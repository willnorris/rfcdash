<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 9053: CBOR Object Signing and Encryption (COSE): Initial Algorithms</title>
<meta content="Jim Schaad" name="author"/>
<meta content="
       
        Concise Binary Object Representation (CBOR) is a data format designed for small code size and small message size. 
        There is a need to be able to define basic security services for this data format.
        This document defines a set of algorithms that can be used with the
 CBOR Object Signing and Encryption (COSE) protocol (RFC 9052).
       
       
        This document, along with RFC 9052, obsoletes RFC 8152.
       
    " name="description"/>
<meta content="xml2rfc 3.14.2" name="generator"/>
<meta content="Object Security" name="keyword"/>
<meta content="COSE" name="keyword"/>
<meta content="Constrained Devices" name="keyword"/>
<meta content="AES" name="keyword"/>
<meta content="AES-GCM" name="keyword"/>
<meta content="AES-CCM" name="keyword"/>
<meta content="ECDSA" name="keyword"/>
<meta content="EdDSA" name="keyword"/>
<meta content="ECC" name="keyword"/>
<meta content="HSS-LMS" name="keyword"/>
<meta content="AES-KW" name="keyword"/>
<meta content="ECDH" name="keyword"/>
<meta content="HMAC" name="keyword"/>
<meta content="CMAC" name="keyword"/>
<meta content="Cryptography" name="keyword"/>
<meta content="9053" name="rfc.number"/>
<!-- Generator version information:
  xml2rfc 3.14.2
    Python 3.9.13
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.1
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 3.1.2
    kitchen 1.2.6
    lxml 4.9.0
    MarkupSafe 2.1.1
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.28.0
    setuptools 44.1.1
    six 1.16.0
    weasyprint 56.1
-->
<link href="rfc9053.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  pre.breakable {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://dx.doi.org/10.17487/rfc9053" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <link href="https://datatracker.ietf.org/doc/draft-ietf-cose-rfc8152bis-algs-12" rel="prev"/>
  </head>
<body>
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9053</td>
<td class="center">COSE Algorithms</td>
<td class="right">August 2022</td>
</tr></thead>
<tfoot><tr>
<td class="left">Schaad</td>
<td class="center">Informational</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc9053">9053</a></dd>
<dt class="label-obsoletes">Obsoletes:</dt>
<dd class="obsoletes">
<a class="eref" href="https://www.rfc-editor.org/rfc/rfc8152">8152</a> </dd>
<dt class="label-category">Category:</dt>
<dd class="category">Informational</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2022-08">August 2022</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">J. Schaad</div>
<div class="org">August Cellars</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9053</h1>
<h1 id="title">CBOR Object Signing and Encryption (COSE): Initial Algorithms</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">
        Concise Binary Object Representation (CBOR) is a data format designed for small code size and small message size. 
        There is a need to be able to define basic security services for this data format.
        This document defines a set of algorithms that can be used with the
 CBOR Object Signing and Encryption (COSE) protocol (RFC 9052).<a class="pilcrow" href="#section-abstract-1">¶</a></p>
<p id="section-abstract-2">
        This document, along with RFC 9052, obsoletes RFC 8152.<a class="pilcrow" href="#section-abstract-2">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This document is not an Internet Standards Track specification; it is
            published for informational purposes.<a class="pilcrow" href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by the
            Internet Engineering Steering Group (IESG).  Not all documents
            approved by the IESG are candidates for any level of Internet
            Standard; see Section 2 of RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9053">https://www.rfc-editor.org/info/rfc9053</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">▲</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a class="xref" href="#section-1">1</a>.  <a class="xref" href="#name-introduction">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p class="keepWithNext" id="section-toc.1-1.1.2.1.1"><a class="xref" href="#section-1.1">1.1</a>.  <a class="xref" href="#name-requirements-terminology">Requirements Terminology</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p class="keepWithNext" id="section-toc.1-1.1.2.2.1"><a class="xref" href="#section-1.2">1.2</a>.  <a class="xref" href="#name-changes-from-rfc-8152">Changes from RFC 8152</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3">
                <p class="keepWithNext" id="section-toc.1-1.1.2.3.1"><a class="xref" href="#section-1.3">1.3</a>.  <a class="xref" href="#name-document-terminology">Document Terminology</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.4">
                <p id="section-toc.1-1.1.2.4.1"><a class="xref" href="#section-1.4">1.4</a>.  <a class="xref" href="#name-cddl-grammar-for-cbor-data-">CDDL Grammar for CBOR Data Structures</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.5">
                <p id="section-toc.1-1.1.2.5.1"><a class="xref" href="#section-1.5">1.5</a>.  <a class="xref" href="#name-examples">Examples</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a class="xref" href="#section-2">2</a>.  <a class="xref" href="#name-signature-algorithms">Signature Algorithms</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a class="xref" href="#section-2.1">2.1</a>.  <a class="xref" href="#name-ecdsa">ECDSA</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.1">
                    <p id="section-toc.1-1.2.2.1.2.1.1"><a class="xref" href="#section-2.1.1">2.1.1</a>.  <a class="xref" href="#name-security-considerations-for">Security Considerations for ECDSA</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a class="xref" href="#section-2.2">2.2</a>.  <a class="xref" href="#name-edwards-curve-digital-signa">Edwards-Curve Digital Signature Algorithm (EdDSA)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.1">
                    <p id="section-toc.1-1.2.2.2.2.1.1"><a class="xref" href="#section-2.2.1">2.2.1</a>.  <a class="xref" href="#name-security-considerations-for-">Security Considerations for EdDSA</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a class="xref" href="#section-3">3</a>.  <a class="xref" href="#name-message-authentication-code">Message Authentication Code (MAC) Algorithms</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a class="xref" href="#section-3.1">3.1</a>.  <a class="xref" href="#name-hash-based-message-authenti">Hash-Based Message Authentication Codes (HMACs)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.1">
                    <p id="section-toc.1-1.3.2.1.2.1.1"><a class="xref" href="#section-3.1.1">3.1.1</a>.  <a class="xref" href="#name-security-considerations-for-h">Security Considerations for HMAC</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a class="xref" href="#section-3.2">3.2</a>.  <a class="xref" href="#name-aes-message-authentication-">AES Message Authentication Code (AES-CBC-MAC)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a class="xref" href="#section-3.2.1">3.2.1</a>.  <a class="xref" href="#name-security-considerations-for-a">Security Considerations for AES-CBC-MAC</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="xref" href="#section-4">4</a>.  <a class="xref" href="#name-content-encryption-algorith">Content Encryption Algorithms</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a class="xref" href="#section-4.1">4.1</a>.  <a class="xref" href="#name-aes-gcm">AES-GCM</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.1">
                    <p id="section-toc.1-1.4.2.1.2.1.1"><a class="xref" href="#section-4.1.1">4.1.1</a>.  <a class="xref" href="#name-security-considerations-for-ae">Security Considerations for AES-GCM</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a class="xref" href="#section-4.2">4.2</a>.  <a class="xref" href="#name-aes-ccm">AES-CCM</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a class="xref" href="#section-4.2.1">4.2.1</a>.  <a class="xref" href="#name-security-considerations-for-aes">Security Considerations for AES-CCM</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a class="xref" href="#section-4.3">4.3</a>.  <a class="xref" href="#name-chacha20-and-poly1305">ChaCha20 and Poly1305</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.1">
                    <p id="section-toc.1-1.4.2.3.2.1.1"><a class="xref" href="#section-4.3.1">4.3.1</a>.  <a class="xref" href="#name-security-considerations-for-c">Security Considerations for ChaCha20/Poly1305</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="xref" href="#section-5">5</a>.  <a class="xref" href="#name-key-derivation-functions-kd">Key Derivation Functions (KDFs)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a class="xref" href="#section-5.1">5.1</a>.  <a class="xref" href="#name-hmac-based-extract-and-expa">HMAC-Based Extract-and-Expand Key Derivation Function (HKDF)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a class="xref" href="#section-5.2">5.2</a>.  <a class="xref" href="#name-context-information-structu">Context Information Structure</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="xref" href="#section-6">6</a>.  <a class="xref" href="#name-content-key-distribution-me">Content Key Distribution Methods</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a class="xref" href="#section-6.1">6.1</a>.  <a class="xref" href="#name-direct-encryption">Direct Encryption</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.1">
                    <p id="section-toc.1-1.6.2.1.2.1.1"><a class="xref" href="#section-6.1.1">6.1.1</a>.  <a class="xref" href="#name-direct-key">Direct Key</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.2">
                    <p id="section-toc.1-1.6.2.1.2.2.1"><a class="xref" href="#section-6.1.2">6.1.2</a>.  <a class="xref" href="#name-direct-key-with-kdf">Direct Key with KDF</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a class="xref" href="#section-6.2">6.2</a>.  <a class="xref" href="#name-key-wrap">Key Wrap</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.1">
                    <p id="section-toc.1-1.6.2.2.2.1.1"><a class="xref" href="#section-6.2.1">6.2.1</a>.  <a class="xref" href="#name-aes-key-wrap">AES Key Wrap</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a class="xref" href="#section-6.3">6.3</a>.  <a class="xref" href="#name-direct-key-agreement">Direct Key Agreement</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3.2.1">
                    <p id="section-toc.1-1.6.2.3.2.1.1"><a class="xref" href="#section-6.3.1">6.3.1</a>.  <a class="xref" href="#name-direct-ecdh">Direct ECDH</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a class="xref" href="#section-6.4">6.4</a>.  <a class="xref" href="#name-key-agreement-with-key-wrap">Key Agreement with Key Wrap</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4.2.1">
                    <p id="section-toc.1-1.6.2.4.2.1.1"><a class="xref" href="#section-6.4.1">6.4.1</a>.  <a class="xref" href="#name-ecdh-with-key-wrap">ECDH with Key Wrap</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="xref" href="#section-7">7</a>.  <a class="xref" href="#name-key-object-parameters">Key Object Parameters</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a class="xref" href="#section-7.1">7.1</a>.  <a class="xref" href="#name-elliptic-curve-keys">Elliptic Curve Keys</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1.2.1">
                    <p id="section-toc.1-1.7.2.1.2.1.1"><a class="xref" href="#section-7.1.1">7.1.1</a>.  <a class="xref" href="#name-double-coordinate-curves">Double Coordinate Curves</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a class="xref" href="#section-7.2">7.2</a>.  <a class="xref" href="#name-octet-key-pair">Octet Key Pair</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a class="xref" href="#section-7.3">7.3</a>.  <a class="xref" href="#name-symmetric-keys">Symmetric Keys</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="xref" href="#section-8">8</a>.  <a class="xref" href="#name-cose-capabilities">COSE Capabilities</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a class="xref" href="#section-8.1">8.1</a>.  <a class="xref" href="#name-assignments-for-existing-al">Assignments for Existing Algorithms</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a class="xref" href="#section-8.2">8.2</a>.  <a class="xref" href="#name-assignments-for-existing-ke">Assignments for Existing Key Types</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a class="xref" href="#section-8.3">8.3</a>.  <a class="xref" href="#name-examples-2">Examples</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="xref" href="#section-9">9</a>.  <a class="xref" href="#name-cbor-encoding-restrictions">CBOR Encoding Restrictions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a class="xref" href="#section-10">10</a>. <a class="xref" href="#name-iana-considerations">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a class="xref" href="#section-10.1">10.1</a>.  <a class="xref" href="#name-changes-to-the-cose-key-typ">Changes to the "COSE Key Types" Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a class="xref" href="#section-10.2">10.2</a>.  <a class="xref" href="#name-changes-to-the-cose-algorit">Changes to the "COSE Algorithms" Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3">
                <p id="section-toc.1-1.10.2.3.1"><a class="xref" href="#section-10.3">10.3</a>.  <a class="xref" href="#name-changes-to-the-cose-key-type">Changes to the "COSE Key Type Parameters" Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.4">
                <p id="section-toc.1-1.10.2.4.1"><a class="xref" href="#section-10.4">10.4</a>.  <a class="xref" href="#name-expert-review-instructions">Expert Review Instructions</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a class="xref" href="#section-11">11</a>. <a class="xref" href="#name-security-considerations">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a class="xref" href="#section-12">12</a>. <a class="xref" href="#name-references">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a class="xref" href="#section-12.1">12.1</a>.  <a class="xref" href="#name-normative-references">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a class="xref" href="#section-12.2">12.2</a>.  <a class="xref" href="#name-informative-references">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a class="xref" href="#appendix-A"></a><a class="xref" href="#name-acknowledgments">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a class="xref" href="#appendix-B"></a><a class="xref" href="#name-authors-address">Author's Address</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">
        There has been an increased focus on small, constrained devices that make up the Internet of Things (IoT). 
        One of the standards that has come out of this process is "Concise
 Binary Object Representation (CBOR)" <span>[<a class="xref" href="#STD94">STD94</a>]</span>. 
        CBOR extended the data model of JavaScript Object Notation (JSON)
 <span>[<a class="xref" href="#STD90">STD90</a>]</span> by allowing for binary data, among other
 changes. 
        CBOR has been adopted by several of the IETF working groups dealing
 with the IoT world as their method of encoding data structures. 
        CBOR was designed specifically to be small in terms of both messages
 transported and implementation size and to have a schema-free decoder. 
        A need exists to provide message security services for IoT, and using
 CBOR as the message-encoding format makes sense.<a class="pilcrow" href="#section-1-1">¶</a></p>
<p id="section-1-2">
        The core COSE specification consists of two documents.
        <span>[<a class="xref" href="#RFC9052">RFC9052</a>]</span> contains the serialization structures and the procedures for using the different cryptographic algorithms.
        This document provides an initial set of algorithms for use with those structures.<a class="pilcrow" href="#section-1-2">¶</a></p>
<div id="requirements-terminology">
<section id="section-1.1">
        <h3 id="name-requirements-terminology">
<a class="section-number selfRef" href="#section-1.1">1.1. </a><a class="section-name selfRef" href="#name-requirements-terminology">Requirements Terminology</a>
        </h3>
<p id="section-1.1-1">
          The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
          "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
          described in BCP 14 <span>[<a class="xref" href="#RFC2119">RFC2119</a>]</span> <span>[<a class="xref" href="#RFC8174">RFC8174</a>]</span> when, and only when, they
          appear in all capitals, as shown here.<a class="pilcrow" href="#section-1.1-1">¶</a></p>
</section>
</div>
<section id="section-1.2">
        <h3 id="name-changes-from-rfc-8152">
<a class="section-number selfRef" href="#section-1.2">1.2. </a><a class="section-name selfRef" href="#name-changes-from-rfc-8152">Changes from RFC 8152</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-1.2-1.1">
              Extracted the sections dealing with specific algorithms and placed
       them into this document.
              The sections dealing with structure and general processing rules
       are placed in <span>[<a class="xref" href="#RFC9052">RFC9052</a>]</span>.<a class="pilcrow" href="#section-1.2-1.1">¶</a>
</li>
          <li class="normal" id="section-1.2-1.2">Made text clarifications and changes in terminology.<a class="pilcrow" href="#section-1.2-1.2">¶</a>
</li>
          <li class="normal" id="section-1.2-1.3">Removed all of the details relating to countersignatures and placed them in <span>[<a class="xref" href="#I-D.ietf-cose-countersign">COUNTERSIGN</a>]</span>.<a class="pilcrow" href="#section-1.2-1.3">¶</a>
</li>
        </ul>
</section>
<section id="section-1.3">
        <h3 id="name-document-terminology">
<a class="section-number selfRef" href="#section-1.3">1.3. </a><a class="section-name selfRef" href="#name-document-terminology">Document Terminology</a>
        </h3>
<p id="section-1.3-1">In this document, we use the following terminology:<a class="pilcrow" href="#section-1.3-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-1.3-2">
          <dt id="section-1.3-2.1">Byte:</dt>
          <dd id="section-1.3-2.2" style="margin-left: 1.5em">A synonym for octet.<a class="pilcrow" href="#section-1.3-2.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.3">Constrained Application Protocol (CoAP):</dt>
          <dd id="section-1.3-2.4" style="margin-left: 1.5em">A specialized
 web transfer protocol for use in constrained systems.  It is defined
 in <span>[<a class="xref" href="#RFC7252">RFC7252</a>]</span>.<a class="pilcrow" href="#section-1.3-2.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.5">Authenticated Encryption (AE) algorithms <span>[<a class="xref" href="#RFC5116">RFC5116</a>]</span>:
          </dt>
          <dd id="section-1.3-2.6" style="margin-left: 1.5em">Encryption algorithms that provide an
 authentication check of the contents along with the encryption service.
          An example of an AE algorithm used in COSE is AES Key Wrap <span>[<a class="xref" href="#RFC3394">RFC3394</a>]</span>.
          These algorithms are used for key encryption, but
   Authenticated Encryption with Associated Data (AEAD)
   algorithms would be preferred.<a class="pilcrow" href="#section-1.3-2.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.7">AEAD algorithms <span>[<a class="xref" href="#RFC5116">RFC5116</a>]</span>:</dt>
          <dd id="section-1.3-2.8" style="margin-left: 1.5em">Encryption algorithms that provide the same authentication service of
 the content as AE algorithms do, and also allow
 associated data that is not part of the encrypted body to be included
 in the authentication service. An example of an AEAD
 algorithm used in COSE is AES-GCM <span>[<a class="xref" href="#RFC5116">RFC5116</a>]</span>. These
 algorithms are used for content encryption and can be used for key
 encryption as well.<a class="pilcrow" href="#section-1.3-2.8">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-1.3-3">The term "byte string" is used for sequences of bytes, while the term "text string" is used for sequences of characters.<a class="pilcrow" href="#section-1.3-3">¶</a></p>
<p id="section-1.3-4">
          The tables for algorithms contain the following columns:<a class="pilcrow" href="#section-1.3-4">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.3-5.1">A name for the algorithm for use in documents.<a class="pilcrow" href="#section-1.3-5.1">¶</a>
</li>
          <li class="normal" id="section-1.3-5.2">
            The value used on the wire for the algorithm.
            One place this is used is the algorithm header parameter of a message.<a class="pilcrow" href="#section-1.3-5.2">¶</a>
</li>
          <li class="normal" id="section-1.3-5.3">A short description so that the algorithm can be easily identified when scanning the IANA registry.<a class="pilcrow" href="#section-1.3-5.3">¶</a>
</li>
        </ul>
<p id="section-1.3-6">
          Additional columns may be present in a table depending on the
   algorithms.<a class="pilcrow" href="#section-1.3-6">¶</a></p>
</section>
<section id="section-1.4">
        <h3 id="name-cddl-grammar-for-cbor-data-">
<a class="section-number selfRef" href="#section-1.4">1.4. </a><a class="section-name selfRef" href="#name-cddl-grammar-for-cbor-data-">CDDL Grammar for CBOR Data Structures</a>
        </h3>
<p id="section-1.4-1">
          When COSE was originally written, the Concise Data Definition
          Language (CDDL) <span>[<a class="xref" href="#RFC8610">RFC8610</a>]</span> had not yet been published
          in an RFC, so it could not be used as the data description
          language to normatively describe the CBOR data structures employed
          by COSE.
          For that reason, the CBOR data objects defined here are described
          in prose.
          Additional (non-normative) descriptions of the
          COSE data objects are provided in a subset of CDDL, described in
          <span>[<a class="xref" href="#RFC9052">RFC9052</a>]</span>.<a class="pilcrow" href="#section-1.4-1">¶</a></p>
</section>
<div id="examples">
<section id="section-1.5">
        <h3 id="name-examples">
<a class="section-number selfRef" href="#section-1.5">1.5. </a><a class="section-name selfRef" href="#name-examples">Examples</a>
        </h3>
<p id="section-1.5-1">
          A GitHub project has been created at <span>[<a class="xref" href="#GitHub-Examples">GitHub-Examples</a>]</span> that contains a set of testing examples. 
          Each example is found in a JSON file that contains the inputs used to create the example, some of the intermediate values that can be used for debugging, and the output of the example.
          The results are encoded using both hexadecimal and
   CBOR diagnostic notation format.<a class="pilcrow" href="#section-1.5-1">¶</a></p>
<p id="section-1.5-2">
          Some of the examples are designed to be failure-testing cases; these
   are clearly marked as such in the JSON file.<a class="pilcrow" href="#section-1.5-2">¶</a></p>
</section>
</div>
</section>
</div>
<div id="SigAlgs">
<section id="section-2">
      <h2 id="name-signature-algorithms">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-signature-algorithms">Signature Algorithms</a>
      </h2>
<p id="section-2-1">
        <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9052#section-8.1">Section 8.1</a> of [<a class="xref" href="#RFC9052">RFC9052</a>]</span> contains a generic description of signature algorithms.
        This document defines signature algorithm identifiers for two signature algorithms.<a class="pilcrow" href="#section-2-1">¶</a></p>
<div id="ECDSA">
<section id="section-2.1">
        <h3 id="name-ecdsa">
<a class="section-number selfRef" href="#section-2.1">2.1. </a><a class="section-name selfRef" href="#name-ecdsa">ECDSA</a>
        </h3>
<p id="section-2.1-1">The Elliptic Curve Digital Signature Algorithm (ECDSA) <span>[<a class="xref" href="#DSS">DSS</a>]</span> defines a signature algorithm using Elliptic Curve Cryptography (ECC).
 Implementations <span class="bcp14">SHOULD</span> use a deterministic version of
 ECDSA such as the one defined in <span>[<a class="xref" href="#RFC6979">RFC6979</a>]</span>.  The use of
 a deterministic signature algorithm allows systems to avoid relying on
 random number generators in order to avoid generating the same value
 of "k" (the per-message random value). Biased generation of the value
 "k" can be attacked, and collisions of this value lead to leaked
 keys.  It additionally allows performing deterministic tests for the
 signature algorithm.  The use of deterministic ECDSA does not lessen
 the need to have good random number generation when creating the
 private key.<a class="pilcrow" href="#section-2.1-1">¶</a></p>
<p id="section-2.1-2">The ECDSA signature algorithm is parameterized with a hash function
 (h).  In the event that the length of the hash function output is
 greater than the group of the key, the leftmost bytes of the hash
 output are used.<a class="pilcrow" href="#section-2.1-2">¶</a></p>
<p id="section-2.1-3">The algorithms defined in this document can be found in <a class="xref" href="#x-table_ecdsa">Table 1</a>.<a class="pilcrow" href="#section-2.1-3">¶</a></p>
<span id="name-ecdsa-algorithm-values"></span><div id="x-table_ecdsa">
<table class="center" id="table-1">
          <caption>
<a class="selfRef" href="#table-1">Table 1</a>:
<a class="selfRef" href="#name-ecdsa-algorithm-values">ECDSA Algorithm Values</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Name</th>
              <th class="text-center" colspan="1" rowspan="1">Value</th>
              <th class="text-left" colspan="1" rowspan="1">Hash</th>
              <th class="text-left" colspan="1" rowspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">ES256</td>
              <td class="text-center" colspan="1" rowspan="1">-7</td>
              <td class="text-left" colspan="1" rowspan="1">SHA-256</td>
              <td class="text-left" colspan="1" rowspan="1">ECDSA w/ SHA-256</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">ES384</td>
              <td class="text-center" colspan="1" rowspan="1">-35</td>
              <td class="text-left" colspan="1" rowspan="1">SHA-384</td>
              <td class="text-left" colspan="1" rowspan="1">ECDSA w/ SHA-384</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">ES512</td>
              <td class="text-center" colspan="1" rowspan="1">-36</td>
              <td class="text-left" colspan="1" rowspan="1">SHA-512</td>
              <td class="text-left" colspan="1" rowspan="1">ECDSA w/ SHA-512</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-2.1-5">This document defines ECDSA as working only with the curves P-256,
 P-384, and P-521.  This document requires that the curves be encoded
 using the "EC2" (two coordinate elliptic curve) key type.
 Implementations need to check that the key type and curve are correct
 when creating and verifying a signature.  Future documents may define
 it to work with other curves and key types in the future.<a class="pilcrow" href="#section-2.1-5">¶</a></p>
<p id="section-2.1-6">In order to promote interoperability, it is suggested that SHA-256 be used only with curve P-256, SHA-384 be used only with curve P-384, and SHA-512 be used only with curve P-521.  This is aligned with the recommendation in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc5480#section-4">Section 4</a> of [<a class="xref" href="#RFC5480">RFC5480</a>]</span>.<a class="pilcrow" href="#section-2.1-6">¶</a></p>
<p id="section-2.1-7">
          The signature algorithm results in a pair of integers (R, S).
          These integers will be the same length as the length of the key used for the signature process.
          The signature is encoded by converting the integers into byte strings of the same length as the key size.
          The length is rounded up to the nearest byte and is left padded with zero bits to get to the correct length.
          The two integers are then concatenated together to form a byte string that is the resulting signature.<a class="pilcrow" href="#section-2.1-7">¶</a></p>
<p id="section-2.1-8">
          Using the function defined in <span>[<a class="xref" href="#RFC8017">RFC8017</a>]</span>, the signature is:<a class="pilcrow" href="#section-2.1-8">¶</a></p>
<p id="section-2.1-9">
          Signature = I2OSP(R, n) | I2OSP(S, n)<a class="pilcrow" href="#section-2.1-9">¶</a></p>
<p id="section-2.1-10">
          where n = ceiling(key_length / 8)<a class="pilcrow" href="#section-2.1-10">¶</a></p>
<p id="section-2.1-11">When using a COSE key for this algorithm, the following checks are made:<a class="pilcrow" href="#section-2.1-11">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-12.1">The "kty" field <span class="bcp14">MUST</span> be present, and it <span class="bcp14">MUST</span> be "EC2".<a class="pilcrow" href="#section-2.1-12.1">¶</a>
</li>
          <li class="normal" id="section-2.1-12.2">If the "alg" field is present, it <span class="bcp14">MUST</span> match the ECDSA signature algorithm being used.<a class="pilcrow" href="#section-2.1-12.2">¶</a>
</li>
          <li class="normal" id="section-2.1-12.3">If the "key_ops" field is present, it <span class="bcp14">MUST</span> include "sign" when creating an ECDSA signature.<a class="pilcrow" href="#section-2.1-12.3">¶</a>
</li>
          <li class="normal" id="section-2.1-12.4">If the "key_ops" field is present, it <span class="bcp14">MUST</span> include "verify" when verifying an ECDSA signature.<a class="pilcrow" href="#section-2.1-12.4">¶</a>
</li>
        </ul>
<section id="section-2.1.1">
          <h4 id="name-security-considerations-for">
<a class="section-number selfRef" href="#section-2.1.1">2.1.1. </a><a class="section-name selfRef" href="#name-security-considerations-for">Security Considerations for ECDSA</a>
          </h4>
<p id="section-2.1.1-1">The security strength of the signature is no greater than the minimum of the security strength associated with the bit length of the key and the security strength of the hash function.<a class="pilcrow" href="#section-2.1.1-1">¶</a></p>
<p id="section-2.1.1-2">
            Note: Use of a deterministic signature technique is a good idea
     even when good random number generation exists. 
            Doing so both reduces the possibility of having the same value of
     "k" in two signature operations and allows for reproducible
     signature values, which helps testing.
            There have been recent attacks involving faulting the device in
     order to extract the key.
            This can be addressed by combining both randomness and determinism
     <span>[<a class="xref" href="#I-D.mattsson-cfrg-det-sigs-with-noise">CFRG-DET-SIGS</a>]</span>.<a class="pilcrow" href="#section-2.1.1-2">¶</a></p>
<p id="section-2.1.1-3">There are two substitution attacks that can theoretically be mounted against the ECDSA signature algorithm.<a class="pilcrow" href="#section-2.1.1-3">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1.1-4.1">Changing the curve used to validate the signature: If one
     changes the curve used to validate the signature, then potentially
     one could have two messages with the same signature, each computed
     under a different curve.  The only requirements on the new curve are
     that its order be the same as the old one and that it be acceptable to
     the client.  An example would be to change from using the curve
     secp256r1 (aka P-256) to using secp256k1.  (Both are 256-bit
     curves.) We currently do not have any way to deal with this
     version of the attack except to restrict the overall set of curves
     that can be used.<a class="pilcrow" href="#section-2.1.1-4.1">¶</a>
</li>
            <li class="normal" id="section-2.1.1-4.2">Changing the hash function used to validate the signature: If
     one either has two different hash functions of the same length or
     can truncate a hash function, then one could potentially find
     collisions between the hash functions rather than within a single
     hash function. For example, truncating SHA-512 to 256 bits might
     collide with a SHA-256 bit hash value. As the hash algorithm is
     part of the signature algorithm identifier, this attack is
     mitigated by including a signature algorithm identifier in the
     protected-header bucket.<a class="pilcrow" href="#section-2.1.1-4.2">¶</a>
</li>
          </ul>
</section>
</section>
</div>
<section id="section-2.2">
        <h3 id="name-edwards-curve-digital-signa">
<a class="section-number selfRef" href="#section-2.2">2.2. </a><a class="section-name selfRef" href="#name-edwards-curve-digital-signa">Edwards-Curve Digital Signature Algorithm (EdDSA)</a>
        </h3>
<p id="section-2.2-1"><span>[<a class="xref" href="#RFC8032">RFC8032</a>]</span> describes the elliptic curve signature
 scheme Edwards-curve Digital Signature Algorithm (EdDSA).  In that
 document, the signature algorithm is instantiated using parameters for
 the edwards25519 and edwards448 curves.  The document additionally
 describes two variants of the EdDSA algorithm: Pure EdDSA, where no
 hash function is applied to the content before signing, and HashEdDSA,
 where a hash function is applied to the content before signing and the
 result of that hash function is signed.  For EdDSA, the content to be
 signed (either the message or the prehash value) is processed twice
 inside of the signature algorithm.  For use with COSE, only the pure
 EdDSA version is used.  This is because it is not expected that
 extremely large contents are going to be needed and, based on the
 arrangement of the message structure, the entire message is going to
 need to be held in memory in order to create or verify a signature.
 Therefore, there does not appear to be a need to be able to do
 block updates of the hash, followed by eliminating the message from
 memory.  Applications can provide the same features by defining the
 content of the message as a hash value and transporting the COSE
 object (with the hash value) and the content as separate items.<a class="pilcrow" href="#section-2.2-1">¶</a></p>
<p id="section-2.2-2">The algorithm defined in this document can be found in <a class="xref" href="#x-table-eddsa-algs">Table 2</a>.  A single signature algorithm is defined, which can be used for multiple curves.<a class="pilcrow" href="#section-2.2-2">¶</a></p>
<span id="name-eddsa-algorithm-value"></span><div id="x-table-eddsa-algs">
<table class="center" id="table-2">
          <caption>
<a class="selfRef" href="#table-2">Table 2</a>:
<a class="selfRef" href="#name-eddsa-algorithm-value">EdDSA Algorithm Value</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Name</th>
              <th class="text-center" colspan="1" rowspan="1">Value</th>
              <th class="text-left" colspan="1" rowspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">EdDSA</td>
              <td class="text-center" colspan="1" rowspan="1">-8</td>
              <td class="text-left" colspan="1" rowspan="1">EdDSA</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-2.2-4"><span>[<a class="xref" href="#RFC8032">RFC8032</a>]</span> describes the method of encoding the signature value.<a class="pilcrow" href="#section-2.2-4">¶</a></p>
<p id="section-2.2-5">When using a COSE key for this algorithm, the following checks are made:<a class="pilcrow" href="#section-2.2-5">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2-6.1">The "kty" field <span class="bcp14">MUST</span> be present, and it <span class="bcp14">MUST</span> be "OKP" (Octet Key Pair).<a class="pilcrow" href="#section-2.2-6.1">¶</a>
</li>
          <li class="normal" id="section-2.2-6.2">The "crv" field <span class="bcp14">MUST</span> be present, and it <span class="bcp14">MUST</span> be a curve defined for this signature algorithm.<a class="pilcrow" href="#section-2.2-6.2">¶</a>
</li>
          <li class="normal" id="section-2.2-6.3">If the "alg" field is present, it <span class="bcp14">MUST</span> match "EdDSA".<a class="pilcrow" href="#section-2.2-6.3">¶</a>
</li>
          <li class="normal" id="section-2.2-6.4">If the "key_ops" field is present, it <span class="bcp14">MUST</span> include "sign" when creating an EdDSA signature.<a class="pilcrow" href="#section-2.2-6.4">¶</a>
</li>
          <li class="normal" id="section-2.2-6.5">If the "key_ops" field is present, it <span class="bcp14">MUST</span> include "verify" when verifying an EdDSA signature.<a class="pilcrow" href="#section-2.2-6.5">¶</a>
</li>
        </ul>
<section id="section-2.2.1">
          <h4 id="name-security-considerations-for-">
<a class="section-number selfRef" href="#section-2.2.1">2.2.1. </a><a class="section-name selfRef" href="#name-security-considerations-for-">Security Considerations for EdDSA</a>
          </h4>
<p id="section-2.2.1-1">Public values are computed differently in EdDSA and Elliptic Curve
   Diffie-Hellman (ECDH); for this reason, the public key from one should not be
   used with the other algorithm.<a class="pilcrow" href="#section-2.2.1-1">¶</a></p>
<p id="section-2.2.1-2">If batch signature verification is performed, a well-seeded
   cryptographic random number generator is <span class="bcp14">REQUIRED</span>
   (<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8032#section-8.2">Section 8.2</a> of [<a class="xref" href="#RFC8032">RFC8032</a>]</span>).  Signing and nonbatch
   signature verification are deterministic operations and do not need
   random numbers of any kind.<a class="pilcrow" href="#section-2.2.1-2">¶</a></p>
</section>
</section>
</section>
</div>
<section id="section-3">
      <h2 id="name-message-authentication-code">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-message-authentication-code">Message Authentication Code (MAC) Algorithms</a>
      </h2>
<p id="section-3-1">
 <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9052#section-8.2">Section 8.2</a> of [<a class="xref" href="#RFC9052">RFC9052</a>]</span> contains a generic description
 of MAC algorithms.
        This section defines the conventions for two MAC algorithms.<a class="pilcrow" href="#section-3-1">¶</a></p>
<section id="section-3.1">
        <h3 id="name-hash-based-message-authenti">
<a class="section-number selfRef" href="#section-3.1">3.1. </a><a class="section-name selfRef" href="#name-hash-based-message-authenti">Hash-Based Message Authentication Codes (HMACs)</a>
        </h3>
<p id="section-3.1-1">HMAC <span>[<a class="xref" href="#RFC2104">RFC2104</a>]</span> <span>[<a class="xref" href="#RFC4231">RFC4231</a>]</span> was designed
 to deal with length extension attacks. The HMAC algorithm was also designed to allow new hash functions to be
 directly plugged in without changes to the hash function.  The HMAC design process has
 been shown to be solid; although the security of hash functions such
 as MD5 has decreased over time, the security of HMAC combined with MD5
 has not yet been shown to be compromised <span>[<a class="xref" href="#RFC6151">RFC6151</a>]</span>.<a class="pilcrow" href="#section-3.1-1">¶</a></p>
<p id="section-3.1-2">The HMAC algorithm is parameterized by an inner and outer padding,
 a hash function (h), and an authentication tag value length.  For this
 specification, the inner and outer padding are fixed to the values set
 in <span>[<a class="xref" href="#RFC2104">RFC2104</a>]</span>.  The length of the authentication tag
 corresponds to the difficulty of producing a forgery.  For use in
 constrained environments, we define one HMAC algorithm that is
 truncated.  There are currently no known issues with truncation;
 however, the security strength of the message tag is correspondingly
 reduced in strength.  When truncating, the leftmost tag-length bits
 are kept and transmitted.<a class="pilcrow" href="#section-3.1-2">¶</a></p>
<p id="section-3.1-3">The algorithms defined in this document can be found in <a class="xref" href="#x-table-hmac">Table 3</a>.<a class="pilcrow" href="#section-3.1-3">¶</a></p>
<span id="name-hmac-algorithm-values"></span><div id="x-table-hmac">
<table class="center" id="table-3">
          <caption>
<a class="selfRef" href="#table-3">Table 3</a>:
<a class="selfRef" href="#name-hmac-algorithm-values">HMAC Algorithm Values</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Name</th>
              <th class="text-center" colspan="1" rowspan="1">Value</th>
              <th class="text-left" colspan="1" rowspan="1">Hash</th>
              <th class="text-center" colspan="1" rowspan="1">Tag Length</th>
              <th class="text-left" colspan="1" rowspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">HMAC 256/64</td>
              <td class="text-center" colspan="1" rowspan="1">4</td>
              <td class="text-left" colspan="1" rowspan="1">SHA-256</td>
              <td class="text-center" colspan="1" rowspan="1">64</td>
              <td class="text-left" colspan="1" rowspan="1">HMAC w/ SHA-256 truncated to 64 bits</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">HMAC 256/256</td>
              <td class="text-center" colspan="1" rowspan="1">5</td>
              <td class="text-left" colspan="1" rowspan="1">SHA-256</td>
              <td class="text-center" colspan="1" rowspan="1">256</td>
              <td class="text-left" colspan="1" rowspan="1">HMAC w/ SHA-256</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">HMAC 384/384</td>
              <td class="text-center" colspan="1" rowspan="1">6</td>
              <td class="text-left" colspan="1" rowspan="1">SHA-384</td>
              <td class="text-center" colspan="1" rowspan="1">384</td>
              <td class="text-left" colspan="1" rowspan="1">HMAC w/ SHA-384</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">HMAC 512/512</td>
              <td class="text-center" colspan="1" rowspan="1">7</td>
              <td class="text-left" colspan="1" rowspan="1">SHA-512</td>
              <td class="text-center" colspan="1" rowspan="1">512</td>
              <td class="text-left" colspan="1" rowspan="1">HMAC w/ SHA-512</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-3.1-5">Some recipient algorithms transport the key, while others derive a key from secret data.  For those algorithms that transport the key (such as AES Key Wrap), the size of the HMAC key <span class="bcp14">SHOULD</span> be the same size as the output of the  underlying hash function.  For those algorithms that derive the key (such as ECDH), the derived key <span class="bcp14">MUST</span> be the same size as the output of the underlying hash function.<a class="pilcrow" href="#section-3.1-5">¶</a></p>
<p id="section-3.1-6">When using a COSE key for this algorithm, the following checks are made:<a class="pilcrow" href="#section-3.1-6">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-7.1">The "kty" field <span class="bcp14">MUST</span> be present, and it <span class="bcp14">MUST</span> be "Symmetric".<a class="pilcrow" href="#section-3.1-7.1">¶</a>
</li>
          <li class="normal" id="section-3.1-7.2">If the "alg" field is present, it <span class="bcp14">MUST</span> match the HMAC algorithm being used.<a class="pilcrow" href="#section-3.1-7.2">¶</a>
</li>
          <li class="normal" id="section-3.1-7.3">If the "key_ops" field is present, it <span class="bcp14">MUST</span> include "MAC create" when creating an HMAC authentication tag.<a class="pilcrow" href="#section-3.1-7.3">¶</a>
</li>
          <li class="normal" id="section-3.1-7.4">If the "key_ops" field is present, it <span class="bcp14">MUST</span> include "MAC verify" when verifying an HMAC authentication tag.<a class="pilcrow" href="#section-3.1-7.4">¶</a>
</li>
        </ul>
<p id="section-3.1-8">Implementations creating and validating MAC values <span class="bcp14">MUST</span> validate that the key type, key length, and algorithm are correct and appropriate for the entities involved.<a class="pilcrow" href="#section-3.1-8">¶</a></p>
<section id="section-3.1.1">
          <h4 id="name-security-considerations-for-h">
<a class="section-number selfRef" href="#section-3.1.1">3.1.1. </a><a class="section-name selfRef" href="#name-security-considerations-for-h">Security Considerations for HMAC</a>
          </h4>
<p id="section-3.1.1-1">HMAC has proved to be resistant to attack even when used with weakened hash algorithms.  The current best known attack is to brute force the key.  This means that key size is going to be directly related to the security of an HMAC operation.<a class="pilcrow" href="#section-3.1.1-1">¶</a></p>
</section>
</section>
<section id="section-3.2">
        <h3 id="name-aes-message-authentication-">
<a class="section-number selfRef" href="#section-3.2">3.2. </a><a class="section-name selfRef" href="#name-aes-message-authentication-">AES Message Authentication Code (AES-CBC-MAC)</a>
        </h3>
<p id="section-3.2-1">AES-CBC-MAC is the instantiation of the CBC-MAC construction (defined in <span>[<a class="xref" href="#MAC">MAC</a>]</span>) using AES as the block cipher.  For brevity, we also use "AES-MAC"
to refer to AES-CBC-MAC.  (Note that this is
 not the same algorithm as AES Cipher-Based Message Authentication Code
 (AES-CMAC) <span>[<a class="xref" href="#RFC4493">RFC4493</a>]</span>.)<a class="pilcrow" href="#section-3.2-1">¶</a></p>
<p id="section-3.2-2">AES-CBC-MAC is parameterized by the key length, the
 authentication tag length, and the Initialization Vector (IV) used.
 For all of these algorithms, the IV is fixed to all zeros.  We provide
 an array of algorithms for various key and tag lengths.  The
 algorithms defined in this document are found in <a class="xref" href="#x-table-aes-mac">Table 4</a>.<a class="pilcrow" href="#section-3.2-2">¶</a></p>
<span id="name-aes-mac-algorithm-values"></span><div id="x-table-aes-mac">
<table class="center" id="table-4">
          <caption>
<a class="selfRef" href="#table-4">Table 4</a>:
<a class="selfRef" href="#name-aes-mac-algorithm-values">AES-MAC Algorithm Values</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Name</th>
              <th class="text-center" colspan="1" rowspan="1">Value</th>
              <th class="text-center" colspan="1" rowspan="1">Key Length</th>
              <th class="text-center" colspan="1" rowspan="1">Tag Length</th>
              <th class="text-left" colspan="1" rowspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">AES-MAC 128/64</td>
              <td class="text-center" colspan="1" rowspan="1">14</td>
              <td class="text-center" colspan="1" rowspan="1">128</td>
              <td class="text-center" colspan="1" rowspan="1">64</td>
              <td class="text-left" colspan="1" rowspan="1">AES-MAC 128-bit key, 64-bit tag</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">AES-MAC 256/64</td>
              <td class="text-center" colspan="1" rowspan="1">15</td>
              <td class="text-center" colspan="1" rowspan="1">256</td>
              <td class="text-center" colspan="1" rowspan="1">64</td>
              <td class="text-left" colspan="1" rowspan="1">AES-MAC 256-bit key, 64-bit tag</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">AES-MAC 128/128</td>
              <td class="text-center" colspan="1" rowspan="1">25</td>
              <td class="text-center" colspan="1" rowspan="1">128</td>
              <td class="text-center" colspan="1" rowspan="1">128</td>
              <td class="text-left" colspan="1" rowspan="1">AES-MAC 128-bit key, 128-bit tag</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">AES-MAC 256/128</td>
              <td class="text-center" colspan="1" rowspan="1">26</td>
              <td class="text-center" colspan="1" rowspan="1">256</td>
              <td class="text-center" colspan="1" rowspan="1">128</td>
              <td class="text-left" colspan="1" rowspan="1">AES-MAC 256-bit key, 128-bit tag</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-3.2-4">Keys may be obtained from either a key structure or a
 recipient structure.  Implementations creating and validating MAC
 values <span class="bcp14">MUST</span> validate that the key type, key length, and
 algorithm are correct and appropriate for the entities involved.<a class="pilcrow" href="#section-3.2-4">¶</a></p>
<p id="section-3.2-5">When using a COSE key for this algorithm, the following checks are made:<a class="pilcrow" href="#section-3.2-5">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-6.1">The "kty" field <span class="bcp14">MUST</span> be present, and it <span class="bcp14">MUST</span> be "Symmetric".<a class="pilcrow" href="#section-3.2-6.1">¶</a>
</li>
          <li class="normal" id="section-3.2-6.2">If the "alg" field is present, it <span class="bcp14">MUST</span> match the AES-MAC algorithm being used.<a class="pilcrow" href="#section-3.2-6.2">¶</a>
</li>
          <li class="normal" id="section-3.2-6.3">If the "key_ops" field is present, it <span class="bcp14">MUST</span> include "MAC create" when creating an AES-MAC authentication tag.<a class="pilcrow" href="#section-3.2-6.3">¶</a>
</li>
          <li class="normal" id="section-3.2-6.4">If the "key_ops" field is present, it <span class="bcp14">MUST</span> include "MAC verify" when verifying an AES-MAC authentication tag.<a class="pilcrow" href="#section-3.2-6.4">¶</a>
</li>
        </ul>
<section id="section-3.2.1">
          <h4 id="name-security-considerations-for-a">
<a class="section-number selfRef" href="#section-3.2.1">3.2.1. </a><a class="section-name selfRef" href="#name-security-considerations-for-a">Security Considerations for AES-CBC-MAC</a>
          </h4>
<p id="section-3.2.1-1">A number of attacks exist against Cipher Block Chaining Message Authentication Code (CBC-MAC) that need to be considered.<a class="pilcrow" href="#section-3.2.1-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.1-2.1">A single key must only be used for messages of a fixed or
     known length.  If this is not the case, an attacker will be able
     to generate a message with a valid tag given two
     message and tag pairs.  This can be addressed by using different
     keys for
     messages of different lengths. The current structure mitigates
     this problem, as a specific encoding structure that includes
     lengths is built and signed.  (CMAC also addresses this issue.)<a class="pilcrow" href="#section-3.2.1-2.1">¶</a>
</li>
            <li class="normal" id="section-3.2.1-2.2">In Cipher Block Chaining (CBC) mode, if the same key is used
     for both encryption and authentication operations, an attacker can
     produce messages with a valid authentication code.<a class="pilcrow" href="#section-3.2.1-2.2">¶</a>
</li>
            <li class="normal" id="section-3.2.1-2.3">If the IV can be modified, then messages can be forged.  This is addressed by fixing the IV to all zeros.<a class="pilcrow" href="#section-3.2.1-2.3">¶</a>
</li>
          </ul>
</section>
</section>
</section>
<section id="section-4">
      <h2 id="name-content-encryption-algorith">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-content-encryption-algorith">Content Encryption Algorithms</a>
      </h2>
<p id="section-4-1">

        <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9052#section-8.3">Section 8.3</a> of [<a class="xref" href="#RFC9052">RFC9052</a>]</span> contains a generic description
 of content encryption algorithms.
        This document defines the identifier and usages for three
 content encryption algorithms.<a class="pilcrow" href="#section-4-1">¶</a></p>
<section id="section-4.1">
        <h3 id="name-aes-gcm">
<a class="section-number selfRef" href="#section-4.1">4.1. </a><a class="section-name selfRef" href="#name-aes-gcm">AES-GCM</a>
        </h3>
<p id="section-4.1-1">The Galois/Counter Mode (GCM) mode is a generic AEAD block cipher
 mode defined in <span>[<a class="xref" href="#AES-GCM">AES-GCM</a>]</span>.  The GCM mode is combined
 with the AES block encryption algorithm to define an AEAD cipher.<a class="pilcrow" href="#section-4.1-1">¶</a></p>
<p id="section-4.1-2">The GCM mode is parameterized by the size of the authentication tag
 and the size of the nonce.  This document fixes the size of the nonce
 at 96 bits.  The size of the authentication tag is limited to a small
 set of values.  For this document, however, the size of the
 authentication tag is fixed at 128 bits.<a class="pilcrow" href="#section-4.1-2">¶</a></p>
<p id="section-4.1-3">The set of algorithms defined in this document is in <a class="xref" href="#x-table-AES-GCM">Table 5</a>.<a class="pilcrow" href="#section-4.1-3">¶</a></p>
<span id="name-algorithm-values-for-aes-gc"></span><div id="x-table-AES-GCM">
<table class="center" id="table-5">
          <caption>
<a class="selfRef" href="#table-5">Table 5</a>:
<a class="selfRef" href="#name-algorithm-values-for-aes-gc">Algorithm Values for AES-GCM</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Name</th>
              <th class="text-center" colspan="1" rowspan="1">Value</th>
              <th class="text-left" colspan="1" rowspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">A128GCM</td>
              <td class="text-center" colspan="1" rowspan="1">1</td>
              <td class="text-left" colspan="1" rowspan="1">AES-GCM mode w/ 128-bit key, 128-bit tag</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">A192GCM</td>
              <td class="text-center" colspan="1" rowspan="1">2</td>
              <td class="text-left" colspan="1" rowspan="1">AES-GCM mode w/ 192-bit key, 128-bit tag</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">A256GCM</td>
              <td class="text-center" colspan="1" rowspan="1">3</td>
              <td class="text-left" colspan="1" rowspan="1">AES-GCM mode w/ 256-bit key, 128-bit tag</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-4.1-5">Keys may be obtained from either a key structure or a recipient
 structure.  Implementations that are encrypting or decrypting
 <span class="bcp14">MUST</span> validate that the key type, key length, and
 algorithm are correct and appropriate for the entities involved.<a class="pilcrow" href="#section-4.1-5">¶</a></p>
<p id="section-4.1-6">When using a COSE key for this algorithm, the following checks are made:<a class="pilcrow" href="#section-4.1-6">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-7.1">The "kty" field <span class="bcp14">MUST</span> be present, and it <span class="bcp14">MUST</span> be "Symmetric".<a class="pilcrow" href="#section-4.1-7.1">¶</a>
</li>
          <li class="normal" id="section-4.1-7.2">If the "alg" field is present, it <span class="bcp14">MUST</span> match the AES-GCM algorithm being used.<a class="pilcrow" href="#section-4.1-7.2">¶</a>
</li>
          <li class="normal" id="section-4.1-7.3">If the "key_ops" field is present, it <span class="bcp14">MUST</span> include "encrypt" or "wrap key" when encrypting.<a class="pilcrow" href="#section-4.1-7.3">¶</a>
</li>
          <li class="normal" id="section-4.1-7.4">If the "key_ops" field is present, it <span class="bcp14">MUST</span> include "decrypt" or "unwrap key"  when decrypting.<a class="pilcrow" href="#section-4.1-7.4">¶</a>
</li>
        </ul>
<section id="section-4.1.1">
          <h4 id="name-security-considerations-for-ae">
<a class="section-number selfRef" href="#section-4.1.1">4.1.1. </a><a class="section-name selfRef" href="#name-security-considerations-for-ae">Security Considerations for AES-GCM</a>
          </h4>
<p id="section-4.1.1-1">When using AES-GCM, the following restrictions <span class="bcp14">MUST</span> be enforced:<a class="pilcrow" href="#section-4.1.1-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1.1-2.1">The key and nonce pair <span class="bcp14">MUST</span> be unique for every
     message encrypted.<a class="pilcrow" href="#section-4.1.1-2.1">¶</a>
</li>
            <li class="normal" id="section-4.1.1-2.2">The total number of messages encrypted for a single key
     <span class="bcp14">MUST NOT</span> exceed 2<sup>32</sup> <span>[<a class="xref" href="#SP800-38D">SP800-38D</a>]</span>.
     An explicit check is required only in environments where it is expected that this limit might be exceeded.<a class="pilcrow" href="#section-4.1.1-2.2">¶</a>
</li>
            <li class="normal" id="section-4.1.1-2.3">
              <span>[<a class="xref" href="#RFC8446">RFC8446</a>]</span> contains an analysis on the
       use of AES-CGM for its environment.
              Based on that recommendation, one should restrict the number of
       messages encrypted to 2<sup>24.5</sup>.<a class="pilcrow" href="#section-4.1.1-2.3">¶</a>
</li>
            <li class="normal" id="section-4.1.1-2.4">
              A more recent analysis in <span>[<a class="xref" href="#ROBUST">ROBUST</a>]</span> indicates that
       the number of failed decryptions needs to be taken into account
       as part of determining when a key rollover is to be done.
              Following the recommendation in DTLS (<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9147#section-4.5.3">Section 4.5.3</a> of [<a class="xref" href="#RFC9147">RFC9147</a>]</span>), the number of
              failed message decryptions should be limited to 2<sup>36</sup>.<a class="pilcrow" href="#section-4.1.1-2.4">¶</a>
</li>
          </ul>
<p id="section-4.1.1-3">Consideration was given to supporting smaller tag values; the
   constrained community would desire tag sizes in the 64-bit
   range. Such use drastically changes both the maximum message size
   (generally not an issue) and the number of times that a key can be
   used.  Given that Counter with CBC-MAC (CCM) is the usual mode for
   constrained environments, restricted modes are not supported.<a class="pilcrow" href="#section-4.1.1-3">¶</a></p>
</section>
</section>
<section id="section-4.2">
        <h3 id="name-aes-ccm">
<a class="section-number selfRef" href="#section-4.2">4.2. </a><a class="section-name selfRef" href="#name-aes-ccm">AES-CCM</a>
        </h3>
<p id="section-4.2-1">CCM is a generic authentication encryption block cipher mode
 defined in <span>[<a class="xref" href="#RFC3610">RFC3610</a>]</span>.  The CCM mode is combined with
 the AES block encryption algorithm to define an AEAD cipher that is
commonly used in constrained devices.<a class="pilcrow" href="#section-4.2-1">¶</a></p>
<p id="section-4.2-2">The CCM mode has two parameter choices.  The first choice is M, the
 size of the authentication field.  The choice of the value for M
 involves a trade-off between message growth (from the tag) and the
 probability that an attacker can undetectably modify a message.  The
 second choice is L, the size of the length field.  This value requires
 a trade-off between the maximum message size and the size of the
 nonce.<a class="pilcrow" href="#section-4.2-2">¶</a></p>
<p id="section-4.2-3">It is unfortunate that the specification for CCM specified L and M as a count of bytes rather than a count of bits.  This leads to possible misunderstandings where AES-CCM-8 is frequently used to refer to a version of CCM mode where the size of the authentication is 64 bits and not 8 bits.  In most cryptographic algorithm specifications, these values have traditionally been specified as bit counts rather than byte counts.  This document will follow the convention of using bit counts so that it is easier to compare the different algorithms presented in this document.<a class="pilcrow" href="#section-4.2-3">¶</a></p>
<p id="section-4.2-4">We define a matrix of algorithms in this document over the values of L and M.  Constrained devices are usually operating in situations where they use short messages and want to avoid doing recipient-specific cryptographic operations.  This favors smaller values of both L and M.  Less-constrained devices will want to be able to use larger messages and are more willing to generate new keys for every operation.  This favors larger values of L and M.<a class="pilcrow" href="#section-4.2-4">¶</a></p>
<p id="section-4.2-5">The following values are used for L:<a class="pilcrow" href="#section-4.2-5">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.2-6">
          <dt id="section-4.2-6.1">16 bits (2):</dt>
          <dd id="section-4.2-6.2" style="margin-left: 1.5em">This limits messages to 2<sup>16</sup> bytes (64 KiB) in length.
   This is sufficiently long for messages in the constrained world.
   The nonce length is 13 bytes allowing for 2<sup>104</sup> possible values of
   the nonce without repeating.<a class="pilcrow" href="#section-4.2-6.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-6.3">64 bits (8):</dt>
          <dd id="section-4.2-6.4" style="margin-left: 1.5em">This limits messages to 2<sup>64</sup> bytes in length.  The
   nonce length is 7 bytes, allowing for 2<sup>56</sup> possible values of the nonce without repeating.<a class="pilcrow" href="#section-4.2-6.4">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.2-7">The following values are used for M:<a class="pilcrow" href="#section-4.2-7">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.2-8">
          <dt id="section-4.2-8.1">64 bits (8):</dt>
          <dd id="section-4.2-8.2" style="margin-left: 1.5em">This produces a 64-bit authentication tag.  This implies that
   there is a 1 in 2<sup>64</sup> chance that a modified message will
   authenticate.<a class="pilcrow" href="#section-4.2-8.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-8.3">128 bits (16):</dt>
          <dd id="section-4.2-8.4" style="margin-left: 1.5em">This produces a 128-bit authentication tag.  This implies that
   there is a 1 in 2<sup>128</sup> chance that a modified message will
   authenticate.<a class="pilcrow" href="#section-4.2-8.4">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<span id="name-algorithm-values-for-aes-cc"></span><div id="x-table-AES-CCM">
<table class="center" id="table-6">
          <caption>
<a class="selfRef" href="#table-6">Table 6</a>:
<a class="selfRef" href="#name-algorithm-values-for-aes-cc">Algorithm Values for AES-CCM</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Name</th>
              <th class="text-center" colspan="1" rowspan="1">Value</th>
              <th class="text-left" colspan="1" rowspan="1">L</th>
              <th class="text-left" colspan="1" rowspan="1">M</th>
              <th class="text-center" colspan="1" rowspan="1">Key Length</th>
              <th class="text-left" colspan="1" rowspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">AES-CCM-16-64-128</td>
              <td class="text-center" colspan="1" rowspan="1">10</td>
              <td class="text-left" colspan="1" rowspan="1">16</td>
              <td class="text-left" colspan="1" rowspan="1">64</td>
              <td class="text-center" colspan="1" rowspan="1">128</td>
              <td class="text-left" colspan="1" rowspan="1">AES-CCM mode 128-bit key, 64-bit tag, 13-byte nonce</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">AES-CCM-16-64-256</td>
              <td class="text-center" colspan="1" rowspan="1">11</td>
              <td class="text-left" colspan="1" rowspan="1">16</td>
              <td class="text-left" colspan="1" rowspan="1">64</td>
              <td class="text-center" colspan="1" rowspan="1">256</td>
              <td class="text-left" colspan="1" rowspan="1">AES-CCM mode 256-bit key, 64-bit tag, 13-byte nonce</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">AES-CCM-64-64-128</td>
              <td class="text-center" colspan="1" rowspan="1">12</td>
              <td class="text-left" colspan="1" rowspan="1">64</td>
              <td class="text-left" colspan="1" rowspan="1">64</td>
              <td class="text-center" colspan="1" rowspan="1">128</td>
              <td class="text-left" colspan="1" rowspan="1">AES-CCM mode 128-bit key, 64-bit tag, 7-byte nonce</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">AES-CCM-64-64-256</td>
              <td class="text-center" colspan="1" rowspan="1">13</td>
              <td class="text-left" colspan="1" rowspan="1">64</td>
              <td class="text-left" colspan="1" rowspan="1">64</td>
              <td class="text-center" colspan="1" rowspan="1">256</td>
              <td class="text-left" colspan="1" rowspan="1">AES-CCM mode 256-bit key, 64-bit tag, 7-byte nonce</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">AES-CCM-16-128-128</td>
              <td class="text-center" colspan="1" rowspan="1">30</td>
              <td class="text-left" colspan="1" rowspan="1">16</td>
              <td class="text-left" colspan="1" rowspan="1">128</td>
              <td class="text-center" colspan="1" rowspan="1">128</td>
              <td class="text-left" colspan="1" rowspan="1">AES-CCM mode 128-bit key, 128-bit tag, 13-byte nonce</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">AES-CCM-16-128-256</td>
              <td class="text-center" colspan="1" rowspan="1">31</td>
              <td class="text-left" colspan="1" rowspan="1">16</td>
              <td class="text-left" colspan="1" rowspan="1">128</td>
              <td class="text-center" colspan="1" rowspan="1">256</td>
              <td class="text-left" colspan="1" rowspan="1">AES-CCM mode 256-bit key, 128-bit tag, 13-byte nonce</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">AES-CCM-64-128-128</td>
              <td class="text-center" colspan="1" rowspan="1">32</td>
              <td class="text-left" colspan="1" rowspan="1">64</td>
              <td class="text-left" colspan="1" rowspan="1">128</td>
              <td class="text-center" colspan="1" rowspan="1">128</td>
              <td class="text-left" colspan="1" rowspan="1">AES-CCM mode 128-bit key, 128-bit tag, 7-byte nonce</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">AES-CCM-64-128-256</td>
              <td class="text-center" colspan="1" rowspan="1">33</td>
              <td class="text-left" colspan="1" rowspan="1">64</td>
              <td class="text-left" colspan="1" rowspan="1">128</td>
              <td class="text-center" colspan="1" rowspan="1">256</td>
              <td class="text-left" colspan="1" rowspan="1">AES-CCM mode 256-bit key, 128-bit tag, 7-byte nonce</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-4.2-10">Keys may be obtained from either a key structure or a recipient
 structure.  Implementations that are encrypting or decrypting
 <span class="bcp14">MUST</span> validate that the key type, key length, and
 algorithm are correct and appropriate for the entities involved.<a class="pilcrow" href="#section-4.2-10">¶</a></p>
<p id="section-4.2-11">When using a COSE key for this algorithm, the following checks are made:<a class="pilcrow" href="#section-4.2-11">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-12.1">The "kty" field <span class="bcp14">MUST</span> be present, and it <span class="bcp14">MUST</span> be "Symmetric".<a class="pilcrow" href="#section-4.2-12.1">¶</a>
</li>
          <li class="normal" id="section-4.2-12.2">If the "alg" field is present, it <span class="bcp14">MUST</span> match the AES-CCM algorithm being used.<a class="pilcrow" href="#section-4.2-12.2">¶</a>
</li>
          <li class="normal" id="section-4.2-12.3">If the "key_ops" field is present, it <span class="bcp14">MUST</span> include "encrypt" or "wrap key" when encrypting.<a class="pilcrow" href="#section-4.2-12.3">¶</a>
</li>
          <li class="normal" id="section-4.2-12.4">If the "key_ops" field is present, it <span class="bcp14">MUST</span> include "decrypt" or "unwrap key"  when decrypting.<a class="pilcrow" href="#section-4.2-12.4">¶</a>
</li>
        </ul>
<section id="section-4.2.1">
          <h4 id="name-security-considerations-for-aes">
<a class="section-number selfRef" href="#section-4.2.1">4.2.1. </a><a class="section-name selfRef" href="#name-security-considerations-for-aes">Security Considerations for AES-CCM</a>
          </h4>
<p id="section-4.2.1-1">When using AES-CCM, the following restrictions <span class="bcp14">MUST</span> be enforced:<a class="pilcrow" href="#section-4.2.1-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.1-2.1">The key and nonce pair <span class="bcp14">MUST</span> be unique for every message encrypted. Note that the value of L influences the number of unique nonces.<a class="pilcrow" href="#section-4.2.1-2.1">¶</a>
</li>
            <li class="normal" id="section-4.2.1-2.2">The total number of times the AES block cipher is used
     <span class="bcp14">MUST NOT</span> exceed 2<sup>61</sup> operations.  This
     limit is the sum of times the block cipher is used in
     computing the MAC value and performing stream encryption
     operations.  An explicit check is required only in environments
     where it is expected that this limit might be exceeded.<a class="pilcrow" href="#section-4.2.1-2.2">¶</a>
</li>
            <li class="normal" id="section-4.2.1-2.3">
              <span>[<a class="xref" href="#RFC9147">RFC9147</a>]</span> contains an analysis on the
       use of AES-CCM for its environment.
              Based on that recommendation, one should restrict the number of
       messages encrypted to 2<sup>23</sup>.<a class="pilcrow" href="#section-4.2.1-2.3">¶</a>
</li>
            <li class="normal" id="section-4.2.1-2.4">
              In addition to the number of messages successfully decrypted, the number of failed decryptions needs to be tracked as well.
              Following the recommendation in DTLS (<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9147#section-4.5.3">Section 4.5.3</a> of [<a class="xref" href="#RFC9147">RFC9147</a>]</span>),
the number of failed message decryptions should be limited to 2<sup>23.5</sup>.
              If one is using the 64-bit tag, then the limits are significantly smaller if one wants to keep the same integrity limits.
              A protocol recommending this needs to analyze what level of integrity is acceptable for the smaller tag size.
              It may be that, to keep the desired level of integrity, one needs to rekey as often as every 2<sup>7</sup> messages.<a class="pilcrow" href="#section-4.2.1-2.4">¶</a>
</li>
          </ul>
<p id="section-4.2.1-3"><span>[<a class="xref" href="#RFC3610">RFC3610</a>]</span> additionally calls out one other
   consideration of note.  It is possible to do a precomputation
   attack against the algorithm in cases where portions of the
   plaintext are  highly predictable.  This reduces the security of the
   key size by half.  Ways to deal with this attack include adding a
   random portion to the nonce value and/or increasing the key size
   used.  Using a portion of the nonce for a random value will decrease
   the number of messages that a single key can be used for.
   Increasing the key size may require more resources in the
   constrained device.  See Sections <a class="relref" href="https://www.rfc-editor.org/rfc/rfc3610#section-5">5</a> and <a class="relref" href="https://www.rfc-editor.org/rfc/rfc3610#section-10">10</a> of <span>[<a class="xref" href="#RFC3610">RFC3610</a>]</span> for more
   information.<a class="pilcrow" href="#section-4.2.1-3">¶</a></p>
</section>
</section>
<section id="section-4.3">
        <h3 id="name-chacha20-and-poly1305">
<a class="section-number selfRef" href="#section-4.3">4.3. </a><a class="section-name selfRef" href="#name-chacha20-and-poly1305">ChaCha20 and Poly1305</a>
        </h3>
<p id="section-4.3-1">ChaCha20 and Poly1305 combined together is an AEAD mode that is defined in <span>[<a class="xref" href="#RFC8439">RFC8439</a>]</span>.  This is an algorithm defined using a cipher that is not AES and thus would not suffer from any future weaknesses found in AES.  These cryptographic functions are designed to be fast in software-only implementations.<a class="pilcrow" href="#section-4.3-1">¶</a></p>
<p id="section-4.3-2">The ChaCha20/Poly1305 AEAD construction defined in <span>[<a class="xref" href="#RFC8439">RFC8439</a>]</span> has no parameterization.  It takes as inputs a
 256-bit key and a 96-bit nonce, as well as the plaintext and
 additional data, and produces the ciphertext as an output.  We define
 one algorithm identifier for this algorithm in <a class="xref" href="#x-table-CHACHA">Table 7</a>.<a class="pilcrow" href="#section-4.3-2">¶</a></p>
<span id="name-algorithm-value-for-chacha2"></span><div id="x-table-CHACHA">
<table class="center" id="table-7">
          <caption>
<a class="selfRef" href="#table-7">Table 7</a>:
<a class="selfRef" href="#name-algorithm-value-for-chacha2">Algorithm Value for ChaCha20/Poly1305</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Name</th>
              <th class="text-center" colspan="1" rowspan="1">Value</th>
              <th class="text-left" colspan="1" rowspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">ChaCha20/Poly1305</td>
              <td class="text-center" colspan="1" rowspan="1">24</td>
              <td class="text-left" colspan="1" rowspan="1">ChaCha20/Poly1305 w/ 256-bit key, 128-bit tag</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-4.3-4">Keys may be obtained from either a key structure or a recipient
 structure.  Implementations that are encrypting or decrypting
 <span class="bcp14">MUST</span> validate that the key type, key length, and
 algorithm are correct and appropriate for the entities involved.<a class="pilcrow" href="#section-4.3-4">¶</a></p>
<p id="section-4.3-5">When using a COSE key for this algorithm, the following checks are made:<a class="pilcrow" href="#section-4.3-5">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3-6.1">The "kty" field <span class="bcp14">MUST</span> be present, and it <span class="bcp14">MUST</span> be "Symmetric".<a class="pilcrow" href="#section-4.3-6.1">¶</a>
</li>
          <li class="normal" id="section-4.3-6.2">If the "alg" field is present, it <span class="bcp14">MUST</span> match the ChaCha20/Poly1305 algorithm being used.<a class="pilcrow" href="#section-4.3-6.2">¶</a>
</li>
          <li class="normal" id="section-4.3-6.3">If the "key_ops" field is present, it <span class="bcp14">MUST</span> include "encrypt" or "wrap key" when encrypting.<a class="pilcrow" href="#section-4.3-6.3">¶</a>
</li>
          <li class="normal" id="section-4.3-6.4">If the "key_ops" field is present, it <span class="bcp14">MUST</span> include "decrypt" or "unwrap key"  when decrypting.<a class="pilcrow" href="#section-4.3-6.4">¶</a>
</li>
        </ul>
<section id="section-4.3.1">
          <h4 id="name-security-considerations-for-c">
<a class="section-number selfRef" href="#section-4.3.1">4.3.1. </a><a class="section-name selfRef" href="#name-security-considerations-for-c">Security Considerations for ChaCha20/Poly1305</a>
          </h4>
<p id="section-4.3.1-1">The key and nonce values <span class="bcp14">MUST</span> be a unique pair for every invocation of the algorithm.  Nonce counters are considered to be an acceptable way of ensuring that they are unique.<a class="pilcrow" href="#section-4.3.1-1">¶</a></p>
<p id="section-4.3.1-2">A more recent analysis in <span>[<a class="xref" href="#ROBUST">ROBUST</a>]</span> indicates that
   the number of failed decryptions needs to be taken into account as
   part of determining when a key rollover is to be done. Following the
   recommendation in DTLS (<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9147#section-4.5.3">Section 4.5.3</a> of [<a class="xref" href="#RFC9147">RFC9147</a>]</span>), the number of failed message decryptions
   should be limited to 2<sup>36</sup>.<a class="pilcrow" href="#section-4.3.1-2">¶</a></p>
<p id="section-4.3.1-3">
              <span>[<a class="xref" href="#RFC8446">RFC8446</a>]</span> notes that the (64-bit) record sequence
number would wrap before the safety limit is reached for ChaCha20/Poly1305.
COSE implementations should not send more than 2<sup>64</sup> messages
encrypted using a single ChaCha20/Poly1305 key.<a class="pilcrow" href="#section-4.3.1-3">¶</a></p>
</section>
</section>
</section>
<section id="section-5">
      <h2 id="name-key-derivation-functions-kd">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-key-derivation-functions-kd">Key Derivation Functions (KDFs)</a>
      </h2>
<p id="section-5-1">
        <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9052#section-8.4">Section 8.4</a> of [<a class="xref" href="#RFC9052">RFC9052</a>]</span> contains a generic description
 of key derivation functions.
        This document defines a single context structure and a single KDF. 
        These elements are used for all of the recipient algorithms defined in
 this document that require a KDF process. 
        These algorithms are defined in Sections <a class="xref" href="#direct-kdf">6.1.2</a>, <a class="xref" href="#ECDH">6.3.1</a>, and <a class="xref" href="#ECDH-wrap">6.4.1</a>.<a class="pilcrow" href="#section-5-1">¶</a></p>
<div id="HKDF-section">
<section id="section-5.1">
        <h3 id="name-hmac-based-extract-and-expa">
<a class="section-number selfRef" href="#section-5.1">5.1. </a><a class="section-name selfRef" href="#name-hmac-based-extract-and-expa">HMAC-Based Extract-and-Expand Key Derivation Function (HKDF)</a>
        </h3>
<p id="section-5.1-1">The HKDF key derivation algorithm is defined in <span>[<a class="xref" href="#RFC5869">RFC5869</a>]</span> and <span>[<a class="xref" href="#HKDF">HKDF</a>]</span>.<a class="pilcrow" href="#section-5.1-1">¶</a></p>
<p id="section-5.1-2">The HKDF algorithm takes these inputs:<a class="pilcrow" href="#section-5.1-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.1-3">
          <dt id="section-5.1-3.1">secret:</dt>
          <dd id="section-5.1-3.2" style="margin-left: 1.5em"> A shared value that is secret.  Secrets may be
   either previously shared or derived from operations like a
   Diffie-Hellman (DH) key agreement.<a class="pilcrow" href="#section-5.1-3.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-3.3">salt:</dt>
          <dd id="section-5.1-3.4" style="margin-left: 1.5em"> An optional value that is used to change the
   generation process.  The salt value can be either public or private.
   If the salt is public and carried in the message, then the "salt"
   algorithm header parameter defined in <a class="xref" href="#HKDF_Alg_Params">Table 9</a> is used.  While <span>[<a class="xref" href="#RFC5869">RFC5869</a>]</span>
   suggests that the length of the salt be the same as the length of
   the underlying hash value, any positive salt length will improve the
   security, as different key values will be generated.  This parameter
   is protected by being included in the key computation and does not
   need to be separately authenticated.  The salt value does not need
   to be unique for every message sent.<a class="pilcrow" href="#section-5.1-3.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-3.5">length:</dt>
          <dd id="section-5.1-3.6" style="margin-left: 1.5em">The number of bytes of output that need to be generated.<a class="pilcrow" href="#section-5.1-3.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-3.7">context information:</dt>
          <dd id="section-5.1-3.8" style="margin-left: 1.5em">Information that describes the
   context in which the resulting value will be used.  Making this
   information specific to the context in which the material is going
   to be used ensures that the resulting material will always be tied
   to that usage.  The context structure defined in <a class="xref" href="#context">Section 5.2</a> is used by the KDFs in this document.<a class="pilcrow" href="#section-5.1-3.8">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-3.9">PRF:</dt>
          <dd id="section-5.1-3.10" style="margin-left: 1.5em"> The underlying pseudorandom function to be used in
   the HKDF algorithm.  The PRF is encoded into the HKDF algorithm
   selection.<a class="pilcrow" href="#section-5.1-3.10">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-5.1-4">HKDF is defined to use HMAC as the underlying PRF.  However, it is
 possible to use other functions in the same construct to provide a
 different KDF that is more appropriate in the constrained world.
 Specifically, one can use AES-CBC-MAC as the PRF for the expand step,
 but not for the extract step.  When using a good random shared secret
 of the correct length, the extract step can be skipped.  For the AES
 algorithm versions, the extract step is always skipped.<a class="pilcrow" href="#section-5.1-4">¶</a></p>
<p id="section-5.1-5">The extract step cannot be skipped if the secret is not uniformly
 random -- for example, if it is the result of an ECDH key agreement
 step. This implies that the AES HKDF version cannot be used with
 ECDH. If the extract step is skipped, the "salt" value is not used as
 part of the HKDF functionality.<a class="pilcrow" href="#section-5.1-5">¶</a></p>
<p id="section-5.1-6">The algorithms defined in this document are found in <a class="xref" href="#x-table-hkdf">Table 8</a>.<a class="pilcrow" href="#section-5.1-6">¶</a></p>
<span id="name-hkdf-algorithms"></span><div id="x-table-hkdf">
<table class="center" id="table-8">
          <caption>
<a class="selfRef" href="#table-8">Table 8</a>:
<a class="selfRef" href="#name-hkdf-algorithms">HKDF Algorithms</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Name</th>
              <th class="text-left" colspan="1" rowspan="1">PRF</th>
              <th class="text-left" colspan="1" rowspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">HKDF SHA-256</td>
              <td class="text-left" colspan="1" rowspan="1">HMAC with SHA-256</td>
              <td class="text-left" colspan="1" rowspan="1">HKDF using HMAC SHA-256 as the PRF</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">HKDF SHA-512</td>
              <td class="text-left" colspan="1" rowspan="1">HMAC with SHA-512</td>
              <td class="text-left" colspan="1" rowspan="1">HKDF using HMAC SHA-512 as the PRF</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">HKDF AES-MAC-128</td>
              <td class="text-left" colspan="1" rowspan="1">AES-CBC-MAC-128</td>
              <td class="text-left" colspan="1" rowspan="1">HKDF using AES-MAC as the PRF w/ 128-bit key</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">HKDF AES-MAC-256</td>
              <td class="text-left" colspan="1" rowspan="1">AES-CBC-MAC-256</td>
              <td class="text-left" colspan="1" rowspan="1">HKDF using AES-MAC as the PRF w/ 256-bit key</td>
            </tr>
          </tbody>
        </table>
</div>
<span id="name-hkdf-algorithm-parameters"></span><div id="HKDF_Alg_Params">
<table class="center" id="table-9">
          <caption>
<a class="selfRef" href="#table-9">Table 9</a>:
<a class="selfRef" href="#name-hkdf-algorithm-parameters">HKDF Algorithm Parameters</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Name</th>
              <th class="text-left" colspan="1" rowspan="1">Label</th>
              <th class="text-left" colspan="1" rowspan="1">Type</th>
              <th class="text-left" colspan="1" rowspan="1">Algorithm</th>
              <th class="text-left" colspan="1" rowspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">salt</td>
              <td class="text-left" colspan="1" rowspan="1">-20</td>
              <td class="text-left" colspan="1" rowspan="1">bstr</td>
              <td class="text-left" colspan="1" rowspan="1">direct+HKDF-SHA-256, direct+HKDF-SHA-512, direct+HKDF-AES-128, direct+HKDF-AES-256, ECDH-ES+HKDF-256, ECDH-ES+HKDF-512, ECDH-SS+HKDF-256, ECDH-SS+HKDF-512, ECDH-ES+A128KW, ECDH-ES+A192KW, ECDH-ES+A256KW, ECDH-SS+A128KW, ECDH-SS+A192KW, ECDH-SS+A256KW </td>
              <td class="text-left" colspan="1" rowspan="1">Random salt</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="context">
<section id="section-5.2">
        <h3 id="name-context-information-structu">
<a class="section-number selfRef" href="#section-5.2">5.2. </a><a class="section-name selfRef" href="#name-context-information-structu">Context Information Structure</a>
        </h3>
<p id="section-5.2-1">The context information structure is used to ensure that the
 derived keying material is "bound" to the context of the transaction.
 The context information structure used here is based on that defined
 in <span>[<a class="xref" href="#SP800-56A">SP800-56A</a>]</span>.  By using CBOR for the encoding of the
 context information structure, we automatically get the same type and
 length separation of fields that is obtained by the use of ASN.1.
 This means that there is no need to encode the lengths for the base
 elements, as it is done by the encoding used in JSON Object Signing
 and Encryption (JOSE) (<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc7518#section-4.6.2">Section 4.6.2</a> of [<a class="xref" href="#RFC7518">RFC7518</a>]</span>).<a class="pilcrow" href="#section-5.2-1">¶</a></p>
<p id="section-5.2-2">The context information structure refers to PartyU and PartyV as
 the two parties that are doing the key derivation.  Unless the
 application protocol defines differently, we assign PartyU to the
 entity that is creating the message and PartyV to the entity that is
 receiving the message.  By defining this association, different keys
 will be derived for each direction, as the context information is
 different in each direction.<a class="pilcrow" href="#section-5.2-2">¶</a></p>
<p id="section-5.2-3">The context structure is built from information that is known to both entities.  This information can be obtained from a variety of sources:<a class="pilcrow" href="#section-5.2-3">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2-4.1">Fields can be defined by the application.  This is commonly used to assign fixed names to parties, but it can be used for other items such as nonces.<a class="pilcrow" href="#section-5.2-4.1">¶</a>
</li>
          <li class="normal" id="section-5.2-4.2">Fields can be defined by usage of the output.  Examples of this are the algorithm and key size that are being generated.<a class="pilcrow" href="#section-5.2-4.2">¶</a>
</li>
          <li class="normal" id="section-5.2-4.3">Fields can be defined by parameters from the message.  We define
   a set of header parameters in <a class="xref" href="#KDF_Context_Alg_Params">Table 10</a> that can be used to carry the
   values associated with the context structure.  Examples of this are
   identities and nonce values.  These header parameters are designed
   to be placed in the unprotected bucket of the recipient structure;
   they do not need to be in the protected bucket, since they are already
   included in the cryptographic computation by virtue of being
   included in the context structure.<a class="pilcrow" href="#section-5.2-4.3">¶</a>
</li>
        </ul>
<span id="name-context-algorithm-parameter"></span><div id="KDF_Context_Alg_Params">
<table class="center" id="table-10">
          <caption>
<a class="selfRef" href="#table-10">Table 10</a>:
<a class="selfRef" href="#name-context-algorithm-parameter">Context Algorithm Parameters</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Name</th>
              <th class="text-left" colspan="1" rowspan="1">Label</th>
              <th class="text-left" colspan="1" rowspan="1">Type</th>
              <th class="text-left" colspan="1" rowspan="1">Algorithm</th>
              <th class="text-left" colspan="1" rowspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">PartyU identity</td>
              <td class="text-left" colspan="1" rowspan="1">-21</td>
              <td class="text-left" colspan="1" rowspan="1">bstr</td>
              <td class="text-left" colspan="1" rowspan="1">direct+HKDF-SHA-256, direct+HKDF-SHA-512, direct+HKDF-AES-128, direct+HKDF-AES-256, ECDH-ES+HKDF-256, ECDH-ES+HKDF-512, ECDH-SS+HKDF-256, ECDH-SS+HKDF-512, ECDH-ES+A128KW, ECDH-ES+A192KW, ECDH-ES+A256KW, ECDH-SS+A128KW, ECDH-SS+A192KW, ECDH-SS+A256KW </td>
              <td class="text-left" colspan="1" rowspan="1">PartyU identity information</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">PartyU nonce</td>
              <td class="text-left" colspan="1" rowspan="1">-22</td>
              <td class="text-left" colspan="1" rowspan="1">bstr / int</td>
              <td class="text-left" colspan="1" rowspan="1">direct+HKDF-SHA-256, direct+HKDF-SHA-512, direct+HKDF-AES-128, direct+HKDF-AES-256, ECDH-ES+HKDF-256, ECDH-ES+HKDF-512, ECDH-SS+HKDF-256, ECDH-SS+HKDF-512, ECDH-ES+A128KW, ECDH-ES+A192KW, ECDH-ES+A256KW, ECDH-SS+A128KW, ECDH-SS+A192KW, ECDH-SS+A256KW </td>
              <td class="text-left" colspan="1" rowspan="1">PartyU provided nonce</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">PartyU other</td>
              <td class="text-left" colspan="1" rowspan="1">-23</td>
              <td class="text-left" colspan="1" rowspan="1">bstr</td>
              <td class="text-left" colspan="1" rowspan="1">direct+HKDF-SHA-256, direct+HKDF-SHA-512, direct+HKDF-AES-128, direct+HKDF-AES-256, ECDH-ES+HKDF-256, ECDH-ES+HKDF-512, ECDH-SS+HKDF-256, ECDH-SS+HKDF-512, ECDH-ES+A128KW, ECDH-ES+A192KW, ECDH-ES+A256KW, ECDH-SS+A128KW, ECDH-SS+A192KW, ECDH-SS+A256KW </td>
              <td class="text-left" colspan="1" rowspan="1">PartyU other provided information</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">PartyV identity</td>
              <td class="text-left" colspan="1" rowspan="1">-24</td>
              <td class="text-left" colspan="1" rowspan="1">bstr</td>
              <td class="text-left" colspan="1" rowspan="1">direct+HKDF-SHA-256, direct+HKDF-SHA-512, direct+HKDF-AES-128, direct+HKDF-AES-256, ECDH-ES+HKDF-256, ECDH-ES+HKDF-512, ECDH-SS+HKDF-256, ECDH-SS+HKDF-512, ECDH-ES+A128KW, ECDH-ES+A192KW, ECDH-ES+A256KW, ECDH-SS+A128KW, ECDH-SS+A192KW, ECDH-SS+A256KW </td>
              <td class="text-left" colspan="1" rowspan="1">PartyV identity information</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">PartyV nonce</td>
              <td class="text-left" colspan="1" rowspan="1">-25</td>
              <td class="text-left" colspan="1" rowspan="1">bstr / int</td>
              <td class="text-left" colspan="1" rowspan="1">direct+HKDF-SHA-256, direct+HKDF-SHA-512, direct+HKDF-AES-128, direct+HKDF-AES-256, ECDH-ES+HKDF-256, ECDH-ES+HKDF-512, ECDH-SS+HKDF-256, ECDH-SS+HKDF-512, ECDH-ES+A128KW, ECDH-ES+A192KW, ECDH-ES+A256KW, ECDH-SS+A128KW, ECDH-SS+A192KW, ECDH-SS+A256KW </td>
              <td class="text-left" colspan="1" rowspan="1">PartyV provided nonce</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">PartyV other</td>
              <td class="text-left" colspan="1" rowspan="1">-26</td>
              <td class="text-left" colspan="1" rowspan="1">bstr</td>
              <td class="text-left" colspan="1" rowspan="1">direct+HKDF-SHA-256, direct+HKDF-SHA-512, direct+HKDF-AES-128, direct+HKDF-AES-256, ECDH-ES+HKDF-256, ECDH-ES+HKDF-512, ECDH-SS+HKDF-256, ECDH-SS+HKDF-512, ECDH-ES+A128KW, ECDH-ES+A192KW, ECDH-ES+A256KW, ECDH-SS+A128KW, ECDH-SS+A192KW, ECDH-SS+A256KW </td>
              <td class="text-left" colspan="1" rowspan="1">PartyV other provided information</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-5.2-6">We define a CBOR object to hold the context information.  This object is referred to as COSE_KDF_Context.  The object is based on a CBOR array type.  The fields in the array are:<a class="pilcrow" href="#section-5.2-6">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.2-7">
          <dt id="section-5.2-7.1">AlgorithmID:</dt>
          <dd id="section-5.2-7.2" style="margin-left: 1.5em">
            This field indicates the algorithm for which the key material will be used.
            This normally is either a key wrap algorithm identifier or a
     content encryption algorithm identifier.
            The values are from the "COSE Algorithms" registry.
            This field is required to be present.
            The field exists in the context information so that a different key is generated for each algorithm even if all of the other context information is the same.
            In practice, this means if algorithm A is broken and thus finding the key is relatively easy, the key derived for algorithm B will not be the same as the key derived for algorithm A.<a class="pilcrow" href="#section-5.2-7.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.2-7.3">PartyUInfo:</dt>
          <dd id="section-5.2-7.4" style="margin-left: 1.5em">
            <p id="section-5.2-7.4.1">This field holds information about PartyU.  The PartyUInfo is
     encoded as a CBOR array.  The elements of PartyUInfo are encoded
     in the order presented below.  The elements of the PartyUInfo
     array are:<a class="pilcrow" href="#section-5.2-7.4.1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.2-7.4.2">
              <dt id="section-5.2-7.4.2.1">identity:</dt>
              <dd id="section-5.2-7.4.2.2" style="margin-left: 1.5em">
                <p id="section-5.2-7.4.2.2.1">This contains the identity information for PartyU.  The
 identities can be assigned in one of two manners.  First, a
 protocol can assign identities based on roles.  For example,
 the roles of "client" and "server" may be assigned to
 different entities in the protocol.  Each entity would then
 use the correct label for the data it sends or receives.  The
 second way for a protocol to assign identities is to use a
 name based on a naming system (i.e., DNS or X.509 names).<a class="pilcrow" href="#section-5.2-7.4.2.2.1">¶</a></p>
<p id="section-5.2-7.4.2.2.2"> We define an algorithm parameter, "PartyU identity", that
 can be used to carry identity information in the message.
 However, identity information is often known as part of the
 protocol and can thus be inferred rather than made explicit.
 If identity information is carried in the message,
 applications <span class="bcp14">SHOULD</span> have a way of validating
 the supplied identity information.  The identity information
 does not need to be specified and is set to nil in that case.<a class="pilcrow" href="#section-5.2-7.4.2.2.2">¶</a></p>
</dd>
              <dd class="break"></dd>
<dt id="section-5.2-7.4.2.3">nonce:</dt>
              <dd id="section-5.2-7.4.2.4" style="margin-left: 1.5em">
                <p id="section-5.2-7.4.2.4.1">This contains a nonce value.  The nonce can be either
 implicit from the protocol or carried as a value in the
 unprotected header bucket.<a class="pilcrow" href="#section-5.2-7.4.2.4.1">¶</a></p>
<p id="section-5.2-7.4.2.4.2"> We define an algorithm parameter, "PartyU nonce", that can be used to carry this value in the message; however, the nonce value could be determined by the application and its
value obtained in a different manner.<a class="pilcrow" href="#section-5.2-7.4.2.4.2">¶</a></p>
<p id="section-5.2-7.4.2.4.3"> This option does not need to be specified; if not
 needed, it is set to nil.<a class="pilcrow" href="#section-5.2-7.4.2.4.3">¶</a></p>
</dd>
              <dd class="break"></dd>
<dt id="section-5.2-7.4.2.5">other:</dt>
              <dd id="section-5.2-7.4.2.6" style="margin-left: 1.5em">This contains other information that is defined by the protocol. This option does not need to be specified; if not needed, it is set to nil.<a class="pilcrow" href="#section-5.2-7.4.2.6">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</dd>
          <dd class="break"></dd>
<dt id="section-5.2-7.5">PartyVInfo:</dt>
          <dd id="section-5.2-7.6" style="margin-left: 1.5em">This field holds information about PartyV.  The content of the structure is the same as for the PartyUInfo but for PartyV.<a class="pilcrow" href="#section-5.2-7.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.2-7.7">SuppPubInfo:</dt>
          <dd id="section-5.2-7.8" style="margin-left: 1.5em">
            <p id="section-5.2-7.8.1">This field contains public information that is mutually known to both parties, and is encoded as a CBOR array.<a class="pilcrow" href="#section-5.2-7.8.1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.2-7.8.2">
              <dt id="section-5.2-7.8.2.1">keyDataLength:</dt>
              <dd id="section-5.2-7.8.2.2" style="margin-left: 1.5em">This is set to the number of bits of the desired output
       value.  This practice means if algorithm A can use two different
       key lengths, the key derived for the longer key size will not
       contain the key for the shorter key size as a prefix.<a class="pilcrow" href="#section-5.2-7.8.2.2">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-5.2-7.8.2.3">protected:</dt>
              <dd id="section-5.2-7.8.2.4" style="margin-left: 1.5em">This field contains the protected parameter field.  If there
       are no elements in the "protected" field, then use a zero-length
       bstr.<a class="pilcrow" href="#section-5.2-7.8.2.4">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-5.2-7.8.2.5">other:</dt>
              <dd id="section-5.2-7.8.2.6" style="margin-left: 1.5em">This field is for free-form data defined by the application.
       For example, an application could define two different
       byte strings to be placed here to generate different keys for a
       data stream versus a control stream.  This field is optional and
       will only be present if the application defines a structure for
       this information.  Applications that define this
       <span class="bcp14">SHOULD</span> use CBOR to encode the data so that types
       and lengths are correctly included.<a class="pilcrow" href="#section-5.2-7.8.2.6">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</dd>
          <dd class="break"></dd>
<dt id="section-5.2-7.9">SuppPrivInfo:</dt>
          <dd id="section-5.2-7.10" style="margin-left: 1.5em">This field contains private information that is mutually known private information.  An example of this information would be a pre-existing shared secret.  (This could, for example, be used in combination with an ECDH key agreement to provide a secondary proof of identity.) The field is optional and will only be present if the application defines a structure for this information.  Applications that define this <span class="bcp14">SHOULD</span> use CBOR to encode the data so that types and lengths are correctly included.<a class="pilcrow" href="#section-5.2-7.10">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-5.2-8">The following CDDL fragment corresponds to the text above.<a class="pilcrow" href="#section-5.2-8">¶</a></p>
<div id="section-5.2-9">
<pre class="lang-cddl sourcecode">PartyInfo = (
    identity : bstr / nil,
    nonce : bstr / int / nil,
    other : bstr / nil
)

COSE_KDF_Context = [
    AlgorithmID : int / tstr,
    PartyUInfo : [ PartyInfo ],
    PartyVInfo : [ PartyInfo ],
    SuppPubInfo : [
        keyDataLength : uint,
        protected : empty_or_serialized_map,
        ? other : bstr
    ],
    ? SuppPrivInfo : bstr
]
</pre><a class="pilcrow" href="#section-5.2-9">¶</a>
</div>
</section>
</div>
</section>
<div id="key-management-algs">
<section id="section-6">
      <h2 id="name-content-key-distribution-me">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-content-key-distribution-me">Content Key Distribution Methods</a>
      </h2>
<p id="section-6-1">

        <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9052#section-8.5">Section 8.5</a> of [<a class="xref" href="#RFC9052">RFC9052</a>]</span> contains a generic description of content key distribution methods.
        This document defines the identifiers and usage for a number of content key distribution methods.<a class="pilcrow" href="#section-6-1">¶</a></p>
<section id="section-6.1">
        <h3 id="name-direct-encryption">
<a class="section-number selfRef" href="#section-6.1">6.1. </a><a class="section-name selfRef" href="#name-direct-encryption">Direct Encryption</a>
        </h3>
<p id="section-6.1-1">
          A direct encryption algorithm is defined in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9052#section-8.5.1">Section 8.5.1</a> of [<a class="xref" href="#RFC9052">RFC9052</a>]</span>.
          Information about how to fill in the COSE_Recipient structure is detailed there.<a class="pilcrow" href="#section-6.1-1">¶</a></p>
<section id="section-6.1.1">
          <h4 id="name-direct-key">
<a class="section-number selfRef" href="#section-6.1.1">6.1.1. </a><a class="section-name selfRef" href="#name-direct-key">Direct Key</a>
          </h4>
<p id="section-6.1.1-1">
          This recipient algorithm is the simplest; the identified key is directly used as the key for the next layer down in the message. 
          There are no algorithm parameters defined for this algorithm. 
          The algorithm identifier value is assigned  in <a class="xref" href="#x-table-direct">Table 11</a>.<a class="pilcrow" href="#section-6.1.1-1">¶</a></p>
<p id="section-6.1.1-2">
          When this algorithm is used, the "protected" field
   <span class="bcp14">MUST</span> be zero length.
          The key type <span class="bcp14">MUST</span> be "Symmetric".<a class="pilcrow" href="#section-6.1.1-2">¶</a></p>
<span id="name-direct-key-2"></span><div id="x-table-direct">
<table class="center" id="table-11">
            <caption>
<a class="selfRef" href="#table-11">Table 11</a>:
<a class="selfRef" href="#name-direct-key-2">Direct Key</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" colspan="1" rowspan="1">Name</th>
                <th class="text-center" colspan="1" rowspan="1">Value</th>
                <th class="text-left" colspan="1" rowspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">direct</td>
                <td class="text-center" colspan="1" rowspan="1">-6</td>
                <td class="text-left" colspan="1" rowspan="1">Direct use of content encryption key (CEK)</td>
              </tr>
            </tbody>
          </table>
</div>
<section id="section-6.1.1.1">
            <h5 id="name-security-considerations-for-d">
<a class="section-number selfRef" href="#section-6.1.1.1">6.1.1.1. </a><a class="section-name selfRef" href="#name-security-considerations-for-d">Security Considerations for Direct Key</a>
            </h5>
<p id="section-6.1.1.1-1">This recipient algorithm has several potential problems that need to be considered:<a class="pilcrow" href="#section-6.1.1.1-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.1.1-2.1">These keys need to have some method of being regularly updated over time.  All of the content encryption algorithms specified in this document have limits on how many times a key can be used without significant loss of security.<a class="pilcrow" href="#section-6.1.1.1-2.1">¶</a>
</li>
              <li class="normal" id="section-6.1.1.1-2.2">These keys need to be dedicated to a single algorithm.  There have been a number of attacks developed over time when a single key is used for multiple different algorithms.  One example of this is the use of a single key for both the CBC encryption mode and the CBC-MAC authentication mode.<a class="pilcrow" href="#section-6.1.1.1-2.2">¶</a>
</li>
              <li class="normal" id="section-6.1.1.1-2.3">Breaking one message means all messages are broken.  If an adversary succeeds in determining the key for a single message, then the key for all messages is also determined.<a class="pilcrow" href="#section-6.1.1.1-2.3">¶</a>
</li>
            </ul>
</section>
</section>
<div id="direct-kdf">
<section id="section-6.1.2">
          <h4 id="name-direct-key-with-kdf">
<a class="section-number selfRef" href="#section-6.1.2">6.1.2. </a><a class="section-name selfRef" href="#name-direct-key-with-kdf">Direct Key with KDF</a>
          </h4>
<p id="section-6.1.2-1">These recipient algorithms take a common shared secret between
   the two parties and apply the HKDF function (<a class="xref" href="#HKDF-section">Section 5.1</a>), using the context structure defined in
   <a class="xref" href="#context">Section 5.2</a> to transform the shared secret into the
   CEK.  The "protected" field can be of nonzero length.  Either
          the "salt" parameter for HKDF (<a class="xref" href="#HKDF_Alg_Params">Table 9</a>) or the "PartyU nonce" parameter
          for the context structure (<a class="xref" href="#KDF_Context_Alg_Params">Table 10</a>) <span class="bcp14">MUST</span> be
          present (both can be present if desired). The value in the
          "salt"/"nonce" parameter
   can be generated either randomly or deterministically.  The
   requirement is that it be a unique value for the shared secret in
   question.<a class="pilcrow" href="#section-6.1.2-1">¶</a></p>
<p id="section-6.1.2-2">If the salt/nonce value is generated randomly, then it is suggested that the length of the random value be the same length as the output of the hash function underlying HKDF.  While there is no way to guarantee that it will be unique, there is a high probability that it will be unique.  If the salt/nonce value is generated deterministically, it can be guaranteed to be unique, and thus there is no length requirement.<a class="pilcrow" href="#section-6.1.2-2">¶</a></p>
<p id="section-6.1.2-3">A new IV must be used for each message if the same key is used.  The IV can be modified in a predictable manner, a random manner, or an unpredictable manner (e.g., encrypting a counter).<a class="pilcrow" href="#section-6.1.2-3">¶</a></p>
<p id="section-6.1.2-4">The IV used for a key can also be generated using the same HKDF
   functionality used to generate the key.  If HKDF is used for
   generating the IV, the algorithm identifier is set to 34
   ("IV-GENERATION").<a class="pilcrow" href="#section-6.1.2-4">¶</a></p>
<p id="section-6.1.2-5">The set of algorithms defined in this document can be found in <a class="xref" href="#x-table-direct-kdf">Table 12</a>.<a class="pilcrow" href="#section-6.1.2-5">¶</a></p>
<span id="name-direct-key-with-kdf-2"></span><div id="x-table-direct-kdf">
<table class="center" id="table-12">
            <caption>
<a class="selfRef" href="#table-12">Table 12</a>:
<a class="selfRef" href="#name-direct-key-with-kdf-2">Direct Key with KDF</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" colspan="1" rowspan="1">Name</th>
                <th class="text-center" colspan="1" rowspan="1">Value</th>
                <th class="text-left" colspan="1" rowspan="1">KDF</th>
                <th class="text-left" colspan="1" rowspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">direct+HKDF-SHA-256</td>
                <td class="text-center" colspan="1" rowspan="1">-10</td>
                <td class="text-left" colspan="1" rowspan="1">HKDF SHA-256</td>
                <td class="text-left" colspan="1" rowspan="1">Shared secret w/ HKDF and SHA-256</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">direct+HKDF-SHA-512</td>
                <td class="text-center" colspan="1" rowspan="1">-11</td>
                <td class="text-left" colspan="1" rowspan="1">HKDF SHA-512</td>
                <td class="text-left" colspan="1" rowspan="1">Shared secret w/ HKDF and SHA-512</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">direct+HKDF-AES-128</td>
                <td class="text-center" colspan="1" rowspan="1">-12</td>
                <td class="text-left" colspan="1" rowspan="1">HKDF AES-MAC-128</td>
                <td class="text-left" colspan="1" rowspan="1">Shared secret w/ AES-MAC 128-bit key</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">direct+HKDF-AES-256</td>
                <td class="text-center" colspan="1" rowspan="1">-13</td>
                <td class="text-left" colspan="1" rowspan="1">HKDF AES-MAC-256</td>
                <td class="text-left" colspan="1" rowspan="1">Shared secret w/ AES-MAC 256-bit key</td>
              </tr>
            </tbody>
          </table>
</div>
<p id="section-6.1.2-7">When using a COSE key for this algorithm, the following checks are made:<a class="pilcrow" href="#section-6.1.2-7">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.2-8.1">The "kty" field <span class="bcp14">MUST</span> be present, and it <span class="bcp14">MUST</span> be "Symmetric".<a class="pilcrow" href="#section-6.1.2-8.1">¶</a>
</li>
            <li class="normal" id="section-6.1.2-8.2">If the "alg" field is present, it <span class="bcp14">MUST</span> match the algorithm being used.<a class="pilcrow" href="#section-6.1.2-8.2">¶</a>
</li>
            <li class="normal" id="section-6.1.2-8.3">If the "key_ops" field is present, it <span class="bcp14">MUST</span> include "derive key" or "derive bits".<a class="pilcrow" href="#section-6.1.2-8.3">¶</a>
</li>
          </ul>
<section id="section-6.1.2.1">
            <h5 id="name-security-considerations-for-di">
<a class="section-number selfRef" href="#section-6.1.2.1">6.1.2.1. </a><a class="section-name selfRef" href="#name-security-considerations-for-di">Security Considerations for Direct Key with KDF</a>
            </h5>
<p id="section-6.1.2.1-1">The shared secret needs to have some method of being regularly
     updated over time.  The shared secret forms the basis of trust.
     Although not used directly, it should still be subject to
     scheduled rotation.<a class="pilcrow" href="#section-6.1.2.1-1">¶</a></p>
<p id="section-6.1.2.1-2">These methods do not provide for perfect forward secrecy, as
     the same shared secret is used for all of the keys generated;
     however, if the key for any single message is discovered, only the
     message or series of messages using that derived key are
     compromised.  A new key derivation step will generate a new key that requires the same
     amount of work to get the key.<a class="pilcrow" href="#section-6.1.2.1-2">¶</a></p>
</section>
</section>
</div>
</section>
<div id="key_wrap_algs">
<section id="section-6.2">
        <h3 id="name-key-wrap">
<a class="section-number selfRef" href="#section-6.2">6.2. </a><a class="section-name selfRef" href="#name-key-wrap">Key Wrap</a>
        </h3>
<p id="section-6.2-1">
          Key wrap  is defined in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9052#section-8.5.2">Section 8.5.2</a> of [<a class="xref" href="#RFC9052">RFC9052</a>]</span>.
          Information about how to fill in the COSE_Recipient structure is detailed there.<a class="pilcrow" href="#section-6.2-1">¶</a></p>
<section id="section-6.2.1">
          <h4 id="name-aes-key-wrap">
<a class="section-number selfRef" href="#section-6.2.1">6.2.1. </a><a class="section-name selfRef" href="#name-aes-key-wrap">AES Key Wrap</a>
          </h4>
<p id="section-6.2.1-1">The AES Key Wrap algorithm is defined in <span>[<a class="xref" href="#RFC3394">RFC3394</a>]</span>.
 This algorithm uses an AES key to wrap a value that is a multiple of
 64 bits.  As such, it can be used to wrap a key for any of the
 content encryption algorithms defined in this document. The algorithm
 requires a single fixed parameter, the initial value.  This is fixed
 to the value specified in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc3394#section-2.2.3.1">Section 2.2.3.1</a> of [<a class="xref" href="#RFC3394">RFC3394</a>]</span>.  There are no public key parameters that vary on
 a per-invocation basis.  The protected header bucket
 <span class="bcp14">MUST</span> be empty.<a class="pilcrow" href="#section-6.2.1-1">¶</a></p>
<p id="section-6.2.1-2">Keys may be obtained from either a key structure or a recipient
 structure.  Implementations that are encrypting or decrypting
 <span class="bcp14">MUST</span> validate that the key type, key length, and
 algorithm are correct and appropriate for the entities involved.<a class="pilcrow" href="#section-6.2.1-2">¶</a></p>
<p id="section-6.2.1-3">When using a COSE key for this algorithm, the following checks are made:<a class="pilcrow" href="#section-6.2.1-3">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2.1-4.1">The "kty" field <span class="bcp14">MUST</span> be present, and it <span class="bcp14">MUST</span> be "Symmetric".<a class="pilcrow" href="#section-6.2.1-4.1">¶</a>
</li>
            <li class="normal" id="section-6.2.1-4.2">If the "alg" field is present, it <span class="bcp14">MUST</span> match the AES Key Wrap algorithm being used.<a class="pilcrow" href="#section-6.2.1-4.2">¶</a>
</li>
            <li class="normal" id="section-6.2.1-4.3">If the "key_ops" field is present, it <span class="bcp14">MUST</span> include "encrypt" or "wrap key" when encrypting.<a class="pilcrow" href="#section-6.2.1-4.3">¶</a>
</li>
            <li class="normal" id="section-6.2.1-4.4">If the "key_ops" field is present, it <span class="bcp14">MUST</span> include "decrypt" or "unwrap key"  when decrypting.<a class="pilcrow" href="#section-6.2.1-4.4">¶</a>
</li>
          </ul>
<span id="name-aes-key-wrap-algorithm-valu"></span><div id="x-table_aes_keywrap">
<table class="center" id="table-13">
            <caption>
<a class="selfRef" href="#table-13">Table 13</a>:
<a class="selfRef" href="#name-aes-key-wrap-algorithm-valu">AES Key Wrap Algorithm Values</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" colspan="1" rowspan="1">Name</th>
                <th class="text-center" colspan="1" rowspan="1">Value</th>
                <th class="text-center" colspan="1" rowspan="1">Key Size</th>
                <th class="text-left" colspan="1" rowspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">A128KW</td>
                <td class="text-center" colspan="1" rowspan="1">-3</td>
                <td class="text-center" colspan="1" rowspan="1">128</td>
                <td class="text-left" colspan="1" rowspan="1">AES Key Wrap w/ 128-bit key</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">A192KW</td>
                <td class="text-center" colspan="1" rowspan="1">-4</td>
                <td class="text-center" colspan="1" rowspan="1">192</td>
                <td class="text-left" colspan="1" rowspan="1">AES Key Wrap w/ 192-bit key</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">A256KW</td>
                <td class="text-center" colspan="1" rowspan="1">-5</td>
                <td class="text-center" colspan="1" rowspan="1">256</td>
                <td class="text-left" colspan="1" rowspan="1">AES Key Wrap w/ 256-bit key</td>
              </tr>
            </tbody>
          </table>
</div>
<section id="section-6.2.1.1">
            <h5 id="name-security-considerations-for-aes-">
<a class="section-number selfRef" href="#section-6.2.1.1">6.2.1.1. </a><a class="section-name selfRef" href="#name-security-considerations-for-aes-">Security Considerations for AES Key Wrap</a>
            </h5>
<p id="section-6.2.1.1-1">The shared secret needs to have some method of being regularly updated over time.  The shared secret is the basis of trust.<a class="pilcrow" href="#section-6.2.1.1-1">¶</a></p>
</section>
</section>
</section>
</div>
<section id="section-6.3">
        <h3 id="name-direct-key-agreement">
<a class="section-number selfRef" href="#section-6.3">6.3. </a><a class="section-name selfRef" href="#name-direct-key-agreement">Direct Key Agreement</a>
        </h3>
<p id="section-6.3-1">
          Direct Key Agreement is defined in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9052#section-8.5.4">Section 8.5.4</a> of [<a class="xref" href="#RFC9052">RFC9052</a>]</span>.
          Information about how to fill in the COSE_Recipient structure is detailed there.<a class="pilcrow" href="#section-6.3-1">¶</a></p>
<div id="ECDH">
<section id="section-6.3.1">
          <h4 id="name-direct-ecdh">
<a class="section-number selfRef" href="#section-6.3.1">6.3.1. </a><a class="section-name selfRef" href="#name-direct-ecdh">Direct ECDH</a>
          </h4>
<p id="section-6.3.1-1">The mathematics for ECDH can be found in <span>[<a class="xref" href="#RFC6090">RFC6090</a>]</span>.  In this document, the algorithm is extended to be used with the two curves defined in <span>[<a class="xref" href="#RFC7748">RFC7748</a>]</span>.<a class="pilcrow" href="#section-6.3.1-1">¶</a></p>
<p id="section-6.3.1-2">ECDH is parameterized by the following:<a class="pilcrow" href="#section-6.3.1-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-6.3.1-3">
            <dt id="section-6.3.1-3.1">Curve Type/Curve:</dt>
            <dd id="section-6.3.1-3.2" style="margin-left: 1.5em">
              <p id="section-6.3.1-3.2.1">The curve selected controls not only the size of the shared secret, but the mathematics for computing the shared secret.  The curve selected also controls how a point in the curve is represented and what happens for the identity points on the curve.  In this specification, we allow for a number of different curves to be used.  A set of curves is defined in <a class="xref" href="#x-table-ec-curves">Table 18</a>.<a class="pilcrow" href="#section-6.3.1-3.2.1">¶</a></p>
<p id="section-6.3.1-3.2.2"> The math used to obtain the computed secret is based on the curve selected and not on the ECDH algorithm.  For this reason, a new algorithm does not need to be defined for each of the curves.<a class="pilcrow" href="#section-6.3.1-3.2.2">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-6.3.1-3.3">Computed Secret to Shared Secret:</dt>
            <dd id="section-6.3.1-3.4" style="margin-left: 1.5em"> Once the computed
   secret is known, the resulting value needs to be converted to a byte
   string to run the KDF.  The x-coordinate is used for all of the
   curves defined in this document.  For curves X25519 and X448, the
   resulting value is used directly, as it is a byte string of a known
   length.  For the P-256, P-384, and P-521 curves, the x-coordinate is
   run through the Integer-to-Octet-String primitive (I2OSP) function
   defined in <span>[<a class="xref" href="#RFC8017">RFC8017</a>]</span>,
   using the same computation for n as is defined in <a class="xref" href="#ECDSA">Section 2.1</a>.<a class="pilcrow" href="#section-6.3.1-3.4">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-6.3.1-3.5">Ephemeral-Static or Static-Static:</dt>
            <dd id="section-6.3.1-3.6" style="margin-left: 1.5em"> The key agreement
          process may be done using either a static or an ephemeral
          key for the sender's side.  When using ephemeral keys, the
          sender <span class="bcp14">MUST</span> generate a new ephemeral key for
          every key agreement operation.  The ephemeral key is placed
          in the "ephemeral key" parameter and <span class="bcp14">MUST</span> be
          present for all algorithm identifiers that use ephemeral
          keys.  When using static keys, the sender
          <span class="bcp14">MUST</span> either generate a new random value or
          create a unique value for use as a KDF input.  For the KDFs used, this means that either
          the "salt" parameter for HKDF (<a class="xref" href="#HKDF_Alg_Params">Table 9</a>) or the "PartyU nonce" parameter
          for the context structure (<a class="xref" href="#KDF_Context_Alg_Params">Table 10</a>) <span class="bcp14">MUST</span> be
          present (both can be present if desired). The value in the
          parameter <span class="bcp14">MUST</span> be unique for the pair of keys
          being used.  It is acceptable to use a global counter that
          is incremented for every Static-Static operation and use the
          resulting value.  Care must be taken that the counter is
          saved to permanent storage in a way that avoids reuse of that
          counter value. When using static keys, the static key should
          be identified to the recipient.  The static key can be
          identified by providing either the key ("static key") or
          a key identifier for the static key ("static key
          id").  Both of these header parameters are defined in <a class="xref" href="#x-table-ecdh-es-parameter-table">Table 15</a>.<a class="pilcrow" href="#section-6.3.1-3.6">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-6.3.1-3.7">Key Derivation Algorithm:</dt>
            <dd id="section-6.3.1-3.8" style="margin-left: 1.5em">The result of an ECDH
   key agreement process does not provide a uniformly random secret.
   As such, it needs to be run through a KDF in order to produce a usable
   key.  Processing the secret through a KDF also allows for the
   introduction of context material: how the key is going to be used
   and one-time material for Static-Static key agreement.  All of the
   algorithms defined in this document use one of the HKDF algorithms
   defined in <a class="xref" href="#HKDF-section">Section 5.1</a> with the context structure
   defined in <a class="xref" href="#context">Section 5.2</a>.<a class="pilcrow" href="#section-6.3.1-3.8">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-6.3.1-3.9">Key Wrap Algorithm:</dt>
            <dd id="section-6.3.1-3.10" style="margin-left: 1.5em"> No key wrap algorithm is used.
   This is represented in <a class="xref" href="#x-table-ecdh-es-table">Table 14</a> as
   "none".  The key size for the context structure is the
   content layer encryption algorithm size.<a class="pilcrow" href="#section-6.3.1-3.10">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-6.3.1-4">
          COSE does not have an Ephemeral-Ephemeral version defined.
          The reason for this is that COSE is not an online protocol by itself and thus does not have a method of establishing ephemeral secrets on both sides.
          The expectation is that a protocol would establish the secrets for both sides, and then they would be used as Static-Static for the purposes of COSE, or that the protocol would generate a shared secret and a direct encryption would be used.<a class="pilcrow" href="#section-6.3.1-4">¶</a></p>
<p id="section-6.3.1-5">The set of direct ECDH algorithms defined in this document is found
 in <a class="xref" href="#x-table-ecdh-es-table">Table 14</a>.<a class="pilcrow" href="#section-6.3.1-5">¶</a></p>
<span id="name-ecdh-algorithm-values"></span><div id="x-table-ecdh-es-table">
<table class="center" id="table-14">
            <caption>
<a class="selfRef" href="#table-14">Table 14</a>:
<a class="selfRef" href="#name-ecdh-algorithm-values">ECDH Algorithm Values</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" colspan="1" rowspan="1">Name</th>
                <th class="text-left" colspan="1" rowspan="1">Value</th>
                <th class="text-left" colspan="1" rowspan="1">KDF</th>
                <th class="text-left" colspan="1" rowspan="1">Ephemeral-Static</th>
                <th class="text-left" colspan="1" rowspan="1">Key Wrap</th>
                <th class="text-left" colspan="1" rowspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">ECDH-ES + HKDF-256</td>
                <td class="text-left" colspan="1" rowspan="1">-25</td>
                <td class="text-left" colspan="1" rowspan="1">HKDF -- SHA-256</td>
                <td class="text-left" colspan="1" rowspan="1">yes</td>
                <td class="text-left" colspan="1" rowspan="1">none</td>
                <td class="text-left" colspan="1" rowspan="1">ECDH ES w/ HKDF -- generate key directly</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">ECDH-ES + HKDF-512</td>
                <td class="text-left" colspan="1" rowspan="1">-26</td>
                <td class="text-left" colspan="1" rowspan="1">HKDF -- SHA-512</td>
                <td class="text-left" colspan="1" rowspan="1">yes</td>
                <td class="text-left" colspan="1" rowspan="1">none</td>
                <td class="text-left" colspan="1" rowspan="1">ECDH ES w/ HKDF -- generate key directly</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">ECDH-SS + HKDF-256</td>
                <td class="text-left" colspan="1" rowspan="1">-27</td>
                <td class="text-left" colspan="1" rowspan="1">HKDF -- SHA-256</td>
                <td class="text-left" colspan="1" rowspan="1">no</td>
                <td class="text-left" colspan="1" rowspan="1">none</td>
                <td class="text-left" colspan="1" rowspan="1">ECDH SS w/ HKDF -- generate key directly</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">ECDH-SS + HKDF-512</td>
                <td class="text-left" colspan="1" rowspan="1">-28</td>
                <td class="text-left" colspan="1" rowspan="1">HKDF -- SHA-512</td>
                <td class="text-left" colspan="1" rowspan="1">no</td>
                <td class="text-left" colspan="1" rowspan="1">none</td>
                <td class="text-left" colspan="1" rowspan="1">ECDH SS w/ HKDF -- generate key directly</td>
              </tr>
            </tbody>
          </table>
</div>
<span id="name-ecdh-algorithm-parameters"></span><div id="x-table-ecdh-es-parameter-table">
<table class="center" id="table-15">
            <caption>
<a class="selfRef" href="#table-15">Table 15</a>:
<a class="selfRef" href="#name-ecdh-algorithm-parameters">ECDH Algorithm Parameters</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" colspan="1" rowspan="1">Name</th>
                <th class="text-left" colspan="1" rowspan="1">Label</th>
                <th class="text-left" colspan="1" rowspan="1">Type</th>
                <th class="text-left" colspan="1" rowspan="1">Algorithm</th>
                <th class="text-left" colspan="1" rowspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">ephemeral key</td>
                <td class="text-left" colspan="1" rowspan="1">-1</td>
                <td class="text-left" colspan="1" rowspan="1">COSE_Key</td>
                <td class="text-left" colspan="1" rowspan="1">ECDH-ES+HKDF-256, ECDH-ES+HKDF-512, ECDH-ES+A128KW, ECDH-ES+A192KW, ECDH-ES+A256KW</td>
                <td class="text-left" colspan="1" rowspan="1">Ephemeral public key for the sender</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">static key</td>
                <td class="text-left" colspan="1" rowspan="1">-2</td>
                <td class="text-left" colspan="1" rowspan="1">COSE_Key</td>
                <td class="text-left" colspan="1" rowspan="1">ECDH-SS+HKDF-256, ECDH-SS+HKDF-512, ECDH-SS+A128KW, ECDH-SS+A192KW, ECDH-SS+A256KW </td>
                <td class="text-left" colspan="1" rowspan="1">Static public key for the sender</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">static key id </td>
                <td class="text-left" colspan="1" rowspan="1">-3</td>
                <td class="text-left" colspan="1" rowspan="1">bstr</td>
                <td class="text-left" colspan="1" rowspan="1">ECDH-SS+HKDF-256, ECDH-SS+HKDF-512, ECDH-SS+A128KW, ECDH-SS+A192KW, ECDH-SS+A256KW </td>
                <td class="text-left" colspan="1" rowspan="1">Static public key identifier for the sender</td>
              </tr>
            </tbody>
          </table>
</div>
<p id="section-6.3.1-8">This document defines these algorithms to be used with the curves P-256, P-384, P-521, X25519, and X448.  Implementations <span class="bcp14">MUST</span> verify that the key type and curve are correct.  Different curves are restricted to different key types.  Implementations <span class="bcp14">MUST</span> verify that the curve and algorithm are appropriate for the entities involved.<a class="pilcrow" href="#section-6.3.1-8">¶</a></p>
<p id="section-6.3.1-9">When using a COSE key for this algorithm, the following checks are made:<a class="pilcrow" href="#section-6.3.1-9">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.3.1-10.1">The "kty" field <span class="bcp14">MUST</span> be present, and it <span class="bcp14">MUST</span> be "EC2" or "OKP".<a class="pilcrow" href="#section-6.3.1-10.1">¶</a>
</li>
            <li class="normal" id="section-6.3.1-10.2">If the "alg" field is present, it <span class="bcp14">MUST</span> match the
   key agreement algorithm being used.<a class="pilcrow" href="#section-6.3.1-10.2">¶</a>
</li>
            <li class="normal" id="section-6.3.1-10.3">If the "key_ops" field is present, it <span class="bcp14">MUST</span> include "derive key" or "derive bits" for the private key.<a class="pilcrow" href="#section-6.3.1-10.3">¶</a>
</li>
            <li class="normal" id="section-6.3.1-10.4">If the "key_ops" field is present, it <span class="bcp14">MUST</span> be empty for the public key.<a class="pilcrow" href="#section-6.3.1-10.4">¶</a>
</li>
          </ul>
<section id="section-6.3.1.1">
            <h5 id="name-security-considerations-for-e">
<a class="section-number selfRef" href="#section-6.3.1.1">6.3.1.1. </a><a class="section-name selfRef" href="#name-security-considerations-for-e">Security Considerations for ECDH</a>
            </h5>
<p id="section-6.3.1.1-1">
            There is a method of checking that points provided from external entities are valid.
            For the "EC2" key format, this can be done by checking that the x and y values form a point on the curve.
            For the "OKP" format, there is no simple way to perform point validation.<a class="pilcrow" href="#section-6.3.1.1-1">¶</a></p>
<p id="section-6.3.1.1-2">
            Consideration was given to requiring that the public keys of both
     entities be provided as part of the key derivation process (as
     recommended in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc7748#section-6.1">Section 6.1</a> of [<a class="xref" href="#RFC7748">RFC7748</a>]</span>).  This was
     not done, because COSE is used in a store-and-forward
     format rather than in online key exchange. 
            In order for this to be a problem, either the receiver public key has to be chosen maliciously or the sender has to be malicious. 
            In either case, all security evaporates anyway.<a class="pilcrow" href="#section-6.3.1.1-2">¶</a></p>
<p id="section-6.3.1.1-3">A proof of possession of the private key associated with the public key is recommended when a key is moved from untrusted to trusted (either by the end user or by the entity that is responsible for making trust statements on keys).<a class="pilcrow" href="#section-6.3.1.1-3">¶</a></p>
</section>
</section>
</div>
</section>
<section id="section-6.4">
        <h3 id="name-key-agreement-with-key-wrap">
<a class="section-number selfRef" href="#section-6.4">6.4. </a><a class="section-name selfRef" href="#name-key-agreement-with-key-wrap">Key Agreement with Key Wrap</a>
        </h3>
<p id="section-6.4-1">
          Key Agreement with Key Wrap is defined in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9052#section-8.5.5">Section 8.5.5</a> of [<a class="xref" href="#RFC9052">RFC9052</a>]</span>.
          Information about how to fill in the COSE_Recipient structure is detailed there.<a class="pilcrow" href="#section-6.4-1">¶</a></p>
<div id="ECDH-wrap">
<section id="section-6.4.1">
          <h4 id="name-ecdh-with-key-wrap">
<a class="section-number selfRef" href="#section-6.4.1">6.4.1. </a><a class="section-name selfRef" href="#name-ecdh-with-key-wrap">ECDH with Key Wrap</a>
          </h4>
<p id="section-6.4.1-1">These algorithms are defined in <a class="xref" href="#x-table-ecdh-es-table-wrap">Table 16</a>.<a class="pilcrow" href="#section-6.4.1-1">¶</a></p>
<p id="section-6.4.1-2">ECDH with Key Agreement is parameterized by the same header parameters as for ECDH; see <a class="xref" href="#ECDH">Section 6.3.1</a>, with the following modifications:<a class="pilcrow" href="#section-6.4.1-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-6.4.1-3">
            <dt id="section-6.4.1-3.1">Key Wrap Algorithm:</dt>
            <dd id="section-6.4.1-3.2" style="margin-left: 1.5em"> Any of the key wrap algorithms
   defined in <a class="xref" href="#key_wrap_algs">Section 6.2</a> are supported.  The size
   of the key used for the key wrap algorithm is fed into the KDF.  The
   set of identifiers is found in <a class="xref" href="#x-table-ecdh-es-table-wrap">Table 16</a>.<a class="pilcrow" href="#section-6.4.1-3.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<span id="name-ecdh-algorithm-values-with-"></span><div id="x-table-ecdh-es-table-wrap">
<table class="center" id="table-16">
            <caption>
<a class="selfRef" href="#table-16">Table 16</a>:
<a class="selfRef" href="#name-ecdh-algorithm-values-with-">ECDH Algorithm Values with Key Wrap</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" colspan="1" rowspan="1">Name</th>
                <th class="text-left" colspan="1" rowspan="1">Value</th>
                <th class="text-left" colspan="1" rowspan="1">KDF</th>
                <th class="text-left" colspan="1" rowspan="1">Ephemeral-Static</th>
                <th class="text-left" colspan="1" rowspan="1">Key Wrap</th>
                <th class="text-left" colspan="1" rowspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">ECDH-ES + A128KW</td>
                <td class="text-left" colspan="1" rowspan="1">-29</td>
                <td class="text-left" colspan="1" rowspan="1">HKDF -- SHA-256</td>
                <td class="text-left" colspan="1" rowspan="1">yes</td>
                <td class="text-left" colspan="1" rowspan="1">A128KW</td>
                <td class="text-left" colspan="1" rowspan="1">ECDH ES w/ HKDF and AES Key Wrap w/ 128-bit key</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">ECDH-ES + A192KW</td>
                <td class="text-left" colspan="1" rowspan="1">-30</td>
                <td class="text-left" colspan="1" rowspan="1">HKDF -- SHA-256</td>
                <td class="text-left" colspan="1" rowspan="1">yes</td>
                <td class="text-left" colspan="1" rowspan="1">A192KW</td>
                <td class="text-left" colspan="1" rowspan="1">ECDH ES w/ HKDF and AES Key Wrap w/ 192-bit key</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">ECDH-ES + A256KW</td>
                <td class="text-left" colspan="1" rowspan="1">-31</td>
                <td class="text-left" colspan="1" rowspan="1">HKDF -- SHA-256</td>
                <td class="text-left" colspan="1" rowspan="1">yes</td>
                <td class="text-left" colspan="1" rowspan="1">A256KW</td>
                <td class="text-left" colspan="1" rowspan="1">ECDH ES w/ HKDF and AES Key Wrap w/ 256-bit key</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">ECDH-SS + A128KW</td>
                <td class="text-left" colspan="1" rowspan="1">-32</td>
                <td class="text-left" colspan="1" rowspan="1">HKDF -- SHA-256</td>
                <td class="text-left" colspan="1" rowspan="1">no</td>
                <td class="text-left" colspan="1" rowspan="1">A128KW</td>
                <td class="text-left" colspan="1" rowspan="1">ECDH SS w/ HKDF and AES Key Wrap w/ 128-bit key</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">ECDH-SS + A192KW</td>
                <td class="text-left" colspan="1" rowspan="1">-33</td>
                <td class="text-left" colspan="1" rowspan="1">HKDF -- SHA-256</td>
                <td class="text-left" colspan="1" rowspan="1">no</td>
                <td class="text-left" colspan="1" rowspan="1">A192KW</td>
                <td class="text-left" colspan="1" rowspan="1">ECDH SS w/ HKDF and AES Key Wrap w/ 192-bit key</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">ECDH-SS + A256KW</td>
                <td class="text-left" colspan="1" rowspan="1">-34</td>
                <td class="text-left" colspan="1" rowspan="1">HKDF -- SHA-256</td>
                <td class="text-left" colspan="1" rowspan="1">no</td>
                <td class="text-left" colspan="1" rowspan="1">A256KW</td>
                <td class="text-left" colspan="1" rowspan="1">ECDH SS w/ HKDF and AES Key Wrap w/ 256-bit key</td>
              </tr>
            </tbody>
          </table>
</div>
<p id="section-6.4.1-5">When using a COSE key for this algorithm, the following checks are made:<a class="pilcrow" href="#section-6.4.1-5">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.4.1-6.1">The "kty" field <span class="bcp14">MUST</span> be present, and it <span class="bcp14">MUST</span> be "EC2" or "OKP".<a class="pilcrow" href="#section-6.4.1-6.1">¶</a>
</li>
            <li class="normal" id="section-6.4.1-6.2">If the "alg" field is present, it <span class="bcp14">MUST</span> match the key agreement algorithm being used.<a class="pilcrow" href="#section-6.4.1-6.2">¶</a>
</li>
            <li class="normal" id="section-6.4.1-6.3">If the "key_ops" field is present, it <span class="bcp14">MUST</span> include "derive key" or "derive bits" for the private key.<a class="pilcrow" href="#section-6.4.1-6.3">¶</a>
</li>
            <li class="normal" id="section-6.4.1-6.4">If the "key_ops" field is present, it <span class="bcp14">MUST</span> be empty for the public key.<a class="pilcrow" href="#section-6.4.1-6.4">¶</a>
</li>
          </ul>
</section>
</div>
</section>
</section>
</div>
<div id="Key-specific-labels">
<section id="section-7">
      <h2 id="name-key-object-parameters">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-key-object-parameters">Key Object Parameters</a>
      </h2>
<p id="section-7-1">The COSE_Key object defines a way to hold a single key object.  It is still required that the members of individual key types be defined.  This section of the document is where we define an initial set of members for specific key types.<a class="pilcrow" href="#section-7-1">¶</a></p>
<p id="section-7-2">For each of the key types, we define both public and private members.
      The public members are what is transmitted to others for their usage.
      Private members allow individuals to archive keys.  However,
      there are some circumstances in which private keys may be distributed to
      entities in a protocol.  Examples include:  entities that have poor
      random number generation, centralized key creation for multicast-type
      operations, and protocols in which a shared secret is used as a bearer
      token for authorization purposes.<a class="pilcrow" href="#section-7-2">¶</a></p>
<p id="section-7-3">Key types are identified by the "kty" member of the COSE_Key object.  In this document, we define four values for the member:<a class="pilcrow" href="#section-7-3">¶</a></p>
<span id="name-key-type-values"></span><div id="x-table_key_types">
<table class="center" id="table-17">
        <caption>
<a class="selfRef" href="#table-17">Table 17</a>:
<a class="selfRef" href="#name-key-type-values">Key Type Values</a>
        </caption>
<thead>
          <tr>
            <th class="text-left" colspan="1" rowspan="1">Name</th>
            <th class="text-center" colspan="1" rowspan="1">Value</th>
            <th class="text-left" colspan="1" rowspan="1">Description</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">OKP</td>
            <td class="text-center" colspan="1" rowspan="1">1</td>
            <td class="text-left" colspan="1" rowspan="1">Octet Key Pair</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">EC2</td>
            <td class="text-center" colspan="1" rowspan="1">2</td>
            <td class="text-left" colspan="1" rowspan="1">Elliptic Curve Keys w/ x- and y-coordinate pair</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">Symmetric</td>
            <td class="text-center" colspan="1" rowspan="1">4</td>
            <td class="text-left" colspan="1" rowspan="1">Symmetric Keys</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">Reserved</td>
            <td class="text-center" colspan="1" rowspan="1">0</td>
            <td class="text-left" colspan="1" rowspan="1">This value is reserved</td>
          </tr>
        </tbody>
      </table>
</div>
<section id="section-7.1">
        <h3 id="name-elliptic-curve-keys">
<a class="section-number selfRef" href="#section-7.1">7.1. </a><a class="section-name selfRef" href="#name-elliptic-curve-keys">Elliptic Curve Keys</a>
        </h3>
<p id="section-7.1-1">Two different key structures are defined for elliptic curve keys.
 One version uses both an x-coordinate and a y-coordinate, potentially
 with point compression ("EC2").  This is the conventional
 elliptic curve (EC) point
 representation that is used in <span>[<a class="xref" href="#RFC5480">RFC5480</a>]</span>.  The other
 version uses only the x-coordinate, as the y-coordinate is either to
 be recomputed or not needed for the key agreement operation ("OKP").<a class="pilcrow" href="#section-7.1-1">¶</a></p>
<p id="section-7.1-2">Applications <span class="bcp14">MUST</span> check that the curve and the key type are consistent and reject a key if they are not.<a class="pilcrow" href="#section-7.1-2">¶</a></p>
<span id="name-elliptic-curves"></span><div id="x-table-ec-curves">
<table class="center" id="table-18">
          <caption>
<a class="selfRef" href="#table-18">Table 18</a>:
<a class="selfRef" href="#name-elliptic-curves">Elliptic Curves</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Name</th>
              <th class="text-center" colspan="1" rowspan="1">Value</th>
              <th class="text-center" colspan="1" rowspan="1">Key Type</th>
              <th class="text-left" colspan="1" rowspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">P-256</td>
              <td class="text-center" colspan="1" rowspan="1">1</td>
              <td class="text-center" colspan="1" rowspan="1">EC2</td>
              <td class="text-left" colspan="1" rowspan="1">NIST P-256, also known as secp256r1</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">P-384</td>
              <td class="text-center" colspan="1" rowspan="1">2</td>
              <td class="text-center" colspan="1" rowspan="1">EC2</td>
              <td class="text-left" colspan="1" rowspan="1">NIST P-384, also known as secp384r1</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">P-521</td>
              <td class="text-center" colspan="1" rowspan="1">3</td>
              <td class="text-center" colspan="1" rowspan="1">EC2</td>
              <td class="text-left" colspan="1" rowspan="1">NIST P-521, also known as secp521r1</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">X25519</td>
              <td class="text-center" colspan="1" rowspan="1">4</td>
              <td class="text-center" colspan="1" rowspan="1">OKP</td>
              <td class="text-left" colspan="1" rowspan="1">X25519 for use w/ ECDH only</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">X448</td>
              <td class="text-center" colspan="1" rowspan="1">5</td>
              <td class="text-center" colspan="1" rowspan="1">OKP</td>
              <td class="text-left" colspan="1" rowspan="1">X448 for use w/ ECDH only</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">Ed25519</td>
              <td class="text-center" colspan="1" rowspan="1">6</td>
              <td class="text-center" colspan="1" rowspan="1">OKP</td>
              <td class="text-left" colspan="1" rowspan="1">Ed25519 for use w/ EdDSA only</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">Ed448</td>
              <td class="text-center" colspan="1" rowspan="1">7</td>
              <td class="text-center" colspan="1" rowspan="1">OKP</td>
              <td class="text-left" colspan="1" rowspan="1">Ed448 for use w/ EdDSA only</td>
            </tr>
          </tbody>
        </table>
</div>
<div id="EC2-Keys">
<section id="section-7.1.1">
          <h4 id="name-double-coordinate-curves">
<a class="section-number selfRef" href="#section-7.1.1">7.1.1. </a><a class="section-name selfRef" href="#name-double-coordinate-curves">Double Coordinate Curves</a>
          </h4>
<p id="section-7.1.1-1">Generally, protocols transmit elliptic-curve points as either the 
   x-coordinate and y-coordinate or the x-coordinate and a sign bit
   for the y-coordinate.  The latter encoding has not been recommended
   by the IETF due to potential IPR
   issues.  However, for operations in constrained environments, the
   ability to shrink a message by not sending the y-coordinate is
   potentially useful.<a class="pilcrow" href="#section-7.1.1-1">¶</a></p>
<p id="section-7.1.1-2">For EC keys with both coordinates, the "kty" member is set to 2 (EC2).  The key parameters defined in this section are summarized in <a class="xref" href="#x-table-ec2-keys">Table 19</a>.  The members that are defined for this key type are:<a class="pilcrow" href="#section-7.1.1-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-7.1.1-3">
            <dt id="section-7.1.1-3.1">crv:</dt>
            <dd id="section-7.1.1-3.2" style="margin-left: 3.0em">This contains an identifier of the curve to be used with the key. The curves defined in this document for this key type can be found in <a class="xref" href="#x-table-ec-curves">Table 18</a>.  Other curves may be registered in the future, and private curves can be used as well.<a class="pilcrow" href="#section-7.1.1-3.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-7.1.1-3.3">x:</dt>
            <dd id="section-7.1.1-3.4" style="margin-left: 3.0em">This contains the x-coordinate for the EC point.  The integer
     is converted to a byte string as defined in <span>[<a class="xref" href="#SEC1">SEC1</a>]</span>.
     Leading-zero octets <span class="bcp14">MUST</span> be preserved.<a class="pilcrow" href="#section-7.1.1-3.4">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-7.1.1-3.5">y:</dt>
            <dd id="section-7.1.1-3.6" style="margin-left: 3.0em">This contains either the sign bit or the value of the y-coordinate for the EC point.  When encoding the value y, the integer is converted to a byte string (as defined in <span>[<a class="xref" href="#SEC1">SEC1</a>]</span>) and encoded as a CBOR bstr.  Leading-zero octets <span class="bcp14">MUST</span> be preserved.  Compressed point encoding is also supported.  Compute the sign bit as laid out in the Elliptic-Curve-Point-to-Octet-String Conversion function of <span>[<a class="xref" href="#SEC1">SEC1</a>]</span>.  If the sign bit is zero, then encode y as a CBOR false value; otherwise, encode y as a CBOR true value.  The encoding of the infinity point is not supported.<a class="pilcrow" href="#section-7.1.1-3.6">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-7.1.1-3.7">d:</dt>
            <dd id="section-7.1.1-3.8" style="margin-left: 3.0em">This contains the private key.<a class="pilcrow" href="#section-7.1.1-3.8">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-7.1.1-4">For public keys, it is <span class="bcp14">REQUIRED</span> that "crv", "x", and "y" be present in the structure.  For private keys, it is <span class="bcp14">REQUIRED</span> that "crv" and "d" be present in the structure.  For private keys, it is <span class="bcp14">RECOMMENDED</span> that "x" and "y" also be present, but they can be recomputed from the required elements, and omitting them saves on space.<a class="pilcrow" href="#section-7.1.1-4">¶</a></p>
<span id="name-ec-key-parameters"></span><div id="x-table-ec2-keys">
<table class="center" id="table-19">
            <caption>
<a class="selfRef" href="#table-19">Table 19</a>:
<a class="selfRef" href="#name-ec-key-parameters">EC Key Parameters</a>
            </caption>
<thead>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Key Type</th>
                <th class="text-center" colspan="1" rowspan="1">Name</th>
                <th class="text-center" colspan="1" rowspan="1">Label</th>
                <th class="text-left" colspan="1" rowspan="1">CBOR Type</th>
                <th class="text-left" colspan="1" rowspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-center" colspan="1" rowspan="1">2</td>
                <td class="text-center" colspan="1" rowspan="1">crv</td>
                <td class="text-center" colspan="1" rowspan="1">-1</td>
                <td class="text-left" colspan="1" rowspan="1">int / tstr</td>
                <td class="text-left" colspan="1" rowspan="1">EC identifier -- Taken from the "COSE Elliptic Curves" registry</td>
              </tr>
              <tr>
                <td class="text-center" colspan="1" rowspan="1">2</td>
                <td class="text-center" colspan="1" rowspan="1">x</td>
                <td class="text-center" colspan="1" rowspan="1">-2</td>
                <td class="text-left" colspan="1" rowspan="1">bstr</td>
                <td class="text-left" colspan="1" rowspan="1">x-coordinate</td>
              </tr>
              <tr>
                <td class="text-center" colspan="1" rowspan="1">2</td>
                <td class="text-center" colspan="1" rowspan="1">y</td>
                <td class="text-center" colspan="1" rowspan="1">-3</td>
                <td class="text-left" colspan="1" rowspan="1">bstr / bool</td>
                <td class="text-left" colspan="1" rowspan="1">y-coordinate</td>
              </tr>
              <tr>
                <td class="text-center" colspan="1" rowspan="1">2</td>
                <td class="text-center" colspan="1" rowspan="1">d</td>
                <td class="text-center" colspan="1" rowspan="1">-4</td>
                <td class="text-left" colspan="1" rowspan="1">bstr</td>
                <td class="text-left" colspan="1" rowspan="1">Private key</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
</div>
</section>
<section id="section-7.2">
        <h3 id="name-octet-key-pair">
<a class="section-number selfRef" href="#section-7.2">7.2. </a><a class="section-name selfRef" href="#name-octet-key-pair">Octet Key Pair</a>
        </h3>
<p id="section-7.2-1">A new key type is defined for Octet Key Pairs (OKPs).  Do not assume that keys using this type are elliptic curves.  This key type could be used for other curve types (for example, mathematics based on hyper-elliptic surfaces).<a class="pilcrow" href="#section-7.2-1">¶</a></p>
<p id="section-7.2-2">The key parameters defined in this section are summarized in <a class="xref" href="#x-table-ec1-keys">Table 20</a>.  The members that are defined for this key type are:<a class="pilcrow" href="#section-7.2-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-7.2-3">
          <dt id="section-7.2-3.1">crv:</dt>
          <dd id="section-7.2-3.2" style="margin-left: 3.0em">This contains an identifier of the curve to be used with the key. The curves defined in this document for this key type can be found in <a class="xref" href="#x-table-ec-curves">Table 18</a>.  Other curves may be registered in the future, and private curves can be used as well.<a class="pilcrow" href="#section-7.2-3.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.2-3.3">x:</dt>
          <dd id="section-7.2-3.4" style="margin-left: 3.0em">This contains the public key.  The byte string contains the public key as defined by the algorithm. (For X25519, internally it is a little-endian integer.)<a class="pilcrow" href="#section-7.2-3.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.2-3.5">d:</dt>
          <dd id="section-7.2-3.6" style="margin-left: 3.0em">This contains the private key.<a class="pilcrow" href="#section-7.2-3.6">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-7.2-4">For public keys, it is <span class="bcp14">REQUIRED</span> that "crv" and  "x" be present in the structure.  For private keys, it is <span class="bcp14">REQUIRED</span> that "crv" and "d" be present in the structure.  For private keys, it is <span class="bcp14">RECOMMENDED</span> that "x" also be present, but it can be recomputed from the required elements, and omitting it saves on space.<a class="pilcrow" href="#section-7.2-4">¶</a></p>
<span id="name-octet-key-pair-parameters"></span><div id="x-table-ec1-keys">
<table class="center" id="table-20">
          <caption>
<a class="selfRef" href="#table-20">Table 20</a>:
<a class="selfRef" href="#name-octet-key-pair-parameters">Octet Key Pair Parameters</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Name</th>
              <th class="text-center" colspan="1" rowspan="1">Key Type</th>
              <th class="text-center" colspan="1" rowspan="1">Label</th>
              <th class="text-left" colspan="1" rowspan="1">Type</th>
              <th class="text-left" colspan="1" rowspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">crv</td>
              <td class="text-center" colspan="1" rowspan="1">1</td>
              <td class="text-center" colspan="1" rowspan="1">-1</td>
              <td class="text-left" colspan="1" rowspan="1">int / tstr</td>
              <td class="text-left" colspan="1" rowspan="1">EC identifier -- Taken from the "COSE Elliptic Curves" registry</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">x</td>
              <td class="text-center" colspan="1" rowspan="1">1</td>
              <td class="text-center" colspan="1" rowspan="1">-2</td>
              <td class="text-left" colspan="1" rowspan="1">bstr</td>
              <td class="text-left" colspan="1" rowspan="1">Public Key</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">d</td>
              <td class="text-center" colspan="1" rowspan="1">1</td>
              <td class="text-center" colspan="1" rowspan="1">-4</td>
              <td class="text-left" colspan="1" rowspan="1">bstr</td>
              <td class="text-left" colspan="1" rowspan="1">Private key</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
<section id="section-7.3">
        <h3 id="name-symmetric-keys">
<a class="section-number selfRef" href="#section-7.3">7.3. </a><a class="section-name selfRef" href="#name-symmetric-keys">Symmetric Keys</a>
        </h3>
<p id="section-7.3-1">Occasionally, it is required that a symmetric key be transported between entities.  This key structure allows for that to happen.<a class="pilcrow" href="#section-7.3-1">¶</a></p>
<p id="section-7.3-2">For symmetric keys, the "kty" member is set to 4 ("Symmetric").  The member that is defined for this key type is:<a class="pilcrow" href="#section-7.3-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-7.3-3">
          <dt id="section-7.3-3.1">k:</dt>
          <dd id="section-7.3-3.2" style="margin-left: 1.5em">This contains the value of the key.<a class="pilcrow" href="#section-7.3-3.2">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-7.3-4">This key structure does not have a form that contains only public members.  As it is expected that this key structure is going to be transmitted, care must be taken that it is never transmitted accidentally or insecurely.  For symmetric keys, it is <span class="bcp14">REQUIRED</span> that "k" be present in the structure.<a class="pilcrow" href="#section-7.3-4">¶</a></p>
<span id="name-symmetric-key-parameters"></span><div id="x-table-symmetric-keys">
<table class="center" id="table-21">
          <caption>
<a class="selfRef" href="#table-21">Table 21</a>:
<a class="selfRef" href="#name-symmetric-key-parameters">Symmetric Key Parameters</a>
          </caption>
<thead>
            <tr>
              <th class="text-center" colspan="1" rowspan="1">Name</th>
              <th class="text-center" colspan="1" rowspan="1">Key Type</th>
              <th class="text-center" colspan="1" rowspan="1">Label</th>
              <th class="text-center" colspan="1" rowspan="1">Type</th>
              <th class="text-left" colspan="1" rowspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-center" colspan="1" rowspan="1">k</td>
              <td class="text-center" colspan="1" rowspan="1">4</td>
              <td class="text-center" colspan="1" rowspan="1">-1</td>
              <td class="text-center" colspan="1" rowspan="1">bstr</td>
              <td class="text-left" colspan="1" rowspan="1">Key Value</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</section>
</div>
<div id="COSE-Capabilities">
<section id="section-8">
      <h2 id="name-cose-capabilities">
<a class="section-number selfRef" href="#section-8">8. </a><a class="section-name selfRef" href="#name-cose-capabilities">COSE Capabilities</a>
      </h2>
<p id="section-8-1">
 
        The capabilities of an algorithm or key type need to be
        specified in some situations.
        This has a counterpart
        in the S/MIME specifications, where SMIMECapabilities is
        defined in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8551#section-2.5.2">Section 2.5.2</a> of [<a class="xref" href="#RFC8551">RFC8551</a>]</span>.  This document defines the same concept
        for COSE.<a class="pilcrow" href="#section-8-1">¶</a></p>
<p id="section-8-2">
        The algorithm identifier is not included in the capabilities data, as
 it should be encoded elsewhere in the message. The key type identifier
 is included in the capabilities data, as it is not expected to be
 encoded elsewhere.<a class="pilcrow" href="#section-8-2">¶</a></p>
<p id="section-8-3">
        Two different types of capabilities are defined: capabilities for algorithms and capabilities for key type.
        Once defined by registration with IANA, the list of capabilities for an algorithm or key type is immutable.
        If it is later found that a new capability is needed for a key type or algorithm, it will require that a new code point be assigned to deal with that.
        As a general rule, the capabilities are going to map to algorithm-specific header parameters or key parameters, but they do not need to do so.
        An example of this is the HSS-LMS key type capabilities defined below, where the hash algorithm used is included.<a class="pilcrow" href="#section-8-3">¶</a></p>
<p id="section-8-4">
        The capability structure is an array of values; the values included in the structure are dependent on a specific algorithm or key type.
        For algorithm capabilities, the first element should always be a
 key type value if applicable, but the items that are specific to a key
 (for example, a curve) should not be included in the algorithm
 capabilities.
        This means that if one wishes to enumerate all of the capabilities for
 a device that implements ECDH, it requires that all of the
 combinations of algorithms and key pairs be specified.
        The last example of <a class="xref" href="#cap-examples">Section 8.3</a> provides a case
 where this is done by allowing for a cross product to be specified
 between an array of algorithm capabilities and key type capabilities
 (see the ECDH-ES+A25KW element).
        For a key, the first element should be the key type value.
        While this means that the key type value will be duplicated if both an algorithm and key capability are used, the key type is needed in order to understand the rest of the values.<a class="pilcrow" href="#section-8-4">¶</a></p>
<section id="section-8.1">
        <h3 id="name-assignments-for-existing-al">
<a class="section-number selfRef" href="#section-8.1">8.1. </a><a class="section-name selfRef" href="#name-assignments-for-existing-al">Assignments for Existing Algorithms</a>
        </h3>
<p id="section-8.1-1">
          For the current set of algorithms in the registry other than IV-GENERATION (those in this document as well as those in <span>[<a class="xref" href="#RFC8230">RFC8230</a>]</span>, <span>[<a class="xref" href="#RFC8778">RFC8778</a>]</span>, and <span>[<a class="xref" href="#RFC9021">RFC9021</a>]</span>), the capabilities list is an array with one element, the key type (from the "COSE Key Types" Registry).  It is expected that future registered algorithms could have zero, one, or multiple elements.<a class="pilcrow" href="#section-8.1-1">¶</a></p>
</section>
<section id="section-8.2">
        <h3 id="name-assignments-for-existing-ke">
<a class="section-number selfRef" href="#section-8.2">8.2. </a><a class="section-name selfRef" href="#name-assignments-for-existing-ke">Assignments for Existing Key Types</a>
        </h3>
<p id="section-8.2-1">
          There are a number of pre-existing key types; the following deals with creating the capability definition for those structures:<a class="pilcrow" href="#section-8.2-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.2-2.1">
            <p id="section-8.2-2.1.1">OKP, EC2: The list of capabilities is:<a class="pilcrow" href="#section-8.2-2.1.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.2-2.1.2.1">The key type value.  (1 for OKP or 2 for EC2.)<a class="pilcrow" href="#section-8.2-2.1.2.1">¶</a>
</li>
              <li class="normal" id="section-8.2-2.1.2.2">One curve for that key type from the "COSE Elliptic Curves" registry.<a class="pilcrow" href="#section-8.2-2.1.2.2">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-8.2-2.2">
            <p id="section-8.2-2.2.1">RSA: The list of capabilities is:<a class="pilcrow" href="#section-8.2-2.2.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.2-2.2.2.1">The key type value (3).<a class="pilcrow" href="#section-8.2-2.2.2.1">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-8.2-2.3">
            <p id="section-8.2-2.3.1">Symmetric: The list of capabilities is:<a class="pilcrow" href="#section-8.2-2.3.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.2-2.3.2.1">The key type value (4).<a class="pilcrow" href="#section-8.2-2.3.2.1">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-8.2-2.4">
            <p id="section-8.2-2.4.1">HSS-LMS: The list of capabilities is:<a class="pilcrow" href="#section-8.2-2.4.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.2-2.4.2.1">The key type value (5).<a class="pilcrow" href="#section-8.2-2.4.2.1">¶</a>
</li>
              <li class="normal" id="section-8.2-2.4.2.2">Algorithm identifier for the underlying hash function from the "COSE
Algorithms" registry.<a class="pilcrow" href="#section-8.2-2.4.2.2">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-8.2-2.5">
            <p id="section-8.2-2.5.1">WalnutDSA: The list of capabilities is:<a class="pilcrow" href="#section-8.2-2.5.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.2-2.5.2.1">The key type value (6).<a class="pilcrow" href="#section-8.2-2.5.2.1">¶</a>
</li>
              <li class="normal" id="section-8.2-2.5.2.2">The N value (group and matrix size) for the key, a uint.<a class="pilcrow" href="#section-8.2-2.5.2.2">¶</a>
</li>
              <li class="normal" id="section-8.2-2.5.2.3">The q value (finite field order) for the key, a uint.<a class="pilcrow" href="#section-8.2-2.5.2.3">¶</a>
</li>
            </ul>
</li>
        </ul>
</section>
<div id="cap-examples">
<section id="section-8.3">
        <h3 id="name-examples-2">
<a class="section-number selfRef" href="#section-8.3">8.3. </a><a class="section-name selfRef" href="#name-examples-2">Examples</a>
        </h3>
<p id="section-8.3-1">
          Capabilities can be used in a key derivation process to make sure
   that both sides are using the same parameters.
          The three examples below show different ways that one might utilize parameters in specifying an application protocol:<a class="pilcrow" href="#section-8.3-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.3-2.1">
          Only an algorithm capability: This is useful if the protocol wants to require a specific algorithm, such as ES256, but it is agnostic about which curve is being used. 
          This requires that the algorithm identifier be specified in the protocol. See the first example.<a class="pilcrow" href="#section-8.3-2.1">¶</a>
</li>
          <li class="normal" id="section-8.3-2.2">
            Only a key type capability: This is useful if the protocol wants
     to require a specific key type and curve, such as
     P-256, but will accept any algorithm using that curve (e.g., both
     ECDSA and ECDH).
            See the second example.<a class="pilcrow" href="#section-8.3-2.2">¶</a>
</li>
          <li class="normal" id="section-8.3-2.3">
            Both algorithm and key type capabilities: This is used if the
     protocol needs to nail down all of the options surrounding an
     algorithm -- e.g., EdDSA with the curve Ed25519.
            As with the first example, the algorithm identifier needs to be specified in the protocol. See the third example, which just concatenates the two capabilities together.<a class="pilcrow" href="#section-8.3-2.3">¶</a>
</li>
        </ul>
<div id="section-8.3-3">
<pre class="lang-cbor-pretty sourcecode">Algorithm ES256

0x8102                 / [2 \ EC2 \ ] /

Key type EC2 with P-256 curve:

0x820201               / [2 \ EC2 \, 1 \ P-256 \] /

ECDH-ES + A256KW with an X25519 curve:

0x8101820104           / [1 \ OKP \],[1 \ OKP \, 4 \ X25519 \] /
</pre><a class="pilcrow" href="#section-8.3-3">¶</a>
</div>
<p id="section-8.3-4">
          The capabilities can also be used by an entity to advertise what it is capable of doing.
          The decoded example below is one of many encodings that could be used for that purpose.
          Each array element includes three fields: the algorithm identifier, one or more algorithm capabilities, and one or more key type capabilities.<a class="pilcrow" href="#section-8.3-4">¶</a></p>
<div id="section-8.3-5">
<pre class="lang-cbor-diag sourcecode">[
 [-8 / EdDSA /,
   [1 / OKP key type /],
   [
     [1 / OKP /, 6 / Ed25519 / ],
     [1 /OKP/, 7 /Ed448 /]
   ]
 ],
 [-7 / ECDSA with SHA-256/,
   [2 /EC2 key type/],
   [
     [2 /EC2/, 1 /P-256/],
     [2 /EC2/, 3 /P-521/]
   ]
 ],
 [ -31 / ECDH-ES+A256KW/,
   [
     [ 2 /EC2/],
     [1 /OKP/ ]
   ],
   [
     [2 /EC2/, 1 /P-256/],
     [1 /OKP/, 4 / X25519/ ]
   ]
 ],
 [ 1 / A128GCM /,
   [ 4 / Symmetric / ],
   [ 4 / Symmetric /]
 ]
]
</pre><a class="pilcrow" href="#section-8.3-5">¶</a>
</div>
<p id="section-8.3-6">
          Examining the above:<a class="pilcrow" href="#section-8.3-6">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.3-7.1">The first element indicates that the entity supports EdDSA with curves Ed25519 and Ed448.<a class="pilcrow" href="#section-8.3-7.1">¶</a>
</li>
          <li class="normal" id="section-8.3-7.2">The second element indicates that the entity supports ECDSA with SHA-256 with curves P-256 and P-521.<a class="pilcrow" href="#section-8.3-7.2">¶</a>
</li>
          <li class="normal" id="section-8.3-7.3">
            The third element indicates that the entity supports Ephemeral-Static ECDH using AES256 key wrap.
            The entity can support the P-256 curve with an EC2 key type and the X25519 curve with an OKP key type.<a class="pilcrow" href="#section-8.3-7.3">¶</a>
</li>
          <li class="normal" id="section-8.3-7.4">The last element indicates that the entity supports AES-GCM of 128 bits for content encryption.<a class="pilcrow" href="#section-8.3-7.4">¶</a>
</li>
        </ul>
<p id="section-8.3-8">
          The entity does not advertise that it supports any MAC algorithms.<a class="pilcrow" href="#section-8.3-8">¶</a></p>
</section>
</div>
</section>
</div>
<div id="CBOR-Canonical">
<section id="section-9">
      <h2 id="name-cbor-encoding-restrictions">
<a class="section-number selfRef" href="#section-9">9. </a><a class="section-name selfRef" href="#name-cbor-encoding-restrictions">CBOR Encoding Restrictions</a>
      </h2>
<p id="section-9-1">This document limits the restrictions it imposes on how the CBOR
  Encoder needs to work.  The new encoding restrictions are aligned with
  the Core Deterministic Encoding Requirements specified in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8949#section-4.2.1">Section 4.2.1</a> of RFC 8949 [<a class="xref" href="#STD94">STD94</a>]</span>.
  It has been narrowed down to the following restrictions:<a class="pilcrow" href="#section-9-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9-2.1">
          The restriction applies to the encoding of the COSE_KDF_Context.<a class="pilcrow" href="#section-9-2.1">¶</a>
</li>
        <li class="normal" id="section-9-2.2">
          Encoding <span class="bcp14">MUST</span> be done using definite lengths,
          and the length of the (encoded) argument <span class="bcp14">MUST</span>
          be the minimum possible length.  This means that the integer
          1 is encoded as "0x01" and not "0x1801".<a class="pilcrow" href="#section-9-2.2">¶</a>
</li>
        <li class="normal" id="section-9-2.3">
          Applications <span class="bcp14">MUST NOT</span> generate messages with the same label used twice as a key in a single map. 
          Applications <span class="bcp14">MUST NOT</span> parse and process messages with
   the same label used twice as a key in a single map. 
          Applications can enforce the parse-and-process
      requirement by using parsers that will fail the parse step or by
      using parsers that will pass all keys to the application, and the
      application can perform the check for duplicate keys.<a class="pilcrow" href="#section-9-2.3">¶</a>
</li>
      </ul>
</section>
</div>
<div id="iana-considerations">
<section id="section-10">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-10">10. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<p id="section-10-1">IANA has updated all COSE registries except for "COSE
      Header Parameters" and "COSE Key Common Parameters" to point to this document instead of <span>[<a class="xref" href="#RFC8152">RFC8152</a>]</span>.<a class="pilcrow" href="#section-10-1">¶</a></p>
<section id="section-10.1">
        <h3 id="name-changes-to-the-cose-key-typ">
<a class="section-number selfRef" href="#section-10.1">10.1. </a><a class="section-name selfRef" href="#name-changes-to-the-cose-key-typ">Changes to the "COSE Key Types" Registry</a>
        </h3>
<p id="section-10.1-1">
        IANA has added a new column in the "COSE Key Types" registry.
        The new column is labeled "Capabilities" and has been populated according to the entries in <a class="xref" href="#initial-kty-caps">Table 22</a>.<a class="pilcrow" href="#section-10.1-1">¶</a></p>
<span id="name-key-type-capabilities"></span><div id="initial-kty-caps">
<table class="center" id="table-22">
          <caption>
<a class="selfRef" href="#table-22">Table 22</a>:
<a class="selfRef" href="#name-key-type-capabilities">Key Type Capabilities</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Value</th>
              <th class="text-left" colspan="1" rowspan="1">Name</th>
              <th class="text-left" colspan="1" rowspan="1">Capabilities</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">1</td>
              <td class="text-left" colspan="1" rowspan="1">OKP</td>
              <td class="text-left" colspan="1" rowspan="1">[kty(1), crv]</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">2</td>
              <td class="text-left" colspan="1" rowspan="1">EC2</td>
              <td class="text-left" colspan="1" rowspan="1">[kty(2), crv]</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">3</td>
              <td class="text-left" colspan="1" rowspan="1">RSA</td>
              <td class="text-left" colspan="1" rowspan="1">[kty(3)]</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">4</td>
              <td class="text-left" colspan="1" rowspan="1">Symmetric</td>
              <td class="text-left" colspan="1" rowspan="1">[kty(4)]</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">5</td>
              <td class="text-left" colspan="1" rowspan="1">HSS-LMS</td>
              <td class="text-left" colspan="1" rowspan="1">[kty(5), hash algorithm]</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">6</td>
              <td class="text-left" colspan="1" rowspan="1">WalnutDSA</td>
              <td class="text-left" colspan="1" rowspan="1">[kty(6), N value, q value]</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
<section id="section-10.2">
        <h3 id="name-changes-to-the-cose-algorit">
<a class="section-number selfRef" href="#section-10.2">10.2. </a><a class="section-name selfRef" href="#name-changes-to-the-cose-algorit">Changes to the "COSE Algorithms" Registry</a>
        </h3>
<p id="section-10.2-1">
          IANA has added a new column in the "COSE Algorithms" registry.
          The new column is labeled "Capabilities" and has been populated with "[kty]" for all current,
   nonprovisional registrations.<a class="pilcrow" href="#section-10.2-1">¶</a></p>
<p id="section-10.2-2">
          IANA has updated the Reference column in the "COSE Algorithms" registry to include this document as a reference for all rows where it was not already present.<a class="pilcrow" href="#section-10.2-2">¶</a></p>
<p id="section-10.2-3">
          IANA has added a new row to the "COSE Algorithms" registry.<a class="pilcrow" href="#section-10.2-3">¶</a></p>
<span id="name-new-entry-in-the-cose-algor"></span><table class="center" id="table-23">
          <caption>
<a class="selfRef" href="#table-23">Table 23</a>:
<a class="selfRef" href="#name-new-entry-in-the-cose-algor">New entry in the COSE Algorithms registry</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Name</th>
              <th class="text-left" colspan="1" rowspan="1">Value</th>
              <th class="text-left" colspan="1" rowspan="1">Description</th>
              <th class="text-left" colspan="1" rowspan="1">Reference</th>
              <th class="text-left" colspan="1" rowspan="1">Recommended</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">IV-GENERATION</td>
              <td class="text-left" colspan="1" rowspan="1">34</td>
              <td class="text-left" colspan="1" rowspan="1">For doing IV generation for symmetric algorithms.</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9053</td>
              <td class="text-left" colspan="1" rowspan="1">No</td>
            </tr>
          </tbody>
        </table>
<p id="section-10.2-5">
          The Capabilities column for this registration is to be empty.<a class="pilcrow" href="#section-10.2-5">¶</a></p>
</section>
<section id="section-10.3">
        <h3 id="name-changes-to-the-cose-key-type">
<a class="section-number selfRef" href="#section-10.3">10.3. </a><a class="section-name selfRef" href="#name-changes-to-the-cose-key-type">Changes to the "COSE Key Type Parameters" Registry</a>
        </h3>
<p id="section-10.3-1">
          IANA has modified the description to "Public Key" for the
   line with "Key Type" of 1 and the "Name" of "x".
          See <a class="xref" href="#x-table-ec1-keys">Table 20</a>, which has been modified with
   this change.<a class="pilcrow" href="#section-10.3-1">¶</a></p>
</section>
<div id="review">
<section id="section-10.4">
        <h3 id="name-expert-review-instructions">
<a class="section-number selfRef" href="#section-10.4">10.4. </a><a class="section-name selfRef" href="#name-expert-review-instructions">Expert Review Instructions</a>
        </h3>
<p id="section-10.4-1">
          All of the IANA registries established by <span>[<a class="xref" href="#RFC8152">RFC8152</a>]</span> are, at least in part, defined as Expert Review <span>[<a class="xref" href="#RFC8126">RFC8126</a>]</span>.  This section gives some general guidelines for what the experts should be looking for, but they are being designated as experts for a reason, so they should be given substantial latitude.<a class="pilcrow" href="#section-10.4-1">¶</a></p>
<p id="section-10.4-2">Expert reviewers should take the following into consideration:<a class="pilcrow" href="#section-10.4-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.4-3.1">Point squatting should be discouraged.  Reviewers are encouraged to get sufficient information for registration requests to ensure that the usage is not going to duplicate an existing registration and that the code point is likely to be used in deployments.  The ranges tagged as private use are intended for testing purposes and closed environments; code points in other ranges should not be assigned for testing.<a class="pilcrow" href="#section-10.4-3.1">¶</a>
</li>
          <li class="normal" id="section-10.4-3.2">Standards Track or BCP RFCs are required to register a code point in the Standards Action range.
Specifications should exist for Specification Required ranges,
but early assignment before an RFC is available is considered to be
permissible.  Specifications are needed for the first-come, first-served range
if the points are expected to be used outside of closed environments in an
interoperable way.  When specifications are not provided, the description
provided needs to have sufficient information to identify what the point is
being used for.<a class="pilcrow" href="#section-10.4-3.2">¶</a>
</li>
          <li class="normal" id="section-10.4-3.3">Experts should take into account the expected usage of fields when
approving code point assignment.  
The fact that the Standards Action range is only available to Standards Track documents does not mean that a Standards Track document cannot have points assigned outside of that range. The length of the encoded value should
be weighed against how many code points of that length are left and the size of
device it will be used on.<a class="pilcrow" href="#section-10.4-3.3">¶</a>
</li>
          <li class="normal" id="section-10.4-3.4">When algorithms are registered, vanity registrations should be discouraged.  One way to do this is to require registrations to provide additional documentation on security analysis of the algorithm.  Another thing that should be considered is requesting an opinion on the algorithm from the Crypto Forum Research Group (CFRG). Algorithms are expected to meet the security requirements of the
community and the requirements of the message structures in order to be
suitable for registration.<a class="pilcrow" href="#section-10.4-3.4">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-11">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-11">11. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<p id="section-11-1">There are a number of security considerations that need to be taken into account by implementers of this specification.  The security considerations that are specific to an individual algorithm are placed next to the description of the algorithm.  While some considerations have been highlighted here, additional considerations may be found in the documents listed in the references.<a class="pilcrow" href="#section-11-1">¶</a></p>
<p id="section-11-2">Implementations need to protect the private key material for all
      individuals.  Some cases in this document need to be highlighted with
      regard to this issue.<a class="pilcrow" href="#section-11-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11-3.1">Use of the same key for two different algorithms can leak information about the key.  It is therefore recommended that keys be restricted to a single algorithm.<a class="pilcrow" href="#section-11-3.1">¶</a>
</li>
        <li class="normal" id="section-11-3.2">Use of "direct" as a recipient algorithm combined with a second recipient algorithm exposes the direct key to the second recipient; <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9052#section-8.5">Section 8.5</a> of [<a class="xref" href="#RFC9052">RFC9052</a>]</span> forbids combining "direct" recipient algorithms with other modes.<a class="pilcrow" href="#section-11-3.2">¶</a>
</li>
        <li class="normal" id="section-11-3.3">Several of the algorithms in this document have limits on the number of times that a key can be used without leaking information about the key.<a class="pilcrow" href="#section-11-3.3">¶</a>
</li>
      </ul>
<p id="section-11-4">The use of ECDH and direct plus KDF (with no key wrap) will not
      directly lead to the private key being leaked; the one-way function of
      the KDF will prevent that.  There is, however, a different issue that
      needs to be addressed.  Having two recipients requires that the CEK be
      shared between two recipients.  The second recipient therefore has a CEK
      that was derived from material that can be used for the weak proof of
      origin.  The second recipient could create a message using the same CEK
      and send it to the first recipient; the first recipient would, for
      either Static-Static ECDH or direct plus KDF, make an assumption that
      the CEK could be used for proof of origin, even though it is from the
      wrong entity.  If the key wrap step is added, then no proof of origin is
      implied and this is not an issue.<a class="pilcrow" href="#section-11-4">¶</a></p>
<p id="section-11-5">Although it has been mentioned before, it bears repeating that the use of a single key for
      multiple algorithms has been demonstrated in some cases to leak
      information about a key, providing the opportunity for attackers to forge
      integrity tags or gain information about encrypted content.  Binding a
      key to a single algorithm prevents these problems.  Key creators and key
      consumers are strongly encouraged to not only create new keys for each
      different algorithm, but to include that selection of algorithm in any
      distribution of key material and strictly enforce the matching of
      algorithms in the key structure to algorithms in the message structure.
      In addition to checking that algorithms are correct, the key form needs
      to be checked as well.  Do not use an "EC2" key where an "OKP" key is
      expected.<a class="pilcrow" href="#section-11-5">¶</a></p>
<p id="section-11-6">Before using a key for transmission, or before acting on information
      received, a trust decision on a key needs to be made.  Is the data or
      action something that the entity associated with the key has a right to
      see or a right to request? A number of factors are associated with this
      trust decision.  Some highlighted here are:<a class="pilcrow" href="#section-11-6">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11-7.1">What are the permissions associated with the key owner?<a class="pilcrow" href="#section-11-7.1">¶</a>
</li>
        <li class="normal" id="section-11-7.2">Is the cryptographic algorithm acceptable in the current context?<a class="pilcrow" href="#section-11-7.2">¶</a>
</li>
        <li class="normal" id="section-11-7.3">Have the restrictions associated with the key, such as algorithm
 or freshness, been checked, and are they correct?<a class="pilcrow" href="#section-11-7.3">¶</a>
</li>
        <li class="normal" id="section-11-7.4">Is the request something that is reasonable, given the current state of the application?<a class="pilcrow" href="#section-11-7.4">¶</a>
</li>
        <li class="normal" id="section-11-7.5">Have any security considerations that are part of the message been enforced (as specified by the application or "crit" header parameter)?<a class="pilcrow" href="#section-11-7.5">¶</a>
</li>
      </ul>
<p id="section-11-8">There are a large number of algorithms presented in this
      document that use nonce values.  For all of the nonces defined
      in this document, there is some type of restriction on the nonce
      being a unique value for either a key or some other
      conditions.  In all of these cases, there is no known
      requirement on the nonce being both unique and unpredictable;
      under these circumstances, it's reasonable to use a counter for
      creation of the nonce.  In cases where one wants the pattern of
      the nonce to be unpredictable as well as unique, one can use a
      key created for that purpose and encrypt the counter to produce
      the nonce value.<a class="pilcrow" href="#section-11-8">¶</a></p>
<p id="section-11-9">One area that has been getting
      exposure is traffic analysis of encrypted messages based on the
      length of the message.  This specification does not provide
      a uniform method for providing padding as part of the message
      structure.  An observer can distinguish between two different
      messages (for example, "YES" and "NO") based on the length for
      all of the content encryption algorithms that are defined in
      this document.  This means that it is up to the applications to
      document how content padding is to be done in order to prevent
      or discourage such analysis.  (For example, the text strings
      could be defined as "YES" and "NO ".)<a class="pilcrow" href="#section-11-9">¶</a></p>
<p id="section-11-10"> The analysis done
      in <span>[<a class="xref" href="#RFC9147">RFC9147</a>]</span> is based on the number of records that
      are sent.  This should map well to the number of messages sent
      when using COSE, so that analysis should hold here as well, under
      the assumption that the COSE messages are roughly the same size
      as DTLS records.
It needs to be noted that the limits are based on the number of messages,
 but QUIC and DTLS are always pairwise-based endpoints.  In contrast, <span>[<a class="xref" href="#I-D.ietf-core-oscore-groupcomm">OSCORE-GROUPCOMM</a>]</span>  uses COSE in a group communication scenario.  Under these circumstances, it may be that no one
      single entity will see all of the messages that are encrypted, and
      therefore no single entity can trigger the rekey operation.<a class="pilcrow" href="#section-11-10">¶</a></p>
</section>
</div>
<section id="section-12">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-12">12. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-12.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-12.1">12.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="AES-GCM">[AES-GCM]</dt>
        <dd>
<span class="refAuthor">Dworkin, M.</span>, <span class="refTitle">"Recommendation for Block Cipher Modes of Operation: Galois/Counter Mode (GCM) and GMAC"</span>, <span class="seriesInfo">NIST Special Publication 800-38D</span>, <span class="seriesInfo">DOI 10.6028/NIST.SP.800-38D</span>, <time class="refDate" datetime="2007-11">November 2007</time>, <span>&lt;<a href="https://csrc.nist.gov/publications/nistpubs/800-38D/SP-800-38D.pdf">https://csrc.nist.gov/publications/nistpubs/800-38D/SP-800-38D.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="DSS">[DSS]</dt>
        <dd>
<span class="refAuthor">National Institute of Standards and Technology</span>, <span class="refTitle">"Digital Signature Standard (DSS)"</span>, <span class="seriesInfo">FIPS PUB 186-4</span>, <span class="seriesInfo">DOI 10.6028/NIST.FIPS.186-4</span>, <time class="refDate" datetime="2013-07">July 2013</time>, <span>&lt;<a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.186-4.pdf">https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.186-4.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="MAC">[MAC]</dt>
        <dd>
<span class="refAuthor">Menezes, A.</span>, <span class="refAuthor">van Oorschot, P.</span>, and <span class="refAuthor">S. Vanstone</span>, <span class="refTitle">"Handbook of Applied Cryptography"</span>, <span class="refContent">CRC Press, Boca Raton</span>, <time class="refDate" datetime="1996">1996</time>, <span>&lt;<a href="https://cacr.uwaterloo.ca/hac/">https://cacr.uwaterloo.ca/hac/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2104">[RFC2104]</dt>
        <dd>
<span class="refAuthor">Krawczyk, H.</span>, <span class="refAuthor">Bellare, M.</span>, and <span class="refAuthor">R. Canetti</span>, <span class="refTitle">"HMAC: Keyed-Hashing for Message Authentication"</span>, <span class="seriesInfo">RFC 2104</span>, <span class="seriesInfo">DOI 10.17487/RFC2104</span>, <time class="refDate" datetime="1997-02">February 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2104">https://www.rfc-editor.org/info/rfc2104</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time class="refDate" datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3394">[RFC3394]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span> and <span class="refAuthor">R. Housley</span>, <span class="refTitle">"Advanced Encryption Standard (AES) Key Wrap Algorithm"</span>, <span class="seriesInfo">RFC 3394</span>, <span class="seriesInfo">DOI 10.17487/RFC3394</span>, <time class="refDate" datetime="2002-09">September 2002</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3394">https://www.rfc-editor.org/info/rfc3394</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3610">[RFC3610]</dt>
        <dd>
<span class="refAuthor">Whiting, D.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">N. Ferguson</span>, <span class="refTitle">"Counter with CBC-MAC (CCM)"</span>, <span class="seriesInfo">RFC 3610</span>, <span class="seriesInfo">DOI 10.17487/RFC3610</span>, <time class="refDate" datetime="2003-09">September 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3610">https://www.rfc-editor.org/info/rfc3610</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5869">[RFC5869]</dt>
        <dd>
<span class="refAuthor">Krawczyk, H.</span> and <span class="refAuthor">P. Eronen</span>, <span class="refTitle">"HMAC-based Extract-and-Expand Key Derivation Function (HKDF)"</span>, <span class="seriesInfo">RFC 5869</span>, <span class="seriesInfo">DOI 10.17487/RFC5869</span>, <time class="refDate" datetime="2010-05">May 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5869">https://www.rfc-editor.org/info/rfc5869</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6090">[RFC6090]</dt>
        <dd>
<span class="refAuthor">McGrew, D.</span>, <span class="refAuthor">Igoe, K.</span>, and <span class="refAuthor">M. Salter</span>, <span class="refTitle">"Fundamental Elliptic Curve Cryptography Algorithms"</span>, <span class="seriesInfo">RFC 6090</span>, <span class="seriesInfo">DOI 10.17487/RFC6090</span>, <time class="refDate" datetime="2011-02">February 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6090">https://www.rfc-editor.org/info/rfc6090</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6979">[RFC6979]</dt>
        <dd>
<span class="refAuthor">Pornin, T.</span>, <span class="refTitle">"Deterministic Usage of the Digital Signature Algorithm (DSA) and Elliptic Curve Digital Signature Algorithm (ECDSA)"</span>, <span class="seriesInfo">RFC 6979</span>, <span class="seriesInfo">DOI 10.17487/RFC6979</span>, <time class="refDate" datetime="2013-08">August 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6979">https://www.rfc-editor.org/info/rfc6979</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7748">[RFC7748]</dt>
        <dd>
<span class="refAuthor">Langley, A.</span>, <span class="refAuthor">Hamburg, M.</span>, and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"Elliptic Curves for Security"</span>, <span class="seriesInfo">RFC 7748</span>, <span class="seriesInfo">DOI 10.17487/RFC7748</span>, <time class="refDate" datetime="2016-01">January 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7748">https://www.rfc-editor.org/info/rfc7748</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8017">[RFC8017]</dt>
        <dd>
<span class="refAuthor">Moriarty, K., Ed.</span>, <span class="refAuthor">Kaliski, B.</span>, <span class="refAuthor">Jonsson, J.</span>, and <span class="refAuthor">A. Rusch</span>, <span class="refTitle">"PKCS #1: RSA Cryptography Specifications Version 2.2"</span>, <span class="seriesInfo">RFC 8017</span>, <span class="seriesInfo">DOI 10.17487/RFC8017</span>, <time class="refDate" datetime="2016-11">November 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8017">https://www.rfc-editor.org/info/rfc8017</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8032">[RFC8032]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span> and <span class="refAuthor">I. Liusvaara</span>, <span class="refTitle">"Edwards-Curve Digital Signature Algorithm (EdDSA)"</span>, <span class="seriesInfo">RFC 8032</span>, <span class="seriesInfo">DOI 10.17487/RFC8032</span>, <time class="refDate" datetime="2017-01">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8032">https://www.rfc-editor.org/info/rfc8032</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time class="refDate" datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8439">[RFC8439]</dt>
        <dd>
<span class="refAuthor">Nir, Y.</span> and <span class="refAuthor">A. Langley</span>, <span class="refTitle">"ChaCha20 and Poly1305 for IETF Protocols"</span>, <span class="seriesInfo">RFC 8439</span>, <span class="seriesInfo">DOI 10.17487/RFC8439</span>, <time class="refDate" datetime="2018-06">June 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8439">https://www.rfc-editor.org/info/rfc8439</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9052">[RFC9052]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Structures and Process"</span>, <span class="seriesInfo">STD 96</span>, <span class="seriesInfo">RFC 9052</span>, <span class="seriesInfo">DOI 10.17487/RFC9052</span>, <time class="refDate" datetime="2022-08">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9052">https://www.rfc-editor.org/info/rfc9052</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SEC1">[SEC1]</dt>
        <dd>
<span class="refAuthor">Certicom Research</span>, <span class="refTitle">"SEC 1: Elliptic Curve Cryptography"</span>, <span class="refContent">Standards for Efficient Cryptography</span>, <time class="refDate" datetime="2009-05">May 2009</time>, <span>&lt;<a href="https://www.secg.org/sec1-v2.pdf">https://www.secg.org/sec1-v2.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="STD94">[STD94]</dt>
      <dd>
<span class="refAuthor">Bormann, C.</span> and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">STD 94</span>, <span class="seriesInfo">RFC 8949</span>, <time class="refDate" datetime="2020-12">December 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/std94">https://www.rfc-editor.org/info/std94</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-12.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-12.2">12.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.mattsson-cfrg-det-sigs-with-noise">[CFRG-DET-SIGS]</dt>
        <dd>
<span class="refAuthor">Mattsson, J. P.</span>, <span class="refAuthor">Thormarker, E.</span>, and <span class="refAuthor">S. Ruohomaa</span>, <span class="refTitle">"Deterministic ECDSA and EdDSA Signatures with Additional Randomness"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-mattsson-cfrg-det-sigs-with-noise-04</span>, <time class="refDate" datetime="2022-02-15">15 February 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-mattsson-cfrg-det-sigs-with-noise-04">https://datatracker.ietf.org/doc/html/draft-mattsson-cfrg-det-sigs-with-noise-04</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-cose-countersign">[COUNTERSIGN]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span> and <span class="refAuthor">R. Housley</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Countersignatures"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-cose-countersign-08</span>, <time class="refDate" datetime="2022-08-22">22 August 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-cose-countersign-08">https://datatracker.ietf.org/doc/html/draft-ietf-cose-countersign-08</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="GitHub-Examples">[GitHub-Examples]</dt>
        <dd>
<span class="refTitle">"GitHub Examples of COSE"</span>, <span class="refContent">commit 3221310</span>, <time class="refDate" datetime="2020-06-03">3 June 2020</time>, <span>&lt;<a href="https://github.com/cose-wg/Examples">https://github.com/cose-wg/Examples</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="HKDF">[HKDF]</dt>
        <dd>
<span class="refAuthor">Krawczyk, H.</span>, <span class="refTitle">"Cryptographic Extraction and Key Derivation: The HKDF Scheme"</span>, <time class="refDate" datetime="2010">2010</time>, <span>&lt;<a href="https://eprint.iacr.org/2010/264.pdf">https://eprint.iacr.org/2010/264.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-core-oscore-groupcomm">[OSCORE-GROUPCOMM]</dt>
        <dd>
<span class="refAuthor">Tiloca, M.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Palombini, F.</span>, <span class="refAuthor">Mattsson, J. P.</span>, and <span class="refAuthor">J. Park</span>, <span class="refTitle">"Group OSCORE - Secure Group Communication for CoAP"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-core-oscore-groupcomm-14</span>, <time class="refDate" datetime="2022-03-07">7 March 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-14">https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-14</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4231">[RFC4231]</dt>
        <dd>
<span class="refAuthor">Nystrom, M.</span>, <span class="refTitle">"Identifiers and Test Vectors for HMAC-SHA-224, HMAC-SHA-256, HMAC-SHA-384, and HMAC-SHA-512"</span>, <span class="seriesInfo">RFC 4231</span>, <span class="seriesInfo">DOI 10.17487/RFC4231</span>, <time class="refDate" datetime="2005-12">December 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4231">https://www.rfc-editor.org/info/rfc4231</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4493">[RFC4493]</dt>
        <dd>
<span class="refAuthor">Song, JH.</span>, <span class="refAuthor">Poovendran, R.</span>, <span class="refAuthor">Lee, J.</span>, and <span class="refAuthor">T. Iwata</span>, <span class="refTitle">"The AES-CMAC Algorithm"</span>, <span class="seriesInfo">RFC 4493</span>, <span class="seriesInfo">DOI 10.17487/RFC4493</span>, <time class="refDate" datetime="2006-06">June 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4493">https://www.rfc-editor.org/info/rfc4493</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5116">[RFC5116]</dt>
        <dd>
<span class="refAuthor">McGrew, D.</span>, <span class="refTitle">"An Interface and Algorithms for Authenticated Encryption"</span>, <span class="seriesInfo">RFC 5116</span>, <span class="seriesInfo">DOI 10.17487/RFC5116</span>, <time class="refDate" datetime="2008-01">January 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5116">https://www.rfc-editor.org/info/rfc5116</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5480">[RFC5480]</dt>
        <dd>
<span class="refAuthor">Turner, S.</span>, <span class="refAuthor">Brown, D.</span>, <span class="refAuthor">Yiu, K.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">T. Polk</span>, <span class="refTitle">"Elliptic Curve Cryptography Subject Public Key Information"</span>, <span class="seriesInfo">RFC 5480</span>, <span class="seriesInfo">DOI 10.17487/RFC5480</span>, <time class="refDate" datetime="2009-03">March 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5480">https://www.rfc-editor.org/info/rfc5480</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6151">[RFC6151]</dt>
        <dd>
<span class="refAuthor">Turner, S.</span> and <span class="refAuthor">L. Chen</span>, <span class="refTitle">"Updated Security Considerations for the MD5 Message-Digest and the HMAC-MD5 Algorithms"</span>, <span class="seriesInfo">RFC 6151</span>, <span class="seriesInfo">DOI 10.17487/RFC6151</span>, <time class="refDate" datetime="2011-03">March 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6151">https://www.rfc-editor.org/info/rfc6151</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7252">[RFC7252]</dt>
        <dd>
<span class="refAuthor">Shelby, Z.</span>, <span class="refAuthor">Hartke, K.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"The Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7252</span>, <span class="seriesInfo">DOI 10.17487/RFC7252</span>, <time class="refDate" datetime="2014-06">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7252">https://www.rfc-editor.org/info/rfc7252</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7518">[RFC7518]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refTitle">"JSON Web Algorithms (JWA)"</span>, <span class="seriesInfo">RFC 7518</span>, <span class="seriesInfo">DOI 10.17487/RFC7518</span>, <time class="refDate" datetime="2015-05">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7518">https://www.rfc-editor.org/info/rfc7518</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time class="refDate" datetime="2017-06">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8152">[RFC8152]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE)"</span>, <span class="seriesInfo">RFC 8152</span>, <span class="seriesInfo">DOI 10.17487/RFC8152</span>, <time class="refDate" datetime="2017-07">July 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8152">https://www.rfc-editor.org/info/rfc8152</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8230">[RFC8230]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refTitle">"Using RSA Algorithms with CBOR Object Signing and Encryption (COSE) Messages"</span>, <span class="seriesInfo">RFC 8230</span>, <span class="seriesInfo">DOI 10.17487/RFC8230</span>, <time class="refDate" datetime="2017-09">September 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8230">https://www.rfc-editor.org/info/rfc8230</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time class="refDate" datetime="2018-08">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8551">[RFC8551]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refAuthor">Ramsdell, B.</span>, and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"Secure/Multipurpose Internet Mail Extensions (S/MIME) Version 4.0 Message Specification"</span>, <span class="seriesInfo">RFC 8551</span>, <span class="seriesInfo">DOI 10.17487/RFC8551</span>, <time class="refDate" datetime="2019-04">April 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8551">https://www.rfc-editor.org/info/rfc8551</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8610">[RFC8610]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Vigano, C.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"Concise Data Definition Language (CDDL): A Notational Convention to Express Concise Binary Object Representation (CBOR) and JSON Data Structures"</span>, <span class="seriesInfo">RFC 8610</span>, <span class="seriesInfo">DOI 10.17487/RFC8610</span>, <time class="refDate" datetime="2019-06">June 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8610">https://www.rfc-editor.org/info/rfc8610</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8778">[RFC8778]</dt>
        <dd>
<span class="refAuthor">Housley, R.</span>, <span class="refTitle">"Use of the HSS/LMS Hash-Based Signature Algorithm with CBOR Object Signing and Encryption (COSE)"</span>, <span class="seriesInfo">RFC 8778</span>, <span class="seriesInfo">DOI 10.17487/RFC8778</span>, <time class="refDate" datetime="2020-04">April 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8778">https://www.rfc-editor.org/info/rfc8778</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9021">[RFC9021]</dt>
        <dd>
<span class="refAuthor">Atkins, D.</span>, <span class="refTitle">"Use of the Walnut Digital Signature Algorithm with CBOR Object Signing and Encryption (COSE)"</span>, <span class="seriesInfo">RFC 9021</span>, <span class="seriesInfo">DOI 10.17487/RFC9021</span>, <time class="refDate" datetime="2021-05">May 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9021">https://www.rfc-editor.org/info/rfc9021</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9147">[RFC9147]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refAuthor">Tschofenig, H.</span>, and <span class="refAuthor">N. Modadugu</span>, <span class="refTitle">"The Datagram Transport Layer Security (DTLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 9147</span>, <span class="seriesInfo">DOI 10.17487/RFC9147</span>, <time class="refDate" datetime="2022-04">April 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9147">https://www.rfc-editor.org/info/rfc9147</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ROBUST">[ROBUST]</dt>
        <dd>
<span class="refAuthor">Fischlin, M.</span>, <span class="refAuthor">Günther, F.</span>, and <span class="refAuthor">C. Janson</span>, <span class="refTitle">"Robust Channels: Handling Unreliable Networks in the Record Layers of QUIC and DTLS"</span>, <time class="refDate" datetime="2020-02">February 2020</time>, <span>&lt;<a href="https://eprint.iacr.org/2020/718.pdf">https://eprint.iacr.org/2020/718.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SP800-38D">[SP800-38D]</dt>
        <dd>
<span class="refAuthor">Dworkin, M.</span>, <span class="refTitle">"Recommendation for Block Cipher Modes of Operation: Galois/Counter Mode (GCM) and GMAC"</span>, <span class="seriesInfo">NIST Special Publication 800-38D</span>, <time class="refDate" datetime="2007-11">November 2007</time>, <span>&lt;<a href="https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-38d.pdf">https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-38d.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SP800-56A">[SP800-56A]</dt>
        <dd>
<span class="refAuthor">Barker, E.</span>, <span class="refAuthor">Chen, L.</span>, <span class="refAuthor">Roginsky, A.</span>, <span class="refAuthor">Vassilev, A.</span>, and <span class="refAuthor">R. Davis</span>, <span class="refTitle">"Recommendation for Pair-Wise Key Establishment Schemes Using Discrete Logarithm Cryptography"</span>, <span class="refContent">NIST Special Publication 800-56A, Revision 3</span>, <span class="seriesInfo">DOI 10.6028/NIST.SP.800-56Ar3</span>, <time class="refDate" datetime="2018-04">April 2018</time>, <span>&lt;<a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-56Ar2.pdf">https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-56Ar2.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="STD90">[STD90]</dt>
      <dd>
<span class="refAuthor">Bray, T., Ed.</span>, <span class="refTitle">"The JavaScript Object Notation (JSON) Data Interchange Format"</span>, <span class="seriesInfo">STD 90</span>, <span class="seriesInfo">RFC 8259</span>, <time class="refDate" datetime="2017-12">December 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/std90">https://www.rfc-editor.org/info/std90</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<section id="appendix-A">
      <h2 id="name-acknowledgments">
<a class="section-name selfRef" href="#name-acknowledgments">Acknowledgments</a>
      </h2>
<p id="appendix-A-1">This document is a product of the COSE Working Group of the IETF.<a class="pilcrow" href="#appendix-A-1">¶</a></p>
<p id="appendix-A-2">The following individuals are to blame for getting me started on this
      project in the first place: <span class="contact-name">Richard Barnes</span>,
      <span class="contact-name">Matt Miller</span>, and <span class="contact-name">Martin       Thomson</span>.<a class="pilcrow" href="#appendix-A-2">¶</a></p>
<p id="appendix-A-3">The initial draft version of the specification was based to some degree on
      the outputs of the JOSE and S/MIME Working Groups.<a class="pilcrow" href="#appendix-A-3">¶</a></p>
<p id="appendix-A-4">The following individuals provided input into the final form of the
      document: <span class="contact-name">Carsten Bormann</span>, <span class="contact-name">John       Bradley</span>, <span class="contact-name">Brian Campbell</span>, <span class="contact-name">Michael B. Jones</span>, <span class="contact-name">Ilari Liusvaara</span>,
      <span class="contact-name">Francesca Palombini</span>, <span class="contact-name">Ludwig       Seitz</span>, and <span class="contact-name">Göran Selander</span>.<a class="pilcrow" href="#appendix-A-4">¶</a></p>
</section>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-address">
<a class="section-name selfRef" href="#name-authors-address">Author's Address</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Jim Schaad</span></div>
<div class="left" dir="auto"><span class="org">August Cellars</span></div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>