<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 9008: Using RPI Option Type, Routing Header for Source Routes, and IPv6-in-IPv6 Encapsulation in the RPL Data Plane</title>
<meta content="Maria Ines Robles" name="author"/>
<meta content="Michael C. Richardson" name="author"/>
<meta content="Pascal Thubert" name="author"/>
<meta content="
       
        This document looks at different data flows through Low-Power and Lossy Networks (LLN) where RPL
        (IPv6 Routing Protocol for Low-Power and Lossy Networks) is used to establish routing.
        The document enumerates the cases where RPL Packet Information (RPI) Option Type (RFC 6553), 
        RPL Source Route Header (RFC 6554), 
        and IPv6-in-IPv6 encapsulation are required in the data plane.
        This analysis provides the basis upon which to design efficient compression of these headers.
        This document updates RFC 6553 by adding a change to the RPI Option Type. Additionally, this document updates
        RFC 6550 by defining a flag in the DODAG Information Object (DIO) Configuration option to indicate this change and
        updates RFC 8138 as well to consider the new Option Type when the RPL Option is decompressed.
       
    " name="description"/>
<meta content="xml2rfc 3.7.0" name="generator"/>
<meta content="RPL Option" name="keyword"/>
<meta content="6LoWPAN" name="keyword"/>
<meta content="RFC 6553" name="keyword"/>
<meta content="9008" name="rfc.number"/>
<!-- Generator version information:
  xml2rfc 3.7.0
    Python 3.6.10
    appdirs 1.4.4
    ConfigArgParse 1.2.3
    google-i18n-address 2.3.5
    html5lib 1.0.1
    intervaltree 3.0.2
    Jinja2 2.11.2
    kitchen 1.2.6
    lxml 4.4.2
    pycairo 1.19.0
    pycountry 19.8.18
    pyflakes 2.1.1
    PyYAML 5.3.1
    requests 2.22.0
    setuptools 40.6.2
    six 1.14.0
    WeasyPrint 51
-->
<link href="rfc9008.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://dx.doi.org/10.17487/rfc9008" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <link href="https://datatracker.ietf.org/doc/draft-ietf-roll-useofrplinfo-44" rel="prev"/>
  </head>
<body>
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9008</td>
<td class="center">RPL Data Plane</td>
<td class="right">April 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Robles, et al.</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc9008">9008</a></dd>
<dt class="label-updates">Updates:</dt>
<dd class="updates">
<a class="eref" href="https://www.rfc-editor.org/rfc/rfc6550">6550</a>, <a class="eref" href="https://www.rfc-editor.org/rfc/rfc6553">6553</a>, <a class="eref" href="https://www.rfc-editor.org/rfc/rfc8138">8138</a> </dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2021-04">April 2021</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">M.I. Robles</div>
<div class="org">UTN-FRM/Aalto</div>
</div>
<div class="author">
      <div class="author-name">M. Richardson</div>
<div class="org">SSW</div>
</div>
<div class="author">
      <div class="author-name">P. Thubert</div>
<div class="org">Cisco</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9008</h1>
<h1 id="title">Using RPI Option Type, Routing Header for Source Routes, and IPv6-in-IPv6 Encapsulation in the RPL Data Plane</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">
        This document looks at different data flows through Low-Power and Lossy Networks (LLN) where RPL
        (IPv6 Routing Protocol for Low-Power and Lossy Networks) is used to establish routing.
        The document enumerates the cases where RPL Packet Information (RPI) Option Type (RFC 6553), 
        RPL Source Route Header (RFC 6554), 
        and IPv6-in-IPv6 encapsulation are required in the data plane.
        This analysis provides the basis upon which to design efficient compression of these headers.
        This document updates RFC 6553 by adding a change to the RPI Option Type. Additionally, this document updates
        RFC 6550 by defining a flag in the DODAG Information Object (DIO) Configuration option to indicate this change and
        updates RFC 8138 as well to consider the new Option Type when the RPL Option is decompressed.<a class="pilcrow" href="#section-abstract-1">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a class="pilcrow" href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9008">https://www.rfc-editor.org/info/rfc9008</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">▲</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.1">
            <p class="keepWithNext" id="section-toc.1-1.1.1"><a class="xref" href="#section-1">1</a>.  <a class="xref" href="#name-introduction">Introduction</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.1.2.1">
                <p class="keepWithNext" id="section-toc.1-1.1.2.1.1"><a class="xref" href="#section-1.1">1.1</a>.  <a class="xref" href="#name-overview">Overview</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.2">
            <p class="keepWithNext" id="section-toc.1-1.2.1"><a class="xref" href="#section-2">2</a>.  <a class="xref" href="#name-terminology-and-requirement">Terminology and Requirements Language</a></p>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a class="xref" href="#section-3">3</a>.  <a class="xref" href="#name-rpl-overview">RPL Overview</a></p>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="xref" href="#section-4">4</a>.  <a class="xref" href="#name-updates-to-rfc-6550-rfc-655">Updates to RFC 6550, RFC 6553, and RFC 8138</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a class="xref" href="#section-4.1">4.1</a>.  <a class="xref" href="#name-updates-to-rfc-6550">Updates to RFC 6550</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.4.2.1.2.1">
                    <p id="section-toc.1-1.4.2.1.2.1.1"><a class="xref" href="#section-4.1.1">4.1.1</a>.  <a class="xref" href="#name-advertising-external-routes">Advertising External Routes with Non-Storing Mode Signaling</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.4.2.1.2.2">
                    <p id="section-toc.1-1.4.2.1.2.2.1"><a class="xref" href="#section-4.1.2">4.1.2</a>.  <a class="xref" href="#name-configuration-options-and-m">Configuration Options and Mode of Operation</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.4.2.1.2.3">
                    <p id="section-toc.1-1.4.2.1.2.3.1"><a class="xref" href="#section-4.1.3">4.1.3</a>.  <a class="xref" href="#name-indicating-the-new-rpi-in-t">Indicating the New RPI in the DODAG Configuration Option Flag</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a class="xref" href="#section-4.2">4.2</a>.  <a class="xref" href="#name-updates-to-rfc-6553-indicat">Updates to RFC 6553: Indicating the New RPI Option Type</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a class="xref" href="#section-4.3">4.3</a>.  <a class="xref" href="#name-updates-to-rfc-8138-indicat">Updates to RFC 8138: Indicating the Way to Decompress with the New RPI Option Type</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="xref" href="#section-5">5</a>.  <a class="xref" href="#name-reference-topology">Reference Topology</a></p>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="xref" href="#section-6">6</a>.  <a class="xref" href="#name-use-cases">Use Cases</a></p>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="xref" href="#section-7">7</a>.  <a class="xref" href="#name-storing-mode">Storing Mode</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a class="xref" href="#section-7.1">7.1</a>.  <a class="xref" href="#name-storing-mode-interaction-be">Storing Mode: Interaction between Leaf and Root</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.7.2.1.2.1">
                    <p id="section-toc.1-1.7.2.1.2.1.1"><a class="xref" href="#section-7.1.1">7.1.1</a>.  <a class="xref" href="#name-sm-example-of-flow-from-ral">SM: Example of Flow from RAL to Root</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.7.2.1.2.2">
                    <p id="section-toc.1-1.7.2.1.2.2.1"><a class="xref" href="#section-7.1.2">7.1.2</a>.  <a class="xref" href="#name-sm-example-of-flow-from-roo">SM: Example of Flow from Root to RAL</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.7.2.1.2.3">
                    <p id="section-toc.1-1.7.2.1.2.3.1"><a class="xref" href="#section-7.1.3">7.1.3</a>.  <a class="xref" href="#name-sm-example-of-flow-from-root">SM: Example of Flow from Root to RUL</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.7.2.1.2.4">
                    <p id="section-toc.1-1.7.2.1.2.4.1"><a class="xref" href="#section-7.1.4">7.1.4</a>.  <a class="xref" href="#name-sm-example-of-flow-from-rul">SM: Example of Flow from RUL to Root</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a class="xref" href="#section-7.2">7.2</a>.  <a class="xref" href="#name-sm-interaction-between-leaf">SM: Interaction between Leaf and Internet</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.7.2.2.2.1">
                    <p id="section-toc.1-1.7.2.2.2.1.1"><a class="xref" href="#section-7.2.1">7.2.1</a>.  <a class="xref" href="#name-sm-example-of-flow-from-ral-">SM: Example of Flow from RAL to Internet</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.7.2.2.2.2">
                    <p id="section-toc.1-1.7.2.2.2.2.1"><a class="xref" href="#section-7.2.2">7.2.2</a>.  <a class="xref" href="#name-sm-example-of-flow-from-int">SM: Example of Flow from Internet to RAL</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.7.2.2.2.3">
                    <p id="section-toc.1-1.7.2.2.2.3.1"><a class="xref" href="#section-7.2.3">7.2.3</a>.  <a class="xref" href="#name-sm-example-of-flow-from-rul-">SM: Example of Flow from RUL to Internet</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.7.2.2.2.4">
                    <p id="section-toc.1-1.7.2.2.2.4.1"><a class="xref" href="#section-7.2.4">7.2.4</a>.  <a class="xref" href="#name-sm-example-of-flow-from-inte">SM: Example of Flow from Internet to RUL</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a class="xref" href="#section-7.3">7.3</a>.  <a class="xref" href="#name-sm-interaction-between-leaf-">SM: Interaction between Leaf and Leaf</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.7.2.3.2.1">
                    <p id="section-toc.1-1.7.2.3.2.1.1"><a class="xref" href="#section-7.3.1">7.3.1</a>.  <a class="xref" href="#name-sm-example-of-flow-from-ral-t">SM: Example of Flow from RAL to RAL</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.7.2.3.2.2">
                    <p id="section-toc.1-1.7.2.3.2.2.1"><a class="xref" href="#section-7.3.2">7.3.2</a>.  <a class="xref" href="#name-sm-example-of-flow-from-ral-to">SM: Example of Flow from RAL to RUL</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.7.2.3.2.3">
                    <p id="section-toc.1-1.7.2.3.2.3.1"><a class="xref" href="#section-7.3.3">7.3.3</a>.  <a class="xref" href="#name-sm-example-of-flow-from-rul-t">SM: Example of Flow from RUL to RAL</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.7.2.3.2.4">
                    <p id="section-toc.1-1.7.2.3.2.4.1"><a class="xref" href="#section-7.3.4">7.3.4</a>.  <a class="xref" href="#name-sm-example-of-flow-from-rul-to">SM: Example of Flow from RUL to RUL</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="xref" href="#section-8">8</a>.  <a class="xref" href="#name-non-storing-mode">Non-Storing Mode</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a class="xref" href="#section-8.1">8.1</a>.  <a class="xref" href="#name-non-storing-mode-interactio">Non-Storing Mode: Interaction between Leaf and Root</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.8.2.1.2.1">
                    <p id="section-toc.1-1.8.2.1.2.1.1"><a class="xref" href="#section-8.1.1">8.1.1</a>.  <a class="xref" href="#name-non-sm-example-of-flow-from">Non-SM: Example of Flow from RAL to Root</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.8.2.1.2.2">
                    <p id="section-toc.1-1.8.2.1.2.2.1"><a class="xref" href="#section-8.1.2">8.1.2</a>.  <a class="xref" href="#name-non-sm-example-of-flow-from-">Non-SM: Example of Flow from Root to RAL</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.8.2.1.2.3">
                    <p id="section-toc.1-1.8.2.1.2.3.1"><a class="xref" href="#section-8.1.3">8.1.3</a>.  <a class="xref" href="#name-non-sm-example-of-flow-from-r">Non-SM: Example of Flow from Root to RUL</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.8.2.1.2.4">
                    <p id="section-toc.1-1.8.2.1.2.4.1"><a class="xref" href="#section-8.1.4">8.1.4</a>.  <a class="xref" href="#name-non-sm-example-of-flow-from-ru">Non-SM: Example of Flow from RUL to Root</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a class="xref" href="#section-8.2">8.2</a>.  <a class="xref" href="#name-non-storing-mode-interaction">Non-Storing Mode: Interaction between Leaf and Internet</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.8.2.2.2.1">
                    <p id="section-toc.1-1.8.2.2.2.1.1"><a class="xref" href="#section-8.2.1">8.2.1</a>.  <a class="xref" href="#name-non-sm-example-of-flow-from-ra">Non-SM: Example of Flow from RAL to Internet</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.8.2.2.2.2">
                    <p id="section-toc.1-1.8.2.2.2.2.1"><a class="xref" href="#section-8.2.2">8.2.2</a>.  <a class="xref" href="#name-non-sm-example-of-flow-from-i">Non-SM: Example of Flow from Internet to RAL</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.8.2.2.2.3">
                    <p id="section-toc.1-1.8.2.2.2.3.1"><a class="xref" href="#section-8.2.3">8.2.3</a>.  <a class="xref" href="#name-non-sm-example-of-flow-from-rul">Non-SM: Example of Flow from RUL to Internet</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.8.2.2.2.4">
                    <p id="section-toc.1-1.8.2.2.2.4.1"><a class="xref" href="#section-8.2.4">8.2.4</a>.  <a class="xref" href="#name-non-sm-example-of-flow-from-in">Non-SM: Example of Flow from Internet to RUL</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a class="xref" href="#section-8.3">8.3</a>.  <a class="xref" href="#name-non-sm-interaction-between-">Non-SM: Interaction between Leaves</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.8.2.3.2.1">
                    <p id="section-toc.1-1.8.2.3.2.1.1"><a class="xref" href="#section-8.3.1">8.3.1</a>.  <a class="xref" href="#name-non-sm-example-of-flow-from-ral">Non-SM: Example of Flow from RAL to RAL</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.8.2.3.2.2">
                    <p id="section-toc.1-1.8.2.3.2.2.1"><a class="xref" href="#section-8.3.2">8.3.2</a>.  <a class="xref" href="#name-non-sm-example-of-flow-from-ral-">Non-SM: Example of Flow from RAL to RUL</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.8.2.3.2.3">
                    <p id="section-toc.1-1.8.2.3.2.3.1"><a class="xref" href="#section-8.3.3">8.3.3</a>.  <a class="xref" href="#name-non-sm-example-of-flow-from-rul-">Non-SM: Example of Flow from RUL to RAL</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.8.2.3.2.4">
                    <p id="section-toc.1-1.8.2.3.2.4.1"><a class="xref" href="#section-8.3.4">8.3.4</a>.  <a class="xref" href="#name-non-sm-example-of-flow-from-rul-t">Non-SM: Example of Flow from RUL to RUL</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="xref" href="#section-9">9</a>.  <a class="xref" href="#name-operational-considerations-">Operational Considerations of Supporting RULs</a></p>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a class="xref" href="#section-10">10</a>. <a class="xref" href="#name-operational-considerations-o">Operational Considerations of Introducing 0x23</a></p>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a class="xref" href="#section-11">11</a>. <a class="xref" href="#name-iana-considerations">IANA Considerations</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a class="xref" href="#section-11.1">11.1</a>.  <a class="xref" href="#name-option-type-in-rpl-option-2">Option Type in RPL Option</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a class="xref" href="#section-11.2">11.2</a>.  <a class="xref" href="#name-change-to-the-dodag-configu">Change to the "DODAG Configuration Option Flags" Subregistry</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.11.2.3">
                <p id="section-toc.1-1.11.2.3.1"><a class="xref" href="#section-11.3">11.3</a>.  <a class="xref" href="#name-change-mop-value-7-to-reser">Change MOP Value 7 to Reserved</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a class="xref" href="#section-12">12</a>. <a class="xref" href="#name-security-considerations">Security Considerations</a></p>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a class="xref" href="#section-13">13</a>. <a class="xref" href="#name-references">References</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a class="xref" href="#section-13.1">13.1</a>.  <a class="xref" href="#name-normative-references">Normative References</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a class="xref" href="#section-13.2">13.2</a>.  <a class="xref" href="#name-informative-references">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a class="xref" href="#section-appendix.a"></a><a class="xref" href="#name-acknowledgments">Acknowledgments</a></p>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a class="xref" href="#section-appendix.b"></a><a class="xref" href="#name-authors-addresses">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">
               RPL (IPv6 Routing Protocol for Low-Power and Lossy Networks)
               <span>[<a class="xref" href="#RFC6550">RFC6550</a>]</span> is a routing protocol for
                constrained networks. <span>[<a class="xref" href="#RFC6553">RFC6553</a>]</span>
                defines the RPL Option carried within the IPv6 Hop-by-Hop Options
                header to carry the RPLInstanceID and quickly identify inconsistencies (loops) in the routing topology.
                The RPL Option is commonly referred to as the RPL Packet Information
                (RPI), although the RPI is the routing information that is defined
                in <span>[<a class="xref" href="#RFC6550">RFC6550</a>]</span> and transported in the RPL Option.
                RFC 6554 <span>[<a class="xref" href="#RFC6554">RFC6554</a>]</span> defines the "RPL Source Route Header" (RH3), an
                IPv6 extension header to deliver datagrams within a RPL
                routing domain, particularly in Non-Storing mode.<a class="pilcrow" href="#section-1-1">¶</a></p>
<p id="section-1-2">
                These various items are referred to as RPL artifacts, and
                they are seen on all of the data plane traffic that occurs in
                RPL-routed networks; they do not, in general, appear on the RPL
                control plane at all, which is mostly hop-by-hop
                traffic (one exception being Destination Advertisement Object (DAO) messages in Non-Storing mode).<a class="pilcrow" href="#section-1-2">¶</a></p>
<p id="section-1-3">
               It has become clear from attempts to do multi-vendor
               interoperability, and from a desire to compress as many of
               the above artifacts as possible, that not all implementers
               agree when artifacts are necessary, or when they can be safely
               omitted, or removed.<a class="pilcrow" href="#section-1-3">¶</a></p>
<p id="section-1-4">
               The ROLL (Routing Over Low power and Lossy networks) Working Group 
               analyzed how IPv6 rules <span>[<a class="xref" href="#RFC2460">RFC2460</a>]</span> apply to the Storing and
               Non-Storing use of RPL.  The result was 24 data-plane use
               cases.  They are exhaustively outlined here in order to be
               completely unambiguous.  During the processing of this
               document, new rules were published as
               <span>[<a class="xref" href="#RFC8200">RFC8200</a>]</span>, and this document was updated
               to reflect the normative changes in that document.<a class="pilcrow" href="#section-1-4">¶</a></p>
<p id="section-1-5">
               This document updates <span>[<a class="xref" href="#RFC6553">RFC6553</a>]</span>, changing the value of the Option Type of the RPL Option
               to make routers compliant with <span>[<a class="xref" href="#RFC8200">RFC8200</a>]</span> ignore this option when it is not recognized.<a class="pilcrow" href="#section-1-5">¶</a></p>
<p id="section-1-6">
               A Routing Header Dispatch for IPv6 over Low-Power Wireless Personal Area Networks (6LoWPAN) (6LoRH) <span>[<a class="xref" href="#RFC8138">RFC8138</a>]</span>
                defines a mechanism for compressing RPL Option information and Routing Header type 3 (RH3)
                <span>[<a class="xref" href="#RFC6554">RFC6554</a>]</span>, as well as an efficient IPv6-in-IPv6 technique.<a class="pilcrow" href="#section-1-6">¶</a></p>
<p id="section-1-7">
                Most of the use cases described herein require the use of IPv6-in-IPv6 packet encapsulation.
                When encapsulating and decapsulating packets, <span>[<a class="xref" href="#RFC6040">RFC6040</a>]</span> <span class="bcp14">MUST</span> be applied to map the
                setting of the explicit congestion notification (ECN) field between inner and outer headers.
                Additionally, <span>[<a class="xref" href="#I-D.ietf-intarea-tunnels">TUNNELS</a>]</span> is recommended reading to explain
                the relationship of IP tunnels to existing protocol layers and the challenges
                in supporting IP tunneling.<a class="pilcrow" href="#section-1-7">¶</a></p>
<p id="section-1-8">
                Unconstrained uses of RPL are not in scope of this document, and
                applicability statements for those uses may provide different
                advice, e.g., <span>[<a class="xref" href="#I-D.ietf-anima-autonomic-control-plane">ACP</a>]</span>.<a class="pilcrow" href="#section-1-8">¶</a></p>
<section id="section-1.1">
        <h3 id="name-overview">
<a class="section-number selfRef" href="#section-1.1">1.1. </a><a class="section-name selfRef" href="#name-overview">Overview</a>
        </h3>
<p id="section-1.1-1">
               The rest of the document is organized as follows: <a class="xref" href="#sec_terms">Section 2</a> describes the terminology that is used.
               <a class="xref" href="#sec_rpl_overview">Section 3</a> provides a RPL overview.
        <a class="xref" href="#updateRFCs_section">Section 4</a> describes the updates to RFC 6553, RFC 6550, and RFC 8138.
               <a class="xref" href="#sec_ref_topo">Section 5</a> provides the reference topology used for the use cases.
               <a class="xref" href="#sec_use_cases">Section 6</a> describes the use cases included.
               <a class="xref" href="#sec_sm">Section 7</a> describes the Storing mode cases and <a class="xref" href="#sec_non-sm">Section 8</a> the Non-Storing mode cases.
               <a class="xref" href="#notrplaware">Section 9</a> describes the operational considerations of supporting RPL-unaware leaves.
               <a class="xref" href="#sec_op_con_0x23">Section 10</a> depicts operational considerations for the proposed change on RPI Option Type, <a class="xref" href="#iana">Section 11</a> the
               IANA considerations, and then <a class="xref" href="#Security">Section 12</a> describes the security
               aspects.<a class="pilcrow" href="#section-1.1-1">¶</a></p>
</section>
</section>
<div id="sec_terms">
<section id="section-2">
      <h2 id="name-terminology-and-requirement">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-terminology-and-requirement">Terminology and Requirements Language</a>
      </h2>
<p id="section-2-1">
    The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
    "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
    described in BCP 14 <span>[<a class="xref" href="#RFC2119">RFC2119</a>]</span> <span>[<a class="xref" href="#RFC8174">RFC8174</a>]</span> 
    when, and only when, they appear in all capitals, as shown here.<a class="pilcrow" href="#section-2-1">¶</a></p>
<p id="section-2-2">
        The following terminology defined in <span>[<a class="xref" href="#RFC7102">RFC7102</a>]</span> applies to this document: LLN, RPL, RPL domain, and ROLL.<a class="pilcrow" href="#section-2-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2-3">
        <dt id="section-2-3.1">
        Consumed:</dt>
        <dd id="section-2-3.2" style="margin-left: 1.5em">A Routing Header is consumed when the Segments Left field is zero, which indicates that the
        destination in the IPv6 header is the final destination of the packet and that the hops in the Routing Header
        have been traversed.<a class="pilcrow" href="#section-2-3.2">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.3">
        RPL Leaf:</dt>
        <dd id="section-2-3.4" style="margin-left: 1.5em">An IPv6 host that is attached to a RPL router and obtains connectivity
        through a RPL Destination-Oriented Directed Acyclic Graph (DODAG). As an IPv6 node,
        a RPL leaf is expected to ignore a consumed Routing Header, and as an IPv6 host, it
        is expected to ignore a Hop-by-Hop Options header. Thus, a RPL leaf can correctly
        receive a packet with RPL artifacts. On the other hand, a RPL leaf is not expected
        to generate RPL artifacts or to support IP-in-IP encapsulation. For simplification,
        this document uses the standalone term leaf to mean a RPL leaf.<a class="pilcrow" href="#section-2-3.4">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.5">
        RPL Packet Information (RPI):</dt>
        <dd id="section-2-3.6" style="margin-left: 1.5em">
        The information defined abstractly in <span>[<a class="xref" href="#RFC6550">RFC6550</a>]</span> to be placed in IP packets.
        The term is commonly used, including in this document, to refer to the RPL Option <span>[<a class="xref" href="#RFC6553">RFC6553</a>]</span>
        that transports that abstract information in an IPv6 Hop-by-Hop Options header. <span>[<a class="xref" href="#RFC8138">RFC8138</a>]</span> provides
        an alternate (more compressed)  formatting for the same abstract information.<a class="pilcrow" href="#section-2-3.6">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.7">
        RPL-Aware Node (RAN):</dt>
        <dd id="section-2-3.8" style="margin-left: 1.5em">A device that implements RPL. Please note that the device can be found inside the LLN or outside LLN.<a class="pilcrow" href="#section-2-3.8">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.9">
        RPL-Aware Leaf (RAL):</dt>
        <dd id="section-2-3.10" style="margin-left: 1.5em">A RPL-aware node that is also a RPL leaf.<a class="pilcrow" href="#section-2-3.10">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.11">
        RPL-Unaware Node:</dt>
        <dd id="section-2-3.12" style="margin-left: 1.5em">A device that does not implement RPL, thus the device is RPL unaware.
       Please note that the device can be found inside the LLN.<a class="pilcrow" href="#section-2-3.12">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.13">
        RPL-Unaware Leaf (RUL):</dt>
        <dd id="section-2-3.14" style="margin-left: 1.5em">A RPL-unaware node that is also a RPL leaf.<a class="pilcrow" href="#section-2-3.14">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.15">
     6LoWPAN Node (6LN):</dt>
        <dd id="section-2-3.16" style="margin-left: 1.5em">
          <span>[<a class="xref" href="#RFC6775">RFC6775</a>]</span> defines it as the following:
      "A 6LoWPAN node is any host or router participating in a LoWPAN.
      This term is used when referring to situations in which either a
      host or router can play the role described." In this document, a 6LN acts as a leaf.<a class="pilcrow" href="#section-2-3.16">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.17">
      6LoWPAN Router (6LR):</dt>
        <dd id="section-2-3.18" style="margin-left: 1.5em">
          <span>[<a class="xref" href="#RFC6775">RFC6775</a>]</span> defines it as the following: 
      "An intermediate router in the LoWPAN that is able to send and
      receive Router Advertisements (RAs) and Router Solicitations (RSs)
      as well as forward and route IPv6 packets.  6LoWPAN routers are
      present only in route-over topologies."<a class="pilcrow" href="#section-2-3.18">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.19">
      6LoWPAN Border Router (6LBR):</dt>
        <dd id="section-2-3.20" style="margin-left: 1.5em">
          <span>[<a class="xref" href="#RFC6775">RFC6775</a>]</span> defines it as the following:
      "A border router located at the junction of separate 6LoWPAN
      networks or between a 6LoWPAN network and another IP network.
      There may be one or more 6LBRs at the 6LoWPAN network boundary.  A
      6LBR is the responsible authority for IPv6 prefix propagation for
      the 6LoWPAN network it is serving.  An isolated LoWPAN also
      contains a 6LBR in the network, which provides the prefix(es) for
      the isolated network."<a class="pilcrow" href="#section-2-3.20">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.21">
          Flag Day:</dt>
        <dd id="section-2-3.22" style="margin-left: 1.5em">A flag day is caused when a network is reconfigured in a way that nodes running the older configuration cannot communicate with nodes running the new configuration.  An example of a flag day is when the ARPANET changed from IP version 3 to IP version 4 on January 1, 1983 <span>[<a class="xref" href="#RFC0801">RFC0801</a>]</span>.
          In the context of this document, a switch from RPI Option Type (0x63) to Option Type (0x23) presents as a disruptive changeover.  In order to reduce the amount of time for such a changeover, <a class="xref" href="#update6550">Section 4.1.3</a> provides a mechanism to allow nodes to be incrementally upgraded.<a class="pilcrow" href="#section-2-3.22">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.23">
           Non-Storing Mode (Non-SM):</dt>
        <dd id="section-2-3.24" style="margin-left: 1.5em">A RPL mode of operation in which the RPL-aware
       nodes send information to the root about their parents.  Thus, the root knows the topology.
       Because the root knows the topology, the intermediate 6LRs do not maintain routing state, and
        source routing is needed.<a class="pilcrow" href="#section-2-3.24">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.25">
        Storing Mode (SM):</dt>
        <dd id="section-2-3.26" style="margin-left: 1.5em">A RPL mode of operation in which RPL-aware nodes (6LRs) maintain routing
        state (of the children) so that source routing is not needed.<a class="pilcrow" href="#section-2-3.26">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<aside id="section-2-4">
        <p id="section-2-4.1">
        Note: Due to lack of space in some tables, we refer to IPv6-in-IPv6 as IP6-IP6.<a class="pilcrow" href="#section-2-4.1">¶</a></p>
</aside>
</section>
</div>
<div id="sec_rpl_overview">
<section id="section-3">
      <h2 id="name-rpl-overview">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-rpl-overview">RPL Overview</a>
      </h2>
<p id="section-3-1">
        RPL defines the RPL control message (control plane), which is an
        ICMPv6 message <span>[<a class="xref" href="#RFC4443">RFC4443</a>]</span> with a Type of 155.
        DIS (DODAG Information Solicitation), DIO (DODAG Information Object),
        and DAO (Destination Advertisement Object) messages are
        all RPL control messages but with different Code values.
        A RPL stack is shown in <a class="xref" href="#fig_RPLStack">Figure 1</a>.<a class="pilcrow" href="#section-3-1">¶</a></p>
<span id="name-rpl-stack"></span><div id="fig_RPLStack">
<figure id="figure-1">
        <div class="artwork art-text alignLeft" id="section-3-2.1">
<pre>+--------------+
| Upper Layers |
|              |
+--------------+
|   RPL        |
|              |
+--------------+
|   ICMPv6     |
|              |
+--------------+
|   IPv6       |
|              |
+--------------+
|   6LoWPAN    |
|              |
+--------------+
|   PHY-MAC    |
|              |
+--------------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-1">Figure 1</a>:
<a class="selfRef" href="#name-rpl-stack">RPL Stack</a>
        </figcaption></figure>
</div>
<p id="section-3-3">
        RPL supports two modes of Downward internal traffic: in Storing mode (SM),
        it is fully stateful; in Non-Storing mode (non-SM), it is fully source
        routed. A RPL Instance is either fully Storing or fully
        Non-Storing, i.e., a RPL Instance with a combination of fully
        Storing and Non-Storing nodes is not supported with the
        current specifications at the time of writing this document.
        External routes are advertised with non-SM messaging
        even in an SM network, see <a class="xref" href="#nnstext">Section 4.1.1</a><a class="pilcrow" href="#section-3-3">¶</a></p>
</section>
</div>
<div id="updateRFCs_section">
<section id="section-4">
      <h2 id="name-updates-to-rfc-6550-rfc-655">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-updates-to-rfc-6550-rfc-655">Updates to RFC 6550, RFC 6553, and RFC 8138</a>
      </h2>
<div id="updateRFC_section6550">
<section id="section-4.1">
        <h3 id="name-updates-to-rfc-6550">
<a class="section-number selfRef" href="#section-4.1">4.1. </a><a class="section-name selfRef" href="#name-updates-to-rfc-6550">Updates to RFC 6550</a>
        </h3>
<div id="nnstext">
<section id="section-4.1.1">
          <h4 id="name-advertising-external-routes">
<a class="section-number selfRef" href="#section-4.1.1">4.1.1. </a><a class="section-name selfRef" href="#name-advertising-external-routes">Advertising External Routes with Non-Storing Mode Signaling</a>
          </h4>
<p id="section-4.1.1-1">
          <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6550#section-6.7.8">Section 6.7.8</a> of [<a class="xref" href="#RFC6550">RFC6550</a>]</span> introduces the 'E' flag that
          is set to indicate that the 6LR that generates the DAO redistributes
          external targets into the RPL network.  An external target is a target
          that has been learned through an alternate protocol, for instance, a
          route to a prefix that is outside the RPL domain but reachable via a
          6LR. Being outside of the RPL domain, a node that is reached via an
          external target cannot be guaranteed to ignore the RPL artifacts and
          cannot be expected to process the compression defined in <span>[<a class="xref" href="#RFC8138">RFC8138</a>]</span> 
          correctly. This means that the RPL artifacts should be contained in an
          IP-in-IP encapsulation that is removed by the 6LR, and that any
          remaining compression should be expanded by the 6LR before it forwards
          a packet outside the RPL domain.<a class="pilcrow" href="#section-4.1.1-1">¶</a></p>
<p id="section-4.1.1-2">
          This specification updates <span>[<a class="xref" href="#RFC6550">RFC6550</a>]</span> to say that advertising external
          targets using Non-Storing mode DAO messaging even in a Storing mode 
          network is <span class="bcp14">RECOMMENDED</span>.  This way, external routes are not
          advertised within the DODAG, and all packets to an external target
          reach the root like normal Non-Storing mode traffic. The Non-Storing
          mode DAO informs the root of the address of the 6LR that injects the
          external route, and the root uses IP-in-IP encapsulation to that 6LR,
          which terminates the IP-in-IP tunnel and forwards the original packet
          outside the RPL domain free of RPL artifacts.<a class="pilcrow" href="#section-4.1.1-2">¶</a></p>
<p id="section-4.1.1-3">
          In the other direction,
          for traffic coming from an external target into the LLN, the parent
          (6LR) that injects the traffic always encapsulates to the root.
          This whole operation is
          transparent to intermediate routers that only see traffic between the
          6LR and the root, and only the root and the 6LRs that inject external
          routes in the network need to be upgraded to add this function to the
          network.<a class="pilcrow" href="#section-4.1.1-3">¶</a></p>
<p id="section-4.1.1-4">
          A RUL is a special case of external target when the target is actually
          a host, and it is known to support a consumed Routing Header and to
          ignore a Hop-by-Hop Options header as prescribed by <span>[<a class="xref" href="#RFC8200">RFC8200</a>]</span>.
          The target may have been learned through an external routing protocol or may have
          been registered to the 6LR using <span>[<a class="xref" href="#RFC8505">RFC8505</a>]</span>.<a class="pilcrow" href="#section-4.1.1-4">¶</a></p>
<p id="section-4.1.1-5">
          In order to enable IP-in-IP all the way to a 6LN, it is beneficial
          that the 6LN supports decapsulating IP-in-IP, but that is not assumed
          by <span>[<a class="xref" href="#RFC8504">RFC8504</a>]</span>.
          If the 6LN is a RUL, the root that encapsulates a packet <span class="bcp14">SHOULD</span>
          terminate the tunnel at a parent 6LR. The root may encapsulate all the
          way to the RUL if it is aware that the RUL supports IP-in-IP decapsulation 
          and the artifacts in the outer header chain.<a class="pilcrow" href="#section-4.1.1-5">¶</a></p>
<p id="section-4.1.1-6">

          A node that is reachable over an external route is not expected to
          support <span>[<a class="xref" href="#RFC8138">RFC8138</a>]</span>. Whether a decapsulation took place
          or not and even when the 6LR is delivering the packet to a RUL, the
          6LR that injected an external route <span class="bcp14">MUST</span> undo the <span>[<a class="xref" href="#RFC8138">RFC8138</a>]</span> compression on the packet before
          forwarding over that external route.<a class="pilcrow" href="#section-4.1.1-6">¶</a></p>
</section>
</div>
<div id="mopchanges">
<section id="section-4.1.2">
          <h4 id="name-configuration-options-and-m">
<a class="section-number selfRef" href="#section-4.1.2">4.1.2. </a><a class="section-name selfRef" href="#name-configuration-options-and-m">Configuration Options and Mode of Operation</a>
          </h4>
<p id="section-4.1.2-1">
              <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6550#section-6.7.6">Section 6.7.6</a> of [<a class="xref" href="#RFC6550">RFC6550</a>]</span> describes the DODAG Configuration option as
              containing a series of flags in the first octet of the payload.<a class="pilcrow" href="#section-4.1.2-1">¶</a></p>
<p id="section-4.1.2-2">
              Anticipating future work to revise RPL relating to how the LLN and DODAG
              are configured, this document renames the IANA "DODAG Configuration Option
              Flags" subregistry so that it applies to Mode of Operation (MOP) values zero
              (0) through six (6) only, leaving the flags unassigned for MOP value seven
              (7). The MOP is described in <span>[<a class="xref" href="#RFC6550">RFC6550</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc6550#section-6.3.1">Section 6.3.1</a></span>.<a class="pilcrow" href="#section-4.1.2-2">¶</a></p>
<p id="section-4.1.2-3">
              In addition, this document reserves MOP value 7 for future expansion.<a class="pilcrow" href="#section-4.1.2-3">¶</a></p>
<p id="section-4.1.2-4">
            See Sections <a class="xref" href="#sec_op_flags_reg">11.2</a> and <a class="xref" href="#sec_mop_val_change">11.3</a>.<a class="pilcrow" href="#section-4.1.2-4">¶</a></p>
</section>
</div>
<div id="update6550">
<section id="section-4.1.3">
          <h4 id="name-indicating-the-new-rpi-in-t">
<a class="section-number selfRef" href="#section-4.1.3">4.1.3. </a><a class="section-name selfRef" href="#name-indicating-the-new-rpi-in-t">Indicating the New RPI in the DODAG Configuration Option Flag</a>
          </h4>
<p id="section-4.1.3-1">
            In order to avoid a flag day caused by lack of interoperation
            between nodes of the new RPI Option Type (0x23) and old RPI Option Type (0x63), this section
            defines a flag in the DODAG Configuration option, to indicate when
            the new RPI Option Type can be safely used. This means that the flag is going
            to indicate the value of Option Type that the network will be using for the RPL Option. Thus, when a
            node joins to a network, it will know which value to use.
            With this, RPL-capable nodes know if it is safe to use 0x23 when creating a new RPL Option.
            A node that forwards a packet with an RPI <span class="bcp14">MUST NOT</span> modify the Option Type of the RPL Option.<a class="pilcrow" href="#section-4.1.3-1">¶</a></p>
<p id="section-4.1.3-2">
              This is done using a DODAG Configuration option flag that will
            signal "RPI 0x23 enable" and propagate through the network.
              <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6550#section-6.3.1">Section 6.3.1</a> of [<a class="xref" href="#RFC6550">RFC6550</a>]</span> defines a 3-bit Mode of
              Operation (MOP) in the DIO Base Object. The flag is defined only
              for MOP value between 0 to 6.<a class="pilcrow" href="#section-4.1.3-2">¶</a></p>
<p id="section-4.1.3-3">
              For a MOP value of 7, a node <span class="bcp14">MUST</span> use the RPI 0x23 option.<a class="pilcrow" href="#section-4.1.3-3">¶</a></p>
<p id="section-4.1.3-4">
              As stated in <span>[<a class="xref" href="#RFC6550">RFC6550</a>]</span>, the DODAG Configuration option is present in DIO messages.
              The DODAG Configuration option distributes configuration
              information.  It is generally static, and it does not change within
              the DODAG.
              This information is configured at the DODAG root and distributed
              throughout the DODAG with the DODAG Configuration option.
              Nodes other than the DODAG root do not modify this information when
              propagating the DODAG Configuration option.<a class="pilcrow" href="#section-4.1.3-4">¶</a></p>
<p id="section-4.1.3-5">
              Currently, the DODAG Configuration option in <span>[<a class="xref" href="#RFC6550">RFC6550</a>]</span> states
              that the unused bits "<span class="bcp14">MUST</span> be initialized to zero by the sender
              and <span class="bcp14">MUST</span> be ignored by the receiver." If the flag is received with a
            value zero, which is the default, then new nodes will remain compatible with
              RFC 6553 -- originating traffic with the old RPI Option Type value (0x63).
              If the flag is received with a value of 1, then the value for the
              RPL Option <span class="bcp14">MUST</span> be set to 0x23.<a class="pilcrow" href="#section-4.1.3-5">¶</a></p>
<p id="section-4.1.3-6">
             Bit number three of the Flags field in the DODAG Configuration option
             is to be used as shown in <a class="xref" href="#fig_RPIflagday2">Table 1</a> (which is the same as <a class="xref" href="#fig_RPIflagdayConfOption">Table 36</a>
             in <a class="xref" href="#iana">Section 11</a> and is shown here for convenience):<a class="pilcrow" href="#section-4.1.3-6">¶</a></p>
<span id="name-dodag-configuration-option-"></span><div id="fig_RPIflagday2">
<table class="center" id="table-1">
            <caption>
<a class="selfRef" href="#table-1">Table 1</a>:
<a class="selfRef" href="#name-dodag-configuration-option-">DODAG Configuration Option Flag to Indicate the RPI Flag Day</a>
            </caption>
<thead>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Bit number</th>
                <th class="text-center" colspan="1" rowspan="1">Description</th>
                <th class="text-center" colspan="1" rowspan="1">Reference</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-center" colspan="1" rowspan="1">3</td>
                <td class="text-center" colspan="1" rowspan="1">RPI 0x23 enable</td>
                <td class="text-center" colspan="1" rowspan="1">This document</td>
              </tr>
            </tbody>
          </table>
</div>
<p id="section-4.1.3-8">
              In the case of reboot, the node (6LN or 6LR) does not remember the
              RPI Option Type (i.e., whether or not the flag is set), so the node will not trigger DIO
              messages until a DIO message is received that indicates the RPI
              value to be used. The node will use the value 0x23 if the network supports this feature.<a class="pilcrow" href="#section-4.1.3-8">¶</a></p>
</section>
</div>
</section>
</div>
<section id="section-4.2">
        <h3 id="name-updates-to-rfc-6553-indicat">
<a class="section-number selfRef" href="#section-4.2">4.2. </a><a class="section-name selfRef" href="#name-updates-to-rfc-6553-indicat">Updates to RFC 6553: Indicating the New RPI Option Type</a>
        </h3>
<p id="section-4.2-1">
          This modification is required in order to be able to send, for example,
          IPv6 packets from a RPL-aware leaf to a RPL-unaware node through the Internet (see <a class="xref" href="#sm-Ral2i">Section 7.2.1</a>)
          without requiring IPv6-in-IPv6 encapsulation.<a class="pilcrow" href="#section-4.2-1">¶</a></p>
<p id="section-4.2-2">
          <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6553#section-6">Section 6</a> of [<a class="xref" href="#RFC6553">RFC6553</a>]</span> states, as shown in <a class="xref" href="#fig_RPIOption">Table 2</a>,
          that in the Option Type field of the RPL Option,
          the two high-order bits must be set to '01' and the third bit is equal to '1'.
          The first two bits indicate that the IPv6 node must discard the packet
          if it doesn't recognize the Option Type,
          and the third bit indicates that the Option Data may change in route.
          The remaining bits serve as the Option Type.<a class="pilcrow" href="#section-4.2-2">¶</a></p>
<span id="name-option-type-in-rpl-option"></span><div id="fig_RPIOption">
<table class="center" id="table-2">
          <caption>
<a class="selfRef" href="#table-2">Table 2</a>:
<a class="selfRef" href="#name-option-type-in-rpl-option">Option Type in RPL Option</a>
          </caption>
<thead>
            <tr>
              <th class="text-center" colspan="1" rowspan="2">Hex Value</th>
              <th class="text-center" colspan="3" rowspan="1">Binary Value</th>
              <th class="text-center" colspan="1" rowspan="2">Description</th>
              <th class="text-center" colspan="1" rowspan="2">Reference</th>
            </tr>
            <tr>
              <th class="text-center" colspan="1" rowspan="1">act</th>
              <th class="text-center" colspan="1" rowspan="1">chg</th>
              <th class="text-center" colspan="1" rowspan="1">rest</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-center" colspan="1" rowspan="1">0x63</td>
              <td class="text-center" colspan="1" rowspan="1">01</td>
              <td class="text-center" colspan="1" rowspan="1">1</td>
              <td class="text-center" colspan="1" rowspan="1">00011</td>
              <td class="text-center" colspan="1" rowspan="1">RPL Option</td>
              <td class="text-center" colspan="1" rowspan="1">
                <span>[<a class="xref" href="#RFC6553">RFC6553</a>]</span>
</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-4.2-4">
          This document illustrates that it is not always possible to know for sure at the source whether a packet will travel only within the RPL domain or whether it will leave it.<a class="pilcrow" href="#section-4.2-4">¶</a></p>
<p id="section-4.2-5">
          At the time <span>[<a class="xref" href="#RFC6553">RFC6553</a>]</span> was published, leaking a Hop-by-Hop Options header in the outer IPv6 header
          chain could potentially impact core routers in the Internet. So at that time, it was decided to encapsulate
          any packet with a RPL Option using IPv6-in-IPv6 in all cases where it was unclear whether the packet would
          remain within the RPL domain. In the exception case where a packet would still leak, the Option Type would
          ensure that the first router in the Internet that does not recognize the option would drop the packet and
          protect the rest of the network.<a class="pilcrow" href="#section-4.2-5">¶</a></p>
<p id="section-4.2-6">
          Even with <span>[<a class="xref" href="#RFC8138">RFC8138</a>]</span>, where the IPv6-in-IPv6 header is compressed, this approach yields extra bytes
          in a packet; this means consuming more energy and more bandwidth, incurring higher chances of loss, and possibly
          causing a fragmentation at the 6LoWPAN level. This impacts the daily operation of constrained devices for a case
           that generally does not happen and would not heavily impact the core anyway.<a class="pilcrow" href="#section-4.2-6">¶</a></p>
<p id="section-4.2-7">

          While the intention was and remains that the Hop-by-Hop Options header with a RPL Option should be confined within the
          RPL domain, this specification modifies this behavior in order to reduce the dependency on IPv6-in-IPv6 and
          protect the constrained devices. <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8200#section-4">Section 4</a> of [<a class="xref" href="#RFC8200">RFC8200</a>]</span> clarifies the behavior of routers in
          the Internet as follows: "it is now expected that nodes along a packet's delivery path only examine and process
          the Hop-by-Hop Options header if explicitly configured to do so."<a class="pilcrow" href="#section-4.2-7">¶</a></p>
<p id="section-4.2-8">
          When unclear about the travel of a packet, it becomes preferable for a source not to encapsulate, accepting
          the fact that the packet may leave the RPL domain on its way to its destination. In that event, the packet
          should reach its destination and should not be discarded by the first node that does not recognize the RPL Option.
           However, with the current value of the Option Type, if a node in the Internet is configured to process the Hop-by-Hop Options
           header, and if such a node encounters an Option Type with the first two bits set to 01 and the node conforms to <span>[<a class="xref" href="#RFC8200">RFC8200</a>]</span>,
            it will drop the packet. Host systems should do the same, irrespective of the configuration.<a class="pilcrow" href="#section-4.2-8">¶</a></p>
<p id="section-4.2-9">
           Thus, this document updates the Option Type of the RPL Option <span>[<a class="xref" href="#RFC6553">RFC6553</a>]</span>,
           naming it RPI Option Type for simplicity
           (<a class="xref" href="#fig_RPIOption_new">Table 3</a>):
           the two high order bits <span class="bcp14">MUST</span> be set to '00',
           and the third bit is equal to '1'.
           The first two bits indicate that the IPv6 node <span class="bcp14">MUST</span>
           skip over this option and continue processing the header
           (<span>[<a class="xref" href="#RFC8200">RFC8200</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc8200#section-4.2">Section 4.2</a></span>)
           if it doesn't recognize the Option Type,
           and the third bit continues to be set to indicate that the Option
           Data may change en route. The rightmost five bits remain at 0x3(00011).
           This ensures that a packet that leaves the RPL domain of an LLN (or that
           leaves the LLN entirely) will not be discarded when it contains the RPL Option.<a class="pilcrow" href="#section-4.2-9">¶</a></p>
<p id="section-4.2-10">
          With the new Option Type, if an IPv6 (intermediate) node (RPL unaware) receives a packet with a
          RPL Option, it should ignore the Hop-by-Hop RPL Option
          (skip over this option and continue processing the header). This is relevant, as it was mentioned previously, in the case that
          there is a flow from RAL to Internet (see <a class="xref" href="#sm-Ral2i">Section 7.2.1</a>).<a class="pilcrow" href="#section-4.2-10">¶</a></p>
<p id="section-4.2-11">
           This is a significant update to <span>[<a class="xref" href="#RFC6553">RFC6553</a>]</span>.<a class="pilcrow" href="#section-4.2-11">¶</a></p>
<span id="name-revised-option-type-in-rpl-"></span><div id="fig_RPIOption_new">
<table class="center" id="table-3">
          <caption>
<a class="selfRef" href="#table-3">Table 3</a>:
<a class="selfRef" href="#name-revised-option-type-in-rpl-">Revised Option Type in RPL Option</a>
          </caption>
<thead>
            <tr>
              <th class="text-center" colspan="1" rowspan="2">Hex Value</th>
              <th class="text-center" colspan="3" rowspan="1">Binary Value</th>
              <th class="text-center" colspan="1" rowspan="2">Description</th>
              <th class="text-center" colspan="1" rowspan="2">Reference</th>
            </tr>
            <tr>
              <th class="text-center" colspan="1" rowspan="1">act</th>
              <th class="text-center" colspan="1" rowspan="1">chg</th>
              <th class="text-center" colspan="1" rowspan="1">rest</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-center" colspan="1" rowspan="1">0x23</td>
              <td class="text-center" colspan="1" rowspan="1">00</td>
              <td class="text-center" colspan="1" rowspan="1">1</td>
              <td class="text-center" colspan="1" rowspan="1">00011</td>
              <td class="text-center" colspan="1" rowspan="1">RPL Option</td>
              <td class="text-center" colspan="1" rowspan="1">This document</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-4.2-13">
            Without the signaling described below, this change would otherwise create a lack of interoperation (flag day) for existing networks that are
            currently using 0x63 as the RPI Option Type value.  A move to 0x23 will not
            be understood by those networks.  It is suggested that
            RPL implementations accept both 0x63 and 0x23 when
            processing the header.<a class="pilcrow" href="#section-4.2-13">¶</a></p>
<p id="section-4.2-14">
            When forwarding packets, implementations <span class="bcp14">SHOULD</span> use the same value of RPI Type
            as was received. This is required because the RPI Option Type does not change en route
            (<span>[<a class="xref" href="#RFC8200">RFC8200</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc8200#section-4.2">Section 4.2</a></span>). It allows the network to be incrementally
            upgraded and allows the DODAG root to know which parts of the
            network have been upgraded.<a class="pilcrow" href="#section-4.2-14">¶</a></p>
<p id="section-4.2-15">
            When originating new packets,
            implementations should have an option to determine which value to
            originate with. This option is controlled by the DODAG Configuration option (<a class="xref" href="#update6550">Section 4.1.3</a>).<a class="pilcrow" href="#section-4.2-15">¶</a></p>
<p id="section-4.2-16">
          The change of RPI Option Type from 0x63 to 0x23 makes all nodes that are compliant with
          <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8200#section-4.2">Section 4.2</a> of [<a class="xref" href="#RFC8200">RFC8200</a>]</span> tolerant of the RPL artifacts.  There
          is no longer a need to remove the artifacts when
          sending traffic to the Internet.  This change clarifies when
          to use IPv6-in-IPv6 headers and how to address them:
          the Hop-by-Hop Options header containing the RPI <span class="bcp14">MUST</span> always
          be added when 6LRs originate packets (without IPv6-in-IPv6
          headers), and IPv6-in-IPv6 headers <span class="bcp14">MUST</span> always be added
          when a 6LR finds that it needs to insert a Hop-by-Hop Options header
          containing the RPL Option. The IPv6-in-IPv6 header is to
          be addressed to the
          RPL root when on the way up, and to the end host when on the way down.<a class="pilcrow" href="#section-4.2-16">¶</a></p>
<p id="section-4.2-17">
          In the Non-Storing case, dealing with RPL-unaware leaf nodes
          is much easier as the 6LBR (DODAG root) has complete knowledge
          about the connectivity of all DODAG nodes, and all traffic flows
          through the root node.<a class="pilcrow" href="#section-4.2-17">¶</a></p>
<p id="section-4.2-18">
          The 6LBR can recognize RPL-unaware leaf nodes because it will
          receive a DAO about that node from the 6LR immediately above that
          RPL-unaware node.<a class="pilcrow" href="#section-4.2-18">¶</a></p>
<p id="section-4.2-19">
          The Non-Storing mode case does not require the Type change from
          0x63 to 0x23, as the root can always create the right packet.
          The Type change does not adversely affect the Non-Storing case (see  <a class="xref" href="#update6550">Section 4.1.3</a>).<a class="pilcrow" href="#section-4.2-19">¶</a></p>
</section>
<section id="section-4.3">
        <h3 id="name-updates-to-rfc-8138-indicat">
<a class="section-number selfRef" href="#section-4.3">4.3. </a><a class="section-name selfRef" href="#name-updates-to-rfc-8138-indicat">Updates to RFC 8138: Indicating the Way to Decompress with the New RPI Option Type</a>
        </h3>
<p id="section-4.3-1">
          This modification is required in order to be able to decompress the RPL Option
          with the new Option Type of 0x23.<a class="pilcrow" href="#section-4.3-1">¶</a></p>
<p id="section-4.3-2">
            The RPI-6LoRH header provides a compressed form for the RPL RPI; see
            <span>[<a class="xref" href="#RFC8138">RFC8138</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc8138#section-6">Section 6</a></span>. A node that is decompressing this header
            <span class="bcp14">MUST</span> decompress using the RPI Option Type that is currently active, that
            is, a choice between 0x23 (new) and 0x63 (old). The node will know which to
            use based upon the presence of the flag in the DODAG Configuration option defined in
            <a class="xref" href="#update6550">Section 4.1.3</a>. For example, if the network is in 0x23 mode (by DIO option),
            then it should be decompressed to 0x23.<a class="pilcrow" href="#section-4.3-2">¶</a></p>
<p id="section-4.3-3">
          <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8138#section-7">Section 7</a> of [<a class="xref" href="#RFC8138">RFC8138</a>]</span> documents how to compress
          the IPv6-in-IPv6 header.<a class="pilcrow" href="#section-4.3-3">¶</a></p>
<p id="section-4.3-4">
          There are potential significant advantages to having a single
          code path that always processes IPv6-in-IPv6 headers with no
          conditional branches.<a class="pilcrow" href="#section-4.3-4">¶</a></p>
<p id="section-4.3-5">
            In Storing mode, the scenarios where the flow goes from RAL to RUL and RUL
            to  RUL include compression of the IPv6-in-IPv6 and RPI headers.  The 
            IPv6-in-IPv6 header <span class="bcp14">MUST</span> be used in this case, and 
            it <span class="bcp14">SHOULD</span> be compressed as specified in 
            <span>[<a class="xref" href="#RFC8138">RFC8138</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc8138#section-7">Section 7</a></span>.
             <a class="xref" href="#rtghc">Figure 2</a>
             illustrates the case in Storing mode where the packet is received from the Internet, then the
             root encapsulates the packet to insert the RPI. In that example,
             the leaf is not known to support RFC 8138, and the packet is
             encapsulated to the 6LR that is the parent and last hop to the
             final destination.<a class="pilcrow" href="#section-4.3-5">¶</a></p>
<span id="name-rpi-inserted-by-the-root-in"></span><div id="rtghc">
<figure id="figure-2">
          <div class="artwork art-text alignLeft" id="section-4.3-6.1">
<pre>+-+ ... -+-+ ... +-+- ... -+-+- +-+-+-+ ... +-+-+ ... -+++ ... +-...
|11110001|SRH-6LoRH| RPI-  |IP-in-IP| NH=1      |11110CPP| UDP | UDP
|Page 1  |Type1 S=0| 6LoRH |6LoRH   |LOWPAN_IPHC| UDP    | hdr |Payld
+-+ ... -+-+ ... +-+- ... -+-+-.+-+-+-+-+ ... +-+-+ ... -+ ... +-...
         &lt;-4bytes-&gt;                      &lt;-        RFC 6282      -&gt;
                                               No RPL artifact
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-2">Figure 2</a>:
<a class="selfRef" href="#name-rpi-inserted-by-the-root-in">RPI Inserted by the Root in Storing Mode</a>
          </figcaption></figure>
</div>
<p id="section-4.3-7">
          In <a class="xref" href="#rtghc">Figure 2</a>, the source of the IPv6-in-IPv6 encapsulation is
          the root, so it is elided in the IP-in-IP 6LoRH. The destination is
          the parent 6LR of the destination of the inner packet so it cannot be
          elided. It is placed as the single entry in a Source Route Header 6LoRH (SRH-6LoRH) as the first
          6LoRH. There is a single entry so the SRH-6LoRH Size is zero. In that
          example, the Type is 1 so the 6LR address is compressed to two bytes.
          This results in the total length of the SRH-6LoRH being four bytes.
          The RPI-6LoRH and then the IP-in-IP 6LoRH follow. When the
          IP-in-IP 6LoRH is removed, all the router headers that precede it are
          also removed.
          The Paging Dispatch <span>[<a class="xref" href="#RFC8025">RFC8025</a>]</span> may also be removed if
          there was no previous Page change to a Page other than 0 or 1, since
          the LOWPAN_IPHC is encoded in the same fashion in the default Page 0
          and in Page 1. The resulting packet to the destination is the inner
          packet compressed with <span>[<a class="xref" href="#RFC6282">RFC6282</a>]</span>.<a class="pilcrow" href="#section-4.3-7">¶</a></p>
</section>
</section>
</div>
<div id="sec_ref_topo">
<section id="section-5">
      <h2 id="name-reference-topology">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-reference-topology">Reference Topology</a>
      </h2>
<p id="section-5-1">
                A RPL network in general is composed of a 6LBR,
                a Backbone Router (6BBR), a 6LR, and a 6LN as a leaf logically organized in a DODAG structure.<a class="pilcrow" href="#section-5-1">¶</a></p>
<p id="section-5-2">
               <a class="xref" href="#fig_CommonTopology">Figure 3</a> shows the reference RPL topology for this document. The
               nodes are labeled with letters so that
               they may be referenced in subsequent sections. In the figure,
               6LR represents a full router node.
               The 6LN is a RPL-aware router or host (as a leaf).
               Additionally, for simplification purposes,
               it is supposed that the 6LBR has direct access to Internet and is the root of the DODAG, thus the 6BBR
               is not present in the figure.<a class="pilcrow" href="#section-5-2">¶</a></p>
<p id="section-5-3">
            The 6LN leaves marked as RAL (F, H, and I) are RPL nodes with no children hosts.<a class="pilcrow" href="#section-5-3">¶</a></p>
<p id="section-5-4">
     The leaves marked as RUL (G and J) are
            devices that do not speak RPL at all (RPL unaware),
     but use Router Advertisements, 6LoWPAN Duplicate Address Request and Duplicate Address Confirmation (DAR/DAC), and
            6LoWPAN Neighbor Discovery (ND) only to participate in the network <span>[<a class="xref" href="#RFC8505">RFC8505</a>]</span>.
     In the document, these leaves (G and J) are also referred to as
            a RUL.<a class="pilcrow" href="#section-5-4">¶</a></p>
<p id="section-5-5">
            The 6LBR (A) in the figure is the root of the Global DODAG.<a class="pilcrow" href="#section-5-5">¶</a></p>
<span id="name-a-reference-rpl-topology"></span><div id="fig_CommonTopology">
<figure id="figure-3">
        <div class="artwork art-text alignLeft" id="section-5-6.1">
<pre>                  +------------+
                  |  INTERNET  ----------+
                  |            |         |
                  +------------+         |
                                         |
                                         |
                                         |
                                       A |
                                   +-------+
                                   |6LBR   |
                       +-----------|(root) |-------+
                       |           +-------+       |
                       |                           |
                       |                           |
                       |                           |
                       |                           |
                       | B                         |C
                   +---|---+                   +---|---+
                   |  6LR  |                   |  6LR  |
         +---------|       |--+             +---       ---+
         |         +-------+  |             |  +-------+  |
         |                    |             |             |
         |                    |             |             |
         |                    |             |             |
         |                    |             |             |
         | D                  |  E          |             |
       +-|-----+          +---|---+         |             |
       |  6LR  |          |  6LR  |         |             |
       |       |    +------       |         |             |
       +---|---+    |     +---|---+         |             |
           |        |         |             |             |
           |        |         +--+          |             |
           |        |            |          |             |
           |        |            |          |             |
           |        |            |        I |          J  |
        F  |        | G          | H        |             |
     +-----+-+    +-|-----+  +---|--+   +---|---+     +---|---+
     |  RAL  |    | RUL   |  | RAL  |   |  RAL  |     | RUL   |
     |  6LN  |    |  6LN  |  | 6LN  |   |  6LN  |     |  6LN  |
     +-------+    +-------+  +------+   +-------+     +-------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-3">Figure 3</a>:
<a class="selfRef" href="#name-a-reference-rpl-topology">A Reference RPL Topology</a>
        </figcaption></figure>
</div>
</section>
</div>
<div id="sec_use_cases">
<section id="section-6">
      <h2 id="name-use-cases">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-use-cases">Use Cases</a>
      </h2>
<p id="section-6-1">
           In the data plane, a combination of RFC 6553, RFC 6554, and
           IPv6-in-IPv6 encapsulation are going to be analyzed for a number of
           representative traffic flows.<a class="pilcrow" href="#section-6-1">¶</a></p>
<p id="section-6-2">

          The use cases describe the communication in the following cases:<a class="pilcrow" href="#section-6-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-3.1">Between RPL-aware nodes with the root (6LBR)<a class="pilcrow" href="#section-6-3.1">¶</a>
</li>
        <li class="normal" id="section-6-3.2">Between RPL-aware nodes with the Internet<a class="pilcrow" href="#section-6-3.2">¶</a>
</li>
        <li class="normal" id="section-6-3.3">Between RUL nodes within the LLN (e.g., see <a class="xref" href="#sm-nRal2root">Section 7.1.4</a>)<a class="pilcrow" href="#section-6-3.3">¶</a>
</li>
        <li class="normal" id="section-6-3.4">Inside of the LLN when the final destination address resides outside
            of the LLN (e.g., see <a class="xref" href="#sm-nRal2i">Section 7.2.3</a>)<a class="pilcrow" href="#section-6-3.4">¶</a>
</li>
      </ul>
<p id="section-6-4">
             The use cases are as follows:<a class="pilcrow" href="#section-6-4">¶</a></p>
<ul class="ulEmpty normal">
<li class="ulEmpty normal" id="section-6-5.1">
          <p id="section-6-5.1.1">
             Interaction between leaf and root:<a class="pilcrow" href="#section-6-5.1.1">¶</a></p>
<ul class="ulEmpty normal">
<li class="ulEmpty normal" id="section-6-5.1.2.1">
               RAL to root<a class="pilcrow" href="#section-6-5.1.2.1">¶</a>
</li>
            <li class="ulEmpty normal" id="section-6-5.1.2.2">
               root to RAL<a class="pilcrow" href="#section-6-5.1.2.2">¶</a>
</li>
            <li class="ulEmpty normal" id="section-6-5.1.2.3">
               RUL to root<a class="pilcrow" href="#section-6-5.1.2.3">¶</a>
</li>
            <li class="ulEmpty normal" id="section-6-5.1.2.4">
               root to RUL<a class="pilcrow" href="#section-6-5.1.2.4">¶</a>
</li>
          </ul>
</li>
        <li class="ulEmpty normal" id="section-6-5.2">
          <p id="section-6-5.2.1">
             Interaction between leaf and Internet:<a class="pilcrow" href="#section-6-5.2.1">¶</a></p>
<ul class="ulEmpty normal">
<li class="ulEmpty normal" id="section-6-5.2.2.1">
               RAL to Internet<a class="pilcrow" href="#section-6-5.2.2.1">¶</a>
</li>
            <li class="ulEmpty normal" id="section-6-5.2.2.2">
               Internet to RAL<a class="pilcrow" href="#section-6-5.2.2.2">¶</a>
</li>
            <li class="ulEmpty normal" id="section-6-5.2.2.3">
               RUL to Internet<a class="pilcrow" href="#section-6-5.2.2.3">¶</a>
</li>
            <li class="ulEmpty normal" id="section-6-5.2.2.4">
               Internet to RUL<a class="pilcrow" href="#section-6-5.2.2.4">¶</a>
</li>
          </ul>
</li>
        <li class="ulEmpty normal" id="section-6-5.3">
          <p id="section-6-5.3.1">
             Interaction between leaves:<a class="pilcrow" href="#section-6-5.3.1">¶</a></p>
<ul class="ulEmpty normal">
<li class="ulEmpty normal" id="section-6-5.3.2.1">
               RAL to RAL<a class="pilcrow" href="#section-6-5.3.2.1">¶</a>
</li>
            <li class="ulEmpty normal" id="section-6-5.3.2.2">
               RAL to RUL<a class="pilcrow" href="#section-6-5.3.2.2">¶</a>
</li>
            <li class="ulEmpty normal" id="section-6-5.3.2.3">
               RUL to RAL<a class="pilcrow" href="#section-6-5.3.2.3">¶</a>
</li>
            <li class="ulEmpty normal" id="section-6-5.3.2.4">
               RUL to RUL<a class="pilcrow" href="#section-6-5.3.2.4">¶</a>
</li>
          </ul>
</li>
      </ul>
<p id="section-6-6">
            This document is consistent with the rule that a header cannot be
            inserted or removed on the fly inside an IPv6 packet that is
            being routed.
            This is a fundamental precept of the IPv6 architecture as
            outlined in <span>[<a class="xref" href="#RFC8200">RFC8200</a>]</span>.<a class="pilcrow" href="#section-6-6">¶</a></p>
<p id="section-6-7">
            As the Rank information in the RPI artifact is changed at each
            hop, it will typically be zero when it arrives at the DODAG
            root.  The DODAG root <span class="bcp14">MUST</span> force it to zero when passing the
            packet out to the Internet.  The Internet will therefore not see
            any SenderRank information.<a class="pilcrow" href="#section-6-7">¶</a></p>
<p id="section-6-8">
            Despite being legal to leave the RPI artifact in place,
            an intermediate router that needs to add an extension header
            (e.g., RH3 or RPL Option) <span class="bcp14">MUST</span> still encapsulate the packet in an
            (additional) outer IP header. The new header is placed after
            this new outer IP header.<a class="pilcrow" href="#section-6-8">¶</a></p>
<p id="section-6-9">
           A corollary is that an
            intermediate router can remove an RH3 or RPL Option only
            if it is placed in an encapsulating IPv6
            header that is addressed <em>to</em> this intermediate router.
            When doing the above, the whole encapsulating header must be
            removed. (A replacement may be added.)<a class="pilcrow" href="#section-6-9">¶</a></p>
<p id="section-6-10">
            Both the RPL Option and the RH3 headers may be modified in very specific ways
            by routers on the path of the packet without the need to add and
            remove an encapsulating header.  Both headers were designed with
            this modification in
            mind, and both the RPL RH3 and the RPL Option are marked mutable
            but recoverable: so an IPsec Authentication Header (AH) can be applied
            across these headers, but it cannot secure the values that mutate.<a class="pilcrow" href="#section-6-10">¶</a></p>
<p id="section-6-11">
            The RPI <span class="bcp14">MUST</span> be present in every single RPL data packet.<a class="pilcrow" href="#section-6-11">¶</a></p>
<p id="section-6-12">
            Prior to <span>[<a class="xref" href="#RFC8138">RFC8138</a>]</span>, there was significant
            interest in creating an exception to this rule and removing the RPI for Downward flows in Non-Storing
            mode.  This exception covered a very small number of cases, and
            caused significant interoperability challenges while adding
            significant interest in the code and tests.  The ability to compress
            the RPI down to three bytes or less removes much of the pressure
            to optimize this any further.<a class="pilcrow" href="#section-6-12">¶</a></p>
<p id="section-6-13">
            Throughout the following subsections, the examples are described in more detail in the first subsections,
     and more concisely in the later ones.<a class="pilcrow" href="#section-6-13">¶</a></p>
<p id="section-6-14">
              The use cases are delineated based on the following IPV6 and RPL mandates:<a class="pilcrow" href="#section-6-14">¶</a></p>
<ul class="ulEmpty normal">
<li class="ulEmpty normal" id="section-6-15.1">
          <p id="section-6-15.1.1">The RPI has to be in every packet that traverses the LLN.<a class="pilcrow" href="#section-6-15.1.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-15.1.2.1">
                Because of the above requirement, packets from the Internet have to be encapsulated.<a class="pilcrow" href="#section-6-15.1.2.1">¶</a>
</li>
            <li class="normal" id="section-6-15.1.2.2">
                A header cannot be inserted or removed on the fly inside an IPv6 packet that is being routed.<a class="pilcrow" href="#section-6-15.1.2.2">¶</a>
</li>
            <li class="normal" id="section-6-15.1.2.3">
                Extension headers may not be added or removed except by the sender or the receiver.<a class="pilcrow" href="#section-6-15.1.2.3">¶</a>
</li>
            <li class="normal" id="section-6-15.1.2.4">
                RPI and RH3 headers may be modified by routers on the path of the packet without the need to add and remove an encapsulating header.<a class="pilcrow" href="#section-6-15.1.2.4">¶</a>
</li>
            <li class="normal" id="section-6-15.1.2.5">
                An RH3 or RPL Option can only be removed by an intermediate router if it is placed in an encapsulating IPv6 header, which is addressed to the intermediate router.<a class="pilcrow" href="#section-6-15.1.2.5">¶</a>
</li>
            <li class="normal" id="section-6-15.1.2.6">
                The Non-Storing mode requires downstream encapsulation by the root for RH3.<a class="pilcrow" href="#section-6-15.1.2.6">¶</a>
</li>
          </ul>
</li>
      </ul>
<p id="section-6-16">
            The use cases are delineated based on the following assumptions:<a class="pilcrow" href="#section-6-16">¶</a></p>
<ul class="ulEmpty normal">
<li class="ulEmpty normal" id="section-6-17.1">
          <p id="section-6-17.1.1">This document assumes that the LLN is using the no-drop RPI Option Type (0x23).<a class="pilcrow" href="#section-6-17.1.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-17.1.2.1">
                Each IPv6 node (including Internet routers) obeys <span>[<a class="xref" href="#RFC8200">RFC8200</a>]</span>, so that the 0x23 RPI Option Type can be safely inserted.<a class="pilcrow" href="#section-6-17.1.2.1">¶</a>
</li>
            <li class="normal" id="section-6-17.1.2.2">
                All 6LRs obey <span>[<a class="xref" href="#RFC8200">RFC8200</a>]</span>.<a class="pilcrow" href="#section-6-17.1.2.2">¶</a>
</li>
            <li class="normal" id="section-6-17.1.2.3">
                The RPI is ignored at the IPv6 destination (dst) node (RUL).<a class="pilcrow" href="#section-6-17.1.2.3">¶</a>
</li>
            <li class="normal" id="section-6-17.1.2.4">
                In the use cases, we assume that the RAL supports IP-in-IP encapsulation.<a class="pilcrow" href="#section-6-17.1.2.4">¶</a>
</li>
            <li class="normal" id="section-6-17.1.2.5">
                In the use cases, we don't assume that the RUL supports IP-in-IP encapsulation.<a class="pilcrow" href="#section-6-17.1.2.5">¶</a>
</li>
            <li class="normal" id="section-6-17.1.2.6">
                For traffic leaving a RUL, if the RUL adds an opaque RPI, then the 6LR as a RPL Border Router <span class="bcp14">SHOULD</span> rewrite
                 the RPI to indicate the selected Instance and set the flags.<a class="pilcrow" href="#section-6-17.1.2.6">¶</a>
</li>
            <li class="normal" id="section-6-17.1.2.7">
                The description for RALs applies to RAN in general.<a class="pilcrow" href="#section-6-17.1.2.7">¶</a>
</li>
            <li class="normal" id="section-6-17.1.2.8">
               Unconstrained uses of RPL are not in scope of this document.<a class="pilcrow" href="#section-6-17.1.2.8">¶</a>
</li>
            <li class="normal" id="section-6-17.1.2.9">
               Compression is based on <span>[<a class="xref" href="#RFC8138">RFC8138</a>]</span>.<a class="pilcrow" href="#section-6-17.1.2.9">¶</a>
</li>
            <li class="normal" id="section-6-17.1.2.10">
               The flow label <span>[<a class="xref" href="#RFC6437">RFC6437</a>]</span> is not needed in RPL.<a class="pilcrow" href="#section-6-17.1.2.10">¶</a>
</li>
          </ul>
</li>
      </ul>
</section>
</div>
<div id="sec_sm">
<section id="section-7">
      <h2 id="name-storing-mode">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-storing-mode">Storing Mode</a>
      </h2>
<p id="section-7-1">
          In Storing mode (SM) (fully stateful), the sender can determine if
           the destination is inside the LLN by
            looking if the destination address is matched by the DIO's Prefix Information Option (PIO) option.<a class="pilcrow" href="#section-7-1">¶</a></p>
<p id="section-7-2">
            <a class="xref" href="#fig_EncStoMode">Table 4</a> itemizes which headers are needed in each of the following scenarios.
            It indicates whether an IPv6-in-IPv6 header must be added and to which destination it must be addressed:<a class="pilcrow" href="#section-7-2">¶</a></p>
<ol class="normal type-1" id="section-7-3" start="1" type="1">
     <li id="section-7-3.1"> the final destination (the RAL node that is the target (tgt)),<a class="pilcrow" href="#section-7-3.1">¶</a>
</li>
        <li id="section-7-3.2"> the "root", or<a class="pilcrow" href="#section-7-3.2">¶</a>
</li>
        <li id="section-7-3.3">the 6LR parent of a RUL.<a class="pilcrow" href="#section-7-3.3">¶</a>
</li>
      </ol>
<p id="section-7-4">
            In cases where no IPv6-in-IPv6 header is needed, the column states "No", and the destination is N/A (Not Applicable).
            If the IPv6-in-IPv6 header is needed, the column shows "must".<a class="pilcrow" href="#section-7-4">¶</a></p>
<p id="section-7-5">
            In all cases, the RPI is needed, since it identifies
            inconsistencies (loops) in the routing topology.
            In general, the RH3 is not needed because it is not used in Storing mode. However, there is one scenario (from the root to the RUL in SM)
            where the RH3 can be used to point at the RUL (<a class="xref" href="#Storing-root2notrplnoIPIP">Table 8</a>).<a class="pilcrow" href="#section-7-5">¶</a></p>
<p id="section-7-6">
            The leaf can be a router 6LR or a host, both indicated as 6LN. The root refers to the 6LBR
            (see <a class="xref" href="#fig_CommonTopology">Figure 3</a>).<a class="pilcrow" href="#section-7-6">¶</a></p>
<span id="name-ipv6-in-ipv6-encapsulation-"></span><div id="fig_EncStoMode">
<table class="center" id="table-4">
        <caption>
<a class="selfRef" href="#table-4">Table 4</a>:
<a class="selfRef" href="#name-ipv6-in-ipv6-encapsulation-">IPv6-in-IPv6 Encapsulation in Storing Mode</a>
        </caption>
<thead>
          <tr>
            <th class="text-center" colspan="1" rowspan="1">Interaction between</th>
            <th class="text-center" colspan="1" rowspan="1">Use Case</th>
            <th class="text-center" colspan="1" rowspan="1">IPv6-in-IPv6</th>
            <th class="text-center" colspan="1" rowspan="1">IPv6-in-IPv6 dst</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <th class="text-center" colspan="1" rowspan="4">Leaf - Root</th>
            <td class="text-center" colspan="1" rowspan="1">RAL to root</td>
            <td class="text-center" colspan="1" rowspan="1">No</td>
            <td class="text-center" colspan="1" rowspan="1">N/A</td>
          </tr>
          <tr>
            <td class="text-center" colspan="1" rowspan="1">root to RAL</td>
            <td class="text-center" colspan="1" rowspan="1">No</td>
            <td class="text-center" colspan="1" rowspan="1">N/A</td>
          </tr>
          <tr>
            <td class="text-center" colspan="1" rowspan="1">root to RUL</td>
            <td class="text-center" colspan="1" rowspan="1">must</td>
            <td class="text-center" colspan="1" rowspan="1">6LR</td>
          </tr>
          <tr>
            <td class="text-center" colspan="1" rowspan="1">RUL to root</td>
            <td class="text-center" colspan="1" rowspan="1">must</td>
            <td class="text-center" colspan="1" rowspan="1">root</td>
          </tr>
          <tr>
            <th class="text-center" colspan="1" rowspan="4">Leaf - Internet</th>
            <td class="text-center" colspan="1" rowspan="1">RAL to Int</td>
            <td class="text-center" colspan="1" rowspan="1">may</td>
            <td class="text-center" colspan="1" rowspan="1">root</td>
          </tr>
          <tr>
            <td class="text-center" colspan="1" rowspan="1">Int to RAL</td>
            <td class="text-center" colspan="1" rowspan="1">must</td>
            <td class="text-center" colspan="1" rowspan="1">RAL (tgt)</td>
          </tr>
          <tr>
            <td class="text-center" colspan="1" rowspan="1">RUL to Int</td>
            <td class="text-center" colspan="1" rowspan="1">must</td>
            <td class="text-center" colspan="1" rowspan="1">root</td>
          </tr>
          <tr>
            <td class="text-center" colspan="1" rowspan="1">Int to RUL</td>
            <td class="text-center" colspan="1" rowspan="1">must</td>
            <td class="text-center" colspan="1" rowspan="1">6LR</td>
          </tr>
          <tr>
            <th class="text-center" colspan="1" rowspan="7">Leaf - Leaf</th>
            <td class="text-center" colspan="1" rowspan="1">RAL to RAL</td>
            <td class="text-center" colspan="1" rowspan="1">No</td>
            <td class="text-center" colspan="1" rowspan="1">N/A</td>
          </tr>
          <tr>
            <td class="text-center" colspan="1" rowspan="2">RAL to RUL</td>
            <td class="text-center" colspan="1" rowspan="1">No(up)</td>
            <td class="text-center" colspan="1" rowspan="1">N/A</td>
          </tr>
          <tr>
            <td class="text-center" colspan="1" rowspan="1">must(down)</td>
            <td class="text-center" colspan="1" rowspan="1">6LR</td>
          </tr>
          <tr>
            <td class="text-center" colspan="1" rowspan="2">RUL to RAL</td>
            <td class="text-center" colspan="1" rowspan="1">must(up)</td>
            <td class="text-center" colspan="1" rowspan="1">root</td>
          </tr>
          <tr>
            <td class="text-center" colspan="1" rowspan="1">must(down)</td>
            <td class="text-center" colspan="1" rowspan="1">RAL</td>
          </tr>
          <tr>
            <td class="text-center" colspan="1" rowspan="2">RUL to RUL</td>
            <td class="text-center" colspan="1" rowspan="1">must(up)</td>
            <td class="text-center" colspan="1" rowspan="1">root</td>
          </tr>
          <tr>
            <td class="text-center" colspan="1" rowspan="1">must(down)</td>
            <td class="text-center" colspan="1" rowspan="1">6LR</td>
          </tr>
        </tbody>
      </table>
</div>
<section id="section-7.1">
        <h3 id="name-storing-mode-interaction-be">
<a class="section-number selfRef" href="#section-7.1">7.1. </a><a class="section-name selfRef" href="#name-storing-mode-interaction-be">Storing Mode: Interaction between Leaf and Root</a>
        </h3>
<p id="section-7.1-1">
             This section describes the communication flow
             in Storing mode (SM) between the following:<a class="pilcrow" href="#section-7.1-1">¶</a></p>
<ul class="ulEmpty normal">
<li class="ulEmpty normal" id="section-7.1-2.1">
                 RAL to root<a class="pilcrow" href="#section-7.1-2.1">¶</a>
</li>
          <li class="ulEmpty normal" id="section-7.1-2.2">
                 root to RAL<a class="pilcrow" href="#section-7.1-2.2">¶</a>
</li>
          <li class="ulEmpty normal" id="section-7.1-2.3">
                 RUL to root<a class="pilcrow" href="#section-7.1-2.3">¶</a>
</li>
          <li class="ulEmpty normal" id="section-7.1-2.4">
                 root to RUL<a class="pilcrow" href="#section-7.1-2.4">¶</a>
</li>
        </ul>
<section id="section-7.1.1">
          <h4 id="name-sm-example-of-flow-from-ral">
<a class="section-number selfRef" href="#section-7.1.1">7.1.1. </a><a class="section-name selfRef" href="#name-sm-example-of-flow-from-ral">SM: Example of Flow from RAL to Root</a>
          </h4>
<p id="section-7.1.1-1">
                        In Storing mode, RPI <span>[<a class="xref" href="#RFC6553">RFC6553</a>]</span> is used
                        to send the RPLInstanceID and Rank
                        information.<a class="pilcrow" href="#section-7.1.1-1">¶</a></p>
<p id="section-7.1.1-2">
                           In this case, the flow comprises:<a class="pilcrow" href="#section-7.1.1-2">¶</a></p>
<p id="section-7.1.1-3">
                        RAL (6LN) --&gt; 6LR_i --&gt; root (6LBR)<a class="pilcrow" href="#section-7.1.1-3">¶</a></p>
<p id="section-7.1.1-4">
                        For example, a communication flow could be: 
Node F (6LN) --&gt; Node D (6LR_i) --&gt; Node B (6LR_i) --&gt; Node A root (6LBR)<a class="pilcrow" href="#section-7.1.1-4">¶</a></p>
<p id="section-7.1.1-5">
                           The RAL (Node F) inserts the RPI, and sends the
                           packet to the 6LR (Node D), which decrements the Rank in the RPI and
                           sends the packet up. When the packet arrives at
                           the 6LBR (Node A), the RPI is removed and the packet is
                           processed.<a class="pilcrow" href="#section-7.1.1-5">¶</a></p>
<p id="section-7.1.1-6">
                          No IPv6-in-IPv6 header is required.<a class="pilcrow" href="#section-7.1.1-6">¶</a></p>
<p id="section-7.1.1-7"> The RPI can be removed by the 6LBR
                         because the packet is addressed to the 6LBR.  The
                         RAL must know that it is communicating with the 6LBR
                         to make use of this scenario.
                         The RAL can know the address of the 6LBR because it
                         knows the address of the root via the DODAGID in the
                         DIO messages.<a class="pilcrow" href="#section-7.1.1-7">¶</a></p>
<p id="section-7.1.1-8">
                         <a class="xref" href="#Storing-summary-headers">Table 5</a> summarizes which headers are needed for this use case.<a class="pilcrow" href="#section-7.1.1-8">¶</a></p>
<span id="name-sm-summary-of-the-use-of-he"></span><div id="Storing-summary-headers">
<table class="center" id="table-5">
            <caption>
<a class="selfRef" href="#table-5">Table 5</a>:
<a class="selfRef" href="#name-sm-summary-of-the-use-of-he">SM: Summary of the Use of Headers from RAL to Root</a>
            </caption>
<thead>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Header</th>
                <th class="text-center" colspan="1" rowspan="1">RAL src</th>
                <th class="text-center" colspan="1" rowspan="1">6LR_i</th>
                <th class="text-center" colspan="1" rowspan="1">6LBR dst</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Added headers</th>
                <td class="text-center" colspan="1" rowspan="1">RPI</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Modified headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">RPI</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Removed headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">RPI</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Untouched headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
<div id="Storing-root2ral">
<section id="section-7.1.2">
          <h4 id="name-sm-example-of-flow-from-roo">
<a class="section-number selfRef" href="#section-7.1.2">7.1.2. </a><a class="section-name selfRef" href="#name-sm-example-of-flow-from-roo">SM: Example of Flow from Root to RAL</a>
          </h4>
<p id="section-7.1.2-1">
                                In this case, the flow comprises:<a class="pilcrow" href="#section-7.1.2-1">¶</a></p>
<p id="section-7.1.2-2">

                                root (6LBR) --&gt; 6LR_i --&gt; RAL (6LN)<a class="pilcrow" href="#section-7.1.2-2">¶</a></p>
<p id="section-7.1.2-3">
                        For example, a communication flow could be: 
Node A root (6LBR) --&gt; Node B (6LR_i) --&gt; Node D (6LR_i) --&gt; Node F (6LN)<a class="pilcrow" href="#section-7.1.2-3">¶</a></p>
<p id="section-7.1.2-4">
                                In this case, the 6LBR inserts RPI and
                                sends the packet down. The 6LR
                                increments the Rank in the RPI (it examines the
                                RPLInstanceID to identify the right forwarding
                                table).
                                The packet
                                is processed in the RAL, and the RPI is removed.<a class="pilcrow" href="#section-7.1.2-4">¶</a></p>
<p id="section-7.1.2-5">
                          No IPv6-in-IPv6 header is required.<a class="pilcrow" href="#section-7.1.2-5">¶</a></p>
<p id="section-7.1.2-6">
                        <a class="xref" href="#Storing-root2leaf">Table 6</a> summarizes which headers are needed for this use case.<a class="pilcrow" href="#section-7.1.2-6">¶</a></p>
<span id="name-sm-summary-of-the-use-of-hea"></span><div id="Storing-root2leaf">
<table class="center" id="table-6">
            <caption>
<a class="selfRef" href="#table-6">Table 6</a>:
<a class="selfRef" href="#name-sm-summary-of-the-use-of-hea">SM: Summary of the Use of Headers from Root to RAL</a>
            </caption>
<thead>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Header</th>
                <th class="text-center" colspan="1" rowspan="1">6LBR src</th>
                <th class="text-center" colspan="1" rowspan="1">6LR_i</th>
                <th class="text-center" colspan="1" rowspan="1">RAL dst</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Added headers</th>
                <td class="text-center" colspan="1" rowspan="1">RPI</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Modified headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">RPI</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Removed headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">RPI</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Untouched headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
</div>
<section id="section-7.1.3">
          <h4 id="name-sm-example-of-flow-from-root">
<a class="section-number selfRef" href="#section-7.1.3">7.1.3. </a><a class="section-name selfRef" href="#name-sm-example-of-flow-from-root">SM: Example of Flow from Root to RUL</a>
          </h4>
<p id="section-7.1.3-1">
                        In this case, the flow comprises:<a class="pilcrow" href="#section-7.1.3-1">¶</a></p>
<p id="section-7.1.3-2">
                                root (6LBR) --&gt; 6LR_i --&gt; RUL (IPv6 dst node)<a class="pilcrow" href="#section-7.1.3-2">¶</a></p>
<p id="section-7.1.3-3">
                        For example, a communication flow could be:
 Node A (6LBR) --&gt; Node B (6LR_i) --&gt; Node E (6LR_n) --&gt; Node G (RUL)<a class="pilcrow" href="#section-7.1.3-3">¶</a></p>
<p id="section-7.1.3-4">
                          6LR_i (Node B) represents the intermediate routers from the source (6LBR) to the destination (RUL),
                          and 1 &lt;= i &lt;= n, where n is the total number of routers (6LR)
                          that the packet goes through, from the 6LBR (Node A) to the RUL (Node G).<a class="pilcrow" href="#section-7.1.3-4">¶</a></p>
<p id="section-7.1.3-5">
                        The 6LBR will encapsulate the packet in an IPv6-in-IPv6 header and prepend an RPI. The IPv6-in-IPv6
                        header is addressed to the 6LR parent of the RUL (6LR_n).
                        The 6LR parent of the RUL removes the header and sends the packet to the RUL.<a class="pilcrow" href="#section-7.1.3-5">¶</a></p>
<p id="section-7.1.3-6">
                        <a class="xref" href="#Storing-root2notrpl">Table 7</a> summarizes which headers are needed for this use case.<a class="pilcrow" href="#section-7.1.3-6">¶</a></p>
<span id="name-sm-summary-of-the-use-of-head"></span><div id="Storing-root2notrpl">
<table class="center" id="table-7">
            <caption>
<a class="selfRef" href="#table-7">Table 7</a>:
<a class="selfRef" href="#name-sm-summary-of-the-use-of-head">SM: Summary of the Use of Headers from Root to RUL</a>
            </caption>
<thead>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Header</th>
                <th class="text-center" colspan="1" rowspan="1">6LBR src</th>
                <th class="text-center" colspan="1" rowspan="1">6LR_i</th>
                <th class="text-center" colspan="1" rowspan="1">6LR_n</th>
                <th class="text-center" colspan="1" rowspan="1">RUL dst</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Added headers</th>
                <td class="text-center" colspan="1" rowspan="1">IP6-IP6 (RPI)</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Modified headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">RPI</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Removed headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">IP6-IP6 (RPI)</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Untouched headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">IP6-IP6</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
            </tbody>
          </table>
</div>
<p id="section-7.1.3-8">
                       IP-in-IP encapsulation may be avoided for root-to-RUL communication.
                       In SM, it can be replaced by a loose RH3 header that indicates the RUL.
                       In which case, the packet is routed to the 6LR as a normal SM operation,
                       then the 6LR forwards to the RUL based on the RH3, and the RUL ignores
                       both the consumed RH3 and the RPI, as in Non-Storing mode.<a class="pilcrow" href="#section-7.1.3-8">¶</a></p>
<p id="section-7.1.3-9">
                       <a class="xref" href="#Storing-root2notrplnoIPIP">Table 8</a> summarizes which headers are needed for this scenario.<a class="pilcrow" href="#section-7.1.3-9">¶</a></p>
<span id="name-sm-summary-of-the-use-of-heade"></span><div id="Storing-root2notrplnoIPIP">
<table class="center" id="table-8">
            <caption>
<a class="selfRef" href="#table-8">Table 8</a>:
<a class="selfRef" href="#name-sm-summary-of-the-use-of-heade">SM: Summary of the Use of Headers from Root to RUL without Encapsulation</a>
            </caption>
<thead>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Header</th>
                <th class="text-center" colspan="1" rowspan="1">6LBR src</th>
                <th class="text-center" colspan="1" rowspan="1">6LR_i<br/>i=(1,..,n-1)</th>
                <th class="text-center" colspan="1" rowspan="1">6LR_n</th>
                <th class="text-center" colspan="1" rowspan="1">RUL dst</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Added headers</th>
                <td class="text-center" colspan="1" rowspan="1">RPI, RH3</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Modified headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">RPI</td>
                <td class="text-center" colspan="1" rowspan="1">RPI, RH3(consumed)</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Removed headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Untouched headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">RH3</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">RPI, RH3 (both ignored)</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
<div id="sm-nRal2root">
<section id="section-7.1.4">
          <h4 id="name-sm-example-of-flow-from-rul">
<a class="section-number selfRef" href="#section-7.1.4">7.1.4. </a><a class="section-name selfRef" href="#name-sm-example-of-flow-from-rul">SM: Example of Flow from RUL to Root</a>
          </h4>
<p id="section-7.1.4-1">
                                In this case, the flow comprises:<a class="pilcrow" href="#section-7.1.4-1">¶</a></p>
<p id="section-7.1.4-2">

                                RUL (IPv6 src node) --&gt; 6LR_1 --&gt; 6LR_i --&gt; root (6LBR)<a class="pilcrow" href="#section-7.1.4-2">¶</a></p>
<p id="section-7.1.4-3">
                        For example, a communication flow could be:
 Node G (RUL) --&gt; Node E (6LR_1) --&gt; Node B (6LR_i) --&gt; Node A root (6LBR)<a class="pilcrow" href="#section-7.1.4-3">¶</a></p>
<p id="section-7.1.4-4">
                          6LR_i represents the intermediate routers from the source (RUL) to the destination (6LBR),
                          and 1 &lt;= i &lt;= n, where n is the total number of routers (6LR)
                          that the packet goes through, from the RUL to the 6LBR.<a class="pilcrow" href="#section-7.1.4-4">¶</a></p>
<p id="section-7.1.4-5">
                        When the packet arrives from the RUL (Node G) to
                        6LR_1 (Node E), the 6LR_1 will encapsulate the packet
                        in an IPv6-in-IPv6 header with an RPI. The IPv6-in-IPv6
                        header is addressed to the root (Node A).  The root removes the header and processes
                        the packet.<a class="pilcrow" href="#section-7.1.4-5">¶</a></p>
<p id="section-7.1.4-6">
                        <a class="xref" href="#Storing-notrpl2root">Table 9</a> summarizes which headers are needed for this use case
                        where the IPv6-in-IPv6 header is addressed to the root (Node A).<a class="pilcrow" href="#section-7.1.4-6">¶</a></p>
<span id="name-sm-summary-of-the-use-of-header"></span><div id="Storing-notrpl2root">
<table class="center" id="table-9">
            <caption>
<a class="selfRef" href="#table-9">Table 9</a>:
<a class="selfRef" href="#name-sm-summary-of-the-use-of-header">SM: Summary of the Use of Headers from RUL to Root</a>
            </caption>
<thead>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Header</th>
                <th class="text-center" colspan="1" rowspan="1">RUL src</th>
                <th class="text-center" colspan="1" rowspan="1">6LR_1</th>
                <th class="text-center" colspan="1" rowspan="1">6LR_i</th>
                <th class="text-center" colspan="1" rowspan="1">6LBR dst</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Added headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">IP6-IP6 (RPI)</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Modified headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">RPI</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Removed headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">IP6-IP6 (RPI)</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Untouched headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">IP6-IP6</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
</div>
</section>
<section id="section-7.2">
        <h3 id="name-sm-interaction-between-leaf">
<a class="section-number selfRef" href="#section-7.2">7.2. </a><a class="section-name selfRef" href="#name-sm-interaction-between-leaf">SM: Interaction between Leaf and Internet</a>
        </h3>
<p id="section-7.2-1">
                   This section describes the communication flow
                   in Storing mode (SM) between the following:<a class="pilcrow" href="#section-7.2-1">¶</a></p>
<ul class="ulEmpty normal">
<li class="ulEmpty normal" id="section-7.2-2.1">
                       RAL to Internet<a class="pilcrow" href="#section-7.2-2.1">¶</a>
</li>
          <li class="ulEmpty normal" id="section-7.2-2.2">
                       Internet to RAL<a class="pilcrow" href="#section-7.2-2.2">¶</a>
</li>
          <li class="ulEmpty normal" id="section-7.2-2.3">
                       RUL to Internet<a class="pilcrow" href="#section-7.2-2.3">¶</a>
</li>
          <li class="ulEmpty normal" id="section-7.2-2.4">
                       Internet to RUL<a class="pilcrow" href="#section-7.2-2.4">¶</a>
</li>
        </ul>
<div id="sm-Ral2i">
<section id="section-7.2.1">
          <h4 id="name-sm-example-of-flow-from-ral-">
<a class="section-number selfRef" href="#section-7.2.1">7.2.1. </a><a class="section-name selfRef" href="#name-sm-example-of-flow-from-ral-">SM: Example of Flow from RAL to Internet</a>
          </h4>
<p id="section-7.2.1-1">
                                In this case, the flow comprises:<a class="pilcrow" href="#section-7.2.1-1">¶</a></p>
<p id="section-7.2.1-2">

                                RAL (6LN) --&gt; 6LR_i --&gt; root (6LBR) --&gt; Internet<a class="pilcrow" href="#section-7.2.1-2">¶</a></p>
<p id="section-7.2.1-3">
                        For example, the communication flow could be:
Node F (RAL) --&gt; Node D (6LR_i) --&gt; Node B (6LR_i) --&gt; Node A root (6LBR) --&gt; Internet<a class="pilcrow" href="#section-7.2.1-3">¶</a></p>
<p id="section-7.2.1-4">
                          6LR_i represents the intermediate routers from the source (RAL) to the root (6LBR),
                          and 1 &lt;= i &lt;= n, where n is the total number of routers (6LR)
                          that the packet goes through, from the RAL to the 6LBR.<a class="pilcrow" href="#section-7.2.1-4">¶</a></p>
<p id="section-7.2.1-5">
                       RPL information from RFC 6553 may go out to
                       Internet as it will be ignored by nodes that have
                       not been configured to be RPL aware. No IPv6-in-IPv6 header is required.<a class="pilcrow" href="#section-7.2.1-5">¶</a></p>
<p id="section-7.2.1-6">
                       On the other hand, the RAL may insert the RPI encapsulated in an IPv6-in-IPv6 header to the root.
                       Thus, the root removes the RPI and sends the packet to the Internet.<a class="pilcrow" href="#section-7.2.1-6">¶</a></p>
<aside id="section-7.2.1-7">
            <p id="section-7.2.1-7.1">
                          Note: In this use case, a leaf node is used, but this use case 
                          can also be applicable to any RPL-aware node type (e.g., 6LR).<a class="pilcrow" href="#section-7.2.1-7.1">¶</a></p>
</aside>
<p id="section-7.2.1-8">
                        <a class="xref" href="#Storing-rpl2int">Table 10</a> summarizes which headers are needed for this use case when there is no encapsulation.
                        Note that the RPI is modified by 6LBR to set the SenderRank to zero in the case that it is not already zero.
                        <a class="xref" href="#Storing-rpl2intIPIP">Table 11</a> summarizes which headers are needed when encapsulation to the root takes place.<a class="pilcrow" href="#section-7.2.1-8">¶</a></p>
<span id="name-sm-summary-of-the-use-of-headers"></span><div id="Storing-rpl2int">
<table class="center" id="table-10">
            <caption>
<a class="selfRef" href="#table-10">Table 10</a>:
<a class="selfRef" href="#name-sm-summary-of-the-use-of-headers">SM: Summary of the Use of Headers from RAL to Internet with No Encapsulation</a>
            </caption>
<thead>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Header</th>
                <th class="text-center" colspan="1" rowspan="1">RAL src</th>
                <th class="text-center" colspan="1" rowspan="1">6LR_i</th>
                <th class="text-center" colspan="1" rowspan="1">6LBR</th>
                <th class="text-center" colspan="1" rowspan="1">Internet dst</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Added headers</th>
                <td class="text-center" colspan="1" rowspan="1">RPI</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Modified headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">RPI</td>
                <td class="text-center" colspan="1" rowspan="1">RPI</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Removed headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Untouched headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">RPI (Ignored)</td>
              </tr>
            </tbody>
          </table>
</div>
<p id="section-7.2.1-10"></p>
<span id="name-sm-summary-of-the-use-of-headers-"></span><div id="Storing-rpl2intIPIP">
<table class="center" id="table-11">
            <caption>
<a class="selfRef" href="#table-11">Table 11</a>:
<a class="selfRef" href="#name-sm-summary-of-the-use-of-headers-">SM: Summary of the Use of Headers from RAL to Internet with Encapsulation to the Root (6LBR)</a>
            </caption>
<thead>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Header</th>
                <th class="text-center" colspan="1" rowspan="1">RAL src</th>
                <th class="text-center" colspan="1" rowspan="1">6LR_i</th>
                <th class="text-center" colspan="1" rowspan="1">6LBR</th>
                <th class="text-center" colspan="1" rowspan="1">Internet dst</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Added headers</th>
                <td class="text-center" colspan="1" rowspan="1">IP6-IP6 (RPI)</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Modified headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">RPI</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Removed headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">IP6-IP6 (RPI)</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Untouched headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">IP6-IP6</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
</div>
<section id="section-7.2.2">
          <h4 id="name-sm-example-of-flow-from-int">
<a class="section-number selfRef" href="#section-7.2.2">7.2.2. </a><a class="section-name selfRef" href="#name-sm-example-of-flow-from-int">SM: Example of Flow from Internet to RAL</a>
          </h4>
<p id="section-7.2.2-1">
                                In this case, the flow comprises:<a class="pilcrow" href="#section-7.2.2-1">¶</a></p>
<p id="section-7.2.2-2">

                                Internet --&gt; root (6LBR) --&gt; 6LR_i --&gt; RAL (6LN)<a class="pilcrow" href="#section-7.2.2-2">¶</a></p>
<p id="section-7.2.2-3">
                        For example, a communication flow could be: 
Internet --&gt; Node A root (6LBR) --&gt; Node B (6LR_1) --&gt; Node D (6LR_n) --&gt; Node F (RAL)<a class="pilcrow" href="#section-7.2.2-3">¶</a></p>
<p id="section-7.2.2-4">

                                When the packet arrives from Internet to 6LBR,
                                the RPI is added in a outer
                                IPv6-in-IPv6 header (with the IPv6-in-IPv6 destination address set to the RAL) and sent to the 6LR, which
                                modifies the Rank in the RPI. When the packet
                                arrives at the RAL, the packet is decapsulated, which removes the RPI before the
                                packet is processed.<a class="pilcrow" href="#section-7.2.2-4">¶</a></p>
<p id="section-7.2.2-5">
                        <a class="xref" href="#Storing-int2rpl">Table 12</a> summarizes which headers are needed for this use case.<a class="pilcrow" href="#section-7.2.2-5">¶</a></p>
<span id="name-sm-summary-of-the-use-of-headers-f"></span><div id="Storing-int2rpl">
<table class="center" id="table-12">
            <caption>
<a class="selfRef" href="#table-12">Table 12</a>:
<a class="selfRef" href="#name-sm-summary-of-the-use-of-headers-f">SM: Summary of the Use of Headers from Internet to RAL</a>
            </caption>
<thead>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Header</th>
                <th class="text-center" colspan="1" rowspan="1">Internet src</th>
                <th class="text-center" colspan="1" rowspan="1">6LBR</th>
                <th class="text-center" colspan="1" rowspan="1">6LR_i</th>
                <th class="text-center" colspan="1" rowspan="1"> RAL dst</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Added headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">IP6-IP6 (RPI)</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Modified headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">RPI</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Removed headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">IP6-IP6 (RPI)</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Untouched headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
<div id="sm-nRal2i">
<section id="section-7.2.3">
          <h4 id="name-sm-example-of-flow-from-rul-">
<a class="section-number selfRef" href="#section-7.2.3">7.2.3. </a><a class="section-name selfRef" href="#name-sm-example-of-flow-from-rul-">SM: Example of Flow from RUL to Internet</a>
          </h4>
<p id="section-7.2.3-1">
                   In this case, the flow comprises:<a class="pilcrow" href="#section-7.2.3-1">¶</a></p>
<p id="section-7.2.3-2">
                   RUL (IPv6 src node) --&gt; 6LR_1 --&gt; 6LR_i --&gt; root (6LBR) --&gt; Internet<a class="pilcrow" href="#section-7.2.3-2">¶</a></p>
<p id="section-7.2.3-3">
                 For example, a communication flow could be: 
Node G (RUL) --&gt; Node E (6LR_1) --&gt; Node B (6lR_i) --&gt; Node A root (6LBR) --&gt; Internet<a class="pilcrow" href="#section-7.2.3-3">¶</a></p>
<p id="section-7.2.3-4">
                   The node 6LR_1 (i=1) will add an IPv6-in-IPv6 (RPI) header addressed to the root such that the root can remove
                   the RPI before passing upwards.
                   In the intermediate 6LR, the Rank in the RPI is modified.<a class="pilcrow" href="#section-7.2.3-4">¶</a></p>
<p id="section-7.2.3-5">
                   The originating node will ideally leave the IPv6 flow
                   label as zero so that the packet can be better compressed through
                   the LLN. The 6LBR will set the flow label of the packet to a
                   non-zero value when sending to the Internet. For details, check <span>[<a class="xref" href="#RFC6437">RFC6437</a>]</span>.<a class="pilcrow" href="#section-7.2.3-5">¶</a></p>
<p id="section-7.2.3-6">
                 <a class="xref" href="#Storing-notrpl2int">Table 13</a> summarizes which headers are needed for this use case.<a class="pilcrow" href="#section-7.2.3-6">¶</a></p>
<span id="name-sm-summary-of-the-use-of-headers-fr"></span><div id="Storing-notrpl2int">
<table class="center" id="table-13">
            <caption>
<a class="selfRef" href="#table-13">Table 13</a>:
<a class="selfRef" href="#name-sm-summary-of-the-use-of-headers-fr">SM: Summary of the Use of Headers from RUL to Internet</a>
            </caption>
<thead>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Header</th>
                <th class="text-center" colspan="1" rowspan="1">IPv6 src (RUL)</th>
                <th class="text-center" colspan="1" rowspan="1">6LR_1</th>
                <th class="text-center" colspan="1" rowspan="1">6LR_i i=(2,..,n)</th>
                <th class="text-center" colspan="1" rowspan="1">6LBR</th>
                <th class="text-center" colspan="1" rowspan="1">Internet dst</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Added headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">IP6-IP6 (RPI)</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Modified headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">RPI</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Removed headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">IP6-IP6 (RPI)</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Untouched headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
</div>
<section id="section-7.2.4">
          <h4 id="name-sm-example-of-flow-from-inte">
<a class="section-number selfRef" href="#section-7.2.4">7.2.4. </a><a class="section-name selfRef" href="#name-sm-example-of-flow-from-inte">SM: Example of Flow from Internet to RUL</a>
          </h4>
<p id="section-7.2.4-1">
                                In this case, the flow comprises:<a class="pilcrow" href="#section-7.2.4-1">¶</a></p>
<p id="section-7.2.4-2">
                                Internet --&gt; root (6LBR) --&gt; 6LR_i --&gt; RUL (IPv6 dst node)<a class="pilcrow" href="#section-7.2.4-2">¶</a></p>
<p id="section-7.2.4-3">
                        For example, a communication flow could be: 
Internet --&gt; Node A root (6LBR) --&gt; Node B (6LR_i) --&gt; Node E (6LR_n) --&gt; Node G (RUL)<a class="pilcrow" href="#section-7.2.4-3">¶</a></p>
<p id="section-7.2.4-4">
                          The 6LBR will have to add an RPI within an
                          IPv6-in-IPv6 header. The IPv6-in-IPv6 encapsulating header is addressed
                          to the 6LR parent of the RUL.<a class="pilcrow" href="#section-7.2.4-4">¶</a></p>
<p id="section-7.2.4-5">
                          Further details about this are mentioned in <span>[<a class="xref" href="#RFC9010">RFC9010</a>]</span>,
                          which specifies RPL routing for a 6LN acting as a plain host and being unaware of RPL.<a class="pilcrow" href="#section-7.2.4-5">¶</a></p>
<p id="section-7.2.4-6">
                          The 6LBR may set the flow label on the inner IPv6-in-IPv6
                          header to zero in order to aid in compression <span>[<a class="xref" href="#RFC8138">RFC8138</a>]</span> <span>[<a class="xref" href="#RFC6437">RFC6437</a>]</span>.<a class="pilcrow" href="#section-7.2.4-6">¶</a></p>
<p id="section-7.2.4-7">
                       <a class="xref" href="#Storing-int2notrpl">Table 14</a> summarizes which headers are needed for this use case.<a class="pilcrow" href="#section-7.2.4-7">¶</a></p>
<span id="name-sm-summary-of-the-use-of-headers-fr-2"></span><div id="Storing-int2notrpl">
<table class="center" id="table-14">
            <caption>
<a class="selfRef" href="#table-14">Table 14</a>:
<a class="selfRef" href="#name-sm-summary-of-the-use-of-headers-fr-2">SM: Summary of the Use of Headers from Internet to RUL</a>
            </caption>
<thead>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Header</th>
                <th class="text-center" colspan="1" rowspan="1">Internet src</th>
                <th class="text-center" colspan="1" rowspan="1">6LBR</th>
                <th class="text-center" colspan="1" rowspan="1">6LR_i i=(1,..,n-1)</th>
                <th class="text-center" colspan="1" rowspan="1">6LR_n</th>
                <th class="text-center" colspan="1" rowspan="1">RUL dst</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Added headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">IP6-IP6 (RPI)</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Modified headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">RPI</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Removed headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">IP6-IP6 (RPI)</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Untouched headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
</section>
<section id="section-7.3">
        <h3 id="name-sm-interaction-between-leaf-">
<a class="section-number selfRef" href="#section-7.3">7.3. </a><a class="section-name selfRef" href="#name-sm-interaction-between-leaf-">SM: Interaction between Leaf and Leaf</a>
        </h3>
<p id="section-7.3-1">
         This section describes the communication flow
         in Storing mode (SM) between the following:<a class="pilcrow" href="#section-7.3-1">¶</a></p>
<ul class="ulEmpty normal">
<li class="ulEmpty normal" id="section-7.3-2.1">
             RAL to RAL<a class="pilcrow" href="#section-7.3-2.1">¶</a>
</li>
          <li class="ulEmpty normal" id="section-7.3-2.2">
             RAL to RUL<a class="pilcrow" href="#section-7.3-2.2">¶</a>
</li>
          <li class="ulEmpty normal" id="section-7.3-2.3">
             RUL to  RAL<a class="pilcrow" href="#section-7.3-2.3">¶</a>
</li>
          <li class="ulEmpty normal" id="section-7.3-2.4">
             RUL to RUL<a class="pilcrow" href="#section-7.3-2.4">¶</a>
</li>
        </ul>
<div id="storingRALtoRAL">
<section id="section-7.3.1">
          <h4 id="name-sm-example-of-flow-from-ral-t">
<a class="section-number selfRef" href="#section-7.3.1">7.3.1. </a><a class="section-name selfRef" href="#name-sm-example-of-flow-from-ral-t">SM: Example of Flow from RAL to RAL</a>
          </h4>
<p id="section-7.3.1-1">
                   In <span>[<a class="xref" href="#RFC6550">RFC6550</a>]</span>, RPL allows a simple, one-hop
                   optimization for both Storing and Non-Storing
                   networks.
                   A node may send a packet destined to a one-hop
                   neighbor directly to that node. See <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6550#section-9">Section 9</a> of [<a class="xref" href="#RFC6550">RFC6550</a>]</span>.<a class="pilcrow" href="#section-7.3.1-1">¶</a></p>
<p id="section-7.3.1-2">
                   When the nodes are not directly connected, then 
                   the flow comprises the following in the Storing mode:<a class="pilcrow" href="#section-7.3.1-2">¶</a></p>
<p id="section-7.3.1-3">
                   RAL src (6LN) --&gt; 6LR_ia --&gt; common parent (6LR_x) --&gt; 6LR_id --&gt;  RAL dst (6LN)<a class="pilcrow" href="#section-7.3.1-3">¶</a></p>
<p id="section-7.3.1-4">
                 For example, a communication flow could be:
Node F (RAL src) --&gt; Node D (6LR_ia) --&gt; Node B (6LR_x) --&gt; Node E (6LR_id) --&gt; Node H (RAL dst)<a class="pilcrow" href="#section-7.3.1-4">¶</a></p>
<p id="section-7.3.1-5">
                   6LR_ia (Node D) represents the intermediate routers from the source to the common parent 6LR_x (Node B),
                   and 1 &lt;= ia &lt;= n, where n is the total number of routers (6LR)
                   that the packet goes through, from the RAL (Node F) to the common parent 6LR_x (Node B).<a class="pilcrow" href="#section-7.3.1-5">¶</a></p>
<p id="section-7.3.1-6">
                   6LR_id (Node E) represents the intermediate routers from the common parent 6LR_x (Node B) to the destination RAL (Node H),
                    and 1 &lt;= id &lt;= m, where m is the total number of routers (6LR)
                   that the packet goes through, from the common parent (6LR_x) to the destination RAL (Node H).<a class="pilcrow" href="#section-7.3.1-6">¶</a></p>
<p id="section-7.3.1-7">
                   It is assumed that the two nodes are in the same RPL domain
                   (that they share the same DODAG root). At the
                   common parent (Node B), the direction flag ('O' flag) of the RPI is changed (from decreasing ranks to increasing ranks).<a class="pilcrow" href="#section-7.3.1-7">¶</a></p>
<p id="section-7.3.1-8">
                   While the 6LR nodes will update the RPI, no node needs to
                   add or remove the RPI, so no IPv6-in-IPv6 headers are
                   necessary.<a class="pilcrow" href="#section-7.3.1-8">¶</a></p>
<p id="section-7.3.1-9">
                <a class="xref" href="#Storing-rpl2rpl">Table 15</a> summarizes which headers are needed for this use case.<a class="pilcrow" href="#section-7.3.1-9">¶</a></p>
<span id="name-sm-summary-of-the-use-of-headers-fr-3"></span><div id="Storing-rpl2rpl">
<table class="center" id="table-15">
            <caption>
<a class="selfRef" href="#table-15">Table 15</a>:
<a class="selfRef" href="#name-sm-summary-of-the-use-of-headers-fr-3">SM: Summary of the Use of Headers from RAL to RAL</a>
            </caption>
<thead>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Header</th>
                <th class="text-center" colspan="1" rowspan="1">RAL src</th>
                <th class="text-center" colspan="1" rowspan="1">6LR_ia</th>
                <th class="text-center" colspan="1" rowspan="1">6LR_x (common parent)</th>
                <th class="text-center" colspan="1" rowspan="1">6LR_id</th>
                <th class="text-center" colspan="1" rowspan="1">RAL dst</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Added headers</th>
                <td class="text-center" colspan="1" rowspan="1">RPI</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Modified headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">RPI</td>
                <td class="text-center" colspan="1" rowspan="1">RPI</td>
                <td class="text-center" colspan="1" rowspan="1">RPI</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Removed headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">RPI</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Untouched headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
</div>
<div id="storingRALtononRAL">
<section id="section-7.3.2">
          <h4 id="name-sm-example-of-flow-from-ral-to">
<a class="section-number selfRef" href="#section-7.3.2">7.3.2. </a><a class="section-name selfRef" href="#name-sm-example-of-flow-from-ral-to">SM: Example of Flow from RAL to RUL</a>
          </h4>
<p id="section-7.3.2-1">
                        In this case, the flow comprises:<a class="pilcrow" href="#section-7.3.2-1">¶</a></p>
<p id="section-7.3.2-2">
                         RAL src (6LN) --&gt; 6LR_ia --&gt; common parent (6LBR, the root) --&gt; 6LR_id --&gt;  RUL (IPv6 dst node)<a class="pilcrow" href="#section-7.3.2-2">¶</a></p>
<p id="section-7.3.2-3">
                        For example, a communication flow could be: 
Node F (RAL) --&gt; Node D --&gt; Node B --&gt; Node A --&gt; Node B --&gt; Node E --&gt; Node G (RUL)<a class="pilcrow" href="#section-7.3.2-3">¶</a></p>
<p id="section-7.3.2-4">
                          6LR_ia represents the intermediate routers from the source (RAL) to the
                          common parent (the root), and 1 &lt;= ia &lt;= n, where n is the total number of
                          routers (6LR) that the packet goes through, from the RAL to the root.<a class="pilcrow" href="#section-7.3.2-4">¶</a></p>
<p id="section-7.3.2-5">
                          6LR_id (Node E) represents the intermediate routers from the root
                          (Node B) to the destination RUL (Node G).  In this case, 1 &lt;= id &lt;= m,
                          where m is the total number of routers (6LR) that the packet goes
                          through, from the root down to the destination RUL.<a class="pilcrow" href="#section-7.3.2-5">¶</a></p>
<p id="section-7.3.2-6">
                          In this case, the packet from the RAL goes to the 6LBR because the route to the RUL is not injected into the RPL SM.
                          Thus, the RAL inserts an RPI (RPI1) addressed to the root (6LBR). The root does not remove the RPI1
                          (the root cannot remove an RPI if there is no encapsulation). The root inserts an IPv6-in-IPv6 encapsulation with an RPI2
                          and sends it to the 6LR parent of the RUL, which removes the encapsulation and RPI2 before passing the packet to the RUL.<a class="pilcrow" href="#section-7.3.2-6">¶</a></p>
<p id="section-7.3.2-7">
                        <a class="xref" href="#Storing-rpl2nrpl">Table 16</a> summarizes which headers are needed for this use case.<a class="pilcrow" href="#section-7.3.2-7">¶</a></p>
<span id="name-sm-summary-of-the-use-of-headers-fr-4"></span><div id="Storing-rpl2nrpl">
<table class="center" id="table-16">
            <caption>
<a class="selfRef" href="#table-16">Table 16</a>:
<a class="selfRef" href="#name-sm-summary-of-the-use-of-headers-fr-4">SM: Summary of the Use of Headers from RAL to RUL</a>
            </caption>
<thead>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Header</th>
                <th class="text-center" colspan="1" rowspan="1">RAL src</th>
                <th class="text-center" colspan="1" rowspan="1">6LR_ia</th>
                <th class="text-center" colspan="1" rowspan="1">6LBR</th>
                <th class="text-center" colspan="1" rowspan="1">6LR_id</th>
                <th class="text-center" colspan="1" rowspan="1">6LR_m</th>
                <th class="text-center" colspan="1" rowspan="1">RUL dst</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Added headers</th>
                <td class="text-center" colspan="1" rowspan="1">RPI1</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">IP6-IP6 (RPI2)</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Modified headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">RPI1</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">RPI2</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Removed headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">IP6-IP6 (RPI2)</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Untouched headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">RPI1</td>
                <td class="text-center" colspan="1" rowspan="1">RPI1</td>
                <td class="text-center" colspan="1" rowspan="1">RPI1</td>
                <td class="text-center" colspan="1" rowspan="1">RPI1 (ignored)</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
</div>
<div id="storingnotRALtoRAL">
<section id="section-7.3.3">
          <h4 id="name-sm-example-of-flow-from-rul-t">
<a class="section-number selfRef" href="#section-7.3.3">7.3.3. </a><a class="section-name selfRef" href="#name-sm-example-of-flow-from-rul-t">SM: Example of Flow from RUL to RAL</a>
          </h4>
<p id="section-7.3.3-1">
                   In this case, the flow comprises:<a class="pilcrow" href="#section-7.3.3-1">¶</a></p>
<p id="section-7.3.3-2">
                   RUL (IPv6 src node) --&gt; 6LR_ia --&gt; 6LBR --&gt; 6LR_id --&gt;  RAL dst (6LN)<a class="pilcrow" href="#section-7.3.3-2">¶</a></p>
<p id="section-7.3.3-3">
                 For example, a communication flow could be: 
Node G (RUL) --&gt; Node E --&gt; Node B --&gt; Node A --&gt; Node B --&gt; Node D --&gt; Node F (RAL)<a class="pilcrow" href="#section-7.3.3-3">¶</a></p>
<p id="section-7.3.3-4">
                   6LR_ia (Node E) represents the intermediate routers from the source (RUL) (Node G) to the root (Node A).
                   In this case, 1 &lt;= ia &lt;= n, where n is the total number of routers (6LR)
                   that the packet goes through, from the source to the root.<a class="pilcrow" href="#section-7.3.3-4">¶</a></p>
<p id="section-7.3.3-5">
                   6LR_id represents the intermediate routers from the root (Node A) to the destination RAL (Node F).
                   In this case, 1 &lt;= id &lt;= m, where m is the total number of routers (6LR)
                   that the packet goes through, from the root to the destination RAL.<a class="pilcrow" href="#section-7.3.3-5">¶</a></p>
<p id="section-7.3.3-6">
                   The 6LR_1 (Node E) receives the packet from the RUL (Node G) and
                   inserts the RPI (RPI1) encapsulated in an IPv6-in-IPv6 header to the root.
                   The root removes the outer header including the RPI (RPI1) and
                   inserts a new RPI (RPI2) addressed to the destination RAL (Node F).<a class="pilcrow" href="#section-7.3.3-6">¶</a></p>
<p id="section-7.3.3-7">
                 <a class="xref" href="#Storing-notrpl2rpl">Table 17</a> summarizes which headers are needed for this use case.<a class="pilcrow" href="#section-7.3.3-7">¶</a></p>
<span id="name-sm-summary-of-the-use-of-headers-fr-5"></span><div id="Storing-notrpl2rpl">
<table class="center" id="table-17">
            <caption>
<a class="selfRef" href="#table-17">Table 17</a>:
<a class="selfRef" href="#name-sm-summary-of-the-use-of-headers-fr-5">SM: Summary of the Use of Headers from RUL to RAL</a>
            </caption>
<thead>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Header</th>
                <th class="text-center" colspan="1" rowspan="1">RUL src</th>
                <th class="text-center" colspan="1" rowspan="1">6LR_1</th>
                <th class="text-center" colspan="1" rowspan="1">6LR_ia</th>
                <th class="text-center" colspan="1" rowspan="1">6LBR</th>
                <th class="text-center" colspan="1" rowspan="1">6LR_id</th>
                <th class="text-center" colspan="1" rowspan="1">RAL dst</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Added headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">IP6-IP6 (RPI1)</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">IP6-IP6 (RPI2)</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Modified headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">RPI1</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">RPI2</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Removed headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">IP6-IP6 (RPI1)</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">IP6-IP6 (RPI2)</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Untouched headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
</div>
<section id="section-7.3.4">
          <h4 id="name-sm-example-of-flow-from-rul-to">
<a class="section-number selfRef" href="#section-7.3.4">7.3.4. </a><a class="section-name selfRef" href="#name-sm-example-of-flow-from-rul-to">SM: Example of Flow from RUL to RUL</a>
          </h4>
<p id="section-7.3.4-1">
                   In this case, the flow comprises:<a class="pilcrow" href="#section-7.3.4-1">¶</a></p>
<p id="section-7.3.4-2">
                   RUL (IPv6 src node) --&gt; 6LR_1 --&gt; 6LR_ia --&gt; 6LBR --&gt; 6LR_id --&gt; RUL (IPv6 dst node)<a class="pilcrow" href="#section-7.3.4-2">¶</a></p>
<p id="section-7.3.4-3">
                 For example, a communication flow could be: 
Node G (RUL src) --&gt; Node E --&gt; Node B --&gt; Node A (root) --&gt; Node C --&gt; Node J (RUL dst)<a class="pilcrow" href="#section-7.3.4-3">¶</a></p>
<p id="section-7.3.4-4">
                   Internal nodes 6LR_ia (e.g., Node E or Node B) is the
                   intermediate router from the RUL source (Node G)
                   to the root (6LBR) (Node A).
                   In this case, 1 &lt;= ia &lt;= n, where n is the total number of routers (6LR)
                   that the packet goes through, from the RUL to the root. 6LR_1 applies when ia=1.<a class="pilcrow" href="#section-7.3.4-4">¶</a></p>
<p id="section-7.3.4-5">
                   6LR_id (Node C) represents the intermediate routers from the root
                   (Node A) to the destination RUL (Node J).
                   In this case, 1 &lt;= id &lt;= m, where m is the total number of routers (6LR)
                   that the packet goes through, from the root to the destination RUL.<a class="pilcrow" href="#section-7.3.4-5">¶</a></p>
<p id="section-7.3.4-6">
                   The 6LR_1 (Node E) receives the packet from the
                   RUL (Node G) and adds the RPI (RPI1)
                   in an IPv6-in-IPv6 encapsulation directed to the root.
                   The root removes the outer header including the RPI (RPI1) and
                   inserts a new RPI (RPI2) addressed to the 6LR parent of the RUL.<a class="pilcrow" href="#section-7.3.4-6">¶</a></p>
<p id="section-7.3.4-7">
                 <a class="xref" href="#Storing-notrpl2notrpl">Table 18</a> summarizes which headers are needed for this use case.<a class="pilcrow" href="#section-7.3.4-7">¶</a></p>
<span id="name-sm-summary-of-the-use-of-headers-fr-6"></span><div id="Storing-notrpl2notrpl">
<table class="center" id="table-18">
            <caption>
<a class="selfRef" href="#table-18">Table 18</a>:
<a class="selfRef" href="#name-sm-summary-of-the-use-of-headers-fr-6">SM: Summary of the Use of Headers from RUL to RUL</a>
            </caption>
<thead>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Header</th>
                <th class="text-center" colspan="1" rowspan="1">RUL src</th>
                <th class="text-center" colspan="1" rowspan="1">6LR_1</th>
                <th class="text-center" colspan="1" rowspan="1">6LR_ia</th>
                <th class="text-center" colspan="1" rowspan="1">6LBR</th>
                <th class="text-center" colspan="1" rowspan="1">6LR_id</th>
                <th class="text-center" colspan="1" rowspan="1">6LR_n</th>
                <th class="text-center" colspan="1" rowspan="1">RUL dst</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Added headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">IP6-IP6 (RPI1)</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">IP6-IP6 (RPI1)</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Modified headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">RPI1</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">RPI2</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Removed headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">IP6-IP6 (RPI1)</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">IP6-IP6 (RPI2)</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Untouched headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
</section>
</section>
</div>
<div id="sec_non-sm">
<section id="section-8">
      <h2 id="name-non-storing-mode">
<a class="section-number selfRef" href="#section-8">8. </a><a class="section-name selfRef" href="#name-non-storing-mode">Non-Storing Mode</a>
      </h2>
<p id="section-8-1">
          In Non-Storing mode (Non-SM) (fully source routed),
          the 6LBR (DODAG root) has complete knowledge about the
          connectivity of all DODAG nodes and all traffic flows
          through the root node. Thus, there is no need for all nodes to
          know about the existence of RPL-unaware nodes.
          Only the 6LBR needs to act if compensation is necessary for 
          RPL-unaware receivers.<a class="pilcrow" href="#section-8-1">¶</a></p>
<p id="section-8-2">
           <a class="xref" href="#fig_table_non-storing">Table 19</a> summarizes which headers are needed in the following
           scenarios and indicates when the RPI, RH3, and IPv6-in-IPv6 header
           are to be inserted.  The last column depicts the
           target destination of the IPv6-in-IPv6 header: 6LN (indicated by "RAL"), 6LR (parent of a RUL), or the root.
           In cases where no IPv6-in-IPv6 header is needed, the column indicates "No".
           There is no expectation on RPL that RPI can be omitted because it is needed for routing, quality of service, and compression.
           This specification expects that an RPI is always present.
           The term "may(up)" means that the IPv6-in-IPv6 header may be necessary in the Upward direction.
           The term "must(up)" means that the IPv6-in-IPv6 header must be present in the Upward direction.
           The term "must(down)" means that the IPv6-in-IPv6 header must be present in the Downward direction.<a class="pilcrow" href="#section-8-2">¶</a></p>
<p id="section-8-3">
           The leaf can be a router 6LR or a host, both indicated as 6LN (<a class="xref" href="#fig_CommonTopology">Figure 3</a>). In <a class="xref" href="#fig_table_non-storing">Table 19</a>, the
           (1) indicates a 6TiSCH case <span>[<a class="xref" href="#RFC8180">RFC8180</a>]</span>, where the RPI may still be needed
          for the RPLInstanceID to be available for priority/channel selection at each hop.<a class="pilcrow" href="#section-8-3">¶</a></p>
<span id="name-headers-needed-in-non-stori"></span><div id="fig_table_non-storing">
<table class="center" id="table-19">
        <caption>
<a class="selfRef" href="#table-19">Table 19</a>:
<a class="selfRef" href="#name-headers-needed-in-non-stori">Headers Needed in Non-Storing Mode: RPI, RH3, IPv6-in-IPv6 Encapsulation</a>
        </caption>
<thead>
          <tr>
            <th class="text-center" colspan="1" rowspan="1">Interaction between</th>
            <th class="text-center" colspan="1" rowspan="1">Use Case</th>
            <th class="text-center" colspan="1" rowspan="1">RPI</th>
            <th class="text-center" colspan="1" rowspan="1">RH3</th>
            <th class="text-center" colspan="1" rowspan="1">IPv6-in-IPv6</th>
            <th class="text-center" colspan="1" rowspan="1">IP-in-IP dst</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <th class="text-center" colspan="1" rowspan="4">Leaf - Root</th>
            <td class="text-center" colspan="1" rowspan="1">RAL to root</td>
            <td class="text-center" colspan="1" rowspan="1">Yes</td>
            <td class="text-center" colspan="1" rowspan="1">No</td>
            <td class="text-center" colspan="1" rowspan="1">No</td>
            <td class="text-center" colspan="1" rowspan="1">No</td>
          </tr>
          <tr>
            <td class="text-center" colspan="1" rowspan="1">root to RAL</td>
            <td class="text-center" colspan="1" rowspan="1">Yes</td>
            <td class="text-center" colspan="1" rowspan="1">Yes</td>
            <td class="text-center" colspan="1" rowspan="1">No</td>
            <td class="text-center" colspan="1" rowspan="1">No</td>
          </tr>
          <tr>
            <td class="text-center" colspan="1" rowspan="1">root to RUL</td>
            <td class="text-center" colspan="1" rowspan="1">Yes (1)</td>
            <td class="text-center" colspan="1" rowspan="1">Yes</td>
            <td class="text-center" colspan="1" rowspan="1">No</td>
            <td class="text-center" colspan="1" rowspan="1">6LR</td>
          </tr>
          <tr>
            <td class="text-center" colspan="1" rowspan="1">RUL to root</td>
            <td class="text-center" colspan="1" rowspan="1">Yes</td>
            <td class="text-center" colspan="1" rowspan="1">No</td>
            <td class="text-center" colspan="1" rowspan="1">must</td>
            <td class="text-center" colspan="1" rowspan="1">root</td>
          </tr>
          <tr>
            <th class="text-center" colspan="1" rowspan="4">Leaf - Internet</th>
            <td class="text-center" colspan="1" rowspan="1">RAL to Int</td>
            <td class="text-center" colspan="1" rowspan="1">Yes</td>
            <td class="text-center" colspan="1" rowspan="1">No</td>
            <td class="text-center" colspan="1" rowspan="1">may(up)</td>
            <td class="text-center" colspan="1" rowspan="1">root</td>
          </tr>
          <tr>
            <td class="text-center" colspan="1" rowspan="1">Int to RAL</td>
            <td class="text-center" colspan="1" rowspan="1">Yes</td>
            <td class="text-center" colspan="1" rowspan="1">Yes</td>
            <td class="text-center" colspan="1" rowspan="1">must</td>
            <td class="text-center" colspan="1" rowspan="1">RAL</td>
          </tr>
          <tr>
            <td class="text-center" colspan="1" rowspan="1">RUL to Int</td>
            <td class="text-center" colspan="1" rowspan="1">Yes</td>
            <td class="text-center" colspan="1" rowspan="1">No</td>
            <td class="text-center" colspan="1" rowspan="1">must</td>
            <td class="text-center" colspan="1" rowspan="1">root</td>
          </tr>
          <tr>
            <td class="text-center" colspan="1" rowspan="1">Int to RUL</td>
            <td class="text-center" colspan="1" rowspan="1">Yes</td>
            <td class="text-center" colspan="1" rowspan="1">Yes</td>
            <td class="text-center" colspan="1" rowspan="1">must</td>
            <td class="text-center" colspan="1" rowspan="1">6LR</td>
          </tr>
          <tr>
            <th class="text-center" colspan="1" rowspan="8">Leaf - Leaf</th>
            <td class="text-center" colspan="1" rowspan="2">RAL to RAL</td>
            <td class="text-center" colspan="1" rowspan="2">Yes</td>
            <td class="text-center" colspan="1" rowspan="2">Yes</td>
            <td class="text-center" colspan="1" rowspan="1">may(up)</td>
            <td class="text-center" colspan="1" rowspan="1">root</td>
          </tr>
          <tr>
            <td class="text-center" colspan="1" rowspan="1">must(down)</td>
            <td class="text-center" colspan="1" rowspan="1">RAL</td>
          </tr>
          <tr>
            <td class="text-center" colspan="1" rowspan="2">RAL to RUL</td>
            <td class="text-center" colspan="1" rowspan="2">Yes</td>
            <td class="text-center" colspan="1" rowspan="2">Yes</td>
            <td class="text-center" colspan="1" rowspan="1">may(up)</td>
            <td class="text-center" colspan="1" rowspan="1">root</td>
          </tr>
          <tr>
            <td class="text-center" colspan="1" rowspan="1">must(down)</td>
            <td class="text-center" colspan="1" rowspan="1">6LR</td>
          </tr>
          <tr>
            <td class="text-center" colspan="1" rowspan="2">RUL to RAL</td>
            <td class="text-center" colspan="1" rowspan="2">Yes</td>
            <td class="text-center" colspan="1" rowspan="2">Yes</td>
            <td class="text-center" colspan="1" rowspan="1">must(up)</td>
            <td class="text-center" colspan="1" rowspan="1">root</td>
          </tr>
          <tr>
            <td class="text-center" colspan="1" rowspan="1">must(down)</td>
            <td class="text-center" colspan="1" rowspan="1">RAL</td>
          </tr>
          <tr>
            <td class="text-center" colspan="1" rowspan="2">RUL to RUL</td>
            <td class="text-center" colspan="1" rowspan="2">Yes</td>
            <td class="text-center" colspan="1" rowspan="2">Yes</td>
            <td class="text-center" colspan="1" rowspan="1">must(up)</td>
            <td class="text-center" colspan="1" rowspan="1">root</td>
          </tr>
          <tr>
            <td class="text-center" colspan="1" rowspan="1">must(down)</td>
            <td class="text-center" colspan="1" rowspan="1">6LR</td>
          </tr>
        </tbody>
      </table>
</div>
<section id="section-8.1">
        <h3 id="name-non-storing-mode-interactio">
<a class="section-number selfRef" href="#section-8.1">8.1. </a><a class="section-name selfRef" href="#name-non-storing-mode-interactio">Non-Storing Mode: Interaction between Leaf and Root</a>
        </h3>
<p id="section-8.1-1">
              This section describes the communication flow
              in Non-Storing mode (Non-SM) between the following:<a class="pilcrow" href="#section-8.1-1">¶</a></p>
<ul class="ulEmpty normal">
<li class="ulEmpty normal" id="section-8.1-2.1">
                  RAL  to root<a class="pilcrow" href="#section-8.1-2.1">¶</a>
</li>
          <li class="ulEmpty normal" id="section-8.1-2.2">
                  root to RAL<a class="pilcrow" href="#section-8.1-2.2">¶</a>
</li>
          <li class="ulEmpty normal" id="section-8.1-2.3">
                  RUL  to root<a class="pilcrow" href="#section-8.1-2.3">¶</a>
</li>
          <li class="ulEmpty normal" id="section-8.1-2.4">
                  root to RUL<a class="pilcrow" href="#section-8.1-2.4">¶</a>
</li>
        </ul>
<section id="section-8.1.1">
          <h4 id="name-non-sm-example-of-flow-from">
<a class="section-number selfRef" href="#section-8.1.1">8.1.1. </a><a class="section-name selfRef" href="#name-non-sm-example-of-flow-from">Non-SM: Example of Flow from RAL to Root</a>
          </h4>
<p id="section-8.1.1-1">
                   In Non-Storing mode, the leaf node uses default
                   routing to send traffic to the root. The RPI must be included
                   since it contains the Rank information, which is used to
                   avoid and/or detect loops.<a class="pilcrow" href="#section-8.1.1-1">¶</a></p>
<p id="section-8.1.1-2">
                   RAL (6LN) --&gt; 6LR_i --&gt; root(6LBR)<a class="pilcrow" href="#section-8.1.1-2">¶</a></p>
<p id="section-8.1.1-3">
                   For example, a communication flow could be: 
Node F --&gt; Node D --&gt; Node B --&gt; Node A (root)<a class="pilcrow" href="#section-8.1.1-3">¶</a></p>
<p id="section-8.1.1-4">
                   6LR_i represents the intermediate routers from the source to the destination.
                   In this case, 1 &lt;= i &lt;= n, where n is the total number of routers (6LR)
                   that the packet goes through, from the source (RAL) to the destination (6LBR).<a class="pilcrow" href="#section-8.1.1-4">¶</a></p>
<p id="section-8.1.1-5">
                   This situation is the same case as Storing mode.<a class="pilcrow" href="#section-8.1.1-5">¶</a></p>
<p id="section-8.1.1-6">
                 <a class="xref" href="#NonStoring-summary-headers">Table 20</a> summarizes which headers are needed for this use case.<a class="pilcrow" href="#section-8.1.1-6">¶</a></p>
<span id="name-non-sm-summary-of-the-use-o"></span><div id="NonStoring-summary-headers">
<table class="center" id="table-20">
            <caption>
<a class="selfRef" href="#table-20">Table 20</a>:
<a class="selfRef" href="#name-non-sm-summary-of-the-use-o">Non-SM: Summary of the Use of Headers from RAL to Root</a>
            </caption>
<thead>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Header</th>
                <th class="text-center" colspan="1" rowspan="1">RAL src</th>
                <th class="text-center" colspan="1" rowspan="1">6LR_i</th>
                <th class="text-center" colspan="1" rowspan="1">6LBR dst</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Added headers</th>
                <td class="text-center" colspan="1" rowspan="1">RPI</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Modified headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">RPI</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Removed headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">RPI</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Untouched headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
<div id="nsroottoRAL">
<section id="section-8.1.2">
          <h4 id="name-non-sm-example-of-flow-from-">
<a class="section-number selfRef" href="#section-8.1.2">8.1.2. </a><a class="section-name selfRef" href="#name-non-sm-example-of-flow-from-">Non-SM: Example of Flow from Root to RAL</a>
          </h4>
<p id="section-8.1.2-1">
                   In this case, the flow comprises:<a class="pilcrow" href="#section-8.1.2-1">¶</a></p>
<p id="section-8.1.2-2">

                         root (6LBR) --&gt; 6LR_i --&gt; RAL (6LN)<a class="pilcrow" href="#section-8.1.2-2">¶</a></p>
<p id="section-8.1.2-3">
                 For example, a communication flow could be: 
Node A (root) --&gt; Node B --&gt; Node D --&gt; Node F<a class="pilcrow" href="#section-8.1.2-3">¶</a></p>
<p id="section-8.1.2-4">
                   6LR_i represents the intermediate routers from the source to the destination.
                   In this case, 1 &lt;= i &lt;= n, where n is the total number of routers (6LR)
                   that the packet goes through, from the source (6LBR) to the destination (RAL).<a class="pilcrow" href="#section-8.1.2-4">¶</a></p>
<p id="section-8.1.2-5">
                   The 6LBR inserts an RH3 and an RPI.
                   No IPv6-in-IPv6 header is necessary as the traffic
                   originates with a RPL-aware node, the 6LBR.
                   The destination is known to be RPL aware because the root
                   knows the whole topology in Non-Storing mode.<a class="pilcrow" href="#section-8.1.2-5">¶</a></p>
<p id="section-8.1.2-6">
                 <a class="xref" href="#NonStoring-root2rpl">Table 21</a> summarizes which headers are needed for this use case.<a class="pilcrow" href="#section-8.1.2-6">¶</a></p>
<span id="name-non-sm-summary-of-the-use-of"></span><div id="NonStoring-root2rpl">
<table class="center" id="table-21">
            <caption>
<a class="selfRef" href="#table-21">Table 21</a>:
<a class="selfRef" href="#name-non-sm-summary-of-the-use-of">Non-SM: Summary of the Use of Headers from Root to RAL</a>
            </caption>
<thead>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Header</th>
                <th class="text-center" colspan="1" rowspan="1">6LBR src</th>
                <th class="text-center" colspan="1" rowspan="1">6LR_i</th>
                <th class="text-center" colspan="1" rowspan="1">RAL dst</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Added headers</th>
                <td class="text-center" colspan="1" rowspan="1">RPI, RH3</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Modified headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">RPI, RH3</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Removed headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">RPI, RH3</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Untouched headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
</div>
<section id="section-8.1.3">
          <h4 id="name-non-sm-example-of-flow-from-r">
<a class="section-number selfRef" href="#section-8.1.3">8.1.3. </a><a class="section-name selfRef" href="#name-non-sm-example-of-flow-from-r">Non-SM: Example of Flow from Root to RUL</a>
          </h4>
<p id="section-8.1.3-1">
                                In this case, the flow comprises:<a class="pilcrow" href="#section-8.1.3-1">¶</a></p>
<p id="section-8.1.3-2">
                                root (6LBR) --&gt; 6LR_i --&gt; RUL (IPv6 dst node)<a class="pilcrow" href="#section-8.1.3-2">¶</a></p>
<p id="section-8.1.3-3">
                        For example, a communication flow could be: 
Node A (root) --&gt; Node B --&gt; Node E --&gt; Node G (RUL)<a class="pilcrow" href="#section-8.1.3-3">¶</a></p>
<p id="section-8.1.3-4">
                          6LR_i represents the intermediate routers from the source to the destination.
                          In this case, 1 &lt;= i &lt;= n, where n is the total number of routers (6LR)
                          that the packet goes through, from the source (6LBR) to the destination (RUL).<a class="pilcrow" href="#section-8.1.3-4">¶</a></p>
<p id="section-8.1.3-5">
                          In the 6LBR, the RH3 is added; it is then modified at each
                          intermediate 6LR (6LR_1 and so on), and it is fully consumed in the
                          last 6LR (6LR_n) but is left in place.  When the RPI is added, the
                          RUL, which does not understand the RPI, will ignore it (per
                          <span>[<a class="xref" href="#RFC8200">RFC8200</a>]</span>); thus, encapsulation is not necessary.<a class="pilcrow" href="#section-8.1.3-5">¶</a></p>
<p id="section-8.1.3-6">
                        <a class="xref" href="#NonStoring-root2notrpl">Table 22</a> summarizes which headers are needed for this use case.<a class="pilcrow" href="#section-8.1.3-6">¶</a></p>
<span id="name-non-sm-summary-of-the-use-of-"></span><div id="NonStoring-root2notrpl">
<table class="center" id="table-22">
            <caption>
<a class="selfRef" href="#table-22">Table 22</a>:
<a class="selfRef" href="#name-non-sm-summary-of-the-use-of-">Non-SM: Summary of the Use of Headers from Root to RUL</a>
            </caption>
<thead>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Header</th>
                <th class="text-center" colspan="1" rowspan="1">6LBR src</th>
                <th class="text-center" colspan="1" rowspan="1">6LR_i i=(1,..,n-1)</th>
                <th class="text-center" colspan="1" rowspan="1">6LR_n</th>
                <th class="text-center" colspan="1" rowspan="1">RUL dst</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Added headers</th>
                <td class="text-center" colspan="1" rowspan="1">RPI, RH3</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Modified headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">RPI, RH3</td>
                <td class="text-center" colspan="1" rowspan="1">RPI, RH3(consumed)</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Removed headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Untouched headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">RPI, RH3 (both ignored)</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
<section id="section-8.1.4">
          <h4 id="name-non-sm-example-of-flow-from-ru">
<a class="section-number selfRef" href="#section-8.1.4">8.1.4. </a><a class="section-name selfRef" href="#name-non-sm-example-of-flow-from-ru">Non-SM: Example of Flow from RUL to Root</a>
          </h4>
<p id="section-8.1.4-1">
                                In this case, the flow comprises:<a class="pilcrow" href="#section-8.1.4-1">¶</a></p>
<p id="section-8.1.4-2">

                                RUL (IPv6 src node) --&gt; 6LR_1 --&gt; 6LR_i --&gt; root (6LBR) dst<a class="pilcrow" href="#section-8.1.4-2">¶</a></p>
<p id="section-8.1.4-3">
                        For example, a communication flow could be: 
Node G --&gt; Node E --&gt; Node B --&gt; Node A (root)<a class="pilcrow" href="#section-8.1.4-3">¶</a></p>
<p id="section-8.1.4-4">
                          6LR_i represents the intermediate routers from the source to the destination.
                          In this case, 1 &lt;= i &lt;= n, where n is the total number of routers (6LR)
                          that the packet goes through, from the source (RUL) to the destination (6LBR).
                          For example, 6LR_1 (i=1) is the router that receives the packets from the
                          RUL.<a class="pilcrow" href="#section-8.1.4-4">¶</a></p>
<p id="section-8.1.4-5">
                          In this case, the RPI is added by the first 6LR (6LR_1) (Node E),
                          encapsulated in an IPv6-in-IPv6 header, and modified in the
                          subsequent 6LRs in the flow. The RPI and the
                          entire packet are consumed by the root.<a class="pilcrow" href="#section-8.1.4-5">¶</a></p>
<p id="section-8.1.4-6">
                        <a class="xref" href="#NonStoring-notrpl2root">Table 23</a> summarizes which headers are needed for this use case.<a class="pilcrow" href="#section-8.1.4-6">¶</a></p>
<span id="name-non-sm-summary-of-the-use-of-h"></span><div id="NonStoring-notrpl2root">
<table class="center" id="table-23">
            <caption>
<a class="selfRef" href="#table-23">Table 23</a>:
<a class="selfRef" href="#name-non-sm-summary-of-the-use-of-h">Non-SM: Summary of the Use of Headers from RUL to Root</a>
            </caption>
<thead>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Header</th>
                <th class="text-center" colspan="1" rowspan="1">RUL src</th>
                <th class="text-center" colspan="1" rowspan="1">6LR_1</th>
                <th class="text-center" colspan="1" rowspan="1">6LR_i</th>
                <th class="text-center" colspan="1" rowspan="1">6LBR dst</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Added headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">IPv6-in-IPv6 (RPI)</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Modified headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">RPI</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Removed headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">IPv6-in-IPv6 (RPI)</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Untouched headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
</section>
<section id="section-8.2">
        <h3 id="name-non-storing-mode-interaction">
<a class="section-number selfRef" href="#section-8.2">8.2. </a><a class="section-name selfRef" href="#name-non-storing-mode-interaction">Non-Storing Mode: Interaction between Leaf and Internet</a>
        </h3>
<p id="section-8.2-1">
                   This section describes the communication flow in Non-Storing mode (Non-SM) between the following:<a class="pilcrow" href="#section-8.2-1">¶</a></p>
<ul class="ulEmpty normal">
<li class="ulEmpty normal" id="section-8.2-2.1">
                       RAL to Internet<a class="pilcrow" href="#section-8.2-2.1">¶</a>
</li>
          <li class="ulEmpty normal" id="section-8.2-2.2">
                       Internet to RAL<a class="pilcrow" href="#section-8.2-2.2">¶</a>
</li>
          <li class="ulEmpty normal" id="section-8.2-2.3">
                       RUL to Internet<a class="pilcrow" href="#section-8.2-2.3">¶</a>
</li>
          <li class="ulEmpty normal" id="section-8.2-2.4">
                       Internet to RUL<a class="pilcrow" href="#section-8.2-2.4">¶</a>
</li>
        </ul>
<section id="section-8.2.1">
          <h4 id="name-non-sm-example-of-flow-from-ra">
<a class="section-number selfRef" href="#section-8.2.1">8.2.1. </a><a class="section-name selfRef" href="#name-non-sm-example-of-flow-from-ra">Non-SM: Example of Flow from RAL to Internet</a>
          </h4>
<p id="section-8.2.1-1">
                                In this case, the flow comprises:<a class="pilcrow" href="#section-8.2.1-1">¶</a></p>
<p id="section-8.2.1-2">
                                RAL (6LN) src --&gt; 6LR_i --&gt; root (6LBR) --&gt; Internet dst<a class="pilcrow" href="#section-8.2.1-2">¶</a></p>
<p id="section-8.2.1-3">
                        For example, a communication flow could be: 
Node F (RAL) --&gt; Node D --&gt; Node B --&gt; Node A --&gt; Internet.
                        Having the RAL information about the RPL domain, the packet may be encapsulated to the root when the destination is not in the RPL domain of the RAL.<a class="pilcrow" href="#section-8.2.1-3">¶</a></p>
<p id="section-8.2.1-4">
                          6LR_i represents the intermediate routers from the source to the destination,
                          and 1 &lt;= i &lt;= n, where n is the total number of routers (6LR)
                          that the packet goes through, from the source (RAL) to the 6LBR.<a class="pilcrow" href="#section-8.2.1-4">¶</a></p>
<p id="section-8.2.1-5">
                              In this case, the encapsulation from the RAL to the root is optional.
                              The simplest case is when the RPI gets to the Internet (as the <a class="xref" href="#NonStoring-rpl2int">Table 24</a> shows it), knowing that the Internet is
                              going to ignore it.<a class="pilcrow" href="#section-8.2.1-5">¶</a></p>
<p id="section-8.2.1-6">
                          The IPv6 flow label should be set to zero to aid
                          in compression <span>[<a class="xref" href="#RFC8138">RFC8138</a>]</span>, and the 6LBR will set it to a
                          non-zero value when sending towards the Internet  <span>[<a class="xref" href="#RFC6437">RFC6437</a>]</span>.<a class="pilcrow" href="#section-8.2.1-6">¶</a></p>
<p id="section-8.2.1-7">
                        <a class="xref" href="#NonStoring-rpl2int">Table 24</a> summarizes which headers are needed for this use case
                        when no encapsulation is used.
                        <a class="xref" href="#NonStoring-rpl2intwithIPIP">Table 25</a> summarizes which headers are needed
                        for this use case when encapsulation to the root is used.<a class="pilcrow" href="#section-8.2.1-7">¶</a></p>
<span id="name-non-sm-summary-of-the-use-of-he"></span><div id="NonStoring-rpl2int">
<table class="center" id="table-24">
            <caption>
<a class="selfRef" href="#table-24">Table 24</a>:
<a class="selfRef" href="#name-non-sm-summary-of-the-use-of-he">Non-SM: Summary of the Use of Headers from RAL to Internet with No Encapsulation</a>
            </caption>
<thead>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Header</th>
                <th class="text-center" colspan="1" rowspan="1">RAL src</th>
                <th class="text-center" colspan="1" rowspan="1">6LR_i</th>
                <th class="text-center" colspan="1" rowspan="1">6LBR</th>
                <th class="text-center" colspan="1" rowspan="1">Internet dst</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Added headers</th>
                <td class="text-center" colspan="1" rowspan="1">RPI</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Modified headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">RPI</td>
                <td class="text-center" colspan="1" rowspan="1">RPI</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Removed headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Untouched headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">RPI (Ignored)</td>
              </tr>
            </tbody>
          </table>
</div>
<span id="name-non-sm-summary-of-the-use-of-hea"></span><div id="NonStoring-rpl2intwithIPIP">
<table class="center" id="table-25">
            <caption>
<a class="selfRef" href="#table-25">Table 25</a>:
<a class="selfRef" href="#name-non-sm-summary-of-the-use-of-hea">Non-SM: Summary of the Use of Headers from RAL to Internet with Encapsulation to the Root</a>
            </caption>
<thead>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Header</th>
                <th class="text-center" colspan="1" rowspan="1">RAL src</th>
                <th class="text-center" colspan="1" rowspan="1">6LR_i</th>
                <th class="text-center" colspan="1" rowspan="1">6LBR</th>
                <th class="text-center" colspan="1" rowspan="1">Internet dst</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Added headers</th>
                <td class="text-center" colspan="1" rowspan="1">IP6v6-in-IPv6 (RPI)</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Modified headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">RPI</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Removed headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">IPv6-in-IPv6 (RPI)</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Untouched headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
<section id="section-8.2.2">
          <h4 id="name-non-sm-example-of-flow-from-i">
<a class="section-number selfRef" href="#section-8.2.2">8.2.2. </a><a class="section-name selfRef" href="#name-non-sm-example-of-flow-from-i">Non-SM: Example of Flow from Internet to RAL</a>
          </h4>
<p id="section-8.2.2-1">
                                In this case, the flow comprises:<a class="pilcrow" href="#section-8.2.2-1">¶</a></p>
<p id="section-8.2.2-2">

                                Internet --&gt; root (6LBR) --&gt; 6LR_i --&gt; RAL dst (6LN)<a class="pilcrow" href="#section-8.2.2-2">¶</a></p>
<p id="section-8.2.2-3">
                        For example, a communication flow could be: 
Internet --&gt; Node A (root) --&gt; Node B --&gt; Node D --&gt; Node F (RAL)<a class="pilcrow" href="#section-8.2.2-3">¶</a></p>
<p id="section-8.2.2-4">
                          6LR_i represents the intermediate routers from source to destination,
                          and 1 &lt;= i &lt;= n, where n is the total number of routers (6LR)
                          that the packet goes through, from the 6LBR to the destination (RAL).<a class="pilcrow" href="#section-8.2.2-4">¶</a></p>
<p id="section-8.2.2-5">
                          The 6LBR must add an RH3 header.  As the 6LBR will
                          know the path and address of the target node, it can
                          address the IPv6-in-IPv6 header to that node.
                          The 6LBR will zero the flow label upon entry in
                          order to aid compression <span>[<a class="xref" href="#RFC8138">RFC8138</a>]</span>.<a class="pilcrow" href="#section-8.2.2-5">¶</a></p>
<p id="section-8.2.2-6">
                        <a class="xref" href="#NonStoring-int2rpl">Table 26</a> summarizes which headers are needed for this use case.<a class="pilcrow" href="#section-8.2.2-6">¶</a></p>
<span id="name-non-sm-summary-of-the-use-of-head"></span><div id="NonStoring-int2rpl">
<table class="center" id="table-26">
            <caption>
<a class="selfRef" href="#table-26">Table 26</a>:
<a class="selfRef" href="#name-non-sm-summary-of-the-use-of-head">Non-SM: Summary of the Use of Headers from Internet to RAL</a>
            </caption>
<thead>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Header</th>
                <th class="text-center" colspan="1" rowspan="1">Internet src</th>
                <th class="text-center" colspan="1" rowspan="1">6LBR</th>
                <th class="text-center" colspan="1" rowspan="1">6LR_i</th>
                <th class="text-center" colspan="1" rowspan="1">RAL dst</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Added headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">IPv6-in-IPv6 (RH3, RPI)</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Modified headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">IPv6-in-IPv6 (RH3, RPI)</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Removed headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">IPv6-in-IPv6 (RH3, RPI)</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Untouched headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
<section id="section-8.2.3">
          <h4 id="name-non-sm-example-of-flow-from-rul">
<a class="section-number selfRef" href="#section-8.2.3">8.2.3. </a><a class="section-name selfRef" href="#name-non-sm-example-of-flow-from-rul">Non-SM: Example of Flow from RUL to Internet</a>
          </h4>
<p id="section-8.2.3-1">
                                In this case, the flow comprises:<a class="pilcrow" href="#section-8.2.3-1">¶</a></p>
<p id="section-8.2.3-2">
                          RUL (IPv6 src node) --&gt; 6LR_1 --&gt; 6LR_i --&gt; root (6LBR) --&gt; Internet dst<a class="pilcrow" href="#section-8.2.3-2">¶</a></p>
<p id="section-8.2.3-3">
                        For example, a communication flow could be: 
Node G --&gt; Node E --&gt; Node B --&gt; Node A --&gt; Internet<a class="pilcrow" href="#section-8.2.3-3">¶</a></p>
<p id="section-8.2.3-4">
                          6LR_i represents the intermediate routers from the source to the destination,
                          and 1 &lt;= i &lt;= n, where n is the total number of routers (6LRs) that the
                          packet goes through, from the source (RUL) to the 6LBR, e.g., 6LR_1 (i=1).<a class="pilcrow" href="#section-8.2.3-4">¶</a></p>
<p id="section-8.2.3-5">
                                In this case, the flow label is recommended to
                                be zero in the RUL.  As the RUL parent adds  RPL headers in the RUL packet,
                                the first 6LR (6LR_1) will add an RPI inside a new IPv6-in-IPv6 header.
                                The IPv6-in-IPv6 header will be addressed to the
                                root.  This case is identical to the
                                Storing mode case (see <a class="xref" href="#sm-nRal2i">Section 7.2.3</a>).<a class="pilcrow" href="#section-8.2.3-5">¶</a></p>
<p id="section-8.2.3-6">
                        <a class="xref" href="#NonStoring-notrpl2int">Table 27</a> summarizes which headers are needed for this use case.<a class="pilcrow" href="#section-8.2.3-6">¶</a></p>
<span id="name-non-sm-summary-of-the-use-of-heade"></span><div id="NonStoring-notrpl2int">
<table class="center" id="table-27">
            <caption>
<a class="selfRef" href="#table-27">Table 27</a>:
<a class="selfRef" href="#name-non-sm-summary-of-the-use-of-heade">Non-SM: Summary of the Use of Headers from RUL to Internet</a>
            </caption>
<thead>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Header</th>
                <th class="text-center" colspan="1" rowspan="1">RUL src</th>
                <th class="text-center" colspan="1" rowspan="1">6LR_1</th>
                <th class="text-center" colspan="1" rowspan="1">6LR_i i=(2,..,n)</th>
                <th class="text-center" colspan="1" rowspan="1">6LBR</th>
                <th class="text-center" colspan="1" rowspan="1">Internet dst</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Added headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">IP6-IP6 (RPI)</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Modified headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">RPI</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Removed headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">IP6-IP6 (RPI)</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Untouched headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
<section id="section-8.2.4">
          <h4 id="name-non-sm-example-of-flow-from-in">
<a class="section-number selfRef" href="#section-8.2.4">8.2.4. </a><a class="section-name selfRef" href="#name-non-sm-example-of-flow-from-in">Non-SM: Example of Flow from Internet to RUL</a>
          </h4>
<p id="section-8.2.4-1">
                                In this case, the flow comprises:<a class="pilcrow" href="#section-8.2.4-1">¶</a></p>
<p id="section-8.2.4-2">

                                Internet src --&gt; root (6LBR) --&gt; 6LR_i --&gt; RUL (IPv6 dst node)<a class="pilcrow" href="#section-8.2.4-2">¶</a></p>
<p id="section-8.2.4-3">
                        For example, a communication flow could be: 
Internet --&gt; Node A (root) --&gt; Node B --&gt; Node E --&gt; Node G<a class="pilcrow" href="#section-8.2.4-3">¶</a></p>
<p id="section-8.2.4-4">
                          6LR_i represents the intermediate routers from the source to the destination,
                          and 1 &lt;= i &lt;= n, where n is the total number of routers (6LR)
                          that the packet goes through, from the 6LBR to the RUL.<a class="pilcrow" href="#section-8.2.4-4">¶</a></p>
<p id="section-8.2.4-5">
                          The 6LBR must add an RH3 header inside an IPv6-in-IPv6
                          header.
                          The 6LBR will know the path and will recognize
                          that the final node is not a RPL-capable node as
                          it will have received the connectivity DAO from the
                          nearest 6LR.  The 6LBR can therefore make the IPv6-in-IPv6
                          header destination be the last 6LR.
                          The 6LBR will set to zero the flow label upon entry in
                          order to aid compression <span>[<a class="xref" href="#RFC8138">RFC8138</a>]</span>.<a class="pilcrow" href="#section-8.2.4-5">¶</a></p>
<p id="section-8.2.4-6">
                        <a class="xref" href="#NonStoring-int2notrpl">Table 28</a> summarizes which headers are needed for this use case.<a class="pilcrow" href="#section-8.2.4-6">¶</a></p>
<span id="name-non-sm-summary-of-the-use-of-header"></span><div id="NonStoring-int2notrpl">
<table class="center" id="table-28">
            <caption>
<a class="selfRef" href="#table-28">Table 28</a>:
<a class="selfRef" href="#name-non-sm-summary-of-the-use-of-header">Non-SM: Summary of the Use of Headers from Internet to RUL</a>
            </caption>
<thead>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Header</th>
                <th class="text-center" colspan="1" rowspan="1">Internet src</th>
                <th class="text-center" colspan="1" rowspan="1">6LBR</th>
                <th class="text-center" colspan="1" rowspan="1">6LR_i</th>
                <th class="text-center" colspan="1" rowspan="1">6LR_n</th>
                <th class="text-center" colspan="1" rowspan="1">RUL dst</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Added headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">IP6-IP6 (RH3, RPI)</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Modified headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">IP6-IP6 (RH3, RPI)</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Removed headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">IP6-IP6 (RH3, RPI)</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Untouched headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
</section>
<section id="section-8.3">
        <h3 id="name-non-sm-interaction-between-">
<a class="section-number selfRef" href="#section-8.3">8.3. </a><a class="section-name selfRef" href="#name-non-sm-interaction-between-">Non-SM: Interaction between Leaves</a>
        </h3>
<p id="section-8.3-1">
                    This section describes the communication flow
                    in Non-Storing mode (Non-SM) between the following:<a class="pilcrow" href="#section-8.3-1">¶</a></p>
<ul class="ulEmpty normal">
<li class="ulEmpty normal" id="section-8.3-2.1">
                        RAL to RAL<a class="pilcrow" href="#section-8.3-2.1">¶</a>
</li>
          <li class="ulEmpty normal" id="section-8.3-2.2">
                        RAL to RUL<a class="pilcrow" href="#section-8.3-2.2">¶</a>
</li>
          <li class="ulEmpty normal" id="section-8.3-2.3">
                        RUL to RAL<a class="pilcrow" href="#section-8.3-2.3">¶</a>
</li>
          <li class="ulEmpty normal" id="section-8.3-2.4">
                        RUL to RUL<a class="pilcrow" href="#section-8.3-2.4">¶</a>
</li>
        </ul>
<section id="section-8.3.1">
          <h4 id="name-non-sm-example-of-flow-from-ral">
<a class="section-number selfRef" href="#section-8.3.1">8.3.1. </a><a class="section-name selfRef" href="#name-non-sm-example-of-flow-from-ral">Non-SM: Example of Flow from RAL to RAL</a>
          </h4>
<p id="section-8.3.1-1">
                        In this case, the flow comprises:<a class="pilcrow" href="#section-8.3.1-1">¶</a></p>
<p id="section-8.3.1-2">
                         RAL src --&gt; 6LR_ia --&gt; root (6LBR) --&gt; 6LR_id --&gt;  RAL dst<a class="pilcrow" href="#section-8.3.1-2">¶</a></p>
<p id="section-8.3.1-3">
                        For example, a communication flow could be: 
Node F (RAL src) --&gt; Node D --&gt; Node B --&gt; Node A (root) --&gt; Node B --&gt; Node E --&gt; Node H (RAL dst)<a class="pilcrow" href="#section-8.3.1-3">¶</a></p>
<p id="section-8.3.1-4">
                          6LR_ia represents the intermediate routers from the source to the root,
                          and 1 &lt;= ia &lt;= n, where n is the total number of routers (6LR)
                          that the packet goes through, from the RAL to the root.<a class="pilcrow" href="#section-8.3.1-4">¶</a></p>
<p id="section-8.3.1-5">
                          6LR_id represents the intermediate routers from the root to the destination,
                          and 1 &lt;= id &lt;= m, where m is the total number of the
                          intermediate routers (6LR).<a class="pilcrow" href="#section-8.3.1-5">¶</a></p>
<p id="section-8.3.1-6">
                          This case involves only nodes in same RPL domain.
                          The originating node will add an RPI to the
                          original packet and send the packet Upward.<a class="pilcrow" href="#section-8.3.1-6">¶</a></p>
<p id="section-8.3.1-7">
                          The originating node may put the RPI (RPI1) into an IPv6-in-IPv6
                          header addressed to the root so that the 6LBR can remove that
                          header.  If it does not, then the RPI1 is forwarded down from the
                          root in the inner header to no avail.<a class="pilcrow" href="#section-8.3.1-7">¶</a></p>
<p id="section-8.3.1-8">
                          The 6LBR will need to insert an RH3 header, which
                          requires that it add an IPv6-in-IPv6 header.
                          It removes the RPI (RPI1), as it was contained in an
                          IPv6-in-IPv6 header addressed to it.  Otherwise, there may
                          be an RPI buried inside the inner IP header,
                          which should be ignored. The root inserts an RPI (RPI2) alongside the RH3.<a class="pilcrow" href="#section-8.3.1-8">¶</a></p>
<p id="section-8.3.1-9">
                   Networks that use the RPL point-to-point extension <span>[<a class="xref" href="#RFC6997">RFC6997</a>]</span>
                   are essentially Non-Storing DODAGs and fall into this
                   scenario or the scenario given in <a class="xref" href="#nsroottoRAL">Section 8.1.2</a>, with
                   the originating node acting as a 6LBR.<a class="pilcrow" href="#section-8.3.1-9">¶</a></p>
<p id="section-8.3.1-10">
                 <a class="xref" href="#NonStoring-rpl2rpl">Table 29</a> summarizes which headers
                 are needed for this use case when encapsulation to the root takes place.<a class="pilcrow" href="#section-8.3.1-10">¶</a></p>
<p id="section-8.3.1-11">
                 <a class="xref" href="#NonStoring-rpl2rplnoIPIP">Table 30</a> summarizes which headers
                 are needed for this use case when there is no encapsulation to the root.
                 Note that in the Modified headers row, going up in each 6LR_ia only the RPI1 is changed.
                 Going down, in each 6LR_id the IPv6 header is swapped with the RH3 so both are changed alongside with the RPI2.<a class="pilcrow" href="#section-8.3.1-11">¶</a></p>
<span id="name-non-sm-summary-of-the-use-of-header-2"></span><div id="NonStoring-rpl2rpl">
<table class="center" id="table-29">
            <caption>
<a class="selfRef" href="#table-29">Table 29</a>:
<a class="selfRef" href="#name-non-sm-summary-of-the-use-of-header-2">Non-SM: Summary of the Use of Headers from RAL to RAL with Encapsulation to the Root</a>
            </caption>
<thead>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Header</th>
                <th class="text-center" colspan="1" rowspan="1">RAL src</th>
                <th class="text-center" colspan="1" rowspan="1">6LR_ia</th>
                <th class="text-center" colspan="1" rowspan="1">6LBR</th>
                <th class="text-center" colspan="1" rowspan="1">6LR_id</th>
                <th class="text-center" colspan="1" rowspan="1">RAL dst</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Added headers</th>
                <td class="text-center" colspan="1" rowspan="1">IP6-IP6 (RPI1)</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">IP6-IP6 (RH3 -&gt; RAL, RPI2)</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Modified headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">RPI1</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">IP6-IP6 (RH3, RPI2)</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Removed headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">IP6-IP6 (RPI1)</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">IP6-IP6 (RH3, RPI2)</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Untouched headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
            </tbody>
          </table>
</div>
<span id="name-non-sm-summary-of-the-use-of-header-3"></span><div id="NonStoring-rpl2rplnoIPIP">
<table class="center" id="table-30">
            <caption>
<a class="selfRef" href="#table-30">Table 30</a>:
<a class="selfRef" href="#name-non-sm-summary-of-the-use-of-header-3">Non-SM: Summary of the Use of Headers from RAL to RAL without Encapsulation to the Root</a>
            </caption>
<thead>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Header</th>
                <th class="text-center" colspan="1" rowspan="1">RAL src</th>
                <th class="text-center" colspan="1" rowspan="1">6LR_ia</th>
                <th class="text-center" colspan="1" rowspan="1">6LBR</th>
                <th class="text-center" colspan="1" rowspan="1">6LR_id</th>
                <th class="text-center" colspan="1" rowspan="1">RAL dst</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Added headers</th>
                <td class="text-center" colspan="1" rowspan="1">RPI1</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">IP6-IP6 (RH3, RPI2)</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Modified headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">RPI1</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">IP6-IP6 (RH3, RPI2)</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Removed headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">IP6-IP6 (RH3, RPI2)</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Untouched headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">RPI1</td>
                <td class="text-center" colspan="1" rowspan="1">RPI1</td>
                <td class="text-center" colspan="1" rowspan="1">RPI1 (Ignored)</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
<section id="section-8.3.2">
          <h4 id="name-non-sm-example-of-flow-from-ral-">
<a class="section-number selfRef" href="#section-8.3.2">8.3.2. </a><a class="section-name selfRef" href="#name-non-sm-example-of-flow-from-ral-">Non-SM: Example of Flow from RAL to RUL</a>
          </h4>
<p id="section-8.3.2-1">
                        In this case, the flow comprises:<a class="pilcrow" href="#section-8.3.2-1">¶</a></p>
<p id="section-8.3.2-2">
                         RAL --&gt; 6LR_ia --&gt; root (6LBR) --&gt; 6LR_id --&gt;  RUL (IPv6 dst node)<a class="pilcrow" href="#section-8.3.2-2">¶</a></p>
<p id="section-8.3.2-3">
                        For example, a communication flow could be: 
Node F (RAL) --&gt; Node D --&gt; Node B --&gt; Node A (root) --&gt; Node B --&gt; Node E --&gt; Node G (RUL)<a class="pilcrow" href="#section-8.3.2-3">¶</a></p>
<p id="section-8.3.2-4">
                          6LR_ia represents the intermediate routers from the source to the root,
                          and 1 &lt;= ia &lt;= n, where n is the total number of intermediate routers (6LR).<a class="pilcrow" href="#section-8.3.2-4">¶</a></p>
<p id="section-8.3.2-5">
                          6LR_id represents the intermediate routers from the root to the destination,
                           and 1 &lt;= id &lt;= m, where m is the total number of the
                          intermediate routers (6LRs).<a class="pilcrow" href="#section-8.3.2-5">¶</a></p>
<p id="section-8.3.2-6">
                          As in the previous case, the RAL (6LN) may insert an RPI (RPI1)
                          header, which must be in an IPv6-in-IPv6 header addressed to
                          the root so that the 6LBR can remove this RPI.
                          The 6LBR will then insert an RH3 inside a new IPv6-in-IPv6
                          header addressed to the last 6LR_id (6LR_id = m) alongside the insertion of RPI2.<a class="pilcrow" href="#section-8.3.2-6">¶</a></p>
<p id="section-8.3.2-7">
                          If the originating node does not put the RPI (RPI1) into an IPv6-in-IPv6
                          header addressed to the root, then the RPI1 is forwarded down from the
                          root in the inner header to no avail.<a class="pilcrow" href="#section-8.3.2-7">¶</a></p>
<p id="section-8.3.2-8">
                        <a class="xref" href="#NonStoring-rpl2notrpl">Table 31</a> summarizes which headers
                        are needed for this use case when encapsulation to the root takes place.
                        <a class="xref" href="#NonStoring-rpl2notrplnoIPIP">Table 32</a> summarizes which headers
                        are needed for this use case when no encapsulation to the root takes place.<a class="pilcrow" href="#section-8.3.2-8">¶</a></p>
<span id="name-non-sm-summary-of-the-use-of-header-4"></span><div id="NonStoring-rpl2notrpl">
<table class="center" id="table-31">
            <caption>
<a class="selfRef" href="#table-31">Table 31</a>:
<a class="selfRef" href="#name-non-sm-summary-of-the-use-of-header-4">Non-SM: Summary of the Use of Headers from RAL to RUL with Encapsulation to the Root</a>
            </caption>
<thead>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Header</th>
                <th class="text-center" colspan="1" rowspan="1">RAL src</th>
                <th class="text-center" colspan="1" rowspan="1">6LR_ia</th>
                <th class="text-center" colspan="1" rowspan="1">6LBR</th>
                <th class="text-center" colspan="1" rowspan="1">6LR_id</th>
                <th class="text-center" colspan="1" rowspan="1">6LR_m</th>
                <th class="text-center" colspan="1" rowspan="1">RUL dst</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Added headers</th>
                <td class="text-center" colspan="1" rowspan="1">IP6-IP6 (RPI1)</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">IP6-IP6 (RH3, RPI2)</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Modified headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">RPI1</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">IP6-IP6 (RH3, RPI2)</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Removed headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">IP6-IP6 (RPI1)</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">IP6-IP6 (RH3, RPI2)</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Untouched headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
            </tbody>
          </table>
</div>
<span id="name-non-sm-summary-of-the-use-of-header-5"></span><div id="NonStoring-rpl2notrplnoIPIP">
<table class="center" id="table-32">
            <caption>
<a class="selfRef" href="#table-32">Table 32</a>:
<a class="selfRef" href="#name-non-sm-summary-of-the-use-of-header-5">Non-SM: Summary of the Use of Headers from RAL to RUL without Encapsulation to the Root</a>
            </caption>
<thead>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Header</th>
                <th class="text-center" colspan="1" rowspan="1">RAL src</th>
                <th class="text-center" colspan="1" rowspan="1">6LR_ia</th>
                <th class="text-center" colspan="1" rowspan="1">6LBR</th>
                <th class="text-center" colspan="1" rowspan="1">6LR_id</th>
                <th class="text-center" colspan="1" rowspan="1">6LR_n</th>
                <th class="text-center" colspan="1" rowspan="1">RUL dst</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Added headers</th>
                <td class="text-center" colspan="1" rowspan="1">RPI1</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">IP6-IP6 (RH3, RPI2)</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Modified headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">RPI1</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">IP6-IP6 (RH3, RPI2)</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Removed headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">IP6-IP6 (RH3, RPI2)</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Untouched headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">RPI1</td>
                <td class="text-center" colspan="1" rowspan="1">RPI1</td>
                <td class="text-center" colspan="1" rowspan="1">RPI1</td>
                <td class="text-center" colspan="1" rowspan="1">RPI1 (ignored)</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
<section id="section-8.3.3">
          <h4 id="name-non-sm-example-of-flow-from-rul-">
<a class="section-number selfRef" href="#section-8.3.3">8.3.3. </a><a class="section-name selfRef" href="#name-non-sm-example-of-flow-from-rul-">Non-SM: Example of Flow from RUL to RAL</a>
          </h4>
<p id="section-8.3.3-1">
                        In this case, the flow comprises:<a class="pilcrow" href="#section-8.3.3-1">¶</a></p>
<p id="section-8.3.3-2">
                         RUL (IPv6 src node) --&gt; 6LR_1 --&gt; 6LR_ia --&gt; root (6LBR) --&gt; 6LR_id --&gt; RAL dst (6LN)<a class="pilcrow" href="#section-8.3.3-2">¶</a></p>
<p id="section-8.3.3-3">
                        For example, a communication flow could be:
Node G (RUL) --&gt; Node E --&gt; Node B --&gt; Node A (root) --&gt; Node B --&gt; Node E --&gt; Node H (RAL)<a class="pilcrow" href="#section-8.3.3-3">¶</a></p>
<p id="section-8.3.3-4">
                          6LR_ia represents the intermediate routers from source to the root,
                          and 1 &lt;= ia &lt;= n, where n is the total number of intermediate routers (6LR).<a class="pilcrow" href="#section-8.3.3-4">¶</a></p>
<p id="section-8.3.3-5">
                          6LR_id represents the intermediate routers from the root to the destination,
                          and 1 &lt;= id &lt;= m, where m is the total number of the
                          intermediate routers (6LR).<a class="pilcrow" href="#section-8.3.3-5">¶</a></p>
<p id="section-8.3.3-6">
                          In this scenario, the RPI (RPI1) is added by the first 6LR (6LR_1) inside an
                          IPv6-in-IPv6 header addressed to the root.  The 6LBR will
                          remove this RPI and add its own IPv6-in-IPv6 header
                          containing an RH3 header and an RPI (RPI2).<a class="pilcrow" href="#section-8.3.3-6">¶</a></p>
<p id="section-8.3.3-7">
                        <a class="xref" href="#NonStoring-notrpl2rpl">Table 33</a> summarizes which headers are needed for this use case.<a class="pilcrow" href="#section-8.3.3-7">¶</a></p>
<span id="name-non-sm-summary-of-the-use-of-header-6"></span><div id="NonStoring-notrpl2rpl">
<table class="center" id="table-33">
            <caption>
<a class="selfRef" href="#table-33">Table 33</a>:
<a class="selfRef" href="#name-non-sm-summary-of-the-use-of-header-6">Non-SM: Summary of the Use of Headers from RUL to RAL</a>
            </caption>
<thead>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Header</th>
                <th class="text-center" colspan="1" rowspan="1">RUL src</th>
                <th class="text-center" colspan="1" rowspan="1">6LR_1</th>
                <th class="text-center" colspan="1" rowspan="1">6LR_ia</th>
                <th class="text-center" colspan="1" rowspan="1">6LBR</th>
                <th class="text-center" colspan="1" rowspan="1">6LR_id</th>
                <th class="text-center" colspan="1" rowspan="1">RAL dst</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Added headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">IP6-IP6 (RPI1)</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">IP6-IP6 (RH3, RPI2)</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Modified headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">RPI1</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">IP6-IP6 (RH3, RPI2)</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Removed headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">IP6-IP6 (RPI1)</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">IP6-IP6 (RH3, RPI2)</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Untouched headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
<section id="section-8.3.4">
          <h4 id="name-non-sm-example-of-flow-from-rul-t">
<a class="section-number selfRef" href="#section-8.3.4">8.3.4. </a><a class="section-name selfRef" href="#name-non-sm-example-of-flow-from-rul-t">Non-SM: Example of Flow from RUL to RUL</a>
          </h4>
<p id="section-8.3.4-1">
                        In this case, the flow comprises:<a class="pilcrow" href="#section-8.3.4-1">¶</a></p>
<p id="section-8.3.4-2">
                         RUL (IPv6 src node) --&gt; 6LR_1 --&gt; 6LR_ia --&gt; root (6LBR) --&gt; 6LR_id --&gt; RUL (IPv6 dst node)<a class="pilcrow" href="#section-8.3.4-2">¶</a></p>
<p id="section-8.3.4-3">
                        For example, a communication flow could be: 
Node G --&gt; Node E --&gt; Node B --&gt; Node A (root) --&gt; Node C --&gt; Node J<a class="pilcrow" href="#section-8.3.4-3">¶</a></p>
<p id="section-8.3.4-4">
                          6LR_ia represents the intermediate routers from the source to the root,
                          and 1 &lt;= ia &lt;= n, where n is the total number of intermediate routers (6LR).<a class="pilcrow" href="#section-8.3.4-4">¶</a></p>
<p id="section-8.3.4-5">
                          6LR_id represents the intermediate routers from the root to the destination,
                          and 1 &lt;= id &lt;= m, where m is the total number of the
                          intermediate routers (6LR).<a class="pilcrow" href="#section-8.3.4-5">¶</a></p>
<p id="section-8.3.4-6">
                          This scenario is the combination of the previous two cases.<a class="pilcrow" href="#section-8.3.4-6">¶</a></p>
<p id="section-8.3.4-7">
                        <a class="xref" href="#NonStoring-notrpl2notrpl">Table 34</a> summarizes which headers are needed for this use case.<a class="pilcrow" href="#section-8.3.4-7">¶</a></p>
<span id="name-non-sm-summary-of-the-use-of-header-7"></span><div id="NonStoring-notrpl2notrpl">
<table class="center" id="table-34">
            <caption>
<a class="selfRef" href="#table-34">Table 34</a>:
<a class="selfRef" href="#name-non-sm-summary-of-the-use-of-header-7">Non-SM: Summary of the Use of Headers from RUL to RUL</a>
            </caption>
<thead>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Header</th>
                <th class="text-center" colspan="1" rowspan="1">RUL src</th>
                <th class="text-center" colspan="1" rowspan="1">6LR_1</th>
                <th class="text-center" colspan="1" rowspan="1">6LR_ia</th>
                <th class="text-center" colspan="1" rowspan="1">6LBR</th>
                <th class="text-center" colspan="1" rowspan="1">6LR_id</th>
                <th class="text-center" colspan="1" rowspan="1">6LR_m</th>
                <th class="text-center" colspan="1" rowspan="1">RUL dst</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Added headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">IP6-IP6 (RPI1)</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">IP6-IP6 (RH3, RPI2)</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Modified headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">RPI1</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">IP6-IP6 (RH3, RPI2)</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Removed headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">IP6-IP6 (RPI1)</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">IP6-IP6 (RH3, RPI2)</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Untouched headers</th>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
                <td class="text-center" colspan="1" rowspan="1">--</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
</section>
</section>
</div>
<div id="notrplaware">
<section id="section-9">
      <h2 id="name-operational-considerations-">
<a class="section-number selfRef" href="#section-9">9. </a><a class="section-name selfRef" href="#name-operational-considerations-">Operational Considerations of Supporting RULs</a>
      </h2>
<p id="section-9-1">
              Roughly half of the situations described in this document
              involve leaf ("host") nodes that do not speak RPL.  These nodes
              fall into two further categories: ones that drop a packet
              that have RPI or RH3 headers, and ones that continue to
              process a packet that has RPI and/or RH3 headers.<a class="pilcrow" href="#section-9-1">¶</a></p>
<p id="section-9-2">
              <span>[<a class="xref" href="#RFC8200">RFC8200</a>]</span> provides for new rules that suggest
              that nodes that have not been configured (explicitly) to
              examine Hop-by-Hop Options headers should ignore those headers and
              continue processing the packet.  Despite this, and despite the
              switch from 0x63 to 0x23, there may be nodes that predate RFC 8200
              or are simply intolerant.  Those nodes will drop packets that
              continue to have RPL artifacts in them.  In general, such
              nodes cannot be easily supported in RPL LLNs.<a class="pilcrow" href="#section-9-2">¶</a></p>
<p id="section-9-3">
              There are some specific cases where it is possible to remove
              the RPL artifacts prior to forwarding the packet to the leaf
              host.  The critical thing is that the artifacts have been
              inserted by the RPL root inside an IPv6-in-IPv6 header, and
              that the header has been addressed to the 6LR immediately prior
              to the leaf node. In that case, in the process of removing the
              IPv6-in-IPv6 header, the artifacts can also be removed.<a class="pilcrow" href="#section-9-3">¶</a></p>
<p id="section-9-4">
              The above case occurs whenever traffic originates from the
              outside the LLN (the "Internet" cases above), and Non-Storing
              mode is used.  In Non-Storing mode, the RPL root knows the exact topology
              (as it must create the RH3 header) and therefore knows which 6LR is prior to the
              leaf.  For example, in <a class="xref" href="#fig_CommonTopology">Figure 3</a>, Node E is the 6LR prior to leaf
              Node G, or Node C is the 6LR prior to leaf Node J.<a class="pilcrow" href="#section-9-4">¶</a></p>
<p id="section-9-5">
              Traffic originating from the RPL root (such as when the data
              collection system is co-located on the RPL root), does not
              require an IPv6-in-IPv6 header (in Storing or Non-Storing mode), as the packet
              is originating at the root, and the root can insert the RPI
              and RH3 headers directly into the packet as it is formed.
              Such a packet is slightly smaller, but can only be sent to
              nodes (whether RPL aware or not) that will tolerate the
              RPL artifacts.<a class="pilcrow" href="#section-9-5">¶</a></p>
<p id="section-9-6">
              An operator that finds itself with a high amount of traffic from the
              RPL root to RPL-unaware leaves will have to do IPv6-in-IPv6
              encapsulation if the leaf is not tolerant of the RPL artifacts.
              Such an operator could otherwise omit this unnecessary header
              if it was certain of the properties of the leaf.<a class="pilcrow" href="#section-9-6">¶</a></p>
<p id="section-9-7">
              As the Storing mode cannot know the final path of the traffic,
              intolerant leaf nodes, which drop packets with RPL artifacts,
              cannot be supported.<a class="pilcrow" href="#section-9-7">¶</a></p>
</section>
</div>
<div id="sec_op_con_0x23">
<section id="section-10">
      <h2 id="name-operational-considerations-o">
<a class="section-number selfRef" href="#section-10">10. </a><a class="section-name selfRef" href="#name-operational-considerations-o">Operational Considerations of Introducing 0x23</a>
      </h2>
<p id="section-10-1">
           This section describes the operational considerations of introducing the new RPI Option Type of 0x23.<a class="pilcrow" href="#section-10-1">¶</a></p>
<p id="section-10-2">
             During bootstrapping, the node receives the DIO with the information of RPI Option Type, indicating
             the new RPI in the DODAG Configuration option flag.
             The DODAG root is in charge of configuring the current network with the new value, through DIO
             messages, and determining when all the nodes have been set with the new value. The DODAG should change to a new DODAG version.
             In case of rebooting, the node does not remember the RPI Option Type.
             Thus, the DIO is sent with a flag indicating the new RPI Option Type.<a class="pilcrow" href="#section-10-2">¶</a></p>
<p id="section-10-3">
           The DODAG Configuration option is contained in a RPL DIO message, which contains a unique Destination Advertisement Trigger Sequence Number (DTSN) counter.
           The leaf nodes respond to this message with DAO messages containing the same DTSN.
           This is a normal part of RPL routing; the RPL root therefore knows when the updated
           DODAG Configuration option has been seen by all nodes.<a class="pilcrow" href="#section-10-3">¶</a></p>
<p id="section-10-4">
             Before the migration happens, all the RPL-aware nodes should support both values.
             The migration procedure is triggered when the DIO is sent with the flag
             indicating the new RPI Option Type.
             Namely, it remains at 0x63 until it is sure that the network is capable of 0x23, then it abruptly changes to 0x23.
             The 0x23 RPI Option allows the sending of packets to non-RPL nodes. The non-RPL nodes should ignore the option and continue processing the packets.<a class="pilcrow" href="#section-10-4">¶</a></p>
<p id="section-10-5">
             As mentioned previously, indicating the new RPI in the DODAG Configuration option flag is a way to avoid the flag day
             (abrupt changeover) in a network using 0x63 as the RPI Option Type value. It is suggested that RPL implementations
             accept both 0x63 and 0x23 RPI Option Type values when processing the header to enable interoperability.<a class="pilcrow" href="#section-10-5">¶</a></p>
</section>
</div>
<div id="iana">
<section id="section-11">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-11">11. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<section id="section-11.1">
        <h3 id="name-option-type-in-rpl-option-2">
<a class="section-number selfRef" href="#section-11.1">11.1. </a><a class="section-name selfRef" href="#name-option-type-in-rpl-option-2">Option Type in RPL Option</a>
        </h3>
<p id="section-11.1-1">
            This document updates the registration made in the
            "Destination Options and Hop-by-Hop Options" subregistry <span>[<a class="xref" href="#RFC6553">RFC6553</a>]</span> from 0x63 to 0x23
            as shown in <a class="xref" href="#fig_IanaRPIOption">Table 35</a>.<a class="pilcrow" href="#section-11.1-1">¶</a></p>
<span id="name-option-type-in-rpl-option-3"></span><div id="fig_IanaRPIOption">
<table class="center" id="table-35">
          <caption>
<a class="selfRef" href="#table-35">Table 35</a>:
<a class="selfRef" href="#name-option-type-in-rpl-option-3">Option Type in RPL Option</a>
          </caption>
<thead>
            <tr>
              <th class="text-center" colspan="1" rowspan="2">Hex Value</th>
              <th class="text-center" colspan="3" rowspan="1">Binary Value</th>
              <th class="text-center" colspan="1" rowspan="2">Description</th>
              <th class="text-center" colspan="1" rowspan="2">Reference</th>
            </tr>
            <tr>
              <th class="text-center" colspan="1" rowspan="1">act</th>
              <th class="text-center" colspan="1" rowspan="1">chg</th>
              <th class="text-center" colspan="1" rowspan="1">rest</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-center" colspan="1" rowspan="1">0x23</td>
              <td class="text-center" colspan="1" rowspan="1">00</td>
              <td class="text-center" colspan="1" rowspan="1">1</td>
              <td class="text-center" colspan="1" rowspan="1">00011</td>
              <td class="text-center" colspan="1" rowspan="1">RPL Option</td>
              <td class="text-center" colspan="1" rowspan="1">This document</td>
            </tr>
            <tr>
              <td class="text-center" colspan="1" rowspan="1">0x63</td>
              <td class="text-center" colspan="1" rowspan="1">01</td>
              <td class="text-center" colspan="1" rowspan="1">1</td>
              <td class="text-center" colspan="1" rowspan="1">00011</td>
              <td class="text-center" colspan="1" rowspan="1">RPL Option (DEPRECATED)</td>
              <td class="text-center" colspan="1" rowspan="1">
                <span>[<a class="xref" href="#RFC6553">RFC6553</a>]</span>, this document</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-11.1-3"> The "DODAG Configuration
          Option Flags for MOP 0..6" subregistry is updated as follows (<a class="xref" href="#fig_RPIflagdayConfOption">Table 36</a>):<a class="pilcrow" href="#section-11.1-3">¶</a></p>
<span id="name-dodag-configuration-option-f"></span><div id="fig_RPIflagdayConfOption">
<table class="center" id="table-36">
          <caption>
<a class="selfRef" href="#table-36">Table 36</a>:
<a class="selfRef" href="#name-dodag-configuration-option-f">DODAG Configuration Option Flag to Indicate the RPI Flag Day</a>
          </caption>
<thead>
            <tr>
              <th class="text-center" colspan="1" rowspan="1">Bit Number</th>
              <th class="text-center" colspan="1" rowspan="1">Capability Description</th>
              <th class="text-center" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-center" colspan="1" rowspan="1">3</td>
              <td class="text-center" colspan="1" rowspan="1">RPI 0x23 enable</td>
              <td class="text-center" colspan="1" rowspan="1">This document</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
<div id="sec_op_flags_reg">
<section id="section-11.2">
        <h3 id="name-change-to-the-dodag-configu">
<a class="section-number selfRef" href="#section-11.2">11.2. </a><a class="section-name selfRef" href="#name-change-to-the-dodag-configu">Change to the "DODAG Configuration Option Flags" Subregistry</a>
        </h3>
<p id="section-11.2-1">
            IANA has changed the name of the "DODAG
            Configuration Option Flags" subregistry to "DODAG Configuration Option Flags
            for MOP 0..6".<a class="pilcrow" href="#section-11.2-1">¶</a></p>
<p id="section-11.2-2">The subregistry references this document for this change.<a class="pilcrow" href="#section-11.2-2">¶</a></p>
</section>
</div>
<div id="sec_mop_val_change">
<section id="section-11.3">
        <h3 id="name-change-mop-value-7-to-reser">
<a class="section-number selfRef" href="#section-11.3">11.3. </a><a class="section-name selfRef" href="#name-change-mop-value-7-to-reser">Change MOP Value 7 to Reserved</a>
        </h3>
<p id="section-11.3-1">
            IANA has changed the registration status of value 7 in
            the "Mode of Operation" subregistry from Unassigned to Reserved.  This change
            is in support of future work.<a class="pilcrow" href="#section-11.3-1">¶</a></p>
<p id="section-11.3-2">
            This document is listed as a reference for this entry in
     the subregistry.<a class="pilcrow" href="#section-11.3-2">¶</a></p>
</section>
</div>
</section>
</div>
<div id="Security">
<section id="section-12">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-12">12. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<p id="section-12-1">
             The security considerations covered in <span>[<a class="xref" href="#RFC6553">RFC6553</a>]</span> and
             <span>[<a class="xref" href="#RFC6554">RFC6554</a>]</span> apply when the packets are in the RPL
             Domain.<a class="pilcrow" href="#section-12-1">¶</a></p>
<p id="section-12-2">
            The IPv6-in-IPv6 mechanism described in this document is much more
            limited than the general mechanism described in <span>[<a class="xref" href="#RFC2473">RFC2473</a>]</span>.  The willingness of each node in the LLN to
            decapsulate packets and forward them could be exploited by nodes to
            disguise the origin of an attack.<a class="pilcrow" href="#section-12-2">¶</a></p>
<p id="section-12-3">
            While a typical LLN may be a very poor origin for attack traffic
            (as the networks tend to be very slow,
            and the nodes often have very low duty cycles), given enough
            nodes, LLNs could still have a
            significant impact, particularly if the attack is targeting another LLN.
            Additionally, some uses of RPL involve large-backbone, ISP-scale
            equipment <span>[<a class="xref" href="#I-D.ietf-anima-autonomic-control-plane">ACP</a>]</span>,
            which may be equipped with multiple 100 Gb/s interfaces.<a class="pilcrow" href="#section-12-3">¶</a></p>
<p id="section-12-4">
            Blocking or careful filtering of IPv6-in-IPv6 traffic entering the LLN as
            described above will make sure that any attack that is mounted
            must originate from compromised nodes within the LLN.
            The use of network ingress filtering <span>[<a class="xref" href="#BCP38">BCP38</a>]</span> on egress traffic at  
            the RPL root will alert the operator to the existence of the attack 
            as well as drop the attack traffic.  As the RPL network is typically
            numbered from a single prefix, which is itself assigned by RPL,
            network ingress filtering <span>[<a class="xref" href="#BCP38">BCP38</a>]</span> involves a single prefix comparison and should be
            trivial to automatically configure.<a class="pilcrow" href="#section-12-4">¶</a></p>
<p id="section-12-5">
            There are some scenarios where IPv6-in-IPv6 traffic should be allowed to
            pass through the RPL root, such as the IPv6-in-IPv6 mediated
            communications between a new pledge and the Join
            Registrar/Coordinator (JRC) when
            using <span>[<a class="xref" href="#I-D.ietf-anima-bootstrapping-keyinfra">BRSKI</a>]</span> and
            <span>[<a class="xref" href="#I-D.ietf-6tisch-dtsecurity-zerotouch-join">ZEROTOUCH-JOIN</a>]</span>. This is
            the case for the RPL root to do careful filtering: it occurs only
            when the Join Coordinator is not co-located inside the RPL root.<a class="pilcrow" href="#section-12-5">¶</a></p>
<p id="section-12-6">
            With the above precautions, an attack using IPv6-in-IPv6 tunnels can only be
            by a node within the LLN on another node within the LLN.  Such an
            attack could, of course, be done directly.  An attack of this
            kind is meaningful only if the source addresses are either fake
            or if the point is to amplify return traffic.
            Such an attack could also be done without the use of IPv6-in-IPv6 
            headers, by using forged source addresses instead.  
            If the attack requires bidirectional communication, then IPv6-in-IPv6
            provides no advantages.<a class="pilcrow" href="#section-12-6">¶</a></p>
<p id="section-12-7">
            Whenever IPv6-in-IPv6 headers are being proposed, there is a concern
            about creating security issues. In the Security Considerations
            section of <span>[<a class="xref" href="#RFC2473">RFC2473</a>]</span> (Section <a class="relref" href="https://www.rfc-editor.org/rfc/rfc2473#section-9">9</a>), it was suggested that tunnel entry and exit
            points can be secured by securing the IPv6 path between them.   This
            recommendation is not practical for RPL networks.  
            <span>[<a class="xref" href="#RFC5406">RFC5406</a>]</span> provides guidance on what
            on what additional details are needed in order to "Use IPsec".
            While the use of Encapsulating Security Payload (ESP) would prevent source address
            forgeries, in order to use it with <span>[<a class="xref" href="#RFC8138">RFC8138</a>]</span>, compression would have to occur
            before encryption, as the <span>[<a class="xref" href="#RFC8138">RFC8138</a>]</span> compression is lossy.  Once encrypted,
            there would be no further redundancy to compress.  These are minor issues.  The major issue is how to
            establish trust enough such that Internet Key Exchange Protocol Version 2 (IKEv2) could be used.  This would
            require a system of certificates to be present in every single node,
            including any Internet nodes that might need to communicate with the
            LLN. Thus, using IPsec requires a global PKI in the general case.<a class="pilcrow" href="#section-12-7">¶</a></p>
<p id="section-12-8">
            More significantly, the use of IPsec tunnels to protect the IPv6-in-IPv6
            headers would, in the general case, scale with the square of the
            number of nodes.  This is a lot of resources for a constrained
            nodes on a constrained network. In the end, the IPsec tunnels
            would be providing only BCP38-like origin authentication!
            That is, IPsec provides a transitive guarantee to the tunnel exit point
            that the tunnel entry point did network ingress filtering <span>[<a class="xref" href="#BCP38">BCP38</a>]</span> on traffic going in.
            Just doing origin filtering per BCP 38 at the entry and
            exit of the LLN provides a similar level of security without all the
            scaling and trust problems related to IPv6 tunnels as discussed in
            <span>[<a class="xref" href="#RFC2473">RFC2473</a>]</span>. IPsec is not recommended.<a class="pilcrow" href="#section-12-8">¶</a></p>
<p id="section-12-9">
            An LLN with hostile nodes within it would not be protected against
            impersonation within the LLN by entry/exit filtering.<a class="pilcrow" href="#section-12-9">¶</a></p>
<p id="section-12-10">
            The RH3 header usage described here can be abused in equivalent
            ways. An external attacker may form a packet with an RH3 that is
            not fully consumed and encapsulate it to hide the RH3 from
            intermediate nodes and disguise the origin of
            traffic. As such, the attacker's RH3 header will not be seen by
            the network until it reaches the destination, which will decapsulate
            it. As indicated in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6554#section-4.2">Section 4.2</a> of [<a class="xref" href="#RFC6554">RFC6554</a>]</span>, RPL
            routers are responsible for ensuring that an SRH is only used
            between RPL routers. As such, if there is an RH3 that is not fully
            consumed in the encapsulated packet, the node that decapsulates it
            <span class="bcp14">MUST</span> ensure that the outer packet was originated in the RPL domain
            and drop the packet otherwise.<a class="pilcrow" href="#section-12-10">¶</a></p>
<p id="section-12-11">
            Also, as indicated by 
            <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6554#section-2">Section 2</a> of [<a class="xref" href="#RFC6554">RFC6554</a>]</span>, RPL Border Routers 
           "do not allow datagrams
            carrying an SRH header to enter or exit a RPL routing domain."
            This
            sentence must be understood as concerning non-fully-consumed packets.
            A consumed (inert)
            RH3 header could be present in a packet that flows from one LLN,
            crosses the Internet, and enters another LLN.  Per the
            discussion in this document, such headers do not need to be
            removed.  However, there is no case described in this document
            where an RH3 is inserted in a Non-Storing network on traffic that
            is leaving the LLN, but this document should not preclude such a
            future innovation.<a class="pilcrow" href="#section-12-11">¶</a></p>
<p id="section-12-12">
            In short, a packet that crosses the border of the RPL domain <span class="bcp14">MAY</span>
            carry an RH3, and if so, that RH3 <span class="bcp14">MUST</span> be fully consumed.<a class="pilcrow" href="#section-12-12">¶</a></p>
<p id="section-12-13">
            The RPI, if permitted to enter the LLN, could be used by
            an attacker to change the priority of a packet by selecting a
            different RPLInstanceID, perhaps one with a higher energy cost,
            for instance.  It could also be that not all nodes are reachable
            in an LLN using the default RPLInstanceID, but a change of
            RPLInstanceID would permit an attacker to bypass such filtering.
            Like the RH3, an RPI is to be inserted by the RPL root on
            traffic entering the LLN by first inserting an IPv6-in-IPv6 header. The
            attacker's RPI therefore will not be seen by the network.
            Upon reaching the destination node, the RPI has no further
            meaning and is just skipped; the presence of a second RPI
            will have no meaning to the end node as the packet has already
            been identified as being at its final destination.<a class="pilcrow" href="#section-12-13">¶</a></p>
<p id="section-12-14">
            For traffic leaving a RUL, if the RUL adds an uninitialized RPI (e.g., with a value of zero), then the 6LR as a RPL Border
            Router <span class="bcp14">SHOULD</span> rewrite the RPI to indicate the selected Instance and set the flags.
            This is done in order to avoid the following scenarios: 1) The leaf is an external router that
            passes a packet that it did not generate and that carries an unrelated RPI,
            and 2) The leaf is an attacker or presents misconfiguration and
            tries to inject traffic in a protected Instance.
            Also, this applies to the case where the leaf is aware of the RPL Instance and passes a correct RPI;
            the 6LR needs a configuration that allows that leaf to inject in that instance.<a class="pilcrow" href="#section-12-14">¶</a></p>
<p id="section-12-15">
            The RH3 and RPIs could be abused by an attacker inside of
            the network to route packets in nonobvious ways, perhaps eluding
            observation.   This usage appears consistent with a normal operation of
            <span>[<a class="xref" href="#RFC6997">RFC6997</a>]</span> and cannot be restricted at all. This
            is a feature, not a bug.<a class="pilcrow" href="#section-12-15">¶</a></p>
<p id="section-12-16">
            <span>[<a class="xref" href="#RFC7416">RFC7416</a>]</span> deals with many other threats to LLNs
            not directly related to the use of IPv6-in-IPv6 headers, and this
            document does not change that analysis.<a class="pilcrow" href="#section-12-16">¶</a></p>
<p id="section-12-17">
            Nodes within the LLN can use the IPv6-in-IPv6 mechanism to mount an
            attack on another part of the LLN, while disguising the origin of
            the attack.  The mechanism can even be abused to make it appear
            that the attack is coming from outside the LLN, and unless
            countered, this could be used to mount a DDOS 
            attack upon nodes elsewhere in the Internet. See <span>[<a class="xref" href="#DDOS-KREBS">DDOS-KREBS</a>]</span> for an example of such attacks already
            seen in the real world.<a class="pilcrow" href="#section-12-17">¶</a></p>
<p id="section-12-18">
            If an attack comes from inside of LLN, it can be alleviated with SAVI
            (Source Address Validation Improvement) using <span>[<a class="xref" href="#RFC8505">RFC8505</a>]</span> with
            <span>[<a class="xref" href="#RFC8928">RFC8928</a>]</span>. The attacker will not
            be able to source traffic with an address that is not registered, and the registration process
            checks for topological correctness. Notice that there is Layer 2 authentication
            in most of the cases.  If an attack comes from outside LLN, IPv6-in-IPv6
            can be used to hide inner routing headers, but by construction, the RH3 can typically only address nodes within the
            LLN.  That is, an RH3 with a CmprI less than 8 should be considered an attack (see <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6554#section-3">Section 3</a> of [<a class="xref" href="#RFC6554">RFC6554</a>]</span>).<a class="pilcrow" href="#section-12-18">¶</a></p>
<p id="section-12-19">
            Nodes outside of the LLN will need to pass IPv6-in-IPv6 traffic
            through the RPL root to perform this attack. To counter, the RPL
            root <span class="bcp14">SHOULD</span> either restrict ingress of IPv6-in-IPv6 packets (the
            simpler solution), or it <span class="bcp14">SHOULD</span> walk the IP header extension chain until it can inspect the
            upper-layer payload as described in <span>[<a class="xref" href="#RFC7045">RFC7045</a>]</span>.
            In particular, the RPL root <span class="bcp14">SHOULD</span> do network ingress filtering <span>[<a class="xref" href="#BCP38">BCP38</a>]</span> on the source addresses of all IP
            headers that it examines in both directions.<a class="pilcrow" href="#section-12-19">¶</a></p>
<p id="section-12-20">
            Note: there are some situations where a prefix will spread
            across multiple LLNs via mechanisms such as the one described in
            <span>[<a class="xref" href="#RFC8929">RFC8929</a>]</span>.
            In this case, the network ingress filtering <span>[<a class="xref" href="#BCP38">BCP38</a>]</span> needs to take this into account,
            either by exchanging detailed routing information on each LLN
            or by moving the network ingress filtering <span>[<a class="xref" href="#BCP38">BCP38</a>]</span> further towards the Internet,
            so that the details of the multiple LLNs do not matter.<a class="pilcrow" href="#section-12-20">¶</a></p>
</section>
</div>
<section id="section-13">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-13">13. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-13.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-13.1">13.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="BCP38">[BCP38]</dt>
        <dd>
<div class="refInstance" id="RFC2827">
            <span class="refAuthor">Ferguson, P.</span> and <span class="refAuthor">D. Senie</span>, <span class="refTitle">"Network Ingress Filtering: Defeating Denial of Service Attacks which employ IP Source Address Spoofing"</span>, <span class="seriesInfo">BCP 38</span>, <span class="seriesInfo">RFC 2827</span>, <time class="refDate" datetime="2000-05">May 2000</time>. </div>
<span>&lt;<a href="https://rfc-editor.org/info/bcp38">https://rfc-editor.org/info/bcp38</a>&gt;</span>
</dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time class="refDate" datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6040">[RFC6040]</dt>
        <dd>
<span class="refAuthor">Briscoe, B.</span>, <span class="refTitle">"Tunnelling of Explicit Congestion Notification"</span>, <span class="seriesInfo">RFC 6040</span>, <span class="seriesInfo">DOI 10.17487/RFC6040</span>, <time class="refDate" datetime="2010-11">November 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6040">https://www.rfc-editor.org/info/rfc6040</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6282">[RFC6282]</dt>
        <dd>
<span class="refAuthor">Hui, J., Ed.</span> and <span class="refAuthor">P. Thubert</span>, <span class="refTitle">"Compression Format for IPv6 Datagrams over IEEE 802.15.4-Based Networks"</span>, <span class="seriesInfo">RFC 6282</span>, <span class="seriesInfo">DOI 10.17487/RFC6282</span>, <time class="refDate" datetime="2011-09">September 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6282">https://www.rfc-editor.org/info/rfc6282</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6550">[RFC6550]</dt>
        <dd>
<span class="refAuthor">Winter, T., Ed.</span>, <span class="refAuthor">Thubert, P., Ed.</span>, <span class="refAuthor">Brandt, A.</span>, <span class="refAuthor">Hui, J.</span>, <span class="refAuthor">Kelsey, R.</span>, <span class="refAuthor">Levis, P.</span>, <span class="refAuthor">Pister, K.</span>, <span class="refAuthor">Struik, R.</span>, <span class="refAuthor">Vasseur, JP.</span>, and <span class="refAuthor">R. Alexander</span>, <span class="refTitle">"RPL: IPv6 Routing Protocol for Low-Power and Lossy Networks"</span>, <span class="seriesInfo">RFC 6550</span>, <span class="seriesInfo">DOI 10.17487/RFC6550</span>, <time class="refDate" datetime="2012-03">March 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6550">https://www.rfc-editor.org/info/rfc6550</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6553">[RFC6553]</dt>
        <dd>
<span class="refAuthor">Hui, J.</span> and <span class="refAuthor">JP. Vasseur</span>, <span class="refTitle">"The Routing Protocol for Low-Power and Lossy Networks (RPL) Option for Carrying RPL Information in Data-Plane Datagrams"</span>, <span class="seriesInfo">RFC 6553</span>, <span class="seriesInfo">DOI 10.17487/RFC6553</span>, <time class="refDate" datetime="2012-03">March 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6553">https://www.rfc-editor.org/info/rfc6553</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6554">[RFC6554]</dt>
        <dd>
<span class="refAuthor">Hui, J.</span>, <span class="refAuthor">Vasseur, JP.</span>, <span class="refAuthor">Culler, D.</span>, and <span class="refAuthor">V. Manral</span>, <span class="refTitle">"An IPv6 Routing Header for Source Routes with the Routing Protocol for Low-Power and Lossy Networks (RPL)"</span>, <span class="seriesInfo">RFC 6554</span>, <span class="seriesInfo">DOI 10.17487/RFC6554</span>, <time class="refDate" datetime="2012-03">March 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6554">https://www.rfc-editor.org/info/rfc6554</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7045">[RFC7045]</dt>
        <dd>
<span class="refAuthor">Carpenter, B.</span> and <span class="refAuthor">S. Jiang</span>, <span class="refTitle">"Transmission and Processing of IPv6 Extension Headers"</span>, <span class="seriesInfo">RFC 7045</span>, <span class="seriesInfo">DOI 10.17487/RFC7045</span>, <time class="refDate" datetime="2013-12">December 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7045">https://www.rfc-editor.org/info/rfc7045</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8025">[RFC8025]</dt>
        <dd>
<span class="refAuthor">Thubert, P., Ed.</span> and <span class="refAuthor">R. Cragie</span>, <span class="refTitle">"IPv6 over Low-Power Wireless Personal Area Network (6LoWPAN) Paging Dispatch"</span>, <span class="seriesInfo">RFC 8025</span>, <span class="seriesInfo">DOI 10.17487/RFC8025</span>, <time class="refDate" datetime="2016-11">November 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8025">https://www.rfc-editor.org/info/rfc8025</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8138">[RFC8138]</dt>
        <dd>
<span class="refAuthor">Thubert, P., Ed.</span>, <span class="refAuthor">Bormann, C.</span>, <span class="refAuthor">Toutain, L.</span>, and <span class="refAuthor">R. Cragie</span>, <span class="refTitle">"IPv6 over Low-Power Wireless Personal Area Network (6LoWPAN) Routing Header"</span>, <span class="seriesInfo">RFC 8138</span>, <span class="seriesInfo">DOI 10.17487/RFC8138</span>, <time class="refDate" datetime="2017-04">April 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8138">https://www.rfc-editor.org/info/rfc8138</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time class="refDate" datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8200">[RFC8200]</dt>
      <dd>
<span class="refAuthor">Deering, S.</span> and <span class="refAuthor">R. Hinden</span>, <span class="refTitle">"Internet Protocol, Version 6 (IPv6) Specification"</span>, <span class="seriesInfo">STD 86</span>, <span class="seriesInfo">RFC 8200</span>, <span class="seriesInfo">DOI 10.17487/RFC8200</span>, <time class="refDate" datetime="2017-07">July 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8200">https://www.rfc-editor.org/info/rfc8200</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-13.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-13.2">13.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-anima-autonomic-control-plane">[ACP]</dt>
        <dd>
<span class="refAuthor">Eckert, T.</span>, <span class="refAuthor">Behringer, M. H.</span>, and <span class="refAuthor">S. Bjarnason</span>, <span class="refTitle">"An Autonomic Control Plane (ACP)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-anima-autonomic-control-plane-30</span>, <time class="refDate" datetime="2020-10-30">30 October 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-anima-autonomic-control-plane-30">https://tools.ietf.org/html/draft-ietf-anima-autonomic-control-plane-30</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-anima-bootstrapping-keyinfra">[BRSKI]</dt>
        <dd>
<span class="refAuthor">Pritikin, M.</span>, <span class="refAuthor">Richardson, M. C.</span>, <span class="refAuthor">Eckert, T.</span>, <span class="refAuthor">Behringer, M. H.</span>, and <span class="refAuthor">K. Watsen</span>, <span class="refTitle">"Bootstrapping Remote Secure Key Infrastructures (BRSKI)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-anima-bootstrapping-keyinfra-45</span>, <time class="refDate" datetime="2020-11-11">11 November 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-anima-bootstrapping-keyinfra-45">https://tools.ietf.org/html/draft-ietf-anima-bootstrapping-keyinfra-45</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="DDOS-KREBS">[DDOS-KREBS]</dt>
        <dd>
<span class="refAuthor">Goodin, D.</span>, <span class="refTitle">"Record-breaking DDoS reportedly delivered by &gt;145k hacked cameras"</span>, <time class="refDate" datetime="2016-09">September 2016</time>, <span>&lt;<a href="https://arstechnica.com/information-technology/2016/09/botnet-of-145k-cameras-reportedly-deliver-internets-biggest-ddos-ever/">https://arstechnica.com/information-technology/2016/09/botnet-of-145k-cameras-reportedly-deliver-internets-biggest-ddos-ever/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC0801">[RFC0801]</dt>
        <dd>
<span class="refAuthor">Postel, J.</span>, <span class="refTitle">"NCP/TCP transition plan"</span>, <span class="seriesInfo">RFC 801</span>, <span class="seriesInfo">DOI 10.17487/RFC0801</span>, <time class="refDate" datetime="1981-11">November 1981</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc801">https://www.rfc-editor.org/info/rfc801</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2460">[RFC2460]</dt>
        <dd>
<span class="refAuthor">Deering, S.</span> and <span class="refAuthor">R. Hinden</span>, <span class="refTitle">"Internet Protocol, Version 6 (IPv6) Specification"</span>, <span class="seriesInfo">RFC 2460</span>, <span class="seriesInfo">DOI 10.17487/RFC2460</span>, <time class="refDate" datetime="1998-12">December 1998</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2460">https://www.rfc-editor.org/info/rfc2460</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2473">[RFC2473]</dt>
        <dd>
<span class="refAuthor">Conta, A.</span> and <span class="refAuthor">S. Deering</span>, <span class="refTitle">"Generic Packet Tunneling in IPv6 Specification"</span>, <span class="seriesInfo">RFC 2473</span>, <span class="seriesInfo">DOI 10.17487/RFC2473</span>, <time class="refDate" datetime="1998-12">December 1998</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2473">https://www.rfc-editor.org/info/rfc2473</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4443">[RFC4443]</dt>
        <dd>
<span class="refAuthor">Conta, A.</span>, <span class="refAuthor">Deering, S.</span>, and <span class="refAuthor">M. Gupta, Ed.</span>, <span class="refTitle">"Internet Control Message Protocol (ICMPv6) for the Internet Protocol Version 6 (IPv6) Specification"</span>, <span class="seriesInfo">STD 89</span>, <span class="seriesInfo">RFC 4443</span>, <span class="seriesInfo">DOI 10.17487/RFC4443</span>, <time class="refDate" datetime="2006-03">March 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4443">https://www.rfc-editor.org/info/rfc4443</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5406">[RFC5406]</dt>
        <dd>
<span class="refAuthor">Bellovin, S.</span>, <span class="refTitle">"Guidelines for Specifying the Use of IPsec Version 2"</span>, <span class="seriesInfo">BCP 146</span>, <span class="seriesInfo">RFC 5406</span>, <span class="seriesInfo">DOI 10.17487/RFC5406</span>, <time class="refDate" datetime="2009-02">February 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5406">https://www.rfc-editor.org/info/rfc5406</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6437">[RFC6437]</dt>
        <dd>
<span class="refAuthor">Amante, S.</span>, <span class="refAuthor">Carpenter, B.</span>, <span class="refAuthor">Jiang, S.</span>, and <span class="refAuthor">J. Rajahalme</span>, <span class="refTitle">"IPv6 Flow Label Specification"</span>, <span class="seriesInfo">RFC 6437</span>, <span class="seriesInfo">DOI 10.17487/RFC6437</span>, <time class="refDate" datetime="2011-11">November 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6437">https://www.rfc-editor.org/info/rfc6437</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6775">[RFC6775]</dt>
        <dd>
<span class="refAuthor">Shelby, Z., Ed.</span>, <span class="refAuthor">Chakrabarti, S.</span>, <span class="refAuthor">Nordmark, E.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"Neighbor Discovery Optimization for IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs)"</span>, <span class="seriesInfo">RFC 6775</span>, <span class="seriesInfo">DOI 10.17487/RFC6775</span>, <time class="refDate" datetime="2012-11">November 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6775">https://www.rfc-editor.org/info/rfc6775</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6997">[RFC6997]</dt>
        <dd>
<span class="refAuthor">Goyal, M., Ed.</span>, <span class="refAuthor">Baccelli, E.</span>, <span class="refAuthor">Philipp, M.</span>, <span class="refAuthor">Brandt, A.</span>, and <span class="refAuthor">J. Martocci</span>, <span class="refTitle">"Reactive Discovery of Point-to-Point Routes in Low-Power and Lossy Networks"</span>, <span class="seriesInfo">RFC 6997</span>, <span class="seriesInfo">DOI 10.17487/RFC6997</span>, <time class="refDate" datetime="2013-08">August 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6997">https://www.rfc-editor.org/info/rfc6997</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7102">[RFC7102]</dt>
        <dd>
<span class="refAuthor">Vasseur, JP.</span>, <span class="refTitle">"Terms Used in Routing for Low-Power and Lossy Networks"</span>, <span class="seriesInfo">RFC 7102</span>, <span class="seriesInfo">DOI 10.17487/RFC7102</span>, <time class="refDate" datetime="2014-01">January 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7102">https://www.rfc-editor.org/info/rfc7102</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7416">[RFC7416]</dt>
        <dd>
<span class="refAuthor">Tsao, T.</span>, <span class="refAuthor">Alexander, R.</span>, <span class="refAuthor">Dohler, M.</span>, <span class="refAuthor">Daza, V.</span>, <span class="refAuthor">Lozano, A.</span>, and <span class="refAuthor">M. Richardson, Ed.</span>, <span class="refTitle">"A Security Threat Analysis for the Routing Protocol for Low-Power and Lossy Networks (RPLs)"</span>, <span class="seriesInfo">RFC 7416</span>, <span class="seriesInfo">DOI 10.17487/RFC7416</span>, <time class="refDate" datetime="2015-01">January 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7416">https://www.rfc-editor.org/info/rfc7416</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8180">[RFC8180]</dt>
        <dd>
<span class="refAuthor">Vilajosana, X., Ed.</span>, <span class="refAuthor">Pister, K.</span>, and <span class="refAuthor">T. Watteyne</span>, <span class="refTitle">"Minimal IPv6 over the TSCH Mode of IEEE 802.15.4e (6TiSCH) Configuration"</span>, <span class="seriesInfo">BCP 210</span>, <span class="seriesInfo">RFC 8180</span>, <span class="seriesInfo">DOI 10.17487/RFC8180</span>, <time class="refDate" datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8180">https://www.rfc-editor.org/info/rfc8180</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8504">[RFC8504]</dt>
        <dd>
<span class="refAuthor">Chown, T.</span>, <span class="refAuthor">Loughney, J.</span>, and <span class="refAuthor">T. Winters</span>, <span class="refTitle">"IPv6 Node Requirements"</span>, <span class="seriesInfo">BCP 220</span>, <span class="seriesInfo">RFC 8504</span>, <span class="seriesInfo">DOI 10.17487/RFC8504</span>, <time class="refDate" datetime="2019-01">January 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8504">https://www.rfc-editor.org/info/rfc8504</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8505">[RFC8505]</dt>
        <dd>
<span class="refAuthor">Thubert, P., Ed.</span>, <span class="refAuthor">Nordmark, E.</span>, <span class="refAuthor">Chakrabarti, S.</span>, and <span class="refAuthor">C. Perkins</span>, <span class="refTitle">"Registration Extensions for IPv6 over Low-Power Wireless Personal Area Network (6LoWPAN) Neighbor Discovery"</span>, <span class="seriesInfo">RFC 8505</span>, <span class="seriesInfo">DOI 10.17487/RFC8505</span>, <time class="refDate" datetime="2018-11">November 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8505">https://www.rfc-editor.org/info/rfc8505</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8928">[RFC8928]</dt>
        <dd>
<span class="refAuthor">Thubert, P., Ed.</span>, <span class="refAuthor">Sarikaya, B.</span>, <span class="refAuthor">Sethi, M.</span>, and <span class="refAuthor">R. Struik</span>, <span class="refTitle">"Address-Protected Neighbor Discovery for Low-Power and Lossy Networks"</span>, <span class="seriesInfo">RFC 8928</span>, <span class="seriesInfo">DOI 10.17487/RFC8928</span>, <time class="refDate" datetime="2020-11">November 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8928">https://www.rfc-editor.org/info/rfc8928</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8929">[RFC8929]</dt>
        <dd>
<span class="refAuthor">Thubert, P., Ed.</span>, <span class="refAuthor">Perkins, C.E.</span>, and <span class="refAuthor">E. Levy-Abegnoli</span>, <span class="refTitle">"IPv6 Backbone Router"</span>, <span class="seriesInfo">RFC 8929</span>, <span class="seriesInfo">DOI 10.17487/RFC8929</span>, <time class="refDate" datetime="2020-11">November 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8929">https://www.rfc-editor.org/info/rfc8929</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9010">[RFC9010]</dt>
        <dd>
<span class="refAuthor">Thubert, P., Ed.</span> and <span class="refAuthor">M. Richardson</span>, <span class="refTitle">"Routing for RPL (Routing Protocol for Low-Power and Lossy Networks) Leaves"</span>, <span class="seriesInfo">RFC 9010</span>, <span class="seriesInfo">DOI 10.17487/RFC9010</span>, <time class="refDate" datetime="2021-04">April 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9010">https://www.rfc-editor.org/rfc/rfc9010</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-intarea-tunnels">[TUNNELS]</dt>
        <dd>
<span class="refAuthor">Touch, J.</span> and <span class="refAuthor">M. Townsley</span>, <span class="refTitle">"IP Tunnels in the Internet Architecture"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-intarea-tunnels-10</span>, <time class="refDate" datetime="2019-09-12">12 September 2019</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-intarea-tunnels-10">https://tools.ietf.org/html/draft-ietf-intarea-tunnels-10</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-6tisch-dtsecurity-zerotouch-join">[ZEROTOUCH-JOIN]</dt>
      <dd>
<span class="refAuthor">Richardson, M.</span>, <span class="refTitle">"6tisch Zero-Touch Secure Join protocol"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-6tisch-dtsecurity-zerotouch-join-04</span>, <time class="refDate" datetime="2019-07-08">8 July 2019</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-6tisch-dtsecurity-zerotouch-join-04">https://tools.ietf.org/html/draft-ietf-6tisch-dtsecurity-zerotouch-join-04</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="Acknowledgments">
<section id="section-appendix.a">
      <h2 id="name-acknowledgments">
<a class="section-name selfRef" href="#name-acknowledgments">Acknowledgments</a>
      </h2>
<p id="section-appendix.a-1">
           This work is done thanks to the grant given by the StandICT.eu project.<a class="pilcrow" href="#section-appendix.a-1">¶</a></p>
<p id="section-appendix.a-2">
            A special BIG thanks to <span class="contact-name">C. M. Heard</span> for the help with <a class="xref" href="#updateRFCs_section">Section 4</a>.
            Much of the editing in that section is based on his comments.<a class="pilcrow" href="#section-appendix.a-2">¶</a></p>
<p id="section-appendix.a-3">
           Additionally, the authors would like to acknowledge the review, feedback, and
           comments of the following (in alphabetical order): <span class="contact-name">Dominique Barthel</span>, <span class="contact-name">Robert Cragie</span>, <span class="contact-name">Ralph Droms</span>, <span class="contact-name">Simon Duquennoy</span>,
           <span class="contact-name">Cenk Guendogan</span>, <span class="contact-name">Rahul Jadhav</span>, <span class="contact-name">Benjamin Kaduk</span>, <span class="contact-name">Matthias Kovatsch</span>, <span class="contact-name">Gustavo Mercado</span>, <span class="contact-name">Subramanian Moonesamy</span>,
           <span class="contact-name">Marcela Orbiscay</span>, <span class="contact-name">Cristian Perez</span>, <span class="contact-name">Charlie Perkins</span>, <span class="contact-name">Alvaro Retana</span>, <span class="contact-name">Peter van der Stok</span>,
           <span class="contact-name">Xavier Vilajosana</span>, <span class="contact-name">Éric Vyncke</span>, and <span class="contact-name">Thomas Watteyne</span>.<a class="pilcrow" href="#section-appendix.a-3">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="section-appendix.b">
      <h2 id="name-authors-addresses">
<a class="section-name selfRef" href="#name-authors-addresses">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Maria Ines Robles</span></div>
<div class="left" dir="auto"><span class="org">Universidad Tecno. Nac.(UTN)-FRM, Argentina /Aalto University Finland</span></div>
<div class="left" dir="auto"><span class="street-address">Coronel Rodríguez 273</span></div>
<div class="left" dir="auto">
<span class="postal-code">M5500</span> <span class="locality">Mendoza</span>
</div>
<div class="left" dir="auto"><span class="region">Provincia de Mendoza</span></div>
<div class="left" dir="auto"><span class="country-name">Argentina</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:mariainesrobles@gmail.com">mariainesrobles@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Michael C. Richardson</span></div>
<div class="left" dir="auto"><span class="org">Sandelman Software Works</span></div>
<div class="left" dir="auto"><span class="street-address">470 Dawson Avenue</span></div>
<div class="left" dir="auto">
<span class="locality">Ottawa</span> <span class="region">ON</span> <span class="postal-code">K1Z 5V7</span>
</div>
<div class="left" dir="auto"><span class="country-name">Canada</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:mcr+ietf@sandelman.ca">mcr+ietf@sandelman.ca</a>
</div>
<div class="url">
<span>URI:</span>
<a class="url" href="http://www.sandelman.ca/mcr/">http://www.sandelman.ca/mcr/</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Pascal Thubert</span></div>
<div class="left" dir="auto"><span class="org">Cisco Systems, Inc</span></div>
<div class="left" dir="auto"><span class="extended-address">Building D</span></div>
<div class="left" dir="auto"><span class="street-address">45 Allee des Ormes - BP1200</span></div>
<div class="left" dir="auto">
<span class="postal-code">06254</span> <span class="locality">MOUGINS - Sophia Antipolis</span>
</div>
<div class="left" dir="auto"><span class="country-name">France</span></div>
<div class="tel">
<span>Phone:</span>
<a class="tel" href="tel:+33%20497%2023%2026%2034">+33 497 23 26 34</a>
</div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:pthubert@cisco.com">pthubert@cisco.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>