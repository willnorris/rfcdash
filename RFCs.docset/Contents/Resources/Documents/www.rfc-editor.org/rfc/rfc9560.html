<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 9560: Federated Authentication for the Registration Data Access Protocol (RDAP) Using OpenID Connect</title>
<meta content="Scott Hollenbeck" name="author"/>
<meta content="
       The Registration Data Access Protocol (RDAP) provides
      Representational State Transfer (RESTful) web services to retrieve
      registration metadata from domain name and regional internet
      registries. RDAP allows a server to make access control decisions based
      on client identity, and as such, it includes support for client
      identification features provided by the Hypertext Transfer Protocol
      (HTTP). Identification methods that require clients to obtain and manage
      credentials from every RDAP server operator present management
      challenges for both clients and servers, whereas a federated
      authentication system would make it easier to operate and use RDAP
      without the need to maintain server-specific client credentials. This
      document describes a federated authentication system for RDAP based on
      OpenID Connect. 
    " name="description"/>
<meta content="xml2rfc 3.21.0" name="generator"/>
<meta content="RDAP" name="keyword"/>
<meta content="Federated" name="keyword"/>
<meta content="Authentication" name="keyword"/>
<meta content="9560" name="rfc.number"/>
<!-- Generator version information:
  xml2rfc 3.21.0
    Python 3.9.15
    ConfigArgParse 1.5.3
    google-i18n-address 3.0.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.0
    platformdirs 3.8.0
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.28.0
    setuptools 44.1.1
    six 1.16.0
    wcwidth 0.2.5
    weasyprint 56.1
-->
<link href="rfc9560.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
  overflow-wrap: break-word;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
blockquote > *:last-child {
  margin-bottom: 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}
.xref {
  overflow-wrap: normal;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.refSubseries {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://datatracker.ietf.org/doc/draft-ietf-regext-rdap-openid-27" rel="prev"/>
  <link href="https://dx.doi.org/10.17487/rfc9560" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  </head>
<body class="xml2rfc">
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9560</td>
<td class="center">OIDC for RDAP</td>
<td class="right">April 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Hollenbeck</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc9560">9560</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2024-04">April 2024</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">S. Hollenbeck</div>
<div class="org">Verisign Labs</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9560</h1>
<h1 id="title">Federated Authentication for the Registration Data Access Protocol (RDAP) Using OpenID Connect</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">The Registration Data Access Protocol (RDAP) provides
      Representational State Transfer (RESTful) web services to retrieve
      registration metadata from domain name and regional internet
      registries. RDAP allows a server to make access control decisions based
      on client identity, and as such, it includes support for client
      identification features provided by the Hypertext Transfer Protocol
      (HTTP). Identification methods that require clients to obtain and manage
      credentials from every RDAP server operator present management
      challenges for both clients and servers, whereas a federated
      authentication system would make it easier to operate and use RDAP
      without the need to maintain server-specific client credentials. This
      document describes a federated authentication system for RDAP based on
      OpenID Connect.<a class="pilcrow" href="#section-abstract-1">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a class="pilcrow" href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9560">https://www.rfc-editor.org/info/rfc9560</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">▲</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p class="keepWithNext" id="section-toc.1-1.1.1"><a class="auto internal xref" href="#section-1">1</a>.  <a class="internal xref" href="#name-introduction">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p class="keepWithNext" id="section-toc.1-1.1.2.1.1"><a class="auto internal xref" href="#section-1.1">1.1</a>.  <a class="internal xref" href="#name-problem-statement">Problem Statement</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p class="keepWithNext" id="section-toc.1-1.1.2.2.1"><a class="auto internal xref" href="#section-1.2">1.2</a>.  <a class="internal xref" href="#name-approach">Approach</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a class="auto internal xref" href="#section-2">2</a>.  <a class="internal xref" href="#name-conventions-used-in-this-do">Conventions Used in This Document</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a class="auto internal xref" href="#section-3">3</a>.  <a class="internal xref" href="#name-federated-authentication-fo">Federated Authentication for RDAP</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a class="auto internal xref" href="#section-3.1">3.1</a>.  <a class="internal xref" href="#name-rdap-and-openid-connect">RDAP and OpenID Connect</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.1">
                    <p id="section-toc.1-1.3.2.1.2.1.1"><a class="auto internal xref" href="#section-3.1.1">3.1.1</a>.  <a class="internal xref" href="#name-terminology">Terminology</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.2">
                    <p id="section-toc.1-1.3.2.1.2.2.1"><a class="auto internal xref" href="#section-3.1.2">3.1.2</a>.  <a class="internal xref" href="#name-client-considerations">Client Considerations</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.3">
                    <p id="section-toc.1-1.3.2.1.2.3.1"><a class="auto internal xref" href="#section-3.1.3">3.1.3</a>.  <a class="internal xref" href="#name-overview">Overview</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.4">
                    <p id="section-toc.1-1.3.2.1.2.4.1"><a class="auto internal xref" href="#section-3.1.4">3.1.4</a>.  <a class="internal xref" href="#name-rdap-authentication-and-aut">RDAP Authentication and Authorization Steps</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.4.2.1">
                        <p id="section-toc.1-1.3.2.1.2.4.2.1.1"><a class="auto internal xref" href="#section-3.1.4.1">3.1.4.1</a>.  <a class="internal xref" href="#name-provider-discovery">Provider Discovery</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.4.2.2">
                        <p id="section-toc.1-1.3.2.1.2.4.2.2.1"><a class="auto internal xref" href="#section-3.1.4.2">3.1.4.2</a>.  <a class="internal xref" href="#name-authentication-request">Authentication Request</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.4.2.3">
                        <p id="section-toc.1-1.3.2.1.2.4.2.3.1"><a class="auto internal xref" href="#section-3.1.4.3">3.1.4.3</a>.  <a class="internal xref" href="#name-end-user-authorization">End User Authorization</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.4.2.4">
                        <p id="section-toc.1-1.3.2.1.2.4.2.4.1"><a class="auto internal xref" href="#section-3.1.4.4">3.1.4.4</a>.  <a class="internal xref" href="#name-authorization-response-and-">Authorization Response and Validation</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.4.2.5">
                        <p id="section-toc.1-1.3.2.1.2.4.2.5.1"><a class="auto internal xref" href="#section-3.1.4.5">3.1.4.5</a>.  <a class="internal xref" href="#name-token-processing">Token Processing</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.4.2.6">
                        <p id="section-toc.1-1.3.2.1.2.4.2.6.1"><a class="auto internal xref" href="#section-3.1.4.6">3.1.4.6</a>.  <a class="internal xref" href="#name-delivery-of-user-informatio">Delivery of User Information</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.5">
                    <p id="section-toc.1-1.3.2.1.2.5.1"><a class="auto internal xref" href="#section-3.1.5">3.1.5</a>.  <a class="internal xref" href="#name-specialized-claims-and-auth">Specialized Claims and Authorization Scope for RDAP</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.5.2.1">
                        <p id="section-toc.1-1.3.2.1.2.5.2.1.1"><a class="auto internal xref" href="#section-3.1.5.1">3.1.5.1</a>.  <a class="internal xref" href="#name-stated-purposes">Stated Purposes</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.5.2.2">
                        <p id="section-toc.1-1.3.2.1.2.5.2.2.1"><a class="auto internal xref" href="#section-3.1.5.2">3.1.5.2</a>.  <a class="internal xref" href="#name-do-not-track">Do Not Track</a></p>
</li>
                    </ul>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="auto internal xref" href="#section-4">4</a>.  <a class="internal xref" href="#name-common-protocol-features">Common Protocol Features</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a class="auto internal xref" href="#section-4.1">4.1</a>.  <a class="internal xref" href="#name-openid-connect-configuratio">OpenID Connect Configuration</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a class="auto internal xref" href="#section-4.2">4.2</a>.  <a class="internal xref" href="#name-rdap-query-parameters">RDAP Query Parameters</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a class="auto internal xref" href="#section-4.2.1">4.2.1</a>.  <a class="internal xref" href="#name-rdap-query-purpose">RDAP Query Purpose</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.2">
                    <p id="section-toc.1-1.4.2.2.2.2.1"><a class="auto internal xref" href="#section-4.2.2">4.2.2</a>.  <a class="internal xref" href="#name-rdap-do-not-track">RDAP Do Not Track</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.3">
                    <p id="section-toc.1-1.4.2.2.2.3.1"><a class="auto internal xref" href="#section-4.2.3">4.2.3</a>.  <a class="internal xref" href="#name-parameter-processing">Parameter Processing</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="auto internal xref" href="#section-5">5</a>.  <a class="internal xref" href="#name-protocol-features-for-sessi">Protocol Features for Session-Oriented Clients</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a class="auto internal xref" href="#section-5.1">5.1</a>.  <a class="internal xref" href="#name-data-structures">Data Structures</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.1">
                    <p id="section-toc.1-1.5.2.1.2.1.1"><a class="auto internal xref" href="#section-5.1.1">5.1.1</a>.  <a class="internal xref" href="#name-session">Session</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.2">
                    <p id="section-toc.1-1.5.2.1.2.2.1"><a class="auto internal xref" href="#section-5.1.2">5.1.2</a>.  <a class="internal xref" href="#name-device-info">Device Info</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a class="auto internal xref" href="#section-5.2">5.2</a>.  <a class="internal xref" href="#name-client-login">Client Login</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1">
                    <p id="section-toc.1-1.5.2.2.2.1.1"><a class="auto internal xref" href="#section-5.2.1">5.2.1</a>.  <a class="internal xref" href="#name-end-user-identifier">End-User Identifier</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.2">
                    <p id="section-toc.1-1.5.2.2.2.2.1"><a class="auto internal xref" href="#section-5.2.2">5.2.2</a>.  <a class="internal xref" href="#name-op-issuer-identifier">OP Issuer Identifier</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3">
                    <p id="section-toc.1-1.5.2.2.2.3.1"><a class="auto internal xref" href="#section-5.2.3">5.2.3</a>.  <a class="internal xref" href="#name-login-response">Login Response</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.4">
                    <p id="section-toc.1-1.5.2.2.2.4.1"><a class="auto internal xref" href="#section-5.2.4">5.2.4</a>.  <a class="internal xref" href="#name-clients-with-limited-user-i">Clients with Limited User Interfaces</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.4.2.1">
                        <p id="section-toc.1-1.5.2.2.2.4.2.1.1"><a class="auto internal xref" href="#section-5.2.4.1">5.2.4.1</a>.  <a class="internal xref" href="#name-ui-constrained-client-login">UI-Constrained Client Login</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.4.2.2">
                        <p id="section-toc.1-1.5.2.2.2.4.2.2.1"><a class="auto internal xref" href="#section-5.2.4.2">5.2.4.2</a>.  <a class="internal xref" href="#name-ui-constrained-client-login-">UI-Constrained Client Login Polling</a></p>
</li>
                    </ul>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a class="auto internal xref" href="#section-5.3">5.3</a>.  <a class="internal xref" href="#name-session-status">Session Status</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a class="auto internal xref" href="#section-5.4">5.4</a>.  <a class="internal xref" href="#name-session-refresh">Session Refresh</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5">
                <p id="section-toc.1-1.5.2.5.1"><a class="auto internal xref" href="#section-5.5">5.5</a>.  <a class="internal xref" href="#name-client-logout">Client Logout</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.6">
                <p id="section-toc.1-1.5.2.6.1"><a class="auto internal xref" href="#section-5.6">5.6</a>.  <a class="internal xref" href="#name-request-sequencing">Request Sequencing</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="auto internal xref" href="#section-6">6</a>.  <a class="internal xref" href="#name-protocol-features-for-token">Protocol Features for Token-Oriented Clients</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a class="auto internal xref" href="#section-6.1">6.1</a>.  <a class="internal xref" href="#name-client-login-2">Client Login</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a class="auto internal xref" href="#section-6.2">6.2</a>.  <a class="internal xref" href="#name-client-queries">Client Queries</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a class="auto internal xref" href="#section-6.3">6.3</a>.  <a class="internal xref" href="#name-access-token-validation">Access Token Validation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a class="auto internal xref" href="#section-6.4">6.4</a>.  <a class="internal xref" href="#name-token-exchange">Token Exchange</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="auto internal xref" href="#section-7">7</a>.  <a class="internal xref" href="#name-rdap-query-processing">RDAP Query Processing</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="auto internal xref" href="#section-8">8</a>.  <a class="internal xref" href="#name-rdap-conformance">RDAP Conformance</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="auto internal xref" href="#section-9">9</a>.  <a class="internal xref" href="#name-iana-considerations">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a class="auto internal xref" href="#section-9.1">9.1</a>.  <a class="internal xref" href="#name-rdap-extensions-registry">RDAP Extensions Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a class="auto internal xref" href="#section-9.2">9.2</a>.  <a class="internal xref" href="#name-json-web-token-claims-regis">JSON Web Token Claims Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a class="auto internal xref" href="#section-9.3">9.3</a>.  <a class="internal xref" href="#name-rdap-query-purpose-registry">RDAP Query Purpose Registry</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a class="auto internal xref" href="#section-10">10</a>. <a class="internal xref" href="#name-security-considerations">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a class="auto internal xref" href="#section-10.1">10.1</a>.  <a class="internal xref" href="#name-authentication-and-access-c">Authentication and Access Control</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a class="auto internal xref" href="#section-11">11</a>. <a class="internal xref" href="#name-references">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a class="auto internal xref" href="#section-11.1">11.1</a>.  <a class="internal xref" href="#name-normative-references">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a class="auto internal xref" href="#section-11.2">11.2</a>.  <a class="internal xref" href="#name-informative-references">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a class="auto internal xref" href="#appendix-A"></a><a class="internal xref" href="#name-acknowledgments">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a class="auto internal xref" href="#appendix-B"></a><a class="internal xref" href="#name-authors-address">Author's Address</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">The Registration Data Access Protocol (RDAP) provides 
      Representational State Transfer (RESTful) web services to retrieve
      registration metadata from domain name and regional internet
      registries. RDAP allows a server to make access control decisions based
      on client identity, and as such, it includes support for client
      identification features provided by the Hypertext Transfer Protocol
      (HTTP) <span>[<a class="cite xref" href="#RFC9110">RFC9110</a>]</span>.<a class="pilcrow" href="#section-1-1">¶</a></p>
<p id="section-1-2">RDAP is specified in multiple documents, including "<a class="internal xref" href="#RFC7480">HTTP Usage in the Registration Data Access Protocol (RDAP)</a>" <span>[<a class="cite xref" href="#RFC7480">RFC7480</a>]</span>, "<a class="internal xref" href="#RFC7481">Security Services for the Registration Data Access Protocol (RDAP)</a>" <span>[<a class="cite xref" href="#RFC7481">RFC7481</a>]</span>, "<a class="internal xref" href="#RFC9082">Registration Data Access Protocol (RDAP) Query Format</a>" <span>[<a class="cite xref" href="#RFC9082">RFC9082</a>]</span>, and "<a class="internal xref" href="#RFC9083">JSON Responses for the Registration Data Access Protocol (RDAP)</a>" <span>[<a class="cite xref" href="#RFC9083">RFC9083</a>]</span>. <span>[<a class="cite xref" href="#RFC7481">RFC7481</a>]</span> describes client identification and authentication
      services that can be used with RDAP, but it does not specify how any of
      these services can (or should) be used with RDAP.<a class="pilcrow" href="#section-1-2">¶</a></p>
<div id="problem">
<section id="section-1.1">
        <h3 id="name-problem-statement">
<a class="section-number selfRef" href="#section-1.1">1.1. </a><a class="section-name selfRef" href="#name-problem-statement">Problem Statement</a>
        </h3>
<p id="section-1.1-1">The conventional "username and password" authentication method does not scale well in the RDAP ecosystem. Assuming that all domain name and address registries will eventually provide RDAP service, it is impractical and inefficient for users to secure login credentials from the hundreds of different server operators. Authentication methods based on usernames and passwords do not provide information that describes the user in sufficient detail (while protecting the personal privacy of the user) for server operators to make fine-grained access control decisions based on the user's identity. The authentication system used for RDAP needs to address all of these needs.<a class="pilcrow" href="#section-1.1-1">¶</a></p>
</section>
</div>
<section id="section-1.2">
        <h3 id="name-approach">
<a class="section-number selfRef" href="#section-1.2">1.2. </a><a class="section-name selfRef" href="#name-approach">Approach</a>
        </h3>
<p id="section-1.2-1">A basic level of RDAP service can be provided to users who possess an identifier issued by a recognized provider who can authenticate and validate the user. For example, the identifiers issued by social media services can be used. Users who require higher levels of service (and who are willing to share more information about themselves to gain access to that service) can secure identifiers from specialized providers who are or will be able to provide more detailed information about the user. Server operators can then make access control decisions based on the identification information provided by the user.<a class="pilcrow" href="#section-1.2-1">¶</a></p>
<p id="section-1.2-2">A federated authentication system in which an RDAP server outsources identification and authentication services to a trusted identity provider would make it easier to operate and use RDAP by reusing existing identifiers to provide a basic level of access. It can also provide the ability to collect additional user identification information, and that information can be shared with the RDAP server operator with the consent of the user in order to help the server operator make access control decisions. This type of system allows an RDAP server to make access control decisions based on the nature of a query and the identity, authentication, and authorization information that is received from the identity provider. This document describes a federated authentication system for RDAP based on OpenID Connect <span>[<a class="cite xref" href="#OIDC">OIDC</a>]</span> that meets these needs.<a class="pilcrow" href="#section-1.2-2">¶</a></p>
</section>
</section>
<section id="section-2">
      <h2 id="name-conventions-used-in-this-do">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-conventions-used-in-this-do">Conventions Used in This Document</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>", "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as described in BCP 14 <span>[<a class="cite xref" href="#RFC2119">RFC2119</a>]</span> <span>[<a class="cite xref" href="#RFC8174">RFC8174</a>]</span> when, and only when, they appear in all capitals, as shown here.<a class="pilcrow" href="#section-2-1">¶</a></p>
<p id="section-2-2">All of the HTTP requests described in this document that are sent from an RDAP client to an RDAP server use the HTTP GET method as specified in <span>[<a class="cite xref" href="#RFC9110">RFC9110</a>]</span>.<a class="pilcrow" href="#section-2-2">¶</a></p>
<p id="section-2-3">Long lines in examples are wrapped using "The Single Backslash Strategy" described in <span>[<a class="cite xref" href="#RFC8792">RFC8792</a>]</span>.<a class="pilcrow" href="#section-2-3">¶</a></p>
</section>
<div id="RDAP-FedAuth">
<section id="section-3">
      <h2 id="name-federated-authentication-fo">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-federated-authentication-fo">Federated Authentication for RDAP</a>
      </h2>
<p id="section-3-1">RDAP itself does not include built-in security services. Instead, RDAP relies on features that are available in other protocol layers to provide needed security services including access control, authentication, authorization, availability, data confidentiality, data integrity, and identification. A description of each of these security services can be found in "<a class="internal xref" href="#RFC4949">Internet Security Glossary, Version 2</a>" <span>[<a class="cite xref" href="#RFC4949">RFC4949</a>]</span>. This document focuses on a federated authentication system for RDAP that provides services for authentication, authorization, and identification, allowing a server operator to make access control decisions. <span><a class="relref" href="https://rfc-editor.org/rfc/rfc7481#section-3">Section 3</a> of [<a class="cite xref" href="#RFC7481">RFC7481</a>]</span> describes general considerations for RDAP access control, authentication, and authorization.<a class="pilcrow" href="#section-3-1">¶</a></p>
<p id="section-3-2">The conventional client-server authentication model requires clients to maintain distinct credentials for every RDAP server. This situation can become unwieldy as the number of RDAP servers increases. Federated authentication mechanisms allow clients to use one credential to access multiple RDAP servers and reduce client credential management complexity.<a class="pilcrow" href="#section-3-2">¶</a></p>
<div id="RDAP-OIDC">
<section id="section-3.1">
        <h3 id="name-rdap-and-openid-connect">
<a class="section-number selfRef" href="#section-3.1">3.1. </a><a class="section-name selfRef" href="#name-rdap-and-openid-connect">RDAP and OpenID Connect</a>
        </h3>
<p id="section-3.1-1">OpenID Connect 1.0 <span>[<a class="cite xref" href="#OIDCC">OIDCC</a>]</span> is a decentralized, Single Sign-On (SSO) federated authentication system that allows users to access multiple web resources with one identifier instead of having to create multiple server-specific identifiers. Users acquire identifiers from OpenID Providers (OPs). Relying Parties (RPs) are applications (such as RDAP) that outsource their user authentication function to an OP. OpenID Connect is built on top of the authorization framework provided by the OAuth 2.0  protocol <span>[<a class="cite xref" href="#RFC6749">RFC6749</a>]</span>.<a class="pilcrow" href="#section-3.1-1">¶</a></p>
<p id="section-3.1-2">The OAuth authorization framework describes a method for users to access protected web resources without having to hand out their credentials. Instead, clients are issued access tokens by OPs with the permission of the resource owners. Using OpenID Connect and OAuth, multiple RDAP servers can form a federation, and clients can access any server in the federation by providing one credential registered with any OP in that federation. The OAuth authorization framework is designed for use with HTTP and thus can be used with RDAP.<a class="pilcrow" href="#section-3.1-2">¶</a></p>
<div id="terms">
<section id="section-3.1.1">
          <h4 id="name-terminology">
<a class="section-number selfRef" href="#section-3.1.1">3.1.1. </a><a class="section-name selfRef" href="#name-terminology">Terminology</a>
          </h4>
<p id="section-3.1.1-1">This document uses the following terminology.<a class="pilcrow" href="#section-3.1.1-1">¶</a></p>
<p id="section-3.1.1-2">Terms defined by <span>[<a class="cite xref" href="#RFC7480">RFC7480</a>]</span>:<a class="pilcrow" href="#section-3.1.1-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.1-3.1">client<a class="pilcrow" href="#section-3.1.1-3.1">¶</a>
</li>
            <li class="normal" id="section-3.1.1-3.2">server<a class="pilcrow" href="#section-3.1.1-3.2">¶</a>
</li>
          </ul>
<p id="section-3.1.1-4">Terms defined by <span>[<a class="cite xref" href="#RFC6749">RFC6749</a>]</span>:<a class="pilcrow" href="#section-3.1.1-4">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.1-5.1">access token<a class="pilcrow" href="#section-3.1.1-5.1">¶</a>
</li>
            <li class="normal" id="section-3.1.1-5.2">authorization code<a class="pilcrow" href="#section-3.1.1-5.2">¶</a>
</li>
            <li class="normal" id="section-3.1.1-5.3">authorization endpoint<a class="pilcrow" href="#section-3.1.1-5.3">¶</a>
</li>
            <li class="normal" id="section-3.1.1-5.4">authorization grant<a class="pilcrow" href="#section-3.1.1-5.4">¶</a>
</li>
            <li class="normal" id="section-3.1.1-5.5">client authentication<a class="pilcrow" href="#section-3.1.1-5.5">¶</a>
</li>
            <li class="normal" id="section-3.1.1-5.6">client identifier<a class="pilcrow" href="#section-3.1.1-5.6">¶</a>
</li>
            <li class="normal" id="section-3.1.1-5.7">protected resource<a class="pilcrow" href="#section-3.1.1-5.7">¶</a>
</li>
            <li class="normal" id="section-3.1.1-5.8">refresh token<a class="pilcrow" href="#section-3.1.1-5.8">¶</a>
</li>
            <li class="normal" id="section-3.1.1-5.9">resource owner<a class="pilcrow" href="#section-3.1.1-5.9">¶</a>
</li>
            <li class="normal" id="section-3.1.1-5.10">resource server<a class="pilcrow" href="#section-3.1.1-5.10">¶</a>
</li>
            <li class="normal" id="section-3.1.1-5.11">token endpoint<a class="pilcrow" href="#section-3.1.1-5.11">¶</a>
</li>
          </ul>
<p id="section-3.1.1-6">Terms defined by <span>[<a class="cite xref" href="#RFC7519">RFC7519</a>]</span>:<a class="pilcrow" href="#section-3.1.1-6">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.1-7.1">claim name<a class="pilcrow" href="#section-3.1.1-7.1">¶</a>
</li>
            <li class="normal" id="section-3.1.1-7.2">claim value<a class="pilcrow" href="#section-3.1.1-7.2">¶</a>
</li>
            <li class="normal" id="section-3.1.1-7.3">JSON Web Token (JWT)<a class="pilcrow" href="#section-3.1.1-7.3">¶</a>
</li>
          </ul>
<p id="section-3.1.1-8">Terms defined by <span>[<a class="cite xref" href="#OIDCC">OIDCC</a>]</span>:<a class="pilcrow" href="#section-3.1.1-8">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.1-9.1">ID Token<a class="pilcrow" href="#section-3.1.1-9.1">¶</a>
</li>
            <li class="normal" id="section-3.1.1-9.2">UserInfo Endpoint<a class="pilcrow" href="#section-3.1.1-9.2">¶</a>
</li>
          </ul>
<p id="section-3.1.1-10">Term defined by <span>[<a class="cite xref" href="#RFC9068">RFC9068</a>]</span>:<a class="pilcrow" href="#section-3.1.1-10">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.1-11.1">JWT access token<a class="pilcrow" href="#section-3.1.1-11.1">¶</a>
</li>
          </ul>
<p id="section-3.1.1-12">Additional terms from Section 1.2 of the OpenID Connect Core specification are incorporated by reference.<a class="pilcrow" href="#section-3.1.1-12">¶</a></p>
<p id="section-3.1.1-13">This document uses the terms "remote" and "default" to describe the relationship between an RDAP server and the OPs that it interacts with. A "remote" OP is one that is identified by the RDAP client by providing either an Issuer Identifier or an end-user identifier in a login request. Whether an Issuer Identifier or end-user identifier can be provided in the login request for the purposes of selecting an OP can be determined by retrieving the RDAP server's OIDC configuration details (see <a class="auto internal xref" href="#openidcConfiguration">Section 4.1</a>). A "default" OP is one that the RDAP server will use when the RDAP client does not provide an Issuer Identifier or an end-user identifier in the login request.<a class="pilcrow" href="#section-3.1.1-13">¶</a></p>
<p id="section-3.1.1-14">This document uses the term "session" to describe a set of interactions between an RDAP client and an RDAP server during a given period of time. For session-oriented clients (see <a class="auto internal xref" href="#client-cons">Section 3.1.2</a>), the RDAP session is a typical HTTP session starting with a farv1_session/login request and ending with either a farv1_session/logout request (see <a class="auto internal xref" href="#protocol">Section 5</a> for a description of both path segments) or a timeout. For token-oriented clients (see Sections <a class="auto internal xref" href="#client-cons">3.1.2</a> and <a class="auto internal xref" href="#protocol-tokens">6</a>), the RDAP session corresponds to the lifespan of an authorization obtained from an OP and the corresponding access token, including any refreshed access tokens.<a class="pilcrow" href="#section-3.1.1-14">¶</a></p>
</section>
</div>
<div id="client-cons">
<section id="section-3.1.2">
          <h4 id="name-client-considerations">
<a class="section-number selfRef" href="#section-3.1.2">3.1.2. </a><a class="section-name selfRef" href="#name-client-considerations">Client Considerations</a>
          </h4>
<p id="section-3.1.2-1">Clients that delegate OIDC authentication to an RDAP server as part of session-oriented interactions and can accept and process HTTP cookies <span>[<a class="cite xref" href="#RFC6265">RFC6265</a>]</span> to maintain the session are known as "session-oriented" clients. This type of RDAP client performs the role of a user agent <span>[<a class="cite xref" href="#RFC9110">RFC9110</a>]</span>. An RDAP server performs the role of an OpenID Connect Core Relying Party (RP). A web browser used to send queries directly to an RDAP server is an example of a session-oriented client. Specifications for this type of client can be found in <a class="auto internal xref" href="#protocol">Section 5</a>.<a class="pilcrow" href="#section-3.1.2-1">¶</a></p>
<p id="section-3.1.2-2">Clients that perform OIDC authentication directly, taking the role of an RP in interactions with an OP and sending access tokens <span>[<a class="cite xref" href="#RFC6749">RFC6749</a>]</span> to an RDAP server to authorize RDAP queries, are known as "token-oriented" clients. An RDAP server performs resource server <span>[<a class="cite xref" href="#RFC6749">RFC6749</a>]</span> functions to verify the tokens received from the client and RP functions to retrieve information from the OP as necessary to make access control decisions. A web browser running JavaScript received from a web service that sends queries to an RDAP server directly or through its back-end web service is an example of a token-oriented client. Specifications for this type of client can be found in <a class="auto internal xref" href="#protocol-tokens">Section 6</a>.<a class="pilcrow" href="#section-3.1.2-2">¶</a></p>
<p id="section-3.1.2-3">Clients <span class="bcp14">MAY</span> operate as either session-oriented or token-oriented clients, but they <span class="bcp14">MUST</span> do so consistently by not mixing token-oriented and session-oriented requests while interacting with an OP. Servers <span class="bcp14">SHOULD</span> support both types of client to maximize interoperability but <span class="bcp14">MAY</span> choose to support only one type of client as required by local policy or operating conditions. A server that does not support a particular client type will not support the protocol features (the data structures, path segments, parameters, and interactions) specified for that client type. Server signaling of supported client types is described in <a class="auto internal xref" href="#openidcConfiguration">Section 4.1</a>.<a class="pilcrow" href="#section-3.1.2-3">¶</a></p>
</section>
</div>
<div id="overview">
<section id="section-3.1.3">
          <h4 id="name-overview">
<a class="section-number selfRef" href="#section-3.1.3">3.1.3. </a><a class="section-name selfRef" href="#name-overview">Overview</a>
          </h4>
<p id="section-3.1.3-1">At a high level, RDAP authentication of a session-oriented client using OpenID Connect requires completion of the following steps:<a class="pilcrow" href="#section-3.1.3-1">¶</a></p>
<ol class="normal type-1" id="section-3.1.3-2" start="1" type="1">
     <li id="section-3.1.3-2.1">
              <p id="section-3.1.3-2.1.1">An RDAP client sends an RDAP "help" query to an RDAP server
              to determine the types and capabilities of the OPs
              that are used by the RDAP server. This information is returned
              in the "rdapConformance" section of the response. A value of
              "farv1" indicates support for the extension described in this
              specification. If one or more remote OPs are
              supported, the RDAP client <span class="bcp14">SHOULD</span> evaluate the
              additional information described in <a class="auto internal xref" href="#openidcConfiguration">Section 4.1</a> in order to discover the
              capabilities of the RDAP server and optionally obtain the set of
              supported OPs unless that information is available from a
              trusted out-of-band source and has already been processed.<a class="pilcrow" href="#section-3.1.3-2.1.1">¶</a></p>
</li>
            <li id="section-3.1.3-2.2">
              <p id="section-3.1.3-2.2.1">An RDAP client sends an RDAP "login" request to an RDAP server as described in <a class="auto internal xref" href="#client-login">Section 5.2</a>.<a class="pilcrow" href="#section-3.1.3-2.2.1">¶</a></p>
</li>
            <li id="section-3.1.3-2.3">
              <p id="section-3.1.3-2.3.1">The RDAP server prepares an Authentication Request containing the desired request parameters.<a class="pilcrow" href="#section-3.1.3-2.3.1">¶</a></p>
</li>
            <li id="section-3.1.3-2.4">
              <p id="section-3.1.3-2.4.1">The RDAP server sends an Authentication Request to an OP authorization endpoint and redirects the RDAP client to the OP using an HTTP redirect.<a class="pilcrow" href="#section-3.1.3-2.4.1">¶</a></p>
</li>
            <li id="section-3.1.3-2.5">
              <p id="section-3.1.3-2.5.1">The OP authenticates the end user.<a class="pilcrow" href="#section-3.1.3-2.5.1">¶</a></p>
</li>
            <li id="section-3.1.3-2.6">
              <p id="section-3.1.3-2.6.1">The OP obtains end-user consent and authorization.<a class="pilcrow" href="#section-3.1.3-2.6.1">¶</a></p>
</li>
            <li id="section-3.1.3-2.7">
              <p id="section-3.1.3-2.7.1">The OP sends the RDAP client back to the RDAP server with an authorization code using an HTTP redirect.<a class="pilcrow" href="#section-3.1.3-2.7.1">¶</a></p>
</li>
            <li id="section-3.1.3-2.8">
              <p id="section-3.1.3-2.8.1">The RDAP server requests tokens using the authorization code at the OP's token endpoint.<a class="pilcrow" href="#section-3.1.3-2.8.1">¶</a></p>
</li>
            <li id="section-3.1.3-2.9">
              <p id="section-3.1.3-2.9.1">The RDAP server receives a response that contains an ID Token and access token in the response body.<a class="pilcrow" href="#section-3.1.3-2.9.1">¶</a></p>
</li>
            <li id="section-3.1.3-2.10">
              <p id="section-3.1.3-2.10.1">The RDAP server validates the tokens as described in <span>[<a class="cite xref" href="#OIDCC">OIDCC</a>]</span> and retrieves the claims associated with the end user's identity from the OP's UserInfo
   Endpoint.<a class="pilcrow" href="#section-3.1.3-2.10.1">¶</a></p>
</li>
          </ol>
<p class="keepWithNext" id="section-3.1.3-3">The steps above can be described in a sequence diagram:<a class="pilcrow" href="#section-3.1.3-3">¶</a></p>
<div id="sequence_diagram_session">
<figure id="figure-1">
            <div class="alignLeft art-text artwork" id="section-3.1.3-4.1">
<pre>End          OpenID         RDAP                 RDAP
User        Provider       Client               Server
  |             |             |                    |
  |             |             |-----Help Query----&gt;|
  |             |             |                    |
  |             |             |&lt;---Help Response---|
  |             |             |                    |
  |-------Login Request------&gt;|                    |
  |             |             |                    |
  |             |             |---Login Request---&gt;|
  |             |             |                    |
  |             |&lt;-----Authentication Request------|
  |             |             |                    |
  | Credential--|             |                    |
  |&lt;--Request   |             |                    |
  |             |             |                    |
  |--Credential |             |                    |
  |   Response-&gt;|             |                    |
  |             |             |                    |
  |             |-----Authentication Response-----&gt;|
  |             |             |                    |
  |             |&lt;----------Token Request----------|
  |             |             |                    |
  |             |-----------Token Response--------&gt;|
  |             |             |                    |
  |             |&lt;----------Claim Request----------|
  |             |             |                    |
  |             |-----------Claim Response--------&gt;|
  |             |             |                    |
  |             |             |&lt;--Login Response---|
  |             |             |                    |
  |&lt;------Login Response------|                    |
  |             |             |                    |
  |----------RDAP Query------&gt;|                    |
  |             |             |                    |
  |             |             |-----RDAP Query----&gt;|
  |             |             |                    |
  |             |             |&lt;---RDAP Response---|
  |             |             |                    |
  |&lt;------RDAP Response-------|                    |</pre>
</div>
<figcaption><a class="selfRef" href="#figure-1">Figure 1</a></figcaption></figure>
</div>
<p id="section-3.1.3-5">The RDAP server can then make identification, authorization, and access control decisions based on end-user identity information and local policies. Note that OpenID Connect describes different process flows for other types of clients, such as script-based or command-line clients.<a class="pilcrow" href="#section-3.1.3-5">¶</a></p>
<p id="section-3.1.3-6">RDAP authentication of a token-oriented client using OpenID Connect requires completion of the following steps:<a class="pilcrow" href="#section-3.1.3-6">¶</a></p>
<ol class="normal type-1" id="section-3.1.3-7" start="1" type="1">
<li id="section-3.1.3-7.1">
              <p id="section-3.1.3-7.1.1">An RDAP client sends an RDAP "help" query to an RDAP server to determine the type and capabilities of the OPs that are used by the RDAP server. This information is returned in the "rdapConformance" section of the response. A value of "farv1" indicates support for the extension described in this specification. If one or more remote OPs are supported, the RDAP client <span class="bcp14">SHOULD</span> evaluate the additional information described in <a class="auto internal xref" href="#openidcConfiguration">Section 4.1</a> in order to discover the capabilities of the RDAP server and optionally obtain the set of supported OPs. Support for token-oriented clients requires a default OP.<a class="pilcrow" href="#section-3.1.3-7.1.1">¶</a></p>
</li>
            <li id="section-3.1.3-7.2">
              <p id="section-3.1.3-7.2.1">The RDAP client determines the end user's OP and confirms that it's supported by the RDAP server.<a class="pilcrow" href="#section-3.1.3-7.2.1">¶</a></p>
</li>
            <li id="section-3.1.3-7.3">
              <p id="section-3.1.3-7.3.1">The RDAP client sends an Authentication Request to the OP's authorization endpoint.<a class="pilcrow" href="#section-3.1.3-7.3.1">¶</a></p>
</li>
            <li id="section-3.1.3-7.4">
              <p id="section-3.1.3-7.4.1">The OP authenticates the end user.<a class="pilcrow" href="#section-3.1.3-7.4.1">¶</a></p>
</li>
            <li id="section-3.1.3-7.5">
              <p id="section-3.1.3-7.5.1">The OP obtains end-user consent or authorization.<a class="pilcrow" href="#section-3.1.3-7.5.1">¶</a></p>
</li>
            <li id="section-3.1.3-7.6">
              <p id="section-3.1.3-7.6.1">The OP returns an authorization code to the RDAP client.<a class="pilcrow" href="#section-3.1.3-7.6.1">¶</a></p>
</li>
            <li id="section-3.1.3-7.7">
              <p id="section-3.1.3-7.7.1">The RDAP client requests tokens using the authorization code at the OP's token endpoint.<a class="pilcrow" href="#section-3.1.3-7.7.1">¶</a></p>
</li>
            <li id="section-3.1.3-7.8">
              <p id="section-3.1.3-7.8.1">The RDAP client receives a response that contains an ID Token and an access token in the response body.<a class="pilcrow" href="#section-3.1.3-7.8.1">¶</a></p>
</li>
            <li id="section-3.1.3-7.9">
              <p id="section-3.1.3-7.9.1">The RDAP client monitors the token validity period and either refreshes the token or requests new tokens as necessary.<a class="pilcrow" href="#section-3.1.3-7.9.1">¶</a></p>
</li>
            <li id="section-3.1.3-7.10">
              <p id="section-3.1.3-7.10.1">The RDAP client sends queries that require user identification, authentication, and authorization to an RDAP server that include an access token in an HTTP "authorization" header using the "bearer" authentication scheme described in <span>[<a class="cite xref" href="#RFC6750">RFC6750</a>]</span>.<a class="pilcrow" href="#section-3.1.3-7.10.1">¶</a></p>
</li>
            <li id="section-3.1.3-7.11">
              <p id="section-3.1.3-7.11.1">The RDAP server validates the access token and retrieves the claims associated with the end user's identity from the OP's UserInfo Endpoint.<a class="pilcrow" href="#section-3.1.3-7.11.1">¶</a></p>
</li>
            <li id="section-3.1.3-7.12">
              <p id="section-3.1.3-7.12.1">The RDAP server determines the end user's authorization level and processes the query in accordance with server policies.<a class="pilcrow" href="#section-3.1.3-7.12.1">¶</a></p>
</li>
          </ol>
<p class="keepWithNext" id="section-3.1.3-8">The steps above can be described in a sequence diagram:<a class="pilcrow" href="#section-3.1.3-8">¶</a></p>
<div id="sequence_diagram_token">
<figure id="figure-2">
            <div class="alignLeft art-text artwork" id="section-3.1.3-9.1">
<pre>End          OpenID         RDAP                 RDAP
User        Provider       Client               Server
  |             |             |                    |
  |             |             |-----Help Query----&gt;|
  |             |             |                    |
  |             |             |&lt;----Help Response--|
  |             |             |                    |
  |-------Login Request------&gt;|                    |
  |             |             |                    |
  |             |&lt;-Authentication                  |
  |             |   Request---|                    |
  |             |             |                    |
  |&lt;-Credential |             |                    |
  |   Request---|             |                    |
  |             |             |                    |
  |--Credential |             |                    |
  |   Response-&gt;|             |                    |
  |             |             |                    |
  |             |--Authentication                  |
  |             | Response---&gt;|                    |
  |             |             |                    |
  |             |&lt;-Token      |                    |
  |             |  Request----|                    |
  |             |             |                    |
  |             |--Token      |                    |
  |             |  Response--&gt;|                    |
  |             |             |                    |
  |&lt;------Login Response------|                    |
  |             |             |                    |
  |-----RDAP Query-----------&gt;|                    |
  |             |             |                    |
  |             |             |----RDAP Query-----&gt;|
  |             |             |                    |
  |             |&lt;------------Claim                |
  |             |            Request---------------|
  |             |             |                    |
  |             |-------------Claim                |
  |             |            Response-------------&gt;|
  |             |             |                    |
  |             |             |&lt;---RDAP Response---|
  |             |             |                    |
  |&lt;----RDAP Response---------|                    |</pre>
</div>
<figcaption><a class="selfRef" href="#figure-2">Figure 2</a></figcaption></figure>
</div>
</section>
</div>
<div id="process">
<section id="section-3.1.4">
          <h4 id="name-rdap-authentication-and-aut">
<a class="section-number selfRef" href="#section-3.1.4">3.1.4. </a><a class="section-name selfRef" href="#name-rdap-authentication-and-aut">RDAP Authentication and Authorization Steps</a>
          </h4>
<p id="section-3.1.4-1">End users <span class="bcp14">MAY</span> present an identifier (an OpenID) issued by an OP to use OpenID Connect with RDAP. If the RDAP server supports a default OP or if provider discovery is not supported, the end-user identifier <span class="bcp14">MAY</span> be omitted. An OP <span class="bcp14">SHOULD</span> include support for the claims described in <a class="auto internal xref" href="#rdap-claims">Section 3.1.5</a> to provide additional information needed for RDAP end-user authorization; in the absence of these claims, clients and servers <span class="bcp14">MAY</span> make authorization and access control decisions as appropriate given any other information returned from the OP. OpenID Connect requires RPs to register with OPs to use OpenID Connect services for an end user. The registration process is often completed using out-of-band methods, but it is also possible to use the automated method described by the OpenID Connect Dynamic Client Registration protocol <span>[<a class="cite xref" href="#OIDCR">OIDCR</a>]</span>. The parties involved can use any method that is mutually acceptable.<a class="pilcrow" href="#section-3.1.4-1">¶</a></p>
<div id="discovery">
<section id="section-3.1.4.1">
            <h5 id="name-provider-discovery">
<a class="section-number selfRef" href="#section-3.1.4.1">3.1.4.1. </a><a class="section-name selfRef" href="#name-provider-discovery">Provider Discovery</a>
            </h5>
<p id="section-3.1.4.1-1">An RDAP server acting as an RP needs to be able to map an end user's identifier to an OP. This can be accomplished using the <span class="bcp14">OPTIONAL</span> OpenID Connect Discovery protocol <span>[<a class="cite xref" href="#OIDCD">OIDCD</a>]</span>, but that protocol is not widely implemented. Out-of-band methods are also possible and can be more dependable. For example, an RP can support a limited number of OPs and maintain internal associations of those identifiers with the OPs that issued them.<a class="pilcrow" href="#section-3.1.4.1-1">¶</a></p>
<p id="section-3.1.4.1-2">Alternatively, if mapping an end user's identifier is not possible, or not supported by the RDAP server, the RDAP server <span class="bcp14">SHOULD</span> support explicit specification of a remote OP by the RDAP client in the form of a query parameter as described in <a class="auto internal xref" href="#issuer-identifier">Section 5.2.2</a> unless the remote OP has been identified using an out-of-band mechanism. An RDAP server <span class="bcp14">MUST</span> provide information about its capabilities and supported OPs in the "help" query response in the "farv1_openidcConfiguration" data structure described in <a class="auto internal xref" href="#openidcConfiguration">Section 4.1</a>. An RDAP server acting as an RP <span class="bcp14">MUST</span> support at least one of these methods of OP discovery.<a class="pilcrow" href="#section-3.1.4.1-2">¶</a></p>
</section>
</div>
<div id="auth-request">
<section id="section-3.1.4.2">
            <h5 id="name-authentication-request">
<a class="section-number selfRef" href="#section-3.1.4.2">3.1.4.2. </a><a class="section-name selfRef" href="#name-authentication-request">Authentication Request</a>
            </h5>
<p id="section-3.1.4.2-1">Once the OP is known, an RP <span class="bcp14">MUST</span> form an Authentication Request and send it to the OP as described in Section 3 of <span>[<a class="cite xref" href="#OIDCC">OIDCC</a>]</span>. The authentication path followed (authorization, implicit, or hybrid) will depend on the Authentication Request response_type set by the RP. The remainder of the processing steps described here assume that the authorization code flow is being used by setting "response_type=code" in the Authentication Request.<a class="pilcrow" href="#section-3.1.4.2-1">¶</a></p>
<p id="section-3.1.4.2-2">The benefits of using the authorization code flow for authenticating a human user are described in Section 3.1 of <span>[<a class="cite xref" href="#OIDCC">OIDCC</a>]</span>. The Implicit Flow is more commonly used by clients implemented in a web browser using a scripting language; it is described in Section 3.2 of <span>[<a class="cite xref" href="#OIDCC">OIDCC</a>]</span>. At the time of this writing, the Implicit Flow is considered insecure and efforts are being made to deprecate the flow. The Hybrid Flow (described in Section 3.3 of <span>[<a class="cite xref" href="#OIDCC">OIDCC</a>]</span>) combines elements of the authorization code and Implicit Flows by returning some tokens from the authorization endpoint and others from the token endpoint.<a class="pilcrow" href="#section-3.1.4.2-2">¶</a></p>
<p id="section-3.1.4.2-3">An Authentication Request can contain several parameters. <span class="bcp14">REQUIRED</span> parameters are specified in Section 3.1.2.1 of <span>[<a class="cite xref" href="#OIDCC">OIDCC</a>]</span>. Apart from these parameters, it is <span class="bcp14">RECOMMENDED</span> that the RP include the optional "login_hint" parameter in the request, with the value being that of the "farv1_id" query parameter of the end user's RDAP "login" request, if provided. Passing the "login_hint" parameter allows a client to pre-fill login form information, so logging in can be more convenient for users. Other parameters <span class="bcp14">MAY</span> be included.<a class="pilcrow" href="#section-3.1.4.2-3">¶</a></p>
<p id="section-3.1.4.2-4">The OP receives the Authentication Request and attempts to validate it as described in Section 3.1.2.2 of <span>[<a class="cite xref" href="#OIDCC">OIDCC</a>]</span>. If the request is valid, the OP attempts to authenticate the end user as described in Section 3.1.2.3 of <span>[<a class="cite xref" href="#OIDCC">OIDCC</a>]</span>. The OP returns an error response if the request is not valid or if any error is encountered.<a class="pilcrow" href="#section-3.1.4.2-4">¶</a></p>
</section>
</div>
<div id="End-User-auth">
<section id="section-3.1.4.3">
            <h5 id="name-end-user-authorization">
<a class="section-number selfRef" href="#section-3.1.4.3">3.1.4.3. </a><a class="section-name selfRef" href="#name-end-user-authorization">End User Authorization</a>
            </h5>
<p id="section-3.1.4.3-1">After the end user is authenticated, the OP <span class="bcp14">MUST</span> obtain consent from the end user to release authorization information to the RDAP server acting as an RP. This process is described in Section 3.1.2.4 of <span>[<a class="cite xref" href="#OIDCC">OIDCC</a>]</span>.<a class="pilcrow" href="#section-3.1.4.3-1">¶</a></p>
</section>
</div>
<div id="auth-valid">
<section id="section-3.1.4.4">
            <h5 id="name-authorization-response-and-">
<a class="section-number selfRef" href="#section-3.1.4.4">3.1.4.4. </a><a class="section-name selfRef" href="#name-authorization-response-and-">Authorization Response and Validation</a>
            </h5>
<p id="section-3.1.4.4-1">After obtaining an authorization result, the OP will send a response to the RP that provides the result of the authorization process using an authorization code. The RP <span class="bcp14">MUST</span> validate the response. This process is described in Sections 3.1.2.5 - 3.1.2.7 of <span>[<a class="cite xref" href="#OIDCC">OIDCC</a>]</span>.<a class="pilcrow" href="#section-3.1.4.4-1">¶</a></p>
</section>
</div>
<div id="tokens">
<section id="section-3.1.4.5">
            <h5 id="name-token-processing">
<a class="section-number selfRef" href="#section-3.1.4.5">3.1.4.5. </a><a class="section-name selfRef" href="#name-token-processing">Token Processing</a>
            </h5>
<p id="section-3.1.4.5-1">The RP sends a token request using the authorization grant to a token endpoint to obtain a token response containing an access token, ID Token, and an <span class="bcp14">OPTIONAL</span> refresh token. The RP <span class="bcp14">MUST</span> validate the token response. This process is described in Section 3.1.3.5 <span>[<a class="cite xref" href="#OIDCC">OIDCC</a>]</span>.<a class="pilcrow" href="#section-3.1.4.5-1">¶</a></p>
</section>
</div>
<div id="user-info">
<section id="section-3.1.4.6">
            <h5 id="name-delivery-of-user-informatio">
<a class="section-number selfRef" href="#section-3.1.4.6">3.1.4.6. </a><a class="section-name selfRef" href="#name-delivery-of-user-informatio">Delivery of User Information</a>
            </h5>
<p id="section-3.1.4.6-1">The set of claims can be retrieved by sending a request to a UserInfo Endpoint using the access token. The claims are returned in the ID Token. The process of retrieving claims from a UserInfo Endpoint is described in Section 5.3 of <span>[<a class="cite xref" href="#OIDCC">OIDCC</a>]</span>.<a class="pilcrow" href="#section-3.1.4.6-1">¶</a></p>
<p id="section-3.1.4.6-2">OpenID Connect specifies a set of standard claims in Section 5.1 of <span>[<a class="cite xref" href="#OIDCC">OIDCC</a>]</span>. Additional claims for RDAP are described in <a class="auto internal xref" href="#rdap-claims">Section 3.1.5</a>.<a class="pilcrow" href="#section-3.1.4.6-2">¶</a></p>
</section>
</div>
</section>
</div>
<div id="rdap-claims">
<section id="section-3.1.5">
          <h4 id="name-specialized-claims-and-auth">
<a class="section-number selfRef" href="#section-3.1.5">3.1.5. </a><a class="section-name selfRef" href="#name-specialized-claims-and-auth">Specialized Claims and Authorization Scope for RDAP</a>
          </h4>
<p id="section-3.1.5-1">OpenID Connect claims are pieces of information used to make assertions about an entity. Section 5 of <span>[<a class="cite xref" href="#OIDCC">OIDCC</a>]</span> describes a set of standard claims. Section 5.1.2 of <span>[<a class="cite xref" href="#OIDCC">OIDCC</a>]</span> notes that additional claims <span class="bcp14">MAY</span> be used, and it describes a method to create them. The set of claims that are specific to RDAP are associated with an OAuth scope request parameter value (see <span><a class="relref" href="https://rfc-editor.org/rfc/rfc6749#section-3.3">Section 3.3</a> of [<a class="cite xref" href="#RFC6749">RFC6749</a>]</span>) of "rdap".<a class="pilcrow" href="#section-3.1.5-1">¶</a></p>
<div id="stated-purposes">
<section id="section-3.1.5.1">
            <h5 id="name-stated-purposes">
<a class="section-number selfRef" href="#section-3.1.5.1">3.1.5.1. </a><a class="section-name selfRef" href="#name-stated-purposes">Stated Purposes</a>
            </h5>
<p id="section-3.1.5.1-1">Communities of RDAP users and operators may wish to make and validate claims about a user's "need to know" when it comes to requesting access to a protected resource. For example, a law enforcement agent or a trademark attorney may wish to be able to assert that they have a legal right to access a protected resource, and a server operator may need to be able to receive and validate that claim. These needs can be met by defining and using an additional "rdap_allowed_purposes" claim.<a class="pilcrow" href="#section-3.1.5.1-1">¶</a></p>
<p id="section-3.1.5.1-2">The "rdap_allowed_purposes" claim identifies the purposes for which access to a protected resource can be requested by an end user. Use of the "rdap_allowed_purposes" claim is <span class="bcp14">OPTIONAL</span>; processing of this claim is subject to server acceptance of the purposes, the trust level assigned to this claim by the server, and successful authentication of the end user. Unrecognized purpose values <span class="bcp14">MUST</span> be ignored, and the associated query <span class="bcp14">MUST</span> be processed as if the unrecognized purpose value was not present at all. See <a class="auto internal xref" href="#purpose-registry">Section 9.3</a> for a description of the IANA considerations associated with this claim.<a class="pilcrow" href="#section-3.1.5.1-2">¶</a></p>
<p id="section-3.1.5.1-3">The "rdap_allowed_purposes" claim is represented as an array of case-sensitive StringOrURI values as specified in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc7519#section-2">Section 2</a> of [<a class="cite xref" href="#RFC7519">RFC7519</a>]</span>. An example:<a class="pilcrow" href="#section-3.1.5.1-3">¶</a></p>
<p id="section-3.1.5.1-4">"rdap_allowed_purposes": ["domainNameControl","dnsTransparency"]<a class="pilcrow" href="#section-3.1.5.1-4">¶</a></p>
<p id="section-3.1.5.1-5">Purpose values are assigned to an end user's credential by an identity provider. Identity providers <span class="bcp14">MUST</span> ensure that appropriate purpose values are only assigned to end user identities that are authorized to use them.<a class="pilcrow" href="#section-3.1.5.1-5">¶</a></p>
</section>
</div>
<div id="rdap_dnt_allowed">
<section id="section-3.1.5.2">
            <h5 id="name-do-not-track">
<a class="section-number selfRef" href="#section-3.1.5.2">3.1.5.2. </a><a class="section-name selfRef" href="#name-do-not-track">Do Not Track</a>
            </h5>
<p id="section-3.1.5.2-1">Communities of RDAP users and operators may wish to make and validate claims about a user's wish to not have their queries logged, tracked, or recorded. For example, a law enforcement agent may wish to assert that their queries are part of a criminal investigation and should not be tracked due to a risk of query exposure compromising the investigation, and a server operator may need to be able to receive and validate that claim. These needs can be met by defining and using an additional "do not track" claim.<a class="pilcrow" href="#section-3.1.5.2-1">¶</a></p>
<p id="section-3.1.5.2-2">The "do not track" ("rdap_dnt_allowed") claim can be used to identify an end user that is authorized to perform queries without the end user's association with those queries being logged, tracked, or recorded by the server. Client use of the "rdap_dnt_allowed" claim is <span class="bcp14">OPTIONAL</span>. Server operators <span class="bcp14">MUST NOT</span> log, track, or record any association of the query and the end user's identity if the end user is successfully identified and authorized, if the "rdap_dnt_allowed" claim is present, if the value of the claim is "true", and if accepting the claim complies with local regulations regarding logging and tracking.<a class="pilcrow" href="#section-3.1.5.2-2">¶</a></p>
<p id="section-3.1.5.2-3">The "rdap_dnt_allowed" value is represented as a JSON boolean literal. An example:<a class="pilcrow" href="#section-3.1.5.2-3">¶</a></p>
<p id="section-3.1.5.2-4">rdap_dnt_allowed: true<a class="pilcrow" href="#section-3.1.5.2-4">¶</a></p>
<p id="section-3.1.5.2-5">No special query tracking processing is required if this claim is not present or if the value of the claim is "false". Use of this claim <span class="bcp14">MUST</span> be limited to end users who are granted "do not track" privileges in accordance with service policies and regulations. Specification of these policies and regulations is beyond the scope of this document.<a class="pilcrow" href="#section-3.1.5.2-5">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="protocol-common">
<section id="section-4">
      <h2 id="name-common-protocol-features">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-common-protocol-features">Common Protocol Features</a>
      </h2>
<p id="section-4-1">As described in <a class="auto internal xref" href="#discovery">Section 3.1.4.1</a>, an RDAP server <span class="bcp14">MUST</span> provide information about its capabilities and supported OPs in a "help" query response. This specification describes a new "farv1_openidcConfiguration" data structure that describes the OpenID Connect configuration and related extension features supported by the RDAP server. This data structure is returned to all client types.<a class="pilcrow" href="#section-4-1">¶</a></p>
<div id="openidcConfiguration">
<section id="section-4.1">
        <h3 id="name-openid-connect-configuratio">
<a class="section-number selfRef" href="#section-4.1">4.1. </a><a class="section-name selfRef" href="#name-openid-connect-configuratio">OpenID Connect Configuration</a>
        </h3>
<p id="section-4.1-1">The "farv1_openidcConfiguration" data structure is an object with
        the following members:<a class="pilcrow" href="#section-4.1-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.1-2">
          <dt id="section-4.1-2.1">"sessionClientSupported":</dt>
          <dd id="section-4.1-2.2" style="margin-left: 1.5em">(<span class="bcp14">REQUIRED</span>) a boolean value that describes RDAP
     server support for session-oriented clients (see <a class="auto internal xref" href="#client-cons">Section 3.1.2</a>).<a class="pilcrow" href="#section-4.1-2.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-2.3">"tokenClientSupported":</dt>
          <dd id="section-4.1-2.4" style="margin-left: 1.5em">(<span class="bcp14">REQUIRED</span>) a boolean value that describes RDAP
     server support for token-oriented clients (see <a class="auto internal xref" href="#client-cons">Section 3.1.2</a>).<a class="pilcrow" href="#section-4.1-2.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-2.5">"dntSupported":</dt>
          <dd id="section-4.1-2.6" style="margin-left: 1.5em">(<span class="bcp14">REQUIRED</span>) a boolean value that describes RDAP
     server support for the "farv1_dnt" query parameter (see <a class="auto internal xref" href="#rdap-do-not-track">Section 4.2.2</a>).<a class="pilcrow" href="#section-4.1-2.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-2.7">"providerDiscoverySupported":</dt>
          <dd id="section-4.1-2.8" style="margin-left: 1.5em">(<span class="bcp14">OPTIONAL</span>) a boolean value that describes RDAP
     server support for discovery of providers of end-user
     identifiers. The default value is "true".<a class="pilcrow" href="#section-4.1-2.8">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-2.9">"issuerIdentifierSupported":</dt>
          <dd id="section-4.1-2.10" style="margin-left: 1.5em">(<span class="bcp14">OPTIONAL</span>) a boolean value that describes RDAP
     server support for explicit client specification of an Issuer
     Identifier. The default value is "true".<a class="pilcrow" href="#section-4.1-2.10">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-2.11">"implicitTokenRefreshSupported":</dt>
          <dd id="section-4.1-2.12" style="margin-left: 1.5em">(<span class="bcp14">OPTIONAL</span>) a boolean value that describes RDAP
     server support for implicit token refresh. The default value is
     "false".<a class="pilcrow" href="#section-4.1-2.12">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-2.13">"openidcProviders":</dt>
          <dd id="section-4.1-2.14" style="margin-left: 1.5em">
            <p id="section-4.1-2.14.1">(<span class="bcp14">OPTIONAL</span>) a list of objects with the
     following members that describes the set of OPs that are supported
     by the RDAP server. This data is <span class="bcp14">RECOMMENDED</span> if the
     value of issuerIdentifierSupported is "true":<a class="pilcrow" href="#section-4.1-2.14.1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.1-2.14.2">
              <dt id="section-4.1-2.14.2.1">"iss":</dt>
              <dd id="section-4.1-2.14.2.2" style="margin-left: 1.5em">(<span class="bcp14">REQUIRED</span>) a URI value that represents the
 Issuer Identifier of the OP as per the OpenID Connect Core
 specification <span>[<a class="cite xref" href="#OIDCC">OIDCC</a>]</span>.<a class="pilcrow" href="#section-4.1-2.14.2.2">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-4.1-2.14.2.3">"name":</dt>
              <dd id="section-4.1-2.14.2.4" style="margin-left: 1.5em">(<span class="bcp14">REQUIRED</span>) a string value representing the
 human-friendly name of the OP.<a class="pilcrow" href="#section-4.1-2.14.2.4">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-4.1-2.14.2.5">"default":</dt>
              <dd id="section-4.1-2.14.2.6" style="margin-left: 1.5em">(<span class="bcp14">OPTIONAL</span>) a boolean value that describes
 RDAP server support for an <span class="bcp14">OPTIONAL</span> default OP
 that will be used when a client omits the "farv1_id" and
 "farv1_iss" query parameters from a "farv1_session/login"
 request. Only one member of this set can be identified as the
 default OP by setting a value of "true". The default value is
 "false".<a class="pilcrow" href="#section-4.1-2.14.2.6">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-4.1-2.14.2.7">"additionalAuthorizationQueryParams":</dt>
              <dd id="section-4.1-2.14.2.8" style="margin-left: 1.5em">(<span class="bcp14">OPTIONAL</span>) an object where each member
                represents an OAuth authorization request parameter name-value
                pair supported by the OP. The name represents an OAuth query
                parameter, and the value is the query parameter value. A
                token-oriented RDAP client <span class="bcp14">SHOULD</span> add these
                query parameters and their corresponding values to the
                Authentication Request URL when requesting authorization by a
                specified OP through a proxy OP.<a class="pilcrow" href="#section-4.1-2.14.2.8">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.1-3">An RDAP server <span class="bcp14">MUST</span> set either the "sessionClientSupported" or the "tokenClientSupported" value to "true". Both values <span class="bcp14">MAY</span> be set to "true" if an RDAP server supports both types of clients.<a class="pilcrow" href="#section-4.1-3">¶</a></p>
<p id="section-4.1-4">The "providerDiscoverySupported" value has a direct impact on the use of the "farv1_id" query parameter described in Sections <a class="auto internal xref" href="#auth-request">3.1.4.2</a> and <a class="auto internal xref" href="#end-user-identifier">5.2.1</a>. The value of "providerDiscoverySupported" <span class="bcp14">MUST</span> be "true" for an RDAP server to properly accept and process "farv1_id" query parameters. Similarly, the "issuerIdentifierSupported" value has a direct impact on the use of the "farv1_iss" query parameter described in <a class="auto internal xref" href="#issuer-identifier">Section 5.2.2</a>. The value of "issuerIdentifierSupported" <span class="bcp14">MUST</span> be "true" for an RDAP server to properly accept and process "farv1_iss" query parameters.<a class="pilcrow" href="#section-4.1-4">¶</a></p>
<p class="keepWithNext" id="section-4.1-5">An example of a "farv1_openidcConfiguration" data structure:<a class="pilcrow" href="#section-4.1-5">¶</a></p>
<div id="example_openidcConfiguration_structure">
<figure id="figure-3">
          <div class="alignLeft art-text artwork" id="section-4.1-6.1">
<pre>"farv1_openidcConfiguration": {
  "sessionClientSupported": true,
  "tokenClientSupported": true,
  "dntSupported": false,
  "providerDiscoverySupported": true,
  "issuerIdentifierSupported": true,
  "openidcProviders":
    [
      {
        "iss": "https://idp.example.com",
        "name": "Example IDP"
      },
      {
        "iss": "https://accounts.example.net",
        "name": "Login with EXAMPLE",
        "additionalAuthorizationQueryParams": {
          "kc_idp_hint": "examplePublicIDP"
        }
      },
      {
        "iss": "https://auth.nic.example/auth/realms/rdap",
        "name": "Default OP for the Example RDAP server",
        "default": true
      }
    ]
}</pre>
</div>
<figcaption><a class="selfRef" href="#figure-3">Figure 3</a></figcaption></figure>
</div>
</section>
</div>
<div id="rdap-query-parameters">
<section id="section-4.2">
        <h3 id="name-rdap-query-parameters">
<a class="section-number selfRef" href="#section-4.2">4.2. </a><a class="section-name selfRef" href="#name-rdap-query-parameters">RDAP Query Parameters</a>
        </h3>
<p id="section-4.2-1">This specification describes two <span class="bcp14">OPTIONAL</span> query parameters for use with RDAP queries that request access to information associated with protected resources:<a class="pilcrow" href="#section-4.2-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.2-2">
          <dt id="section-4.2-2.1">"farv1_qp":</dt>
          <dd id="section-4.2-2.2" style="margin-left: 1.5em">A query parameter to identify the purpose of the query.<a class="pilcrow" href="#section-4.2-2.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-2.3">"farv1_dnt":</dt>
          <dd id="section-4.2-2.4" style="margin-left: 1.5em">A query parameter to request that the server not log or
   otherwise record information about the identity associated with a
   query.<a class="pilcrow" href="#section-4.2-2.4">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.2-3">One or both parameters <span class="bcp14">MAY</span> be added to an RDAP request URI using the syntax described in Section "application/x-www-form-urlencoded" of <span>[<a class="cite xref" href="#HTMLURL">HTMLURL</a>]</span>.<a class="pilcrow" href="#section-4.2-3">¶</a></p>
<div id="rdap-query-purpose">
<section id="section-4.2.1">
          <h4 id="name-rdap-query-purpose">
<a class="section-number selfRef" href="#section-4.2.1">4.2.1. </a><a class="section-name selfRef" href="#name-rdap-query-purpose">RDAP Query Purpose</a>
          </h4>
<p id="section-4.2.1-1">This query is represented as a "key=value" pair using a key value of "farv1_qp" and a value component that contains a single query purpose string from the set of allowed purposes associated with the end user's identity (see <a class="auto internal xref" href="#stated-purposes">Section 3.1.5.1</a>). If present, the server <span class="bcp14">SHOULD</span> compare the value of the parameter to the "rdap_allowed_purposes" claim values associated with the end user's identity and ensure that the requested purpose is present in the set of allowed purposes. The RDAP server <span class="bcp14">MAY</span> choose to ignore both the requested purpose and the "rdap_allowed_purposes" claim values if they are inconsistent with local server policy. The server <span class="bcp14">MUST</span> return an HTTP 403 (Forbidden) response if the requested purpose is not an allowed purpose. If the "farv1_qp" parameter is not present, the server <span class="bcp14">MUST</span> process the query and make an access control decision based on any other information known to the server about the end user and the information they are requesting. For example, a server <span class="bcp14">MAY</span> treat the request as one performed by an unidentified or unauthenticated user and return either an error or an appropriate subset of the available data. An example domain query using the "farv1_qp" query parameter:<a class="pilcrow" href="#section-4.2.1-1">¶</a></p>
<div id="example_farv1_qp">
<figure id="figure-4">
            <div class="alignLeft art-text artwork" id="section-4.2.1-2.1">
<pre>https://example.com/rdap/domain/example.com?farv1_qp=legalActions
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-4">Figure 4</a></figcaption></figure>
</div>
</section>
</div>
<div id="rdap-do-not-track">
<section id="section-4.2.2">
          <h4 id="name-rdap-do-not-track">
<a class="section-number selfRef" href="#section-4.2.2">4.2.2. </a><a class="section-name selfRef" href="#name-rdap-do-not-track">RDAP Do Not Track</a>
          </h4>
<p id="section-4.2.2-1">This query is represented as a "key=value" pair using a key value of "farv1_dnt" and a value component that contains a single boolean value. A value of "true" indicates that the end user is requesting that their query is not tracked or logged in accordance with server policy. A value of "false" indicates that the end user is accepting that their query can be tracked or logged in accordance with server policy. The server <span class="bcp14">MUST</span> return an HTTP 403 (Forbidden) response if the server is unable to perform the action requested by this query parameter. An example domain query using the "farv1_dnt" query parameter:<a class="pilcrow" href="#section-4.2.2-1">¶</a></p>
<div id="example_farv1_dnt">
<figure id="figure-5">
            <div class="alignLeft art-text artwork" id="section-4.2.2-2.1">
<pre>https://example.com/rdap/domain/example.com?farv1_dnt=true
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-5">Figure 5</a></figcaption></figure>
</div>
</section>
</div>
<div id="parameter-processing">
<section id="section-4.2.3">
          <h4 id="name-parameter-processing">
<a class="section-number selfRef" href="#section-4.2.3">4.2.3. </a><a class="section-name selfRef" href="#name-parameter-processing">Parameter Processing</a>
          </h4>
<p id="section-4.2.3-1">Unrecognized query parameters <span class="bcp14">MUST</span> be ignored. An RDAP server that processes an authenticated query <span class="bcp14">MUST</span> determine if the end-user identification information is associated with an OP that is recognized and supported by the server. RDAP servers <span class="bcp14">MUST</span> reject queries that include identification information that is not associated with a supported OP by returning an HTTP 400 (Bad Request) response. An RDAP server that receives a query containing identification information associated with a recognized OP <span class="bcp14">MUST</span> perform the steps required to authenticate the user with the OP, process the query, and return an RDAP response that is appropriate for the end user's level of authorization and access.<a class="pilcrow" href="#section-4.2.3-1">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="protocol">
<section id="section-5">
      <h2 id="name-protocol-features-for-sessi">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-protocol-features-for-sessi">Protocol Features for Session-Oriented Clients</a>
      </h2>
<p id="section-5-1">This specification adds the following features to RDAP that are commonly used by session-oriented clients:<a class="pilcrow" href="#section-5-1">¶</a></p>
<ol class="normal type-1" id="section-5-2" start="1" type="1">
<li id="section-5-2.1">
          <p id="section-5-2.1.1">Data structures to return information that describes an established session and the information needed to establish a session for a UI-constrained device.<a class="pilcrow" href="#section-5-2.1.1">¶</a></p>
</li>
        <li id="section-5-2.2">
          <p id="section-5-2.2.1">A query parameter to request authentication for a specific end-user identity.<a class="pilcrow" href="#section-5-2.2.1">¶</a></p>
</li>
        <li id="section-5-2.3">
          <p id="section-5-2.3.1">A query parameter to support authentication for a specific end-user identity on a device with a constrained user interface.<a class="pilcrow" href="#section-5-2.3.1">¶</a></p>
</li>
        <li id="section-5-2.4">
          <p id="section-5-2.4.1">A query parameter to identify the purpose of the query.<a class="pilcrow" href="#section-5-2.4.1">¶</a></p>
</li>
        <li id="section-5-2.5">
          <p id="section-5-2.5.1">A query parameter to request that the server not log or otherwise record information about the identity associated with a query.<a class="pilcrow" href="#section-5-2.5.1">¶</a></p>
</li>
        <li id="section-5-2.6">
          <p id="section-5-2.6.1">Path segments to start, stop, refresh, and determine the status of an authenticated session for a specific end-user identity.<a class="pilcrow" href="#section-5-2.6.1">¶</a></p>
</li>
      </ol>
<div id="data-structures">
<section id="section-5.1">
        <h3 id="name-data-structures">
<a class="section-number selfRef" href="#section-5.1">5.1. </a><a class="section-name selfRef" href="#name-data-structures">Data Structures</a>
        </h3>
<p id="section-5.1-1">This specification describes two new data structures that are used to return information to a session-oriented client:<a class="pilcrow" href="#section-5.1-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.1-2">
          <dt id="section-5.1-2.1">"farv1_session":</dt>
          <dd id="section-5.1-2.2" style="margin-left: 1.5em">A data structure that contains information that describes an established session.<a class="pilcrow" href="#section-5.1-2.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-2.3">"farv1_deviceInfo":</dt>
          <dd id="section-5.1-2.4" style="margin-left: 1.5em">A data structure that contains information that describes an
   active attempt to establish a session on a UI-constrained
   device.<a class="pilcrow" href="#section-5.1-2.4">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<div id="session">
<section id="section-5.1.1">
          <h4 id="name-session">
<a class="section-number selfRef" href="#section-5.1.1">5.1.1. </a><a class="section-name selfRef" href="#name-session">Session</a>
          </h4>
<p id="section-5.1.1-1">The "farv1_session" data structure is an object that contains the following members:<a class="pilcrow" href="#section-5.1.1-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.1.1-2">
            <dt id="section-5.1.1-2.1">"userID":</dt>
            <dd id="section-5.1.1-2.2" style="margin-left: 1.5em">an <span class="bcp14">OPTIONAL</span> string value that represents the
     end-user identifier associated with the session.<a class="pilcrow" href="#section-5.1.1-2.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.1.1-2.3">"iss":</dt>
            <dd id="section-5.1.1-2.4" style="margin-left: 1.5em">an <span class="bcp14">OPTIONAL</span> URI value that represents the
     issuer of the end-user identifier associated with the
     session.<a class="pilcrow" href="#section-5.1.1-2.4">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.1.1-2.5">"userClaims":</dt>
            <dd id="section-5.1.1-2.6" style="margin-left: 1.5em">an <span class="bcp14">OPTIONAL</span> object that contains the set of
     claims associated with the end user's identity based on the user
     information provided by the OP as described in <a class="auto internal xref" href="#user-info">Section 3.1.4.6</a> and processed by the RDAP server in the
     authentication and authorization process. The set of possible
     values is determined by OP policy and RDAP server policy.<a class="pilcrow" href="#section-5.1.1-2.6">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.1.1-2.7">"sessionInfo":</dt>
            <dd id="section-5.1.1-2.8" style="margin-left: 1.5em">
              <p id="section-5.1.1-2.8.1">an <span class="bcp14">OPTIONAL</span> object that contains two members:<a class="pilcrow" href="#section-5.1.1-2.8.1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.1.1-2.8.2">
                <dt id="section-5.1.1-2.8.2.1">"tokenExpiration":</dt>
                <dd id="section-5.1.1-2.8.2.2" style="margin-left: 1.5em">an integer value that represents the number of seconds
 that remain in the lifetime of the access token.<a class="pilcrow" href="#section-5.1.1-2.8.2.2">¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-5.1.1-2.8.2.3">"tokenRefresh":</dt>
                <dd id="section-5.1.1-2.8.2.4" style="margin-left: 1.5em">a boolean value that indicates if the OP supports refresh
 tokens. As described in <span>[<a class="cite xref" href="#RFC6749">RFC6749</a>]</span>, support for
 refresh tokens is <span class="bcp14">OPTIONAL</span>.<a class="pilcrow" href="#section-5.1.1-2.8.2.4">¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-5.1.1-3">Note that all of the members of the "farv1_session" data structure are <span class="bcp14">OPTIONAL</span>. See <a class="auto internal xref" href="#login-response">Section 5.2.3</a> for instructions describing when to return the minimum set of members.<a class="pilcrow" href="#section-5.1.1-3">¶</a></p>
<p class="keepWithNext" id="section-5.1.1-4">An example of a "farv1_session" data structure:<a class="pilcrow" href="#section-5.1.1-4">¶</a></p>
<div id="example_session_structure">
<figure id="figure-6">
            <div class="alignLeft art-text artwork" id="section-5.1.1-5.1">
<pre>  "farv1_session": {
    "userID": "user.idp.example",
    "iss": "https://idp.example.com",
    "userClaims": {
      "sub": "103892603076825016132",
      "name": "User Person",
      "given_name": "User",
      "family_name": "Person",
      "picture": "https://lh3.example.com/a-/AOh14=s96-c",
      "email": "user@example.com",
      "email_verified": true,
      "locale": "en",
      "rdap_allowed_purposes": [
        "domainNameControl",
        "personalDataProtection"
      ],
      "rdap_dnt_allowed": false
    },
    "sessionInfo": {
      "tokenExpiration": 3599,
      "tokenRefresh": true
    }
  }</pre>
</div>
<figcaption><a class="selfRef" href="#figure-6">Figure 6</a></figcaption></figure>
</div>
</section>
</div>
<div id="deviceInfo">
<section id="section-5.1.2">
          <h4 id="name-device-info">
<a class="section-number selfRef" href="#section-5.1.2">5.1.2. </a><a class="section-name selfRef" href="#name-device-info">Device Info</a>
          </h4>
<p id="section-5.1.2-1">The flow described in <a class="auto internal xref" href="#process">Section 3.1.4</a> requires an end user to interact with a server using a user interface that can process HTTP. This will not work well in situations where the client is automated or an end user is using a command-line user interface such as <a href="https://curl.se/">curl</a> or <a href="https://www.gnu.org/software/wget/">wget</a>. This limitation can be addressed using a web browser on a second device. The information that needs to be entered using the web browser is contained in the "farv1_deviceInfo" data structure, an object that contains members as described in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8628#section-3.2">Section 3.2</a> of [<a class="cite xref" href="#RFC8628">RFC8628</a>]</span>.<a class="pilcrow" href="#section-5.1.2-1">¶</a></p>
<p class="keepWithNext" id="section-5.1.2-2">An example of a "farv1_deviceInfo" data structure:<a class="pilcrow" href="#section-5.1.2-2">¶</a></p>
<div id="example_deviceInfo_structure">
<figure id="figure-7">
            <div class="alignLeft art-text artwork" id="section-5.1.2-3.1">
<pre>  "farv1_deviceInfo": {
    "device_code": "AH-1ng2ezu",
    "user_code": "NJJQ-GJFC",
    "verification_uri": "https://www.example.com/device",
    "verification_uri_complete":
       "https://www.example.com/device?user_code=NJJQ-GJFC",
    "expires_in": 1800,
    "interval": 5
  }</pre>
</div>
<figcaption><a class="selfRef" href="#figure-7">Figure 7</a></figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="client-login">
<section id="section-5.2">
        <h3 id="name-client-login">
<a class="section-number selfRef" href="#section-5.2">5.2. </a><a class="section-name selfRef" href="#name-client-login">Client Login</a>
        </h3>
<p id="section-5.2-1">Client authentication is requested by sending a "farv1_session/login" request to an RDAP server. If the RDAP server supports only remote OPs, the "farv1_session/login" request <span class="bcp14">MUST</span> include at least one end-user identifier or OP Issuer Identifier.<a class="pilcrow" href="#section-5.2-1">¶</a></p>
<p id="section-5.2-2">The server sets an HTTP cookie as described in <span>[<a class="cite xref" href="#RFC6265">RFC6265</a>]</span> when the "farv1_session/login" request is received and processed successfully. The client <span class="bcp14">MUST</span> include the session cookie received from the server in any RDAP request within the scope of that session, including "farv1_session/refresh", "farv1_session/status", and "farv1_session/logout". A "farv1_session/login" followed by another "farv1_session/login" that does not include an HTTP cookie <span class="bcp14">MUST</span> start a new session on the server that includes a new cookie. A server that receives a "farv1_session/login" followed by another "farv1_session/login" that includes an HTTP cookie <span class="bcp14">MUST</span> return an HTTP 409 (Conflict) response.<a class="pilcrow" href="#section-5.2-2">¶</a></p>
<p id="section-5.2-3">To help reduce the risk of resource starvation, a server <span class="bcp14">MAY</span> reject a "farv1_session/login" request and refuse to start a new session by returning an HTTP 409 (Conflict) response if a server-side maximum number of concurrent sessions per user exists and the client exceeds that limit. Additionally, an active session <span class="bcp14">MAY</span> be removed by the server due to timeout expiration or because a maximum session lifetime has been exceeded. Clients <span class="bcp14">SHOULD</span> proactively monitor the "tokenExpiration" value associated with an active session and refresh the session as appropriate to provide a positive user experience.<a class="pilcrow" href="#section-5.2-3">¶</a></p>
<div id="end-user-identifier">
<section id="section-5.2.1">
          <h4 id="name-end-user-identifier">
<a class="section-number selfRef" href="#section-5.2.1">5.2.1. </a><a class="section-name selfRef" href="#name-end-user-identifier">End-User Identifier</a>
          </h4>
<p id="section-5.2.1-1">The end-user identifier is delivered using one of two methods: by adding a query component to an RDAP request URI using the syntax described in Section "application/x-www-form-urlencoded" of <span>[<a class="cite xref" href="#HTMLURL">HTMLURL</a>]</span> or by including an HTTP "authorization" request header for the Basic authentication scheme as described in <span>[<a class="cite xref" href="#RFC7617">RFC7617</a>]</span>. Clients can use either of these methods to deliver the end-user identifier to a server that supports remote OPs and provider discovery. Servers that support remote OPs and provider discovery <span class="bcp14">MUST</span> accept both methods. If the RDAP server supports a default OP or if provider discovery is not supported, the end-user identifier <span class="bcp14">MAY</span> be omitted.<a class="pilcrow" href="#section-5.2.1-1">¶</a></p>
<p id="section-5.2.1-2">The query parameter used to deliver the end-user identifier is represented as an <span class="bcp14">OPTIONAL</span> "key=value" pair using a key value of "farv1_id" and a value component that contains the client identifier issued by an OP. An example for client identifier "user.idp.example":<a class="pilcrow" href="#section-5.2.1-2">¶</a></p>
<div id="example_client_identifier">
<figure id="figure-8">
            <div class="alignLeft art-text artwork" id="section-5.2.1-3.1">
<pre>========== NOTE: '\' line wrapping per RFC 8792 ===========
https://example.com/rdap/farv1_session/\
login?farv1_id=user.idp.example</pre>
</div>
<figcaption><a class="selfRef" href="#figure-8">Figure 8</a></figcaption></figure>
</div>
<p id="section-5.2.1-4">The authorization header for the Basic authentication scheme contains a base64-encoded representation of the client identifier issued by an OP. No password is provided. An example for client identifier "user.idp.example":<a class="pilcrow" href="#section-5.2.1-4">¶</a></p>
<div id="example_base64">
<figure id="figure-9">
            <div class="alignLeft art-text artwork" id="section-5.2.1-5.1">
<pre>https://example.com/rdap/farv1_session/login
Authorization: Basic dXNlci5pZHAuZXhhbXBsZQ==
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-9">Figure 9</a></figcaption></figure>
</div>
<p id="section-5.2.1-6">An example for use with a default OP:<a class="pilcrow" href="#section-5.2.1-6">¶</a></p>
<div id="example_default_op">
<figure id="figure-10">
            <div class="alignLeft art-text artwork" id="section-5.2.1-7.1">
<pre>https://example.com/rdap/farv1_session/login
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-10">Figure 10</a></figcaption></figure>
</div>
</section>
</div>
<div id="issuer-identifier">
<section id="section-5.2.2">
          <h4 id="name-op-issuer-identifier">
<a class="section-number selfRef" href="#section-5.2.2">5.2.2. </a><a class="section-name selfRef" href="#name-op-issuer-identifier">OP Issuer Identifier</a>
          </h4>
<p id="section-5.2.2-1">The OP's Issuer Identifier is delivered by adding a query component to an RDAP request URI using the syntax described in Section "application/x-www-form-urlencoded" of <span>[<a class="cite xref" href="#HTMLURL">HTMLURL</a>]</span>. If the RDAP server supports a default OP, the Issuer Identifier <span class="bcp14">MAY</span> be omitted.<a class="pilcrow" href="#section-5.2.2-1">¶</a></p>
<p id="section-5.2.2-2">The query parameter used to deliver the OP's Issuer Identifier is represented as an <span class="bcp14">OPTIONAL</span> "key=value" pair using a key value of "farv1_iss" and a value component that contains the Issuer Identifier associated with an OP. An RDAP server <span class="bcp14">MAY</span> accept Issuer Identifiers not specified in the "farv1_openidcConfiguration" data structure and <span class="bcp14">MAY</span> also decide to accept specific Issuer Identifiers only from specific clients. An example for Issuer Identifier "https://idp.example.com":<a class="pilcrow" href="#section-5.2.2-2">¶</a></p>
<div id="example_issuer_identifier">
<figure id="figure-11">
            <div class="alignLeft art-text artwork" id="section-5.2.2-3.1">
<pre>========== NOTE: '\' line wrapping per RFC 8792 ===========
https://example.com/rdap/farv1_session/\
login?farv1_iss=https://idp.example.com</pre>
</div>
<figcaption><a class="selfRef" href="#figure-11">Figure 11</a></figcaption></figure>
</div>
</section>
</div>
<div id="login-response">
<section id="section-5.2.3">
          <h4 id="name-login-response">
<a class="section-number selfRef" href="#section-5.2.3">5.2.3. </a><a class="section-name selfRef" href="#name-login-response">Login Response</a>
          </h4>
<p id="section-5.2.3-1">The response to this request <span class="bcp14">MUST</span> be a valid RDAP response per <span>[<a class="cite xref" href="#RFC9083">RFC9083</a>]</span>. It <span class="bcp14">MUST NOT</span> include any members that relate to a specific RDAP object type (e.g., "events" or "status"). In addition, the response <span class="bcp14">MAY</span> include an indication of the requested operation's success or failure in the "notices" data structure. If successful, the response <span class="bcp14">MUST</span> include a "farv1_session" data structure that includes a "sessionInfo" object and an <span class="bcp14">OPTIONAL</span> "userClaims" object. If unsuccessful, the response <span class="bcp14">MUST</span> include a "farv1_session" data structure that omits the "userClaims" and "sessionInfo" objects.<a class="pilcrow" href="#section-5.2.3-1">¶</a></p>
<p class="keepWithNext" id="section-5.2.3-2">An example of a successful "farv1_session/login" response:<a class="pilcrow" href="#section-5.2.3-2">¶</a></p>
<div id="example_login_response">
<figure id="figure-12">
            <div class="alignLeft art-text artwork" id="section-5.2.3-3.1">
<pre>    {
      "rdapConformance": [
        "farv1"
      ],
      "lang": "en-US",
      "notices": [
        {
          "title": "Login Result",
          "description": [
            "Login succeeded"
          ]
        }
      ],
      "farv1_session": {
        "userID": "user.idp.example",
        "iss": "https://idp.example.com",
        "userClaims": {
          "sub": "103892603076825016132",
          "name": "User Person",
          "given_name": "User",
          "family_name": "Person",
          "picture": "https://lh3.example.com/a-/AOh14=s96-c",
          "email": "user@example.com",
          "email_verified": true,
          "locale": "en",
          "rdap_allowed_purposes": [
            "domainNameControl",
            "personalDataProtection"
          ],
          "rdap_dnt_allowed": false
        },
        "sessionInfo": {
          "tokenExpiration": 3599,
          "tokenRefresh": true
        }
      }
    }</pre>
</div>
<figcaption><a class="selfRef" href="#figure-12">Figure 12</a></figcaption></figure>
</div>
<p class="keepWithNext" id="section-5.2.3-4">An example of a failed "farv1_session/login" response:<a class="pilcrow" href="#section-5.2.3-4">¶</a></p>
<div id="example_failed_login_response">
<figure id="figure-13">
            <div class="alignLeft art-text artwork" id="section-5.2.3-5.1">
<pre>    {
      "rdapConformance": [
        "farv1"
      ],
      "lang": "en-US",
      "notices": [
        {
          "title": "Login Result",
          "description": [
            "Login failed"
          ]
        }
      ],
      "farv1_session": {
        "userID": "user.idp.example",
        "iss": "https://idp.example.com"
      }
    }</pre>
</div>
<figcaption><a class="selfRef" href="#figure-13">Figure 13</a></figcaption></figure>
</div>
</section>
</div>
<div id="ui-constrained">
<section id="section-5.2.4">
          <h4 id="name-clients-with-limited-user-i">
<a class="section-number selfRef" href="#section-5.2.4">5.2.4. </a><a class="section-name selfRef" href="#name-clients-with-limited-user-i">Clients with Limited User Interfaces</a>
          </h4>
<p id="section-5.2.4-1">"<a class="internal xref" href="#RFC8628">OAuth 2.0 Device Authorization Grant</a>" <span>[<a class="cite xref" href="#RFC8628">RFC8628</a>]</span> provides an <span class="bcp14">OPTIONAL</span> method to
          request user authorization from devices that have an Internet
          connection but lack a suitable browser for a more conventional OAuth
          flow. This method requires an end user to use a second device (such
          as a smartphone) that has access to a web browser for entry of a
          code sequence that is presented on the UI-constrained device.<a class="pilcrow" href="#section-5.2.4-1">¶</a></p>
<div id="client-login-device">
<section id="section-5.2.4.1">
            <h5 id="name-ui-constrained-client-login">
<a class="section-number selfRef" href="#section-5.2.4.1">5.2.4.1. </a><a class="section-name selfRef" href="#name-ui-constrained-client-login">UI-Constrained Client Login</a>
            </h5>
<p id="section-5.2.4.1-1">Client authentication is requested by sending a
            "farv1_session/device" request to an RDAP server. If the RDAP
            server supports only remote OPs, the
            "farv1_session/device" request <span class="bcp14">MUST</span> include either
            an end-user identifier as described in <a class="auto internal xref" href="#end-user-identifier">Section 5.2.1</a> or an OP Issuer Identifier as
            described in <a class="auto internal xref" href="#issuer-identifier">Section 5.2.2</a>.<a class="pilcrow" href="#section-5.2.4.1-1">¶</a></p>
<p class="keepWithNext" id="section-5.2.4.1-2">An example using wget for client identifier "user.idp.example":<a class="pilcrow" href="#section-5.2.4.1-2">¶</a></p>
<div id="example_wget1">
<figure id="figure-14">
              <div class="alignLeft art-text artwork" id="section-5.2.4.1-3.1">
<pre>========== NOTE: '\' line wrapping per RFC 8792 ===========
   wget -qO- "https://example.com/rdap/farv1_session/device\
   ?farv1_id=user.idp.example"</pre>
</div>
<figcaption><a class="selfRef" href="#figure-14">Figure 14</a></figcaption></figure>
</div>
<p id="section-5.2.4.1-4">The authorization header for the Basic authentication scheme contains a base64-encoded representation of the client identifier issued by an OP. No password is provided.<a class="pilcrow" href="#section-5.2.4.1-4">¶</a></p>
<p class="keepWithNext" id="section-5.2.4.1-5">An example using curl and an authorization header:<a class="pilcrow" href="#section-5.2.4.1-5">¶</a></p>
<div id="example_curl1">
<figure id="figure-15">
              <div class="alignLeft art-text artwork" id="section-5.2.4.1-6.1">
<pre>========== NOTE: '\' line wrapping per RFC 8792 ===========
   curl -H "Authorization: Basic dXNlci5pZHAuZXhhbXBsZQ=="\
   "https://example.com/rdap/farv1_session/device"</pre>
</div>
<figcaption><a class="selfRef" href="#figure-15">Figure 15</a></figcaption></figure>
</div>
<p id="section-5.2.4.1-7">The response to this request <span class="bcp14">MUST</span> be a valid RDAP response per <span>[<a class="cite xref" href="#RFC9083">RFC9083</a>]</span>. It <span class="bcp14">MUST NOT</span> include any members that relate to a specific RDAP object type (e.g., "events" or "status"). In addition, the response <span class="bcp14">MAY</span> include an indication of the requested operation's success or failure in the "notices" data structure and, if successful, a "farv1_deviceInfo" data structure.<a class="pilcrow" href="#section-5.2.4.1-7">¶</a></p>
<p class="keepWithNext" id="section-5.2.4.1-8">An example of a "farv1_session/device" response:<a class="pilcrow" href="#section-5.2.4.1-8">¶</a></p>
<div id="example_device_login_response">
<figure id="figure-16">
              <div class="alignLeft art-text artwork" id="section-5.2.4.1-9.1">
<pre>  {
    "rdapConformance": [
      "farv1"
    ],
    "lang": "en-US",
    "notices": [
      {
        "title": "Device Login Result",
        "description": [
          "Login succeeded"
        ]
      }
    ],
    "farv1_deviceInfo": {
      "device_code": "AH-1ng2ezu",
      "user_code": "NJJQ-GJFC",
      "verification_uri": "https://www.example.com/device",
      "verification_uri_complete":
              "https://www.example.com/device?user_code=NJJQ-GJFC",
      "expires_in": 1800,
          "interval": 5
    }
  }</pre>
</div>
<figcaption><a class="selfRef" href="#figure-16">Figure 16</a></figcaption></figure>
</div>
</section>
</div>
<div id="client-login-device-poll">
<section id="section-5.2.4.2">
            <h5 id="name-ui-constrained-client-login-">
<a class="section-number selfRef" href="#section-5.2.4.2">5.2.4.2. </a><a class="section-name selfRef" href="#name-ui-constrained-client-login-">UI-Constrained Client Login Polling</a>
            </h5>
<p id="section-5.2.4.2-1">After successful processing of the "farv1_session/device" request, the client <span class="bcp14">MUST</span> send a "farv1_session/devicepoll" request to the RDAP server to continue the login process. This request initiates the polling function described in <span>[<a class="cite xref" href="#RFC8628">RFC8628</a>]</span> on the RDAP server. The RDAP server polls the OP as described in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8628#section-3.4">Section 3.4</a> of [<a class="cite xref" href="#RFC8628">RFC8628</a>]</span>, allowing the RDAP server to wait for the end user to enter the information returned from the "farv1_session/device" request using the interface on their second device. After the end user has completed that process, or if the process fails or times out, the OP will respond to the polling requests with an indication of success or failure. If the RDAP server supports only remote OPs, the "farv1_session/devicepoll" request <span class="bcp14">MUST</span> include either an end-user identifier as described in <a class="auto internal xref" href="#end-user-identifier">Section 5.2.1</a> or an OP Issuer Identifier as described in <a class="auto internal xref" href="#issuer-identifier">Section 5.2.2</a>.<a class="pilcrow" href="#section-5.2.4.2-1">¶</a></p>
<p id="section-5.2.4.2-2">The "farv1_session/devicepoll" request <span class="bcp14">MUST</span> also include a "farv1_dc" query parameter. The query parameter is represented as an <span class="bcp14">OPTIONAL</span> "key=value" pair using a key value of "farv1_dc" and a value component that contains the value of the device_code that was returned in the response to the "farv1_session/device" request.<a class="pilcrow" href="#section-5.2.4.2-2">¶</a></p>
<p class="keepWithNext" id="section-5.2.4.2-3">An example using wget:<a class="pilcrow" href="#section-5.2.4.2-3">¶</a></p>
<div id="example_wget2">
<figure id="figure-17">
              <div class="alignLeft art-text artwork" id="section-5.2.4.2-4.1">
<pre>========== NOTE: '\' line wrapping per RFC 8792 ===========
   wget -qO- --keep-session-cookies --save-cookies cookie.txt\
   "https://example.com/rdap/farv1_session/devicepoll\
   ?farv1_id=user.idp.example&amp;farv1_dc=AH-1ng2ezu"</pre>
</div>
<figcaption><a class="selfRef" href="#figure-17">Figure 17</a></figcaption></figure>
</div>
<p class="keepWithNext" id="section-5.2.4.2-5">An example using curl:<a class="pilcrow" href="#section-5.2.4.2-5">¶</a></p>
<div id="example_curl2">
<figure id="figure-18">
              <div class="alignLeft art-text artwork" id="section-5.2.4.2-6.1">
<pre>========== NOTE: '\' line wrapping per RFC 8792 ===========
   curl -c cookie.txt "https://example.com/rdap/farv1_session/\
   devicepoll?farv1_id=user.idp.example&amp;farv1_dc=AH-1ng2ezu"</pre>
</div>
<figcaption><a class="selfRef" href="#figure-18">Figure 18</a></figcaption></figure>
</div>
<p id="section-5.2.4.2-7">The response to this request <span class="bcp14">MUST</span> use the response structures described in <a class="auto internal xref" href="#client-login">Section 5.2</a>. RDAP query processing can continue normally on the UI-constrained device once the device polling process has been completed successfully.<a class="pilcrow" href="#section-5.2.4.2-7">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="session-status">
<section id="section-5.3">
        <h3 id="name-session-status">
<a class="section-number selfRef" href="#section-5.3">5.3. </a><a class="section-name selfRef" href="#name-session-status">Session Status</a>
        </h3>
<p id="section-5.3-1">Clients <span class="bcp14">MAY</span> send a query to an RDAP server to determine the status of an existing login session using a "farv1_session/status" path segment. An example "farv1_session/status" request:<a class="pilcrow" href="#section-5.3-1">¶</a></p>
<div id="example_session_status">
<figure id="figure-19">
          <div class="alignLeft art-text artwork" id="section-5.3-2.1">
<pre>https://example.com/rdap/farv1_session/status
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-19">Figure 19</a></figcaption></figure>
</div>
<p id="section-5.3-3">The response to this request <span class="bcp14">MUST</span> be a valid RDAP response per <span>[<a class="cite xref" href="#RFC9083">RFC9083</a>]</span>. It <span class="bcp14">MUST NOT</span> include any members that relate to a specific RDAP object type (e.g., "events" or "status"). In addition, the response <span class="bcp14">MAY</span> include an indication of the requested operation's success or failure in the "notices" data structure. If the operation is successful and an active session exists, the response <span class="bcp14">MUST</span> include a "farv1_session" data structure that includes a "sessionInfo" object and an <span class="bcp14">OPTIONAL</span> "userClaims" object. If the operation is unsuccessful or if no active session exists, the response <span class="bcp14">MUST NOT</span> include a "farv1_session" object.<a class="pilcrow" href="#section-5.3-3">¶</a></p>
<p class="keepWithNext" id="section-5.3-4">An example of a "farv1_session/status" response for an active session:<a class="pilcrow" href="#section-5.3-4">¶</a></p>
<div id="example_session_response_1">
<figure id="figure-20">
          <div class="alignLeft art-text artwork" id="section-5.3-5.1">
<pre>  {
    "rdapConformance": [
      "farv1"
    ],
    "lang": "en-US",
    "notices": [
      {
        "title": "Session Status Result",
        "description": [
          "Session status succeeded"
        ]
      }
    ],
    "farv1_session": {
      "userID": "user.idp.example",
      "iss": "https://idp.example.com",
      "userClaims": {
        "sub": "103892603076825016132",
        "name": "User Person",
        "given_name": "User",
        "family_name": "Person",
        "picture": "https://lh3.example.com/a-/AOh14=s96-c",
        "email": "user@example.com",
        "email_verified": true,
        "locale": "en",
        "rdap_allowed_purposes": [
          "domainNameControl",
          "personalDataProtection"
        ],
        "rdap_dnt_allowed": false
      },
      "sessionInfo": {
        "tokenExpiration": 3490,
        "tokenRefresh": true
      }
    }
  }</pre>
</div>
<figcaption><a class="selfRef" href="#figure-20">Figure 20</a></figcaption></figure>
</div>
<p id="section-5.3-6">If the operation is successful and an active session does not exist, the response <span class="bcp14">MAY</span> note the lack of an active session in the "notices" data structure. The "farv1_session" data structure <span class="bcp14">MUST</span> be omitted.<a class="pilcrow" href="#section-5.3-6">¶</a></p>
<p class="keepWithNext" id="section-5.3-7">An example of a "farv1_session/status" response with no active session:<a class="pilcrow" href="#section-5.3-7">¶</a></p>
<div id="example_session_response_2">
<figure id="figure-21">
          <div class="alignLeft art-text artwork" id="section-5.3-8.1">
<pre>  {
    "rdapConformance": [
      "farv1"
    ],
    "lang": "en-US",
    "notices": [
      {
        "title": "Session Status Result",
        "description": [
          "Session status succeeded",
          "No active session"
        ]
      }
    ]
  }</pre>
</div>
<figcaption><a class="selfRef" href="#figure-21">Figure 21</a></figcaption></figure>
</div>
</section>
</div>
<div id="session-refresh">
<section id="section-5.4">
        <h3 id="name-session-refresh">
<a class="section-number selfRef" href="#section-5.4">5.4. </a><a class="section-name selfRef" href="#name-session-refresh">Session Refresh</a>
        </h3>
<p id="section-5.4-1">Clients <span class="bcp14">MAY</span> send a request to an RDAP server to refresh or extend an existing login session using a "farv1_session/refresh" path segment. The RDAP server <span class="bcp14">MAY</span> attempt to refresh the access token associated with the current session as part of extending the session for a period of time determined by the RDAP server. As described in <span>[<a class="cite xref" href="#RFC6749">RFC6749</a>]</span>, OP support for refresh tokens is <span class="bcp14">OPTIONAL</span>. An RDAP server <span class="bcp14">MUST</span> determine if the OP supports token refresh and process the refresh request by either requesting refresh of the access token or returning a response that indicates that token refresh is not supported by the OP in the "notices" data structure. An example "farv1_session/refresh" request:<a class="pilcrow" href="#section-5.4-1">¶</a></p>
<div id="example_session_refresh">
<figure id="figure-22">
          <div class="alignLeft art-text artwork" id="section-5.4-2.1">
<pre>https://example.com/rdap/farv1_session/refresh
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-22">Figure 22</a></figcaption></figure>
</div>
<p id="section-5.4-3">The response to this request <span class="bcp14">MUST</span> be a valid RDAP response per <span>[<a class="cite xref" href="#RFC9083">RFC9083</a>]</span>. It <span class="bcp14">MUST NOT</span> include any members that relate to a specific RDAP object type (e.g., "events" or "status"). In addition, the response <span class="bcp14">MAY</span> include an indication of the requested operation's success or failure in the "notices" data structure. The response <span class="bcp14">MUST</span> include a "farv1_session" data structure that includes a "sessionInfo" object and an <span class="bcp14">OPTIONAL</span> "userClaims" object. If unsuccessful but an active session exists, the response <span class="bcp14">MUST</span> include a "farv1_session" data structure that includes a "sessionInfo" object and an <span class="bcp14">OPTIONAL</span> "userClaims" object. If unsuccessful and no active session exists, the response <span class="bcp14">MUST</span> omit the "farv1_session" data structure.<a class="pilcrow" href="#section-5.4-3">¶</a></p>
<p class="keepWithNext" id="section-5.4-4">An example of a successful "farv1_session/refresh" response:<a class="pilcrow" href="#section-5.4-4">¶</a></p>
<div id="example_refresh_response">
<figure id="figure-23">
          <div class="alignLeft art-text artwork" id="section-5.4-5.1">
<pre>  {
    "rdapConformance": [
      "farv1"
    ],
    "lang": "en-US",
    "notices": [
      {
        "title": "Session Refresh Result",
        "description": [
          "Session refresh succeeded",
          "Token refresh succeeded."
        ]
      }
    ],
    "farv1_session": {
      "userID": "user.idp.example",
      "iss": "https://idp.example.com",
      "userClaims": {
        "sub": "103892603076825016132",
        "name": "User Person",
        "given_name": "User",
        "family_name": "Person",
        "picture": "https://lh3.example.com/a-/AOh14=s96-c",
        "email": "user@example.com",
        "email_verified": true,
        "locale": "en",
        "rdap_allowed_purposes": [
          "domainNameControl",
          "personalDataProtection"
        ],
        "rdap_dnt_allowed": false
      },
      "sessionInfo": {
        "tokenExpiration": 3599,
        "tokenRefresh": true
      }
    }
  }</pre>
</div>
<figcaption><a class="selfRef" href="#figure-23">Figure 23</a></figcaption></figure>
</div>
<p id="section-5.4-6">Alternatively, an RDAP server <span class="bcp14">MAY</span> attempt to refresh an access token upon receipt of a query if the access token associated with an existing session has expired and the corresponding OP supports token refresh. The default RDAP server behavior is described in the "implicitTokenRefreshSupported" value that's included in the "farv1_openidcConfiguration" data structure (see <a class="auto internal xref" href="#openidcConfiguration">Section 4.1</a>).<a class="pilcrow" href="#section-5.4-6">¶</a></p>
<p id="section-5.4-7">If the value of "implicitTokenRefreshSupported" is "true", the client <span class="bcp14">MAY</span> either explicitly attempt to refresh the session using the "farv1_session/refresh" query or depend on the RDAP server to attempt to refresh the session as necessary when an RDAP query is received by the server. In this case, a server <span class="bcp14">MUST</span> attempt to refresh the access token upon receipt of a query if the access token associated with an existing session has expired and the corresponding OP supports token refresh. Servers <span class="bcp14">MUST</span> return an HTTP 401 (Unauthorized) response to a query if an attempt to implicitly refresh an existing session fails.<a class="pilcrow" href="#section-5.4-7">¶</a></p>
<p id="section-5.4-8">If the value of "implicitTokenRefreshSupported" is "false", the client <span class="bcp14">MUST</span> explicitly attempt to refresh the session using the "farv1_session/refresh" query to extend an existing session. If a session cannot be extended for any reason, the client <span class="bcp14">MUST</span> establish a new session to continue authenticated query processing by submitting a "farv1_session/login" query. If the OP does not support token refresh, the client <span class="bcp14">MUST</span> submit a new "farv1_session/login" request to establish a new session once an access token has expired.<a class="pilcrow" href="#section-5.4-8">¶</a></p>
<p id="section-5.4-9">Clients <span class="bcp14">SHOULD NOT</span> send a "farv1_session/refresh" request in the absence of an active login session because the request conflicts with the current state of the server. Servers <span class="bcp14">MUST</span> return an HTTP 409 (Conflict) response if a "farv1_session/refresh" request is received in the absence of a session cookie.<a class="pilcrow" href="#section-5.4-9">¶</a></p>
</section>
</div>
<div id="client-logout">
<section id="section-5.5">
        <h3 id="name-client-logout">
<a class="section-number selfRef" href="#section-5.5">5.5. </a><a class="section-name selfRef" href="#name-client-logout">Client Logout</a>
        </h3>
<p id="section-5.5-1">Clients <span class="bcp14">MAY</span> send a request to an RDAP server to terminate an existing login session. Termination of a session is requested using a "farv1_session/logout" path segment. 
Access and refresh tokens can be revoked during the "farv1_session/logout" process as described in <span>[<a class="cite xref" href="#RFC7009">RFC7009</a>]</span> if supported by the OP (token revocation endpoint support is <span class="bcp14">OPTIONAL</span> per <span>[<a class="cite xref" href="#RFC8414">RFC8414</a>]</span>). If supported, this feature <span class="bcp14">SHOULD</span> be used to ensure that the tokens are not mistakenly associated with a future RDAP session. Alternatively, an RDAP server <span class="bcp14">MAY</span> attempt to log out from the OP using the OpenID Connect RP-Initiated Logout protocol <span>[<a class="cite xref" href="#OIDCL">OIDCL</a>]</span> if that protocol is supported by the OP. In any case, to prevent abuse before the cookie times out, an RDAP server <span class="bcp14">SHOULD</span> invalidate the HTTP cookie associated with the session as part of terminating the session.<a class="pilcrow" href="#section-5.5-1">¶</a></p>
<p id="section-5.5-2">An example "farv1_session/logout" request:<a class="pilcrow" href="#section-5.5-2">¶</a></p>
<div id="example_session_logout">
<figure id="figure-24">
          <div class="alignLeft art-text artwork" id="section-5.5-3.1">
<pre>https://example.com/rdap/farv1_session/logout
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-24">Figure 24</a></figcaption></figure>
</div>
<p id="section-5.5-4">The response to this request <span class="bcp14">MUST</span> be a valid RDAP response per <span>[<a class="cite xref" href="#RFC9083">RFC9083</a>]</span>. It <span class="bcp14">MUST NOT</span> include any members that relate to a specific RDAP object type (e.g., "events" or "status"). In addition, the response <span class="bcp14">MAY</span> include an indication of the requested operation's success or failure in the "notices" data structure. The "notices" data structure <span class="bcp14">MAY</span> include an indication of the success or failure of any attempt to logout from the OP or to revoke the tokens issued by the OP.<a class="pilcrow" href="#section-5.5-4">¶</a></p>
<p class="keepWithNext" id="section-5.5-5">An example of a "farv1_session/logout" response:<a class="pilcrow" href="#section-5.5-5">¶</a></p>
<div id="example_logout_response">
<figure id="figure-25">
          <div class="alignLeft art-text artwork" id="section-5.5-6.1">
<pre>  {
    "rdapConformance": [
      "farv1"
    ],
    "lang": "en-US",
    "notices": [
      {
        "title": "Logout Result",
        "description": [
          "Logout succeeded"
          "Provider logout failed: Not supported by provider.",
          "Token revocation successful."
        ]
      }
    ]
  }</pre>
</div>
<figcaption><a class="selfRef" href="#figure-25">Figure 25</a></figcaption></figure>
</div>
<p id="section-5.5-7">In the absence of a "logout" request, an RDAP session <span class="bcp14">MUST</span> be terminated by the RDAP server after a server-defined period of time. The server <span class="bcp14">SHOULD</span> also take appropriate steps to ensure that the tokens associated with the terminated session cannot be reused. This <span class="bcp14">SHOULD</span> include revoking the tokens or logging out from the OP if either operation is supported by the OP.<a class="pilcrow" href="#section-5.5-7">¶</a></p>
</section>
</div>
<div id="request-sequencing">
<section id="section-5.6">
        <h3 id="name-request-sequencing">
<a class="section-number selfRef" href="#section-5.6">5.6. </a><a class="section-name selfRef" href="#name-request-sequencing">Request Sequencing</a>
        </h3>
<p id="section-5.6-1">The requests described in this document are typically performed in
        a specific sequence:<a class="pilcrow" href="#section-5.6-1">¶</a></p>
<ol class="normal type-1" id="section-5.6-2" start="1" type="1">
   <li id="section-5.6-2.1">"farv1_session/login" (or the related "farv1_session/device" and
   "farv1_session/devicepoll" requests) to start a session,<a class="pilcrow" href="#section-5.6-2.1">¶</a>
</li>
          <li id="section-5.6-2.2">"farv1_session/status" and/or "farv1_session/refresh" to manage
   a session,<a class="pilcrow" href="#section-5.6-2.2">¶</a>
</li>
          <li id="section-5.6-2.3">and "farv1_session/logout" to end a session.<a class="pilcrow" href="#section-5.6-2.3">¶</a>
</li>
        </ol>
<p id="section-5.6-3">If a client sends a "farv1_session/status",
 "farv1_session/refresh", or "farv1_session/logout" request in the
 absence of a session cookie, the server <span class="bcp14">MUST</span> return an
 HTTP 409 (Conflict) error.<a class="pilcrow" href="#section-5.6-3">¶</a></p>
<p id="section-5.6-4">A client can end a session explicitly by sending a
        "farv1_session/logout" request to the RDAP server. A session can also
        be ended implicitly by the server after a server-defined period of
        time. The status of a session can be determined at any time by sending
        a "farv1_session/status" query to the RDAP server.<a class="pilcrow" href="#section-5.6-4">¶</a></p>
<p id="section-5.6-5">An RDAP server <span class="bcp14">MUST</span> maintain session state
        information for the duration of an active session. This is commonly
        done using HTTP cookies as described in <span>[<a class="cite xref" href="#RFC6265">RFC6265</a>]</span>. Doing so allows end users to submit queries
        without having to explicitly identify and authenticate themselves for
        every query.<a class="pilcrow" href="#section-5.6-5">¶</a></p>
<p id="section-5.6-6">An RDAP server can receive queries that include a session cookie where the associated session has expired or is otherwise unavailable (e.g., due to the user requesting explicit logout for the associated session).  The server <span class="bcp14">MUST</span> return an HTTP 401 (Unauthorized) error in response to such queries.<a class="pilcrow" href="#section-5.6-6">¶</a></p>
</section>
</div>
</section>
</div>
<div id="protocol-tokens">
<section id="section-6">
      <h2 id="name-protocol-features-for-token">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-protocol-features-for-token">Protocol Features for Token-Oriented Clients</a>
      </h2>
<p id="section-6-1">This specification adds additional processing steps for token-oriented clients as described in this section and <a class="auto internal xref" href="#overview">Section 3.1.3</a>. It does not define additional data structures or RDAP-specific protocol parameters specifically for token-oriented clients.<a class="pilcrow" href="#section-6-1">¶</a></p>
<div id="login-tokens">
<section id="section-6.1">
        <h3 id="name-client-login-2">
<a class="section-number selfRef" href="#section-6.1">6.1. </a><a class="section-name selfRef" href="#name-client-login-2">Client Login</a>
        </h3>
<p id="section-6.1-1">Clients identify and authenticate end users by exchanging information with an OP that is recognized by the RDAP server as described in Sections <a class="auto internal xref" href="#auth-request">3.1.4.2</a>, <a class="auto internal xref" href="#End-User-auth">3.1.4.3</a>, and <a class="auto internal xref" href="#auth-valid">3.1.4.4</a>. A client <span class="bcp14">SHOULD</span> append the "additionalAuthorizationQueryParams" values retrieved from the "openidcProviders" array described in <a class="auto internal xref" href="#openidcConfiguration">Section 4.1</a> to the authorization endpoint URL when requesting authorization from the OP. Once these processes are completed successfully, the client can request tokens from the OP as described in <a class="auto internal xref" href="#tokens">Section 3.1.4.5</a>. The OP <span class="bcp14">SHOULD</span> include the RDAP server's client_id in the "aud" claim value of an issued ID Token. The RDAP server <span class="bcp14">MAY</span> choose to ignore the value of the "aud" claim or exchange the token as described in <a class="auto internal xref" href="#token-exch">Section 6.4</a>. With these steps completed, the access token received from the OP can be passed to an RDAP server in an HTTP "authorization" request header <span>[<a class="cite xref" href="#RFC6750">RFC6750</a>]</span> for RDAP queries that require end-user identification, authentication, and authorization.<a class="pilcrow" href="#section-6.1-1">¶</a></p>
</section>
</div>
<div id="queries-tokens">
<section id="section-6.2">
        <h3 id="name-client-queries">
<a class="section-number selfRef" href="#section-6.2">6.2. </a><a class="section-name selfRef" href="#name-client-queries">Client Queries</a>
        </h3>
<p id="section-6.2-1">An RDAP server that receives a bearer token in an HTTP "authorization" request header as part of an RDAP object query <span class="bcp14">MUST</span> validate the token in accordance with local policy and confirm that the token is a legitimate access token. Once validated, the access token <span class="bcp14">MAY</span> be used to retrieve the claims associated with the end user's identity, including claims associated with the "rdap" scope that are not already included in the access token, as described in <a class="auto internal xref" href="#user-info">Section 3.1.4.6</a>. The RDAP server can then evaluate the end user's identity information to determine the end user's authorization level and process the query in accordance with server policies. A client <span class="bcp14">MUST</span> include the "farv1_iss" query parameter and Issuer Identifier value with an RDAP query if the token was issued by a remote OP.<a class="pilcrow" href="#section-6.2-1">¶</a></p>
</section>
</div>
<div id="access-token-val">
<section id="section-6.3">
        <h3 id="name-access-token-validation">
<a class="section-number selfRef" href="#section-6.3">6.3. </a><a class="section-name selfRef" href="#name-access-token-validation">Access Token Validation</a>
        </h3>
<p id="section-6.3-1">An RDAP server <span class="bcp14">MUST</span> validate a received access token prior to using that token for access control purposes. Validation <span class="bcp14">MAY</span> include token introspection <span>[<a class="cite xref" href="#RFC7662">RFC7662</a>]</span> using the issuing OP or analysis of the values included in a JWT access token. Once an access token is validated, an RDAP server <span class="bcp14">MAY</span> use that token to request user claims from the issuing OP.<a class="pilcrow" href="#section-6.3-1">¶</a></p>
<p id="section-6.3-2">There are performance considerations associated with the process of validating a token and requesting user claims as part of processing every received RDAP query. An RDAP server <span class="bcp14">MAY</span> cache validated information and use that cached information to reduce the amount of time needed to process subsequent RDAP queries associated with the same access token as long as the token has not expired. The client <span class="bcp14">SHOULD</span> monitor the token expiration time and refresh the token as needed.<a class="pilcrow" href="#section-6.3-2">¶</a></p>
</section>
</div>
<div id="token-exch">
<section id="section-6.4">
        <h3 id="name-token-exchange">
<a class="section-number selfRef" href="#section-6.4">6.4. </a><a class="section-name selfRef" href="#name-token-exchange">Token Exchange</a>
        </h3>
<p id="section-6.4-1">Tokens can include an "aud" (audience) claim that contains the OAuth 2.0 client_id of the RP as an audience value. In some operational scenarios (such as a client that is providing a proxy service), an RP can receive tokens with an "aud" claim value that does not include the RP's client_id. These tokens might not be trusted by the RP, and the RP might refuse to accept the tokens. This situation can be remedied by having the RP exchange the access token with the OP for a set of trusted tokens that reset the "aud" claim. The token exchange protocol is described in <span>[<a class="cite xref" href="#RFC8693">RFC8693</a>]</span>.<a class="pilcrow" href="#section-6.4-1">¶</a></p>
</section>
</div>
</section>
</div>
<div id="query-processing">
<section id="section-7">
      <h2 id="name-rdap-query-processing">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-rdap-query-processing">RDAP Query Processing</a>
      </h2>
<p id="section-7-1">Once an RDAP session is active, an RDAP server <span class="bcp14">MUST</span> determine if the end user is authorized to perform any queries that are received during the duration of the session. This <span class="bcp14">MAY</span> include rejecting queries outright, and it <span class="bcp14">MAY</span> include omitting or otherwise redacting information that the end user is not authorized to receive. Specific processing requirements are beyond the scope of this document.<a class="pilcrow" href="#section-7-1">¶</a></p>
</section>
</div>
<div id="conformance">
<section id="section-8">
      <h2 id="name-rdap-conformance">
<a class="section-number selfRef" href="#section-8">8. </a><a class="section-name selfRef" href="#name-rdap-conformance">RDAP Conformance</a>
      </h2>
<p id="section-8-1">RDAP responses that contain values described in this document <span class="bcp14">MUST</span> indicate conformance with this specification by including an rdapConformance <span>[<a class="cite xref" href="#RFC9083">RFC9083</a>]</span> value of "farv1" (federated authentication method for RDAP version 1). The information needed to register this value in the "RDAP Extensions" registry is described in <a class="auto internal xref" href="#ext-registry">Section 9.1</a>.<a class="pilcrow" href="#section-8-1">¶</a></p>
<p class="keepWithNext" id="section-8-2">Example rdapConformance structure with extension specified:<a class="pilcrow" href="#section-8-2">¶</a></p>
<div id="rdapConformance_example">
<figure id="figure-26">
        <div class="alignLeft art-text artwork" id="section-8-3.1">
<pre>   "rdapConformance" :
     [
       "rdap_level_0",
       "farv1"
     ]</pre>
</div>
<figcaption><a class="selfRef" href="#figure-26">Figure 26</a></figcaption></figure>
</div>
</section>
</div>
<div id="IANA">
<section id="section-9">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-9">9. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<div id="ext-registry">
<section id="section-9.1">
        <h3 id="name-rdap-extensions-registry">
<a class="section-number selfRef" href="#section-9.1">9.1. </a><a class="section-name selfRef" href="#name-rdap-extensions-registry">RDAP Extensions Registry</a>
        </h3>
<p id="section-9.1-1">IANA has registered the following value in the "RDAP Extensions" registry:<a class="pilcrow" href="#section-9.1-1">¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-9.1-2">
          <dt id="section-9.1-2.1">Extension Identifier:</dt>
          <dd id="section-9.1-2.2" style="margin-left: 1.5em">farv1<a class="pilcrow" href="#section-9.1-2.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.1-2.3">Registry Operator:</dt>
          <dd id="section-9.1-2.4" style="margin-left: 1.5em">Any<a class="pilcrow" href="#section-9.1-2.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.1-2.5">Specification:</dt>
          <dd id="section-9.1-2.6" style="margin-left: 1.5em">RFC 9560<a class="pilcrow" href="#section-9.1-2.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.1-2.7">Contact:</dt>
          <dd id="section-9.1-2.8" style="margin-left: 1.5em"> IETF &lt;iesg@ietf.org&gt;<a class="pilcrow" href="#section-9.1-2.8">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.1-2.9">Intended Usage:</dt>
          <dd id="section-9.1-2.10" style="margin-left: 1.5em"> This extension describes federated authentication method for RDAP version 1 using OAuth 2.0 and OpenID Connect.<a class="pilcrow" href="#section-9.1-2.10">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="JWT-registry">
<section id="section-9.2">
        <h3 id="name-json-web-token-claims-regis">
<a class="section-number selfRef" href="#section-9.2">9.2. </a><a class="section-name selfRef" href="#name-json-web-token-claims-regis">JSON Web Token Claims Registry</a>
        </h3>
<p id="section-9.2-1">IANA has registered the following values in the "JSON Web Token Claims" registry:<a class="pilcrow" href="#section-9.2-1">¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-9.2-2">
          <dt id="section-9.2-2.1">Claim Name:</dt>
          <dd id="section-9.2-2.2" style="margin-left: 1.5em">rdap_allowed_purposes<a class="pilcrow" href="#section-9.2-2.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.2-2.3">Claim Description:</dt>
          <dd id="section-9.2-2.4" style="margin-left: 1.5em"> This claim describes the set of RDAP query purposes that are available to an identity that is presented for access to a protected RDAP resource.<a class="pilcrow" href="#section-9.2-2.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.2-2.5">Change Controller:</dt>
          <dd id="section-9.2-2.6" style="margin-left: 1.5em"> IETF<a class="pilcrow" href="#section-9.2-2.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.2-2.7">Reference:</dt>
          <dd id="section-9.2-2.8" style="margin-left: 1.5em">
            <a class="auto internal xref" href="#stated-purposes">Section 3.1.5.1</a> of RFC 9560.<a class="pilcrow" href="#section-9.2-2.8">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-9.2-3">
          <dt id="section-9.2-3.1">Claim Name:</dt>
          <dd id="section-9.2-3.2" style="margin-left: 1.5em">rdap_dnt_allowed<a class="pilcrow" href="#section-9.2-3.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.2-3.3">Claim Description:</dt>
          <dd id="section-9.2-3.4" style="margin-left: 1.5em"> This claim contains a JSON boolean literal that describes a "do not track" request for server-side tracking, logging, or recording of an identity that is presented for access to a protected RDAP resource.<a class="pilcrow" href="#section-9.2-3.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.2-3.5">Change Controller:</dt>
          <dd id="section-9.2-3.6" style="margin-left: 1.5em"> IETF<a class="pilcrow" href="#section-9.2-3.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.2-3.7">Reference:</dt>
          <dd id="section-9.2-3.8" style="margin-left: 1.5em">
            <a class="auto internal xref" href="#rdap_dnt_allowed">Section 3.1.5.2</a> of RFC 9560.<a class="pilcrow" href="#section-9.2-3.8">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="purpose-registry">
<section id="section-9.3">
        <h3 id="name-rdap-query-purpose-registry">
<a class="section-number selfRef" href="#section-9.3">9.3. </a><a class="section-name selfRef" href="#name-rdap-query-purpose-registry">RDAP Query Purpose Registry</a>
        </h3>
<p id="section-9.3-1">IANA has created a new protocol registry to manage RDAP query purpose values.<a class="pilcrow" href="#section-9.3-1">¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-9.3-2">
          <dt id="section-9.3-2.1">Section at <span><a href="https://www.iana.org/protocols">https://www.iana.org/protocols</a></span>:</dt>
          <dd id="section-9.3-2.2" style="margin-left: 1.5em">Registration Data Access Protocol (RDAP)<a class="pilcrow" href="#section-9.3-2.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.3-2.3">Registry Name:</dt>
          <dd id="section-9.3-2.4" style="margin-left: 1.5em">Registration Data Access Protocol (RDAP) Query Purpose Values<a class="pilcrow" href="#section-9.3-2.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.3-2.5">Registration Procedure(s):</dt>
          <dd id="section-9.3-2.6" style="margin-left: 1.5em">This registry is operated under the "Specification Required"
   policy defined in <span>[<a class="cite xref" href="#RFC8126">RFC8126</a>]</span>. The designated expert
   must ensure that requests to add values to this registry meet the
   syntax, value, and description requirements described in this
   section.<a class="pilcrow" href="#section-9.3-2.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.3-2.7">Required Information:</dt>
          <dd id="section-9.3-2.8" style="margin-left: 1.5em">Registration requests are described in a specification that's
   consistent with the "Specification Required" policy defined in
   <span>[<a class="cite xref" href="#RFC8126">RFC8126</a>]</span>. The specification must include one or
   more purpose values as described below.<a class="pilcrow" href="#section-9.3-2.8">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-9.3-3">Individual purpose values are registered with IANA. Each entry in the registry contains the following fields:<a class="pilcrow" href="#section-9.3-3">¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-9.3-4">
          <dt id="section-9.3-4.1">Value:</dt>
          <dd id="section-9.3-4.2" style="margin-left: 1.5em">The purpose string value being registered. Value strings can
   contain uppercase ASCII characters from "A" to "Z", lowercase
   ASCII characters from "a" to "z", and the underscore ("_")
   character. Value strings contain at least one character and no more
   than 64 characters.<a class="pilcrow" href="#section-9.3-4.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.3-4.3">Description:</dt>
          <dd id="section-9.3-4.4" style="margin-left: 1.5em">One or two sentences in English describing the
   meaning of the purpose value, how it might be used, and/or how it
   should be interpreted by clients and servers.<a class="pilcrow" href="#section-9.3-4.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.3-4.5">Reference:</dt>
          <dd id="section-9.3-4.6" style="margin-left: 1.5em">RFC 9560<a class="pilcrow" href="#section-9.3-4.6">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-9.3-5">The set of initial values used to populate the registry as
          described below are derived from the final report produced by the
          Expert Working Group on gTLD Directory Services chartered by the
          Internet Corporation for Assigned Names and Numbers (ICANN) <span>[<a class="cite xref" href="#gTLD">gTLD</a>]</span>.<a class="pilcrow" href="#section-9.3-5">¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-9.3-6">
          <dt id="section-9.3-6.1">Value:</dt>
          <dd id="section-9.3-6.2" style="margin-left: 1.5em">domainNameControl<a class="pilcrow" href="#section-9.3-6.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.3-6.3">Description:</dt>
          <dd id="section-9.3-6.4" style="margin-left: 1.5em">Tasks within the scope of this purpose include, for a
   registrant's own domain name, creating the domain name, updating
   information about the domain name, transferring the domain name,
   renewing the domain name, deleting the domain name, maintaining a
   domain name portfolio, and detecting fraudulent use of the
   registrant's own contact information.<a class="pilcrow" href="#section-9.3-6.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.3-6.5">Reference:</dt>
          <dd id="section-9.3-6.6" style="margin-left: 1.5em">RFC 9560<a class="pilcrow" href="#section-9.3-6.6">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-9.3-7">
          <dt id="section-9.3-7.1">Value:</dt>
          <dd id="section-9.3-7.2" style="margin-left: 1.5em">personalDataProtection<a class="pilcrow" href="#section-9.3-7.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.3-7.3">Description:</dt>
          <dd id="section-9.3-7.4" style="margin-left: 1.5em">Tasks within the scope of this purpose
          include identifying the accredited privacy or proxy provider associated
          with a domain name, reporting abuse, requesting reveal, or otherwise
          contacting the provider.<a class="pilcrow" href="#section-9.3-7.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.3-7.5">Reference:</dt>
          <dd id="section-9.3-7.6" style="margin-left: 1.5em">RFC 9560<a class="pilcrow" href="#section-9.3-7.6">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-9.3-8">
          <dt id="section-9.3-8.1">Value:</dt>
          <dd id="section-9.3-8.2" style="margin-left: 1.5em">technicalIssueResolution<a class="pilcrow" href="#section-9.3-8.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.3-8.3">Description:</dt>
          <dd id="section-9.3-8.4" style="margin-left: 1.5em"> Tasks within the scope of this purpose
          include (but are not limited to) working to resolve technical issues,
          including email delivery issues, DNS resolution failures, and
          website functionality issues.<a class="pilcrow" href="#section-9.3-8.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.3-8.5">Reference:</dt>
          <dd id="section-9.3-8.6" style="margin-left: 1.5em">RFC 9560<a class="pilcrow" href="#section-9.3-8.6">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-9.3-9">
          <dt id="section-9.3-9.1">Value:</dt>
          <dd id="section-9.3-9.2" style="margin-left: 1.5em"> domainNameCertification<a class="pilcrow" href="#section-9.3-9.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.3-9.3">Description:</dt>
          <dd id="section-9.3-9.4" style="margin-left: 1.5em"> Tasks within the scope of this purpose include a Certification Authority (CA) issuing an X.509 certificate to a subject identified by a domain name.<a class="pilcrow" href="#section-9.3-9.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.3-9.5">Reference:</dt>
          <dd id="section-9.3-9.6" style="margin-left: 1.5em">RFC 9560<a class="pilcrow" href="#section-9.3-9.6">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-9.3-10">
          <dt id="section-9.3-10.1">Value:</dt>
          <dd id="section-9.3-10.2" style="margin-left: 1.5em"> individualInternetUse<a class="pilcrow" href="#section-9.3-10.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.3-10.3">Description:</dt>
          <dd id="section-9.3-10.4" style="margin-left: 1.5em"> Tasks within the scope of this purpose
          include identifying the organization using a domain name to instill
          consumer trust or contacting that organization to raise a customer
          complaint to them or file a complaint about them.<a class="pilcrow" href="#section-9.3-10.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.3-10.5">Reference:</dt>
          <dd id="section-9.3-10.6" style="margin-left: 1.5em">RFC 9560<a class="pilcrow" href="#section-9.3-10.6">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-9.3-11">
          <dt id="section-9.3-11.1">Value:</dt>
          <dd id="section-9.3-11.2" style="margin-left: 1.5em"> businessDomainNamePurchaseOrSale<a class="pilcrow" href="#section-9.3-11.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.3-11.3">Description:</dt>
          <dd id="section-9.3-11.4" style="margin-left: 1.5em"> Tasks within the scope of this purpose include making purchase queries about a domain name, acquiring a domain name from a registrant, and enabling due diligence research.<a class="pilcrow" href="#section-9.3-11.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.3-11.5">Reference:</dt>
          <dd id="section-9.3-11.6" style="margin-left: 1.5em">RFC 9560<a class="pilcrow" href="#section-9.3-11.6">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-9.3-12">
          <dt id="section-9.3-12.1">Value:</dt>
          <dd id="section-9.3-12.2" style="margin-left: 1.5em"> academicPublicInterestDNSResearch<a class="pilcrow" href="#section-9.3-12.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.3-12.3">Description:</dt>
          <dd id="section-9.3-12.4" style="margin-left: 1.5em"> Tasks within the scope of this purpose include academic public interest research studies about domain names published in the registration data service, including public information about the registrant and designated contacts, the domain name's history and status, and domain names registered by a given registrant (reverse query).<a class="pilcrow" href="#section-9.3-12.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.3-12.5">Reference:</dt>
          <dd id="section-9.3-12.6" style="margin-left: 1.5em">RFC 9560<a class="pilcrow" href="#section-9.3-12.6">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-9.3-13">
          <dt id="section-9.3-13.1">Value:</dt>
          <dd id="section-9.3-13.2" style="margin-left: 1.5em"> legalActions<a class="pilcrow" href="#section-9.3-13.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.3-13.3">Description:</dt>
          <dd id="section-9.3-13.4" style="margin-left: 1.5em"> Tasks within the scope of this purpose include investigating possible fraudulent use of a registrant's name or address by other domain names, investigating possible trademark infringement, contacting a registrant's or licensee's legal representative prior to taking legal action, and then taking a legal action if the concern is not satisfactorily addressed.<a class="pilcrow" href="#section-9.3-13.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.3-13.5">Reference:</dt>
          <dd id="section-9.3-13.6" style="margin-left: 1.5em">RFC 9560<a class="pilcrow" href="#section-9.3-13.6">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-9.3-14">
          <dt id="section-9.3-14.1">Value:</dt>
          <dd id="section-9.3-14.2" style="margin-left: 1.5em"> regulatoryAndContractEnforcement<a class="pilcrow" href="#section-9.3-14.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.3-14.3">Description:</dt>
          <dd id="section-9.3-14.4" style="margin-left: 1.5em">Tasks within the scope of this purpose
          include investigating the tax authority of businesses with online
          presences, investigating Uniform Domain-Name Dispute-Resolution
          Policy (UDRP), investigating contractual compliance, and registering
          data escrow audits.<a class="pilcrow" href="#section-9.3-14.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.3-14.5">Reference:</dt>
          <dd id="section-9.3-14.6" style="margin-left: 1.5em">RFC 9560<a class="pilcrow" href="#section-9.3-14.6">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-9.3-15">
          <dt id="section-9.3-15.1">Value:</dt>
          <dd id="section-9.3-15.2" style="margin-left: 1.5em"> criminalInvestigationAndDNSAbuseMitigation<a class="pilcrow" href="#section-9.3-15.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.3-15.3">Description:</dt>
          <dd id="section-9.3-15.4" style="margin-left: 1.5em"> Tasks within the scope of this purpose include reporting abuse to someone who can investigate and address that abuse or contacting entities associated with a domain name during an offline criminal investigation.<a class="pilcrow" href="#section-9.3-15.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.3-15.5">Reference:</dt>
          <dd id="section-9.3-15.6" style="margin-left: 1.5em">RFC 9560<a class="pilcrow" href="#section-9.3-15.6">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-9.3-16">
          <dt id="section-9.3-16.1">Value:</dt>
          <dd id="section-9.3-16.2" style="margin-left: 1.5em"> dnsTransparency<a class="pilcrow" href="#section-9.3-16.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.3-16.3">Description:</dt>
          <dd id="section-9.3-16.4" style="margin-left: 1.5em"> Tasks within the scope of this purpose involve querying the registration data made public by registrants to satisfy a wide variety of use cases around informing the public.<a class="pilcrow" href="#section-9.3-16.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.3-16.5">Reference:</dt>
          <dd id="section-9.3-16.6" style="margin-left: 1.5em">RFC 9560<a class="pilcrow" href="#section-9.3-16.6">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="Security">
<section id="section-10">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-10">10. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<p id="section-10-1">Security considerations for RDAP can be found in <span>[<a class="cite xref" href="#RFC7481">RFC7481</a>]</span>. Security considerations for OpenID Connect Core <span>[<a class="cite xref" href="#OIDCC">OIDCC</a>]</span> and OAuth 2.0 <span>[<a class="cite xref" href="#RFC6749">RFC6749</a>]</span> can be found in their reference specifications; best current security practice for OAuth 2.0 can be found in <span>[<a class="cite xref" href="#I-D.ietf-oauth-security-topics">OAUTH-SECURITY</a>]</span>. Additionally, the practices described in <span>[<a class="cite xref" href="#RFC9325">RFC9325</a>]</span> <span class="bcp14">MUST</span> be followed when the Transport Layer Security (TLS) protocol is used.<a class="pilcrow" href="#section-10-1">¶</a></p>
<p id="section-10-2">As described in <a class="auto internal xref" href="#auth-request">Section 3.1.4.2</a>, the OAuth 2.0 Implicit Flow <span>[<a class="cite xref" href="#RFC6749">RFC6749</a>]</span> is considered insecure, and efforts are being made to deprecate the flow. It <span class="bcp14">MUST NOT</span> be used.<a class="pilcrow" href="#section-10-2">¶</a></p>
<p id="section-10-3">Some of the responses described in this specification return information to a client from an RDAP server that is intended to help the client match responses to queries and manage sessions. Some of that information, such as the "userClaims" described in <a class="auto internal xref" href="#session">Section 5.1.1</a>, can be personally identifiable and considered sensitive if disclosed to unauthorized parties. An RDAP server operator must develop policies for information disclosure to ensure that personally identifiable information is disclosed only to clients that are authorized to process that information.<a class="pilcrow" href="#section-10-3">¶</a></p>
<p id="section-10-4">The "do not track" claim relies on the good will of the RDAP server and associated proxies. As such, using and processing this claim depends on out-of-band trust relationships that need to be established before the claim is used in practice. If used and accepted by the RDAP server, there is a risk of information loss that could seriously impair audit capabilities.<a class="pilcrow" href="#section-10-4">¶</a></p>
<div id="access">
<section id="section-10.1">
        <h3 id="name-authentication-and-access-c">
<a class="section-number selfRef" href="#section-10.1">10.1. </a><a class="section-name selfRef" href="#name-authentication-and-access-c">Authentication and Access Control</a>
        </h3>
<p id="section-10.1-1">Having completed the client identification, authorization, and validation process, an RDAP server can make access control decisions based on a comparison of client-provided information (such as the set of "userClaims" described in <a class="auto internal xref" href="#session">Section 5.1.1</a>) and local policy. For example, a client who provides an email address (and nothing more) might be entitled to receive a subset of the information that would be available to a client who provides an email address, a full name, and a stated purpose. Development of these access control policies is beyond the scope of this document.<a class="pilcrow" href="#section-10.1-1">¶</a></p>
</section>
</div>
</section>
</div>
<section id="section-11">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-11">11. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-11.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-11.1">11.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="HTMLURL">[HTMLURL]</dt>
        <dd>
<span class="refAuthor">WHATWG</span>, <span class="refTitle">"URL (Living Standard)"</span>, <time class="refDate" datetime="2024-03">March 2024</time>, <span>&lt;<a href="https://url.spec.whatwg.org/">https://url.spec.whatwg.org/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OIDCC">[OIDCC]</dt>
        <dd>
<span class="refAuthor">Sakimura, N.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Jones, M.</span>, <span class="refAuthor">de Medeiros, B.</span>, and <span class="refAuthor">C. Mortimore</span>, <span class="refTitle">"OpenID Connect Core 1.0 incorporating errata set 2"</span>, <time class="refDate" datetime="2023-12">December 2023</time>, <span>&lt;<a href="https://openid.net/specs/openid-connect-core-1_0.html">https://openid.net/specs/openid-connect-core-1_0.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OIDCD">[OIDCD]</dt>
        <dd>
<span class="refAuthor">Sakimura, N.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Jones, M.</span>, and <span class="refAuthor">E. Jay</span>, <span class="refTitle">"OpenID Connect Discovery 1.0 incorporating errata set 2"</span>, <time class="refDate" datetime="2023-12">December 2023</time>, <span>&lt;<a href="https://openid.net/specs/openid-connect-discovery-1_0.html">https://openid.net/specs/openid-connect-discovery-1_0.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OIDCL">[OIDCL]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">de Medeiros, B.</span>, <span class="refAuthor">Agarwal, N.</span>, <span class="refAuthor">Sakimura, N.</span>, and <span class="refAuthor">J. Bradley</span>, <span class="refTitle">"OpenID Connect RP-Initiated Logout 1.0"</span>, <time class="refDate" datetime="2022-09">September 2022</time>, <span>&lt;<a href="https://openid.net/specs/openid-connect-rpinitiated-1_0.html">https://openid.net/specs/openid-connect-rpinitiated-1_0.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OIDCR">[OIDCR]</dt>
        <dd>
<span class="refAuthor">Sakimura, N.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">M. Jones</span>, <span class="refTitle">"OpenID Connect Dynamic Client Registration 1.0 incorporating errata set 2"</span>, <time class="refDate" datetime="2023-12">December 2023</time>, <span>&lt;<a href="https://openid.net/specs/openid-connect-registration-1_0.html">https://openid.net/specs/openid-connect-registration-1_0.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time class="refDate" datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6265">[RFC6265]</dt>
        <dd>
<span class="refAuthor">Barth, A.</span>, <span class="refTitle">"HTTP State Management Mechanism"</span>, <span class="seriesInfo">RFC 6265</span>, <span class="seriesInfo">DOI 10.17487/RFC6265</span>, <time class="refDate" datetime="2011-04">April 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6265">https://www.rfc-editor.org/info/rfc6265</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6749">[RFC6749]</dt>
        <dd>
<span class="refAuthor">Hardt, D., Ed.</span>, <span class="refTitle">"The OAuth 2.0 Authorization Framework"</span>, <span class="seriesInfo">RFC 6749</span>, <span class="seriesInfo">DOI 10.17487/RFC6749</span>, <time class="refDate" datetime="2012-10">October 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6749">https://www.rfc-editor.org/info/rfc6749</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6750">[RFC6750]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span> and <span class="refAuthor">D. Hardt</span>, <span class="refTitle">"The OAuth 2.0 Authorization Framework: Bearer Token Usage"</span>, <span class="seriesInfo">RFC 6750</span>, <span class="seriesInfo">DOI 10.17487/RFC6750</span>, <time class="refDate" datetime="2012-10">October 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6750">https://www.rfc-editor.org/info/rfc6750</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7009">[RFC7009]</dt>
        <dd>
<span class="refAuthor">Lodderstedt, T., Ed.</span>, <span class="refAuthor">Dronia, S.</span>, and <span class="refAuthor">M. Scurtescu</span>, <span class="refTitle">"OAuth 2.0 Token Revocation"</span>, <span class="seriesInfo">RFC 7009</span>, <span class="seriesInfo">DOI 10.17487/RFC7009</span>, <time class="refDate" datetime="2013-08">August 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7009">https://www.rfc-editor.org/info/rfc7009</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7480">[RFC7480]</dt>
        <dd>
<span class="refAuthor">Newton, A.</span>, <span class="refAuthor">Ellacott, B.</span>, and <span class="refAuthor">N. Kong</span>, <span class="refTitle">"HTTP Usage in the Registration Data Access Protocol (RDAP)"</span>, <span class="seriesInfo">STD 95</span>, <span class="seriesInfo">RFC 7480</span>, <span class="seriesInfo">DOI 10.17487/RFC7480</span>, <time class="refDate" datetime="2015-03">March 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7480">https://www.rfc-editor.org/info/rfc7480</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7481">[RFC7481]</dt>
        <dd>
<span class="refAuthor">Hollenbeck, S.</span> and <span class="refAuthor">N. Kong</span>, <span class="refTitle">"Security Services for the Registration Data Access Protocol (RDAP)"</span>, <span class="seriesInfo">STD 95</span>, <span class="seriesInfo">RFC 7481</span>, <span class="seriesInfo">DOI 10.17487/RFC7481</span>, <time class="refDate" datetime="2015-03">March 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7481">https://www.rfc-editor.org/info/rfc7481</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7519">[RFC7519]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">N. Sakimura</span>, <span class="refTitle">"JSON Web Token (JWT)"</span>, <span class="seriesInfo">RFC 7519</span>, <span class="seriesInfo">DOI 10.17487/RFC7519</span>, <time class="refDate" datetime="2015-05">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7519">https://www.rfc-editor.org/info/rfc7519</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7617">[RFC7617]</dt>
        <dd>
<span class="refAuthor">Reschke, J.</span>, <span class="refTitle">"The 'Basic' HTTP Authentication Scheme"</span>, <span class="seriesInfo">RFC 7617</span>, <span class="seriesInfo">DOI 10.17487/RFC7617</span>, <time class="refDate" datetime="2015-09">September 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7617">https://www.rfc-editor.org/info/rfc7617</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7662">[RFC7662]</dt>
        <dd>
<span class="refAuthor">Richer, J., Ed.</span>, <span class="refTitle">"OAuth 2.0 Token Introspection"</span>, <span class="seriesInfo">RFC 7662</span>, <span class="seriesInfo">DOI 10.17487/RFC7662</span>, <time class="refDate" datetime="2015-10">October 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7662">https://www.rfc-editor.org/info/rfc7662</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time class="refDate" datetime="2017-06">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time class="refDate" datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8628">[RFC8628]</dt>
        <dd>
<span class="refAuthor">Denniss, W.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Jones, M.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"OAuth 2.0 Device Authorization Grant"</span>, <span class="seriesInfo">RFC 8628</span>, <span class="seriesInfo">DOI 10.17487/RFC8628</span>, <time class="refDate" datetime="2019-08">August 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8628">https://www.rfc-editor.org/info/rfc8628</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8693">[RFC8693]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Nadalin, A.</span>, <span class="refAuthor">Campbell, B., Ed.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">C. Mortimore</span>, <span class="refTitle">"OAuth 2.0 Token Exchange"</span>, <span class="seriesInfo">RFC 8693</span>, <span class="seriesInfo">DOI 10.17487/RFC8693</span>, <time class="refDate" datetime="2020-01">January 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8693">https://www.rfc-editor.org/info/rfc8693</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9068">[RFC9068]</dt>
        <dd>
<span class="refAuthor">Bertocci, V.</span>, <span class="refTitle">"JSON Web Token (JWT) Profile for OAuth 2.0 Access Tokens"</span>, <span class="seriesInfo">RFC 9068</span>, <span class="seriesInfo">DOI 10.17487/RFC9068</span>, <time class="refDate" datetime="2021-10">October 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9068">https://www.rfc-editor.org/info/rfc9068</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9082">[RFC9082]</dt>
        <dd>
<span class="refAuthor">Hollenbeck, S.</span> and <span class="refAuthor">A. Newton</span>, <span class="refTitle">"Registration Data Access Protocol (RDAP) Query Format"</span>, <span class="seriesInfo">STD 95</span>, <span class="seriesInfo">RFC 9082</span>, <span class="seriesInfo">DOI 10.17487/RFC9082</span>, <time class="refDate" datetime="2021-06">June 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9082">https://www.rfc-editor.org/info/rfc9082</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9083">[RFC9083]</dt>
        <dd>
<span class="refAuthor">Hollenbeck, S.</span> and <span class="refAuthor">A. Newton</span>, <span class="refTitle">"JSON Responses for the Registration Data Access Protocol (RDAP)"</span>, <span class="seriesInfo">STD 95</span>, <span class="seriesInfo">RFC 9083</span>, <span class="seriesInfo">DOI 10.17487/RFC9083</span>, <time class="refDate" datetime="2021-06">June 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9083">https://www.rfc-editor.org/info/rfc9083</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9110">[RFC9110]</dt>
        <dd>
<span class="refAuthor">Fielding, R., Ed.</span>, <span class="refAuthor">Nottingham, M., Ed.</span>, and <span class="refAuthor">J. Reschke, Ed.</span>, <span class="refTitle">"HTTP Semantics"</span>, <span class="seriesInfo">STD 97</span>, <span class="seriesInfo">RFC 9110</span>, <span class="seriesInfo">DOI 10.17487/RFC9110</span>, <time class="refDate" datetime="2022-06">June 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9110">https://www.rfc-editor.org/info/rfc9110</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9325">[RFC9325]</dt>
      <dd>
<span class="refAuthor">Sheffer, Y.</span>, <span class="refAuthor">Saint-Andre, P.</span>, and <span class="refAuthor">T. Fossati</span>, <span class="refTitle">"Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"</span>, <span class="seriesInfo">BCP 195</span>, <span class="seriesInfo">RFC 9325</span>, <span class="seriesInfo">DOI 10.17487/RFC9325</span>, <time class="refDate" datetime="2022-11">November 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9325">https://www.rfc-editor.org/info/rfc9325</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-11.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-11.2">11.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="gTLD">[gTLD]</dt>
        <dd>
<span class="refAuthor">Expert Working Group on gTLD Directory Services (EWG)</span>, <span class="refTitle">"Final Report from the Expert Working Group on gTLD Directory Services: A Next-Generation Registration Directory Service (RDS)"</span>, <time class="refDate" datetime="2014-06">June 2014</time>, <span>&lt;<a href="https://www.icann.org/en/system/files/files/final-report-06jun14-en.pdf">https://www.icann.org/en/system/files/files/final-report-06jun14-en.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-oauth-security-topics">[OAUTH-SECURITY]</dt>
        <dd>
<span class="refAuthor">Lodderstedt, T.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Labunets, A.</span>, and <span class="refAuthor">D. Fett</span>, <span class="refTitle">"OAuth 2.0 Security Best Current Practice"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-oauth-security-topics-26</span>, <time class="refDate" datetime="2024-04-21">21 April 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-oauth-security-topics-26">https://datatracker.ietf.org/doc/html/draft-ietf-oauth-security-topics-26</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OIDC">[OIDC]</dt>
        <dd>
<span class="refAuthor">OpenID</span>, <span class="refTitle">"What is OpenID Connect"</span>, <span>&lt;<a href="https://openid.net/developers/how-connect-works/">https://openid.net/developers/how-connect-works/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4949">[RFC4949]</dt>
        <dd>
<span class="refAuthor">Shirey, R.</span>, <span class="refTitle">"Internet Security Glossary, Version 2"</span>, <span class="seriesInfo">FYI 36</span>, <span class="seriesInfo">RFC 4949</span>, <span class="seriesInfo">DOI 10.17487/RFC4949</span>, <time class="refDate" datetime="2007-08">August 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4949">https://www.rfc-editor.org/info/rfc4949</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8414">[RFC8414]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Sakimura, N.</span>, and <span class="refAuthor">J. Bradley</span>, <span class="refTitle">"OAuth 2.0 Authorization Server Metadata"</span>, <span class="seriesInfo">RFC 8414</span>, <span class="seriesInfo">DOI 10.17487/RFC8414</span>, <time class="refDate" datetime="2018-06">June 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8414">https://www.rfc-editor.org/info/rfc8414</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8792">[RFC8792]</dt>
      <dd>
<span class="refAuthor">Watsen, K.</span>, <span class="refAuthor">Auerswald, E.</span>, <span class="refAuthor">Farrel, A.</span>, and <span class="refAuthor">Q. Wu</span>, <span class="refTitle">"Handling Long Lines in Content of Internet-Drafts and RFCs"</span>, <span class="seriesInfo">RFC 8792</span>, <span class="seriesInfo">DOI 10.17487/RFC8792</span>, <time class="refDate" datetime="2020-06">June 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8792">https://www.rfc-editor.org/info/rfc8792</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="acks">
<section id="appendix-A">
      <h2 id="name-acknowledgments">
<a class="section-name selfRef" href="#name-acknowledgments">Acknowledgments</a>
      </h2>
<p id="appendix-A-1">The author would like to acknowledge the following individuals for
      their contributions to the development of this document: <span class="contact-name">Julien Bernard</span>, <span class="contact-name">Marc Blanchet</span>,
      <span class="contact-name">Tom Harrison</span>, <span class="contact-name">Russ Housley</span>,
      <span class="contact-name">Jasdip Singh</span>, <span class="contact-name">Rhys Smith</span>,
      <span class="contact-name">Jaromir Talir</span>, <span class="contact-name">Rick Wilhelm</span>,
      and <span class="contact-name">Alessandro Vesely</span>. In addition, the Verisign
      Registry Services Lab development team of <span class="contact-name">Joseph       Harvey</span>, <span class="contact-name">Andrew Kaizer</span>, <span class="contact-name">Sai       Mogali</span>, <span class="contact-name">Anurag Saxena</span>, <span class="contact-name">Swapneel Sheth</span>, <span class="contact-name">Nitin Singh</span>, and
      <span class="contact-name">Zhao Zhao</span> provided critical "proof of concept"
      implementation experience that helped demonstrate the validity of the
      concepts described in this document.<a class="pilcrow" href="#appendix-A-1">¶</a></p>
<p id="appendix-A-2"><span class="contact-name">Pawel Kowalik</span> and <span class="contact-name">Mario       Loffredo</span> provided significant text contributions that led to welcome
      improvements in several sections of this document. Their contributions
      are greatly appreciated.<a class="pilcrow" href="#appendix-A-2">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-address">
<a class="section-name selfRef" href="#name-authors-address">Author's Address</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Scott Hollenbeck</span></div>
<div class="left" dir="auto"><span class="org">Verisign Labs</span></div>
<div class="left" dir="auto"><span class="street-address">12061 Bluemont Way</span></div>
<div class="left" dir="auto">
<span class="locality">Reston</span>, <span class="region">VA</span> <span class="postal-code">20190</span>
</div>
<div class="left" dir="auto"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:shollenbeck@verisign.com">shollenbeck@verisign.com</a>
</div>
<div class="url">
<span>URI:</span>
<a class="url" href="https://www.verisignlabs.com/">https://www.verisignlabs.com/</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>