<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 9605: Secure Frame (SFrame): Lightweight Authenticated Encryption for Realâ€‘Time Media</title>
<meta content="Emad Omara" name="author"/>
<meta content="Justin Uberti" name="author"/>
<meta content="Sergio Garcia Murillo" name="author"/>
<meta content="Richard Barnes" name="author"/>
<meta content="Youenn Fablet" name="author"/>
<meta content="
       This document describes the Secure Frame (SFrame) end-to-end encryption and
authentication mechanism for media frames in a multiparty conference call, in
which central media servers (Selective Forwarding Units or SFUs) can access the
media metadata needed to make forwarding decisions without having access to the
actual media. 
       This mechanism differs from the Secure Real-Time Protocol (SRTP) in that
it is independent of RTP (thus compatible with non-RTP media transport) and can
be applied to whole media frames in order to be more bandwidth efficient. 
    " name="description"/>
<meta content="xml2rfc 3.23.0" name="generator"/>
<meta content="security" name="keyword"/>
<meta content="real-time media encryption" name="keyword"/>
<meta content="end-to-end encryption" name="keyword"/>
<meta content="9605" name="rfc.number"/>
<!-- Generator version information:
  xml2rfc 3.23.0
    Python 3.9.15
    ConfigArgParse 1.5.3
    google-i18n-address 3.0.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.0
    platformdirs 3.8.0
    pycountry 22.3.5
    pydyf 0.10.0
    PyYAML 6.0
    requests 2.28.0
    setuptools 44.1.1
    wcwidth 0.2.5
    weasyprint 62.3
-->
<link href="rfc9605.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
  overflow-wrap: break-word;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
blockquote > *:last-child {
  margin-bottom: 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}
.xref {
  overflow-wrap: normal;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.refSubseries {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: upper-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code, dt tt, dt code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://datatracker.ietf.org/doc/draft-ietf-sframe-enc-09" rel="prev"/>
  <link href="https://dx.doi.org/10.17487/rfc9605" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  </head>
<body class="xml2rfc">
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9605</td>
<td class="center">SFrame</td>
<td class="right">August 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Omara, et al.</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc9605">9605</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2024-08">August 2024</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">E. Omara</div>
<div class="org">Apple</div>
</div>
<div class="author">
      <div class="author-name">J. Uberti</div>
<div class="org">Fixie.ai</div>
</div>
<div class="author">
      <div class="author-name">S. G. Murillo</div>
<div class="org">CoSMo Software</div>
</div>
<div class="author">
      <div class="author-name">R. Barnes, <span class="editor">Ed.</span>
</div>
<div class="org">Cisco</div>
</div>
<div class="author">
      <div class="author-name">Y. Fablet</div>
<div class="org">Apple</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9605</h1>
<h1 id="title">Secure Frame (SFrame): Lightweight Authenticated Encryption for Realâ€‘Time Media</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">This document describes the Secure Frame (SFrame) end-to-end encryption and
authentication mechanism for media frames in a multiparty conference call, in
which central media servers (Selective Forwarding Units or SFUs) can access the
media metadata needed to make forwarding decisions without having access to the
actual media.<a class="pilcrow" href="#section-abstract-1">Â¶</a></p>
<p id="section-abstract-2">This mechanism differs from the Secure Real-Time Protocol (SRTP) in that
it is independent of RTP (thus compatible with non-RTP media transport) and can
be applied to whole media frames in order to be more bandwidth efficient.<a class="pilcrow" href="#section-abstract-2">Â¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a class="pilcrow" href="#section-boilerplate.1-1">Â¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">Â¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9605">https://www.rfc-editor.org/info/rfc9605</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">Â¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">Â¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">Â¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">â–²</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p class="keepWithNext" id="section-toc.1-1.1.1"><a class="auto internal xref" href="#section-1">1</a>.Â Â <a class="internal xref" href="#name-introduction">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p class="keepWithNext" id="section-toc.1-1.2.1"><a class="auto internal xref" href="#section-2">2</a>.Â Â <a class="internal xref" href="#name-terminology">Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p class="keepWithNext" id="section-toc.1-1.3.1"><a class="auto internal xref" href="#section-3">3</a>.Â Â <a class="internal xref" href="#name-goals">Goals</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="auto internal xref" href="#section-4">4</a>.Â Â <a class="internal xref" href="#name-sframe">SFrame</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a class="auto internal xref" href="#section-4.1">4.1</a>.Â Â <a class="internal xref" href="#name-application-context">Application Context</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a class="auto internal xref" href="#section-4.2">4.2</a>.Â Â <a class="internal xref" href="#name-sframe-ciphertext">SFrame Ciphertext</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a class="auto internal xref" href="#section-4.3">4.3</a>.Â Â <a class="internal xref" href="#name-sframe-header">SFrame Header</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a class="auto internal xref" href="#section-4.4">4.4</a>.Â Â <a class="internal xref" href="#name-encryption-schema">Encryption Schema</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.1">
                    <p id="section-toc.1-1.4.2.4.2.1.1"><a class="auto internal xref" href="#section-4.4.1">4.4.1</a>.Â Â <a class="internal xref" href="#name-key-selection">Key Selection</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.2">
                    <p id="section-toc.1-1.4.2.4.2.2.1"><a class="auto internal xref" href="#section-4.4.2">4.4.2</a>.Â Â <a class="internal xref" href="#name-key-derivation">Key Derivation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.3">
                    <p id="section-toc.1-1.4.2.4.2.3.1"><a class="auto internal xref" href="#section-4.4.3">4.4.3</a>.Â Â <a class="internal xref" href="#name-encryption">Encryption</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.4">
                    <p id="section-toc.1-1.4.2.4.2.4.1"><a class="auto internal xref" href="#section-4.4.4">4.4.4</a>.Â Â <a class="internal xref" href="#name-decryption">Decryption</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a class="auto internal xref" href="#section-4.5">4.5</a>.Â Â <a class="internal xref" href="#name-cipher-suites">Cipher Suites</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5.2.1">
                    <p id="section-toc.1-1.4.2.5.2.1.1"><a class="auto internal xref" href="#section-4.5.1">4.5.1</a>.Â Â <a class="internal xref" href="#name-aes-ctr-with-sha2">AES-CTR with SHA2</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="auto internal xref" href="#section-5">5</a>.Â Â <a class="internal xref" href="#name-key-management">Key Management</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a class="auto internal xref" href="#section-5.1">5.1</a>.Â Â <a class="internal xref" href="#name-sender-keys">Sender Keys</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a class="auto internal xref" href="#section-5.2">5.2</a>.Â Â <a class="internal xref" href="#name-mls">MLS</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="auto internal xref" href="#section-6">6</a>.Â Â <a class="internal xref" href="#name-media-considerations">Media Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a class="auto internal xref" href="#section-6.1">6.1</a>.Â Â <a class="internal xref" href="#name-selective-forwarding-units">Selective Forwarding Units</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.1">
                    <p id="section-toc.1-1.6.2.1.2.1.1"><a class="auto internal xref" href="#section-6.1.1">6.1.1</a>.Â Â <a class="internal xref" href="#name-rtp-stream-reuse">RTP Stream Reuse</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.2">
                    <p id="section-toc.1-1.6.2.1.2.2.1"><a class="auto internal xref" href="#section-6.1.2">6.1.2</a>.Â Â <a class="internal xref" href="#name-simulcast">Simulcast</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.3">
                    <p id="section-toc.1-1.6.2.1.2.3.1"><a class="auto internal xref" href="#section-6.1.3">6.1.3</a>.Â Â <a class="internal xref" href="#name-scalable-video-coding-svc">Scalable Video Coding (SVC)</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a class="auto internal xref" href="#section-6.2">6.2</a>.Â Â <a class="internal xref" href="#name-video-key-frames">Video Key Frames</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a class="auto internal xref" href="#section-6.3">6.3</a>.Â Â <a class="internal xref" href="#name-partial-decoding">Partial Decoding</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="auto internal xref" href="#section-7">7</a>.Â Â <a class="internal xref" href="#name-security-considerations">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a class="auto internal xref" href="#section-7.1">7.1</a>.Â Â <a class="internal xref" href="#name-no-header-confidentiality">No Header Confidentiality</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a class="auto internal xref" href="#section-7.2">7.2</a>.Â Â <a class="internal xref" href="#name-no-per-sender-authenticatio">No Per-Sender Authentication</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a class="auto internal xref" href="#section-7.3">7.3</a>.Â Â <a class="internal xref" href="#name-key-management-2">Key Management</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a class="auto internal xref" href="#section-7.4">7.4</a>.Â Â <a class="internal xref" href="#name-replay">Replay</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5">
                <p id="section-toc.1-1.7.2.5.1"><a class="auto internal xref" href="#section-7.5">7.5</a>.Â Â <a class="internal xref" href="#name-risks-due-to-short-tags">Risks Due to Short Tags</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="auto internal xref" href="#section-8">8</a>.Â Â <a class="internal xref" href="#name-iana-considerations">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a class="auto internal xref" href="#section-8.1">8.1</a>.Â Â <a class="internal xref" href="#name-sframe-cipher-suites">SFrame Cipher Suites</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="auto internal xref" href="#section-9">9</a>.Â Â <a class="internal xref" href="#name-application-responsibilitie">Application Responsibilities</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a class="auto internal xref" href="#section-9.1">9.1</a>.Â Â <a class="internal xref" href="#name-header-value-uniqueness">Header Value Uniqueness</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a class="auto internal xref" href="#section-9.2">9.2</a>.Â Â <a class="internal xref" href="#name-key-management-framework">Key Management Framework</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a class="auto internal xref" href="#section-9.3">9.3</a>.Â Â <a class="internal xref" href="#name-anti-replay">Anti-Replay</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4">
                <p id="section-toc.1-1.9.2.4.1"><a class="auto internal xref" href="#section-9.4">9.4</a>.Â Â <a class="internal xref" href="#name-metadata">Metadata</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a class="auto internal xref" href="#section-10">10</a>.Â <a class="internal xref" href="#name-references">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a class="auto internal xref" href="#section-10.1">10.1</a>.Â Â <a class="internal xref" href="#name-normative-references">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a class="auto internal xref" href="#section-10.2">10.2</a>.Â Â <a class="internal xref" href="#name-informative-references">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a class="auto internal xref" href="#appendix-A">Appendix A</a>.Â Â <a class="internal xref" href="#name-example-api">Example API</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a class="auto internal xref" href="#appendix-B">Appendix B</a>.Â Â <a class="internal xref" href="#name-overhead-analysis">Overhead Analysis</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a class="auto internal xref" href="#appendix-B.1">B.1</a>.Â Â <a class="internal xref" href="#name-assumptions">Assumptions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a class="auto internal xref" href="#appendix-B.2">B.2</a>.Â Â <a class="internal xref" href="#name-audio">Audio</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.3">
                <p id="section-toc.1-1.12.2.3.1"><a class="auto internal xref" href="#appendix-B.3">B.3</a>.Â Â <a class="internal xref" href="#name-video">Video</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.4">
                <p id="section-toc.1-1.12.2.4.1"><a class="auto internal xref" href="#appendix-B.4">B.4</a>.Â Â <a class="internal xref" href="#name-conferences">Conferences</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.5">
                <p id="section-toc.1-1.12.2.5.1"><a class="auto internal xref" href="#appendix-B.5">B.5</a>.Â Â <a class="internal xref" href="#name-sframe-over-rtp">SFrame over RTP</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a class="auto internal xref" href="#appendix-C">Appendix C</a>.Â Â <a class="internal xref" href="#name-test-vectors">Test Vectors</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a class="auto internal xref" href="#appendix-C.1">C.1</a>.Â Â <a class="internal xref" href="#name-header-encoding-decoding">Header Encoding/Decoding</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a class="auto internal xref" href="#appendix-C.2">C.2</a>.Â Â <a class="internal xref" href="#name-aead-encryption-decryption-">AEAD Encryption/Decryption Using AES-CTR and HMAC</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.3">
                <p id="section-toc.1-1.13.2.3.1"><a class="auto internal xref" href="#appendix-C.3">C.3</a>.Â Â <a class="internal xref" href="#name-sframe-encryption-decryptio">SFrame Encryption/Decryption</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a class="auto internal xref" href="#appendix-D"></a><a class="internal xref" href="#name-acknowledgements">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a class="auto internal xref" href="#appendix-E"></a><a class="internal xref" href="#name-contributors">Contributors</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a class="auto internal xref" href="#appendix-F"></a><a class="internal xref" href="#name-authors-addresses">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">Modern multiparty video call systems use Selective Forwarding Unit (SFU)
servers to efficiently route media streams to call endpoints based on factors such
as available bandwidth, desired video size, codec support, and other factors. An
SFU typically does not need access to the media content of the conference,
which allows the media to be encrypted "end to end" so that it cannot be
decrypted by the SFU. In order for the SFU to work properly, though, it usually
needs to be able to access RTP metadata and RTCP feedback messages, which is not
possible if all RTP/RTCP traffic is end-to-end encrypted.<a class="pilcrow" href="#section-1-1">Â¶</a></p>
<p id="section-1-2">As such, two layers of encryption and authentication are required:<a class="pilcrow" href="#section-1-2">Â¶</a></p>
<ol class="normal type-1" id="section-1-3" start="1" type="1">
<li id="section-1-3.1">
          <p id="section-1-3.1.1">Hop-by-hop (HBH) encryption of media, metadata, and feedback messages
between the endpoints and SFU<a class="pilcrow" href="#section-1-3.1.1">Â¶</a></p>
</li>
        <li id="section-1-3.2">
          <p id="section-1-3.2.1">End-to-end (E2E) encryption (E2EE) of media between the endpoints<a class="pilcrow" href="#section-1-3.2.1">Â¶</a></p>
</li>
      </ol>
<p id="section-1-4">The Secure Real-Time Protocol (SRTP) is already widely used for HBH encryption
<span>[<a class="cite xref" href="#RFC3711">RFC3711</a>]</span>. The SRTP "double encryption" scheme defines a way to do E2E
encryption in SRTP <span>[<a class="cite xref" href="#RFC8723">RFC8723</a>]</span>. Unfortunately, this scheme has poor efficiency
and high complexity, and its entanglement with RTP makes it unworkable in
several realistic SFU scenarios.<a class="pilcrow" href="#section-1-4">Â¶</a></p>
<p id="section-1-5">This document proposes a new E2EE protection scheme known as SFrame,
specifically designed to work in group conference calls with SFUs. SFrame is a
general encryption framing that can be used to protect media payloads, agnostic
of transport.<a class="pilcrow" href="#section-1-5">Â¶</a></p>
</section>
</div>
<div id="terminology">
<section id="section-2">
      <h2 id="name-terminology">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-terminology">Terminology</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>",
        "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>",
        "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>",
        "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
        "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be
        interpreted as described in BCPÂ 14 <span>[<a class="cite xref" href="#RFC2119">RFC2119</a>]</span> <span>[<a class="cite xref" href="#RFC8174">RFC8174</a>]</span> when, and only when, they appear in all capitals, as
        shown here.<a class="pilcrow" href="#section-2-1">Â¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2-2">
        <dt id="section-2-2.1">MAC:</dt>
        <dd id="section-2-2.2" style="margin-left: 1.5em">
          <p id="section-2-2.2.1">Message Authentication Code<a class="pilcrow" href="#section-2-2.2.1">Â¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.3">E2EE:</dt>
        <dd id="section-2-2.4" style="margin-left: 1.5em">
          <p id="section-2-2.4.1">End-to-End Encryption<a class="pilcrow" href="#section-2-2.4.1">Â¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.5">HBH:</dt>
        <dd id="section-2-2.6" style="margin-left: 1.5em">
          <p id="section-2-2.6.1">Hop-by-Hop<a class="pilcrow" href="#section-2-2.6.1">Â¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-2-3">We use "Selective Forwarding Unit (SFU)" and "media stream" in a less formal sense
than in <span>[<a class="cite xref" href="#RFC7656">RFC7656</a>]</span>.  An SFU is a selective switching function for media
payloads, and a media stream is a sequence of media payloads,
regardless of whether those media payloads are transported over RTP or some
other protocol.<a class="pilcrow" href="#section-2-3">Â¶</a></p>
</section>
</div>
<div id="goals">
<section id="section-3">
      <h2 id="name-goals">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-goals">Goals</a>
      </h2>
<p id="section-3-1">SFrame is designed to be a suitable E2EE protection scheme for conference call
media in a broad range of scenarios, as outlined by the following goals:<a class="pilcrow" href="#section-3-1">Â¶</a></p>
<ol class="normal type-1" id="section-3-2" start="1" type="1">
<li id="section-3-2.1">
          <p id="section-3-2.1.1">Provide a secure E2EE mechanism for audio and video in conference calls
that can be used with arbitrary SFU servers.<a class="pilcrow" href="#section-3-2.1.1">Â¶</a></p>
</li>
        <li id="section-3-2.2">
          <p id="section-3-2.2.1">Decouple media encryption from key management to allow SFrame to be used
with an arbitrary key management system.<a class="pilcrow" href="#section-3-2.2.1">Â¶</a></p>
</li>
        <li id="section-3-2.3">
          <p id="section-3-2.3.1">Minimize packet expansion to allow successful conferencing in as many
network conditions as possible.<a class="pilcrow" href="#section-3-2.3.1">Â¶</a></p>
</li>
        <li id="section-3-2.4">
          <p id="section-3-2.4.1">Decouple the media encryption framework from the underlying transport,
allowing use in non-RTP scenarios, e.g., WebTransport
<span>[<a class="cite xref" href="#I-D.ietf-webtrans-overview">WEBTRANSPORT</a>]</span>.<a class="pilcrow" href="#section-3-2.4.1">Â¶</a></p>
</li>
        <li id="section-3-2.5">
          <p id="section-3-2.5.1">When used with RTP and its associated error-resilience mechanisms, i.e., RTX
and Forward Error Correction (FEC), require no special handling for RTX and FEC packets.<a class="pilcrow" href="#section-3-2.5.1">Â¶</a></p>
</li>
        <li id="section-3-2.6">
          <p id="section-3-2.6.1">Minimize the changes needed in SFU servers.<a class="pilcrow" href="#section-3-2.6.1">Â¶</a></p>
</li>
        <li id="section-3-2.7">
          <p id="section-3-2.7.1">Minimize the changes needed in endpoints.<a class="pilcrow" href="#section-3-2.7.1">Â¶</a></p>
</li>
        <li id="section-3-2.8">
          <p id="section-3-2.8.1">Work with the most popular audio and video codecs used in conferencing
scenarios.<a class="pilcrow" href="#section-3-2.8.1">Â¶</a></p>
</li>
      </ol>
</section>
</div>
<div id="sframe">
<section id="section-4">
      <h2 id="name-sframe">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-sframe">SFrame</a>
      </h2>
<p id="section-4-1">This document defines an encryption mechanism that provides effective E2EE,
is simple to implement, has no dependencies on RTP, and minimizes
encryption bandwidth overhead. This section describes how the mechanism
works and includes details of how applications utilize SFrame for media protection
as well as the actual mechanics of E2EE for protecting media.<a class="pilcrow" href="#section-4-1">Â¶</a></p>
<div id="application-context">
<section id="section-4.1">
        <h3 id="name-application-context">
<a class="section-number selfRef" href="#section-4.1">4.1. </a><a class="section-name selfRef" href="#name-application-context">Application Context</a>
        </h3>
<p id="section-4.1-1">SFrame is a general encryption framing, intended to be used as an E2EE
layer over an underlying HBH-encrypted transport such as SRTP or QUIC
<span>[<a class="cite xref" href="#RFC3711">RFC3711</a>]</span><span>[<a class="cite xref" href="#I-D.ietf-moq-transport">MOQ-TRANSPORT</a>]</span>.<a class="pilcrow" href="#section-4.1-1">Â¶</a></p>
<p id="section-4.1-2">The scale at which SFrame encryption is applied to media determines the overall
amount of overhead that SFrame adds to the media stream as well as the
engineering complexity involved in integrating SFrame into a particular
environment. Two patterns are common: using SFrame to encrypt either whole
media frames (per frame) or individual transport-level media payloads
(per packet).<a class="pilcrow" href="#section-4.1-2">Â¶</a></p>
<p id="section-4.1-3">For example, <a class="auto internal xref" href="#media-stack">Figure 1</a> shows a typical media sender stack that takes media
from some source, encodes it into frames, divides those frames into media
packets, and then sends those payloads in SRTP packets. The receiver stack
performs the reverse operations, reassembling frames from SRTP packets and
decoding.  Arrows indicate two different ways that SFrame protection could be
integrated into this media stack: to encrypt whole frames or individual media
packets.<a class="pilcrow" href="#section-4.1-3">Â¶</a></p>
<p id="section-4.1-4">Applying SFrame per frame in this system offers higher efficiency but may
require a more complex integration in environments where depacketization relies
on the content of media packets. Applying SFrame per packet avoids this
complexity at the cost of higher bandwidth consumption.  Some quantitative
discussion of these trade-offs is provided in <a class="auto internal xref" href="#overhead-analysis">Appendix B</a>.<a class="pilcrow" href="#section-4.1-4">Â¶</a></p>
<p id="section-4.1-5">As noted above, however, SFrame is a general media encapsulation and can be
applied in other scenarios.  The important thing is that the sender and
receivers of an SFrame-encrypted object agree on that object's semantics.
SFrame does not provide this agreement; it must be arranged by the application.<a class="pilcrow" href="#section-4.1-5">Â¶</a></p>
<span id="name-two-options-for-integrating"></span><div id="media-stack">
<figure id="figure-1">
          <div id="section-4.1-6.1">
            <div class="alignLeft art-svg artwork" id="section-4.1-6.1.1">
<svg class="diagram" font-family="monospace" font-size="13px" height="576" stroke-linecap="round" text-anchor="middle" version="1.1" viewBox="0 0 584 576" width="584" xmlns="http://www.w3.org/2000/svg">
                <path d="M 24,112 L 24,144" fill="none" stroke="black"></path>
                <path d="M 24,432 L 24,464" fill="none" stroke="black"></path>
                <path d="M 56,32 L 56,240" fill="none" stroke="black"></path>
                <path d="M 56,352 L 56,560" fill="none" stroke="black"></path>
                <path d="M 80,64 L 80,128" fill="none" stroke="black"></path>
                <path d="M 80,464 L 80,528" fill="none" stroke="black"></path>
                <path d="M 152,64 L 152,128" fill="none" stroke="black"></path>
                <path d="M 152,464 L 152,528" fill="none" stroke="black"></path>
                <path d="M 184,104 L 184,144" fill="none" stroke="black"></path>
                <path d="M 184,208 L 184,384" fill="none" stroke="black"></path>
                <path d="M 184,448 L 184,488" fill="none" stroke="black"></path>
                <path d="M 208,64 L 208,128" fill="none" stroke="black"></path>
                <path d="M 208,464 L 208,528" fill="none" stroke="black"></path>
                <path d="M 320,64 L 320,128" fill="none" stroke="black"></path>
                <path d="M 320,464 L 320,528" fill="none" stroke="black"></path>
                <path d="M 344,104 L 344,144" fill="none" stroke="black"></path>
                <path d="M 344,208 L 344,384" fill="none" stroke="black"></path>
                <path d="M 352,448 L 352,488" fill="none" stroke="black"></path>
                <path d="M 376,64 L 376,128" fill="none" stroke="black"></path>
                <path d="M 376,464 L 376,528" fill="none" stroke="black"></path>
                <path d="M 424,136 L 424,272" fill="none" stroke="black"></path>
                <path d="M 424,320 L 424,456" fill="none" stroke="black"></path>
                <path d="M 472,64 L 472,128" fill="none" stroke="black"></path>
                <path d="M 472,464 L 472,528" fill="none" stroke="black"></path>
                <path d="M 496,32 L 496,88" fill="none" stroke="black"></path>
                <path d="M 496,104 L 496,240" fill="none" stroke="black"></path>
                <path d="M 496,352 L 496,488" fill="none" stroke="black"></path>
                <path d="M 496,504 L 496,560" fill="none" stroke="black"></path>
                <path d="M 504,272 L 504,320" fill="none" stroke="black"></path>
                <path d="M 560,96 L 560,264" fill="none" stroke="black"></path>
                <path d="M 560,320 L 560,496" fill="none" stroke="black"></path>
                <path d="M 576,272 L 576,320" fill="none" stroke="black"></path>
                <path d="M 56,32 L 496,32" fill="none" stroke="black"></path>
                <path d="M 80,64 L 152,64" fill="none" stroke="black"></path>
                <path d="M 208,64 L 320,64" fill="none" stroke="black"></path>
                <path d="M 376,64 L 472,64" fill="none" stroke="black"></path>
                <path d="M 160,96 L 200,96" fill="none" stroke="black"></path>
                <path d="M 328,96 L 368,96" fill="none" stroke="black"></path>
                <path d="M 480,96 L 560,96" fill="none" stroke="black"></path>
                <path d="M 80,128 L 152,128" fill="none" stroke="black"></path>
                <path d="M 208,128 L 320,128" fill="none" stroke="black"></path>
                <path d="M 376,128 L 472,128" fill="none" stroke="black"></path>
                <path d="M 56,240 L 176,240" fill="none" stroke="black"></path>
                <path d="M 192,240 L 336,240" fill="none" stroke="black"></path>
                <path d="M 352,240 L 416,240" fill="none" stroke="black"></path>
                <path d="M 432,240 L 496,240" fill="none" stroke="black"></path>
                <path d="M 504,272 L 576,272" fill="none" stroke="black"></path>
                <path d="M 184,304 L 216,304" fill="none" stroke="black"></path>
                <path d="M 320,304 L 344,304" fill="none" stroke="black"></path>
                <path d="M 504,320 L 576,320" fill="none" stroke="black"></path>
                <path d="M 56,352 L 176,352" fill="none" stroke="black"></path>
                <path d="M 192,352 L 336,352" fill="none" stroke="black"></path>
                <path d="M 352,352 L 416,352" fill="none" stroke="black"></path>
                <path d="M 432,352 L 496,352" fill="none" stroke="black"></path>
                <path d="M 80,464 L 152,464" fill="none" stroke="black"></path>
                <path d="M 208,464 L 320,464" fill="none" stroke="black"></path>
                <path d="M 376,464 L 472,464" fill="none" stroke="black"></path>
                <path d="M 160,496 L 200,496" fill="none" stroke="black"></path>
                <path d="M 328,496 L 368,496" fill="none" stroke="black"></path>
                <path d="M 480,496 L 560,496" fill="none" stroke="black"></path>
                <path d="M 80,528 L 152,528" fill="none" stroke="black"></path>
                <path d="M 208,528 L 320,528" fill="none" stroke="black"></path>
                <path d="M 376,528 L 472,528" fill="none" stroke="black"></path>
                <path d="M 56,560 L 496,560" fill="none" stroke="black"></path>
                <path d="M 24,464 L 40,496" fill="none" stroke="black"></path>
                <path d="M 24,432 L 40,464" fill="none" stroke="black"></path>
                <path d="M 24,144 L 40,176" fill="none" stroke="black"></path>
                <path d="M 24,112 L 40,144" fill="none" stroke="black"></path>
                <path d="M 8,144 L 24,112" fill="none" stroke="black"></path>
                <path d="M 8,176 L 24,144" fill="none" stroke="black"></path>
                <path d="M 8,464 L 24,432" fill="none" stroke="black"></path>
                <path d="M 8,496 L 24,464" fill="none" stroke="black"></path>
                <path d="M 24,80 C 15.16936,80 8,87.16936 8,96" fill="none" stroke="black"></path>
                <path d="M 24,80 C 32.83064,80 40,87.16936 40,96" fill="none" stroke="black"></path>
                <path d="M 24,112 C 15.16936,112 8,104.83064 8,96" fill="none" stroke="black"></path>
                <path d="M 24,112 C 32.83064,112 40,104.83064 40,96" fill="none" stroke="black"></path>
                <path d="M 24,400 C 15.16936,400 8,407.16936 8,416" fill="none" stroke="black"></path>
                <path d="M 24,400 C 32.83064,400 40,407.16936 40,416" fill="none" stroke="black"></path>
                <path d="M 24,432 C 15.16936,432 8,424.83064 8,416" fill="none" stroke="black"></path>
                <path d="M 24,432 C 32.83064,432 40,424.83064 40,416" fill="none" stroke="black"></path>
                <polygon class="arrowhead" fill="black" points="568,264 556,258.4 556,269.6" transform="rotate(90,560,264)"></polygon>
                <polygon class="arrowhead" fill="black" points="488,496 476,490.4 476,501.6" transform="rotate(180,480,496)"></polygon>
                <polygon class="arrowhead" fill="black" points="432,456 420,450.4 420,461.6" transform="rotate(90,424,456)"></polygon>
                <polygon class="arrowhead" fill="black" points="432,136 420,130.4 420,141.6" transform="rotate(270,424,136)"></polygon>
                <polygon class="arrowhead" fill="black" points="376,96 364,90.4 364,101.6" transform="rotate(0,368,96)"></polygon>
                <polygon class="arrowhead" fill="black" points="360,488 348,482.4 348,493.6" transform="rotate(90,352,488)"></polygon>
                <polygon class="arrowhead" fill="black" points="352,384 340,378.4 340,389.6" transform="rotate(90,344,384)"></polygon>
                <polygon class="arrowhead" fill="black" points="352,208 340,202.4 340,213.6" transform="rotate(270,344,208)"></polygon>
                <polygon class="arrowhead" fill="black" points="352,104 340,98.4 340,109.6" transform="rotate(270,344,104)"></polygon>
                <polygon class="arrowhead" fill="black" points="336,496 324,490.4 324,501.6" transform="rotate(180,328,496)"></polygon>
                <polygon class="arrowhead" fill="black" points="208,96 196,90.4 196,101.6" transform="rotate(0,200,96)"></polygon>
                <polygon class="arrowhead" fill="black" points="192,488 180,482.4 180,493.6" transform="rotate(90,184,488)"></polygon>
                <polygon class="arrowhead" fill="black" points="192,384 180,378.4 180,389.6" transform="rotate(90,184,384)"></polygon>
                <polygon class="arrowhead" fill="black" points="192,208 180,202.4 180,213.6" transform="rotate(270,184,208)"></polygon>
                <polygon class="arrowhead" fill="black" points="192,104 180,98.4 180,109.6" transform="rotate(270,184,104)"></polygon>
                <polygon class="arrowhead" fill="black" points="168,496 156,490.4 156,501.6" transform="rotate(180,160,496)"></polygon>
                <g class="text">
                  <text x="424" y="84">HBH</text>
                  <text x="116" y="100">Encode</text>
                  <text x="264" y="100">Packetize</text>
                  <text x="424" y="100">Protect</text>
                  <text x="180" y="164">SFrame</text>
                  <text x="340" y="164">SFrame</text>
                  <text x="184" y="180">Protect</text>
                  <text x="344" y="180">Protect</text>
                  <text x="24" y="196">Alice</text>
                  <text x="156" y="196">(per</text>
                  <text x="204" y="196">frame)</text>
                  <text x="316" y="196">(per</text>
                  <text x="368" y="196">packet)</text>
                  <text x="248" y="292">E2E</text>
                  <text x="280" y="292">Key</text>
                  <text x="416" y="292">HBH</text>
                  <text x="448" y="292">Key</text>
                  <text x="536" y="292">Media</text>
                  <text x="268" y="308">Management</text>
                  <text x="436" y="308">Management</text>
                  <text x="540" y="308">Server</text>
                  <text x="180" y="404">SFrame</text>
                  <text x="348" y="404">SFrame</text>
                  <text x="184" y="420">Unprotect</text>
                  <text x="352" y="420">Unprotect</text>
                  <text x="156" y="436">(per</text>
                  <text x="204" y="436">frame)</text>
                  <text x="324" y="436">(per</text>
                  <text x="376" y="436">packet)</text>
                  <text x="424" y="484">HBH</text>
                  <text x="116" y="500">Decode</text>
                  <text x="264" y="500">Depacketize</text>
                  <text x="424" y="500">Unprotect</text>
                  <text x="24" y="516">Bob</text>
                </g>
              </svg><a class="pilcrow" href="#section-4.1-6.1.1">Â¶</a>
</div>
</div>
<figcaption><a class="selfRef" href="#figure-1">Figure 1</a>:
<a class="selfRef" href="#name-two-options-for-integrating">Two Options for Integrating SFrame in a Typical Media Stack</a>
          </figcaption></figure>
</div>
<p id="section-4.1-7">Like SRTP, SFrame does not define how the keys used for SFrame are exchanged by
the parties in the conference.  Keys for SFrame might be distributed over an
existing E2E-secure channel (see <a class="auto internal xref" href="#sender-keys">Section 5.1</a>) or derived from an E2E-secure
shared secret (see <a class="auto internal xref" href="#mls">Section 5.2</a>).  The key management system <span class="bcp14">MUST</span> ensure that each
key used for encrypting media is used by exactly one media sender in order to
avoid reuse of nonces.<a class="pilcrow" href="#section-4.1-7">Â¶</a></p>
</section>
</div>
<div id="sframe-ciphertext">
<section id="section-4.2">
        <h3 id="name-sframe-ciphertext">
<a class="section-number selfRef" href="#section-4.2">4.2. </a><a class="section-name selfRef" href="#name-sframe-ciphertext">SFrame Ciphertext</a>
        </h3>
<p id="section-4.2-1">An SFrame ciphertext comprises an SFrame header followed by the output of an
Authenticated Encryption with Associated Data (AEAD) encryption of the plaintext <span>[<a class="cite xref" href="#RFC5116">RFC5116</a>]</span>, with the header provided as additional
authenticated data (AAD).<a class="pilcrow" href="#section-4.2-1">Â¶</a></p>
<p id="section-4.2-2">The SFrame header is a variable-length structure described in detail in
<a class="auto internal xref" href="#sframe-header">Section 4.3</a>.  The structure of the encrypted data and authentication tag
are determined by the AEAD algorithm in use.<a class="pilcrow" href="#section-4.2-2">Â¶</a></p>
<span id="name-structure-of-an-sframe-ciph"></span><div id="sframe-ciphertext-struct">
<figure id="figure-2">
          <div id="section-4.2-3.1">
            <div class="alignLeft art-svg artwork" id="section-4.2-3.1.1">
<svg class="diagram" font-family="monospace" font-size="13px" height="320" stroke-linecap="round" text-anchor="middle" version="1.1" viewBox="0 0 512 320" width="512" xmlns="http://www.w3.org/2000/svg">
                <path d="M 8,64 L 8,304" fill="none" stroke="black"></path>
                <path d="M 32,32 L 32,256" fill="none" stroke="black"></path>
                <path d="M 48,32 L 48,64" fill="none" stroke="black"></path>
                <path d="M 88,32 L 88,64" fill="none" stroke="black"></path>
                <path d="M 104,32 L 104,64" fill="none" stroke="black"></path>
                <path d="M 144,32 L 144,64" fill="none" stroke="black"></path>
                <path d="M 312,32 L 312,64" fill="none" stroke="black"></path>
                <path d="M 480,32 L 480,256" fill="none" stroke="black"></path>
                <path d="M 504,32 L 504,304" fill="none" stroke="black"></path>
                <path d="M 32,32 L 504,32" fill="none" stroke="black"></path>
                <path d="M 8,64 L 480,64" fill="none" stroke="black"></path>
                <path d="M 8,224 L 504,224" fill="none" stroke="black"></path>
                <path d="M 32,256 L 480,256" fill="none" stroke="black"></path>
                <path d="M 8,304 L 32,304" fill="none" stroke="black"></path>
                <path d="M 480,304 L 504,304" fill="none" stroke="black"></path>
                <polygon class="arrowhead" fill="black" points="496,224 484,218.4 484,229.6" transform="rotate(180,488,224)"></polygon>
                <polygon class="arrowhead" fill="black" points="496,32 484,26.4 484,37.6" transform="rotate(180,488,32)"></polygon>
                <polygon class="arrowhead" fill="black" points="32,224 20,218.4 20,229.6" transform="rotate(0,24,224)"></polygon>
                <polygon class="arrowhead" fill="black" points="32,64 20,58.4 20,69.6" transform="rotate(0,24,64)"></polygon>
                <g class="text">
                  <text x="40" y="52">K</text>
                  <text x="68" y="52">KLEN</text>
                  <text x="96" y="52">C</text>
                  <text x="124" y="52">CLEN</text>
                  <text x="216" y="52">Key</text>
                  <text x="244" y="52">ID</text>
                  <text x="392" y="52">Counter</text>
                  <text x="224" y="148">Encrypted</text>
                  <text x="284" y="148">Data</text>
                  <text x="228" y="244">Authentication</text>
                  <text x="304" y="244">Tag</text>
                  <text x="80" y="308">Encrypted</text>
                  <text x="152" y="308">Portion</text>
                  <text x="352" y="308">Authenticated</text>
                  <text x="440" y="308">Portion</text>
                </g>
              </svg><a class="pilcrow" href="#section-4.2-3.1.1">Â¶</a>
</div>
</div>
<figcaption><a class="selfRef" href="#figure-2">Figure 2</a>:
<a class="selfRef" href="#name-structure-of-an-sframe-ciph">Structure of an SFrame Ciphertext</a>
          </figcaption></figure>
</div>
<p id="section-4.2-4">When SFrame is applied per packet, the payload of each packet will be an SFrame
ciphertext.  When SFrame is applied per frame, the SFrame ciphertext
representing an encrypted frame will span several packets, with the header
appearing in the first packet and the authentication tag in the last packet.
It is the responsibility of the application to reassemble an encrypted frame from
individual packets, accounting for packet loss and reordering as necessary.<a class="pilcrow" href="#section-4.2-4">Â¶</a></p>
</section>
</div>
<div id="sframe-header">
<section id="section-4.3">
        <h3 id="name-sframe-header">
<a class="section-number selfRef" href="#section-4.3">4.3. </a><a class="section-name selfRef" href="#name-sframe-header">SFrame Header</a>
        </h3>
<p id="section-4.3-1">The SFrame header specifies two values from which encryption parameters are
derived:<a class="pilcrow" href="#section-4.3-1">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3-2.1">
            <p id="section-4.3-2.1.1">A Key ID (KID) that determines which encryption key should be used<a class="pilcrow" href="#section-4.3-2.1.1">Â¶</a></p>
</li>
          <li class="normal" id="section-4.3-2.2">
            <p id="section-4.3-2.2.1">A Counter (CTR) that is used to construct the nonce for the encryption<a class="pilcrow" href="#section-4.3-2.2.1">Â¶</a></p>
</li>
        </ul>
<p id="section-4.3-3">Applications <span class="bcp14">MUST</span> ensure that each (KID, CTR) combination is used for exactly
one SFrame encryption operation. A typical approach to achieve this guarantee is
outlined in <a class="auto internal xref" href="#header-value-uniqueness">Section 9.1</a>.<a class="pilcrow" href="#section-4.3-3">Â¶</a></p>
<span id="name-sframe-header-2"></span><div id="fig-sframe-header">
<figure id="figure-3">
          <div id="section-4.3-4.1">
            <div class="alignLeft art-svg artwork" id="section-4.3-4.1.1">
<svg class="diagram" font-family="monospace" font-size="13px" height="160" stroke-linecap="round" text-anchor="middle" version="1.1" viewBox="0 0 352 160" width="352" xmlns="http://www.w3.org/2000/svg">
                <path d="M 8,112 L 8,144" fill="none" stroke="black"></path>
                <path d="M 24,112 L 24,144" fill="none" stroke="black"></path>
                <path d="M 72,112 L 72,144" fill="none" stroke="black"></path>
                <path d="M 88,112 L 88,144" fill="none" stroke="black"></path>
                <path d="M 136,112 L 136,144" fill="none" stroke="black"></path>
                <path d="M 240,112 L 240,144" fill="none" stroke="black"></path>
                <path d="M 344,112 L 344,144" fill="none" stroke="black"></path>
                <path d="M 24,64 L 56,64" fill="none" stroke="black"></path>
                <path d="M 88,64 L 120,64" fill="none" stroke="black"></path>
                <path d="M 8,112 L 344,112" fill="none" stroke="black"></path>
                <path d="M 8,144 L 344,144" fill="none" stroke="black"></path>
                <path d="M 24,64 C 15.16936,64 8,71.16936 8,80" fill="none" stroke="black"></path>
                <path d="M 56,64 C 64.83064,64 72,56.83064 72,48" fill="none" stroke="black"></path>
                <path d="M 88,64 C 79.16936,64 72,56.83064 72,48" fill="none" stroke="black"></path>
                <path d="M 120,64 C 128.83064,64 136,71.16936 136,80" fill="none" stroke="black"></path>
                <g class="text">
                  <text x="52" y="36">Config</text>
                  <text x="100" y="36">Byte</text>
                  <text x="16" y="100">0</text>
                  <text x="32" y="100">1</text>
                  <text x="48" y="100">2</text>
                  <text x="64" y="100">3</text>
                  <text x="80" y="100">4</text>
                  <text x="96" y="100">5</text>
                  <text x="112" y="100">6</text>
                  <text x="128" y="100">7</text>
                  <text x="16" y="132">X</text>
                  <text x="48" y="132">K</text>
                  <text x="80" y="132">Y</text>
                  <text x="112" y="132">C</text>
                  <text x="188" y="132">KID...</text>
                  <text x="292" y="132">CTR...</text>
                </g>
              </svg><a class="pilcrow" href="#section-4.3-4.1.1">Â¶</a>
</div>
</div>
<figcaption><a class="selfRef" href="#figure-3">Figure 3</a>:
<a class="selfRef" href="#name-sframe-header-2">SFrame Header</a>
          </figcaption></figure>
</div>
<p id="section-4.3-5">The SFrame header has the overall structure shown in <a class="auto internal xref" href="#fig-sframe-header">Figure 3</a>.  The
first byte is a "config byte", with the following fields:<a class="pilcrow" href="#section-4.3-5">Â¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.3-6">
          <dt id="section-4.3-6.1">Extended KID Flag (X, 1 bit):</dt>
          <dd id="section-4.3-6.2" style="margin-left: 1.5em">
            <p id="section-4.3-6.2.1">Indicates if the K field contains the KID or the KID length.<a class="pilcrow" href="#section-4.3-6.2.1">Â¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-4.3-6.3">KID or KID Length (K, 3 bits):</dt>
          <dd id="section-4.3-6.4" style="margin-left: 1.5em">
            <p id="section-4.3-6.4.1">If the X flag is set to 0, this field contains the KID.  If the X flag is
set to 1, then it contains the length of the KID, minus one.<a class="pilcrow" href="#section-4.3-6.4.1">Â¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-4.3-6.5">Extended CTR Flag (Y, 1 bit):</dt>
          <dd id="section-4.3-6.6" style="margin-left: 1.5em">
            <p id="section-4.3-6.6.1">Indicates if the C field contains the CTR or the CTR length.<a class="pilcrow" href="#section-4.3-6.6.1">Â¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-4.3-6.7">CTR or CTR Length (C, 3 bits):</dt>
          <dd id="section-4.3-6.8" style="margin-left: 1.5em">
            <p id="section-4.3-6.8.1">This field contains the CTR if the Y flag is set to 0, or the CTR
length, minus one, if set to 1.<a class="pilcrow" href="#section-4.3-6.8.1">Â¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.3-7">The KID and CTR fields are encoded as compact unsigned integers in
network (big-endian) byte order.  If the value of one of these fields is in the
range 0-7, then the value is carried in the corresponding bits of the config
byte (K or C) and the corresponding flag (X or Y) is set to zero.  Otherwise,
the value <span class="bcp14">MUST</span> be encoded with the minimum number of bytes required and
appended after the config byte, with the KID first and CTR second.
The header field (K or C) is set to the number of bytes in the encoded value,
minus one.  The value 000 represents a length of 1, 001 a length of 2, etc.
This allows a 3-bit length field to represent the value lengths 1-8.<a class="pilcrow" href="#section-4.3-7">Â¶</a></p>
<p id="section-4.3-8">The SFrame header can thus take one of the four forms shown in
<a class="auto internal xref" href="#fig-sframe-header-cases">Figure 4</a>, depending on which of the X and Y flags are set.<a class="pilcrow" href="#section-4.3-8">Â¶</a></p>
<span id="name-forms-of-encoded-sframe-hea"></span><div id="fig-sframe-header-cases">
<figure id="figure-4">
          <div id="section-4.3-9.1">
            <div class="alignLeft art-svg artwork" id="section-4.3-9.1.1">
<svg class="diagram" font-family="monospace" font-size="13px" height="336" stroke-linecap="round" text-anchor="middle" version="1.1" viewBox="0 0 544 336" width="544" xmlns="http://www.w3.org/2000/svg">
                <path d="M 8,48 L 8,80" fill="none" stroke="black"></path>
                <path d="M 8,128 L 8,160" fill="none" stroke="black"></path>
                <path d="M 8,208 L 8,240" fill="none" stroke="black"></path>
                <path d="M 8,288 L 8,320" fill="none" stroke="black"></path>
                <path d="M 24,48 L 24,80" fill="none" stroke="black"></path>
                <path d="M 24,128 L 24,160" fill="none" stroke="black"></path>
                <path d="M 24,208 L 24,240" fill="none" stroke="black"></path>
                <path d="M 24,288 L 24,320" fill="none" stroke="black"></path>
                <path d="M 72,48 L 72,80" fill="none" stroke="black"></path>
                <path d="M 72,128 L 72,160" fill="none" stroke="black"></path>
                <path d="M 72,192 L 72,240" fill="none" stroke="black"></path>
                <path d="M 72,272 L 72,320" fill="none" stroke="black"></path>
                <path d="M 88,48 L 88,80" fill="none" stroke="black"></path>
                <path d="M 88,128 L 88,160" fill="none" stroke="black"></path>
                <path d="M 88,208 L 88,240" fill="none" stroke="black"></path>
                <path d="M 88,288 L 88,320" fill="none" stroke="black"></path>
                <path d="M 136,48 L 136,80" fill="none" stroke="black"></path>
                <path d="M 136,128 L 136,160" fill="none" stroke="black"></path>
                <path d="M 136,208 L 136,240" fill="none" stroke="black"></path>
                <path d="M 136,288 L 136,320" fill="none" stroke="black"></path>
                <path d="M 336,128 L 336,160" fill="none" stroke="black"></path>
                <path d="M 336,208 L 336,240" fill="none" stroke="black"></path>
                <path d="M 336,288 L 336,320" fill="none" stroke="black"></path>
                <path d="M 536,288 L 536,320" fill="none" stroke="black"></path>
                <path d="M 8,48 L 136,48" fill="none" stroke="black"></path>
                <path d="M 8,80 L 136,80" fill="none" stroke="black"></path>
                <path d="M 8,128 L 336,128" fill="none" stroke="black"></path>
                <path d="M 8,160 L 336,160" fill="none" stroke="black"></path>
                <path d="M 8,208 L 336,208" fill="none" stroke="black"></path>
                <path d="M 8,240 L 336,240" fill="none" stroke="black"></path>
                <path d="M 8,288 L 536,288" fill="none" stroke="black"></path>
                <path d="M 8,320 L 536,320" fill="none" stroke="black"></path>
                <g class="text">
                  <text x="16" y="36">KID</text>
                  <text x="40" y="36">&lt;</text>
                  <text x="60" y="36">8,</text>
                  <text x="88" y="36">CTR</text>
                  <text x="112" y="36">&lt;</text>
                  <text x="132" y="36">8:</text>
                  <text x="16" y="68">0</text>
                  <text x="48" y="68">KID</text>
                  <text x="80" y="68">0</text>
                  <text x="112" y="68">CTR</text>
                  <text x="16" y="116">KID</text>
                  <text x="40" y="116">&lt;</text>
                  <text x="60" y="116">8,</text>
                  <text x="88" y="116">CTR</text>
                  <text x="116" y="116">&gt;=</text>
                  <text x="140" y="116">8:</text>
                  <text x="16" y="148">0</text>
                  <text x="48" y="148">KID</text>
                  <text x="80" y="148">1</text>
                  <text x="108" y="148">CLEN</text>
                  <text x="180" y="148">CTR...</text>
                  <text x="264" y="148">(length=CLEN)</text>
                  <text x="16" y="196">KID</text>
                  <text x="44" y="196">&gt;=</text>
                  <text x="64" y="196">8</text>
                  <text x="96" y="196">CTR</text>
                  <text x="120" y="196">&lt;</text>
                  <text x="140" y="196">8:</text>
                  <text x="16" y="228">1</text>
                  <text x="44" y="228">KLEN</text>
                  <text x="80" y="228">0</text>
                  <text x="112" y="228">CTR</text>
                  <text x="180" y="228">KID...</text>
                  <text x="264" y="228">(length=KLEN)</text>
                  <text x="16" y="276">KID</text>
                  <text x="44" y="276">&gt;=</text>
                  <text x="64" y="276">8</text>
                  <text x="96" y="276">CTR</text>
                  <text x="124" y="276">&gt;=</text>
                  <text x="148" y="276">8:</text>
                  <text x="16" y="308">1</text>
                  <text x="44" y="308">KLEN</text>
                  <text x="80" y="308">1</text>
                  <text x="108" y="308">CLEN</text>
                  <text x="180" y="308">KID...</text>
                  <text x="264" y="308">(length=KLEN)</text>
                  <text x="380" y="308">CTR...</text>
                  <text x="464" y="308">(length=CLEN)</text>
                </g>
              </svg><a class="pilcrow" href="#section-4.3-9.1.1">Â¶</a>
</div>
</div>
<figcaption><a class="selfRef" href="#figure-4">Figure 4</a>:
<a class="selfRef" href="#name-forms-of-encoded-sframe-hea">Forms of Encoded SFrame Header</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="encryption-schema">
<section id="section-4.4">
        <h3 id="name-encryption-schema">
<a class="section-number selfRef" href="#section-4.4">4.4. </a><a class="section-name selfRef" href="#name-encryption-schema">Encryption Schema</a>
        </h3>
<p id="section-4.4-1">SFrame encryption uses an AEAD encryption algorithm and hash function defined by
the cipher suite in use (see <a class="auto internal xref" href="#cipher-suites">Section 4.5</a>).  We will refer to the following
aspects of the AEAD and the hash algorithm below:<a class="pilcrow" href="#section-4.4-1">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4-2.1">
            <p id="section-4.4-2.1.1"><code>AEAD.Encrypt</code> and <code>AEAD.Decrypt</code> - The encryption and decryption functions
for the AEAD.  We follow the convention of RFC 5116 <span>[<a class="cite xref" href="#RFC5116">RFC5116</a>]</span> and consider
the authentication tag part of the ciphertext produced by <code>AEAD.Encrypt</code> (as
opposed to a separate field as in SRTP <span>[<a class="cite xref" href="#RFC3711">RFC3711</a>]</span>).<a class="pilcrow" href="#section-4.4-2.1.1">Â¶</a></p>
</li>
          <li class="normal" id="section-4.4-2.2">
            <p id="section-4.4-2.2.1"><code>AEAD.Nk</code> - The size in bytes of a key for the encryption algorithm<a class="pilcrow" href="#section-4.4-2.2.1">Â¶</a></p>
</li>
          <li class="normal" id="section-4.4-2.3">
            <p id="section-4.4-2.3.1"><code>AEAD.Nn</code> - The size in bytes of a nonce for the encryption algorithm<a class="pilcrow" href="#section-4.4-2.3.1">Â¶</a></p>
</li>
          <li class="normal" id="section-4.4-2.4">
            <p id="section-4.4-2.4.1"><code>AEAD.Nt</code> - The overhead in bytes of the encryption algorithm (typically the
size of a "tag" that is added to the plaintext)<a class="pilcrow" href="#section-4.4-2.4.1">Â¶</a></p>
</li>
          <li class="normal" id="section-4.4-2.5">
            <p id="section-4.4-2.5.1"><code>AEAD.Nka</code> - For cipher suites using the compound AEAD described in
<a class="auto internal xref" href="#aes-ctr-with-sha2">Section 4.5.1</a>, the size in bytes of a key for the underlying encryption
algorithm<a class="pilcrow" href="#section-4.4-2.5.1">Â¶</a></p>
</li>
          <li class="normal" id="section-4.4-2.6">
            <p id="section-4.4-2.6.1"><code>Hash.Nh</code> - The size in bytes of the output of the hash function<a class="pilcrow" href="#section-4.4-2.6.1">Â¶</a></p>
</li>
        </ul>
<div id="key-selection">
<section id="section-4.4.1">
          <h4 id="name-key-selection">
<a class="section-number selfRef" href="#section-4.4.1">4.4.1. </a><a class="section-name selfRef" href="#name-key-selection">Key Selection</a>
          </h4>
<p id="section-4.4.1-1">Each SFrame encryption or decryption operation is premised on a single secret
<code>base_key</code>, which is labeled with an integer KID value signaled in the SFrame
header.<a class="pilcrow" href="#section-4.4.1-1">Â¶</a></p>
<p id="section-4.4.1-2">The sender and receivers need to agree on which <code>base_key</code> should be used for a given
KID.  Moreover, senders and receivers need to agree on whether a <code>base_key</code> will be used
for encryption or decryption only. The process for provisioning <code>base_key</code> values and their KID
values is beyond the scope of this specification, but its security properties will
bound the assurances that SFrame provides.  For example, if SFrame is used to
provide E2E security against intermediary media nodes, then SFrame keys need to
be negotiated in a way that does not make them accessible to these intermediaries.<a class="pilcrow" href="#section-4.4.1-2">Â¶</a></p>
<p id="section-4.4.1-3">For each known KID value, the client stores the corresponding symmetric key
<code>base_key</code>.  For keys that can be used for encryption, the client also stores
the next CTR value to be used when encrypting (initially 0).<a class="pilcrow" href="#section-4.4.1-3">Â¶</a></p>
<p id="section-4.4.1-4">When encrypting a plaintext, the application specifies which KID is to be used,
and the CTR value is incremented after successful encryption.  When decrypting,
the <code>base_key</code> for decryption is selected from the available keys using the KID
value in the SFrame header.<a class="pilcrow" href="#section-4.4.1-4">Â¶</a></p>
<p id="section-4.4.1-5">A given <code>base_key</code> <span class="bcp14">MUST NOT</span> be used for encryption by multiple senders.  Such reuse
would result in multiple encrypted frames being generated with the same (key,
nonce) pair, which harms the protections provided by many AEAD algorithms.
Implementations <span class="bcp14">MUST</span> mark each <code>base_key</code> as usable for encryption or decryption,
never both.<a class="pilcrow" href="#section-4.4.1-5">Â¶</a></p>
<p id="section-4.4.1-6">Note that the set of available keys might change over the lifetime of a
real-time session.  In such cases, the client will need to manage key usage to
avoid media loss due to a key being used to encrypt before all receivers are
able to use it to decrypt.  For example, an application may make decryption-only
keys available immediately, but delay the use of keys for encryption until (a)
all receivers have acknowledged receipt of the new key, or (b) a timeout expires.<a class="pilcrow" href="#section-4.4.1-6">Â¶</a></p>
</section>
</div>
<div id="key-derivation">
<section id="section-4.4.2">
          <h4 id="name-key-derivation">
<a class="section-number selfRef" href="#section-4.4.2">4.4.2. </a><a class="section-name selfRef" href="#name-key-derivation">Key Derivation</a>
          </h4>
<p id="section-4.4.2-1">SFrame encryption and decryption use a key and salt derived from the <code>base_key</code>
associated with a KID.  Given a <code>base_key</code> value, the key and salt are derived
using HMAC-based Key Derivation Function (HKDF) <span>[<a class="cite xref" href="#RFC5869">RFC5869</a>]</span> as follows:<a class="pilcrow" href="#section-4.4.2-1">Â¶</a></p>
<div class="lang-pseudocode sourcecode" id="section-4.4.2-2">
<pre>def derive_key_salt(KID, base_key):
  sframe_secret = HKDF-Extract("", base_key)

  sframe_key_label = "SFrame 1.0 Secret key " + KID + cipher_suite
  sframe_key =
    HKDF-Expand(sframe_secret, sframe_key_label, AEAD.Nk)

  sframe_salt_label = "SFrame 1.0 Secret salt " + KID + cipher_suite
  sframe_salt =
    HKDF-Expand(sframe_secret, sframe_salt_label, AEAD.Nn)

  return sframe_key, sframe_salt
</pre><a class="pilcrow" href="#section-4.4.2-2">Â¶</a>
</div>
<p id="section-4.4.2-3">In the derivation of <code>sframe_secret</code>:<a class="pilcrow" href="#section-4.4.2-3">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4.2-4.1">
              <p id="section-4.4.2-4.1.1">The <code>+</code> operator represents concatenation of byte strings.<a class="pilcrow" href="#section-4.4.2-4.1.1">Â¶</a></p>
</li>
            <li class="normal" id="section-4.4.2-4.2">
              <p id="section-4.4.2-4.2.1">The KID value is encoded as an 8-byte big-endian integer, not the compressed
form used in the SFrame header.<a class="pilcrow" href="#section-4.4.2-4.2.1">Â¶</a></p>
</li>
            <li class="normal" id="section-4.4.2-4.3">
              <p id="section-4.4.2-4.3.1">The <code>cipher_suite</code> value is a 2-byte big-endian integer representing the
cipher suite in use (see <a class="auto internal xref" href="#sframe-cipher-suites">Section 8.1</a>).<a class="pilcrow" href="#section-4.4.2-4.3.1">Â¶</a></p>
</li>
          </ul>
<p id="section-4.4.2-5">The hash function used for HKDF is determined by the cipher suite in use.<a class="pilcrow" href="#section-4.4.2-5">Â¶</a></p>
</section>
</div>
<div id="encryption">
<section id="section-4.4.3">
          <h4 id="name-encryption">
<a class="section-number selfRef" href="#section-4.4.3">4.4.3. </a><a class="section-name selfRef" href="#name-encryption">Encryption</a>
          </h4>
<p id="section-4.4.3-1">SFrame encryption uses the AEAD encryption algorithm for the cipher suite in use.
The key for the encryption is the <code>sframe_key</code>.  The nonce is formed by first XORing
the <code>sframe_salt</code> with the current CTR value, and then encoding the result as a big-endian integer of
length <code>AEAD.Nn</code>.<a class="pilcrow" href="#section-4.4.3-1">Â¶</a></p>
<p id="section-4.4.3-2">The encryptor forms an SFrame header using the CTR and KID values provided.
The encoded header is provided as AAD to the AEAD encryption operation, together
with application-provided metadata about the encrypted media (see <a class="auto internal xref" href="#metadata">Section 9.4</a>).<a class="pilcrow" href="#section-4.4.3-2">Â¶</a></p>
<div class="lang-pseudocode sourcecode" id="section-4.4.3-3">
<pre>def encrypt(CTR, KID, metadata, plaintext):
  sframe_key, sframe_salt = key_store[KID]

  # encode_big_endian(x, n) produces an n-byte string encoding the
  # integer x in big-endian byte order.
  ctr = encode_big_endian(CTR, AEAD.Nn)
  nonce = xor(sframe_salt, CTR)

  # encode_sframe_header produces a byte string encoding the
  # provided KID and CTR values into an SFrame header.
  header = encode_sframe_header(CTR, KID)
  aad = header + metadata

  ciphertext = AEAD.Encrypt(sframe_key, nonce, aad, plaintext)
  return header + ciphertext
</pre><a class="pilcrow" href="#section-4.4.3-3">Â¶</a>
</div>
<p id="section-4.4.3-4">For example, the metadata input to encryption allows for frame metadata to be
authenticated when SFrame is applied per frame.  After encoding the frame and
before packetizing it, the necessary media metadata will be moved out of the
encoded frame buffer to be sent in some channel visible to the SFU (e.g., an
RTP header extension).<a class="pilcrow" href="#section-4.4.3-4">Â¶</a></p>
<span id="name-encrypting-an-sframe-cipher"></span><figure id="figure-5">
            <div id="section-4.4.3-5.1">
              <div class="alignLeft art-svg artwork" id="section-4.4.3-5.1.1">
<svg class="diagram" font-family="monospace" font-size="13px" height="608" stroke-linecap="round" text-anchor="middle" version="1.1" viewBox="0 0 416 608" width="416" xmlns="http://www.w3.org/2000/svg">
                  <path d="M 40,224 L 40,480" fill="none" stroke="black"></path>
                  <path d="M 64,176 L 64,272" fill="none" stroke="black"></path>
                  <path d="M 96,160 L 96,288" fill="none" stroke="black"></path>
                  <path d="M 128,320 L 128,352" fill="none" stroke="black"></path>
                  <path d="M 144,160 L 144,288" fill="none" stroke="black"></path>
                  <path d="M 168,176 L 168,208" fill="none" stroke="black"></path>
                  <path d="M 168,464 L 168,592" fill="none" stroke="black"></path>
                  <path d="M 192,352 L 192,384" fill="none" stroke="black"></path>
                  <path d="M 264,320 L 264,352" fill="none" stroke="black"></path>
                  <path d="M 280,32 L 280,128" fill="none" stroke="black"></path>
                  <path d="M 296,464 L 296,592" fill="none" stroke="black"></path>
                  <path d="M 320,208 L 320,240" fill="none" stroke="black"></path>
                  <path d="M 344,128 L 344,400" fill="none" stroke="black"></path>
                  <path d="M 344,432 L 344,528" fill="none" stroke="black"></path>
                  <path d="M 408,32 L 408,128" fill="none" stroke="black"></path>
                  <path d="M 280,32 L 408,32" fill="none" stroke="black"></path>
                  <path d="M 280,128 L 408,128" fill="none" stroke="black"></path>
                  <path d="M 96,160 L 144,160" fill="none" stroke="black"></path>
                  <path d="M 144,176 L 192,176" fill="none" stroke="black"></path>
                  <path d="M 296,176 L 336,176" fill="none" stroke="black"></path>
                  <path d="M 168,208 L 192,208" fill="none" stroke="black"></path>
                  <path d="M 304,208 L 320,208" fill="none" stroke="black"></path>
                  <path d="M 40,224 L 64,224" fill="none" stroke="black"></path>
                  <path d="M 96,224 L 144,224" fill="none" stroke="black"></path>
                  <path d="M 144,240 L 336,240" fill="none" stroke="black"></path>
                  <path d="M 96,288 L 144,288" fill="none" stroke="black"></path>
                  <path d="M 128,320 L 264,320" fill="none" stroke="black"></path>
                  <path d="M 128,352 L 264,352" fill="none" stroke="black"></path>
                  <path d="M 40,384 L 336,384" fill="none" stroke="black"></path>
                  <path d="M 168,464 L 296,464" fill="none" stroke="black"></path>
                  <path d="M 40,480 L 160,480" fill="none" stroke="black"></path>
                  <path d="M 168,496 L 296,496" fill="none" stroke="black"></path>
                  <path d="M 304,528 L 344,528" fill="none" stroke="black"></path>
                  <path d="M 168,592 L 296,592" fill="none" stroke="black"></path>
                  <path d="M 80,160 C 71.16936,160 64,167.16936 64,176" fill="none" stroke="black"></path>
                  <path d="M 80,288 C 71.16936,288 64,280.83064 64,272" fill="none" stroke="black"></path>
                  <polygon class="arrowhead" fill="black" points="344,384 332,378.4 332,389.6" transform="rotate(0,336,384)"></polygon>
                  <polygon class="arrowhead" fill="black" points="344,240 332,234.4 332,245.6" transform="rotate(0,336,240)"></polygon>
                  <polygon class="arrowhead" fill="black" points="344,176 332,170.4 332,181.6" transform="rotate(0,336,176)"></polygon>
                  <polygon class="arrowhead" fill="black" points="312,528 300,522.4 300,533.6" transform="rotate(180,304,528)"></polygon>
                  <polygon class="arrowhead" fill="black" points="200,208 188,202.4 188,213.6" transform="rotate(0,192,208)"></polygon>
                  <polygon class="arrowhead" fill="black" points="200,176 188,170.4 188,181.6" transform="rotate(0,192,176)"></polygon>
                  <polygon class="arrowhead" fill="black" points="168,480 156,474.4 156,485.6" transform="rotate(0,160,480)"></polygon>
                  <g class="text">
                    <text x="344" y="84">plaintext</text>
                    <text x="244" y="180">sframe_key</text>
                    <text x="368" y="180">Key</text>
                    <text x="28" y="196">Header</text>
                    <text x="120" y="196">KID</text>
                    <text x="248" y="212">sframe_salt</text>
                    <text x="376" y="244">Nonce</text>
                    <text x="120" y="260">CTR</text>
                    <text x="196" y="340">metadata</text>
                    <text x="368" y="388">AAD</text>
                    <text x="348" y="420">AEAD.Encrypt</text>
                    <text x="188" y="452">SFrame</text>
                    <text x="260" y="452">Ciphertext</text>
                    <text x="204" y="484">SFrame</text>
                    <text x="260" y="484">Header</text>
                    <text x="236" y="548">ciphertext</text>
                  </g>
                </svg><a class="pilcrow" href="#section-4.4.3-5.1.1">Â¶</a>
</div>
</div>
<figcaption><a class="selfRef" href="#figure-5">Figure 5</a>:
<a class="selfRef" href="#name-encrypting-an-sframe-cipher">Encrypting an SFrame Ciphertext</a>
            </figcaption></figure>
</section>
</div>
<div id="decryption">
<section id="section-4.4.4">
          <h4 id="name-decryption">
<a class="section-number selfRef" href="#section-4.4.4">4.4.4. </a><a class="section-name selfRef" href="#name-decryption">Decryption</a>
          </h4>
<p id="section-4.4.4-1">Before decrypting, a receiver needs to assemble a full SFrame ciphertext. When
an SFrame ciphertext is fragmented into multiple parts for transport (e.g.,
a whole encrypted frame sent in multiple SRTP packets), the receiving client
collects all the fragments of the ciphertext, using appropriate sequencing
and start/end markers in the transport. Once all of the required fragments are
available, the client reassembles them into the SFrame ciphertext and passes
the ciphertext to SFrame for decryption.<a class="pilcrow" href="#section-4.4.4-1">Â¶</a></p>
<p id="section-4.4.4-2">The KID field in the SFrame header is used to find the right key and salt for
the encrypted frame, and the CTR field is used to construct the nonce. The SFrame
decryption procedure is as follows:<a class="pilcrow" href="#section-4.4.4-2">Â¶</a></p>
<div class="lang-pseudocode sourcecode" id="section-4.4.4-3">
<pre>def decrypt(metadata, sframe_ciphertext):
  KID, CTR, header, ciphertext = parse_ciphertext(sframe_ciphertext)

  sframe_key, sframe_salt = key_store[KID]

  ctr = encode_big_endian(CTR, AEAD.Nn)
  nonce = xor(sframe_salt, ctr)
  aad = header + metadata

  return AEAD.Decrypt(sframe_key, nonce, aad, ciphertext)
</pre><a class="pilcrow" href="#section-4.4.4-3">Â¶</a>
</div>
<p id="section-4.4.4-4">If a ciphertext fails to decrypt because there is no key available for the KID
in the SFrame header, the client <span class="bcp14">MAY</span> buffer the ciphertext and retry decryption
once a key with that KID is received.  If a ciphertext fails to decrypt for any
other reason, the client <span class="bcp14">MUST</span> discard the ciphertext. Invalid ciphertexts <span class="bcp14">SHOULD</span> be
discarded in a way that is indistinguishable (to an external observer) from having
processed a valid ciphertext.  In other words, the SFrame decrypt operation
should take the same amount of time regardless of whether decryption succeeds or fails.<a class="pilcrow" href="#section-4.4.4-4">Â¶</a></p>
<span id="name-decrypting-an-sframe-cipher"></span><figure id="figure-6">
            <div id="section-4.4.4-5.1">
              <div class="alignLeft art-svg artwork" id="section-4.4.4-5.1.1">
<svg class="diagram" font-family="monospace" font-size="13px" height="640" stroke-linecap="round" text-anchor="middle" version="1.1" viewBox="0 0 384 640" width="384" xmlns="http://www.w3.org/2000/svg">
                  <path d="M 8,64 L 8,432" fill="none" stroke="black"></path>
                  <path d="M 32,224 L 32,320" fill="none" stroke="black"></path>
                  <path d="M 64,208 L 64,336" fill="none" stroke="black"></path>
                  <path d="M 96,368 L 96,400" fill="none" stroke="black"></path>
                  <path d="M 112,208 L 112,336" fill="none" stroke="black"></path>
                  <path d="M 136,48 L 136,176" fill="none" stroke="black"></path>
                  <path d="M 136,224 L 136,256" fill="none" stroke="black"></path>
                  <path d="M 160,400 L 160,432" fill="none" stroke="black"></path>
                  <path d="M 232,368 L 232,400" fill="none" stroke="black"></path>
                  <path d="M 248,512 L 248,608" fill="none" stroke="black"></path>
                  <path d="M 264,48 L 264,176" fill="none" stroke="black"></path>
                  <path d="M 288,256 L 288,288" fill="none" stroke="black"></path>
                  <path d="M 312,112 L 312,448" fill="none" stroke="black"></path>
                  <path d="M 312,496 L 312,504" fill="none" stroke="black"></path>
                  <path d="M 376,512 L 376,608" fill="none" stroke="black"></path>
                  <path d="M 136,48 L 264,48" fill="none" stroke="black"></path>
                  <path d="M 8,64 L 128,64" fill="none" stroke="black"></path>
                  <path d="M 136,80 L 264,80" fill="none" stroke="black"></path>
                  <path d="M 272,112 L 312,112" fill="none" stroke="black"></path>
                  <path d="M 136,176 L 264,176" fill="none" stroke="black"></path>
                  <path d="M 64,208 L 112,208" fill="none" stroke="black"></path>
                  <path d="M 112,224 L 160,224" fill="none" stroke="black"></path>
                  <path d="M 264,224 L 304,224" fill="none" stroke="black"></path>
                  <path d="M 136,256 L 160,256" fill="none" stroke="black"></path>
                  <path d="M 272,256 L 288,256" fill="none" stroke="black"></path>
                  <path d="M 8,272 L 24,272" fill="none" stroke="black"></path>
                  <path d="M 64,272 L 112,272" fill="none" stroke="black"></path>
                  <path d="M 112,288 L 304,288" fill="none" stroke="black"></path>
                  <path d="M 64,336 L 112,336" fill="none" stroke="black"></path>
                  <path d="M 96,368 L 232,368" fill="none" stroke="black"></path>
                  <path d="M 96,400 L 232,400" fill="none" stroke="black"></path>
                  <path d="M 8,432 L 304,432" fill="none" stroke="black"></path>
                  <path d="M 248,512 L 376,512" fill="none" stroke="black"></path>
                  <path d="M 248,608 L 376,608" fill="none" stroke="black"></path>
                  <path d="M 48,208 C 39.16936,208 32,215.16936 32,224" fill="none" stroke="black"></path>
                  <path d="M 48,336 C 39.16936,336 32,328.83064 32,320" fill="none" stroke="black"></path>
                  <polygon class="arrowhead" fill="black" points="320,504 308,498.4 308,509.6" transform="rotate(90,312,504)"></polygon>
                  <polygon class="arrowhead" fill="black" points="312,432 300,426.4 300,437.6" transform="rotate(0,304,432)"></polygon>
                  <polygon class="arrowhead" fill="black" points="312,288 300,282.4 300,293.6" transform="rotate(0,304,288)"></polygon>
                  <polygon class="arrowhead" fill="black" points="312,224 300,218.4 300,229.6" transform="rotate(0,304,224)"></polygon>
                  <polygon class="arrowhead" fill="black" points="168,256 156,250.4 156,261.6" transform="rotate(0,160,256)"></polygon>
                  <polygon class="arrowhead" fill="black" points="168,224 156,218.4 156,229.6" transform="rotate(0,160,224)"></polygon>
                  <polygon class="arrowhead" fill="black" points="32,272 20,266.4 20,277.6" transform="rotate(0,24,272)"></polygon>
                  <g class="text">
                    <text x="156" y="36">SFrame</text>
                    <text x="228" y="36">Ciphertext</text>
                    <text x="172" y="68">SFrame</text>
                    <text x="228" y="68">Header</text>
                    <text x="204" y="132">ciphertext</text>
                    <text x="212" y="228">sframe_key</text>
                    <text x="336" y="228">Key</text>
                    <text x="88" y="244">KID</text>
                    <text x="216" y="260">sframe_salt</text>
                    <text x="344" y="292">Nonce</text>
                    <text x="88" y="308">CTR</text>
                    <text x="164" y="388">metadata</text>
                    <text x="336" y="436">AAD</text>
                    <text x="316" y="468">AEAD.Decrypt</text>
                    <text x="312" y="484">|</text>
                    <text x="312" y="564">plaintext</text>
                  </g>
                </svg><a class="pilcrow" href="#section-4.4.4-5.1.1">Â¶</a>
</div>
</div>
<figcaption><a class="selfRef" href="#figure-6">Figure 6</a>:
<a class="selfRef" href="#name-decrypting-an-sframe-cipher">Decrypting an SFrame Ciphertext</a>
            </figcaption></figure>
</section>
</div>
</section>
</div>
<div id="cipher-suites">
<section id="section-4.5">
        <h3 id="name-cipher-suites">
<a class="section-number selfRef" href="#section-4.5">4.5. </a><a class="section-name selfRef" href="#name-cipher-suites">Cipher Suites</a>
        </h3>
<p id="section-4.5-1">Each SFrame session uses a single cipher suite that specifies the following
primitives:<a class="pilcrow" href="#section-4.5-1">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.5-2.1">
            <p id="section-4.5-2.1.1">A hash function used for key derivation<a class="pilcrow" href="#section-4.5-2.1.1">Â¶</a></p>
</li>
          <li class="normal" id="section-4.5-2.2">
            <p id="section-4.5-2.2.1">An AEAD encryption algorithm <span>[<a class="cite xref" href="#RFC5116">RFC5116</a>]</span> used for frame encryption, optionally
with a truncated authentication tag<a class="pilcrow" href="#section-4.5-2.2.1">Â¶</a></p>
</li>
        </ul>
<p id="section-4.5-3">This document defines the following cipher suites, with the constants defined in
<a class="auto internal xref" href="#encryption-schema">Section 4.4</a>:<a class="pilcrow" href="#section-4.5-3">Â¶</a></p>
<span id="name-sframe-cipher-suite-constan"></span><div id="cipher-suite-constants">
<table class="center" id="table-1">
          <caption>
<a class="selfRef" href="#table-1">Table 1</a>:
<a class="selfRef" href="#name-sframe-cipher-suite-constan">SFrame Cipher Suite Constants</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Name</th>
              <th class="text-left" colspan="1" rowspan="1">Nh</th>
              <th class="text-left" colspan="1" rowspan="1">Nka</th>
              <th class="text-left" colspan="1" rowspan="1">Nk</th>
              <th class="text-left" colspan="1" rowspan="1">Nn</th>
              <th class="text-left" colspan="1" rowspan="1">Nt</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">
                <code>AES_128_CTR_HMAC_SHA256_80</code>
</td>
              <td class="text-left" colspan="1" rowspan="1">32</td>
              <td class="text-left" colspan="1" rowspan="1">16</td>
              <td class="text-left" colspan="1" rowspan="1">48</td>
              <td class="text-left" colspan="1" rowspan="1">12</td>
              <td class="text-left" colspan="1" rowspan="1">10</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">
                <code>AES_128_CTR_HMAC_SHA256_64</code>
</td>
              <td class="text-left" colspan="1" rowspan="1">32</td>
              <td class="text-left" colspan="1" rowspan="1">16</td>
              <td class="text-left" colspan="1" rowspan="1">48</td>
              <td class="text-left" colspan="1" rowspan="1">12</td>
              <td class="text-left" colspan="1" rowspan="1">8</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">
                <code>AES_128_CTR_HMAC_SHA256_32</code>
</td>
              <td class="text-left" colspan="1" rowspan="1">32</td>
              <td class="text-left" colspan="1" rowspan="1">16</td>
              <td class="text-left" colspan="1" rowspan="1">48</td>
              <td class="text-left" colspan="1" rowspan="1">12</td>
              <td class="text-left" colspan="1" rowspan="1">4</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">
                <code>AES_128_GCM_SHA256_128</code>
</td>
              <td class="text-left" colspan="1" rowspan="1">32</td>
              <td class="text-left" colspan="1" rowspan="1">n/a</td>
              <td class="text-left" colspan="1" rowspan="1">16</td>
              <td class="text-left" colspan="1" rowspan="1">12</td>
              <td class="text-left" colspan="1" rowspan="1">16</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">
                <code>AES_256_GCM_SHA512_128</code>
</td>
              <td class="text-left" colspan="1" rowspan="1">64</td>
              <td class="text-left" colspan="1" rowspan="1">n/a</td>
              <td class="text-left" colspan="1" rowspan="1">32</td>
              <td class="text-left" colspan="1" rowspan="1">12</td>
              <td class="text-left" colspan="1" rowspan="1">16</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-4.5-5">Numeric identifiers for these cipher suites are defined in the IANA registry
created in <a class="auto internal xref" href="#sframe-cipher-suites">Section 8.1</a>.<a class="pilcrow" href="#section-4.5-5">Â¶</a></p>
<p id="section-4.5-6">In the suite names, the length of the authentication tag is indicated by
the last value: "_128" indicates a 128-bit tag, "_80" indicates
an 80-bit tag, "_64" indicates a 64-bit tag, and "_32" indicates a
32-bit tag.<a class="pilcrow" href="#section-4.5-6">Â¶</a></p>
<p id="section-4.5-7">In a session that uses multiple media streams, different cipher suites might be
configured for different media streams.  For example, in order to conserve
bandwidth, a session might use a cipher suite with 80-bit tags for video frames
and another cipher suite with 32-bit tags for audio frames.<a class="pilcrow" href="#section-4.5-7">Â¶</a></p>
<div id="aes-ctr-with-sha2">
<section id="section-4.5.1">
          <h4 id="name-aes-ctr-with-sha2">
<a class="section-number selfRef" href="#section-4.5.1">4.5.1. </a><a class="section-name selfRef" href="#name-aes-ctr-with-sha2">AES-CTR with SHA2</a>
          </h4>
<p id="section-4.5.1-1">In order to allow very short tag sizes, we define a synthetic AEAD function
using the authenticated counter mode of AES together with HMAC for
authentication.  We use an encrypt-then-MAC approach, as in SRTP <span>[<a class="cite xref" href="#RFC3711">RFC3711</a>]</span>.<a class="pilcrow" href="#section-4.5.1-1">Â¶</a></p>
<p id="section-4.5.1-2">Before encryption or decryption, encryption and authentication subkeys are
derived from the single AEAD key.  The overall length of the AEAD key is <code>Nka +
Nh</code>, where <code>Nka</code> represents the key size for the AES block cipher in use and <code>Nh</code>
represents the output size of the hash function  (as in <a class="auto internal xref" href="#encryption-schema">Section 4.4</a>).
The encryption subkey comprises the first <code>Nka</code> bytes and the authentication
subkey comprises the remaining <code>Nh</code> bytes.<a class="pilcrow" href="#section-4.5.1-2">Â¶</a></p>
<div class="lang-pseudocode sourcecode" id="section-4.5.1-3">
<pre>def derive_subkeys(sframe_key):
  # The encryption key comprises the first Nka bytes
  enc_key = sframe_key[..Nka]

  # The authentication key comprises Nh remaining bytes
  auth_key = sframe_key[Nka..]

  return enc_key, auth_key
</pre><a class="pilcrow" href="#section-4.5.1-3">Â¶</a>
</div>
<p id="section-4.5.1-4">The AEAD encryption and decryption functions are then composed of individual
calls to the CTR encrypt function and HMAC.  The resulting MAC value is truncated
to a number of bytes <code>Nt</code> fixed by the cipher suite.<a class="pilcrow" href="#section-4.5.1-4">Â¶</a></p>
<div class="lang-pseudocode sourcecode" id="section-4.5.1-5">
<pre>def truncate(tag, n):
  # Take the first `n` bytes of `tag`
  return tag[..n]

def compute_tag(auth_key, nonce, aad, ct):
  aad_len = encode_big_endian(len(aad), 8)
  ct_len = encode_big_endian(len(ct), 8)
  tag_len = encode_big_endian(Nt, 8)
  auth_data = aad_len + ct_len + tag_len + nonce + aad + ct
  tag = HMAC(auth_key, auth_data)
  return truncate(tag, Nt)

def AEAD.Encrypt(key, nonce, aad, pt):
  enc_key, auth_key = derive_subkeys(key)
  initial_counter = nonce + 0x00000000 # append four zero bytes
  ct = AES-CTR.Encrypt(enc_key, initial_counter, pt)
  tag = compute_tag(auth_key, nonce, aad, ct)
  return ct + tag

def AEAD.Decrypt(key, nonce, aad, ct):
  inner_ct, tag = split_ct(ct, tag_len)

  enc_key, auth_key = derive_subkeys(key)
  candidate_tag = compute_tag(auth_key, nonce, aad, inner_ct)
  if !constant_time_equal(tag, candidate_tag):
    raise Exception("Authentication Failure")

  initial_counter = nonce + 0x00000000 # append four zero bytes
  return AES-CTR.Decrypt(enc_key, initial_counter, inner_ct)
</pre><a class="pilcrow" href="#section-4.5.1-5">Â¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="key-management">
<section id="section-5">
      <h2 id="name-key-management">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-key-management">Key Management</a>
      </h2>
<p id="section-5-1">SFrame must be integrated with an E2E key management framework to exchange and
rotate the keys used for SFrame encryption. The key management
framework provides the following functions:<a class="pilcrow" href="#section-5-1">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-2.1">
          <p id="section-5-2.1.1">Provisioning KID / <code>base_key</code> mappings to participating clients<a class="pilcrow" href="#section-5-2.1.1">Â¶</a></p>
</li>
        <li class="normal" id="section-5-2.2">
          <p id="section-5-2.2.1">Updating the above data as clients join or leave<a class="pilcrow" href="#section-5-2.2.1">Â¶</a></p>
</li>
      </ul>
<p id="section-5-3">It is the responsibility of the application to provide the key management
framework, as described in <a class="auto internal xref" href="#key-management-framework">Section 9.2</a>.<a class="pilcrow" href="#section-5-3">Â¶</a></p>
<div id="sender-keys">
<section id="section-5.1">
        <h3 id="name-sender-keys">
<a class="section-number selfRef" href="#section-5.1">5.1. </a><a class="section-name selfRef" href="#name-sender-keys">Sender Keys</a>
        </h3>
<p id="section-5.1-1">If the participants in a call have a preexisting E2E-secure channel, they can
use it to distribute SFrame keys.  Each client participating in a call generates
a fresh <code>base_key</code> value that it will use to encrypt media. The client then uses
the E2E-secure channel to send their encryption key to the other participants.<a class="pilcrow" href="#section-5.1-1">Â¶</a></p>
<p id="section-5.1-2">In this scheme, it is assumed that receivers have a signal outside of SFrame for
which client has sent a given frame (e.g., an RTP synchronization source (SSRC)).  SFrame KID
values are then used to distinguish between versions of the sender's <code>base_key</code>.<a class="pilcrow" href="#section-5.1-2">Â¶</a></p>
<p id="section-5.1-3">KID values in this scheme have two parts: a "key generation" and a "ratchet step".
Both are unsigned integers that begin at zero.  The key generation increments
each time the sender distributes a new key to receivers.  The ratchet step is
incremented each time the sender ratchets their key forward for forward secrecy:<a class="pilcrow" href="#section-5.1-3">Â¶</a></p>
<div class="lang-pseudocode sourcecode" id="section-5.1-4">
<pre>base_key[i+1] = HKDF-Expand(
                  HKDF-Extract("", base_key[i]),
                  "SFrame 1.0 Ratchet", CipherSuite.Nh)
</pre><a class="pilcrow" href="#section-5.1-4">Â¶</a>
</div>
<p id="section-5.1-5">For compactness, we do not send the whole ratchet step.  Instead, we send only
its low-order <code>R</code> bits, where <code>R</code> is a value set by the application.  Different
senders may use different values of <code>R</code>, but each receiver of a given sender
needs to know what value of <code>R</code> is used by the sender so that they can recognize
when they need to ratchet (vs. expecting a new key).  <code>R</code> effectively defines a
reordering window, since no more than 2<sup><code>R</code></sup> ratchet steps can be
active at a given time.  The key generation is sent in the remaining <code>64 - R</code>
bits of the KID.<a class="pilcrow" href="#section-5.1-5">Â¶</a></p>
<div class="lang-pseudocode sourcecode" id="section-5.1-6">
<pre>KID = (key_generation &lt;&lt; R) + (ratchet_step % (1 &lt;&lt; R))
</pre><a class="pilcrow" href="#section-5.1-6">Â¶</a>
</div>
<span id="name-structure-of-a-kid-in-the-s"></span><div id="sender-keys-kid">
<figure id="figure-7">
          <div id="section-5.1-7.1">
            <div class="alignLeft art-svg artwork" id="section-5.1-7.1.1">
<svg class="diagram" font-family="monospace" font-size="13px" height="112" stroke-linecap="round" text-anchor="middle" version="1.1" viewBox="0 0 280 112" width="280" xmlns="http://www.w3.org/2000/svg">
                <path d="M 8,64 L 8,96" fill="none" stroke="black"></path>
                <path d="M 152,64 L 152,96" fill="none" stroke="black"></path>
                <path d="M 272,64 L 272,96" fill="none" stroke="black"></path>
                <path d="M 16,48 L 144,48" fill="none" stroke="black"></path>
                <path d="M 160,48 L 264,48" fill="none" stroke="black"></path>
                <path d="M 8,64 L 272,64" fill="none" stroke="black"></path>
                <path d="M 8,96 L 272,96" fill="none" stroke="black"></path>
                <polygon class="arrowhead" fill="black" points="272,48 260,42.4 260,53.6" transform="rotate(0,264,48)"></polygon>
                <polygon class="arrowhead" fill="black" points="168,48 156,42.4 156,53.6" transform="rotate(180,160,48)"></polygon>
                <polygon class="arrowhead" fill="black" points="152,48 140,42.4 140,53.6" transform="rotate(0,144,48)"></polygon>
                <polygon class="arrowhead" fill="black" points="24,48 12,42.4 12,53.6" transform="rotate(180,16,48)"></polygon>
                <g class="text">
                  <text x="60" y="36">64-R</text>
                  <text x="100" y="36">bits</text>
                  <text x="192" y="36">R</text>
                  <text x="220" y="36">bits</text>
                  <text x="32" y="84">Key</text>
                  <text x="92" y="84">Generation</text>
                  <text x="192" y="84">Ratchet</text>
                  <text x="244" y="84">Step</text>
                </g>
              </svg><a class="pilcrow" href="#section-5.1-7.1.1">Â¶</a>
</div>
</div>
<figcaption><a class="selfRef" href="#figure-7">Figure 7</a>:
<a class="selfRef" href="#name-structure-of-a-kid-in-the-s">Structure of a KID in the Sender Keys Scheme</a>
          </figcaption></figure>
</div>
<p id="section-5.1-8">The sender signals such a ratchet step update by sending with a KID value in
which the ratchet step has been incremented.  A receiver who receives from a
sender with a new KID computes the new key as above.  The old key may be kept
for some time to allow for out-of-order delivery, but should be deleted
promptly.<a class="pilcrow" href="#section-5.1-8">Â¶</a></p>
<p id="section-5.1-9">If a new participant joins in the middle of a session, they will need to receive
from each sender (a) the current sender key for that sender and (b) the current
KID value for the sender. Evicting a participant requires each sender to send
a fresh sender key to all receivers.<a class="pilcrow" href="#section-5.1-9">Â¶</a></p>
<p id="section-5.1-10">It is the application's responsibility to decide when sender keys are updated.  A sender
key may be updated by sending a new <code>base_key</code> (updating the key generation) or
by hashing the current <code>base_key</code> (updating the ratchet step).  Ratcheting the
key forward is useful when adding new receivers to an SFrame-based interaction,
since it ensures that the new receivers can't decrypt any media encrypted before
they were added.  If a sender wishes to assure the opposite property when
removing a receiver (i.e., ensuring that the receiver can't decrypt media after
they are removed), then the sender will need to distribute a new sender key.<a class="pilcrow" href="#section-5.1-10">Â¶</a></p>
</section>
</div>
<div id="mls">
<section id="section-5.2">
        <h3 id="name-mls">
<a class="section-number selfRef" href="#section-5.2">5.2. </a><a class="section-name selfRef" href="#name-mls">MLS</a>
        </h3>
<p id="section-5.2-1">The Messaging Layer Security (MLS) protocol provides group authenticated key
exchange <span>[<a class="cite xref" href="#I-D.ietf-mls-architecture">MLS-ARCH</a>]</span> <span>[<a class="cite xref" href="#RFC9420">MLS-PROTO</a>]</span>.  In
principle, it could be used to instantiate the sender key scheme above, but it
can also be used more efficiently directly.<a class="pilcrow" href="#section-5.2-1">Â¶</a></p>
<p id="section-5.2-2">MLS creates a linear sequence of keys, each of which is shared among the members
of a group at a given point in time.  When a member joins or leaves the group, a
new key is produced that is known only to the augmented or reduced group.  Each
step in the lifetime of the group is known as an "epoch", and each member of the
group is assigned an "index" that is constant for the time they are in the
group.<a class="pilcrow" href="#section-5.2-2">Â¶</a></p>
<p id="section-5.2-3">To generate keys and nonces for SFrame, we use the MLS exporter function to
generate a <code>base_key</code> value for each MLS epoch.  Each member of the group is
assigned a set of KID values so that each member has a unique <code>sframe_key</code> and
<code>sframe_salt</code> that it uses to encrypt with.  Senders may choose any KID value
within their assigned set of KID values, e.g., to allow a single sender to send
multiple, uncoordinated outbound media streams.<a class="pilcrow" href="#section-5.2-3">Â¶</a></p>
<div class="lang-pseudocode sourcecode" id="section-5.2-4">
<pre>base_key = MLS-Exporter("SFrame 1.0 Base Key", "", AEAD.Nk)
</pre><a class="pilcrow" href="#section-5.2-4">Â¶</a>
</div>
<p id="section-5.2-5">For compactness, we do not send the whole epoch number.  Instead, we send only
its low-order <code>E</code> bits, where <code>E</code> is a value set by the application.  <code>E</code>
effectively defines a reordering window, since no more than 2<sup><code>E</code></sup>
epochs can be active at a given time.  To handle rollover of the epoch counter,
receivers <span class="bcp14">MUST</span> remove an old epoch when a new epoch with the same low-order
E bits is introduced.<a class="pilcrow" href="#section-5.2-5">Â¶</a></p>
<p id="section-5.2-6">Let <code>S</code> be the number of bits required to encode a member index in the group,
i.e., the smallest value such that <code>group_size &lt;= (1 &lt;&lt; S)</code>.  The sender index
is encoded in the <code>S</code> bits above the epoch.  The remaining <code>64 - S - E</code> bits of
the KID value are a <code>context</code> value chosen by the sender (<code>context</code> value <code>0</code> will
produce the shortest encoded KID).<a class="pilcrow" href="#section-5.2-6">Â¶</a></p>
<div class="lang-pseudocode sourcecode" id="section-5.2-7">
<pre>KID = (context &lt;&lt; (S + E)) + (sender_index &lt;&lt; E) + (epoch % (1 &lt;&lt; E))
</pre><a class="pilcrow" href="#section-5.2-7">Â¶</a>
</div>
<span id="name-structure-of-a-kid-for-an-m"></span><div id="mls-kid">
<figure id="figure-8">
          <div id="section-5.2-8.1">
            <div class="alignLeft art-svg artwork" id="section-5.2-8.1.1">
<svg class="diagram" font-family="monospace" font-size="13px" height="112" stroke-linecap="round" text-anchor="middle" version="1.1" viewBox="0 0 264 112" width="264" xmlns="http://www.w3.org/2000/svg">
                <path d="M 8,64 L 8,96" fill="none" stroke="black"></path>
                <path d="M 120,64 L 120,96" fill="none" stroke="black"></path>
                <path d="M 192,64 L 192,96" fill="none" stroke="black"></path>
                <path d="M 256,64 L 256,96" fill="none" stroke="black"></path>
                <path d="M 16,48 L 112,48" fill="none" stroke="black"></path>
                <path d="M 128,48 L 184,48" fill="none" stroke="black"></path>
                <path d="M 200,48 L 256,48" fill="none" stroke="black"></path>
                <path d="M 8,64 L 256,64" fill="none" stroke="black"></path>
                <path d="M 8,96 L 256,96" fill="none" stroke="black"></path>
                <polygon class="arrowhead" fill="black" points="264,48 252,42.4 252,53.6" transform="rotate(0,256,48)"></polygon>
                <polygon class="arrowhead" fill="black" points="208,48 196,42.4 196,53.6" transform="rotate(180,200,48)"></polygon>
                <polygon class="arrowhead" fill="black" points="192,48 180,42.4 180,53.6" transform="rotate(0,184,48)"></polygon>
                <polygon class="arrowhead" fill="black" points="136,48 124,42.4 124,53.6" transform="rotate(180,128,48)"></polygon>
                <polygon class="arrowhead" fill="black" points="120,48 108,42.4 108,53.6" transform="rotate(0,112,48)"></polygon>
                <polygon class="arrowhead" fill="black" points="24,48 12,42.4 12,53.6" transform="rotate(180,16,48)"></polygon>
                <g class="text">
                  <text x="44" y="36">64-S-E</text>
                  <text x="92" y="36">bits</text>
                  <text x="136" y="36">S</text>
                  <text x="164" y="36">bits</text>
                  <text x="208" y="36">E</text>
                  <text x="236" y="36">bits</text>
                  <text x="48" y="84">Context</text>
                  <text x="92" y="84">ID</text>
                  <text x="152" y="84">Index</text>
                  <text x="224" y="84">Epoch</text>
                </g>
              </svg><a class="pilcrow" href="#section-5.2-8.1.1">Â¶</a>
</div>
</div>
<figcaption><a class="selfRef" href="#figure-8">Figure 8</a>:
<a class="selfRef" href="#name-structure-of-a-kid-for-an-m">Structure of a KID for an MLS Sender</a>
          </figcaption></figure>
</div>
<p id="section-5.2-9">Once an SFrame stack has been provisioned with the <code>sframe_epoch_secret</code> for an
epoch, it can compute the required KID values on demand (as well as the
resulting SFrame keys/nonces derived from the <code>base_key</code> and KID) as it needs
to encrypt or decrypt for a given member.<a class="pilcrow" href="#section-5.2-9">Â¶</a></p>
<span id="name-an-example-sequence-of-kids"></span><div id="mls-evolution">
<figure id="figure-9">
          <div id="section-5.2-10.1">
            <div class="alignLeft art-svg artwork" id="section-5.2-10.1.1">
<svg class="diagram" font-family="monospace" font-size="13px" height="448" stroke-linecap="round" text-anchor="middle" version="1.1" viewBox="0 0 472 448" width="472" xmlns="http://www.w3.org/2000/svg">
                <path d="M 80,48 L 80,416" fill="none" stroke="black"></path>
                <path d="M 104,80 L 104,144" fill="none" stroke="black"></path>
                <path d="M 104,192 L 104,224" fill="none" stroke="black"></path>
                <path d="M 104,352 L 104,384" fill="none" stroke="black"></path>
                <path d="M 216,272 L 216,304" fill="none" stroke="black"></path>
                <path d="M 80,80 L 120,80" fill="none" stroke="black"></path>
                <path d="M 200,80 L 224,80" fill="none" stroke="black"></path>
                <path d="M 104,112 L 120,112" fill="none" stroke="black"></path>
                <path d="M 200,112 L 224,112" fill="none" stroke="black"></path>
                <path d="M 104,144 L 120,144" fill="none" stroke="black"></path>
                <path d="M 208,144 L 224,144" fill="none" stroke="black"></path>
                <path d="M 80,192 L 120,192" fill="none" stroke="black"></path>
                <path d="M 200,192 L 224,192" fill="none" stroke="black"></path>
                <path d="M 104,224 L 120,224" fill="none" stroke="black"></path>
                <path d="M 200,224 L 224,224" fill="none" stroke="black"></path>
                <path d="M 80,272 L 120,272" fill="none" stroke="black"></path>
                <path d="M 200,272 L 240,272" fill="none" stroke="black"></path>
                <path d="M 352,272 L 368,272" fill="none" stroke="black"></path>
                <path d="M 216,304 L 240,304" fill="none" stroke="black"></path>
                <path d="M 352,304 L 368,304" fill="none" stroke="black"></path>
                <path d="M 80,352 L 120,352" fill="none" stroke="black"></path>
                <path d="M 208,352 L 224,352" fill="none" stroke="black"></path>
                <path d="M 104,384 L 120,384" fill="none" stroke="black"></path>
                <path d="M 208,384 L 224,384" fill="none" stroke="black"></path>
                <polygon class="arrowhead" fill="black" points="376,304 364,298.4 364,309.6" transform="rotate(0,368,304)"></polygon>
                <polygon class="arrowhead" fill="black" points="376,272 364,266.4 364,277.6" transform="rotate(0,368,272)"></polygon>
                <polygon class="arrowhead" fill="black" points="248,304 236,298.4 236,309.6" transform="rotate(0,240,304)"></polygon>
                <polygon class="arrowhead" fill="black" points="248,272 236,266.4 236,277.6" transform="rotate(0,240,272)"></polygon>
                <polygon class="arrowhead" fill="black" points="232,384 220,378.4 220,389.6" transform="rotate(0,224,384)"></polygon>
                <polygon class="arrowhead" fill="black" points="232,352 220,346.4 220,357.6" transform="rotate(0,224,352)"></polygon>
                <polygon class="arrowhead" fill="black" points="232,224 220,218.4 220,229.6" transform="rotate(0,224,224)"></polygon>
                <polygon class="arrowhead" fill="black" points="232,192 220,186.4 220,197.6" transform="rotate(0,224,192)"></polygon>
                <polygon class="arrowhead" fill="black" points="232,144 220,138.4 220,149.6" transform="rotate(0,224,144)"></polygon>
                <polygon class="arrowhead" fill="black" points="232,112 220,106.4 220,117.6" transform="rotate(0,224,112)"></polygon>
                <polygon class="arrowhead" fill="black" points="232,80 220,74.4 220,85.6" transform="rotate(0,224,80)"></polygon>
                <g class="text">
                  <text x="32" y="36">...</text>
                  <text x="24" y="84">Epoch</text>
                  <text x="60" y="84">14</text>
                  <text x="160" y="84">index=3</text>
                  <text x="248" y="84">KID</text>
                  <text x="272" y="84">=</text>
                  <text x="300" y="84">0x3e</text>
                  <text x="160" y="116">index=7</text>
                  <text x="248" y="116">KID</text>
                  <text x="272" y="116">=</text>
                  <text x="300" y="116">0x7e</text>
                  <text x="164" y="148">index=20</text>
                  <text x="248" y="148">KID</text>
                  <text x="272" y="148">=</text>
                  <text x="304" y="148">0x14e</text>
                  <text x="24" y="196">Epoch</text>
                  <text x="60" y="196">15</text>
                  <text x="160" y="196">index=3</text>
                  <text x="248" y="196">KID</text>
                  <text x="272" y="196">=</text>
                  <text x="300" y="196">0x3f</text>
                  <text x="160" y="228">index=5</text>
                  <text x="248" y="228">KID</text>
                  <text x="272" y="228">=</text>
                  <text x="300" y="228">0x5f</text>
                  <text x="24" y="276">Epoch</text>
                  <text x="60" y="276">16</text>
                  <text x="160" y="276">index=2</text>
                  <text x="280" y="276">context</text>
                  <text x="320" y="276">=</text>
                  <text x="336" y="276">2</text>
                  <text x="392" y="276">KID</text>
                  <text x="416" y="276">=</text>
                  <text x="448" y="276">0x820</text>
                  <text x="280" y="308">context</text>
                  <text x="320" y="308">=</text>
                  <text x="336" y="308">3</text>
                  <text x="392" y="308">KID</text>
                  <text x="416" y="308">=</text>
                  <text x="448" y="308">0xc20</text>
                  <text x="24" y="356">Epoch</text>
                  <text x="60" y="356">17</text>
                  <text x="164" y="356">index=33</text>
                  <text x="248" y="356">KID</text>
                  <text x="272" y="356">=</text>
                  <text x="304" y="356">0x211</text>
                  <text x="164" y="388">index=51</text>
                  <text x="248" y="388">KID</text>
                  <text x="272" y="388">=</text>
                  <text x="304" y="388">0x331</text>
                  <text x="32" y="436">...</text>
                </g>
              </svg><a class="pilcrow" href="#section-5.2-10.1.1">Â¶</a>
</div>
</div>
<figcaption><a class="selfRef" href="#figure-9">Figure 9</a>:
<a class="selfRef" href="#name-an-example-sequence-of-kids">An Example Sequence of KIDs for an MLS-based SFrame Session (E=4; S=6, Allowing for 64 Group Members)</a>
          </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="media-considerations">
<section id="section-6">
      <h2 id="name-media-considerations">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-media-considerations">Media Considerations</a>
      </h2>
<div id="selective-forwarding-units">
<section id="section-6.1">
        <h3 id="name-selective-forwarding-units">
<a class="section-number selfRef" href="#section-6.1">6.1. </a><a class="section-name selfRef" href="#name-selective-forwarding-units">Selective Forwarding Units</a>
        </h3>
<p id="section-6.1-1">SFUs (e.g., those described in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc7667#section-3.7">Section 3.7</a> of [<a class="cite xref" href="#RFC7667">RFC7667</a>]</span>) receive the media streams from each participant and select which
ones should be forwarded to each of the other participants.  There are several
approaches for stream selection, but in general, the SFU needs to access
metadata associated with each frame and modify the RTP information of the incoming
packets when they are transmitted to the received participants.<a class="pilcrow" href="#section-6.1-1">Â¶</a></p>
<p id="section-6.1-2">This section describes how these normal SFU modes of operation interact with the
E2EE provided by SFrame.<a class="pilcrow" href="#section-6.1-2">Â¶</a></p>
<div id="rtp-stream-reuse">
<section id="section-6.1.1">
          <h4 id="name-rtp-stream-reuse">
<a class="section-number selfRef" href="#section-6.1.1">6.1.1. </a><a class="section-name selfRef" href="#name-rtp-stream-reuse">RTP Stream Reuse</a>
          </h4>
<p id="section-6.1.1-1">The SFU may choose to send only a certain number of streams based on the voice
activity of the participants. To avoid the overhead involved in establishing new
transport streams, the SFU may decide to reuse previously existing streams or
even pre-allocate a predefined number of streams and choose in each moment in
time which participant media will be sent through it.<a class="pilcrow" href="#section-6.1.1-1">Â¶</a></p>
<p id="section-6.1.1-2">This means that the same transport-level stream (e.g., an RTP stream defined
by either SSRC or Media Identification (MID)) may carry media from different
streams of different participants. Because each participant uses a different key
to encrypt their media, the receiver will be able to verify the sender of the
media within the RTP stream at any given point in time. Thus the receiver will
correctly associate the media with the sender indicated by the authenticated
SFrame KID value, irrespective of how the SFU transmits the media to the client.<a class="pilcrow" href="#section-6.1.1-2">Â¶</a></p>
<p id="section-6.1.1-3">Note that in order to prevent impersonation by a malicious participant (not the
SFU), a mechanism based on digital signature would be required. SFrame does not
protect against such attacks.<a class="pilcrow" href="#section-6.1.1-3">Â¶</a></p>
</section>
</div>
<div id="simulcast">
<section id="section-6.1.2">
          <h4 id="name-simulcast">
<a class="section-number selfRef" href="#section-6.1.2">6.1.2. </a><a class="section-name selfRef" href="#name-simulcast">Simulcast</a>
          </h4>
<p id="section-6.1.2-1">When using simulcast, the same input image will produce N different encoded
frames (one per simulcast layer), which would be processed independently by the
frame encryptor and assigned an unique CTR value for each.<a class="pilcrow" href="#section-6.1.2-1">Â¶</a></p>
</section>
</div>
<div id="scalable-video-coding-svc">
<section id="section-6.1.3">
          <h4 id="name-scalable-video-coding-svc">
<a class="section-number selfRef" href="#section-6.1.3">6.1.3. </a><a class="section-name selfRef" href="#name-scalable-video-coding-svc">Scalable Video Coding (SVC)</a>
          </h4>
<p id="section-6.1.3-1">In both temporal and spatial scalability, the SFU may choose to drop layers in
order to match a certain bitrate or to forward specific media sizes or frames per
second. In order to support the SFU selectively removing layers, the sender <span class="bcp14">MUST</span>
encapsulate each layer in a different SFrame ciphertext.<a class="pilcrow" href="#section-6.1.3-1">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="video-key-frames">
<section id="section-6.2">
        <h3 id="name-video-key-frames">
<a class="section-number selfRef" href="#section-6.2">6.2. </a><a class="section-name selfRef" href="#name-video-key-frames">Video Key Frames</a>
        </h3>
<p id="section-6.2-1">Forward security and post-compromise security require that the E2EE keys (base keys)
are updated any time a participant joins or leaves the call.<a class="pilcrow" href="#section-6.2-1">Â¶</a></p>
<p id="section-6.2-2">The key exchange happens asynchronously and on a different path than the SFU signaling
and media. So it may happen that when a new participant joins the call and the
SFU side requests a key frame, the sender generates the E2EE frame
with a key that is not known by the receiver, so it will be discarded. When the sender
updates his sending key with the new key, it will send it in a non-key frame, so
the receiver will be able to decrypt it, but not decode it.<a class="pilcrow" href="#section-6.2-2">Â¶</a></p>
<p id="section-6.2-3">The new receiver will then re-request a key frame, but due to sender and SFU
policies, that new key frame could take some time to be generated.<a class="pilcrow" href="#section-6.2-3">Â¶</a></p>
<p id="section-6.2-4">If the sender sends a key frame after the new E2EE key is in use, the time
required for the new participant to display the video is minimized.<a class="pilcrow" href="#section-6.2-4">Â¶</a></p>
<p id="section-6.2-5">Note that this issue does not arise for media streams that do not have
dependencies among frames, e.g., audio streams.  In these streams, each frame is
independently decodable, so a frame never depends on another frame that might be
on the other side of a key rotation.<a class="pilcrow" href="#section-6.2-5">Â¶</a></p>
</section>
</div>
<div id="partial-decoding">
<section id="section-6.3">
        <h3 id="name-partial-decoding">
<a class="section-number selfRef" href="#section-6.3">6.3. </a><a class="section-name selfRef" href="#name-partial-decoding">Partial Decoding</a>
        </h3>
<p id="section-6.3-1">Some codecs support partial decoding, where individual packets can be decoded
without waiting for the full frame to arrive.  When SFrame is applied per frame,
partial decoding is not possible because the decoder cannot access data until an entire
frame has arrived and has been decrypted.<a class="pilcrow" href="#section-6.3-1">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-7">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<div id="no-header-confidentiality">
<section id="section-7.1">
        <h3 id="name-no-header-confidentiality">
<a class="section-number selfRef" href="#section-7.1">7.1. </a><a class="section-name selfRef" href="#name-no-header-confidentiality">No Header Confidentiality</a>
        </h3>
<p id="section-7.1-1">SFrame provides integrity protection to the SFrame header (the KID and
CTR values), but it does not provide confidentiality protection.  Parties that
can observe the SFrame header may learn, for example, which parties are sending
SFrame payloads (from KID values) and at what rates (from CTR values).  In cases
where SFrame is used for end-to-end security on top of hop-by-hop protections
(e.g., running over SRTP as described in <a class="auto internal xref" href="#sframe-over-rtp">Appendix B.5</a>), the hop-by-hop security
mechanisms provide confidentiality protection of the SFrame header between hops.<a class="pilcrow" href="#section-7.1-1">Â¶</a></p>
</section>
</div>
<div id="no-per-sender-authentication">
<section id="section-7.2">
        <h3 id="name-no-per-sender-authenticatio">
<a class="section-number selfRef" href="#section-7.2">7.2. </a><a class="section-name selfRef" href="#name-no-per-sender-authenticatio">No Per-Sender Authentication</a>
        </h3>
<p id="section-7.2-1">SFrame does not provide per-sender authentication of media data.  Any sender in
a session can send media that will be associated with any other sender.  This is
because SFrame uses symmetric encryption to protect media data, so that any
receiver also has the keys required to encrypt packets for the sender.<a class="pilcrow" href="#section-7.2-1">Â¶</a></p>
</section>
</div>
<div id="key-management-1">
<section id="section-7.3">
        <h3 id="name-key-management-2">
<a class="section-number selfRef" href="#section-7.3">7.3. </a><a class="section-name selfRef" href="#name-key-management-2">Key Management</a>
        </h3>
<p id="section-7.3-1">The specifics of key management are beyond the scope of this document. However, every client
<span class="bcp14">SHOULD</span> change their keys when new clients join or leave the call for forward
secrecy and post-compromise security.<a class="pilcrow" href="#section-7.3-1">Â¶</a></p>
</section>
</div>
<div id="replay">
<section id="section-7.4">
        <h3 id="name-replay">
<a class="section-number selfRef" href="#section-7.4">7.4. </a><a class="section-name selfRef" href="#name-replay">Replay</a>
        </h3>
<p id="section-7.4-1">The handling of replay is out of the scope of this document. However, senders
<span class="bcp14">MUST</span> reject requests to encrypt multiple times with the same key and nonce
since several AEAD algorithms fail badly in such cases (see, e.g., <span><a class="relref" href="https://rfc-editor.org/rfc/rfc5116#section-5.1.1">Section 5.1.1</a> of [<a class="cite xref" href="#RFC5116">RFC5116</a>]</span>).<a class="pilcrow" href="#section-7.4-1">Â¶</a></p>
</section>
</div>
<div id="risks-due-to-short-tags">
<section id="section-7.5">
        <h3 id="name-risks-due-to-short-tags">
<a class="section-number selfRef" href="#section-7.5">7.5. </a><a class="section-name selfRef" href="#name-risks-due-to-short-tags">Risks Due to Short Tags</a>
        </h3>
<p id="section-7.5-1">The SFrame cipher suites based on AES-CTR allow for the use of short
authentication tags, which bring a higher risk that an attacker will be
able to cause an SFrame receiver to accept an SFrame ciphertext of the
attacker's choosing.<a class="pilcrow" href="#section-7.5-1">Â¶</a></p>
<p id="section-7.5-2">Assuming that the authentication properties of the cipher suite are robust, the
only attack that an attacker can mount is an attempt to find an acceptable
(ciphertext, tag) combination through brute force.  Such a brute-force attack
will have an expected success rate of the following form:<a class="pilcrow" href="#section-7.5-2">Â¶</a></p>
<p id="section-7.5-3"><code>
attacker_success_rate = attempts_per_second / 2^(8*Nt)
</code><a class="pilcrow" href="#section-7.5-3">Â¶</a></p>
<p id="section-7.5-4">For example, a gigabit Ethernet connection is able to transmit roughly 2<sup>20</sup>
packets per second.  If an attacker saturated such a link with guesses against a
32-bit authentication tag (<code>Nt=4</code>), then the attacker would succeed on average
roughly once every 2<sup>12</sup> seconds, or about once an hour.<a class="pilcrow" href="#section-7.5-4">Â¶</a></p>
<p id="section-7.5-5">In a typical SFrame usage in a real-time media application, there are a few
approaches to mitigating this risk:<a class="pilcrow" href="#section-7.5-5">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.5-6.1">
            <p id="section-7.5-6.1.1">Receivers only accept SFrame ciphertexts over HBH-secure channels (e.g., SRTP
security associations or QUIC connections).  If this is the case, only an
entity that is part of such a channel can mount the above attack.<a class="pilcrow" href="#section-7.5-6.1.1">Â¶</a></p>
</li>
          <li class="normal" id="section-7.5-6.2">
            <p id="section-7.5-6.2.1">The expected packet rate for a media stream is very predictable (and typically
far lower than the above example).  On the one hand, attacks at this rate will
succeed even less often than the high-rate attack described above.  On the
other hand, the application may use an elevated packet arrival rate as a
signal of a brute-force attack.  This latter approach is common in other
settings, e.g., mitigating brute-force attacks on passwords.<a class="pilcrow" href="#section-7.5-6.2.1">Â¶</a></p>
</li>
          <li class="normal" id="section-7.5-6.3">
            <p id="section-7.5-6.3.1">Media applications typically do not provide feedback to media senders as to
which media packets failed to decrypt.  When media-quality feedback
mechanisms are used, decryption failures will typically appear as packet
losses, but only at an aggregate level.<a class="pilcrow" href="#section-7.5-6.3.1">Â¶</a></p>
</li>
          <li class="normal" id="section-7.5-6.4">
            <p id="section-7.5-6.4.1">Anti-replay mechanisms (see <a class="auto internal xref" href="#replay">Section 7.4</a>) prevent the attacker from reusing
valid ciphertexts (either observed or guessed by the attacker).  A receiver
applying anti-replay controls will only accept one valid plaintext per CTR
value.  Since the CTR value is covered by SFrame authentication, an attacker
has to do a fresh search for a valid tag for every forged ciphertext, even if
the encrypted content is unchanged.  In other words, when the above brute-force
attack succeeds, it only allows the attacker to send a single SFrame
ciphertext; the ciphertext cannot be reused because either it will have the
same CTR value and be discarded as a replay, or else it will have a different
CTR value and its tag will no longer be valid.<a class="pilcrow" href="#section-7.5-6.4.1">Â¶</a></p>
</li>
        </ul>
<p id="section-7.5-7">Nonetheless, without these mitigations, an application that makes use of short
tags will be at heightened risk of forgery attacks.  In many cases, it is
simpler to use full-size tags and tolerate slightly higher bandwidth usage
rather than to add the additional defenses necessary to safely use short tags.<a class="pilcrow" href="#section-7.5-7">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-8">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-8">8. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<p id="section-8-1">IANA has created a new registry called "SFrame Cipher Suites" (<a class="auto internal xref" href="#sframe-cipher-suites">Section 8.1</a>)
under the "SFrame" group registry heading.<a class="pilcrow" href="#section-8-1">Â¶</a></p>
<div id="sframe-cipher-suites">
<section id="section-8.1">
        <h3 id="name-sframe-cipher-suites">
<a class="section-number selfRef" href="#section-8.1">8.1. </a><a class="section-name selfRef" href="#name-sframe-cipher-suites">SFrame Cipher Suites</a>
        </h3>
<p id="section-8.1-1">The "SFrame Cipher Suites" registry lists identifiers for SFrame cipher suites as defined in
<a class="auto internal xref" href="#cipher-suites">Section 4.5</a>.  The cipher suite field is two bytes wide, so the valid cipher
suites are in the range 0x0000 to 0xFFFF.  Except as noted below, assignments are made
via the Specification Required policy <span>[<a class="cite xref" href="#RFC8126">RFC8126</a>]</span>.<a class="pilcrow" href="#section-8.1-1">Â¶</a></p>
<p id="section-8.1-2">The registration template is as follows:<a class="pilcrow" href="#section-8.1-2">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.1-3.1">
            <p id="section-8.1-3.1.1">Value: The numeric value of the cipher suite<a class="pilcrow" href="#section-8.1-3.1.1">Â¶</a></p>
</li>
          <li class="normal" id="section-8.1-3.2">
            <p id="section-8.1-3.2.1">Name: The name of the cipher suite<a class="pilcrow" href="#section-8.1-3.2.1">Â¶</a></p>
</li>
          <li class="normal" id="section-8.1-3.3">
            <p id="section-8.1-3.3.1">Recommended: Whether support for this cipher suite is recommended by the IETF.
Valid values are "Y", "N", and "D" as described in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc9420#section-17.1">Section 17.1</a> of [<a class="cite xref" href="#RFC9420">MLS-PROTO</a>]</span>. The default value of the "Recommended" column is "N". Setting the
Recommended item to "Y" or "D", or changing an item whose current value is "Y"
or "D", requires Standards Action <span>[<a class="cite xref" href="#RFC8126">RFC8126</a>]</span>.<a class="pilcrow" href="#section-8.1-3.3.1">Â¶</a></p>
</li>
          <li class="normal" id="section-8.1-3.4">
            <p id="section-8.1-3.4.1">Reference: The document where this cipher suite is defined<a class="pilcrow" href="#section-8.1-3.4.1">Â¶</a></p>
</li>
          <li class="normal" id="section-8.1-3.5">
            <p id="section-8.1-3.5.1">Change Controller: Who is authorized to update the row in the registry<a class="pilcrow" href="#section-8.1-3.5.1">Â¶</a></p>
</li>
        </ul>
<p id="section-8.1-4">Initial contents:<a class="pilcrow" href="#section-8.1-4">Â¶</a></p>
<span id="name-sframe-cipher-suites-2"></span><div id="iana-cipher-suites">
<table class="center" id="table-2">
          <caption>
<a class="selfRef" href="#table-2">Table 2</a>:
<a class="selfRef" href="#name-sframe-cipher-suites-2">SFrame Cipher Suites</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Value</th>
              <th class="text-left" colspan="1" rowspan="1">Name</th>
              <th class="text-left" colspan="1" rowspan="1">R</th>
              <th class="text-left" colspan="1" rowspan="1">Reference</th>
              <th class="text-left" colspan="1" rowspan="1">Change Controller</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0x0000</td>
              <td class="text-left" colspan="1" rowspan="1">Reserved</td>
              <td class="text-left" colspan="1" rowspan="1">-</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9605</td>
              <td class="text-left" colspan="1" rowspan="1">IETF</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0x0001</td>
              <td class="text-left" colspan="1" rowspan="1">
                <code>AES_128_CTR_HMAC_SHA256_80</code>
</td>
              <td class="text-left" colspan="1" rowspan="1">Y</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9605</td>
              <td class="text-left" colspan="1" rowspan="1">IETF</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0x0002</td>
              <td class="text-left" colspan="1" rowspan="1">
                <code>AES_128_CTR_HMAC_SHA256_64</code>
</td>
              <td class="text-left" colspan="1" rowspan="1">Y</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9605</td>
              <td class="text-left" colspan="1" rowspan="1">IETF</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0x0003</td>
              <td class="text-left" colspan="1" rowspan="1">
                <code>AES_128_CTR_HMAC_SHA256_32</code>
</td>
              <td class="text-left" colspan="1" rowspan="1">Y</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9605</td>
              <td class="text-left" colspan="1" rowspan="1">IETF</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0x0004</td>
              <td class="text-left" colspan="1" rowspan="1">
                <code>AES_128_GCM_SHA256_128</code>
</td>
              <td class="text-left" colspan="1" rowspan="1">Y</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9605</td>
              <td class="text-left" colspan="1" rowspan="1">IETF</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0x0005</td>
              <td class="text-left" colspan="1" rowspan="1">
                <code>AES_256_GCM_SHA512_128</code>
</td>
              <td class="text-left" colspan="1" rowspan="1">Y</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9605</td>
              <td class="text-left" colspan="1" rowspan="1">IETF</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0xF000 - 0xFFFF</td>
              <td class="text-left" colspan="1" rowspan="1">Reserved for Private Use</td>
              <td class="text-left" colspan="1" rowspan="1">-</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9605</td>
              <td class="text-left" colspan="1" rowspan="1">IETF</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
</section>
</div>
<div id="application-responsibilities">
<section id="section-9">
      <h2 id="name-application-responsibilitie">
<a class="section-number selfRef" href="#section-9">9. </a><a class="section-name selfRef" href="#name-application-responsibilitie">Application Responsibilities</a>
      </h2>
<p id="section-9-1">To use SFrame, an application needs to define the inputs to the SFrame
encryption and decryption operations, and how SFrame ciphertexts are delivered
from sender to receiver (including any fragmentation and reassembly).  In this
section, we lay out additional requirements that an application must meet in
order for SFrame to operate securely.<a class="pilcrow" href="#section-9-1">Â¶</a></p>
<p id="section-9-2">In general, an application using SFrame is responsible for configuring SFrame.
The application must first define when SFrame is applied at all.  When SFrame is
applied, the application must define which cipher suite is to be used.  If new
versions of SFrame are defined in the future, it will be the application's responsibility
to determine which version should be used.<a class="pilcrow" href="#section-9-2">Â¶</a></p>
<p id="section-9-3">This division of responsibilities is similar to the way other media parameters
(e.g., codecs) are typically handled in media applications, in the sense that
they are set up in some signaling protocol and not described in the media.
Applications might find it useful to extend the protocols used for negotiating
other media parameters (e.g., Session Description Protocol (SDP) <span>[<a class="cite xref" href="#RFC8866">RFC8866</a>]</span>) to also negotiate parameters for
SFrame.<a class="pilcrow" href="#section-9-3">Â¶</a></p>
<div id="header-value-uniqueness">
<section id="section-9.1">
        <h3 id="name-header-value-uniqueness">
<a class="section-number selfRef" href="#section-9.1">9.1. </a><a class="section-name selfRef" href="#name-header-value-uniqueness">Header Value Uniqueness</a>
        </h3>
<p id="section-9.1-1">Applications <span class="bcp14">MUST</span> ensure that each (<code>base_key</code>, KID, CTR) combination is used
for at most one SFrame encryption operation. This ensures that the (key, nonce)
pairs used by the underlying AEAD algorithm are never reused. Typically this is
done by assigning each sender a KID or set of KIDs, then having each sender use
the CTR field as a monotonic counter, incrementing for each plaintext that is
encrypted. In addition to its simplicity, this scheme minimizes overhead by
keeping CTR values as small as possible.<a class="pilcrow" href="#section-9.1-1">Â¶</a></p>
<p id="section-9.1-2">In applications where an SFrame context might be written to persistent storage,
this context needs to include the last-used CTR value.  When the context is used
later, the application should use the stored CTR value to determine the next CTR
value to be used in an encryption operation, and then write the next CTR value
back to storage before using the CTR value for encryption.  Storing the CTR
value before usage (vs. after) helps ensure that a storage failure will not
cause reuse of the same (<code>base_key</code>, KID, CTR) combination.<a class="pilcrow" href="#section-9.1-2">Â¶</a></p>
</section>
</div>
<div id="key-management-framework">
<section id="section-9.2">
        <h3 id="name-key-management-framework">
<a class="section-number selfRef" href="#section-9.2">9.2. </a><a class="section-name selfRef" href="#name-key-management-framework">Key Management Framework</a>
        </h3>
<p id="section-9.2-1">The application is responsible for provisioning SFrame with a mapping of KID values to
<code>base_key</code> values and the resulting keys and salts.  More importantly, the
application specifies which KID values are used for which purposes (e.g., by
which senders).  An application's KID assignment strategy <span class="bcp14">MUST</span> be structured to
assure the non-reuse properties discussed in <a class="auto internal xref" href="#header-value-uniqueness">Section 9.1</a>.<a class="pilcrow" href="#section-9.2-1">Â¶</a></p>
<p id="section-9.2-2">The application is also responsible for defining a rotation schedule for keys.  For
example, one application might have an ephemeral group for every call and keep
rotating keys when endpoints join or leave the call, while another application
could have a persistent group that can be used for multiple calls and simply
derives ephemeral symmetric keys for a specific call.<a class="pilcrow" href="#section-9.2-2">Â¶</a></p>
<p id="section-9.2-3">It should be noted that KID values are not encrypted by SFrame and are thus
visible to any application-layer intermediaries that might handle an SFrame
ciphertext.  If there are application semantics included in KID values, then
this information would be exposed to intermediaries.  For example, in the scheme
of <a class="auto internal xref" href="#sender-keys">Section 5.1</a>, the number of ratchet steps per sender is exposed, and in
the scheme of <a class="auto internal xref" href="#mls">Section 5.2</a>, the number of epochs and the MLS sender ID of the SFrame
sender are exposed.<a class="pilcrow" href="#section-9.2-3">Â¶</a></p>
</section>
</div>
<div id="anti-replay">
<section id="section-9.3">
        <h3 id="name-anti-replay">
<a class="section-number selfRef" href="#section-9.3">9.3. </a><a class="section-name selfRef" href="#name-anti-replay">Anti-Replay</a>
        </h3>
<p id="section-9.3-1">It is the responsibility of the application to handle anti-replay. Replay by network
attackers is assumed to be prevented by network-layer facilities (e.g., TLS, SRTP).
As mentioned in <a class="auto internal xref" href="#replay">Section 7.4</a>, senders <span class="bcp14">MUST</span> reject requests to encrypt multiple times
with the same key and nonce.<a class="pilcrow" href="#section-9.3-1">Â¶</a></p>
<p id="section-9.3-2">It is not mandatory to implement anti-replay on the receiver side. Receivers <span class="bcp14">MAY</span>
apply time- or counter-based anti-replay mitigations.  For example, <span><a class="relref" href="https://rfc-editor.org/rfc/rfc3711#section-3.3.2">Section 3.3.2</a> of [<a class="cite xref" href="#RFC3711">RFC3711</a>]</span> specifies a counter-based anti-replay mitigation, which
could be adapted to use with SFrame, using the CTR field as the counter.<a class="pilcrow" href="#section-9.3-2">Â¶</a></p>
</section>
</div>
<div id="metadata">
<section id="section-9.4">
        <h3 id="name-metadata">
<a class="section-number selfRef" href="#section-9.4">9.4. </a><a class="section-name selfRef" href="#name-metadata">Metadata</a>
        </h3>
<p id="section-9.4-1">The <code>metadata</code> input to SFrame operations is an opaque byte string specified by the application. As
such, the application needs to define what information should go in the
<code>metadata</code> input and ensure that it is provided to the encryption and decryption
functions at the appropriate points.  A receiver <span class="bcp14">MUST NOT</span> use SFrame-authenticated
metadata until after the SFrame decrypt function has authenticated it, unless
the purpose of such usage is to prepare an SFrame ciphertext for SFrame
decryption.  Essentially, metadata may be used "upstream of SFrame" in a
processing pipeline, but only to prepare for SFrame decryption.<a class="pilcrow" href="#section-9.4-1">Â¶</a></p>
<p id="section-9.4-2">For example, consider an application where SFrame is used to encrypt audio
frames that are sent over SRTP, with some application data included in the RTP
header extension. Suppose the application also includes this application data in
the SFrame metadata, so that the SFU is allowed to read, but not modify, the
application data.  A receiver can use the application data in the RTP header
extension as part of the standard SRTP decryption process since this is
required to recover the SFrame ciphertext carried in the SRTP payload.  However,
the receiver <span class="bcp14">MUST NOT</span> use the application data for other purposes before SFrame
decryption has authenticated the application data.<a class="pilcrow" href="#section-9.4-2">Â¶</a></p>
</section>
</div>
</section>
</div>
<section id="section-10">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-10">10. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-10.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-10.1">10.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC9420">[MLS-PROTO]</dt>
        <dd>
<span class="refAuthor">Barnes, R.</span>, <span class="refAuthor">Beurdouche, B.</span>, <span class="refAuthor">Robert, R.</span>, <span class="refAuthor">Millican, J.</span>, <span class="refAuthor">Omara, E.</span>, and <span class="refAuthor">K. Cohn-Gordon</span>, <span class="refTitle">"The Messaging Layer Security (MLS) Protocol"</span>, <span class="seriesInfo">RFC 9420</span>, <span class="seriesInfo">DOI 10.17487/RFC9420</span>, <time class="refDate" datetime="2023-07">July 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9420">https://www.rfc-editor.org/info/rfc9420</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time class="refDate" datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5116">[RFC5116]</dt>
        <dd>
<span class="refAuthor">McGrew, D.</span>, <span class="refTitle">"An Interface and Algorithms for Authenticated Encryption"</span>, <span class="seriesInfo">RFC 5116</span>, <span class="seriesInfo">DOI 10.17487/RFC5116</span>, <time class="refDate" datetime="2008-01">January 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5116">https://www.rfc-editor.org/info/rfc5116</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5869">[RFC5869]</dt>
        <dd>
<span class="refAuthor">Krawczyk, H.</span> and <span class="refAuthor">P. Eronen</span>, <span class="refTitle">"HMAC-based Extract-and-Expand Key Derivation Function (HKDF)"</span>, <span class="seriesInfo">RFC 5869</span>, <span class="seriesInfo">DOI 10.17487/RFC5869</span>, <time class="refDate" datetime="2010-05">May 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5869">https://www.rfc-editor.org/info/rfc5869</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time class="refDate" datetime="2017-06">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time class="refDate" datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-10.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-10.2">10.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-mls-architecture">[MLS-ARCH]</dt>
        <dd>
<span class="refAuthor">Beurdouche, B.</span>, <span class="refAuthor">Rescorla, E.</span>, <span class="refAuthor">Omara, E.</span>, <span class="refAuthor">Inguva, S.</span>, and <span class="refAuthor">A. Duric</span>, <span class="refTitle">"The Messaging Layer Security (MLS) Architecture"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-mls-architecture-15</span>, <time class="refDate" datetime="2024-08-03">3 August 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-mls-architecture-15">https://datatracker.ietf.org/doc/html/draft-ietf-mls-architecture-15</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-moq-transport">[MOQ-TRANSPORT]</dt>
        <dd>
<span class="refAuthor">Curley, L.</span>, <span class="refAuthor">Pugin, K.</span>, <span class="refAuthor">Nandakumar, S.</span>, <span class="refAuthor">Vasiliev, V.</span>, and <span class="refAuthor">I. Swett, Ed.</span>, <span class="refTitle">"Media over QUIC Transport"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-moq-transport-05</span>, <time class="refDate" datetime="2024-07-08">8 July 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-moq-transport-05">https://datatracker.ietf.org/doc/html/draft-ietf-moq-transport-05</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3711">[RFC3711]</dt>
        <dd>
<span class="refAuthor">Baugher, M.</span>, <span class="refAuthor">McGrew, D.</span>, <span class="refAuthor">Naslund, M.</span>, <span class="refAuthor">Carrara, E.</span>, and <span class="refAuthor">K. Norrman</span>, <span class="refTitle">"The Secure Real-time Transport Protocol (SRTP)"</span>, <span class="seriesInfo">RFC 3711</span>, <span class="seriesInfo">DOI 10.17487/RFC3711</span>, <time class="refDate" datetime="2004-03">March 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3711">https://www.rfc-editor.org/info/rfc3711</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6716">[RFC6716]</dt>
        <dd>
<span class="refAuthor">Valin, JM.</span>, <span class="refAuthor">Vos, K.</span>, and <span class="refAuthor">T. Terriberry</span>, <span class="refTitle">"Definition of the Opus Audio Codec"</span>, <span class="seriesInfo">RFC 6716</span>, <span class="seriesInfo">DOI 10.17487/RFC6716</span>, <time class="refDate" datetime="2012-09">September 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6716">https://www.rfc-editor.org/info/rfc6716</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7656">[RFC7656]</dt>
        <dd>
<span class="refAuthor">Lennox, J.</span>, <span class="refAuthor">Gross, K.</span>, <span class="refAuthor">Nandakumar, S.</span>, <span class="refAuthor">Salgueiro, G.</span>, and <span class="refAuthor">B. Burman, Ed.</span>, <span class="refTitle">"A Taxonomy of Semantics and Mechanisms for Real-Time Transport Protocol (RTP) Sources"</span>, <span class="seriesInfo">RFC 7656</span>, <span class="seriesInfo">DOI 10.17487/RFC7656</span>, <time class="refDate" datetime="2015-11">November 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7656">https://www.rfc-editor.org/info/rfc7656</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7667">[RFC7667]</dt>
        <dd>
<span class="refAuthor">Westerlund, M.</span> and <span class="refAuthor">S. Wenger</span>, <span class="refTitle">"RTP Topologies"</span>, <span class="seriesInfo">RFC 7667</span>, <span class="seriesInfo">DOI 10.17487/RFC7667</span>, <time class="refDate" datetime="2015-11">November 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7667">https://www.rfc-editor.org/info/rfc7667</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8723">[RFC8723]</dt>
        <dd>
<span class="refAuthor">Jennings, C.</span>, <span class="refAuthor">Jones, P.</span>, <span class="refAuthor">Barnes, R.</span>, and <span class="refAuthor">A.B. Roach</span>, <span class="refTitle">"Double Encryption Procedures for the Secure Real-Time Transport Protocol (SRTP)"</span>, <span class="seriesInfo">RFC 8723</span>, <span class="seriesInfo">DOI 10.17487/RFC8723</span>, <time class="refDate" datetime="2020-04">April 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8723">https://www.rfc-editor.org/info/rfc8723</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8866">[RFC8866]</dt>
        <dd>
<span class="refAuthor">Begen, A.</span>, <span class="refAuthor">Kyzivat, P.</span>, <span class="refAuthor">Perkins, C.</span>, and <span class="refAuthor">M. Handley</span>, <span class="refTitle">"SDP: Session Description Protocol"</span>, <span class="seriesInfo">RFC 8866</span>, <span class="seriesInfo">DOI 10.17487/RFC8866</span>, <time class="refDate" datetime="2021-01">January 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8866">https://www.rfc-editor.org/info/rfc8866</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.gouaillard-avtcore-codec-agn-rtp-payload">[RTP-PAYLOAD]</dt>
        <dd>
<span class="refAuthor">Murillo, S. G.</span>, <span class="refAuthor">Fablet, Y.</span>, and <span class="refAuthor">A. Gouaillard</span>, <span class="refTitle">"Codec agnostic RTP payload format for video"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-gouaillard-avtcore-codec-agn-rtp-payload-01</span>, <time class="refDate" datetime="2021-03-09">9 March 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-gouaillard-avtcore-codec-agn-rtp-payload-01">https://datatracker.ietf.org/doc/html/draft-gouaillard-avtcore-codec-agn-rtp-payload-01</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TestVectors">[TestVectors]</dt>
        <dd>
<span class="refTitle">"SFrame Test Vectors"</span>, <span class="refContent">commit 025d568</span>, <time class="refDate" datetime="2023-09">September 2023</time>, <span>&lt;<a href="https://github.com/sframe-wg/sframe/blob/025d568/test-vectors/test-vectors.json">https://github.com/sframe-wg/sframe/blob/025d568/test-vectors/test-vectors.json</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-webtrans-overview">[WEBTRANSPORT]</dt>
      <dd>
<span class="refAuthor">Vasiliev, V.</span>, <span class="refTitle">"The WebTransport Protocol Framework"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-webtrans-overview-08</span>, <time class="refDate" datetime="2024-08-25">25 August 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/api/v1/doc/document/draft-ietf-webtrans-overview/">https://datatracker.ietf.org/api/v1/doc/document/draft-ietf-webtrans-overview/</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
<div id="example-api">
<section id="appendix-A">
      <h2 id="name-example-api">
<a class="section-number selfRef" href="#appendix-A">Appendix A. </a><a class="section-name selfRef" href="#name-example-api">Example API</a>
      </h2>
<p id="appendix-A-1"><strong>This section is not normative.</strong><a class="pilcrow" href="#appendix-A-1">Â¶</a></p>
<p id="appendix-A-2">This section describes a notional API that an SFrame implementation might
expose.  The core concept is an "SFrame context", within which KID values are
meaningful.  In the key management scheme described in <a class="auto internal xref" href="#sender-keys">Section 5.1</a>, each
sender has a different context; in the scheme described in <a class="auto internal xref" href="#mls">Section 5.2</a>, all senders
share the same context.<a class="pilcrow" href="#appendix-A-2">Â¶</a></p>
<p id="appendix-A-3">An SFrame context stores mappings from KID values to "key contexts", which are
different depending on whether the KID is to be used for sending or receiving
(an SFrame key should never be used for both operations).  A key context tracks
the key and salt associated to the KID, and the current CTR value.  A key
context to be used for sending also tracks the next CTR value to be used.<a class="pilcrow" href="#appendix-A-3">Â¶</a></p>
<p id="appendix-A-4">The primary operations on an SFrame context are as follows:<a class="pilcrow" href="#appendix-A-4">Â¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-5.1">
          <p id="appendix-A-5.1.1"><strong>Create an SFrame context:</strong> The context is initialized with a cipher suite and
no KID mappings.<a class="pilcrow" href="#appendix-A-5.1.1">Â¶</a></p>
</li>
        <li class="normal" id="appendix-A-5.2">
          <p id="appendix-A-5.2.1"><strong>Add a key for sending:</strong> The key and salt are derived from the base key and
used to initialize a send context, together with a zero CTR value.<a class="pilcrow" href="#appendix-A-5.2.1">Â¶</a></p>
</li>
        <li class="normal" id="appendix-A-5.3">
          <p id="appendix-A-5.3.1"><strong>Add a key for receiving:</strong> The key and salt are derived from the base key and
used to initialize a send context.<a class="pilcrow" href="#appendix-A-5.3.1">Â¶</a></p>
</li>
        <li class="normal" id="appendix-A-5.4">
          <p id="appendix-A-5.4.1"><strong>Encrypt a plaintext:</strong> Encrypt a given plaintext using the key for a given KID,
including the specified metadata.<a class="pilcrow" href="#appendix-A-5.4.1">Â¶</a></p>
</li>
        <li class="normal" id="appendix-A-5.5">
          <p id="appendix-A-5.5.1"><strong>Decrypt an SFrame ciphertext:</strong> Decrypt an SFrame ciphertext with the KID
and CTR values specified in the SFrame header, and the provided metadata.<a class="pilcrow" href="#appendix-A-5.5.1">Â¶</a></p>
</li>
      </ul>
<p id="appendix-A-6"><a class="auto internal xref" href="#rust-api">Figure 10</a> shows an example of the types of structures and methods that could
be used to create an SFrame API in Rust.<a class="pilcrow" href="#appendix-A-6">Â¶</a></p>
<span id="name-an-example-sframe-api"></span><div id="rust-api">
<figure id="figure-10">
        <div class="lang-rust sourcecode" id="appendix-A-7.1">
<pre>type KeyId = u64;
type Counter = u64;
type CipherSuite = u16;

struct SendKeyContext {
  key: Vec&lt;u8&gt;,
  salt: Vec&lt;u8&gt;,
  next_counter: Counter,
}

struct RecvKeyContext {
  key: Vec&lt;u8&gt;,
  salt: Vec&lt;u8&gt;,
}

struct SFrameContext {
  cipher_suite: CipherSuite,
  send_keys: HashMap&lt;KeyId, SendKeyContext&gt;,
  recv_keys: HashMap&lt;KeyId, RecvKeyContext&gt;,
}

trait SFrameContextMethods {
  fn create(cipher_suite: CipherSuite) -&gt; Self;
  fn add_send_key(&amp;self, kid: KeyId, base_key: &amp;[u8]);
  fn add_recv_key(&amp;self, kid: KeyId, base_key: &amp;[u8]);
  fn encrypt(&amp;mut self, kid: KeyId, metadata: &amp;[u8],
             plaintext: &amp;[u8]) -&gt; Vec&lt;u8&gt;;
  fn decrypt(&amp;self, metadata: &amp;[u8], ciphertext: &amp;[u8]) -&gt; Vec&lt;u8&gt;;
}
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-10">Figure 10</a>:
<a class="selfRef" href="#name-an-example-sframe-api">An Example SFrame API</a>
        </figcaption></figure>
</div>
</section>
</div>
<div id="overhead-analysis">
<section id="appendix-B">
      <h2 id="name-overhead-analysis">
<a class="section-number selfRef" href="#appendix-B">Appendix B. </a><a class="section-name selfRef" href="#name-overhead-analysis">Overhead Analysis</a>
      </h2>
<p id="appendix-B-1">Any use of SFrame will impose overhead in terms of the amount of bandwidth
necessary to transmit a given media stream.  Exactly how much overhead will be added
depends on several factors:<a class="pilcrow" href="#appendix-B-1">Â¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-2.1">
          <p id="appendix-B-2.1.1">The number of senders involved in a conference (length of KID)<a class="pilcrow" href="#appendix-B-2.1.1">Â¶</a></p>
</li>
        <li class="normal" id="appendix-B-2.2">
          <p id="appendix-B-2.2.1">The duration of the conference (length of CTR)<a class="pilcrow" href="#appendix-B-2.2.1">Â¶</a></p>
</li>
        <li class="normal" id="appendix-B-2.3">
          <p id="appendix-B-2.3.1">The cipher suite in use (length of authentication tag)<a class="pilcrow" href="#appendix-B-2.3.1">Â¶</a></p>
</li>
        <li class="normal" id="appendix-B-2.4">
          <p id="appendix-B-2.4.1">Whether SFrame is used to encrypt packets, whole frames, or some other unit<a class="pilcrow" href="#appendix-B-2.4.1">Â¶</a></p>
</li>
      </ul>
<p id="appendix-B-3">Overall, the overhead rate in kilobits per second can be estimated as:<a class="pilcrow" href="#appendix-B-3">Â¶</a></p>
<p id="appendix-B-4"><code>
OverheadKbps = (1 + |CTR| + |KID| + |TAG|) * 8 * CTPerSecond / 1024
</code><a class="pilcrow" href="#appendix-B-4">Â¶</a></p>
<p id="appendix-B-5">Here the constant value <code>1</code> reflects the fixed SFrame header; <code>|CTR|</code> and
<code>|KID|</code> reflect the lengths of those fields; <code>|TAG|</code> reflects the cipher
overhead; and <code>CTPerSecond</code> reflects the number of SFrame ciphertexts
sent per second (e.g., packets or frames per second).<a class="pilcrow" href="#appendix-B-5">Â¶</a></p>
<p id="appendix-B-6">In the remainder of this section, we compute overhead estimates for a collection
of common scenarios.<a class="pilcrow" href="#appendix-B-6">Â¶</a></p>
<div id="assumptions">
<section id="appendix-B.1">
        <h3 id="name-assumptions">
<a class="section-number selfRef" href="#appendix-B.1">B.1. </a><a class="section-name selfRef" href="#name-assumptions">Assumptions</a>
        </h3>
<p id="appendix-B.1-1">In the below calculations, we make conservative assumptions about SFrame
overhead so that the overhead amounts we compute here are likely to be an upper
bound of those seen in practice.<a class="pilcrow" href="#appendix-B.1-1">Â¶</a></p>
<span id="name-overhead-analysis-assumptio"></span><div id="analysis-assumptions">
<table class="center" id="table-3">
          <caption>
<a class="selfRef" href="#table-3">Table 3</a>:
<a class="selfRef" href="#name-overhead-analysis-assumptio">Overhead Analysis Assumptions</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Field</th>
              <th class="text-right" colspan="1" rowspan="1">Bytes</th>
              <th class="text-left" colspan="1" rowspan="1">Explanation</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">Config byte</td>
              <td class="text-right" colspan="1" rowspan="1">1</td>
              <td class="text-left" colspan="1" rowspan="1">Fixed</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">Key ID (KID)</td>
              <td class="text-right" colspan="1" rowspan="1">2</td>
              <td class="text-left" colspan="1" rowspan="1">&gt;255 senders; or MLS epoch (E=4) and &gt;16 senders</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">Counter (CTR)</td>
              <td class="text-right" colspan="1" rowspan="1">3</td>
              <td class="text-left" colspan="1" rowspan="1">More than 24 hours of media in common cases</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">Cipher overhead</td>
              <td class="text-right" colspan="1" rowspan="1">16</td>
              <td class="text-left" colspan="1" rowspan="1">Full authentication tag (longest defined here)</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="appendix-B.1-3">In total, then, we assume that each SFrame encryption will add 22 bytes of
overhead.<a class="pilcrow" href="#appendix-B.1-3">Â¶</a></p>
<p id="appendix-B.1-4">We consider two scenarios: applying SFrame per frame and per packet.  In each
scenario, we compute the SFrame overhead in absolute terms (kbps) and as a
percentage of the base bandwidth.<a class="pilcrow" href="#appendix-B.1-4">Â¶</a></p>
</section>
</div>
<div id="audio">
<section id="appendix-B.2">
        <h3 id="name-audio">
<a class="section-number selfRef" href="#appendix-B.2">B.2. </a><a class="section-name selfRef" href="#name-audio">Audio</a>
        </h3>
<p id="appendix-B.2-1">In audio streams, there is typically a one-to-one relationship between frames
and packets, so the overhead is the same whether one uses SFrame at a per-packet
or per-frame level.<a class="pilcrow" href="#appendix-B.2-1">Â¶</a></p>
<p id="appendix-B.2-2"><a class="auto internal xref" href="#audio-overhead">Table 4</a> considers three scenarios that are based on recommended configurations
of the Opus codec <span>[<a class="cite xref" href="#RFC6716">RFC6716</a>]</span> (where "fps" stands for "frames per second"):<a class="pilcrow" href="#appendix-B.2-2">Â¶</a></p>
<span id="name-sframe-overhead-for-audio-s"></span><div id="audio-overhead">
<table class="center" id="table-4">
          <caption>
<a class="selfRef" href="#table-4">Table 4</a>:
<a class="selfRef" href="#name-sframe-overhead-for-audio-s">SFrame Overhead for Audio Streams</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Scenario</th>
              <th class="text-center" colspan="1" rowspan="1">Frame length</th>
              <th class="text-center" colspan="1" rowspan="1">fps</th>
              <th class="text-center" colspan="1" rowspan="1">Base kbps</th>
              <th class="text-center" colspan="1" rowspan="1">Overhead kbps</th>
              <th class="text-center" colspan="1" rowspan="1">Overhead %</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">Narrow-band speech</td>
              <td class="text-center" colspan="1" rowspan="1">120 ms</td>
              <td class="text-center" colspan="1" rowspan="1">8.3</td>
              <td class="text-center" colspan="1" rowspan="1">8</td>
              <td class="text-center" colspan="1" rowspan="1">1.4</td>
              <td class="text-center" colspan="1" rowspan="1">17.9%</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">Full-band speech</td>
              <td class="text-center" colspan="1" rowspan="1">20 ms</td>
              <td class="text-center" colspan="1" rowspan="1">50</td>
              <td class="text-center" colspan="1" rowspan="1">32</td>
              <td class="text-center" colspan="1" rowspan="1">8.6</td>
              <td class="text-center" colspan="1" rowspan="1">26.9%</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">Full-band stereo music</td>
              <td class="text-center" colspan="1" rowspan="1">10 ms</td>
              <td class="text-center" colspan="1" rowspan="1">100</td>
              <td class="text-center" colspan="1" rowspan="1">128</td>
              <td class="text-center" colspan="1" rowspan="1">17.2</td>
              <td class="text-center" colspan="1" rowspan="1">13.4%</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="video">
<section id="appendix-B.3">
        <h3 id="name-video">
<a class="section-number selfRef" href="#appendix-B.3">B.3. </a><a class="section-name selfRef" href="#name-video">Video</a>
        </h3>
<p id="appendix-B.3-1">Video frames can be larger than an MTU and thus are commonly split across
multiple frames.  Tables <a class="auto internal xref" href="#video-overhead-per-frame">5</a>
and <a class="auto internal xref" href="#video-overhead-per-packet">6</a>
show the estimated overhead of encrypting a video stream, where SFrame is
applied per frame and per packet, respectively.  The choices of resolution,
frames per second, and bandwidth roughly reflect the capabilities of
modern video codecs across a range from very low to very high quality.<a class="pilcrow" href="#appendix-B.3-1">Â¶</a></p>
<span id="name-sframe-overhead-for-a-video"></span><div id="video-overhead-per-frame">
<table class="center" id="table-5">
          <caption>
<a class="selfRef" href="#table-5">Table 5</a>:
<a class="selfRef" href="#name-sframe-overhead-for-a-video">SFrame Overhead for a Video Stream Encrypted per Frame</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Scenario</th>
              <th class="text-center" colspan="1" rowspan="1">fps</th>
              <th class="text-center" colspan="1" rowspan="1">Base kbps</th>
              <th class="text-center" colspan="1" rowspan="1">Overhead kbps</th>
              <th class="text-center" colspan="1" rowspan="1">Overhead %</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">426 x 240</td>
              <td class="text-center" colspan="1" rowspan="1">7.5</td>
              <td class="text-center" colspan="1" rowspan="1">45</td>
              <td class="text-center" colspan="1" rowspan="1">1.3</td>
              <td class="text-center" colspan="1" rowspan="1">2.9%</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">640 x 360</td>
              <td class="text-center" colspan="1" rowspan="1">15</td>
              <td class="text-center" colspan="1" rowspan="1">200</td>
              <td class="text-center" colspan="1" rowspan="1">2.6</td>
              <td class="text-center" colspan="1" rowspan="1">1.3%</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">640 x 360</td>
              <td class="text-center" colspan="1" rowspan="1">30</td>
              <td class="text-center" colspan="1" rowspan="1">400</td>
              <td class="text-center" colspan="1" rowspan="1">5.2</td>
              <td class="text-center" colspan="1" rowspan="1">1.3%</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">1280 x 720</td>
              <td class="text-center" colspan="1" rowspan="1">30</td>
              <td class="text-center" colspan="1" rowspan="1">1500</td>
              <td class="text-center" colspan="1" rowspan="1">5.2</td>
              <td class="text-center" colspan="1" rowspan="1">0.3%</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">1920 x 1080</td>
              <td class="text-center" colspan="1" rowspan="1">60</td>
              <td class="text-center" colspan="1" rowspan="1">7200</td>
              <td class="text-center" colspan="1" rowspan="1">10.3</td>
              <td class="text-center" colspan="1" rowspan="1">0.1%</td>
            </tr>
          </tbody>
        </table>
</div>
<span id="name-sframe-overhead-for-a-video-"></span><div id="video-overhead-per-packet">
<table class="center" id="table-6">
          <caption>
<a class="selfRef" href="#table-6">Table 6</a>:
<a class="selfRef" href="#name-sframe-overhead-for-a-video-">SFrame Overhead for a Video Stream Encrypted per Packet</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Scenario</th>
              <th class="text-center" colspan="1" rowspan="1">fps</th>
              <th class="text-center" colspan="1" rowspan="1">Packets per Second (pps)</th>
              <th class="text-center" colspan="1" rowspan="1">Base kbps</th>
              <th class="text-center" colspan="1" rowspan="1">Overhead kbps</th>
              <th class="text-center" colspan="1" rowspan="1">Overhead %</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">426 x 240</td>
              <td class="text-center" colspan="1" rowspan="1">7.5</td>
              <td class="text-center" colspan="1" rowspan="1">7.5</td>
              <td class="text-center" colspan="1" rowspan="1">45</td>
              <td class="text-center" colspan="1" rowspan="1">1.3</td>
              <td class="text-center" colspan="1" rowspan="1">2.9%</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">640 x 360</td>
              <td class="text-center" colspan="1" rowspan="1">15</td>
              <td class="text-center" colspan="1" rowspan="1">30</td>
              <td class="text-center" colspan="1" rowspan="1">200</td>
              <td class="text-center" colspan="1" rowspan="1">5.2</td>
              <td class="text-center" colspan="1" rowspan="1">2.6%</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">640 x 360</td>
              <td class="text-center" colspan="1" rowspan="1">30</td>
              <td class="text-center" colspan="1" rowspan="1">60</td>
              <td class="text-center" colspan="1" rowspan="1">400</td>
              <td class="text-center" colspan="1" rowspan="1">10.3</td>
              <td class="text-center" colspan="1" rowspan="1">2.6%</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">1280 x 720</td>
              <td class="text-center" colspan="1" rowspan="1">30</td>
              <td class="text-center" colspan="1" rowspan="1">180</td>
              <td class="text-center" colspan="1" rowspan="1">1500</td>
              <td class="text-center" colspan="1" rowspan="1">30.9</td>
              <td class="text-center" colspan="1" rowspan="1">2.1%</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">1920 x 1080</td>
              <td class="text-center" colspan="1" rowspan="1">60</td>
              <td class="text-center" colspan="1" rowspan="1">780</td>
              <td class="text-center" colspan="1" rowspan="1">7200</td>
              <td class="text-center" colspan="1" rowspan="1">134.1</td>
              <td class="text-center" colspan="1" rowspan="1">1.9%</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="appendix-B.3-4">In the per-frame case, the SFrame percentage overhead approaches zero as the
quality of the video improves since bandwidth is driven more by picture size
than frame rate.  In the per-packet case, the SFrame percentage overhead
approaches the ratio between the SFrame overhead per packet and the MTU (here 22
bytes of SFrame overhead divided by an assumed 1200-byte MTU, or about 1.8%).<a class="pilcrow" href="#appendix-B.3-4">Â¶</a></p>
</section>
</div>
<div id="conferences">
<section id="appendix-B.4">
        <h3 id="name-conferences">
<a class="section-number selfRef" href="#appendix-B.4">B.4. </a><a class="section-name selfRef" href="#name-conferences">Conferences</a>
        </h3>
<p id="appendix-B.4-1">Real conferences usually involve several audio and video streams.  The overhead
of SFrame in such a conference is the aggregate of the overhead across all the
individual streams.  Thus, while SFrame incurs a large percentage overhead on an
audio stream, if the conference also involves a video stream, then the audio
overhead is likely negligible relative to the overall bandwidth of the
conference.<a class="pilcrow" href="#appendix-B.4-1">Â¶</a></p>
<p id="appendix-B.4-2">For example, <a class="auto internal xref" href="#conference-overhead">Table 7</a> shows the overhead estimates for a two-person
conference where one person is sending low-quality media and the other is
sending high-quality media.  (And we assume that SFrame is applied per frame.)  The
video streams dominate the bandwidth at the SFU, so the total bandwidth overhead
is only around 1%.<a class="pilcrow" href="#appendix-B.4-2">Â¶</a></p>
<span id="name-sframe-overhead-for-a-two-p"></span><div id="conference-overhead">
<table class="center" id="table-7">
          <caption>
<a class="selfRef" href="#table-7">Table 7</a>:
<a class="selfRef" href="#name-sframe-overhead-for-a-two-p">SFrame Overhead for a Two-Person Conference</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Stream</th>
              <th class="text-center" colspan="1" rowspan="1">Base Kbps</th>
              <th class="text-center" colspan="1" rowspan="1">Overhead Kbps</th>
              <th class="text-center" colspan="1" rowspan="1">Overhead %</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">Participant 1 audio</td>
              <td class="text-center" colspan="1" rowspan="1">8</td>
              <td class="text-center" colspan="1" rowspan="1">1.4</td>
              <td class="text-center" colspan="1" rowspan="1">17.9%</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">Participant 1 video</td>
              <td class="text-center" colspan="1" rowspan="1">45</td>
              <td class="text-center" colspan="1" rowspan="1">1.3</td>
              <td class="text-center" colspan="1" rowspan="1">2.9%</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">Participant 2 audio</td>
              <td class="text-center" colspan="1" rowspan="1">32</td>
              <td class="text-center" colspan="1" rowspan="1">9</td>
              <td class="text-center" colspan="1" rowspan="1">26.9%</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">Participant 2 video</td>
              <td class="text-center" colspan="1" rowspan="1">1500</td>
              <td class="text-center" colspan="1" rowspan="1">5</td>
              <td class="text-center" colspan="1" rowspan="1">0.3%</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">Total at SFU</td>
              <td class="text-center" colspan="1" rowspan="1">1585</td>
              <td class="text-center" colspan="1" rowspan="1">16.5</td>
              <td class="text-center" colspan="1" rowspan="1">1.0%</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="sframe-over-rtp">
<section id="appendix-B.5">
        <h3 id="name-sframe-over-rtp">
<a class="section-number selfRef" href="#appendix-B.5">B.5. </a><a class="section-name selfRef" href="#name-sframe-over-rtp">SFrame over RTP</a>
        </h3>
<p id="appendix-B.5-1">SFrame is a generic encapsulation format, but many of the applications in which
it is likely to be integrated are based on RTP.  This section discusses how an
integration between SFrame and RTP could be done, and some of the challenges
that would need to be overcome.<a class="pilcrow" href="#appendix-B.5-1">Â¶</a></p>
<p id="appendix-B.5-2">As discussed in <a class="auto internal xref" href="#application-context">Section 4.1</a>, there are two natural patterns for
integrating SFrame into an application: applying SFrame per frame or per packet.
In RTP-based applications, applying SFrame per packet means that the payload of
each RTP packet will be an SFrame ciphertext, starting with an SFrame header, as
shown in <a class="auto internal xref" href="#sframe-packet">Figure 11</a>.  Applying SFrame per frame means that different
RTP payloads will have different formats: The first payload of a frame will
contain the SFrame headers, and subsequent payloads will contain further chunks
of the ciphertext, as shown in <a class="auto internal xref" href="#sframe-multi-packet">Figure 12</a>.<a class="pilcrow" href="#appendix-B.5-2">Â¶</a></p>
<p id="appendix-B.5-3">In order for these media payloads to be properly interpreted by receivers,
receivers will need to be configured to know which of the above schemes the
sender has  applied to a given sequence of RTP packets. SFrame does not provide
a mechanism for distributing this configuration information. In applications
that use SDP for negotiating RTP media streams <span>[<a class="cite xref" href="#RFC8866">RFC8866</a>]</span>, an appropriate
extension to SDP could provide this function.<a class="pilcrow" href="#appendix-B.5-3">Â¶</a></p>
<p id="appendix-B.5-4">Applying SFrame per frame also requires that packetization and depacketization
be done in a generic manner that does not depend on the media content of the
packets, since the content being packetized or depacketized will be opaque
ciphertext (except for the SFrame header).  In order for such a generic
packetization scheme to work interoperably, one would have to be defined, e.g.,
as proposed in <span>[<a class="cite xref" href="#I-D.gouaillard-avtcore-codec-agn-rtp-payload">RTP-PAYLOAD</a>]</span>.<a class="pilcrow" href="#appendix-B.5-4">Â¶</a></p>
<span id="name-srtp-packet-with-sframe-pro"></span><div id="sframe-packet">
<figure id="figure-11">
          <div id="appendix-B.5-5.1">
            <div class="alignLeft art-svg artwork" id="appendix-B.5-5.1.1">
<svg class="diagram" font-family="monospace" font-size="13px" height="384" stroke-linecap="round" text-anchor="middle" version="1.1" viewBox="0 0 552 384" width="552" xmlns="http://www.w3.org/2000/svg">
                <path d="M 8,208 L 8,368" fill="none" stroke="black"></path>
                <path d="M 32,32 L 32,336" fill="none" stroke="black"></path>
                <path d="M 64,32 L 64,64" fill="none" stroke="black"></path>
                <path d="M 80,32 L 80,64" fill="none" stroke="black"></path>
                <path d="M 96,32 L 96,64" fill="none" stroke="black"></path>
                <path d="M 160,32 L 160,64" fill="none" stroke="black"></path>
                <path d="M 176,32 L 176,64" fill="none" stroke="black"></path>
                <path d="M 192,208 L 192,240" fill="none" stroke="black"></path>
                <path d="M 272,32 L 272,64" fill="none" stroke="black"></path>
                <path d="M 520,32 L 520,336" fill="none" stroke="black"></path>
                <path d="M 544,32 L 544,368" fill="none" stroke="black"></path>
                <path d="M 32,32 L 544,32" fill="none" stroke="black"></path>
                <path d="M 32,64 L 520,64" fill="none" stroke="black"></path>
                <path d="M 32,96 L 520,96" fill="none" stroke="black"></path>
                <path d="M 32,126 L 520,126" fill="none" stroke="black"></path>
                <path d="M 32,130 L 520,130" fill="none" stroke="black"></path>
                <path d="M 32,176 L 520,176" fill="none" stroke="black"></path>
                <path d="M 8,208 L 520,208" fill="none" stroke="black"></path>
                <path d="M 32,240 L 192,240" fill="none" stroke="black"></path>
                <path d="M 8,304 L 544,304" fill="none" stroke="black"></path>
                <path d="M 32,336 L 520,336" fill="none" stroke="black"></path>
                <path d="M 8,368 L 32,368" fill="none" stroke="black"></path>
                <path d="M 520,368 L 544,368" fill="none" stroke="black"></path>
                <polygon class="arrowhead" fill="black" points="536,304 524,298.4 524,309.6" transform="rotate(180,528,304)"></polygon>
                <polygon class="arrowhead" fill="black" points="536,32 524,26.4 524,37.6" transform="rotate(180,528,32)"></polygon>
                <polygon class="arrowhead" fill="black" points="32,304 20,298.4 20,309.6" transform="rotate(0,24,304)"></polygon>
                <polygon class="arrowhead" fill="black" points="32,208 20,202.4 20,213.6" transform="rotate(0,24,208)"></polygon>
                <g class="text">
                  <text x="48" y="52">V=2</text>
                  <text x="72" y="52">P</text>
                  <text x="88" y="52">X</text>
                  <text x="124" y="52">CC</text>
                  <text x="168" y="52">M</text>
                  <text x="228" y="52">PT</text>
                  <text x="364" y="52">sequence</text>
                  <text x="428" y="52">number</text>
                  <text x="280" y="84">timestamp</text>
                  <text x="176" y="116">synchronization</text>
                  <text x="268" y="116">source</text>
                  <text x="324" y="116">(SSRC)</text>
                  <text x="396" y="116">identifier</text>
                  <text x="172" y="148">contributing</text>
                  <text x="252" y="148">source</text>
                  <text x="308" y="148">(CSRC)</text>
                  <text x="384" y="148">identifiers</text>
                  <text x="292" y="164">....</text>
                  <text x="192" y="196">RTP</text>
                  <text x="260" y="196">extension(s)</text>
                  <text x="356" y="196">(OPTIONAL)</text>
                  <text x="76" y="228">SFrame</text>
                  <text x="132" y="228">header</text>
                  <text x="132" y="276">SFrame</text>
                  <text x="200" y="276">encrypted</text>
                  <text x="256" y="276">and</text>
                  <text x="328" y="276">authenticated</text>
                  <text x="416" y="276">payload</text>
                  <text x="204" y="324">SRTP</text>
                  <text x="284" y="324">authentication</text>
                  <text x="360" y="324">tag</text>
                  <text x="60" y="372">SRTP</text>
                  <text x="120" y="372">Encrypted</text>
                  <text x="192" y="372">Portion</text>
                  <text x="316" y="372">SRTP</text>
                  <text x="392" y="372">Authenticated</text>
                  <text x="480" y="372">Portion</text>
                </g>
              </svg><a class="pilcrow" href="#appendix-B.5-5.1.1">Â¶</a>
</div>
</div>
<figcaption><a class="selfRef" href="#figure-11">Figure 11</a>:
<a class="selfRef" href="#name-srtp-packet-with-sframe-pro">SRTP Packet with SFrame-Protected Payload</a>
          </figcaption></figure>
</div>
<span id="name-encryption-flow-with-per-fr"></span><div id="sframe-multi-packet">
<figure id="figure-12">
          <div id="appendix-B.5-6.1">
            <div class="alignLeft art-svg artwork" id="appendix-B.5-6.1.1">
<svg class="diagram" font-family="monospace" font-size="13px" height="624" stroke-linecap="round" text-anchor="middle" version="1.1" viewBox="0 0 504 624" width="504" xmlns="http://www.w3.org/2000/svg">
                <path d="M 8,192 L 8,224" fill="none" stroke="black"></path>
                <path d="M 8,512 L 8,608" fill="none" stroke="black"></path>
                <path d="M 32,32 L 32,64" fill="none" stroke="black"></path>
                <path d="M 32,232 L 32,504" fill="none" stroke="black"></path>
                <path d="M 72,464 L 72,504" fill="none" stroke="black"></path>
                <path d="M 96,64 L 96,184" fill="none" stroke="black"></path>
                <path d="M 136,512 L 136,608" fill="none" stroke="black"></path>
                <path d="M 168,32 L 168,64" fill="none" stroke="black"></path>
                <path d="M 192,32 L 192,128" fill="none" stroke="black"></path>
                <path d="M 192,288 L 192,400" fill="none" stroke="black"></path>
                <path d="M 192,512 L 192,608" fill="none" stroke="black"></path>
                <path d="M 256,128 L 256,184" fill="none" stroke="black"></path>
                <path d="M 256,232 L 256,280" fill="none" stroke="black"></path>
                <path d="M 256,400 L 256,416" fill="none" stroke="black"></path>
                <path d="M 256,448 L 256,504" fill="none" stroke="black"></path>
                <path d="M 320,32 L 320,128" fill="none" stroke="black"></path>
                <path d="M 320,192 L 320,224" fill="none" stroke="black"></path>
                <path d="M 320,288 L 320,400" fill="none" stroke="black"></path>
                <path d="M 320,512 L 320,608" fill="none" stroke="black"></path>
                <path d="M 368,512 L 368,608" fill="none" stroke="black"></path>
                <path d="M 432,464 L 432,504" fill="none" stroke="black"></path>
                <path d="M 496,512 L 496,608" fill="none" stroke="black"></path>
                <path d="M 32,32 L 168,32" fill="none" stroke="black"></path>
                <path d="M 192,32 L 320,32" fill="none" stroke="black"></path>
                <path d="M 32,64 L 168,64" fill="none" stroke="black"></path>
                <path d="M 192,128 L 320,128" fill="none" stroke="black"></path>
                <path d="M 8,192 L 320,192" fill="none" stroke="black"></path>
                <path d="M 8,224 L 320,224" fill="none" stroke="black"></path>
                <path d="M 192,288 L 320,288" fill="none" stroke="black"></path>
                <path d="M 192,400 L 320,400" fill="none" stroke="black"></path>
                <path d="M 72,464 L 328,464" fill="none" stroke="black"></path>
                <path d="M 360,464 L 432,464" fill="none" stroke="black"></path>
                <path d="M 8,512 L 136,512" fill="none" stroke="black"></path>
                <path d="M 192,512 L 320,512" fill="none" stroke="black"></path>
                <path d="M 368,512 L 496,512" fill="none" stroke="black"></path>
                <path d="M 8,544 L 136,544" fill="none" stroke="black"></path>
                <path d="M 8,608 L 136,608" fill="none" stroke="black"></path>
                <path d="M 192,608 L 320,608" fill="none" stroke="black"></path>
                <path d="M 368,608 L 496,608" fill="none" stroke="black"></path>
                <polygon class="arrowhead" fill="black" points="440,504 428,498.4 428,509.6" transform="rotate(90,432,504)"></polygon>
                <polygon class="arrowhead" fill="black" points="264,504 252,498.4 252,509.6" transform="rotate(90,256,504)"></polygon>
                <polygon class="arrowhead" fill="black" points="264,280 252,274.4 252,285.6" transform="rotate(90,256,280)"></polygon>
                <polygon class="arrowhead" fill="black" points="264,184 252,178.4 252,189.6" transform="rotate(90,256,184)"></polygon>
                <polygon class="arrowhead" fill="black" points="104,184 92,178.4 92,189.6" transform="rotate(90,96,184)"></polygon>
                <polygon class="arrowhead" fill="black" points="80,504 68,498.4 68,509.6" transform="rotate(90,72,504)"></polygon>
                <polygon class="arrowhead" fill="black" points="40,504 28,498.4 28,509.6" transform="rotate(90,32,504)"></polygon>
                <g class="text">
                  <text x="64" y="52">frame</text>
                  <text x="124" y="52">metadata</text>
                  <text x="256" y="84">frame</text>
                  <text x="132" y="212">SFrame</text>
                  <text x="192" y="212">Encrypt</text>
                  <text x="256" y="340">encrypted</text>
                  <text x="256" y="356">frame</text>
                  <text x="208" y="436">generic</text>
                  <text x="256" y="436">RTP</text>
                  <text x="312" y="436">packetize</text>
                  <text x="344" y="468">...</text>
                  <text x="44" y="532">SFrame</text>
                  <text x="100" y="532">header</text>
                  <text x="240" y="564">payload</text>
                  <text x="288" y="564">2/N</text>
                  <text x="344" y="564">...</text>
                  <text x="416" y="564">payload</text>
                  <text x="464" y="564">N/N</text>
                  <text x="56" y="580">payload</text>
                  <text x="104" y="580">1/N</text>
                </g>
              </svg><a class="pilcrow" href="#appendix-B.5-6.1.1">Â¶</a>
</div>
</div>
<figcaption><a class="selfRef" href="#figure-12">Figure 12</a>:
<a class="selfRef" href="#name-encryption-flow-with-per-fr">Encryption Flow with per-Frame Encryption for RTP</a>
          </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="test-vectors">
<section id="appendix-C">
      <h2 id="name-test-vectors">
<a class="section-number selfRef" href="#appendix-C">Appendix C. </a><a class="section-name selfRef" href="#name-test-vectors">Test Vectors</a>
      </h2>
<p id="appendix-C-1">This section provides a set of test vectors that implementations can use to
verify that they correctly implement SFrame encryption and decryption.  In
addition to test vectors for the overall process of SFrame
encryption/decryption, we also provide test vectors for header
encoding/decoding, and for AEAD encryption/decryption using the AES-CTR
construction defined in <a class="auto internal xref" href="#aes-ctr-with-sha2">Section 4.5.1</a>.<a class="pilcrow" href="#appendix-C-1">Â¶</a></p>
<p id="appendix-C-2">All values are either numeric or byte strings.  Numeric values are represented
as hex values, prefixed with <code>0x</code>.  Byte strings are represented in hex
encoding.<a class="pilcrow" href="#appendix-C-2">Â¶</a></p>
<p id="appendix-C-3">Line breaks and whitespace within values are inserted to conform to the width
requirements of the RFC format.  They should be removed before use.<a class="pilcrow" href="#appendix-C-3">Â¶</a></p>
<p id="appendix-C-4">These test vectors are also available in JSON format at <span>[<a class="cite xref" href="#TestVectors">TestVectors</a>]</span>.  In the
JSON test vectors, numeric values are JSON numbers and byte string values are
JSON strings containing the hex encoding of the byte strings.<a class="pilcrow" href="#appendix-C-4">Â¶</a></p>
<div id="header-encodingdecoding">
<section id="appendix-C.1">
        <h3 id="name-header-encoding-decoding">
<a class="section-number selfRef" href="#appendix-C.1">C.1. </a><a class="section-name selfRef" href="#name-header-encoding-decoding">Header Encoding/Decoding</a>
        </h3>
<p id="appendix-C.1-1">For each case, we provide:<a class="pilcrow" href="#appendix-C.1-1">Â¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C.1-2.1">
            <p id="appendix-C.1-2.1.1"><code>kid</code>: A KID value<a class="pilcrow" href="#appendix-C.1-2.1.1">Â¶</a></p>
</li>
          <li class="normal" id="appendix-C.1-2.2">
            <p id="appendix-C.1-2.2.1"><code>ctr</code>: A CTR value<a class="pilcrow" href="#appendix-C.1-2.2.1">Â¶</a></p>
</li>
          <li class="normal" id="appendix-C.1-2.3">
            <p id="appendix-C.1-2.3.1"><code>header</code>: An encoded SFrame header<a class="pilcrow" href="#appendix-C.1-2.3.1">Â¶</a></p>
</li>
        </ul>
<p id="appendix-C.1-3">An implementation should verify that:<a class="pilcrow" href="#appendix-C.1-3">Â¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C.1-4.1">
            <p id="appendix-C.1-4.1.1">Encoding a header with the KID and CTR results in the provided header value<a class="pilcrow" href="#appendix-C.1-4.1.1">Â¶</a></p>
</li>
          <li class="normal" id="appendix-C.1-4.2">
            <p id="appendix-C.1-4.2.1">Decoding the provided header value results in the provided KID and CTR values<a class="pilcrow" href="#appendix-C.1-4.2.1">Â¶</a></p>
</li>
        </ul>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-5">
<pre>kid: 0x0000000000000000
ctr: 0x0000000000000000
header: 00
</pre><a class="pilcrow" href="#appendix-C.1-5">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-6">
<pre>kid: 0x0000000000000000
ctr: 0x0000000000000001
header: 01
</pre><a class="pilcrow" href="#appendix-C.1-6">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-7">
<pre>kid: 0x0000000000000000
ctr: 0x00000000000000ff
header: 08ff
</pre><a class="pilcrow" href="#appendix-C.1-7">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-8">
<pre>kid: 0x0000000000000000
ctr: 0x0000000000000100
header: 090100
</pre><a class="pilcrow" href="#appendix-C.1-8">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-9">
<pre>kid: 0x0000000000000000
ctr: 0x000000000000ffff
header: 09ffff
</pre><a class="pilcrow" href="#appendix-C.1-9">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-10">
<pre>kid: 0x0000000000000000
ctr: 0x0000000000010000
header: 0a010000
</pre><a class="pilcrow" href="#appendix-C.1-10">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-11">
<pre>kid: 0x0000000000000000
ctr: 0x0000000000ffffff
header: 0affffff
</pre><a class="pilcrow" href="#appendix-C.1-11">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-12">
<pre>kid: 0x0000000000000000
ctr: 0x0000000001000000
header: 0b01000000
</pre><a class="pilcrow" href="#appendix-C.1-12">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-13">
<pre>kid: 0x0000000000000000
ctr: 0x00000000ffffffff
header: 0bffffffff
</pre><a class="pilcrow" href="#appendix-C.1-13">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-14">
<pre>kid: 0x0000000000000000
ctr: 0x0000000100000000
header: 0c0100000000
</pre><a class="pilcrow" href="#appendix-C.1-14">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-15">
<pre>kid: 0x0000000000000000
ctr: 0x000000ffffffffff
header: 0cffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-15">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-16">
<pre>kid: 0x0000000000000000
ctr: 0x0000010000000000
header: 0d010000000000
</pre><a class="pilcrow" href="#appendix-C.1-16">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-17">
<pre>kid: 0x0000000000000000
ctr: 0x0000ffffffffffff
header: 0dffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-17">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-18">
<pre>kid: 0x0000000000000000
ctr: 0x0001000000000000
header: 0e01000000000000
</pre><a class="pilcrow" href="#appendix-C.1-18">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-19">
<pre>kid: 0x0000000000000000
ctr: 0x00ffffffffffffff
header: 0effffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-19">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-20">
<pre>kid: 0x0000000000000000
ctr: 0x0100000000000000
header: 0f0100000000000000
</pre><a class="pilcrow" href="#appendix-C.1-20">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-21">
<pre>kid: 0x0000000000000000
ctr: 0xffffffffffffffff
header: 0fffffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-21">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-22">
<pre>kid: 0x0000000000000001
ctr: 0x0000000000000000
header: 10
</pre><a class="pilcrow" href="#appendix-C.1-22">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-23">
<pre>kid: 0x0000000000000001
ctr: 0x0000000000000001
header: 11
</pre><a class="pilcrow" href="#appendix-C.1-23">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-24">
<pre>kid: 0x0000000000000001
ctr: 0x00000000000000ff
header: 18ff
</pre><a class="pilcrow" href="#appendix-C.1-24">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-25">
<pre>kid: 0x0000000000000001
ctr: 0x0000000000000100
header: 190100
</pre><a class="pilcrow" href="#appendix-C.1-25">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-26">
<pre>kid: 0x0000000000000001
ctr: 0x000000000000ffff
header: 19ffff
</pre><a class="pilcrow" href="#appendix-C.1-26">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-27">
<pre>kid: 0x0000000000000001
ctr: 0x0000000000010000
header: 1a010000
</pre><a class="pilcrow" href="#appendix-C.1-27">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-28">
<pre>kid: 0x0000000000000001
ctr: 0x0000000000ffffff
header: 1affffff
</pre><a class="pilcrow" href="#appendix-C.1-28">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-29">
<pre>kid: 0x0000000000000001
ctr: 0x0000000001000000
header: 1b01000000
</pre><a class="pilcrow" href="#appendix-C.1-29">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-30">
<pre>kid: 0x0000000000000001
ctr: 0x00000000ffffffff
header: 1bffffffff
</pre><a class="pilcrow" href="#appendix-C.1-30">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-31">
<pre>kid: 0x0000000000000001
ctr: 0x0000000100000000
header: 1c0100000000
</pre><a class="pilcrow" href="#appendix-C.1-31">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-32">
<pre>kid: 0x0000000000000001
ctr: 0x000000ffffffffff
header: 1cffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-32">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-33">
<pre>kid: 0x0000000000000001
ctr: 0x0000010000000000
header: 1d010000000000
</pre><a class="pilcrow" href="#appendix-C.1-33">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-34">
<pre>kid: 0x0000000000000001
ctr: 0x0000ffffffffffff
header: 1dffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-34">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-35">
<pre>kid: 0x0000000000000001
ctr: 0x0001000000000000
header: 1e01000000000000
</pre><a class="pilcrow" href="#appendix-C.1-35">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-36">
<pre>kid: 0x0000000000000001
ctr: 0x00ffffffffffffff
header: 1effffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-36">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-37">
<pre>kid: 0x0000000000000001
ctr: 0x0100000000000000
header: 1f0100000000000000
</pre><a class="pilcrow" href="#appendix-C.1-37">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-38">
<pre>kid: 0x0000000000000001
ctr: 0xffffffffffffffff
header: 1fffffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-38">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-39">
<pre>kid: 0x00000000000000ff
ctr: 0x0000000000000000
header: 80ff
</pre><a class="pilcrow" href="#appendix-C.1-39">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-40">
<pre>kid: 0x00000000000000ff
ctr: 0x0000000000000001
header: 81ff
</pre><a class="pilcrow" href="#appendix-C.1-40">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-41">
<pre>kid: 0x00000000000000ff
ctr: 0x00000000000000ff
header: 88ffff
</pre><a class="pilcrow" href="#appendix-C.1-41">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-42">
<pre>kid: 0x00000000000000ff
ctr: 0x0000000000000100
header: 89ff0100
</pre><a class="pilcrow" href="#appendix-C.1-42">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-43">
<pre>kid: 0x00000000000000ff
ctr: 0x000000000000ffff
header: 89ffffff
</pre><a class="pilcrow" href="#appendix-C.1-43">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-44">
<pre>kid: 0x00000000000000ff
ctr: 0x0000000000010000
header: 8aff010000
</pre><a class="pilcrow" href="#appendix-C.1-44">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-45">
<pre>kid: 0x00000000000000ff
ctr: 0x0000000000ffffff
header: 8affffffff
</pre><a class="pilcrow" href="#appendix-C.1-45">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-46">
<pre>kid: 0x00000000000000ff
ctr: 0x0000000001000000
header: 8bff01000000
</pre><a class="pilcrow" href="#appendix-C.1-46">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-47">
<pre>kid: 0x00000000000000ff
ctr: 0x00000000ffffffff
header: 8bffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-47">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-48">
<pre>kid: 0x00000000000000ff
ctr: 0x0000000100000000
header: 8cff0100000000
</pre><a class="pilcrow" href="#appendix-C.1-48">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-49">
<pre>kid: 0x00000000000000ff
ctr: 0x000000ffffffffff
header: 8cffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-49">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-50">
<pre>kid: 0x00000000000000ff
ctr: 0x0000010000000000
header: 8dff010000000000
</pre><a class="pilcrow" href="#appendix-C.1-50">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-51">
<pre>kid: 0x00000000000000ff
ctr: 0x0000ffffffffffff
header: 8dffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-51">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-52">
<pre>kid: 0x00000000000000ff
ctr: 0x0001000000000000
header: 8eff01000000000000
</pre><a class="pilcrow" href="#appendix-C.1-52">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-53">
<pre>kid: 0x00000000000000ff
ctr: 0x00ffffffffffffff
header: 8effffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-53">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-54">
<pre>kid: 0x00000000000000ff
ctr: 0x0100000000000000
header: 8fff0100000000000000
</pre><a class="pilcrow" href="#appendix-C.1-54">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-55">
<pre>kid: 0x00000000000000ff
ctr: 0xffffffffffffffff
header: 8fffffffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-55">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-56">
<pre>kid: 0x0000000000000100
ctr: 0x0000000000000000
header: 900100
</pre><a class="pilcrow" href="#appendix-C.1-56">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-57">
<pre>kid: 0x0000000000000100
ctr: 0x0000000000000001
header: 910100
</pre><a class="pilcrow" href="#appendix-C.1-57">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-58">
<pre>kid: 0x0000000000000100
ctr: 0x00000000000000ff
header: 980100ff
</pre><a class="pilcrow" href="#appendix-C.1-58">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-59">
<pre>kid: 0x0000000000000100
ctr: 0x0000000000000100
header: 9901000100
</pre><a class="pilcrow" href="#appendix-C.1-59">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-60">
<pre>kid: 0x0000000000000100
ctr: 0x000000000000ffff
header: 990100ffff
</pre><a class="pilcrow" href="#appendix-C.1-60">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-61">
<pre>kid: 0x0000000000000100
ctr: 0x0000000000010000
header: 9a0100010000
</pre><a class="pilcrow" href="#appendix-C.1-61">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-62">
<pre>kid: 0x0000000000000100
ctr: 0x0000000000ffffff
header: 9a0100ffffff
</pre><a class="pilcrow" href="#appendix-C.1-62">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-63">
<pre>kid: 0x0000000000000100
ctr: 0x0000000001000000
header: 9b010001000000
</pre><a class="pilcrow" href="#appendix-C.1-63">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-64">
<pre>kid: 0x0000000000000100
ctr: 0x00000000ffffffff
header: 9b0100ffffffff
</pre><a class="pilcrow" href="#appendix-C.1-64">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-65">
<pre>kid: 0x0000000000000100
ctr: 0x0000000100000000
header: 9c01000100000000
</pre><a class="pilcrow" href="#appendix-C.1-65">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-66">
<pre>kid: 0x0000000000000100
ctr: 0x000000ffffffffff
header: 9c0100ffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-66">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-67">
<pre>kid: 0x0000000000000100
ctr: 0x0000010000000000
header: 9d0100010000000000
</pre><a class="pilcrow" href="#appendix-C.1-67">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-68">
<pre>kid: 0x0000000000000100
ctr: 0x0000ffffffffffff
header: 9d0100ffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-68">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-69">
<pre>kid: 0x0000000000000100
ctr: 0x0001000000000000
header: 9e010001000000000000
</pre><a class="pilcrow" href="#appendix-C.1-69">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-70">
<pre>kid: 0x0000000000000100
ctr: 0x00ffffffffffffff
header: 9e0100ffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-70">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-71">
<pre>kid: 0x0000000000000100
ctr: 0x0100000000000000
header: 9f01000100000000000000
</pre><a class="pilcrow" href="#appendix-C.1-71">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-72">
<pre>kid: 0x0000000000000100
ctr: 0xffffffffffffffff
header: 9f0100ffffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-72">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-73">
<pre>kid: 0x000000000000ffff
ctr: 0x0000000000000000
header: 90ffff
</pre><a class="pilcrow" href="#appendix-C.1-73">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-74">
<pre>kid: 0x000000000000ffff
ctr: 0x0000000000000001
header: 91ffff
</pre><a class="pilcrow" href="#appendix-C.1-74">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-75">
<pre>kid: 0x000000000000ffff
ctr: 0x00000000000000ff
header: 98ffffff
</pre><a class="pilcrow" href="#appendix-C.1-75">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-76">
<pre>kid: 0x000000000000ffff
ctr: 0x0000000000000100
header: 99ffff0100
</pre><a class="pilcrow" href="#appendix-C.1-76">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-77">
<pre>kid: 0x000000000000ffff
ctr: 0x000000000000ffff
header: 99ffffffff
</pre><a class="pilcrow" href="#appendix-C.1-77">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-78">
<pre>kid: 0x000000000000ffff
ctr: 0x0000000000010000
header: 9affff010000
</pre><a class="pilcrow" href="#appendix-C.1-78">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-79">
<pre>kid: 0x000000000000ffff
ctr: 0x0000000000ffffff
header: 9affffffffff
</pre><a class="pilcrow" href="#appendix-C.1-79">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-80">
<pre>kid: 0x000000000000ffff
ctr: 0x0000000001000000
header: 9bffff01000000
</pre><a class="pilcrow" href="#appendix-C.1-80">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-81">
<pre>kid: 0x000000000000ffff
ctr: 0x00000000ffffffff
header: 9bffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-81">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-82">
<pre>kid: 0x000000000000ffff
ctr: 0x0000000100000000
header: 9cffff0100000000
</pre><a class="pilcrow" href="#appendix-C.1-82">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-83">
<pre>kid: 0x000000000000ffff
ctr: 0x000000ffffffffff
header: 9cffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-83">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-84">
<pre>kid: 0x000000000000ffff
ctr: 0x0000010000000000
header: 9dffff010000000000
</pre><a class="pilcrow" href="#appendix-C.1-84">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-85">
<pre>kid: 0x000000000000ffff
ctr: 0x0000ffffffffffff
header: 9dffffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-85">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-86">
<pre>kid: 0x000000000000ffff
ctr: 0x0001000000000000
header: 9effff01000000000000
</pre><a class="pilcrow" href="#appendix-C.1-86">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-87">
<pre>kid: 0x000000000000ffff
ctr: 0x00ffffffffffffff
header: 9effffffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-87">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-88">
<pre>kid: 0x000000000000ffff
ctr: 0x0100000000000000
header: 9fffff0100000000000000
</pre><a class="pilcrow" href="#appendix-C.1-88">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-89">
<pre>kid: 0x000000000000ffff
ctr: 0xffffffffffffffff
header: 9fffffffffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-89">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-90">
<pre>kid: 0x0000000000010000
ctr: 0x0000000000000000
header: a0010000
</pre><a class="pilcrow" href="#appendix-C.1-90">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-91">
<pre>kid: 0x0000000000010000
ctr: 0x0000000000000001
header: a1010000
</pre><a class="pilcrow" href="#appendix-C.1-91">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-92">
<pre>kid: 0x0000000000010000
ctr: 0x00000000000000ff
header: a8010000ff
</pre><a class="pilcrow" href="#appendix-C.1-92">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-93">
<pre>kid: 0x0000000000010000
ctr: 0x0000000000000100
header: a90100000100
</pre><a class="pilcrow" href="#appendix-C.1-93">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-94">
<pre>kid: 0x0000000000010000
ctr: 0x000000000000ffff
header: a9010000ffff
</pre><a class="pilcrow" href="#appendix-C.1-94">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-95">
<pre>kid: 0x0000000000010000
ctr: 0x0000000000010000
header: aa010000010000
</pre><a class="pilcrow" href="#appendix-C.1-95">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-96">
<pre>kid: 0x0000000000010000
ctr: 0x0000000000ffffff
header: aa010000ffffff
</pre><a class="pilcrow" href="#appendix-C.1-96">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-97">
<pre>kid: 0x0000000000010000
ctr: 0x0000000001000000
header: ab01000001000000
</pre><a class="pilcrow" href="#appendix-C.1-97">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-98">
<pre>kid: 0x0000000000010000
ctr: 0x00000000ffffffff
header: ab010000ffffffff
</pre><a class="pilcrow" href="#appendix-C.1-98">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-99">
<pre>kid: 0x0000000000010000
ctr: 0x0000000100000000
header: ac0100000100000000
</pre><a class="pilcrow" href="#appendix-C.1-99">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-100">
<pre>kid: 0x0000000000010000
ctr: 0x000000ffffffffff
header: ac010000ffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-100">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-101">
<pre>kid: 0x0000000000010000
ctr: 0x0000010000000000
header: ad010000010000000000
</pre><a class="pilcrow" href="#appendix-C.1-101">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-102">
<pre>kid: 0x0000000000010000
ctr: 0x0000ffffffffffff
header: ad010000ffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-102">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-103">
<pre>kid: 0x0000000000010000
ctr: 0x0001000000000000
header: ae01000001000000000000
</pre><a class="pilcrow" href="#appendix-C.1-103">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-104">
<pre>kid: 0x0000000000010000
ctr: 0x00ffffffffffffff
header: ae010000ffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-104">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-105">
<pre>kid: 0x0000000000010000
ctr: 0x0100000000000000
header: af0100000100000000000000
</pre><a class="pilcrow" href="#appendix-C.1-105">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-106">
<pre>kid: 0x0000000000010000
ctr: 0xffffffffffffffff
header: af010000ffffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-106">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-107">
<pre>kid: 0x0000000000ffffff
ctr: 0x0000000000000000
header: a0ffffff
</pre><a class="pilcrow" href="#appendix-C.1-107">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-108">
<pre>kid: 0x0000000000ffffff
ctr: 0x0000000000000001
header: a1ffffff
</pre><a class="pilcrow" href="#appendix-C.1-108">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-109">
<pre>kid: 0x0000000000ffffff
ctr: 0x00000000000000ff
header: a8ffffffff
</pre><a class="pilcrow" href="#appendix-C.1-109">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-110">
<pre>kid: 0x0000000000ffffff
ctr: 0x0000000000000100
header: a9ffffff0100
</pre><a class="pilcrow" href="#appendix-C.1-110">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-111">
<pre>kid: 0x0000000000ffffff
ctr: 0x000000000000ffff
header: a9ffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-111">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-112">
<pre>kid: 0x0000000000ffffff
ctr: 0x0000000000010000
header: aaffffff010000
</pre><a class="pilcrow" href="#appendix-C.1-112">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-113">
<pre>kid: 0x0000000000ffffff
ctr: 0x0000000000ffffff
header: aaffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-113">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-114">
<pre>kid: 0x0000000000ffffff
ctr: 0x0000000001000000
header: abffffff01000000
</pre><a class="pilcrow" href="#appendix-C.1-114">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-115">
<pre>kid: 0x0000000000ffffff
ctr: 0x00000000ffffffff
header: abffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-115">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-116">
<pre>kid: 0x0000000000ffffff
ctr: 0x0000000100000000
header: acffffff0100000000
</pre><a class="pilcrow" href="#appendix-C.1-116">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-117">
<pre>kid: 0x0000000000ffffff
ctr: 0x000000ffffffffff
header: acffffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-117">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-118">
<pre>kid: 0x0000000000ffffff
ctr: 0x0000010000000000
header: adffffff010000000000
</pre><a class="pilcrow" href="#appendix-C.1-118">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-119">
<pre>kid: 0x0000000000ffffff
ctr: 0x0000ffffffffffff
header: adffffffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-119">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-120">
<pre>kid: 0x0000000000ffffff
ctr: 0x0001000000000000
header: aeffffff01000000000000
</pre><a class="pilcrow" href="#appendix-C.1-120">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-121">
<pre>kid: 0x0000000000ffffff
ctr: 0x00ffffffffffffff
header: aeffffffffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-121">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-122">
<pre>kid: 0x0000000000ffffff
ctr: 0x0100000000000000
header: afffffff0100000000000000
</pre><a class="pilcrow" href="#appendix-C.1-122">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-123">
<pre>kid: 0x0000000000ffffff
ctr: 0xffffffffffffffff
header: afffffffffffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-123">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-124">
<pre>kid: 0x0000000001000000
ctr: 0x0000000000000000
header: b001000000
</pre><a class="pilcrow" href="#appendix-C.1-124">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-125">
<pre>kid: 0x0000000001000000
ctr: 0x0000000000000001
header: b101000000
</pre><a class="pilcrow" href="#appendix-C.1-125">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-126">
<pre>kid: 0x0000000001000000
ctr: 0x00000000000000ff
header: b801000000ff
</pre><a class="pilcrow" href="#appendix-C.1-126">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-127">
<pre>kid: 0x0000000001000000
ctr: 0x0000000000000100
header: b9010000000100
</pre><a class="pilcrow" href="#appendix-C.1-127">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-128">
<pre>kid: 0x0000000001000000
ctr: 0x000000000000ffff
header: b901000000ffff
</pre><a class="pilcrow" href="#appendix-C.1-128">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-129">
<pre>kid: 0x0000000001000000
ctr: 0x0000000000010000
header: ba01000000010000
</pre><a class="pilcrow" href="#appendix-C.1-129">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-130">
<pre>kid: 0x0000000001000000
ctr: 0x0000000000ffffff
header: ba01000000ffffff
</pre><a class="pilcrow" href="#appendix-C.1-130">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-131">
<pre>kid: 0x0000000001000000
ctr: 0x0000000001000000
header: bb0100000001000000
</pre><a class="pilcrow" href="#appendix-C.1-131">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-132">
<pre>kid: 0x0000000001000000
ctr: 0x00000000ffffffff
header: bb01000000ffffffff
</pre><a class="pilcrow" href="#appendix-C.1-132">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-133">
<pre>kid: 0x0000000001000000
ctr: 0x0000000100000000
header: bc010000000100000000
</pre><a class="pilcrow" href="#appendix-C.1-133">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-134">
<pre>kid: 0x0000000001000000
ctr: 0x000000ffffffffff
header: bc01000000ffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-134">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-135">
<pre>kid: 0x0000000001000000
ctr: 0x0000010000000000
header: bd01000000010000000000
</pre><a class="pilcrow" href="#appendix-C.1-135">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-136">
<pre>kid: 0x0000000001000000
ctr: 0x0000ffffffffffff
header: bd01000000ffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-136">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-137">
<pre>kid: 0x0000000001000000
ctr: 0x0001000000000000
header: be0100000001000000000000
</pre><a class="pilcrow" href="#appendix-C.1-137">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-138">
<pre>kid: 0x0000000001000000
ctr: 0x00ffffffffffffff
header: be01000000ffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-138">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-139">
<pre>kid: 0x0000000001000000
ctr: 0x0100000000000000
header: bf010000000100000000000000
</pre><a class="pilcrow" href="#appendix-C.1-139">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-140">
<pre>kid: 0x0000000001000000
ctr: 0xffffffffffffffff
header: bf01000000ffffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-140">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-141">
<pre>kid: 0x00000000ffffffff
ctr: 0x0000000000000000
header: b0ffffffff
</pre><a class="pilcrow" href="#appendix-C.1-141">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-142">
<pre>kid: 0x00000000ffffffff
ctr: 0x0000000000000001
header: b1ffffffff
</pre><a class="pilcrow" href="#appendix-C.1-142">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-143">
<pre>kid: 0x00000000ffffffff
ctr: 0x00000000000000ff
header: b8ffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-143">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-144">
<pre>kid: 0x00000000ffffffff
ctr: 0x0000000000000100
header: b9ffffffff0100
</pre><a class="pilcrow" href="#appendix-C.1-144">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-145">
<pre>kid: 0x00000000ffffffff
ctr: 0x000000000000ffff
header: b9ffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-145">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-146">
<pre>kid: 0x00000000ffffffff
ctr: 0x0000000000010000
header: baffffffff010000
</pre><a class="pilcrow" href="#appendix-C.1-146">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-147">
<pre>kid: 0x00000000ffffffff
ctr: 0x0000000000ffffff
header: baffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-147">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-148">
<pre>kid: 0x00000000ffffffff
ctr: 0x0000000001000000
header: bbffffffff01000000
</pre><a class="pilcrow" href="#appendix-C.1-148">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-149">
<pre>kid: 0x00000000ffffffff
ctr: 0x00000000ffffffff
header: bbffffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-149">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-150">
<pre>kid: 0x00000000ffffffff
ctr: 0x0000000100000000
header: bcffffffff0100000000
</pre><a class="pilcrow" href="#appendix-C.1-150">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-151">
<pre>kid: 0x00000000ffffffff
ctr: 0x000000ffffffffff
header: bcffffffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-151">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-152">
<pre>kid: 0x00000000ffffffff
ctr: 0x0000010000000000
header: bdffffffff010000000000
</pre><a class="pilcrow" href="#appendix-C.1-152">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-153">
<pre>kid: 0x00000000ffffffff
ctr: 0x0000ffffffffffff
header: bdffffffffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-153">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-154">
<pre>kid: 0x00000000ffffffff
ctr: 0x0001000000000000
header: beffffffff01000000000000
</pre><a class="pilcrow" href="#appendix-C.1-154">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-155">
<pre>kid: 0x00000000ffffffff
ctr: 0x00ffffffffffffff
header: beffffffffffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-155">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-156">
<pre>kid: 0x00000000ffffffff
ctr: 0x0100000000000000
header: bfffffffff0100000000000000
</pre><a class="pilcrow" href="#appendix-C.1-156">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-157">
<pre>kid: 0x00000000ffffffff
ctr: 0xffffffffffffffff
header: bfffffffffffffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-157">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-158">
<pre>kid: 0x0000000100000000
ctr: 0x0000000000000000
header: c00100000000
</pre><a class="pilcrow" href="#appendix-C.1-158">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-159">
<pre>kid: 0x0000000100000000
ctr: 0x0000000000000001
header: c10100000000
</pre><a class="pilcrow" href="#appendix-C.1-159">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-160">
<pre>kid: 0x0000000100000000
ctr: 0x00000000000000ff
header: c80100000000ff
</pre><a class="pilcrow" href="#appendix-C.1-160">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-161">
<pre>kid: 0x0000000100000000
ctr: 0x0000000000000100
header: c901000000000100
</pre><a class="pilcrow" href="#appendix-C.1-161">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-162">
<pre>kid: 0x0000000100000000
ctr: 0x000000000000ffff
header: c90100000000ffff
</pre><a class="pilcrow" href="#appendix-C.1-162">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-163">
<pre>kid: 0x0000000100000000
ctr: 0x0000000000010000
header: ca0100000000010000
</pre><a class="pilcrow" href="#appendix-C.1-163">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-164">
<pre>kid: 0x0000000100000000
ctr: 0x0000000000ffffff
header: ca0100000000ffffff
</pre><a class="pilcrow" href="#appendix-C.1-164">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-165">
<pre>kid: 0x0000000100000000
ctr: 0x0000000001000000
header: cb010000000001000000
</pre><a class="pilcrow" href="#appendix-C.1-165">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-166">
<pre>kid: 0x0000000100000000
ctr: 0x00000000ffffffff
header: cb0100000000ffffffff
</pre><a class="pilcrow" href="#appendix-C.1-166">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-167">
<pre>kid: 0x0000000100000000
ctr: 0x0000000100000000
header: cc01000000000100000000
</pre><a class="pilcrow" href="#appendix-C.1-167">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-168">
<pre>kid: 0x0000000100000000
ctr: 0x000000ffffffffff
header: cc0100000000ffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-168">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-169">
<pre>kid: 0x0000000100000000
ctr: 0x0000010000000000
header: cd0100000000010000000000
</pre><a class="pilcrow" href="#appendix-C.1-169">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-170">
<pre>kid: 0x0000000100000000
ctr: 0x0000ffffffffffff
header: cd0100000000ffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-170">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-171">
<pre>kid: 0x0000000100000000
ctr: 0x0001000000000000
header: ce010000000001000000000000
</pre><a class="pilcrow" href="#appendix-C.1-171">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-172">
<pre>kid: 0x0000000100000000
ctr: 0x00ffffffffffffff
header: ce0100000000ffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-172">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-173">
<pre>kid: 0x0000000100000000
ctr: 0x0100000000000000
header: cf01000000000100000000000000
</pre><a class="pilcrow" href="#appendix-C.1-173">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-174">
<pre>kid: 0x0000000100000000
ctr: 0xffffffffffffffff
header: cf0100000000ffffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-174">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-175">
<pre>kid: 0x000000ffffffffff
ctr: 0x0000000000000000
header: c0ffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-175">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-176">
<pre>kid: 0x000000ffffffffff
ctr: 0x0000000000000001
header: c1ffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-176">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-177">
<pre>kid: 0x000000ffffffffff
ctr: 0x00000000000000ff
header: c8ffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-177">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-178">
<pre>kid: 0x000000ffffffffff
ctr: 0x0000000000000100
header: c9ffffffffff0100
</pre><a class="pilcrow" href="#appendix-C.1-178">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-179">
<pre>kid: 0x000000ffffffffff
ctr: 0x000000000000ffff
header: c9ffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-179">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-180">
<pre>kid: 0x000000ffffffffff
ctr: 0x0000000000010000
header: caffffffffff010000
</pre><a class="pilcrow" href="#appendix-C.1-180">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-181">
<pre>kid: 0x000000ffffffffff
ctr: 0x0000000000ffffff
header: caffffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-181">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-182">
<pre>kid: 0x000000ffffffffff
ctr: 0x0000000001000000
header: cbffffffffff01000000
</pre><a class="pilcrow" href="#appendix-C.1-182">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-183">
<pre>kid: 0x000000ffffffffff
ctr: 0x00000000ffffffff
header: cbffffffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-183">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-184">
<pre>kid: 0x000000ffffffffff
ctr: 0x0000000100000000
header: ccffffffffff0100000000
</pre><a class="pilcrow" href="#appendix-C.1-184">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-185">
<pre>kid: 0x000000ffffffffff
ctr: 0x000000ffffffffff
header: ccffffffffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-185">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-186">
<pre>kid: 0x000000ffffffffff
ctr: 0x0000010000000000
header: cdffffffffff010000000000
</pre><a class="pilcrow" href="#appendix-C.1-186">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-187">
<pre>kid: 0x000000ffffffffff
ctr: 0x0000ffffffffffff
header: cdffffffffffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-187">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-188">
<pre>kid: 0x000000ffffffffff
ctr: 0x0001000000000000
header: ceffffffffff01000000000000
</pre><a class="pilcrow" href="#appendix-C.1-188">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-189">
<pre>kid: 0x000000ffffffffff
ctr: 0x00ffffffffffffff
header: ceffffffffffffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-189">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-190">
<pre>kid: 0x000000ffffffffff
ctr: 0x0100000000000000
header: cfffffffffff0100000000000000
</pre><a class="pilcrow" href="#appendix-C.1-190">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-191">
<pre>kid: 0x000000ffffffffff
ctr: 0xffffffffffffffff
header: cfffffffffffffffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-191">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-192">
<pre>kid: 0x0000010000000000
ctr: 0x0000000000000000
header: d0010000000000
</pre><a class="pilcrow" href="#appendix-C.1-192">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-193">
<pre>kid: 0x0000010000000000
ctr: 0x0000000000000001
header: d1010000000000
</pre><a class="pilcrow" href="#appendix-C.1-193">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-194">
<pre>kid: 0x0000010000000000
ctr: 0x00000000000000ff
header: d8010000000000ff
</pre><a class="pilcrow" href="#appendix-C.1-194">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-195">
<pre>kid: 0x0000010000000000
ctr: 0x0000000000000100
header: d90100000000000100
</pre><a class="pilcrow" href="#appendix-C.1-195">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-196">
<pre>kid: 0x0000010000000000
ctr: 0x000000000000ffff
header: d9010000000000ffff
</pre><a class="pilcrow" href="#appendix-C.1-196">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-197">
<pre>kid: 0x0000010000000000
ctr: 0x0000000000010000
header: da010000000000010000
</pre><a class="pilcrow" href="#appendix-C.1-197">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-198">
<pre>kid: 0x0000010000000000
ctr: 0x0000000000ffffff
header: da010000000000ffffff
</pre><a class="pilcrow" href="#appendix-C.1-198">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-199">
<pre>kid: 0x0000010000000000
ctr: 0x0000000001000000
header: db01000000000001000000
</pre><a class="pilcrow" href="#appendix-C.1-199">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-200">
<pre>kid: 0x0000010000000000
ctr: 0x00000000ffffffff
header: db010000000000ffffffff
</pre><a class="pilcrow" href="#appendix-C.1-200">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-201">
<pre>kid: 0x0000010000000000
ctr: 0x0000000100000000
header: dc0100000000000100000000
</pre><a class="pilcrow" href="#appendix-C.1-201">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-202">
<pre>kid: 0x0000010000000000
ctr: 0x000000ffffffffff
header: dc010000000000ffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-202">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-203">
<pre>kid: 0x0000010000000000
ctr: 0x0000010000000000
header: dd010000000000010000000000
</pre><a class="pilcrow" href="#appendix-C.1-203">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-204">
<pre>kid: 0x0000010000000000
ctr: 0x0000ffffffffffff
header: dd010000000000ffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-204">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-205">
<pre>kid: 0x0000010000000000
ctr: 0x0001000000000000
header: de01000000000001000000000000
</pre><a class="pilcrow" href="#appendix-C.1-205">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-206">
<pre>kid: 0x0000010000000000
ctr: 0x00ffffffffffffff
header: de010000000000ffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-206">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-207">
<pre>kid: 0x0000010000000000
ctr: 0x0100000000000000
header: df0100000000000100000000000000
</pre><a class="pilcrow" href="#appendix-C.1-207">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-208">
<pre>kid: 0x0000010000000000
ctr: 0xffffffffffffffff
header: df010000000000ffffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-208">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-209">
<pre>kid: 0x0000ffffffffffff
ctr: 0x0000000000000000
header: d0ffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-209">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-210">
<pre>kid: 0x0000ffffffffffff
ctr: 0x0000000000000001
header: d1ffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-210">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-211">
<pre>kid: 0x0000ffffffffffff
ctr: 0x00000000000000ff
header: d8ffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-211">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-212">
<pre>kid: 0x0000ffffffffffff
ctr: 0x0000000000000100
header: d9ffffffffffff0100
</pre><a class="pilcrow" href="#appendix-C.1-212">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-213">
<pre>kid: 0x0000ffffffffffff
ctr: 0x000000000000ffff
header: d9ffffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-213">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-214">
<pre>kid: 0x0000ffffffffffff
ctr: 0x0000000000010000
header: daffffffffffff010000
</pre><a class="pilcrow" href="#appendix-C.1-214">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-215">
<pre>kid: 0x0000ffffffffffff
ctr: 0x0000000000ffffff
header: daffffffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-215">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-216">
<pre>kid: 0x0000ffffffffffff
ctr: 0x0000000001000000
header: dbffffffffffff01000000
</pre><a class="pilcrow" href="#appendix-C.1-216">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-217">
<pre>kid: 0x0000ffffffffffff
ctr: 0x00000000ffffffff
header: dbffffffffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-217">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-218">
<pre>kid: 0x0000ffffffffffff
ctr: 0x0000000100000000
header: dcffffffffffff0100000000
</pre><a class="pilcrow" href="#appendix-C.1-218">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-219">
<pre>kid: 0x0000ffffffffffff
ctr: 0x000000ffffffffff
header: dcffffffffffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-219">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-220">
<pre>kid: 0x0000ffffffffffff
ctr: 0x0000010000000000
header: ddffffffffffff010000000000
</pre><a class="pilcrow" href="#appendix-C.1-220">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-221">
<pre>kid: 0x0000ffffffffffff
ctr: 0x0000ffffffffffff
header: ddffffffffffffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-221">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-222">
<pre>kid: 0x0000ffffffffffff
ctr: 0x0001000000000000
header: deffffffffffff01000000000000
</pre><a class="pilcrow" href="#appendix-C.1-222">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-223">
<pre>kid: 0x0000ffffffffffff
ctr: 0x00ffffffffffffff
header: deffffffffffffffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-223">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-224">
<pre>kid: 0x0000ffffffffffff
ctr: 0x0100000000000000
header: dfffffffffffff0100000000000000
</pre><a class="pilcrow" href="#appendix-C.1-224">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-225">
<pre>kid: 0x0000ffffffffffff
ctr: 0xffffffffffffffff
header: dfffffffffffffffffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-225">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-226">
<pre>kid: 0x0001000000000000
ctr: 0x0000000000000000
header: e001000000000000
</pre><a class="pilcrow" href="#appendix-C.1-226">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-227">
<pre>kid: 0x0001000000000000
ctr: 0x0000000000000001
header: e101000000000000
</pre><a class="pilcrow" href="#appendix-C.1-227">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-228">
<pre>kid: 0x0001000000000000
ctr: 0x00000000000000ff
header: e801000000000000ff
</pre><a class="pilcrow" href="#appendix-C.1-228">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-229">
<pre>kid: 0x0001000000000000
ctr: 0x0000000000000100
header: e9010000000000000100
</pre><a class="pilcrow" href="#appendix-C.1-229">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-230">
<pre>kid: 0x0001000000000000
ctr: 0x000000000000ffff
header: e901000000000000ffff
</pre><a class="pilcrow" href="#appendix-C.1-230">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-231">
<pre>kid: 0x0001000000000000
ctr: 0x0000000000010000
header: ea01000000000000010000
</pre><a class="pilcrow" href="#appendix-C.1-231">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-232">
<pre>kid: 0x0001000000000000
ctr: 0x0000000000ffffff
header: ea01000000000000ffffff
</pre><a class="pilcrow" href="#appendix-C.1-232">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-233">
<pre>kid: 0x0001000000000000
ctr: 0x0000000001000000
header: eb0100000000000001000000
</pre><a class="pilcrow" href="#appendix-C.1-233">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-234">
<pre>kid: 0x0001000000000000
ctr: 0x00000000ffffffff
header: eb01000000000000ffffffff
</pre><a class="pilcrow" href="#appendix-C.1-234">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-235">
<pre>kid: 0x0001000000000000
ctr: 0x0000000100000000
header: ec010000000000000100000000
</pre><a class="pilcrow" href="#appendix-C.1-235">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-236">
<pre>kid: 0x0001000000000000
ctr: 0x000000ffffffffff
header: ec01000000000000ffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-236">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-237">
<pre>kid: 0x0001000000000000
ctr: 0x0000010000000000
header: ed01000000000000010000000000
</pre><a class="pilcrow" href="#appendix-C.1-237">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-238">
<pre>kid: 0x0001000000000000
ctr: 0x0000ffffffffffff
header: ed01000000000000ffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-238">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-239">
<pre>kid: 0x0001000000000000
ctr: 0x0001000000000000
header: ee0100000000000001000000000000
</pre><a class="pilcrow" href="#appendix-C.1-239">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-240">
<pre>kid: 0x0001000000000000
ctr: 0x00ffffffffffffff
header: ee01000000000000ffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-240">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-241">
<pre>kid: 0x0001000000000000
ctr: 0x0100000000000000
header: ef010000000000000100000000000000
</pre><a class="pilcrow" href="#appendix-C.1-241">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-242">
<pre>kid: 0x0001000000000000
ctr: 0xffffffffffffffff
header: ef01000000000000ffffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-242">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-243">
<pre>kid: 0x00ffffffffffffff
ctr: 0x0000000000000000
header: e0ffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-243">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-244">
<pre>kid: 0x00ffffffffffffff
ctr: 0x0000000000000001
header: e1ffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-244">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-245">
<pre>kid: 0x00ffffffffffffff
ctr: 0x00000000000000ff
header: e8ffffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-245">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-246">
<pre>kid: 0x00ffffffffffffff
ctr: 0x0000000000000100
header: e9ffffffffffffff0100
</pre><a class="pilcrow" href="#appendix-C.1-246">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-247">
<pre>kid: 0x00ffffffffffffff
ctr: 0x000000000000ffff
header: e9ffffffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-247">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-248">
<pre>kid: 0x00ffffffffffffff
ctr: 0x0000000000010000
header: eaffffffffffffff010000
</pre><a class="pilcrow" href="#appendix-C.1-248">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-249">
<pre>kid: 0x00ffffffffffffff
ctr: 0x0000000000ffffff
header: eaffffffffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-249">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-250">
<pre>kid: 0x00ffffffffffffff
ctr: 0x0000000001000000
header: ebffffffffffffff01000000
</pre><a class="pilcrow" href="#appendix-C.1-250">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-251">
<pre>kid: 0x00ffffffffffffff
ctr: 0x00000000ffffffff
header: ebffffffffffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-251">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-252">
<pre>kid: 0x00ffffffffffffff
ctr: 0x0000000100000000
header: ecffffffffffffff0100000000
</pre><a class="pilcrow" href="#appendix-C.1-252">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-253">
<pre>kid: 0x00ffffffffffffff
ctr: 0x000000ffffffffff
header: ecffffffffffffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-253">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-254">
<pre>kid: 0x00ffffffffffffff
ctr: 0x0000010000000000
header: edffffffffffffff010000000000
</pre><a class="pilcrow" href="#appendix-C.1-254">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-255">
<pre>kid: 0x00ffffffffffffff
ctr: 0x0000ffffffffffff
header: edffffffffffffffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-255">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-256">
<pre>kid: 0x00ffffffffffffff
ctr: 0x0001000000000000
header: eeffffffffffffff01000000000000
</pre><a class="pilcrow" href="#appendix-C.1-256">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-257">
<pre>kid: 0x00ffffffffffffff
ctr: 0x00ffffffffffffff
header: eeffffffffffffffffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-257">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-258">
<pre>kid: 0x00ffffffffffffff
ctr: 0x0100000000000000
header: efffffffffffffff0100000000000000
</pre><a class="pilcrow" href="#appendix-C.1-258">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-259">
<pre>kid: 0x00ffffffffffffff
ctr: 0xffffffffffffffff
header: efffffffffffffffffffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-259">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-260">
<pre>kid: 0x0100000000000000
ctr: 0x0000000000000000
header: f00100000000000000
</pre><a class="pilcrow" href="#appendix-C.1-260">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-261">
<pre>kid: 0x0100000000000000
ctr: 0x0000000000000001
header: f10100000000000000
</pre><a class="pilcrow" href="#appendix-C.1-261">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-262">
<pre>kid: 0x0100000000000000
ctr: 0x00000000000000ff
header: f80100000000000000ff
</pre><a class="pilcrow" href="#appendix-C.1-262">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-263">
<pre>kid: 0x0100000000000000
ctr: 0x0000000000000100
header: f901000000000000000100
</pre><a class="pilcrow" href="#appendix-C.1-263">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-264">
<pre>kid: 0x0100000000000000
ctr: 0x000000000000ffff
header: f90100000000000000ffff
</pre><a class="pilcrow" href="#appendix-C.1-264">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-265">
<pre>kid: 0x0100000000000000
ctr: 0x0000000000010000
header: fa0100000000000000010000
</pre><a class="pilcrow" href="#appendix-C.1-265">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-266">
<pre>kid: 0x0100000000000000
ctr: 0x0000000000ffffff
header: fa0100000000000000ffffff
</pre><a class="pilcrow" href="#appendix-C.1-266">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-267">
<pre>kid: 0x0100000000000000
ctr: 0x0000000001000000
header: fb010000000000000001000000
</pre><a class="pilcrow" href="#appendix-C.1-267">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-268">
<pre>kid: 0x0100000000000000
ctr: 0x00000000ffffffff
header: fb0100000000000000ffffffff
</pre><a class="pilcrow" href="#appendix-C.1-268">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-269">
<pre>kid: 0x0100000000000000
ctr: 0x0000000100000000
header: fc01000000000000000100000000
</pre><a class="pilcrow" href="#appendix-C.1-269">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-270">
<pre>kid: 0x0100000000000000
ctr: 0x000000ffffffffff
header: fc0100000000000000ffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-270">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-271">
<pre>kid: 0x0100000000000000
ctr: 0x0000010000000000
header: fd0100000000000000010000000000
</pre><a class="pilcrow" href="#appendix-C.1-271">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-272">
<pre>kid: 0x0100000000000000
ctr: 0x0000ffffffffffff
header: fd0100000000000000ffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-272">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-273">
<pre>kid: 0x0100000000000000
ctr: 0x0001000000000000
header: fe010000000000000001000000000000
</pre><a class="pilcrow" href="#appendix-C.1-273">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-274">
<pre>kid: 0x0100000000000000
ctr: 0x00ffffffffffffff
header: fe0100000000000000ffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-274">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-275">
<pre>kid: 0x0100000000000000
ctr: 0x0100000000000000
header: ff010000000000000001000000000000
        00
</pre><a class="pilcrow" href="#appendix-C.1-275">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-276">
<pre>kid: 0x0100000000000000
ctr: 0xffffffffffffffff
header: ff0100000000000000ffffffffffffff
        ff
</pre><a class="pilcrow" href="#appendix-C.1-276">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-277">
<pre>kid: 0xffffffffffffffff
ctr: 0x0000000000000000
header: f0ffffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-277">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-278">
<pre>kid: 0xffffffffffffffff
ctr: 0x0000000000000001
header: f1ffffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-278">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-279">
<pre>kid: 0xffffffffffffffff
ctr: 0x00000000000000ff
header: f8ffffffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-279">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-280">
<pre>kid: 0xffffffffffffffff
ctr: 0x0000000000000100
header: f9ffffffffffffffff0100
</pre><a class="pilcrow" href="#appendix-C.1-280">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-281">
<pre>kid: 0xffffffffffffffff
ctr: 0x000000000000ffff
header: f9ffffffffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-281">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-282">
<pre>kid: 0xffffffffffffffff
ctr: 0x0000000000010000
header: faffffffffffffffff010000
</pre><a class="pilcrow" href="#appendix-C.1-282">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-283">
<pre>kid: 0xffffffffffffffff
ctr: 0x0000000000ffffff
header: faffffffffffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-283">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-284">
<pre>kid: 0xffffffffffffffff
ctr: 0x0000000001000000
header: fbffffffffffffffff01000000
</pre><a class="pilcrow" href="#appendix-C.1-284">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-285">
<pre>kid: 0xffffffffffffffff
ctr: 0x00000000ffffffff
header: fbffffffffffffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-285">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-286">
<pre>kid: 0xffffffffffffffff
ctr: 0x0000000100000000
header: fcffffffffffffffff0100000000
</pre><a class="pilcrow" href="#appendix-C.1-286">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-287">
<pre>kid: 0xffffffffffffffff
ctr: 0x000000ffffffffff
header: fcffffffffffffffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-287">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-288">
<pre>kid: 0xffffffffffffffff
ctr: 0x0000010000000000
header: fdffffffffffffffff010000000000
</pre><a class="pilcrow" href="#appendix-C.1-288">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-289">
<pre>kid: 0xffffffffffffffff
ctr: 0x0000ffffffffffff
header: fdffffffffffffffffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-289">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-290">
<pre>kid: 0xffffffffffffffff
ctr: 0x0001000000000000
header: feffffffffffffffff01000000000000
</pre><a class="pilcrow" href="#appendix-C.1-290">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-291">
<pre>kid: 0xffffffffffffffff
ctr: 0x00ffffffffffffff
header: feffffffffffffffffffffffffffffff
</pre><a class="pilcrow" href="#appendix-C.1-291">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-292">
<pre>kid: 0xffffffffffffffff
ctr: 0x0100000000000000
header: ffffffffffffffffff01000000000000
        00
</pre><a class="pilcrow" href="#appendix-C.1-292">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.1-293">
<pre>kid: 0xffffffffffffffff
ctr: 0xffffffffffffffff
header: ffffffffffffffffffffffffffffffff
        ff
</pre><a class="pilcrow" href="#appendix-C.1-293">Â¶</a>
</div>
</section>
</div>
<div id="aead-encryptiondecryption-using-aes-ctr-and-hmac">
<section id="appendix-C.2">
        <h3 id="name-aead-encryption-decryption-">
<a class="section-number selfRef" href="#appendix-C.2">C.2. </a><a class="section-name selfRef" href="#name-aead-encryption-decryption-">AEAD Encryption/Decryption Using AES-CTR and HMAC</a>
        </h3>
<p id="appendix-C.2-1">For each case, we provide:<a class="pilcrow" href="#appendix-C.2-1">Â¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C.2-2.1">
            <p id="appendix-C.2-2.1.1"><code>cipher_suite</code>: The index of the cipher suite in use (see
<a class="auto internal xref" href="#sframe-cipher-suites">Section 8.1</a>)<a class="pilcrow" href="#appendix-C.2-2.1.1">Â¶</a></p>
</li>
          <li class="normal" id="appendix-C.2-2.2">
            <p id="appendix-C.2-2.2.1"><code>key</code>: The <code>key</code> input to encryption/decryption<a class="pilcrow" href="#appendix-C.2-2.2.1">Â¶</a></p>
</li>
          <li class="normal" id="appendix-C.2-2.3">
            <p id="appendix-C.2-2.3.1"><code>enc_key</code>: The encryption subkey produced by the <code>derive_subkeys()</code> algorithm<a class="pilcrow" href="#appendix-C.2-2.3.1">Â¶</a></p>
</li>
          <li class="normal" id="appendix-C.2-2.4">
            <p id="appendix-C.2-2.4.1"><code>auth_key</code>: The encryption subkey produced by the <code>derive_subkeys()</code> algorithm<a class="pilcrow" href="#appendix-C.2-2.4.1">Â¶</a></p>
</li>
          <li class="normal" id="appendix-C.2-2.5">
            <p id="appendix-C.2-2.5.1"><code>nonce</code>: The <code>nonce</code> input to encryption/decryption<a class="pilcrow" href="#appendix-C.2-2.5.1">Â¶</a></p>
</li>
          <li class="normal" id="appendix-C.2-2.6">
            <p id="appendix-C.2-2.6.1"><code>aad</code>: The <code>aad</code> input to encryption/decryption<a class="pilcrow" href="#appendix-C.2-2.6.1">Â¶</a></p>
</li>
          <li class="normal" id="appendix-C.2-2.7">
            <p id="appendix-C.2-2.7.1"><code>pt</code>: The plaintext<a class="pilcrow" href="#appendix-C.2-2.7.1">Â¶</a></p>
</li>
          <li class="normal" id="appendix-C.2-2.8">
            <p id="appendix-C.2-2.8.1"><code>ct</code>: The ciphertext<a class="pilcrow" href="#appendix-C.2-2.8.1">Â¶</a></p>
</li>
        </ul>
<p id="appendix-C.2-3">An implementation should verify that the following are true, where
<code>AEAD.Encrypt</code> and <code>AEAD.Decrypt</code> are as defined in <a class="auto internal xref" href="#aes-ctr-with-sha2">Section 4.5.1</a>:<a class="pilcrow" href="#appendix-C.2-3">Â¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C.2-4.1">
            <p id="appendix-C.2-4.1.1"><code>AEAD.Encrypt(key, nonce, aad, pt) == ct</code><a class="pilcrow" href="#appendix-C.2-4.1.1">Â¶</a></p>
</li>
          <li class="normal" id="appendix-C.2-4.2">
            <p id="appendix-C.2-4.2.1"><code>AEAD.Decrypt(key, nonce, aad, ct) == pt</code><a class="pilcrow" href="#appendix-C.2-4.2.1">Â¶</a></p>
</li>
        </ul>
<p id="appendix-C.2-5">The other values in the test vector are intermediate values provided to
facilitate debugging of test failures.<a class="pilcrow" href="#appendix-C.2-5">Â¶</a></p>
<div class="lang-test-vectors sourcecode" id="appendix-C.2-6">
<pre>cipher_suite: 0x0001
key: 000102030405060708090a0b0c0d0e0f
     101112131415161718191a1b1c1d1e1f
     202122232425262728292a2b2c2d2e2f
enc_key: 000102030405060708090a0b0c0d0e0f
auth_key: 101112131415161718191a1b1c1d1e1f
          202122232425262728292a2b2c2d2e2f
nonce: 101112131415161718191a1b
aad: 4945544620534672616d65205747
pt: 64726166742d696574662d736672616d
    652d656e63
ct: 6339af04ada1d064688a442b8dc69d5b
    6bfa40f4bef0583e8081069cc60705
</pre><a class="pilcrow" href="#appendix-C.2-6">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.2-7">
<pre>cipher_suite: 0x0002
key: 000102030405060708090a0b0c0d0e0f
     101112131415161718191a1b1c1d1e1f
     202122232425262728292a2b2c2d2e2f
enc_key: 000102030405060708090a0b0c0d0e0f
auth_key: 101112131415161718191a1b1c1d1e1f
          202122232425262728292a2b2c2d2e2f
nonce: 101112131415161718191a1b
aad: 4945544620534672616d65205747
pt: 64726166742d696574662d736672616d
    652d656e63
ct: 6339af04ada1d064688a442b8dc69d5b
    6bfa40f4be6e93b7da076927bb
</pre><a class="pilcrow" href="#appendix-C.2-7">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.2-8">
<pre>cipher_suite: 0x0003
key: 000102030405060708090a0b0c0d0e0f
     101112131415161718191a1b1c1d1e1f
     202122232425262728292a2b2c2d2e2f
enc_key: 000102030405060708090a0b0c0d0e0f
auth_key: 101112131415161718191a1b1c1d1e1f
          202122232425262728292a2b2c2d2e2f
nonce: 101112131415161718191a1b
aad: 4945544620534672616d65205747
pt: 64726166742d696574662d736672616d
    652d656e63
ct: 6339af04ada1d064688a442b8dc69d5b
    6bfa40f4be09480509
</pre><a class="pilcrow" href="#appendix-C.2-8">Â¶</a>
</div>
</section>
</div>
<div id="sframe-encryptiondecryption">
<section id="appendix-C.3">
        <h3 id="name-sframe-encryption-decryptio">
<a class="section-number selfRef" href="#appendix-C.3">C.3. </a><a class="section-name selfRef" href="#name-sframe-encryption-decryptio">SFrame Encryption/Decryption</a>
        </h3>
<p id="appendix-C.3-1">For each case, we provide:<a class="pilcrow" href="#appendix-C.3-1">Â¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C.3-2.1">
            <p id="appendix-C.3-2.1.1"><code>cipher_suite</code>: The index of the cipher suite in use (see
<a class="auto internal xref" href="#sframe-cipher-suites">Section 8.1</a>)<a class="pilcrow" href="#appendix-C.3-2.1.1">Â¶</a></p>
</li>
          <li class="normal" id="appendix-C.3-2.2">
            <p id="appendix-C.3-2.2.1"><code>kid</code>: A KID value<a class="pilcrow" href="#appendix-C.3-2.2.1">Â¶</a></p>
</li>
          <li class="normal" id="appendix-C.3-2.3">
            <p id="appendix-C.3-2.3.1"><code>ctr</code>: A CTR value<a class="pilcrow" href="#appendix-C.3-2.3.1">Â¶</a></p>
</li>
          <li class="normal" id="appendix-C.3-2.4">
            <p id="appendix-C.3-2.4.1"><code>base_key</code>: The <code>base_key</code> input to the <code>derive_key_salt</code> algorithm<a class="pilcrow" href="#appendix-C.3-2.4.1">Â¶</a></p>
</li>
          <li class="normal" id="appendix-C.3-2.5">
            <p id="appendix-C.3-2.5.1"><code>sframe_key_label</code>: The label used to derive <code>sframe_key</code> in the <code>derive_key_salt</code> algorithm<a class="pilcrow" href="#appendix-C.3-2.5.1">Â¶</a></p>
</li>
          <li class="normal" id="appendix-C.3-2.6">
            <p id="appendix-C.3-2.6.1"><code>sframe_salt_label</code>: The label used to derive <code>sframe_salt</code> in the <code>derive_key_salt</code> algorithm<a class="pilcrow" href="#appendix-C.3-2.6.1">Â¶</a></p>
</li>
          <li class="normal" id="appendix-C.3-2.7">
            <p id="appendix-C.3-2.7.1"><code>sframe_secret</code>: The <code>sframe_secret</code> variable in the <code>derive_key_salt</code> algorithm<a class="pilcrow" href="#appendix-C.3-2.7.1">Â¶</a></p>
</li>
          <li class="normal" id="appendix-C.3-2.8">
            <p id="appendix-C.3-2.8.1"><code>sframe_key</code>: The <code>sframe_key</code> value produced by the <code>derive_key_salt</code> algorithm<a class="pilcrow" href="#appendix-C.3-2.8.1">Â¶</a></p>
</li>
          <li class="normal" id="appendix-C.3-2.9">
            <p id="appendix-C.3-2.9.1"><code>sframe_salt</code>: The <code>sframe_salt</code> value produced by the <code>derive_key_salt</code> algorithm<a class="pilcrow" href="#appendix-C.3-2.9.1">Â¶</a></p>
</li>
          <li class="normal" id="appendix-C.3-2.10">
            <p id="appendix-C.3-2.10.1"><code>metadata</code>: The <code>metadata</code> input to the SFrame <code>encrypt</code> algorithm<a class="pilcrow" href="#appendix-C.3-2.10.1">Â¶</a></p>
</li>
          <li class="normal" id="appendix-C.3-2.11">
            <p id="appendix-C.3-2.11.1"><code>pt</code>: The plaintext<a class="pilcrow" href="#appendix-C.3-2.11.1">Â¶</a></p>
</li>
          <li class="normal" id="appendix-C.3-2.12">
            <p id="appendix-C.3-2.12.1"><code>ct</code>: The SFrame ciphertext<a class="pilcrow" href="#appendix-C.3-2.12.1">Â¶</a></p>
</li>
        </ul>
<p id="appendix-C.3-3">An implementation should verify that the following are true, where
<code>encrypt</code> and <code>decrypt</code> are as defined in <a class="auto internal xref" href="#encryption-schema">Section 4.4</a>, using an SFrame
context initialized with <code>base_key</code> assigned to <code>kid</code>:<a class="pilcrow" href="#appendix-C.3-3">Â¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C.3-4.1">
            <p id="appendix-C.3-4.1.1"><code>encrypt(ctr, kid, metadata, plaintext) == ct</code><a class="pilcrow" href="#appendix-C.3-4.1.1">Â¶</a></p>
</li>
          <li class="normal" id="appendix-C.3-4.2">
            <p id="appendix-C.3-4.2.1"><code>decrypt(metadata, ct) == pt</code><a class="pilcrow" href="#appendix-C.3-4.2.1">Â¶</a></p>
</li>
        </ul>
<p id="appendix-C.3-5">The other values in the test vector are intermediate values provided to
facilitate debugging of test failures.<a class="pilcrow" href="#appendix-C.3-5">Â¶</a></p>
<div class="lang-test-vectors sourcecode" id="appendix-C.3-6">
<pre>cipher_suite: 0x0001
kid: 0x0000000000000123
ctr: 0x0000000000004567
base_key: 000102030405060708090a0b0c0d0e0f
sframe_key_label: 534672616d6520312e30205365637265
                  74206b65792000000000000001230001
sframe_salt_label: 534672616d6520312e30205365637265
                   742073616c7420000000000000012300
                   01
sframe_secret: d926952ca8b7ec4a95941d1ada3a5203
               ceff8cceee34f574d23909eb314c40c0
sframe_key: 3f7d9a7c83ae8e1c8a11ae695ab59314
            b367e359fadac7b9c46b2bc6f81f46e1
            6b96f0811868d59402b7e870102720b3
sframe_salt: 50b29329a04dc0f184ac3168
metadata: 4945544620534672616d65205747
nonce: 50b29329a04dc0f184ac740f
aad: 99012345674945544620534672616d65
     205747
pt: 64726166742d696574662d736672616d
    652d656e63
ct: 9901234567449408b6f490086165b9d6
    f62b24ae1a59a56486b4ae8ed036b889
    12e24f11
</pre><a class="pilcrow" href="#appendix-C.3-6">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.3-7">
<pre>cipher_suite: 0x0002
kid: 0x0000000000000123
ctr: 0x0000000000004567
base_key: 000102030405060708090a0b0c0d0e0f
sframe_key_label: 534672616d6520312e30205365637265
                  74206b65792000000000000001230002
sframe_salt_label: 534672616d6520312e30205365637265
                   742073616c7420000000000000012300
                   02
sframe_secret: d926952ca8b7ec4a95941d1ada3a5203
               ceff8cceee34f574d23909eb314c40c0
sframe_key: e2ec5c797540310483b16bf6e7a570d2
            a27d192fe869c7ccd8584a8d9dab9154
            9fbe553f5113461ec6aa83bf3865553e
sframe_salt: e68ac8dd3d02fbcd368c5577
metadata: 4945544620534672616d65205747
nonce: e68ac8dd3d02fbcd368c1010
aad: 99012345674945544620534672616d65
     205747
pt: 64726166742d696574662d736672616d
    652d656e63
ct: 99012345673f31438db4d09434e43afa
    0f8a2f00867a2be085046a9f5cb4f101
    d607
</pre><a class="pilcrow" href="#appendix-C.3-7">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.3-8">
<pre>cipher_suite: 0x0003
kid: 0x0000000000000123
ctr: 0x0000000000004567
base_key: 000102030405060708090a0b0c0d0e0f
sframe_key_label: 534672616d6520312e30205365637265
                  74206b65792000000000000001230003
sframe_salt_label: 534672616d6520312e30205365637265
                   742073616c7420000000000000012300
                   03
sframe_secret: d926952ca8b7ec4a95941d1ada3a5203
               ceff8cceee34f574d23909eb314c40c0
sframe_key: 2c5703089cbb8c583475e4fc461d97d1
            8809df79b6d550f78eb6d50ffa80d892
            11d57909934f46f5405e38cd583c69fe
sframe_salt: 38c16e4f5159700c00c7f350
metadata: 4945544620534672616d65205747
nonce: 38c16e4f5159700c00c7b637
aad: 99012345674945544620534672616d65
     205747
pt: 64726166742d696574662d736672616d
    652d656e63
ct: 990123456717fc8af28a5a695afcfc6c
    8df6358a17e26b2fcb3bae32e443
</pre><a class="pilcrow" href="#appendix-C.3-8">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.3-9">
<pre>cipher_suite: 0x0004
kid: 0x0000000000000123
ctr: 0x0000000000004567
base_key: 000102030405060708090a0b0c0d0e0f
sframe_key_label: 534672616d6520312e30205365637265
                  74206b65792000000000000001230004
sframe_salt_label: 534672616d6520312e30205365637265
                   742073616c7420000000000000012300
                   04
sframe_secret: d926952ca8b7ec4a95941d1ada3a5203
               ceff8cceee34f574d23909eb314c40c0
sframe_key: d34f547f4ca4f9a7447006fe7fcbf768
sframe_salt: 75234edefe07819026751816
metadata: 4945544620534672616d65205747
nonce: 75234edefe07819026755d71
aad: 99012345674945544620534672616d65
     205747
pt: 64726166742d696574662d736672616d
    652d656e63
ct: 9901234567b7412c2513a1b66dbb4884
    1bbaf17f598751176ad847681a69c6d0
    b091c07018ce4adb34eb
</pre><a class="pilcrow" href="#appendix-C.3-9">Â¶</a>
</div>
<div class="lang-test-vectors sourcecode" id="appendix-C.3-10">
<pre>cipher_suite: 0x0005
kid: 0x0000000000000123
ctr: 0x0000000000004567
base_key: 000102030405060708090a0b0c0d0e0f
sframe_key_label: 534672616d6520312e30205365637265
                  74206b65792000000000000001230005
sframe_salt_label: 534672616d6520312e30205365637265
                   742073616c7420000000000000012300
                   05
sframe_secret: 0fc3ea6de6aac97a35f194cf9bed94d4
               b5230f1cb45a785c9fe5dce9c188938a
               b6ba005bc4c0a19181599e9d1bcf7b74
               aca48b60bf5e254e546d809313e083a3
sframe_key: d3e27b0d4a5ae9e55df01a70e6d4d28d
            969b246e2936f4b7a5d9b494da6b9633
sframe_salt: 84991c167b8cd23c93708ec7
metadata: 4945544620534672616d65205747
nonce: 84991c167b8cd23c9370cba0
aad: 99012345674945544620534672616d65
     205747
pt: 64726166742d696574662d736672616d
    652d656e63
ct: 990123456794f509d36e9beacb0e261d
    99c7d1e972f1fed787d4049f17ca2135
    3c1cc24d56ceabced279
</pre><a class="pilcrow" href="#appendix-C.3-10">Â¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="acknowledgements">
<section id="appendix-D">
      <h2 id="name-acknowledgements">
<a class="section-name selfRef" href="#name-acknowledgements">Acknowledgements</a>
      </h2>
<p id="appendix-D-1">The authors wish to specially thank <span class="contact-name">Dr. Alex Gouaillard</span> as one of the early
contributors to the document. His passion and energy were key to the design and
development of SFrame.<a class="pilcrow" href="#appendix-D-1">Â¶</a></p>
</section>
</div>
<div id="contributors">
<section id="appendix-E">
      <h2 id="name-contributors">
<a class="section-name selfRef" href="#name-contributors">Contributors</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">FrÃ©dÃ©ric Jacobs</span></div>
<div class="left" dir="auto"><span class="org">Apple</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:frederic.jacobs@apple.com">frederic.jacobs@apple.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Marta Mularczyk</span></div>
<div class="left" dir="auto"><span class="org">Amazon</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:mulmarta@amazon.com">mulmarta@amazon.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Suhas Nandakumar</span></div>
<div class="left" dir="auto"><span class="org">Cisco</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:snandaku@cisco.com">snandaku@cisco.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Tomas Rigaux</span></div>
<div class="left" dir="auto"><span class="org">Cisco</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:trigaux@cisco.com">trigaux@cisco.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Raphael Robert</span></div>
<div class="left" dir="auto"><span class="org">Phoenix R&amp;D</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:ietf@raphaelrobert.com">ietf@raphaelrobert.com</a>
</div>
</address>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-F">
      <h2 id="name-authors-addresses">
<a class="section-name selfRef" href="#name-authors-addresses">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Emad Omara</span></div>
<div class="left" dir="auto"><span class="org">Apple</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:eomara@apple.com">eomara@apple.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Justin Uberti</span></div>
<div class="left" dir="auto"><span class="org">Fixie.ai</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:justin@fixie.ai">justin@fixie.ai</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Sergio Garcia Murillo</span></div>
<div class="left" dir="auto"><span class="org">CoSMo Software</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:sergio.garcia.murillo@cosmosoftware.io">sergio.garcia.murillo@cosmosoftware.io</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Richard Barnes (<span class="role">editor</span>)</span></div>
<div class="left" dir="auto"><span class="org">Cisco</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:rlb@ipv.sx">rlb@ipv.sx</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Youenn Fablet</span></div>
<div class="left" dir="auto"><span class="org">Apple</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:youenn@apple.com">youenn@apple.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>