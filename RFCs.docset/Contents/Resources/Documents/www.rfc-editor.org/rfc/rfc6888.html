<html><head></head><body><pre>Internet Engineering Task Force (IETF)                 S. Perreault, Ed.
Request for Comments: 6888                                      Viagenie
BCP: 127                                                     I. Yamagata
Updates: <a href="./rfc4787">4787</a>                                                S. Miyakawa
Category: Best Current Practice                       NTT Communications
ISSN: 2070-1721                                              A. Nakagawa
                                          Japan Internet Exchange (JPIX)
                                                               H. Ashida
                                                           Cisco Systems
                                                              April 2013


           <span class="h1">Common Requirements for Carrier-Grade NATs (CGNs)</span>

Abstract

   This document defines common requirements for Carrier-Grade NATs
   (CGNs).  It updates <a href="./rfc4787">RFC 4787</a>.

Status of This Memo

   This memo documents an Internet Best Current Practice.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   BCPs is available in <a href="./rfc5741#section-2">Section 2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc6888">http://www.rfc-editor.org/info/rfc6888</a>.

Copyright Notice

   Copyright (c) 2013 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://www.rfc-editor.org/bcp/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.




<span class="grey">Perreault, et al.         Best Current Practice                 [Page 1]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-2"></span>
<span class="grey"><a href="./rfc6888">RFC 6888</a>                    CGN Requirements                  April 2013</span>


Table of Contents
   <a href="#section-1">1</a>. Introduction . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-2">2</a>
   <a href="#section-2">2</a>. Terminology  . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-3">3</a>
   <a href="#section-3">3</a>. Requirements for CGNs  . . . . . . . . . . . . . . . . . . .  <a href="#page-4">4</a>
   <a href="#section-4">4</a>. Logging  . . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-10">10</a>
   <a href="#section-5">5</a>. Port Allocation Scheme . . . . . . . . . . . . . . . . . . . <a href="#page-11">11</a>
   <a href="#section-6">6</a>. Deployment Considerations  . . . . . . . . . . . . . . . . . <a href="#page-11">11</a>
   <a href="#section-7">7</a>. Security Considerations  . . . . . . . . . . . . . . . . . . <a href="#page-12">12</a>
   <a href="#section-8">8</a>. Acknowledgements . . . . . . . . . . . . . . . . . . . . . . <a href="#page-12">12</a>
   <a href="#section-9">9</a>. References . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-12">12</a>
      <a href="#section-9.1">9.1</a>. Normative References  . . . . . . . . . . . . . . . . . <a href="#page-12">12</a>
      <a href="#section-9.2">9.2</a>. Informative Reference . . . . . . . . . . . . . . . . . <a href="#page-13">13</a>

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" id="section-1">1</a>.  Introduction</span>

   With the shortage of IPv4 addresses, it is expected that more
   Internet Service Providers (ISPs) may want to provide a service where
   a public IPv4 address would be shared by many subscribers.  Each
   subscriber is assigned a private address, and a Network Address
   Translator (NAT) [<a href="./rfc2663" title='"IP Network Address Translator (NAT) Terminology and Considerations"'>RFC2663</a>] situated in the ISP's network translates
   the traffic between private and public addresses.  When a second IPv4
   NAT is located at the customer edge, this results in two layers of
   NAT.

   This service can conceivably be offered alongside others, such as
   IPv6 services or regular IPv4 service assigning public addresses to
   subscribers.  Some ISPs started offering such a service long before
   there was a shortage of IPv4 addresses, showing that there are
   driving forces other than the shortage of IPv4 addresses.  One
   approach to CGN deployment is described in [<a href="./rfc6264" title='"An Incremental Carrier-Grade NAT (CGN) for IPv6 Transition"'>RFC6264</a>].

   This document describes behavior that is required of those multi-
   subscriber NATs for interoperability.  It is not an IETF endorsement
   of CGNs or a real specification for CGNs; rather, it is just a
   minimal set of requirements that will increase the likelihood of
   applications working across CGNs.

   Because subscribers do not receive unique IPv4 addresses, Carrier-
   Grade NATs introduce substantial limitations in communications
   between subscribers and with the rest of the Internet.  In
   particular, it is considerably more involved to establish proxy
   functionality at the border between internal and external realms.
   Some applications may require substantial enhancements, while some
   others may not function at all in such an environment.  Please see
   "Issues with IP Address Sharing" [<a href="./rfc6269" title='"Issues with IP Address Sharing"'>RFC6269</a>] for details.






<span class="grey">Perreault, et al.         Best Current Practice                 [Page 2]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-3"></span>
<span class="grey"><a href="./rfc6888">RFC 6888</a>                    CGN Requirements                  April 2013</span>


   This document builds upon previous works describing requirements for
   generic NATs [<a href="./rfc4787" title='"Network Address Translation (NAT) Behavioral Requirements for Unicast UDP"'>RFC4787</a>][RFC5382][<a href="./rfc5508" title='"NAT Behavioral Requirements for ICMP"'>RFC5508</a>].  These documents, and their
   updates if any, still apply in this context.  What follows are
   additional requirements, to be satisfied on top of previous ones.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.%20%20Terminology"></a><a class="selflink" href="#section-2" id="section-2">2</a>.  Terminology</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [<a href="./rfc2119" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].

   Readers are expected to be familiar with "Network Address Translation
   (NAT) Behavioral Requirements for Unicast UDP" [<a href="./rfc4787" title='"Network Address Translation (NAT) Behavioral Requirements for Unicast UDP"'>RFC4787</a>] and the
   terms defined there.  The following additional term is used in this
   document:

   Carrier-Grade NAT (CGN):  A NAT-based [<a href="./rfc2663" title='"IP Network Address Translator (NAT) Terminology and Considerations"'>RFC2663</a>] logical function used
      to share the same IPv4 address among several subscribers.  A CGN
      is not managed by the subscribers.

         Note that the term "carrier-grade" has nothing to do with the
         quality of the NAT; that is left to discretion of implementers.
         Rather, it is to be understood as a topological qualifier: the
         NAT is placed in an ISP's network and translates the traffic of
         potentially many subscribers.  Subscribers have limited or no
         control over the CGN, whereas they typically have full control
         over a NAT placed on their premises.

         Note also that the CGN described in this document is IPv4-only.
         IPv6 address translation is not considered.

         However, the scenario in which the IPv4-only CGN logical
         function is used may include IPv6 elements.  For example, Dual-
         Stack Lite (DS-Lite) [<a href="./rfc6333" title='"Dual- Stack Lite Broadband Deployments Following IPv4 Exhaustion"'>RFC6333</a>] uses an IPv4-only CGN logical
         function in a scenario making use of IPv6 encapsulation.
         Therefore, this document would also apply to the CGN part of
         DS-Lite.














<span class="grey">Perreault, et al.         Best Current Practice                 [Page 3]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-4"></span>
<span class="grey"><a href="./rfc6888">RFC 6888</a>                    CGN Requirements                  April 2013</span>


   Figure 1 summarizes a common network topology in which a CGN
   operates.

                                   .
                                   :
                                   |       Internet
                   ............... | ...................
                                   |       ISP network
                   External pool:  |
                   192.0.2.1/26    |
                               ++------++  External realm
                   ........... |  CGN   |...............
                               ++------++  Internal realm
                        10.0.0.1 |    |
                                 |    |
                                 |    |    ISP network
                   ............. | .. | ................
                                 |    |  Customer premises
                      10.0.0.100 |    | 10.0.0.101
                         ++------++  ++------++
                         |  CPE1  |  |  CPE2  |  etc.
                         ++------++  ++------++

               (IP addresses are only for example purposes)

                      Figure 1: CGN Network Topology

   Another possible topology is one for hotspots, where there is no
   customer premise or customer premises equipment (CPE), but where a
   CGN serves a bunch of customers who don't trust each other; hence,
   fairness is an issue.  One important difference with the previous
   topology is the absence of a second layer of NAT.  This, however, has
   no impact on CGN requirements since they are driven by fairness and
   robustness in the service provided to customers, which applies in
   both cases.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.%20%20Requirements%20for%20CGNs"></a><a class="selflink" href="#section-3" id="section-3">3</a>.  Requirements for CGNs</span>

   What follows is a list of requirements for CGNs.  They are in
   addition to those found in other documents such as [<a href="./rfc4787" title='"Network Address Translation (NAT) Behavioral Requirements for Unicast UDP"'>RFC4787</a>],
   [<a href="./rfc5382" title='"NAT Behavioral Requirements for TCP"'>RFC5382</a>], and [<a href="./rfc5508" title='"NAT Behavioral Requirements for ICMP"'>RFC5508</a>].

   REQ-1:  If a CGN forwards packets containing a given transport
      protocol, then it MUST fulfill that transport protocol's
      behavioral requirements.  Current applicable documents are as
      follows:

      a.  "NAT Behavioral Requirements for Unicast UDP" [<a href="./rfc4787" title='"Network Address Translation (NAT) Behavioral Requirements for Unicast UDP"'>RFC4787</a>]



<span class="grey">Perreault, et al.         Best Current Practice                 [Page 4]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-5"></span>
<span class="grey"><a href="./rfc6888">RFC 6888</a>                    CGN Requirements                  April 2013</span>


      b.  "Network Address Translation (NAT) Behavioral Requirements for
          TCP" [<a href="./rfc5382" title='"NAT Behavioral Requirements for TCP"'>RFC5382</a>]

      c.  "NAT Behavioral Requirements for ICMP" [<a href="./rfc5508" title='"NAT Behavioral Requirements for ICMP"'>RFC5508</a>]

      d.  "Network Address Translation (NAT) Behavioral Requirements for
          the Datagram Congestion Control Protocol (DCCP)" [<a href="./rfc5597" title='"Network Address Translation (NAT) Behavioral Requirements for the Datagram Congestion Control Protocol"'>RFC5597</a>]

      Any future NAT behavioral requirements documents for IPv4
      transport protocols will impose additional requirements for CGNs
      on top of those stated here.

   Justification:  It is crucial for CGNs to maximize the set of
      applications that can function properly across them.  The IETF has
      documented the best current practices for UDP, TCP, ICMP, and
      DCCP.

   REQ-2:  A CGN MUST have a default "IP address pooling" behavior of
      "Paired" (as defined in <a href="./rfc4787#section-4.1">Section 4.1 of [RFC4787]</a>).  A CGN MAY
      provide a mechanism for administrators to change this behavior on
      an application protocol basis.

      *  When multiple overlapping internal IP address ranges share the
         same external IP address pool (e.g., DS-Lite [<a href="./rfc6333" title='"Dual- Stack Lite Broadband Deployments Following IPv4 Exhaustion"'>RFC6333</a>]), the
         "IP address pooling" behavior applies to mappings between
         external IP addresses and internal subscribers rather than
         between external and internal IP addresses.

   Justification:  This stronger form of REQ-2 from [<a href="./rfc4787" title='"Network Address Translation (NAT) Behavioral Requirements for Unicast UDP"'>RFC4787</a>] is
      justified by the stronger need for not breaking applications that
      depend on the external address remaining constant.

      Note that this requirement applies regardless of the transport
      protocol.  In other words, a CGN must use the same external IP
      address mapping for all sessions associated with the same internal
      IP address, be they TCP, UDP, ICMP, something else, or a mix of
      different protocols.

      The justification for allowing other behaviors is to allow the
      administrator to save external addresses and ports for application
      protocols that are known to work fine with other behaviors in
      practice.  However, the default behavior MUST be "Paired".

   REQ-3:  The CGN function SHOULD NOT have any limitations on the size
      or the contiguity of the external address pool.  In particular,
      the CGN function MUST be configurable with contiguous or non-
      contiguous external IPv4 address ranges.




<span class="grey">Perreault, et al.         Best Current Practice                 [Page 5]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-6"></span>
<span class="grey"><a href="./rfc6888">RFC 6888</a>                    CGN Requirements                  April 2013</span>


   Justification:  Given the increasing rarity of IPv4 addresses, it is
      becoming harder for an operator to provide large contiguous
      address pools to CGNs.  Additionally, operational flexibility may
      require non-contiguous address pools for reasons such as
      differentiated services, routing management, etc.

      The reason for having SHOULD instead of MUST is to account for
      limitations imposed by available resources as well as constraints
      imposed for security reasons.

   REQ-4:  A CGN MUST support limiting the number of external ports (or,
      equivalently, "identifiers" for ICMP) that are assigned per
      subscriber.

      a.  Per-subscriber limits MUST be configurable by the CGN
          administrator.

      b.  Per-subscriber limits MAY be configurable independently per
          transport protocol.

      c.  Additionally, it is RECOMMENDED that the CGN include
          administrator-adjustable thresholds to prevent a single
          subscriber from consuming excessive CPU resources from the CGN
          (e.g., rate-limit the subscriber's creation of new mappings).

   Justification:  A CGN can be considered a network resource that is
      shared by competing subscribers.  Limiting the number of external
      ports assigned to each subscriber mitigates the denial-of-service
      (DoS) attack that a subscriber could launch against other
      subscribers through the CGN in order to get a larger share of the
      resource.  It ensures fairness among subscribers.  Limiting the
      rate of allocation mitigates a similar attack where the CPU is the
      resource being targeted instead of port numbers.  However, this
      requirement is not a MUST because it is very hard to explicitly
      call out all CPU-consuming events.

   REQ-5:  A CGN SHOULD support limiting the amount of state memory
      allocated per mapping and per subscriber.  This may include
      limiting the number of sessions, the number of filters, etc.,
      depending on the NAT implementation.

      a.  Limits SHOULD be configurable by the CGN administrator.

      b.  Additionally, it SHOULD be possible to limit the rate at which
          memory-consuming state elements are allocated.






<span class="grey">Perreault, et al.         Best Current Practice                 [Page 6]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-7"></span>
<span class="grey"><a href="./rfc6888">RFC 6888</a>                    CGN Requirements                  April 2013</span>


   Justification:  A NAT needs to keep track of TCP sessions associated
      with each mapping.  This state consumes resources for which, in
      the case of a CGN, subscribers may compete.  It is necessary to
      ensure that each subscriber has access to a fair share of the
      CGN's resources.  Limiting the rate of allocation is intended to
      prevent CPU resource exhaustion.  Item "B" is at the SHOULD level
      to account for the fact that means other than rate limiting may be
      used to attain the same goal.

   REQ-6:  It MUST be possible to administratively turn off translation
      for specific destination addresses and/or ports.

   Justification:  It is common for a CGN administrator to provide
      access for subscribers to servers installed in the ISP's network
      in the external realm.  When such a server is able to reach the
      internal realm via normal routing (which is entirely controlled by
      the ISP), translation is unneeded.  In that case, the CGN may
      forward packets without modification, thus acting like a plain
      router.  This may represent an important efficiency gain.

      Figure 2 illustrates this use-case.

                  X1:x1            X1':x1'            X2:x2
                  +---+from X1:x1  +---+from X1:x1    +---+
                  | C |  to X2:x2  |   |  to X2:x2    | S |
                  | l |&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;| C |&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;| e |
                  | i |            | G |              | r |
                  | e |&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;| N |&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;| v |
                  | n |from X2:x2  |   |from X2:x2    | e |
                  | t |  to X1:x1  |   |  to X1:x1    | r |
                  +---+            +---+              +---+

                        Figure 2: CGN Pass-Through

   REQ-7:  It is RECOMMENDED that a CGN use an "endpoint-independent
      filtering" behavior (as defined in <a href="./rfc4787#section-5">Section 5 of [RFC4787]</a>).  If it
      is known that "Address-Dependent Filtering" does not cause the
      application-layer protocol to break (how to determine this is out
      of scope for this document), then it MAY be used instead.

   Justification:  This is a stronger form of REQ-8 from [<a href="./rfc4787" title='"Network Address Translation (NAT) Behavioral Requirements for Unicast UDP"'>RFC4787</a>].
      This is based on the observation that some games and peer-to-peer
      applications require EIF for the NAT traversal to work.  In the
      context of a CGN, it is important to minimize application
      breakage.






<span class="grey">Perreault, et al.         Best Current Practice                 [Page 7]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-8"></span>
<span class="grey"><a href="./rfc6888">RFC 6888</a>                    CGN Requirements                  April 2013</span>


   REQ-8:  Once an external port is deallocated, it SHOULD NOT be
      reallocated to a new mapping until at least 120 seconds have
      passed, with the exceptions being:

      a.  If the CGN tracks TCP sessions (e.g., with a state machine, as
          in <a href="./rfc6146#section-3.5.2.2">Section 3.5.2.2 of [RFC6146]</a>), TCP ports MAY be reused
          immediately.

      b.  If external ports are statically assigned to internal
          addresses (e.g., address X with port range 1000-1999 is
          assigned to subscriber A, 2000-2999 to subscriber B, etc.),
          and the assignment remains constant across state loss, then
          ports MAY be reused immediately.

      c.  If the allocated external ports used address-dependent or
          address-and-port-dependent filtering before state loss, they
          MAY be reused immediately.

      The length of time and the maximum number of ports in this state
      MUST be configurable by the CGN administrator.

   Justification:  This is necessary in order to prevent collisions
      between old and new mappings and sessions.  It ensures that all
      established sessions are broken instead of redirected to a
      different peer.

      The exceptions are for cases where reusing a port immediately does
      not create a possibility that packets would be redirected to the
      wrong peer.  One can imagine other exceptions where mapping
      collisions are avoided, thus justifying the SHOULD level for this
      requirement.

      The 120 seconds value corresponds to the Maximum Segment Lifetime
      (MSL) from [<a href="./rfc0793" title='"Transmission Control Protocol"'>RFC0793</a>].

      Note that this requirement also applies to the case when a CGN
      loses state (due to a crash, reboot, failover to a cold standby,
      etc.).  In that case, ports that were in use at the time of state
      loss SHOULD NOT be reallocated until at least 120 seconds have
      passed.

   REQ-9:  A CGN MUST implement a protocol giving subscribers explicit
      control over NAT mappings.  That protocol SHOULD be the Port
      Control Protocol [<a href="./rfc6887" title='"Port Control Protocol (PCP)"'>RFC6887</a>].

   Justification:  Allowing subscribers to manipulate the NAT state
      table with PCP greatly increases the likelihood that applications
      will function properly.



<span class="grey">Perreault, et al.         Best Current Practice                 [Page 8]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-9"></span>
<span class="grey"><a href="./rfc6888">RFC 6888</a>                    CGN Requirements                  April 2013</span>


      A study of PCP-less CGN impacts can be found in [<a href="#ref-NAT444" title='"Assessing the Impact of Carrier-Grade NAT on Network Applications"'>NAT444</a>].  Another
      study considering the effects of PCP on a peer-to-peer file
      sharing protocol can be found in [<a href="#ref-BITTORRENT">BITTORRENT</a>].

   REQ-10: CGN implementers SHOULD make their equipment manageable.
      Standards-based management using standards such as "Definitions of
      Managed Objects for NAT" [<a href="./rfc4008" title='"Definitions of Managed Objects for Network Address Translators (NAT)"'>RFC4008</a>] is RECOMMENDED.

   Justification:  It is anticipated that CGNs will be primarily
      deployed in ISP networks where the need for management is
      critical.  This requirement is at the SHOULD level to account for
      the fact that some CGN operators may not need management
      functionality.

      Note also that there are efforts within the IETF toward creating a
      MIB tailored for CGNs (e.g., [<a href="#ref-NAT-MIB" title='"Additional Managed Objects for Network Address Translators (NAT)"'>NAT-MIB</a>]).

   REQ-11: When a CGN is unable to create a dynamic mapping due to
      resource constraints or administrative restrictions (i.e.,
      quotas):

      a.  it MUST drop the original packet;

      b.  it SHOULD send an ICMP Destination Unreachable message with
          code 1 (Host Unreachable) to the sender;

      c.  it SHOULD send a notification (e.g., SNMP trap) towards a
          management system (if configured to do so); and

      d.  it MUST NOT delete existing mappings in order to "make room"
          for the new one.  (This only applies to normal CGN behavior,
          not to manual operator intervention.)

   Justification:  This is a slightly different form of REQ-8 from
      [<a href="./rfc5508" title='"NAT Behavioral Requirements for ICMP"'>RFC5508</a>].  Code 1 is preferred to code 13 because it is listed as
      a "soft error" in [<a href="./rfc1122" title='"Requirements for Internet Hosts - Communication Layers"'>RFC1122</a>], which is important because we don't
      want TCP stacks to abort the connection attempt in this case.  See
      [<a href="./rfc5461" title="&quot;TCP's Reaction to Soft Errors&quot;">RFC5461</a>] for details on TCP's reaction to soft errors.

      Sending ICMP errors and SNMP traps may be rate-limited for
      security reasons, which is why requirements B and C are SHOULDs,
      not MUSTs.

      Applications generally handle connection establishment failure
      better than established connection failure.  This is why dropping
      the packet initiating the new connection is preferred over
      deleting existing mappings.  See also the rationale in <a href="./rfc5508#section-6">Section 6
      of [RFC5508]</a>.



<span class="grey">Perreault, et al.         Best Current Practice                 [Page 9]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-10"></span>
<span class="grey"><a href="./rfc6888">RFC 6888</a>                    CGN Requirements                  April 2013</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/4.%20%20Logging"></a><a class="selflink" href="#section-4" id="section-4">4</a>.  Logging</span>

   It may be necessary for CGN administrators to be able to identify a
   subscriber based on external IPv4 address, port, and timestamp in
   order to deal with abuse.  When multiple subscribers share a single
   external address, the source address and port that are visible at the
   destination host have been translated from the ones originated by the
   subscriber.

   In order to be able to do this, the CGN would need to log the
   following information for each mapping created (this list is for
   informational purposes only and does not constitute a requirement):

   o  transport protocol

   o  subscriber identifier (e.g., internal source address or tunnel
      endpoint identifier)

   o  external source address

   o  external source port

   o  timestamp

   By "subscriber identifier" we mean information that uniquely
   identifies a subscriber.  For example, in a traditional NAT scenario,
   the internal source address would be sufficient.  In the case of DS-
   Lite, many subscribers share the same internal address and the
   subscriber identifier is the tunnel endpoint identifier (i.e., the
   B4's IPv6 address).

   A disadvantage of logging mappings is that CGNs under heavy usage may
   produce large amounts of logs, which may require large storage
   volume.

   REQ-12: A CGN SHOULD NOT log destination addresses or ports unless
      required to do so for administrative reasons.

   Justification:  Destination logging at the CGN creates privacy
      issues.  Furthermore, readers should be aware of logging
      recommendations for Internet-facing servers [<a href="./rfc6302" title='"Logging Recommendations for Internet-Facing Servers"'>RFC6302</a>].  With
      compliant servers, the destination address and port do not need to
      be logged by the CGN.  This can help reduce the amount of logging.

      This requirement is at the SHOULD level to account for the fact
      that there may be other reasons for logging destination addresses
      or ports.  One such reason might be that the remote server is not
      following [<a href="./rfc6302" title='"Logging Recommendations for Internet-Facing Servers"'>RFC6302</a>].



<span class="grey">Perreault, et al.         Best Current Practice                [Page 10]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-11"></span>
<span class="grey"><a href="./rfc6888">RFC 6888</a>                    CGN Requirements                  April 2013</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.%20%20Port%20Allocation%20Scheme"></a><a class="selflink" href="#section-5" id="section-5">5</a>.  Port Allocation Scheme</span>

   A CGN's port allocation scheme is subject to three competing
   requirements:

   REQ-13: A CGN's port allocation scheme SHOULD maximize port
      utilization.

   Justification:  External ports are one of the resources being shared
      by a CGN.  Efficient management of that resource directly impacts
      the quality of a subscriber's Internet connection.

      Some schemes are very efficient in their port utilization.  In
      that sense, they have good scaling properties (nothing is wasted).
      Others will systematically waste ports.

   REQ-14: A CGN's port allocation scheme SHOULD minimize log volume.

   Justification:  Huge log volumes can be problematic to CGN operators.

      Some schemes create one log entry per mapping.  Others allow
      multiple mappings to generate a single log entry, which sometimes
      can be expressed very compactly.  With some schemes, the logging
      frequency can approach that of DHCP servers.

   REQ-15: A CGN's port allocation scheme SHOULD make it hard for
      attackers to guess port numbers.

   Justification:  Easily guessed port numbers put subscribers at risk
      of the attacks described in [<a href="./rfc6056" title='"Recommendations for Transport- Protocol Port Randomization"'>RFC6056</a>].

      Some schemes provide very good security in that ports numbers are
      not easily guessed.  Others provide poor security to subscribers.

   A CGN implementation's choice of port allocation scheme optimizes to
   satisfy one requirement at the expense of another.  Therefore, these
   are soft requirements (SHOULD as opposed to MUST).

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/6.%20%20Deployment%20Considerations"></a><a class="selflink" href="#section-6" id="section-6">6</a>.  Deployment Considerations</span>

   Several issues are encountered when CGNs are used [<a href="./rfc6269" title='"Issues with IP Address Sharing"'>RFC6269</a>].  There
   is current work in the IETF toward alleviating some of these issues.
   For example, see [<a href="#ref-NAT-REVEAL">NAT-REVEAL</a>].








<span class="grey">Perreault, et al.         Best Current Practice                [Page 11]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-12"></span>
<span class="grey"><a href="./rfc6888">RFC 6888</a>                    CGN Requirements                  April 2013</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/7.%20%20Security%20Considerations"></a><a class="selflink" href="#section-7" id="section-7">7</a>.  Security Considerations</span>

   If a malicious subscriber can spoof another subscriber's CPE, it may
   cause a DoS to that subscriber by creating mappings up to the allowed
   limit.  An ISP can prevent this with ingress filtering, as described
   in [<a href="./rfc2827" title='"Network Ingress Filtering: Defeating Denial of Service Attacks which employ IP Source Address Spoofing"'>RFC2827</a>].

   This document recommends endpoint-independent filtering (EIF) as the
   default filtering behavior for CGNs.  EIF has security considerations
   that are discussed in [<a href="./rfc4787" title='"Network Address Translation (NAT) Behavioral Requirements for Unicast UDP"'>RFC4787</a>].

   NATs sometimes perform fragment reassembly.  CGNs would do so at
   presumably high data rates.  Therefore, the reader should be familiar
   with the potential security issues described in [<a href="./rfc4963" title='"IPv4 Reassembly Errors at High Data Rates"'>RFC4963</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/8.%20%20Acknowledgements"></a><a class="selflink" href="#section-8" id="section-8">8</a>.  Acknowledgements</span>

   Thanks for the input and review by Alexey Melnikov, Arifumi
   Matsumoto, Barry Leiba, Benson Schliesser, Dai Kuwabara, Dan Wing,
   Dave Thaler, David Harrington, Francis Dupont, Jean-Francois
   Tremblay, Joe Touch, Lars Eggert, Kousuke Shishikura, Mohamed
   Boucadair, Martin Stiemerling, Meng Wei, Nejc Skoberne, Pete Resnick,
   Reinaldo Penno, Ron Bonica, Sam Hartman, Sean Turner, Senthil
   Sivakumar, Stephen Farrell, Stewart Bryant, Takanori Mizuguchi,
   Takeshi Tomochika, Tina Tsou, Tomohiro Fujisaki, Tomohiro Nishitani,
   Tomoya Yoshida, Wes George, Wesley Eddy, and Yasuhiro Shirasaki.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/9.%20%20References"></a><a class="selflink" href="#section-9" id="section-9">9</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/9.1.%20%20Normative%20References"></a><a class="selflink" href="#section-9.1" id="section-9.1">9.1</a>.  Normative References</span>

   [<a id="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="https://www.rfc-editor.org/bcp/bcp14">BCP 14</a>, <a href="./rfc2119">RFC 2119</a>, March 1997.

   [<a id="ref-RFC4008">RFC4008</a>]  Rohit, R., Srisuresh, P., Raghunarayan, R., Pai, N., and
              C. Wang, "Definitions of Managed Objects for Network
              Address Translators (NAT)", <a href="./rfc4008">RFC 4008</a>, March 2005.

   [<a id="ref-RFC4787">RFC4787</a>]  Audet, F. and C. Jennings, "Network Address Translation
              (NAT) Behavioral Requirements for Unicast UDP", <a href="https://www.rfc-editor.org/bcp/bcp127">BCP 127</a>,
              <a href="./rfc4787">RFC 4787</a>, January 2007.

   [<a id="ref-RFC5382">RFC5382</a>]  Guha, S., Biswas, K., Ford, B., Sivakumar, S., and P.
              Srisuresh, "NAT Behavioral Requirements for TCP", <a href="https://www.rfc-editor.org/bcp/bcp142">BCP 142</a>,
              <a href="./rfc5382">RFC 5382</a>, October 2008.






<span class="grey">Perreault, et al.         Best Current Practice                [Page 12]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-13"></span>
<span class="grey"><a href="./rfc6888">RFC 6888</a>                    CGN Requirements                  April 2013</span>


   [<a id="ref-RFC5508">RFC5508</a>]  Srisuresh, P., Ford, B., Sivakumar, S., and S. Guha, "NAT
              Behavioral Requirements for ICMP", <a href="https://www.rfc-editor.org/bcp/bcp148">BCP 148</a>, <a href="./rfc5508">RFC 5508</a>,
              April 2009.

   [<a id="ref-RFC5597">RFC5597</a>]  Denis-Courmont, R., "Network Address Translation (NAT)
              Behavioral Requirements for the Datagram Congestion
              Control Protocol", <a href="https://www.rfc-editor.org/bcp/bcp150">BCP 150</a>, <a href="./rfc5597">RFC 5597</a>, September 2009.

   [<a id="ref-RFC6887">RFC6887</a>]  Wing, D., Ed., Cheshire, S., Boucadair, M., Penno, R., and
              P.  Selkirk, "Port Control Protocol (PCP)", <a href="./rfc6887">RFC 6887</a>,
              April 2013.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/9.2.%20%20Informative%20Reference"></a><a class="selflink" href="#section-9.2" id="section-9.2">9.2</a>.  Informative Reference</span>

   [<a id="ref-RFC0793">RFC0793</a>]  Postel, J., "Transmission Control Protocol", STD 7, <a href="./rfc793">RFC</a>
              <a href="./rfc793">793</a>, September 1981.

   [<a id="ref-RFC1122">RFC1122</a>]  Braden, R., "Requirements for Internet Hosts -
              Communication Layers", STD 3, <a href="./rfc1122">RFC 1122</a>, October 1989.

   [<a id="ref-RFC2663">RFC2663</a>]  Srisuresh, P. and M. Holdrege, "IP Network Address
              Translator (NAT) Terminology and Considerations", <a href="./rfc2663">RFC</a>
              <a href="./rfc2663">2663</a>, August 1999.

   [<a id="ref-RFC2827">RFC2827</a>]  Ferguson, P. and D. Senie, "Network Ingress Filtering:
              Defeating Denial of Service Attacks which employ IP Source
              Address Spoofing", <a href="https://www.rfc-editor.org/bcp/bcp38">BCP 38</a>, <a href="./rfc2827">RFC 2827</a>, May 2000.

   [<a id="ref-RFC4963">RFC4963</a>]  Heffner, J., Mathis, M., and B. Chandler, "IPv4 Reassembly
              Errors at High Data Rates", <a href="./rfc4963">RFC 4963</a>, July 2007.

   [<a id="ref-RFC5461">RFC5461</a>]  Gont, F., "TCP's Reaction to Soft Errors", <a href="./rfc5461">RFC 5461</a>,
              February 2009.

   [<a id="ref-RFC6056">RFC6056</a>]  Larsen, M. and F. Gont, "Recommendations for Transport-
              Protocol Port Randomization", <a href="https://www.rfc-editor.org/bcp/bcp156">BCP 156</a>, <a href="./rfc6056">RFC 6056</a>, January
              2011.

   [<a id="ref-RFC6146">RFC6146</a>]  Bagnulo, M., Matthews, P., and I. van Beijnum, "Stateful
              NAT64: Network Address and Protocol Translation from IPv6
              Clients to IPv4 Servers", <a href="./rfc6146">RFC 6146</a>, April 2011.

   [<a id="ref-RFC6264">RFC6264</a>]  Jiang, S., Guo, D., and B. Carpenter, "An Incremental
              Carrier-Grade NAT (CGN) for IPv6 Transition", <a href="./rfc6264">RFC 6264</a>,
              June 2011.






<span class="grey">Perreault, et al.         Best Current Practice                [Page 13]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-14"></span>
<span class="grey"><a href="./rfc6888">RFC 6888</a>                    CGN Requirements                  April 2013</span>


   [<a id="ref-RFC6269">RFC6269</a>]  Ford, M., Boucadair, M., Durand, A., Levis, P., and P.
              Roberts, "Issues with IP Address Sharing", <a href="./rfc6269">RFC 6269</a>, June
              2011.

   [<a id="ref-RFC6302">RFC6302</a>]  Durand, A., Gashinsky, I., Lee, D., and S. Sheppard,
              "Logging Recommendations for Internet-Facing Servers", <a href="https://www.rfc-editor.org/bcp/bcp162">BCP</a>
              <a href="https://www.rfc-editor.org/bcp/bcp162">162</a>, <a href="./rfc6302">RFC 6302</a>, June 2011.

   [<a id="ref-RFC6333">RFC6333</a>]  Durand, A., Droms, R., Woodyatt, J., and Y. Lee, "Dual-
              Stack Lite Broadband Deployments Following IPv4
              Exhaustion", <a href="./rfc6333">RFC 6333</a>, August 2011.

   [<a id="ref-NAT-MIB">NAT-MIB</a>]  Perreault, S., Tsou, T., and S. Sivakumar, "Additional
              Managed Objects for Network Address Translators (NAT)",
              Work in Progress, February 2013.

   [<a id="ref-NAT-REVEAL">NAT-REVEAL</a>]
              Boucadair, M., Touch, J., Levis, P., and R. Penno,
              "Analysis of Solution Candidates to Reveal a Host
              Identifier (HOST_ID) in Shared Address Deployments", Work
              in Progress, April 2013.

   [<a id="ref-NAT444">NAT444</a>]   Donley, C., Ed., Howard, L., Kuarsingh, V., Berg, J., and
              J. Doshi, "Assessing the Impact of Carrier-Grade NAT on
              Network Applications", Work in Progress, April 2013.

   [<a id="ref-BITTORRENT">BITTORRENT</a>]
              Boucadair, M., Zheng, T., Deng, X., and J. Queiroz,
              "Behavior of BitTorrent service in PCP-enabled networks
              with Address Sharing", Work in Progress, May 2012.

Authors' Addresses

   Simon Perreault (editor)
   Viagenie
   246 Aberdeen
   Quebec, QC  G1R 2E1
   Canada

   Phone: +1 418 656 9254
   EMail: simon.perreault@viagenie.ca
   URI:   <a href="http://www.viagenie.ca">http://www.viagenie.ca</a>









<span class="grey">Perreault, et al.         Best Current Practice                [Page 14]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-15"></span>
<span class="grey"><a href="./rfc6888">RFC 6888</a>                    CGN Requirements                  April 2013</span>


   Ikuhei Yamagata
   NTT Communications Corporation
   Gran Park Tower 17F, 3-4-1 Shibaura, Minato-ku
   Tokyo  108-8118
   Japan

   Phone: +81 50 3812 4704
   EMail: ikuhei@nttv6.jp


   Shin Miyakawa
   NTT Communications Corporation
   Gran Park Tower 17F, 3-4-1 Shibaura, Minato-ku
   Tokyo  108-8118
   Japan

   Phone: +81 50 3812 4695
   EMail: miyakawa@nttv6.jp


   Akira Nakagawa
   Japan Internet Exchange Co., Ltd. (JPIX)
   Otemachi Building 21F, 1-8-1 Otemachi, Chiyoda-ku
   Tokyo  100-0004
   Japan

   Phone: +81 90 9242 2717
   EMail: a-nakagawa@jpix.ad.jp


   Hiroyuki Ashida
   Cisco Systems
   Midtown Tower, 9-7-1, Akasaka
   Minato-Ku, Tokyo  107-6227
   Japan

   EMail: hiashida@cisco.com














Perreault, et al.         Best Current Practice                [Page 15]
</pre>
</body></html>