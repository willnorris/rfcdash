<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 8666: OSPFv3 Extensions for Segment Routing</title>
<meta content="Peter Psenak" name="author"/>
<meta content="Stefano Previdi" name="author"/>
<meta content='
       Segment Routing (SR) allows a flexible definition of end-to-end
      paths within IGP topologies by encoding paths as sequences of
      topological subpaths called "segments". These segments are advertised
      by the link-state routing protocols (IS-IS and OSPF). 
       This document describes the OSPFv3 extensions required for Segment Routing
      with the MPLS data plane. 
    ' name="description"/>
<meta content="xml2rfc 2.35.0" name="generator"/>
<meta content="MPLS, SID, IGP, OSPF, Label advertisement, Segment Routing" name="keyword"/>
<meta content="8666" name="rfc.number"/>
<link href="rfc8666.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Avoid wrapping of URLs in references */
@media screen {
  .references a {
    white-space: nowrap;
  }
}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin: 0 0 0.25em 0;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .sourcecode {
    margin-bottom: 1em;
  }
}</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://dx.doi.org/10.17487/rfc8666" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <link href="https://datatracker.ietf.org/doc/draft-ietf-ospf-ospfv3-segment-routing-extensions-23" rel="prev"/>
  </head>
<body>
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 8666</td>
<td class="center">OSPFv3 Extensions for Segment Routing</td>
<td class="right">December 2019</td>
</tr></thead>
<tfoot><tr>
<td class="left">Psenak &amp; Previdi</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc8666">8666</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2019-12">December 2019</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">P. Psenak, <span class="editor">Ed.</span>
</div>
<div class="org">Cisco Systems, Inc.</div>
</div>
<div class="author">
      <div class="author-name">S. Previdi, <span class="editor">Ed.</span>
</div>
<div class="org">Cisco Systems, Inc.</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 8666</h1>
<h1 id="title">OSPFv3 Extensions for Segment Routing</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">Segment Routing (SR) allows a flexible definition of end-to-end
      paths within IGP topologies by encoding paths as sequences of
      topological subpaths called "segments". These segments are advertised
      by the link-state routing protocols (IS-IS and OSPF).<a class="pilcrow" href="#section-abstract-1">¶</a></p>
<p id="section-abstract-2">This document describes the OSPFv3 extensions required for Segment Routing
      with the MPLS data plane.<a class="pilcrow" href="#section-abstract-2">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a class="pilcrow" href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc8666">https://www.rfc-editor.org/info/rfc8666</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2019 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">▲</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a class="xref" href="#section-1">1</a>.  <a class="xref" href="#name-introduction">Introduction</a><a class="pilcrow" href="#section-toc.1-1.1.1">¶</a></p>
</li>
          <li class="toc ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a class="xref" href="#section-2">2</a>.  <a class="xref" href="#name-terminology">Terminology</a><a class="pilcrow" href="#section-toc.1-1.2.1">¶</a></p>
</li>
          <li class="toc ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a class="xref" href="#section-3">3</a>.  <a class="xref" href="#name-segment-routing-identifiers">Segment Routing Identifiers</a><a class="pilcrow" href="#section-toc.1-1.3.1">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a class="xref" href="#section-3.1">3.1</a>.  <a class="xref" href="#name-sid-label-sub-tlv">SID/Label Sub-TLV</a><a class="pilcrow" href="#section-toc.1-1.3.2.1.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="xref" href="#section-4">4</a>.  <a class="xref" href="#name-segment-routing-capabilitie">Segment Routing Capabilities</a><a class="pilcrow" href="#section-toc.1-1.4.1">¶</a></p>
</li>
          <li class="toc ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="xref" href="#section-5">5</a>.  <a class="xref" href="#name-ospfv3-extended-prefix-rang">OSPFv3 Extended Prefix Range TLV</a><a class="pilcrow" href="#section-toc.1-1.5.1">¶</a></p>
</li>
          <li class="toc ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="xref" href="#section-6">6</a>.  <a class="xref" href="#name-prefix-sid-sub-tlv">Prefix-SID Sub-TLV</a><a class="pilcrow" href="#section-toc.1-1.6.1">¶</a></p>
</li>
          <li class="toc ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="xref" href="#section-7">7</a>.  <a class="xref" href="#name-adjacency-segment-identifie">Adjacency Segment Identifier (Adj-SID)</a><a class="pilcrow" href="#section-toc.1-1.7.1">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a class="xref" href="#section-7.1">7.1</a>.  <a class="xref" href="#name-adj-sid-sub-tlv">Adj-SID Sub-TLV</a><a class="pilcrow" href="#section-toc.1-1.7.2.1.1">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a class="xref" href="#section-7.2">7.2</a>.  <a class="xref" href="#name-lan-adj-sid-sub-tlv">LAN Adj-SID Sub-TLV</a><a class="pilcrow" href="#section-toc.1-1.7.2.2.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="xref" href="#section-8">8</a>.  <a class="xref" href="#name-elements-of-procedure">Elements of Procedure</a><a class="pilcrow" href="#section-toc.1-1.8.1">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a class="xref" href="#section-8.1">8.1</a>.  <a class="xref" href="#name-intra-area-segment-routing-">Intra-area Segment Routing in OSPFv3</a><a class="pilcrow" href="#section-toc.1-1.8.2.1.1">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a class="xref" href="#section-8.2">8.2</a>.  <a class="xref" href="#name-inter-area-segment-routing-">Inter-area Segment Routing in OSPFv3</a><a class="pilcrow" href="#section-toc.1-1.8.2.2.1">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a class="xref" href="#section-8.3">8.3</a>.  <a class="xref" href="#name-segment-routing-for-externa">Segment Routing for External Prefixes</a><a class="pilcrow" href="#section-toc.1-1.8.2.3.1">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-toc.1-1.8.2.4">
                <p id="section-toc.1-1.8.2.4.1"><a class="xref" href="#section-8.4">8.4</a>.  <a class="xref" href="#name-advertisement-of-adj-sid">Advertisement of Adj-SID</a><a class="pilcrow" href="#section-toc.1-1.8.2.4.1">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.8.2.4.2.1">
                    <p id="section-toc.1-1.8.2.4.2.1.1"><a class="xref" href="#section-8.4.1">8.4.1</a>.  <a class="xref" href="#name-advertisement-of-adj-sid-on">Advertisement of Adj-SID on Point-to-Point Links</a><a class="pilcrow" href="#section-toc.1-1.8.2.4.2.1.1">¶</a></p>
</li>
                  <li class="toc ulEmpty" id="section-toc.1-1.8.2.4.2.2">
                    <p id="section-toc.1-1.8.2.4.2.2.1"><a class="xref" href="#section-8.4.2">8.4.2</a>.  <a class="xref" href="#name-adjacency-sid-on-broadcast-">Adjacency SID on Broadcast or NBMA Interfaces</a><a class="pilcrow" href="#section-toc.1-1.8.2.4.2.2.1">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="toc ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="xref" href="#section-9">9</a>.  <a class="xref" href="#name-iana-considerations">IANA Considerations</a><a class="pilcrow" href="#section-toc.1-1.9.1">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a class="xref" href="#section-9.1">9.1</a>.  <a class="xref" href="#name-ospfv3-extended-lsa-tlvs-re">"OSPFv3 Extended-LSA TLVs" Registry</a><a class="pilcrow" href="#section-toc.1-1.9.2.1.1">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a class="xref" href="#section-9.2">9.2</a>.  <a class="xref" href="#name-ospfv3-extended-lsa-sub-tlv">"OSPFv3 Extended-LSA Sub-TLVs" Registry</a><a class="pilcrow" href="#section-toc.1-1.9.2.2.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a class="xref" href="#section-10">10</a>. <span><a class="xref" href="#name-tlv-sub-tlv-error-handling">TLV/Sub-TLV Error Handling                                                                                            
</a> (<a class="xref" href="#name-tlv-sub-tlv-error-handling">TLV/Sub-TLV Error Handling</a>)</span><a class="pilcrow" href="#section-toc.1-1.10.1">¶</a></p>
</li>
          <li class="toc ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a class="xref" href="#section-11">11</a>. <a class="xref" href="#name-security-considerations">Security Considerations</a><a class="pilcrow" href="#section-toc.1-1.11.1">¶</a></p>
</li>
          <li class="toc ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a class="xref" href="#section-12">12</a>. <a class="xref" href="#name-references">References</a><a class="pilcrow" href="#section-toc.1-1.12.1">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a class="xref" href="#section-12.1">12.1</a>.  <a class="xref" href="#name-normative-references">Normative References</a><a class="pilcrow" href="#section-toc.1-1.12.2.1.1">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a class="xref" href="#section-12.2">12.2</a>.  <a class="xref" href="#name-informative-references">Informative References</a><a class="pilcrow" href="#section-toc.1-1.12.2.2.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a class="xref" href="#section-appendix.a"></a><a class="xref" href="#name-contributors">Contributors</a><a class="pilcrow" href="#section-toc.1-1.13.1">¶</a></p>
</li>
          <li class="toc ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a class="xref" href="#section-appendix.b"></a><a class="xref" href="#name-authors-addresses">Authors' Addresses</a><a class="pilcrow" href="#section-toc.1-1.14.1">¶</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">Segment Routing (SR) allows a flexible definition of end-to-end paths
      within IGP topologies by encoding paths as sequences of topological
      subpaths called "segments". These segments are advertised by the
      link-state routing protocols (IS-IS and OSPF). Prefix segments represent
      an ECMP-aware shortest path to a prefix (or a node) as per the state of
      the IGP topology. Adjacency segments represent a hop over a specific
      adjacency between two nodes in the IGP. A prefix segment is typically a
      multi-hop path while an adjacency segment, in most cases, is a one-hop
      path. SR's control plane can be applied to both IPv6 and MPLS data
      planes, and it does not require any additional signaling (other than IGP
      extensions). The IPv6 data plane is out of the scope of this
      specification; the OSPFv3 extension for SR with the IPv6 data plane will be
      specified in a separate document.  When used in MPLS networks, SR paths
      do not require any LDP or RSVP-TE signaling.  However, SR can
      interoperate in the presence of Label Switched Paths (LSPs) established with RSVP or LDP.<a class="pilcrow" href="#section-1-1">¶</a></p>
<p id="section-1-2">This document describes the OSPFv3 extensions required for Segment
      Routing with the MPLS data plane.<a class="pilcrow" href="#section-1-2">¶</a></p>
<p id="section-1-3">Segment Routing architecture is described in <span>[<a class="xref" href="#RFC8402">RFC8402</a>]</span>.<a class="pilcrow" href="#section-1-3">¶</a></p>
<p id="section-1-4">Segment Routing use cases are described in <span>[<a class="xref" href="#RFC7855">RFC7855</a>]</span>.<a class="pilcrow" href="#section-1-4">¶</a></p>
</section>
<section id="section-2">
      <h2 id="name-terminology">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-terminology">Terminology</a>
      </h2>
<p id="section-2-1">This section lists some of the terminology used in this document:<a class="pilcrow" href="#section-2-1">¶</a></p>
<dl class="dlParallel" id="section-2-2">
        <dt id="section-2-2.1">ABR:</dt>
        <dd id="section-2-2.2" style="margin-left: 6.0em">Area Border Router<a class="pilcrow" href="#section-2-2.2">¶</a>
</dd>
<dt id="section-2-2.3">Adj-SID:</dt>
        <dd id="section-2-2.4" style="margin-left: 6.0em">Adjacency Segment Identifier<a class="pilcrow" href="#section-2-2.4">¶</a>
</dd>
<dt id="section-2-2.5">AS:</dt>
        <dd id="section-2-2.6" style="margin-left: 6.0em">Autonomous System<a class="pilcrow" href="#section-2-2.6">¶</a>
</dd>
<dt id="section-2-2.7">ASBR:</dt>
        <dd id="section-2-2.8" style="margin-left: 6.0em">Autonomous System Boundary Router<a class="pilcrow" href="#section-2-2.8">¶</a>
</dd>
<dt id="section-2-2.9">DR:</dt>
        <dd id="section-2-2.10" style="margin-left: 6.0em">Designated Router<a class="pilcrow" href="#section-2-2.10">¶</a>
</dd>
<dt id="section-2-2.11">IS-IS:</dt>
        <dd id="section-2-2.12" style="margin-left: 6.0em">Intermediate System to Intermediate System<a class="pilcrow" href="#section-2-2.12">¶</a>
</dd>
<dt id="section-2-2.13">LDP:</dt>
        <dd id="section-2-2.14" style="margin-left: 6.0em">Label Distribution Protocol<a class="pilcrow" href="#section-2-2.14">¶</a>
</dd>
<dt id="section-2-2.15">LSP:</dt>
        <dd id="section-2-2.16" style="margin-left: 6.0em">Label Switched Path<a class="pilcrow" href="#section-2-2.16">¶</a>
</dd>
<dt id="section-2-2.17">MPLS:</dt>
        <dd id="section-2-2.18" style="margin-left: 6.0em">Multiprotocol Label Switching<a class="pilcrow" href="#section-2-2.18">¶</a>
</dd>
<dt id="section-2-2.19">OSPF:</dt>
        <dd id="section-2-2.20" style="margin-left: 6.0em">Open Shortest Path First<a class="pilcrow" href="#section-2-2.20">¶</a>
</dd>
<dt id="section-2-2.21">SPF:</dt>
        <dd id="section-2-2.22" style="margin-left: 6.0em">Shortest Path First<a class="pilcrow" href="#section-2-2.22">¶</a>
</dd>
<dt id="section-2-2.23">RSVP:</dt>
        <dd id="section-2-2.24" style="margin-left: 6.0em">Resource Reservation Protocol<a class="pilcrow" href="#section-2-2.24">¶</a>
</dd>
<dt id="section-2-2.25">SID:</dt>
        <dd id="section-2-2.26" style="margin-left: 6.0em">Segment Identifier<a class="pilcrow" href="#section-2-2.26">¶</a>
</dd>
<dt id="section-2-2.27">SR:</dt>
        <dd id="section-2-2.28" style="margin-left: 6.0em">Segment Routing<a class="pilcrow" href="#section-2-2.28">¶</a>
</dd>
<dt id="section-2-2.29">SRGB:</dt>
        <dd id="section-2-2.30" style="margin-left: 6.0em">Segment Routing Global Block<a class="pilcrow" href="#section-2-2.30">¶</a>
</dd>
<dt id="section-2-2.31">SRLB:</dt>
        <dd id="section-2-2.32" style="margin-left: 6.0em">Segment Routing Local Block<a class="pilcrow" href="#section-2-2.32">¶</a>
</dd>
<dt id="section-2-2.33">SRMS:</dt>
        <dd id="section-2-2.34" style="margin-left: 6.0em">Segment Routing Mapping Server<a class="pilcrow" href="#section-2-2.34">¶</a>
</dd>
<dt id="section-2-2.35">TLV:</dt>
        <dd id="section-2-2.36" style="margin-left: 6.0em">Type Length Value<a class="pilcrow" href="#section-2-2.36">¶</a>
</dd>
</dl>
<p id="section-2-3">
    The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
    "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
    described in BCP 14 <span>[<a class="xref" href="#RFC2119">RFC2119</a>]</span> <span>[<a class="xref" href="#RFC8174">RFC8174</a>]</span> 
    when, and only when, they appear in all capitals, as shown here.<a class="pilcrow" href="#section-2-3">¶</a></p>
</section>
<section id="section-3">
      <h2 id="name-segment-routing-identifiers">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-segment-routing-identifiers">Segment Routing Identifiers</a>
      </h2>
<p id="section-3-1">Segment Routing defines various types of Segment Identifiers (SIDs):
      Prefix-SID, Adjacency SID, and LAN Adjacency SID.<a class="pilcrow" href="#section-3-1">¶</a></p>
<div id="SIDLABEL">
<section id="section-3.1">
        <h3 id="name-sid-label-sub-tlv">
<a class="section-number selfRef" href="#section-3.1">3.1. </a><a class="section-name selfRef" href="#name-sid-label-sub-tlv">SID/Label Sub-TLV</a>
        </h3>
<p id="section-3.1-1">The SID/Label sub-TLV appears in multiple TLVs or sub-TLVs defined
        later in this document. It is used to advertise the SID or label
        associated with a prefix or adjacency. The SID/Label sub-TLV has the following
        format:<a class="pilcrow" href="#section-3.1-1">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.1-2">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|              Type             |             Length            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                      SID/Label (variable)                     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</pre><a class="pilcrow" href="#section-3.1-2">¶</a>
</div>
<p id="section-3.1-3">where:<a class="pilcrow" href="#section-3.1-3">¶</a></p>
<ul class="ulEmpty">
<li class="ulEmpty" id="section-3.1-4.1">
            <dl class="dlParallel" id="section-3.1-4.1.1">
              <dt id="section-3.1-4.1.1.1">Type:</dt>
              <dd id="section-3.1-4.1.1.2">7<a class="pilcrow" href="#section-3.1-4.1.1.2">¶</a>
</dd>
<dt id="section-3.1-4.1.1.3">Length:</dt>
              <dd id="section-3.1-4.1.1.4">3 or 4 octets.<a class="pilcrow" href="#section-3.1-4.1.1.4">¶</a>
</dd>
<dt id="section-3.1-4.1.1.5">SID/Label:</dt>
              <dd id="section-3.1-4.1.1.6">If the length is set to 3, then the 20 rightmost bits
            represent a label. If the length is set to 4, then the value represents
            a 32-bit SID.<a class="pilcrow" href="#section-3.1-4.1.1.6">¶</a>
</dd>
</dl>
</li>
        </ul>
</section>
</div>
</section>
<div id="SRCAP">
<section id="section-4">
      <h2 id="name-segment-routing-capabilitie">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-segment-routing-capabilitie">Segment Routing Capabilities</a>
      </h2>
<p id="section-4-1">Segment Routing requires some additional router capabilities to be advertised to 
      other routers in the area.<a class="pilcrow" href="#section-4-1">¶</a></p>
<p id="section-4-2">These SR capabilities are advertised in the OSPFv3 Router Information Opaque LSA 
      (defined in <span>[<a class="xref" href="#RFC7770">RFC7770</a>]</span>) and specified in 
      <span>[<a class="xref" href="#RFC8665">RFC8665</a>]</span>.<a class="pilcrow" href="#section-4-2">¶</a></p>
</section>
</div>
<div id="PFXRANGE">
<section id="section-5">
      <h2 id="name-ospfv3-extended-prefix-rang">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-ospfv3-extended-prefix-rang">OSPFv3 Extended Prefix Range TLV</a>
      </h2>
<p id="section-5-1">In some cases, it is useful to advertise attributes for a range of
      prefixes in a single advertisement. The SR Mapping Server, 
      which is described in <span>[<a class="xref" href="#RFC8661">RFC8661</a>]</span>,
      is an example of where SIDs for multiple prefixes can be advertised. To
      optimize such advertisement in case of multiple prefixes from a
      contiguous address range, OSPFv3 Extended Prefix Range TLV is defined.<a class="pilcrow" href="#section-5-1">¶</a></p>
<p id="section-5-2">The OSPFv3 Extended Prefix Range TLV is a top-level TLV of the following LSAs
      defined in <span>[<a class="xref" href="#RFC8362">RFC8362</a>]</span>:<a class="pilcrow" href="#section-5-2">¶</a></p>
<ul class="ulEmpty">
<li class="ulEmpty" id="section-5-3.1">E-Intra-Area-Prefix-LSA<a class="pilcrow" href="#section-5-3.1">¶</a>
</li>
        <li class="ulEmpty" id="section-5-3.2">E-Inter-Area-Prefix-LSA<a class="pilcrow" href="#section-5-3.2">¶</a>
</li>
        <li class="ulEmpty" id="section-5-3.3">E-AS-External-LSA<a class="pilcrow" href="#section-5-3.3">¶</a>
</li>
        <li class="ulEmpty" id="section-5-3.4">E-Type-7-LSA<a class="pilcrow" href="#section-5-3.4">¶</a>
</li>
      </ul>
<p id="section-5-4">Multiple OSPFv3 Extended Prefix Range TLVs <span class="bcp14">MAY</span> be advertised in each LSA mentioned 
      above. The OSPFv3 Extended Prefix Range TLV has the following
      format:<a class="pilcrow" href="#section-5-4">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5-5">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|              Type             |             Length            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Prefix Length |       AF      |         Range Size            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|    Flags      |                 Reserved                      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                     Address Prefix (variable)                 |
|                           ...                                 |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                      Sub-TLVs (variable)                      |
+-                                                             -+
|                                                               |</pre><a class="pilcrow" href="#section-5-5">¶</a>
</div>
<p id="section-5-6">where:<a class="pilcrow" href="#section-5-6">¶</a></p>
<ul class="ulEmpty">
<li class="ulEmpty" id="section-5-7.1">
          <dl class="dlParallel" id="section-5-7.1.1">
            <dt id="section-5-7.1.1.1">Type:</dt>
            <dd id="section-5-7.1.1.2">9<a class="pilcrow" href="#section-5-7.1.1.2">¶</a>
</dd>
<dt id="section-5-7.1.1.3">Length:</dt>
            <dd id="section-5-7.1.1.4">Variable, in octets, depending on the sub-TLVs.<a class="pilcrow" href="#section-5-7.1.1.4">¶</a>
</dd>
<dt id="section-5-7.1.1.5">Prefix Length:</dt>
            <dd id="section-5-7.1.1.6">Length of prefix in bits.<a class="pilcrow" href="#section-5-7.1.1.6">¶</a>
</dd>
<dt id="section-5-7.1.1.7">AF:</dt>
            <dd id="section-5-7.1.1.8">
              <p id="section-5-7.1.1.8.1">Address family for the prefix.<a class="pilcrow" href="#section-5-7.1.1.8.1">¶</a></p>
<dl class="dlParallel" id="section-5-7.1.1.8.2">
                <dt id="section-5-7.1.1.8.2.1">AF:</dt>
                <dd id="section-5-7.1.1.8.2.2">0 - IPv4 unicast<a class="pilcrow" href="#section-5-7.1.1.8.2.2">¶</a>
</dd>
<dt id="section-5-7.1.1.8.2.3">AF:</dt>
                <dd id="section-5-7.1.1.8.2.4">1 - IPv6 unicast<a class="pilcrow" href="#section-5-7.1.1.8.2.4">¶</a>
</dd>
</dl>
</dd>
<dt id="section-5-7.1.1.9">Range Size:</dt>
            <dd id="section-5-7.1.1.10">
              <p id="section-5-7.1.1.10.1">Represents the number of prefixes that are covered by the
            advertisement. The Range Size <span class="bcp14">MUST NOT</span> exceed the number of 
 prefixes that could be satisfied by the Prefix Length without 
 including:<a class="pilcrow" href="#section-5-7.1.1.10.1">¶</a></p>
<ul class="ulEmpty">
<li class="ulEmpty" id="section-5-7.1.1.10.2.1">Addresses from the IPv4 multicast address range (224.0.0.0/3), if the 
             AF is IPv4 unicast.<a class="pilcrow" href="#section-5-7.1.1.10.2.1">¶</a>
</li>
                <li class="ulEmpty" id="section-5-7.1.1.10.2.2">Addresses other than the IPv6 unicast addresses, if the
             AF is IPv6 unicast.<a class="pilcrow" href="#section-5-7.1.1.10.2.2">¶</a>
</li>
              </ul>
</dd>
<dt id="section-5-7.1.1.11">Flags:</dt>
            <dd id="section-5-7.1.1.12">Reserved. <span class="bcp14">MUST</span> be zero when sent and are ignored when received.<a class="pilcrow" href="#section-5-7.1.1.12">¶</a>
</dd>
<dt id="section-5-7.1.1.13">Reserved:</dt>
            <dd id="section-5-7.1.1.14">
              <span class="bcp14">SHOULD</span> be set to 0 on transmission and <span class="bcp14">MUST</span> be ignored on reception.<a class="pilcrow" href="#section-5-7.1.1.14">¶</a>
</dd>
<dt id="section-5-7.1.1.15">Address Prefix:</dt>
            <dd id="section-5-7.1.1.16">
              <ul class="ulEmpty">
<li class="ulEmpty" id="section-5-7.1.1.16.1.1">For the address family IPv4 unicast, the prefix itself is 
               encoded as a 32-bit value. The default route is represented by a prefix of 
               length 0.<a class="pilcrow" href="#section-5-7.1.1.16.1.1">¶</a>
</li>
                <li class="ulEmpty" id="section-5-7.1.1.16.1.2">For the address family IPv6 unicast, the prefix is encoded as an even
multiple of 32-bit words and padded with zeroed bits as necessary. This
encoding consumes ((PrefixLength + 31) / 32) 32-bit words.<a class="pilcrow" href="#section-5-7.1.1.16.1.2">¶</a>
</li>
                <li class="ulEmpty" id="section-5-7.1.1.16.1.3">Prefix encoding for other address families is beyond the scope of
               this specification. Prefix encoding for other address families can
               be defined in future Standards Track specifications from the IETF stream.<a class="pilcrow" href="#section-5-7.1.1.16.1.3">¶</a>
</li>
              </ul>
</dd>
</dl>
</li>
      </ul>
<p id="section-5-8">The range represents the contiguous set of prefixes with the same prefix length 
     as specified by the Prefix Length field. The set starts with the prefix that is 
     specified by the Address Prefix field. The number of prefixes in the range is equal 
     to the Range Size.<a class="pilcrow" href="#section-5-8">¶</a></p>
<p id="section-5-9">If the OSPFv3 Extended Prefix Range TLVs advertising the exact same range appears 
     in multiple LSAs of the same type, originated by the same OSPFv3 router, the LSA with
     the numerically smallest Instance ID <span class="bcp14">MUST</span> be used, and subsequent instances of the 
     OSPFv3 Extended Prefix Range TLVs <span class="bcp14">MUST</span> be ignored.<a class="pilcrow" href="#section-5-9">¶</a></p>
</section>
</div>
<div id="PREFIXSID">
<section id="section-6">
      <h2 id="name-prefix-sid-sub-tlv">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-prefix-sid-sub-tlv">Prefix-SID Sub-TLV</a>
      </h2>
<p id="section-6-1">The Prefix-SID sub-TLV is a sub-TLV of the following OSPFv3 TLVs as
        defined in <span>[<a class="xref" href="#RFC8362">RFC8362</a>]</span> and in <a class="xref" href="#PFXRANGE">Section 5</a>:<a class="pilcrow" href="#section-6-1">¶</a></p>
<ul class="ulEmpty">
<li class="ulEmpty" id="section-6-2.1">Intra-Area Prefix TLV<a class="pilcrow" href="#section-6-2.1">¶</a>
</li>
        <li class="ulEmpty" id="section-6-2.2">Inter-Area Prefix TLV<a class="pilcrow" href="#section-6-2.2">¶</a>
</li>
        <li class="ulEmpty" id="section-6-2.3">External Prefix TLV<a class="pilcrow" href="#section-6-2.3">¶</a>
</li>
        <li class="ulEmpty" id="section-6-2.4">OSPFv3 Extended Prefix Range TLV<a class="pilcrow" href="#section-6-2.4">¶</a>
</li>
      </ul>
<p id="section-6-3">It <span class="bcp14">MAY</span> appear more than once in the parent TLV and has the following format:<a class="pilcrow" href="#section-6-3">¶</a></p>
<div class="artwork art-text alignLeft" id="section-6-4">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|               Type            |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     Flags     |  Algorithm    |           Reserved            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       SID/Index/Label (variable)              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</pre><a class="pilcrow" href="#section-6-4">¶</a>
</div>
<p id="section-6-5">where:<a class="pilcrow" href="#section-6-5">¶</a></p>
<ul class="ulEmpty">
<li class="ulEmpty" id="section-6-6.1">
          <dl class="dlParallel" id="section-6-6.1.1">
            <dt id="section-6-6.1.1.1">Type:</dt>
            <dd id="section-6-6.1.1.2">4<a class="pilcrow" href="#section-6-6.1.1.2">¶</a>
</dd>
<dt id="section-6-6.1.1.3">Length:</dt>
            <dd id="section-6-6.1.1.4">7 or 8 octets, depending on the V-Flag.<a class="pilcrow" href="#section-6-6.1.1.4">¶</a>
</dd>
<dt id="section-6-6.1.1.5">Flags:</dt>
            <dd id="section-6-6.1.1.6">
              <p id="section-6-6.1.1.6.1">Single-octet field. The following flags are defined:<a class="pilcrow" href="#section-6-6.1.1.6.1">¶</a></p>
<div class="artwork art-text alignLeft" id="section-6-6.1.1.6.2">
<pre>                
  0  1  2  3  4  5  6  7 
+--+--+--+--+--+--+--+--+
|  |NP|M |E |V |L |  |  |
+--+--+--+--+--+--+--+--+</pre><a class="pilcrow" href="#section-6-6.1.1.6.2">¶</a>
</div>
<p id="section-6-6.1.1.6.3">where:<a class="pilcrow" href="#section-6-6.1.1.6.3">¶</a></p>
<dl class="dlParallel" id="section-6-6.1.1.6.4">
                <dt id="section-6-6.1.1.6.4.1">NP-Flag:</dt>
                <dd id="section-6-6.1.1.6.4.2">No-PHP (Penultimate Hop Popping) Flag. If set, then the penultimate hop <span class="bcp14">MUST NOT</span> pop the Prefix-SID before delivering packets to the
                node that advertised the Prefix-SID.<a class="pilcrow" href="#section-6-6.1.1.6.4.2">¶</a>
</dd>
<dt id="section-6-6.1.1.6.4.3">M-Flag:</dt>
                <dd id="section-6-6.1.1.6.4.4">Mapping Server Flag.  If set, the SID was advertised
                by an SR Mapping Server as described in 
                <span>[<a class="xref" href="#RFC8661">RFC8661</a>]</span>.<a class="pilcrow" href="#section-6-6.1.1.6.4.4">¶</a>
</dd>
<dt id="section-6-6.1.1.6.4.5">E-Flag:</dt>
                <dd id="section-6-6.1.1.6.4.6">Explicit Null Flag. If set, any upstream neighbor 
                of the Prefix-SID originator <span class="bcp14">MUST</span> replace the Prefix-SID with 
                the Explicit NULL label (0 for IPv4, 2 for IPv6) before forwarding the packet.<a class="pilcrow" href="#section-6-6.1.1.6.4.6">¶</a>
</dd>
<dt id="section-6-6.1.1.6.4.7">V-Flag:</dt>
                <dd id="section-6-6.1.1.6.4.8">Value/Index Flag. If set, then the Prefix-SID 
                carries an absolute value. If not set, then the Prefix-SID carries 
                an index.<a class="pilcrow" href="#section-6-6.1.1.6.4.8">¶</a>
</dd>
<dt id="section-6-6.1.1.6.4.9">L-Flag:</dt>
                <dd id="section-6-6.1.1.6.4.10">Local/Global Flag. If set, then the value/index 
                carried by the Prefix-SID has local significance. If not set, then
                the value/index carried by this sub-TLV has global significance.<a class="pilcrow" href="#section-6-6.1.1.6.4.10">¶</a>
</dd>
<dt id="section-6-6.1.1.6.4.11">Other bits:</dt>
                <dd id="section-6-6.1.1.6.4.12">Reserved. These <span class="bcp14">MUST</span> be zero when sent and are ignored when
                received.<a class="pilcrow" href="#section-6-6.1.1.6.4.12">¶</a>
</dd>
</dl>
</dd>
<dt id="section-6-6.1.1.7">Reserved:</dt>
            <dd id="section-6-6.1.1.8">
              <span class="bcp14">SHOULD</span> be set to 0 on transmission and <span class="bcp14">MUST</span> be ignored on reception.<a class="pilcrow" href="#section-6-6.1.1.8">¶</a>
</dd>
<dt id="section-6-6.1.1.9">Algorithm:</dt>
            <dd id="section-6-6.1.1.10">
              <p id="section-6-6.1.1.10.1">Single octet identifying the algorithm the Prefix-SID
            is associated with as defined in the IGP Algorithm Types registry 
            <span>[<a class="xref" href="#ALGOREG">ALGOREG</a>]</span>.<a class="pilcrow" href="#section-6-6.1.1.10.1">¶</a></p>
<p id="section-6-6.1.1.10.2">A router receiving a Prefix-SID from a remote node and with an algorithm 
            value that the remote node has not advertised in the SR-Algorithm TLV
            <span>[<a class="xref" href="#RFC8665">RFC8665</a>]</span> <span class="bcp14">MUST</span> ignore the 
            Prefix-SID sub-TLV.<a class="pilcrow" href="#section-6-6.1.1.10.2">¶</a></p>
</dd>
<dt id="section-6-6.1.1.11">SID/Index/Label:</dt>
            <dd id="section-6-6.1.1.12">
              <p id="section-6-6.1.1.12.1">According to the V-Flag and L-Flag, it contains:<a class="pilcrow" href="#section-6-6.1.1.12.1">¶</a></p>
<ul class="ulEmpty">
<li class="ulEmpty" id="section-6-6.1.1.12.2.1">V-Flag is set to 0 and L-Flag is set to 0: The SID/Index/Label
            field is a 4-octet index defining the offset in the SID/Label
            space advertised by this router.<a class="pilcrow" href="#section-6-6.1.1.12.2.1">¶</a>
</li>
                <li class="ulEmpty" id="section-6-6.1.1.12.2.2">V-Flag is set to 1 and L-Flag is set to 1: The SID/Index/Label
            field is a 3-octet local label where the 20 rightmost bits are
            used for encoding the label value.<a class="pilcrow" href="#section-6-6.1.1.12.2.2">¶</a>
</li>
                <li class="ulEmpty" id="section-6-6.1.1.12.2.3">All other combinations of V-Flag and L-Flag are invalid and
            any SID Advertisement received with an invalid setting for V- and
            L-Flags <span class="bcp14">MUST</span> be ignored.<a class="pilcrow" href="#section-6-6.1.1.12.2.3">¶</a>
</li>
              </ul>
</dd>
</dl>
</li>
      </ul>
<p id="section-6-7">If an OSPFv3 router advertises multiple Prefix-SIDs for the same prefix,
        topology, and algorithm, all of them <span class="bcp14">MUST</span> be ignored.<a class="pilcrow" href="#section-6-7">¶</a></p>
<p id="section-6-8">When calculating the outgoing label for the prefix, the router <span class="bcp14">MUST</span>
        take into account, as described below, the E-, NP-, and M-Flags advertised by the 
        next-hop router if that router advertised the SID for the prefix.  This <span class="bcp14">MUST</span> be done
        regardless of whether the next-hop router contributes to the best path to the
        prefix.<a class="pilcrow" href="#section-6-8">¶</a></p>
<p id="section-6-9">The NP-Flag (No-PHP) <span class="bcp14">MUST</span> be set and the E-Flag <span class="bcp14">MUST</span> be clear for Prefix-SIDs 
        allocated to prefixes that are propagated between areas by an ABR based on 
        intra-area or inter-area reachability, unless the advertised prefix is directly 
        attached to such ABR.<a class="pilcrow" href="#section-6-9">¶</a></p>
<p id="section-6-10">The NP-Flag (No-PHP) <span class="bcp14">MUST</span> be set and the E-Flag <span class="bcp14">MUST</span> be clear for Prefix-SIDs 
        allocated to redistributed prefixes, unless the redistributed prefix is directly
        attached to the advertising ASBR.<a class="pilcrow" href="#section-6-10">¶</a></p>
<p id="section-6-11">If the NP-Flag is not set, then:<a class="pilcrow" href="#section-6-11">¶</a></p>
<ul class="ulEmpty">
<li class="ulEmpty" id="section-6-12.1">Any upstream neighbor of the Prefix-SID
        originator <span class="bcp14">MUST</span> pop the Prefix-SID. This is equivalent to the
 penultimate hop-popping mechanism used in the MPLS data plane.<a class="pilcrow" href="#section-6-12.1">¶</a>
</li>
        <li class="ulEmpty" id="section-6-12.2">The received E-Flag is ignored.<a class="pilcrow" href="#section-6-12.2">¶</a>
</li>
      </ul>
<p id="section-6-13">If the NP-Flag is set and the E-Flag is not set, then:<a class="pilcrow" href="#section-6-13">¶</a></p>
<ul class="ulEmpty">
<li class="ulEmpty" id="section-6-14.1">Any upstream neighbor of the Prefix-SID originator <span class="bcp14">MUST</span> keep the
        Prefix-SID on top of the stack.  This is useful when the originator of
        the Prefix-SID needs to stitch the incoming packet into a continuing
        MPLS LSP to the final destination.  This could occur at an ABR (prefix
        propagation from one area to another) or at an ASBR (prefix
        propagation from one domain to another).<a class="pilcrow" href="#section-6-14.1">¶</a>
</li>
      </ul>
<p id="section-6-15">If both the NP-Flag and E-Flag are set, then:<a class="pilcrow" href="#section-6-15">¶</a></p>
<ul class="ulEmpty">
<li class="ulEmpty" id="section-6-16.1">Any upstream neighbor of the Prefix-SID originator 
         <span class="bcp14">MUST</span> replace the Prefix-SID with an Explicit NULL label. This
         is useful, e.g., when the originator of the Prefix-SID is the final destination
         for the related prefix and the originator wishes to receive the packet with the 
         original Traffic Class field <span>[<a class="xref" href="#RFC5462">RFC5462</a>]</span>.<a class="pilcrow" href="#section-6-16.1">¶</a>
</li>
      </ul>
<p id="section-6-17">When the M-Flag is set, the NP-Flag and the E-Flag <span class="bcp14">MUST</span> be ignored on reception.<a class="pilcrow" href="#section-6-17">¶</a></p>
<p id="section-6-18">As the Mapping Server does not specify the originator of a prefix advertisement,
        it is not possible to determine PHP behavior solely based on the Mapping Server 
        Advertisement. However, PHP behavior <span class="bcp14">SHOULD</span> be done in the following cases:<a class="pilcrow" href="#section-6-18">¶</a></p>
<ul class="ulEmpty">
<li class="ulEmpty" id="section-6-19.1">The Prefix is intra-area type and the downstream neighbor is the originator 
         of the prefix.<a class="pilcrow" href="#section-6-19.1">¶</a>
</li>
        <li class="ulEmpty" id="section-6-19.2">The Prefix is inter-area type and the downstream neighbor is an ABR, which is 
         advertising prefix reachability and is setting the LA-bit in the Prefix 
         Options as described in <span>[<a class="xref" href="#RFC8362">RFC8362</a>]</span>.<a class="pilcrow" href="#section-6-19.2">¶</a>
</li>
        <li class="ulEmpty" id="section-6-19.3">The Prefix is external type and the downstream neighbor is an ASBR, which is 
         advertising prefix reachability and is setting the LA-bit in the Prefix 
         Options as described in <span>[<a class="xref" href="#RFC8362">RFC8362</a>]</span>.<a class="pilcrow" href="#section-6-19.3">¶</a>
</li>
      </ul>
<p id="section-6-20">When a Prefix-SID is advertised in the OSPFv3 Extended Prefix Range TLV, then
         the value advertised in the Prefix-SID sub-TLV is interpreted as a starting 
         SID/Label value.<a class="pilcrow" href="#section-6-20">¶</a></p>
<p id="section-6-21">Example 1: If the following router addresses (loopback addresses)
        need to be mapped into the corresponding Prefix-SID indexes:<a class="pilcrow" href="#section-6-21">¶</a></p>
<div class="artwork art-text alignLeft" id="section-6-22">
<pre>          Router-A: 2001:DB8::1/128, Prefix-SID: Index 1
          Router-B: 2001:DB8::2/128, Prefix-SID: Index 2
          Router-C: 2001:DB8::3/128, Prefix-SID: Index 3
          Router-D: 2001:DB8::4/128, Prefix-SID: Index 4</pre><a class="pilcrow" href="#section-6-22">¶</a>
</div>
<p id="section-6-23">then the Address Prefix field in the OSPFv3 Extended Prefix Range TLV would be set
        to 2001:DB8::1, the Prefix Length would be set to 128, the Range Size would be set to 4, and 
        the Index value in the Prefix-SID sub-TLV would be set to 1.<a class="pilcrow" href="#section-6-23">¶</a></p>
<p id="section-6-24">Example 2: If the following prefixes need to be mapped into the
        corresponding Prefix-SID indexes:<a class="pilcrow" href="#section-6-24">¶</a></p>
<div class="artwork art-text alignLeft" id="section-6-25">
<pre>          2001:DB8:1::0/120,   Prefix-SID: Index 51
          2001:DB8:1::100/120, Prefix-SID: Index 52
          2001:DB8:1::200/120, Prefix-SID: Index 53
          2001:DB8:1::300/120, Prefix-SID: Index 54
          2001:DB8:1::400/120, Prefix-SID: Index 55
          2001:DB8:1::500/120, Prefix-SID: Index 56
          2001:DB8:1::600/120, Prefix-SID: Index 57</pre><a class="pilcrow" href="#section-6-25">¶</a>
</div>
<p id="section-6-26">then the Prefix field in the OSPFv3 Extended Prefix Range TLV would be set 
        to 2001:DB8:1::0, the Prefix Length would be set to 120, the Range Size would be set to 7,
        and the Index value in the Prefix-SID sub-TLV would be set to 51.<a class="pilcrow" href="#section-6-26">¶</a></p>
</section>
</div>
<div id="ADJSID">
<section id="section-7">
      <h2 id="name-adjacency-segment-identifie">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-adjacency-segment-identifie">Adjacency Segment Identifier (Adj-SID)</a>
      </h2>
<p id="section-7-1">An Adjacency Segment Identifier (Adj-SID) represents a router
      adjacency in Segment Routing.<a class="pilcrow" href="#section-7-1">¶</a></p>
<div id="ADJSIDSUBTLV">
<section id="section-7.1">
        <h3 id="name-adj-sid-sub-tlv">
<a class="section-number selfRef" href="#section-7.1">7.1. </a><a class="section-name selfRef" href="#name-adj-sid-sub-tlv">Adj-SID Sub-TLV</a>
        </h3>
<p id="section-7.1-1">The Adj-SID sub-TLV is an optional sub-TLV of the Router-Link TLV as defined in 
        <span>[<a class="xref" href="#RFC8362">RFC8362</a>]</span>. It <span class="bcp14">MAY</span> appear multiple times
        in the Router-Link TLV. 
        
        The Adj-SID sub-TLV has the following format:<a class="pilcrow" href="#section-7.1-1">¶</a></p>
<div class="artwork art-text alignLeft" id="section-7.1-2">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|               Type            |              Length           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Flags         |     Weight    |             Reserved          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                   SID/Label/Index (variable)                  |
+---------------------------------------------------------------+</pre><a class="pilcrow" href="#section-7.1-2">¶</a>
</div>
<p id="section-7.1-3">where:<a class="pilcrow" href="#section-7.1-3">¶</a></p>
<ul class="ulEmpty">
<li class="ulEmpty" id="section-7.1-4.1">
            <dl class="dlParallel" id="section-7.1-4.1.1">
              <dt id="section-7.1-4.1.1.1">Type:</dt>
              <dd id="section-7.1-4.1.1.2">5<a class="pilcrow" href="#section-7.1-4.1.1.2">¶</a>
</dd>
<dt id="section-7.1-4.1.1.3">Length:</dt>
              <dd id="section-7.1-4.1.1.4">7 or 8 octets, depending on the V-Flag.<a class="pilcrow" href="#section-7.1-4.1.1.4">¶</a>
</dd>
<dt id="section-7.1-4.1.1.5">Flags:</dt>
              <dd id="section-7.1-4.1.1.6">
                <p id="section-7.1-4.1.1.6.1">Single-octet field containing the following flags:<a class="pilcrow" href="#section-7.1-4.1.1.6.1">¶</a></p>
<div class="artwork art-text alignLeft" id="section-7.1-4.1.1.6.2">
<pre>    0 1 2 3 4 5 6 7 
   +-+-+-+-+-+-+-+-+
   |B|V|L|G|P|     |
   +-+-+-+-+-+-+-+-+</pre><a class="pilcrow" href="#section-7.1-4.1.1.6.2">¶</a>
</div>
<p id="section-7.1-4.1.1.6.3">where:<a class="pilcrow" href="#section-7.1-4.1.1.6.3">¶</a></p>
<dl class="dlParallel" id="section-7.1-4.1.1.6.4">
                  <dt id="section-7.1-4.1.1.6.4.1">B-Flag:</dt>
                  <dd id="section-7.1-4.1.1.6.4.2">Backup Flag. If set, the Adj-SID refers to an
                adjacency that is eligible for protection (e.g., using IP Fast
 Reroute (IPFRR) or MPLS-FRR (MPLS Fast Reroute)) as
                described in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8402#section-3.4">Section 3.4</a> of [<a class="xref" href="#RFC8402">RFC8402</a>]</span>.<a class="pilcrow" href="#section-7.1-4.1.1.6.4.2">¶</a>
</dd>
<dt id="section-7.1-4.1.1.6.4.3">V-Flag:</dt>
                  <dd id="section-7.1-4.1.1.6.4.4">Value/Index Flag. If set, then the Adj-SID 
                carries an absolute value. If not set, then the Adj-SID carries 
                an index.<a class="pilcrow" href="#section-7.1-4.1.1.6.4.4">¶</a>
</dd>
<dt id="section-7.1-4.1.1.6.4.5">L-Flag:</dt>
                  <dd id="section-7.1-4.1.1.6.4.6">Local/Global Flag. If set, then the value/index 
                carried by the Adj-SID has local significance. If not set, then
                the value/index carried by this sub-TLV has global significance.<a class="pilcrow" href="#section-7.1-4.1.1.6.4.6">¶</a>
</dd>
<dt id="section-7.1-4.1.1.6.4.7">G-Flag:</dt>
                  <dd id="section-7.1-4.1.1.6.4.8">Group Flag. When set, the G-Flag indicates that the 
                Adj-SID refers to a group of adjacencies (and therefore <span class="bcp14">MAY</span> be assigned
                to other adjacencies as well).<a class="pilcrow" href="#section-7.1-4.1.1.6.4.8">¶</a>
</dd>
<dt id="section-7.1-4.1.1.6.4.9">P-Flag.</dt>
                  <dd id="section-7.1-4.1.1.6.4.10">Persistent Flag. When set, the P-Flag indicates that 
     the Adj-SID is persistently allocated, i.e., the Adj-SID value 
     remains the same across router restart and/or interface flap.<a class="pilcrow" href="#section-7.1-4.1.1.6.4.10">¶</a>
</dd>
<dt id="section-7.1-4.1.1.6.4.11">Other bits:</dt>
                  <dd id="section-7.1-4.1.1.6.4.12">Reserved. These <span class="bcp14">MUST</span> be zero when sent and are 
                ignored when received.<a class="pilcrow" href="#section-7.1-4.1.1.6.4.12">¶</a>
</dd>
</dl>
</dd>
<dt id="section-7.1-4.1.1.7">Reserved:</dt>
              <dd id="section-7.1-4.1.1.8">
                <span class="bcp14">SHOULD</span> be set to 0 on transmission and <span class="bcp14">MUST</span> be ignored on reception.<a class="pilcrow" href="#section-7.1-4.1.1.8">¶</a>
</dd>
<dt id="section-7.1-4.1.1.9">Weight:</dt>
              <dd id="section-7.1-4.1.1.10">Weight used for load-balancing purposes. The use of the
            weight is defined in <span>[<a class="xref" href="#RFC8402">RFC8402</a>]</span>.<a class="pilcrow" href="#section-7.1-4.1.1.10">¶</a>
</dd>
<dt id="section-7.1-4.1.1.11">SID/Index/Label:</dt>
              <dd id="section-7.1-4.1.1.12">As described in <a class="xref" href="#PREFIXSID">Section 6</a>.<a class="pilcrow" href="#section-7.1-4.1.1.12">¶</a>
</dd>
</dl>
</li>
        </ul>
<p id="section-7.1-5">An SR-capable router <span class="bcp14">MAY</span> allocate an Adj-SID for each of its
        adjacencies and set the B-Flag when the adjacency is eligible for protection by an
        FRR mechanism (IP or MPLS) as described in <span>[<a class="xref" href="#RFC8402">RFC8402</a>]</span>.<a class="pilcrow" href="#section-7.1-5">¶</a></p>
<p id="section-7.1-6">An SR-capable router <span class="bcp14">MAY</span> allocate more than one Adj-SID to an adjacency.<a class="pilcrow" href="#section-7.1-6">¶</a></p>
<p id="section-7.1-7">An SR-capable router <span class="bcp14">MAY</span> allocate the same Adj-SID to different adjacencies.<a class="pilcrow" href="#section-7.1-7">¶</a></p>
<p id="section-7.1-8">When the P-Flag is not set, the Adj-SID <span class="bcp14">MAY</span> be persistent. When 
     the P-Flag is set, the Adj-SID <span class="bcp14">MUST</span> be persistent.<a class="pilcrow" href="#section-7.1-8">¶</a></p>
</section>
</div>
<div id="LANADJSIDSUBTLV">
<section id="section-7.2">
        <h3 id="name-lan-adj-sid-sub-tlv">
<a class="section-number selfRef" href="#section-7.2">7.2. </a><a class="section-name selfRef" href="#name-lan-adj-sid-sub-tlv">LAN Adj-SID Sub-TLV</a>
        </h3>
<p id="section-7.2-1">The LAN Adjacency SID is an optional sub-TLV of the Router-Link
        TLV. It <span class="bcp14">MAY</span> appear multiple times in the Router-Link TLV. It is used
        to advertise a SID/Label for an adjacency to a non-DR router on a
        broadcast, Non-Broadcast Multi-Access (NBMA), or hybrid <span>[<a class="xref" href="#RFC6845">RFC6845</a>]</span> network.<a class="pilcrow" href="#section-7.2-1">¶</a></p>
<div class="artwork art-text alignLeft" id="section-7.2-2">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|              Type             |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     Flags     |     Weight    |            Reserved           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           Neighbor ID                         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                    SID/Label/Index (variable)                 |
+---------------------------------------------------------------+</pre><a class="pilcrow" href="#section-7.2-2">¶</a>
</div>
<p id="section-7.2-3">where:<a class="pilcrow" href="#section-7.2-3">¶</a></p>
<ul class="ulEmpty">
<li class="ulEmpty" id="section-7.2-4.1">
            <dl class="dlParallel" id="section-7.2-4.1.1">
              <dt id="section-7.2-4.1.1.1">Type:</dt>
              <dd id="section-7.2-4.1.1.2">6<a class="pilcrow" href="#section-7.2-4.1.1.2">¶</a>
</dd>
<dt id="section-7.2-4.1.1.3">Length:</dt>
              <dd id="section-7.2-4.1.1.4">11 or 12 octets, depending on the V-Flag.<a class="pilcrow" href="#section-7.2-4.1.1.4">¶</a>
</dd>
<dt id="section-7.2-4.1.1.5">Flags:</dt>
              <dd id="section-7.2-4.1.1.6">Same as in <a class="xref" href="#ADJSIDSUBTLV">Section 7.1</a>.<a class="pilcrow" href="#section-7.2-4.1.1.6">¶</a>
</dd>
<dt id="section-7.2-4.1.1.7">Weight:</dt>
              <dd id="section-7.2-4.1.1.8">Weight used for load-balancing purposes. The use of the
            weight is defined in <span>[<a class="xref" href="#RFC8402">RFC8402</a>]</span>.<a class="pilcrow" href="#section-7.2-4.1.1.8">¶</a>
</dd>
<dt id="section-7.2-4.1.1.9">Reserved:</dt>
              <dd id="section-7.2-4.1.1.10">
                <span class="bcp14">SHOULD</span> be set to 0 on transmission and <span class="bcp14">MUST</span> be ignored on reception.<a class="pilcrow" href="#section-7.2-4.1.1.10">¶</a>
</dd>
<dt id="section-7.2-4.1.1.11">Neighbor ID:</dt>
              <dd id="section-7.2-4.1.1.12">The Router ID of the neighbor for which the LAN Adjacency SID is 
            advertised.<a class="pilcrow" href="#section-7.2-4.1.1.12">¶</a>
</dd>
<dt id="section-7.2-4.1.1.13">SID/Index/Label:</dt>
              <dd id="section-7.2-4.1.1.14">
                <p id="section-7.2-4.1.1.14.1">As described in <a class="xref" href="#PREFIXSID">Section 6</a>.<a class="pilcrow" href="#section-7.2-4.1.1.14.1">¶</a></p>
<p id="section-7.2-4.1.1.14.2">When the P-Flag is not set, the LAN Adjacency SID <span class="bcp14">MAY</span> be persistent. When 
         the P-Flag is set, the LAN Adjacency SID <span class="bcp14">MUST</span> be persistent.<a class="pilcrow" href="#section-7.2-4.1.1.14.2">¶</a></p>
</dd>
</dl>
</li>
        </ul>
</section>
</div>
</section>
</div>
<section id="section-8">
      <h2 id="name-elements-of-procedure">
<a class="section-number selfRef" href="#section-8">8. </a><a class="section-name selfRef" href="#name-elements-of-procedure">Elements of Procedure</a>
      </h2>
<section id="section-8.1">
        <h3 id="name-intra-area-segment-routing-">
<a class="section-number selfRef" href="#section-8.1">8.1. </a><a class="section-name selfRef" href="#name-intra-area-segment-routing-">Intra-area Segment Routing in OSPFv3</a>
        </h3>
<p id="section-8.1-1">An OSPFv3 router that supports Segment Routing <span class="bcp14">MAY</span> advertise Prefix-
        SIDs for any prefix to which it is advertising reachability (e.g.,
        a loopback IP address as described in <a class="xref" href="#PREFIXSID">Section 6</a>).<a class="pilcrow" href="#section-8.1-1">¶</a></p>
<p id="section-8.1-2">A Prefix-SID can also be advertised by SR Mapping Servers (as
        described in <span>[<a class="xref" href="#RFC8661">RFC8661</a>]</span>). A Mapping
        Server advertises Prefix-SIDs for remote prefixes that exist in the
        OSPFv3 routing domain. Multiple Mapping Servers can advertise Prefix-SIDs 
        for the same prefix, in which case the same Prefix-SID <span class="bcp14">MUST</span> be advertised by
        all of them. The SR Mapping Server could use either area flooding scope or
        autonomous system flooding scope when advertising Prefix-SIDs for
        prefixes, based on the configuration of the SR Mapping Server.
        Depending on the flooding scope used, the SR Mapping Server chooses the
        OSPFv3 LSA type that will be used. If the area flooding scope is needed,
        an E-Intra-Area-Prefix-LSA <span>[<a class="xref" href="#RFC8362">RFC8362</a>]</span>
        is used. If autonomous system flooding scope is needed,
        an E-AS-External-LSA <span>[<a class="xref" href="#RFC8362">RFC8362</a>]</span> is used.<a class="pilcrow" href="#section-8.1-2">¶</a></p>
<p id="section-8.1-3">When a Prefix-SID is advertised by the Mapping Server, which is
        indicated by the M-Flag in the Prefix-SID sub-TLV (<a class="xref" href="#PREFIXSID">Section 6</a>), the route type as implied by
        the LSA type is ignored and the Prefix-SID is bound to the
        corresponding prefix independent of the route type.<a class="pilcrow" href="#section-8.1-3">¶</a></p>
<p id="section-8.1-4">Advertisement of the Prefix-SID by the Mapping Server using an
        Inter-Area Prefix TLV, External-Prefix TLV, or Intra-Area-Prefix TLV
        <span>[<a class="xref" href="#RFC8362">RFC8362</a>]</span> does not itself
        contribute to the prefix reachability. The NU-bit <span>[<a class="xref" href="#RFC5340">RFC5340</a>]</span> <span class="bcp14">MUST</span> be set in the
        PrefixOptions field of the LSA, which is used by the Mapping Server to
        advertise SID or SID Range, which prevents the advertisement from contributing to
        prefix reachability.<a class="pilcrow" href="#section-8.1-4">¶</a></p>
<p id="section-8.1-5">An SR Mapping Server <span class="bcp14">MUST</span> use the OSPFv3 Extended Prefix Range TLVs when advertising SIDs
        for prefixes. Prefixes of different route types can be combined in a single OSPFv3 
        Extended Prefix Range TLV advertised by an SR Mapping Server.<a class="pilcrow" href="#section-8.1-5">¶</a></p>
<p id="section-8.1-6">Area-scoped OSPFv3 Extended Prefix Range TLVs are propagated between areas, similar 
        to propagation of prefixes between areas. Same rules that are used for propagating 
        prefixes between areas <span>[<a class="xref" href="#RFC5340">RFC5340</a>]</span> are used for the propagation of 
        the prefix ranges.<a class="pilcrow" href="#section-8.1-6">¶</a></p>
</section>
<section id="section-8.2">
        <h3 id="name-inter-area-segment-routing-">
<a class="section-number selfRef" href="#section-8.2">8.2. </a><a class="section-name selfRef" href="#name-inter-area-segment-routing-">Inter-area Segment Routing in OSPFv3</a>
        </h3>
<p id="section-8.2-1">In order to support SR in a multiarea environment, OSPFv3 <span class="bcp14">MUST</span>
        propagate Prefix-SID information between areas. The following
        procedure is used to propagate Prefix-SIDs between areas.<a class="pilcrow" href="#section-8.2-1">¶</a></p>
<p id="section-8.2-2">When an OSPFv3 ABR advertises an Inter-Area-Prefix-LSA from an
        intra-area prefix to all its connected areas, it will also include the
        Prefix-SID sub-TLV as described in <a class="xref" href="#PREFIXSID">Section 6</a>. The
        Prefix-SID value will be set as follows:<a class="pilcrow" href="#section-8.2-2">¶</a></p>
<ul class="ulEmpty">
<li class="ulEmpty" id="section-8.2-3.1">The ABR will look at its best path to the prefix in the source area
            and find the advertising router associated with the best
            path to that prefix.<a class="pilcrow" href="#section-8.2-3.1">¶</a>
</li>
          <li class="ulEmpty" id="section-8.2-3.2">The ABR will then determine if this router advertised a Prefix-SID 
 for the prefix and use it when advertising the Prefix-SID to other 
 connected areas.<a class="pilcrow" href="#section-8.2-3.2">¶</a>
</li>
          <li class="ulEmpty" id="section-8.2-3.3">If no Prefix-SID was advertised for the prefix in the source
            area by the router that contributes to the best path to the
            prefix, the originating ABR will use the Prefix-SID advertised by any
            other router when propagating the Prefix-SID for the prefix to other areas.<a class="pilcrow" href="#section-8.2-3.3">¶</a>
</li>
        </ul>
<p id="section-8.2-4">When an OSPFv3 ABR advertises an Inter-Area-Prefix-LSA from an
        inter-area route to all its connected areas, it will also include the
        Prefix-SID sub-TLV as described in <a class="xref" href="#PREFIXSID">Section 6</a>. The
        Prefix-SID value will be set as follows:<a class="pilcrow" href="#section-8.2-4">¶</a></p>
<ul class="ulEmpty">
<li class="ulEmpty" id="section-8.2-5.1">The ABR will look at its best path to the prefix in the backbone
            area and find the advertising router associated with the best
            path to that prefix.<a class="pilcrow" href="#section-8.2-5.1">¶</a>
</li>
          <li class="ulEmpty" id="section-8.2-5.2">The ABR will then determine if this router advertised a Prefix-SID
            for the prefix and use it when advertising the Prefix-SID to other
            connected areas.<a class="pilcrow" href="#section-8.2-5.2">¶</a>
</li>
          <li class="ulEmpty" id="section-8.2-5.3">If no Prefix-SID was advertised for the prefix in the backbone
            area by the ABR that contributes to the best path to the prefix,
            the originating ABR will use the Prefix-SID advertised by any
            other router when propagating the Prefix-SID for the prefix to other areas.<a class="pilcrow" href="#section-8.2-5.3">¶</a>
</li>
        </ul>
</section>
<section id="section-8.3">
        <h3 id="name-segment-routing-for-externa">
<a class="section-number selfRef" href="#section-8.3">8.3. </a><a class="section-name selfRef" href="#name-segment-routing-for-externa">Segment Routing for External Prefixes</a>
        </h3>
<p id="section-8.3-1">AS-External-LSAs are flooded domain wide. When an ASBR, which
        supports SR, originates an E-AS-External-LSA, it <span class="bcp14">SHOULD</span> also include
        a Prefix-SID sub-TLV as described in <a class="xref" href="#PREFIXSID">Section 6</a>.
        The Prefix-SID value will be set to the SID that has been reserved for
        that prefix.<a class="pilcrow" href="#section-8.3-1">¶</a></p>
<p id="section-8.3-2">When a Not-So-Stubby Area (NSSA) <span>[<a class="xref" href="#RFC3101">RFC3101</a>]</span> ABR
        translates an E-NSSA-LSA into an E-AS-External-LSA, it <span class="bcp14">SHOULD</span> also
        advertise the Prefix-SID for the prefix. The NSSA ABR determines its
        best path to the prefix advertised in the translated E-NSSA-LSA and
        finds the advertising router associated with that path.  If the
        advertising router has advertised a Prefix-SID for the prefix, then
        the NSSA ABR uses it when advertising the Prefix-SID for the
        E-AS-External-LSA. Otherwise, the Prefix-SID advertised by any other
        router will be used.<a class="pilcrow" href="#section-8.3-2">¶</a></p>
</section>
<section id="section-8.4">
        <h3 id="name-advertisement-of-adj-sid">
<a class="section-number selfRef" href="#section-8.4">8.4. </a><a class="section-name selfRef" href="#name-advertisement-of-adj-sid">Advertisement of Adj-SID</a>
        </h3>
<p id="section-8.4-1">The Adjacency Segment Routing Identifier (Adj-SID) is advertised
        using the Adj-SID sub-TLV as described in <a class="xref" href="#ADJSID">Section 7</a>.<a class="pilcrow" href="#section-8.4-1">¶</a></p>
<section id="section-8.4.1">
          <h4 id="name-advertisement-of-adj-sid-on">
<a class="section-number selfRef" href="#section-8.4.1">8.4.1. </a><a class="section-name selfRef" href="#name-advertisement-of-adj-sid-on">Advertisement of Adj-SID on Point-to-Point Links</a>
          </h4>
<p id="section-8.4.1-1">An Adj-SID <span class="bcp14">MAY</span> be advertised for any adjacency on a
          point-to-point (P2P) link that is in neighbor state 2-Way or
          higher. If the adjacency on a P2P link transitions from the FULL
          state, then the Adj-SID for that adjacency <span class="bcp14">MAY</span> be removed from the
          area. If the adjacency transitions to a state lower than 2-Way, then
          the Adj-SID Advertisement <span class="bcp14">MUST</span> be withdrawn from the area.<a class="pilcrow" href="#section-8.4.1-1">¶</a></p>
</section>
<section id="section-8.4.2">
          <h4 id="name-adjacency-sid-on-broadcast-">
<a class="section-number selfRef" href="#section-8.4.2">8.4.2. </a><a class="section-name selfRef" href="#name-adjacency-sid-on-broadcast-">Adjacency SID on Broadcast or NBMA Interfaces</a>
          </h4>
<p id="section-8.4.2-1">Broadcast, NBMA, or hybrid <span>[<a class="xref" href="#RFC6845">RFC6845</a>]</span> networks in OSPFv3 are 
          represented by a star topology where the DR is the central 
          point to which all other routers on the broadcast, NBMA, or hybrid network connect. 
          As a result, routers on the broadcast, NBMA, or hybrid network advertise only
          their adjacency to the DR. Routers that do not act as DR do not form or advertise
          adjacencies with each other. They do, however, maintain 2-Way adjacency state
          with each other and are directly reachable.<a class="pilcrow" href="#section-8.4.2-1">¶</a></p>
<p id="section-8.4.2-2">When Segment Routing is used, each router on the broadcast, NBMA, or hybrid
          network <span class="bcp14">MAY</span> advertise the Adj-SID for its adjacency to the DR using the
          Adj-SID sub-TLV as described in <a class="xref" href="#ADJSIDSUBTLV">Section 7.1</a>.<a class="pilcrow" href="#section-8.4.2-2">¶</a></p>
<p id="section-8.4.2-3">SR-capable routers <span class="bcp14">MAY</span> also advertise a LAN
          Adjacency SID for other neighbors (e.g., Backup Designated Router
          (BDR), DR-OTHER, etc.) on the broadcast, NBMA, or hybrid network
          using the LAN Adj-SID sub-TLV as described in <a class="xref" href="#LANADJSIDSUBTLV">Section 7.2</a>.<a class="pilcrow" href="#section-8.4.2-3">¶</a></p>
</section>
</section>
</section>
<div id="IANA">
<section id="section-9">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-9">9. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<p id="section-9-1">This specification updates two existing OSPFv3 registries.<a class="pilcrow" href="#section-9-1">¶</a></p>
<div id="EPLTLVREG">
<section id="section-9.1">
        <h3 id="name-ospfv3-extended-lsa-tlvs-re">
<a class="section-number selfRef" href="#section-9.1">9.1. </a><a class="section-name selfRef" href="#name-ospfv3-extended-lsa-tlvs-re">"OSPFv3 Extended-LSA TLVs" Registry</a>
        </h3>
<p id="section-9.1-1">The following values have been allocated:<a class="pilcrow" href="#section-9.1-1">¶</a></p>
<span id="name-ospfv3-extended-lsa-tlvs"></span><div id="IANA1">
<table class="left" id="table-1">
          <caption>
<a class="selfRef" href="#table-1">Table 1</a>:
<a class="selfRef" href="#name-ospfv3-extended-lsa-tlvs">OSPFv3 Extended-LSA TLVs</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Value</th>
              <th class="text-left" colspan="1" rowspan="1">Description</th>
              <th class="text-left" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">9</td>
              <td class="text-left" colspan="1" rowspan="1">OSPFv3 Extended Prefix Range TLV</td>
              <td class="text-left" colspan="1" rowspan="1">This document</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="EXTLSAREG">
<section id="section-9.2">
        <h3 id="name-ospfv3-extended-lsa-sub-tlv">
<a class="section-number selfRef" href="#section-9.2">9.2. </a><a class="section-name selfRef" href="#name-ospfv3-extended-lsa-sub-tlv">"OSPFv3 Extended-LSA Sub-TLVs" Registry</a>
        </h3>
<p id="section-9.2-1">The following values have been allocated:<a class="pilcrow" href="#section-9.2-1">¶</a></p>
<span id="name-ospfv3-extended-lsa-sub-tlvs"></span><div id="IANA2">
<table class="left" id="table-2">
          <caption>
<a class="selfRef" href="#table-2">Table 2</a>:
<a class="selfRef" href="#name-ospfv3-extended-lsa-sub-tlvs">OSPFv3 Extended-LSA Sub-TLVs</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Value</th>
              <th class="text-left" colspan="1" rowspan="1">Description</th>
              <th class="text-left" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">4</td>
              <td class="text-left" colspan="1" rowspan="1">Prefix-SID sub-TLV</td>
              <td class="text-left" colspan="1" rowspan="1">This document</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">5</td>
              <td class="text-left" colspan="1" rowspan="1">Adj-SID sub-TLV</td>
              <td class="text-left" colspan="1" rowspan="1">This document</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">6</td>
              <td class="text-left" colspan="1" rowspan="1">LAN Adj-SID sub-TLV</td>
              <td class="text-left" colspan="1" rowspan="1">This document</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">7</td>
              <td class="text-left" colspan="1" rowspan="1">SID/Label sub-TLV</td>
              <td class="text-left" colspan="1" rowspan="1">This document</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
</section>
</div>
<div id="Error-handling">
<section id="section-10">
      <h2 id="name-tlv-sub-tlv-error-handling">
<a class="section-number selfRef" href="#section-10">10. </a><a class="section-name selfRef" href="#name-tlv-sub-tlv-error-handling">TLV/Sub-TLV Error Handling</a>
      </h2>
<p id="section-10-1">For any new TLVs/sub-TLVs defined in this document, if the length is
invalid, the LSA in which it is advertised is considered malformed and
<span class="bcp14">MUST</span> be ignored. Errors <span class="bcp14">SHOULD</span> be logged subject
to rate limiting.<a class="pilcrow" href="#section-10-1">¶</a></p>
</section>
</div>
<div id="Security">
<section id="section-11">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-11">11. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<p id="section-11-1">With the OSPFv3 Segment Routing extensions defined herein,
      OSPFv3 will now program the MPLS data plane <span>[<a class="xref" href="#RFC3031">RFC3031</a>]</span>.
      Previously, LDP <span>[<a class="xref" href="#RFC5036">RFC5036</a>]</span> or 
      another label distribution mechanism was required to advertise MPLS labels and 
      program the MPLS data plane.<a class="pilcrow" href="#section-11-1">¶</a></p>
<p id="section-11-2">In general, the same types of attacks that can be carried out on the IP
      control plane can be carried out on the MPLS control plane resulting in traffic
      being misrouted in the respective data planes. However, the latter can be more
      difficult to detect and isolate.<a class="pilcrow" href="#section-11-2">¶</a></p>
<p id="section-11-3">Existing security extensions, as described in <span>[<a class="xref" href="#RFC5340">RFC5340</a>]</span> and
       <span>[<a class="xref" href="#RFC8362">RFC8362</a>]</span>, apply to these Segment Routing
       extensions. While OSPFv3 is under a single administrative domain, there can be 
       deployments where potential attackers have access to one or more networks in the
       OSPFv3 routing domain. In these deployments, stronger authentication mechanisms,
       such as those specified in <span>[<a class="xref" href="#RFC4552">RFC4552</a>]</span> or 
       <span>[<a class="xref" href="#RFC7166">RFC7166</a>]</span>,
       <span class="bcp14">SHOULD</span> be used.<a class="pilcrow" href="#section-11-3">¶</a></p>
<p id="section-11-4">Implementations <span class="bcp14">MUST</span> ensure that malformed TLVs and sub-TLVs defined in this document 
       are detected and that they do not provide a vulnerability for attackers to crash the OSPFv3 
       router or routing process. Reception of a malformed TLV or sub-TLV <span class="bcp14">SHOULD</span> be counted 
       and/or logged for further analysis. Logging of malformed TLVs and sub-TLVs <span class="bcp14">SHOULD</span>
       be rate limited to prevent a Denial-of-Service (DoS) attack (distributed or otherwise) 
       from overloading the OSPFv3 control plane.<a class="pilcrow" href="#section-11-4">¶</a></p>
</section>
</div>
<section id="section-12">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-12">12. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-12.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-12.1">12.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="ALGOREG">[ALGOREG]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Interior Gateway Protocol (IGP) Parameters"</span>, <span>&lt;<a href="https://www.iana.org/assignments/igp-parameters">https://www.iana.org/assignments/igp-parameters</a>&gt;</span>. </dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dt id="RFC3031">[RFC3031]</dt>
        <dd>
<span class="refAuthor">Rosen, E.</span><span class="refAuthor">, Viswanathan, A.</span><span class="refAuthor">, and R. Callon</span>, <span class="refTitle">"Multiprotocol Label Switching Architecture"</span>, <span class="seriesInfo">RFC 3031</span>, <span class="seriesInfo">DOI 10.17487/RFC3031</span>, <time datetime="2001-01">January 2001</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3031">https://www.rfc-editor.org/info/rfc3031</a>&gt;</span>. </dd>
<dt id="RFC3101">[RFC3101]</dt>
        <dd>
<span class="refAuthor">Murphy, P.</span>, <span class="refTitle">"The OSPF Not-So-Stubby Area (NSSA) Option"</span>, <span class="seriesInfo">RFC 3101</span>, <span class="seriesInfo">DOI 10.17487/RFC3101</span>, <time datetime="2003-01">January 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3101">https://www.rfc-editor.org/info/rfc3101</a>&gt;</span>. </dd>
<dt id="RFC5036">[RFC5036]</dt>
        <dd>
<span class="refAuthor">Andersson, L., Ed.</span><span class="refAuthor">, Minei, I., Ed.</span><span class="refAuthor">, and B. Thomas, Ed.</span>, <span class="refTitle">"LDP Specification"</span>, <span class="seriesInfo">RFC 5036</span>, <span class="seriesInfo">DOI 10.17487/RFC5036</span>, <time datetime="2007-10">October 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5036">https://www.rfc-editor.org/info/rfc5036</a>&gt;</span>. </dd>
<dt id="RFC5340">[RFC5340]</dt>
        <dd>
<span class="refAuthor">Coltun, R.</span><span class="refAuthor">, Ferguson, D.</span><span class="refAuthor">, Moy, J.</span><span class="refAuthor">, and A. Lindem</span>, <span class="refTitle">"OSPF for IPv6"</span>, <span class="seriesInfo">RFC 5340</span>, <span class="seriesInfo">DOI 10.17487/RFC5340</span>, <time datetime="2008-07">July 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5340">https://www.rfc-editor.org/info/rfc5340</a>&gt;</span>. </dd>
<dt id="RFC5462">[RFC5462]</dt>
        <dd>
<span class="refAuthor">Andersson, L.</span><span class="refAuthor"> and R. Asati</span>, <span class="refTitle">"Multiprotocol Label Switching (MPLS) Label Stack Entry: "EXP" Field Renamed to "Traffic Class" Field"</span>, <span class="seriesInfo">RFC 5462</span>, <span class="seriesInfo">DOI 10.17487/RFC5462</span>, <time datetime="2009-02">February 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5462">https://www.rfc-editor.org/info/rfc5462</a>&gt;</span>. </dd>
<dt id="RFC6845">[RFC6845]</dt>
        <dd>
<span class="refAuthor">Sheth, N.</span><span class="refAuthor">, Wang, L.</span><span class="refAuthor">, and J. Zhang</span>, <span class="refTitle">"OSPF Hybrid Broadcast and Point-to-Multipoint Interface Type"</span>, <span class="seriesInfo">RFC 6845</span>, <span class="seriesInfo">DOI 10.17487/RFC6845</span>, <time datetime="2013-01">January 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6845">https://www.rfc-editor.org/info/rfc6845</a>&gt;</span>. </dd>
<dt id="RFC7770">[RFC7770]</dt>
        <dd>
<span class="refAuthor">Lindem, A., Ed.</span><span class="refAuthor">, Shen, N.</span><span class="refAuthor">, Vasseur, JP.</span><span class="refAuthor">, Aggarwal, R.</span><span class="refAuthor">, and S. Shaffer</span>, <span class="refTitle">"Extensions to OSPF for Advertising Optional Router Capabilities"</span>, <span class="seriesInfo">RFC 7770</span>, <span class="seriesInfo">DOI 10.17487/RFC7770</span>, <time datetime="2016-02">February 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7770">https://www.rfc-editor.org/info/rfc7770</a>&gt;</span>. </dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dt id="RFC8362">[RFC8362]</dt>
        <dd>
<span class="refAuthor">Lindem, A.</span><span class="refAuthor">, Roy, A.</span><span class="refAuthor">, Goethals, D.</span><span class="refAuthor">, Reddy Vallem, V.</span><span class="refAuthor">, and F. Baker</span>, <span class="refTitle">"OSPFv3 Link State Advertisement (LSA) Extensibility"</span>, <span class="seriesInfo">RFC 8362</span>, <span class="seriesInfo">DOI 10.17487/RFC8362</span>, <time datetime="2018-04">April 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8362">https://www.rfc-editor.org/info/rfc8362</a>&gt;</span>. </dd>
<dt id="RFC8402">[RFC8402]</dt>
        <dd>
<span class="refAuthor">Filsfils, C., Ed.</span><span class="refAuthor">, Previdi, S., Ed.</span><span class="refAuthor">, Ginsberg, L.</span><span class="refAuthor">, Decraene, B.</span><span class="refAuthor">, Litkowski, S.</span><span class="refAuthor">, and R. Shakir</span>, <span class="refTitle">"Segment Routing Architecture"</span>, <span class="seriesInfo">RFC 8402</span>, <span class="seriesInfo">DOI 10.17487/RFC8402</span>, <time datetime="2018-07">July 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8402">https://www.rfc-editor.org/info/rfc8402</a>&gt;</span>. </dd>
<dt id="RFC8661">[RFC8661]</dt>
        <dd>
<span class="refAuthor">Bashandy, A., Ed.</span><span class="refAuthor">, Filsfils, C., Ed.</span><span class="refAuthor">, Previdi, S.</span><span class="refAuthor">, Decraene, B.</span><span class="refAuthor">, and S. Litkowski</span>, <span class="refTitle">"Segment Routing MPLS Interworking with LDP"</span>, <span class="seriesInfo">RFC 8661</span>, <span class="seriesInfo">DOI 10.17487/RFC8661</span>, <time datetime="2019-12">December 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8661">https://www.rfc-editor.org/info/rfc8661</a>&gt;</span>. </dd>
<dt id="RFC8665">[RFC8665]</dt>
      <dd>
<span class="refAuthor">Psenak, P., Ed.</span><span class="refAuthor">, Previdi, S., Ed.</span><span class="refAuthor">, Filfils, C.</span><span class="refAuthor">, Gredler, H.</span><span class="refAuthor">, Shakir, R.</span><span class="refAuthor">, Henderickx, W.</span><span class="refAuthor">, and J. Tantsura</span>, <span class="refTitle">"OSPF Extensions for Segment Routing"</span>, <span class="seriesInfo">RFC 8665</span>, <span class="seriesInfo">DOI 10.17487/RFC8665</span>, <time datetime="2019-12">December 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8665">https://www.rfc-editor.org/info/rfc8665</a>&gt;</span>. </dd>
</dl>
</section>
<section id="section-12.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-12.2">12.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC4552">[RFC4552]</dt>
        <dd>
<span class="refAuthor">Gupta, M.</span><span class="refAuthor"> and N. Melam</span>, <span class="refTitle">"Authentication/Confidentiality for OSPFv3"</span>, <span class="seriesInfo">RFC 4552</span>, <span class="seriesInfo">DOI 10.17487/RFC4552</span>, <time datetime="2006-06">June 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4552">https://www.rfc-editor.org/info/rfc4552</a>&gt;</span>. </dd>
<dt id="RFC7166">[RFC7166]</dt>
        <dd>
<span class="refAuthor">Bhatia, M.</span><span class="refAuthor">, Manral, V.</span><span class="refAuthor">, and A. Lindem</span>, <span class="refTitle">"Supporting Authentication Trailer for OSPFv3"</span>, <span class="seriesInfo">RFC 7166</span>, <span class="seriesInfo">DOI 10.17487/RFC7166</span>, <time datetime="2014-03">March 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7166">https://www.rfc-editor.org/info/rfc7166</a>&gt;</span>. </dd>
<dt id="RFC7855">[RFC7855]</dt>
      <dd>
<span class="refAuthor">Previdi, S., Ed.</span><span class="refAuthor">, Filsfils, C., Ed.</span><span class="refAuthor">, Decraene, B.</span><span class="refAuthor">, Litkowski, S.</span><span class="refAuthor">, Horneffer, M.</span><span class="refAuthor">, and R. Shakir</span>, <span class="refTitle">"Source Packet Routing in Networking (SPRING) Problem Statement and Requirements"</span>, <span class="seriesInfo">RFC 7855</span>, <span class="seriesInfo">DOI 10.17487/RFC7855</span>, <time datetime="2016-05">May 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7855">https://www.rfc-editor.org/info/rfc7855</a>&gt;</span>. </dd>
</dl>
</section>
</section>
<div id="Acknowledgements">
<section id="section-appendix.a">
      <h2 id="name-contributors">
<a class="section-name selfRef" href="#name-contributors">Contributors</a>
      </h2>
<p id="section-appendix.a-1">The following people gave a substantial contribution to the content
      of this document and should be considered coauthors:<a class="pilcrow" href="#section-appendix.a-1">¶</a></p>
<div class="artwork art-text alignLeft" id="section-appendix.a-2">
<pre>    
   Clarence Filsfils
   Cisco Systems, Inc.
   Brussels
   Belgium
   
   Email: cfilsfil@cisco.com</pre><a class="pilcrow" href="#section-appendix.a-2">¶</a>
</div>
<div class="artwork art-text alignLeft" id="section-appendix.a-3">
<pre>  
   Hannes Gredler
   RtBrick Inc.
   Austria

   Email: hannes@rtbrick.com</pre><a class="pilcrow" href="#section-appendix.a-3">¶</a>
</div>
<div class="artwork art-text alignLeft" id="section-appendix.a-4">
<pre>     
   Rob Shakir
   Google, Inc.
   United States of America 

   Email: robjs@google.com</pre><a class="pilcrow" href="#section-appendix.a-4">¶</a>
</div>
<div class="artwork art-text alignLeft" id="section-appendix.a-5">
<pre>     
   Wim Henderickx
   Nokia
   Belgium

   Email: wim.henderickx@nokia.com</pre><a class="pilcrow" href="#section-appendix.a-5">¶</a>
</div>
<div class="artwork art-text alignLeft" id="section-appendix.a-6">
<pre>     
   Jeff Tantsura
   Apstra, Inc.
   United States of America

   Email: jefftant.ietf@gmail.com</pre><a class="pilcrow" href="#section-appendix.a-6">¶</a>
</div>
<p id="section-appendix.a-7">Thanks to Acee Lindem for his substantial contribution to the content of 
      this document.<a class="pilcrow" href="#section-appendix.a-7">¶</a></p>
<p id="section-appendix.a-8">We would like to thank Anton Smirnov for his contribution as well.<a class="pilcrow" href="#section-appendix.a-8">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="section-appendix.b">
      <h2 id="name-authors-addresses">
<a class="section-name selfRef" href="#name-authors-addresses">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Peter Psenak (<span class="role">editor</span>)</span></div>
<div class="left" dir="auto"><span class="org">Cisco Systems, Inc.</span></div>
<div class="left" dir="auto"><span class="street-address">Eurovea Centre, Central 3, Pribinova Street 10</span></div>
<div class="left" dir="auto">
<span class="postal-code">81109</span> <span class="locality">Bratislava</span>
</div>
<div class="left" dir="auto"><span class="country-name">Slovakia</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:ppsenak@cisco.com">ppsenak@cisco.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Stefano Previdi (<span class="role">editor</span>)</span></div>
<div class="left" dir="auto"><span class="org">Cisco Systems, Inc.</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:stefano@previdi.net">stefano@previdi.net</a>
</div>
</address>
</section>
</div>
<script>var toc = document.getElementById("toc");
var tocToggle = toc.querySelector("h2");
var tocNav = toc.querySelector("nav");

// mobile menu toggle
tocToggle.onclick = function(event) {
    if (window.innerWidth < 1024) {
 var tocNavDisplay = tocNav.currentStyle ? tocNav.currentStyle.display : getComputedStyle(tocNav, null).display;
 if (tocNavDisplay == "none") {
     tocNav.style.display = "block";
 } else {
     tocNav.style.display = "none";
 }
    }
}

// toc anchor scroll to anchor
tocNav.addEventListener("click", function (event) {
    event.preventDefault();
    if (event.target.nodeName == 'A') {
 if (window.innerWidth < 1024) {
     tocNav.style.display = "none";
 }
 var href = event.target.getAttribute("href");
 var anchorId = href.substr(1);
 var anchor =  document.getElementById(anchorId);
 anchor.scrollIntoView(true);
 window.history.pushState("","",href);
    }
});

// switch toc mode when window resized
window.onresize = function () {
    if (window.innerWidth < 1024) {
 tocNav.style.display = "none";
    } else {
 tocNav.style.display = "block";
    }
}
</script>


</body></html>