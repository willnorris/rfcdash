<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 9161: Operational Aspects of Proxy ARP/ND in Ethernet Virtual Private Networks</title>
<meta content="Jorge Rabadan" name="author"/>
<meta content="Senthil Sathappan" name="author"/>
<meta content="Kiran Nagaraj" name="author"/>
<meta content="Greg Hankins" name="author"/>
<meta content="Thomas King" name="author"/>
<meta content="
       This document describes the Ethernet Virtual Private Network (EVPN)
      Proxy ARP/ND function augmented by the capability of the ARP/ND
      Extended Community. From that perspective, this document updates the EVPN
      specification to provide more comprehensive documentation of the
      operation of the Proxy ARP/ND function. The EVPN Proxy ARP/ND function
      and the ARP/ND Extended Community help operators of Internet Exchange
      Points, Data Centers, and other networks deal with IPv4 and IPv6 address
      resolution issues associated with large Broadcast Domains by reducing
      and even suppressing the flooding produced by address resolution in the
      EVPN network. 
    " name="description"/>
<meta content="xml2rfc 3.12.0" name="generator"/>
<meta content="ARP suppression" name="keyword"/>
<meta content="flood suppression" name="keyword"/>
<meta content="ARP unicast-forward" name="keyword"/>
<meta content="Duplicate IP Detection" name="keyword"/>
<meta content="9161" name="rfc.number"/>
<!-- Generator version information:
  xml2rfc 3.12.0
    Python 3.6.15
    appdirs 1.4.4
    ConfigArgParse 1.4.1
    google-i18n-address 2.4.0
    html5lib 1.0.1
    intervaltree 3.0.2
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.4.2
    pycairo 1.15.1
    pycountry 19.8.18
    pyflakes 2.1.1
    PyYAML 5.4.1
    requests 2.24.0
    setuptools 40.5.0
    six 1.14.0
    WeasyPrint 52.5
-->
<link href="rfc9161.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://dx.doi.org/10.17487/rfc9161" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <link href="https://datatracker.ietf.org/doc/draft-ietf-bess-evpn-proxy-arp-nd-16" rel="prev"/>
  </head>
<body>
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9161</td>
<td class="center">EVPN Proxy ARP/ND</td>
<td class="right">January 2022</td>
</tr></thead>
<tfoot><tr>
<td class="left">Rabadan, et al.</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc9161">9161</a></dd>
<dt class="label-updates">Updates:</dt>
<dd class="updates">
<a class="eref" href="https://www.rfc-editor.org/rfc/rfc7432">7432</a> </dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2022-01">January 2022</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">J. Rabadan, <span class="editor">Ed.</span>
</div>
<div class="org">Nokia</div>
</div>
<div class="author">
      <div class="author-name">S. Sathappan</div>
<div class="org">Nokia</div>
</div>
<div class="author">
      <div class="author-name">K. Nagaraj</div>
<div class="org">Nokia</div>
</div>
<div class="author">
      <div class="author-name">G. Hankins</div>
<div class="org">Nokia</div>
</div>
<div class="author">
      <div class="author-name">T. King</div>
<div class="org">DE-CIX</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9161</h1>
<h1 id="title">Operational Aspects of Proxy ARP/ND in Ethernet Virtual Private Networks</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">This document describes the Ethernet Virtual Private Network (EVPN)
      Proxy ARP/ND function augmented by the capability of the ARP/ND
      Extended Community. From that perspective, this document updates the EVPN
      specification to provide more comprehensive documentation of the
      operation of the Proxy ARP/ND function. The EVPN Proxy ARP/ND function
      and the ARP/ND Extended Community help operators of Internet Exchange
      Points, Data Centers, and other networks deal with IPv4 and IPv6 address
      resolution issues associated with large Broadcast Domains by reducing
      and even suppressing the flooding produced by address resolution in the
      EVPN network.<a class="pilcrow" href="#section-abstract-1">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a class="pilcrow" href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9161">https://www.rfc-editor.org/info/rfc9161</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">▲</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p class="keepWithNext" id="section-toc.1-1.1.1"><a class="xref" href="#section-1">1</a>.  <a class="xref" href="#name-introduction">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p class="keepWithNext" id="section-toc.1-1.1.2.1.1"><a class="xref" href="#section-1.1">1.1</a>.  <a class="xref" href="#name-the-data-center-use-case">The Data Center Use Case</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p class="keepWithNext" id="section-toc.1-1.1.2.2.1"><a class="xref" href="#section-1.2">1.2</a>.  <a class="xref" href="#name-the-internet-exchange-point">The Internet Exchange Point Use Case</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a class="xref" href="#section-2">2</a>.  <a class="xref" href="#name-terminology">Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a class="xref" href="#section-3">3</a>.  <a class="xref" href="#name-solution-description">Solution Description</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a class="xref" href="#section-3.1">3.1</a>.  <a class="xref" href="#name-proxy-arp-nd-sub-functions">Proxy ARP/ND Sub-functions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a class="xref" href="#section-3.2">3.2</a>.  <a class="xref" href="#name-learning-sub-function">Learning Sub-function</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a class="xref" href="#section-3.2.1">3.2.1</a>.  <a class="xref" href="#name-proxy-nd-and-the-na-flags">Proxy ND and the NA Flags</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a class="xref" href="#section-3.3">3.3</a>.  <a class="xref" href="#name-reply-sub-function">Reply Sub-function</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a class="xref" href="#section-3.4">3.4</a>.  <a class="xref" href="#name-unicast-forward-sub-functio">Unicast-Forward Sub-function</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a class="xref" href="#section-3.5">3.5</a>.  <a class="xref" href="#name-maintenance-sub-function">Maintenance Sub-function</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6">
                <p id="section-toc.1-1.3.2.6.1"><a class="xref" href="#section-3.6">3.6</a>.  <a class="xref" href="#name-flood-to-remote-pes-handlin">Flood (to Remote PEs) Handling</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7">
                <p id="section-toc.1-1.3.2.7.1"><a class="xref" href="#section-3.7">3.7</a>.  <a class="xref" href="#name-duplicate-ip-detection">Duplicate IP Detection</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="xref" href="#section-4">4</a>.  <a class="xref" href="#name-solution-benefits">Solution Benefits</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="xref" href="#section-5">5</a>.  <a class="xref" href="#name-deployment-scenarios">Deployment Scenarios</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a class="xref" href="#section-5.1">5.1</a>.  <a class="xref" href="#name-all-dynamic-learning">All Dynamic Learning</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a class="xref" href="#section-5.2">5.2</a>.  <a class="xref" href="#name-dynamic-learning-with-proxy">Dynamic Learning with Proxy ARP/ND</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a class="xref" href="#section-5.3">5.3</a>.  <a class="xref" href="#name-hybrid-dynamic-learning-and">Hybrid Dynamic Learning and Static Provisioning with Proxy ARP/ND</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a class="xref" href="#section-5.4">5.4</a>.  <a class="xref" href="#name-all-static-provisioning-wit">All Static Provisioning with Proxy ARP/ND</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5">
                <p id="section-toc.1-1.5.2.5.1"><a class="xref" href="#section-5.5">5.5</a>.  <a class="xref" href="#name-example-of-deployment-in-in">Example of Deployment in Internet Exchange Points</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.6">
                <p id="section-toc.1-1.5.2.6.1"><a class="xref" href="#section-5.6">5.6</a>.  <a class="xref" href="#name-example-of-deployment-in-da">Example of Deployment in Data Centers</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="xref" href="#section-6">6</a>.  <a class="xref" href="#name-security-considerations">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="xref" href="#section-7">7</a>.  <a class="xref" href="#name-iana-considerations">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="xref" href="#section-8">8</a>.  <a class="xref" href="#name-references">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a class="xref" href="#section-8.1">8.1</a>.  <a class="xref" href="#name-normative-references">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a class="xref" href="#section-8.2">8.2</a>.  <a class="xref" href="#name-informative-references">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="xref" href="#appendix-A"></a><a class="xref" href="#name-acknowledgments">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a class="xref" href="#appendix-B"></a><a class="xref" href="#name-contributors">Contributors</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a class="xref" href="#appendix-C"></a><a class="xref" href="#name-authors-addresses">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="sect-2">
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">As specified in <span>[<a class="xref" href="#RFC7432">RFC7432</a>]</span>, the IP
      Address field in the Ethernet Virtual Private Network (EVPN) Media
      Access Control (MAC) / IP Advertisement route may optionally carry one
      of the IP addresses associated with the MAC address. A Provider Edge (PE) may learn
      local IP-&gt;MAC pairs and advertise them in EVPN MAC/IP Advertisement
      routes. Remote PEs importing those routes in the same Broadcast Domain
      (BD) may add those IP-&gt;MAC pairs to their Proxy ARP/ND tables and
      reply to local ARP Requests or Neighbor Solicitations (or
      "unicast-forward" those packets to the owner MAC), reducing and even
      suppressing, in some cases, the flooding in the EVPN network.<a class="pilcrow" href="#section-1-1">¶</a></p>
<p id="section-1-2">EVPN and its associated Proxy ARP/ND function are extremely useful in
      Data Centers (DCs) or Internet Exchange Points (IXPs) with large Broadcast Domains,
      where the amount of ARP/ND flooded traffic causes issues on connected
      routers and Customer Edges (CEs). <span>[<a class="xref" href="#RFC6820">RFC6820</a>]</span> describes the address
      resolution problems in large DC networks.<a class="pilcrow" href="#section-1-2">¶</a></p>
<p id="section-1-3">This document describes the Proxy ARP/ND function in <span>[<a class="xref" href="#RFC7432">RFC7432</a>]</span> networks, augmented by the
      capability of the ARP/ND Extended Community <span>[<a class="xref" href="#RFC9047">RFC9047</a>]</span>. From that perspective, this document updates <span>[<a class="xref" href="#RFC7432">RFC7432</a>]</span>.<a class="pilcrow" href="#section-1-3">¶</a></p>
<p id="section-1-4">Proxy ARP/ND may be implemented to help IXPs, DCs, and other operators
      deal with the issues derived from address resolution in large Broadcast
      Domains.<a class="pilcrow" href="#section-1-4">¶</a></p>
<div id="sect-2.1">
<section id="section-1.1">
        <h3 id="name-the-data-center-use-case">
<a class="section-number selfRef" href="#section-1.1">1.1. </a><a class="section-name selfRef" href="#name-the-data-center-use-case">The Data Center Use Case</a>
        </h3>
<p id="section-1.1-1">As described in <span>[<a class="xref" href="#RFC6820">RFC6820</a>]</span>, the IPv4
        and IPv6 address resolution can create a lot of issues in large
        DCs. In particular, the issues created by IPv4 Address
        Resolution Protocol procedures may be significant.<a class="pilcrow" href="#section-1.1-1">¶</a></p>
<p id="section-1.1-2">On one hand, ARP Requests use broadcast MAC addresses; therefore,
        any Tenant System in a large Broadcast Domain will see a large amount
        of ARP traffic, which is not addressed to most of the receivers.<a class="pilcrow" href="#section-1.1-2">¶</a></p>
<p id="section-1.1-3">On the other hand, the flooding issue becomes even worse if some
        Tenant Systems disappear from the Broadcast Domain, since some
        implementations will persistently retry sending ARP Requests. As <span>[<a class="xref" href="#RFC6820">RFC6820</a>]</span> states, there are no clear
        requirements for retransmitting ARP Requests in the absence of
        replies; hence, an implementation may choose to keep retrying endlessly
        even if there are no replies.<a class="pilcrow" href="#section-1.1-3">¶</a></p>
<p id="section-1.1-4">The amount of flooding that address resolution creates can be
        mitigated by the use of EVPN and its Proxy ARP/ND function.<a class="pilcrow" href="#section-1.1-4">¶</a></p>
</section>
</div>
<div id="sect-2.2">
<section id="section-1.2">
        <h3 id="name-the-internet-exchange-point">
<a class="section-number selfRef" href="#section-1.2">1.2. </a><a class="section-name selfRef" href="#name-the-internet-exchange-point">The Internet Exchange Point Use Case</a>
        </h3>
<p id="section-1.2-1">The implementation described in this document is especially useful
        in IXP networks.<a class="pilcrow" href="#section-1.2-1">¶</a></p>
<p id="section-1.2-2">A typical IXP provides access to a large Layer 2 Broadcast Domain
        for peering purposes (referred to as "the peering network"), where
        (hundreds of) Internet routers are connected. We refer to these
        Internet routers as CE devices in this section.
        Because of the requirement to connect all routers to a single Layer 2
        network, the peering networks use IPv4 addresses in length ranges from
        /21 to /24 (and even bigger for IPv6), which can create very large
        Broadcast Domains.

 This peering network is transparent to the CEs and
        therefore floods any ARP Requests or NS messages to all the CEs in the
        network. Gratuitous ARP and NA messages are flooded to all the CEs
        too.<a class="pilcrow" href="#section-1.2-2">¶</a></p>
<p id="section-1.2-3">In these IXP networks, most of the CEs are typically peering
        routers and roughly all the Broadcast, Unknown Unicast, and Multicast
        (BUM) traffic is originated by the ARP and ND address resolution
        procedures. This ARP/ND BUM traffic causes significant data volumes
        that reach every single router in the peering network. Since the
        ARP/ND messages are processed in "slow path" software processors and
        they take high priority in the routers, heavy loads of ARP/ND traffic
        can cause some routers to run out of resources. CEs disappearing from
        the network may cause address resolution explosions that can make a
        router with limited processing power fail to keep BGP sessions
        running.<a class="pilcrow" href="#section-1.2-3">¶</a></p>
<p id="section-1.2-4">The issue might be better in IPv6 routers if Multicast Listener
        Discovery (MLD) snooping was enabled, since ND uses an SN-multicast
        address in NS messages; however, ARP uses broadcast and has to be
        processed by all the routers in the network. Some routers may also be
        configured to broadcast periodic Gratuitous ARPs (GARPs) <span>[<a class="xref" href="#RFC5227">RFC5227</a>]</span>. For IPv6, the fact that IPv6 CEs
        have more than one IPv6 address contributes to the growth of ND
        flooding in the network. The amount of ARP/ND flooded traffic grows
        linearly with the number of IXP participants; therefore, the issue can
        only grow worse as new CEs are added.<a class="pilcrow" href="#section-1.2-4">¶</a></p>
<p id="section-1.2-5">In order to deal with this issue, IXPs have developed certain
        solutions over the past years. While these solutions may mitigate the
        issues of address resolution in large Broadcast Domains, EVPN
        provides new more efficient possibilities to IXPs. EVPN and its
        Proxy ARP/ND function may help solve the issue in a distributed and
        scalable way, fully integrated with the PE network.<a class="pilcrow" href="#section-1.2-5">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-1">
<section id="section-2">
      <h2 id="name-terminology">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-terminology">Terminology</a>
      </h2>
<p id="section-2-1">
    The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
    "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
    described in BCP 14 <span>[<a class="xref" href="#RFC2119">RFC2119</a>]</span> <span>[<a class="xref" href="#RFC8174">RFC8174</a>]</span> 
    when, and only when, they appear in all capitals, as shown here.<a class="pilcrow" href="#section-2-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2-2">
        <dt id="section-2-2.1">ARP:
        </dt>
        <dd id="section-2-2.2" style="margin-left: 6.0em">Address Resolution Protocol<a class="pilcrow" href="#section-2-2.2">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.3">AS-MAC:
        </dt>
        <dd id="section-2-2.4" style="margin-left: 6.0em">Anti-spoofing MAC. It is a special MAC configured on all the
   PEs attached to the same BD and used for the duplicate IP detection
   procedures.<a class="pilcrow" href="#section-2-2.4">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.5">BD: 
        </dt>
        <dd id="section-2-2.6" style="margin-left: 6.0em">Broadcast Domain<a class="pilcrow" href="#section-2-2.6">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.7">BUM:
        </dt>
        <dd id="section-2-2.8" style="margin-left: 6.0em">Broadcast, Unknown Unicast, and Multicast Layer 2 traffic<a class="pilcrow" href="#section-2-2.8">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.9">CE:
        </dt>
        <dd id="section-2-2.10" style="margin-left: 6.0em">Customer Edge router<a class="pilcrow" href="#section-2-2.10">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.11">DAD:
        </dt>
        <dd id="section-2-2.12" style="margin-left: 6.0em">Duplicate Address Detection, as per <span>[<a class="xref" href="#RFC4861">RFC4861</a>]</span><a class="pilcrow" href="#section-2-2.12">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.13">DC:
        </dt>
        <dd id="section-2-2.14" style="margin-left: 6.0em">Data Center<a class="pilcrow" href="#section-2-2.14">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.15">EVI:
        </dt>
        <dd id="section-2-2.16" style="margin-left: 6.0em">EVPN Instance<a class="pilcrow" href="#section-2-2.16">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.17">EVPN:
        </dt>
        <dd id="section-2-2.18" style="margin-left: 6.0em">Ethernet Virtual Private Network, as per <span>[<a class="xref" href="#RFC7432">RFC7432</a>]</span><a class="pilcrow" href="#section-2-2.18">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.19">GARP:
        </dt>
        <dd id="section-2-2.20" style="margin-left: 6.0em">Gratuitous ARP<a class="pilcrow" href="#section-2-2.20">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.21">IP-&gt;MAC:
        </dt>
        <dd id="section-2-2.22" style="margin-left: 6.0em">An IP address associated to a MAC address. IP-&gt;MAC entries are
   programmed in Proxy ARP/ND tables and may be of three different
   types: dynamic, static, or EVPN-learned.<a class="pilcrow" href="#section-2-2.22">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.23">IXP: 
        </dt>
        <dd id="section-2-2.24" style="margin-left: 6.0em">Internet Exchange Point<a class="pilcrow" href="#section-2-2.24">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.25">IXP-LAN:
        </dt>
        <dd id="section-2-2.26" style="margin-left: 6.0em">The IXP's large Broadcast Domain to where Internet routers are connected.<a class="pilcrow" href="#section-2-2.26">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.27">LAG:
        </dt>
        <dd id="section-2-2.28" style="margin-left: 6.0em">Link Aggregation Group<a class="pilcrow" href="#section-2-2.28">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.29">MAC or IP DA:
        </dt>
        <dd id="section-2-2.30" style="margin-left: 6.0em">MAC or IP Destination Address<a class="pilcrow" href="#section-2-2.30">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.31">MAC or IP SA: 
        </dt>
        <dd id="section-2-2.32" style="margin-left: 6.0em">MAC or IP Source Address<a class="pilcrow" href="#section-2-2.32">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.33">ND: 
        </dt>
        <dd id="section-2-2.34" style="margin-left: 6.0em">Neighbor Discovery<a class="pilcrow" href="#section-2-2.34">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.35">NS:
        </dt>
        <dd id="section-2-2.36" style="margin-left: 6.0em">Neighbor Solicitation<a class="pilcrow" href="#section-2-2.36">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.37">NA:
        </dt>
        <dd id="section-2-2.38" style="margin-left: 6.0em">Neighbor Advertisement<a class="pilcrow" href="#section-2-2.38">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.39">NUD:
        </dt>
        <dd id="section-2-2.40" style="margin-left: 6.0em">Neighbor Unreachability Detection, as per <span>[<a class="xref" href="#RFC4861">RFC4861</a>]</span><a class="pilcrow" href="#section-2-2.40">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.41">O Flag:
        </dt>
        <dd id="section-2-2.42" style="margin-left: 6.0em">Override Flag in NA messages, as per <span>[<a class="xref" href="#RFC4861">RFC4861</a>]</span><a class="pilcrow" href="#section-2-2.42">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.43">PE:
        </dt>
        <dd id="section-2-2.44" style="margin-left: 6.0em">Provider Edge router<a class="pilcrow" href="#section-2-2.44">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.45">R Flag:
        </dt>
        <dd id="section-2-2.46" style="margin-left: 6.0em">Router Flag in NA messages, as per <span>[<a class="xref" href="#RFC4861">RFC4861</a>]</span><a class="pilcrow" href="#section-2-2.46">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.47">RT2:
        </dt>
        <dd id="section-2-2.48" style="margin-left: 6.0em">EVPN Route type 2 or EVPN MAC/IP Advertisement route, as per
   <span>[<a class="xref" href="#RFC7432">RFC7432</a>]</span><a class="pilcrow" href="#section-2-2.48">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.49">S Flag:
        </dt>
        <dd id="section-2-2.50" style="margin-left: 6.0em">Solicited Flag in NA messages, as per <span>[<a class="xref" href="#RFC4861">RFC4861</a>]</span><a class="pilcrow" href="#section-2-2.50">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.51">SN-multicast address:
        </dt>
        <dd id="section-2-2.52" style="margin-left: 6.0em">Solicited-Node IPv6 multicast address used by NS messages<a class="pilcrow" href="#section-2-2.52">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.53">TLLA: 
        </dt>
        <dd id="section-2-2.54" style="margin-left: 6.0em">Target Link Layer Address, as per <span>[<a class="xref" href="#RFC4861">RFC4861</a>]</span><a class="pilcrow" href="#section-2-2.54">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.55">VPLS:
        </dt>
        <dd id="section-2-2.56" style="margin-left: 6.0em">Virtual Private LAN Service<a class="pilcrow" href="#section-2-2.56">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-2-3">This document assumes familiarity with the terminology used in <span>[<a class="xref" href="#RFC7432">RFC7432</a>]</span>.<a class="pilcrow" href="#section-2-3">¶</a></p>
</section>
</div>
<div id="sect-4">
<section id="section-3">
      <h2 id="name-solution-description">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-solution-description">Solution Description</a>
      </h2>
<p id="section-3-1"><a class="xref" href="#ure-proxy-arp-nd-network-example">Figure 1</a> illustrates an
      example EVPN network where the Proxy ARP/ND function is enabled.<a class="pilcrow" href="#section-3-1">¶</a></p>
<span id="name-proxy-arp-nd-network-exampl"></span><div id="ure-proxy-arp-nd-network-example">
<figure id="figure-1">
        <div class="alignLeft art-text artwork" id="section-3-2.1">
<pre>                                                      BD1
                                                  Proxy ARP/ND
                                                 +------------+
IP1/M1          +----------------------------+   |IP1-&gt;M1 EVPN|
 GARP ---&gt;Proxy ARP/ND                       |   |IP2-&gt;M2 EVPN|
+---+      +--------+   RT2(IP1/M1)          |   |IP3-&gt;M3 sta |
|CE1+------|   BD1  |    ------&gt;      +------+---|IP4-&gt;M4 dyn |
+---+      +--------+                 |          +------------+
               PE1                    | +--------+ Who has IP1?
                |           EVPN      | |   BD1  | &lt;-----  +---+
                |           EVI1      | |        | -----&gt;  |CE3|
IP2/M2          |                     | |        | IP1-&gt;M1 +---+
 GARP  ---&gt;Proxy ARP/ND               | +--------+   |    IP3/M3
  +---+    +--------+   RT2(IP2/M2)   |              |
  |CE2+----|   BD1  |    ------&gt;      +--------------+
  +---+    +--------+                       PE3|    +---+
               PE2                           | +----+CE4|
                +----------------------------+      +---+
                                              &lt;---IP4/M4 GARP
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-1">Figure 1</a>:
<a class="selfRef" href="#name-proxy-arp-nd-network-exampl">Proxy ARP/ND Network Example</a>
        </figcaption></figure>
</div>
<p id="section-3-3">When the Proxy ARP/ND function is enabled in a BD (Broadcast Domain)
      of the EVPN PEs, each PE creates a Proxy table specific to that BD that
      can contain three types of Proxy ARP/ND entries:<a class="pilcrow" href="#section-3-3">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-3-4">
        <dt id="section-3-4.1">Dynamic entries:
        </dt>
        <dd id="section-3-4.2" style="margin-left: 1.5em">Learned by snooping a CE's ARP and ND messages; for instance,
 see IP4-&gt;M4 in <a class="xref" href="#ure-proxy-arp-nd-network-example">Figure 1</a>.<a class="pilcrow" href="#section-3-4.2">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-4.3">Static entries:
        </dt>
        <dd id="section-3-4.4" style="margin-left: 1.5em">Provisioned on the PE by the management system; for instance,
 see IP3-&gt;M3 in <a class="xref" href="#ure-proxy-arp-nd-network-example">Figure 1</a>.<a class="pilcrow" href="#section-3-4.4">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-4.5">EVPN-learned entries:
        </dt>
        <dd id="section-3-4.6" style="margin-left: 1.5em">Learned from the IP/MAC information encoded in the received RT2's
 coming from remote PEs; for instance, see IP1-&gt;M1 and IP2-&gt;M2 in
 <a class="xref" href="#ure-proxy-arp-nd-network-example">Figure 1</a>.<a class="pilcrow" href="#section-3-4.6">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-3-5">As a high-level example, the operation of the EVPN Proxy ARP/ND function in
the network of <a class="xref" href="#ure-proxy-arp-nd-network-example">Figure 1</a> is described below. In this example, we assume IP1, IP2, and
IP3 are IPv4 addresses:<a class="pilcrow" href="#section-3-5">¶</a></p>
<ol class="normal type-1" id="section-3-6" start="1" type="1">
       <li id="section-3-6.1">Proxy ARP/ND is enabled in BD1 of PE1, PE2, and PE3.<a class="pilcrow" href="#section-3-6.1">¶</a>
</li>
        <li id="section-3-6.2">
          <p id="section-3-6.2.1">The PEs start adding dynamic, static, and EVPN-learned entries to
          their Proxy tables:<a class="pilcrow" href="#section-3-6.2.1">¶</a></p>
<ol class="normal type-a" id="section-3-6.2.2" start="1" type="a">
            <li id="section-3-6.2.2.1">PE3 adds IP1-&gt;M1 and IP2-&gt;M2 based on the EVPN routes
              received from PE1 and PE2. Those entries were previously learned
              as dynamic entries in PE1 and PE2, respectively, and advertised
              in BGP EVPN.<a class="pilcrow" href="#section-3-6.2.2.1">¶</a>
</li>
            <li id="section-3-6.2.2.2">PE3 adds IP4-&gt;M4 as dynamic. This entry is learned by
              snooping the corresponding ARP messages sent by CE4.<a class="pilcrow" href="#section-3-6.2.2.2">¶</a>
</li>
            <li id="section-3-6.2.2.3">An operator also provisions the static entry IP3-&gt;M3.<a class="pilcrow" href="#section-3-6.2.2.3">¶</a>
</li>
          </ol>
</li>
        <li id="section-3-6.3">
          <p id="section-3-6.3.1">When CE3 sends an ARP Request asking for the MAC address of IP1,
          PE3 will:<a class="pilcrow" href="#section-3-6.3.1">¶</a></p>
<ol class="normal type-a" id="section-3-6.3.2" start="1" type="a">
            <li id="section-3-6.3.2.1">Intercept the ARP Request and perform a Proxy ARP lookup for
              IP1.<a class="pilcrow" href="#section-3-6.3.2.1">¶</a>
</li>
            <li id="section-3-6.3.2.2">If the lookup is successful (as in <a class="xref" href="#ure-proxy-arp-nd-network-example">Figure 1</a>), PE3 will send an
              ARP Reply with IP1-&gt;M1. The ARP Request will not be flooded
              to the EVPN network or any other local CEs.<a class="pilcrow" href="#section-3-6.3.2.2">¶</a>
</li>
            <li id="section-3-6.3.2.3">If the lookup is not successful, PE3 will flood the ARP
              Request in the EVPN network and the other local CEs.<a class="pilcrow" href="#section-3-6.3.2.3">¶</a>
</li>
          </ol>
</li>
      </ol>
<p id="section-3-7">In the same example, if we assume IP1, IP2, IP3, and IP4 are now IPv6
      addresses and Proxy ARP/ND is enabled in BD1:<a class="pilcrow" href="#section-3-7">¶</a></p>
<ol class="normal type-1" id="section-3-8" start="1" type="1">
<li id="section-3-8.1">
          <p id="section-3-8.1.1">PEs will start adding entries in a similar way as they would for IPv4;
          however, there are some differences:<a class="pilcrow" href="#section-3-8.1.1">¶</a></p>
<ol class="normal type-a" id="section-3-8.1.2" start="1" type="a">
<li id="section-3-8.1.2.1">IP1-&gt;M1 and IP2-&gt;M2 are
          learned as dynamic entries in PE1 and PE2, respectively, by snooping
          NA messages and not by snooping NS messages. In the IPv4 case, any
          ARP frame can be snooped to learn the dynamic Proxy ARP entry. When
          learning the dynamic entries, the R and O Flags contained in the
          snooped NA messages will be added to the Proxy ND entries too.<a class="pilcrow" href="#section-3-8.1.2.1">¶</a>
</li>
            <li id="section-3-8.1.2.2">PE1 and PE2 will advertise those entries in EVPN MAC/IP
              Advertisement routes, including the corresponding learned R and
              O Flags in the ARP/ND Extended Community.<a class="pilcrow" href="#section-3-8.1.2.2">¶</a>
</li>
            <li id="section-3-8.1.2.3">PE3 also adds IP4-&gt;M4 as dynamic after snooping an NA
              message sent by CE4.<a class="pilcrow" href="#section-3-8.1.2.3">¶</a>
</li>
          </ol>
</li>
        <li id="section-3-8.2">When CE3 sends an NS message asking for the MAC address of IP1,
          PE3 behaves as in the IPv4 example, by intercepting the NS, performing a
          lookup on the IP, and replying with an NA if the lookup is
          successful. If it is successful, the NS is not flooded to the EVPN
          PEs or any other local CEs.<a class="pilcrow" href="#section-3-8.2">¶</a>
</li>
        <li id="section-3-8.3">If the lookup is not successful, PE3 will flood the NS to remote
          EVPN PEs attached to the same BD and the other local CEs as in the
          IPv4 case.<a class="pilcrow" href="#section-3-8.3">¶</a>
</li>
      </ol>
<p id="section-3-9">As PE3 learns more and more host entries in the Proxy ARP/ND table,
      the flooding of ARP Request messages among PEs is reduced and in some
      cases, it can even be suppressed. In a network where most of the
      participant CEs are not moving between PEs and are advertising their
      presence with GARPs or unsolicited-NA messages, the ARP/ND flooding
      among PEs, as well as the unknown unicast flooding, can practically be
      suppressed. In an EVPN-based IXP network, where all the entries are
      static, the ARP/ND flooding among PEs is in fact totally suppressed.<a class="pilcrow" href="#section-3-9">¶</a></p>
<p id="section-3-10">In a network where CEs move between PEs, the Proxy ARP/ND function
      relies on the CE signaling its new location via GARP or unsolicited-NA
      messages so that tables are immediately updated. If a CE moves
      "silently", that is, without issuing any GARP or NA message upon getting
      attached to the destination PE, the mechanisms described in <a class="xref" href="#sect-4.4">Section 3.5</a> make sure that the Proxy ARP/ND tables are
      eventually updated.<a class="pilcrow" href="#section-3-10">¶</a></p>
<section id="section-3.1">
        <h3 id="name-proxy-arp-nd-sub-functions">
<a class="section-number selfRef" href="#section-3.1">3.1. </a><a class="section-name selfRef" href="#name-proxy-arp-nd-sub-functions">Proxy ARP/ND Sub-functions</a>
        </h3>
<p id="section-3.1-1">The Proxy ARP/ND function can be structured in six sub-functions or
        procedures:<a class="pilcrow" href="#section-3.1-1">¶</a></p>
<ol class="normal type-1" id="section-3.1-2" start="1" type="1">
<li id="section-3.1-2.1">Learning sub-function<a class="pilcrow" href="#section-3.1-2.1">¶</a>
</li>
          <li id="section-3.1-2.2">Reply sub-function<a class="pilcrow" href="#section-3.1-2.2">¶</a>
</li>
          <li id="section-3.1-2.3">Unicast-forward sub-function<a class="pilcrow" href="#section-3.1-2.3">¶</a>
</li>
          <li id="section-3.1-2.4">Maintenance sub-function<a class="pilcrow" href="#section-3.1-2.4">¶</a>
</li>
          <li id="section-3.1-2.5">Flood handling sub-function<a class="pilcrow" href="#section-3.1-2.5">¶</a>
</li>
          <li id="section-3.1-2.6">Duplicate IP detection sub-function<a class="pilcrow" href="#section-3.1-2.6">¶</a>
</li>
        </ol>
<p id="section-3.1-3">A Proxy ARP/ND implementation <span class="bcp14">MUST</span> at least support
        the Learning, Reply, Maintenance, and duplicate IP detection
        sub-functions. The following sections describe each individual
        sub-function.<a class="pilcrow" href="#section-3.1-3">¶</a></p>
</section>
<div id="sect-4.1">
<section id="section-3.2">
        <h3 id="name-learning-sub-function">
<a class="section-number selfRef" href="#section-3.2">3.2. </a><a class="section-name selfRef" href="#name-learning-sub-function">Learning Sub-function</a>
        </h3>
<p id="section-3.2-1">A Proxy ARP/ND implementation in an EVPN BD <span class="bcp14">MUST</span>
        support dynamic and EVPN-learned entries and <span class="bcp14">SHOULD</span>
        support static entries.<a class="pilcrow" href="#section-3.2-1">¶</a></p>
<p id="section-3.2-2">Static entries are provisioned from the management plane. A static
        entry is configured on the PE attached to the host using the IP
        address in that entry. The provisioned static IP-&gt;MAC entry
        <span class="bcp14">MUST</span> be advertised in EVPN with an ARP/ND Extended
        Community where the Immutable ARP/ND Binding Flag (I) is set to 1, as
        per <span>[<a class="xref" href="#RFC9047">RFC9047</a>]</span>. When the I Flag in the
        ARP/ND Extended Community is 1, the advertising PE indicates that the
        IP address must not be associated to a MAC other than the one included
        in the EVPN MAC/IP Advertisement route. The advertisement of I = 1 in
        the ARP/ND Extended Community is compatible with any value of the
        Sticky bit (S) or sequence number in the <span>[<a class="xref" href="#RFC7432">RFC7432</a>]</span> MAC Mobility Extended Community. Note that the
        I bit in the ARP/ND Extended Community refers to the immutable
        configured association between the IP and the MAC address in the
        IP-&gt;MAC binding, whereas the S bit in the MAC Mobility Extended
        Community refers to the fact that the advertised MAC address is not
        subject to the <span>[<a class="xref" href="#RFC7432">RFC7432</a>]</span> mobility
        procedures.<a class="pilcrow" href="#section-3.2-2">¶</a></p>
<p id="section-3.2-3">An entry may associate a configured static IP to a list of
        potential MACs, i.e., IP1-&gt;(MAC1,MAC2..MACN). Until a frame
        (including a local ARP/NA message) is received from the CE, the PE will
        not advertise any IP1-&gt;MAC in EVPN. Upon receiving traffic from the
        CE, the PE will check that the source MAC, e.g., MAC1, is included in
        the list of allowed MACs. Only in that case, the PE will activate the
        IP1-&gt;MAC1 and advertise only that IP1 and MAC1 in an EVPN MAC/IP
        Advertisement route.<a class="pilcrow" href="#section-3.2-3">¶</a></p>
<p id="section-3.2-4">The PE <span class="bcp14">MUST</span> create EVPN-learned entries from the received valid
        EVPN MAC/IP Advertisement routes containing a MAC and IP address.<a class="pilcrow" href="#section-3.2-4">¶</a></p>
<p id="section-3.2-5">Dynamic entries are learned in different ways depending on whether
        the entry contains an IPv4 or IPv6 address:<a class="pilcrow" href="#section-3.2-5">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-3.2-6">
          <dt id="section-3.2-6.1">Proxy ARP dynamic entries:
          </dt>
          <dd id="section-3.2-6.2" style="margin-left: 1.5em">The PE <span class="bcp14">MUST</span> snoop all ARP packets (that is, all
   frames with Ethertype 0x0806) received from the CEs attached to the
   BD in order to learn dynamic entries. ARP packets received from
   remote EVPN PEs attached to the same BD are not snooped. The
   Learning function will add the sender MAC and sender IP of the
   snooped ARP packet to the Proxy ARP table. Note that a MAC or an IP
   address with value 0 <span class="bcp14">SHOULD NOT</span> be learned.<a class="pilcrow" href="#section-3.2-6.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.2-6.3">Proxy ND dynamic entries:
          </dt>
          <dd id="section-3.2-6.4" style="margin-left: 1.5em">
            <p id="section-3.2-6.4.1">The PE <span class="bcp14">MUST</span> snoop the NA messages (Ethertype
     0x86dd, ICMPv6 type 136) received from the CEs attached to the BD
     and learn dynamic entries from the Target Address and TLLA
     information.  NA messages received from remote EVPN PEs are not
     snooped. A PE implementing Proxy ND as in this document
     <span class="bcp14">MUST NOT</span> create dynamic IP-&gt;MAC entries from NS
     messages because they don't contain the R Flag required by the
     Proxy ND reply function.  See <a class="xref" href="#sect-4.1.1">Section 3.2.1</a> for more information about the R Flag.<a class="pilcrow" href="#section-3.2-6.4.1">¶</a></p>
<p id="section-3.2-6.4.2">This document specifies an "anycast" capability that can be
     configured for the Proxy ND function of the PE and affects how
     dynamic Proxy ND entries are learned based on the O Flag of the
     snooped NA messages. If the O Flag is zero in the received NA
     message, the IP-&gt;MAC <span class="bcp14">SHOULD</span> only be learned in
     case the IPv6 "anycast" capability is enabled in the BD.
     Irrespective, an NA message with O Flag = 0 will be normally
     forwarded by the PE based on a MAC DA lookup.<a class="pilcrow" href="#section-3.2-6.4.2">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-3.2-7">The following procedure associated to the Learning sub-function is
        <span class="bcp14">RECOMMENDED</span>:<a class="pilcrow" href="#section-3.2-7">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-8.1">When a new Proxy ARP/ND EVPN or static active entry is learned
            (or provisioned), the PE <span class="bcp14">SHOULD</span> send a GARP or unsolicited-NA
            message to all the connected access CEs. The PE <span class="bcp14">SHOULD</span> send a GARP
            or unsolicited-NA message for dynamic entries only if the ARP/NA
            message that previously created the entry on the PE was NOT
            flooded to all the local connected CEs before. This
            GARP/unsolicited-NA message makes sure the CE ARP/ND caches are
            updated even if the ARP/NS/NA messages from CEs connected to
            remote PEs are not flooded in the EVPN network.<a class="pilcrow" href="#section-3.2-8.1">¶</a>
</li>
        </ul>
<p id="section-3.2-9">Note that if a static entry is provisioned with the same IP as an
        existing EVPN-learned or dynamic entry, the static entry takes
        precedence.<a class="pilcrow" href="#section-3.2-9">¶</a></p>
<p id="section-3.2-10">In case of a PE reboot, the static and EVPN entries will be
        re-added as soon as the PE is back online and receives all the EVPN
        routes for the BD. However, the dynamic entries will be gone. Due to
        that reason, new NS and ARP Requests will be flooded by the PE to
        remote PEs and dynamic entries gradually relearned again.<a class="pilcrow" href="#section-3.2-10">¶</a></p>
<div id="sect-4.1.1">
<section id="section-3.2.1">
          <h4 id="name-proxy-nd-and-the-na-flags">
<a class="section-number selfRef" href="#section-3.2.1">3.2.1. </a><a class="section-name selfRef" href="#name-proxy-nd-and-the-na-flags">Proxy ND and the NA Flags</a>
          </h4>
<p id="section-3.2.1-1"><span>[<a class="xref" href="#RFC4861">RFC4861</a>]</span> describes the use of the R Flag in IPv6
          address resolution:<a class="pilcrow" href="#section-3.2.1-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.1-2.1">Nodes capable of routing IPv6 packets must reply to NS
            messages with NA messages where the R Flag is set (R Flag = 1).<a class="pilcrow" href="#section-3.2.1-2.1">¶</a>
</li>
            <li class="normal" id="section-3.2.1-2.2">Hosts that are not able to route IPv6 packets must indicate
              that inability by replying with NA messages that contain R
              Flag = 0.<a class="pilcrow" href="#section-3.2.1-2.2">¶</a>
</li>
          </ul>
<p id="section-3.2.1-3">The use of the R Flag in NA messages has an impact on how hosts
          select their default gateways when sending packets off-link, as per
          <span>[<a class="xref" href="#RFC4861">RFC4861</a>]</span>:<a class="pilcrow" href="#section-3.2.1-3">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.1-4.1">Hosts build a Default Router List based on the received RAs
              and NAs with R Flag = 1. Each cache entry has an IsRouter flag,
              which must be set for received RAs and is set based on the R
              Flag in the received NAs. A host can choose one or more Default
              Routers when sending packets off-link.<a class="pilcrow" href="#section-3.2.1-4.1">¶</a>
</li>
            <li class="normal" id="section-3.2.1-4.2">In those cases where the IsRouter flag changes from TRUE to
            FALSE as a result of an NA update, the node must remove that
            router from the Default Router List and update the Destination
            Cache entries for all destinations using that neighbor as a
            router, as specified in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc4861#section-7.3.3">Section 7.3.3</a> of [<a class="xref" href="#RFC4861">RFC4861</a>]</span>. This is needed to detect when
            a node that is used as a router stops forwarding packets due to
            being configured as a host.<a class="pilcrow" href="#section-3.2.1-4.2">¶</a>
</li>
          </ul>
<p id="section-3.2.1-5">The R and O Flags for a Proxy ARP/ND entry will be learned in
          the following ways:<a class="pilcrow" href="#section-3.2.1-5">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.1-6.1">The R Flag information <span class="bcp14">SHOULD</span> be added to the
            static entries by the management interface. The O Flag information
            <span class="bcp14">MAY</span> also be added by the management interface. If
            the R and O Flags are not configured, the default value is 1.<a class="pilcrow" href="#section-3.2.1-6.1">¶</a>
</li>
            <li class="normal" id="section-3.2.1-6.2">Dynamic entries <span class="bcp14">SHOULD</span> learn the R Flag and
            <span class="bcp14">MAY</span> learn the O Flag from the snooped NA messages
            used to learn the IP-&gt;MAC itself.<a class="pilcrow" href="#section-3.2.1-6.2">¶</a>
</li>
            <li class="normal" id="section-3.2.1-6.3">EVPN-learned entries <span class="bcp14">SHOULD</span> learn the R Flag
            and <span class="bcp14">MAY</span> learn the O Flag from the ARP/ND Extended
            Community <span>[<a class="xref" href="#RFC9047">RFC9047</a>]</span> received from
            EVPN along with the RT2 used to learn the IP-&gt;MAC itself. If no
            ARP/ND Extended Community is received, the PE will add a
            configured R Flag / O Flag to the entry. These configured R and O
            Flags <span class="bcp14">MAY</span> be an administrative choice with a
            default value of 1. The configuration of this administrative
            choice provides a backwards-compatible option with EVPN PEs that
            follow <span>[<a class="xref" href="#RFC7432">RFC7432</a>]</span> but do not
            support this specification.<a class="pilcrow" href="#section-3.2.1-6.3">¶</a>
</li>
          </ul>
<p id="section-3.2.1-7">Note that, typically, IP-&gt;MAC entries with O = 0 will not be
          learned; therefore, the Proxy ND function will reply to NS
          messages with NA messages that contain O = 1. However, this document
          allows the configuration of the "anycast" capability in the BD where
          the Proxy ND function is enabled. If "anycast" is enabled in the BD
          and an NA message with O = 0 is received, the associated IP-&gt;MAC
          entry will be learned with O = 0. If this "anycast" capability is
          enabled in the BD, duplicate IP detection must be disabled so that
          the PE is able to learn the same IP mapped to different MACs in the
          same Proxy ND table. If the "anycast" capability is disabled, NA
          messages with O Flag = 0 will not create a Proxy ND entry (although
          they will be forwarded normally); hence, no EVPN advertisement with
          ARP/ND Extended Community will be generated.<a class="pilcrow" href="#section-3.2.1-7">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-4.2">
<section id="section-3.3">
        <h3 id="name-reply-sub-function">
<a class="section-number selfRef" href="#section-3.3">3.3. </a><a class="section-name selfRef" href="#name-reply-sub-function">Reply Sub-function</a>
        </h3>
<p id="section-3.3-1">This sub-function will reply to address resolution
        requests/solicitations upon successful lookup in the Proxy ARP/ND
        table for a given IP address. The following considerations should be
        taken into account, assuming that the ARP Request / NS lookup hits a
        Proxy ARP/ND entry IP1-&gt;MAC1:<a class="pilcrow" href="#section-3.3-1">¶</a></p>
<ol class="normal type-a" id="section-3.3-2" start="1" type="a">
<li id="section-3.3-2.1">
            <p id="section-3.3-2.1.1">When replying to ARP Requests or NS messages:<a class="pilcrow" href="#section-3.3-2.1.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3-2.1.2.1">The PE <span class="bcp14">SHOULD</span> use the Proxy ARP/ND entry MAC
              address MAC1 as MAC SA. This is <span class="bcp14">RECOMMENDED</span> so
              that the resolved MAC can be learned in the MAC forwarding
              database of potential Layer 2 switches sitting between the PE
              and the CE requesting the address resolution.<a class="pilcrow" href="#section-3.3-2.1.2.1">¶</a>
</li>
              <li class="normal" id="section-3.3-2.1.2.2">For an ARP reply, the PE <span class="bcp14">MUST</span> use the
              Proxy ARP entry IP1 and MAC1 addresses in the sender Protocol
              Address and Hardware Address fields, respectively.<a class="pilcrow" href="#section-3.3-2.1.2.2">¶</a>
</li>
              <li class="normal" id="section-3.3-2.1.2.3">For an NA message in response to an address resolution NS or
              DAD NS, the PE <span class="bcp14">MUST</span> use IP1 as the IP SA and
              Target Address. M1 <span class="bcp14">MUST</span> be used as the Target
              Link Local Address (TLLA).<a class="pilcrow" href="#section-3.3-2.1.2.3">¶</a>
</li>
            </ul>
</li>
          <li id="section-3.3-2.2">A PE <span class="bcp14">SHOULD NOT</span> reply to a request/solicitation received on the
            same attachment circuit over which the IP-&gt;MAC is learned. In
            this case, the requester and the requested IP are assumed to be
            connected to the same Layer 2 CE/access network linked to the PE's
            attachment circuit; therefore, the requested IP owner will
            receive the request directly.<a class="pilcrow" href="#section-3.3-2.2">¶</a>
</li>
          <li id="section-3.3-2.3">A PE <span class="bcp14">SHOULD</span> reply to broadcast/multicast address resolution
            messages, i.e., ARP Requests, ARP probes, NS messages, as well as
            DAD NS messages. An ARP probe is an ARP Request constructed with
            an all-zero sender IP address that may be used by hosts for IPv4
            Address Conflict Detection as specified in <span>[<a class="xref" href="#RFC5227">RFC5227</a>]</span>. A PE <span class="bcp14">SHOULD NOT</span> reply to unicast address
            resolution requests (for instance, NUD NS messages).<a class="pilcrow" href="#section-3.3-2.3">¶</a>
</li>
          <li id="section-3.3-2.4">
            <p id="section-3.3-2.4.1">When replying to an NS, a PE <span class="bcp14">SHOULD</span> set the Flags in the NA
            messages as follows:<a class="pilcrow" href="#section-3.3-2.4.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3-2.4.2.1">The R bit is set as it was learned for the IP-&gt;MAC entry
                in the NA messages that created the entry (see <a class="xref" href="#sect-4.1.1">Section 3.2.1</a>).<a class="pilcrow" href="#section-3.3-2.4.2.1">¶</a>
</li>
              <li class="normal" id="section-3.3-2.4.2.2">The S Flag will be set/unset as per <span>[<a class="xref" href="#RFC4861">RFC4861</a>]</span>.<a class="pilcrow" href="#section-3.3-2.4.2.2">¶</a>
</li>
              <li class="normal" id="section-3.3-2.4.2.3">The O Flag will be set in all the NA messages issued by the
              PE except in the case in which the BD is configured with the
              "anycast" capability and the entry was previously learned with
              O = 0. If "anycast" is enabled and there is more than one MAC for
              a given IP in the Proxy ND table, the PE will reply to NS
              messages with as many NA responses as "anycast" entries there
              are in the Proxy ND table.<a class="pilcrow" href="#section-3.3-2.4.2.3">¶</a>
</li>
            </ul>
</li>
          <li id="section-3.3-2.5">For Proxy ARP, a PE <span class="bcp14">MUST</span> only reply to ARP Requests with the
            format specified in <span>[<a class="xref" href="#RFC0826">RFC0826</a>]</span>.<a class="pilcrow" href="#section-3.3-2.5">¶</a>
</li>
          <li id="section-3.3-2.6">
            <p id="section-3.3-2.6.1">For Proxy ND, a PE <span class="bcp14">MUST</span> reply to NS messages
            with known options with the format and options specified in <span>[<a class="xref" href="#RFC4861">RFC4861</a>]</span> and <span class="bcp14">MAY</span> reply,
            discard, forward, or unicast-forward NS messages containing other
            options. An administrative choice to control the behavior for
            received NS messages with unknown options ("reply", "discard",
            "unicast-forward", or "forward") <span class="bcp14">MAY</span> be
            supported.<a class="pilcrow" href="#section-3.3-2.6.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3-2.6.2.1">The "reply" option implies that the PE ignores the unknown
                options and replies with NA messages, assuming a successful
                lookup on the Proxy ND table. An unsuccessful lookup will
                result in a "forward" behavior (i.e., flood the NS
                message based on the MAC DA).<a class="pilcrow" href="#section-3.3-2.6.2.1">¶</a>
</li>
              <li class="normal" id="section-3.3-2.6.2.2">If "discard" is available, the operator should assess if
              flooding NS unknown options may be a security risk for the EVPN
              BD (and if so, enable "discard") or, on the contrary, if not
              forwarding/flooding NS unknown options may disrupt
              connectivity. This option discards NS messages with unknown
              options irrespective of the result of the lookup on the
              Proxy ND table.<a class="pilcrow" href="#section-3.3-2.6.2.2">¶</a>
</li>
              <li class="normal" id="section-3.3-2.6.2.3">The "unicast-forward" option is described in <a class="xref" href="#sect-4.3">Section 3.4</a>.<a class="pilcrow" href="#section-3.3-2.6.2.3">¶</a>
</li>
              <li class="normal" id="section-3.3-2.6.2.4">The "forward" option implies flooding the NS message based
                on the MAC DA. This option forwards NS messages with unknown
                options irrespective of the result of the lookup on the
                Proxy ND table. The "forward" option is <span class="bcp14">RECOMMENDED</span> by this
                document.<a class="pilcrow" href="#section-3.3-2.6.2.4">¶</a>
</li>
            </ul>
</li>
        </ol>
</section>
</div>
<div id="sect-4.3">
<section id="section-3.4">
        <h3 id="name-unicast-forward-sub-functio">
<a class="section-number selfRef" href="#section-3.4">3.4. </a><a class="section-name selfRef" href="#name-unicast-forward-sub-functio">Unicast-Forward Sub-function</a>
        </h3>
<p id="section-3.4-1">As discussed in <a class="xref" href="#sect-4.2">Section 3.3</a>, in some cases, the
        operator may want to "unicast-forward" certain ARP Requests and NS
        messages as opposed to reply to them. The implementation of a
        "unicast-forward" function is <span class="bcp14">RECOMMENDED</span>. This option can be enabled
        with one of the following parameters:<a class="pilcrow" href="#section-3.4-1">¶</a></p>
<ol class="normal type-a" id="section-3.4-2" start="1" type="a">
<li id="section-3.4-2.1">unicast-forward always<a class="pilcrow" href="#section-3.4-2.1">¶</a>
</li>
          <li id="section-3.4-2.2">unicast-forward unknown-options<a class="pilcrow" href="#section-3.4-2.2">¶</a>
</li>
        </ol>
<p id="section-3.4-3">If "unicast-forward always" is enabled, the PE will perform a
        Proxy ARP/ND table lookup and, in case of a hit, the PE will forward
        the packet to the owner of the MAC found in the Proxy ARP/ND table.
        This is irrespective of the options carried in the ARP/ND packet. This
        option provides total transparency in the BD and yet reduces the
        amount of flooding significantly.<a class="pilcrow" href="#section-3.4-3">¶</a></p>
<p id="section-3.4-4">If "unicast-forward unknown-options" is enabled, upon a successful
        Proxy ARP/ND lookup, the PE will perform a "unicast-forward" action
        only if the ARP Requests or NS messages carry unknown options, as
        explained in <a class="xref" href="#sect-4.2">Section 3.3</a>. The "unicast-forward
        unknown-options" configuration allows the support of new applications
        using ARP/ND in the BD while still reducing the flooding.<a class="pilcrow" href="#section-3.4-4">¶</a></p>
<p id="section-3.4-5">Irrespective of the enabled option, if there is no successful
        Proxy ARP/ND lookup, the unknown ARP Request / NS message will be flooded in the
        context of the BD, as per <a class="xref" href="#sect-4.5">Section 3.6</a>.<a class="pilcrow" href="#section-3.4-5">¶</a></p>
</section>
</div>
<div id="sect-4.4">
<section id="section-3.5">
        <h3 id="name-maintenance-sub-function">
<a class="section-number selfRef" href="#section-3.5">3.5. </a><a class="section-name selfRef" href="#name-maintenance-sub-function">Maintenance Sub-function</a>
        </h3>
<p id="section-3.5-1">The Proxy ARP/ND tables <span class="bcp14">SHOULD</span> follow a number of maintenance
        procedures so that the dynamic IP-&gt;MAC entries are kept if the
        owner is active and flushed (and the associated RT2 withdrawn) or if the
        owner is no longer in the network. The following procedures are
        <span class="bcp14">RECOMMENDED</span>:<a class="pilcrow" href="#section-3.5-1">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-3.5-2">
          <dt id="section-3.5-2.1">Age-time:
          </dt>
          <dd id="section-3.5-2.2" style="margin-left: 1.5em">A dynamic Proxy ARP/ND entry <span class="bcp14">MUST</span> be flushed out
   of the table if the IP-&gt;MAC has not been refreshed within a given
   age-time. The entry is refreshed if an ARP or NA message is received
   for the same IP-&gt;MAC entry. The age-time is an administrative
   option, and its value should be carefully chosen depending on the
   specific use case; in IXP networks (where the CE routers are fairly
   static), the age-time may normally be longer than in DC networks
   (where mobility is required).<a class="pilcrow" href="#section-3.5-2.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.5-2.3">Send-refresh option:
          </dt>
          <dd id="section-3.5-2.4" style="margin-left: 1.5em">
            <p id="section-3.5-2.4.1">The PE <span class="bcp14">MAY</span> send periodic refresh messages
            (ARP/ND "probes") to the owners of the dynamic Proxy ARP/ND
            entries, so that the entries can be refreshed before they age
            out. The owner of the IP-&gt;MAC entry would reply to the ARP/ND
            probe and the corresponding entry age-time reset.  The periodic
            send-refresh timer is an administrative option and is
            <span class="bcp14">RECOMMENDED</span> to be a third of the age-time or a half
            of the age-time in scaled networks.<a class="pilcrow" href="#section-3.5-2.4.1">¶</a></p>
<p id="section-3.5-2.4.2">An ARP refresh issued by the PE will be an ARP Request message
            with the sender's IP = 0 sent from the PE's MAC SA. If the PE has
            an IP address in the subnet, for instance, on an Integrated Routing
            and Bridging (IRB) interface, then it <span class="bcp14">MAY</span> use it as
            a source for the ARP Request (instead of sender's IP = 0). An ND
            refresh will be an NS message issued from the PE's MAC SA and a
            Link Local Address associated to the PE's MAC.<a class="pilcrow" href="#section-3.5-2.4.2">¶</a></p>
<p id="section-3.5-2.4.3">The refresh request messages <span class="bcp14">SHOULD</span> be sent only
            for dynamic entries and not for static or EVPN-learned
            entries. Even though the refresh request messages are broadcast or
            multicast, the PE <span class="bcp14">SHOULD</span> only send the message to
            the attachment circuit associated to the MAC in the IP-&gt;MAC
            entry.<a class="pilcrow" href="#section-3.5-2.4.3">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-3.5-3">The age-time and send-refresh options are used in EVPN networks to avoid
unnecessary EVPN RT2 withdrawals; if refresh messages are sent before the
corresponding BD Bridge-Table and Proxy ARP/ND age-time for a given entry
expires, inactive but existing hosts will reply, refreshing the entry and
therefore avoiding unnecessary EVPN MAC/IP Advertisement withdrawals in
EVPN. Both entries (MAC in the BD and IP-&gt;MAC in the Proxy ARP/ND) are reset
when the owner replies to the ARP/ND probe. If there is no response to the
ARP/ND probe, the MAC and IP-&gt;MAC entries will be legitimately flushed and
the RT2s withdrawn.<a class="pilcrow" href="#section-3.5-3">¶</a></p>
</section>
</div>
<div id="sect-4.5">
<section id="section-3.6">
        <h3 id="name-flood-to-remote-pes-handlin">
<a class="section-number selfRef" href="#section-3.6">3.6. </a><a class="section-name selfRef" href="#name-flood-to-remote-pes-handlin">Flood (to Remote PEs) Handling</a>
        </h3>
<p id="section-3.6-1">The Proxy ARP/ND function implicitly helps reduce the flooding of
        ARP Requests and NS messages to remote PEs in an EVPN network. However,
        in certain use cases, the flooding of ARP/NS/NA messages (and even the
        unknown unicast flooding) to remote PEs can be suppressed completely
        in an EVPN network.<a class="pilcrow" href="#section-3.6-1">¶</a></p>
<p id="section-3.6-2">For instance, in an IXP network, since all the participant CEs are
        well known and will not move to a different PE, the IP-&gt;MAC entries
        for the local CEs may be all provisioned on the PEs by a management
        system. Assuming the entries for the CEs are all provisioned on the
        local PE, a given Proxy ARP/ND table will only contain static and
        EVPN-learned entries. In this case, the operator may choose to
        suppress the flooding of ARP/NS/NA from the local PE to the remote PEs
        completely.<a class="pilcrow" href="#section-3.6-2">¶</a></p>
<p id="section-3.6-3">The flooding may also be suppressed completely in IXP networks with
        dynamic Proxy ARP/ND entries assuming that all the CEs are directly
        connected to the PEs and that they all advertise their presence with a
        GARP/unsolicited-NA when they connect to the network. If any of those
        two assumptions are not true and any of the PEs may not learn all the
        local Proxy ARP/ND entries, flooding of the ARP/NS/NA messages from
        the local PE to the remote PEs <span class="bcp14">SHOULD NOT</span> be suppressed, or the
        address resolution process for some CEs will not be completed.<a class="pilcrow" href="#section-3.6-3">¶</a></p>
<p id="section-3.6-4">In networks where fast mobility is expected (DC use case), it is
        <span class="bcp14">NOT RECOMMENDED</span> to suppress the flooding of unknown ARP Requests / NS messages or
        GARPs/unsolicited-NAs. Unknown ARP Requests / NS messages refer to those
        ARP Requests / NS messages for which the Proxy ARP/ND lookups for the
        requested IPs do not succeed.<a class="pilcrow" href="#section-3.6-4">¶</a></p>
<p id="section-3.6-5">In order to give the operator the choice to suppress/allow the
        flooding to remote PEs, a PE <span class="bcp14">MAY</span> support administrative options to
        individually suppress/allow the flooding of:<a class="pilcrow" href="#section-3.6-5">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.6-6.1">Unknown ARP Requests and NS messages.<a class="pilcrow" href="#section-3.6-6.1">¶</a>
</li>
          <li class="normal" id="section-3.6-6.2">GARP and unsolicited-NA messages.<a class="pilcrow" href="#section-3.6-6.2">¶</a>
</li>
        </ul>
<p id="section-3.6-7">The operator will use these options based on the expected behavior
        on the CEs.<a class="pilcrow" href="#section-3.6-7">¶</a></p>
</section>
</div>
<div id="sect-4.6">
<section id="section-3.7">
        <h3 id="name-duplicate-ip-detection">
<a class="section-number selfRef" href="#section-3.7">3.7. </a><a class="section-name selfRef" href="#name-duplicate-ip-detection">Duplicate IP Detection</a>
        </h3>
<p id="section-3.7-1">The Proxy ARP/ND function <span class="bcp14">MUST</span> support duplicate IP
        detection as per this section so that ARP/ND-spoofing attacks or
        duplicate IPs due to human errors can be detected. For IPv6 addresses,
        CEs will continue to carry out the DAD procedures as per <span>[<a class="xref" href="#RFC4862">RFC4862</a>]</span>. The solution described in this
        section is an additional security mechanism carried out by the PEs
        that guarantees IPv6 address moves between PEs are legitimate and not
        the result of an attack. <span>[<a class="xref" href="#RFC6957">RFC6957</a>]</span>
        describes a solution for the IPv6 Duplicate Address Detection Proxy;
        however, it is defined for point-to-multipoint topologies with a
        split-horizon forwarding, where the "CEs" have no direct communication
        within the same L2 link; therefore, it is not suitable for EVPN
        Broadcast Domains. In addition, the solution described in this section
        includes the use of the AS-MAC for additional security.<a class="pilcrow" href="#section-3.7-1">¶</a></p>
<p id="section-3.7-2">ARP/ND spoofing is a technique whereby an attacker sends "fake"
        ARP/ND messages onto a Broadcast Domain. Generally, the aim is to
        associate the attacker's MAC address with the IP address of another
        host causing any traffic meant for that IP address to be sent to the
        attacker instead.<a class="pilcrow" href="#section-3.7-2">¶</a></p>
<p id="section-3.7-3">The distributed nature of EVPN and Proxy ARP/ND allows the easy
        detection of duplicated IPs in the network in a similar way to the
        MAC duplication detection function supported by <span>[<a class="xref" href="#RFC7432">RFC7432</a>]</span> for MAC addresses.<a class="pilcrow" href="#section-3.7-3">¶</a></p>
<p id="section-3.7-4">Duplicate IP detection monitors "IP-moves" in the Proxy ARP/ND
        table in the following way:<a class="pilcrow" href="#section-3.7-4">¶</a></p>
<ol class="normal type-a" id="section-3.7-5" start="1" type="a">
<li id="section-3.7-5.1">When an existing active IP1-&gt;MAC1
        entry is modified, a PE starts an M-second timer (default value of
        M = 180), and if it detects N IP moves before the timer expires (default
        value of N = g5), it concludes that a duplicate IP situation has
        occurred. An IP move is considered when, for instance, IP1-&gt;MAC1 is
        replaced by IP1-&gt;MAC2 in the Proxy ARP/ND table. Static IP-&gt;MAC
        entries, i.e., locally provisioned or EVPN-learned entries with I = 1
        in the ARP/ND Extended Community, are not subject to this
        procedure. Static entries <span class="bcp14">MUST NOT</span> be overridden by
        dynamic Proxy ARP/ND entries.<a class="pilcrow" href="#section-3.7-5.1">¶</a>
</li>
          <li id="section-3.7-5.2">
            <p id="section-3.7-5.2.1">In order to detect the duplicate IP faster, the PE
            <span class="bcp14">SHOULD</span> send a Confirm message to the former owner
            of the IP. A Confirm message is a unicast ARP Request / NS message
            sent by the PE to the MAC addresses that previously owned the IP,
            when the MAC changes in the Proxy ARP/ND table. The Confirm
            message uses a sender's IP 0.0.0.0 in case of ARP (if the PE has
            an IP address in the subnet, then it <span class="bcp14">MAY</span> use it)
            and an IPv6 Link Local Address in case of NS.  If the PE does not
            receive an answer within a given time, the new entry will be
            confirmed and activated. The default <span class="bcp14">RECOMMENDED</span>
            time to receive the confirmation is 30 seconds. In case of
            spoofing, for instance, if IP1-&gt;MAC1 moves to IP1-&gt;MAC2, the
            PE may send a unicast ARP Request / NS message for IP1 with MAC DA
            = MAC1 and MAC SA = PE's MAC. This will force the legitimate owner
            to respond if the move to MAC2 was spoofed and make the PE issue
            another Confirm message, this time to MAC DA = MAC2.

     If both, the legitimate owner and spoofer keep replying to the
     Confirm message. The PE would then detect the duplicate IP within the
     M-second timer, and a response would be triggered as follows:<a class="pilcrow" href="#section-3.7-5.2.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.7-5.2.2.1">If the IP1-&gt;MAC1 pair was previously owned by the
                spoofer and the new IP1-&gt;MAC2 was from a valid CE, then the
                issued Confirm message would trigger a response from the
                spoofer.<a class="pilcrow" href="#section-3.7-5.2.2.1">¶</a>
</li>
              <li class="normal" id="section-3.7-5.2.2.2">If it were the other way around, that is, IP1-&gt;MAC1 was
                previously owned by a valid CE, the Confirm message would
                trigger a response from the CE.<a class="pilcrow" href="#section-3.7-5.2.2.2">¶</a>
</li>
            </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.7-5.2.3.1">Either way, if this process continues, then
                duplicate detection will kick in.<a class="pilcrow" href="#section-3.7-5.2.3.1">¶</a>
</li>
            </ul>
</li>
          <li id="section-3.7-5.3">
            <p id="section-3.7-5.3.1">Upon detecting a duplicate IP situation:<a class="pilcrow" href="#section-3.7-5.3.1">¶</a></p>
<ol class="normal type-1" id="section-3.7-5.3.2" start="1" type="1">
<li id="section-3.7-5.3.2.1">The entry in duplicate detected
            state cannot be updated with new dynamic or EVPN-learned entries
            for the same IP. The operator <span class="bcp14">MAY</span> override the
            entry, though, with a static IP-&gt;MAC.<a class="pilcrow" href="#section-3.7-5.3.2.1">¶</a>
</li>
              <li id="section-3.7-5.3.2.2">The PE <span class="bcp14">SHOULD</span> alert the operator and stop responding to
                ARP/NS for the duplicate IP until a corrective action is
                taken.<a class="pilcrow" href="#section-3.7-5.3.2.2">¶</a>
</li>
              <li id="section-3.7-5.3.2.3">Optionally, the PE <span class="bcp14">MAY</span> associate an
              "anti-spoofing-mac" (AS-MAC) to the duplicate IP in the
              Proxy ARP/ND table. The PE will send a GARP/unsolicited-NA
              message with IP1-&gt;AS-MAC to the local CEs as well as an RT2
              (with IP1-&gt;AS-MAC) to the remote PEs. This will update the
              ARP/ND caches on all the CEs in the BD; hence, all the CEs in
              the BD will use the AS-MAC as MAC DA when sending traffic to
              IP1. This procedure prevents the spoofer from attracting any
              traffic for IP1. Since the AS-MAC is a managed MAC address known
              by all the PEs in the BD, all the PEs <span class="bcp14">MAY</span> apply
              filters to drop and/or log any frame with MAC DA = AS-MAC. The
              advertisement of the AS-MAC as a "drop-MAC" (by using an
              indication in the RT2) that can be used directly in the BD to
              drop frames is for further study.<a class="pilcrow" href="#section-3.7-5.3.2.3">¶</a>
</li>
            </ol>
</li>
          <li id="section-3.7-5.4">The duplicate IP situation will be cleared when a corrective
            action is taken by the operator or, alternatively, after a
            HOLD-DOWN timer (default value of 540 seconds).<a class="pilcrow" href="#section-3.7-5.4">¶</a>
</li>
        </ol>
<p id="section-3.7-6">The values of M, N, and HOLD-DOWN timer <span class="bcp14">SHOULD</span> be a configurable
        administrative option to allow for the required flexibility in
        different scenarios.<a class="pilcrow" href="#section-3.7-6">¶</a></p>
<p id="section-3.7-7">For Proxy ND, the duplicate IP detection described in this section
        <span class="bcp14">SHOULD</span> only monitor IP moves for IP-&gt;MACs learned from NA messages
        with O Flag = 1. NA messages with O Flag = 0 would not override the ND
        cache entries for an existing IP; therefore, the procedure in this
        section would not detect duplicate IPs. This duplicate IP detection
        for IPv6 <span class="bcp14">SHOULD</span> be disabled when the IPv6 "anycast" capability is
        activated in a given BD.<a class="pilcrow" href="#section-3.7-7">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-5">
<section id="section-4">
      <h2 id="name-solution-benefits">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-solution-benefits">Solution Benefits</a>
      </h2>
<p id="section-4-1">The solution described in this document provides the following
      benefits:<a class="pilcrow" href="#section-4-1">¶</a></p>
<ol class="normal type-a" id="section-4-2" start="1" type="a">
 <li id="section-4-2.1">May completely suppress
      the flooding of the ARP/ND messages in the EVPN network, assuming that
      all the CE IP-&gt;MAC addresses local to the PEs are known or
      provisioned on the PEs from a management system. Note that in this case,
      the unknown unicast flooded traffic can also be suppressed, since all
      the expected unicast traffic will be destined to known MAC addresses in
      the PE BDs.<a class="pilcrow" href="#section-4-2.1">¶</a>
</li>
        <li id="section-4-2.2">Significantly reduces the flooding of the ARP/ND
          messages in the EVPN network, assuming that some or all the CE
          IP-&gt;MAC addresses are learned on the data plane by snooping
          ARP/ND messages issued by the CEs.<a class="pilcrow" href="#section-4-2.2">¶</a>
</li>
        <li id="section-4-2.3">Provides a way to refresh periodically the CE
          IP-&gt;MAC entries learned through the data plane so that the
          IP-&gt;MAC entries are not withdrawn by EVPN when they age out
          unless the CE is not active anymore. This option helps reducing the
          EVPN control plane overhead in a network with active CEs that do not
          send packets frequently.<a class="pilcrow" href="#section-4-2.3">¶</a>
</li>
        <li id="section-4-2.4">Provides a mechanism to detect duplicate IP addresses and avoid
          ARP/ND-spoof attacks or the effects of duplicate addresses due to
          human errors.<a class="pilcrow" href="#section-4-2.4">¶</a>
</li>
      </ol>
</section>
</div>
<div id="sect-6">
<section id="section-5">
      <h2 id="name-deployment-scenarios">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-deployment-scenarios">Deployment Scenarios</a>
      </h2>
<p id="section-5-1">Four deployment scenarios with different levels of ARP/ND control are
      available to operators using this solution depending on their
      requirements to manage ARP/ND: all dynamic learning, all dynamic
      learning with Proxy ARP/ND, hybrid dynamic learning and static
      provisioning with Proxy ARP/ND, and all static provisioning with
      Proxy ARP/ND.<a class="pilcrow" href="#section-5-1">¶</a></p>
<div id="sect-6.1">
<section id="section-5.1">
        <h3 id="name-all-dynamic-learning">
<a class="section-number selfRef" href="#section-5.1">5.1. </a><a class="section-name selfRef" href="#name-all-dynamic-learning">All Dynamic Learning</a>
        </h3>
<p id="section-5.1-1">In this scenario for minimum security and mitigation, EVPN is
        deployed in the BD with the Proxy ARP/ND function shutdown. PEs do not
        intercept ARP/ND requests and flood all requests issued by the CEs as
        a conventional Layer 2 network among those CEs would suffice. While no
        ARP/ND mitigation is used in this scenario, the operator can still
        take advantage of EVPN features such as control plane learning and
        all-active multihoming in the peering network.<a class="pilcrow" href="#section-5.1-1">¶</a></p>
<p id="section-5.1-2">Although this option does not require any of the procedures
        described in this document, it is added as a baseline/default option for
        completeness. This option is equivalent to VPLS as far as ARP/ND is
        concerned. The options described in Sections <a class="xref" href="#sect-6.2">5.2</a>, <a class="xref" href="#sect-6.3">5.3</a>, and <a class="xref" href="#sect-6.4">5.4</a> are only possible in
        EVPN networks in combination with their Proxy ARP/ND capabilities.<a class="pilcrow" href="#section-5.1-2">¶</a></p>
</section>
</div>
<div id="sect-6.2">
<section id="section-5.2">
        <h3 id="name-dynamic-learning-with-proxy">
<a class="section-number selfRef" href="#section-5.2">5.2. </a><a class="section-name selfRef" href="#name-dynamic-learning-with-proxy">Dynamic Learning with Proxy ARP/ND</a>
        </h3>
<p id="section-5.2-1">This scenario minimizes flooding while enabling dynamic learning of
        IP-&gt;MAC entries. The Proxy ARP/ND function is enabled in the BDs of
        the EVPN PEs so that the PEs snoop ARP/ND messages issued by the CEs
        and respond to CE ARP Requests / NS messages.<a class="pilcrow" href="#section-5.2-1">¶</a></p>
<p id="section-5.2-2">PEs will flood requests if the entry is not in their Proxy table.
        Any unknown source IP-&gt;MAC entries will be learned and advertised
        in EVPN, and traffic to unknown entries is discarded at the ingress
        PE.<a class="pilcrow" href="#section-5.2-2">¶</a></p>
<p id="section-5.2-3">This scenario makes use of the Learning, Reply, and Maintenance
        sub-functions, with an optional use of the Unicast-forward and
        duplicate IP detection sub-functions. The Flood handling sub-function
        uses default flooding for unknown ARP Requests / NS messages.<a class="pilcrow" href="#section-5.2-3">¶</a></p>
</section>
</div>
<div id="sect-6.3">
<section id="section-5.3">
        <h3 id="name-hybrid-dynamic-learning-and">
<a class="section-number selfRef" href="#section-5.3">5.3. </a><a class="section-name selfRef" href="#name-hybrid-dynamic-learning-and">Hybrid Dynamic Learning and Static Provisioning with Proxy ARP/ND</a>
        </h3>
<p id="section-5.3-1">Some IXPs and other operators want to protect particular hosts on
        the BD while allowing dynamic learning of CE addresses. For example,
        an operator may want to configure static IP-&gt;MAC entries for
        management and infrastructure hosts that provide critical services. In
        this scenario, static entries are provisioned from the management
        plane for protected IP-&gt;MAC addresses, and dynamic learning with
        Proxy ARP/ND is enabled as described in <a class="xref" href="#sect-6.2">Section 5.2</a> on
        the BD.<a class="pilcrow" href="#section-5.3-1">¶</a></p>
<p id="section-5.3-2">This scenario makes use of the same sub-functions as in <a class="xref" href="#sect-6.2">Section 5.2</a> but with static entries added by
        the Learning sub-function.<a class="pilcrow" href="#section-5.3-2">¶</a></p>
</section>
</div>
<div id="sect-6.4">
<section id="section-5.4">
        <h3 id="name-all-static-provisioning-wit">
<a class="section-number selfRef" href="#section-5.4">5.4. </a><a class="section-name selfRef" href="#name-all-static-provisioning-wit">All Static Provisioning with Proxy ARP/ND</a>
        </h3>
<p id="section-5.4-1">For a solution that maximizes security and eliminates flooding and
        unknown unicast in the peering network, all IP-&gt;MAC entries are
        provisioned from the management plane. The Proxy ARP/ND function is
        enabled in the BDs of the EVPN PEs so that the PEs intercept and
        respond to CE requests.
 Dynamic learning and ARP/ND snooping is
        disabled so that ARP Requests and NS messages to unknown IPs are discarded at
        the ingress PE. This scenario provides an operator the most control
        over IP-&gt;MAC entries and allows an operator to manage all entries
        from a management system.<a class="pilcrow" href="#section-5.4-1">¶</a></p>
<p id="section-5.4-2">In this scenario, the Learning sub-function is limited to static
        entries, the Maintenance sub-function will not require any procedures
        due to the static entries, and the Flood handling sub-function will
        completely suppress unknown ARP Requests / NS messages as well as GARP
        and unsolicited-NA messages.<a class="pilcrow" href="#section-5.4-2">¶</a></p>
</section>
</div>
<div id="sect-6.5">
<section id="section-5.5">
        <h3 id="name-example-of-deployment-in-in">
<a class="section-number selfRef" href="#section-5.5">5.5. </a><a class="section-name selfRef" href="#name-example-of-deployment-in-in">Example of Deployment in Internet Exchange Points</a>
        </h3>
<p id="section-5.5-1">Nowadays, almost all IXPs install some security rules in order to
        protect the peering network (BD). These rules are often called port
        security. Port security summarizes different operational steps that
        limit the access to the IXP-LAN and the customer router and controls
        the kind of traffic that the routers are allowed to exchange (e.g.,
        Ethernet, IPv4, and IPv6). Due to this, the deployment scenario as
        described in <a class="xref" href="#sect-6.4">Section 5.4</a>, "All Static
        Provisioning with Proxy ARP/ND", is the predominant scenario for
        IXPs.<a class="pilcrow" href="#section-5.5-1">¶</a></p>
<p id="section-5.5-2">In addition to the "All Static Provisioning" behavior, in IXP
        networks it is recommended to configure the Reply sub-function to
        "discard" ARP Requests / NS messages with unrecognized options.<a class="pilcrow" href="#section-5.5-2">¶</a></p>
<p id="section-5.5-3">At IXPs, customers usually follow a certain operational life cycle.
        For each step of the operational life cycle, specific operational
        procedures are executed.<a class="pilcrow" href="#section-5.5-3">¶</a></p>
<p id="section-5.5-4">The following describes the operational procedures that are needed
        to guarantee port security throughout the life cycle of a customer
        with focus on EVPN features:<a class="pilcrow" href="#section-5.5-4">¶</a></p>
<ol class="normal type-1" id="section-5.5-5" start="1" type="1">
<li id="section-5.5-5.1">
            <p id="section-5.5-5.1.1">A new customer is connected the first time to the IXP:<a class="pilcrow" href="#section-5.5-5.1.1">¶</a></p>
<p id="section-5.5-5.1.2">Before the connection between the customer router
            and the IXP-LAN is activated, the MAC of the router is
            allowlisted on the IXP's switch port. All other MAC addresses are
            blocked. Pre-defined IPv4 and IPv6 addresses of the IXP peering
            network space are configured at the customer router. The
            IP-&gt;MAC static entries (IPv4 and IPv6) are configured in the
            management system of the IXP for the customer's port in order to
            support Proxy ARP/ND.<a class="pilcrow" href="#section-5.5-5.1.2">¶</a></p>
<p id="section-5.5-5.1.3">In case a customer uses multiple ports aggregated to a single
            logical port (LAG), some vendors randomly select the MAC address of
            the LAG from the different MAC addresses assigned to the ports. In
            this case, the static entry will be used and associated to a list of
            allowed MACs.<a class="pilcrow" href="#section-5.5-5.1.3">¶</a></p>
</li>
          <li id="section-5.5-5.2">
            <p id="section-5.5-5.2.1">Replacement of customer router:<a class="pilcrow" href="#section-5.5-5.2.1">¶</a></p>
<p id="section-5.5-5.2.2">If a customer router is about to be replaced, the new MAC
     address(es) must be installed in the management system in addition
     to the MAC address(es) of the currently connected router. This
     allows the customer to replace the router without any active
     involvement of the IXP operator. For this, static entries are also
     used. After the replacement takes place, the MAC address(es) of
     the replaced router can be removed.<a class="pilcrow" href="#section-5.5-5.2.2">¶</a></p>
</li>
          <li id="section-5.5-5.3">
            <p id="section-5.5-5.3.1">Decommissioning a customer router:<a class="pilcrow" href="#section-5.5-5.3.1">¶</a></p>
<p id="section-5.5-5.3.2">If a
            customer router is decommissioned, the router is disconnected from
            the IXP PE. Right after that, the MAC address(es) of the router
            and IP-&gt;MAC bindings can be removed from the management
            system.<a class="pilcrow" href="#section-5.5-5.3.2">¶</a></p>
</li>
        </ol>
</section>
</div>
<div id="sect-6.6">
<section id="section-5.6">
        <h3 id="name-example-of-deployment-in-da">
<a class="section-number selfRef" href="#section-5.6">5.6. </a><a class="section-name selfRef" href="#name-example-of-deployment-in-da">Example of Deployment in Data Centers</a>
        </h3>
<p id="section-5.6-1">DCs normally have different requirements than IXPs in terms of
        Proxy ARP/ND. Some differences are listed below:<a class="pilcrow" href="#section-5.6-1">¶</a></p>
<ol class="normal type-a" id="section-5.6-2" start="1" type="a">
<li id="section-5.6-2.1">The required mobility in virtualized
        DCs makes the "Dynamic Learning" or "Hybrid Dynamic and Static
        Provisioning" models more appropriate than the "All Static
        Provisioning" model.<a class="pilcrow" href="#section-5.6-2.1">¶</a>
</li>
          <li id="section-5.6-2.2">IPv6 "anycast" may be required in DCs, while it is typically not
          a requirement in IXP networks. Therefore, if the DC needs IPv6
          anycast addresses, the "anycast" capability will be explicitly
          enabled in the Proxy ND function and hence the Proxy ND sub-functions
          modified accordingly. For instance, if IPv6 "anycast" is enabled in
          the Proxy ND function, the duplicate IP detection procedure in <a class="xref" href="#sect-4.6">Section 3.7</a> must be disabled.<a class="pilcrow" href="#section-5.6-2.2">¶</a>
</li>
          <li id="section-5.6-2.3">DCs may require special options on ARP/ND as opposed to the
            address resolution function, which is the only one typically
            required in IXPs. Based on that, the Reply sub-function may be
            modified to forward or discard unknown options.<a class="pilcrow" href="#section-5.6-2.3">¶</a>
</li>
        </ol>
</section>
</div>
</section>
</div>
<div id="sect-7">
<section id="section-6">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<p id="section-6-1">The security considerations of <span>[<a class="xref" href="#RFC7432">RFC7432</a>]</span> and <span>[<a class="xref" href="#RFC9047">RFC9047</a>]</span> apply to this document too. Note that EVPN does not
      inherently provide cryptographic protection (including confidentiality
      protection).<a class="pilcrow" href="#section-6-1">¶</a></p>
<p id="section-6-2">The procedures in this document reduce the amount of ARP/ND message
      flooding, which in itself provides a protection to "slow path" software
      processors of routers and Tenant Systems in large BDs. The ARP/ND
      requests that are replied to by the Proxy ARP/ND function (hence not
      flooded) are normally targeted to existing hosts in the BD. ARP/ND
      requests targeted to absent hosts are still normally flooded; however,
      the suppression of unknown ARP Requests and NS messages described in
      <a class="xref" href="#sect-4.5">Section 3.6</a> can provide an additional
      level of security against ARP Requests / NS messages issued to
      non-existing hosts.<a class="pilcrow" href="#section-6-2">¶</a></p>
<p id="section-6-3">While the unicast-forward and/or flood suppression sub-functions
      provide an added security mechanism for the BD, they can also increase
      the risk of blocking the service for a CE if the EVPN PEs cannot provide
      the ARP/ND resolution that the CE needs.<a class="pilcrow" href="#section-6-3">¶</a></p>
<p id="section-6-4">The solution also provides protection against Denial-of-Service (DoS)
      attacks that use ARP/ND spoofing as a first step. The duplicate IP
      detection and the use of an AS-MAC as explained in <a class="xref" href="#sect-4.6">Section 3.7</a> protects the BD against ARP/ND
      spoofing.<a class="pilcrow" href="#section-6-4">¶</a></p>
<p id="section-6-5">The Proxy ARP/ND function specified in this document does not allow
      for the learning of an IP address mapped to multiple MAC addresses in
      the same table unless the "anycast" capability is enabled (and only in
      case of Proxy ND). When "anycast" is enabled in the Proxy ND function,
      the number of allowed entries for the same IP address
      <span class="bcp14">MUST</span> be limited by the operator to prevent DoS attacks
      that attempt to fill the Proxy ND table with a significant number of
      entries for the same IP.<a class="pilcrow" href="#section-6-5">¶</a></p>
<p id="section-6-6">This document provides some examples and guidelines that can be used
      by IXPs in their EVPN BDs. When EVPN and its associated Proxy ARP/ND
      function are used in IXP networks, they provide ARP/ND security and
      mitigation. IXPs must still employ additional security mechanisms that
      protect the peering network as per the established BCPs such as the ones
      described in <span>[<a class="xref" href="#EURO-IX-BCP">EURO-IX-BCP</a>]</span>. For example,
      IXPs should disable all unneeded control protocols and block unwanted
      protocols from CEs so that only IPv4, ARP, and IPv6 Ethertypes are
      permitted on the peering network. In addition, port security features
      and ACLs can provide an additional level of security.<a class="pilcrow" href="#section-6-6">¶</a></p>
<p id="section-6-7">Finally, it is worth noting that the Proxy ARP/ND solution in this
      document will not work if there is a mechanism securing ARP/ND exchanges
      among CEs because the PE is not able to secure the "proxied" ND
      messages.<a class="pilcrow" href="#section-6-7">¶</a></p>
</section>
</div>
<div id="sect-8">
<section id="section-7">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<p id="section-7-1">This document has no IANA actions.<a class="pilcrow" href="#section-7-1">¶</a></p>
</section>
</div>
<section id="section-8">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-8">8. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-8.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-8.1">8.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC0826">[RFC0826]</dt>
        <dd>
<span class="refAuthor">Plummer, D.</span>, <span class="refTitle">"An Ethernet Address Resolution Protocol: Or Converting Network Protocol Addresses to 48.bit Ethernet Address for Transmission on Ethernet Hardware"</span>, <span class="seriesInfo">STD 37</span>, <span class="seriesInfo">RFC 826</span>, <span class="seriesInfo">DOI 10.17487/RFC0826</span>, <time class="refDate" datetime="1982-11">November 1982</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc826">https://www.rfc-editor.org/info/rfc826</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time class="refDate" datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4861">[RFC4861]</dt>
        <dd>
<span class="refAuthor">Narten, T.</span>, <span class="refAuthor">Nordmark, E.</span>, <span class="refAuthor">Simpson, W.</span>, and <span class="refAuthor">H. Soliman</span>, <span class="refTitle">"Neighbor Discovery for IP version 6 (IPv6)"</span>, <span class="seriesInfo">RFC 4861</span>, <span class="seriesInfo">DOI 10.17487/RFC4861</span>, <time class="refDate" datetime="2007-09">September 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4861">https://www.rfc-editor.org/info/rfc4861</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5227">[RFC5227]</dt>
        <dd>
<span class="refAuthor">Cheshire, S.</span>, <span class="refTitle">"IPv4 Address Conflict Detection"</span>, <span class="seriesInfo">RFC 5227</span>, <span class="seriesInfo">DOI 10.17487/RFC5227</span>, <time class="refDate" datetime="2008-07">July 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5227">https://www.rfc-editor.org/info/rfc5227</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7432">[RFC7432]</dt>
        <dd>
<span class="refAuthor">Sajassi, A., Ed.</span>, <span class="refAuthor">Aggarwal, R.</span>, <span class="refAuthor">Bitar, N.</span>, <span class="refAuthor">Isaac, A.</span>, <span class="refAuthor">Uttaro, J.</span>, <span class="refAuthor">Drake, J.</span>, and <span class="refAuthor">W. Henderickx</span>, <span class="refTitle">"BGP MPLS-Based Ethernet VPN"</span>, <span class="seriesInfo">RFC 7432</span>, <span class="seriesInfo">DOI 10.17487/RFC7432</span>, <time class="refDate" datetime="2015-02">February 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7432">https://www.rfc-editor.org/info/rfc7432</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time class="refDate" datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9047">[RFC9047]</dt>
      <dd>
<span class="refAuthor">Rabadan, J., Ed.</span>, <span class="refAuthor">Sathappan, S.</span>, <span class="refAuthor">Nagaraj, K.</span>, and <span class="refAuthor">W. Lin</span>, <span class="refTitle">"Propagation of ARP/ND Flags in an Ethernet Virtual Private Network (EVPN)"</span>, <span class="seriesInfo">RFC 9047</span>, <span class="seriesInfo">DOI 10.17487/RFC9047</span>, <time class="refDate" datetime="2021-06">June 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9047">https://www.rfc-editor.org/info/rfc9047</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-8.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-8.2">8.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="EURO-IX-BCP">[EURO-IX-BCP]</dt>
        <dd>
<span class="refAuthor">Euro-IX</span>, <span class="refTitle">"European Internet Exchange Association"</span>, <span>&lt;<a href="https://www.euro-ix.net/en/forixps/set-ixp/ixp-bcops">https://www.euro-ix.net/en/forixps/set-ixp/ixp-bcops</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4862">[RFC4862]</dt>
        <dd>
<span class="refAuthor">Thomson, S.</span>, <span class="refAuthor">Narten, T.</span>, and <span class="refAuthor">T. Jinmei</span>, <span class="refTitle">"IPv6 Stateless Address Autoconfiguration"</span>, <span class="seriesInfo">RFC 4862</span>, <span class="seriesInfo">DOI 10.17487/RFC4862</span>, <time class="refDate" datetime="2007-09">September 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4862">https://www.rfc-editor.org/info/rfc4862</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6820">[RFC6820]</dt>
        <dd>
<span class="refAuthor">Narten, T.</span>, <span class="refAuthor">Karir, M.</span>, and <span class="refAuthor">I. Foo</span>, <span class="refTitle">"Address Resolution Problems in Large Data Center Networks"</span>, <span class="seriesInfo">RFC 6820</span>, <span class="seriesInfo">DOI 10.17487/RFC6820</span>, <time class="refDate" datetime="2013-01">January 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6820">https://www.rfc-editor.org/info/rfc6820</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6957">[RFC6957]</dt>
      <dd>
<span class="refAuthor">Costa, F.</span>, <span class="refAuthor">Combes, J-M., Ed.</span>, <span class="refAuthor">Pougnard, X.</span>, and <span class="refAuthor">H. Li</span>, <span class="refTitle">"Duplicate Address Detection Proxy"</span>, <span class="seriesInfo">RFC 6957</span>, <span class="seriesInfo">DOI 10.17487/RFC6957</span>, <time class="refDate" datetime="2013-06">June 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6957">https://www.rfc-editor.org/info/rfc6957</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="sect-10">
<section id="appendix-A">
      <h2 id="name-acknowledgments">
<a class="section-name selfRef" href="#name-acknowledgments">Acknowledgments</a>
      </h2>
<p id="appendix-A-1">The authors want to thank <span class="contact-name">Ranganathan       Boovaraghavan</span>, <span class="contact-name">Sriram Venkateswaran</span>, <span class="contact-name">Manish Krishnan</span>, <span class="contact-name">Seshagiri Venugopal</span>,
      <span class="contact-name">Tony Przygienda</span>, <span class="contact-name">Robert       Raszuk</span>, and <span class="contact-name">Iftekhar Hussain</span> for their review
      and contributions.  Thank you to <span class="contact-name">Oliver Knapp</span> as
      well for his detailed review.<a class="pilcrow" href="#appendix-A-1">¶</a></p>
</section>
</div>
<div id="sect-11">
<section id="appendix-B">
      <h2 id="name-contributors">
<a class="section-name selfRef" href="#name-contributors">Contributors</a>
      </h2>
<p id="appendix-B-1">In addition to the authors listed on the front page, the following
      coauthors have also contributed to this document:<a class="pilcrow" href="#appendix-B-1">¶</a></p>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Wim Henderickx</span></div>
<div class="left" dir="auto"><span class="org">Nokia</span></div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Daniel Melzer</span></div>
<div class="left" dir="auto"><span class="org">DE-CIX Management GmbH</span></div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Erik Nordmark</span></div>
<div class="left" dir="auto"><span class="org">Zededa</span></div>
</address>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-addresses">
<a class="section-name selfRef" href="#name-authors-addresses">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Jorge Rabadan (<span class="role">editor</span>)</span></div>
<div class="left" dir="auto"><span class="org">Nokia</span></div>
<div class="left" dir="auto"><span class="street-address">777 Middlefield Road</span></div>
<div class="left" dir="auto">
<span class="locality">Mountain View</span>, <span class="region">CA</span> <span class="postal-code">94043</span>
</div>
<div class="left" dir="auto"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:jorge.rabadan@nokia.com">jorge.rabadan@nokia.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Senthil Sathappan</span></div>
<div class="left" dir="auto"><span class="org">Nokia</span></div>
<div class="left" dir="auto"><span class="street-address">701 E. Middlefield Road</span></div>
<div class="left" dir="auto">
<span class="locality">Mountain View</span>, <span class="region">CA</span> <span class="postal-code">94043</span>
</div>
<div class="left" dir="auto"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:senthil.sathappan@nokia.com">senthil.sathappan@nokia.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Kiran Nagaraj</span></div>
<div class="left" dir="auto"><span class="org">Nokia</span></div>
<div class="left" dir="auto"><span class="street-address">701 E. Middlefield Road</span></div>
<div class="left" dir="auto">
<span class="locality">Mountain View</span>, <span class="region">CA</span> <span class="postal-code">94043</span>
</div>
<div class="left" dir="auto"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:kiran.nagaraj@nokia.com">kiran.nagaraj@nokia.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Greg Hankins</span></div>
<div class="left" dir="auto"><span class="org">Nokia</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:greg.hankins@nokia.com">greg.hankins@nokia.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Thomas King</span></div>
<div class="left" dir="auto"><span class="org">DE-CIX Management GmbH</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:thomas.king@de-cix.net">thomas.king@de-cix.net</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>