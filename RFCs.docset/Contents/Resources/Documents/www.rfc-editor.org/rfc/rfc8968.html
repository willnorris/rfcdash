<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 8968: Babel Routing Protocol over Datagram Transport Layer Security</title>
<meta content="Antonin DÃ©cimo" name="author"/>
<meta content="David Schinazi" name="author"/>
<meta content="Juliusz Chroboczek" name="author"/>
<meta content="
       The Babel Routing Protocol does not contain any means to authenticate
neighbours or provide integrity or confidentiality for messages sent between
them.  This document specifies a mechanism to ensure these properties using
Datagram Transport Layer Security (DTLS). 
    " name="description"/>
<meta content="xml2rfc 3.5.0" name="generator"/>
<meta content="8968" name="rfc.number"/>
<!-- Generator version information:
  xml2rfc 3.5.0
    Python 3.6.10
    appdirs 1.4.4
    ConfigArgParse 1.2.3
    google-i18n-address 2.3.5
    html5lib 1.0.1
    intervaltree 3.0.2
    Jinja2 2.11.2
    kitchen 1.2.6
    lxml 4.4.2
    pycairo 1.19.0
    pycountry 19.8.18
    pyflakes 2.1.1
    PyYAML 5.3.1
    requests 2.22.0
    setuptools 40.6.2
    six 1.14.0
    WeasyPrint 51
-->
<link href="rfc8968.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://dx.doi.org/10.17487/rfc8968" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <link href="https://datatracker.ietf.org/doc/draft-ietf-babel-dtls-10" rel="prev"/>
  </head>
<body>
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 8968</td>
<td class="center">Babel over DTLS</td>
<td class="right">January 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">DÃ©cimo, et al.</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc8968">8968</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2021-01">January 2021</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">A. DÃ©cimo</div>
<div class="org">IRIF, University of Paris-Diderot</div>
</div>
<div class="author">
      <div class="author-name">D. Schinazi</div>
<div class="org">Google LLC</div>
</div>
<div class="author">
      <div class="author-name">J. Chroboczek</div>
<div class="org">IRIF, University of Paris-Diderot</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 8968</h1>
<h1 id="title">Babel Routing Protocol over Datagram Transport Layer Security</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">The Babel Routing Protocol does not contain any means to authenticate
neighbours or provide integrity or confidentiality for messages sent between
them.  This document specifies a mechanism to ensure these properties using
Datagram Transport Layer Security (DTLS).<a class="pilcrow" href="#section-abstract-1">Â¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a class="pilcrow" href="#section-boilerplate.1-1">Â¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">Â¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc8968">https://www.rfc-editor.org/info/rfc8968</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">Â¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">Â¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">Â¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">â²</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.1">
            <p class="keepWithNext" id="section-toc.1-1.1.1"><a class="xref" href="#section-1">1</a>.Â Â <a class="xref" href="#name-introduction">Introduction</a><a class="pilcrow" href="#section-toc.1-1.1.1">Â¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.1.2.1">
                <p class="keepWithNext" id="section-toc.1-1.1.2.1.1"><a class="xref" href="#section-1.1">1.1</a>.Â Â <a class="xref" href="#name-specification-of-requiremen">Specification of Requirements</a><a class="pilcrow" href="#section-toc.1-1.1.2.1.1">Â¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.1.2.2">
                <p class="keepWithNext" id="section-toc.1-1.1.2.2.1"><a class="xref" href="#section-1.2">1.2</a>.Â Â <a class="xref" href="#name-applicability">Applicability</a><a class="pilcrow" href="#section-toc.1-1.1.2.2.1">Â¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a class="xref" href="#section-2">2</a>.Â Â <a class="xref" href="#name-operation-of-the-protocol">Operation of the Protocol</a><a class="pilcrow" href="#section-toc.1-1.2.1">Â¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a class="xref" href="#section-2.1">2.1</a>.Â Â <a class="xref" href="#name-dtls-connection-initiation">DTLS Connection Initiation</a><a class="pilcrow" href="#section-toc.1-1.2.2.1.1">Â¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a class="xref" href="#section-2.2">2.2</a>.Â Â <a class="xref" href="#name-protocol-encoding">Protocol Encoding</a><a class="pilcrow" href="#section-toc.1-1.2.2.2.1">Â¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a class="xref" href="#section-2.3">2.3</a>.Â Â <a class="xref" href="#name-transmission">Transmission</a><a class="pilcrow" href="#section-toc.1-1.2.2.3.1">Â¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a class="xref" href="#section-2.4">2.4</a>.Â Â <a class="xref" href="#name-reception">Reception</a><a class="pilcrow" href="#section-toc.1-1.2.2.4.1">Â¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.2.2.5">
                <p id="section-toc.1-1.2.2.5.1"><a class="xref" href="#section-2.5">2.5</a>.Â Â <a class="xref" href="#name-neighbour-table-entry">Neighbour Table Entry</a><a class="pilcrow" href="#section-toc.1-1.2.2.5.1">Â¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.2.2.6">
                <p id="section-toc.1-1.2.2.6.1"><a class="xref" href="#section-2.6">2.6</a>.Â Â <a class="xref" href="#name-simultaneous-operation-of-b">Simultaneous Operation of Babel over DTLS and Unprotected Babel on a Node</a><a class="pilcrow" href="#section-toc.1-1.2.2.6.1">Â¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.2.2.7">
                <p id="section-toc.1-1.2.2.7.1"><a class="xref" href="#section-2.7">2.7</a>.Â Â <a class="xref" href="#name-simultaneous-operation-of-ba">Simultaneous Operation of Babel over DTLS and Unprotected Babel on a Network</a><a class="pilcrow" href="#section-toc.1-1.2.2.7.1">Â¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a class="xref" href="#section-3">3</a>.Â Â <a class="xref" href="#name-interface-maximum-transmiss">Interface Maximum Transmission Unit Issues</a><a class="pilcrow" href="#section-toc.1-1.3.1">Â¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="xref" href="#section-4">4</a>.Â Â <a class="xref" href="#name-iana-considerations">IANA Considerations</a><a class="pilcrow" href="#section-toc.1-1.4.1">Â¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="xref" href="#section-5">5</a>.Â Â <a class="xref" href="#name-security-considerations">Security Considerations</a><a class="pilcrow" href="#section-toc.1-1.5.1">Â¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="xref" href="#section-6">6</a>.Â Â <a class="xref" href="#name-references">References</a><a class="pilcrow" href="#section-toc.1-1.6.1">Â¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a class="xref" href="#section-6.1">6.1</a>.Â Â <a class="xref" href="#name-normative-references">Normative References</a><a class="pilcrow" href="#section-toc.1-1.6.2.1.1">Â¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a class="xref" href="#section-6.2">6.2</a>.Â Â <a class="xref" href="#name-informative-references">Informative References</a><a class="pilcrow" href="#section-toc.1-1.6.2.2.1">Â¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="xref" href="#section-appendix.a">Appendix A</a>.Â Â <a class="xref" href="#name-performance-considerations">Performance Considerations</a><a class="pilcrow" href="#section-toc.1-1.7.1">Â¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="xref" href="#section-appendix.b"></a><a class="xref" href="#name-acknowledgments">Acknowledgments</a><a class="pilcrow" href="#section-toc.1-1.8.1">Â¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="xref" href="#section-appendix.c"></a><a class="xref" href="#name-authors-addresses">Authors' Addresses</a><a class="pilcrow" href="#section-toc.1-1.9.1">Â¶</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">The Babel routing protocol <span>[<a class="xref" href="#RFC8966">RFC8966</a>]</span> does not contain
any means to authenticate neighbours or protect messages sent between them.
Because of this, an attacker is able to send maliciously crafted Babel
messages that could lead a network to route traffic to an attacker or
to an under-resourced target, causing denial of service.
This document specifies a mechanism to prevent such attacks using
Datagram Transport Layer Security (DTLS) <span>[<a class="xref" href="#RFC6347">RFC6347</a>]</span>.<a class="pilcrow" href="#section-1-1">Â¶</a></p>
<section id="section-1.1">
        <h3 id="name-specification-of-requiremen">
<a class="section-number selfRef" href="#section-1.1">1.1. </a><a class="section-name selfRef" href="#name-specification-of-requiremen">Specification of Requirements</a>
        </h3>
<p id="section-1.1-1">
    The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>",
    "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", 
    "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
    "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
    described in BCPÂ 14 <span>[<a class="xref" href="#RFC2119">RFC2119</a>]</span> <span>[<a class="xref" href="#RFC8174">RFC8174</a>]</span> 
    when, and only when, they appear in all capitals, as shown here.<a class="pilcrow" href="#section-1.1-1">Â¶</a></p>
</section>
<section id="section-1.2">
        <h3 id="name-applicability">
<a class="section-number selfRef" href="#section-1.2">1.2. </a><a class="section-name selfRef" href="#name-applicability">Applicability</a>
        </h3>
<p id="section-1.2-1">The protocol described in this document protects Babel packets with
DTLS.  As such, it inherits the features offered by DTLS, notably
authentication, integrity, optional replay protection, confidentiality, and
asymmetric keying.  It is therefore expected to be applicable in a wide
range of environments.<a class="pilcrow" href="#section-1.2-1">Â¶</a></p>
<p id="section-1.2-2">There exists another mechanism for securing Babel, namely Message Authentication Code (MAC)
authentication for Babel (Babel-MAC) <span>[<a class="xref" href="#RFC8967">RFC8967</a>]</span>.  Babel-MAC only offers basic
features, namely authentication, integrity, and replay protection with
a small number of symmetric keys.  A comparison of Babel security mechanisms
and their applicability can be found in <span>[<a class="xref" href="#RFC8966">RFC8966</a>]</span>.<a class="pilcrow" href="#section-1.2-2">Â¶</a></p>
<p id="section-1.2-3">Note that Babel over DTLS provides a single authentication domain, meaning
that all nodes that have the right credentials can convey any and all routing
information.<a class="pilcrow" href="#section-1.2-3">Â¶</a></p>
<p id="section-1.2-4">DTLS supports several mechanisms by which nodes can identify themselves
and prove possession of secrets tied to these identities.  This document
does not prescribe which of these mechanisms to use; details of identity
management are left to deployment profiles of Babel over DTLS.<a class="pilcrow" href="#section-1.2-4">Â¶</a></p>
</section>
</section>
<section id="section-2">
      <h2 id="name-operation-of-the-protocol">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-operation-of-the-protocol">Operation of the Protocol</a>
      </h2>
<p id="section-2-1">Babel over DTLS requires some changes to how Babel operates.
First, DTLS is a client-server protocol, while Babel is a peer-to-peer
protocol.  Second, DTLS can only protect unicast communication, while
Babel packets can be sent to both unicast and multicast destinations.<a class="pilcrow" href="#section-2-1">Â¶</a></p>
<section id="section-2.1">
        <h3 id="name-dtls-connection-initiation">
<a class="section-number selfRef" href="#section-2.1">2.1. </a><a class="section-name selfRef" href="#name-dtls-connection-initiation">DTLS Connection Initiation</a>
        </h3>
<p id="section-2.1-1">Babel over DTLS operates on a different port than unencrypted Babel.
All Babel over DTLS nodes <span class="bcp14">MUST</span> act as DTLS servers on a given UDP port
and <span class="bcp14">MUST</span> listen for unencrypted Babel traffic on another UDP port, which
<span class="bcp14">MUST</span> be distinct from the first one.  The default port for Babel over DTLS is
registered with IANA as the "babel-dtls" port (UDP port 6699, see
<a class="xref" href="#iana_considerations">Section 4</a>), and the port exchanging unencrypted
Babel traffic is registered as the "babel" port (UDP port 6696,
see <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8966#section-5">Section 5</a> of [<a class="xref" href="#RFC8966">RFC8966</a>]</span>).<a class="pilcrow" href="#section-2.1-1">Â¶</a></p>
<p id="section-2.1-2">When a Babel node discovers a new neighbour (generally by
receiving an unencrypted multicast Babel packet), it compares the neighbour's
IP address with its own, using network byte ordering.  If a node's
address is lower than the recently discovered neighbour's address, it acts
as a client and connects to the neighbour.  In other words, the node with
the lowest address is the DTLS client for this pairwise relationship.
As an example, fe80::1:2 is considered lower than fe80::2:1.<a class="pilcrow" href="#section-2.1-2">Â¶</a></p>
<p id="section-2.1-3">The node acting as DTLS client initiates its DTLS connection from an
ephemeral UDP port.  Nodes <span class="bcp14">SHOULD</span> ensure that new client DTLS connections
use different ephemeral ports from recently used connections to allow
servers to differentiate between the new and old DTLS connections.
Alternatively, nodes could use DTLS connection identifiers
<span>[<a class="xref" href="#I-D.ietf-tls-dtls-connection-id">DTLS-CID</a>]</span> as a higher-entropy mechanism to distinguish between
connections.<a class="pilcrow" href="#section-2.1-3">Â¶</a></p>
<p id="section-2.1-4">When a node receives a new DTLS connection, it <span class="bcp14">MUST</span> verify that the source
IP address is either an IPv6 link-local address or an IPv4 address belonging
to the local network; if it is neither, it <span class="bcp14">MUST</span> reject the
connection.  Nodes use mutual authentication (authenticating
both client and server); clients <span class="bcp14">MUST</span> authenticate servers and servers <span class="bcp14">MUST</span>
authenticate clients.  Implementations <span class="bcp14">MUST</span> support
authenticating peers against a local store of credentials.  If either node
fails to authenticate its peer against its local policy, it <span class="bcp14">MUST</span> abort the DTLS
handshake.  The guidance given in <span>[<a class="xref" href="#BCP195">BCP195</a>]</span> <span class="bcp14">MUST</span> be followed to
avoid attacks on DTLS.  Additionally, nodes <span class="bcp14">MUST</span> only negotiate DTLS version
1.2 or higher.  Nodes <span class="bcp14">MUST</span>
use DTLS replay protection to prevent attackers from replaying stale
information.  Nodes <span class="bcp14">SHOULD</span> drop packets that have been reordered by more than
two IHU (I Heard You) intervals, to avoid letting attackers make stale
information last longer.  If a node receives a new DTLS connection from a
neighbour to whom it already has a connection, the node <span class="bcp14">MUST NOT</span> discard the
older connection until it has completed the handshake of the new one and
validated the identity of the peer.<a class="pilcrow" href="#section-2.1-4">Â¶</a></p>
</section>
<section id="section-2.2">
        <h3 id="name-protocol-encoding">
<a class="section-number selfRef" href="#section-2.2">2.2. </a><a class="section-name selfRef" href="#name-protocol-encoding">Protocol Encoding</a>
        </h3>
<p id="section-2.2-1">Babel over DTLS sends all unicast Babel packets protected by DTLS.  The
entire Babel packet, from the Magic byte at the start of the Babel header
to the last byte of the Babel packet trailer, is sent protected by DTLS.<a class="pilcrow" href="#section-2.2-1">Â¶</a></p>
</section>
<section id="section-2.3">
        <h3 id="name-transmission">
<a class="section-number selfRef" href="#section-2.3">2.3. </a><a class="section-name selfRef" href="#name-transmission">Transmission</a>
        </h3>
<p id="section-2.3-1">When sending packets, Babel over DTLS nodes <span class="bcp14">MUST NOT</span> send any TLVs over
the unprotected "babel" port, with the exception of Hello TLVs without the
Unicast flag set.  Babel over DTLS nodes <span class="bcp14">MUST NOT</span> send any unprotected unicast
packets.  This ensures the confidentiality of the information sent in Babel
packets (e.g., the network topology) by only sending it encrypted by DTLS.
Unless some out-of-band neighbour discovery mechanism is available,
nodes <span class="bcp14">SHOULD</span> periodically send unprotected Multicast Hellos to ensure
discovery of new neighbours.  In order to maintain bidirectional reachability,
nodes can either rely entirely on unprotected Multicast Hellos, or send
protected Unicast Hellos in addition to the Multicast Hellos.<a class="pilcrow" href="#section-2.3-1">Â¶</a></p>
<p id="section-2.3-2">Since Babel over DTLS only protects unicast packets, implementors may
implement Babel over DTLS by modifying an implementation of Babel without DTLS
support and replacing any TLV previously sent over multicast with a separate
TLV sent over unicast for each neighbour.  TLVs previously sent over multicast
can be replaced with the same contents over unicast, with the exception of
Hellos as described above.  Some implementations could also change the contents
of IHU TLVs when converting to unicast in order to remove redundant
information.<a class="pilcrow" href="#section-2.3-2">Â¶</a></p>
</section>
<section id="section-2.4">
        <h3 id="name-reception">
<a class="section-number selfRef" href="#section-2.4">2.4. </a><a class="section-name selfRef" href="#name-reception">Reception</a>
        </h3>
<p id="section-2.4-1">Babel over DTLS nodes can receive Babel packets either protected over a
DTLS connection or unprotected directly over the "babel" port.  To ensure the
security properties of this mechanism, unprotected packets are treated
differently.  Nodes <span class="bcp14">MUST</span> silently ignore any unprotected packet sent over
unicast.  When parsing an unprotected packet, a node <span class="bcp14">MUST</span> silently
ignore all TLVs that are not of type Hello.  Nodes <span class="bcp14">MUST</span> also silently ignore
any unprotected Hello with the Unicast flag set.  Note that receiving an
unprotected packet can still be used to discover new neighbours, even when
all TLVs in that packet are silently ignored.<a class="pilcrow" href="#section-2.4-1">Â¶</a></p>
</section>
<section id="section-2.5">
        <h3 id="name-neighbour-table-entry">
<a class="section-number selfRef" href="#section-2.5">2.5. </a><a class="section-name selfRef" href="#name-neighbour-table-entry">Neighbour Table Entry</a>
        </h3>
<p id="section-2.5-1">It is <span class="bcp14">RECOMMENDED</span> for nodes to associate the state of their DTLS connection
with their neighbour table.  When a neighbour entry is flushed from the
neighbour table (<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8966#appendix-A">Appendix A</a> of [<a class="xref" href="#RFC8966">RFC8966</a>]</span>), its associated
DTLS state <span class="bcp14">SHOULD</span> be discarded.  The node <span class="bcp14">SHOULD</span> send a DTLS close_notify alert
to the neighbour if it believes the link is still viable.<a class="pilcrow" href="#section-2.5-1">Â¶</a></p>
</section>
<section id="section-2.6">
        <h3 id="name-simultaneous-operation-of-b">
<a class="section-number selfRef" href="#section-2.6">2.6. </a><a class="section-name selfRef" href="#name-simultaneous-operation-of-b">Simultaneous Operation of Babel over DTLS and Unprotected Babel on a Node</a>
        </h3>
<p id="section-2.6-1">Implementations <span class="bcp14">MAY</span> implement both Babel over DTLS and unprotected Babel.
Additionally, a node <span class="bcp14">MAY</span> simultaneously run both Babel over DTLS and
unprotected Babel. However, a node running both <span class="bcp14">MUST</span> ensure that it runs
them on separate interfaces, as the security properties of Babel over DTLS
rely on ignoring unprotected Babel packets (other than Multicast Hellos).
An implementation <span class="bcp14">MAY</span> offer configuration options to allow unprotected Babel on
some interfaces but not others, which effectively gives nodes on that interface
the same access as authenticated nodes; however, this <span class="bcp14">SHOULD NOT</span> be done unless that
interface has a mechanism to authenticate nodes at a lower
layer (e.g., IPsec).<a class="pilcrow" href="#section-2.6-1">Â¶</a></p>
</section>
<section id="section-2.7">
        <h3 id="name-simultaneous-operation-of-ba">
<a class="section-number selfRef" href="#section-2.7">2.7. </a><a class="section-name selfRef" href="#name-simultaneous-operation-of-ba">Simultaneous Operation of Babel over DTLS and Unprotected Babel on a Network</a>
        </h3>
<p id="section-2.7-1">If Babel over DTLS and unprotected Babel are both operated on the same
network, the Babel over DTLS implementation will receive unprotected Multicast
Hellos and attempt to initiate a DTLS connection.  These connection attempts
can be sent to nodes that only run unprotected Babel, who will not
respond.  Babel over DTLS implementations <span class="bcp14">SHOULD</span> therefore rate-limit their
DTLS connection attempts to avoid causing undue load on the network.<a class="pilcrow" href="#section-2.7-1">Â¶</a></p>
</section>
</section>
<section id="section-3">
      <h2 id="name-interface-maximum-transmiss">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-interface-maximum-transmiss">Interface Maximum Transmission Unit Issues</a>
      </h2>
<p id="section-3-1">Compared to unprotected Babel, DTLS adds header, authentication tag, and
possibly block-size padding overhead to every packet.  This reduces the size of
the Babel payload that can be carried.  This document does not relax the
packet size requirements in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8966#section-4">Section 4</a> of [<a class="xref" href="#RFC8966">RFC8966</a>]</span> but
recommends that DTLS overhead be taken into account when computing maximum
packet size.<a class="pilcrow" href="#section-3-1">Â¶</a></p>
<p id="section-3-2"> More precisely, nodes <span class="bcp14">SHOULD</span> compute the overhead of DTLS depending on
the ciphersuites in use and <span class="bcp14">SHOULD NOT</span> send Babel packets larger than the
interface maximum transmission unit (MTU) minus the overhead of IP, UDP,
and DTLS.  Nodes <span class="bcp14">MUST NOT</span> send Babel packets larger than the attached
interface's MTU adjusted for known lower-layer headers (at least UDP and
IP) or 512 octets, whichever is larger, but not exceeding 2<sup>16</sup> -
1 adjusted for lower-layer headers.  Every Babel speaker <span class="bcp14">MUST</span> be able to
receive packets that are as large as any attached interface's MTU adjusted
for UDP and IP headers or 512 octets, whichever is larger.  Note that this
requirement on reception does not take into account the overhead of DTLS
because the peer may not have the ability to compute the overhead of DTLS,
and the packet may be fragmented by lower layers.<a class="pilcrow" href="#section-3-2">Â¶</a></p>
<p id="section-3-3">Note that distinct DTLS connections can use different ciphers, which can
have different amounts of per-packet overhead.  Therefore, the MTU to one
neighbour can be different from the MTU to another neighbour on the same
link.<a class="pilcrow" href="#section-3-3">Â¶</a></p>
</section>
<div id="iana_considerations">
<section id="section-4">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<p id="section-4-1">IANA has registered a UDP port
number, called "babel-dtls", for use by Babel over DTLS:<a class="pilcrow" href="#section-4-1">Â¶</a></p>
<ul class="ulEmpty normal">
<li class="ulEmpty normal" id="section-4-2.1">
          <span class="break"></span><dl class="dlParallel" id="section-4-2.1.1">
            <dt id="section-4-2.1.1.1">Service Name:</dt>
            <dd id="section-4-2.1.1.2" style="margin-left: 1.5em"> babel-dtls<a class="pilcrow" href="#section-4-2.1.1.2">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4-2.1.1.3">Port Number:</dt>
            <dd id="section-4-2.1.1.4" style="margin-left: 1.5em"> 6699<a class="pilcrow" href="#section-4-2.1.1.4">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4-2.1.1.5">Transport Protocols:</dt>
            <dd id="section-4-2.1.1.6" style="margin-left: 1.5em"> UDP only<a class="pilcrow" href="#section-4-2.1.1.6">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4-2.1.1.7">Description:</dt>
            <dd id="section-4-2.1.1.8" style="margin-left: 1.5em"> Babel Routing Protocol over DTLS<a class="pilcrow" href="#section-4-2.1.1.8">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4-2.1.1.9">Assignee:</dt>
            <dd id="section-4-2.1.1.10" style="margin-left: 1.5em"> IESG, iesg@ietf.org<a class="pilcrow" href="#section-4-2.1.1.10">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4-2.1.1.11">Contact:</dt>
            <dd id="section-4-2.1.1.12" style="margin-left: 1.5em"> IETF Chair, chair@ietf.org<a class="pilcrow" href="#section-4-2.1.1.12">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4-2.1.1.13">Reference:</dt>
            <dd id="section-4-2.1.1.14" style="margin-left: 1.5em"> RFC 8968<a class="pilcrow" href="#section-4-2.1.1.14">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4-2.1.1.15">Service Code:</dt>
            <dd id="section-4-2.1.1.16" style="margin-left: 1.5em"> None<a class="pilcrow" href="#section-4-2.1.1.16">Â¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</li>
      </ul>
</section>
</div>
<section id="section-5">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<p id="section-5-1">A malicious client might attempt to perform a high number of DTLS
handshakes with a server.  As the clients are not uniquely identified
by the protocol until the handshake completes and can be obfuscated with IPv6
temporary addresses, a server needs to mitigate the impact of such an attack.
Note that attackers might attempt to keep in-progress handshakes open for as
long as possible by using variants on the attack commonly known as
Slowloris <span>[<a class="xref" href="#SLOWLORIS">SLOWLORIS</a>]</span>.  Mitigating these attacks might involve
limiting the rate of handshakes from a given subnet or more advanced denial of
service avoidance techniques beyond the scope of this document.<a class="pilcrow" href="#section-5-1">Â¶</a></p>
<p id="section-5-2">Babel over DTLS allows sending Multicast Hellos unprotected; attackers can
therefore tamper with them.  For example, an attacker could send erroneous
values for the Seqno and Interval fields, causing bidirectional
reachability detection to fail.  While implementations <span class="bcp14">MAY</span> use Multicast Hellos
for link quality estimation, they <span class="bcp14">SHOULD</span> also emit protected Unicast Hellos to
prevent this class of denial-of-service attack.<a class="pilcrow" href="#section-5-2">Â¶</a></p>
<p id="section-5-3">While DTLS provides protection against an attacker that replays valid
packets, DTLS is not able to detect when an active on-path attacker intercepts
valid packets and resends them at a later time.  This attack could be used to
make a node believe it has bidirectional reachability to a neighbour even
though that neighbour has disconnected from the network.  To prevent this
attack, nodes <span class="bcp14">MUST</span> discard the DTLS state associated with a neighbour after a
finite time of not receiving valid DTLS packets.  This can be implemented by,
for example, discarding a neighbour's DTLS state when its associated IHU timer
fires. Note that relying solely on the receipt of Hellos is not sufficient as
Multicast Hellos are sent unprotected.  Additionally, an attacker could save
some packets and replay them later in hopes of propagating stale routing
information at a later time.  This can be mitigated by discarding received
packets that have been reordered by more than two IHU intervals.<a class="pilcrow" href="#section-5-3">Â¶</a></p>
</section>
<section id="section-6">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-6.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-6.1">6.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="BCP195">[BCP195]</dt>
        <dd>
<span class="refAuthor">Sheffer, Y.</span><span class="refAuthor">, Holz, R.</span><span class="refAuthor">, and P. Saint-Andre</span>, <span class="refTitle">"Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"</span>, <span class="seriesInfo">BCP 195</span>, <span class="seriesInfo">RFC 7525</span>, <time class="refDate" datetime="2015-05">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/bcp195">https://www.rfc-editor.org/info/bcp195</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time class="refDate" datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6347">[RFC6347]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span><span class="refAuthor"> and N. Modadugu</span>, <span class="refTitle">"Datagram Transport Layer Security Version 1.2"</span>, <span class="seriesInfo">RFC 6347</span>, <span class="seriesInfo">DOI 10.17487/RFC6347</span>, <time class="refDate" datetime="2012-01">January 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6347">https://www.rfc-editor.org/info/rfc6347</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time class="refDate" datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8966">[RFC8966]</dt>
      <dd>
<span class="refAuthor">Chroboczek, J.</span><span class="refAuthor"> and D. Schinazi</span>, <span class="refTitle">"The Babel Routing Protocol"</span>, <span class="seriesInfo">RFC 8966</span>, <span class="seriesInfo">DOI 10.17487/RFC8966</span>, <time class="refDate" datetime="2021-01">January 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8966">https://www.rfc-editor.org/info/rfc8966</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-6.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-6.2">6.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-tls-dtls-connection-id">[DTLS-CID]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span><span class="refAuthor">, Tschofenig, H.</span><span class="refAuthor">, and T. Fossati</span>, <span class="refTitle">"Connection Identifiers for DTLS 1.2"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-tls-dtls-connection-id-08</span>, <time class="refDate" datetime="2020-11-02">2 November 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-tls-dtls-connection-id-08">https://tools.ietf.org/html/draft-ietf-tls-dtls-connection-id-08</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7250">[RFC7250]</dt>
        <dd>
<span class="refAuthor">Wouters, P., Ed.</span><span class="refAuthor">, Tschofenig, H., Ed.</span><span class="refAuthor">, Gilmore, J.</span><span class="refAuthor">, Weiler, S.</span><span class="refAuthor">, and T. Kivinen</span>, <span class="refTitle">"Using Raw Public Keys in Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"</span>, <span class="seriesInfo">RFC 7250</span>, <span class="seriesInfo">DOI 10.17487/RFC7250</span>, <time class="refDate" datetime="2014-06">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7250">https://www.rfc-editor.org/info/rfc7250</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7918">[RFC7918]</dt>
        <dd>
<span class="refAuthor">Langley, A.</span><span class="refAuthor">, Modadugu, N.</span><span class="refAuthor">, and B. Moeller</span>, <span class="refTitle">"Transport Layer Security (TLS) False Start"</span>, <span class="seriesInfo">RFC 7918</span>, <span class="seriesInfo">DOI 10.17487/RFC7918</span>, <time class="refDate" datetime="2016-08">August 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7918">https://www.rfc-editor.org/info/rfc7918</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7924">[RFC7924]</dt>
        <dd>
<span class="refAuthor">Santesson, S.</span><span class="refAuthor"> and H. Tschofenig</span>, <span class="refTitle">"Transport Layer Security (TLS) Cached Information Extension"</span>, <span class="seriesInfo">RFC 7924</span>, <span class="seriesInfo">DOI 10.17487/RFC7924</span>, <time class="refDate" datetime="2016-07">July 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7924">https://www.rfc-editor.org/info/rfc7924</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8094">[RFC8094]</dt>
        <dd>
<span class="refAuthor">Reddy, T.</span><span class="refAuthor">, Wing, D.</span><span class="refAuthor">, and P. Patil</span>, <span class="refTitle">"DNS over Datagram Transport Layer Security (DTLS)"</span>, <span class="seriesInfo">RFC 8094</span>, <span class="seriesInfo">DOI 10.17487/RFC8094</span>, <time class="refDate" datetime="2017-02">February 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8094">https://www.rfc-editor.org/info/rfc8094</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8967">[RFC8967]</dt>
        <dd>
<span class="refAuthor">DÃ´, C.</span><span class="refAuthor">, Kolodziejak, W.</span><span class="refAuthor">, and J. Chroboczek</span>, <span class="refTitle">"MAC Authentication for the Babel Routing Protocol"</span>, <span class="seriesInfo">RFC 8967</span>, <span class="seriesInfo">DOI 10.17487/RFC8967</span>, <time class="refDate" datetime="2021-01">January 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8967">https://www.rfc-editor.org/info/rfc8967</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SLOWLORIS">[SLOWLORIS]</dt>
      <dd>
<span class="refAuthor">Hansen, R.</span>, <span class="refTitle">"Slowloris HTTP DoS"</span>, <time class="refDate" datetime="2009-06">June 2009</time>, <span>&lt;<a href="https://web.archive.org/web/20150315054838/http://ha.ckers.org/slowloris/">https://web.archive.org/web/20150315054838/http://ha.ckers.org/slowloris/</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<section id="section-appendix.a">
      <h2 id="name-performance-considerations">
<a class="section-number selfRef" href="#section-appendix.a">Appendix A. </a><a class="section-name selfRef" href="#name-performance-considerations">Performance Considerations</a>
      </h2>
<p id="section-appendix.a-1">To reduce the number of octets taken by the DTLS handshake,
especially the size of the certificate in the ServerHello (which can
be several kilobytes), Babel peers can use raw public keys <span>[<a class="xref" href="#RFC7250">RFC7250</a>]</span> or the Cached Information Extension <span>[<a class="xref" href="#RFC7924">RFC7924</a>]</span>.  The Cached Information Extension avoids
transmitting the server's certificate and certificate chain if the
client has cached that information from a previous TLS handshake.  TLS
False Start <span>[<a class="xref" href="#RFC7918">RFC7918</a>]</span> can reduce round trips by
allowing the TLS second flight of messages (ChangeCipherSpec) to also
contain the (encrypted) Babel packet.<a class="pilcrow" href="#section-appendix.a-1">Â¶</a></p>
</section>
<section id="section-appendix.b">
      <h2 id="name-acknowledgments">
<a class="section-name selfRef" href="#name-acknowledgments">Acknowledgments</a>
      </h2>
<p id="section-appendix.b-1">The authors would like to thank
<span class="contact-name">Roman Danyliw</span>,
<span class="contact-name">Donald Eastlake</span>,
<span class="contact-name">Thomas Fossati</span>,
<span class="contact-name">Benjamin Kaduk</span>,
<span class="contact-name">Gabriel Kerneis</span>,
<span class="contact-name">Mirja KÃ¼hlewind</span>,
<span class="contact-name">Antoni Przygienda</span>,
<span class="contact-name">Henning Rogge</span>,
<span class="contact-name">Dan Romascanu</span>,
<span class="contact-name">Barbara Stark</span>,
<span class="contact-name">Markus Stenberg</span>,
<span class="contact-name">Dave Taht</span>,
<span class="contact-name">Martin Thomson</span>,
<span class="contact-name">Sean Turner</span>,
and <span class="contact-name">Martin Vigoureux</span>
for their input and contributions.
The performance considerations in this document were inspired from the ones for
DNS over DTLS <span>[<a class="xref" href="#RFC8094">RFC8094</a>]</span>.<a class="pilcrow" href="#section-appendix.b-1">Â¶</a></p>
</section>
<div id="authors-addresses">
<section id="section-appendix.c">
      <h2 id="name-authors-addresses">
<a class="section-name selfRef" href="#name-authors-addresses">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Antonin DÃ©cimo</span></div>
<div class="left" dir="auto"><span class="org">IRIF, University of Paris-Diderot</span></div>
<div class="left" dir="auto"><span class="locality">Paris</span></div>
<div class="left" dir="auto"><span class="country-name">France</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:antonin.decimo@gmail.com">antonin.decimo@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">David Schinazi</span></div>
<div class="left" dir="auto"><span class="org">Google LLC</span></div>
<div class="left" dir="auto"><span class="street-address">1600 Amphitheatre Parkway</span></div>
<div class="left" dir="auto">
<span class="locality">Mountain View</span>, <span class="region">CA</span> <span class="postal-code">94043</span>
</div>
<div class="left" dir="auto"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:dschinazi.ietf@gmail.com">dschinazi.ietf@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Juliusz Chroboczek</span></div>
<div class="left" dir="auto"><span class="org">IRIF, University of Paris-Diderot</span></div>
<div class="left" dir="auto"><span class="street-address">Case 7014</span></div>
<div class="left" dir="auto">
<span class="postal-code">75205</span> <span class="locality">Paris CEDEX 13</span>
</div>
<div class="left" dir="auto"><span class="country-name">France</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:jch@irif.fr">jch@irif.fr</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>