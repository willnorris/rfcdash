<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 8870: Encrypted Key Transport for DTLS and Secure RTP</title>
<meta content="Cullen Jennings" name="author"/>
<meta content="John Mattsson" name="author"/>
<meta content="David A. McGrew" name="author"/>
<meta content="Dan Wing" name="author"/>
<meta content="Flemming Andreasen" name="author"/>
<meta content="
       Encrypted Key Transport (EKT) is an extension to DTLS
(Datagram Transport Layer Security) and the Secure Real-time
Transport Protocol (SRTP) that provides for the secure
transport of SRTP master keys, rollover counters, and other
information within SRTP. This facility enables SRTP for decentralized
conferences by distributing a common key to all of the conference
endpoints.
 
    " name="description"/>
<meta content="xml2rfc 3.5.0" name="generator"/>
<meta content="PERC" name="keyword"/>
<meta content="SRTP" name="keyword"/>
<meta content="RTP" name="keyword"/>
<meta content="conferencing" name="keyword"/>
<meta content="encryption" name="keyword"/>
<meta content="8870" name="rfc.number"/>
<!-- Generator version information:
  xml2rfc 3.5.0
    Python 3.6.10
    appdirs 1.4.4
    ConfigArgParse 1.2.3
    google-i18n-address 2.3.5
    html5lib 1.0.1
    intervaltree 3.0.2
    Jinja2 2.11.2
    kitchen 1.2.6
    lxml 4.4.2
    pycairo 1.19.0
    pycountry 19.8.18
    pyflakes 2.1.1
    PyYAML 5.3.1
    requests 2.22.0
    setuptools 40.6.2
    six 1.14.0
    WeasyPrint 51
-->
<link href="rfc8870.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://dx.doi.org/10.17487/rfc8870" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <link href="https://datatracker.ietf.org/doc/draft-ietf-perc-srtp-ekt-diet-13" rel="prev"/>
  </head>
<body>
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 8870</td>
<td class="center">EKT SRTP</td>
<td class="right">January 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Jennings, et al.</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc8870">8870</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2021-01">January 2021</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">C. Jennings</div>
<div class="org">Cisco Systems</div>
</div>
<div class="author">
      <div class="author-name">J. Mattsson</div>
<div class="org">Ericsson AB</div>
</div>
<div class="author">
      <div class="author-name">D. McGrew</div>
<div class="org">Cisco Systems</div>
</div>
<div class="author">
      <div class="author-name">D. Wing</div>
<div class="org">Citrix</div>
</div>
<div class="author">
      <div class="author-name">F. Andreasen</div>
<div class="org">Cisco Systems</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 8870</h1>
<h1 id="title">Encrypted Key Transport for DTLS and Secure RTP</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">Encrypted Key Transport (EKT) is an extension to DTLS
(Datagram Transport Layer Security) and the Secure Real-time
Transport Protocol (SRTP) that provides for the secure
transport of SRTP master keys, rollover counters, and other
information within SRTP. This facility enables SRTP for decentralized
conferences by distributing a common key to all of the conference
endpoints.<a class="pilcrow" href="#section-abstract-1">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a class="pilcrow" href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc8870">https://www.rfc-editor.org/info/rfc8870</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">▲</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.1">
            <p class="keepWithNext" id="section-toc.1-1.1.1"><a class="xref" href="#section-1">1</a>.  <a class="xref" href="#name-introduction">Introduction</a><a class="pilcrow" href="#section-toc.1-1.1.1">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.2">
            <p class="keepWithNext" id="section-toc.1-1.2.1"><a class="xref" href="#section-2">2</a>.  <a class="xref" href="#name-overview">Overview</a><a class="pilcrow" href="#section-toc.1-1.2.1">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.3">
            <p class="keepWithNext" id="section-toc.1-1.3.1"><a class="xref" href="#section-3">3</a>.  <a class="xref" href="#name-conventions-used-in-this-do">Conventions Used in This Document</a><a class="pilcrow" href="#section-toc.1-1.3.1">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="xref" href="#section-4">4</a>.  <a class="xref" href="#name-encrypted-key-transport">Encrypted Key Transport</a><a class="pilcrow" href="#section-toc.1-1.4.1">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a class="xref" href="#section-4.1">4.1</a>.  <a class="xref" href="#name-ektfield-formats">EKTField Formats</a><a class="pilcrow" href="#section-toc.1-1.4.2.1.1">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a class="xref" href="#section-4.2">4.2</a>.  <a class="xref" href="#name-spis-and-ekt-parameter-sets">SPIs and EKT Parameter Sets</a><a class="pilcrow" href="#section-toc.1-1.4.2.2.1">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a class="xref" href="#section-4.3">4.3</a>.  <a class="xref" href="#name-packet-processing-and-state">Packet Processing and State Machine</a><a class="pilcrow" href="#section-toc.1-1.4.2.3.1">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.4.2.3.2.1">
                    <p id="section-toc.1-1.4.2.3.2.1.1"><a class="xref" href="#section-4.3.1">4.3.1</a>.  <a class="xref" href="#name-outbound-processing">Outbound Processing</a><a class="pilcrow" href="#section-toc.1-1.4.2.3.2.1.1">¶</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.4.2.3.2.2">
                    <p id="section-toc.1-1.4.2.3.2.2.1"><a class="xref" href="#section-4.3.2">4.3.2</a>.  <a class="xref" href="#name-inbound-processing">Inbound Processing</a><a class="pilcrow" href="#section-toc.1-1.4.2.3.2.2.1">¶</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a class="xref" href="#section-4.4">4.4</a>.  <a class="xref" href="#name-ciphers">Ciphers</a><a class="pilcrow" href="#section-toc.1-1.4.2.4.1">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.4.2.4.2.1">
                    <p id="section-toc.1-1.4.2.4.2.1.1"><a class="xref" href="#section-4.4.1">4.4.1</a>.  <a class="xref" href="#name-aes-key-wrap">AES Key Wrap</a><a class="pilcrow" href="#section-toc.1-1.4.2.4.2.1.1">¶</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.4.2.4.2.2">
                    <p id="section-toc.1-1.4.2.4.2.2.1"><a class="xref" href="#section-4.4.2">4.4.2</a>.  <a class="xref" href="#name-defining-new-ekt-ciphers">Defining New EKT Ciphers</a><a class="pilcrow" href="#section-toc.1-1.4.2.4.2.2.1">¶</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a class="xref" href="#section-4.5">4.5</a>.  <a class="xref" href="#name-synchronizing-operation">Synchronizing Operation</a><a class="pilcrow" href="#section-toc.1-1.4.2.5.1">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.4.2.6">
                <p id="section-toc.1-1.4.2.6.1"><a class="xref" href="#section-4.6">4.6</a>.  <a class="xref" href="#name-timing-and-reliability-cons">Timing and Reliability Considerations</a><a class="pilcrow" href="#section-toc.1-1.4.2.6.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="xref" href="#section-5">5</a>.  <a class="xref" href="#name-use-of-ekt-with-dtls-srtp">Use of EKT with DTLS-SRTP</a><a class="pilcrow" href="#section-toc.1-1.5.1">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a class="xref" href="#section-5.1">5.1</a>.  <a class="xref" href="#name-dtls-srtp-recap">DTLS-SRTP Recap</a><a class="pilcrow" href="#section-toc.1-1.5.2.1.1">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a class="xref" href="#section-5.2">5.2</a>.  <a class="xref" href="#name-srtp-ekt-key-transport-exte">SRTP EKT Key Transport Extensions to DTLS-SRTP</a><a class="pilcrow" href="#section-toc.1-1.5.2.2.1">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.5.2.2.2.1">
                    <p id="section-toc.1-1.5.2.2.2.1.1"><a class="xref" href="#section-5.2.1">5.2.1</a>.  <a class="xref" href="#name-negotiating-an-ektcipher">Negotiating an EKTCipher</a><a class="pilcrow" href="#section-toc.1-1.5.2.2.2.1.1">¶</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.5.2.2.2.2">
                    <p id="section-toc.1-1.5.2.2.2.2.1"><a class="xref" href="#section-5.2.2">5.2.2</a>.  <a class="xref" href="#name-establishing-an-ekt-key">Establishing an EKT Key</a><a class="pilcrow" href="#section-toc.1-1.5.2.2.2.2.1">¶</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a class="xref" href="#section-5.3">5.3</a>.  <a class="xref" href="#name-offer-answer-considerations">Offer/Answer Considerations</a><a class="pilcrow" href="#section-toc.1-1.5.2.3.1">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a class="xref" href="#section-5.4">5.4</a>.  <a class="xref" href="#name-sending-the-dtls-ektkey-rel">Sending the DTLS EKTKey Reliably</a><a class="pilcrow" href="#section-toc.1-1.5.2.4.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="xref" href="#section-6">6</a>.  <a class="xref" href="#name-security-considerations">Security Considerations</a><a class="pilcrow" href="#section-toc.1-1.6.1">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="xref" href="#section-7">7</a>.  <a class="xref" href="#name-iana-considerations">IANA Considerations</a><a class="pilcrow" href="#section-toc.1-1.7.1">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a class="xref" href="#section-7.1">7.1</a>.  <a class="xref" href="#name-ekt-message-types">EKT Message Types</a><a class="pilcrow" href="#section-toc.1-1.7.2.1.1">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a class="xref" href="#section-7.2">7.2</a>.  <a class="xref" href="#name-ekt-ciphers-2">EKT Ciphers</a><a class="pilcrow" href="#section-toc.1-1.7.2.2.1">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a class="xref" href="#section-7.3">7.3</a>.  <a class="xref" href="#name-tls-extensions">TLS Extensions</a><a class="pilcrow" href="#section-toc.1-1.7.2.3.1">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a class="xref" href="#section-7.4">7.4</a>.  <a class="xref" href="#name-tls-handshake-type">TLS Handshake Type</a><a class="pilcrow" href="#section-toc.1-1.7.2.4.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="xref" href="#section-8">8</a>.  <a class="xref" href="#name-references">References</a><a class="pilcrow" href="#section-toc.1-1.8.1">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a class="xref" href="#section-8.1">8.1</a>.  <a class="xref" href="#name-normative-references">Normative References</a><a class="pilcrow" href="#section-toc.1-1.8.2.1.1">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a class="xref" href="#section-8.2">8.2</a>.  <a class="xref" href="#name-informative-references">Informative References</a><a class="pilcrow" href="#section-toc.1-1.8.2.2.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="xref" href="#section-appendix.a"></a><a class="xref" href="#name-acknowledgments">Acknowledgments</a><a class="pilcrow" href="#section-toc.1-1.9.1">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a class="xref" href="#section-appendix.b"></a><a class="xref" href="#name-authors-addresses">Authors' Addresses</a><a class="pilcrow" href="#section-toc.1-1.10.1">¶</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">The Real-time Transport Protocol (RTP) is designed to allow decentralized
groups with minimal control to establish sessions, such as for
multimedia conferences.  Unfortunately, Secure RTP (SRTP) <span>[<a class="xref" href="#RFC3711">RFC3711</a>]</span>
cannot be used in many minimal-control scenarios, because it requires
that synchronization source (SSRC) values and other data be
coordinated among all of the participants in a session. For example,
if a participant joins a session that is already in progress, that
participant needs to be informed of the SRTP keys along with the SSRC,
rollover counter (ROC), and other details of the other SRTP sources.<a class="pilcrow" href="#section-1-1">¶</a></p>
<p id="section-1-2">The inability of SRTP to work in the absence of central control was
well understood during the design of the protocol; the omission was
considered less important than optimizations such as bandwidth
conservation. Additionally, in many situations, SRTP is used in
conjunction with a signaling system that can provide the central
control needed by SRTP. However, there are several cases in which
conventional signaling systems cannot easily provide all of the
coordination required.<a class="pilcrow" href="#section-1-2">¶</a></p>
<p id="section-1-3">This document defines Encrypted Key Transport (EKT) for SRTP and
reduces the amount of external signaling control that is needed in an
SRTP session with multiple receivers. EKT securely distributes the
SRTP master key and other information for each SRTP source. With this
method, SRTP entities are free to choose SSRC values as they see fit
and to start up new SRTP sources with new SRTP master keys within a
session without coordinating with other entities via external signaling
or other external means.<a class="pilcrow" href="#section-1-3">¶</a></p>
<p id="section-1-4">EKT extends DTLS and SRTP to enable a common key encryption key
(called an "EKTKey") to be distributed to all endpoints, so that each
endpoint can securely send its SRTP master key and current SRTP
ROC to the other participants in the session. This data
furnishes the information needed by the receiver to instantiate an
SRTP receiver context.<a class="pilcrow" href="#section-1-4">¶</a></p>
<p id="section-1-5">EKT can be used in conferences where the central Media Distributor or
conference bridge cannot decrypt the media, such as the type defined
in <span>[<a class="xref" href="#RFC8871">RFC8871</a>]</span>. It can also be used for
large-scale conferences where the conference bridge or Media
Distributor can decrypt all the media but wishes to encrypt the media
it is sending just once and then send the same encrypted media to a large
number of participants. This reduces encryption CPU time
in general and is necessary when sending multicast media.<a class="pilcrow" href="#section-1-5">¶</a></p>
<p id="section-1-6">EKT does not control the manner in which the SSRC is generated. It
is only concerned with distributing the security parameters that an
endpoint needs to associate with a given SSRC in order to decrypt
SRTP packets from that sender.<a class="pilcrow" href="#section-1-6">¶</a></p>
<p id="section-1-7">EKT is not intended to replace external key establishment
mechanisms. Instead, it is used in conjunction with those methods, and
it relieves those methods of the burden of delivering the context for
each SRTP source to every SRTP participant.  This document defines
how EKT works with the DTLS-SRTP approach to key establishment, by
using keys derived from the DTLS-SRTP handshake to encipher the
EKTKey in addition to the SRTP media.<a class="pilcrow" href="#section-1-7">¶</a></p>
</section>
</div>
<div id="overview">
<section id="section-2">
      <h2 id="name-overview">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-overview">Overview</a>
      </h2>
<p id="section-2-1">This specification defines a way for the server in a DTLS-SRTP
negotiation (see <a class="xref" href="#dtls-srtp-kt">Section 5</a>) to provide an EKTKey to the client
during the DTLS handshake. The EKTKey thus obtained can be used to
encrypt the SRTP master key that is used to encrypt the media sent by
the endpoint. This specification also defines a way to send the
encrypted SRTP master key (with the EKTKey) along with the SRTP packet
(see <a class="xref" href="#srtp_ekt">Section 4</a>). Endpoints that receive this packet and know the EKTKey can use
the EKTKey to decrypt the SRTP master key, which can then be used to decrypt
the SRTP packet.<a class="pilcrow" href="#section-2-1">¶</a></p>
<p id="section-2-2">One way to use this specification is described in the architecture defined
by <span>[<a class="xref" href="#RFC8871">RFC8871</a>]</span>. Each participant in the
conference forms a DTLS-SRTP connection to a common Key Distributor
that distributes the same EKTKey to all the endpoints.
Then, each endpoint picks its own SRTP master key for the media
it sends. When sending media, the endpoint may also include the
SRTP master key encrypted with the EKTKey in the SRTP packet.
This allows all the endpoints to decrypt the media.<a class="pilcrow" href="#section-2-2">¶</a></p>
</section>
</div>
<div id="conventions-used-in-this-document">
<section id="section-3">
      <h2 id="name-conventions-used-in-this-do">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-conventions-used-in-this-do">Conventions Used in This Document</a>
      </h2>
<p id="section-3-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>",
      "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>",
      "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>",
      "<span class="bcp14">SHOULD NOT</span>",
      "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
      "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document
      are to be interpreted as described in BCP 14
      <span>[<a class="xref" href="#RFC2119">RFC2119</a>]</span> <span>[<a class="xref" href="#RFC8174">RFC8174</a>]</span> when, and only
      when, they appear in all capitals, as shown here.<a class="pilcrow" href="#section-3-1">¶</a></p>
</section>
</div>
<div id="srtp_ekt">
<section id="section-4">
      <h2 id="name-encrypted-key-transport">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-encrypted-key-transport">Encrypted Key Transport</a>
      </h2>
<p id="section-4-1">EKT defines a new method of providing SRTP master keys to an
endpoint. In order to convey the ciphertext corresponding to the SRTP
master key, and other additional information, an additional field,
called the "EKTField", is added to the SRTP packets. The EKTField appears
at the end of the SRTP packet. It appears after the optional
authentication tag, if one is present; otherwise, the EKTField
appears after the ciphertext portion of the packet.<a class="pilcrow" href="#section-4-1">¶</a></p>
<p id="section-4-2">EKT <span class="bcp14">MUST NOT</span> be used in conjunction with SRTP's MKI (Master Key
Identifier) or with SRTP's &lt;From, To&gt; <span>[<a class="xref" href="#RFC3711">RFC3711</a>]</span>, as those SRTP
features duplicate some of the functions of EKT. Senders <span class="bcp14">MUST NOT</span>
include the MKI when using EKT. Receivers <span class="bcp14">SHOULD</span> simply ignore any MKI
field received if EKT is in use.<a class="pilcrow" href="#section-4-2">¶</a></p>
<p id="section-4-3">This document defines the use of EKT with SRTP.  Its use with the
      Secure Real-time Transport Control Protocol (SRTCP)
would be similar, but that topic is left for a future specification.  SRTP
is preferred for transmitting keying material because (1) it shares fate
with the transmitted media, (2) SRTP rekeying can occur without
concern for RTCP transmission limits, and (3) it avoids the need
for SRTCP compound packets with RTP translators and mixers.<a class="pilcrow" href="#section-4-3">¶</a></p>
<div id="EKT">
<section id="section-4.1">
        <h3 id="name-ektfield-formats">
<a class="section-number selfRef" href="#section-4.1">4.1. </a><a class="section-name selfRef" href="#name-ektfield-formats">EKTField Formats</a>
        </h3>
<p id="section-4.1-1">The EKTField uses the formats defined in Figures <a class="xref" href="#tag-format-base">1</a> and <a class="xref" href="#tag-format-abbreviated">2</a> for the
FullEKTField and ShortEKTField.  The EKTField appended to an SRTP
packet can be referred to as an "EKT Tag".<a class="pilcrow" href="#section-4.1-1">¶</a></p>
<span id="name-fullektfield-format"></span><div id="tag-format-base">
<figure id="figure-1">
          <div class="artwork art-text alignCenter" id="section-4.1-2.1">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:                                                               :
:                        EKT Ciphertext                         :
:                                                               :
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Security Parameter Index    |             Epoch             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|            Length             |0 0 0 0 0 0 1 0|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</pre>
</div>
<figcaption><a class="selfRef" href="#figure-1">Figure 1</a>:
<a class="selfRef" href="#name-fullektfield-format">FullEKTField Format</a>
          </figcaption></figure>
</div>
<span id="name-shortektfield-format"></span><div id="tag-format-abbreviated">
<figure id="figure-2">
          <div class="artwork art-text alignCenter" id="section-4.1-3.1">
<pre> 0 1 2 3 4 5 6 7
+-+-+-+-+-+-+-+-+
|0 0 0 0 0 0 0 0|
+-+-+-+-+-+-+-+-+</pre>
</div>
<figcaption><a class="selfRef" href="#figure-2">Figure 2</a>:
<a class="selfRef" href="#name-shortektfield-format">ShortEKTField Format</a>
          </figcaption></figure>
</div>
<p id="section-4.1-4"><a class="xref" href="#tag-formats">Figure 3</a> shows the syntax of the EKTField, expressed in ABNF
<span>[<a class="xref" href="#RFC5234">RFC5234</a>]</span>.  The EKTField is added to the end of an SRTP
packet. The EKTPlaintext is the concatenation of SRTPMasterKeyLength,
SRTPMasterKey, SSRC, and ROC, in that order. The EKTCiphertext is
computed by encrypting the EKTPlaintext using the EKTKey. Future
extensions to the EKTField <span class="bcp14">MUST</span> conform to the syntax of the
ExtensionEKTField.<a class="pilcrow" href="#section-4.1-4">¶</a></p>
<span id="name-ektfield-syntax"></span><div id="tag-formats">
<figure id="figure-3">
          <div id="section-4.1-5.1">
<pre class="sourcecode lang-abnf">BYTE = %x00-FF

EKTMsgTypeFull = %x02
EKTMsgTypeShort = %x00
EKTMsgTypeExtension = %x03-FF ; Message Type %x01 is not available
                              ; for assignment due to its usage by
                              ; legacy implementations.

EKTMsgLength = 2BYTE

SRTPMasterKeyLength = BYTE
SRTPMasterKey = 1*242BYTE
SSRC = 4BYTE ; SSRC from RTP
ROC = 4BYTE ; ROC from SRTP for the given SSRC

EKTPlaintext = SRTPMasterKeyLength SRTPMasterKey SSRC ROC

EKTCiphertext = 1*251BYTE ; EKTEncrypt(EKTKey, EKTPlaintext)
Epoch = 2BYTE
SPI = 2BYTE

FullEKTField = EKTCiphertext SPI Epoch EKTMsgLength EKTMsgTypeFull

ShortEKTField = EKTMsgTypeShort

ExtensionData = 1*1024BYTE
ExtensionEKTField = ExtensionData EKTMsgLength EKTMsgTypeExtension

EKTField = FullEKTField / ShortEKTField / ExtensionEKTField</pre>
</div>
<figcaption><a class="selfRef" href="#figure-3">Figure 3</a>:
<a class="selfRef" href="#name-ektfield-syntax">EKTField Syntax</a>
          </figcaption></figure>
</div>
<p id="section-4.1-6">These fields and data elements are defined as follows:<a class="pilcrow" href="#section-4.1-6">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.1-7">
          <dt id="section-4.1-7.1">EKTPlaintext:</dt>
          <dd id="section-4.1-7.2" style="margin-left: 1.5em">This is the data that is input to the EKT encryption operation. This data never
  appears on the wire; it is used only in computations internal to EKT. This
  is the concatenation of the SRTP master key and its length, the SSRC, and
  the ROC.<a class="pilcrow" href="#section-4.1-7.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-7.3">EKTCiphertext:</dt>
          <dd id="section-4.1-7.4" style="margin-left: 1.5em">This is the data that is output from the EKT encryption operation
  (see <a class="xref" href="#cipher">Section 4.4</a>). This field is included in SRTP
  packets when EKT is in use.  The length of the EKTCiphertext can be larger than
  the length of the EKTPlaintext that was encrypted.<a class="pilcrow" href="#section-4.1-7.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-7.5">SRTPMasterKey:</dt>
          <dd id="section-4.1-7.6" style="margin-left: 1.5em">On the sender side, this is the SRTP master key associated with the indicated
  SSRC.<a class="pilcrow" href="#section-4.1-7.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-7.7">SRTPMasterKeyLength:</dt>
          <dd id="section-4.1-7.8" style="margin-left: 1.5em">This is the length of the SRTPMasterKey in bytes. This depends on the cipher
  suite negotiated for SRTP using Session Description Protocol (SDP) Offer/Answer <span>[<a class="xref" href="#RFC3264">RFC3264</a>]</span>.<a class="pilcrow" href="#section-4.1-7.8">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-7.9">SSRC:</dt>
          <dd id="section-4.1-7.10" style="margin-left: 1.5em">On the sender side, this is the SSRC for this SRTP source. The length of
  this field is 32 bits.  The SSRC value in the EKT Tag <span class="bcp14">MUST</span> be
  the same as the one in the header of the SRTP packet to which the tag is
  appended.<a class="pilcrow" href="#section-4.1-7.10">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-7.11">Rollover Counter (ROC):</dt>
          <dd id="section-4.1-7.12" style="margin-left: 1.5em">On the sender side, this is set to the current value of the SRTP
  ROC in the SRTP context associated with the SSRC in the SRTP
  packet. The length of this field is 32 bits.<a class="pilcrow" href="#section-4.1-7.12">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-7.13">Security Parameter Index (SPI):</dt>
          <dd id="section-4.1-7.14" style="margin-left: 1.5em">
            <p id="section-4.1-7.14.1">This field indicates the appropriate EKTKey and other parameters for the
  receiver to use when processing the packet, within a given conference. The
  length of this field is 16 bits, representing a two-byte integer in network
  byte order. The parameters identified by this field are as follows:<a class="pilcrow" href="#section-4.1-7.14.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-7.14.2.1">The EKT Cipher used to process the packet.<a class="pilcrow" href="#section-4.1-7.14.2.1">¶</a>
</li>
              <li class="normal" id="section-4.1-7.14.2.2">The EKTKey used to process the packet.<a class="pilcrow" href="#section-4.1-7.14.2.2">¶</a>
</li>
              <li class="normal" id="section-4.1-7.14.2.3">The SRTP master salt associated with any master key encrypted
          with this EKT Key.  The master salt is communicated separately, via
          signaling, typically along with the EKTKey. (Recall that the SRTP
          master salt is used in the formation of Initialization Vectors
          (IVs) / nonces.)<a class="pilcrow" href="#section-4.1-7.14.2.3">¶</a>
</li>
            </ul>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-7.15">Epoch:</dt>
          <dd id="section-4.1-7.16" style="margin-left: 1.5em">This field indicates how many SRTP keys have been sent for this SSRC
   under the current EKTKey, prior to the current key, as a two‑byte integer
   in network byte order.  It starts at zero at the beginning of a session and
   resets to zero whenever the EKTKey is changed (i.e., when a new SPI
   appears).  The epoch for an SSRC increments by one every time the sender
   transmits a new key.  The recipient of a FullEKTField <span class="bcp14">MUST</span>
   reject any future FullEKTField for this SPI and SSRC that has an epoch
   value equal to or lower than an epoch already seen.<a class="pilcrow" href="#section-4.1-7.16">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.1-8">Together, these data elements are called an "EKT parameter set". To
        avoid ambiguity, each distinct EKT parameter set that is used
        <span class="bcp14">MUST</span> be associated with a distinct SPI value.<a class="pilcrow" href="#section-4.1-8">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.1-9">
          <dt id="section-4.1-9.1">EKTMsgLength:</dt>
          <dd id="section-4.1-9.2" style="margin-left: 1.5em">All EKT Message Types other than the ShortEKTField include a length
   in octets (in network byte
   order) of either the FullEKTField or the ExtensionEKTField, including this length
   field and the EKT Message Type (as defined in the next paragraph).<a class="pilcrow" href="#section-4.1-9.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-9.3">Message Type:</dt>
          <dd id="section-4.1-9.4" style="margin-left: 1.5em">The last byte is used to indicate the type of the EKTField. This
   <span class="bcp14">MUST</span> be 2 for the FullEKTField format and 0 for the ShortEKTField
   format.  If a received EKT Tag has an unknown Message Type, then the
   receiver <span class="bcp14">MUST</span> discard the whole EKT Tag.<a class="pilcrow" href="#section-4.1-9.4">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="spis-and-ekt-parameter-sets">
<section id="section-4.2">
        <h3 id="name-spis-and-ekt-parameter-sets">
<a class="section-number selfRef" href="#section-4.2">4.2. </a><a class="section-name selfRef" href="#name-spis-and-ekt-parameter-sets">SPIs and EKT Parameter Sets</a>
        </h3>
<p id="section-4.2-1">The SPI identifies the parameters for how the EKT Tag should
be processed:<a class="pilcrow" href="#section-4.2-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-2.1">The EKTKey and EKT Cipher used to process the packet.<a class="pilcrow" href="#section-4.2-2.1">¶</a>
</li>
          <li class="normal" id="section-4.2-2.2">The SRTP master salt associated with any master key encrypted
          with this EKT Key.  The master salt is communicated separately, via
          signaling, typically along with the EKTKey.<a class="pilcrow" href="#section-4.2-2.2">¶</a>
</li>
        </ul>
<p id="section-4.2-3">Together, these data elements are called an "EKT parameter set". To
        avoid ambiguity, each distinct EKT parameter set that is used
        <span class="bcp14">MUST</span> be associated with a distinct SPI value.  The association of a given
parameter set with a given SPI value is configured by some other
protocol, e.g., the DTLS-SRTP extension defined in
<a class="xref" href="#dtls-srtp-kt">Section 5</a>.<a class="pilcrow" href="#section-4.2-3">¶</a></p>
</section>
</div>
<div id="pkt_proc">
<section id="section-4.3">
        <h3 id="name-packet-processing-and-state">
<a class="section-number selfRef" href="#section-4.3">4.3. </a><a class="section-name selfRef" href="#name-packet-processing-and-state">Packet Processing and State Machine</a>
        </h3>
<p id="section-4.3-1">At any given time, the SSRC for each SRTP source has associated with
        it a single EKT parameter set.  This parameter set is used to
        process all outbound packets and is called the "outbound parameter
        set" for that SSRC. There may be other EKT parameter sets that are used by other
SRTP sources in the same session, including other SRTP
sources on the same endpoint (e.g., one endpoint with voice and video
might have two EKT parameter sets, or there might be multiple video
sources on an endpoint, each with their own EKT parameter set).  All of
the received EKT parameter sets <span class="bcp14">SHOULD</span> be stored by all of the
participants in an SRTP session, for use in processing inbound SRTP
traffic.  If a participant deletes an EKT parameter set
(e.g., because of space limitations), then it will be unable to
process Full EKT Tags containing updated media keys and thus will be unable
to receive media from a participant that has changed its media key.<a class="pilcrow" href="#section-4.3-1">¶</a></p>
<p id="section-4.3-2">Either the FullEKTField or ShortEKTField is appended at the tail end
of all SRTP packets. The decision regarding which parameter to send and when
is specified in <a class="xref" href="#timing">Section 4.6</a>.<a class="pilcrow" href="#section-4.3-2">¶</a></p>
<div id="outbound-processing">
<section id="section-4.3.1">
          <h4 id="name-outbound-processing">
<a class="section-number selfRef" href="#section-4.3.1">4.3.1. </a><a class="section-name selfRef" href="#name-outbound-processing">Outbound Processing</a>
          </h4>
<p id="section-4.3.1-1">See <a class="xref" href="#timing">Section 4.6</a>, which describes when to send an SRTP packet with a
FullEKTField. If a FullEKTField is not being sent, then a
ShortEKTField is sent so the receiver can correctly determine how to
process the packet.<a class="pilcrow" href="#section-4.3.1-1">¶</a></p>
<p id="section-4.3.1-2">When an SRTP packet is sent with a FullEKTField, the EKTField for that
packet is created per either the steps below or an equivalent set of steps.<a class="pilcrow" href="#section-4.3.1-2">¶</a></p>
<ol class="normal type-1" id="section-4.3.1-3" start="1" type="1">
            <li id="section-4.3.1-3.1">The Security Parameter Index (SPI) field is set to the value of the
SPI that is associated with the outbound
parameter set.<a class="pilcrow" href="#section-4.3.1-3.1">¶</a>
</li>
            <li id="section-4.3.1-3.2">The EKTPlaintext field is computed from the SRTP master key, SSRC,
and ROC fields, as shown in <a class="xref" href="#EKT">Section 4.1</a>. The ROC, SRTP master key, and
SSRC used in EKT processing <span class="bcp14">MUST</span> be the same as the one used in
SRTP processing.<a class="pilcrow" href="#section-4.3.1-3.2">¶</a>
</li>
            <li id="section-4.3.1-3.3">The EKTCiphertext field is set to the ciphertext created by
encrypting the EKTPlaintext with the EKTCipher using the EKTKey
as the encryption key.  The encryption process is detailed in
<a class="xref" href="#cipher">Section 4.4</a>.<a class="pilcrow" href="#section-4.3.1-3.3">¶</a>
</li>
            <li id="section-4.3.1-3.4">
              <p id="section-4.3.1-3.4.1">Then, the FullEKTField is formed using the EKTCiphertext and the SPI
associated with the EKTKey used above. Also appended are the length
and Message Type using the FullEKTField format.<a class="pilcrow" href="#section-4.3.1-3.4.1">¶</a></p>
</li>
          </ol>
<aside id="section-4.3.1-4">
            <p id="section-4.3.1-4.1">Note: The value of the EKTCiphertext field is identical in successive
packets protected by the same EKTKey and SRTP master key. This value <span class="bcp14">MAY</span>
be cached by an SRTP sender to minimize computational effort.<a class="pilcrow" href="#section-4.3.1-4.1">¶</a></p>
</aside>
<p id="section-4.3.1-5">The computed value of the FullEKTField is appended to the end of
          the SRTP packet, after the encrypted payload.<a class="pilcrow" href="#section-4.3.1-5">¶</a></p>
<p id="section-4.3.1-6">When a packet is sent with the ShortEKTField, the ShortEKTField
          is simply appended to the packet.<a class="pilcrow" href="#section-4.3.1-6">¶</a></p>
<p id="section-4.3.1-7">Outbound packets <span class="bcp14">SHOULD</span> continue to use the old SRTP master key for
250 ms after sending any new key in a FullEKTField value. This gives
all the receivers in the system time to get the new key before they
start receiving media encrypted with the new key.  (The specific
value of 250 ms is chosen to represent a reasonable upper bound on
the amount of latency and jitter that is tolerable in a real-time
context.)<a class="pilcrow" href="#section-4.3.1-7">¶</a></p>
</section>
</div>
<div id="inbound-processing">
<section id="section-4.3.2">
          <h4 id="name-inbound-processing">
<a class="section-number selfRef" href="#section-4.3.2">4.3.2. </a><a class="section-name selfRef" href="#name-inbound-processing">Inbound Processing</a>
          </h4>
<p id="section-4.3.2-1">When receiving a packet on an RTP stream, the following steps are
applied for each received SRTP packet.<a class="pilcrow" href="#section-4.3.2-1">¶</a></p>
<ol class="normal type-1" id="section-4.3.2-2" start="1" type="1">
            <li id="section-4.3.2-2.1">The final byte is checked to determine which EKT format is in
use. When an SRTP packet contains a ShortEKTField, the
ShortEKTField is removed from the packet and then normal SRTP
processing occurs. If the packet contains a FullEKTField, then
processing continues as described below. The reason for using the
last byte of the packet to indicate the type is that the length of
the SRTP part is not known until the decryption has
occurred. At this point in the processing, there is no easy way to
know where the EKTField would start. However, the whole SRTP packet
has been received, so instead of starting at the front of the
packet, the parsing works backwards at the end of the packet, and
thus the type is placed at the very end of the packet.<a class="pilcrow" href="#section-4.3.2-2.1">¶</a>
</li>
            <li id="section-4.3.2-2.2">The Security Parameter Index (SPI) field is used to find the
right EKT parameter set to be used for processing the packet.
If there is no matching SPI, then the verification function
<span class="bcp14">MUST</span> return an indication of authentication failure, and
the steps described below are not performed. The EKT parameter
set contains the EKTKey, the EKTCipher, and the SRTP master salt.<a class="pilcrow" href="#section-4.3.2-2.2">¶</a>
</li>
            <li id="section-4.3.2-2.3">The EKTCiphertext is authenticated and decrypted, as
described in <a class="xref" href="#cipher">Section 4.4</a>, using the EKTKey and EKTCipher found in the
previous step. If the EKT decryption operation returns an
authentication failure, then EKT processing <span class="bcp14">MUST</span> be aborted.  The
receiver <span class="bcp14">SHOULD</span> discard the whole SRTP packet.<a class="pilcrow" href="#section-4.3.2-2.3">¶</a>
</li>
            <li id="section-4.3.2-2.4">The resulting EKTPlaintext is parsed as described in <a class="xref" href="#EKT">Section 4.1</a>, to
recover the SRTP master key, SSRC, and ROC fields. The SRTP master
salt that is associated with the EKTKey is also retrieved. If the
value of the srtp_master_salt (see <a class="xref" href="#ekt_key">Section 5.2.2</a>) sent as part of the EKTKey is
longer than needed by SRTP, then it is truncated by taking the
first N bytes from the srtp_master_salt field.<a class="pilcrow" href="#section-4.3.2-2.4">¶</a>
</li>
            <li id="section-4.3.2-2.5">If the SSRC in the EKTPlaintext does not match the SSRC of the SRTP packet
received, then this FullEKTField <span class="bcp14">MUST</span> be discarded and the
subsequent steps in
this list skipped.  After stripping the FullEKTField, the remainder of
the SRTP packet <span class="bcp14">MAY</span> be processed as normal.<a class="pilcrow" href="#section-4.3.2-2.5">¶</a>
</li>
            <li id="section-4.3.2-2.6">
              <p id="section-4.3.2-2.6.1">The SRTP master key, ROC, and SRTP master salt from the previous
steps are saved in a map indexed by the SSRC found in the
EKTPlaintext and can be used for any future crypto operations on
the inbound packets with that SSRC.<a class="pilcrow" href="#section-4.3.2-2.6.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.2-2.6.2.1">Unless the transform specifies other acceptable key lengths,
the length of the SRTP master key <span class="bcp14">MUST</span> be the same as the
master key length for the SRTP transform in use.  If this is
not the case, then the receiver <span class="bcp14">MUST</span> abort EKT processing and
<span class="bcp14">SHOULD</span> discard the whole SRTP packet.<a class="pilcrow" href="#section-4.3.2-2.6.2.1">¶</a>
</li>
                <li class="normal" id="section-4.3.2-2.6.2.2">If the length of the SRTP master key is less than the master
key length for the SRTP transform in use and the transform
specifies that this length is acceptable, then the SRTP master
key value is used to replace the first bytes in the existing
master key.  The other bytes remain the same as in the old key.
For example, the double GCM transform <span>[<a class="xref" href="#RFC8723">RFC8723</a>]</span>
allows replacement of the first ("end-to-end") half of the
master key.<a class="pilcrow" href="#section-4.3.2-2.6.2.2">¶</a>
</li>
              </ul>
</li>
            <li id="section-4.3.2-2.7">At this point, EKT processing has successfully completed, and the
normal SRTP processing takes place.<a class="pilcrow" href="#section-4.3.2-2.7">¶</a>
</li>
          </ol>
<p id="section-4.3.2-3">The value of the EKTCiphertext field is identical in successive
packets protected by the same EKT parameter set, SRTP
master key, and ROC.
  SRTP senders and receivers <span class="bcp14">MAY</span> cache an
EKTCiphertext value to optimize processing in cases where the master
key hasn't changed.  Instead of encrypting and decrypting, senders
can simply copy the precomputed value and receivers can compare a
received EKTCiphertext to the known value.<a class="pilcrow" href="#section-4.3.2-3">¶</a></p>
<p id="section-4.3.2-4"><a class="xref" href="#outbound-processing">Section 4.3.1</a> recommends that SRTP senders continue using
an old key for some time after sending a new key in an EKT Tag.
Receivers that wish to avoid packet loss due to decryption failures
<span class="bcp14">MAY</span> perform trial decryption with both the old key and the new key,
keeping the result of whichever decryption succeeds.  Note that this
approach is only compatible with SRTP transforms that include
integrity protection.<a class="pilcrow" href="#section-4.3.2-4">¶</a></p>
<p id="section-4.3.2-5">When receiving a new EKTKey, implementations need to use the
ekt_ttl field (see <a class="xref" href="#ekt_key">Section 5.2.2</a>)
to create a time after which this key cannot be used, and they also
need to create a counter that keeps track of how many times the key
has been used to encrypt data, to ensure that it does not exceed the T value
for that cipher (see <a class="xref" href="#cipher">Section 4.4</a>). If either of
these limits is exceeded,
the key can no longer be used for encryption. At this point, implementations
need to either use call signaling to renegotiate a new session
or terminate the existing session.  Terminating the session is a
reasonable implementation choice because these limits should not be
exceeded, except under an attack or error condition.<a class="pilcrow" href="#section-4.3.2-5">¶</a></p>
</section>
</div>
</section>
</div>
<div id="cipher">
<section id="section-4.4">
        <h3 id="name-ciphers">
<a class="section-number selfRef" href="#section-4.4">4.4. </a><a class="section-name selfRef" href="#name-ciphers">Ciphers</a>
        </h3>
<p id="section-4.4-1">EKT uses an authenticated cipher to encrypt and authenticate the
EKTPlaintext.  This specification defines the interface to the cipher,
in order to abstract the interface away from the details of that
function. This specification also defines the default cipher that is
used in EKT. The default cipher described in <a class="xref" href="#DefaultCipher">Section 4.4.1</a> <span class="bcp14">MUST</span>
be implemented, but another cipher that conforms to this interface
<span class="bcp14">MAY</span> be used.  The cipher used for a given EKTCiphertext value is
negotiated using the supported_ekt_ciphers extension (see <a class="xref" href="#dtls-srtp-extensions">Section 5.2</a>) and indicated with the
SPI value in the FullEKTField.<a class="pilcrow" href="#section-4.4-1">¶</a></p>
<p id="section-4.4-2">An EKTCipher consists of an encryption function and a decryption
function. The encryption function E(K, P) takes the following inputs:<a class="pilcrow" href="#section-4.4-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4-3.1">a secret key K with a length of L bytes, and<a class="pilcrow" href="#section-4.4-3.1">¶</a>
</li>
          <li class="normal" id="section-4.4-3.2">a plaintext value P with a length of M bytes.<a class="pilcrow" href="#section-4.4-3.2">¶</a>
</li>
        </ul>
<p id="section-4.4-4">The encryption function returns a ciphertext value C whose length is N
bytes, where N may be larger than M. The decryption function D(K, C)
takes the following inputs:<a class="pilcrow" href="#section-4.4-4">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4-5.1">a secret key K with a length of L bytes, and<a class="pilcrow" href="#section-4.4-5.1">¶</a>
</li>
          <li class="normal" id="section-4.4-5.2">a ciphertext value C with a length of N bytes.<a class="pilcrow" href="#section-4.4-5.2">¶</a>
</li>
        </ul>
<p id="section-4.4-6">The decryption function returns a plaintext value P that is M bytes
long, or it returns an indication that the decryption operation failed
because the ciphertext was invalid (i.e., it was not generated by the
encryption of plaintext with the key K).<a class="pilcrow" href="#section-4.4-6">¶</a></p>
<p id="section-4.4-7">These functions have the property that D(K, E(K, P)) = P for all
values of K and P. Each cipher also has a limit T on the number of
times that it can be used with any fixed key value.  The EKTKey <span class="bcp14">MUST NOT</span> be used for encryption more than T times.  Note that if the same
FullEKTField is retransmitted three times, that only counts as one
encryption.<a class="pilcrow" href="#section-4.4-7">¶</a></p>
<p id="section-4.4-8">Security requirements for EKT Ciphers are discussed in <a class="xref" href="#sec">Section 6</a>.<a class="pilcrow" href="#section-4.4-8">¶</a></p>
<div id="DefaultCipher">
<section id="section-4.4.1">
          <h4 id="name-aes-key-wrap">
<a class="section-number selfRef" href="#section-4.4.1">4.4.1. </a><a class="section-name selfRef" href="#name-aes-key-wrap">AES Key Wrap</a>
          </h4>
<p id="section-4.4.1-1">The default EKT Cipher is the Advanced Encryption Standard (AES)
          Key Wrap with Padding algorithm <span>[<a class="xref" href="#RFC5649">RFC5649</a>]</span>. It requires a plaintext length M that is at least one
          octet, and it returns a ciphertext with a length of N = M + (M mod
          8) + 8 octets. It can be used with key sizes of L = 16 octets or L = 32
          octets, and its use with those key sizes is indicated as AESKW128
          or AESKW256, respectively.
 The key size determines the length of the
          AES key used by the Key Wrap algorithm. With this cipher,
          T=2<sup>48</sup>.<a class="pilcrow" href="#section-4.4.1-1">¶</a></p>
<span id="name-ekt-ciphers"></span><div id="CipherTable">
<table class="center" id="table-1">
            <caption>
<a class="selfRef" href="#table-1">Table 1</a>:
<a class="selfRef" href="#name-ekt-ciphers">EKT Ciphers</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" colspan="1" rowspan="1">Cipher</th>
                <th class="text-right" colspan="1" rowspan="1">L</th>
                <th class="text-right" colspan="1" rowspan="1">T</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">AESKW128</td>
                <td class="text-right" colspan="1" rowspan="1">16</td>
                <td class="text-right" colspan="1" rowspan="1">2<sup>48</sup>
</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">AESKW256</td>
                <td class="text-right" colspan="1" rowspan="1">32</td>
                <td class="text-right" colspan="1" rowspan="1">2<sup>48</sup>
</td>
              </tr>
            </tbody>
          </table>
</div>
<p id="section-4.4.1-3">As AES-128 is the mandatory-to-implement transform in SRTP, AESKW128
<span class="bcp14">MUST</span> be implemented for EKT. AESKW256 <span class="bcp14">MAY</span> be implemented.<a class="pilcrow" href="#section-4.4.1-3">¶</a></p>
</section>
</div>
<div id="defining-new-ekt-ciphers">
<section id="section-4.4.2">
          <h4 id="name-defining-new-ekt-ciphers">
<a class="section-number selfRef" href="#section-4.4.2">4.4.2. </a><a class="section-name selfRef" href="#name-defining-new-ekt-ciphers">Defining New EKT Ciphers</a>
          </h4>
<p id="section-4.4.2-1">Other specifications may extend this document by defining other
EKTCiphers, as described in <a class="xref" href="#iana">Section 7</a>. This section defines how those
ciphers interact with this specification.<a class="pilcrow" href="#section-4.4.2-1">¶</a></p>
<p id="section-4.4.2-2">An EKTCipher determines how the EKTCiphertext field is written and
how it is processed when it is read. This field is opaque to the other
aspects of EKT processing. EKT Ciphers are free to use this field in
any way, but they <span class="bcp14">SHOULD NOT</span> use other EKT or SRTP fields as an
input. The values of the parameters L and T <span class="bcp14">MUST</span> be defined by each
EKTCipher.
 The cipher <span class="bcp14">MUST</span> provide integrity protection.<a class="pilcrow" href="#section-4.4.2-2">¶</a></p>
</section>
</div>
</section>
</div>
<div id="SynchronizingOperation">
<section id="section-4.5">
        <h3 id="name-synchronizing-operation">
<a class="section-number selfRef" href="#section-4.5">4.5. </a><a class="section-name selfRef" href="#name-synchronizing-operation">Synchronizing Operation</a>
        </h3>
<p id="section-4.5-1">If a source has its EKTKey changed by key management, it <span class="bcp14">MUST</span> also
change its SRTP master key, which will cause it to send out a new
FullEKTField and eventually begin encrypting with it, as described in
<a class="xref" href="#outbound-processing">Section 4.3.1</a>.
This ensures that if key management thought the EKTKey
needs changing (due to a participant leaving or joining) and
communicated that to a source, the source will also change its SRTP
master key, so that traffic can be decrypted only by those who know
the current EKTKey.<a class="pilcrow" href="#section-4.5-1">¶</a></p>
</section>
</div>
<div id="timing">
<section id="section-4.6">
        <h3 id="name-timing-and-reliability-cons">
<a class="section-number selfRef" href="#section-4.6">4.6. </a><a class="section-name selfRef" href="#name-timing-and-reliability-cons">Timing and Reliability Considerations</a>
        </h3>
<p id="section-4.6-1">A system using EKT learns the SRTP master keys distributed with
the FullEKTField sent with SRTP, rather than with call signaling.
 A
receiver can immediately decrypt an SRTP packet, provided the SRTP
packet contains a FullEKTField.<a class="pilcrow" href="#section-4.6-1">¶</a></p>
<p id="section-4.6-2">This section describes how to reliably and expediently deliver new
SRTP master keys to receivers.<a class="pilcrow" href="#section-4.6-2">¶</a></p>
<p id="section-4.6-3">There are three cases to consider. In the first case, a new
        sender joins a session and needs to communicate its SRTP
        master key to all the receivers.  In the second case, a sender
        changes its SRTP master key, which needs to be communicated to all
        the receivers. In the third case, a new receiver joins a session
        already in progress and needs to know the sender's SRTP
        master key.<a class="pilcrow" href="#section-4.6-3">¶</a></p>
<p id="section-4.6-4">The three cases are as follows:<a class="pilcrow" href="#section-4.6-4">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.6-5">
          <dt id="section-4.6-5.1">New sender:</dt>
          <dd id="section-4.6-5.2" style="margin-left: 1.5em">
A new sender <span class="bcp14">SHOULD</span> send a packet containing the
FullEKTField as soon as possible, ideally in its initial SRTP packet.  To accommodate packet loss, it is
<span class="bcp14">RECOMMENDED</span> that the FullEKTField be transmitted in three consecutive packets.
If the sender does not send a FullEKTField in its
initial packets and receivers have not otherwise been provisioned
with a decryption key, then decryption will fail and SRTP packets
will be dropped until the receiver receives a FullEKTField from the
sender.<a class="pilcrow" href="#section-4.6-5.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.6-5.3">Rekey:</dt>
          <dd id="section-4.6-5.4" style="margin-left: 1.5em">
By sending an EKT Tag over SRTP, the rekeying event shares fate with the
SRTP packets protected with that new SRTP master key. To accommodate
packet loss, it is <span class="bcp14">RECOMMENDED</span> that three consecutive packets
containing the FullEKTField be transmitted.<a class="pilcrow" href="#section-4.6-5.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.6-5.5">New receiver:</dt>
          <dd id="section-4.6-5.6" style="margin-left: 1.5em">
When a new receiver joins a session, it does not need to communicate
its sending SRTP master key (because it is a receiver). Also, when a new
receiver joins a session, the sender is generally unaware of the
receiver joining the session; thus, senders <span class="bcp14">SHOULD</span> periodically
transmit the FullEKTField. That interval depends on how frequently new
receivers join the session, the acceptable delay before those
receivers can start processing SRTP packets, and the acceptable
overhead of sending the FullEKTField. If sending audio and video, the
<span class="bcp14">RECOMMENDED</span> frequency is the same as the rate of intra-coded video
frames. If only sending audio, the <span class="bcp14">RECOMMENDED</span> frequency is every
100 ms.<a class="pilcrow" href="#section-4.6-5.6">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.6-6">If none of the above three cases apply, a ShortEKTField <span class="bcp14">SHOULD</span> be sent.<a class="pilcrow" href="#section-4.6-6">¶</a></p>
<p id="section-4.6-7">
In general, sending FullEKTField tags less frequently will consume less
bandwidth but will increase the time it takes for a join or rekey to
take effect.  Applications should schedule the sending of FullEKTField tags in
a way that makes sense for their bandwidth and latency requirements.<a class="pilcrow" href="#section-4.6-7">¶</a></p>
</section>
</div>
</section>
</div>
<div id="dtls-srtp-kt">
<section id="section-5">
      <h2 id="name-use-of-ekt-with-dtls-srtp">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-use-of-ekt-with-dtls-srtp">Use of EKT with DTLS-SRTP</a>
      </h2>
<p id="section-5-1">This document defines an extension to DTLS-SRTP called "SRTP EKTKey
Transport", which enables secure transport of EKT keying material from
the DTLS-SRTP peer in the server role to the client. This allows
such a peer to process EKT keying material in SRTP and
retrieve the embedded SRTP keying material.
  This combination of
protocols is valuable because it combines the advantages of DTLS,
which has strong authentication of the endpoint and flexibility,
along with allowing secure multi-party RTP with loose coordination
and efficient communication of per-source keys.<a class="pilcrow" href="#section-5-1">¶</a></p>
<p id="section-5-2">In cases where the DTLS termination point is more trusted than the
media relay, the protection that DTLS affords to EKT keying material
can allow EKT Keys to be tunneled through an untrusted relay such as
a centralized conference bridge.  For more details, see
<span>[<a class="xref" href="#RFC8871">RFC8871</a>]</span>.<a class="pilcrow" href="#section-5-2">¶</a></p>
<div id="dtlssrtp-recap">
<section id="section-5.1">
        <h3 id="name-dtls-srtp-recap">
<a class="section-number selfRef" href="#section-5.1">5.1. </a><a class="section-name selfRef" href="#name-dtls-srtp-recap">DTLS-SRTP Recap</a>
        </h3>
<p id="section-5.1-1">DTLS-SRTP <span>[<a class="xref" href="#RFC5764">RFC5764</a>]</span> uses an extended DTLS exchange between two
peers to exchange keying material, algorithms, and parameters for
SRTP. The SRTP flow operates over the same transport as the
DTLS-SRTP exchange (i.e., the same 5-tuple). DTLS-SRTP combines the
performance and encryption flexibility benefits of SRTP with the
flexibility and convenience of DTLS-integrated key and association
management. DTLS-SRTP can be viewed in two equivalent ways: as a new
key management method for SRTP and as a new RTP-specific data format
for DTLS.<a class="pilcrow" href="#section-5.1-1">¶</a></p>
</section>
</div>
<div id="dtls-srtp-extensions">
<section id="section-5.2">
        <h3 id="name-srtp-ekt-key-transport-exte">
<a class="section-number selfRef" href="#section-5.2">5.2. </a><a class="section-name selfRef" href="#name-srtp-ekt-key-transport-exte">SRTP EKT Key Transport Extensions to DTLS-SRTP</a>
        </h3>
<p id="section-5.2-1">This document defines a new TLS negotiated extension
called "supported_ekt_ciphers" and a new TLS handshake message type called
"ekt_key".  The extension negotiates the cipher to be used in
encrypting and decrypting EKTCiphertext values, and the handshake
message carries the corresponding key.<a class="pilcrow" href="#section-5.2-1">¶</a></p>
<p id="section-5.2-2"><a class="xref" href="#dtls-srtp-flow">Figure 4</a> shows a message
flow between a DTLS 1.3 client and server
using EKT configured using the DTLS extensions described in this
section.  (The initial cookie exchange and other normal DTLS
messages are omitted.)  To be clear, EKT can be used with versions
of DTLS prior to 1.3.  The only difference is that in pre-1.3 TLS,
stacks will not have built-in support for generating and processing
ACK messages.<a class="pilcrow" href="#section-5.2-2">¶</a></p>
<span id="name-dtls-13-message-flow"></span><div id="dtls-srtp-flow">
<figure id="figure-4">
          <div class="artwork art-text alignCenter" id="section-5.2-3.1">
<pre>Client                                             Server

ClientHello
 + use_srtp
 + supported_ekt_ciphers
                        --------&gt;

                                               ServerHello
                                     {EncryptedExtensions}
                                                + use_srtp
                                   + supported_ekt_ciphers
                                            {... Finished}
                        &lt;--------

{... Finished}          --------&gt;

                                                     [ACK]
                        &lt;--------                 [EKTKey]

[ACK]                   --------&gt;

|SRTP packets|          &lt;-------&gt;           |SRTP packets|
+ &lt;EKT Tags&gt;                                  + &lt;EKT Tags&gt;


{} Messages protected using DTLS handshake keys

[] Messages protected using DTLS application traffic keys

&lt;&gt; Messages protected using the EKTKey and EKT Cipher

|| Messages protected using the SRTP master key sent in
   a Full EKT Tag</pre>
</div>
<figcaption><a class="selfRef" href="#figure-4">Figure 4</a>:
<a class="selfRef" href="#name-dtls-13-message-flow">DTLS 1.3 Message Flow</a>
          </figcaption></figure>
</div>
<p id="section-5.2-4">In the context of a multi-party SRTP session in which each endpoint
performs a DTLS handshake as a client with a central DTLS server,
the extensions defined in this document allow the DTLS server to set
a common EKTKey for all participants. Each endpoint can then use
EKT Tags encrypted with that common key to inform other endpoints of
the keys it uses to protect SRTP packets.  This avoids the need
for many individual DTLS handshakes among the endpoints, at the cost
of preventing endpoints from directly authenticating one another.<a class="pilcrow" href="#section-5.2-4">¶</a></p>
<div class="artwork art-text alignCenter" id="section-5.2-5">
<pre>Client A                 Server                 Client B

    &lt;----DTLS Handshake----&gt;
    &lt;--------EKTKey---------
                            &lt;----DTLS Handshake----&gt;
                            ---------EKTKey--------&gt;

    -------------SRTP Packet + EKT Tag-------------&gt;
    &lt;------------SRTP Packet + EKT Tag--------------</pre><a class="pilcrow" href="#section-5.2-5">¶</a>
</div>
<div id="negotiating-an-ektcipher">
<section id="section-5.2.1">
          <h4 id="name-negotiating-an-ektcipher">
<a class="section-number selfRef" href="#section-5.2.1">5.2.1. </a><a class="section-name selfRef" href="#name-negotiating-an-ektcipher">Negotiating an EKTCipher</a>
          </h4>
<p id="section-5.2.1-1">To indicate its support for EKT, a DTLS-SRTP client includes in its
ClientHello an extension of type supported_ekt_ciphers listing the
ciphers used for EKT by the client, in preference order, with
the most preferred version first.  If the server agrees to use EKT,
then it includes a supported_ekt_ciphers extension in its
EncryptedExtensions (or ServerHello for DTLS 1.2)
containing a cipher selected from among those advertised by the
client.<a class="pilcrow" href="#section-5.2.1-1">¶</a></p>
<p id="section-5.2.1-2">The extension_data field of this extension contains an "EKTCipher" value,
encoded using the syntax defined in <span>[<a class="xref" href="#RFC8446">RFC8446</a>]</span>:<a class="pilcrow" href="#section-5.2.1-2">¶</a></p>
<div id="section-5.2.1-3">
<pre class="sourcecode lang-tls-presentation">        enum {
          reserved(0),
          aeskw_128(1),
          aeskw_256(2),
        } EKTCipherType;

        struct {
            select (Handshake.msg_type) {
                case client_hello:
                    EKTCipherType supported_ciphers&lt;1..255&gt;;

                case server_hello:
                    EKTCipherType selected_cipher;

                case encrypted_extensions:
                    EKTCipherType selected_cipher;

            };
        } EKTCipher;</pre><a class="pilcrow" href="#section-5.2.1-3">¶</a>
</div>
</section>
</div>
<div id="ekt_key">
<section id="section-5.2.2">
          <h4 id="name-establishing-an-ekt-key">
<a class="section-number selfRef" href="#section-5.2.2">5.2.2. </a><a class="section-name selfRef" href="#name-establishing-an-ekt-key">Establishing an EKT Key</a>
          </h4>
<p id="section-5.2.2-1">Once a client and server have concluded a handshake that negotiated
an EKTCipher, the server <span class="bcp14">MUST</span> provide to the client a key to be
used when encrypting and decrypting EKTCiphertext values. EKTKeys
are sent in encrypted handshake records, using handshake type
ekt_key(26).  The body of the handshake message contains an
EKTKey structure as follows:<a class="pilcrow" href="#section-5.2.2-1">¶</a></p>
<div class="artwork art-text alignCenter" id="section-5.2.2-2">
<pre>struct {
  opaque ekt_key_value&lt;1..256&gt;;
  opaque srtp_master_salt&lt;1..256&gt;;
  uint16 ekt_spi;
  uint24 ekt_ttl;
} EKTKey;</pre><a class="pilcrow" href="#section-5.2.2-2">¶</a>
</div>
<p id="section-5.2.2-3">The contents of the fields in this message are as follows:<a class="pilcrow" href="#section-5.2.2-3">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-5.2.2-4">
            <dt id="section-5.2.2-4.1">ekt_key_value</dt>
            <dd id="section-5.2.2-4.2" style="margin-left: 1.5em">
The EKTKey that the recipient should use when generating EKTCiphertext
values<a class="pilcrow" href="#section-5.2.2-4.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.2-4.3">srtp_master_salt</dt>
            <dd id="section-5.2.2-4.4" style="margin-left: 1.5em">
The SRTP master salt to be used with any master key encrypted with this EKT
Key<a class="pilcrow" href="#section-5.2.2-4.4">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.2-4.5">ekt_spi</dt>
            <dd id="section-5.2.2-4.6" style="margin-left: 1.5em">
The SPI value to be used to reference this EKTKey and SRTP master salt in
EKT Tags (along with the EKT Cipher negotiated in the handshake)<a class="pilcrow" href="#section-5.2.2-4.6">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.2-4.7">ekt_ttl</dt>
            <dd id="section-5.2.2-4.8" style="margin-left: 1.5em">
The maximum amount of time, in seconds, that this EKTKey can be used.  The
ekt_key_value in this message <span class="bcp14">MUST NOT</span> be used for encrypting or decrypting
information after the TTL expires.<a class="pilcrow" href="#section-5.2.2-4.8">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-5.2.2-5">If the server did not provide a supported_ekt_ciphers extension in
its EncryptedExtensions (or ServerHello for DTLS 1.2), then EKTKey messages <span class="bcp14">MUST NOT</span> be sent by the client
or the server.<a class="pilcrow" href="#section-5.2.2-5">¶</a></p>
<p id="section-5.2.2-6">When an EKTKey is received and processed successfully, the
          recipient <span class="bcp14">MUST</span> respond with an ACK message as
          described in <span><a class="relref" href="https://tools.ietf.org/html/draft-ietf-tls-dtls13-39#section-7">Section 7</a> of [<a class="xref" href="#I-D.ietf-tls-dtls13">TLS-DTLS13</a>]</span>.  The EKTKey message and ACK <span class="bcp14">MUST</span> be
          retransmitted following the rules of the negotiated version of
          DTLS.<a class="pilcrow" href="#section-5.2.2-6">¶</a></p>
<p id="section-5.2.2-7">EKT <span class="bcp14">MAY</span> be used with versions of DTLS prior to
          1.3.  In such cases, to provide reliability, the ACK message is still used.  Thus, DTLS
implementations supporting EKT with pre-1.3 versions of DTLS will need to have
explicit affordances for sending the ACK message in response to an
EKTKey message and for verifying that an ACK message was received.
The retransmission rules for both sides are otherwise defined by the
negotiated version of DTLS.<a class="pilcrow" href="#section-5.2.2-7">¶</a></p>
<p id="section-5.2.2-8">If an EKTKey message is received that cannot be processed, then the
recipient <span class="bcp14">MUST</span> respond with an appropriate DTLS alert.<a class="pilcrow" href="#section-5.2.2-8">¶</a></p>
</section>
</div>
</section>
</div>
<div id="offeranswer-considerations">
<section id="section-5.3">
        <h3 id="name-offer-answer-considerations">
<a class="section-number selfRef" href="#section-5.3">5.3. </a><a class="section-name selfRef" href="#name-offer-answer-considerations">Offer/Answer Considerations</a>
        </h3>
<p id="section-5.3-1">When using EKT with DTLS-SRTP, the negotiation to use EKT is done at
the DTLS handshake level and does not change the SDP Offer⁠/Answer messaging <span>[<a class="xref" href="#RFC3264">RFC3264</a>]</span>.<a class="pilcrow" href="#section-5.3-1">¶</a></p>
</section>
</div>
<div id="sending-the-dtls-ektkey-reliably">
<section id="section-5.4">
        <h3 id="name-sending-the-dtls-ektkey-rel">
<a class="section-number selfRef" href="#section-5.4">5.4. </a><a class="section-name selfRef" href="#name-sending-the-dtls-ektkey-rel">Sending the DTLS EKTKey Reliably</a>
        </h3>
<p id="section-5.4-1">The DTLS EKTKey message is sent using the retransmissions specified
        in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6347#section-4.2.4">Section 4.2.4</a> of DTLS [<a class="xref" href="#RFC6347">RFC6347</a>]</span>.
        Retransmission is finished with an ACK message, or an alert is
        received.<a class="pilcrow" href="#section-5.4-1">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec">
<section id="section-6">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<p id="section-6-1">EKT inherits the security properties of the key management
      protocol that is used to establish the EKTKey, e.g., the DTLS-SRTP
      extension defined in this document.<a class="pilcrow" href="#section-6-1">¶</a></p>
<p id="section-6-2">With EKT, each SRTP sender and receiver <span class="bcp14">MUST</span> generate distinct SRTP
master keys. This property avoids any security concerns over the reuse
of keys, by empowering the SRTP layer to create keys on demand. Note
that the inputs of EKT are the same as for SRTP with key-sharing: a
single key is provided to protect an entire SRTP session. However, EKT
remains secure even when SSRC values collide.<a class="pilcrow" href="#section-6-2">¶</a></p>
<p id="section-6-3">SRTP master keys <span class="bcp14">MUST</span> be randomly generated, and <span>[<a class="xref" href="#RFC4086">RFC4086</a>]</span> offers
some guidance about random number generation. SRTP master keys <span class="bcp14">MUST NOT</span> be reused for any other purpose, and SRTP master keys <span class="bcp14">MUST NOT</span> be
derived from other SRTP master keys.<a class="pilcrow" href="#section-6-3">¶</a></p>
<p id="section-6-4">The EKT Cipher includes its own authentication/integrity check.<a class="pilcrow" href="#section-6-4">¶</a></p>
<p id="section-6-5">The presence of the SSRC in the EKTPlaintext ensures that an attacker
cannot substitute an EKTCiphertext from one SRTP stream into another
SRTP stream.  This mitigates the impact of cut-and-paste attacks
that arise due to the lack of a cryptographic binding between the
EKT Tag and the rest of the SRTP packet.  SRTP tags can only be
cut-and-pasted within the stream of packets sent by a given RTP
endpoint; an attacker cannot "cross the streams" and use an EKT Tag
from one SSRC to reset the key for another SSRC.  The Epoch field
in the FullEKTField also prevents an attacker from rolling back to a
previous key.<a class="pilcrow" href="#section-6-5">¶</a></p>
<p id="section-6-6">An attacker could send packets containing a FullEKTField, in an
attempt to consume additional CPU resources of the receiving system by
causing the receiving system to decrypt the EKT ciphertext and
detect an authentication failure. In some cases, caching the previous
values of the ciphertext as described in <a class="xref" href="#inbound-processing">Section 4.3.2</a> helps
mitigate this issue.<a class="pilcrow" href="#section-6-6">¶</a></p>
<p id="section-6-7">In a similar vein, EKT has no replay protection, so an attacker
could implant improper keys in receivers by capturing EKTCiphertext
values encrypted with a given EKTKey and replaying them in a
different context, e.g., from a different sender.  When the
underlying SRTP transform provides integrity protection, this attack
will just result in packet loss.  If it does not, then it will
result in random data being fed to RTP payload processing.  An
attacker that is in a position to mount these attacks, however,
could achieve the same effects more easily without attacking EKT.<a class="pilcrow" href="#section-6-7">¶</a></p>
<p id="section-6-8">The key encryption keys distributed with EKTKey messages are group
shared symmetric keys, which means they do not provide protection
within the group.  Group members can impersonate each other; for
example, any group member can generate an EKT Tag for any SSRC.  The
entity that distributes EKTKeys can decrypt any keys distributed
using EKT and thus any media protected with those keys.<a class="pilcrow" href="#section-6-8">¶</a></p>
<p id="section-6-9">Each EKT Cipher specifies a value T that is the maximum number of
times a given key can be used. An endpoint <span class="bcp14">MUST NOT</span> encrypt more than
T different FullEKTField values using the same EKTKey. In addition, the
EKTKey <span class="bcp14">MUST NOT</span> be used beyond the lifetime provided by the TTL
described in <a class="xref" href="#dtls-srtp-extensions">Section 5.2</a>.<a class="pilcrow" href="#section-6-9">¶</a></p>
<p id="section-6-10">The key length of the EKT Cipher
<span class="bcp14">MUST</span> be at least as long as the SRTP cipher and at least as long
as the DTLS-SRTP ciphers.<a class="pilcrow" href="#section-6-10">¶</a></p>
<p id="section-6-11">Part of the EKTPlaintext is known or is easily guessable to an
attacker. Thus, the EKT Cipher <span class="bcp14">MUST</span> resist known plaintext attacks. In
practice, this requirement does not impose any restrictions on our
choices, since the ciphers in use provide high security even when much
plaintext is known.<a class="pilcrow" href="#section-6-11">¶</a></p>
<p id="section-6-12">An EKT Cipher <span class="bcp14">MUST</span> resist attacks in which both ciphertexts and
plaintexts can be adaptively chosen by an attacker querying both
the encryption and decryption functions.<a class="pilcrow" href="#section-6-12">¶</a></p>
<p id="section-6-13">In some systems, when a member of a conference leaves the conference,
that conference is rekeyed so that the member who left the conference no longer has the key. When
changing to a new EKTKey, it is possible that the attacker could block
the EKTKey message getting to a particular endpoint and that endpoint
would keep sending media encrypted using the old key. To mitigate that
risk, the lifetime of the EKTKey <span class="bcp14">MUST</span> be limited by using the ekt_ttl.<a class="pilcrow" href="#section-6-13">¶</a></p>
</section>
</div>
<div id="iana">
<section id="section-7">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<div id="iana-ekt-msg-types">
<section id="section-7.1">
        <h3 id="name-ekt-message-types">
<a class="section-number selfRef" href="#section-7.1">7.1. </a><a class="section-name selfRef" href="#name-ekt-message-types">EKT Message Types</a>
        </h3>
<p id="section-7.1-1">IANA has created a new table for "EKT Message Types" in
the "Real-Time Transport Protocol (RTP) Parameters" registry. The
initial values in this registry are as follows:<a class="pilcrow" href="#section-7.1-1">¶</a></p>
<span id="name-ekt-message-types-2"></span><div id="EKTMsgTypeTable">
<table class="center" id="table-2">
          <caption>
<a class="selfRef" href="#table-2">Table 2</a>:
<a class="selfRef" href="#name-ekt-message-types-2">EKT Message Types</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Message Type</th>
              <th class="text-right" colspan="1" rowspan="1">Value</th>
              <th class="text-left" colspan="1" rowspan="1">Specification</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">Short</td>
              <td class="text-right" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 8870</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">Unassigned</td>
              <td class="text-right" colspan="1" rowspan="1">1</td>
              <td class="text-left" colspan="1" rowspan="1"></td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">Full</td>
              <td class="text-right" colspan="1" rowspan="1">2</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 8870</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">Unassigned</td>
              <td class="text-right" colspan="1" rowspan="1">3-254</td>
              <td class="text-left" colspan="1" rowspan="1"></td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">Reserved</td>
              <td class="text-right" colspan="1" rowspan="1">255</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 8870</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-7.1-3">New entries in this table can be added via "Specification Required" as
defined in <span>[<a class="xref" href="#RFC8126">RFC8126</a>]</span>.  To avoid conflicts with
pre-standard versions of EKT that have been deployed, IANA
<span class="bcp14">SHOULD</span> give preference to the allocation of even values over odd values until
the even code points are consumed. Allocated values <span class="bcp14">MUST</span> be in the range of 0 to 254.<a class="pilcrow" href="#section-7.1-3">¶</a></p>
<p id="section-7.1-4">All new EKT messages <span class="bcp14">MUST</span> be defined to include a length parameter, as specified in <a class="xref" href="#EKT">Section 4.1</a>.<a class="pilcrow" href="#section-7.1-4">¶</a></p>
</section>
</div>
<div id="iana-ciphers">
<section id="section-7.2">
        <h3 id="name-ekt-ciphers-2">
<a class="section-number selfRef" href="#section-7.2">7.2. </a><a class="section-name selfRef" href="#name-ekt-ciphers-2">EKT Ciphers</a>
        </h3>
<p id="section-7.2-1">IANA has created a new table for "EKT Ciphers" in the
"Real-Time Transport Protocol (RTP) Parameters" registry.  The initial
values in this registry are as follows:<a class="pilcrow" href="#section-7.2-1">¶</a></p>
<span id="name-ekt-cipher-types"></span><div id="EKTCipherTable">
<table class="center" id="table-3">
          <caption>
<a class="selfRef" href="#table-3">Table 3</a>:
<a class="selfRef" href="#name-ekt-cipher-types">EKT Cipher Types</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Name</th>
              <th class="text-right" colspan="1" rowspan="1">Value</th>
              <th class="text-left" colspan="1" rowspan="1">Specification</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">AESKW128</td>
              <td class="text-right" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 8870</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">AESKW256</td>
              <td class="text-right" colspan="1" rowspan="1">1</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 8870</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">Unassigned</td>
              <td class="text-right" colspan="1" rowspan="1">2-254</td>
              <td class="text-left" colspan="1" rowspan="1"></td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">Reserved</td>
              <td class="text-right" colspan="1" rowspan="1">255</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 8870</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-7.2-3">New entries in this table can be added via "Specification Required" as
defined in <span>[<a class="xref" href="#RFC8126">RFC8126</a>]</span>. The expert
<span class="bcp14">SHOULD</span> ensure that the specification
defines the values for L and T as required in <a class="xref" href="#cipher">Section 4.4</a> of this document. Allocated values <span class="bcp14">MUST</span> be in the range of 0 to 254.<a class="pilcrow" href="#section-7.2-3">¶</a></p>
</section>
</div>
<div id="tls-extensions">
<section id="section-7.3">
        <h3 id="name-tls-extensions">
<a class="section-number selfRef" href="#section-7.3">7.3. </a><a class="section-name selfRef" href="#name-tls-extensions">TLS Extensions</a>
        </h3>
<p id="section-7.3-1">IANA has added supported_ekt_ciphers as a new extension
name to the "TLS ExtensionType Values" table of the "Transport Layer
Security (TLS) Extensions" registry:<a class="pilcrow" href="#section-7.3-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-7.3-2">
          <dt id="section-7.3-2.1">Value:</dt>
          <dd id="section-7.3-2.2" style="margin-left: 1.5em">39<a class="pilcrow" href="#section-7.3-2.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.3-2.3">Extension Name:</dt>
          <dd id="section-7.3-2.4" style="margin-left: 1.5em">supported_ekt_ciphers<a class="pilcrow" href="#section-7.3-2.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.3-2.5">TLS 1.3:</dt>
          <dd id="section-7.3-2.6" style="margin-left: 1.5em">CH, EE<a class="pilcrow" href="#section-7.3-2.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.3-2.7">Recommended:</dt>
          <dd id="section-7.3-2.8" style="margin-left: 1.5em">Y<a class="pilcrow" href="#section-7.3-2.8">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.3-2.9">Reference:</dt>
          <dd id="section-7.3-2.10" style="margin-left: 1.5em">RFC 8870<a class="pilcrow" href="#section-7.3-2.10">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="tls-handshake-type">
<section id="section-7.4">
        <h3 id="name-tls-handshake-type">
<a class="section-number selfRef" href="#section-7.4">7.4. </a><a class="section-name selfRef" href="#name-tls-handshake-type">TLS Handshake Type</a>
        </h3>
<p id="section-7.4-1">IANA has added ekt_key as a new entry in the "TLS
HandshakeType" table of the "Transport Layer Security (TLS)
Parameters" registry:<a class="pilcrow" href="#section-7.4-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-7.4-2">
          <dt id="section-7.4-2.1">Value:</dt>
          <dd id="section-7.4-2.2" style="margin-left: 1.5em">26<a class="pilcrow" href="#section-7.4-2.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.4-2.3">Description:</dt>
          <dd id="section-7.4-2.4" style="margin-left: 1.5em">ekt_key<a class="pilcrow" href="#section-7.4-2.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.4-2.5">DTLS-OK:</dt>
          <dd id="section-7.4-2.6" style="margin-left: 1.5em">Y<a class="pilcrow" href="#section-7.4-2.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.4-2.7">Reference:</dt>
          <dd id="section-7.4-2.8" style="margin-left: 1.5em">RFC 8870<a class="pilcrow" href="#section-7.4-2.8">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.4-2.9">Comment:</dt>
          <dd id="section-7.4-2.10" style="margin-left: 1.5em"></dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<section id="section-8">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-8">8. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-8.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-8.1">8.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time class="refDate" datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3264">[RFC3264]</dt>
        <dd>
<span class="refAuthor">Rosenberg, J.</span><span class="refAuthor"> and H. Schulzrinne</span>, <span class="refTitle">"An Offer/Answer Model with Session Description Protocol (SDP)"</span>, <span class="seriesInfo">RFC 3264</span>, <span class="seriesInfo">DOI 10.17487/RFC3264</span>, <time class="refDate" datetime="2002-06">June 2002</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3264">https://www.rfc-editor.org/info/rfc3264</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3711">[RFC3711]</dt>
        <dd>
<span class="refAuthor">Baugher, M.</span><span class="refAuthor">, McGrew, D.</span><span class="refAuthor">, Naslund, M.</span><span class="refAuthor">, Carrara, E.</span><span class="refAuthor">, and K. Norrman</span>, <span class="refTitle">"The Secure Real-time Transport Protocol (SRTP)"</span>, <span class="seriesInfo">RFC 3711</span>, <span class="seriesInfo">DOI 10.17487/RFC3711</span>, <time class="refDate" datetime="2004-03">March 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3711">https://www.rfc-editor.org/info/rfc3711</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5234">[RFC5234]</dt>
        <dd>
<span class="refAuthor">Crocker, D., Ed.</span><span class="refAuthor"> and P. Overell</span>, <span class="refTitle">"Augmented BNF for Syntax Specifications: ABNF"</span>, <span class="seriesInfo">STD 68</span>, <span class="seriesInfo">RFC 5234</span>, <span class="seriesInfo">DOI 10.17487/RFC5234</span>, <time class="refDate" datetime="2008-01">January 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5234">https://www.rfc-editor.org/info/rfc5234</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5649">[RFC5649]</dt>
        <dd>
<span class="refAuthor">Housley, R.</span><span class="refAuthor"> and M. Dworkin</span>, <span class="refTitle">"Advanced Encryption Standard (AES) Key Wrap with Padding Algorithm"</span>, <span class="seriesInfo">RFC 5649</span>, <span class="seriesInfo">DOI 10.17487/RFC5649</span>, <time class="refDate" datetime="2009-09">September 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5649">https://www.rfc-editor.org/info/rfc5649</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5764">[RFC5764]</dt>
        <dd>
<span class="refAuthor">McGrew, D.</span><span class="refAuthor"> and E. Rescorla</span>, <span class="refTitle">"Datagram Transport Layer Security (DTLS) Extension to Establish Keys for the Secure Real-time Transport Protocol (SRTP)"</span>, <span class="seriesInfo">RFC 5764</span>, <span class="seriesInfo">DOI 10.17487/RFC5764</span>, <time class="refDate" datetime="2010-05">May 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5764">https://www.rfc-editor.org/info/rfc5764</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6347">[RFC6347]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span><span class="refAuthor"> and N. Modadugu</span>, <span class="refTitle">"Datagram Transport Layer Security Version 1.2"</span>, <span class="seriesInfo">RFC 6347</span>, <span class="seriesInfo">DOI 10.17487/RFC6347</span>, <time class="refDate" datetime="2012-01">January 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6347">https://www.rfc-editor.org/info/rfc6347</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span><span class="refAuthor">, Leiba, B.</span><span class="refAuthor">, and T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time class="refDate" datetime="2017-06">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time class="refDate" datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
      <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time class="refDate" datetime="2018-08">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-8.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-8.2">8.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC4086">[RFC4086]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span><span class="refAuthor">, Schiller, J.</span><span class="refAuthor">, and S. Crocker</span>, <span class="refTitle">"Randomness Requirements for Security"</span>, <span class="seriesInfo">BCP 106</span>, <span class="seriesInfo">RFC 4086</span>, <span class="seriesInfo">DOI 10.17487/RFC4086</span>, <time class="refDate" datetime="2005-06">June 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4086">https://www.rfc-editor.org/info/rfc4086</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8723">[RFC8723]</dt>
        <dd>
<span class="refAuthor">Jennings, C.</span><span class="refAuthor">, Jones, P.</span><span class="refAuthor">, Barnes, R.</span><span class="refAuthor">, and A.B. Roach</span>, <span class="refTitle">"Double Encryption Procedures for the Secure Real-Time Transport Protocol (SRTP)"</span>, <span class="seriesInfo">RFC 8723</span>, <span class="seriesInfo">DOI 10.17487/RFC8723</span>, <time class="refDate" datetime="2020-04">April 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8723">https://www.rfc-editor.org/info/rfc8723</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8871">[RFC8871]</dt>
        <dd>
<span class="refAuthor">Jones, P.</span><span class="refAuthor">, Benham, D.</span><span class="refAuthor">, and C. Groves</span>, <span class="refTitle">"A Solution Framework for Private Media in Privacy-Enhanced RTP Conferencing (PERC)"</span>, <span class="seriesInfo">RFC 8871</span>, <span class="seriesInfo">DOI 10.17487/RFC8871</span>, <time class="refDate" datetime="2021-01">January 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8871">https://www.rfc-editor.org/info/rfc8871</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-tls-dtls13">[TLS-DTLS13]</dt>
      <dd>
<span class="refAuthor">Rescorla, E.</span><span class="refAuthor">, Tschofenig, H.</span><span class="refAuthor">, and N. Modadugu</span>, <span class="refTitle">"The Datagram Transport Layer Security (DTLS) Protocol Version 1.3"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-tls-dtls13-39</span>, <time class="refDate" datetime="2020-11-02">2 November 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-tls-dtls13-39">https://tools.ietf.org/html/draft-ietf-tls-dtls13-39</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="acknowledgements">
<section id="section-appendix.a">
      <h2 id="name-acknowledgments">
<a class="section-name selfRef" href="#name-acknowledgments">Acknowledgments</a>
      </h2>
<p id="section-appendix.a-1">Thank you to <span class="contact-name">Russ Housley</span>, who provided a detailed
      review and significant help with crafting text for this document. Thanks
      to <span class="contact-name">David Benham</span>, <span class="contact-name">Yi Cheng</span>,
      <span class="contact-name">Lakshminath Dondeti</span>, <span class="contact-name">Kai       Fischer</span>, <span class="contact-name">Nermeen Ismail</span>, <span class="contact-name">Paul Jones</span>, <span class="contact-name">Eddy Lem</span>, <span class="contact-name">Jonathan Lennox</span>, <span class="contact-name">Michael Peck</span>,
      <span class="contact-name">Rob Raymond</span>, <span class="contact-name">Sean Turner</span>,
      <span class="contact-name">Magnus Westerlund</span>, and <span class="contact-name">Felix       Wyss</span> for fruitful discussions, comments, and contributions to this
      document.<a class="pilcrow" href="#section-appendix.a-1">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="section-appendix.b">
      <h2 id="name-authors-addresses">
<a class="section-name selfRef" href="#name-authors-addresses">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Cullen Jennings</span></div>
<div class="left" dir="auto"><span class="org">Cisco Systems</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:fluffy@iii.ca">fluffy@iii.ca</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">John Mattsson</span></div>
<div class="left" dir="auto"><span class="org">Ericsson AB</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:john.mattsson@ericsson.com">john.mattsson@ericsson.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">David A. McGrew</span></div>
<div class="left" dir="auto"><span class="org">Cisco Systems</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:mcgrew@cisco.com">mcgrew@cisco.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Dan Wing</span></div>
<div class="left" dir="auto"><span class="org">Citrix Systems, Inc.</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:dwing-ietf@fuggles.com">dwing-ietf@fuggles.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Flemming Andreasen</span></div>
<div class="left" dir="auto"><span class="org">Cisco Systems</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:fandreas@cisco.com">fandreas@cisco.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>