<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 9098: Operational Implications of IPv6 Packets with Extension Headers</title>
<meta content="Fernando Gont" name="author"/>
<meta content="Nick Hilliard" name="author"/>
<meta content="Gert Doering" name="author"/>
<meta content="Warren Kumari" name="author"/>
<meta content="Geoff Huston" name="author"/>
<meta content="Will (Shucheng) Liu" name="author"/>
<meta content="
       
This document summarizes the operational implications of IPv6 extension headers specified in the IPv6 protocol specification (RFC 8200) and attempts to analyze reasons why packets with IPv6 extension headers are often dropped in the public Internet.
 
    " name="description"/>
<meta content="xml2rfc 3.9.1" name="generator"/>
<meta content="9098" name="rfc.number"/>
<!-- Generator version information:
  xml2rfc 3.9.1
    Python 3.6.10
    appdirs 1.4.4
    ConfigArgParse 1.2.3
    google-i18n-address 2.3.5
    html5lib 1.0.1
    intervaltree 3.0.2
    Jinja2 2.11.2
    kitchen 1.2.6
    lxml 4.4.2
    pycairo 1.19.0
    pycountry 19.8.18
    pyflakes 2.1.1
    PyYAML 5.3.1
    requests 2.22.0
    setuptools 40.6.2
    six 1.14.0
    WeasyPrint 51
-->
<link href="rfc9098.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://dx.doi.org/10.17487/rfc9098" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <link href="https://datatracker.ietf.org/doc/draft-ietf-v6ops-ipv6-ehs-packet-drops-08" rel="prev"/>
  </head>
<body>
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9098</td>
<td class="center">IPv6 Extension Headers</td>
<td class="right">September 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Gont, et al.</td>
<td class="center">Informational</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc9098">9098</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Informational</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2021-09">September 2021</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">F. Gont</div>
<div class="org">SI6 Networks</div>
</div>
<div class="author">
      <div class="author-name">N. Hilliard</div>
<div class="org">INEX</div>
</div>
<div class="author">
      <div class="author-name">G. Doering</div>
<div class="org">SpaceNet AG</div>
</div>
<div class="author">
      <div class="author-name">W. Kumari</div>
<div class="org">Google</div>
</div>
<div class="author">
      <div class="author-name">G. Huston</div>
<div class="org">APNIC</div>
</div>
<div class="author">
      <div class="author-name">W. Liu</div>
<div class="org">Huawei Technologies</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9098</h1>
<h1 id="title">Operational Implications of IPv6 Packets with Extension Headers</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">
This document summarizes the operational implications of IPv6 extension headers specified in the IPv6 protocol specification (RFC 8200) and attempts to analyze reasons why packets with IPv6 extension headers are often dropped in the public Internet.<a class="pilcrow" href="#section-abstract-1">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This document is not an Internet Standards Track specification; it is
            published for informational purposes.<a class="pilcrow" href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by the
            Internet Engineering Steering Group (IESG).  Not all documents
            approved by the IESG are candidates for any level of Internet
            Standard; see Section 2 of RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9098">https://www.rfc-editor.org/info/rfc9098</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">▲</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact ulEmpty ulBare toc">
<li class="compact ulEmpty ulBare toc" id="section-toc.1-1.1">
            <p class="keepWithNext" id="section-toc.1-1.1.1"><a class="xref" href="#section-1">1</a>.  <a class="xref" href="#name-introduction">Introduction</a></p>
</li>
          <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.2">
            <p class="keepWithNext" id="section-toc.1-1.2.1"><a class="xref" href="#section-2">2</a>.  <a class="xref" href="#name-terminology">Terminology</a></p>
</li>
          <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.3">
            <p class="keepWithNext" id="section-toc.1-1.3.1"><a class="xref" href="#section-3">3</a>.  <a class="xref" href="#name-disclaimer">Disclaimer</a></p>
</li>
          <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="xref" href="#section-4">4</a>.  <a class="xref" href="#name-background-information">Background Information</a></p>
</li>
          <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="xref" href="#section-5">5</a>.  <a class="xref" href="#name-previous-work-on-ipv6-exten">Previous Work on IPv6 Extension Headers</a></p>
</li>
          <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="xref" href="#section-6">6</a>.  <a class="xref" href="#name-packet-forwarding-engine-co">Packet-Forwarding Engine Constraints</a></p>
<ul class="compact ulEmpty ulBare toc">
<li class="compact ulEmpty ulBare toc" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a class="xref" href="#section-6.1">6.1</a>.  <a class="xref" href="#name-recirculation">Recirculation</a></p>
</li>
            </ul>
</li>
          <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="xref" href="#section-7">7</a>.  <a class="xref" href="#name-requirement-to-process-laye">Requirement to Process Layer 3 / Layer 4 Information in Intermediate Systems</a></p>
<ul class="compact ulEmpty ulBare toc">
<li class="compact ulEmpty ulBare toc" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a class="xref" href="#section-7.1">7.1</a>.  <a class="xref" href="#name-ecmp-and-hash-based-load-sh">ECMP and Hash-Based Load Sharing</a></p>
</li>
              <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a class="xref" href="#section-7.2">7.2</a>.  <a class="xref" href="#name-enforcing-infrastructure-ac">Enforcing Infrastructure ACLs</a></p>
</li>
              <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a class="xref" href="#section-7.3">7.3</a>.  <a class="xref" href="#name-ddos-management-and-custome">DDoS Management and Customer Requests for Filtering</a></p>
</li>
              <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a class="xref" href="#section-7.4">7.4</a>.  <a class="xref" href="#name-network-intrusion-detection">Network Intrusion Detection and Prevention</a></p>
</li>
              <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.7.2.5">
                <p id="section-toc.1-1.7.2.5.1"><a class="xref" href="#section-7.5">7.5</a>.  <a class="xref" href="#name-firewalling">Firewalling</a></p>
</li>
            </ul>
</li>
          <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="xref" href="#section-8">8</a>.  <a class="xref" href="#name-operational-and-security-im">Operational and Security Implications</a></p>
<ul class="compact ulEmpty ulBare toc">
<li class="compact ulEmpty ulBare toc" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a class="xref" href="#section-8.1">8.1</a>.  <a class="xref" href="#name-inability-to-find-layer-4-i">Inability to Find Layer 4 Information</a></p>
</li>
              <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a class="xref" href="#section-8.2">8.2</a>.  <a class="xref" href="#name-route-processor-protection">Route-Processor Protection</a></p>
</li>
              <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a class="xref" href="#section-8.3">8.3</a>.  <a class="xref" href="#name-inability-to-perform-fine-g">Inability to Perform Fine-Grained Filtering</a></p>
</li>
              <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.8.2.4">
                <p id="section-toc.1-1.8.2.4.1"><a class="xref" href="#section-8.4">8.4</a>.  <a class="xref" href="#name-security-concerns-associate">Security Concerns Associated with IPv6 Extension Headers</a></p>
</li>
            </ul>
</li>
          <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="xref" href="#section-9">9</a>.  <a class="xref" href="#name-iana-considerations">IANA Considerations</a></p>
</li>
          <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a class="xref" href="#section-10">10</a>. <a class="xref" href="#name-security-considerations">Security Considerations</a></p>
</li>
          <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a class="xref" href="#section-11">11</a>. <a class="xref" href="#name-references">References</a></p>
<ul class="compact ulEmpty ulBare toc">
<li class="compact ulEmpty ulBare toc" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a class="xref" href="#section-11.1">11.1</a>.  <a class="xref" href="#name-normative-references">Normative References</a></p>
</li>
              <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a class="xref" href="#section-11.2">11.2</a>.  <a class="xref" href="#name-informative-references">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a class="xref" href="#appendix-A"></a><a class="xref" href="#name-acknowledgements">Acknowledgements</a></p>
</li>
          <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a class="xref" href="#appendix-B"></a><a class="xref" href="#name-authors-addresses">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="intro">
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">
IPv6 extension headers (EHs) allow for the extension of the IPv6 protocol and provide support for core functionality such as IPv6 fragmentation. However, common implementation limitations suggest that EHs present a challenge for IPv6 packet routing equipment and middleboxes, and evidence exists that IPv6 packets with EHs are intentionally dropped in the public Internet in some circumstances.<a class="pilcrow" href="#section-1-1">¶</a></p>
<p id="section-1-2">This document has the following goals:<a class="pilcrow" href="#section-1-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-3.1">Raise awareness about the operational and security implications of IPv6 extension headers specified in <span>[<a class="xref" href="#RFC8200">RFC8200</a>]</span> and present reasons why some networks resort to intentionally dropping packets containing IPv6 extension headers.<a class="pilcrow" href="#section-1-3.1">¶</a>
</li>
        <li class="normal" id="section-1-3.2">Highlight areas where current IPv6 support by networking devices may be suboptimal, such that the aforementioned support is improved.<a class="pilcrow" href="#section-1-3.2">¶</a>
</li>
        <li class="normal" id="section-1-3.3">Highlight operational issues associated with IPv6 extension headers, such that those issues are considered in IETF standardization efforts.<a class="pilcrow" href="#section-1-3.3">¶</a>
</li>
      </ul>
<p id="section-1-4">
<a class="xref" href="#background">Section 4</a> of this document provides background information about the IPv6 packet structure and associated implications. <a class="xref" href="#previous-work">Section 5</a> summarizes previous work that has been carried out in the area of IPv6 extension headers. <a class="xref" href="#pfe-constraints">Section 6</a> discusses packet-forwarding engine constraints in contemporary routers. <a class="xref" href="#inability">Section 7</a> discusses why intermediate systems may need to access Layer 4 information to make a forwarding decision. Finally, <a class="xref" href="#operational-implications">Section 8</a> discusses operational implications of IPv6 EHs.<a class="pilcrow" href="#section-1-4">¶</a></p>
</section>
</div>
<section id="section-2">
      <h2 id="name-terminology">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-terminology">Terminology</a>
      </h2>
<p id="section-2-1">
This document uses the term "intermediate system" to describe both routers and middleboxes when there is no need to distinguish between the two and where the important issue is that the device being discussed forwards packets.<a class="pilcrow" href="#section-2-1">¶</a></p>
</section>
<div id="disclaimer">
<section id="section-3">
      <h2 id="name-disclaimer">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-disclaimer">Disclaimer</a>
      </h2>
<p id="section-3-1">This document analyzes the operational challenges represented by packets that employ IPv6 extension headers and documents some of the operational reasons why these packets are often dropped in the public Internet. This document is not a recommendation to drop such packets, but rather an analysis of why they are currently dropped.<a class="pilcrow" href="#section-3-1">¶</a></p>
</section>
</div>
<div id="background">
<section id="section-4">
      <h2 id="name-background-information">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-background-information">Background Information</a>
      </h2>
<p id="section-4-1">
It is useful to compare the basic structure of IPv6 packets against that of IPv4 packets and analyze the implications of the two different packet structures.<a class="pilcrow" href="#section-4-1">¶</a></p>
<p id="section-4-2">
    IPv4 packets have a variable-length header size that allows for the
    use of IPv4 "options" -- optional information that may be of use to
    nodes processing IPv4 packets.  The IPv4 header length is specified
    in the "Internet Header Length" (IHL) field of the mandatory IPv4 header and must be in
    the range of 20 octets (the minimum IPv4 header size) to 60 octets, accommodating at most 40 octets of options. The upper-layer protocol type is specified via the "Protocol" field of the mandatory IPv4 header.<a class="pilcrow" href="#section-4-2">¶</a></p>
<span id="name-ipv4-packet-structure"></span><div id="ipv4-packet">
<figure id="figure-1">
        <div class="artwork art-text alignLeft" id="section-4-3.1">
<pre>               Protocol, IHL
                    +--------+
                    |        |
                    |        v
               +------//-----+------------------------+
               |             |                        |
               |    IPv4     |       Upper-Layer      |
               |    Header   |       Protocol         |
               |             |                        |
               +-----//------+------------------------+

               variable length
               &lt;-------------&gt;
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-1">Figure 1</a>:
<a class="selfRef" href="#name-ipv4-packet-structure">IPv4 Packet Structure</a>
        </figcaption></figure>
</div>
<p id="section-4-4">
IPv6 took a different approach to the IPv6 packet structure. Rather than employing a variable-length header as IPv4 does, IPv6 employs a packet structure similar to a linked list, where a mandatory fixed-length IPv6 header is followed by an arbitrary number of optional extension headers, with the upper-layer header being the last header in the IPv6 header chain. Each extension header typically specifies its length (unless it is implicit from the extension header type) and the "next header" (NH) type that follows in the IPv6 header chain.<a class="pilcrow" href="#section-4-4">¶</a></p>
<span id="name-ipv6-packet-structure"></span><div id="ipv6-packet">
<figure id="figure-2">
        <div class="artwork art-text alignLeft" id="section-4-5.1">
<pre>       NH          NH, EH-length      NH, EH-length
        +-------+      +------+            +-------+
        |       |      |      |            |       |
        |       v      |      v            |       v
  +-------------+-------------+-//-+---------------+--------------+
  |             |             |    |               |              |
  |    IPv6     |    Ext.     |    |     Ext.      |  Upper-Layer |
  |    header   |    Header   |    |     Header    |  Protocol    |
  |             |             |    |               |              |
  +-------------+-------------+-//-+---------------+--------------+

   fixed length    variable number of EHs &amp; length
  &lt;------------&gt; &lt;--------------------------------&gt;
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-2">Figure 2</a>:
<a class="selfRef" href="#name-ipv6-packet-structure">IPv6 Packet Structure</a>
        </figcaption></figure>
</div>
<p id="section-4-6">This packet structure has the following implications:<a class="pilcrow" href="#section-4-6">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-7.1">
          <span>[<a class="xref" href="#RFC8200">RFC8200</a>]</span> requires the entire IPv6 header chain to be contained in the first fragment of a packet, therefore limiting the IPv6 header chain to the size of the path MTU.<a class="pilcrow" href="#section-4-7.1">¶</a>
</li>
        <li class="normal" id="section-4-7.2">Other than the path MTU constraints, there are no other limits to the number of IPv6 EHs that may be present in a packet. Therefore, there is no upper limit regarding how deep into the IPv6 packet the upper-layer protocol header may be found.<a class="pilcrow" href="#section-4-7.2">¶</a>
</li>
        <li class="normal" id="section-4-7.3">The only way for a node to obtain the upper-layer protocol
       type or find the upper-layer protocol header is to parse and
       process the entire IPv6 header chain, in sequence, starting from
       the mandatory IPv6 header until the last header in the IPv6
       header chain is found.<a class="pilcrow" href="#section-4-7.3">¶</a>
</li>
      </ul>
</section>
</div>
<div id="previous-work">
<section id="section-5">
      <h2 id="name-previous-work-on-ipv6-exten">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-previous-work-on-ipv6-exten">Previous Work on IPv6 Extension Headers</a>
      </h2>
<p id="section-5-1">Some of the operational and security implications of IPv6 extension headers have been discussed in the IETF:<a class="pilcrow" href="#section-5-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-2.1">
          <span>[<a class="xref" href="#I-D.taylor-v6ops-fragdrop">OPERATORS</a>]</span> discusses a rationale for which operators drop IPv6 fragments.<a class="pilcrow" href="#section-5-2.1">¶</a>
</li>
        <li class="normal" id="section-5-2.2">
          <span>[<a class="xref" href="#I-D.wkumari-long-headers">HEADERS</a>]</span> discusses possible issues arising from "long" IPv6 header chains.<a class="pilcrow" href="#section-5-2.2">¶</a>
</li>
        <li class="normal" id="section-5-2.3">
          <span>[<a class="xref" href="#I-D.kampanakis-6man-ipv6-eh-parsing">PARSING</a>]</span> describes how inconsistencies in the way IPv6 packets with extension headers are parsed by different implementations could result in evasion of security controls and presents guidelines for parsing IPv6 extension headers, with the goal of providing a common and consistent parsing methodology for IPv6 implementations.<a class="pilcrow" href="#section-5-2.3">¶</a>
</li>
        <li class="normal" id="section-5-2.4">
          <span>[<a class="xref" href="#I-D.ietf-opsec-ipv6-eh-filtering">IPV6-EH</a>]</span> analyzes the security implications of IPv6 EHs, as well as the operational implications of dropping packets that employ IPv6 EHs and associated options.<a class="pilcrow" href="#section-5-2.4">¶</a>
</li>
        <li class="normal" id="section-5-2.5">
          <span>[<a class="xref" href="#RFC7113">RFC7113</a>]</span> discusses how some popular Router Advertisement Guard (RA-Guard) implementations are subject to evasion by means of IPv6 extension headers.<a class="pilcrow" href="#section-5-2.5">¶</a>
</li>
        <li class="normal" id="section-5-2.6">
          <span>[<a class="xref" href="#RFC8900">RFC8900</a>]</span> analyzes the fragility introduced by IP fragmentation.<a class="pilcrow" href="#section-5-2.6">¶</a>
</li>
      </ul>
<p id="section-5-3">A number of recent RFCs have discussed issues related to IPv6 extension headers and have specified updates to RFC 2460 <span>[<a class="xref" href="#RFC2460">RFC2460</a>]</span> (an earlier version of the IPv6 standard). Many of these updates have now been incorporated into the current IPv6 core standard <span>[<a class="xref" href="#RFC8200">RFC8200</a>]</span> or the IPv6 node requirements <span>[<a class="xref" href="#RFC8504">RFC8504</a>]</span>. Namely,<a class="pilcrow" href="#section-5-3">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-4.1">
          <span>[<a class="xref" href="#RFC5095">RFC5095</a>]</span> discusses the security implications of Routing Header Type 0 (RHT0) and deprecates it.<a class="pilcrow" href="#section-5-4.1">¶</a>
</li>
        <li class="normal" id="section-5-4.2">
          <span>[<a class="xref" href="#RFC5722">RFC5722</a>]</span> analyzes the security implications of overlapping fragments and provides recommendations in this area.<a class="pilcrow" href="#section-5-4.2">¶</a>
</li>
        <li class="normal" id="section-5-4.3">
          <span>[<a class="xref" href="#RFC7045">RFC7045</a>]</span> clarifies how intermediate nodes should deal with IPv6 extension headers.<a class="pilcrow" href="#section-5-4.3">¶</a>
</li>
        <li class="normal" id="section-5-4.4">
          <span>[<a class="xref" href="#RFC7112">RFC7112</a>]</span> discusses the issues arising in a specific fragmentation case where the IPv6 header chain is fragmented into two or more fragments and formally forbids such fragmentation.<a class="pilcrow" href="#section-5-4.4">¶</a>
</li>
        <li class="normal" id="section-5-4.5">
          <span>[<a class="xref" href="#RFC6946">RFC6946</a>]</span> discusses a flawed (but common) processing of the so-called IPv6 "atomic fragments" and specifies improved processing of such packets.<a class="pilcrow" href="#section-5-4.5">¶</a>
</li>
        <li class="normal" id="section-5-4.6">
          <span>[<a class="xref" href="#RFC8021">RFC8021</a>]</span> deprecates the generation of IPv6 atomic fragments.<a class="pilcrow" href="#section-5-4.6">¶</a>
</li>
        <li class="normal" id="section-5-4.7">
          <span>[<a class="xref" href="#RFC8504">RFC8504</a>]</span> clarifies processing rules for packets with extension headers and also allows hosts to enforce limits on the number of options included in IPv6 EHs.<a class="pilcrow" href="#section-5-4.7">¶</a>
</li>
        <li class="normal" id="section-5-4.8">
          <span>[<a class="xref" href="#RFC7739">RFC7739</a>]</span> discusses the security implications of predictable fragment Identification values and provides recommendations for the generation of these values.<a class="pilcrow" href="#section-5-4.8">¶</a>
</li>
        <li class="normal" id="section-5-4.9">
          <span>[<a class="xref" href="#RFC6980">RFC6980</a>]</span> analyzes the security implications of employing IPv6 fragmentation with Neighbor Discovery for IPv6 and formally recommends against such usage.<a class="pilcrow" href="#section-5-4.9">¶</a>
</li>
      </ul>
<p id="section-5-5">Additionally, <span>[<a class="xref" href="#RFC8200">RFC8200</a>]</span> has relaxed the requirement that "all nodes must examine and process the Hop-by-Hop Options header" from <span>[<a class="xref" href="#RFC2460">RFC2460</a>]</span>, by specifying that only nodes that have been explicitly configured to process the Hop-by-Hop Options header are required to do so.<a class="pilcrow" href="#section-5-5">¶</a></p>
<p id="section-5-6">A number of studies have measured the extent to which packets employing IPv6 extension headers are dropped in the public Internet:<a class="pilcrow" href="#section-5-6">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-7.1">
          <span>[<a class="xref" href="#PMTUD-Blackholes">PMTUD-Blackholes</a>]</span> and <span>[<a class="xref" href="#Linkova-Gont-IEPG90">Linkova-Gont-IEPG90</a>]</span> present some preliminary measurements regarding the extent to which packets containing IPv6 EHs are dropped in the public Internet.<a class="pilcrow" href="#section-5-7.1">¶</a>
</li>
        <li class="normal" id="section-5-7.2">
          <span>[<a class="xref" href="#RFC7872">RFC7872</a>]</span> presents more comprehensive results and documents the methodology used to obtain these results.<a class="pilcrow" href="#section-5-7.2">¶</a>
</li>
        <li class="normal" id="section-5-7.3">
          <span>[<a class="xref" href="#Huston-2017">Huston-2017</a>]</span> and <span>[<a class="xref" href="#Huston-2020">Huston-2020</a>]</span> measure packet drops resulting from IPv6 fragmentation when communicating with DNS servers.<a class="pilcrow" href="#section-5-7.3">¶</a>
</li>
      </ul>
</section>
</div>
<div id="pfe-constraints">
<section id="section-6">
      <h2 id="name-packet-forwarding-engine-co">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-packet-forwarding-engine-co">Packet-Forwarding Engine Constraints</a>
      </h2>
<p id="section-6-1">

Most contemporary carrier-grade routers use dedicated hardware, e.g., Application-Specific
Integrated Circuits (ASICs) or Network Processing Units (NPUs), to determine how to forward
packets across their internal fabrics (see <span>[<a class="xref" href="#IEPG94-Scudder">IEPG94-Scudder</a>]</span> and <span>[<a class="xref" href="#APNIC-Scudder">APNIC-Scudder</a>]</span> for details).  One common method of handling next-hop lookups is to send a small portion of the
ingress packet to a lookup engine with specialized hardware, e.g., ternary
content-addressable memory (TCAM) or reduced latency dynamic random-access memory
(RLDRAM), to determine the packet's next hop.  Technical constraints
mean that there is a trade-off between the amount of data sent to the lookup
engine and the overall packet-forwarding rate of the lookup engine.  If more data is
sent, the lookup engine can inspect further into the packet, but the overall
packet-forwarding rate of the system will be reduced.  If less data is sent, the
overall packet-forwarding rate of the router will be increased, but the packet lookup
engine may not be able to inspect far enough into a packet to determine how
it should be handled.<a class="pilcrow" href="#section-6-1">¶</a></p>
<aside id="section-6-2">
        <p id="section-6-2.1">NOTE:<a class="pilcrow" href="#section-6-2.1">¶</a></p>
<p id="section-6-2.2" style="margin-left: 1.5em">
For example, some contemporary high-end routers are known to inspect up to 192 bytes, while others are known to parse up to 384 bytes of header.<a class="pilcrow" href="#section-6-2.2">¶</a></p>
</aside>
<p id="section-6-3">If a hardware-forwarding engine on a contemporary router cannot make a
forwarding decision about a packet because critical information is not sent
to the lookup engine, then the router will normally drop the packet. <a class="xref" href="#inability">Section 7</a> discusses some of the reasons for which a contemporary router might need to access Layer 4 information to make a forwarding decision.<a class="pilcrow" href="#section-6-3">¶</a></p>
<p id="section-6-4">
Historically, some packet-forwarding engines punted packets of this kind to
the control plane for more in-depth analysis, but this is unfeasible on most
contemporary router architectures as a result of the vast difference between the hardware-based forwarding
capacity of the router and the processing capacity of the control plane and the size of the management link that connects the control plane to the forwarding plane.  Other platforms may have a separate software-based forwarding plane that is
   distinct both from the hardware-based forwarding plane and the control
   plane. However, the limited CPU resources of this software-based
   forwarding plane, as well as the limited bandwidth of the associated
   link, results in similar throughput constraints.<a class="pilcrow" href="#section-6-4">¶</a></p>
<p id="section-6-5">

   If an IPv6 header chain is sufficiently long such that it exceeds the
   packet lookup capacity of the router, the router might be unable to
   determine how the packet should be handled and thus could resort to
   dropping the packet.<a class="pilcrow" href="#section-6-5">¶</a></p>
<div id="recirculation">
<section id="section-6.1">
        <h3 id="name-recirculation">
<a class="section-number selfRef" href="#section-6.1">6.1. </a><a class="section-name selfRef" href="#name-recirculation">Recirculation</a>
        </h3>
<p id="section-6.1-1">

Although type-length-value (TLV) chains are amenable to iterative processing on architectures
that have packet lookup engines with deep inspection capabilities, some
packet-forwarding engines manage IPv6 header chains using
recirculation.  This approach processes extension headers one at a time:
when processing on one extension header is completed, the packet is looped
back through the processing engine again.  This recirculation process
continues repeatedly until there are no more extension headers left to be
processed.<a class="pilcrow" href="#section-6.1-1">¶</a></p>
<p id="section-6.1-2">

Recirculation is typically used on packet-forwarding engines with limited
lookup capability, because it allows arbitrarily long header chains to be
processed without the complexity and cost associated with packet-forwarding
engines, which have deep lookup capabilities.  However, recirculation can
impact the forwarding capacity of hardware, as each packet will pass through
the processing engine multiple times.  Depending on configuration, the type
of packets being processed, and the hardware capabilities of the packet-forwarding
engine, the data-plane throughput performance on the
router might be negatively affected.<a class="pilcrow" href="#section-6.1-2">¶</a></p>
</section>
</div>
</section>
</div>
<div id="inability">
<section id="section-7">
      <h2 id="name-requirement-to-process-laye">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-requirement-to-process-laye">Requirement to Process Layer 3 / Layer 4 Information in Intermediate Systems</a>
      </h2>
<p id="section-7-1">The following subsections discuss some of the reasons for which intermediate systems may need to process Layer 3 / Layer 4 information to make a forwarding decision.<a class="pilcrow" href="#section-7-1">¶</a></p>
<div id="ecmp-load-balancing">
<section id="section-7.1">
        <h3 id="name-ecmp-and-hash-based-load-sh">
<a class="section-number selfRef" href="#section-7.1">7.1. </a><a class="section-name selfRef" href="#name-ecmp-and-hash-based-load-sh">ECMP and Hash-Based Load Sharing</a>
        </h3>
<p id="section-7.1-1">In the case of Equal Cost Multipath (ECMP) load sharing, the intermediate system
needs to make a decision regarding which of its interfaces to
use to forward a given packet.  Since round-robin usage of the links is usually
avoided to prevent packet reordering, forwarding engines need to
use a mechanism that will consistently forward the same data streams down
the same forwarding paths.  Most forwarding engines achieve this by
calculating a simple hash using an n-tuple gleaned from a combination of
Layer 2 through to Layer 4 protocol header information.  This n-tuple will
typically use the src/dst Media Access Control (MAC) addresses, src/dst IP addresses, and, if possible,
further Layer 4 src/dst port information.<a class="pilcrow" href="#section-7.1-1">¶</a></p>
<p id="section-7.1-2">In the IPv6 world, flows are expected to be identified by means of the IPv6 "Flow Label" <span>[<a class="xref" href="#RFC6437">RFC6437</a>]</span>. Thus, ECMP and hash-based load sharing should be possible without the need to process the entire IPv6 header chain to obtain upper-layer information to identify flows. <span>[<a class="xref" href="#RFC7098">RFC7098</a>]</span> discusses how the IPv6 Flow Label can be used to enhance Layer 3/4 load distribution and balancing for large server farms.<a class="pilcrow" href="#section-7.1-2">¶</a></p>
<p id="section-7.1-3">Historically, many IPv6 implementations failed to set the Flow Label, and hash-based ECMP/load-sharing devices also did not employ the Flow Label for performing their task. While support of <span>[<a class="xref" href="#RFC6437">RFC6437</a>]</span> is currently widespread for current versions of all popular host implementations, there is still only marginal usage of the IPv6 Flow Label for ECMP and load balancing <span>[<a class="xref" href="#Almeida-2020">Almeida-2020</a>]</span>. A contributing factor could be the issues that have been found in host implementations and middleboxes <span>[<a class="xref" href="#Jaeggli-2018">Jaeggli-2018</a>]</span>.<a class="pilcrow" href="#section-7.1-3">¶</a></p>
<p id="section-7.1-4">
Clearly, widespread support of <span>[<a class="xref" href="#RFC6437">RFC6437</a>]</span> would relieve intermediate systems from having to process the entire IPv6 header chain, making Flow Label-based ECMP and load sharing <span>[<a class="xref" href="#RFC6438">RFC6438</a>]</span> feasible.<a class="pilcrow" href="#section-7.1-4">¶</a></p>
<p id="section-7.1-5">
If an intermediate system cannot determine consistent n-tuples for calculating flow hashes, data streams are more likely to end up being distributed unequally across ECMP and load-shared links.  This may lead to packet drops or reduced performance.<a class="pilcrow" href="#section-7.1-5">¶</a></p>
</section>
</div>
<div id="enforcing-infrastructure-acls">
<section id="section-7.2">
        <h3 id="name-enforcing-infrastructure-ac">
<a class="section-number selfRef" href="#section-7.2">7.2. </a><a class="section-name selfRef" href="#name-enforcing-infrastructure-ac">Enforcing Infrastructure ACLs</a>
        </h3>
<p id="section-7.2-1">Infrastructure Access Control Lists (iACLs) drop unwanted packets destined
to a network's infrastructure.  Typically, iACLs are deployed because external direct access to a network's infrastructure addresses is operationally unnecessary and can be used for attacks of different sorts against router
control planes.  To this end, traffic usually needs to be differentiated on the basis of Layer 3
or Layer 4 criteria to achieve a useful balance of protection and functionality.  For example, an infrastructure may be configured with the following policy:<a class="pilcrow" href="#section-7.2-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.2-2.1">Permit some amount of ICMP echo (ping) traffic towards a router's
 addresses for troubleshooting.<a class="pilcrow" href="#section-7.2-2.1">¶</a>
</li>
          <li class="normal" id="section-7.2-2.2">Permit BGP sessions on the shared network of an exchange point (potentially differentiating between the amount of packets/second permitted for established sessions and for connection establishment), but do not permit other traffic from the same peer IP addresses.<a class="pilcrow" href="#section-7.2-2.2">¶</a>
</li>
        </ul>
<p id="section-7.2-3">
If a forwarding router cannot determine consistent n-tuples for calculating flow hashes, data streams are more likely to end up being distributed unequally across ECMP and load-shared links.  This may lead to packet drops or reduced performance.<a class="pilcrow" href="#section-7.2-3">¶</a></p>
<p id="section-7.2-4">
If a network cannot deploy infrastructure ACLs, then the security of the network may be compromised as a result of the increased attack surface.<a class="pilcrow" href="#section-7.2-4">¶</a></p>
</section>
</div>
<div id="ddos-management">
<section id="section-7.3">
        <h3 id="name-ddos-management-and-custome">
<a class="section-number selfRef" href="#section-7.3">7.3. </a><a class="section-name selfRef" href="#name-ddos-management-and-custome">DDoS Management and Customer Requests for Filtering</a>
        </h3>
<p id="section-7.3-1">The case of customer Distributed Denial-of-Service (DDoS) protection and edge-to-core customer protection
filters is similar in nature to the iACL protection.  Similar
to iACL protection, Layer 4 ACLs generally need to be applied as close to the
edge of the network as possible, even though the intent is usually to protect the
customer edge rather than the provider core.  Application of Layer 4 DDoS protection
to a network edge is often automated using BGP Flowspec <span>[<a class="xref" href="#RFC8955">RFC8955</a>]</span> <span>[<a class="xref" href="#RFC8956">RFC8956</a>]</span>.<a class="pilcrow" href="#section-7.3-1">¶</a></p>
<p id="section-7.3-2">For example, a website that normally only handles traffic on TCP ports
80 and 443 could be subject to a volumetric DDoS attack using NTP and DNS
packets with a randomized source IP address, thereby rendering
source-based remote triggered black hole <span>[<a class="xref" href="#RFC5635">RFC5635</a>]</span>
mechanisms useless.  In this situation, ACLs that provide DDoS protection could be configured to
block all UDP traffic at the network edge without impairing the web server
functionality in any way.  Thus, being able to block arbitrary
protocols at the network edge can avoid DDoS-related problems both in the provider
network and on the customer edge link.<a class="pilcrow" href="#section-7.3-2">¶</a></p>
</section>
</div>
<div id="nids">
<section id="section-7.4">
        <h3 id="name-network-intrusion-detection">
<a class="section-number selfRef" href="#section-7.4">7.4. </a><a class="section-name selfRef" href="#name-network-intrusion-detection">Network Intrusion Detection and Prevention</a>
        </h3>
<p id="section-7.4-1">Network Intrusion Detection Systems (NIDS) examine network traffic and try to identify traffic patterns that can be correlated to network-based attacks. These systems generally attempt to inspect application-layer traffic (if possible) but, at the bare minimum, inspect Layer 4 flows. When attack activity is inferred, the operator is notified of the potential intrusion attempt.<a class="pilcrow" href="#section-7.4-1">¶</a></p>
<p id="section-7.4-2">Network Intrusion Prevention Systems (IPS) operate similarly to NIDSs, but they can also prevent intrusions by reacting to detected attack attempts by e.g., triggering packet filtering policies at firewalls and other devices.<a class="pilcrow" href="#section-7.4-2">¶</a></p>
<p id="section-7.4-3">Use of extension headers can be problematic for NIDS/IPS, since:<a class="pilcrow" href="#section-7.4-3">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.4-4.1">Extension headers increase the complexity of resulting traffic and the associated work and system requirements to process it.<a class="pilcrow" href="#section-7.4-4.1">¶</a>
</li>
          <li class="normal" id="section-7.4-4.2">Use of unknown extension headers can prevent a NIDS or IPS from processing Layer 4 information.<a class="pilcrow" href="#section-7.4-4.2">¶</a>
</li>
          <li class="normal" id="section-7.4-4.3">Use of IPv6 fragmentation requires a stateful fragment-reassembly operation, even for decoy traffic employing forged source addresses (see, e.g., <span>[<a class="xref" href="#nmap">nmap</a>]</span>).<a class="pilcrow" href="#section-7.4-4.3">¶</a>
</li>
        </ul>
<p id="section-7.4-5">As a result, in order to increase the efficiency or effectiveness of these systems, packets employing IPv6 extension headers are often dropped at the network ingress point(s) of networks that deploy these systems.<a class="pilcrow" href="#section-7.4-5">¶</a></p>
</section>
</div>
<div id="firewalls">
<section id="section-7.5">
        <h3 id="name-firewalling">
<a class="section-number selfRef" href="#section-7.5">7.5. </a><a class="section-name selfRef" href="#name-firewalling">Firewalling</a>
        </h3>
<p id="section-7.5-1">Firewalls enforce security policies by means of packet filtering. These systems usually inspect Layer 3 and Layer 4 traffic but can often also examine application-layer traffic flows.<a class="pilcrow" href="#section-7.5-1">¶</a></p>
<p id="section-7.5-2">As with a NIDS or IPS (<a class="xref" href="#nids">Section 7.4</a>), use of IPv6 extension headers can represent a challenge to network firewalls, since:<a class="pilcrow" href="#section-7.5-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.5-3.1">Extension headers increase the complexity of resulting traffic and the associated work and system requirements to process it, as outlined in <span>[<a class="xref" href="#Zack-FW-Benchmark">Zack-FW-Benchmark</a>]</span>.<a class="pilcrow" href="#section-7.5-3.1">¶</a>
</li>
          <li class="normal" id="section-7.5-3.2">Use of unknown extension headers can prevent firewalls from processing Layer 4 information.<a class="pilcrow" href="#section-7.5-3.2">¶</a>
</li>
          <li class="normal" id="section-7.5-3.3">Use of IPv6 fragmentation requires a stateful fragment-reassembly operation, even for decoy traffic employing forged source addresses (see, e.g., <span>[<a class="xref" href="#nmap">nmap</a>]</span>).<a class="pilcrow" href="#section-7.5-3.3">¶</a>
</li>
        </ul>
<p id="section-7.5-4">Additionally, a common firewall filtering policy is the so-called "default deny", where all traffic is blocked (by default), and only expected traffic is added to an "allow/accept list".<a class="pilcrow" href="#section-7.5-4">¶</a></p>
<p id="section-7.5-5">As a result, packets employing IPv6 extension headers are often
dropped by network firewalls, either because of the challenges
represented by extension headers or because the use of IPv6 extension
headers has not been explicitly allowed.<a class="pilcrow" href="#section-7.5-5">¶</a></p>
<p id="section-7.5-6">Note that although the data presented in <span>[<a class="xref" href="#Zack-FW-Benchmark">Zack-FW-Benchmark</a>]</span> was several years old at the time of publication of this document, many contemporary firewalls use comparable hardware and software architectures; consequently, the conclusions of this benchmark are still relevant, despite its age.<a class="pilcrow" href="#section-7.5-6">¶</a></p>
</section>
</div>
</section>
</div>
<div id="operational-implications">
<section id="section-8">
      <h2 id="name-operational-and-security-im">
<a class="section-number selfRef" href="#section-8">8. </a><a class="section-name selfRef" href="#name-operational-and-security-im">Operational and Security Implications</a>
      </h2>
<div id="inability-layer-4-info">
<section id="section-8.1">
        <h3 id="name-inability-to-find-layer-4-i">
<a class="section-number selfRef" href="#section-8.1">8.1. </a><a class="section-name selfRef" href="#name-inability-to-find-layer-4-i">Inability to Find Layer 4 Information</a>
        </h3>
<p id="section-8.1-1">As discussed in <a class="xref" href="#inability">Section 7</a>, intermediate systems that need to find the Layer 4 header must process the entire IPv6 header chain.  When such devices are unable to obtain the required information, the forwarding device has the option to drop the packet unconditionally, forward the packet unconditionally, or process the packet outside the normal forwarding path.  Forwarding packets unconditionally will usually allow for the circumvention of security controls (see, e.g., <a class="xref" href="#firewalls">Section 7.5</a>), while processing packets outside of the normal forwarding path will usually open the door to Denial-of-Service (DoS) attacks (see, e.g., <a class="xref" href="#pfe-constraints">Section 6</a>). Thus, in these scenarios, devices often simply resort to dropping such packets unconditionally.<a class="pilcrow" href="#section-8.1-1">¶</a></p>
</section>
</div>
<div id="route-processor-protection">
<section id="section-8.2">
        <h3 id="name-route-processor-protection">
<a class="section-number selfRef" href="#section-8.2">8.2. </a><a class="section-name selfRef" href="#name-route-processor-protection">Route-Processor Protection</a>
        </h3>
<p id="section-8.2-1">Most contemporary carrier-grade routers have a fast hardware-assisted forwarding plane
and a loosely coupled control plane, connected together with a link that
has much less capacity than the forwarding plane could handle.  Traffic
differentiation cannot be performed by the control plane because this would
overload the internal link connecting the forwarding plane to the control
plane.<a class="pilcrow" href="#section-8.2-1">¶</a></p>
<p id="section-8.2-2">The Hop-by-Hop Options header has been particularly challenging since, in most circumstances, the corresponding packet is punted to the control plane for processing. As a result, many operators drop IPv6 packets containing this extension header <span>[<a class="xref" href="#RFC7872">RFC7872</a>]</span>. <span>[<a class="xref" href="#RFC6192">RFC6192</a>]</span> provides advice regarding protection of a router's control plane.<a class="pilcrow" href="#section-8.2-2">¶</a></p>
</section>
</div>
<div id="finer-grained">
<section id="section-8.3">
        <h3 id="name-inability-to-perform-fine-g">
<a class="section-number selfRef" href="#section-8.3">8.3. </a><a class="section-name selfRef" href="#name-inability-to-perform-fine-g">Inability to Perform Fine-Grained Filtering</a>
        </h3>
<p id="section-8.3-1">Some intermediate systems do not have support for fine-grained filtering of IPv6 extension headers. For example, an operator that wishes to drop packets containing RHT0 may only be able to filter on the extension header type (Routing Header). This could result in an operator enforcing a coarser filtering policy (e.g., "drop all packets containing a Routing Header" vs. "only drop packets that contain a Routing Header Type 0").<a class="pilcrow" href="#section-8.3-1">¶</a></p>
</section>
</div>
<div id="security-implications">
<section id="section-8.4">
        <h3 id="name-security-concerns-associate">
<a class="section-number selfRef" href="#section-8.4">8.4. </a><a class="section-name selfRef" href="#name-security-concerns-associate">Security Concerns Associated with IPv6 Extension Headers</a>
        </h3>
<p id="section-8.4-1">The security implications of IPv6 extension headers generally fall into one or more of these categories:<a class="pilcrow" href="#section-8.4-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.4-2.1">Evasion of security controls<a class="pilcrow" href="#section-8.4-2.1">¶</a>
</li>
          <li class="normal" id="section-8.4-2.2">DoS due to processing requirements<a class="pilcrow" href="#section-8.4-2.2">¶</a>
</li>
          <li class="normal" id="section-8.4-2.3">DoS due to implementation errors<a class="pilcrow" href="#section-8.4-2.3">¶</a>
</li>
          <li class="normal" id="section-8.4-2.4">Issues specific to the extension header type<a class="pilcrow" href="#section-8.4-2.4">¶</a>
</li>
        </ul>
<p id="section-8.4-3">Unlike IPv4 packets where the upper-layer protocol can be trivially found by means of the IHL field of the IPv4 header, the structure of IPv6 packets is more flexible and complex.  This can represent a challenge for devices that need to find this information, since locating upper-layer protocol information requires that all IPv6 extension headers be examined. In turn, this presents implementation difficulties, since some packet-filtering mechanisms that require upper-layer information (even if just the upper-layer protocol type) can be trivially circumvented by inserting IPv6 extension headers between the main IPv6 header and the upper-layer protocol header. <span>[<a class="xref" href="#RFC7113">RFC7113</a>]</span> describes this issue for the RA-Guard case, but the same techniques could be employed to circumvent other IPv6 firewall and packet-filtering mechanisms.  Additionally, implementation inconsistencies in packet-forwarding engines can result in evasion of security controls <span>[<a class="xref" href="#I-D.kampanakis-6man-ipv6-eh-parsing">PARSING</a>]</span> <span>[<a class="xref" href="#Atlasis2014">Atlasis2014</a>]</span> <span>[<a class="xref" href="#BH-EU-2014">BH-EU-2014</a>]</span>.<a class="pilcrow" href="#section-8.4-3">¶</a></p>
<p id="section-8.4-4">Sometimes, packets with IPv6 extension headers can impact throughput performance on intermediate systems. Unless appropriate mitigations are put in place (e.g., packet dropping and/or rate limiting), an attacker could simply send a large amount of IPv6 traffic employing IPv6 extension headers with the purpose of performing a DoS attack (see Sections <a class="xref" href="#recirculation">6.1</a> and <a class="xref" href="#operational-implications">8</a> for further details). The extent to which performance is affected on these devices is implementation dependent.<a class="pilcrow" href="#section-8.4-4">¶</a></p>
<aside id="section-8.4-5">
          <p id="section-8.4-5.1">NOTE:<a class="pilcrow" href="#section-8.4-5.1">¶</a></p>
<p id="section-8.4-5.2" style="margin-left: 1.5em">
In the most trivial case, a packet that includes a Hop-by-Hop Options header might go through the slow forwarding path, to be processed by the router's CPU. Alternatively, a router configured to enforce an ACL based on upper-layer information (e.g., upper-layer protocol type or TCP Destination Port) may need to process the entire IPv6 header chain in order to find the required information, thereby causing the packet to be processed in the slow path <span>[<a class="xref" href="#Cisco-EH-Cons">Cisco-EH-Cons</a>]</span>. We note that, for obvious reasons, the aforementioned performance issues can affect devices such as firewalls, NIDSs, etc. <span>[<a class="xref" href="#Zack-FW-Benchmark">Zack-FW-Benchmark</a>]</span>.<a class="pilcrow" href="#section-8.4-5.2">¶</a></p>
</aside>
<p id="section-8.4-6">IPv6 implementations, like all other software, tend to mature with time and wide-scale deployment. While the IPv6 protocol itself has existed for over 20 years, serious bugs related to IPv6 extension header processing continue to be discovered (see, e.g., <span>[<a class="xref" href="#Cisco-Frag">Cisco-Frag</a>]</span>, <span>[<a class="xref" href="#Microsoft-SA">Microsoft-SA</a>]</span>, and <span>[<a class="xref" href="#FreeBSD-SA">FreeBSD-SA</a>]</span>).  Because there is currently little operational reliance on IPv6 extension headers, the corresponding code paths are rarely exercised, and there is the potential for bugs that still remain to be discovered in some implementations.<a class="pilcrow" href="#section-8.4-6">¶</a></p>
<p id="section-8.4-7">The IPv6 Fragment Header is employed for the fragmentation and reassembly of IPv6 packets. While many of the security implications of the fragmentation/reassembly mechanism are known from the IPv4 world, several related issues have crept into IPv6 implementations. These range from DoS attacks to information leakages, as discussed in <span>[<a class="xref" href="#RFC7739">RFC7739</a>]</span>, <span>[<a class="xref" href="#Bonica-NANOG58">Bonica-NANOG58</a>]</span>, and <span>[<a class="xref" href="#Atlasis2012">Atlasis2012</a>]</span>.<a class="pilcrow" href="#section-8.4-7">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-cons">
<section id="section-9">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-9">9. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<p id="section-9-1">This document has no IANA actions.<a class="pilcrow" href="#section-9-1">¶</a></p>
</section>
</div>
<section id="section-10">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-10">10. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<p id="section-10-1">The security implications of IPv6 extension headers are discussed in <a class="xref" href="#security-implications">Section 8.4</a>.  This document does not introduce any new security issues.<a class="pilcrow" href="#section-10-1">¶</a></p>
</section>
<section id="section-11">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-11">11. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-11.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-11.1">11.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC5095">[RFC5095]</dt>
        <dd>
<span class="refAuthor">Abley, J.</span>, <span class="refAuthor">Savola, P.</span>, and <span class="refAuthor">G. Neville-Neil</span>, <span class="refTitle">"Deprecation of Type 0 Routing Headers in IPv6"</span>, <span class="seriesInfo">RFC 5095</span>, <span class="seriesInfo">DOI 10.17487/RFC5095</span>, <time class="refDate" datetime="2007-12">December 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5095">https://www.rfc-editor.org/info/rfc5095</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5722">[RFC5722]</dt>
        <dd>
<span class="refAuthor">Krishnan, S.</span>, <span class="refTitle">"Handling of Overlapping IPv6 Fragments"</span>, <span class="seriesInfo">RFC 5722</span>, <span class="seriesInfo">DOI 10.17487/RFC5722</span>, <time class="refDate" datetime="2009-12">December 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5722">https://www.rfc-editor.org/info/rfc5722</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6946">[RFC6946]</dt>
        <dd>
<span class="refAuthor">Gont, F.</span>, <span class="refTitle">"Processing of IPv6 "Atomic" Fragments"</span>, <span class="seriesInfo">RFC 6946</span>, <span class="seriesInfo">DOI 10.17487/RFC6946</span>, <time class="refDate" datetime="2013-05">May 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6946">https://www.rfc-editor.org/info/rfc6946</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6980">[RFC6980]</dt>
        <dd>
<span class="refAuthor">Gont, F.</span>, <span class="refTitle">"Security Implications of IPv6 Fragmentation with IPv6 Neighbor Discovery"</span>, <span class="seriesInfo">RFC 6980</span>, <span class="seriesInfo">DOI 10.17487/RFC6980</span>, <time class="refDate" datetime="2013-08">August 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6980">https://www.rfc-editor.org/info/rfc6980</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7112">[RFC7112]</dt>
        <dd>
<span class="refAuthor">Gont, F.</span>, <span class="refAuthor">Manral, V.</span>, and <span class="refAuthor">R. Bonica</span>, <span class="refTitle">"Implications of Oversized IPv6 Header Chains"</span>, <span class="seriesInfo">RFC 7112</span>, <span class="seriesInfo">DOI 10.17487/RFC7112</span>, <time class="refDate" datetime="2014-01">January 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7112">https://www.rfc-editor.org/info/rfc7112</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8021">[RFC8021]</dt>
        <dd>
<span class="refAuthor">Gont, F.</span>, <span class="refAuthor">Liu, W.</span>, and <span class="refAuthor">T. Anderson</span>, <span class="refTitle">"Generation of IPv6 Atomic Fragments Considered Harmful"</span>, <span class="seriesInfo">RFC 8021</span>, <span class="seriesInfo">DOI 10.17487/RFC8021</span>, <time class="refDate" datetime="2017-01">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8021">https://www.rfc-editor.org/info/rfc8021</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8200">[RFC8200]</dt>
        <dd>
<span class="refAuthor">Deering, S.</span> and <span class="refAuthor">R. Hinden</span>, <span class="refTitle">"Internet Protocol, Version 6 (IPv6) Specification"</span>, <span class="seriesInfo">STD 86</span>, <span class="seriesInfo">RFC 8200</span>, <span class="seriesInfo">DOI 10.17487/RFC8200</span>, <time class="refDate" datetime="2017-07">July 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8200">https://www.rfc-editor.org/info/rfc8200</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8504">[RFC8504]</dt>
      <dd>
<span class="refAuthor">Chown, T.</span>, <span class="refAuthor">Loughney, J.</span>, and <span class="refAuthor">T. Winters</span>, <span class="refTitle">"IPv6 Node Requirements"</span>, <span class="seriesInfo">BCP 220</span>, <span class="seriesInfo">RFC 8504</span>, <span class="seriesInfo">DOI 10.17487/RFC8504</span>, <time class="refDate" datetime="2019-01">January 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8504">https://www.rfc-editor.org/info/rfc8504</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-11.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-11.2">11.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="Almeida-2020">[Almeida-2020]</dt>
        <dd>
<span class="refAuthor">Almeida, R.</span>, <span class="refAuthor">Cunha, I.</span>, <span class="refAuthor">Teixeira, R.</span>, <span class="refAuthor">Veitch, D.</span>, and <span class="refAuthor">C. Diot</span>, <span class="refTitle">"Classification of Load Balancing in the Internet"</span>, <span class="refContent">IEEE INFOCOM 2020</span>, <span class="seriesInfo">DOI 10.1109/INFOCOM41043.2020.9155387</span>, <time class="refDate" datetime="2020-07">July 2020</time>, <span>&lt;<a href="https://homepages.dcc.ufmg.br/~cunha/papers/almeida20infocom-mca.pdf">https://homepages.dcc.ufmg.br/~cunha/papers/almeida20infocom-mca.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="APNIC-Scudder">[APNIC-Scudder]</dt>
        <dd>
<span class="refAuthor">Scudder, J.</span>, <span class="refTitle">"Modern router architecture and IPv6"</span>, <span class="refContent">APNIC Blog</span>, <time class="refDate" datetime="2020-06">June 2020</time>, <span>&lt;<a href="https://blog.apnic.net/2020/06/04/modern-router-architecture-and-ipv6/">https://blog.apnic.net/2020/06/04/modern-router-architecture-and-ipv6/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Atlasis2012">[Atlasis2012]</dt>
        <dd>
<span class="refAuthor">Atlasis, A.</span>, <span class="refTitle">"Attacking IPv6 Implementation Using Fragmentation"</span>, <span class="refContent">Black Hat Europe 2012</span>, <time class="refDate" datetime="2012-03">March 2012</time>, <span>&lt;<a href="https://void.gr/kargig/ipv6/bh-eu-12-Atlasis-Attacking_IPv6-Slides.pdf">https://void.gr/kargig/ipv6/bh-eu-12-Atlasis-Attacking_IPv6-Slides.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Atlasis2014">[Atlasis2014]</dt>
        <dd>
<span class="refAuthor">Atlasis, A.</span>, <span class="refTitle">"A Novel Way of Abusing IPv6 Extension Headers to Evade IPv6 Security Devices"</span>, <time class="refDate" datetime="2014-05">May 2014</time>, <span>&lt;<a href="http://www.insinuator.net/2014/05/a-novel-way-of-abusing-ipv6-extension-headers-to-evade-ipv6-security-devices/">http://www.insinuator.net/2014/05/a-novel-way-of-abusing-ipv6-extension-headers-to-evade-ipv6-security-devices/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="BH-EU-2014">[BH-EU-2014]</dt>
        <dd>
<span class="refAuthor">Atlasis, A.</span>, <span class="refAuthor">Rey, E.</span>, and <span class="refAuthor">R. Schaefer</span>, <span class="refTitle">"Evasion of High-End IDPS Devices at the IPv6 Era"</span>, <span class="refContent">Black Hat Europe 2014</span>, <time class="refDate" datetime="2014">2014</time>, <span>&lt;<a href="https://www.ernw.de/download/eu-14-Atlasis-Rey-Schaefer-briefings-Evasion-of-HighEnd-IPS-Devices-wp.pdf">https://www.ernw.de/download/eu-14-Atlasis-Rey-Schaefer-briefings-Evasion-of-HighEnd-IPS-Devices-wp.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Bonica-NANOG58">[Bonica-NANOG58]</dt>
        <dd>
<span class="refAuthor">Bonica, R.</span>, <span class="refTitle">"IPv6 Fragmentation: The Case For Deprecation"</span>, <span class="refContent">NANOG 58</span>, <time class="refDate" datetime="2013-06">June 2013</time>, <span>&lt;<a href="https://www.nanog.org/sites/default/files/mon.general.fragmentation.bonica.pdf">https://www.nanog.org/sites/default/files/mon.general.fragmentation.bonica.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Cisco-EH-Cons">[Cisco-EH-Cons]</dt>
        <dd>
<span class="refAuthor">Cisco</span>, <span class="refTitle">"IPv6 Extension Headers Review and Considerations"</span>, <time class="refDate" datetime="2006-10">October 2006</time>, <span>&lt;<a href="http://www.cisco.com/en/US/technologies/tk648/tk872/technologies_white_paper0900aecd8054d37d.pdf">http://www.cisco.com/en/US/technologies/tk648/tk872/technologies_white_paper0900aecd8054d37d.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Cisco-Frag">[Cisco-Frag]</dt>
        <dd>
<span class="refAuthor">Cisco</span>, <span class="refTitle">"Cisco IOS XR Software Crafted IPv6 Packet Denial of Service Vulnerability"</span>, <time class="refDate" datetime="2015-06">June 2015</time>, <span>&lt;<a href="http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20150611-iosxr">http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20150611-iosxr</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="FreeBSD-SA">[FreeBSD-SA]</dt>
        <dd>
<span class="refAuthor">The FreeBSD Project</span>, <span class="refTitle">"IPv6 Hop-by-Hop options use-after-free bug"</span>, <time class="refDate" datetime="2020-09">September 2020</time>, <span>&lt;<a href="https://www.freebsd.org/security/advisories/FreeBSD-SA-20:24.ipv6.asc">https://www.freebsd.org/security/advisories/FreeBSD-SA-20:24.ipv6.asc</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.wkumari-long-headers">[HEADERS]</dt>
        <dd>
<span class="refAuthor">Kumari, W.</span>, <span class="refAuthor">Jaeggli, J.</span>, <span class="refAuthor">Bonica, R. P.</span>, and <span class="refAuthor">J. Linkova</span>, <span class="refTitle">"Operational Issues Associated With Long IPv6 Header Chains"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-wkumari-long-headers-03</span>, <time class="refDate" datetime="2015-06-16">16 June 2015</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-wkumari-long-headers-03">https://datatracker.ietf.org/doc/html/draft-wkumari-long-headers-03</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Huston-2017">[Huston-2017]</dt>
        <dd>
<span class="refAuthor">Huston, G.</span>, <span class="refTitle">"Dealing with IPv6 fragmentation in the DNS"</span>, <span class="refContent">APNIC Blog</span>, <time class="refDate" datetime="2017-08">August 2017</time>, <span>&lt;<a href="https://blog.apnic.net/2017/08/22/dealing-ipv6-fragmentation-dns/">https://blog.apnic.net/2017/08/22/dealing-ipv6-fragmentation-dns/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Huston-2020">[Huston-2020]</dt>
        <dd>
<span class="refAuthor">Huston, G.</span>, <span class="refTitle">"Measurement of IPv6 Extension Header Support"</span>, <span class="refContent">NPS/CAIDA 2020 Virtual IPv6 Workshop</span>, <time class="refDate" datetime="2020-06">June 2020</time>, <span>&lt;<a href="https://www.cmand.org/workshops/202006-v6/slides/2020-06-16-xtn-hdrs.pdf">https://www.cmand.org/workshops/202006-v6/slides/2020-06-16-xtn-hdrs.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IEPG94-Scudder">[IEPG94-Scudder]</dt>
        <dd>
<span class="refAuthor">Petersen, B.</span> and <span class="refAuthor">J. Scudder</span>, <span class="refTitle">"Modern Router Architecture for Protocol Designers"</span>, <span class="refContent">IEPG 94</span>, <time class="refDate" datetime="2015-11">November 2015</time>, <span>&lt;<a href="http://www.iepg.org/2015-11-01-ietf94/IEPG-RouterArchitecture-jgs.pdf">http://www.iepg.org/2015-11-01-ietf94/IEPG-RouterArchitecture-jgs.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-opsec-ipv6-eh-filtering">[IPV6-EH]</dt>
        <dd>
<span class="refAuthor">Gont, F.</span> and <span class="refAuthor">W. Liu</span>, <span class="refTitle">"Recommendations on the Filtering of IPv6 Packets Containing IPv6 Extension Headers at Transit Routers"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-opsec-ipv6-eh-filtering-08</span>, <time class="refDate" datetime="2021-06-03">3 June 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-opsec-ipv6-eh-filtering-08">https://datatracker.ietf.org/doc/html/draft-ietf-opsec-ipv6-eh-filtering-08</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Jaeggli-2018">[Jaeggli-2018]</dt>
        <dd>
<span class="refAuthor">Jaeggli, J.</span>, <span class="refTitle">"IPv6 flow label: misuse in hashing"</span>, <span class="refContent">APNIC Blog</span>, <time class="refDate" datetime="2018-01">January 2018</time>, <span>&lt;<a href="https://blog.apnic.net/2018/01/11/ipv6-flow-label-misuse-hashing/">https://blog.apnic.net/2018/01/11/ipv6-flow-label-misuse-hashing/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Linkova-Gont-IEPG90">[Linkova-Gont-IEPG90]</dt>
        <dd>
<span class="refAuthor">Linkova, J.</span> and <span class="refAuthor">F. Gont</span>, <span class="refTitle">"IPv6 Extension Headers in the Real World v2.0"</span>, <span class="refContent">IEPG 90</span>, <time class="refDate" datetime="2014-07">July 2014</time>, <span>&lt;<a href="http://www.iepg.org/2014-07-20-ietf90/iepg-ietf90-ipv6-ehs-in-the-real-world-v2.0.pdf">http://www.iepg.org/2014-07-20-ietf90/iepg-ietf90-ipv6-ehs-in-the-real-world-v2.0.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Microsoft-SA">[Microsoft-SA]</dt>
        <dd>
<span class="refAuthor">Microsoft</span>, <span class="refTitle">"Windows TCP/IP Remote Code Execution Vulnerability"</span>, <span class="refContent">CVE-2021-24094</span>, <time class="refDate" datetime="2021-02">February 2021</time>, <span>&lt;<a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-24094">https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-24094</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="nmap">[nmap]</dt>
        <dd>
<span class="refAuthor">Lyon, G.</span>, <span class="refTitle">"Firewall/IDS Evasion and Spoofing"</span>, <span class="refContent">Chapter 15. Nmap Reference Guide</span>, <span>&lt;<a href="https://nmap.org/book/man-bypass-firewalls-ids.html">https://nmap.org/book/man-bypass-firewalls-ids.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.taylor-v6ops-fragdrop">[OPERATORS]</dt>
        <dd>
<span class="refAuthor">Jaeggli, J.</span>, <span class="refAuthor">Colitti, L.</span>, <span class="refAuthor">Kumari, W.</span>, <span class="refAuthor">Vyncke, E.</span>, <span class="refAuthor">Kaeo, M.</span>, and <span class="refAuthor">T. Taylor, Ed.</span>, <span class="refTitle">"Why Operators Filter Fragments and What It Implies"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-taylor-v6ops-fragdrop-02</span>, <time class="refDate" datetime="2013-12-03">3 December 2013</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-taylor-v6ops-fragdrop-02">https://datatracker.ietf.org/doc/html/draft-taylor-v6ops-fragdrop-02</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.kampanakis-6man-ipv6-eh-parsing">[PARSING]</dt>
        <dd>
<span class="refAuthor">Kampanakis, P.</span>, <span class="refTitle">"Implementation Guidelines for Parsing IPv6 Extension Headers"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-kampanakis-6man-ipv6-eh-parsing-01</span>, <time class="refDate" datetime="2014-08-05">5 August 2014</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-kampanakis-6man-ipv6-eh-parsing-01">https://datatracker.ietf.org/doc/html/draft-kampanakis-6man-ipv6-eh-parsing-01</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="PMTUD-Blackholes">[PMTUD-Blackholes]</dt>
        <dd>
<span class="refAuthor">De Boer, M.</span> and <span class="refAuthor">J. Bosma</span>, <span class="refTitle">"Discovering Path MTU black holes on the Internet using RIPE Atlas"</span>, <span class="refContent">University of Amsterdam, MSc. Systems &amp; Network Engineering</span>, <time class="refDate" datetime="2012-07">July 2012</time>, <span>&lt;<a href="http://www.nlnetlabs.nl/downloads/publications/pmtu-black-holes-msc-thesis.pdf">http://www.nlnetlabs.nl/downloads/publications/pmtu-black-holes-msc-thesis.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2460">[RFC2460]</dt>
        <dd>
<span class="refAuthor">Deering, S.</span> and <span class="refAuthor">R. Hinden</span>, <span class="refTitle">"Internet Protocol, Version 6 (IPv6) Specification"</span>, <span class="seriesInfo">RFC 2460</span>, <span class="seriesInfo">DOI 10.17487/RFC2460</span>, <time class="refDate" datetime="1998-12">December 1998</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2460">https://www.rfc-editor.org/info/rfc2460</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5635">[RFC5635]</dt>
        <dd>
<span class="refAuthor">Kumari, W.</span> and <span class="refAuthor">D. McPherson</span>, <span class="refTitle">"Remote Triggered Black Hole Filtering with Unicast Reverse Path Forwarding (uRPF)"</span>, <span class="seriesInfo">RFC 5635</span>, <span class="seriesInfo">DOI 10.17487/RFC5635</span>, <time class="refDate" datetime="2009-08">August 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5635">https://www.rfc-editor.org/info/rfc5635</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6192">[RFC6192]</dt>
        <dd>
<span class="refAuthor">Dugal, D.</span>, <span class="refAuthor">Pignataro, C.</span>, and <span class="refAuthor">R. Dunn</span>, <span class="refTitle">"Protecting the Router Control Plane"</span>, <span class="seriesInfo">RFC 6192</span>, <span class="seriesInfo">DOI 10.17487/RFC6192</span>, <time class="refDate" datetime="2011-03">March 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6192">https://www.rfc-editor.org/info/rfc6192</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6437">[RFC6437]</dt>
        <dd>
<span class="refAuthor">Amante, S.</span>, <span class="refAuthor">Carpenter, B.</span>, <span class="refAuthor">Jiang, S.</span>, and <span class="refAuthor">J. Rajahalme</span>, <span class="refTitle">"IPv6 Flow Label Specification"</span>, <span class="seriesInfo">RFC 6437</span>, <span class="seriesInfo">DOI 10.17487/RFC6437</span>, <time class="refDate" datetime="2011-11">November 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6437">https://www.rfc-editor.org/info/rfc6437</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6438">[RFC6438]</dt>
        <dd>
<span class="refAuthor">Carpenter, B.</span> and <span class="refAuthor">S. Amante</span>, <span class="refTitle">"Using the IPv6 Flow Label for Equal Cost Multipath Routing and Link Aggregation in Tunnels"</span>, <span class="seriesInfo">RFC 6438</span>, <span class="seriesInfo">DOI 10.17487/RFC6438</span>, <time class="refDate" datetime="2011-11">November 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6438">https://www.rfc-editor.org/info/rfc6438</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7045">[RFC7045]</dt>
        <dd>
<span class="refAuthor">Carpenter, B.</span> and <span class="refAuthor">S. Jiang</span>, <span class="refTitle">"Transmission and Processing of IPv6 Extension Headers"</span>, <span class="seriesInfo">RFC 7045</span>, <span class="seriesInfo">DOI 10.17487/RFC7045</span>, <time class="refDate" datetime="2013-12">December 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7045">https://www.rfc-editor.org/info/rfc7045</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7098">[RFC7098]</dt>
        <dd>
<span class="refAuthor">Carpenter, B.</span>, <span class="refAuthor">Jiang, S.</span>, and <span class="refAuthor">W. Tarreau</span>, <span class="refTitle">"Using the IPv6 Flow Label for Load Balancing in Server Farms"</span>, <span class="seriesInfo">RFC 7098</span>, <span class="seriesInfo">DOI 10.17487/RFC7098</span>, <time class="refDate" datetime="2014-01">January 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7098">https://www.rfc-editor.org/info/rfc7098</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7113">[RFC7113]</dt>
        <dd>
<span class="refAuthor">Gont, F.</span>, <span class="refTitle">"Implementation Advice for IPv6 Router Advertisement Guard (RA-Guard)"</span>, <span class="seriesInfo">RFC 7113</span>, <span class="seriesInfo">DOI 10.17487/RFC7113</span>, <time class="refDate" datetime="2014-02">February 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7113">https://www.rfc-editor.org/info/rfc7113</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7739">[RFC7739]</dt>
        <dd>
<span class="refAuthor">Gont, F.</span>, <span class="refTitle">"Security Implications of Predictable Fragment Identification Values"</span>, <span class="seriesInfo">RFC 7739</span>, <span class="seriesInfo">DOI 10.17487/RFC7739</span>, <time class="refDate" datetime="2016-02">February 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7739">https://www.rfc-editor.org/info/rfc7739</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7872">[RFC7872]</dt>
        <dd>
<span class="refAuthor">Gont, F.</span>, <span class="refAuthor">Linkova, J.</span>, <span class="refAuthor">Chown, T.</span>, and <span class="refAuthor">W. Liu</span>, <span class="refTitle">"Observations on the Dropping of Packets with IPv6 Extension Headers in the Real World"</span>, <span class="seriesInfo">RFC 7872</span>, <span class="seriesInfo">DOI 10.17487/RFC7872</span>, <time class="refDate" datetime="2016-06">June 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7872">https://www.rfc-editor.org/info/rfc7872</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8900">[RFC8900]</dt>
        <dd>
<span class="refAuthor">Bonica, R.</span>, <span class="refAuthor">Baker, F.</span>, <span class="refAuthor">Huston, G.</span>, <span class="refAuthor">Hinden, R.</span>, <span class="refAuthor">Troan, O.</span>, and <span class="refAuthor">F. Gont</span>, <span class="refTitle">"IP Fragmentation Considered Fragile"</span>, <span class="seriesInfo">BCP 230</span>, <span class="seriesInfo">RFC 8900</span>, <span class="seriesInfo">DOI 10.17487/RFC8900</span>, <time class="refDate" datetime="2020-09">September 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8900">https://www.rfc-editor.org/info/rfc8900</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8955">[RFC8955]</dt>
        <dd>
<span class="refAuthor">Loibl, C.</span>, <span class="refAuthor">Hares, S.</span>, <span class="refAuthor">Raszuk, R.</span>, <span class="refAuthor">McPherson, D.</span>, and <span class="refAuthor">M. Bacher</span>, <span class="refTitle">"Dissemination of Flow Specification Rules"</span>, <span class="seriesInfo">RFC 8955</span>, <span class="seriesInfo">DOI 10.17487/RFC8955</span>, <time class="refDate" datetime="2020-12">December 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8955">https://www.rfc-editor.org/info/rfc8955</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8956">[RFC8956]</dt>
        <dd>
<span class="refAuthor">Loibl, C., Ed.</span>, <span class="refAuthor">Raszuk, R., Ed.</span>, and <span class="refAuthor">S. Hares, Ed.</span>, <span class="refTitle">"Dissemination of Flow Specification Rules for IPv6"</span>, <span class="seriesInfo">RFC 8956</span>, <span class="seriesInfo">DOI 10.17487/RFC8956</span>, <time class="refDate" datetime="2020-12">December 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8956">https://www.rfc-editor.org/info/rfc8956</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Zack-FW-Benchmark">[Zack-FW-Benchmark]</dt>
      <dd>
<span class="refAuthor">Zack, E.</span>, <span class="refTitle">"Firewall Security Assessment and Benchmarking IPv6 Firewall Load Tests"</span>, <span class="refContent">IPv6 Hackers Meeting #1</span>, <time class="refDate" datetime="2013-06">June 2013</time>, <span>&lt;<a href="https://www.ipv6hackers.org/files/meetings/ipv6-hackers-1/zack-ipv6hackers1-firewall-security-assessment-and-benchmarking.pdf">https://www.ipv6hackers.org/files/meetings/ipv6-hackers-1/zack-ipv6hackers1-firewall-security-assessment-and-benchmarking.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<section id="appendix-A">
      <h2 id="name-acknowledgements">
<a class="section-name selfRef" href="#name-acknowledgements">Acknowledgements</a>
      </h2>
<p id="appendix-A-1">The authors would like to thank (in alphabetical order) <span class="contact-name">Mikael Abrahamsson</span>, <span class="contact-name">Fred Baker</span>, <span class="contact-name">Dale W. Carder</span>, <span class="contact-name">Brian Carpenter</span>, <span class="contact-name">Tim Chown</span>, <span class="contact-name">Owen DeLong</span>, <span class="contact-name">Gorry Fairhurst</span>, <span class="contact-name">Guillermo Gont</span>, <span class="contact-name">Tom Herbert</span>, <span class="contact-name">Lee Howard</span>, <span class="contact-name">Tom Petch</span>, <span class="contact-name">Sander Steffann</span>, <span class="contact-name">Eduard Vasilenko</span>, <span class="contact-name">Éric Vyncke</span>, <span class="contact-name">Rob Wilton</span>, <span class="contact-name">Jingrong Xie</span>, and <span class="contact-name">Andrew Yourtchenko</span> for providing valuable comments on earlier draft versions of this document.<a class="pilcrow" href="#appendix-A-1">¶</a></p>
<p id="appendix-A-2"><span class="contact-name">Fernando Gont</span> would like to thank <span class="contact-name">Jan Zorz</span> / Go6 Lab <span>&lt;<a href="https://go6lab.si/">https://go6lab.si/</a>&gt;</span>, <span class="contact-name">Jared Mauch</span>, and <span class="contact-name">Sander Steffann</span> <span>&lt;<a href="https://steffann.nl/">https://steffann.nl/</a>&gt;</span> for providing access to systems and networks that were employed to perform experiments and measurements involving packets with IPv6 extension headers.<a class="pilcrow" href="#appendix-A-2">¶</a></p>
</section>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a class="section-name selfRef" href="#name-authors-addresses">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Fernando Gont</span></div>
<div class="left" dir="auto"><span class="org">SI6 Networks</span></div>
<div class="left" dir="auto"><span class="street-address">Segurola y Habana 4310, 7mo Piso</span></div>
<div class="left" dir="auto"><span class="locality">Villa Devoto</span></div>
<div class="left" dir="auto"><span class="region">Ciudad Autonoma de Buenos Aires</span></div>
<div class="left" dir="auto"><span class="country-name">Argentina</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:fgont@si6networks.com">fgont@si6networks.com</a>
</div>
<div class="url">
<span>URI:</span>
<a class="url" href="https://www.si6networks.com">https://www.si6networks.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Nick Hilliard</span></div>
<div class="left" dir="auto"><span class="org">INEX</span></div>
<div class="left" dir="auto"><span class="street-address">4027 Kingswood Road</span></div>
<div class="left" dir="auto"><span class="locality">Dublin</span></div>
<div class="left" dir="auto"><span class="postal-code">24</span></div>
<div class="left" dir="auto"><span class="country-name">Ireland</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:nick@inex.ie">nick@inex.ie</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Gert Doering</span></div>
<div class="left" dir="auto"><span class="org">SpaceNet AG</span></div>
<div class="left" dir="auto"><span class="street-address">Joseph-Dollinger-Bogen 14</span></div>
<div class="left" dir="auto">
<span class="postal-code">D-80807</span> <span class="locality">Muenchen</span>
</div>
<div class="left" dir="auto"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:gert@space.net">gert@space.net</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Warren Kumari</span></div>
<div class="left" dir="auto"><span class="org">Google</span></div>
<div class="left" dir="auto"><span class="street-address">1600 Amphitheatre Parkway</span></div>
<div class="left" dir="auto">
<span class="locality">Mountain View</span>, <span class="region">CA</span> <span class="postal-code">94043</span>
</div>
<div class="left" dir="auto"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:warren@kumari.net">warren@kumari.net</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Geoff Huston</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:gih@apnic.net">gih@apnic.net</a>
</div>
<div class="url">
<span>URI:</span>
<a class="url" href="https://www.apnic.net">https://www.apnic.net</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Will (Shucheng) Liu</span></div>
<div class="left" dir="auto"><span class="org">Huawei Technologies</span></div>
<div class="left" dir="auto"><span class="street-address">Bantian, Longgang District</span></div>
<div class="left" dir="auto"><span class="locality">Shenzhen</span></div>
<div class="left" dir="auto"><span class="postal-code">518129</span></div>
<div class="left" dir="auto"><span class="country-name">China</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:liushucheng@huawei.com">liushucheng@huawei.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>