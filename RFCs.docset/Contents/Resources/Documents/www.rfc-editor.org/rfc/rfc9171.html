<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 9171: Bundle Protocol Version 7</title>
<meta content="Scott Burleigh" name="author"/>
<meta content="Kevin Fall" name="author"/>
<meta content="Edward J. Birrane, III" name="author"/>
<meta content="
       
   This document presents a specification for the Bundle
   Protocol, adapted from the experimental Bundle Protocol
   specification developed by the Delay-Tolerant Networking Research
   Group of the Internet Research Task Force and documented in RFC
   5050.

 
    " name="description"/>
<meta content="xml2rfc 3.12.0" name="generator"/>
<meta content="Delay-tolerant networking" name="keyword"/>
<meta content="disruption-tolerant networking" name="keyword"/>
<meta content="9171" name="rfc.number"/>
<!-- Generator version information:
  xml2rfc 3.12.0
    Python 3.6.15
    appdirs 1.4.4
    ConfigArgParse 1.4.1
    google-i18n-address 2.4.0
    html5lib 1.0.1
    intervaltree 3.0.2
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.4.2
    pycairo 1.15.1
    pycountry 19.8.18
    pyflakes 2.1.1
    PyYAML 5.4.1
    requests 2.24.0
    setuptools 40.5.0
    six 1.14.0
    WeasyPrint 52.5
-->
<link href="rfc9171.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://dx.doi.org/10.17487/rfc9171" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <link href="https://datatracker.ietf.org/doc/draft-ietf-dtn-bpbis-31" rel="prev"/>
  </head>
<body>
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9171</td>
<td class="center">Bundle Protocol Version 7</td>
<td class="right">January 2022</td>
</tr></thead>
<tfoot><tr>
<td class="left">Burleigh, et al.</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc9171">9171</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2022-01">January 2022</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">S. Burleigh</div>
<div class="org">IPNGROUP</div>
</div>
<div class="author">
      <div class="author-name">K. Fall</div>
<div class="org">Roland Computing Services</div>
</div>
<div class="author">
      <div class="author-name">E. Birrane, III</div>
<div class="org">APL, Johns Hopkins University</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9171</h1>
<h1 id="title">Bundle Protocol Version 7</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">
   This document presents a specification for the Bundle
   Protocol, adapted from the experimental Bundle Protocol
   specification developed by the Delay-Tolerant Networking Research
   Group of the Internet Research Task Force and documented in RFC
   5050.<a class="pilcrow" href="#section-abstract-1">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a class="pilcrow" href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9171">https://www.rfc-editor.org/info/rfc9171</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">▲</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p class="keepWithNext" id="section-toc.1-1.1.1"><a class="xref" href="#section-1">1</a>.  <a class="xref" href="#name-introduction">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p class="keepWithNext" id="section-toc.1-1.2.1"><a class="xref" href="#section-2">2</a>.  <a class="xref" href="#name-conventions-used-in-this-do">Conventions Used in This Document</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a class="xref" href="#section-3">3</a>.  <a class="xref" href="#name-service-description">Service Description</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p class="keepWithNext" id="section-toc.1-1.3.2.1.1"><a class="xref" href="#section-3.1">3.1</a>.  <a class="xref" href="#name-definitions">Definitions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a class="xref" href="#section-3.2">3.2</a>.  <a class="xref" href="#name-discussion-of-bp-concepts">Discussion of BP Concepts</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a class="xref" href="#section-3.3">3.3</a>.  <a class="xref" href="#name-services-offered-by-bundle-">Services Offered by Bundle Protocol Agents</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="xref" href="#section-4">4</a>.  <a class="xref" href="#name-bundle-format">Bundle Format</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a class="xref" href="#section-4.1">4.1</a>.  <a class="xref" href="#name-bundle-structure">Bundle Structure</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a class="xref" href="#section-4.2">4.2</a>.  <a class="xref" href="#name-bp-fundamental-data-structu">BP Fundamental Data Structures</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a class="xref" href="#section-4.2.1">4.2.1</a>.  <a class="xref" href="#name-crc-type">CRC Type</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.2">
                    <p id="section-toc.1-1.4.2.2.2.2.1"><a class="xref" href="#section-4.2.2">4.2.2</a>.  <a class="xref" href="#name-crc">CRC</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.3">
                    <p id="section-toc.1-1.4.2.2.2.3.1"><a class="xref" href="#section-4.2.3">4.2.3</a>.  <a class="xref" href="#name-bundle-processing-control-f">Bundle Processing Control Flags</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.4">
                    <p id="section-toc.1-1.4.2.2.2.4.1"><a class="xref" href="#section-4.2.4">4.2.4</a>.  <a class="xref" href="#name-block-processing-control-fl">Block Processing Control Flags</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.5">
                    <p id="section-toc.1-1.4.2.2.2.5.1"><a class="xref" href="#section-4.2.5">4.2.5</a>.  <a class="xref" href="#name-identifiers">Identifiers</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.5.2.1">
                        <p id="section-toc.1-1.4.2.2.2.5.2.1.1"><a class="xref" href="#section-4.2.5.1">4.2.5.1</a>.  <a class="xref" href="#name-endpoint-id">Endpoint ID</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.5.2.1.2.1">
                            <p id="section-toc.1-1.4.2.2.2.5.2.1.2.1.1"><a class="xref" href="#section-4.2.5.1.1">4.2.5.1.1</a>.  <a class="xref" href="#name-the-dtn-uri-scheme">The dtn URI Scheme</a></p>
</li>
                          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.5.2.1.2.2">
                            <p id="section-toc.1-1.4.2.2.2.5.2.1.2.2.1"><a class="xref" href="#section-4.2.5.1.2">4.2.5.1.2</a>.  <a class="xref" href="#name-the-ipn-uri-scheme">The ipn URI Scheme</a></p>
</li>
                        </ul>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.5.2.2">
                        <p id="section-toc.1-1.4.2.2.2.5.2.2.1"><a class="xref" href="#section-4.2.5.2">4.2.5.2</a>.  <a class="xref" href="#name-node-id">Node ID</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.6">
                    <p id="section-toc.1-1.4.2.2.2.6.1"><a class="xref" href="#section-4.2.6">4.2.6</a>.  <a class="xref" href="#name-dtn-time">DTN Time</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.7">
                    <p id="section-toc.1-1.4.2.2.2.7.1"><a class="xref" href="#section-4.2.7">4.2.7</a>.  <a class="xref" href="#name-creation-timestamp">Creation Timestamp</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.8">
                    <p id="section-toc.1-1.4.2.2.2.8.1"><a class="xref" href="#section-4.2.8">4.2.8</a>.  <a class="xref" href="#name-block-type-specific-data">Block-Type-Specific Data</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a class="xref" href="#section-4.3">4.3</a>.  <a class="xref" href="#name-block-structures">Block Structures</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.1">
                    <p id="section-toc.1-1.4.2.3.2.1.1"><a class="xref" href="#section-4.3.1">4.3.1</a>.  <a class="xref" href="#name-primary-bundle-block">Primary Bundle Block</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.2">
                    <p id="section-toc.1-1.4.2.3.2.2.1"><a class="xref" href="#section-4.3.2">4.3.2</a>.  <a class="xref" href="#name-canonical-bundle-block-form">Canonical Bundle Block Format</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a class="xref" href="#section-4.4">4.4</a>.  <a class="xref" href="#name-extension-blocks">Extension Blocks</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.1">
                    <p id="section-toc.1-1.4.2.4.2.1.1"><a class="xref" href="#section-4.4.1">4.4.1</a>.  <a class="xref" href="#name-previous-node">Previous Node</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.2">
                    <p id="section-toc.1-1.4.2.4.2.2.1"><a class="xref" href="#section-4.4.2">4.4.2</a>.  <a class="xref" href="#name-bundle-age">Bundle Age</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.3">
                    <p id="section-toc.1-1.4.2.4.2.3.1"><a class="xref" href="#section-4.4.3">4.4.3</a>.  <a class="xref" href="#name-hop-count">Hop Count</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="xref" href="#section-5">5</a>.  <a class="xref" href="#name-bundle-processing">Bundle Processing</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a class="xref" href="#section-5.1">5.1</a>.  <a class="xref" href="#name-generation-of-administrativ">Generation of Administrative Records</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a class="xref" href="#section-5.2">5.2</a>.  <a class="xref" href="#name-bundle-transmission">Bundle Transmission</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a class="xref" href="#section-5.3">5.3</a>.  <a class="xref" href="#name-bundle-dispatching">Bundle Dispatching</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a class="xref" href="#section-5.4">5.4</a>.  <a class="xref" href="#name-bundle-forwarding">Bundle Forwarding</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4.2.1">
                    <p id="section-toc.1-1.5.2.4.2.1.1"><a class="xref" href="#section-5.4.1">5.4.1</a>.  <a class="xref" href="#name-forwarding-contraindicated">Forwarding Contraindicated</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4.2.2">
                    <p id="section-toc.1-1.5.2.4.2.2.1"><a class="xref" href="#section-5.4.2">5.4.2</a>.  <a class="xref" href="#name-forwarding-failed">Forwarding Failed</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5">
                <p id="section-toc.1-1.5.2.5.1"><a class="xref" href="#section-5.5">5.5</a>.  <a class="xref" href="#name-bundle-expiration">Bundle Expiration</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.6">
                <p id="section-toc.1-1.5.2.6.1"><a class="xref" href="#section-5.6">5.6</a>.  <a class="xref" href="#name-bundle-reception">Bundle Reception</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.7">
                <p id="section-toc.1-1.5.2.7.1"><a class="xref" href="#section-5.7">5.7</a>.  <a class="xref" href="#name-local-bundle-delivery">Local Bundle Delivery</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.8">
                <p id="section-toc.1-1.5.2.8.1"><a class="xref" href="#section-5.8">5.8</a>.  <a class="xref" href="#name-bundle-fragmentation">Bundle Fragmentation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.9">
                <p id="section-toc.1-1.5.2.9.1"><a class="xref" href="#section-5.9">5.9</a>.  <a class="xref" href="#name-application-data-unit-reass">Application Data Unit Reassembly</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.10">
                <p id="section-toc.1-1.5.2.10.1"><a class="xref" href="#section-5.10">5.10</a>. <a class="xref" href="#name-bundle-deletion">Bundle Deletion</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.11">
                <p id="section-toc.1-1.5.2.11.1"><a class="xref" href="#section-5.11">5.11</a>. <a class="xref" href="#name-discarding-a-bundle">Discarding a Bundle</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.12">
                <p id="section-toc.1-1.5.2.12.1"><a class="xref" href="#section-5.12">5.12</a>. <a class="xref" href="#name-canceling-a-transmission">Canceling a Transmission</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="xref" href="#section-6">6</a>.  <a class="xref" href="#name-administrative-record-proce">Administrative Record Processing</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a class="xref" href="#section-6.1">6.1</a>.  <a class="xref" href="#name-administrative-records">Administrative Records</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.1">
                    <p id="section-toc.1-1.6.2.1.2.1.1"><a class="xref" href="#section-6.1.1">6.1.1</a>.  <a class="xref" href="#name-bundle-status-reports">Bundle Status Reports</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a class="xref" href="#section-6.2">6.2</a>.  <a class="xref" href="#name-generation-of-administrative">Generation of Administrative Records</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="xref" href="#section-7">7</a>.  <a class="xref" href="#name-services-required-of-the-co">Services Required of the Convergence Layer</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a class="xref" href="#section-7.1">7.1</a>.  <a class="xref" href="#name-the-convergence-layer">The Convergence Layer</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a class="xref" href="#section-7.2">7.2</a>.  <a class="xref" href="#name-summary-of-convergence-laye">Summary of Convergence-Layer Services</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="xref" href="#section-8">8</a>.  <a class="xref" href="#name-security-considerations">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="xref" href="#section-9">9</a>.  <a class="xref" href="#name-iana-considerations">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a class="xref" href="#section-9.1">9.1</a>.  <a class="xref" href="#name-bundle-block-types">Bundle Block Types</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a class="xref" href="#section-9.2">9.2</a>.  <a class="xref" href="#name-primary-bundle-protocol-ver">Primary Bundle Protocol Version</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a class="xref" href="#section-9.3">9.3</a>.  <a class="xref" href="#name-bundle-processing-control-fl">Bundle Processing Control Flags</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4">
                <p id="section-toc.1-1.9.2.4.1"><a class="xref" href="#section-9.4">9.4</a>.  <a class="xref" href="#name-block-processing-control-fla">Block Processing Control Flags</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.5">
                <p id="section-toc.1-1.9.2.5.1"><a class="xref" href="#section-9.5">9.5</a>.  <a class="xref" href="#name-bundle-status-report-reason">Bundle Status Report Reason Codes</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.6">
                <p id="section-toc.1-1.9.2.6.1"><a class="xref" href="#section-9.6">9.6</a>.  <a class="xref" href="#name-bundle-protocol-uri-scheme-">Bundle Protocol URI Scheme Types</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.7">
                <p id="section-toc.1-1.9.2.7.1"><a class="xref" href="#section-9.7">9.7</a>.  <a class="xref" href="#name-dtn-uri-scheme">dtn URI Scheme</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.8">
                <p id="section-toc.1-1.9.2.8.1"><a class="xref" href="#section-9.8">9.8</a>.  <a class="xref" href="#name-ipn-uri-scheme">ipn URI Scheme</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a class="xref" href="#section-10">10</a>. <a class="xref" href="#name-references">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a class="xref" href="#section-10.1">10.1</a>.  <a class="xref" href="#name-normative-references">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a class="xref" href="#section-10.2">10.2</a>.  <a class="xref" href="#name-informative-references">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a class="xref" href="#appendix-A">Appendix A</a>.  <a class="xref" href="#name-significant-changes-from-rf">Significant Changes from RFC 5050</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a class="xref" href="#appendix-B">Appendix B</a>.  <a class="xref" href="#name-cddl-expression">CDDL Expression</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a class="xref" href="#appendix-C"></a><a class="xref" href="#name-acknowledgments">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a class="xref" href="#appendix-D"></a><a class="xref" href="#name-authors-addresses">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="sect-1">
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">
   Since the publication of the Bundle Protocol specification
   (Experimental RFC 5050 <span>[<a class="xref" href="#RFC5050">RFC5050</a>]</span>) in 2007, the Delay-Tolerant
   Networking (DTN) Bundle Protocol (BP) has been implemented in multiple
   programming languages and deployed to a wide variety of computing
   platforms.  This implementation and deployment experience has
   identified opportunities for making the protocol simpler, more
   capable, and easier to use.  The present document, standardizing the
   Bundle Protocol, is adapted from RFC 5050 in that context,
   reflecting lessons learned.  Significant changes from the Bundle
   Protocol specification defined in RFC 5050 are listed in <a class="xref" href="#app-a">Appendix A</a>.<a class="pilcrow" href="#section-1-1">¶</a></p>
<p id="section-1-2">
   This document describes BP version 7 (BPv7).<a class="pilcrow" href="#section-1-2">¶</a></p>
<p id="section-1-3">
   Delay-Tolerant Networking is a network architecture providing
   communications in and/or through highly stressed environments.
   Stressed networking environments include those with intermittent
   connectivity, large and/or variable delays, and high bit error
   rates.  To provide its services, BP may be viewed as sitting at the
   application layer of some number of constituent networks, forming a
   store-carry-forward overlay network.  Key capabilities of BP
   include:<a class="pilcrow" href="#section-1-3">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-4.1">Ability to use physical motility for the movement of data.<a class="pilcrow" href="#section-1-4.1">¶</a>
</li>
        <li class="normal" id="section-1-4.2">Ability to move the responsibility for error control from one
            node to another.<a class="pilcrow" href="#section-1-4.2">¶</a>
</li>
        <li class="normal" id="section-1-4.3">Ability to cope with intermittent connectivity, including cases
           where the sender and receiver are not concurrently present in
           the network.<a class="pilcrow" href="#section-1-4.3">¶</a>
</li>
        <li class="normal" id="section-1-4.4">Ability to take advantage of scheduled, predicted, and
           opportunistic connectivity, whether bidirectional or
           unidirectional, in addition to continuous connectivity.<a class="pilcrow" href="#section-1-4.4">¶</a>
</li>
        <li class="normal" id="section-1-4.5">Late binding of overlay-network endpoint identifiers to
           underlying constituent network addresses.<a class="pilcrow" href="#section-1-4.5">¶</a>
</li>
      </ul>
<p id="section-1-5">
   For descriptions of these capabilities and the rationale for the DTN
   architecture, see <span>[<a class="xref" href="#RFC4838">ARCH</a>]</span> and <span>[<a class="xref" href="#SIGC">SIGC</a>]</span>.<a class="pilcrow" href="#section-1-5">¶</a></p>
<p id="section-1-6">
   BP's location within the standard protocol stack is as shown in <a class="xref" href="#fig-1">Figure 1</a>.
   BP uses underlying "integrated" transport and/or network protocols for
   communications within a given constituent network.  The layer at which
   those underlying protocols are located is here termed the "convergence
   layer", and the interface between the Bundle Protocol and a specific
   underlying protocol is termed a "convergence-layer adapter".<a class="pilcrow" href="#section-1-6">¶</a></p>
<p id="section-1-7">
   <a class="xref" href="#fig-1">Figure 1</a> shows three distinct transport and network protocols
   (denoted T1/N1, T2/N2, and T3/N3).<a class="pilcrow" href="#section-1-7">¶</a></p>
<span id="name-the-bundle-protocol-in-the-"></span><div id="fig-1">
<figure id="figure-1">
        <div class="alignLeft art-ascii-art art-text artwork" id="section-1-8.1">
<pre>+-----------+                                         +-----------+
|   BP app  |                                         |   BP app  |
+---------v-|   +-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;v-+     +-&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;v-+   +-^---------+
|   BP    v |   | ^    BP   v |     | ^   BP    v |   | ^   BP    |
+---------v-+   +-^---------v-+     +-^---------v-+   +-^---------+
| T1      v |   + ^  T1/T2  v |     + ^  T2/T3  v |   | ^ T3      |
+---------v-+   +-^---------v-+     +-^---------v +   +-^---------+
| N1      v |   | ^  N1/N2  v |     | ^  N2/N3  v |   | ^ N3      |
+---------v-+   +-^---------v +     +-^---------v-+   +-^---------+
|         &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;^         &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;^         &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;^         |
+-----------+   +-------------+     +-------------+   +-----------+
|                     |                     |                     |
|&lt;---- A network ----&gt;|                     |&lt;---- A network ----&gt;|
|                     |                     |                     |
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-1">Figure 1</a>:
<a class="selfRef" href="#name-the-bundle-protocol-in-the-">The Bundle Protocol in the Protocol Stack Model</a>
        </figcaption></figure>
</div>
<p id="section-1-9">
   This document describes the format of the protocol data units (PDUs)
   (called "bundles") passed between entities participating in BP
   communications.<a class="pilcrow" href="#section-1-9">¶</a></p>
<p id="section-1-10">
   The entities are referred to as "bundle nodes". This document does
   not address:<a class="pilcrow" href="#section-1-10">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-11.1">Operations in the convergence-layer adapters that bundle nodes use
        to transport data through specific types of internets.  (However, the
        document does discuss the services that must be provided by each
        adapter at the convergence layer.)<a class="pilcrow" href="#section-1-11.1">¶</a>
</li>
        <li class="normal" id="section-1-11.2">The bundle route computation algorithm.<a class="pilcrow" href="#section-1-11.2">¶</a>
</li>
        <li class="normal" id="section-1-11.3">Mechanisms for populating the routing or forwarding information
           bases of bundle nodes.<a class="pilcrow" href="#section-1-11.3">¶</a>
</li>
        <li class="normal" id="section-1-11.4">The mechanisms for securing bundles en route.<a class="pilcrow" href="#section-1-11.4">¶</a>
</li>
        <li class="normal" id="section-1-11.5"> The mechanisms for managing bundle nodes.<a class="pilcrow" href="#section-1-11.5">¶</a>
</li>
      </ul>
<p id="section-1-12">
   Note that implementations of the specification presented in this
   document will not be interoperable with implementations of RFC 5050.<a class="pilcrow" href="#section-1-12">¶</a></p>
</section>
</div>
<div id="sect-2">
<section id="section-2">
      <h2 id="name-conventions-used-in-this-do">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-conventions-used-in-this-do">Conventions Used in This Document</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>",
       "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>",
       "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>",
       "<span class="bcp14">SHOULD NOT</span>",
       "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
       "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document
       are to be interpreted as described in BCP 14
       <span>[<a class="xref" href="#RFC2119">RFC2119</a>]</span> <span>[<a class="xref" href="#RFC8174">RFC8174</a>]</span> when, and only
       when, they appear in all capitals, as shown here.<a class="pilcrow" href="#section-2-1">¶</a></p>
</section>
</div>
<div id="sect-3">
<section id="section-3">
      <h2 id="name-service-description">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-service-description">Service Description</a>
      </h2>
<div id="sect-3.1">
<section id="section-3.1">
        <h3 id="name-definitions">
<a class="section-number selfRef" href="#section-3.1">3.1. </a><a class="section-name selfRef" href="#name-definitions">Definitions</a>
        </h3>
<span class="break"></span><dl class="dlParallel" id="section-3.1-1">
          <dt id="section-3.1-1.1">Bundle:</dt>
          <dd id="section-3.1-1.2" style="margin-left: 1.5em">A bundle is a PDU of BP, so named because
   negotiation of the parameters of a data exchange may be impractical
   in a delay-tolerant network: it is often better practice to "bundle"
   with a unit of application data all metadata that might be needed in
   order to make the data immediately usable when delivered to the
   application. Each bundle comprises a sequence of two or more
   "blocks" of protocol data, which serve various purposes.<a class="pilcrow" href="#section-3.1-1.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-1.3">Block:</dt>
          <dd id="section-3.1-1.4" style="margin-left: 1.5em">A Bundle Protocol block is one of the protocol data
   structures that together constitute a well-formed bundle.<a class="pilcrow" href="#section-3.1-1.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-1.5">Application Data Unit:</dt>
          <dd id="section-3.1-1.6" style="margin-left: 1.5em">An application data unit (ADU) is the unit
   of data whose conveyance to the bundle's destination is the purpose
   for the transmission of some bundle that is not a fragment (as
   defined below).<a class="pilcrow" href="#section-3.1-1.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-1.7">Bundle payload:</dt>
          <dd id="section-3.1-1.8" style="margin-left: 1.5em">A bundle payload (or simply "payload") is the
   content of the bundle's payload block. The terms "bundle content",
   "bundle payload", and "payload" are used interchangeably in this
   document.  For a bundle that is not a fragment (as defined below),
   the payload is an ADU.<a class="pilcrow" href="#section-3.1-1.8">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-1.9">Partial payload:</dt>
          <dd id="section-3.1-1.10" style="margin-left: 1.5em">A partial payload is a payload that comprises
   either the first N bytes or the last N bytes of some other payload
   of length M, such that 0 &lt; N &lt; M.  Note that every partial payload is a payload and therefore can be further subdivided into partial payloads.<a class="pilcrow" href="#section-3.1-1.10">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-1.11">Fragment:</dt>
          <dd id="section-3.1-1.12" style="margin-left: 1.5em">A fragment, a.k.a. "fragmentary bundle", is a bundle
   whose payload block contains a partial payload.<a class="pilcrow" href="#section-3.1-1.12">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-1.13">Bundle node:</dt>
          <dd id="section-3.1-1.14" style="margin-left: 1.5em">A bundle node (or, in the context of this document,
   simply a "node") is any entity that can send and/or receive bundles.
   Each bundle node has three conceptual components, defined below, as
   shown in <a class="xref" href="#fig-2">Figure 2</a>: a "Bundle Protocol Agent", a set of zero or more
   "convergence-layer adapters", and an "application agent".
 ("CL1 PDUs" are the PDUs of the convergence-layer protocol used in network 1.)<a class="pilcrow" href="#section-3.1-1.14">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<span id="name-components-of-a-bundle-node"></span><div id="fig-2">
<figure id="figure-2">
          <div class="alignLeft art-ascii-art art-text artwork" id="section-3.1-2.1">
<pre>+-----------------------------------------------------------+
|Node                                                       |
|                                                           |
| +-------------------------------------------------------+ |
| |Application Agent                                      | |
| |                                                       | |
| | +--------------------------+ +----------------------+ | |
| | |Administrative element    | |Application-specific  | | |
| | |                          | |element               | | |
| | |                          | |                      | | |
| | +--------------------------+ +----------------------+ | |
| |                ^                          ^           | |
| |           Admin|records        Application|data       | |
| |                |                          |           | |
| +----------------v--------------------------v-----------+ |
|                               ^                           |
|                               | ADUs                      |
|                               |                           |
| +-----------------------------v-------------------------+ |
| |Bundle Protocol Agent                                  | |
| |                                                       | |
| |                                                       | |
| +-------------------------------------------------------+ |
|        ^                 ^                        ^       |
|        | Bundles         | Bundles        Bundles |       |
|        |                 |                        |       |
| +------v-----+     +-----v------+           +-----v-----+ |
| |CLA 1       |     |CLA 2       |           |CLA n      | |
| |            |     |            |   . . .   |           | |
| |            |     |            |           |           | |
+-+------------+-----+------------+-----------+-----------+-+
         ^                 ^                        ^
      CL1|PDUs          CL2|PDUs                 CLn|PDUs
         |                 |                        |
  +------v-----+     +-----v------+           +-----v-----+
   Network 1          Network 2                Network n
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-2">Figure 2</a>:
<a class="selfRef" href="#name-components-of-a-bundle-node">Components of a Bundle Node</a>
          </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-3.1-3">
          <dt id="section-3.1-3.1">Bundle Protocol Agent:</dt>
          <dd id="section-3.1-3.2" style="margin-left: 1.5em">The Bundle Protocol Agent (BPA) of a node is
   the node component that offers the BP services and executes the
   procedures of the Bundle Protocol.<a class="pilcrow" href="#section-3.1-3.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-3.3">Convergence-layer adapter:</dt>
          <dd id="section-3.1-3.4" style="margin-left: 1.5em">A convergence-layer adapter (CLA) is a
   node component that sends and receives bundles on behalf of the BPA,
   utilizing the services of some "integrated" protocol stack that is
   supported in one of the networks within which the node is
   functionally located.<a class="pilcrow" href="#section-3.1-3.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-3.5">Application agent:</dt>
          <dd id="section-3.1-3.6" style="margin-left: 1.5em">The application agent (AA) of a node is the node
   component that utilizes the BP services to effect communication for
   some user purpose. The application agent in turn has two elements:
   an administrative element and an application-specific element.<a class="pilcrow" href="#section-3.1-3.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-3.7">Application-specific element:</dt>
          <dd id="section-3.1-3.8" style="margin-left: 1.5em">The application-specific element of
   an AA is the node component that constructs, requests transmission
   of, accepts delivery of, and processes units of user application
   data.<a class="pilcrow" href="#section-3.1-3.8">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-3.9">Administrative element:</dt>
          <dd id="section-3.1-3.10" style="margin-left: 1.5em">The administrative element of an AA is the
   node component that constructs and requests transmission of
   administrative records (defined below), including status reports,
   and accepts delivery of and processes any administrative records
   that the node receives.<a class="pilcrow" href="#section-3.1-3.10">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-3.11">Administrative record:</dt>
          <dd id="section-3.1-3.12" style="margin-left: 1.5em">A BP administrative record is an ADU that is exchanged between the administrative elements of
   nodes' application agents for some BP administrative purpose.  The
   only administrative record defined in this specification is the
   status report, discussed later.<a class="pilcrow" href="#section-3.1-3.12">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-3.13">Bundle endpoint:</dt>
          <dd id="section-3.1-3.14" style="margin-left: 1.5em">A bundle endpoint (or simply "endpoint") is a set
   of zero or more bundle nodes that all identify themselves for BP
   purposes by some common identifier, called a "bundle endpoint ID"
   (or, in this document, simply "endpoint ID"); endpoint IDs are
   described in detail in <a class="xref" href="#sect-4.2.5.1">Section 4.2.5.1</a>.<a class="pilcrow" href="#section-3.1-3.14">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-3.15">Singleton endpoint:</dt>
          <dd id="section-3.1-3.16" style="margin-left: 1.5em">A singleton endpoint is an endpoint that always
   contains exactly one member.<a class="pilcrow" href="#section-3.1-3.16">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-3.17">Registration:</dt>
          <dd id="section-3.1-3.18" style="margin-left: 1.5em">A registration is the state machine characterizing a
   given node's membership in a given endpoint.  Any single
   registration has an associated delivery failure action as defined
   below and must at any time be in one of two states: Active or
   Passive.  Registrations are local; information about a node's
   registrations is not expected to be available at other nodes, and
   the Bundle Protocol does not include a mechanism for distributing
   information about registrations.<a class="pilcrow" href="#section-3.1-3.18">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-3.19">Delivery:</dt>
          <dd id="section-3.1-3.20" style="margin-left: 1.5em">A bundle is considered to have been delivered at a node
   subject to a registration as soon as the ADU that
   is the payload of the bundle, together with any relevant metadata
   (an implementation matter), has been presented to the node's
   application agent in a manner consistent with the state of that
   registration.<a class="pilcrow" href="#section-3.1-3.20">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-3.21">Deliverability:</dt>
          <dd id="section-3.1-3.22" style="margin-left: 1.5em">A bundle is considered "deliverable" subject to a
   registration if and only if (a) the bundle's destination endpoint is
   the endpoint with which the registration is associated, (b) the
   bundle has not yet been delivered subject to this registration, and
   (c) the bundle has not yet been "abandoned" (as defined below)
   subject to this registration.<a class="pilcrow" href="#section-3.1-3.22">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-3.23">Abandonment:</dt>
          <dd id="section-3.1-3.24" style="margin-left: 1.5em">To abandon a bundle subject to some registration is to
   assert that the bundle is not deliverable subject to that
   registration.<a class="pilcrow" href="#section-3.1-3.24">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-3.25">Delivery failure action:</dt>
          <dd id="section-3.1-3.26" style="margin-left: 1.5em">The delivery failure action of a
   registration is the action that is to be taken when a bundle that is
   "deliverable" subject to that registration is received at a time
   when the registration is in the Passive state.<a class="pilcrow" href="#section-3.1-3.26">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-3.27">Destination:</dt>
          <dd id="section-3.1-3.28" style="margin-left: 1.5em">The destination of a bundle is the endpoint comprising
   the node(s) at which the bundle is to be delivered (as defined
   above).<a class="pilcrow" href="#section-3.1-3.28">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-3.29">Transmission:</dt>
          <dd id="section-3.1-3.30" style="margin-left: 1.5em">A transmission is an attempt by a node's BPA to cause
   copies of a bundle to be delivered to one or more of the nodes that
   are members of some endpoint (the bundle's destination) in response
   to a transmission request issued by the node's application agent.<a class="pilcrow" href="#section-3.1-3.30">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-3.31">Forwarding:</dt>
          <dd id="section-3.1-3.32" style="margin-left: 1.5em">To forward a bundle to a node is to invoke the services
   of one or more CLAs in a sustained effort to cause a copy of the
   bundle to be received by that node.<a class="pilcrow" href="#section-3.1-3.32">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-3.33">Discarding:</dt>
          <dd id="section-3.1-3.34" style="margin-left: 1.5em">To discard a bundle is to cease all operations on the
   bundle and functionally erase all references to it.  The specific
   procedures by which this is accomplished are an implementation
   matter.<a class="pilcrow" href="#section-3.1-3.34">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-3.35">Retention constraint:</dt>
          <dd id="section-3.1-3.36" style="margin-left: 1.5em">A retention constraint is an element of the
   state of a bundle that prevents the bundle from being discarded.
   That is, a bundle cannot be discarded while it has any retention
   constraints.<a class="pilcrow" href="#section-3.1-3.36">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-3.37">Deletion:</dt>
          <dd id="section-3.1-3.38" style="margin-left: 1.5em">To delete a bundle is to remove unconditionally all of
   the bundle's retention constraints, enabling the bundle to be
   discarded.<a class="pilcrow" href="#section-3.1-3.38">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sect-3.2">
<section id="section-3.2">
        <h3 id="name-discussion-of-bp-concepts">
<a class="section-number selfRef" href="#section-3.2">3.2. </a><a class="section-name selfRef" href="#name-discussion-of-bp-concepts">Discussion of BP Concepts</a>
        </h3>
<p id="section-3.2-1">
   Multiple instances of the same bundle (the same unit of DTN protocol
   data) might exist concurrently in different parts of a network --
   possibly differing in some blocks -- in the memory local to one or
   more bundle nodes and/or in transit between nodes. In the context of
   the operation of a bundle node, a bundle is an instance (copy), in
   that node's local memory, of some bundle that is in the network.<a class="pilcrow" href="#section-3.2-1">¶</a></p>
<p id="section-3.2-2">
   The payload for a bundle forwarded in response to a bundle
   transmission request is the ADU whose location is
   provided as a parameter to that request. The payload for a bundle
   forwarded in response to reception of a bundle is the payload of the
   received bundle.<a class="pilcrow" href="#section-3.2-2">¶</a></p>
<p id="section-3.2-3">
   In the most familiar case, a bundle node is instantiated as a single
   process running on a general-purpose computer, but in general the
   definition is meant to be broader: a bundle node might alternatively
   be a thread, an object in an object-oriented operating system, a
   special-purpose hardware device, etc.<a class="pilcrow" href="#section-3.2-3">¶</a></p>
<p id="section-3.2-4">
   The manner in which the functions of the BPA are performed is wholly
   an implementation matter. For example, BPA functionality might be
   coded into each node individually; it might be implemented as a
   shared library that is used in common by any number of bundle nodes
   on a single computer; it might be implemented as a daemon whose
   services are invoked via inter-process or network communication by
   any number of bundle nodes on one or more computers; it might be
   implemented in hardware.<a class="pilcrow" href="#section-3.2-4">¶</a></p>
<p id="section-3.2-5">
   Every CLA implements its own thin layer of protocol, interposed
   between BP and the (usually "top") protocol(s) of the underlying
   integrated protocol stack; this "CL protocol" may only serve to
   multiplex and demultiplex bundles to and from the underlying integrated
   protocol, or it may offer additional CL-specific functionality. The
   manner in which a CLA sends and receives bundles, as well as the
   definitions of CLAs and CL protocols, are beyond the scope of this
   specification.<a class="pilcrow" href="#section-3.2-5">¶</a></p>
<p id="section-3.2-6">
   Note that the administrative element of a node's application agent
   may itself, in some cases, function as a CLA.
   That is, outgoing bundles may be "tunneled" through encapsulating
   bundles:<a class="pilcrow" href="#section-3.2-6">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-7.1">An outgoing bundle constitutes a byte array. This byte array may,
          like any other, be presented to the BPA as an
          ADU that is to be transmitted to some endpoint.<a class="pilcrow" href="#section-3.2-7.1">¶</a>
</li>
          <li class="normal" id="section-3.2-7.2">The original bundle thus forms the payload of an encapsulating
          bundle that is forwarded using some other convergence-layer
          protocol(s).<a class="pilcrow" href="#section-3.2-7.2">¶</a>
</li>
          <li class="normal" id="section-3.2-7.3">When the encapsulating bundle is received, its payload is
          delivered to the peer application agent administrative element,
          which then instructs the BPA to dispatch that
          original bundle in the usual way.<a class="pilcrow" href="#section-3.2-7.3">¶</a>
</li>
        </ul>
<p id="section-3.2-8">
   The purposes for which this technique may be useful (such as cross-domain
   security) are beyond the scope of this specification.<a class="pilcrow" href="#section-3.2-8">¶</a></p>
<p id="section-3.2-9">
   The only interface between the BPA and the application-specific
   element of the AA is the BP service interface. But between the BPA
   and the administrative element of the AA there is a (conceptual)
   private control interface in addition to the BP service interface.
   This private control interface enables the BPA and the
   administrative element of the AA to direct each other to take action
   under specific circumstances.<a class="pilcrow" href="#section-3.2-9">¶</a></p>
<p id="section-3.2-10">
   In the case of a node that serves simply as a BP "router", the AA may have
   no application-specific element at all. The application-specific elements
   of other nodes' AAs may perform arbitrarily complex application functions,
   perhaps even offering multiplexed DTN communication services to a number of
   other applications. As with the BPA, the manner in which the AA performs
   its functions is wholly an implementation matter.<a class="pilcrow" href="#section-3.2-10">¶</a></p>
<p id="section-3.2-11">
   Singletons are the most familiar sort of endpoint, but in general
   the endpoint notion is meant to be broader. For example, the nodes
   in a sensor network might constitute a set of bundle nodes that are
   all registered in a single common endpoint and will all receive any
   data delivered at that endpoint. <strong>Note</strong> too that any given bundle
   node might be registered in multiple bundle endpoints and receive
   all data delivered at each of those endpoints.<a class="pilcrow" href="#section-3.2-11">¶</a></p>
<p id="section-3.2-12">
     
   Recall that every node, by definition, includes an application agent, which
   in turn includes an administrative element, which exchanges administrative
   records with the administrative elements of other nodes.  As such, every
   node is permanently, structurally registered in the singleton endpoint at
   which administrative records received from other nodes are delivered.
   Registration in no other endpoint can ever be assumed to be permanent.
   This endpoint, termed the node's "administrative endpoint", is therefore
   uniquely and permanently associated with the node, and for this reason the
   ID of a node's administrative endpoint may always serve as the "node ID"
   (see <a class="xref" href="#sect-4.2.5.2">Section 4.2.5.2</a>) of the node.<a class="pilcrow" href="#section-3.2-12">¶</a></p>
<p id="section-3.2-13">
   The destination of every bundle is an endpoint, which may or may not
   be singleton.  The source of every bundle is a node, identified by
   node ID.  Note, though, that the source node ID asserted in a given
   bundle may be the null endpoint ID (as described later) rather than
   the ID of the source node; bundles for which the asserted source
   node ID is the null endpoint ID are termed "anonymous" bundles.<a class="pilcrow" href="#section-3.2-13">¶</a></p>
<p id="section-3.2-14">
   Any number of transmissions may be concurrently undertaken by the
   BPA of a given node.<a class="pilcrow" href="#section-3.2-14">¶</a></p>
<p id="section-3.2-15">When the BPA of a node determines that it must forward a bundle either 
   to a node that is a member of the bundle's destination endpoint or to 
   some intermediate forwarding node, the BPA invokes the services of one 
   or more CLAs in a sustained effort to cause a copy of the bundle to be 
   received by that node.<a class="pilcrow" href="#section-3.2-15">¶</a></p>
<p id="section-3.2-16">Upon reception, the processing of a bundle depends on whether or not 
   the receiving node is registered in the bundle's destination endpoint.
 If it is, and if
   the payload of the bundle is non-fragmentary (possibly as a result
   of successful payload reassembly from fragmentary payloads,
   including the original payload of the newly received bundle), then
   the bundle is normally delivered to the node's application agent
   subject to the registration characterizing the node's membership in
   the destination endpoint.<a class="pilcrow" href="#section-3.2-16">¶</a></p>
<p id="section-3.2-17">
   The Bundle Protocol itself does not ensure delivery of a bundle to
   its destination.  Data loss along the path to the destination node
   can be minimized by utilizing reliable convergence-layer protocols
   between neighbors on all segments of the end-to-end path; however, for
   end-to-end bundle delivery assurance it will be necessary to develop
   extensions to the Bundle Protocol and/or application-layer
   mechanisms.<a class="pilcrow" href="#section-3.2-17">¶</a></p>
<p id="section-3.2-18">
   The Bundle Protocol is designed for extensibility.  Bundle Protocol
   extensions, documented elsewhere, may extend this specification by
   defining additional:<a class="pilcrow" href="#section-3.2-18">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-19.1">blocks<a class="pilcrow" href="#section-3.2-19.1">¶</a>
</li>
          <li class="normal" id="section-3.2-19.2">administrative records<a class="pilcrow" href="#section-3.2-19.2">¶</a>
</li>
          <li class="normal" id="section-3.2-19.3">bundle processing control flags<a class="pilcrow" href="#section-3.2-19.3">¶</a>
</li>
          <li class="normal" id="section-3.2-19.4">block processing control flags<a class="pilcrow" href="#section-3.2-19.4">¶</a>
</li>
          <li class="normal" id="section-3.2-19.5">types of bundle status reports<a class="pilcrow" href="#section-3.2-19.5">¶</a>
</li>
          <li class="normal" id="section-3.2-19.6">bundle status report reason codes<a class="pilcrow" href="#section-3.2-19.6">¶</a>
</li>
          <li class="normal" id="section-3.2-19.7">mandates and constraints on processing that
        conformant BPAs must perform at specified points in
        the inbound and outbound bundle processing cycles<a class="pilcrow" href="#section-3.2-19.7">¶</a>
</li>
        </ul>
</section>
</div>
<div id="sect-3.3">
<section id="section-3.3">
        <h3 id="name-services-offered-by-bundle-">
<a class="section-number selfRef" href="#section-3.3">3.3. </a><a class="section-name selfRef" href="#name-services-offered-by-bundle-">Services Offered by Bundle Protocol Agents</a>
        </h3>
<p id="section-3.3-1">
   The BPA of each node is expected to provide the following services
   to the node's application agent:<a class="pilcrow" href="#section-3.3-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3-2.1">commencing a registration (registering the node in an endpoint).<a class="pilcrow" href="#section-3.3-2.1">¶</a>
</li>
          <li class="normal" id="section-3.3-2.2">terminating a registration.<a class="pilcrow" href="#section-3.3-2.2">¶</a>
</li>
          <li class="normal" id="section-3.3-2.3">switching a registration between Active and Passive states.<a class="pilcrow" href="#section-3.3-2.3">¶</a>
</li>
          <li class="normal" id="section-3.3-2.4">transmitting a bundle to an identified bundle endpoint.<a class="pilcrow" href="#section-3.3-2.4">¶</a>
</li>
          <li class="normal" id="section-3.3-2.5">canceling a transmission.<a class="pilcrow" href="#section-3.3-2.5">¶</a>
</li>
          <li class="normal" id="section-3.3-2.6">polling a registration that is in the Passive state.<a class="pilcrow" href="#section-3.3-2.6">¶</a>
</li>
          <li class="normal" id="section-3.3-2.7">delivering a received bundle.<a class="pilcrow" href="#section-3.3-2.7">¶</a>
</li>
        </ul>
<p id="section-3.3-3">   Note that the details of registration functionality are an
   implementation matter and are beyond the scope of this
   specification.<a class="pilcrow" href="#section-3.3-3">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-4">
<section id="section-4">
      <h2 id="name-bundle-format">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-bundle-format">Bundle Format</a>
      </h2>
<div id="sect-4.1">
<section id="section-4.1">
        <h3 id="name-bundle-structure">
<a class="section-number selfRef" href="#section-4.1">4.1. </a><a class="section-name selfRef" href="#name-bundle-structure">Bundle Structure</a>
        </h3>
<p id="section-4.1-1">
   The format of bundles <span class="bcp14">SHALL</span> conform to the Concise Binary Object
   Representation (CBOR) <span>[<a class="xref" href="#RFC8949">RFC8949</a>]</span>.<a class="pilcrow" href="#section-4.1-1">¶</a></p>
<p id="section-4.1-2">
   Cryptographic verification of a block is possible only if the
   sequence of octets on which the verifying node computes its hash --
   the canonicalized representation of the block -- is identical to the
   sequence of octets on which the hash declared for that block was
   computed.  To ensure that blocks are always in canonical
   representation when they are transmitted and received, the CBOR
   encodings of the values of all fields in all blocks <span class="bcp14">MUST</span>
   conform to the core deterministic encoding requirements as specified in <span>[<a class="xref" href="#RFC8949">RFC8949</a>]</span>, except that indefinite-length items are not prohibited.<a class="pilcrow" href="#section-4.1-2">¶</a></p>
<p id="section-4.1-3">
   Each bundle <span class="bcp14">SHALL</span> be a concatenated sequence of at least two blocks,
   represented as a CBOR indefinite-length array.  The first block in
   the sequence (the first item of the array) <span class="bcp14">MUST</span> be a primary bundle
   block in CBOR encoding as described below; the bundle <span class="bcp14">MUST</span>
   have exactly one primary bundle block. The primary block <span class="bcp14">MUST</span> be
   followed by one or more canonical bundle blocks (additional array
   items) in CBOR encoding as described in <a class="xref" href="#sect-4.3.2">Section 4.3.2</a>.  Every
   block following the primary block <span class="bcp14">SHALL</span> be the CBOR encoding
   of a canonical block.  The last such block <span class="bcp14">MUST</span> be a payload block;
   the bundle <span class="bcp14">MUST</span> have exactly one payload block.  The payload block
   <span class="bcp14">SHALL</span> be followed by a CBOR "break" stop code, terminating the
   array.<a class="pilcrow" href="#section-4.1-3">¶</a></p>
<aside id="section-4.1-4">
          <p id="section-4.1-4.1">
   (Note that, while CBOR permits considerable flexibility in the
   encoding of bundles, this flexibility must not be interpreted as
   inviting increased complexity in PDU structure.)<a class="pilcrow" href="#section-4.1-4.1">¶</a></p>
</aside>
<p id="section-4.1-5">
   Associated with each block of a bundle is a block number.  The block
   number uniquely identifies the block within the bundle, enabling
   blocks (notably Bundle Protocol Security blocks) to reference other
   blocks in the same bundle without ambiguity.  The block number of
   the primary block is implicitly zero; the block numbers of all other
   blocks are explicitly stated in block headers as noted below. Block
   numbering is unrelated to the order in which blocks are sequenced in
   the bundle. The block number of the payload block is always 1.<a class="pilcrow" href="#section-4.1-5">¶</a></p>
<p id="section-4.1-6">
   An implementation of the Bundle Protocol <span class="bcp14">MAY</span> discard any sequence of
   bytes that does not conform to the Bundle Protocol specification.<a class="pilcrow" href="#section-4.1-6">¶</a></p>
<p id="section-4.1-7">
   An implementation of the Bundle Protocol <span class="bcp14">MAY</span> accept a sequence of
   bytes that does not conform to the Bundle Protocol specification
   (e.g., one that represents data elements in fixed-length arrays
   rather than indefinite-length arrays) and transform it into
   conformant BP structure before processing it.  Procedures for
   accomplishing such a transformation are beyond the scope of this
   specification.<a class="pilcrow" href="#section-4.1-7">¶</a></p>
</section>
</div>
<div id="sect-4.2">
<section id="section-4.2">
        <h3 id="name-bp-fundamental-data-structu">
<a class="section-number selfRef" href="#section-4.2">4.2. </a><a class="section-name selfRef" href="#name-bp-fundamental-data-structu">BP Fundamental Data Structures</a>
        </h3>
<div id="sect-4.2.1">
<section id="section-4.2.1">
          <h4 id="name-crc-type">
<a class="section-number selfRef" href="#section-4.2.1">4.2.1. </a><a class="section-name selfRef" href="#name-crc-type">CRC Type</a>
          </h4>
<p id="section-4.2.1-1">
   CRC type is an unsigned integer type code for which the following
   values (and no others) are valid:<a class="pilcrow" href="#section-4.2.1-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.1-2.1">0 indicates "no Cyclic Redundancy Check (CRC) is present."<a class="pilcrow" href="#section-4.2.1-2.1">¶</a>
</li>
            <li class="normal" id="section-4.2.1-2.2">1 indicates "a standard X-25 CRC-16 is present." <span>[<a class="xref" href="#CRC16">CRC16</a>]</span><a class="pilcrow" href="#section-4.2.1-2.2">¶</a>
</li>
            <li class="normal" id="section-4.2.1-2.3">2 indicates "a standard CRC32C (Castagnoli) CRC-32 is present."
        <span>[<a class="xref" href="#RFC4960">RFC4960</a>]</span><a class="pilcrow" href="#section-4.2.1-2.3">¶</a>
</li>
          </ul>
<p id="section-4.2.1-3">
   CRC type <span class="bcp14">SHALL</span> be represented as a CBOR unsigned integer.<a class="pilcrow" href="#section-4.2.1-3">¶</a></p>
<p id="section-4.2.1-4">
   For examples of CRC32C CRCs, see <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc7143#appendix-A.4">Appendix A.4</a> of [<a class="xref" href="#RFC7143">RFC7143</a>]</span>.<a class="pilcrow" href="#section-4.2.1-4">¶</a></p>
<p id="section-4.2.1-5">
   Note that more robust protection of BP data integrity, as needed,
   may be provided by means of Block Integrity Blocks (BIBs) as defined in the
   Bundle Protocol Security specification <span>[<a class="xref" href="#RFC9172">BPSEC</a>]</span>.<a class="pilcrow" href="#section-4.2.1-5">¶</a></p>
</section>
</div>
<div id="sect-4.2.2">
<section id="section-4.2.2">
          <h4 id="name-crc">
<a class="section-number selfRef" href="#section-4.2.2">4.2.2. </a><a class="section-name selfRef" href="#name-crc">CRC</a>
          </h4>
<p id="section-4.2.2-1">
   The CRC <span class="bcp14">SHALL</span> be omitted from a block if and only if the block's CRC
   type code is zero.<a class="pilcrow" href="#section-4.2.2-1">¶</a></p>
<p id="section-4.2.2-2">
   When not omitted, the CRC <span class="bcp14">SHALL</span> be represented as a CBOR byte string
   of two bytes (that is, CBOR additional information 2, if CRC type is
   1) or of four bytes (that is, CBOR additional information 4, if CRC
   type is 2); in each case, the sequence of bytes <span class="bcp14">SHALL</span> constitute an
   unsigned integer value (of 16 or 32 bits, respectively) in network
   byte order.<a class="pilcrow" href="#section-4.2.2-2">¶</a></p>
</section>
</div>
<div id="sect-4.2.3">
<section id="section-4.2.3">
          <h4 id="name-bundle-processing-control-f">
<a class="section-number selfRef" href="#section-4.2.3">4.2.3. </a><a class="section-name selfRef" href="#name-bundle-processing-control-f">Bundle Processing Control Flags</a>
          </h4>
<p id="section-4.2.3-1">
   Bundle processing control flags assert properties of the bundle as a
   whole rather than of any particular block of the bundle.  They are
   conveyed in the primary block of the bundle.<a class="pilcrow" href="#section-4.2.3-1">¶</a></p>
<p id="section-4.2.3-2">
   The following properties are asserted by the bundle processing
   control flags:<a class="pilcrow" href="#section-4.2.3-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.3-3.1">The bundle is a fragment.  (Boolean)<a class="pilcrow" href="#section-4.2.3-3.1">¶</a>
</li>
            <li class="normal" id="section-4.2.3-3.2">The bundle's payload is an administrative record.  (Boolean)<a class="pilcrow" href="#section-4.2.3-3.2">¶</a>
</li>
            <li class="normal" id="section-4.2.3-3.3">The bundle must not be fragmented.  (Boolean)<a class="pilcrow" href="#section-4.2.3-3.3">¶</a>
</li>
            <li class="normal" id="section-4.2.3-3.4">Acknowledgment by the user application is requested.  (Boolean)<a class="pilcrow" href="#section-4.2.3-3.4">¶</a>
</li>
            <li class="normal" id="section-4.2.3-3.5">Status time is requested in all status reports.  (Boolean)<a class="pilcrow" href="#section-4.2.3-3.5">¶</a>
</li>
            <li class="normal" id="section-4.2.3-3.6">
              <p id="section-4.2.3-3.6.1">Flags requesting types of status reports (all Boolean):<a class="pilcrow" href="#section-4.2.3-3.6.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.3-3.6.2.1">Request reporting of bundle reception.<a class="pilcrow" href="#section-4.2.3-3.6.2.1">¶</a>
</li>
                <li class="normal" id="section-4.2.3-3.6.2.2">Request reporting of bundle forwarding.<a class="pilcrow" href="#section-4.2.3-3.6.2.2">¶</a>
</li>
                <li class="normal" id="section-4.2.3-3.6.2.3">Request reporting of bundle delivery.<a class="pilcrow" href="#section-4.2.3-3.6.2.3">¶</a>
</li>
                <li class="normal" id="section-4.2.3-3.6.2.4">Request reporting of bundle deletion.<a class="pilcrow" href="#section-4.2.3-3.6.2.4">¶</a>
</li>
              </ul>
</li>
          </ul>
<p id="section-4.2.3-4">
   If the bundle processing control flags indicate that the bundle's
   ADU is an administrative record, then all status
   report request flag values <span class="bcp14">MUST</span> be zero.<a class="pilcrow" href="#section-4.2.3-4">¶</a></p>
<p id="section-4.2.3-5">
   If the bundle's source node is omitted (i.e., the source node ID is the ID
   of the null endpoint, which has no members as discussed below; this option
   enables anonymous bundle transmission), then the bundle is not uniquely
   identifiable and all Bundle Protocol features that rely on bundle identity
   must therefore be disabled: the "Bundle must not be fragmented" flag value
   <span class="bcp14">MUST</span> be 1, and all status report request flag values <span class="bcp14">MUST</span> be zero.<a class="pilcrow" href="#section-4.2.3-5">¶</a></p>
<p id="section-4.2.3-6">
   Bundle processing control flags that are unrecognized <span class="bcp14">MUST</span> be
   ignored, as future definitions of additional flags might not be
   integrated simultaneously into the Bundle Protocol implementations
   operating at all nodes.<a class="pilcrow" href="#section-4.2.3-6">¶</a></p>
<p id="section-4.2.3-7">
   The bundle processing control flags <span class="bcp14">SHALL</span> be represented as a CBOR
   unsigned integer item, the value of which <span class="bcp14">SHALL</span> be processed as a
   bit field indicating the control flag values as follows (note that
   bit numbering in this instance is reversed from the usual practice,
   beginning with the low-order bit instead of the high-order bit, in
   recognition of the potential definition of additional control flag
   values in the future):<a class="pilcrow" href="#section-4.2.3-7">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.2.3-8">
            <dt id="section-4.2.3-8.1">Bit 0 (the low-order bit, 0x000001):</dt>
            <dd id="section-4.2.3-8.2" style="margin-left: 1.5em">Bundle is a fragment.<a class="pilcrow" href="#section-4.2.3-8.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.2.3-8.3">Bit 1 (0x000002):</dt>
            <dd id="section-4.2.3-8.4" style="margin-left: 1.5em">ADU is an administrative record.<a class="pilcrow" href="#section-4.2.3-8.4">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.2.3-8.5">Bit 2 (0x000004):</dt>
            <dd id="section-4.2.3-8.6" style="margin-left: 1.5em">Bundle must not be fragmented.<a class="pilcrow" href="#section-4.2.3-8.6">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.2.3-8.7">Bit 3 (0x000008):</dt>
            <dd id="section-4.2.3-8.8" style="margin-left: 1.5em">Reserved.<a class="pilcrow" href="#section-4.2.3-8.8">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.2.3-8.9">Bit 4 (0x000010):</dt>
            <dd id="section-4.2.3-8.10" style="margin-left: 1.5em">Reserved.<a class="pilcrow" href="#section-4.2.3-8.10">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.2.3-8.11">Bit 5 (0x000020):</dt>
            <dd id="section-4.2.3-8.12" style="margin-left: 1.5em">Acknowledgement by application is requested.<a class="pilcrow" href="#section-4.2.3-8.12">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.2.3-8.13">Bit 6 (0x000040):</dt>
            <dd id="section-4.2.3-8.14" style="margin-left: 1.5em">Status time requested in reports.<a class="pilcrow" href="#section-4.2.3-8.14">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.2.3-8.15">Bit 7 (0x000080):</dt>
            <dd id="section-4.2.3-8.16" style="margin-left: 1.5em">Reserved.<a class="pilcrow" href="#section-4.2.3-8.16">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.2.3-8.17">Bit 8 (0x000100):</dt>
            <dd id="section-4.2.3-8.18" style="margin-left: 1.5em">Reserved.<a class="pilcrow" href="#section-4.2.3-8.18">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.2.3-8.19">Bit 9 (0x000200):</dt>
            <dd id="section-4.2.3-8.20" style="margin-left: 1.5em">Reserved.<a class="pilcrow" href="#section-4.2.3-8.20">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.2.3-8.21">Bit 10 (0x000400):</dt>
            <dd id="section-4.2.3-8.22" style="margin-left: 1.5em">Reserved.<a class="pilcrow" href="#section-4.2.3-8.22">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.2.3-8.23">Bit 11 (0x000800):</dt>
            <dd id="section-4.2.3-8.24" style="margin-left: 1.5em">Reserved.<a class="pilcrow" href="#section-4.2.3-8.24">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.2.3-8.25">Bit 12 (0x001000):</dt>
            <dd id="section-4.2.3-8.26" style="margin-left: 1.5em">Reserved.<a class="pilcrow" href="#section-4.2.3-8.26">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.2.3-8.27">Bit 13 (0x002000):</dt>
            <dd id="section-4.2.3-8.28" style="margin-left: 1.5em">Reserved.<a class="pilcrow" href="#section-4.2.3-8.28">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.2.3-8.29">Bit 14 (0x004000):</dt>
            <dd id="section-4.2.3-8.30" style="margin-left: 1.5em">Request reporting of bundle reception.<a class="pilcrow" href="#section-4.2.3-8.30">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.2.3-8.31">Bit 15 (0x008000):</dt>
            <dd id="section-4.2.3-8.32" style="margin-left: 1.5em">Reserved.<a class="pilcrow" href="#section-4.2.3-8.32">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.2.3-8.33">Bit 16 (0x010000):</dt>
            <dd id="section-4.2.3-8.34" style="margin-left: 1.5em">Request reporting of bundle forwarding.<a class="pilcrow" href="#section-4.2.3-8.34">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.2.3-8.35">Bit 17 (0x020000):</dt>
            <dd id="section-4.2.3-8.36" style="margin-left: 1.5em">Request reporting of bundle delivery.<a class="pilcrow" href="#section-4.2.3-8.36">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.2.3-8.37">Bit 18 (0x040000):</dt>
            <dd id="section-4.2.3-8.38" style="margin-left: 1.5em">Request reporting of bundle deletion.<a class="pilcrow" href="#section-4.2.3-8.38">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.2.3-8.39">Bits 19-20:</dt>
            <dd id="section-4.2.3-8.40" style="margin-left: 1.5em">Reserved.<a class="pilcrow" href="#section-4.2.3-8.40">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.2.3-8.41">Bits 21-63:</dt>
            <dd id="section-4.2.3-8.42" style="margin-left: 1.5em">Unassigned.<a class="pilcrow" href="#section-4.2.3-8.42">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sect-4.2.4">
<section id="section-4.2.4">
          <h4 id="name-block-processing-control-fl">
<a class="section-number selfRef" href="#section-4.2.4">4.2.4. </a><a class="section-name selfRef" href="#name-block-processing-control-fl">Block Processing Control Flags</a>
          </h4>
<p id="section-4.2.4-1">
   The block processing control flags assert properties of canonical
   bundle blocks.  They are conveyed in the header of the block to
   which they pertain.<a class="pilcrow" href="#section-4.2.4-1">¶</a></p>
<p id="section-4.2.4-2">
   Block processing control flags that are unrecognized <span class="bcp14">MUST</span> be
   ignored, as future definitions of additional flags might not be
   integrated simultaneously into the Bundle Protocol implementations
   operating at all nodes.<a class="pilcrow" href="#section-4.2.4-2">¶</a></p>
<p id="section-4.2.4-3">
   The block processing control flags <span class="bcp14">SHALL</span> be represented as a CBOR
   unsigned integer item, the value of which <span class="bcp14">SHALL</span> be processed as a
   bit field indicating the control flag values as follows (note that
   bit numbering in this instance is reversed from the usual practice,
   beginning with the low-order bit instead of the high-order bit, for
   agreement with the bit numbering of the bundle processing control
   flags):<a class="pilcrow" href="#section-4.2.4-3">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.2.4-4">
            <dt id="section-4.2.4-4.1">Bit 0 (the low-order bit, 0x01):</dt>
            <dd id="section-4.2.4-4.2" style="margin-left: 1.5em">Block must be replicated in every fragment.<a class="pilcrow" href="#section-4.2.4-4.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.2.4-4.3">Bit 1 (0x02):</dt>
            <dd id="section-4.2.4-4.4" style="margin-left: 1.5em">Transmit status report if block can't be processed.<a class="pilcrow" href="#section-4.2.4-4.4">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.2.4-4.5">Bit 2 (0x04):</dt>
            <dd id="section-4.2.4-4.6" style="margin-left: 1.5em">Delete bundle if block can't be processed.<a class="pilcrow" href="#section-4.2.4-4.6">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.2.4-4.7">Bit 3 (0x08):</dt>
            <dd id="section-4.2.4-4.8" style="margin-left: 1.5em">Reserved.<a class="pilcrow" href="#section-4.2.4-4.8">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.2.4-4.9">Bit 4 (0x10):</dt>
            <dd id="section-4.2.4-4.10" style="margin-left: 1.5em">Discard block if it can't be processed.<a class="pilcrow" href="#section-4.2.4-4.10">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.2.4-4.11">Bit 5 (0x20):</dt>
            <dd id="section-4.2.4-4.12" style="margin-left: 1.5em">Reserved.<a class="pilcrow" href="#section-4.2.4-4.12">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.2.4-4.13">Bit 6 (0x40):</dt>
            <dd id="section-4.2.4-4.14" style="margin-left: 1.5em">Reserved.<a class="pilcrow" href="#section-4.2.4-4.14">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.2.4-4.15">Bits 7-63:</dt>
            <dd id="section-4.2.4-4.16" style="margin-left: 1.5em">Unassigned.<a class="pilcrow" href="#section-4.2.4-4.16">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-4.2.4-5">
   For each bundle whose bundle processing control flags indicate that
   the bundle's ADU is an administrative record, or
   whose source node ID is the null endpoint ID as defined below, the
   value of the "Transmit status report if block can't be processed"
   flag in every canonical block of the bundle <span class="bcp14">MUST</span> be zero.<a class="pilcrow" href="#section-4.2.4-5">¶</a></p>
</section>
</div>
<div id="sect-4.2.5">
<section id="section-4.2.5">
          <h4 id="name-identifiers">
<a class="section-number selfRef" href="#section-4.2.5">4.2.5. </a><a class="section-name selfRef" href="#name-identifiers">Identifiers</a>
          </h4>
<div id="sect-4.2.5.1">
<section id="section-4.2.5.1">
            <h5 id="name-endpoint-id">
<a class="section-number selfRef" href="#section-4.2.5.1">4.2.5.1. </a><a class="section-name selfRef" href="#name-endpoint-id">Endpoint ID</a>
            </h5>
<p id="section-4.2.5.1-1">
   The destinations of bundles are bundle endpoints, identified by text
   strings termed "endpoint IDs" (see <a class="xref" href="#sect-3.1">Section 3.1</a>). Each endpoint ID
   (EID) is a Uniform Resource Identifier <span>[<a class="xref" href="#RFC3986">URI</a>]</span>. As such, each
   endpoint ID can be characterized as having this general structure:<a class="pilcrow" href="#section-4.2.5.1-1">¶</a></p>
<p id="section-4.2.5.1-2">
   &lt; scheme name &gt; : &lt; scheme-specific part, or "SSP" &gt;<a class="pilcrow" href="#section-4.2.5.1-2">¶</a></p>
<p id="section-4.2.5.1-3">
   The scheme identified by the &lt; scheme name &gt; in an endpoint ID is a
   set of syntactic and semantic rules that fully explain how to parse
   and interpret the scheme-specific part (SSP). Each scheme that may be used to form a BP
   endpoint ID must be added to the "Bundle Protocol URI Scheme Types" registry,
   maintained by IANA as described in <a class="xref" href="#sect-9.6">Section 9.6</a>;
   association of a unique URI scheme code number with each scheme name
   in this registry helps to enable compact representation of endpoint
   IDs in bundle blocks.  Note that the set of allowable schemes is
   effectively unlimited. Any scheme conforming to <span>[<a class="xref" href="#RFC7595">URIREG</a>]</span> may be
   added to the registry of URI scheme code numbers and thereupon used in a
   Bundle Protocol endpoint ID.<a class="pilcrow" href="#section-4.2.5.1-3">¶</a></p>
<p id="section-4.2.5.1-4">
   Each entry in the registry of URI scheme code numbers <span class="bcp14">MUST</span> contain a
   reference to a scheme code number definition document, which defines
   the manner in which the scheme-specific part of any URI formed in
   that scheme is parsed and interpreted and <span class="bcp14">MUST</span> be CBOR encoded for transmission as a BP endpoint ID.  The scheme
   code number definition document may also contain information as to
   (a) which convergence-layer protocol(s) may be used to forward a
   bundle to a BP destination endpoint identified by such an ID and
   (b) how the ID of the convergence-layer protocol endpoint to use for
   that purpose can be inferred from that destination endpoint ID.<a class="pilcrow" href="#section-4.2.5.1-4">¶</a></p>
<p id="section-4.2.5.1-5">
   Note that, although endpoint IDs are URIs, implementations of the BP
   service interface may support expression of endpoint IDs in some
   internationalized manner (e.g., Internationalized Resource
   Identifiers (IRIs); see <span>[<a class="xref" href="#RFC3987">RFC3987</a>]</span>).<a class="pilcrow" href="#section-4.2.5.1-5">¶</a></p>
<p id="section-4.2.5.1-6">
   Each BP endpoint ID (EID) <span class="bcp14">SHALL</span> be represented as a CBOR array
   comprising two items.<a class="pilcrow" href="#section-4.2.5.1-6">¶</a></p>
<p id="section-4.2.5.1-7">
   The first item of the array <span class="bcp14">SHALL</span> be the code number identifying the
   endpoint ID's URI scheme, as defined in the registry of URI scheme
   code numbers for the Bundle Protocol.  Each URI scheme code number <span class="bcp14">SHALL</span>
   be represented as a CBOR unsigned integer.<a class="pilcrow" href="#section-4.2.5.1-7">¶</a></p>
<p id="section-4.2.5.1-8">
   The second item of the array <span class="bcp14">SHALL</span> be the applicable CBOR
   encoding of the scheme-specific part of the EID, defined
   as noted in the references(s) for the URI scheme code number 
   registry entry for the EID's URI scheme.<a class="pilcrow" href="#section-4.2.5.1-8">¶</a></p>
<div id="sect-4.2.5.1.1">
<section id="section-4.2.5.1.1">
              <h6 id="name-the-dtn-uri-scheme">
<a class="section-number selfRef" href="#section-4.2.5.1.1">4.2.5.1.1. </a><a class="section-name selfRef" href="#name-the-dtn-uri-scheme">The dtn URI Scheme</a>
              </h6>
<p id="section-4.2.5.1.1-1">
   The "dtn" scheme supports the identification of BP endpoints by
   arbitrarily expressive character strings.  It is specified as
   follows:<a class="pilcrow" href="#section-4.2.5.1.1-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.2.5.1.1-2">
                <dt id="section-4.2.5.1.1-2.1">Scheme syntax:</dt>
                <dd id="section-4.2.5.1.1-2.2" style="margin-left: 1.5em">This specification uses the Augmented Backus-Naur
  Form (ABNF) notation of <span>[<a class="xref" href="#RFC5234">RFC5234</a>]</span>.<a class="pilcrow" href="#section-4.2.5.1.1-2.2">¶</a>
</dd>
              <dd class="break"></dd>
</dl>
<div id="section-4.2.5.1.1-3">
<pre class="lang-abnf sourcecode">dtn-uri = "dtn:" ("none" / dtn-hier-part)

dtn-hier-part = "//" node-name name-delim demux ; a path-rootless

node-name = reg-name

name-delim = "/"

demux = *VCHAR
</pre><a class="pilcrow" href="#section-4.2.5.1.1-3">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.2.5.1.1-4">
                <dt id="section-4.2.5.1.1-4.1">Scheme semantics:</dt>
                <dd id="section-4.2.5.1.1-4.2" style="margin-left: 1.5em">URIs of the dtn scheme are used as endpoint
   identifiers in the Delay-Tolerant Networking (DTN) Bundle Protocol
   (BP) as described in the present document.<a class="pilcrow" href="#section-4.2.5.1.1-4.2">¶</a>
</dd>
              <dd class="break"></dd>
</dl>
<p id="section-4.2.5.1.1-5">
   The endpoint ID "dtn:none" identifies the "null endpoint", the
   endpoint that by definition never has any members.<a class="pilcrow" href="#section-4.2.5.1.1-5">¶</a></p>
<p id="section-4.2.5.1.1-6">
   All BP endpoints identified by all other dtn-scheme endpoint IDs for which
   the first character of demux is a character other than '~' (tilde) are
   singleton endpoints. All BP endpoints identified by dtn-scheme endpoint IDs
   for which the first character <strong>is</strong> '~' (tilde) are <strong>not</strong> singleton
   endpoints.<a class="pilcrow" href="#section-4.2.5.1.1-6">¶</a></p>
<p id="section-4.2.5.1.1-7">
   A dtn-scheme endpoint ID for which the demux is of length zero <span class="bcp14">MAY</span>
   identify the administrative endpoint for the node identified by
   node-name, and as such may serve as a node ID.  No dtn-scheme
   endpoint ID for which the demux is of non-zero length may do so.<a class="pilcrow" href="#section-4.2.5.1.1-7">¶</a></p>
<p id="section-4.2.5.1.1-8">
   Note that these syntactic rules impose constraints on dtn-scheme
   endpoint IDs that were not imposed by the original specification of
   the dtn scheme as provided in <span>[<a class="xref" href="#RFC5050">RFC5050</a>]</span>.  It is believed that the
   dtn-scheme endpoint IDs employed by BP applications conforming to
   <span>[<a class="xref" href="#RFC5050">RFC5050</a>]</span> are in most cases unlikely to be in violation of these
   rules, but the developers of such applications are advised of the
   potential for compromised interoperation.<a class="pilcrow" href="#section-4.2.5.1.1-8">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.2.5.1.1-9">
                <dt id="section-4.2.5.1.1-9.1">Encoding considerations:</dt>
                <dd id="section-4.2.5.1.1-9.2" style="margin-left: 1.5em">For transmission as a BP endpoint ID, the 
   scheme-specific part of a URI of the dtn scheme <span class="bcp14">SHALL</span> be represented
   as a CBOR text string unless the EID's SSP is "none", in which case
   the SSP <span class="bcp14">SHALL</span> be represented as a CBOR unsigned integer with the
   value zero.  For all other purposes, URIs of the dtn scheme are
   encoded exclusively in US-ASCII characters.<a class="pilcrow" href="#section-4.2.5.1.1-9.2">¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-4.2.5.1.1-9.3">Interoperability considerations:</dt>
                <dd id="section-4.2.5.1.1-9.4" style="margin-left: 1.5em">None.<a class="pilcrow" href="#section-4.2.5.1.1-9.4">¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-4.2.5.1.1-9.5">Security considerations:</dt>
                <dd id="section-4.2.5.1.1-9.6" style="margin-left: 1.5em">
                  <p id="section-4.2.5.1.1-9.6.1"><br/></p>
<span class="break"></span><dl class="dlParallel" id="section-4.2.5.1.1-9.6.2">
                    <dt id="section-4.2.5.1.1-9.6.2.1">Reliability and consistency:</dt>
                    <dd id="section-4.2.5.1.1-9.6.2.2" style="margin-left: 1.5em">None of the BP endpoints identified by the
   URIs of the dtn scheme are guaranteed to be reachable at any time, and the
   identity of the processing entities operating on those endpoints is never
   guaranteed by the Bundle Protocol itself. Verification of the signature provided by the Block Integrity Block targeting the bundle's primary block, as defined by Bundle Protocol Security <span>[<a class="xref" href="#RFC9172">BPSEC</a>]</span>, is required for this purpose.<a class="pilcrow" href="#section-4.2.5.1.1-9.6.2.2">¶</a>
</dd>
                    <dd class="break"></dd>
<dt id="section-4.2.5.1.1-9.6.2.3">Malicious construction:</dt>
                    <dd id="section-4.2.5.1.1-9.6.2.4" style="margin-left: 1.5em">Malicious construction of a conformant
   dtn-scheme URI is limited to the malicious selection of node names and the
   malicious selection of demux strings.  That is, a maliciously constructed
   dtn-scheme URI could be used to direct a bundle to an endpoint that might
   be damaged by the arrival of that bundle or, alternatively, to declare a
   false source for a bundle and thereby cause incorrect processing at a node
   that receives the bundle.  In both cases (and indeed in all bundle
   processing), the node that receives a bundle should verify its authenticity
   and validity before operating on it in any way.<a class="pilcrow" href="#section-4.2.5.1.1-9.6.2.4">¶</a>
</dd>
                    <dd class="break"></dd>
<dt id="section-4.2.5.1.1-9.6.2.5">Back-end transcoding:</dt>
                    <dd id="section-4.2.5.1.1-9.6.2.6" style="margin-left: 1.5em">The limited expressiveness of URIs of the dtn
   scheme effectively eliminates the possibility of threat due to errors in
   back-end transcoding.<a class="pilcrow" href="#section-4.2.5.1.1-9.6.2.6">¶</a>
</dd>
                    <dd class="break"></dd>
<dt id="section-4.2.5.1.1-9.6.2.7">Rare IP address formats:</dt>
                    <dd id="section-4.2.5.1.1-9.6.2.8" style="margin-left: 1.5em">Not relevant, as IP addresses do not appear
   anywhere in conformant dtn-scheme URIs.<a class="pilcrow" href="#section-4.2.5.1.1-9.6.2.8">¶</a>
</dd>
                    <dd class="break"></dd>
<dt id="section-4.2.5.1.1-9.6.2.9">Sensitive information:</dt>
                    <dd id="section-4.2.5.1.1-9.6.2.10" style="margin-left: 1.5em">Because dtn-scheme URIs are used only to
   represent the identities of Bundle Protocol endpoints, the risk of
   disclosure of sensitive information due to interception of these URIs is
   minimal.  Examination of dtn-scheme URIs could be used to support traffic
   analysis; where traffic analysis is a plausible danger, bundles should be
   conveyed by secure convergence-layer protocols that do not expose endpoint
   IDs.<a class="pilcrow" href="#section-4.2.5.1.1-9.6.2.10">¶</a>
</dd>
                    <dd class="break"></dd>
<dt id="section-4.2.5.1.1-9.6.2.11">Semantic attacks:</dt>
                    <dd id="section-4.2.5.1.1-9.6.2.12" style="margin-left: 1.5em">The simplicity of dtn-scheme URI syntax minimizes the
   possibility of misinterpretation of a URI by a human user.<a class="pilcrow" href="#section-4.2.5.1.1-9.6.2.12">¶</a>
</dd>
                  <dd class="break"></dd>
</dl>
</dd>
              <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sect-4.2.5.1.2">
<section id="section-4.2.5.1.2">
              <h6 id="name-the-ipn-uri-scheme">
<a class="section-number selfRef" href="#section-4.2.5.1.2">4.2.5.1.2. </a><a class="section-name selfRef" href="#name-the-ipn-uri-scheme">The ipn URI Scheme</a>
              </h6>
<p id="section-4.2.5.1.2-1">
   The "ipn" scheme supports the identification of BP endpoints by
   pairs of unsigned integers, for compact representation in bundle
   blocks.  It is specified as follows:<a class="pilcrow" href="#section-4.2.5.1.2-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.2.5.1.2-2">
                <dt id="section-4.2.5.1.2-2.1">Scheme syntax:</dt>
                <dd id="section-4.2.5.1.2-2.2" style="margin-left: 1.5em">This specification uses the Augmented Backus-Naur
   Form (ABNF) notation of <span>[<a class="xref" href="#RFC5234">RFC5234</a>]</span>, including the core ABNF syntax
   rule for DIGIT defined by that specification.<a class="pilcrow" href="#section-4.2.5.1.2-2.2">¶</a>
</dd>
              <dd class="break"></dd>
</dl>
<div id="section-4.2.5.1.2-3">
<pre class="lang-abnf sourcecode">ipn-uri = "ipn:" ipn-hier-part

ipn-hier-part = node-nbr nbr-delim service-nbr ; a path-rootless

node-nbr = 1*DIGIT

nbr-delim = "."

service-nbr = 1*DIGIT
</pre><a class="pilcrow" href="#section-4.2.5.1.2-3">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.2.5.1.2-4">
                <dt id="section-4.2.5.1.2-4.1">Scheme semantics:</dt>
                <dd id="section-4.2.5.1.2-4.2" style="margin-left: 1.5em">URIs of the ipn scheme are used as endpoint
   identifiers in the Delay-Tolerant Networking (DTN) Bundle Protocol
   (BP) as described in the present document.<a class="pilcrow" href="#section-4.2.5.1.2-4.2">¶</a>
</dd>
              <dd class="break"></dd>
</dl>
<p id="section-4.2.5.1.2-5">
   All BP endpoints identified by ipn-scheme endpoint IDs are singleton
   endpoints.<a class="pilcrow" href="#section-4.2.5.1.2-5">¶</a></p>
<p id="section-4.2.5.1.2-6">
   An ipn-scheme endpoint ID for which service-nbr is zero <span class="bcp14">MAY</span> identify
   the administrative endpoint for the node identified by node-nbr, and
   as such may serve as a node ID.  No ipn-scheme endpoint ID for which
   service-nbr is non-zero may do so.<a class="pilcrow" href="#section-4.2.5.1.2-6">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.2.5.1.2-7">
                <dt id="section-4.2.5.1.2-7.1">Encoding considerations:</dt>
                <dd id="section-4.2.5.1.2-7.2" style="margin-left: 1.5em">For transmission as a BP endpoint ID, the
   scheme-specific part of a URI of the ipn scheme <span class="bcp14">SHALL</span> be
   represented as a CBOR array comprising two items.  The first item of
   this array <span class="bcp14">SHALL</span> be the EID's node number (a number that identifies
   the node) represented as a CBOR unsigned integer.  The second item
   of this array <span class="bcp14">SHALL</span> be the EID's service number (a number that
   identifies some application service) represented as a CBOR unsigned
   integer.  For all other purposes, URIs of the ipn scheme are encoded
   exclusively in US-ASCII characters.<a class="pilcrow" href="#section-4.2.5.1.2-7.2">¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-4.2.5.1.2-7.3">Interoperability considerations:</dt>
                <dd id="section-4.2.5.1.2-7.4" style="margin-left: 1.5em">None.<a class="pilcrow" href="#section-4.2.5.1.2-7.4">¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-4.2.5.1.2-7.5">Security considerations:</dt>
                <dd id="section-4.2.5.1.2-7.6" style="margin-left: 1.5em">
                  <p id="section-4.2.5.1.2-7.6.1"><br/></p>
<span class="break"></span><dl class="dlParallel" id="section-4.2.5.1.2-7.6.2">
                    <dt id="section-4.2.5.1.2-7.6.2.1">Reliability and consistency:</dt>
                    <dd id="section-4.2.5.1.2-7.6.2.2" style="margin-left: 1.5em">None of the BP endpoints identified by the
   URIs of the ipn scheme are guaranteed to be reachable at any time, and the
   identity of the processing entities operating on those endpoints is never
   guaranteed by the Bundle Protocol itself. Verification of the signature provided by the Block Integrity Block targeting the bundle's primary block, as defined by Bundle Protocol Security <span>[<a class="xref" href="#RFC9172">BPSEC</a>]</span>, is
   required for this purpose.<a class="pilcrow" href="#section-4.2.5.1.2-7.6.2.2">¶</a>
</dd>
                    <dd class="break"></dd>
<dt id="section-4.2.5.1.2-7.6.2.3">Malicious construction:</dt>
                    <dd id="section-4.2.5.1.2-7.6.2.4" style="margin-left: 1.5em">Malicious construction of a conformant
   ipn-scheme URI is limited to the malicious selection of node numbers and
   the malicious selection of service numbers.  That is, a maliciously
   constructed ipn-scheme URI could be used to direct a bundle to an endpoint
   that might be damaged by the arrival of that bundle or, alternatively, to
   declare a false source for a bundle and thereby cause incorrect processing
   at a node that receives the bundle.  In both cases (and indeed in all
   bundle processing), the node that receives a bundle should verify its
   authenticity and validity before operating on it in any way.<a class="pilcrow" href="#section-4.2.5.1.2-7.6.2.4">¶</a>
</dd>
                    <dd class="break"></dd>
<dt id="section-4.2.5.1.2-7.6.2.5">Back-end transcoding:</dt>
                    <dd id="section-4.2.5.1.2-7.6.2.6" style="margin-left: 1.5em">The limited expressiveness of URIs of the ipn
   scheme effectively eliminates the possibility of threat due to errors in
   back-end transcoding.<a class="pilcrow" href="#section-4.2.5.1.2-7.6.2.6">¶</a>
</dd>
                    <dd class="break"></dd>
<dt id="section-4.2.5.1.2-7.6.2.7">Rare IP address formats:</dt>
                    <dd id="section-4.2.5.1.2-7.6.2.8" style="margin-left: 1.5em">Not relevant, as IP addresses do not appear
   anywhere in conformant ipn-scheme URIs.<a class="pilcrow" href="#section-4.2.5.1.2-7.6.2.8">¶</a>
</dd>
                    <dd class="break"></dd>
<dt id="section-4.2.5.1.2-7.6.2.9">Sensitive information:</dt>
                    <dd id="section-4.2.5.1.2-7.6.2.10" style="margin-left: 1.5em">Because ipn-scheme URIs are used only to
   represent the identities of Bundle Protocol endpoints, the risk of
   disclosure of sensitive information due to interception of these URIs is
   minimal.  Examination of ipn-scheme URIs could be used to support traffic
   analysis; where traffic analysis is a plausible danger, bundles should be
   conveyed by secure convergence-layer protocols that do not expose endpoint
   IDs.<a class="pilcrow" href="#section-4.2.5.1.2-7.6.2.10">¶</a>
</dd>
                    <dd class="break"></dd>
<dt id="section-4.2.5.1.2-7.6.2.11">Semantic attacks:</dt>
                    <dd id="section-4.2.5.1.2-7.6.2.12" style="margin-left: 1.5em">The simplicity of ipn-scheme URI syntax minimizes the
   possibility of misinterpretation of a URI by a human user.<a class="pilcrow" href="#section-4.2.5.1.2-7.6.2.12">¶</a>
</dd>
                  <dd class="break"></dd>
</dl>
</dd>
              <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="sect-4.2.5.2">
<section id="section-4.2.5.2">
            <h5 id="name-node-id">
<a class="section-number selfRef" href="#section-4.2.5.2">4.2.5.2. </a><a class="section-name selfRef" href="#name-node-id">Node ID</a>
            </h5>
<p id="section-4.2.5.2-1">
   For many purposes of the Bundle Protocol, it is important to identify
   the node that is operative in some context.<a class="pilcrow" href="#section-4.2.5.2-1">¶</a></p>
<p id="section-4.2.5.2-2">
   As discussed in <a class="xref" href="#sect-3.1">Section 3.1</a>, nodes are distinct from endpoints;
   specifically, an endpoint is a set of zero or more nodes.  But
   rather than define a separate namespace for node identifiers, we
   instead use endpoint identifiers to identify nodes as discussed in
   <a class="xref" href="#sect-3.2">Section 3.2</a>. Formally:<a class="pilcrow" href="#section-4.2.5.2-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.5.2-3.1">Every node is, by definition, permanently registered in the
    singleton endpoint at which administrative records are delivered
    to its application agent's administrative element, termed the
    node's "administrative endpoint".<a class="pilcrow" href="#section-4.2.5.2-3.1">¶</a>
</li>
              <li class="normal" id="section-4.2.5.2-3.2">As such, the EID of a node's administrative endpoint <span class="bcp14">SHALL</span>
    uniquely identify that node.<a class="pilcrow" href="#section-4.2.5.2-3.2">¶</a>
</li>
              <li class="normal" id="section-4.2.5.2-3.3">The EID of any singleton endpoint is allowed to serve as a "node ID"
   identifying the node that is the sole member of that endpoint.<a class="pilcrow" href="#section-4.2.5.2-3.3">¶</a>
</li>
            </ul>
</section>
</div>
</section>
</div>
<div id="sect-4.2.6">
<section id="section-4.2.6">
          <h4 id="name-dtn-time">
<a class="section-number selfRef" href="#section-4.2.6">4.2.6. </a><a class="section-name selfRef" href="#name-dtn-time">DTN Time</a>
          </h4>
<p id="section-4.2.6-1">
   A DTN time is an unsigned integer indicating the number of
   milliseconds that have elapsed since the DTN Epoch, 2000-01-01
   00:00:00 +0000 (UTC).  DTN time is not affected by leap seconds.<a class="pilcrow" href="#section-4.2.6-1">¶</a></p>
<p id="section-4.2.6-2">
   Each DTN time <span class="bcp14">SHALL</span> be represented as a CBOR unsigned integer item.
   Implementers need to be aware that DTN time values conveyed in CBOR
   encoding in bundles will nearly always exceed (2<sup>32</sup> - 1); the
   manner in which a DTN time value is represented in memory is an
   implementation matter.  The DTN time value zero indicates that the
   time is unknown.<a class="pilcrow" href="#section-4.2.6-2">¶</a></p>
</section>
</div>
<div id="sect-4.2.7">
<section id="section-4.2.7">
          <h4 id="name-creation-timestamp">
<a class="section-number selfRef" href="#section-4.2.7">4.2.7. </a><a class="section-name selfRef" href="#name-creation-timestamp">Creation Timestamp</a>
          </h4>
<p id="section-4.2.7-1">
   Each bundle's creation timestamp <span class="bcp14">SHALL</span> be represented as a CBOR
   array comprising two items.<a class="pilcrow" href="#section-4.2.7-1">¶</a></p>
<p id="section-4.2.7-2">
   The first item of the array, termed "bundle creation time", <span class="bcp14">SHALL</span> be
   the DTN time at which the transmission request was received that
   resulted in the creation of the bundle, represented as a CBOR
   unsigned integer.<a class="pilcrow" href="#section-4.2.7-2">¶</a></p>
<p id="section-4.2.7-3">
   The second item of the array, termed the creation timestamp's
   "sequence number", <span class="bcp14">SHALL</span> be the latest value (as of the time at
   which the transmission request was received) of a monotonically
   increasing positive integer counter managed by the source node's
   BPA, represented as a CBOR unsigned integer.  The
   sequence counter <span class="bcp14">MAY</span> be reset to zero whenever the current time
   advances by one millisecond.<a class="pilcrow" href="#section-4.2.7-3">¶</a></p>
<p id="section-4.2.7-4">
   For nodes that lack accurate clocks, it is recommended that bundle
   creation time be set to zero and that the counter used as the source
   of the bundle sequence count never be reset to zero.<a class="pilcrow" href="#section-4.2.7-4">¶</a></p>
<p id="section-4.2.7-5">
   Note that, in general, the creation of two distinct bundles with the
   same source node ID and bundle creation timestamp may result in
   unexpected network behavior and/or suboptimal performance. The
   combination of source node ID and bundle creation timestamp serves
   to identify a single transmission request, enabling it to be
   acknowledged by the receiving application (provided the source node
   ID is not the null endpoint ID).<a class="pilcrow" href="#section-4.2.7-5">¶</a></p>
</section>
</div>
<div id="sect-4.2.8">
<section id="section-4.2.8">
          <h4 id="name-block-type-specific-data">
<a class="section-number selfRef" href="#section-4.2.8">4.2.8. </a><a class="section-name selfRef" href="#name-block-type-specific-data">Block-Type-Specific Data</a>
          </h4>
<p id="section-4.2.8-1">
   Block-type-specific data in each block (other than the primary
   block) <span class="bcp14">SHALL</span> be the applicable CBOR encoding of the content of
   the block.  Details of this representation are included in the
   specification defining the block type.<a class="pilcrow" href="#section-4.2.8-1">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-4.3">
<section id="section-4.3">
        <h3 id="name-block-structures">
<a class="section-number selfRef" href="#section-4.3">4.3. </a><a class="section-name selfRef" href="#name-block-structures">Block Structures</a>
        </h3>
<p id="section-4.3-1">
   This section describes the primary block in detail and non-primary
   blocks in general. Rules for processing these blocks appear in
   <a class="xref" href="#sect-5">Section 5</a>.<a class="pilcrow" href="#section-4.3-1">¶</a></p>
<p id="section-4.3-2">
   Note that supplementary DTN protocol specifications (including, but
   not restricted to, Bundle Protocol Security <span>[<a class="xref" href="#RFC9172">BPSEC</a>]</span>) may require
   that BP implementations conforming to those protocols construct and
   process additional blocks.<a class="pilcrow" href="#section-4.3-2">¶</a></p>
<div id="sect-4.3.1">
<section id="section-4.3.1">
          <h4 id="name-primary-bundle-block">
<a class="section-number selfRef" href="#section-4.3.1">4.3.1. </a><a class="section-name selfRef" href="#name-primary-bundle-block">Primary Bundle Block</a>
          </h4>
<p id="section-4.3.1-1">
   The primary bundle block contains the basic information needed to
   forward bundles to their destinations.<a class="pilcrow" href="#section-4.3.1-1">¶</a></p>
<p id="section-4.3.1-2">
   Each primary block <span class="bcp14">SHALL</span> be represented as a CBOR array; the number
   of elements in the array <span class="bcp14">SHALL</span> be 8 (if the bundle is not a fragment
   and the block has no CRC), 9 (if the block has a CRC and the bundle
   is not a fragment), 10 (if the bundle is a fragment and the block
   has no CRC), or 11 (if the bundle is a fragment and the block has a
   CRC).<a class="pilcrow" href="#section-4.3.1-2">¶</a></p>
<p id="section-4.3.1-3">
   The primary block of each bundle <span class="bcp14">SHALL</span> be immutable.  The CBOR-
   encoded values of all fields in the primary block <span class="bcp14">MUST</span> remain
   unchanged from the time the block is created to the time it is
   delivered.<a class="pilcrow" href="#section-4.3.1-3">¶</a></p>
<p id="section-4.3.1-4">
   The fields of the primary bundle block <span class="bcp14">SHALL</span> be as follows, listed
          in the order in which they <span class="bcp14">MUST</span> appear:<a class="pilcrow" href="#section-4.3.1-4">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.3.1-5">
            <dt id="section-4.3.1-5.1">Version:</dt>
            <dd id="section-4.3.1-5.2" style="margin-left: 1.5em">An unsigned integer value indicating the version of the
   Bundle Protocol that constructed this block. The present document
   describes BPv7. This version number <span class="bcp14">SHALL</span> be
   represented as a CBOR unsigned integer item.<a class="pilcrow" href="#section-4.3.1-5.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.1-5.3">Bundle Processing Control Flags:</dt>
            <dd id="section-4.3.1-5.4" style="margin-left: 1.5em">The bundle processing control flags
   are discussed in <a class="xref" href="#sect-4.2.3">Section 4.2.3</a>.<a class="pilcrow" href="#section-4.3.1-5.4">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.1-5.5">CRC Type:</dt>
            <dd id="section-4.3.1-5.6" style="margin-left: 1.5em">CRC type codes are discussed in <a class="xref" href="#sect-4.2.1">Section 4.2.1</a>.  The
   CRC type code for the primary block <span class="bcp14">MAY</span> be zero if the bundle
   contains a BPSec Block Integrity Block <span>[<a class="xref" href="#RFC9172">BPSEC</a>]</span> 
   whose target is the
   primary block; otherwise, the CRC type code for the primary block
   <span class="bcp14">MUST</span> be non-zero.<a class="pilcrow" href="#section-4.3.1-5.6">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.1-5.7">Destination EID:</dt>
            <dd id="section-4.3.1-5.8" style="margin-left: 1.5em">The Destination EID field identifies the bundle
   endpoint that is the bundle's destination, i.e., the endpoint that
   contains the node(s) at which the bundle is to be delivered.<a class="pilcrow" href="#section-4.3.1-5.8">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.1-5.9">Source node ID:</dt>
            <dd id="section-4.3.1-5.10" style="margin-left: 1.5em">The Source node ID field identifies the bundle node
   at which the bundle was initially transmitted, except that source
   node ID may be the null endpoint ID in the event that the bundle's
   source chooses to remain anonymous.<a class="pilcrow" href="#section-4.3.1-5.10">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.1-5.11">Report-to EID:</dt>
            <dd id="section-4.3.1-5.12" style="margin-left: 1.5em">The Report-to EID field identifies the bundle
   endpoint to which status reports pertaining to the forwarding and
   delivery of this bundle are to be transmitted.<a class="pilcrow" href="#section-4.3.1-5.12">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.1-5.13">Creation Timestamp:</dt>
            <dd id="section-4.3.1-5.14" style="margin-left: 1.5em">The creation timestamp comprises two unsigned
   integers that, together with the source node ID and (if the bundle
   is a fragment) the fragment offset and payload length, serve to
   identify the bundle. See <a class="xref" href="#sect-4.2.7">Section 4.2.7</a> for the definition of this
   field.<a class="pilcrow" href="#section-4.3.1-5.14">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.1-5.15">Lifetime:</dt>
            <dd id="section-4.3.1-5.16" style="margin-left: 1.5em">
              <p id="section-4.3.1-5.16.1">The Lifetime field is an unsigned integer that indicates
   the time at which the bundle's payload will no longer be useful,
   encoded as a number of milliseconds past the creation time. (For
   high-rate deployments with very brief disruptions, fine-grained
   expression of bundle lifetime may be useful.)  When a bundle's age
   exceeds its lifetime, bundle nodes need no longer retain or forward
   the bundle; the bundle <span class="bcp14">SHOULD</span> be deleted from the network.<a class="pilcrow" href="#section-4.3.1-5.16.1">¶</a></p>
<p id="section-4.3.1-5.16.2">
   If the asserted lifetime for a received bundle is so lengthy that
   retention of the bundle until its expiration time might degrade
   operation of the node at which the bundle is received, or if the
   BPA of that node determines that the bundle must
   be deleted in order to prevent network performance degradation
   (e.g., the bundle appears to be part of a denial-of-service attack),
   then that BPA <span class="bcp14">MAY</span> impose a temporary overriding
   lifetime of shorter duration; such an overriding lifetime <span class="bcp14">SHALL NOT</span>
   replace the lifetime asserted in the bundle but <span class="bcp14">SHALL</span> serve as the
   bundle's effective lifetime while the bundle resides at that node.
   Procedures for imposing lifetime overrides are beyond the scope of
   this specification.<a class="pilcrow" href="#section-4.3.1-5.16.2">¶</a></p>
<p id="section-4.3.1-5.16.3">
   For bundles originating at nodes that lack accurate clocks, it is
   recommended that bundle age be obtained from the Bundle Age
   extension block (see <a class="xref" href="#sect-4.4.2">Section 4.4.2</a>) rather than from the difference
   between current time and bundle creation time.  Bundle lifetime
   <span class="bcp14">SHALL</span> be represented as a CBOR unsigned integer item.<a class="pilcrow" href="#section-4.3.1-5.16.3">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.1-5.17">Fragment offset:</dt>
            <dd id="section-4.3.1-5.18" style="margin-left: 1.5em">If and only if the bundle processing control flags
   of this primary block indicate that the bundle is a fragment, 
   fragment offset <span class="bcp14">SHALL</span> be present in the primary block. Fragment
   offset <span class="bcp14">SHALL</span> be represented as a CBOR unsigned integer indicating
   the offset from the start of the original ADU at
   which the bytes comprising the payload of this bundle were located.<a class="pilcrow" href="#section-4.3.1-5.18">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.1-5.19">Total Application Data Unit Length:</dt>
            <dd id="section-4.3.1-5.20" style="margin-left: 1.5em">If and only if the bundle
   processing control flags of this primary block indicate that the
   bundle is a fragment, total application data unit length <span class="bcp14">SHALL</span> be
   present in the primary block. Total application data unit length
   <span class="bcp14">SHALL</span> be represented as a CBOR unsigned integer indicating the total
   length of the original ADU of which this bundle's
   payload is a part.<a class="pilcrow" href="#section-4.3.1-5.20">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.1-5.21">CRC:</dt>
            <dd id="section-4.3.1-5.22" style="margin-left: 1.5em">A CRC <span class="bcp14">SHALL</span> be present in the primary block unless the bundle includes
   a BPSec Block Integrity Block <span>[<a class="xref" href="#RFC9172">BPSEC</a>]</span> whose
   target is the primary block, in which case a CRC <span class="bcp14">MAY</span> be present in the
   primary block.  The length and nature of the CRC <span class="bcp14">SHALL</span> be as indicated by
   the CRC type.  The CRC <span class="bcp14">SHALL</span> be computed over the concatenation of all
   bytes (including CBOR "break" characters) of the primary block including
   the CRC field itself, which, for this purpose, <span class="bcp14">SHALL</span> be temporarily populated
   with all bytes set to zero.<a class="pilcrow" href="#section-4.3.1-5.22">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sect-4.3.2">
<section id="section-4.3.2">
          <h4 id="name-canonical-bundle-block-form">
<a class="section-number selfRef" href="#section-4.3.2">4.3.2. </a><a class="section-name selfRef" href="#name-canonical-bundle-block-form">Canonical Bundle Block Format</a>
          </h4>
<p id="section-4.3.2-1">
   Every block other than the primary block (all such blocks are termed
   "canonical" blocks) <span class="bcp14">SHALL</span> be represented as a CBOR array; the number
   of elements in the array <span class="bcp14">SHALL</span> be 5 (if CRC type is zero) or 6
   (otherwise).<a class="pilcrow" href="#section-4.3.2-1">¶</a></p>
<p id="section-4.3.2-2">
   The fields of every canonical block <span class="bcp14">SHALL</span> be as follows, listed in
   the order in which they <span class="bcp14">MUST</span> appear:<a class="pilcrow" href="#section-4.3.2-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.3.2-3">
            <dt id="section-4.3.2-3.1">Block type code:</dt>
            <dd id="section-4.3.2-3.2" style="margin-left: 1.5em">An unsigned integer. Bundle block type code 1
        indicates that the block is a Bundle Payload Block. Other block type codes
        are described in <a class="xref" href="#sect-9.1">Section 9.1</a>.
        Block type codes 192 through 255 are not reserved and
        are available for private and/or experimental use.  All other block
        type code values are reserved for future use.<a class="pilcrow" href="#section-4.3.2-3.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.2-3.3">Block number:</dt>
            <dd id="section-4.3.2-3.4" style="margin-left: 1.5em">An unsigned integer as discussed in <a class="xref" href="#sect-4.1">Section 4.1</a>.  The block
        number <span class="bcp14">SHALL</span> be represented as a CBOR unsigned integer.<a class="pilcrow" href="#section-4.3.2-3.4">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.2-3.5">Block processing control flags:</dt>
            <dd id="section-4.3.2-3.6" style="margin-left: 1.5em">As discussed in <a class="xref" href="#sect-4.2.4">Section 4.2.4</a>.<a class="pilcrow" href="#section-4.3.2-3.6">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.2-3.7">CRC type:</dt>
            <dd id="section-4.3.2-3.8" style="margin-left: 1.5em">As discussed in <a class="xref" href="#sect-4.2.1">Section 4.2.1</a>.<a class="pilcrow" href="#section-4.3.2-3.8">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.2-3.9">Block-type-specific data:</dt>
            <dd id="section-4.3.2-3.10" style="margin-left: 1.5em">Represented as a single definite-length
        CBOR byte string, i.e., a CBOR byte string that is not of indefinite
        length.  For each type of block, the block-type-specific data byte
        string is the serialization, in a block-type-specific manner, of the
        data conveyed by that type of block; definitions of blocks are
        required to define the manner in which block-type-specific data are
        serialized within the block-type-specific data field. For the Bundle Payload
        Block in particular (block type 1), the block-type-specific data
        field, termed the "payload", <span class="bcp14">SHALL</span> be an ADU, or
        some contiguous extent thereof, represented as a definite-length CBOR
        byte string.<a class="pilcrow" href="#section-4.3.2-3.10">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.2-3.11">If and only if the value of the CRC type field of this block is
        non-zero:</dt>
            <dd id="section-4.3.2-3.12" style="margin-left: 1.5em">A CRC. If present, the length and nature of the CRC <span class="bcp14">SHALL</span> be
        as indicated by the CRC type and the CRC <span class="bcp14">SHALL</span> be computed over the
        concatenation of all bytes of the block (including CBOR "break"
        characters) including the CRC field itself, which, for this purpose,
        <span class="bcp14">SHALL</span> be temporarily populated with all bytes set to zero.<a class="pilcrow" href="#section-4.3.2-3.12">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="sect-4.4">
<section id="section-4.4">
        <h3 id="name-extension-blocks">
<a class="section-number selfRef" href="#section-4.4">4.4. </a><a class="section-name selfRef" href="#name-extension-blocks">Extension Blocks</a>
        </h3>
<p id="section-4.4-1">"Extension blocks" are all blocks other than the primary and payload
   blocks. Three types of extension blocks are defined below.  All
   implementations of the Bundle Protocol specification (the present
   document) <span class="bcp14">MUST</span> include procedures for recognizing, parsing, and
   acting on, but not necessarily producing, these types of extension
   blocks.<a class="pilcrow" href="#section-4.4-1">¶</a></p>
<p id="section-4.4-2">
   The specifications for additional types of extension blocks must
   indicate whether or not BP implementations conforming to those
   specifications must recognize, parse, act on, and/or produce blocks
   of those types.  As not all nodes will necessarily instantiate BP
   implementations that conform to those additional specifications, it
   is possible for a node to receive a bundle that includes extension
   blocks that the node cannot process. The values of the block
   processing control flags indicate the action to be taken by the
   BPA when this is the case.<a class="pilcrow" href="#section-4.4-2">¶</a></p>
<p id="section-4.4-3">
   No mandated procedure in this specification is unconditionally
   dependent on the absence or presence of any extension block.
   Therefore, any BPA <span class="bcp14">MAY</span> insert or remove any
   extension block in any bundle, subject to all mandates in the Bundle
   Protocol specification and all extension block specifications to
   which the node's BP implementation conforms.  Note that removal of
   an extension block will probably disable one or more elements of
   bundle processing that were intended by the BPA that inserted that
   block.  In particular, note that removal of an extension block that
   is one of the targets of a BPSec security block may render the
   bundle unverifiable.<a class="pilcrow" href="#section-4.4-3">¶</a></p>
<p id="section-4.4-4">
   The following extension blocks are defined in the current document.<a class="pilcrow" href="#section-4.4-4">¶</a></p>
<div id="sect-4.4.1">
<section id="section-4.4.1">
          <h4 id="name-previous-node">
<a class="section-number selfRef" href="#section-4.4.1">4.4.1. </a><a class="section-name selfRef" href="#name-previous-node">Previous Node</a>
          </h4>
<p id="section-4.4.1-1">
   The Previous Node Block, block type 6, identifies the node that
   forwarded this bundle to the local node (i.e., to the node at which
   the bundle currently resides); its block-type-specific data is the
   node ID of that forwarder node.  That node ID <span class="bcp14">SHALL</span> conform to <a class="xref" href="#sect-4.2.5.2">Section 4.2.5.2</a>.
   If the local
   node is the source of the bundle, then the bundle <span class="bcp14">MUST NOT</span> contain
   any Previous Node Block.  Otherwise, the bundle <span class="bcp14">SHOULD</span> contain one
   (1) occurrence of this type of block and <span class="bcp14">MUST NOT</span> contain more than
   one.<a class="pilcrow" href="#section-4.4.1-1">¶</a></p>
</section>
</div>
<div id="sect-4.4.2">
<section id="section-4.4.2">
          <h4 id="name-bundle-age">
<a class="section-number selfRef" href="#section-4.4.2">4.4.2. </a><a class="section-name selfRef" href="#name-bundle-age">Bundle Age</a>
          </h4>
<p id="section-4.4.2-1">
   The Bundle Age Block, block type 7, contains the number of
   milliseconds that have elapsed between the time the bundle was
   created and the time at which it was most recently forwarded.  It is
   intended for use by nodes lacking access to an accurate clock, to
   aid in determining the time at which a bundle's lifetime expires.
   The block-type-specific data of this block is an unsigned integer
   containing the age of the bundle in milliseconds, which <span class="bcp14">SHALL</span> be
   represented as a CBOR unsigned integer item. (The age of the bundle
   is the sum of all known intervals of the bundle's residence at
   forwarding nodes, up to the time at which the bundle was most
   recently forwarded, plus the summation of signal propagation time
   over all episodes of transmission between forwarding nodes.
   Determination of these values is an implementation matter.) If the
   bundle's creation time is zero, then the bundle <span class="bcp14">MUST</span> contain exactly
   one (1) occurrence of this type of block; otherwise, the bundle <span class="bcp14">MAY</span>
   contain at most one (1) occurrence of this type of block.  A bundle
   <span class="bcp14">MUST NOT</span> contain multiple occurrences of the Bundle Age Block, as
   this could result in processing anomalies.<a class="pilcrow" href="#section-4.4.2-1">¶</a></p>
</section>
</div>
<div id="sect-4.4.3">
<section id="section-4.4.3">
          <h4 id="name-hop-count">
<a class="section-number selfRef" href="#section-4.4.3">4.4.3. </a><a class="section-name selfRef" href="#name-hop-count">Hop Count</a>
          </h4>
<p id="section-4.4.3-1">
   The Hop Count Block, block type 10, contains two unsigned integers:
   hop limit and hop count.  A "hop" is here defined as an occasion on
   which a bundle was forwarded from one node to another node.  The hop
   limit <span class="bcp14">MUST</span> be in the range 1 through 255. The hop limit value <span class="bcp14">SHOULD NOT</span> be changed at any time after creation of the Hop Count Block;
   the hop count value <span class="bcp14">SHOULD</span> initially be zero and <span class="bcp14">SHOULD</span> be increased
   by 1 on each hop.<a class="pilcrow" href="#section-4.4.3-1">¶</a></p>
<p id="section-4.4.3-2">
   The Hop Count Block is mainly intended as a safety mechanism, a
   means of identifying bundles for removal from the network that can
   never be delivered due to a persistent forwarding error.  The hop count
   is particularly valuable as a defense against routing anomalies that
   might cause a bundle to be forwarded in a cyclical "ping-pong"
   fashion between two nodes.  When a bundle's hop count exceeds its
   hop limit, the bundle <span class="bcp14">SHOULD</span> be deleted for the reason "Hop limit exceeded", following the Bundle Deletion procedure defined in
   <a class="xref" href="#sect-5.10">Section 5.10</a>.<a class="pilcrow" href="#section-4.4.3-2">¶</a></p>
<p id="section-4.4.3-3">
   Procedures for determining the appropriate hop limit for a bundle
   are beyond the scope of this specification.<a class="pilcrow" href="#section-4.4.3-3">¶</a></p>
<p id="section-4.4.3-4">
   The block-type-specific data in a Hop Count Block <span class="bcp14">SHALL</span> be
   represented as a CBOR array comprising two items.  The first item of
   this array <span class="bcp14">SHALL</span> be the bundle's hop limit, represented as a CBOR
   unsigned integer.  The second item of this array <span class="bcp14">SHALL</span> be the
   bundle's hop count, represented as a CBOR unsigned integer. A bundle
   <span class="bcp14">MAY</span> contain one occurrence of this type of block but <span class="bcp14">MUST NOT</span>
   contain more than one.<a class="pilcrow" href="#section-4.4.3-4">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="sect-5">
<section id="section-5">
      <h2 id="name-bundle-processing">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-bundle-processing">Bundle Processing</a>
      </h2>
<p id="section-5-1">
   The bundle-processing procedures mandated in this section and in
   <a class="xref" href="#sect-6">Section 6</a> govern the operation of the BPA and the
   application agent administrative element of each bundle node. They
   are neither exhaustive nor exclusive. Supplementary DTN protocol
   specifications (including, but not restricted to, Bundle Protocol 
   Security <span>[<a class="xref" href="#RFC9172">BPSEC</a>]</span>) may augment, override, or supersede the
   mandates of this document.<a class="pilcrow" href="#section-5-1">¶</a></p>
<div id="sect-5.1">
<section id="section-5.1">
        <h3 id="name-generation-of-administrativ">
<a class="section-number selfRef" href="#section-5.1">5.1. </a><a class="section-name selfRef" href="#name-generation-of-administrativ">Generation of Administrative Records</a>
        </h3>
<p id="section-5.1-1">
   All transmission of bundles is in response to bundle transmission
   requests presented by nodes' application agents. When required to
   "generate" an administrative record (such as a bundle status
   report), the BPA itself is responsible for causing
   a new bundle to be transmitted, conveying that record. In concept,
   the BPA discharges this responsibility by
   directing the administrative element of the node's application agent
   to construct the record and request its transmission as detailed in
   <a class="xref" href="#sect-6">Section 6</a>. In practice, the manner in which administrative
   record generation is accomplished is an implementation matter,
   provided the constraints noted in <a class="xref" href="#sect-6">Section 6</a> are observed.<a class="pilcrow" href="#section-5.1-1">¶</a></p>
<p id="section-5.1-2">
   Status reports are relatively small bundles.  Moreover, even when
   the generation of status reports is enabled, the decision on whether
   or not to generate a requested status report is left to the
   discretion of the BPA.  Nonetheless, note that
   requesting status reports for any single bundle might easily result
   in the generation of (1 + (2 *(N-1))) status report bundles, where N
   is the number of nodes on the path from the bundle's source to its
   destination, inclusive.  That is, the requesting of status reports
   for large numbers of bundles could result in an unacceptable
   increase in the bundle traffic in the network. For this reason, the
   generation of status reports <span class="bcp14">MUST</span> be disabled by default and enabled
   only when the risk of excessive network traffic is deemed
   acceptable.  Mechanisms that could assist in assessing and
   mitigating this risk, such as pre-placed agreements authorizing the
   generation of status reports under specified circumstances, are
   beyond the scope of this specification.<a class="pilcrow" href="#section-5.1-2">¶</a></p>
<p id="section-5.1-3">Notes on administrative record terminology:<a class="pilcrow" href="#section-5.1-3">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1-4.1">A "bundle reception status report" is a bundle status report with
          the "Reporting node received bundle" flag set to 1.<a class="pilcrow" href="#section-5.1-4.1">¶</a>
</li>
          <li class="normal" id="section-5.1-4.2">A "bundle forwarding status report" is a bundle status report
          with the "Reporting node forwarded the bundle" flag set to 1.<a class="pilcrow" href="#section-5.1-4.2">¶</a>
</li>
          <li class="normal" id="section-5.1-4.3">A "bundle delivery status report" is a bundle status report with
          the "Reporting node delivered the bundle" flag set to 1.<a class="pilcrow" href="#section-5.1-4.3">¶</a>
</li>
          <li class="normal" id="section-5.1-4.4">A "bundle deletion status report" is a bundle status report with
          the "Reporting node deleted the bundle" flag set to 1.<a class="pilcrow" href="#section-5.1-4.4">¶</a>
</li>
        </ul>
</section>
</div>
<div id="sect-5.2">
<section id="section-5.2">
        <h3 id="name-bundle-transmission">
<a class="section-number selfRef" href="#section-5.2">5.2. </a><a class="section-name selfRef" href="#name-bundle-transmission">Bundle Transmission</a>
        </h3>
<p id="section-5.2-1">
        The steps in processing a bundle transmission request are as follows:<a class="pilcrow" href="#section-5.2-1">¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-5.2-2">
        <dt>Step 1:</dt>
<dd id="section-5.2-2.1" style="margin-left: 4.5em">
   Transmission of the bundle is initiated. An outbound bundle
   <span class="bcp14">MUST</span> be created per the parameters of the bundle transmission
   request, with the retention constraint "Dispatch pending". The
   source node ID of the bundle <span class="bcp14">MUST</span> be either (a) the null endpoint ID,
   indicating that the source of the bundle is anonymous or (b) the
   EID of a singleton endpoint whose only member is the node of which
   the BPA is a component.<a class="pilcrow" href="#section-5.2-2.1">¶</a>
</dd>
          <dd class="break"></dd>
<dt>Step 2:</dt>
<dd id="section-5.2-2.2" style="margin-left: 4.5em"> Processing proceeds from Step 1 of <a class="xref" href="#sect-5.4">Section 5.4</a>.<a class="pilcrow" href="#section-5.2-2.2">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sect-5.3">
<section id="section-5.3">
        <h3 id="name-bundle-dispatching">
<a class="section-number selfRef" href="#section-5.3">5.3. </a><a class="section-name selfRef" href="#name-bundle-dispatching">Bundle Dispatching</a>
        </h3>
<p id="section-5.3-1">
   (Note that this procedure is initiated only following completion of
   Step 4 of <a class="xref" href="#sect-5.6">Section 5.6</a>.)<a class="pilcrow" href="#section-5.3-1">¶</a></p>
<p id="section-5.3-2">
        The steps in dispatching a bundle are as follows:<a class="pilcrow" href="#section-5.3-2">¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-5.3-3">
        <dt>Step 1:</dt>
<dd id="section-5.3-3.1" style="margin-left: 4.5em">
  If the bundle's destination endpoint is an endpoint of which
   the node is a member, the Bundle Delivery procedure defined in
   <a class="xref" href="#sect-5.7">Section 5.7</a> <span class="bcp14">MUST</span> be followed and, for the purposes of all subsequent
   processing of this bundle at this node, the node's membership in the
   bundle's destination endpoint <span class="bcp14">SHALL</span> be disavowed; specifically, even
   though the node is a member of the bundle's destination endpoint,
   the node <span class="bcp14">SHALL NOT</span> undertake to forward the bundle to itself in the
   course of performing the procedure described in <a class="xref" href="#sect-5.4">Section 5.4</a>.<a class="pilcrow" href="#section-5.3-3.1">¶</a>
</dd>
          <dd class="break"></dd>
<dt>Step 2:</dt>
<dd id="section-5.3-3.2" style="margin-left: 4.5em"> Processing proceeds from Step 1 of <a class="xref" href="#sect-5.4">Section 5.4</a>.<a class="pilcrow" href="#section-5.3-3.2">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sect-5.4">
<section id="section-5.4">
        <h3 id="name-bundle-forwarding">
<a class="section-number selfRef" href="#section-5.4">5.4. </a><a class="section-name selfRef" href="#name-bundle-forwarding">Bundle Forwarding</a>
        </h3>
<p id="section-5.4-1">
        The steps in forwarding a bundle are as follows:<a class="pilcrow" href="#section-5.4-1">¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-5.4-2">
        
  <dt>Step 1:</dt>
<dd id="section-5.4-2.1" style="margin-left: 4.5em">The retention constraint "Forward pending" <span class="bcp14">MUST</span> be added to
   the bundle, and the bundle's "Dispatch pending" retention constraint
   <span class="bcp14">MUST</span> be removed.<a class="pilcrow" href="#section-5.4-2.1">¶</a>
</dd>
          <dd class="break"></dd>
<dt>Step 2:</dt>
<dd id="section-5.4-2.2" style="margin-left: 4.5em">
            <p id="section-5.4-2.2.1">The BPA <span class="bcp14">MUST</span> determine whether or not
   forwarding is contraindicated (that is, rendered inadvisable) for
   any of the reasons listed in the IANA "Bundle Status Report Reason Codes" registry 
   (see <a class="xref" href="#sect-9.5">Section 9.5</a>), whose initial contents
   are listed in  <a class="xref" href="#tab-1">Table 1</a>. In particular:<a class="pilcrow" href="#section-5.4-2.2.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.4-2.2.2.1">The BPA <span class="bcp14">MAY</span> choose to either forward the bundle
          directly to its destination node(s) (if possible) or forward the
          bundle to some other node(s) for further forwarding. The manner in
          which this decision is made may depend on the scheme name in the
          destination endpoint ID and/or on other state but in any case is
          beyond the scope of this document; one possible mechanism is
          described in <span>[<a class="xref" href="#SABR">SABR</a>]</span>. If the BPA elects to forward the bundle to some
          other node(s) for further forwarding but finds it impossible to
          select any node(s) to forward the bundle to, then forwarding is
          contraindicated.<a class="pilcrow" href="#section-5.4-2.2.2.1">¶</a>
</li>
              <li class="normal" id="section-5.4-2.2.2.2">Provided the BPA succeeded in selecting the
          node or nodes to forward the bundle to, the BPA <span class="bcp14">MUST</span>
          subsequently select the CLA(s) whose services
          will enable the node to send the bundle to those nodes.  The manner
          in which specific appropriate CLAs are
          selected is beyond the scope of this document; the TCP
          CLA <span>[<a class="xref" href="#RFC9174">TCPCL</a>]</span> <span class="bcp14">MUST</span>
          be implemented when some or all of the bundles forwarded by the
          BPA must be forwarded via the Internet but may not
          be appropriate for the forwarding of any particular bundle. If the
          agent finds it impossible to select any appropriate CLA(s) to use in forwarding this bundle, then forwarding
          is contraindicated.<a class="pilcrow" href="#section-5.4-2.2.2.2">¶</a>
</li>
            </ul>
</dd>
          <dd class="break"></dd>
<dt>Step 3:</dt>
<dd id="section-5.4-2.3" style="margin-left: 4.5em">
   If forwarding of the bundle is determined to be
   contraindicated for any of the reasons listed in the IANA "Bundle Status Report
   Reason Codes" registry (see <a class="xref" href="#sect-9.5">Section 9.5</a>), then
   the Forwarding Contraindicated procedure defined in <a class="xref" href="#sect-5.4.1">Section 5.4.1</a>
            <span class="bcp14">MUST</span> be followed; the remaining steps of this Bundle Forwarding procedure are skipped at this time.<a class="pilcrow" href="#section-5.4-2.3">¶</a>
</dd>
          <dd class="break"></dd>
<dt>Step 4:</dt>
<dd id="section-5.4-2.4" style="margin-left: 4.5em">
            <p id="section-5.4-2.4.1">For each node selected for forwarding, the BPA <span class="bcp14">MUST</span> invoke the services of the selected CLA(s) in order to effect the sending of the bundle to that
   node. Determining the time at which the BPA
   invokes CLA services is a BPA implementation
   matter.  Determining the time at which each CLA subsequently responds to this service invocation by sending
   the bundle is a CLA implementation matter.
  Note that:<a class="pilcrow" href="#section-5.4-2.4.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.4-2.4.2.1">If the bundle has a Previous Node Block, as defined in <a class="xref" href="#sect-4.4.1">Section 4.4.1</a>,
          then that block <span class="bcp14">MUST</span> be removed from the bundle before the
          bundle is forwarded.<a class="pilcrow" href="#section-5.4-2.4.2.1">¶</a>
</li>
              <li class="normal" id="section-5.4-2.4.2.2">If the BPA is configured to attach Previous
          Node Blocks to forwarded bundles, then a Previous Node Block
          containing the node ID of the forwarding node <span class="bcp14">MUST</span> be inserted into
          the bundle before the bundle is forwarded.<a class="pilcrow" href="#section-5.4-2.4.2.2">¶</a>
</li>
              <li class="normal" id="section-5.4-2.4.2.3">If the bundle has a Bundle Age Block, as defined in <a class="xref" href="#sect-4.4.2">Section 4.4.2</a>,
          then at the last possible moment before the CLA initiates
          conveyance of the bundle via the CL protocol the bundle age value
          <span class="bcp14">MUST</span> be increased by the difference between the current time and the
          time at which the bundle was received (or, if the local node is the
          source of the bundle, created).<a class="pilcrow" href="#section-5.4-2.4.2.3">¶</a>
</li>
            </ul>
</dd>
          <dd class="break"></dd>
<dt>Step 5:</dt>
<dd id="section-5.4-2.5" style="margin-left: 4.5em">
   When all selected CLAs have informed
   the BPA that they have concluded their data-sending procedures
   with regard to this bundle, processing may depend on the results of those
   procedures.<a class="pilcrow" href="#section-5.4-2.5">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-5.4-3"> 
   If completion of the data-sending procedures by all selected
   CLAs has not resulted in successful forwarding
   of the bundle (an implementation-specific determination that is
   beyond the scope of this specification), then the BPA <span class="bcp14">MAY</span> choose (in an implementation-specific manner, again beyond
   the scope of this specification) to initiate another attempt to
   forward the bundle.  In that event, processing proceeds from Step 4.
   The minimum number of times a given node will initiate another
   forwarding attempt for any single bundle in this event (a number
   that may be zero) is a node configuration parameter that must be
   exposed to other nodes in the network to the extent that this is
   required by the operating environment.<a class="pilcrow" href="#section-5.4-3">¶</a></p>
<p id="section-5.4-4">
   If completion of the data-sending procedures by all selected
   CLAs <strong>HAS</strong> resulted in successful forwarding of
   the bundle, or if it has not but the BPA does not
   choose to initiate another attempt to forward the bundle, then:<a class="pilcrow" href="#section-5.4-4">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.4-5.1">If the "request reporting of bundle forwarding" flag in the
          bundle's status report request field is set to 1 and status
          reporting is enabled, then a bundle forwarding status report <span class="bcp14">SHOULD</span>
          be generated, destined for the bundle's report-to endpoint ID. The
          reason code on this bundle forwarding status report <span class="bcp14">MUST</span> be "no
          additional information".<a class="pilcrow" href="#section-5.4-5.1">¶</a>
</li>
          <li class="normal" id="section-5.4-5.2">If any applicable Bundle Protocol extensions mandate generation
          of status reports upon conclusion of convergence-layer data-sending
          procedures, all such status reports <span class="bcp14">SHOULD</span> be generated with
          extension-mandated reason codes.<a class="pilcrow" href="#section-5.4-5.2">¶</a>
</li>
          <li class="normal" id="section-5.4-5.3">The bundle's "Forward pending" retention constraint <span class="bcp14">MUST</span> be
          removed.<a class="pilcrow" href="#section-5.4-5.3">¶</a>
</li>
        </ul>
<div id="sect-5.4.1">
<section id="section-5.4.1">
          <h4 id="name-forwarding-contraindicated">
<a class="section-number selfRef" href="#section-5.4.1">5.4.1. </a><a class="section-name selfRef" href="#name-forwarding-contraindicated">Forwarding Contraindicated</a>
          </h4>
<p id="section-5.4.1-1">
   The steps in responding to contraindication of forwarding are as follows:<a class="pilcrow" href="#section-5.4.1-1">¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-5.4.1-2">
  <dt>Step 1:</dt>
<dd id="section-5.4.1-2.1" style="margin-left: 4.5em">The BPA <span class="bcp14">MUST</span> determine whether or not to
   declare failure in forwarding the bundle. Note: This decision is
   likely to be influenced by the reason for which forwarding is
   contraindicated.<a class="pilcrow" href="#section-5.4.1-2.1">¶</a>
</dd>
            <dd class="break"></dd>
<dt>Step 2:</dt>
<dd id="section-5.4.1-2.2" style="margin-left: 4.5em">
   If forwarding failure is declared, then the Forwarding
          Failed procedure defined in <a class="xref" href="#sect-5.4.2">Section 5.4.2</a> <span class="bcp14">MUST</span> be followed.<a class="pilcrow" href="#section-5.4.1-2.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-5.4.1-3">
   Otherwise, when -- at some future time -- the forwarding of this
   bundle ceases to be contraindicated, processing proceeds from Step 4
          of <a class="xref" href="#sect-5.4">Section 5.4</a>.<a class="pilcrow" href="#section-5.4.1-3">¶</a></p>
</section>
</div>
<div id="sect-5.4.2">
<section id="section-5.4.2">
          <h4 id="name-forwarding-failed">
<a class="section-number selfRef" href="#section-5.4.2">5.4.2. </a><a class="section-name selfRef" href="#name-forwarding-failed">Forwarding Failed</a>
          </h4>
<p id="section-5.4.2-1">
   The steps in responding to a declaration of forwarding failure are as follows:<a class="pilcrow" href="#section-5.4.2-1">¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-5.4.2-2">
   <dt>Step 1:</dt>
<dd id="section-5.4.2-2.1" style="margin-left: 4.5em">The BPA <span class="bcp14">MAY</span> forward the bundle back to the
   node that sent it, as identified by the Previous Node Block, if
   present.  This forwarding, if performed, <span class="bcp14">SHALL</span> be accomplished by
   performing Step 4 and Step 5 of <a class="xref" href="#sect-5.4">Section 5.4</a> where the sole node
   selected for forwarding <span class="bcp14">SHALL</span> be the node that sent the bundle.<a class="pilcrow" href="#section-5.4.2-2.1">¶</a>
</dd>
            <dd class="break"></dd>
<dt>Step 2:</dt>
<dd id="section-5.4.2-2.2" style="margin-left: 4.5em">
   If the bundle's destination endpoint is an endpoint of which
   the node is a member, then the bundle's "Forward pending" retention
   constraint <span class="bcp14">MUST</span> be removed. Otherwise, the bundle <span class="bcp14">MUST</span> be deleted:
   the Bundle Deletion procedure defined in <a class="xref" href="#sect-5.10">Section 5.10</a> <span class="bcp14">MUST</span> be
   followed, citing the reason for which forwarding was determined to
          be contraindicated.<a class="pilcrow" href="#section-5.4.2-2.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="sect-5.5">
<section id="section-5.5">
        <h3 id="name-bundle-expiration">
<a class="section-number selfRef" href="#section-5.5">5.5. </a><a class="section-name selfRef" href="#name-bundle-expiration">Bundle Expiration</a>
        </h3>
<p id="section-5.5-1">
   A bundle expires when the bundle's age exceeds its lifetime as
   specified in the primary bundle block or as overridden by the BPA. Bundle age <span class="bcp14">MAY</span> be determined by subtracting the
   bundle's creation timestamp time from the current time if (a) that
   timestamp time is not zero and (b) the local node's clock is known
   to be accurate; otherwise, bundle age <span class="bcp14">MUST</span> be obtained from the
   Bundle Age extension block.  Bundle expiration <span class="bcp14">MAY</span> occur at any
   point in the processing of a bundle. When a bundle expires, the
   BPA <span class="bcp14">MUST</span> delete the bundle for the reason
   "Lifetime expired" (when the expired lifetime is the lifetime as
   specified in the primary block) or "Traffic pared" (when the expired
   lifetime is a lifetime override as imposed by the BPA): the Bundle Deletion procedure defined in <a class="xref" href="#sect-5.10">Section 5.10</a> <span class="bcp14">MUST</span>
   be followed.<a class="pilcrow" href="#section-5.5-1">¶</a></p>
</section>
</div>
<div id="sect-5.6">
<section id="section-5.6">
        <h3 id="name-bundle-reception">
<a class="section-number selfRef" href="#section-5.6">5.6. </a><a class="section-name selfRef" href="#name-bundle-reception">Bundle Reception</a>
        </h3>
<p id="section-5.6-1">
   The steps in processing a bundle that has been received from another
   node are as follows:<a class="pilcrow" href="#section-5.6-1">¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-5.6-2">
   <dt>Step 1:</dt>
<dd id="section-5.6-2.1" style="margin-left: 4.5em">The retention constraint "Dispatch pending" <span class="bcp14">MUST</span> be added to
   the bundle.<a class="pilcrow" href="#section-5.6-2.1">¶</a>
</dd>
          <dd class="break"></dd>
<dt>Step 2:</dt>
<dd id="section-5.6-2.2" style="margin-left: 4.5em">
   If the "request reporting of bundle reception" flag in the
   bundle's status report request field is set to 1 and status
   reporting is enabled, then a bundle reception status report with
   reason code "No additional information" <span class="bcp14">SHOULD</span> be generated,
   destined for the bundle's report-to endpoint ID.<a class="pilcrow" href="#section-5.6-2.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt>Step 3:</dt>
<dd id="section-5.6-2.3" style="margin-left: 4.5em">
   CRCs <span class="bcp14">SHOULD</span> be computed for every block of the bundle that
   has an attached CRC.  If any block of the bundle is malformed
   according to this specification (including syntactically invalid
   CBOR), or if any block has an attached CRC and the CRC computed for
   this block upon reception differs from that attached CRC, then the
   BPA <span class="bcp14">MUST</span> delete the bundle for the reason "Block unintelligible".  The Bundle Deletion procedure defined in <a class="xref" href="#sect-5.10">Section 5.10</a> <span class="bcp14">MUST</span> be followed, and all remaining steps of the Bundle
   Reception procedure <span class="bcp14">MUST</span> be skipped.<a class="pilcrow" href="#section-5.6-2.3">¶</a>
</dd>
          <dd class="break"></dd>
<dt>Step 4:</dt>
<dd id="section-5.6-2.4" style="margin-left: 4.5em">
            <p id="section-5.6-2.4.1">For each block in the bundle that is an extension block that
   the BPA cannot process:<a class="pilcrow" href="#section-5.6-2.4.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.6-2.4.2.1">If the block processing control flags in that block indicate that a
          status report is requested in this event and if status reporting is
          enabled, then a bundle reception status report with reason code
          "Block unsupported" <span class="bcp14">SHOULD</span> be generated, destined for the bundle's
          report-to endpoint ID.<a class="pilcrow" href="#section-5.6-2.4.2.1">¶</a>
</li>
              <li class="normal" id="section-5.6-2.4.2.2">If the block processing control flags in that block indicate that the
          bundle must be deleted in this event, then the BPA
          <span class="bcp14">MUST</span> delete the bundle for the reason "Block unsupported"; the
          Bundle Deletion procedure defined in <a class="xref" href="#sect-5.10">Section 5.10</a> <span class="bcp14">MUST</span>
          be followed, and all remaining steps of the Bundle Reception
          procedure <span class="bcp14">MUST</span> be skipped.<a class="pilcrow" href="#section-5.6-2.4.2.2">¶</a>
</li>
              <li class="normal" id="section-5.6-2.4.2.3">If the block processing control flags in that block do <strong>NOT</strong> indicate that
          the bundle must be deleted in this event but do indicate that the
          block must be discarded, then the BPA <span class="bcp14">MUST</span> remove
          this block from the bundle.<a class="pilcrow" href="#section-5.6-2.4.2.3">¶</a>
</li>
              <li class="normal" id="section-5.6-2.4.2.4">If the block processing control flags in that block neither indicate that
          the bundle must be deleted nor indicate that the block must be
          discarded, then processing continues with the next extension block
          that the BPA cannot process, if any; otherwise,
          processing proceeds from Step 5.<a class="pilcrow" href="#section-5.6-2.4.2.4">¶</a>
</li>
            </ul>
</dd>
          <dd class="break"></dd>
<dt>Step 5:</dt>
<dd id="section-5.6-2.5" style="margin-left: 4.5em">
        Processing proceeds from Step 1 of <a class="xref" href="#sect-5.3">Section 5.3</a>.<a class="pilcrow" href="#section-5.6-2.5">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sect-5.7">
<section id="section-5.7">
        <h3 id="name-local-bundle-delivery">
<a class="section-number selfRef" href="#section-5.7">5.7. </a><a class="section-name selfRef" href="#name-local-bundle-delivery">Local Bundle Delivery</a>
        </h3>
<p id="section-5.7-1">
   The steps in processing a bundle that is destined for an endpoint of
        which this node is a member are as follows:<a class="pilcrow" href="#section-5.7-1">¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-5.7-2">
        <dt>Step 1:</dt>
<dd id="section-5.7-2.1" style="margin-left: 4.5em">
   If the received bundle is a fragment, the ADU Reassembly procedure described in <a class="xref" href="#sect-5.9">Section 5.9</a> <span class="bcp14">MUST</span> be followed.
   If this procedure results in reassembly of the entire original
   ADU, processing of the fragmentary bundle whose
   payload has been replaced by the reassembled ADU
   (whether this bundle or a previously received fragment) proceeds
   from Step 2; otherwise, the retention constraint "Reassembly pending" <span class="bcp14">MUST</span> be added to the bundle, and all remaining steps of this
   procedure <span class="bcp14">MUST</span> be skipped.<a class="pilcrow" href="#section-5.7-2.1">¶</a>
</dd>
          <dd class="break"></dd>
<dt>Step 2:</dt>
<dd id="section-5.7-2.2" style="margin-left: 4.5em">
            <p id="section-5.7-2.2.1">Delivery depends on the state of the registration whose
   endpoint ID matches that of the destination of the bundle:<a class="pilcrow" href="#section-5.7-2.2.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.7-2.2.2.1">An additional implementation-specific delivery deferral procedure
          <span class="bcp14">MAY</span> optionally be associated with the registration.<a class="pilcrow" href="#section-5.7-2.2.2.1">¶</a>
</li>
              <li class="normal" id="section-5.7-2.2.2.2">If the registration is in the Active state, then the bundle <span class="bcp14">MUST</span>
          be delivered automatically as soon as it is the next bundle that is
          due for delivery according to the BPA's bundle delivery scheduling
          policy (an implementation matter).<a class="pilcrow" href="#section-5.7-2.2.2.2">¶</a>
</li>
              <li class="normal" id="section-5.7-2.2.2.3">
                <p id="section-5.7-2.2.2.3.1">If the registration is in the Passive state, or if delivery of
          the bundle fails for some implementation-specific reason, then the
          registration's delivery failure action <span class="bcp14">MUST</span> be taken. The
          delivery failure action <span class="bcp14">MUST</span> be one of the following:<a class="pilcrow" href="#section-5.7-2.2.2.3.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.7-2.2.2.3.2.1">Defer delivery of the bundle subject to this registration
               until (a) this bundle is the least recently received of all
               bundles currently deliverable subject to this registration and
               (b) either the registration is polled or the registration
               is in the Active state, and also perform any additional
               delivery deferral procedure associated with the registration,
               or<a class="pilcrow" href="#section-5.7-2.2.2.3.2.1">¶</a>
</li>
                  <li class="normal" id="section-5.7-2.2.2.3.2.2">Abandon delivery of the bundle subject to this registration
               (as defined in <a class="xref" href="#sect-3.1">Section 3.1</a>).<a class="pilcrow" href="#section-5.7-2.2.2.3.2.2">¶</a>
</li>
                </ul>
</li>
            </ul>
</dd>
          <dd class="break"></dd>
<dt>Step 3:</dt>
<dd id="section-5.7-2.3" style="margin-left: 4.5em">
   As soon as the bundle has been delivered, if the "request reporting of bundle delivery" flag in the bundle's status report
   request field is set to 1 and bundle status reporting is enabled,
   then a bundle delivery status report <span class="bcp14">SHOULD</span> be generated, destined
   for the bundle's report-to endpoint ID. Note that this status report
   only states that the payload has been delivered to the application
        agent, not that the application agent has processed that payload.<a class="pilcrow" href="#section-5.7-2.3">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sect-5.8">
<section id="section-5.8">
        <h3 id="name-bundle-fragmentation">
<a class="section-number selfRef" href="#section-5.8">5.8. </a><a class="section-name selfRef" href="#name-bundle-fragmentation">Bundle Fragmentation</a>
        </h3>
<p id="section-5.8-1">
   It may at times be advantageous for BPAs to reduce
   the sizes of bundles in order to forward them. This might be the
   case, for example, if a node to which a bundle is to be forwarded is
   accessible only via intermittent contacts and no upcoming contact is
   long enough to enable the forwarding of the entire bundle.<a class="pilcrow" href="#section-5.8-1">¶</a></p>
<p id="section-5.8-2">
   The size of a bundle can be reduced by "fragmenting" the bundle. To
   fragment a bundle whose payload is of size M is to replace it with
   two "fragments" -- new bundles with the same source node ID and
   creation timestamp as the original bundle -- whose payloads <span class="bcp14">MUST</span> be
   the first N and the last (M - N) bytes of the original bundle's
   payload, where 0 &lt; N &lt; M.<a class="pilcrow" href="#section-5.8-2">¶</a></p>
<p id="section-5.8-3">
   Note that fragments are bundles and therefore may themselves be
   fragmented, so multiple episodes of fragmentation may in effect
   replace the original bundle with more than two fragments. (However,
   there is only one "level" of fragmentation, as in IP fragmentation.)<a class="pilcrow" href="#section-5.8-3">¶</a></p>
<p id="section-5.8-4">
   Any bundle whose primary block's bundle processing control flags do <strong>NOT</strong>
   indicate that it must not be fragmented <span class="bcp14">MAY</span> be fragmented at any
   time, for any purpose, at the discretion of the BPA.  <strong>NOTE</strong>, however, that some combinations of bundle
   fragmentation, replication, and routing might result in unexpected
   traffic patterns.<a class="pilcrow" href="#section-5.8-4">¶</a></p>
<p id="section-5.8-5">
   Fragmentation <span class="bcp14">SHALL</span> be constrained as follows:<a class="pilcrow" href="#section-5.8-5">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.8-6.1">The concatenation of the payloads of all fragments produced by
          fragmentation <span class="bcp14">MUST</span> always be identical to the payload of the
          fragmented bundle (that is, the bundle that is being
          fragmented). Note that the payloads of fragments resulting from
          different fragmentation episodes, in different parts of the network,
          may be overlapping subsets of the fragmented bundle's payload.<a class="pilcrow" href="#section-5.8-6.1">¶</a>
</li>
          <li class="normal" id="section-5.8-6.2">The primary block of each fragment <span class="bcp14">MUST</span> differ from that of the
          fragmented bundle, in that the bundle processing control flags of the
          fragment <span class="bcp14">MUST</span> indicate that the bundle is a fragment and both
          fragment offset and total application data unit length must be
          provided.  Additionally, the CRC of the primary block of the
          fragmented bundle, if any, <span class="bcp14">MUST</span> be replaced in each fragment by a
          new CRC computed for the primary block of that fragment.<a class="pilcrow" href="#section-5.8-6.2">¶</a>
</li>
          <li class="normal" id="section-5.8-6.3">The payload blocks of fragments will differ from that of the
          fragmented bundle as noted above.<a class="pilcrow" href="#section-5.8-6.3">¶</a>
</li>
          <li class="normal" id="section-5.8-6.4">If the fragmented bundle is not a fragment or is the fragment
          with offset zero, then all extension blocks of the fragmented bundle
          <span class="bcp14">MUST</span> be replicated in the fragment whose offset is zero.<a class="pilcrow" href="#section-5.8-6.4">¶</a>
</li>
          <li class="normal" id="section-5.8-6.5">Each of the fragmented bundle's extension blocks whose "Block
          must be replicated in every fragment" flag is set to 1 <span class="bcp14">MUST</span> be
          replicated in every fragment.<a class="pilcrow" href="#section-5.8-6.5">¶</a>
</li>
          <li class="normal" id="section-5.8-6.6">Beyond these rules, rules for the replication of extension blocks
          in the fragments must be defined in the specifications for those
          extension block types.<a class="pilcrow" href="#section-5.8-6.6">¶</a>
</li>
        </ul>
</section>
</div>
<div id="sect-5.9">
<section id="section-5.9">
        <h3 id="name-application-data-unit-reass">
<a class="section-number selfRef" href="#section-5.9">5.9. </a><a class="section-name selfRef" href="#name-application-data-unit-reass">Application Data Unit Reassembly</a>
        </h3>
<p id="section-5.9-1">
   Note that the Bundle Fragmentation procedure described in <a class="xref" href="#sect-5.8">Section 5.8</a>
   may result in the replacement of a single original bundle with an
   arbitrarily large number of fragmentary bundles.  In order to be
   delivered at a destination node, the original bundle's payload must
   be reassembled from the payloads of those fragments.<a class="pilcrow" href="#section-5.9-1">¶</a></p>
<p id="section-5.9-2">
   The "material extents" of a received fragment's payload are all
   continuous sequences of bytes in that payload that do not overlap
   with the material extents of the payloads of any previously received
   fragments with the same source node ID and creation timestamp.  If
   the concatenation -- as informed by fragment offsets and payload
   lengths -- of the material extents of the payloads of this fragment
   and all previously received fragments with the same source node ID
   and creation timestamp as this fragment forms a continuous byte
   array whose length is equal to the total application data unit
   length noted in the fragment's primary block, then:<a class="pilcrow" href="#section-5.9-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.9-3.1">This byte array -- the reassembled ADU --
          <span class="bcp14">MUST</span> replace the payload of that fragment whose material extents
          include the extent at offset zero.  Note that this will enable
          delivery of the reconstituted original bundle as described in Step 1
          of <a class="xref" href="#sect-5.7">Section 5.7</a>.<a class="pilcrow" href="#section-5.9-3.1">¶</a>
</li>
          <li class="normal" id="section-5.9-3.2">The "Reassembly pending" retention constraint <span class="bcp14">MUST</span> be removed
          from every other fragment with the same source node ID and creation
          timestamp as this fragment.<a class="pilcrow" href="#section-5.9-3.2">¶</a>
</li>
        </ul>
<p id="section-5.9-4">
   Note: Reassembly of ADUs from fragments occurs at
   the nodes that are members of destination endpoints as necessary; an
   ADU <span class="bcp14">MAY</span> also be reassembled at some other node on
   the path to the destination.<a class="pilcrow" href="#section-5.9-4">¶</a></p>
</section>
</div>
<div id="sect-5.10">
<section id="section-5.10">
        <h3 id="name-bundle-deletion">
<a class="section-number selfRef" href="#section-5.10">5.10. </a><a class="section-name selfRef" href="#name-bundle-deletion">Bundle Deletion</a>
        </h3>
<p id="section-5.10-1">
        The steps in deleting a bundle are as follows:<a class="pilcrow" href="#section-5.10-1">¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-5.10-2">
        <dt>Step 1:</dt>
<dd id="section-5.10-2.1" style="margin-left: 4.5em">
   If the "request reporting of bundle deletion" flag in the
   bundle's status report request field is set to 1 and if status
   reporting is enabled, then a bundle deletion status report citing
   the reason for deletion <span class="bcp14">SHOULD</span> be generated, destined for the
   bundle's report-to endpoint ID.<a class="pilcrow" href="#section-5.10-2.1">¶</a>
</dd>
          <dd class="break"></dd>
<dt>Step 2:</dt>
<dd id="section-5.10-2.2" style="margin-left: 4.5em">
        All of the bundle's retention constraints <span class="bcp14">MUST</span> be removed.<a class="pilcrow" href="#section-5.10-2.2">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sect-5.11">
<section id="section-5.11">
        <h3 id="name-discarding-a-bundle">
<a class="section-number selfRef" href="#section-5.11">5.11. </a><a class="section-name selfRef" href="#name-discarding-a-bundle">Discarding a Bundle</a>
        </h3>
<p id="section-5.11-1">
   As soon as a bundle has no remaining retention constraints, it <span class="bcp14">MAY</span> be
   discarded, thereby releasing any persistent storage that may have
   been allocated to it.<a class="pilcrow" href="#section-5.11-1">¶</a></p>
</section>
</div>
<div id="sect-5.12">
<section id="section-5.12">
        <h3 id="name-canceling-a-transmission">
<a class="section-number selfRef" href="#section-5.12">5.12. </a><a class="section-name selfRef" href="#name-canceling-a-transmission">Canceling a Transmission</a>
        </h3>
<p id="section-5.12-1">
   When requested to cancel a specified transmission, where the bundle
   created upon initiation of the indicated transmission has not yet
   been discarded, the BPA <span class="bcp14">MUST</span> delete that bundle
   for the reason "Transmission canceled". For this purpose, the
   procedure defined in <a class="xref" href="#sect-5.10">Section 5.10</a> <span class="bcp14">MUST</span> be followed.<a class="pilcrow" href="#section-5.12-1">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-6">
<section id="section-6">
      <h2 id="name-administrative-record-proce">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-administrative-record-proce">Administrative Record Processing</a>
      </h2>
<div id="sect-6.1">
<section id="section-6.1">
        <h3 id="name-administrative-records">
<a class="section-number selfRef" href="#section-6.1">6.1. </a><a class="section-name selfRef" href="#name-administrative-records">Administrative Records</a>
        </h3>
<p id="section-6.1-1">
   Administrative records are standard ADUs that are
   used in providing some of the features of the Bundle Protocol.
   Bundle Protocol administrative record types are registered in the
   IANA "Bundle Administrative Record Types" registry <span>[<a class="xref" href="#RFC5050">RFC5050</a>]</span>;
   of these, only administrative record type 1, "Bundle status report", is defined
   for BPv7 at this time. Note that additional types of administrative
   records may be defined by supplementary DTN protocol specification
   documents.<a class="pilcrow" href="#section-6.1-1">¶</a></p>
<p id="section-6.1-2">
   Every administrative record consists of:<a class="pilcrow" href="#section-6.1-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-3.1">A record type code (an unsigned integer for which valid values are
          as defined below).<a class="pilcrow" href="#section-6.1-3.1">¶</a>
</li>
          <li class="normal" id="section-6.1-3.2">Record content in type-specific format.<a class="pilcrow" href="#section-6.1-3.2">¶</a>
</li>
        </ul>
<p id="section-6.1-4">
   Each BP administrative record <span class="bcp14">SHALL</span> be represented as a CBOR array
   comprising two items.<a class="pilcrow" href="#section-6.1-4">¶</a></p>
<p id="section-6.1-5">
   The first item of the array <span class="bcp14">SHALL</span> be a record type code, which <span class="bcp14">SHALL</span>
   be represented as a CBOR unsigned integer.<a class="pilcrow" href="#section-6.1-5">¶</a></p>
<p id="section-6.1-6">
   The second element of this array <span class="bcp14">SHALL</span> be the applicable CBOR
   encoding of the content of the record.  Details of the CBOR
   encoding of administrative record type 1 are provided below.
   Details of the CBOR encoding of other types of administrative
   records are included in the specifications defining those
   records.<a class="pilcrow" href="#section-6.1-6">¶</a></p>
<div id="sect-6.1.1">
<section id="section-6.1.1">
          <h4 id="name-bundle-status-reports">
<a class="section-number selfRef" href="#section-6.1.1">6.1.1. </a><a class="section-name selfRef" href="#name-bundle-status-reports">Bundle Status Reports</a>
          </h4>
<p id="section-6.1.1-1">
   The transmission of "bundle status reports" under specified
   conditions is an option that can be invoked when transmission of a
   bundle is requested. These reports are intended to provide
   information about how bundles are progressing through the system,
   including notices of receipt, forwarding, final delivery, and
   deletion. They are transmitted to the report-to endpoints of
   bundles.<a class="pilcrow" href="#section-6.1.1-1">¶</a></p>
<p id="section-6.1.1-2">
   Each bundle status report <span class="bcp14">SHALL</span> be represented as a CBOR array.  The
   number of elements in the array <span class="bcp14">SHALL</span> be either 6 (if the subject
   bundle is a fragment) or 4 (otherwise).<a class="pilcrow" href="#section-6.1.1-2">¶</a></p>
<p id="section-6.1.1-3">
   The first element of the bundle status report <span class="bcp14">SHALL</span> be bundle
   status information represented as a CBOR array of at least four
   elements.  The first four elements of the bundle status information
   shall provide information on the following four status
   assertions, in this order:<a class="pilcrow" href="#section-6.1.1-3">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.1-4.1">Reporting node received bundle.<a class="pilcrow" href="#section-6.1.1-4.1">¶</a>
</li>
            <li class="normal" id="section-6.1.1-4.2">Reporting node forwarded the bundle.<a class="pilcrow" href="#section-6.1.1-4.2">¶</a>
</li>
            <li class="normal" id="section-6.1.1-4.3">Reporting node delivered the bundle.<a class="pilcrow" href="#section-6.1.1-4.3">¶</a>
</li>
            <li class="normal" id="section-6.1.1-4.4">Reporting node deleted the bundle.<a class="pilcrow" href="#section-6.1.1-4.4">¶</a>
</li>
          </ul>
<p id="section-6.1.1-5">
   Each element of the bundle status information <span class="bcp14">SHALL</span> be a bundle
   status item encoded as a CBOR array.<a class="pilcrow" href="#section-6.1.1-5">¶</a></p>
<p id="section-6.1.1-6">The number of elements in
   each bundle status item <span class="bcp14">SHALL</span> be either 2 (if the value of the first element of
   the bundle status item is 1 AND the "Report status time" flag was
   set to 1 in the bundle processing control flags of the bundle whose status
   is being reported) or 1 (otherwise).<a class="pilcrow" href="#section-6.1.1-6">¶</a></p>
<p id="section-6.1.1-7">The first element of each bundle status item <span class="bcp14">SHALL</span>
   be a status indicator, a Boolean value indicating whether or not the
   corresponding bundle status is asserted, encoded as a CBOR Boolean value.
   If present, the second element of each bundle status item
   <span class="bcp14">SHALL</span> indicate the time (as reported by the local system clock;
   this is an implementation matter) at which the indicated status was asserted for
   this bundle, represented as a DTN time as described in <a class="xref" href="#sect-4.2.6">Section 4.2.6</a>.<a class="pilcrow" href="#section-6.1.1-7">¶</a></p>
<p id="section-6.1.1-8">
   The second element of the bundle status report <span class="bcp14">SHALL</span> be the
   bundle status report reason code explaining the value of the status
   indicator, represented as a CBOR unsigned integer. Valid status
   report reason codes are registered in the IANA "Bundle Status Report
   Reason Codes" subregistry in the "Bundle Protocol" registry (see <a class="xref" href="#sect-9.5">Section 9.5</a>).  The initial contents of that registry are listed in <a class="xref" href="#tab-1">Table 1</a>, but the list of status report reason codes provided here is
   neither exhaustive nor exclusive; supplementary DTN protocol
   specifications (including, but not restricted to, Bundle Protocol 
   Security <span>[<a class="xref" href="#RFC9172">BPSEC</a>]</span>) may define additional reason codes.<a class="pilcrow" href="#section-6.1.1-8">¶</a></p>
<span id="name-status-report-reason-codes"></span><div id="tab-1">
<table class="left" id="table-1">
            <caption>
<a class="selfRef" href="#table-1">Table 1</a>:
<a class="selfRef" href="#name-status-report-reason-codes">Status Report Reason Codes</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" colspan="1" rowspan="1">Value</th>
                <th class="text-left" colspan="1" rowspan="1">Meaning</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0</td>
                <td class="text-left" colspan="1" rowspan="1">No additional information.</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">1</td>
                <td class="text-left" colspan="1" rowspan="1">Lifetime expired.</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">2</td>
                <td class="text-left" colspan="1" rowspan="1">Forwarded over unidirectional link.</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">3</td>
                <td class="text-left" colspan="1" rowspan="1">Transmission canceled.</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">4</td>
                <td class="text-left" colspan="1" rowspan="1">Depleted storage.</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">5</td>
                <td class="text-left" colspan="1" rowspan="1">Destination endpoint ID unavailable.</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">6</td>
                <td class="text-left" colspan="1" rowspan="1">No known route to destination from here.</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">7</td>
                <td class="text-left" colspan="1" rowspan="1">No timely contact with next node on route.</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">8</td>
                <td class="text-left" colspan="1" rowspan="1">Block unintelligible.</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">9</td>
                <td class="text-left" colspan="1" rowspan="1">Hop limit exceeded.</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">10</td>
                <td class="text-left" colspan="1" rowspan="1">Traffic pared (e.g., status reports).</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">11</td>
                <td class="text-left" colspan="1" rowspan="1">Block unsupported.</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">17-254</td>
                <td class="text-left" colspan="1" rowspan="1">Unassigned</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">255</td>
                <td class="text-left" colspan="1" rowspan="1">Reserved</td>
              </tr>
            </tbody>
          </table>
</div>
<p id="section-6.1.1-10">
   The third element of the bundle status report <span class="bcp14">SHALL</span> be the source
   node ID identifying the source of the bundle whose status is being
   reported, represented as described in <a class="xref" href="#sect-4.2.5.1.1">Section 4.2.5.1.1</a>.<a class="pilcrow" href="#section-6.1.1-10">¶</a></p>
<p id="section-6.1.1-11">
   The fourth element of the bundle status report <span class="bcp14">SHALL</span> be the
   creation timestamp of the bundle whose status is being reported,
   represented as described in <a class="xref" href="#sect-4.2.7">Section 4.2.7</a>.<a class="pilcrow" href="#section-6.1.1-11">¶</a></p>
<p id="section-6.1.1-12">
   The fifth element of the bundle status report <span class="bcp14">SHALL</span> be present if
   and only if the bundle whose status is being reported contained a
   fragment offset.  If present, it <span class="bcp14">SHALL</span> be the subject bundle's
   fragment offset represented as a CBOR unsigned integer item.<a class="pilcrow" href="#section-6.1.1-12">¶</a></p>
<p id="section-6.1.1-13">
   The sixth element of the bundle status report <span class="bcp14">SHALL</span> be present if
   and only if the bundle whose status is being reported contained a
   fragment offset.  If present, it <span class="bcp14">SHALL</span> be the length of the subject
   bundle's payload represented as a CBOR unsigned integer item.<a class="pilcrow" href="#section-6.1.1-13">¶</a></p>
<p id="section-6.1.1-14">
   Note that the forwarding parameters (such as lifetime, applicable
   security measures, etc.) of the bundle whose status is being
   reported <span class="bcp14">MAY</span> be reflected in the parameters governing the forwarding
   of the bundle that conveys a status report, but this is an
   implementation matter.  Bundle Protocol deployment experience to
   date has not been sufficient to suggest any clear guidance on this
   topic.<a class="pilcrow" href="#section-6.1.1-14">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-6.2">
<section id="section-6.2">
        <h3 id="name-generation-of-administrative">
<a class="section-number selfRef" href="#section-6.2">6.2. </a><a class="section-name selfRef" href="#name-generation-of-administrative">Generation of Administrative Records</a>
        </h3>
<p id="section-6.2-1">
   Whenever the application agent's administrative element is directed
   by the BPA to generate an administrative record,
        the following procedure must be followed:<a class="pilcrow" href="#section-6.2-1">¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-6.2-2">
        <dt>Step 1:</dt>
<dd id="section-6.2-2.1" style="margin-left: 4.5em">
   The administrative record must be constructed. If the
   administrative record references a bundle and the referenced bundle
   is a fragment, the administrative record <span class="bcp14">MUST</span> contain the fragment
   offset and fragment length.<a class="pilcrow" href="#section-6.2-2.1">¶</a>
</dd>
          <dd class="break"></dd>
<dt>Step 2:</dt>
<dd id="section-6.2-2.2" style="margin-left: 4.5em">
   A request for transmission of a bundle whose payload is this
   administrative record <span class="bcp14">MUST</span> be presented to the BPA.<a class="pilcrow" href="#section-6.2-2.2">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="sect-7">
<section id="section-7">
      <h2 id="name-services-required-of-the-co">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-services-required-of-the-co">Services Required of the Convergence Layer</a>
      </h2>
<div id="sect-7.1">
<section id="section-7.1">
        <h3 id="name-the-convergence-layer">
<a class="section-number selfRef" href="#section-7.1">7.1. </a><a class="section-name selfRef" href="#name-the-convergence-layer">The Convergence Layer</a>
        </h3>
<p id="section-7.1-1">
   The successful operation of the end-to-end Bundle Protocol depends
   on the operation of underlying protocols at what is termed the
   "convergence layer"; these protocols accomplish communication
   between nodes. A wide variety of protocols may serve this purpose,
   so long as each CLA provides a
   defined minimal set of services to the BPA. This
   convergence-layer service specification enumerates those services.<a class="pilcrow" href="#section-7.1-1">¶</a></p>
</section>
</div>
<div id="sect-7.2">
<section id="section-7.2">
        <h3 id="name-summary-of-convergence-laye">
<a class="section-number selfRef" href="#section-7.2">7.2. </a><a class="section-name selfRef" href="#name-summary-of-convergence-laye">Summary of Convergence-Layer Services</a>
        </h3>
<p id="section-7.2-1">
   Each CLA is expected to provide the
   following services to the BPA:<a class="pilcrow" href="#section-7.2-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.2-2.1">sending a bundle to a bundle node that is reachable via the
          convergence-layer protocol.<a class="pilcrow" href="#section-7.2-2.1">¶</a>
</li>
          <li class="normal" id="section-7.2-2.2">notifying the BPA of the disposition of its
          data-sending procedures with regard to a bundle, upon concluding
          those procedures.<a class="pilcrow" href="#section-7.2-2.2">¶</a>
</li>
          <li class="normal" id="section-7.2-2.3">delivering to the BPA a bundle that was sent by
          a bundle node via the convergence-layer protocol.<a class="pilcrow" href="#section-7.2-2.3">¶</a>
</li>
        </ul>
<p id="section-7.2-3">
   The convergence-layer service interface specified here is neither
   exhaustive nor exclusive. That is, supplementary DTN protocol
   specifications (including, but not restricted to, Bundle Protocol 
   Security <span>[<a class="xref" href="#RFC9172">BPSEC</a>]</span>) may expect CLAs
   that serve BP implementations conforming to those protocols to
   provide additional services such as reporting on the transmission
   and/or reception progress of individual bundles (at completion
   and/or incrementally), retransmitting data that were lost in
   transit, discarding bundle-conveying data units that the
   convergence-layer protocol determines are corrupt or inauthentic, or reporting
   on the integrity and/or authenticity of delivered bundles.<a class="pilcrow" href="#section-7.2-3">¶</a></p>
<p id="section-7.2-4">
   In addition, the Bundle Protocol relies on the capabilities of protocols at the
   convergence layer to minimize congestion in the store-carry-forward overlay
   network.  The potentially long round-trip times characterizing
   delay-tolerant networks are incompatible with end-to-end, reactive
   congestion-control mechanisms, so convergence-layer protocols <span class="bcp14">MUST</span> provide
   rate limiting or congestion control.<a class="pilcrow" href="#section-7.2-4">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-8">
<section id="section-8">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-8">8. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<p id="section-8-1">
   The Bundle Protocol security architecture and the available security
   services are specified in an accompanying document, the Bundle Protocol Security
   (BPSec) specification <span>[<a class="xref" href="#RFC9172">BPSEC</a>]</span>.  Whenever Bundle
   Protocol security services (as opposed to the security services
   provided by overlying application protocols or underlying
   convergence-layer protocols) are required, those services <span class="bcp14">SHALL</span> be
   provided by BPSec rather than by some other mechanism with the same
   or similar scope.<a class="pilcrow" href="#section-8-1">¶</a></p>
<p id="section-8-2">
   A Bundle Protocol Agent (BPA) that sources, cryptographically
   verifies, and/or accepts a bundle <span class="bcp14">MUST</span> implement support for BPSec.
   Use of BPSec for any single bundle is optional.<a class="pilcrow" href="#section-8-2">¶</a></p>
<p id="section-8-3">
   The BPSec extensions to the Bundle Protocol enable each block of a
   bundle (other than a BPSec extension block) to be individually
   authenticated by a signature block (Block Integrity Block, or BIB)
   and also enable each block of a bundle other than the primary block
   (and the BPSec extension blocks themselves) to be individually
   encrypted by a Block Confidentiality Block (BCB).<a class="pilcrow" href="#section-8-3">¶</a></p>
<p id="section-8-4">
   Because the security mechanisms are extension blocks that are
   themselves inserted into the bundle, the protections they afford
   apply while the bundle is at rest, awaiting transmission at the next
   forwarding opportunity, as well as in transit.<a class="pilcrow" href="#section-8-4">¶</a></p>
<p id="section-8-5">
   Additionally, convergence-layer protocols that ensure authenticity
   of communication between adjacent nodes in a BP network topology
   <span class="bcp14">SHOULD</span> be used where available, to minimize the ability of
   unauthenticated nodes to introduce inauthentic traffic into the
   network.  Convergence-layer protocols that ensure confidentiality of
   communication between adjacent nodes in a BP network topology <span class="bcp14">SHOULD</span>
   also be used where available, to minimize exposure of the bundle's
   primary block and other cleartext blocks, thereby offering some
   defense against traffic analysis.<a class="pilcrow" href="#section-8-5">¶</a></p>
<p id="section-8-6">
   In order to provide authenticity and/or confidentiality of
   communication between BP nodes, the convergence-layer protocol
   requires as input the name or names of the expected communication peer(s).
   These must be supplied by the CLA. Details of
   the means by which the CLA determines which CL endpoint name(s) must
   be provided to the CL protocol are out of scope for this
   specification. Note, though, that when the CL endpoint names are a
   function of BP endpoint IDs, the correctness and authenticity of
   that mapping will be vital to the overall security properties that
   the CL provides to the system.<a class="pilcrow" href="#section-8-6">¶</a></p>
<p id="section-8-7">
   Note that, while the primary block must remain in the clear for
   routing purposes, the Bundle Protocol could be protected against
   traffic analysis to some extent by using bundle-in-bundle
   encapsulation <span>[<a class="xref" href="#I-D.ietf-dtn-bibect">BIBE</a>]</span> to tunnel bundles to a safe forward
   distribution point: the encapsulated bundle could form the payload
   of an encapsulating bundle, and that payload block could be
   encrypted by a BCB.<a class="pilcrow" href="#section-8-7">¶</a></p>
<p id="section-8-8">
   Note that the generation of bundle status reports is disabled by
   default because malicious initiation of bundle status reporting
   could result in the transmission of extremely large numbers of
   bundles, effecting a denial-of-service attack.  Imposing bundle
   lifetime overrides would constitute one defense against such an
   attack.<a class="pilcrow" href="#section-8-8">¶</a></p>
<p id="section-8-9">
   Note also that the reception of large numbers of fragmentary bundles
   with very long lifetimes could constitute a denial-of-service
   attack, occupying storage while pending reassembly that will never
   occur.  Imposing bundle lifetime overrides would, again, constitute
   one defense against such an attack.<a class="pilcrow" href="#section-8-9">¶</a></p>
<p id="section-8-10">
   This protocol makes use of absolute timestamps for several purposes.
   Provisions are included for nodes without accurate clocks to retain
   most of the protocol functionality, but nodes that are unaware that
   their clock is inaccurate may exhibit unexpected behavior.<a class="pilcrow" href="#section-8-10">¶</a></p>
</section>
</div>
<div id="sect-9">
<section id="section-9">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-9">9. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<p id="section-9-1">
   The Bundle Protocol includes fields requiring registries managed by
   IANA.<a class="pilcrow" href="#section-9-1">¶</a></p>
<div id="sect-9.1">
<section id="section-9.1">
        <h3 id="name-bundle-block-types">
<a class="section-number selfRef" href="#section-9.1">9.1. </a><a class="section-name selfRef" href="#name-bundle-block-types">Bundle Block Types</a>
        </h3>
<p id="section-9.1-1">
   The "Bundle Block Types" subregistry in the "Bundle Protocol"
   registry has been augmented by adding a column identifying the version of
   the Bundle Protocol (Bundle Protocol Version) that applies to the
   values.  IANA has added the following values, as
   described in <a class="xref" href="#sect-4.3.1">Section 4.3.1</a>, to the "Bundle Block Types" registry
   with a value of "7" for the Bundle Protocol Version. IANA
   has set the Bundle Protocol Version to "6" or "6,7" for 
   preexisting values in the "Bundle Block Types" registry,
   as shown below.<a class="pilcrow" href="#section-9.1-1">¶</a></p>
<span id="name-bundle-block-types-registry"></span><table class="left" id="table-2">
          <caption>
<a class="selfRef" href="#table-2">Table 2</a>:
<a class="selfRef" href="#name-bundle-block-types-registry">"Bundle Block Types" Registry</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Bundle Protocol Version</th>
              <th class="text-left" colspan="1" rowspan="1">Value</th>
              <th class="text-left" colspan="1" rowspan="1">Description</th>
              <th class="text-left" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">none</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">Reserved</td>
              <td class="text-left" colspan="1" rowspan="1">
                <span>[<a class="xref" href="#RFC6255">RFC6255</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">6,7</td>
              <td class="text-left" colspan="1" rowspan="1">1</td>
              <td class="text-left" colspan="1" rowspan="1">Bundle Payload Block</td>
              <td class="text-left" colspan="1" rowspan="1">
                <span>[<a class="xref" href="#RFC5050">RFC5050</a>]</span> [RFC9171]</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">6</td>
              <td class="text-left" colspan="1" rowspan="1">2</td>
              <td class="text-left" colspan="1" rowspan="1">Bundle Authentication Block</td>
              <td class="text-left" colspan="1" rowspan="1">
                <span>[<a class="xref" href="#RFC6257">RFC6257</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">6</td>
              <td class="text-left" colspan="1" rowspan="1">3</td>
              <td class="text-left" colspan="1" rowspan="1">Payload Integrity Block</td>
              <td class="text-left" colspan="1" rowspan="1">
                <span>[<a class="xref" href="#RFC6257">RFC6257</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">6</td>
              <td class="text-left" colspan="1" rowspan="1">4</td>
              <td class="text-left" colspan="1" rowspan="1">Payload Confidentiality Block</td>
              <td class="text-left" colspan="1" rowspan="1">
                <span>[<a class="xref" href="#RFC6257">RFC6257</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">6</td>
              <td class="text-left" colspan="1" rowspan="1">5</td>
              <td class="text-left" colspan="1" rowspan="1">Previous-Hop Insertion Block</td>
              <td class="text-left" colspan="1" rowspan="1">
                <span>[<a class="xref" href="#RFC6259">RFC6259</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">7</td>
              <td class="text-left" colspan="1" rowspan="1">6</td>
              <td class="text-left" colspan="1" rowspan="1">Previous node (proximate sender)</td>
              <td class="text-left" colspan="1" rowspan="1">[RFC9171]</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">7</td>
              <td class="text-left" colspan="1" rowspan="1">7</td>
              <td class="text-left" colspan="1" rowspan="1">Bundle age (in milliseconds)</td>
              <td class="text-left" colspan="1" rowspan="1">[RFC9171]</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">6</td>
              <td class="text-left" colspan="1" rowspan="1">8</td>
              <td class="text-left" colspan="1" rowspan="1">Metadata Extension Block</td>
              <td class="text-left" colspan="1" rowspan="1">
                <span>[<a class="xref" href="#RFC6258">RFC6258</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">6</td>
              <td class="text-left" colspan="1" rowspan="1">9</td>
              <td class="text-left" colspan="1" rowspan="1">Extension Security Block</td>
              <td class="text-left" colspan="1" rowspan="1">
                <span>[<a class="xref" href="#RFC6257">RFC6257</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">7</td>
              <td class="text-left" colspan="1" rowspan="1">10</td>
              <td class="text-left" colspan="1" rowspan="1">Hop count (#prior xmit attempts)</td>
              <td class="text-left" colspan="1" rowspan="1">[RFC9171]</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">7</td>
              <td class="text-left" colspan="1" rowspan="1">11-191</td>
              <td class="text-left" colspan="1" rowspan="1">Unassigned</td>
              <td class="text-left" colspan="1" rowspan="1"></td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">6,7</td>
              <td class="text-left" colspan="1" rowspan="1">192-255</td>
              <td class="text-left" colspan="1" rowspan="1">Reserved for Private and/or Experimental Use</td>
              <td class="text-left" colspan="1" rowspan="1">
                <span>[<a class="xref" href="#RFC5050">RFC5050</a>]</span> [RFC9171]</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="sect-9.2">
<section id="section-9.2">
        <h3 id="name-primary-bundle-protocol-ver">
<a class="section-number selfRef" href="#section-9.2">9.2. </a><a class="section-name selfRef" href="#name-primary-bundle-protocol-ver">Primary Bundle Protocol Version</a>
        </h3>
<p id="section-9.2-1">
   IANA has added the following value to the "Primary Bundle
   Protocol Version" subregistry in the "Bundle Protocol" registry.<a class="pilcrow" href="#section-9.2-1">¶</a></p>
<span id="name-primary-bundle-protocol-vers"></span><table class="left" id="table-3">
          <caption>
<a class="selfRef" href="#table-3">Table 3</a>:
<a class="selfRef" href="#name-primary-bundle-protocol-vers">"Primary Bundle Protocol Version" Registry</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Value</th>
              <th class="text-left" colspan="1" rowspan="1">Description</th>
              <th class="text-left" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">7</td>
              <td class="text-left" colspan="1" rowspan="1">Assigned</td>
              <td class="text-left" colspan="1" rowspan="1">[RFC9171]</td>
            </tr>
          </tbody>
        </table>
<p id="section-9.2-3"> Values 8-255 (rather than 7-255) are now Unassigned.<a class="pilcrow" href="#section-9.2-3">¶</a></p>
</section>
</div>
<div id="sect-9.3">
<section id="section-9.3">
        <h3 id="name-bundle-processing-control-fl">
<a class="section-number selfRef" href="#section-9.3">9.3. </a><a class="section-name selfRef" href="#name-bundle-processing-control-fl">Bundle Processing Control Flags</a>
        </h3>
<p id="section-9.3-1">
   The "Bundle Processing Control Flags" subregistry in the "Bundle
   Protocol" registry has been augmented by adding a column identifying the
   version of the Bundle Protocol (Bundle Protocol Version) that
   applies to the new values.  IANA has added the following
   values, as described in <a class="xref" href="#sect-4.2.3">Section 4.2.3</a>, to the "Bundle Processing
   Control Flags" registry with a value of "7" for the Bundle Protocol Version.
 IANA has set the Bundle Protocol Version to the value "6" or "6,7" for preexisting values in the "Bundle Processing
   Control Flags" registry, as shown below.<a class="pilcrow" href="#section-9.3-1">¶</a></p>
<span id="name-bundle-processing-control-fla"></span><table class="left" id="table-4">
          <caption>
<a class="selfRef" href="#table-4">Table 4</a>:
<a class="selfRef" href="#name-bundle-processing-control-fla">"Bundle Processing Control Flags" Registry</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Bundle Protocol Version</th>
              <th class="text-left" colspan="1" rowspan="1">Bit Position (right to left)</th>
              <th class="text-left" colspan="1" rowspan="1">Description</th>
              <th class="text-left" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">6,7</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">Bundle is a fragment</td>
              <td class="text-left" colspan="1" rowspan="1">
                <span>[<a class="xref" href="#RFC5050">RFC5050</a>]</span> [RFC9171]</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">6,7</td>
              <td class="text-left" colspan="1" rowspan="1">1</td>
              <td class="text-left" colspan="1" rowspan="1">ADU is an administrative record</td>
              <td class="text-left" colspan="1" rowspan="1">
                <span>[<a class="xref" href="#RFC5050">RFC5050</a>]</span> [RFC9171]</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">6,7</td>
              <td class="text-left" colspan="1" rowspan="1">2</td>
              <td class="text-left" colspan="1" rowspan="1">Bundle must not be fragmented</td>
              <td class="text-left" colspan="1" rowspan="1">
                <span>[<a class="xref" href="#RFC5050">RFC5050</a>]</span> [RFC9171]</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">6</td>
              <td class="text-left" colspan="1" rowspan="1">3</td>
              <td class="text-left" colspan="1" rowspan="1">Custody transfer is requested</td>
              <td class="text-left" colspan="1" rowspan="1">
                <span>[<a class="xref" href="#RFC5050">RFC5050</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">6</td>
              <td class="text-left" colspan="1" rowspan="1">4</td>
              <td class="text-left" colspan="1" rowspan="1">Destination endpoint is a singleton</td>
              <td class="text-left" colspan="1" rowspan="1">
                <span>[<a class="xref" href="#RFC5050">RFC5050</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">6,7</td>
              <td class="text-left" colspan="1" rowspan="1">5</td>
              <td class="text-left" colspan="1" rowspan="1">Acknowledgement by application is requested</td>
              <td class="text-left" colspan="1" rowspan="1">
                <span>[<a class="xref" href="#RFC5050">RFC5050</a>]</span> [RFC9171]</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">7</td>
              <td class="text-left" colspan="1" rowspan="1">6</td>
              <td class="text-left" colspan="1" rowspan="1">Status time requested in reports</td>
              <td class="text-left" colspan="1" rowspan="1">[RFC9171]</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">6</td>
              <td class="text-left" colspan="1" rowspan="1">7-8</td>
              <td class="text-left" colspan="1" rowspan="1">Class of service: priority</td>
              <td class="text-left" colspan="1" rowspan="1">
                <span>[<a class="xref" href="#RFC5050">RFC5050</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">6</td>
              <td class="text-left" colspan="1" rowspan="1">9-13</td>
              <td class="text-left" colspan="1" rowspan="1">Class of service: reserved</td>
              <td class="text-left" colspan="1" rowspan="1">
                <span>[<a class="xref" href="#RFC5050">RFC5050</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">6,7</td>
              <td class="text-left" colspan="1" rowspan="1">14</td>
              <td class="text-left" colspan="1" rowspan="1">Request reporting of bundle reception</td>
              <td class="text-left" colspan="1" rowspan="1">
                <span>[<a class="xref" href="#RFC5050">RFC5050</a>]</span> [RFC9171]</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">6</td>
              <td class="text-left" colspan="1" rowspan="1">15</td>
              <td class="text-left" colspan="1" rowspan="1">Request reporting of custody acceptance</td>
              <td class="text-left" colspan="1" rowspan="1">
                <span>[<a class="xref" href="#RFC5050">RFC5050</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">6,7</td>
              <td class="text-left" colspan="1" rowspan="1">16</td>
              <td class="text-left" colspan="1" rowspan="1">Request reporting of bundle forwarding</td>
              <td class="text-left" colspan="1" rowspan="1">
                <span>[<a class="xref" href="#RFC5050">RFC5050</a>]</span> [RFC9171]</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">6,7</td>
              <td class="text-left" colspan="1" rowspan="1">17</td>
              <td class="text-left" colspan="1" rowspan="1">Request reporting of bundle delivery</td>
              <td class="text-left" colspan="1" rowspan="1">
                <span>[<a class="xref" href="#RFC5050">RFC5050</a>]</span> [RFC9171]</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">6,7</td>
              <td class="text-left" colspan="1" rowspan="1">18</td>
              <td class="text-left" colspan="1" rowspan="1">Request reporting of bundle deletion</td>
              <td class="text-left" colspan="1" rowspan="1">
                <span>[<a class="xref" href="#RFC5050">RFC5050</a>]</span> [RFC9171]</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">6,7</td>
              <td class="text-left" colspan="1" rowspan="1">19</td>
              <td class="text-left" colspan="1" rowspan="1">Reserved</td>
              <td class="text-left" colspan="1" rowspan="1">
                <span>[<a class="xref" href="#RFC5050">RFC5050</a>]</span> [RFC9171]</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">6,7</td>
              <td class="text-left" colspan="1" rowspan="1">20</td>
              <td class="text-left" colspan="1" rowspan="1">Reserved</td>
              <td class="text-left" colspan="1" rowspan="1">
                <span>[<a class="xref" href="#RFC5050">RFC5050</a>]</span> [RFC9171]</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1"></td>
              <td class="text-left" colspan="1" rowspan="1">21-63</td>
              <td class="text-left" colspan="1" rowspan="1">Unassigned</td>
              <td class="text-left" colspan="1" rowspan="1"></td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="sect-9.4">
<section id="section-9.4">
        <h3 id="name-block-processing-control-fla">
<a class="section-number selfRef" href="#section-9.4">9.4. </a><a class="section-name selfRef" href="#name-block-processing-control-fla">Block Processing Control Flags</a>
        </h3>
<p id="section-9.4-1">
   The "Block Processing Control Flags" subregistry in the "Bundle
   Protocol" registry has been augmented by adding a column identifying the
   version of the Bundle Protocol (Bundle Protocol Version) that
   applies to the related BP version.  IANA has set the Bundle Protocol 
   Version to the value "6" or "6,7" for preexisting values in the "Bundle Processing
   Control Flags" registry, as shown below.<a class="pilcrow" href="#section-9.4-1">¶</a></p>
<span id="name-block-processing-control-flag"></span><table class="left" id="table-5">
          <caption>
<a class="selfRef" href="#table-5">Table 5</a>:
<a class="selfRef" href="#name-block-processing-control-flag">"Block Processing Control Flags" Registry</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Bundle Protocol Version</th>
              <th class="text-left" colspan="1" rowspan="1">
                <p id="section-9.4-2.1.1.0.1">Bit Position (right to left)<a class="pilcrow" href="#section-9.4-2.1.1.0.1">¶</a></p>
</th>
              <th class="text-left" colspan="1" rowspan="1">Description</th>
              <th class="text-left" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">6,7</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">Block must be replicated in every fragment</td>
              <td class="text-left" colspan="1" rowspan="1">
                <span>[<a class="xref" href="#RFC5050">RFC5050</a>]</span> [RFC9171]</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">6,7</td>
              <td class="text-left" colspan="1" rowspan="1">1</td>
              <td class="text-left" colspan="1" rowspan="1">Transmit status report if block  can't be processed</td>
              <td class="text-left" colspan="1" rowspan="1">
                <span>[<a class="xref" href="#RFC5050">RFC5050</a>]</span> [RFC9171]</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">6,7</td>
              <td class="text-left" colspan="1" rowspan="1">2</td>
              <td class="text-left" colspan="1" rowspan="1">Delete bundle if block can't be processed</td>
              <td class="text-left" colspan="1" rowspan="1">
                <span>[<a class="xref" href="#RFC5050">RFC5050</a>]</span> [RFC9171]</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">6</td>
              <td class="text-left" colspan="1" rowspan="1">3</td>
              <td class="text-left" colspan="1" rowspan="1">Last block</td>
              <td class="text-left" colspan="1" rowspan="1">
                <span>[<a class="xref" href="#RFC5050">RFC5050</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">6,7</td>
              <td class="text-left" colspan="1" rowspan="1">4</td>
              <td class="text-left" colspan="1" rowspan="1">Discard block if it can't be processed</td>
              <td class="text-left" colspan="1" rowspan="1">
                <span>[<a class="xref" href="#RFC5050">RFC5050</a>]</span> [RFC9171]</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">6</td>
              <td class="text-left" colspan="1" rowspan="1">5</td>
              <td class="text-left" colspan="1" rowspan="1">Block was forwarded without being processed</td>
              <td class="text-left" colspan="1" rowspan="1">
                <span>[<a class="xref" href="#RFC5050">RFC5050</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">6</td>
              <td class="text-left" colspan="1" rowspan="1">6</td>
              <td class="text-left" colspan="1" rowspan="1">Block contains an EID-reference field</td>
              <td class="text-left" colspan="1" rowspan="1">
                <span>[<a class="xref" href="#RFC5050">RFC5050</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1"></td>
              <td class="text-left" colspan="1" rowspan="1">7-63</td>
              <td class="text-left" colspan="1" rowspan="1">Unassigned</td>
              <td class="text-left" colspan="1" rowspan="1"></td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="sect-9.5">
<section id="section-9.5">
        <h3 id="name-bundle-status-report-reason">
<a class="section-number selfRef" href="#section-9.5">9.5. </a><a class="section-name selfRef" href="#name-bundle-status-report-reason">Bundle Status Report Reason Codes</a>
        </h3>
<p id="section-9.5-1">
   The "Bundle Status Report Reason Codes" subregistry in the "Bundle
   Protocol" registry has been augmented by adding a column identifying the
   version of the Bundle Protocol (Bundle Protocol Version) that
   applies to the new values.  IANA has added the following
   values, as described in <a class="xref" href="#sect-6.1.1">Section 6.1.1</a>, to the "Bundle Status Report
   Reason Codes" registry with a value of "7" for the Bundle Protocol Version.  IANA has set the Bundle Protocol
   Version to the value "6,7" for preexisting values in the "Bundle Status 
   Report Reason Codes" registry, as shown below.<a class="pilcrow" href="#section-9.5-1">¶</a></p>
<span id="name-bundle-status-report-reason-"></span><table class="left" id="table-6">
          <caption>
<a class="selfRef" href="#table-6">Table 6</a>:
<a class="selfRef" href="#name-bundle-status-report-reason-">"Bundle Status Report Reason Codes" Registry</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Bundle Protocol Version</th>
              <th class="text-left" colspan="1" rowspan="1">Value</th>
              <th class="text-left" colspan="1" rowspan="1">Description</th>
              <th class="text-left" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">6,7</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">No additional information</td>
              <td class="text-left" colspan="1" rowspan="1">
                <span>[<a class="xref" href="#RFC5050">RFC5050</a>]</span> [RFC9171]</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">6,7</td>
              <td class="text-left" colspan="1" rowspan="1">1</td>
              <td class="text-left" colspan="1" rowspan="1">Lifetime expired</td>
              <td class="text-left" colspan="1" rowspan="1">
                <span>[<a class="xref" href="#RFC5050">RFC5050</a>]</span> [RFC9171]</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">6,7</td>
              <td class="text-left" colspan="1" rowspan="1">2</td>
              <td class="text-left" colspan="1" rowspan="1">Forwarded over unidirectional link</td>
              <td class="text-left" colspan="1" rowspan="1">
                <span>[<a class="xref" href="#RFC5050">RFC5050</a>]</span> [RFC9171]</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">6,7</td>
              <td class="text-left" colspan="1" rowspan="1">3</td>
              <td class="text-left" colspan="1" rowspan="1">Transmission canceled</td>
              <td class="text-left" colspan="1" rowspan="1">
                <span>[<a class="xref" href="#RFC5050">RFC5050</a>]</span> [RFC9171]</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">6,7</td>
              <td class="text-left" colspan="1" rowspan="1">4</td>
              <td class="text-left" colspan="1" rowspan="1">Depleted storage</td>
              <td class="text-left" colspan="1" rowspan="1">
                <span>[<a class="xref" href="#RFC5050">RFC5050</a>]</span> [RFC9171]</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">6,7</td>
              <td class="text-left" colspan="1" rowspan="1">5</td>
              <td class="text-left" colspan="1" rowspan="1">Destination endpoint ID unavailable</td>
              <td class="text-left" colspan="1" rowspan="1">
                <span>[<a class="xref" href="#RFC5050">RFC5050</a>]</span> [RFC9171]</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">6,7</td>
              <td class="text-left" colspan="1" rowspan="1">6</td>
              <td class="text-left" colspan="1" rowspan="1">No known route to destination from here</td>
              <td class="text-left" colspan="1" rowspan="1">
                <span>[<a class="xref" href="#RFC5050">RFC5050</a>]</span> [RFC9171]</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">6,7</td>
              <td class="text-left" colspan="1" rowspan="1">7</td>
              <td class="text-left" colspan="1" rowspan="1">No timely contact with next node on route</td>
              <td class="text-left" colspan="1" rowspan="1">
                <span>[<a class="xref" href="#RFC5050">RFC5050</a>]</span> [RFC9171]</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">6,7</td>
              <td class="text-left" colspan="1" rowspan="1">8</td>
              <td class="text-left" colspan="1" rowspan="1">Block unintelligible</td>
              <td class="text-left" colspan="1" rowspan="1">
                <span>[<a class="xref" href="#RFC5050">RFC5050</a>]</span> [RFC9171]</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">7</td>
              <td class="text-left" colspan="1" rowspan="1">9</td>
              <td class="text-left" colspan="1" rowspan="1">Hop limit exceeded</td>
              <td class="text-left" colspan="1" rowspan="1">[RFC9171]</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">7</td>
              <td class="text-left" colspan="1" rowspan="1">10</td>
              <td class="text-left" colspan="1" rowspan="1">Traffic pared</td>
              <td class="text-left" colspan="1" rowspan="1">[RFC9171]</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">7</td>
              <td class="text-left" colspan="1" rowspan="1">11</td>
              <td class="text-left" colspan="1" rowspan="1">Block unsupported</td>
              <td class="text-left" colspan="1" rowspan="1">[RFC9171]</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1"></td>
              <td class="text-left" colspan="1" rowspan="1">17-254</td>
              <td class="text-left" colspan="1" rowspan="1">Unassigned</td>
              <td class="text-left" colspan="1" rowspan="1"></td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">6,7</td>
              <td class="text-left" colspan="1" rowspan="1">255</td>
              <td class="text-left" colspan="1" rowspan="1">Reserved</td>
              <td class="text-left" colspan="1" rowspan="1">
                <span>[<a class="xref" href="#RFC6255">RFC6255</a>]</span> [RFC9171]</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="sect-9.6">
<section id="section-9.6">
        <h3 id="name-bundle-protocol-uri-scheme-">
<a class="section-number selfRef" href="#section-9.6">9.6. </a><a class="section-name selfRef" href="#name-bundle-protocol-uri-scheme-">Bundle Protocol URI Scheme Types</a>
        </h3>
<p id="section-9.6-1">
   The Bundle Protocol has a URI scheme type field -- an unsigned
   integer of indefinite length -- for which IANA has created,
   and will maintain, a new "Bundle Protocol URI Scheme Types" subregistry in the
   "Bundle Protocol" registry.  The "Bundle Protocol URI Scheme Types"
   registry governs a namespace of unsigned integers.  Initial values for
   the "Bundle Protocol URI Scheme Types" registry are given below.<a class="pilcrow" href="#section-9.6-1">¶</a></p>
<p id="section-9.6-2">
   The registration policy for this registry is Standards Action <span>[<a class="xref" href="#RFC8126">RFC8126</a>]</span>. The
   allocation should only be granted for a Standards Track RFC approved
   by the IESG.<a class="pilcrow" href="#section-9.6-2">¶</a></p>
<p id="section-9.6-3">
   The range of values is provided as unsigned integers.<a class="pilcrow" href="#section-9.6-3">¶</a></p>
<p id="section-9.6-4">
   Each assignment consists of a URI scheme type name and its
   associated description, a reference to the document that defines the
   URI scheme, and a reference to the document that defines the use of
   this URI scheme in BP endpoint IDs (including the CBOR
   encoding of those endpoint IDs in transmitted bundles).<a class="pilcrow" href="#section-9.6-4">¶</a></p>
<span id="name-bundle-protocol-uri-scheme-t"></span><table class="left" id="table-7">
          <caption>
<a class="selfRef" href="#table-7">Table 7</a>:
<a class="selfRef" href="#name-bundle-protocol-uri-scheme-t">"Bundle Protocol URI Scheme Types" Registry</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Value</th>
              <th class="text-left" colspan="1" rowspan="1">Description</th>
              <th class="text-left" colspan="1" rowspan="1">BP Utilization Reference</th>
              <th class="text-left" colspan="1" rowspan="1">URI Definition Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">Reserved</td>
              <td class="text-left" colspan="1" rowspan="1">n/a</td>
              <td class="text-left" colspan="1" rowspan="1"></td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">1</td>
              <td class="text-left" colspan="1" rowspan="1">dtn</td>
              <td class="text-left" colspan="1" rowspan="1">[RFC9171]</td>
              <td class="text-left" colspan="1" rowspan="1">[RFC9171]</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">2</td>
              <td class="text-left" colspan="1" rowspan="1">ipn</td>
              <td class="text-left" colspan="1" rowspan="1">[RFC9171]</td>
              <td class="text-left" colspan="1" rowspan="1">
                <span>[<a class="xref" href="#RFC6260">RFC6260</a>]</span> [RFC9171]</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">3-254</td>
              <td class="text-left" colspan="1" rowspan="1">Unassigned</td>
              <td class="text-left" colspan="1" rowspan="1">n/a</td>
              <td class="text-left" colspan="1" rowspan="1"></td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">255-65535</td>
              <td class="text-left" colspan="1" rowspan="1">Reserved</td>
              <td class="text-left" colspan="1" rowspan="1">n/a</td>
              <td class="text-left" colspan="1" rowspan="1"></td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">&gt;65535</td>
              <td class="text-left" colspan="1" rowspan="1">Reserved for Private Use</td>
              <td class="text-left" colspan="1" rowspan="1">n/a</td>
              <td class="text-left" colspan="1" rowspan="1"></td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="sect-9.7">
<section id="section-9.7">
        <h3 id="name-dtn-uri-scheme">
<a class="section-number selfRef" href="#section-9.7">9.7. </a><a class="section-name selfRef" href="#name-dtn-uri-scheme">dtn URI Scheme</a>
        </h3>
<p id="section-9.7-1">
   In the "Uniform Resource Identifier (URI) Schemes" (uri-schemes)
   registry, IANA has updated the registration of the URI
   scheme with the string "dtn" as the scheme name, as follows:<a class="pilcrow" href="#section-9.7-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-9.7-2">
          <dt id="section-9.7-2.1">URI scheme name:</dt>
          <dd id="section-9.7-2.2" style="margin-left: 1.5em">"dtn"<a class="pilcrow" href="#section-9.7-2.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.7-2.3">Status:</dt>
          <dd id="section-9.7-2.4" style="margin-left: 1.5em">Permanent<a class="pilcrow" href="#section-9.7-2.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.7-2.5">Applications and/or protocols that use this URI scheme name:</dt>
          <dd id="section-9.7-2.6" style="margin-left: 1.5em">The Delay-Tolerant Networking (DTN) Bundle Protocol (BP).<a class="pilcrow" href="#section-9.7-2.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.7-2.7">Contact:</dt>
          <dd id="section-9.7-2.8" style="margin-left: 1.5em">
            <p id="section-9.7-2.8.1"><span class="contact-name">Scott Burleigh</span>
          &lt;sburleig.sb@gmail.com&gt;<a class="pilcrow" href="#section-9.7-2.8.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-9.7-2.9">Change controller:</dt>
          <dd id="section-9.7-2.10" style="margin-left: 1.5em">IETF (iesg@ietf.org)<a class="pilcrow" href="#section-9.7-2.10">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.7-2.11">Reference:</dt>
          <dd id="section-9.7-2.12" style="margin-left: 1.5em">[RFC9171]<a class="pilcrow" href="#section-9.7-2.12">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sect-9.8">
<section id="section-9.8">
        <h3 id="name-ipn-uri-scheme">
<a class="section-number selfRef" href="#section-9.8">9.8. </a><a class="section-name selfRef" href="#name-ipn-uri-scheme">ipn URI Scheme</a>
        </h3>
<p id="section-9.8-1">
   In the "Uniform Resource Identifier (URI) Schemes" (uri-schemes)
   registry, IANA has updated the registration of the URI
   scheme with the string "ipn" as the scheme name, originally
   documented in RFC 6260 <span>[<a class="xref" href="#RFC6260">RFC6260</a>]</span>, as follows.<a class="pilcrow" href="#section-9.8-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-9.8-2">
          <dt id="section-9.8-2.1">URI scheme name:</dt>
          <dd id="section-9.8-2.2" style="margin-left: 1.5em">"ipn"<a class="pilcrow" href="#section-9.8-2.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.8-2.3">Status:</dt>
          <dd id="section-9.8-2.4" style="margin-left: 1.5em">Permanent<a class="pilcrow" href="#section-9.8-2.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.8-2.5">Applications and/or protocols that use this URI scheme name:</dt>
          <dd id="section-9.8-2.6" style="margin-left: 1.5em">The Delay-Tolerant Networking (DTN) Bundle Protocol (BP).<a class="pilcrow" href="#section-9.8-2.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.8-2.7">Contact:</dt>
          <dd id="section-9.8-2.8" style="margin-left: 1.5em">
            <p id="section-9.8-2.8.1"><span class="contact-name">Scott Burleigh</span>
          &lt;sburleig.sb@gmail.com&gt;<a class="pilcrow" href="#section-9.8-2.8.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-9.8-2.9">Change controller:</dt>
          <dd id="section-9.8-2.10" style="margin-left: 1.5em">IETF (iesg@ietf.org)<a class="pilcrow" href="#section-9.8-2.10">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.8-2.11">Reference:</dt>
          <dd id="section-9.8-2.12" style="margin-left: 1.5em">[RFC9171]<a class="pilcrow" href="#section-9.8-2.12">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<section id="section-10">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-10">10. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-10.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-10.1">10.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC9172">[BPSEC]</dt>
        <dd>
<span class="refAuthor">Birrane, III, E.</span> and <span class="refAuthor">K. McKeever</span>, <span class="refTitle">"Bundle Protocol Security (BPSec)"</span>, <span class="seriesInfo">RFC 9172</span>, <span class="seriesInfo">DOI 10.17487/RFC9172</span>, <time class="refDate" datetime="2022-01">January 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9172">https://www.rfc-editor.org/info/rfc9172</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="CRC16">[CRC16]</dt>
        <dd>
<span class="refAuthor">ITU-T</span>, <span class="refTitle">"X.25: Interface between Data Terminal Equipment (DTE) and Data Circuit-terminating Equipment (DCE) for terminals operating in the packet mode and connected to public data networks by dedicated circuit"</span>, <span class="refContent">p. 9, Section 2.2.7.4</span>, <span class="seriesInfo">ITU-T Recommendation X.25</span>, <time class="refDate" datetime="1996-10">October 1996</time>, <span>&lt;<a href="https://www.itu.int/rec/T-REC-X.25-199610-I/">https://www.itu.int/rec/T-REC-X.25-199610-I/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time class="refDate" datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4960">[RFC4960]</dt>
        <dd>
<span class="refAuthor">Stewart, R., Ed.</span>, <span class="refTitle">"Stream Control Transmission Protocol"</span>, <span class="seriesInfo">RFC 4960</span>, <span class="seriesInfo">DOI 10.17487/RFC4960</span>, <time class="refDate" datetime="2007-09">September 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4960">https://www.rfc-editor.org/info/rfc4960</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5234">[RFC5234]</dt>
        <dd>
<span class="refAuthor">Crocker, D., Ed.</span> and <span class="refAuthor">P. Overell</span>, <span class="refTitle">"Augmented BNF for Syntax Specifications: ABNF"</span>, <span class="seriesInfo">STD 68</span>, <span class="seriesInfo">RFC 5234</span>, <span class="seriesInfo">DOI 10.17487/RFC5234</span>, <time class="refDate" datetime="2008-01">January 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5234">https://www.rfc-editor.org/info/rfc5234</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time class="refDate" datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8949">[RFC8949]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span> and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">STD 94</span>, <span class="seriesInfo">RFC 8949</span>, <span class="seriesInfo">DOI 10.17487/RFC8949</span>, <time class="refDate" datetime="2020-12">December 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8949">https://www.rfc-editor.org/info/rfc8949</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SABR">[SABR]</dt>
        <dd>
<span class="refAuthor">Consultative Committee for Space Data Systems</span>, <span class="refTitle">"Schedule-Aware Bundle Routing"</span>, <span class="seriesInfo">CCSDS Recommended Standard 734.3-B-1</span>, <time class="refDate" datetime="2019-07">July 2019</time>, <span>&lt;<a href="https://public.ccsds.org/Pubs/734x3b1.pdf">https://public.ccsds.org/Pubs/734x3b1.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9174">[TCPCL]</dt>
        <dd>
<span class="refAuthor">Sipos, B.</span>, <span class="refAuthor">Demmer, M.</span>, <span class="refAuthor">Ott, J.</span>, and <span class="refAuthor">S. Perreault</span>, <span class="refTitle">"Delay-Tolerant Networking TCP Convergence-Layer Protocol Version 4"</span>, <span class="seriesInfo">RFC 9174</span>, <span class="seriesInfo">DOI 10.17487/RFC9174</span>, <time class="refDate" datetime="2022-01">January 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9174">https://www.rfc-editor.org/info/rfc9174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3986">[URI]</dt>
        <dd>
<span class="refAuthor">Berners-Lee, T.</span>, <span class="refAuthor">Fielding, R.</span>, and <span class="refAuthor">L. Masinter</span>, <span class="refTitle">"Uniform Resource Identifier (URI): Generic Syntax"</span>, <span class="seriesInfo">STD 66</span>, <span class="seriesInfo">RFC 3986</span>, <span class="seriesInfo">DOI 10.17487/RFC3986</span>, <time class="refDate" datetime="2005-01">January 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3986">https://www.rfc-editor.org/info/rfc3986</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7595">[URIREG]</dt>
      <dd>
<span class="refAuthor">Thaler, D., Ed.</span>, <span class="refAuthor">Hansen, T.</span>, and <span class="refAuthor">T. Hardie</span>, <span class="refTitle">"Guidelines and Registration Procedures for URI Schemes"</span>, <span class="seriesInfo">BCP 35</span>, <span class="seriesInfo">RFC 7595</span>, <span class="seriesInfo">DOI 10.17487/RFC7595</span>, <time class="refDate" datetime="2015-06">June 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7595">https://www.rfc-editor.org/info/rfc7595</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-10.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-10.2">10.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC4838">[ARCH]</dt>
        <dd>
<span class="refAuthor">Cerf, V.</span>, <span class="refAuthor">Burleigh, S.</span>, <span class="refAuthor">Hooke, A.</span>, <span class="refAuthor">Torgerson, L.</span>, <span class="refAuthor">Durst, R.</span>, <span class="refAuthor">Scott, K.</span>, <span class="refAuthor">Fall, K.</span>, and <span class="refAuthor">H. Weiss</span>, <span class="refTitle">"Delay-Tolerant Networking Architecture"</span>, <span class="seriesInfo">RFC 4838</span>, <span class="seriesInfo">DOI 10.17487/RFC4838</span>, <time class="refDate" datetime="2007-04">April 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4838">https://www.rfc-editor.org/info/rfc4838</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-dtn-bibect">[BIBE]</dt>
        <dd>
<span class="refAuthor">Burleigh, S.</span>, <span class="refTitle">"Bundle-in-Bundle Encapsulation"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-dtn-bibect-03</span>, <time class="refDate" datetime="2020-02-18">18 February 2020</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-dtn-bibect-03">https://datatracker.ietf.org/doc/html/draft-ietf-dtn-bibect-03</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3987">[RFC3987]</dt>
        <dd>
<span class="refAuthor">Duerst, M.</span> and <span class="refAuthor">M. Suignard</span>, <span class="refTitle">"Internationalized Resource Identifiers (IRIs)"</span>, <span class="seriesInfo">RFC 3987</span>, <span class="seriesInfo">DOI 10.17487/RFC3987</span>, <time class="refDate" datetime="2005-01">January 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3987">https://www.rfc-editor.org/info/rfc3987</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5050">[RFC5050]</dt>
        <dd>
<span class="refAuthor">Scott, K.</span> and <span class="refAuthor">S. Burleigh</span>, <span class="refTitle">"Bundle Protocol Specification"</span>, <span class="seriesInfo">RFC 5050</span>, <span class="seriesInfo">DOI 10.17487/RFC5050</span>, <time class="refDate" datetime="2007-11">November 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5050">https://www.rfc-editor.org/info/rfc5050</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6255">[RFC6255]</dt>
        <dd>
<span class="refAuthor">Blanchet, M.</span>, <span class="refTitle">"Delay-Tolerant Networking Bundle Protocol IANA Registries"</span>, <span class="seriesInfo">RFC 6255</span>, <span class="seriesInfo">DOI 10.17487/RFC6255</span>, <time class="refDate" datetime="2011-05">May 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6255">https://www.rfc-editor.org/info/rfc6255</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6257">[RFC6257]</dt>
        <dd>
<span class="refAuthor">Symington, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Weiss, H.</span>, and <span class="refAuthor">P. Lovell</span>, <span class="refTitle">"Bundle Security Protocol Specification"</span>, <span class="seriesInfo">RFC 6257</span>, <span class="seriesInfo">DOI 10.17487/RFC6257</span>, <time class="refDate" datetime="2011-05">May 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6257">https://www.rfc-editor.org/info/rfc6257</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6258">[RFC6258]</dt>
        <dd>
<span class="refAuthor">Symington, S.</span>, <span class="refTitle">"Delay-Tolerant Networking Metadata Extension Block"</span>, <span class="seriesInfo">RFC 6258</span>, <span class="seriesInfo">DOI 10.17487/RFC6258</span>, <time class="refDate" datetime="2011-05">May 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6258">https://www.rfc-editor.org/info/rfc6258</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6259">[RFC6259]</dt>
        <dd>
<span class="refAuthor">Symington, S.</span>, <span class="refTitle">"Delay-Tolerant Networking Previous-Hop Insertion Block"</span>, <span class="seriesInfo">RFC 6259</span>, <span class="seriesInfo">DOI 10.17487/RFC6259</span>, <time class="refDate" datetime="2011-05">May 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6259">https://www.rfc-editor.org/info/rfc6259</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6260">[RFC6260]</dt>
        <dd>
<span class="refAuthor">Burleigh, S.</span>, <span class="refTitle">"Compressed Bundle Header Encoding (CBHE)"</span>, <span class="seriesInfo">RFC 6260</span>, <span class="seriesInfo">DOI 10.17487/RFC6260</span>, <time class="refDate" datetime="2011-05">May 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6260">https://www.rfc-editor.org/info/rfc6260</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7143">[RFC7143]</dt>
        <dd>
<span class="refAuthor">Chadalapaka, M.</span>, <span class="refAuthor">Satran, J.</span>, <span class="refAuthor">Meth, K.</span>, and <span class="refAuthor">D. Black</span>, <span class="refTitle">"Internet Small Computer System Interface (iSCSI) Protocol (Consolidated)"</span>, <span class="seriesInfo">RFC 7143</span>, <span class="seriesInfo">DOI 10.17487/RFC7143</span>, <time class="refDate" datetime="2014-04">April 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7143">https://www.rfc-editor.org/info/rfc7143</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time class="refDate" datetime="2017-06">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SIGC">[SIGC]</dt>
      <dd>
<span class="refAuthor">Fall, K.</span>, <span class="refTitle">"A Delay-Tolerant Network Architecture for Challenged Internets"</span>, <span class="refContent">SIGCOMM 2003</span>, <span class="seriesInfo">DOI 10.1145/863955.863960</span>, <time class="refDate" datetime="2003-08">August 2003</time>, <span>&lt;<a href="https://dl.acm.org/doi/10.1145/863955.863960">https://dl.acm.org/doi/10.1145/863955.863960</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="app-a">
<section id="appendix-A">
      <h2 id="name-significant-changes-from-rf">
<a class="section-number selfRef" href="#appendix-A">Appendix A. </a><a class="section-name selfRef" href="#name-significant-changes-from-rf">Significant Changes from RFC 5050</a>
      </h2>
<p id="appendix-A-1">
This document makes the following significant changes from RFC 5050:<a class="pilcrow" href="#appendix-A-1">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-2.1">Clarifies the difference between transmission and forwarding.<a class="pilcrow" href="#appendix-A-2.1">¶</a>
</li>
        <li class="normal" id="appendix-A-2.2">Migrates custody transfer to the bundle-in-bundle encapsulation
          specification <span>[<a class="xref" href="#I-D.ietf-dtn-bibect">BIBE</a>]</span>.<a class="pilcrow" href="#appendix-A-2.2">¶</a>
</li>
        <li class="normal" id="appendix-A-2.3">Introduces the concept of "node ID" as functionally distinct from
          endpoint ID, while having the same syntax.<a class="pilcrow" href="#appendix-A-2.3">¶</a>
</li>
        <li class="normal" id="appendix-A-2.4">Restructures primary block, making it immutable.  Adds optional
          CRC.<a class="pilcrow" href="#appendix-A-2.4">¶</a>
</li>
        <li class="normal" id="appendix-A-2.5">Adds optional CRCs to non-primary blocks.<a class="pilcrow" href="#appendix-A-2.5">¶</a>
</li>
        <li class="normal" id="appendix-A-2.6">Adds block ID number to canonical block format (to support
          BPSec).<a class="pilcrow" href="#appendix-A-2.6">¶</a>
</li>
        <li class="normal" id="appendix-A-2.7">Adds definition of Bundle Age extension block.<a class="pilcrow" href="#appendix-A-2.7">¶</a>
</li>
        <li class="normal" id="appendix-A-2.8">Adds definition of Previous Node extension block.<a class="pilcrow" href="#appendix-A-2.8">¶</a>
</li>
        <li class="normal" id="appendix-A-2.9">Adds definition of Hop Count extension block.<a class="pilcrow" href="#appendix-A-2.9">¶</a>
</li>
        <li class="normal" id="appendix-A-2.10">Removes Quality of Service markings.<a class="pilcrow" href="#appendix-A-2.10">¶</a>
</li>
        <li class="normal" id="appendix-A-2.11">Changes from Self-Delimiting Numeric Values (SDNVs) to CBOR encoding.<a class="pilcrow" href="#appendix-A-2.11">¶</a>
</li>
        <li class="normal" id="appendix-A-2.12">Adds lifetime overrides.<a class="pilcrow" href="#appendix-A-2.12">¶</a>
</li>
        <li class="normal" id="appendix-A-2.13">Clarifies that time values are denominated in milliseconds, not seconds.<a class="pilcrow" href="#appendix-A-2.13">¶</a>
</li>
      </ul>
</section>
</div>
<div id="app-c">
<section id="appendix-B">
      <h2 id="name-cddl-expression">
<a class="section-number selfRef" href="#appendix-B">Appendix B. </a><a class="section-name selfRef" href="#name-cddl-expression">CDDL Expression</a>
      </h2>
<p id="appendix-B-1">
   For informational purposes, Carsten Bormann and Brian Sipos have
   kindly provided an expression of the Bundle Protocol specification
   in the Concise Data Definition Language (CDDL).  That CDDL
   expression is presented below.  Note that wherever the CDDL
   expression is in disagreement with the textual representation of the
   BP specification presented in the earlier sections of this document,
   the textual representation rules.<a class="pilcrow" href="#appendix-B-1">¶</a></p>
<div id="appendix-B-2">
<pre class="lang-cddl sourcecode">   bpv7_start = bundle / #6.55799(bundle)

   ; Times before 2000 are invalid

   dtn-time = uint

   ; CRC enumerated type

   crc-type = &amp;(

     crc-none: 0,

     crc-16bit: 1,

     crc-32bit: 2

   )

   ; Either 16-bit or 32-bit

   crc-value = (bstr .size 2) / (bstr .size 4)

   creation-timestamp = [

     dtn-time, ; absolute time of creation

     sequence: uint ; sequence within the time

   ]

   eid = $eid .within eid-structure

   eid-structure = [

     uri-code: uint,

     SSP: any

   ]

   $eid /= [

     uri-code: 1,

     SSP: (tstr / 0)

   ]

   $eid /= [

     uri-code: 2,

     SSP: [

       nodenum: uint,

       servicenum: uint

     ]

   ]

   ; The root bundle array

   bundle = [primary-block, *extension-block, payload-block]

   primary-block = [

     version: 7,

     bundle-control-flags,

     crc-type,

     destination: eid,

     source-node: eid,

     report-to: eid,

     creation-timestamp,

     lifetime: uint,

     ? (

       fragment-offset: uint,

       total-application-data-length: uint

     ),

     ? crc-value,

   ]

   bundle-control-flags = uint .bits bundleflagbits

   bundleflagbits = &amp;(

     reserved: 20,

     reserved: 19,

     bundle-deletion-status-reports-are-requested: 18,

     bundle-delivery-status-reports-are-requested: 17,

     bundle-forwarding-status-reports-are-requested: 16,

     reserved: 15,

     bundle-reception-status-reports-are-requested: 14,

     reserved: 13,

     reserved: 12,

     reserved: 11,

     reserved: 10,

     reserved: 9,

     reserved: 8,

     reserved: 7,

     status-time-is-requested-in-all-status-reports: 6,

     user-application-acknowledgement-is-requested: 5,

     reserved: 4,

     reserved: 3,

     bundle-must-not-be-fragmented: 2,

     payload-is-an-administrative-record: 1,

     bundle-is-a-fragment: 0

   )

   ; Abstract shared structure of all non-primary blocks

   canonical-block-structure = [

     block-type-code: uint,

     block-number: uint,

     block-control-flags,

     crc-type,

     ; Each block type defines the content within the byte string

     block-type-specific-data,

     ? crc-value

   ]

   block-control-flags = uint .bits blockflagbits

   blockflagbits = &amp;(

     reserved: 7,

     reserved: 6,

     reserved: 5,

     block-must-be-removed-from-bundle-if-it-cannot-be-processed: 4,

     reserved: 3,

     bundle-must-be-deleted-if-block-cannot-be-processed: 2,

     status-report-must-be-transmitted-if-block-cannot-be-processed:
     1,

     block-must-be-replicated-in-every-fragment: 0

   )

   block-type-specific-data = bstr / #6.24(bstr)

   ; Actual CBOR data embedded in a byte string, with optional tag to
   indicate so.

   ; Additional plain bstr allows ciphertext data.

   embedded-cbor&lt;Item&gt; = (bstr .cbor Item) / #6.24(bstr .cbor Item) /
   bstr

   ; Extension block type, which does not specialize other than the
   code/number

   extension-block =
   $extension-block .within canonical-block-structure

   ; Generic shared structure of all non-primary blocks

   extension-block-use&lt;CodeValue, BlockData&gt; = [

     block-type-code: CodeValue,

     block-number: (uint .gt 1),

     block-control-flags,

     crc-type,

     BlockData,

     ? crc-value

   ]

   ; Payload block type

   payload-block = payload-block-structure .within canonical-block-
   structure

   payload-block-structure = [

     block-type-code: 1,

     block-number: 1,

     block-control-flags,

     crc-type,

     $payload-block-data,

     ? crc-value

   ]

   ; Arbitrary payload data, including non-CBOR byte string

   $payload-block-data /= block-type-specific-data

   ; Administrative record as a payload data specialization

   $payload-block-data /= embedded-cbor&lt;admin-record&gt;

   admin-record = $admin-record .within admin-record-structure

   admin-record-structure = [

     record-type-code: uint,

     record-content: any

   ]

   ; Only one defined record type

   $admin-record /= [1, status-record-content]

   status-record-content = [

     bundle-status-information,

     status-report-reason-code: uint,

     source-node-eid: eid,

     subject-creation-timestamp: creation-timestamp,

     ? (

       subject-payload-offset: uint,

       subject-payload-length: uint

     )

   ]

   bundle-status-information = [

     reporting-node-received-bundle: status-info-content,

     reporting-node-forwarded-bundle: status-info-content,

     reporting-node-delivered-bundle: status-info-content,

     reporting-node-deleted-bundle: status-info-content

   ]

   status-info-content = [

     status-indicator: bool,

     ? timestamp: dtn-time

   ]

   ; Previous Node extension block

   $extension-block /=

     extension-block-use&lt;6, embedded-cbor&lt;ext-data-previous-node&gt;&gt;

   ext-data-previous-node = eid

   ; Bundle Age extension block

   $extension-block /=

     extension-block-use&lt;7, embedded-cbor&lt;ext-data-bundle-age&gt;&gt;

   ext-data-bundle-age = uint

   ; Hop Count extension block

   $extension-block /=

     extension-block-use&lt;10, embedded-cbor&lt;ext-data-hop-count&gt;&gt;

   ext-data-hop-count = [

     hop-limit: uint,

     hop-count: uint

   ]
</pre><a class="pilcrow" href="#appendix-B-2">¶</a>
</div>
</section>
</div>
<div id="acks-section">
<section id="appendix-C">
      <h2 id="name-acknowledgments">
<a class="section-name selfRef" href="#name-acknowledgments">Acknowledgments</a>
      </h2>
<p id="appendix-C-1">
   This work is freely adapted from RFC 5050, which was an effort of
   the Delay-Tolerant Networking Research Group. The following DTNRG
   participants contributed significant technical material and/or
   inputs to that document: <span class="contact-name">Dr. Vinton Cerf</span> of Google;
   <span class="contact-name">Scott Burleigh</span>, <span class="contact-name">Adrian Hooke</span>, and
   <span class="contact-name">Leigh Torgerson</span> of the Jet Propulsion Laboratory;
   <span class="contact-name">Michael Demmer</span> of the University of California at Berkeley;
   <span class="contact-name">Robert Durst</span>, <span class="contact-name">Keith Scott</span>, and
   <span class="contact-name">Susan Symington</span> of The MITRE Corporation;
   <span class="contact-name">Kevin Fall</span> of Carnegie Mellon University;
   <span class="contact-name">Stephen Farrell</span> of Trinity College Dublin;
   <span class="contact-name">Howard Weiss</span> and <span class="contact-name">Peter Lovell</span> of
   SPARTA, Inc.;
   and <span class="contact-name">Manikantan Ramadas</span> of Ohio University.<a class="pilcrow" href="#appendix-C-1">¶</a></p>
<p id="appendix-C-2">Scott Burleigh would like to thank the Jet Propulsion Laboratory, California Institute of Technology, for its generous and sustained support of this work.<a class="pilcrow" href="#appendix-C-2">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-D">
      <h2 id="name-authors-addresses">
<a class="section-name selfRef" href="#name-authors-addresses">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Scott Burleigh</span></div>
<div class="left" dir="auto"><span class="org">IPNGROUP</span></div>
<div class="left" dir="auto"><span class="street-address">1435 Woodhurst Blvd.</span></div>
<div class="left" dir="auto">
<span class="locality">McLean</span>, <span class="region">VA</span> <span class="postal-code">22102</span>
</div>
<div class="left" dir="auto"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:sburleig.sb@gmail.com">sburleig.sb@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Kevin Fall</span></div>
<div class="left" dir="auto"><span class="org">Roland Computing Services</span></div>
<div class="left" dir="auto"><span class="street-address">3871 Piedmont Ave. Suite 8</span></div>
<div class="left" dir="auto">
<span class="locality">Oakland</span>, <span class="region">CA</span> <span class="postal-code">94611</span>
</div>
<div class="left" dir="auto"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:kfall+rcs@kfall.com">kfall+rcs@kfall.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Edward J. Birrane, III</span></div>
<div class="left" dir="auto"><span class="org">Johns Hopkins University Applied Physics Laboratory</span></div>
<div class="left" dir="auto"><span class="street-address">11100 Johns Hopkins Rd</span></div>
<div class="left" dir="auto">
<span class="locality">Laurel</span>, <span class="region">MD</span> <span class="postal-code">20723</span>
</div>
<div class="left" dir="auto"><span class="country-name">United States of America</span></div>
<div class="tel">
<span>Phone:</span>
<a class="tel" href="tel:+1%20443%20778%207423">+1 443 778 7423</a>
</div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:Edward.Birrane@jhuapl.edu">Edward.Birrane@jhuapl.edu</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>