<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 9135: Integrated Routing and Bridging in Ethernet VPN (EVPN)</title>
<meta content="Ali Sajassi" name="author"/>
<meta content="Samer Salam" name="author"/>
<meta content="Samir Thoria" name="author"/>
<meta content="John E Drake" name="author"/>
<meta content="Jorge Rabadan" name="author"/>
<meta content="
       
   Ethernet VPN (EVPN) provides an extensible and flexible multihoming
   VPN solution over an MPLS/IP network for intra-subnet connectivity
   among Tenant Systems and end devices that can be physical or virtual.
   However, there are scenarios for which there is a need for a dynamic
   and efficient inter-subnet connectivity among these Tenant Systems
   and end devices while maintaining the multihoming capabilities of
   EVPN.  This document describes an Integrated Routing and Bridging
   (IRB) solution based on EVPN to address such requirements. 
    " name="description"/>
<meta content="xml2rfc 3.10.0" name="generator"/>
<meta content="IRB" name="keyword"/>
<meta content="inter-subnet-forwarding" name="keyword"/>
<meta content="symmetric" name="keyword"/>
<meta content="asymmetric" name="keyword"/>
<meta content="mobility" name="keyword"/>
<meta content="9135" name="rfc.number"/>
<!-- Generator version information:
  xml2rfc 3.10.0
    Python 3.6.13
    appdirs 1.4.4
    ConfigArgParse 1.4.1
    google-i18n-address 2.4.0
    html5lib 1.0.1
    intervaltree 3.0.2
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.4.2
    pycairo 1.15.1
    pycountry 19.8.18
    pyflakes 2.1.1
    PyYAML 5.4.1
    requests 2.24.0
    setuptools 40.5.0
    six 1.14.0
    WeasyPrint 52.5
-->
<link href="rfc9135.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://dx.doi.org/10.17487/rfc9135" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <link href="https://datatracker.ietf.org/doc/draft-ietf-bess-evpn-inter-subnet-forwarding-15" rel="prev"/>
  </head>
<body>
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9135</td>
<td class="center">IRB EVPN</td>
<td class="right">October 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Sajassi, et al.</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc9135">9135</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2021-10">October 2021</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">A. Sajassi</div>
<div class="org">Cisco Systems</div>
</div>
<div class="author">
      <div class="author-name">S. Salam</div>
<div class="org">Cisco Systems</div>
</div>
<div class="author">
      <div class="author-name">S. Thoria</div>
<div class="org">Cisco Systems</div>
</div>
<div class="author">
      <div class="author-name">J. Drake</div>
<div class="org">Juniper</div>
</div>
<div class="author">
      <div class="author-name">J. Rabadan</div>
<div class="org">Nokia</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9135</h1>
<h1 id="title">Integrated Routing and Bridging in Ethernet VPN (EVPN)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">
   Ethernet VPN (EVPN) provides an extensible and flexible multihoming
   VPN solution over an MPLS/IP network for intra-subnet connectivity
   among Tenant Systems and end devices that can be physical or virtual.
   However, there are scenarios for which there is a need for a dynamic
   and efficient inter-subnet connectivity among these Tenant Systems
   and end devices while maintaining the multihoming capabilities of
   EVPN.  This document describes an Integrated Routing and Bridging
   (IRB) solution based on EVPN to address such requirements.<a class="pilcrow" href="#section-abstract-1">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a class="pilcrow" href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9135">https://www.rfc-editor.org/info/rfc9135</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">▲</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p class="keepWithNext" id="section-toc.1-1.1.1"><a class="xref" href="#section-1">1</a>.  <a class="xref" href="#name-introduction">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p class="keepWithNext" id="section-toc.1-1.2.1"><a class="xref" href="#section-2">2</a>.  <a class="xref" href="#name-terminology">Terminology</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p class="keepWithNext" id="section-toc.1-1.2.2.1.1"><a class="xref" href="#section-2.1">2.1</a>.  <a class="xref" href="#name-requirements-language">Requirements Language</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a class="xref" href="#section-3">3</a>.  <a class="xref" href="#name-evpn-pe-model-for-irb-opera">EVPN PE Model for IRB Operation</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="xref" href="#section-4">4</a>.  <a class="xref" href="#name-symmetric-and-asymmetric-ir">Symmetric and Asymmetric IRB</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a class="xref" href="#section-4.1">4.1</a>.  <a class="xref" href="#name-irb-interface-and-its-mac-a">IRB Interface and Its MAC and IP Addresses</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a class="xref" href="#section-4.2">4.2</a>.  <a class="xref" href="#name-operational-considerations">Operational Considerations</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="xref" href="#section-5">5</a>.  <a class="xref" href="#name-symmetric-irb-procedures">Symmetric IRB Procedures</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a class="xref" href="#section-5.1">5.1</a>.  <a class="xref" href="#name-control-plane-advertising-p">Control Plane - Advertising PE</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a class="xref" href="#section-5.2">5.2</a>.  <a class="xref" href="#name-control-plane-receiving-pe">Control Plane - Receiving PE</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a class="xref" href="#section-5.3">5.3</a>.  <a class="xref" href="#name-subnet-route-advertisement">Subnet Route Advertisement</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a class="xref" href="#section-5.4">5.4</a>.  <a class="xref" href="#name-data-plane-ingress-pe">Data Plane - Ingress PE</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5">
                <p id="section-toc.1-1.5.2.5.1"><a class="xref" href="#section-5.5">5.5</a>.  <a class="xref" href="#name-data-plane-egress-pe">Data Plane - Egress PE</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="xref" href="#section-6">6</a>.  <a class="xref" href="#name-asymmetric-irb-procedures">Asymmetric IRB Procedures</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a class="xref" href="#section-6.1">6.1</a>.  <a class="xref" href="#name-control-plane-advertising-pe">Control Plane - Advertising PE</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a class="xref" href="#section-6.2">6.2</a>.  <a class="xref" href="#name-control-plane-receiving-pe-2">Control Plane - Receiving PE</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a class="xref" href="#section-6.3">6.3</a>.  <a class="xref" href="#name-data-plane-ingress-pe-2">Data Plane - Ingress PE</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a class="xref" href="#section-6.4">6.4</a>.  <a class="xref" href="#name-data-plane-egress-pe-2">Data Plane - Egress PE</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="xref" href="#section-7">7</a>.  <a class="xref" href="#name-mobility-procedure">Mobility Procedure</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a class="xref" href="#section-7.1">7.1</a>.  <a class="xref" href="#name-initiating-a-gratuitous-arp">Initiating a Gratuitous ARP upon a Move</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a class="xref" href="#section-7.2">7.2</a>.  <a class="xref" href="#name-sending-data-traffic-withou">Sending Data Traffic without an ARP Request</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a class="xref" href="#section-7.3">7.3</a>.  <a class="xref" href="#name-silent-host">Silent Host</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="xref" href="#section-8">8</a>.  <a class="xref" href="#name-bgp-encoding">BGP Encoding</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a class="xref" href="#section-8.1">8.1</a>.  <a class="xref" href="#name-evpn-routers-mac-extended-c">EVPN Router's MAC Extended Community</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="xref" href="#section-9">9</a>.  <a class="xref" href="#name-operational-models-for-symm">Operational Models for Symmetric Inter-Subnet Forwarding</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a class="xref" href="#section-9.1">9.1</a>.  <a class="xref" href="#name-irb-forwarding-on-nves-for-">IRB Forwarding on NVEs for Tenant Systems</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1.2.1">
                    <p id="section-toc.1-1.9.2.1.2.1.1"><a class="xref" href="#section-9.1.1">9.1.1</a>.  <a class="xref" href="#name-control-plane-operation">Control Plane Operation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1.2.2">
                    <p id="section-toc.1-1.9.2.1.2.2.1"><a class="xref" href="#section-9.1.2">9.1.2</a>.  <a class="xref" href="#name-data-plane-operation">Data Plane Operation</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a class="xref" href="#section-9.2">9.2</a>.  <a class="xref" href="#name-irb-forwarding-on-nves-for-s">IRB Forwarding on NVEs for Subnets behind Tenant Systems</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2.2.1">
                    <p id="section-toc.1-1.9.2.2.2.1.1"><a class="xref" href="#section-9.2.1">9.2.1</a>.  <a class="xref" href="#name-control-plane-operation-2">Control Plane Operation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2.2.2">
                    <p id="section-toc.1-1.9.2.2.2.2.1"><a class="xref" href="#section-9.2.2">9.2.2</a>.  <a class="xref" href="#name-data-plane-operation-2">Data Plane Operation</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a class="xref" href="#section-10">10</a>. <a class="xref" href="#name-security-considerations">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a class="xref" href="#section-11">11</a>. <a class="xref" href="#name-iana-considerations">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a class="xref" href="#section-12">12</a>. <a class="xref" href="#name-references">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a class="xref" href="#section-12.1">12.1</a>.  <a class="xref" href="#name-normative-references">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a class="xref" href="#section-12.2">12.2</a>.  <a class="xref" href="#name-informative-references">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a class="xref" href="#appendix-A"></a><a class="xref" href="#name-acknowledgements">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a class="xref" href="#appendix-B"></a><a class="xref" href="#name-authors-addresses">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="intro">
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">
   EVPN <span>[<a class="xref" href="#RFC7432">RFC7432</a>]</span> provides an extensible and flexible multihoming VPN
   solution over an MPLS/IP network for intra-subnet connectivity among
   Tenant Systems (TSs) and end devices that can be physical or
   virtual, where an IP subnet is represented by an EVPN instance (EVI)
   for a VLAN-based service or by an (EVI, VLAN) association for a VLAN-aware bundle
   service.  However, there are scenarios for which there is a need for
   a dynamic and efficient inter-subnet connectivity among these Tenant
   Systems and end devices while maintaining the multihoming
   capabilities of EVPN.  This document describes an Integrated Routing
   and Bridging (IRB) solution based on EVPN to address such
   requirements.<a class="pilcrow" href="#section-1-1">¶</a></p>
<p id="section-1-2">
   Inter-subnet communication is typically performed by centralized Layer 3 (L3) gateway (GW) devices, which enforce all inter-subnet communication policies
and perform all inter-subnet forwarding. When two TSs belonging to two different
   subnets connected to the same Provider Edge (PE) wanted to communicate with each
   other, their traffic needed to be backhauled from the PE all the way
   to the centralized gateway where inter-subnet switching is performed
   and then sent back to the PE.  For today's large multi-tenant Data Center (DC),
   this scheme is very inefficient and sometimes impractical.<a class="pilcrow" href="#section-1-2">¶</a></p>
<p id="section-1-3">
   In order to overcome the drawback of the centralized L3 GW
   approach, IRB functionality is needed on the PEs (also referred to as
   EVPN Network Virtualization Edges (NVEs)) attached to TSs in order to avoid inefficient forwarding
   of tenant traffic (i.e., avoid backhauling and hair pinning).  When
   a PE with IRB capability receives tenant traffic over an Attachment
   Circuit (AC), it cannot only locally bridge the tenant intra-subnet
   traffic but also locally route the tenant inter-subnet traffic on
   a packet-by-packet basis, thus meeting the requirements for both intra-
   and inter-subnet forwarding and avoiding non-optimal traffic
   forwarding associated with a centralized L3 GW approach.<a class="pilcrow" href="#section-1-3">¶</a></p>
<p id="section-1-4">
   Some TSs run non-IP protocols in conjunction with their IP traffic.
   Therefore, it is important to handle both kinds of traffic optimally --
   e.g., to bridge non-IP and intra-subnet traffic and to route inter-subnet
   IP traffic.  Therefore, the solution needs to meet the following
   requirements:<a class="pilcrow" href="#section-1-4">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-1-5">
        <dt id="section-1-5.1">R1:</dt>
        <dd id="section-1-5.2" style="margin-left: 1.5em"> The solution must provide each tenant with IP routing of its
   inter-subnet traffic and Ethernet bridging of its intra-subnet
   traffic and non-routable traffic, where non-routable traffic refers
   to both non-IP traffic and IP traffic whose version differs from the
   IP version configured in IP Virtual Routing and Forwarding (IP-VRF).  For example, if an IP-VRF in an
   NVE is configured for IPv6 and that NVE receives IPv4 traffic on the
   corresponding VLAN, then the IPv4 traffic is treated as non-routable
   traffic.<a class="pilcrow" href="#section-1-5.2">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-1-5.3">
   R2:</dt>
        <dd id="section-1-5.4" style="margin-left: 1.5em"> The solution must allow IP routing of inter-subnet traffic to be
   disabled on a per-VLAN basis on those PEs that are backhauling that
   traffic to another PE for routing.<a class="pilcrow" href="#section-1-5.4">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<div id="terms">
<section id="section-2">
      <h2 id="name-terminology">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-terminology">Terminology</a>
      </h2>
<span class="break"></span><dl class="dlParallel" id="section-2-1">
        <dt id="section-2-1.1">AC:</dt>
        <dd id="section-2-1.2" style="margin-left: 5.0em">Attachment Circuit<a class="pilcrow" href="#section-2-1.2">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.3">ARP:</dt>
        <dd id="section-2-1.4" style="margin-left: 5.0em">Address Resolution Protocol<a class="pilcrow" href="#section-2-1.4">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.5">ARP Table:</dt>
        <dd id="section-2-1.6" style="margin-left: 5.0em"> A logical view of a forwarding table on a PE that
   maintains an IP to a MAC binding entry on an IP interface for both IPv4
   and IPv6.  These entries are learned through ARP/ND or through EVPN.<a class="pilcrow" href="#section-2-1.6">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.7">BD:</dt>
        <dd id="section-2-1.8" style="margin-left: 5.0em">Broadcast Domain. As per <span>[<a class="xref" href="#RFC7432">RFC7432</a>]</span>, an EVI consists of a single BD or multiple
   BDs.  In the case of VLAN-bundle and VLAN-based service
   models (see <span>[<a class="xref" href="#RFC7432">RFC7432</a>]</span>), a BD is equivalent to an EVI.  In the
   case of a VLAN-aware bundle service model, an EVI contains multiple BDs.  Also, in this document, "BD" and "subnet" are
   equivalent terms, and wherever "subnet" is used, it means "IP subnet".<a class="pilcrow" href="#section-2-1.8">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.9">BD Route Target:</dt>
        <dd id="section-2-1.10" style="margin-left: 5.0em">Refers to the broadcast-domain-assigned Route Target <span>[<a class="xref" href="#RFC4364">RFC4364</a>]</span>.  In the case of a VLAN-aware bundle
   service model, all the BD instances in the MAC-VRF
   share the same Route Target.<a class="pilcrow" href="#section-2-1.10">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.11">BT:</dt>
        <dd id="section-2-1.12" style="margin-left: 5.0em">Bridge Table. The instantiation of a BD in a MAC-VRF,
as per <span>[<a class="xref" href="#RFC7432">RFC7432</a>]</span>.<a class="pilcrow" href="#section-2-1.12">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.13">CE:</dt>
        <dd id="section-2-1.14" style="margin-left: 5.0em">Customer Edge<a class="pilcrow" href="#section-2-1.14">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.15">DA:</dt>
        <dd id="section-2-1.16" style="margin-left: 5.0em">Destination Address<a class="pilcrow" href="#section-2-1.16">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.17">Ethernet NVO Tunnel:</dt>
        <dd id="section-2-1.18" style="margin-left: 5.0em">Refers to Network Virtualization Overlay tunnels
   with an Ethernet payload, as specified for VXLAN in <span>[<a class="xref" href="#RFC7348">RFC7348</a>]</span> and for
   NVGRE in <span>[<a class="xref" href="#RFC7637">RFC7637</a>]</span>.<a class="pilcrow" href="#section-2-1.18">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.19">EVI:</dt>
        <dd id="section-2-1.20" style="margin-left: 5.0em">EVPN Instance spanning NVE/PE devices that are participating
   on that EVPN, as per <span>[<a class="xref" href="#RFC7432">RFC7432</a>]</span>.<a class="pilcrow" href="#section-2-1.20">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.21">EVPN:</dt>
        <dd id="section-2-1.22" style="margin-left: 5.0em">Ethernet VPN, as per <span>[<a class="xref" href="#RFC7432">RFC7432</a>]</span>.<a class="pilcrow" href="#section-2-1.22">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.23">IP NVO Tunnel:</dt>
        <dd id="section-2-1.24" style="margin-left: 5.0em">Refers to Network Virtualization Overlay tunnels
   with IP payload (no MAC header in the payload) as specified for Generic Protocol Extension (GPE)
   in <span>[<a class="xref" href="#I-D.ietf-nvo3-vxlan-gpe">VXLAN-GPE</a>]</span>.<a class="pilcrow" href="#section-2-1.24">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.25">IP-VRF:</dt>
        <dd id="section-2-1.26" style="margin-left: 5.0em">A Virtual Routing and Forwarding table for IP routes on an
   NVE/PE.  The IP routes could be populated by EVPN and IP-VPN address
   families.  An IP-VRF is also an instantiation of a Layer 3 VPN in an
   NVE/PE.<a class="pilcrow" href="#section-2-1.26">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.27">IRB:</dt>
        <dd id="section-2-1.28" style="margin-left: 5.0em">Integrated Routing and Bridging interface.  It connects an IP-VRF to a
BD (or subnet).<a class="pilcrow" href="#section-2-1.28">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.29">MAC:</dt>
        <dd id="section-2-1.30" style="margin-left: 5.0em">Media Access Control<a class="pilcrow" href="#section-2-1.30">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.31">MAC-VRF:</dt>
        <dd id="section-2-1.32" style="margin-left: 5.0em">A Virtual Routing and Forwarding table for
   MAC addresses on an NVE/PE, as per <span>[<a class="xref" href="#RFC7432">RFC7432</a>]</span>.  A MAC-VRF is
   also an instantiation of an EVI in an NVE/PE.<a class="pilcrow" href="#section-2-1.32">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.33">ND:</dt>
        <dd id="section-2-1.34" style="margin-left: 5.0em">Neighbor Discovery<a class="pilcrow" href="#section-2-1.34">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.35">NVE:</dt>
        <dd id="section-2-1.36" style="margin-left: 5.0em">Network Virtualization Edge<a class="pilcrow" href="#section-2-1.36">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.37">NVGRE:</dt>
        <dd id="section-2-1.38" style="margin-left: 5.0em">Network Virtualization Using Generic Routing Encapsulation, as per
   <span>[<a class="xref" href="#RFC7637">RFC7637</a>]</span>.<a class="pilcrow" href="#section-2-1.38">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.39">NVO:</dt>
        <dd id="section-2-1.40" style="margin-left: 5.0em">Network Virtualization Overlay<a class="pilcrow" href="#section-2-1.40">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.41">PE:</dt>
        <dd id="section-2-1.42" style="margin-left: 5.0em">Provider Edge<a class="pilcrow" href="#section-2-1.42">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.43">RT-2:</dt>
        <dd id="section-2-1.44" style="margin-left: 5.0em">EVPN Route Type 2, i.e., MAC/IP Advertisement route, as defined
   in <span>[<a class="xref" href="#RFC7432">RFC7432</a>]</span>.<a class="pilcrow" href="#section-2-1.44">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.45">RT-5:</dt>
        <dd id="section-2-1.46" style="margin-left: 5.0em">EVPN Route Type 5, i.e., IP Prefix route, as defined in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9136#section-3">Section 3</a> of [<a class="xref" href="#RFC9136">RFC9136</a>]</span>.<a class="pilcrow" href="#section-2-1.46">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.47">SA:</dt>
        <dd id="section-2-1.48" style="margin-left: 5.0em">Source Address<a class="pilcrow" href="#section-2-1.48">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.49">TS:</dt>
        <dd id="section-2-1.50" style="margin-left: 5.0em">Tenant System<a class="pilcrow" href="#section-2-1.50">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.51">VA:</dt>
        <dd id="section-2-1.52" style="margin-left: 5.0em">Virtual Appliance<a class="pilcrow" href="#section-2-1.52">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.53">VNI:</dt>
        <dd id="section-2-1.54" style="margin-left: 5.0em">Virtual Network Identifier.  As in <span>[<a class="xref" href="#RFC8365">RFC8365</a>]</span>, the term is used
   as a representation of a 24-bit NVO instance identifier, with the
   understanding that "VNI" will refer to a VXLAN Network Identifier in
   VXLAN, or a Virtual Subnet Identifier in NVGRE, etc., unless it is
   stated otherwise.<a class="pilcrow" href="#section-2-1.54">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.55">VTEP:</dt>
        <dd id="section-2-1.56" style="margin-left: 5.0em">VXLAN Termination End Point, as per <span>[<a class="xref" href="#RFC7348">RFC7348</a>]</span>.<a class="pilcrow" href="#section-2-1.56">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.57">VXLAN:</dt>
        <dd id="section-2-1.58" style="margin-left: 5.0em">Virtual eXtensible Local Area Network, as per <span>[<a class="xref" href="#RFC7348">RFC7348</a>]</span>.<a class="pilcrow" href="#section-2-1.58">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-2-2">
   This document also assumes familiarity with the terminology of <span>[<a class="xref" href="#RFC7365">RFC7365</a>]</span>, <span>[<a class="xref" href="#RFC7432">RFC7432</a>]</span>, and <span>[<a class="xref" href="#RFC8365">RFC8365</a>]</span>.<a class="pilcrow" href="#section-2-2">¶</a></p>
<div id="sect-1.1">
<section id="section-2.1">
        <h3 id="name-requirements-language">
<a class="section-number selfRef" href="#section-2.1">2.1. </a><a class="section-name selfRef" href="#name-requirements-language">Requirements Language</a>
        </h3>
<p id="section-2.1-1">
    The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
    "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
    described in BCP 14 <span>[<a class="xref" href="#RFC2119">RFC2119</a>]</span> <span>[<a class="xref" href="#RFC8174">RFC8174</a>]</span> 
    when, and only when, they appear in all capitals, as shown here.<a class="pilcrow" href="#section-2.1-1">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-3">
<section id="section-3">
      <h2 id="name-evpn-pe-model-for-irb-opera">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-evpn-pe-model-for-irb-opera">EVPN PE Model for IRB Operation</a>
      </h2>
<p id="section-3-1">
   Since this document discusses IRB operation in relationship to EVPN
   MAC-VRF, IP-VRF, EVI, BD, bridge table, and IRB
   interfaces, it is important to understand the relationship between
   these components.  Therefore, the PE model is illustrated
   below to a) describe these components and b) illustrate the
   relationship among them.<a class="pilcrow" href="#section-3-1">¶</a></p>
<span id="name-evpn-irb-pe-model"></span><div id="fig-1">
<figure id="figure-1">
        <div class="alignLeft art-text artwork" id="section-3-2.1">
<pre>   +-------------------------------------------------------------+
   |                                                             |
   |              +------------------+                    IRB PE |
   | Attachment   | +------------------+                         |
   | Circuit(AC1) | |  +----------+    |                MPLS/NVO tnl
 ----------------------*Bridge    |    |                    +-----
   |              | |  |Table(BT1)|    |    +-----------+  / \    \
   |              | |  |          *---------*           |&lt;--&gt; |Eth|
   |              | |  |  VLAN x  |    |IRB1|           |  \ /    /
   |              | |  +----------+    |    |           |   +-----
   |              | |     ...          |    |  IP-VRF1  |        |
   |              | |  +----------+    |    |  RD2/RT2  |MPLS/NVO tnl
   |              | |  |Bridge    |    |    |           |   +-----
   |              | |  |Table(BT2)|    |IRB2|           |  / \    \
   |              | |  |          *---------*           |&lt;--&gt; |IP |
 ----------------------*  VLAN y  |    |    +-----------+  \ /    /
   |  AC2         | |  +----------+    |                    +-----
   |              | |    MAC-VRF1      |                         |
   |              +-+    RD1/RT1       |                         |
   |                +------------------+                         |
   |                                                             |
   |                                                             |
   +-------------------------------------------------------------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-1">Figure 1</a>:
<a class="selfRef" href="#name-evpn-irb-pe-model">EVPN IRB PE Model</a>
        </figcaption></figure>
</div>
<p id="section-3-3">
   A tenant needing IRB services on a PE requires an IP-VRF table along with one or more MAC-VRF tables.  An IP-VRF, as defined in <span>[<a class="xref" href="#RFC4364">RFC4364</a>]</span>, is the
   instantiation of an IP-VPN instance in a PE.  A MAC-VRF, as defined in
   <span>[<a class="xref" href="#RFC7432">RFC7432</a>]</span>, is the instantiation of an EVI in a PE.  A
   MAC-VRF consists of one or more bridge tables, where each bridge table
   corresponds to a VLAN (broadcast domain).  If service interfaces for an
   EVPN PE are configured in VLAN-based mode (i.e., <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc7432#section-6.1">Section 6.1</a> of [<a class="xref" href="#RFC7432">RFC7432</a>]</span>),
   then there is only a single bridge table per MAC-VRF (per EVI) -- i.e.,
   there is only one tenant VLAN per EVI.  However, if service interfaces for
   an EVPN PE are configured in VLAN-aware bundle mode (i.e., <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc7432#section-6.3">Section 6.3</a> of [<a class="xref" href="#RFC7432">RFC7432</a>]</span>), then there are several bridge tables per MAC-VRF (per EVI) --
   i.e., there are several tenant VLANs per EVI.<a class="pilcrow" href="#section-3-3">¶</a></p>
<p id="section-3-4">
   Each bridge table is connected to an IP-VRF via an L3 interface
   called an "IRB interface".  Since a single tenant subnet is typically (and
   in this document) represented by a VLAN (and thus supported by a
   single bridge table), for a given tenant, there are as many bridge
   tables as there are subnets. Thus, there are also as many IRB
   interfaces between the tenant IP-VRF and the associated bridge tables
   as shown in the PE model above.<a class="pilcrow" href="#section-3-4">¶</a></p>
<p id="section-3-5">
   IP-VRF is identified by its corresponding Route Target and Route
   Distinguisher, and MAC-VRF is also identified by its corresponding Route
   Target and Route Distinguisher.  If operating in EVPN VLAN-based mode, then
   a receiving PE that receives an EVPN route with a MAC-VRF Route Target can
   identify the corresponding bridge table; however, if operating in EVPN
   VLAN-aware bundle mode, then the receiving PE needs both the MAC-VRF Route
   Target and VLAN ID in order to identify the corresponding bridge table.<a class="pilcrow" href="#section-3-5">¶</a></p>
</section>
</div>
<div id="sect-4">
<section id="section-4">
      <h2 id="name-symmetric-and-asymmetric-ir">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-symmetric-and-asymmetric-ir">Symmetric and Asymmetric IRB</a>
      </h2>
<p id="section-4-1">
   This document defines and describes two types of IRB solutions --
   namely, symmetric and asymmetric IRB.  The description of symmetric
   and asymmetric IRB procedures relating to data path operations and
   tables in this document is a logical view of data path lookups and
   related tables.  Actual implementations, while following this logical
   view, may not strictly adhere to it for performance trade-offs.
   Specifically,<a class="pilcrow" href="#section-4-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-2.1">References to an ARP table in the context of asymmetric IRB is a
      logical view of a forwarding table that maintains an IP-to-MAC
      binding entry on a Layer 3 interface for both IPv4 and IPv6.
      These entries are not subject to ARP or ND protocols.  For IP-to-MAC bindings learned via EVPN, an implementation may choose to
      import these bindings directly to the respective forwarding table
      (such as an adjacency/next-hop table) as opposed to importing them
      to ARP or ND protocol tables.<a class="pilcrow" href="#section-4-2.1">¶</a>
</li>
        <li class="normal" id="section-4-2.2">References to a host IP lookup followed by a host MAC lookup in the
      context of asymmetric IRB <span class="bcp14">MAY</span> be collapsed into a single IP lookup
      in a hardware implementation.<a class="pilcrow" href="#section-4-2.2">¶</a>
</li>
      </ul>
<p id="section-4-3">
   In symmetric IRB, as its name implies, the lookup operation is
   symmetric at both the ingress and egress PEs -- i.e., both ingress and
   egress PEs perform lookups on both MAC and IP addresses.  The ingress
   PE performs a MAC lookup followed by an IP lookup, and the egress PE
   performs an IP lookup followed by a MAC lookup, as depicted in the
   following figure.<a class="pilcrow" href="#section-4-3">¶</a></p>
<span id="name-symmetric-irb"></span><div id="fig-2">
<figure id="figure-2">
        <div class="alignLeft art-text artwork" id="section-4-4.1">
<pre>               Ingress PE                   Egress PE
         +-------------------+        +------------------+
         |                   |        |                  |
         |    +-&gt; IP-VRF ----|----&gt;---|-----&gt; IP-VRF -+  |
         |    |              |        |               |  |
         |   BT1        BT2  |        |  BT3         BT2 |
         |    |              |        |               |  |
         |    ^              |        |               v  |
         |    |              |        |               |  |
         +-------------------+        +------------------+
              ^                                       |
              |                                       |
        TS1-&gt;-+                                       +-&gt;-TS2
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-2">Figure 2</a>:
<a class="selfRef" href="#name-symmetric-irb">Symmetric IRB</a>
        </figcaption></figure>
</div>
<p id="section-4-5">
   In symmetric IRB, as shown in <a class="xref" href="#fig-2">Figure 2</a>, the inter-subnet forwarding
   between two PEs is done between their associated IP-VRFs.  Therefore,
   the tunnel connecting these IP-VRFs can be either an IP-only tunnel
   (e.g., in the case of MPLS or GPE encapsulation) or an Ethernet NVO tunnel
   (e.g., in the case of VXLAN encapsulation).  If it is an Ethernet NVO
   tunnel, the TS1's IP packet is encapsulated in an Ethernet header
   consisting of ingress and egress PE MAC addresses -- i.e., there is
   no need for the ingress PE to use the destination TS2's MAC address.

   Therefore, in symmetric IRB, there is no need for the ingress PE to
   maintain ARP entries for the association of the destination TS2's IP and MAC addresses in its ARP table.

   Each PE participating in symmetric IRB
   only maintains ARP entries for locally connected hosts and
   MAC-VRFs/BTs for only locally configured subnets.<a class="pilcrow" href="#section-4-5">¶</a></p>
<p id="section-4-6">
   In asymmetric IRB, the lookup operation is asymmetric and the ingress
   PE performs three lookups, whereas the egress PE performs a single
   lookup -- i.e., the ingress PE performs a MAC lookup, followed by an
   IP lookup, followed by a MAC lookup again. The egress PE
   performs just a single MAC lookup as depicted in <a class="xref" href="#fig-3">Figure 3</a> below.<a class="pilcrow" href="#section-4-6">¶</a></p>
<span id="name-asymmetric-irb"></span><div id="fig-3">
<figure id="figure-3">
        <div class="alignLeft art-text artwork" id="section-4-7.1">
<pre>            Ingress PE                       Egress PE
         +-------------------+        +------------------+
         |                   |        |                  |
         |    +-&gt; IP-VRF -&gt;  |        |      IP-VRF      |
         |    |           |  |        |                  |
         |   BT1        BT2  |        |  BT3         BT2 |
         |    |           |  |        |              | | |
         |    |           +--|---&gt;----|--------------+ | |
         |    |              |        |                v |
         +-------------------+        +----------------|-+
              ^                                        |
              |                                        |
        TS1-&gt;-+                                        +-&gt;-TS2
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-3">Figure 3</a>:
<a class="selfRef" href="#name-asymmetric-irb">Asymmetric IRB</a>
        </figcaption></figure>
</div>
<p id="section-4-8">
   In asymmetric IRB, as shown in <a class="xref" href="#fig-3">Figure 3</a>, the inter-subnet forwarding between
   two PEs is done between their associated MAC-VRFs/BTs.
   Therefore, the MPLS or NVO tunnel used for inter-subnet forwarding <span class="bcp14">MUST</span> be
   of type Ethernet.  

Since only MAC lookup is performed at the egress PE
   (e.g., no IP lookup), the TS1's IP packets need to be encapsulated with the
   destination TS2's MAC address.  In order for the ingress PE to perform such
   encapsulation, it needs to maintain TS2's IP and MAC address association in
   its ARP table.  Furthermore, it needs to maintain destination TS2's MAC
   address in the corresponding bridge table even though it may not have any
   TSs of the corresponding subnet locally attached.  In other words, each PE
   participating in asymmetric IRB <span class="bcp14">MUST</span> maintain ARP entries for remote hosts
   (hosts connected to other PEs) as well as maintain MAC-VRFs/BTs
   and IRB interfaces for ALL subnets in an IP-VRF, including subnets that may
   not be locally attached.  Therefore, careful consideration of the PE scale
   aspects for its ARP table size, its IRB interfaces, and the number and size of its
   bridge tables should be given for the application of asymmetric IRB.<a class="pilcrow" href="#section-4-8">¶</a></p>
<p id="section-4-9">
   It should be noted that whenever a PE performs a host IP lookup for a
   packet that is routed, the IPv4 Time To Live (TTL) or IPv6 hop limit for that packet is
   decremented by one, and if it reaches zero, the packet is discarded.
   In the case of symmetric IRB, the TTL / hop limit is decremented by
   both ingress and egress PEs (once by each), whereas in the case of
   asymmetric IRB, the TTL / hop limit is decremented only once by the
   ingress PE.<a class="pilcrow" href="#section-4-9">¶</a></p>
<p id="section-4-10">
   The following sections define the control and data plane procedures
   for symmetric and asymmetric IRB on ingress and egress PEs.  The
   following figure is used to describe these procedures, showing a
   single IP-VRF and a number of BDs on each PE for a
   given tenant. That is, an IP-VRF connects one or more EVIs, and each EVI
   contains one MAC-VRF; each MAC VRF consists of one or more bridge
   tables, one per BD; and a PE has an associated IRB
   interface for each BD.<a class="pilcrow" href="#section-4-10">¶</a></p>
<span id="name-irb-forwarding"></span><div id="fig-4">
<figure id="figure-4">
        <div class="alignLeft art-text artwork" id="section-4-11.1">
<pre>                 PE 1         +---------+
           +-------------+    |         |
   TS1-----|         MACx|    |         |        PE2
 (M1/IP1)  |(BT1)        |    |         |   +-------------+
   TS5-----|      \      |    |  MPLS/  |   |MACy  (BT3)  |-----TS3
 (M5/IP5)  |IPx/Mx \     |    |  VXLAN/ |   |     /       | (M3/IP3)
           |    (IP-VRF1)|----|  NVGRE  |---|(IP-VRF1)    |
           |       /     |    |         |   |     \       |
   TS2-----|(BT2) /      |    |         |   |      (BT1)  |-----TS4
 (M2/IP2)  |             |    |         |   |             |  (M4/IP4)
           +-------------+    |         |   +-------------+
                              |         |
                              +---------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-4">Figure 4</a>:
<a class="selfRef" href="#name-irb-forwarding">IRB Forwarding</a>
        </figcaption></figure>
</div>
<div id="sect-4.1">
<section id="section-4.1">
        <h3 id="name-irb-interface-and-its-mac-a">
<a class="section-number selfRef" href="#section-4.1">4.1. </a><a class="section-name selfRef" href="#name-irb-interface-and-its-mac-a">IRB Interface and Its MAC and IP Addresses</a>
        </h3>
<p id="section-4.1-1">
   To support inter-subnet forwarding on a PE, the PE acts as an IP
   default gateway from the perspective of the attached Tenant Systems
   where default gateway MAC and IP addresses are configured on each IRB
   interface associated with its subnet and fall into one of the
   following two options:<a class="pilcrow" href="#section-4.1-1">¶</a></p>
<ol class="normal type-1" id="section-4.1-2" start="1" type="1">
<li id="section-4.1-2.1">
<div id="opt1">All the PEs for a given tenant subnet use the same anycast
       default gateway IP and MAC addresses.  On each PE, these default
       gateway IP and MAC addresses correspond to the IRB interface
       connecting the bridge table associated with the tenant's VLAN to
       the corresponding tenant's IP-VRF.<a class="pilcrow" href="#opt1">¶</a>
</div>
          </li>
<li id="section-4.1-2.2">
<div id="opt2">Each PE for a given tenant subnet uses the same anycast default
       gateway IP address but its own MAC address.  These MAC addresses
       are aliased to the same anycast default gateway IP address
       through the use of the Default Gateway extended community as
       specified in <span>[<a class="xref" href="#RFC7432">RFC7432</a>]</span>, which is carried in the EVPN MAC/IP
       Advertisement routes.  On each PE, this default gateway IP
       address, along with its associated MAC addresses, correspond to the
       IRB interface connecting the bridge table associated with the
       tenant's VLAN to the corresponding tenant's IP-VRF.<a class="pilcrow" href="#opt2">¶</a>
</div>
        </li>
</ol>
<p id="section-4.1-3">
   It is worth noting that if the applications that are running on the
   TSs are employing or relying on any form of MAC security, then the
   first option (i.e., using an anycast MAC address) should be used to
   ensure that the applications receive traffic from the same IRB
   interface MAC address to which they are sending.  If the second option
   is used, then the IRB interface MAC address <span class="bcp14">MUST</span> be the one used in
   the initial ARP reply or ND Neighbor Advertisement (NA) for that TS.<a class="pilcrow" href="#section-4.1-3">¶</a></p>
<p id="section-4.1-4">
   Although both of these options are applicable to both symmetric and
   asymmetric IRB, <a class="xref" href="#opt1">option 1</a> is recommended because of the ease of
   anycast MAC address provisioning on not only the IRB interface
   associated with a given subnet across all the PEs corresponding to
   that VLAN but also on all IRB interfaces associated with all the
   tenant's subnets across all the PEs corresponding to all the VLANs
   for that tenant.  Furthermore, it simplifies the operation as there
   is no need for Default Gateway extended community advertisement and
   its associated MAC aliasing procedure.  Yet another advantage is that
   following host mobility, the host does not need to refresh the
   default GW ARP/ND entry.<a class="pilcrow" href="#section-4.1-4">¶</a></p>
<p id="section-4.1-5">
   If  <a class="xref" href="#opt1">option 1</a> is used, an implementation <span class="bcp14">MAY</span> choose to auto-derive the
   anycast MAC address.  If auto-derivation is used, the anycast MAC
   <span class="bcp14">MUST</span> be auto-derived out of the following ranges (which are defined
   in <span>[<a class="xref" href="#RFC5798">RFC5798</a>]</span>):<a class="pilcrow" href="#section-4.1-5">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-6.1">Anycast IPv4 IRB case: 00-00-5E-00-01-{VRID}<a class="pilcrow" href="#section-4.1-6.1">¶</a>
</li>
          <li class="normal" id="section-4.1-6.2">Anycast IPv6 IRB case: 00-00-5E-00-02-{VRID}<a class="pilcrow" href="#section-4.1-6.2">¶</a>
</li>
        </ul>
<p id="section-4.1-7">
   Where the last octet is generated based on a configurable Virtual Router ID
   (VRID) (range 1-255).  If not explicitly configured, the default value for
   the VRID octet is '1'.  Auto-derivation of the anycast MAC can only be used
   if there is certainty that the auto-derived MAC does not collide with any
   customer MAC address.<a class="pilcrow" href="#section-4.1-7">¶</a></p>
<p id="section-4.1-8">
   In addition to IP anycast addresses, IRB interfaces can be configured
   with non-anycast IP addresses for the purpose of OAM (such as sending a traceroute/ping to these interfaces) for both symmetric and
   asymmetric IRB.  These IP addresses need to be distributed as VPN
   routes when PEs operate in symmetric IRB mode.  However, they don't
   need to be distributed if the PEs are operating in asymmetric IRB
   mode as the non-anycast IP addresses are configured along with their
   individual MACs, and they get distributed via the EVPN route type 2
   advertisement.<a class="pilcrow" href="#section-4.1-8">¶</a></p>
<p id="section-4.1-9">
   For <a class="xref" href="#opt1">option 1</a> -- irrespective of whether only the anycast MAC address or
   both anycast and non-anycast MAC addresses (where the latter one is
   used for the purpose of OAM) are used on the same IRB -- when a TS sends an ARP
   request or ND Neighbor Solicitation (NS) to the PE to which it is attached, the request is sent for the anycast IP address of the IRB
   interface associated with the TS's subnet. The reply will use
   an anycast MAC address (in both the source MAC in the Ethernet header and
   sender hardware address in the payload).  For example, in <a class="xref" href="#fig-4">Figure 4</a>,
   TS1 is configured with the anycast IPx address as its default gateway
   IP address; thus, when it sends an ARP request for IPx (anycast IP
   address of the IRB interface for BT1), the PE1 sends an ARP reply
   with the MACx, which is the anycast MAC address of that IRB interface.
   Traffic routed from IP-VRF1 to TS1 uses the anycast MAC address as the
   source MAC address.<a class="pilcrow" href="#section-4.1-9">¶</a></p>
</section>
</div>
<div id="sect-4.2">
<section id="section-4.2">
        <h3 id="name-operational-considerations">
<a class="section-number selfRef" href="#section-4.2">4.2. </a><a class="section-name selfRef" href="#name-operational-considerations">Operational Considerations</a>
        </h3>
<p id="section-4.2-1">
   Symmetric and asymmetric IRB modes may coexist in the same network, and an
   ingress PE that supports both forwarding modes for a given tenant can
   interwork with egress PEs that support either IRB mode.  The egress PE will
   indicate the desired forwarding mode for a given host based on the presence
   of the Label2 field and the IP-VRF Route Target in the EVPN MAC/IP
   Advertisement route.  If the Label2 field of the received MAC/IP
   Advertisement route for host H1 is non-zero, and one of its Route Targets
   identifies the IP-VRF, the ingress PE will use symmetric IRB mode when
   forwarding packets destined to H1.  If the Label2 field is zero and the
   MAC/IP Advertisement route for H1 does not carry any Route Target that
   identifies the IP-VRF, the ingress PE will use asymmetric mode when
   forwarding traffic to H1.<a class="pilcrow" href="#section-4.2-1">¶</a></p>
<p id="section-4.2-2">
   As an example that illustrates the previous statement, suppose PE1
   and PE2 need to forward packets from TS2 to TS4 in
   <a class="xref" href="#fig-4">Figure 4</a>.  Since both PEs are attached to the bridge table of the
   destination host, symmetric and asymmetric IRB modes are both
   possible as long as the ingress PE, PE1, supports both modes.  The
   forwarding mode will depend on the mode configured in the egress PE,
   PE2.  That is:<a class="pilcrow" href="#section-4.2-2">¶</a></p>
<ol class="normal type-1" id="section-4.2-3" start="1" type="1">
<li id="section-4.2-3.1">If PE2 is configured for symmetric IRB mode, PE2 will advertise TS4
       MAC/IP addresses in a MAC/IP Advertisement route with a non-zero Label2
       field, e.g., Label2 = Lx, and a Route Target that identifies IP-VRF1 in
       PE1.  IP4 will be installed in PE1's IP-VRF1; TS4's ARP and MAC
       information will also be installed in PE1's IRB interface ARP table and
       BT1, respectively.  When a packet from TS2 destined to TS4 is looked up
       in PE1's IP-VRF route table, a longest prefix match lookup will find
       IP4 in the IP-VRF, and PE1 will forward using the symmetric IRB mode
       and Label Lx.<a class="pilcrow" href="#section-4.2-3.1">¶</a>
</li>
          <li id="section-4.2-3.2">However, if PE2 is configured for asymmetric IRB mode, PE2 will
       advertise TS4 MAC/IP information in a MAC/IP Advertisement route
       with a zero Label2 field and no Route Target identifying IP-VRF1.
       In this case, PE2 will install TS4 information in its ARP table
       and BT1.  When a packet from TS2 to TS4 arrives at PE1, a longest
       prefix match on IP-VRF1's route table will yield the local IRB
       interface to BT1, where a subsequent ARP and bridge table lookup
       will provide the information for an asymmetric forwarding mode to
       PE2.<a class="pilcrow" href="#section-4.2-3.2">¶</a>
</li>
        </ol>
<p id="section-4.2-4">
   Refer to <span>[<a class="xref" href="#I-D.ietf-bess-evpn-modes-interop">EVPN</a>]</span> for more information
   about interoperability between symmetric and asymmetric forwarding
   modes.<a class="pilcrow" href="#section-4.2-4">¶</a></p>
<p id="section-4.2-5">
   The choice between symmetric or asymmetric mode is based on the
   operator's preference, and it is a trade-off between scale (which is better in
   the symmetric IRB mode) and control plane simplicity (asymmetric IRB
   mode simplifies the control plane).  In cases where a tenant has
   hosts for every subnet attached to all (or most of) the PEs, the ARP and
   MAC entries need to be learned by all PEs anyway; therefore, the
   asymmetric IRB mode simplifies the forwarding model and saves space
   in the IP-VRF route table, since host routes are not installed in the
   route table.  However, if the tenant does not need to stretch subnets
   (broadcast domains) to multiple PEs and inter-subnet forwarding is
   needed, the symmetric IRB model will save ARP and bridge table space
   in all the PEs (in comparison with the asymmetric IRB model).<a class="pilcrow" href="#section-4.2-5">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-5">
<section id="section-5">
      <h2 id="name-symmetric-irb-procedures">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-symmetric-irb-procedures">Symmetric IRB Procedures</a>
      </h2>
<div id="sect-5.1">
<section id="section-5.1">
        <h3 id="name-control-plane-advertising-p">
<a class="section-number selfRef" href="#section-5.1">5.1. </a><a class="section-name selfRef" href="#name-control-plane-advertising-p">Control Plane - Advertising PE</a>
        </h3>
<p id="section-5.1-1">
   When a PE (e.g., PE1 in <a class="xref" href="#fig-4">Figure 4</a> above) learns the MAC and IP address of
   a TS (e.g., via an ARP request or Neighbor Solicitation), it adds the
   MAC address to the corresponding MAC-VRF/BT of that
   tenant's subnet and adds the IP address to the IP-VRF for that
   tenant.  Furthermore, it adds this TS's MAC and IP address
   association to its ARP table or Neighbor Discovery
   Protocol (NDP) cache.  It then builds an EVPN
   MAC/IP Advertisement route (type 2) as follows and advertises it to
   other PEs participating in that tenant's VPN.<a class="pilcrow" href="#section-5.1-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1-2.1">The Length field of the BGP EVPN Network Layer Reachability Information (NLRI) for an EVPN MAC/IP
      Advertisement route <span class="bcp14">MUST</span> be either 40 (if the IPv4 address is carried)
      or 52 (if the IPv6 address is carried).<a class="pilcrow" href="#section-5.1-2.1">¶</a>
</li>
          <li class="normal" id="section-5.1-2.2">The Route Distinguisher (RD), Ethernet Segment Identifier, Ethernet
      Tag ID, MAC Address Length, MAC Address, IP Address Length, IP
      Address, and MPLS Label1 fields <span class="bcp14">MUST</span> be set per <span>[<a class="xref" href="#RFC7432">RFC7432</a>]</span> and
      <span>[<a class="xref" href="#RFC8365">RFC8365</a>]</span>.<a class="pilcrow" href="#section-5.1-2.2">¶</a>
</li>
          <li class="normal" id="section-5.1-2.3">The MPLS Label2 field is set to either an MPLS label or a VNI
      corresponding to the tenant's IP-VRF.  In the case of an MPLS
      label, this field is encoded as 3 octets, where the high-order 20
      bits contain the label value.<a class="pilcrow" href="#section-5.1-2.3">¶</a>
</li>
        </ul>
<p id="section-5.1-3">
   Just as in <span>[<a class="xref" href="#RFC7432">RFC7432</a>]</span>, the RD, Ethernet Tag ID, MAC Address Length,
   MAC Address, IP Address Length, and IP Address fields are part of the
   route key used by BGP to compare routes.  The rest of the fields are
   not part of the route key.<a class="pilcrow" href="#section-5.1-3">¶</a></p>
<p id="section-5.1-4">
   This route is advertised along with the following two extended
   communities:<a class="pilcrow" href="#section-5.1-4">¶</a></p>
<ol class="normal type-1" id="section-5.1-5" start="1" type="1">
          <li id="section-5.1-5.1">Encapsulation Extended Community<a class="pilcrow" href="#section-5.1-5.1">¶</a>
</li>
          <li id="section-5.1-5.2">EVPN Router's MAC Extended Community<a class="pilcrow" href="#section-5.1-5.2">¶</a>
</li>
        </ol>
<p id="section-5.1-6">
   This route is advertised with one or more Encapsulation Extended
   Communities <span>[<a class="xref" href="#RFC9012">RFC9012</a>]</span>, one for each encapsulation type supported by
   the advertising PE.  If one or more encapsulation types require an
   Ethernet frame, a single EVPN Router's MAC Extended Community (<a class="xref" href="#sect-8.1">Section 8.1</a>) is also advertised.  This extended community specifies the MAC
   address to be used as the inner destination MAC address in an
   Ethernet frame sent to the advertising PE.<a class="pilcrow" href="#section-5.1-6">¶</a></p>
<p id="section-5.1-7">
   This route <span class="bcp14">MUST</span> be advertised with two Route Targets, one
   corresponding to the MAC-VRF of the tenant's subnet and another
   corresponding to the tenant's IP-VRF.<a class="pilcrow" href="#section-5.1-7">¶</a></p>
</section>
</div>
<div id="sect-5.2">
<section id="section-5.2">
        <h3 id="name-control-plane-receiving-pe">
<a class="section-number selfRef" href="#section-5.2">5.2. </a><a class="section-name selfRef" href="#name-control-plane-receiving-pe">Control Plane - Receiving PE</a>
        </h3>
<p id="section-5.2-1">
   When a PE (e.g., PE2 in <a class="xref" href="#fig-4">Figure 4</a> above) receives this EVPN MAC/IP
   Advertisement route, it performs the following:<a class="pilcrow" href="#section-5.2-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2-2.1">The MAC-VRF Route Target and Ethernet Tag,
 if the latter is non-zero, are used to identify the correct MAC-VRF
 and bridge table, and if they are found, the MAC address is imported.
 The IP-VRF Route Target is used to identify the correct IP-VRF, and if
 it is found, the IP address is imported.<a class="pilcrow" href="#section-5.2-2.1">¶</a>
</li>
        </ul>
<p id="section-5.2-3">
   If the MPLS Label2 field is non-zero, it means that this route is to
   be used for symmetric IRB, and the MPLS label2 value is to be used
   when sending a packet for this IP address to the advertising PE.<a class="pilcrow" href="#section-5.2-3">¶</a></p>
<p id="section-5.2-4">
   If the receiving PE supports asymmetric IRB mode and receives this route with both the MAC-VRF and IP-VRF Route Targets but the MAC/IP Advertisement route does not include the MPLS
   Label2 field, then the receiving PE installs the MAC address in the corresponding MAC-VRF and the (IP,
   MAC) association in the ARP table for that tenant (identified by the
   corresponding IP-VRF Route Target).<a class="pilcrow" href="#section-5.2-4">¶</a></p>
<p id="section-5.2-5">
   If the receiving PE receives this route with both the MAC-VRF and IP-VRF
   Route Targets, and if the receiving PE does not support either asymmetric or
   symmetric IRB modes but has the corresponding MAC-VRF, then it only
   imports the MAC address.<a class="pilcrow" href="#section-5.2-5">¶</a></p>
<p id="section-5.2-6">
   If the receiving PE receives this route with both the MAC-VRF and IP-VRF
   Route Targets and the MAC/IP Advertisement route includes the MPLS Label2 field
   but the receiving PE only supports asymmetric IRB mode, then the receiving
   PE <span class="bcp14">MUST</span> ignore the MPLS Label2 field and install the MAC address in the
   corresponding MAC-VRF and (IP, MAC) association in the ARP table for that
   tenant (identified by the corresponding IP-VRF Route Target).<a class="pilcrow" href="#section-5.2-6">¶</a></p>
</section>
</div>
<div id="sect-5.3">
<section id="section-5.3">
        <h3 id="name-subnet-route-advertisement">
<a class="section-number selfRef" href="#section-5.3">5.3. </a><a class="section-name selfRef" href="#name-subnet-route-advertisement">Subnet Route Advertisement</a>
        </h3>
<p id="section-5.3-1">
   In the case of symmetric IRB, a Layer 3 subnet and IRB interface
   corresponding to a MAC-VRF/BT are required to be provisioned at a
   PE only if that PE has locally attached hosts in that subnet.  In order to
   enable inter-subnet routing across PEs in a deployment where not all
   subnets are provisioned at all PEs participating in an EVPN IRB instance,
   PEs <span class="bcp14">MUST</span> advertise local subnet routes as EVPN RT-5.  These subnet routes
   are required for bootstrapping host (IP, MAC) learning using gleaning
   procedures initiated by an inter-subnet data packet.<a class="pilcrow" href="#section-5.3-1">¶</a></p>
<p id="section-5.3-2">
   That is, if a given host's (IP, MAC) association is unknown, and an
   ingress PE needs to send a packet to that host, then that ingress PE
   needs to know which egress PEs are attached to the subnet in which
   the host resides in order to send the packet to one of those PEs,
   causing the PE receiving the packet to probe for that host.  For
   example, consider a subnet A that is locally attached to PE1 and
   subnet B that is locally attached to PE2 and PE3.  Host A in
   subnet A, which is attached to PE1, initiates a data packet destined to
   host B in subnet B, which is attached to PE3.  If host B's (IP, MAC)
   has not yet been learned via either a gratuitous ARP OR a prior
   gleaning procedure, a new gleaning procedure <span class="bcp14">MUST</span> be triggered for
   host B's (IP, MAC) to be learned and advertised across the EVPN
   network.  Since host B's subnet is not local to PE1, an IP lookup for
   host B at PE1 will not trigger this gleaning procedure for host B's
   (IP, MAC).  Therefore, PE1 <span class="bcp14">MUST</span> learn subnet B's prefix route via
   EVPN RT-5 advertised from PE2 and PE3, so it can route the packet to
   one of the PEs that have subnet B locally attached.  Once the packet
   is received at PE2 OR PE3, and the route lookup yields a glean
   result, an ARP request is triggered and flooded across the Layer 2
   overlay.  

This ARP request would be received and replied to by host
   B, resulting in host B (IP, MAC) learning at PE3 and its
   advertisement across the EVPN network.  Packets from host A to host B
   can now be routed directly from PE1 to PE3.  Advertisement of local
   subnet EVPN RT-5 for an IP-VRF <span class="bcp14">MAY</span> typically be achieved via
   provisioning-connected route redistribution to BGP.<a class="pilcrow" href="#section-5.3-2">¶</a></p>
</section>
</div>
<div id="sect-5.4">
<section id="section-5.4">
        <h3 id="name-data-plane-ingress-pe">
<a class="section-number selfRef" href="#section-5.4">5.4. </a><a class="section-name selfRef" href="#name-data-plane-ingress-pe">Data Plane - Ingress PE</a>
        </h3>
<p id="section-5.4-1">
   When an Ethernet frame is received by an ingress PE (e.g., PE1 in
   <a class="xref" href="#fig-4">Figure 4</a> above), the PE uses the AC ID (e.g., VLAN ID) to identify
   the associated MAC-VRF/BT, and it performs a lookup on the
   destination MAC address.  If the MAC address corresponds to its IRB
   interface MAC address, the ingress PE deduces that the packet must be
   inter-subnet routed.  Hence, the ingress PE performs an IP lookup in
   the associated IP-VRF table.  The lookup identifies the BGP next hop of the egress PE along with the tunnel/encapsulation type and the associated
   MPLS/VNI values.  The ingress PE also decrements the TTL / hop limit
   for that packet by one, and if it reaches zero, the ingress PE
   discards the packet.<a class="pilcrow" href="#section-5.4-1">¶</a></p>
<p id="section-5.4-2">
   If the tunnel type is that of an MPLS or IP-only NVO tunnel, then the TS's
   IP packet is sent over the tunnel without any Ethernet header.
   However, if the tunnel type is that of an Ethernet NVO tunnel, then an
   Ethernet header needs to be added to the TS's IP packet.  The source
   MAC address of this inner Ethernet header is set to the ingress PE's
   router MAC address, and the destination MAC address of this inner
   Ethernet header is set to the egress PE's router MAC address learned
   via the EVPN Router's MAC Extended Community attached to the route.  The MPLS VPN
   label is set to the received label2 in the route.  In the case of the Ethernet NVO tunnel type, the VNI may be set one of two ways:<a class="pilcrow" href="#section-5.4-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.4-3">
          <dt id="section-5.4-3.1">downstream mode:</dt>
          <dd id="section-5.4-3.2" style="margin-left: 1.5em">The VNI is set to the received label2 in the route,
      which is downstream assigned.<a class="pilcrow" href="#section-5.4-3.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.4-3.3">global mode:</dt>
          <dd id="section-5.4-3.4" style="margin-left: 1.5em">The VNI is set to the received label2 in the route, which
      is assigned domain-wide.  This VNI value from the received label2 <span class="bcp14">MUST</span>
      be the same as the locally configured VNI for the IP-VRF as all
      PEs in the NVO <span class="bcp14">MUST</span> be configured with the same IP-VRF VNI for
      this mode of operation.  If the received label2 value does not
      match the locally configured VNI value, the route <span class="bcp14">MUST NOT</span> be used,
      and an error message <span class="bcp14">SHOULD</span> be logged.<a class="pilcrow" href="#section-5.4-3.4">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-5.4-4">
   PEs may be configured to operate in one of these two modes depending
   on the administrative domain boundaries across PEs participating in
   the NVO and the PE's capability to support downstream VNI mode.<a class="pilcrow" href="#section-5.4-4">¶</a></p>
<p id="section-5.4-5">
   In the case of NVO tunnel encapsulation, the outer source and
   destination IP addresses are set to the ingress and egress PE BGP
   next-hop IP addresses, respectively.<a class="pilcrow" href="#section-5.4-5">¶</a></p>
</section>
</div>
<div id="sect-5.5">
<section id="section-5.5">
        <h3 id="name-data-plane-egress-pe">
<a class="section-number selfRef" href="#section-5.5">5.5. </a><a class="section-name selfRef" href="#name-data-plane-egress-pe">Data Plane - Egress PE</a>
        </h3>
<p id="section-5.5-1">
   When the tenant's MPLS or NVO encapsulated packet is received over an
   MPLS or NVO tunnel by the egress PE, the egress PE removes the NVO tunnel
   encapsulation and uses the VPN MPLS label (for MPLS encapsulation) or
   VNI (for NVO encapsulation) to identify the IP-VRF in which IP lookup
   needs to be performed.  If the VPN MPLS label or VNI identifies a
   MAC-VRF instead of an IP-VRF, then the procedures in <a class="xref" href="#sect-6.4">Section 6.4</a> for
   asymmetric IRB are executed.<a class="pilcrow" href="#section-5.5-1">¶</a></p>
<p id="section-5.5-2">
   The lookup in the IP-VRF identifies a local adjacency to the IRB
   interface associated with the egress subnet's MAC-VRF/BT.
   The egress PE also decrements the TTL / hop limit for that packet by
   one, and if it reaches zero, the egress PE discards the packet.<a class="pilcrow" href="#section-5.5-2">¶</a></p>
<p id="section-5.5-3">
   The egress PE gets the destination TS's MAC address for that TS's IP
   address from its ARP table or NDP cache. It encapsulates the packet
   with that destination MAC address and a source MAC address
   corresponding to that IRB interface and sends the packet to its
   destination subnet MAC-VRF/BT.<a class="pilcrow" href="#section-5.5-3">¶</a></p>
<p id="section-5.5-4">
   The destination MAC address lookup in the MAC-VRF/BT
   results in the local adjacency (e.g., local interface) over which the
   Ethernet frame is sent.<a class="pilcrow" href="#section-5.5-4">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-6">
<section id="section-6">
      <h2 id="name-asymmetric-irb-procedures">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-asymmetric-irb-procedures">Asymmetric IRB Procedures</a>
      </h2>
<div id="sect-6.1">
<section id="section-6.1">
        <h3 id="name-control-plane-advertising-pe">
<a class="section-number selfRef" href="#section-6.1">6.1. </a><a class="section-name selfRef" href="#name-control-plane-advertising-pe">Control Plane - Advertising PE</a>
        </h3>
<p id="section-6.1-1">
   When a PE (e.g., PE1 in <a class="xref" href="#fig-4">Figure 4</a> above) learns the MAC and IP address of
   an attached TS (e.g., via an ARP request or ND Neighbor
   Solicitation), it populates its MAC-VRF/BT, IP-VRF, and ARP
   table or NDP cache just as in the case for symmetric IRB.  It then
   builds an EVPN MAC/IP Advertisement route (type 2) as follows and
   advertises it to other PEs participating in that tenant's VPN.<a class="pilcrow" href="#section-6.1-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-2.1">The Length field of the BGP EVPN NLRI for an EVPN MAC/IP
      Advertisement route <span class="bcp14">MUST</span> be either 37 (if an IPv4 address is carried)
      or 49 (if an IPv6 address is carried).<a class="pilcrow" href="#section-6.1-2.1">¶</a>
</li>
          <li class="normal" id="section-6.1-2.2">The RD, Ethernet Segment Identifier, Ethernet
      Tag ID, MAC Address Length, MAC Address, IP Address Length, IP
      Address, and MPLS Label1 fields <span class="bcp14">MUST</span> be set per <span>[<a class="xref" href="#RFC7432">RFC7432</a>]</span> and
      <span>[<a class="xref" href="#RFC8365">RFC8365</a>]</span>.<a class="pilcrow" href="#section-6.1-2.2">¶</a>
</li>
          <li class="normal" id="section-6.1-2.3">The MPLS Label2 field <span class="bcp14">MUST NOT</span> be included in this route.<a class="pilcrow" href="#section-6.1-2.3">¶</a>
</li>
        </ul>
<p id="section-6.1-3">
   Just as in <span>[<a class="xref" href="#RFC7432">RFC7432</a>]</span>, the RD, Ethernet Tag ID, MAC Address Length,
   MAC Address, IP Address Length, and IP Address fields are part of the
   route key used by BGP to compare routes.  The rest of the fields are
   not part of the route key.<a class="pilcrow" href="#section-6.1-3">¶</a></p>
<p id="section-6.1-4">
   This route is advertised along with the following extended community:<a class="pilcrow" href="#section-6.1-4">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-5.1">Tunnel Type Extended Community<a class="pilcrow" href="#section-6.1-5.1">¶</a>
</li>
        </ul>
<p id="section-6.1-6">
   For asymmetric IRB mode, the EVPN Router's MAC Extended Community is not
   needed because forwarding is performed using destination TS's MAC
   address, which is carried in this EVPN route type 2 advertisement.<a class="pilcrow" href="#section-6.1-6">¶</a></p>
<p id="section-6.1-7">
   This route <span class="bcp14">MUST</span> always be advertised with the MAC-VRF Route Target.
   It <span class="bcp14">MAY</span> also be advertised with a second Route Target corresponding to
   the IP-VRF.<a class="pilcrow" href="#section-6.1-7">¶</a></p>
</section>
</div>
<div id="sect-6.2">
<section id="section-6.2">
        <h3 id="name-control-plane-receiving-pe-2">
<a class="section-number selfRef" href="#section-6.2">6.2. </a><a class="section-name selfRef" href="#name-control-plane-receiving-pe-2">Control Plane - Receiving PE</a>
        </h3>
<p id="section-6.2-1">
   When a PE (e.g., PE2 in <a class="xref" href="#fig-4">Figure 4</a> above) receives this EVPN MAC/IP
   Advertisement route, it performs the following:<a class="pilcrow" href="#section-6.2-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2-2.1">Using the MAC-VRF Route Target, it identifies
 the corresponding MAC-VRF and imports the MAC address into it.  For
 asymmetric IRB mode, it is assumed that all PEs participating in a
 tenant's VPN are configured with all subnets (i.e., all VLANs) and
 corresponding MAC-VRFs/BTs even if there are no locally
 attached TSs for some of these subnets. This is because the ingress PE needs to do forwarding based on the destination TS's MAC address
and perform NVO tunnel encapsulation as the property of a lookup in the MAC-VRF/BT.<a class="pilcrow" href="#section-6.2-2.1">¶</a>
</li>
          <li class="normal" id="section-6.2-2.2">If only the MAC-VRF Route Target is used, then the receiving PE uses
      the MAC-VRF Route Target to identify the corresponding IP-VRF --
      i.e., many MAC-VRF Route Targets map to the same IP-VRF for a
      given tenant.  In this case, MAC-VRF may be used by the receiving
      PE to identify the corresponding IP-VRF via the IRB interface
      associated with the subnet MAC-VRF/BT.  In this case,
      the MAC-VRF Route Target may be used by the receiving PE to
      identify the corresponding IP-VRF.<a class="pilcrow" href="#section-6.2-2.2">¶</a>
</li>
          <li class="normal" id="section-6.2-2.3">Using the MAC-VRF Route Target, the receiving PE identifies the
      corresponding ARP table or NDP cache for the tenant, and it adds an
      entry to the ARP table or NDP cache for the TS's MAC and IP
      address association.  It should be noted that the tenant's ARP
      table or NDP cache at the receiving PE is identified by all the
      MAC-VRF Route Targets for that tenant.<a class="pilcrow" href="#section-6.2-2.3">¶</a>
</li>
          <li class="normal" id="section-6.2-2.4">If the IP-VRF Route Target is included, it may be used to import the
      route to IP-VRF.  If the IP-VRF Route Target is not included, MAC-VRF
      is used to derive the corresponding IP-VRF for import, as explained in
      the prior section.  In both cases, an IP-VRF route is installed with
      the TS MAC binding included in the received route.<a class="pilcrow" href="#section-6.2-2.4">¶</a>
</li>
        </ul>
<p id="section-6.2-3">
   If the receiving PE receives the MAC/IP Advertisement route with the MPLS
   Label2 field but the receiving PE only supports asymmetric IRB mode,
   then the receiving PE <span class="bcp14">MUST</span> ignore the MPLS Label2 field and install the
   MAC address in the corresponding MAC-VRF and (IP, MAC) association in
   the ARP table or NDP cache for that tenant (with the IRB interface
   identified by the MAC-VRF).<a class="pilcrow" href="#section-6.2-3">¶</a></p>
</section>
</div>
<div id="sect-6.3">
<section id="section-6.3">
        <h3 id="name-data-plane-ingress-pe-2">
<a class="section-number selfRef" href="#section-6.3">6.3. </a><a class="section-name selfRef" href="#name-data-plane-ingress-pe-2">Data Plane - Ingress PE</a>
        </h3>
<p id="section-6.3-1">
   When an Ethernet frame is received by an ingress PE (e.g., PE1 in
   <a class="xref" href="#fig-4">Figure 4</a> above), the PE uses the AC ID (e.g., VLAN ID) to identify
   the associated MAC-VRF/BT, and it performs a lookup on the
   destination MAC address.  If the MAC address corresponds to its IRB
   interface MAC address, the ingress PE deduces that the packet must be
   inter-subnet routed.  Hence, the ingress PE performs an IP lookup in
   the associated IP-VRF table.  The lookup identifies a local adjacency
   to the IRB interface associated with the egress subnet's MAC-VRF/
   bridge table.  The ingress PE also decrements the TTL / hop limit for
   that packet by one, and if it reaches zero, the ingress PE discards
   the packet.<a class="pilcrow" href="#section-6.3-1">¶</a></p>
<p id="section-6.3-2">
   The ingress PE gets the destination TS's MAC address for that TS's IP
   address from its ARP table or NDP cache. It encapsulates the packet
   with that destination MAC address and a source MAC address
   corresponding to that IRB interface and sends the packet to its
   destination subnet MAC-VRF/BT.<a class="pilcrow" href="#section-6.3-2">¶</a></p>
<p id="section-6.3-3">
   The destination MAC address lookup in the MAC-VRF/BT
   results in a BGP next-hop address of the egress PE along with label1 (L2
   VPN MPLS label or VNI). The ingress PE encapsulates the packet using
   the Ethernet NVO tunnel of the choice (e.g., VXLAN or NVGRE) and sends
   the packet to the egress PE.  Because the packet forwarding is
   between the ingress PE's MAC-VRF/BT and the egress PE's MAC-VRF/
   bridge table, the packet encapsulation procedures follow that of
   <span>[<a class="xref" href="#RFC7432">RFC7432</a>]</span> for MPLS and <span>[<a class="xref" href="#RFC8365">RFC8365</a>]</span> for VXLAN encapsulations.<a class="pilcrow" href="#section-6.3-3">¶</a></p>
</section>
</div>
<div id="sect-6.4">
<section id="section-6.4">
        <h3 id="name-data-plane-egress-pe-2">
<a class="section-number selfRef" href="#section-6.4">6.4. </a><a class="section-name selfRef" href="#name-data-plane-egress-pe-2">Data Plane - Egress PE</a>
        </h3>
<p id="section-6.4-1">
   When a tenant's Ethernet frame is received over an NVO tunnel by the
   egress PE, the egress PE removes the NVO tunnel encapsulation and uses
   the VPN MPLS label (for MPLS encapsulation) or VNI (for NVO
   encapsulation) to identify the MAC-VRF/BT in which the MAC
   lookup needs to be performed.<a class="pilcrow" href="#section-6.4-1">¶</a></p>
<p id="section-6.4-2">
   The MAC lookup results in a local adjacency (e.g., local interface)
   over which the packet needs to get sent.<a class="pilcrow" href="#section-6.4-2">¶</a></p>
<p id="section-6.4-3">
   Note that the forwarding behavior on the egress PE is the same as the EVPN intra-subnet forwarding described in <span>[<a class="xref" href="#RFC7432">RFC7432</a>]</span> for MPLS and
   <span>[<a class="xref" href="#RFC8365">RFC8365</a>]</span> for NVO networks.  In other words, all the packet
   processing associated with the inter-subnet forwarding semantics is
   confined to the ingress PE for asymmetric IRB mode.<a class="pilcrow" href="#section-6.4-3">¶</a></p>
<p id="section-6.4-4">
   It should also be noted that <span>[<a class="xref" href="#RFC7432">RFC7432</a>]</span> provides a different level of
   granularity for the EVPN label.  Besides identifying the bridge
   domain table, it can be used to identify the egress interface or a
   destination MAC address on that interface.  If an EVPN label is used for
   an egress interface or individual MAC address identification, then no
   MAC lookup is needed in the egress PE for MPLS encapsulation, and the
   packet can be directly forwarded to the egress interface just based
   on the EVPN label lookup.<a class="pilcrow" href="#section-6.4-4">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-7">
<section id="section-7">
      <h2 id="name-mobility-procedure">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-mobility-procedure">Mobility Procedure</a>
      </h2>
<p id="section-7-1">
   When a TS moves from one NVE (aka source NVE) to another NVE (aka
   target NVE), it is important that the MAC Mobility procedures be
   properly executed and the corresponding MAC-VRF and IP-VRF tables on
   all participating NVEs be updated.  <span>[<a class="xref" href="#RFC7432">RFC7432</a>]</span> describes the MAC
   Mobility procedures for L2-only services for both single-homed TS and
   multihomed TS.  This section describes the incremental procedures
   and BGP Extended Communities needed to handle the MAC Mobility for
   IRB.  In order to place the emphasis on the differences between
   L2-only and IRB use cases, the incremental procedure is described for
   a single-homed TS with the expectation that the additional steps needed
   for a multihomed TS can be extended per <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc7432#section-15">Section 15</a> of [<a class="xref" href="#RFC7432">RFC7432</a>]</span>.
   This section describes mobility procedures for both symmetric and
   asymmetric IRB.  Although the language used in this section is for
   IPv4 ARP, it equally applies to IPv6 ND.<a class="pilcrow" href="#section-7-1">¶</a></p>
<p id="section-7-2">
   When a TS moves from a source NVE to a target NVE, it can behave in
   one of the following three ways:<a class="pilcrow" href="#section-7-2">¶</a></p>
<ol class="normal type-1" id="section-7-3" start="1" type="1">
<li id="section-7-3.1">
<div id="way1">TS initiates an ARP request upon a move to the target NVE.<a class="pilcrow" href="#way1">¶</a>
</div>
        </li>
<li id="section-7-3.2">
<div id="way2">TS sends a data packet without first initiating an ARP request to
       the target NVE.<a class="pilcrow" href="#way2">¶</a>
</div>
        </li>
<li id="section-7-3.3">
<div id="way3">TS is a silent host and neither initiates an ARP request nor
       sends any packets.<a class="pilcrow" href="#way3">¶</a>
</div>
      </li>
</ol>
<p id="section-7-4">
   Depending on the expected TS's behavior, an NVE needs to handle at least
   the <a class="xref" href="#way1">first</a> option and should be able to handle the <a class="xref" href="#way2">second</a> and <a class="xref" href="#way3">third</a> options.
   The following subsections describe the procedures for each scenario where it
   is assumed that the MAC and IP addresses of a TS have a one-to-one
   relationship (i.e., there is one IP address per MAC address and vice
   versa).  The procedures for host mobility detection in the presence of
a many-to-one relationship is outside the scope of this document, and it is
   covered in <span>[<a class="xref" href="#I-D.ietf-bess-evpn-irb-extended-mobility">EXTENDED-MOBILITY</a>]</span>.  The
   "many-to-one relationship" refers to many host IP addresses corresponding to a
   single host MAC address or many host MAC addresses corresponding to a
   single IP address.  It should be noted that in the case of IPv6, a link-local
   IP address does not count in a many-to-one relationship because that address
   is confined to a single Ethernet segment, and it is not used for host mobility
   (i.e., by definition, host mobility is between two different Ethernet
   segments).  Therefore, when an IPv6 host is configured with both a Global
   Unicast address (or a Unique Local address) and a link-local address, for
   the purpose of host mobility, it is considered with a single IP
   address.<a class="pilcrow" href="#section-7-4">¶</a></p>
<div id="sect-7.1">
<section id="section-7.1">
        <h3 id="name-initiating-a-gratuitous-arp">
<a class="section-number selfRef" href="#section-7.1">7.1. </a><a class="section-name selfRef" href="#name-initiating-a-gratuitous-arp">Initiating a Gratuitous ARP upon a Move</a>
        </h3>
<p id="section-7.1-1">
   In this scenario, when a TS moves from a source NVE to a target NVE,
   the TS initiates a gratuitous ARP upon the move to the target NVE.<a class="pilcrow" href="#section-7.1-1">¶</a></p>
<p id="section-7.1-2">
   The target NVE, upon receiving this ARP message, updates its MAC-VRF,
   IP-VRF, and ARP table with the host MAC, IP, and local adjacency
   information (e.g., local interface).<a class="pilcrow" href="#section-7.1-2">¶</a></p>
<p id="section-7.1-3">
   Since this NVE has previously learned the same MAC and IP addresses
   from the source NVE, it recognizes that there has been a MAC move, and
   it initiates MAC Mobility procedures per <span>[<a class="xref" href="#RFC7432">RFC7432</a>]</span> by advertising an
   EVPN MAC/IP Advertisement route with both the MAC and IP addresses
   filled in (per Sections <a class="xref" href="#sect-5.1">5.1</a> and <a class="xref" href="#sect-6.1">6.1</a>) along with the MAC Mobility extended
   community, with the sequence number incremented by one.  The target
   NVE also exercises the MAC duplication detection procedure in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc7432#section-15.1">Section 15.1</a> of [<a class="xref" href="#RFC7432">RFC7432</a>]</span>.<a class="pilcrow" href="#section-7.1-3">¶</a></p>
<p id="section-7.1-4">
   The source NVE, upon receiving this MAC/IP Advertisement route,
   realizes that the MAC has moved to the target NVE.  It updates its
   MAC-VRF and IP-VRF table accordingly with the adjacency information
   of the target NVE.  In the case of the asymmetric IRB, the source NVE
   also updates its ARP table with the received adjacency information,
   and in the case of the symmetric IRB, the source NVE removes the
   entry associated with the received (IP, MAC) from its local ARP
   table.  It then withdraws its EVPN MAC/IP Advertisement route.
   Furthermore, it sends an ARP probe locally to ensure that the MAC is
   gone.  If an ARP response is received, the source NVE updates its ARP
   entry for that (IP, MAC) and re-advertises an EVPN MAC/IP
   Advertisement route for that (IP, MAC) along with the MAC Mobility
   extended community, with the sequence number incremented by one.  The
   source NVE also exercises the MAC duplication detection procedure in
   <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc7432#section-15.1">Section 15.1</a> of [<a class="xref" href="#RFC7432">RFC7432</a>]</span>.<a class="pilcrow" href="#section-7.1-4">¶</a></p>
<p id="section-7.1-5">
   All other remote NVE devices, upon receiving the MAC/IP Advertisement route
   with the MAC Mobility extended community, compare the sequence number in this
   advertisement with the one previously received.  If the new sequence number
   is greater than the old one, then they update the MAC/IP addresses of the
   TS in their corresponding MAC-VRF and IP-VRF tables to point to the target
   NVE.  Furthermore, upon receiving the MAC/IP withdraw for the TS from the
   source NVE, these remote PEs perform the cleanups for their BGP tables.<a class="pilcrow" href="#section-7.1-5">¶</a></p>
</section>
</div>
<div id="sect-7.2">
<section id="section-7.2">
        <h3 id="name-sending-data-traffic-withou">
<a class="section-number selfRef" href="#section-7.2">7.2. </a><a class="section-name selfRef" href="#name-sending-data-traffic-withou">Sending Data Traffic without an ARP Request</a>
        </h3>
<p id="section-7.2-1">
   In this scenario, when a TS moves from a source NVE to a target NVE,
   the TS starts sending data traffic without first initiating an ARP
   request.<a class="pilcrow" href="#section-7.2-1">¶</a></p>
<p id="section-7.2-2">
   The target NVE, upon receiving the first data packet, learns the MAC
   address of the TS in the data plane and updates its MAC-VRF table
   with the MAC address and the local adjacency information (e.g., local
   interface) accordingly.  The target NVE realizes that there has been
   a MAC move because the same MAC address has been learned remotely
   from the source NVE.<a class="pilcrow" href="#section-7.2-2">¶</a></p>
<p id="section-7.2-3">
   If EVPN-IRB NVEs are configured to advertise MAC-only routes in
   addition to MAC-and-IP EVPN routes, then the following steps are
   taken:<a class="pilcrow" href="#section-7.2-3">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.2-4.1">The target NVE, upon learning this MAC address in the data plane,
      updates this MAC address entry in the corresponding MAC-VRF with
      the local adjacency information (e.g., local interface).  It also
      recognizes that this MAC has moved and initiates MAC Mobility
      procedures per <span>[<a class="xref" href="#RFC7432">RFC7432</a>]</span> by advertising an EVPN MAC/IP
      Advertisement route with only the MAC address filled in along with the
      MAC Mobility extended community, with the sequence number
      incremented by one.<a class="pilcrow" href="#section-7.2-4.1">¶</a>
</li>
          <li class="normal" id="section-7.2-4.2">The source NVE, upon receiving this MAC/IP Advertisement route,
      realizes that the MAC has moved to the new NVE.  It updates its
      MAC-VRF table with the adjacency information for that MAC address
      to point to the target NVE and withdraws its EVPN MAC/IP
      Advertisement route that has only the MAC address (if it has
      advertised such a route previously).  Furthermore, it searches for
      the corresponding MAC-IP entry and sends an ARP probe for this
      (IP, MAC) pair.  The ARP request message is sent both locally to
      all attached TSs in that subnet as well as to other
      NVEs participating in that subnet, including the target NVE.  Note
      that the PE needs to maintain a correlation between MAC and MAC-IP
      route entries in the MAC-VRF to accomplish this.<a class="pilcrow" href="#section-7.2-4.2">¶</a>
</li>
          <li class="normal" id="section-7.2-4.3">The target NVE passes the ARP request to its locally attached TSs,
      and when it receives the ARP response, it updates its IP-VRF and
      ARP table with the host (IP, MAC) information.  It also sends an
      EVPN MAC/IP Advertisement route with both the MAC and IP addresses
      filled in along with the MAC Mobility extended community, with the
      sequence number set to the same value as the one for the MAC-only
      Advertisement route it sent previously.<a class="pilcrow" href="#section-7.2-4.3">¶</a>
</li>
          <li class="normal" id="section-7.2-4.4">When the source NVE receives the EVPN MAC/IP Advertisement route,
      it updates its IP-VRF table with the new adjacency information
      (pointing to the target NVE).  In the case of the asymmetric IRB,
      the source NVE also updates its ARP table with the received
      adjacency information, and in the case of the symmetric IRB, the
      source NVE removes the entry associated with the received (IP, MAC) from its local ARP table.  Furthermore, it withdraws its
      previously advertised EVPN MAC/IP route with both the MAC and IP
      address fields filled in.<a class="pilcrow" href="#section-7.2-4.4">¶</a>
</li>
          <li class="normal" id="section-7.2-4.5">All other remote NVE devices, upon receiving the MAC/IP
      Advertisement route with the MAC Mobility extended community, compare
      the sequence number in this advertisement with the one previously
      received.  If the new sequence number is greater than the old one,
      then they update the MAC/IP addresses of the TS in their
      corresponding MAC-VRF, IP-VRF, and ARP tables (in the case of
      asymmetric IRB) to point to the new NVE.  Furthermore, upon
      receiving the MAC/IP withdraw for the TS from the old NVE, these
      remote PEs perform the cleanups for their BGP tables.<a class="pilcrow" href="#section-7.2-4.5">¶</a>
</li>
        </ul>
<p id="section-7.2-5">
   If an EVPN-IRB NVE is configured not to advertise MAC-only routes,
   then upon receiving the first data packet, it learns the MAC address
   of the TS and updates the MAC entry in the corresponding MAC-VRF
   table with the local adjacency information (e.g., local interface).
   It also realizes that there has been a MAC move because the same MAC
   address has been learned remotely from the source NVE.  It uses the
   local MAC route to find the corresponding local MAC-IP route and
   sends a unicast ARP request to the host. When receiving an ARP
   response, it follows the procedure outlined in <a class="xref" href="#sect-7.1">Section 7.1</a>.  In the
   prior case, where MAC-only routes are also advertised, this procedure
   of triggering a unicast ARP probe at the target PE <span class="bcp14">MAY</span> also be used
   in addition to the source PE broadcast ARP probing procedure
   described earlier for better convergence.<a class="pilcrow" href="#section-7.2-5">¶</a></p>
</section>
</div>
<div id="sect-7.3">
<section id="section-7.3">
        <h3 id="name-silent-host">
<a class="section-number selfRef" href="#section-7.3">7.3. </a><a class="section-name selfRef" href="#name-silent-host">Silent Host</a>
        </h3>
<p id="section-7.3-1">
   In this scenario, when a TS moves from a source NVE to a target NVE,
   the TS is silent, and it neither initiates an ARP request nor sends
   any data traffic.  Therefore, neither the target nor the source NVEs
   are aware of the MAC move.<a class="pilcrow" href="#section-7.3-1">¶</a></p>
<p id="section-7.3-2">
   On the source NVE, an age-out timer (for the silent host that has
   moved) is used to trigger an ARP probe.  This age-out timer can be
   either an ARP timer or a MAC age-out timer, and this is an implementation
   choice.  The ARP request gets sent both locally to all the attached
   TSs on that subnet as well as to all the remote NVEs
   (including the target NVE) participating in that subnet.  The source
   NVE also withdraws the EVPN MAC/IP Advertisement route with only the
   MAC address (if it has previously advertised such a route).<a class="pilcrow" href="#section-7.3-2">¶</a></p>
<p id="section-7.3-3">
   The target NVE passes the ARP request to its locally attached TSs, and when
   it receives the ARP response, it updates its MAC-VRF, IP-VRF, and ARP table
   with the host (IP, MAC) and local adjacency information (e.g., local
   interface).  It also sends an EVPN MAC/IP Advertisement route with both the
   MAC and IP address fields filled in along with the MAC Mobility extended
   community, with the sequence number incremented by one.<a class="pilcrow" href="#section-7.3-3">¶</a></p>
<p id="section-7.3-4">
   When the source NVE receives the EVPN MAC/IP Advertisement route, it
   updates its IP-VRF table with the new adjacency information (pointing
   to the target NVE).  In the case of the asymmetric IRB, the source
   NVE also updates its ARP table with the received adjacency
   information, and in the case of the symmetric IRB, the source NVE
   removes the entry associated with the received (IP, MAC) from its
   local ARP table.  Furthermore, it withdraws its previously advertised
   EVPN MAC/IP route with both the MAC and IP address fields filled in.<a class="pilcrow" href="#section-7.3-4">¶</a></p>
<p id="section-7.3-5">
   All other remote NVE devices, upon receiving the MAC/IP Advertisement route
   with the MAC Mobility extended community, compare the sequence number in this
   advertisement with the one previously received.  If the new sequence number
   is greater than the old one, then they update the MAC/IP addresses of the
   TS in their corresponding MAC-VRF, IP-VRF, and ARP (in the case of
   asymmetric IRB) tables to point to the new NVE.  Furthermore, upon
   receiving the MAC/IP withdraw for the TS from the old NVE, these remote PEs
   perform the cleanups for their BGP tables.<a class="pilcrow" href="#section-7.3-5">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-8">
<section id="section-8">
      <h2 id="name-bgp-encoding">
<a class="section-number selfRef" href="#section-8">8. </a><a class="section-name selfRef" href="#name-bgp-encoding">BGP Encoding</a>
      </h2>
<p id="section-8-1">
   This document defines one new BGP Extended Community for EVPN.<a class="pilcrow" href="#section-8-1">¶</a></p>
<div id="sect-8.1">
<section id="section-8.1">
        <h3 id="name-evpn-routers-mac-extended-c">
<a class="section-number selfRef" href="#section-8.1">8.1. </a><a class="section-name selfRef" href="#name-evpn-routers-mac-extended-c">EVPN Router's MAC Extended Community</a>
        </h3>
<p id="section-8.1-1">
   A new EVPN BGP Extended Community called "EVPN Router's MAC" is introduced
   here.  This new extended community is a transitive extended community
   with a Type field of 0x06 (EVPN) and a Sub-Type field of 0x03.  It may
   be advertised along with the Encapsulation Extended Community defined in
   <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9012#section-4.1">Section 4.1</a> of [<a class="xref" href="#RFC9012">RFC9012</a>]</span>.<a class="pilcrow" href="#section-8.1-1">¶</a></p>
<p id="section-8.1-2">
   The EVPN Router's MAC Extended Community is encoded as an 8-octet value as
   follows:<a class="pilcrow" href="#section-8.1-2">¶</a></p>
<span id="name-evpn-routers-mac-extended-co"></span><div id="fig-5">
<figure id="figure-5">
          <div class="alignLeft art-text artwork" id="section-8.1-3.1">
<pre>     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    | Type=0x06     | Sub-Type=0x03 |        EVPN Router's MAC      |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                    EVPN Router's MAC Cont'd                   |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-5">Figure 5</a>:
<a class="selfRef" href="#name-evpn-routers-mac-extended-co">EVPN Router's MAC Extended Community</a>
          </figcaption></figure>
</div>
<p id="section-8.1-4">
   This extended community is used to carry the PE's MAC address for
   symmetric IRB scenarios, and it is sent with EVPN RT-2.  The
   advertising PE <span class="bcp14">SHALL</span> only attach a single EVPN Router's MAC Extended
   Community to a route.  In case the receiving PE receives more than
   one EVPN Router's MAC Extended Community with a route, it <span class="bcp14">SHALL</span> process
   the first one in the list and not store and propagate the others.<a class="pilcrow" href="#section-8.1-4">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-9">
<section id="section-9">
      <h2 id="name-operational-models-for-symm">
<a class="section-number selfRef" href="#section-9">9. </a><a class="section-name selfRef" href="#name-operational-models-for-symm">Operational Models for Symmetric Inter-Subnet Forwarding</a>
      </h2>
<p id="section-9-1">
   The following sections describe two main symmetric IRB forwarding
   scenarios (within a DC -- i.e., intra-DC) along with the
   corresponding procedures.  In the following scenarios, without loss
   of generality, it is assumed that a given tenant is represented by a
   single IP-VPN instance.  Therefore, on a given PE, a tenant is
   represented by a single IP-VRF table and one or more MAC-VRF tables.<a class="pilcrow" href="#section-9-1">¶</a></p>
<div id="sect-9.1">
<section id="section-9.1">
        <h3 id="name-irb-forwarding-on-nves-for-">
<a class="section-number selfRef" href="#section-9.1">9.1. </a><a class="section-name selfRef" href="#name-irb-forwarding-on-nves-for-">IRB Forwarding on NVEs for Tenant Systems</a>
        </h3>
<p id="section-9.1-1">
   This section covers the symmetric IRB procedures for the scenario
   where each TS is attached to one or more NVEs, and its
   host IP and MAC addresses are learned by the attached NVEs and are
   distributed to all other NVEs that are interested in participating in
   both intra-subnet and inter-subnet communications with that TS.<a class="pilcrow" href="#section-9.1-1">¶</a></p>
<p id="section-9.1-2">
   In this scenario, without loss of generality, it is assumed that NVEs
   operate in VLAN-based service interface mode with one bridge table(s)
   per MAC-VRF.  Thus, for a given tenant, an NVE has one MAC-VRF for
   each tenant subnet (e.g., each VLAN) that is configured for extension
   via VXLAN or NVGRE encapsulation.  In the case of VLAN-aware
   bundling, each MAC-VRF consists of multiple bridge tables (e.g.,
   one bridge table per VLAN).  The MAC-VRFs on an NVE for a given
   tenant are associated with an IP-VRF corresponding to that tenant (or
   IP-VPN instance) via their IRB interfaces.<a class="pilcrow" href="#section-9.1-2">¶</a></p>
<p id="section-9.1-3">
   Since VXLAN and NVGRE encapsulations require an inner Ethernet header
   (inner MAC SA/DA) and since a TS MAC address cannot be used for inter-subnet traffic, the ingress NVE's MAC address is used as an inner MAC
   SA.  The NVE's MAC address is the device MAC address, and it is common
   across all MAC-VRFs and IP-VRFs.  This MAC address is advertised
   using the new EVPN Router's MAC Extended Community (<a class="xref" href="#sect-8.1">Section 8.1</a>).<a class="pilcrow" href="#section-9.1-3">¶</a></p>
<p id="section-9.1-4">
   <a class="xref" href="#fig-6">Figure 6</a> below illustrates this scenario, where a given tenant (e.g., an
   IP-VPN instance) has three subnets represented by MAC-VRF1, MAC-VRF2, and
   MAC-VRF3 across two NVEs.  There are five TSs that are associated with
   these three MAC-VRFs -- i.e., TS1, TS4, and TS5 are on the same subnet
   (e.g., the same MAC-VRF/VLAN).  TS1 and TS5 are associated with MAC-VRF1 on
   NVE1, while TS4 is associated with MAC-VRF1 on NVE2.  TS2 is associated
   with MAC-VRF2 on NVE1, and TS3 is associated with MAC-VRF3 on NVE2.
   MAC-VRF1 and MAC-VRF2 on NVE1 are, in turn, associated with IP-VRF1 on NVE1,
   and MAC-VRF1 and MAC-VRF3 on NVE2 are associated with IP-VRF1 on NVE2.
   When TS1, TS5, and TS4 exchange traffic with each other, only the L2
   forwarding (bridging) part of the IRB solution is exercised because all
   these TSs belong to the same subnet.  However, when TS1 wants to exchange
   traffic with TS2 or TS3, which belong to different subnets, both the bridging
   and routing parts of the IRB solution are exercised.  The following
   subsections describe the control and data plane operations for this IRB
   scenario in detail.<a class="pilcrow" href="#section-9.1-4">¶</a></p>
<span id="name-irb-forwarding-on-nves-for-t"></span><div id="fig-6">
<figure id="figure-6">
          <div class="alignLeft art-text artwork" id="section-9.1-5.1">
<pre>                  NVE1         +---------+
            +-------------+    |         |
    TS1-----|         MACx|    |         |        NVE2
  (M1/IP1)  |(MAC-        |    |         |   +-------------+
    TS5-----| VRF1)\      |    |  MPLS/  |   |MACy  (MAC-  |-----TS3
  (M5/IP5)  |       \     |    |  VXLAN/ |   |     / VRF3) | (M3/IP3)
            |    (IP-VRF1)|----|  NVGRE  |---|(IP-VRF1)    |
            |       /     |    |         |   |     \       |
    TS2-----|(MAC- /      |    |         |   |      (MAC-  |-----TS4
  (M2/IP2)  | VRF2)       |    |         |   |       VRF1) | (M4/IP4)
            +-------------+    |         |   +-------------+
                               |         |
                               +---------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-6">Figure 6</a>:
<a class="selfRef" href="#name-irb-forwarding-on-nves-for-t">IRB Forwarding on NVEs for Tenant Systems</a>
          </figcaption></figure>
</div>
<div id="sect-9.1.1">
<section id="section-9.1.1">
          <h4 id="name-control-plane-operation">
<a class="section-number selfRef" href="#section-9.1.1">9.1.1. </a><a class="section-name selfRef" href="#name-control-plane-operation">Control Plane Operation</a>
          </h4>
<p id="section-9.1.1-1">
   Each NVE advertises a MAC/IP Advertisement route (i.e., route type 2)
   for each of its TSs with the following field set:<a class="pilcrow" href="#section-9.1.1-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.1.1-2.1">RD and Ethernet Segment Identifier (ESI) per <span>[<a class="xref" href="#RFC7432">RFC7432</a>]</span><a class="pilcrow" href="#section-9.1.1-2.1">¶</a>
</li>
            <li class="normal" id="section-9.1.1-2.2">Ethernet Tag = 0 (assuming VLAN-based service)<a class="pilcrow" href="#section-9.1.1-2.2">¶</a>
</li>
            <li class="normal" id="section-9.1.1-2.3">MAC Address Length = 48<a class="pilcrow" href="#section-9.1.1-2.3">¶</a>
</li>
            <li class="normal" id="section-9.1.1-2.4">MAC Address = Mi (where i = 1, 2, 3, 4, or 5) in <a class="xref" href="#fig-6">Figure 6</a>, above<a class="pilcrow" href="#section-9.1.1-2.4">¶</a>
</li>
            <li class="normal" id="section-9.1.1-2.5">IP Address Length = 32 or 128<a class="pilcrow" href="#section-9.1.1-2.5">¶</a>
</li>
            <li class="normal" id="section-9.1.1-2.6">IP Address = IPi (where i = 1, 2, 3, 4, or 5) in <a class="xref" href="#fig-6">Figure 6</a>, above<a class="pilcrow" href="#section-9.1.1-2.6">¶</a>
</li>
            <li class="normal" id="section-9.1.1-2.7">Label1 = MPLS label or VNI corresponding to MAC-VRF<a class="pilcrow" href="#section-9.1.1-2.7">¶</a>
</li>
            <li class="normal" id="section-9.1.1-2.8">Label2 = MPLS label or VNI corresponding to IP-VRF<a class="pilcrow" href="#section-9.1.1-2.8">¶</a>
</li>
          </ul>
<p id="section-9.1.1-3">
   Each NVE advertises an EVPN RT-2 route with two Route Targets (one
   corresponding to its MAC-VRF and the other corresponding to its IP-VRF).
   Furthermore, the EVPN RT-2 is advertised with two BGP Extended Communities.
   The first BGP Extended Community identifies the tunnel type, and it is
   called "Encapsulation Extended Community" as defined in
   <span>[<a class="xref" href="#RFC9012">RFC9012</a>]</span>, and the second BGP Extended Community includes
   the MAC address of the NVE (e.g., MACx for NVE1 or MACy for NVE2) as
   defined in <a class="xref" href="#sect-8.1">Section 8.1</a>.  The EVPN Router's MAC Extended Community <span class="bcp14">MUST</span> be added
   when the Ethernet NVO tunnel is used.  If the IP NVO tunnel type is used, then
   there is no need to send this second Extended Community.  It should be
   noted that the IP NVO tunnel type is only applicable to symmetric IRB
   procedures.<a class="pilcrow" href="#section-9.1.1-3">¶</a></p>
<p id="section-9.1.1-4">
   Upon receiving this advertisement, the receiving NVE performs the
   following:<a class="pilcrow" href="#section-9.1.1-4">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.1.1-5.1">It uses Route Targets corresponding to its MAC-VRF and IP-VRF for
      identifying these tables and subsequently importing the MAC and IP
      addresses into them, respectively.<a class="pilcrow" href="#section-9.1.1-5.1">¶</a>
</li>
            <li class="normal" id="section-9.1.1-5.2">It imports the MAC address from the MAC/IP Advertisement route into
      the MAC-VRF with the BGP next-hop address as the underlay tunnel
      destination address (e.g., VTEP DA for VXLAN encapsulation) and
      label1 as the VNI for VXLAN encapsulation or an EVPN label for MPLS
      encapsulation.<a class="pilcrow" href="#section-9.1.1-5.2">¶</a>
</li>
            <li class="normal" id="section-9.1.1-5.3">If the route carries the new EVPN Router's MAC Extended Community and
      if the receiving NVE uses an Ethernet NVO tunnel, then the receiving
      NVE imports the IP address into IP-VRF with NVE's MAC address
      (from the new EVPN Router's MAC Extended Community) as the inner MAC DA, the BGP next-hop address as the underlay tunnel destination address, the VTEP DA for VXLAN encapsulation, and label2 as the IP-VPN VNI for VXLAN
      encapsulation.<a class="pilcrow" href="#section-9.1.1-5.3">¶</a>
</li>
            <li class="normal" id="section-9.1.1-5.4">If the receiving NVE uses MPLS encapsulation, then the receiving
      NVE imports the IP address into IP-VRF with the BGP next-hop address
      as the underlay tunnel destination address and label2 as the IP-VPN
      label for MPLS encapsulation.<a class="pilcrow" href="#section-9.1.1-5.4">¶</a>
</li>
          </ul>
<p id="section-9.1.1-6">
   If the receiving NVE receives an EVPN RT-2 with only label1 and only
   a single Route Target corresponding to IP-VRF; an
   EVPN RT-2 with only a single Route Target corresponding to MAC-VRF
   but with both label1 and label2; or an EVPN RT-2 with a
   MAC address length of zero, then it <span class="bcp14">MUST</span> use the treat-as-withdraw
   approach <span>[<a class="xref" href="#RFC7606">RFC7606</a>]</span> and <span class="bcp14">SHOULD</span> log an error message.<a class="pilcrow" href="#section-9.1.1-6">¶</a></p>
</section>
</div>
<div id="sect-9.1.2">
<section id="section-9.1.2">
          <h4 id="name-data-plane-operation">
<a class="section-number selfRef" href="#section-9.1.2">9.1.2. </a><a class="section-name selfRef" href="#name-data-plane-operation">Data Plane Operation</a>
          </h4>
<p id="section-9.1.2-1">
   The following description of the data plane operation describes just
   the logical functions, and the actual implementation may differ. Let's consider the data plane operation when TS1 in subnet-1 (MAC-VRF1) on NVE1
wants to send traffic to TS3 in subnet-3 (MAC-VRF3) on NVE2.<a class="pilcrow" href="#section-9.1.2-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.1.2-2.1">NVE1 receives a packet with the MAC DA corresponding to the MAC-VRF1 IRB
      interface on NVE1 (the interface between MAC-VRF1 and IP-VRF1) and
      the VLAN tag corresponding to MAC-VRF1.<a class="pilcrow" href="#section-9.1.2-2.1">¶</a>
</li>
            <li class="normal" id="section-9.1.2-2.2">Upon receiving the packet, the NVE1 uses the VLAN tag to identify the
      MAC-VRF1.  It then looks up the MAC DA and forwards the frame to
      its IRB interface.<a class="pilcrow" href="#section-9.1.2-2.2">¶</a>
</li>
            <li class="normal" id="section-9.1.2-2.3">The Ethernet header of the packet is stripped, and the packet is
      fed to the IP-VRF, where an IP lookup is performed on the
      destination IP address.  NVE1 also decrements the TTL / hop limit
      for that packet by one, and if it reaches zero, NVE1 discards the
      packet.  This lookup yields the outgoing NVO tunnel and the
      required encapsulation.  If the encapsulation is for the Ethernet NVO
      tunnel, then it includes the egress NVE's MAC address as the inner MAC
      DA, the egress NVE's IP address (e.g., BGP next-hop address) as
      the VTEP DA, and the VPN-ID as the VNI.  The inner MAC SA and VTEP
      SA are set to NVE's MAC and IP addresses, respectively.  If it is an
      MPLS encapsulation, then the corresponding EVPN and LSP labels are
      added to the packet.  The packet is then forwarded to the egress
      NVE.<a class="pilcrow" href="#section-9.1.2-2.3">¶</a>
</li>
            <li class="normal" id="section-9.1.2-2.4">If the egress NVE receives a packet from the Ethernet NVO tunnel (e.g., it is VXLAN encapsulated), 
then it removes the Ethernet header. Since the inner MAC DA is the egress NVE's MAC address,
      the egress NVE knows that it needs to perform an IP lookup.  It
      uses the VNI to identify the IP-VRF table.  If the packet is MPLS
      encapsulated, then the EVPN label lookup identifies the IP-VRF
      table.  Next, an IP lookup is performed for the destination TS
      (TS3), which results in an access-facing IRB interface over which
      the packet is sent.  Before sending the packet over this
      interface, the ARP table is consulted to get the destination TS's
      MAC address.  NVE2 also decrements the TTL / hop limit for that
      packet by one, and if it reaches zero, NVE2 discards the packet.<a class="pilcrow" href="#section-9.1.2-2.4">¶</a>
</li>
            <li class="normal" id="section-9.1.2-2.5">The IP packet is encapsulated with an Ethernet header, with the MAC SA
      set to that of the IRB interface MAC address (i.e., the IRB interface
      between MAC-VRF3 and IP-VRF1 on NVE2) and the MAC DA set to that of the
      destination TS (TS3) MAC address.  The packet is sent to the
      corresponding MAC-VRF (i.e., MAC-VRF3) and, after a lookup of MAC
      DA, is forwarded to the destination TS (TS3) over the
      corresponding interface.<a class="pilcrow" href="#section-9.1.2-2.5">¶</a>
</li>
          </ul>
<p id="section-9.1.2-3">
   In this symmetric IRB scenario, inter-subnet traffic between NVEs
   will always use the IP-VRF VNI/MPLS label.  For instance, traffic
   from TS2 to TS4 will be encapsulated by NVE1 using NVE2's IP-VRF VNI/MPLS label, as long as TS4's host IP is present in NVE1's IP-VRF.<a class="pilcrow" href="#section-9.1.2-3">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-9.2">
<section id="section-9.2">
        <h3 id="name-irb-forwarding-on-nves-for-s">
<a class="section-number selfRef" href="#section-9.2">9.2. </a><a class="section-name selfRef" href="#name-irb-forwarding-on-nves-for-s">IRB Forwarding on NVEs for Subnets behind Tenant Systems</a>
        </h3>
<p id="section-9.2-1">
   This section covers the symmetric IRB procedures for the scenario where
   some TSs support one or more subnets and these TSs are
   associated with one or more NVEs.  Therefore, besides the advertisement of
   MAC/IP addresses for each TS, which can be multihomed with All-Active
   redundancy mode, the associated NVE needs to also advertise the subnets
   statically configured on each TS.<a class="pilcrow" href="#section-9.2-1">¶</a></p>
<p id="section-9.2-2">
   The main difference between this solution and the previous one is the
   additional advertisement corresponding to each subnet.  These subnet
   advertisements are accomplished using the EVPN IP Prefix route
   defined in <span>[<a class="xref" href="#RFC9136">RFC9136</a>]</span>.  These subnet
   prefixes are advertised with the IP address of their associated TS
   (which is in an overlay address space) as their next hop.  The receiving
   NVEs perform recursive route resolution to resolve the subnet prefix
   with its advertising NVE so that they know which NVE to forward the
   packets to when they are destined for that subnet prefix.<a class="pilcrow" href="#section-9.2-2">¶</a></p>
<p id="section-9.2-3">
   The advantage of this recursive route resolution is that when a TS
   moves from one NVE to another, there is no need to re-advertise any
   of the subnet prefixes for that TS.  All that is needed is to advertise
   the IP/MAC addresses associated with the TS itself and exercise the MAC
   Mobility procedures for that TS.  The recursive route resolution
   automatically takes care of the updates for the subnet prefixes of
   that TS.<a class="pilcrow" href="#section-9.2-3">¶</a></p>
<p id="section-9.2-4">
   <a class="xref" href="#fig-7">Figure 7</a> illustrates this scenario where a given tenant (e.g., an IP-VPN
   service) has three subnets represented by MAC-VRF1, MAC-VRF2, and MAC-VRF3
   across two NVEs.  There are four TSs associated with these three MAC-VRFs
   -- i.e., TS1 is connected to MAC-VRF1 on NVE1, TS2 is connected to MAC-VRF2
   on NVE1, TS3 is connected to MAC-VRF3 on NVE2, and TS4 is connected to
   MAC-VRF1 on NVE2.  TS1 has two subnet prefixes (SN1 and SN2), and TS3 has a
   single subnet prefix (SN3).  The MAC-VRFs on each NVE are associated with
   their corresponding IP-VRF using their IRB interfaces.  When TS4 and TS1
   exchange intra-subnet traffic, only the L2 forwarding (bridging) part of the
   IRB solution is used (i.e., the traffic only goes through their MAC-VRFs);
   however, when TS3 wants to forward traffic to SN1 or SN2 sitting behind TS1
   (inter-subnet traffic), then both the bridging and routing parts of the IRB
   solution are exercised (i.e., the traffic goes through the corresponding
   MAC-VRFs and IP-VRFs).  

If TS4, for example, wants to reach SN1, it uses
   its default route and sends the packet to the MAC address associated with
   the IRB interface on NVE2; NVE2 then performs an IP lookup in its IP-VRF and
   finds an entry for SN1.  The following subsections describe the control and
   data plane operations for this IRB scenario in detail.<a class="pilcrow" href="#section-9.2-4">¶</a></p>
<span id="name-irb-forwarding-on-nves-for-su"></span><div id="fig-7">
<figure id="figure-7">
          <div class="alignLeft art-text artwork" id="section-9.2-5.1">
<pre>                             NVE1      +----------+
     SN1--+          +-------------+   |          |
          |--TS1-----|(MAC- \      |   |          |
     SN2--+ M1/IP1   | VRF1) \     |   |          |
                     |     (IP-VRF)|---|          |
                     |       /     |   |          |
             TS2-----|(MAC- /      |   |  MPLS/   |
            M2/IP2   | VRF2)       |   |  VXLAN/  |
                     +-------------+   |  NVGRE   |
                     +-------------+   |          |
     SN3--+--TS3-----|(MAC-\       |   |          |
            M3/IP3   | VRF3)\      |   |          |
                     |     (IP-VRF)|---|          |
                     |       /     |   |          |
             TS4-----|(MAC- /      |   |          |
            M4/IP4   | VRF1)       |   |          |
                     +-------------+   +----------+
                            NVE2
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-7">Figure 7</a>:
<a class="selfRef" href="#name-irb-forwarding-on-nves-for-su">IRB Forwarding on NVEs for Subnets behind TSs</a>
          </figcaption></figure>
</div>
<p id="section-9.2-6">
   Note that in <a class="xref" href="#fig-7">Figure 7</a>, above, SN1 and SN2 are configured on NVE1,
   which then advertises each in an IP Prefix route.  Similarly, SN3 is
   configured on NVE2, which then advertises it in an IP Prefix route.<a class="pilcrow" href="#section-9.2-6">¶</a></p>
<div id="sect-9.2.1">
<section id="section-9.2.1">
          <h4 id="name-control-plane-operation-2">
<a class="section-number selfRef" href="#section-9.2.1">9.2.1. </a><a class="section-name selfRef" href="#name-control-plane-operation-2">Control Plane Operation</a>
          </h4>
<p id="section-9.2.1-1">
   Each NVE advertises a route type 5 (EVPN RT-5, IP Prefix route
   defined in <span>[<a class="xref" href="#RFC9136">RFC9136</a>]</span>) for each of its
   subnet prefixes with the IP address of its TS as the next hop
   (Gateway Address field) as follows:<a class="pilcrow" href="#section-9.2.1-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.2.1-2.1">RD associated with the IP-VRF<a class="pilcrow" href="#section-9.2.1-2.1">¶</a>
</li>
            <li class="normal" id="section-9.2.1-2.2">ESI = 0<a class="pilcrow" href="#section-9.2.1-2.2">¶</a>
</li>
            <li class="normal" id="section-9.2.1-2.3">Ethernet Tag = 0<a class="pilcrow" href="#section-9.2.1-2.3">¶</a>
</li>
            <li class="normal" id="section-9.2.1-2.4">IP Prefix Length = 0 to 32 or 0 to 128<a class="pilcrow" href="#section-9.2.1-2.4">¶</a>
</li>
            <li class="normal" id="section-9.2.1-2.5">IP Prefix = SNi<a class="pilcrow" href="#section-9.2.1-2.5">¶</a>
</li>
            <li class="normal" id="section-9.2.1-2.6">Gateway Address = IPi (IP address of TS)<a class="pilcrow" href="#section-9.2.1-2.6">¶</a>
</li>
            <li class="normal" id="section-9.2.1-2.7">MPLS Label = 0<a class="pilcrow" href="#section-9.2.1-2.7">¶</a>
</li>
          </ul>
<p id="section-9.2.1-3">
   This EVPN RT-5 is advertised with one or more Route Targets associated with
   the IP-VRF from which the route is originated.<a class="pilcrow" href="#section-9.2.1-3">¶</a></p>
<p id="section-9.2.1-4">

   Each NVE also advertises an EVPN RT-2 (MAC/IP Advertisement route)
   along with its associated Route Targets and Extended Communities
   for each of its TSs exactly as described in <a class="xref" href="#sect-9.1.1">Section 9.1.1</a>.<a class="pilcrow" href="#section-9.2.1-4">¶</a></p>
<p id="section-9.2.1-5">
   Upon receiving the EVPN RT-5 advertisement, the receiving NVE
   performs the following:<a class="pilcrow" href="#section-9.2.1-5">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.2.1-6.1">It uses the Route Target to identify the corresponding IP-VRF.<a class="pilcrow" href="#section-9.2.1-6.1">¶</a>
</li>
            <li class="normal" id="section-9.2.1-6.2">It imports the IP prefix into its corresponding IP-VRF
      configured with an import RT that is one of the RTs being carried
      by the EVPN RT-5 route, along with the IP address of the associated
      TS as its next hop.<a class="pilcrow" href="#section-9.2.1-6.2">¶</a>
</li>
          </ul>
<p id="section-9.2.1-7">
   When receiving the EVPN RT-2 advertisement, the receiving NVE imports the
   MAC/IP addresses of the TS into the corresponding MAC-VRF and IP-VRF
   per <a class="xref" href="#sect-9.1.1">Section 9.1.1</a>.  When both routes exist, recursive route
   resolution is performed to resolve the IP prefix (received in EVPN
   RT-5) to its corresponding NVE's IP address (e.g., its BGP next hop).
   The BGP next hop will be used as the underlay tunnel destination address
   (e.g., VTEP DA for VXLAN encapsulation), and the EVPN Router's MAC will be used
   as the inner MAC for VXLAN encapsulation.<a class="pilcrow" href="#section-9.2.1-7">¶</a></p>
</section>
</div>
<div id="sect-9.2.2">
<section id="section-9.2.2">
          <h4 id="name-data-plane-operation-2">
<a class="section-number selfRef" href="#section-9.2.2">9.2.2. </a><a class="section-name selfRef" href="#name-data-plane-operation-2">Data Plane Operation</a>
          </h4>
<p id="section-9.2.2-1">
   The following description of the data plane operation describes just
   the logical functions, and the actual implementation may differ.  Let's consider the data plane operation when a host in SN1 behind TS1 wants to send traffic
to a host in SN3 behind TS3.<a class="pilcrow" href="#section-9.2.2-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.2.2-2.1">TS1 sends a packet with MAC DA corresponding to the MAC-VRF1 IRB
      interface of NVE1 and a VLAN tag corresponding to MAC-VRF1.<a class="pilcrow" href="#section-9.2.2-2.1">¶</a>
</li>
            <li class="normal" id="section-9.2.2-2.2">Upon receiving the packet, the ingress NVE1 uses the VLAN tag to
      identify the MAC-VRF1.  It then looks up the MAC DA and forwards
      the frame to its IRB interface as in <a class="xref" href="#sect-9.1.1">Section 9.1.1</a>.<a class="pilcrow" href="#section-9.2.2-2.2">¶</a>
</li>
            <li class="normal" id="section-9.2.2-2.3">The Ethernet header of the packet is stripped, and the packet is
      fed to the IP-VRF, where an IP lookup is performed on the
      destination address.

This lookup yields the fields needed for
      VXLAN encapsulation with NVE2's MAC address as the inner MAC DA,
      NVE2's IP address as the VTEP DA, and the VNI.  The MAC SA is set to
      NVE1's MAC address, and the VTEP SA is set to NVE1's IP address.  NVE1
      also decrements the TTL / hop limit for that packet by one, and if it
      reaches zero, NVE1 discards the packet.<a class="pilcrow" href="#section-9.2.2-2.3">¶</a>
</li>
            <li class="normal" id="section-9.2.2-2.4">The packet is then encapsulated with the proper header based on
      the above info and is forwarded to the egress NVE (NVE2).<a class="pilcrow" href="#section-9.2.2-2.4">¶</a>
</li>
            <li class="normal" id="section-9.2.2-2.5">On the egress NVE (NVE2), assuming the packet is VXLAN
      encapsulated, the VXLAN and the inner Ethernet headers are removed,
      and the resultant IP packet is fed to the IP-VRF associated with
      that VNI.<a class="pilcrow" href="#section-9.2.2-2.5">¶</a>
</li>
            <li class="normal" id="section-9.2.2-2.6">Next, a lookup is performed based on the IP DA (which is in SN3) in the
      associated IP-VRF of NVE2.  The IP lookup yields the access-facing IRB
      interface over which the packet needs to be sent.  Before sending the
      packet over this interface, the ARP table is consulted to get the
      destination TS (TS3) MAC address.  NVE2 also decrements the TTL / hop
      limit for that packet by one, and if it reaches zero, NVE2 discards the
      packet.<a class="pilcrow" href="#section-9.2.2-2.6">¶</a>
</li>
            <li class="normal" id="section-9.2.2-2.7">The IP packet is encapsulated with an Ethernet header with the MAC
      SA set to that of the access-facing IRB interface of the egress
      NVE (NVE2), and the MAC DA is set to that of the destination TS (TS3)
      MAC address.  The packet is sent to the corresponding MAC-VRF3 and,
      after a lookup of MAC DA, is forwarded to the destination TS (TS3)
      over the corresponding interface.<a class="pilcrow" href="#section-9.2.2-2.7">¶</a>
</li>
          </ul>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="sect-11">
<section id="section-10">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-10">10. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<p id="section-10-1">
   The security considerations for Layer 2 forwarding in this document
   follow those of <span>[<a class="xref" href="#RFC7432">RFC7432</a>]</span> for MPLS encapsulation and those
   of <span>[<a class="xref" href="#RFC8365">RFC8365</a>]</span> for VXLAN or NVGRE encapsulations.  This section
   describes additional considerations.<a class="pilcrow" href="#section-10-1">¶</a></p>
<p id="section-10-2">
   This document describes a set of procedures for inter-subnet
   forwarding of tenant traffic across PEs (or NVEs).  These procedures
   include both Layer 2 forwarding and Layer 3 routing on a packet-by-packet basis.  The security consideration for Layer 3 routing in this
   document follows that of <span>[<a class="xref" href="#RFC4365">RFC4365</a>]</span>, with the exception of the
   application of routing protocols between CEs and PEs.  Contrary to
   <span>[<a class="xref" href="#RFC4364">RFC4364</a>]</span>, this document does not describe route distribution
   techniques between CEs and PEs but rather considers the CEs as TSs
   or VAs that do not run dynamic routing protocols.  This can be
   considered a security advantage, since dynamic routing protocols can
   be blocked on the NVE/PE ACs, not allowing the tenant to interact
   with the infrastructure's dynamic routing protocols.<a class="pilcrow" href="#section-10-2">¶</a></p>
<p id="section-10-3">
   The VPN scheme described in this document does not provide the
   quartet of security properties mentioned in <span>[<a class="xref" href="#RFC4365">RFC4365</a>]</span>
   (confidentiality protection, source authentication, integrity
   protection, and replay protection).  If these are desired, they must be
   provided by mechanisms that are outside the scope of the VPN
   mechanisms.<a class="pilcrow" href="#section-10-3">¶</a></p>
<p id="section-10-4">
   In this document, the EVPN RT-5 is used for certain scenarios.  This
   route uses an Overlay Index that requires a recursive resolution to a
   different EVPN route (an EVPN RT-2).  Because of this, it is worth
   noting that any action that ends up filtering or modifying the EVPN
   RT-2 route used to convey the Overlay Indexes will modify the
   resolution of the EVPN RT-5 and therefore the forwarding of packets
   to the remote subnet.<a class="pilcrow" href="#section-10-4">¶</a></p>
</section>
</div>
<div id="sect-12">
<section id="section-11">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-11">11. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<p id="section-11-1">
      IANA has allocated Sub-Type value 0x03 in the "EVPN Extended Community Sub-Types" registry as follows:<a class="pilcrow" href="#section-11-1">¶</a></p>
<div id="IANA_table">
<table class="center" id="table-1">
        <caption><a class="selfRef" href="#table-1">Table 1</a></caption>
<thead>
          <tr>
            <th class="text-left" colspan="1" rowspan="1">Sub-Type Value</th>
            <th class="text-left" colspan="1" rowspan="1">Name</th>
            <th class="text-left" colspan="1" rowspan="1">Reference</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">0x03</td>
            <td class="text-left" colspan="1" rowspan="1">EVPN Router's MAC Extended Community</td>
            <td class="text-left" colspan="1" rowspan="1">RFC 9135</td>
          </tr>
        </tbody>
      </table>
</div>
<p id="section-11-3">
   This document has been listed as an additional reference for the MAC/IP Advertisement route in the "EVPN Route Types" registry.<a class="pilcrow" href="#section-11-3">¶</a></p>
</section>
</div>
<section id="section-12">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-12">12. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-12.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-12.1">12.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time class="refDate" datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4364">[RFC4364]</dt>
        <dd>
<span class="refAuthor">Rosen, E.</span> and <span class="refAuthor">Y. Rekhter</span>, <span class="refTitle">"BGP/MPLS IP Virtual Private Networks (VPNs)"</span>, <span class="seriesInfo">RFC 4364</span>, <span class="seriesInfo">DOI 10.17487/RFC4364</span>, <time class="refDate" datetime="2006-02">February 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4364">https://www.rfc-editor.org/info/rfc4364</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7432">[RFC7432]</dt>
        <dd>
<span class="refAuthor">Sajassi, A., Ed.</span>, <span class="refAuthor">Aggarwal, R.</span>, <span class="refAuthor">Bitar, N.</span>, <span class="refAuthor">Isaac, A.</span>, <span class="refAuthor">Uttaro, J.</span>, <span class="refAuthor">Drake, J.</span>, and <span class="refAuthor">W. Henderickx</span>, <span class="refTitle">"BGP MPLS-Based Ethernet VPN"</span>, <span class="seriesInfo">RFC 7432</span>, <span class="seriesInfo">DOI 10.17487/RFC7432</span>, <time class="refDate" datetime="2015-02">February 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7432">https://www.rfc-editor.org/info/rfc7432</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7606">[RFC7606]</dt>
        <dd>
<span class="refAuthor">Chen, E., Ed.</span>, <span class="refAuthor">Scudder, J., Ed.</span>, <span class="refAuthor">Mohapatra, P.</span>, and <span class="refAuthor">K. Patel</span>, <span class="refTitle">"Revised Error Handling for BGP UPDATE Messages"</span>, <span class="seriesInfo">RFC 7606</span>, <span class="seriesInfo">DOI 10.17487/RFC7606</span>, <time class="refDate" datetime="2015-08">August 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7606">https://www.rfc-editor.org/info/rfc7606</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time class="refDate" datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8365">[RFC8365]</dt>
        <dd>
<span class="refAuthor">Sajassi, A., Ed.</span>, <span class="refAuthor">Drake, J., Ed.</span>, <span class="refAuthor">Bitar, N.</span>, <span class="refAuthor">Shekhar, R.</span>, <span class="refAuthor">Uttaro, J.</span>, and <span class="refAuthor">W. Henderickx</span>, <span class="refTitle">"A Network Virtualization Overlay Solution Using Ethernet VPN (EVPN)"</span>, <span class="seriesInfo">RFC 8365</span>, <span class="seriesInfo">DOI 10.17487/RFC8365</span>, <time class="refDate" datetime="2018-03">March 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8365">https://www.rfc-editor.org/info/rfc8365</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9012">[RFC9012]</dt>
        <dd>
<span class="refAuthor">Patel, K.</span>, <span class="refAuthor">Van de Velde, G.</span>, <span class="refAuthor">Sangli, S.</span>, and <span class="refAuthor">J. Scudder</span>, <span class="refTitle">"The BGP Tunnel Encapsulation Attribute"</span>, <span class="seriesInfo">RFC 9012</span>, <span class="seriesInfo">DOI 10.17487/RFC9012</span>, <time class="refDate" datetime="2021-04">April 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9012">https://www.rfc-editor.org/info/rfc9012</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9136">[RFC9136]</dt>
      <dd>
<span class="refAuthor">Rabadan, J., Ed.</span>, <span class="refAuthor">Henderickx, W.</span>, <span class="refAuthor">Drake, J.</span>, <span class="refAuthor">Lin, W.</span>, and <span class="refAuthor">A. Sajassi</span>, <span class="refTitle">"IP Prefix Advertisement in Ethernet VPN (EVPN)"</span>, <span class="seriesInfo">RFC 9136</span>, <span class="seriesInfo">DOI 10.17487/RFC9136</span>, <time class="refDate" datetime="2021-10">October 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9136">https://www.rfc-editor.org/info/rfc9136</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-12.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-12.2">12.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-bess-evpn-modes-interop">[EVPN]</dt>
        <dd>
<span class="refAuthor">Krattiger, L., Ed.</span>, <span class="refAuthor">Sajassi, A., Ed.</span>, <span class="refAuthor">Thoria, S.</span>, <span class="refAuthor">Rabadan, J.</span>, and <span class="refAuthor">J. Drake</span>, <span class="refTitle">"EVPN Interoperability Modes"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-bess-evpn-modes-interop-00</span>, <time class="refDate" datetime="2021-05-26">26 May 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-bess-evpn-modes-interop-00">https://datatracker.ietf.org/doc/html/draft-ietf-bess-evpn-modes-interop-00</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-bess-evpn-irb-extended-mobility">[EXTENDED-MOBILITY]</dt>
        <dd>
<span class="refAuthor">Malhotra, N., Ed.</span>, <span class="refAuthor">Sajassi, A.</span>, <span class="refAuthor">Pattekar, A.</span>, <span class="refAuthor">Rabadan, J.</span>, <span class="refAuthor">Lingala, A.</span>, and <span class="refAuthor">J. Drake</span>, <span class="refTitle">"Extended Mobility Procedures for EVPN-IRB"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-bess-evpn-irb-extended-mobility-07</span>, <time class="refDate" datetime="2021-10-02">2 October 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-bess-evpn-irb-extended-mobility-07">https://datatracker.ietf.org/doc/html/draft-ietf-bess-evpn-irb-extended-mobility-07</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4365">[RFC4365]</dt>
        <dd>
<span class="refAuthor">Rosen, E.</span>, <span class="refTitle">"Applicability Statement for BGP/MPLS IP Virtual Private Networks (VPNs)"</span>, <span class="seriesInfo">RFC 4365</span>, <span class="seriesInfo">DOI 10.17487/RFC4365</span>, <time class="refDate" datetime="2006-02">February 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4365">https://www.rfc-editor.org/info/rfc4365</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5798">[RFC5798]</dt>
        <dd>
<span class="refAuthor">Nadas, S., Ed.</span>, <span class="refTitle">"Virtual Router Redundancy Protocol (VRRP) Version 3 for IPv4 and IPv6"</span>, <span class="seriesInfo">RFC 5798</span>, <span class="seriesInfo">DOI 10.17487/RFC5798</span>, <time class="refDate" datetime="2010-03">March 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5798">https://www.rfc-editor.org/info/rfc5798</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7348">[RFC7348]</dt>
        <dd>
<span class="refAuthor">Mahalingam, M.</span>, <span class="refAuthor">Dutt, D.</span>, <span class="refAuthor">Duda, K.</span>, <span class="refAuthor">Agarwal, P.</span>, <span class="refAuthor">Kreeger, L.</span>, <span class="refAuthor">Sridhar, T.</span>, <span class="refAuthor">Bursell, M.</span>, and <span class="refAuthor">C. Wright</span>, <span class="refTitle">"Virtual eXtensible Local Area Network (VXLAN): A Framework for Overlaying Virtualized Layer 2 Networks over Layer 3 Networks"</span>, <span class="seriesInfo">RFC 7348</span>, <span class="seriesInfo">DOI 10.17487/RFC7348</span>, <time class="refDate" datetime="2014-08">August 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7348">https://www.rfc-editor.org/info/rfc7348</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7365">[RFC7365]</dt>
        <dd>
<span class="refAuthor">Lasserre, M.</span>, <span class="refAuthor">Balus, F.</span>, <span class="refAuthor">Morin, T.</span>, <span class="refAuthor">Bitar, N.</span>, and <span class="refAuthor">Y. Rekhter</span>, <span class="refTitle">"Framework for Data Center (DC) Network Virtualization"</span>, <span class="seriesInfo">RFC 7365</span>, <span class="seriesInfo">DOI 10.17487/RFC7365</span>, <time class="refDate" datetime="2014-10">October 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7365">https://www.rfc-editor.org/info/rfc7365</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7637">[RFC7637]</dt>
        <dd>
<span class="refAuthor">Garg, P., Ed.</span> and <span class="refAuthor">Y. Wang, Ed.</span>, <span class="refTitle">"NVGRE: Network Virtualization Using Generic Routing Encapsulation"</span>, <span class="seriesInfo">RFC 7637</span>, <span class="seriesInfo">DOI 10.17487/RFC7637</span>, <time class="refDate" datetime="2015-09">September 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7637">https://www.rfc-editor.org/info/rfc7637</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-nvo3-vxlan-gpe">[VXLAN-GPE]</dt>
      <dd>
<span class="refAuthor">Maino, F., Ed.</span>, <span class="refAuthor">Kreeger, L., Ed.</span>, and <span class="refAuthor">U. Elzur, Ed.</span>, <span class="refTitle">"Generic Protocol Extension for VXLAN (VXLAN-GPE)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-nvo3-vxlan-gpe-12</span>, <time class="refDate" datetime="2021-09-22">22 September 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-nvo3-vxlan-gpe-12">https://datatracker.ietf.org/doc/html/draft-ietf-nvo3-vxlan-gpe-12</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="sect-10">
<section id="appendix-A">
      <h2 id="name-acknowledgements">
<a class="section-name selfRef" href="#name-acknowledgements">Acknowledgements</a>
      </h2>
<p id="appendix-A-1">
   The authors would like to thank <span class="contact-name">Sami Boutros</span>, <span class="contact-name">Jeffrey Zhang</span>,
   <span class="contact-name">Krzysztof Szarkowicz</span>, <span class="contact-name">Lukas Krattiger</span> and <span class="contact-name">Neeraj Malhotra</span> for their
   valuable comments.  The authors would also like to thank <span class="contact-name">Linda Dunbar</span>, <span class="contact-name">Florin Balus</span>, <span class="contact-name">Yakov Rekhter</span>, <span class="contact-name">Wim Henderickx</span>, <span class="contact-name">Lucy Yong</span>, and
   <span class="contact-name">Dennis Cai</span> for their feedback and contributions.<a class="pilcrow" href="#appendix-A-1">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a class="section-name selfRef" href="#name-authors-addresses">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Ali Sajassi</span></div>
<div class="left" dir="auto"><span class="org">Cisco Systems</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:sajassi@cisco.com">sajassi@cisco.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Samer Salam</span></div>
<div class="left" dir="auto"><span class="org">Cisco Systems</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:ssalam@cisco.com">ssalam@cisco.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Samir Thoria</span></div>
<div class="left" dir="auto"><span class="org">Cisco Systems</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:sthoria@cisco.com">sthoria@cisco.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">John E Drake</span></div>
<div class="left" dir="auto"><span class="org">Juniper</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:jdrake@juniper.net">jdrake@juniper.net</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Jorge Rabadan</span></div>
<div class="left" dir="auto"><span class="org">Nokia</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:jorge.rabadan@nokia.com">jorge.rabadan@nokia.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>