<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 9303: Locator/ID Separation Protocol Security (LISP-SEC)</title>
<meta content="Fabio Maino" name="author"/>
<meta content="Vina Ermagan" name="author"/>
<meta content="Albert Cabellos" name="author"/>
<meta content="Damien Saucez" name="author"/>
<meta content="
       This memo specifies Locator/ID Separation Protocol Security (LISP-SEC), a set of security mechanisms
      that provides origin authentication, integrity, and anti-replay protection to the 
      LISP's Endpoint-ID-to-Routing-Locator (EID-to-RLOC) mapping data conveyed via the mapping lookup process.
      LISP-SEC also enables verification of authorization on EID-Prefix claims
      in Map-Reply messages. 
    " name="description"/>
<meta content="xml2rfc 3.15.1" name="generator"/>
<meta content="LISP" name="keyword"/>
<meta content="deployment" name="keyword"/>
<meta content="9303" name="rfc.number"/>
<!-- Generator version information:
  xml2rfc 3.15.1
    Python 3.9.13
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.1
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 3.1.2
    kitchen 1.2.6
    lxml 4.9.0
    MarkupSafe 2.1.1
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.28.0
    setuptools 44.1.1
    six 1.16.0
    weasyprint 56.1
-->
<link href="rfc9303.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  pre.breakable {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://dx.doi.org/10.17487/rfc9303" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <link href="https://datatracker.ietf.org/doc/draft-ietf-lisp-sec-29" rel="prev"/>
  </head>
<body class="xml2rfc">
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9303</td>
<td class="center">LISP-SEC</td>
<td class="right">October 2022</td>
</tr></thead>
<tfoot><tr>
<td class="left">Maino, et al.</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc9303">9303</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2022-10">October 2022</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">F. Maino</div>
<div class="org">Cisco Systems</div>
</div>
<div class="author">
      <div class="author-name">V. Ermagan</div>
<div class="org">Google, Inc.</div>
</div>
<div class="author">
      <div class="author-name">A. Cabellos</div>
<div class="org">Universitat Politecnica de Catalunya</div>
</div>
<div class="author">
      <div class="author-name">D. Saucez</div>
<div class="org">Inria</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9303</h1>
<h1 id="title">Locator/ID Separation Protocol Security (LISP-SEC)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">This memo specifies Locator/ID Separation Protocol Security (LISP-SEC), a set of security mechanisms
      that provides origin authentication, integrity, and anti-replay protection to the 
      LISP's Endpoint-ID-to-Routing-Locator (EID-to-RLOC) mapping data conveyed via the mapping lookup process.
      LISP-SEC also enables verification of authorization on EID-Prefix claims
      in Map-Reply messages.<a class="pilcrow" href="#section-abstract-1">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a class="pilcrow" href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9303">https://www.rfc-editor.org/info/rfc9303</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">▲</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p class="keepWithNext" id="section-toc.1-1.1.1"><a class="auto internal xref" href="#section-1">1</a>.  <a class="internal xref" href="#name-introduction">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p class="keepWithNext" id="section-toc.1-1.2.1"><a class="auto internal xref" href="#section-2">2</a>.  <a class="internal xref" href="#name-requirements-notation">Requirements Notation</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p class="keepWithNext" id="section-toc.1-1.3.1"><a class="auto internal xref" href="#section-3">3</a>.  <a class="internal xref" href="#name-definitions-of-terms">Definitions of Terms</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="auto internal xref" href="#section-4">4</a>.  <a class="internal xref" href="#name-lisp-sec-threat-model">LISP-SEC Threat Model</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="auto internal xref" href="#section-5">5</a>.  <a class="internal xref" href="#name-protocol-operations">Protocol Operations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="auto internal xref" href="#section-6">6</a>.  <a class="internal xref" href="#name-lisp-sec-control-messages-d">LISP-SEC Control Messages Details</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a class="auto internal xref" href="#section-6.1">6.1</a>.  <a class="internal xref" href="#name-encapsulated-control-messag">Encapsulated Control Message LISP-SEC Extensions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a class="auto internal xref" href="#section-6.2">6.2</a>.  <a class="internal xref" href="#name-map-reply-lisp-sec-extensio">Map-Reply LISP-SEC Extensions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a class="auto internal xref" href="#section-6.3">6.3</a>.  <a class="internal xref" href="#name-map-register-lisp-sec-exten">Map-Register LISP-SEC Extensions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a class="auto internal xref" href="#section-6.4">6.4</a>.  <a class="internal xref" href="#name-itr-processing-generating-a">ITR Processing: Generating a Map-Request</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5">
                <p id="section-toc.1-1.6.2.5.1"><a class="auto internal xref" href="#section-6.5">6.5</a>.  <a class="internal xref" href="#name-encrypting-and-decrypting-a">Encrypting and Decrypting an OTK</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5.2.1">
                    <p id="section-toc.1-1.6.2.5.2.1.1"><a class="auto internal xref" href="#section-6.5.1">6.5.1</a>.  <a class="internal xref" href="#name-unencrypted-otk">Unencrypted OTK</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.6">
                <p id="section-toc.1-1.6.2.6.1"><a class="auto internal xref" href="#section-6.6">6.6</a>.  <a class="internal xref" href="#name-map-resolver-processing">Map-Resolver Processing</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.7">
                <p id="section-toc.1-1.6.2.7.1"><a class="auto internal xref" href="#section-6.7">6.7</a>.  <a class="internal xref" href="#name-map-server-processing">Map-Server Processing</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.7.2.1">
                    <p id="section-toc.1-1.6.2.7.2.1.1"><a class="auto internal xref" href="#section-6.7.1">6.7.1</a>.  <a class="internal xref" href="#name-generating-a-lisp-sec-prote">Generating a LISP-SEC-Protected Encapsulated Map-Request</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.7.2.2">
                    <p id="section-toc.1-1.6.2.7.2.2.1"><a class="auto internal xref" href="#section-6.7.2">6.7.2</a>.  <a class="internal xref" href="#name-generating-a-proxy-map-repl">Generating a Proxy Map-Reply</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.8">
                <p id="section-toc.1-1.6.2.8.1"><a class="auto internal xref" href="#section-6.8">6.8</a>.  <a class="internal xref" href="#name-etr-processing">ETR Processing</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.9">
                <p id="section-toc.1-1.6.2.9.1"><a class="auto internal xref" href="#section-6.9">6.9</a>.  <a class="internal xref" href="#name-itr-processing-receiving-a-">ITR Processing: Receiving a Map-Reply</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.9.2.1">
                    <p id="section-toc.1-1.6.2.9.2.1.1"><a class="auto internal xref" href="#section-6.9.1">6.9.1</a>.  <a class="internal xref" href="#name-map-reply-record-validation">Map-Reply Record Validation</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="auto internal xref" href="#section-7">7</a>.  <a class="internal xref" href="#name-security-considerations">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a class="auto internal xref" href="#section-7.1">7.1</a>.  <a class="internal xref" href="#name-mapping-system-security">Mapping System Security</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a class="auto internal xref" href="#section-7.2">7.2</a>.  <a class="internal xref" href="#name-random-number-generation">Random Number Generation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a class="auto internal xref" href="#section-7.3">7.3</a>.  <a class="internal xref" href="#name-map-server-and-etr-colocati">Map-Server and ETR Colocation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a class="auto internal xref" href="#section-7.4">7.4</a>.  <a class="internal xref" href="#name-deploying-lisp-sec">Deploying LISP-SEC</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5">
                <p id="section-toc.1-1.7.2.5.1"><a class="auto internal xref" href="#section-7.5">7.5</a>.  <a class="internal xref" href="#name-shared-keys-provisioning">Shared Keys Provisioning</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.6">
                <p id="section-toc.1-1.7.2.6.1"><a class="auto internal xref" href="#section-7.6">7.6</a>.  <a class="internal xref" href="#name-replay-attacks">Replay Attacks</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.7">
                <p id="section-toc.1-1.7.2.7.1"><a class="auto internal xref" href="#section-7.7">7.7</a>.  <a class="internal xref" href="#name-message-privacy">Message Privacy</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.8">
                <p id="section-toc.1-1.7.2.8.1"><a class="auto internal xref" href="#section-7.8">7.8</a>.  <a class="internal xref" href="#name-denial-of-service-and-distr">Denial-of-Service and Distributed Denial-of-Service Attacks</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="auto internal xref" href="#section-8">8</a>.  <a class="internal xref" href="#name-iana-considerations">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a class="auto internal xref" href="#section-8.1">8.1</a>.  <a class="internal xref" href="#name-ecm-ad-type-registry">ECM AD Type Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a class="auto internal xref" href="#section-8.2">8.2</a>.  <a class="internal xref" href="#name-map-reply-ad-types-registry">Map-Reply AD Types Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a class="auto internal xref" href="#section-8.3">8.3</a>.  <a class="internal xref" href="#name-hmac-functions">HMAC Functions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4">
                <p id="section-toc.1-1.8.2.4.1"><a class="auto internal xref" href="#section-8.4">8.4</a>.  <a class="internal xref" href="#name-key-wrap-functions">Key Wrap Functions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.5">
                <p id="section-toc.1-1.8.2.5.1"><a class="auto internal xref" href="#section-8.5">8.5</a>.  <a class="internal xref" href="#name-key-derivation-functions">Key Derivation Functions</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="auto internal xref" href="#section-9">9</a>.  <a class="internal xref" href="#name-references">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a class="auto internal xref" href="#section-9.1">9.1</a>.  <a class="internal xref" href="#name-normative-references">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a class="auto internal xref" href="#section-9.2">9.2</a>.  <a class="internal xref" href="#name-informative-references">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a class="auto internal xref" href="#appendix-A"></a><a class="internal xref" href="#name-acknowledgments">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a class="auto internal xref" href="#appendix-B"></a><a class="internal xref" href="#name-authors-addresses">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="intro">
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">The Locator/ID Separation Protocol (LISP) <span>[<a class="cite xref" href="#RFC9300">RFC9300</a>]</span> <span>[<a class="cite xref" href="#RFC9301">RFC9301</a>]</span> is a network-layer-based protocol
      that enables separation of IP addresses into two new numbering spaces:
      Endpoint Identifiers (EIDs) and Routing Locators (RLOCs). EID-to-RLOC
      mappings are stored in a database and the LISP Mapping System, and they are made
      available via the Map-Request/Map-Reply lookup process. If these
      EID-to-RLOC mappings, carried through Map-Reply messages, are
      transmitted without integrity protection, an adversary can manipulate
      them and hijack the communication, impersonate the requested EID, or
      mount Denial-of-Service (DoS) or Distributed Denial-of-Service (DDoS) attacks. Also,
      if the Map-Reply message is transported unauthenticated, an adversarial
      LISP entity can overclaim an EID-Prefix and maliciously redirect traffic. The LISP-SEC threat model,
      described in <a class="auto internal xref" href="#threat-model">Section 4</a>, is built on top of the LISP
      threat model defined in <span>[<a class="cite xref" href="#RFC7835">RFC7835</a>]</span>, which includes a
      detailed description of an "overclaiming" attack.<a class="pilcrow" href="#section-1-1">¶</a></p>
<p id="section-1-2">This memo specifies LISP-SEC, a set of security mechanisms that
      provides origin authentication, integrity, and anti-replay protection to
      LISP's EID-to-RLOC mapping data conveyed via the mapping lookup process.
      LISP-SEC also enables verification of authorization on EID-Prefix claims
      in Map-Reply messages, ensuring that the sender of a Map-Reply that
      provides the location for a given EID-Prefix is entitled to do so
      according to the EID-Prefix registered in the associated Map-Server.
      Map-Register/Map-Notify security, including the right for a LISP entity
      to register an EID-Prefix or to claim presence at an RLOC, is out of the
      scope of LISP-SEC, as those protocols are protected by the security
      mechanisms specified in <span>[<a class="cite xref" href="#RFC9301">RFC9301</a>]</span>.
      However, LISP-SEC extends the Map-Register message to allow an Ingress Tunnel
      Router (ITR) to
      downgrade to non-LISP-SEC Map-Requests. Additional security
      considerations are described in <a class="auto internal xref" href="#security">Section 7</a>.<a class="pilcrow" href="#section-1-2">¶</a></p>
</section>
</div>
<section id="section-2">
      <h2 id="name-requirements-notation">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-requirements-notation">Requirements Notation</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>",
    "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>", "<span class="bcp14">MAY</span>", and
    "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as described in  BCP 14
    <span>[<a class="cite xref" href="#RFC2119">RFC2119</a>]</span> <span>[<a class="cite xref" href="#RFC8174">RFC8174</a>]</span> when, and only when, they
    appear in all capitals, as shown here.<a class="pilcrow" href="#section-2-1">¶</a></p>
</section>
<div id="terms">
<section id="section-3">
      <h2 id="name-definitions-of-terms">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-definitions-of-terms">Definitions of Terms</a>
      </h2>
<span class="break"></span><dl class="dlParallel" id="section-3-1">
        <dt id="section-3-1.1">One-Time Key (OTK):</dt>
        <dd id="section-3-1.2" style="margin-left: 1.5em">An ephemeral randomly generated key that must
          be used for a single Map-Request/Map-Reply exchange.<a class="pilcrow" href="#section-3-1.2">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-1.3">ITR One-Time Key (ITR-OTK):</dt>
        <dd id="section-3-1.4" style="margin-left: 1.5em">The One-Time Key generated at the
          Ingress Tunnel Router (ITR).<a class="pilcrow" href="#section-3-1.4">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-1.5">MS One-Time Key (MS-OTK):</dt>
        <dd id="section-3-1.6" style="margin-left: 1.5em">The One-Time Key generated at the
          Map-Server.<a class="pilcrow" href="#section-3-1.6">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-1.7">Authentication Data (AD):</dt>
        <dd id="section-3-1.8" style="margin-left: 1.5em">Metadata that is included either in a
          LISP Encapsulated Control Message (ECM) header as defined in <span>[<a class="cite xref" href="#RFC9301">RFC9301</a>]</span>, or in a Map-Reply message to
          support confidentiality, integrity protection, and verification of
          EID-Prefix authorization.<a class="pilcrow" href="#section-3-1.8">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-1.9">OTK Authentication Data (OTK-AD):</dt>
        <dd id="section-3-1.10" style="margin-left: 1.5em">The portion of ECM
          Authentication Data that contains a One-Time Key.<a class="pilcrow" href="#section-3-1.10">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-1.11">EID Authentication Data (EID-AD):</dt>
        <dd id="section-3-1.12" style="margin-left: 1.5em">The portion of ECM and
          Map-Reply Authentication Data used for verification of EID-Prefix
          authorization.<a class="pilcrow" href="#section-3-1.12">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-1.13">Packet Authentication Data (PKT-AD):</dt>
        <dd id="section-3-1.14" style="margin-left: 1.5em">The portion of Map-Reply
          Authentication Data used to protect the integrity of the Map-Reply
          message.<a class="pilcrow" href="#section-3-1.14">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-3-2">For definitions of other terms, notably Map-Request, Map-Reply,
      Ingress Tunnel Router (ITR), Egress Tunnel Router (ETR), Map-Server
      (MS), and Map-Resolver (MR), please consult the LISP specification <span>[<a class="cite xref" href="#RFC9301">RFC9301</a>]</span>.<a class="pilcrow" href="#section-3-2">¶</a></p>
</section>
</div>
<div id="threat-model">
<section id="section-4">
      <h2 id="name-lisp-sec-threat-model">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-lisp-sec-threat-model">LISP-SEC Threat Model</a>
      </h2>
<p id="section-4-1">LISP-SEC addresses the control plane threats, described in Sections
      <a class="relref" href="https://www.rfc-editor.org/rfc/rfc7835#section-3.7">3.7</a> and 
      <a class="relref" href="https://www.rfc-editor.org/rfc/rfc7835#section-3.8">3.8</a> of <span>[<a class="cite xref" href="#RFC7835">RFC7835</a>]</span>, that target EID-to-RLOC
      mappings, including manipulations of Map-Request and Map-Reply messages
      and malicious ETR EID-Prefix overclaiming. LISP-SEC makes two main
      assumptions: (1) the LISP Mapping System is expected to deliver a
      Map-Request message to their intended destination ETR as identified by
      the EID, and (2) no on-path attack can be mounted
      within the LISP Mapping System. How the Mapping System is protected from
      on-path attacks depends on the particular Mapping System used and is
      out of the scope of this memo. Furthermore, while LISP-SEC enables
      detection of EID-Prefix overclaiming attacks, it assumes that
      Map-Servers can verify the EID-Prefix authorization at registration time.<a class="pilcrow" href="#section-4-1">¶</a></p>
<p id="section-4-2">According to the threat model described in <span>[<a class="cite xref" href="#RFC7835">RFC7835</a>]</span>,
      LISP-SEC assumes that any kind of attack, including on-path attacks, can be
      mounted outside of the boundaries of the LISP Mapping System. An on-path
      attacker outside of the LISP Mapping System can, for example, hijack
      Map-Request and Map-Reply messages, spoofing the identity of a LISP
      node. Another example of an on-path attack, called an overclaiming attack, can
      be mounted by a malicious ETR by overclaiming
      the EID-Prefixes for which it is authoritative. In this way, the ETR can
      maliciously redirect traffic.<a class="pilcrow" href="#section-4-2">¶</a></p>
</section>
</div>
<div id="operations">
<section id="section-5">
      <h2 id="name-protocol-operations">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-protocol-operations">Protocol Operations</a>
      </h2>
<p id="section-5-1">The goal of the security mechanisms defined in <span>[<a class="cite xref" href="#RFC9301">RFC9301</a>]</span> is to prevent unauthorized insertion
      of mapping data by providing origin authentication and integrity
      protection for the Map-Register and by using the nonce to detect an
      unsolicited Map-Reply sent by off-path attackers.<a class="pilcrow" href="#section-5-1">¶</a></p>
<p id="section-5-2">LISP-SEC builds on top of the security mechanisms defined in <span>[<a class="cite xref" href="#RFC9301">RFC9301</a>]</span> to address the threats described in
      <a class="auto internal xref" href="#threat-model">Section 4</a> by leveraging the trust relationships
      existing among the LISP entities <span>[<a class="cite xref" href="#RFC9301">RFC9301</a>]</span> participating in the exchange of the Map-Request/Map-Reply messages.
      Those trust relationships (see also <a class="auto internal xref" href="#security">Section 7</a> and <span>[<a class="cite xref" href="#RFC9301">RFC9301</a>]</span>) are used to securely distribute, as described in <a class="auto internal xref" href="#wrap">Section 8.4</a>, a per-message One-Time Key (OTK) that provides origin authentication, integrity, and anti-replay protection to mapping data conveyed via the
      mapping lookup process and that effectively prevents overclaiming
      attacks. The processing of security parameters during the
      Map-Request/Map-Reply exchange is as follows:<a class="pilcrow" href="#section-5-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-3.1">Per each Map-Request message, a new ITR-OTK is generated and
          stored at the ITR and is securely transported to the Map-Server.<a class="pilcrow" href="#section-5-3.1">¶</a>
</li>
        <li class="normal" id="section-5-3.2">The Map-Server uses the ITR-OTK to compute a Hashed Message Authentication Code (HMAC) <span>[<a class="cite xref" href="#RFC2104">RFC2104</a>]</span> that protects
          the integrity of the mapping data known to the Map-Server to prevent
          overclaiming attacks. The Map-Server also derives a new OTK, the
          MS-OTK, that is passed to the ETR by applying a Key Derivation
          Function (KDF) (e.g., <span>[<a class="cite xref" href="#RFC5869">RFC5869</a>]</span>) to the ITR-OTK.<a class="pilcrow" href="#section-5-3.2">¶</a>
</li>
        <li class="normal" id="section-5-3.3">The ETR uses the MS-OTK to compute an HMAC that protects the
          integrity of the Map-Reply sent to the ITR.<a class="pilcrow" href="#section-5-3.3">¶</a>
</li>
        <li class="normal" id="section-5-3.4">Finally, the ITR uses the stored ITR-OTK to verify the integrity
          of the mapping data provided by both the Map-Server and the ETR, and
          to verify that no overclaiming attacks were mounted along the path
          between the Map-Server and the ITR.<a class="pilcrow" href="#section-5-3.4">¶</a>
</li>
      </ul>
<p id="section-5-4"><a class="auto internal xref" href="#encap">Section 6</a> provides the detailed description of the
      LISP-SEC control messages and their processing, while the rest of this
      section describes the flow of LISP protocol operations at each entity
      involved in the Map-Request/Map-Reply exchange:<a class="pilcrow" href="#section-5-4">¶</a></p>
<ol class="normal type-1" id="section-5-5" start="1" type="1">
 <li id="section-5-5.1">The ITR, upon needing to transmit a Map-Request message,
        generates and stores an OTK (ITR-OTK). This ITR-OTK is encrypted and
 included into the Encapsulated Control Message (ECM) that contains the
 Map-Request sent to the Map-Resolver.<a class="pilcrow" href="#section-5-5.1">¶</a>
</li>
        <li id="section-5-5.2">The Map-Resolver decapsulates the ECM, decrypts the
          ITR-OTK (if needed), and forwards through the Mapping System the
          received Map-Request and the ITR-OTK, as part of a new ECM.
          The LISP Mapping System delivers the ECM to the appropriate
          Map-Server, as identified by the EID destination address of the
          Map-Request.<a class="pilcrow" href="#section-5-5.2">¶</a>
</li>
        <li id="section-5-5.3">The Map-Server is configured with the location mappings and
          policy information for the ETR responsible for the EID destination
          address. Using this preconfigured information, the Map-Server, after
          the decapsulation of the ECM, finds the longest-match
          EID-Prefix that covers the requested EID in the received
          Map-Request. The Map-Server adds this EID-Prefix, together with an
          HMAC computed using the ITR-OTK, to a new ECM
          that contains the received Map-Request.<a class="pilcrow" href="#section-5-5.3">¶</a>
</li>
        <li id="section-5-5.4">The Map-Server derives a new OTK, the MS-OTK, by applying a KDF to the ITR-OTK. This MS-OTK is included in
          the ECM that the Map-Server uses to forward
          the Map-Request to the ETR.<a class="pilcrow" href="#section-5-5.4">¶</a>
</li>
        <li id="section-5-5.5">If the Map-Server is acting in proxy mode, as specified in <span>[<a class="cite xref" href="#RFC9301">RFC9301</a>]</span>, the ETR is not involved in the
          generation of the Map-Reply and steps 6 and 7 are skipped. In this
          case, the Map-Server generates the Map-Reply on behalf of the ETR, as
          described in <a class="auto internal xref" href="#proxy">Section 6.7.2</a>.<a class="pilcrow" href="#section-5-5.5">¶</a>
</li>
        <li id="section-5-5.6">The ETR, upon receiving the ECM-Encapsulated Map-Request from the
          Map-Server, decrypts the MS-OTK (if needed), and originates a
          Map-Reply that contains the EID-to-RLOC mapping information as
          specified in <span>[<a class="cite xref" href="#RFC9301">RFC9301</a>]</span>.<a class="pilcrow" href="#section-5-5.6">¶</a>
</li>
        <li id="section-5-5.7">The ETR computes an HMAC over the Map-Reply, keyed with MS-OTK to
          protect the integrity of the whole Map-Reply. The ETR also copies
          the EID-Prefix authorization data that the Map-Server included in
          the ECM-Encapsulated Map-Request into the Map-Reply message. The ETR
          then sends the complete Map-Reply message to the requesting ITR.<a class="pilcrow" href="#section-5-5.7">¶</a>
</li>
        <li id="section-5-5.8">The ITR, upon receiving the Map-Reply, uses the locally stored
          ITR-OTK to verify the integrity of the EID-Prefix authorization data
          included in the Map-Reply by the Map-Server. The ITR computes the
          MS-OTK by applying the same KDF (as specified in the ECM-Encapsulated
   Map-Reply) used by the Map-Server and verifies the
          integrity of the Map-Reply.<a class="pilcrow" href="#section-5-5.8">¶</a>
</li>
      </ol>
</section>
</div>
<div id="encap">
<section id="section-6">
      <h2 id="name-lisp-sec-control-messages-d">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-lisp-sec-control-messages-d">LISP-SEC Control Messages Details</a>
      </h2>
<p id="section-6-1">LISP-SEC metadata associated with a Map-Request is transported within
      the Encapsulated Control Message that contains the Map-Request.<a class="pilcrow" href="#section-6-1">¶</a></p>
<p id="section-6-2">LISP-SEC metadata associated with the Map-Reply is transported within
      the Map-Reply itself.<a class="pilcrow" href="#section-6-2">¶</a></p>
<p id="section-6-3">These specifications use an HMAC in various places (as described in the following). The HMAC function AUTH-HMAC-SHA-256-128 <span>[<a class="cite xref" href="#RFC6234">RFC6234</a>]</span> <span class="bcp14">MUST</span> be supported in LISP-SEC implementations. LISP-SEC deployments <span class="bcp14">SHOULD</span> use the AUTH-HMAC-SHA-256-128 HMAC function, except when communicating with older implementations that only support AUTH-HMAC-SHA-1-96 <span>[<a class="cite xref" href="#RFC2104">RFC2104</a>]</span>.<a class="pilcrow" href="#section-6-3">¶</a></p>
<div id="ECM_extensions">
<section id="section-6.1">
        <h3 id="name-encapsulated-control-messag">
<a class="section-number selfRef" href="#section-6.1">6.1. </a><a class="section-name selfRef" href="#name-encapsulated-control-messag">Encapsulated Control Message LISP-SEC Extensions</a>
        </h3>
<p id="section-6.1-1">LISP-SEC uses the ECM defined in <span>[<a class="cite xref" href="#RFC9301">RFC9301</a>]</span> with the S-bit set to 1 to indicate
        that the LISP header includes Authentication Data (AD). The format of
        the LISP-SEC ECM AD is defined in <a class="auto internal xref" href="#fig-AD">Figure 1</a>. OTK-AD stands for One-Time Key Authentication Data
        and EID-AD stands for EID Authentication Data.<a class="pilcrow" href="#section-6.1-1">¶</a></p>
<span id="name-lisp-sec-ecm-authentication"></span><div id="fig-AD">
<figure id="figure-1">
          <div class="alignCenter art-text artwork" id="section-6.1-2.1">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  ECM AD Type  |   Unassigned  |        Requested HMAC ID      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\
|              OTK Length       |     Key ID    | OTK Wrap. ID  | |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ |
|                       One-Time-Key Preamble ...               | |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+OTK-AD
|                   ... One-Time-Key Preamble                   | |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ |
~                      One-Time Key (128 bits)                  ~/
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ &lt;---+
|           EID-AD Length       |           KDF ID              |     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+     |
| Record Count  |E| Unassigned  |         EID HMAC ID           |EID-AD
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\    |
|  Unassigned   | EID mask-len  |           EID-AFI             | |   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ Rec |
~                          EID-Prefix ...                       ~ |   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+/    |
~                            EID HMAC                           ~     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ &lt;---+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-1">Figure 1</a>:
<a class="selfRef" href="#name-lisp-sec-ecm-authentication">LISP-SEC ECM Authentication Data</a>
          </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-6.1-3">
          <dt id="section-6.1-3.1">ECM AD Type:</dt>
          <dd id="section-6.1-3.2" style="margin-left: 1.5em">1 (LISP-SEC Authentication Data). See <a class="auto internal xref" href="#IANA">Section 8</a>.<a class="pilcrow" href="#section-6.1-3.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-3.3">Unassigned:</dt>
          <dd id="section-6.1-3.4" style="margin-left: 1.5em">Set to 0 on transmission and ignored on
          receipt.<a class="pilcrow" href="#section-6.1-3.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-3.5">Requested HMAC ID:</dt>
          <dd id="section-6.1-3.6" style="margin-left: 1.5em">The HMAC algorithm, which will be used to
          protect the mappings, requested by the ITR. Permitted values are
   registered in the LISP-SEC Authentication Data HMAC ID (see <a class="auto internal xref" href="#HMAC">Section 8.3</a>). Refer to <a class="auto internal xref" href="#itr">Section 6.4</a> for more details.<a class="pilcrow" href="#section-6.1-3.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-3.7">OTK Length:</dt>
          <dd id="section-6.1-3.8" style="margin-left: 1.5em">The length (in bytes) of the OTK Authentication
          Data (OTK-AD), which contains the OTK Preamble and the OTK.<a class="pilcrow" href="#section-6.1-3.8">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-3.9">Key ID:</dt>
          <dd id="section-6.1-3.10" style="margin-left: 1.5em">The identifier of the pre-shared secret shared by an
          ITR and the Map-Resolver, and by the Map-Server and an ETR.
          Per-message keys are derived from the pre-shared secret to
          encrypt, authenticate the origin, and protect the integrity of the
          OTK. The Key ID allows to rotate between multiple pre-shared
          secrets in a nondisruptive way.<a class="pilcrow" href="#section-6.1-3.10">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-3.11">OTK Wrapping ID (OTK Wrap. ID):</dt>
          <dd id="section-6.1-3.12" style="margin-left: 1.5em">The identifier of the Key Derivation Function
          and of the key wrapping algorithm used to encrypt the
          One-Time-Key. Permitted values are registered in the LISP-SEC
   Authentication Data Key Wrap ID (see <a class="auto internal xref" href="#wrap">Section 8.4</a>). Refer to <a class="auto internal xref" href="#encryption">Section 6.5</a> for more details.<a class="pilcrow" href="#section-6.1-3.12">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-3.13">One-Time-Key Preamble:</dt>
          <dd id="section-6.1-3.14" style="margin-left: 1.5em">Set to 0 if the OTK is not encrypted.
          When the OTK is encrypted, this field <span class="bcp14">MAY</span> carry additional
          metadata resulting from the key wrapping operation. When a 128-bit
          OTK is sent unencrypted by a Map-Resolver, the OTK Preamble is set
          to 0x0000000000000000 (64 bits). See <a class="auto internal xref" href="#null">Section 6.5.1</a> for details.<a class="pilcrow" href="#section-6.1-3.14">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-3.15">One-Time-Key:</dt>
          <dd id="section-6.1-3.16" style="margin-left: 1.5em">The OTK wrapped as specified by OTK Wrapping ID.
          See <a class="auto internal xref" href="#encryption">Section 6.5</a> for details.<a class="pilcrow" href="#section-6.1-3.16">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-3.17">EID-AD Length:</dt>
          <dd id="section-6.1-3.18" style="margin-left: 1.5em">Length (in bytes) of the EID Authentication Data
          (EID-AD). The ITR <span class="bcp14">MUST</span> set the EID-AD Length to 4 bytes,
   as it only
          fills the 'KDF ID' field, and all the remaining fields part of the
          EID-AD are not present. An EID-AD <span class="bcp14">MAY</span> contain multiple
          EID-Records. Each EID-Record is 4 bytes long, plus the length of the
          AFI-encoded EID-Prefix.<a class="pilcrow" href="#section-6.1-3.18">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-3.19">KDF ID:</dt>
          <dd id="section-6.1-3.20" style="margin-left: 1.5em">Identifier of the Key Derivation Function used to
          derive the MS-OTK. Permitted values are registered in the LISP-SEC
   Authentication Data Key Derivation Function ID (see <a class="auto internal xref" href="#kdf">Section 8.5</a>). Refer to <a class="auto internal xref" href="#map-server">Section 6.7</a> for more details.<a class="pilcrow" href="#section-6.1-3.20">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-3.21">Record Count:</dt>
          <dd id="section-6.1-3.22" style="margin-left: 1.5em">As defined in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9301#section-5.2">Section 5.2</a> of [<a class="cite xref" href="#RFC9301">RFC9301</a>]</span>.<a class="pilcrow" href="#section-6.1-3.22">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-3.23">E:</dt>
          <dd id="section-6.1-3.24" style="margin-left: 1.5em">ETR-Cant-Sign bit. If this bit is set to 1, it signals to the ITR
          that at least one of the ETRs that is authoritative for the EID-Prefixes
          of this Map-Reply has not enabled LISP-SEC. Only a Map-Server can set
   this bit. See <a class="auto internal xref" href="#map-server">Section 6.7</a> for more
   details.<a class="pilcrow" href="#section-6.1-3.24">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-3.25">Unassigned:</dt>
          <dd id="section-6.1-3.26" style="margin-left: 1.5em">Set to 0 on transmission and ignored on
          receipt.<a class="pilcrow" href="#section-6.1-3.26">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-3.27">EID HMAC ID:</dt>
          <dd id="section-6.1-3.28" style="margin-left: 1.5em">Identifier of the HMAC algorithm used to protect
          the integrity of the EID-AD. This field is filled by the Map-Server
          that computed the EID-Prefix HMAC. See <a class="auto internal xref" href="#EID-AD">Section 6.7.1</a> for more details.<a class="pilcrow" href="#section-6.1-3.28">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-3.29">EID mask-len:</dt>
          <dd id="section-6.1-3.30" style="margin-left: 1.5em">As defined in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9301#section-5.2">Section 5.2</a> of [<a class="cite xref" href="#RFC9301">RFC9301</a>]</span>.<a class="pilcrow" href="#section-6.1-3.30">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-3.31">EID-AFI:</dt>
          <dd id="section-6.1-3.32" style="margin-left: 1.5em">As defined in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9301#section-5.2">Section 5.2</a> of [<a class="cite xref" href="#RFC9301">RFC9301</a>]</span>.<a class="pilcrow" href="#section-6.1-3.32">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-3.33">EID-Prefix:</dt>
          <dd id="section-6.1-3.34" style="margin-left: 1.5em">As defined in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9301#section-5.2">Section 5.2</a> of [<a class="cite xref" href="#RFC9301">RFC9301</a>]</span>.<a class="pilcrow" href="#section-6.1-3.34">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-3.35">EID HMAC:</dt>
          <dd id="section-6.1-3.36" style="margin-left: 1.5em">HMAC of the EID-AD computed and inserted by a
          Map-Server. See <a class="auto internal xref" href="#EID-AD">Section 6.7.1</a> for more details.<a class="pilcrow" href="#section-6.1-3.36">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="MR_extensions">
<section id="section-6.2">
        <h3 id="name-map-reply-lisp-sec-extensio">
<a class="section-number selfRef" href="#section-6.2">6.2. </a><a class="section-name selfRef" href="#name-map-reply-lisp-sec-extensio">Map-Reply LISP-SEC Extensions</a>
        </h3>
<p id="section-6.2-1">LISP-SEC uses the Map-Reply defined in <span>[<a class="cite xref" href="#RFC9301">RFC9301</a>]</span>, with Type set to 2 and S-bit set
        to 1 to indicate that the Map-Reply message includes Authentication
        Data (AD). The format of the LISP-SEC Map-Reply Authentication Data is
        defined in <a class="auto internal xref" href="#map-reply-AD">Figure 2</a>. PKT-AD is the Packet
        Authentication Data that covers the Map-Reply payload.<a class="pilcrow" href="#section-6.2-1">¶</a></p>
<span id="name-lisp-sec-map-reply-authenti"></span><div id="map-reply-AD">
<figure id="figure-2">
          <div class="alignCenter art-text artwork" id="section-6.2-2.1">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  MR AD Type   |                Unassigned                     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ &lt;---+
|           EID-AD Length       |           KDF ID              |     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+     |
| Record Count  |   Unassigned  |         EID HMAC ID           |EID-AD
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\    |
|  Unassigned   | EID mask-len  |           EID-AFI             | |   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ Rec |
~                          EID-Prefix ...                       ~ |   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+/    |
~                            EID HMAC                           ~     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ &lt;---+
|         PKT-AD Length         |         PKT HMAC ID           |\
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ |
~                            PKT HMAC                           ~PKT-AD
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+/
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-2">Figure 2</a>:
<a class="selfRef" href="#name-lisp-sec-map-reply-authenti">LISP-SEC Map-Reply Authentication Data</a>
          </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-6.2-3">
          <dt id="section-6.2-3.1">MR AD Type:</dt>
          <dd id="section-6.2-3.2" style="margin-left: 1.5em">1 (LISP-SEC Authentication Data). See <a class="auto internal xref" href="#IANA">Section 8</a>.<a class="pilcrow" href="#section-6.2-3.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-3.3">EID-AD Length:</dt>
          <dd id="section-6.2-3.4" style="margin-left: 1.5em">Length (in bytes) of the EID-AD (see <a class="auto internal xref" href="#ECM_extensions">Section 6.1</a>).<a class="pilcrow" href="#section-6.2-3.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-3.5">KDF ID:</dt>
          <dd id="section-6.2-3.6" style="margin-left: 1.5em">Identifier of the Key Derivation Function used to
          derive MS-OTK (see <a class="auto internal xref" href="#ECM_extensions">Section 6.1</a>).<a class="pilcrow" href="#section-6.2-3.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-3.7">Record Count:</dt>
          <dd id="section-6.2-3.8" style="margin-left: 1.5em">The number of records in this Map-Reply message (see <a class="auto internal xref" href="#ECM_extensions">Section 6.1</a>).<a class="pilcrow" href="#section-6.2-3.8">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-3.9">Unassigned:</dt>
          <dd id="section-6.2-3.10" style="margin-left: 1.5em">Set to 0 on transmission and ignored on receipt.<a class="pilcrow" href="#section-6.2-3.10">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-3.11">EID HMAC ID:</dt>
          <dd id="section-6.2-3.12" style="margin-left: 1.5em">Identifier of the HMAC algorithm used to protect
          the integrity of the EID-AD (see <a class="auto internal xref" href="#ECM_extensions">Section 6.1</a>).<a class="pilcrow" href="#section-6.2-3.12">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-3.13">EID mask-len:</dt>
          <dd id="section-6.2-3.14" style="margin-left: 1.5em">Mask length for EID-Prefix (see <a class="auto internal xref" href="#ECM_extensions">Section 6.1</a>).<a class="pilcrow" href="#section-6.2-3.14">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-3.15">EID-AFI:</dt>
          <dd id="section-6.2-3.16" style="margin-left: 1.5em">See <a class="auto internal xref" href="#ECM_extensions">Section 6.1</a>.<a class="pilcrow" href="#section-6.2-3.16">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-3.17">EID-Prefix:</dt>
          <dd id="section-6.2-3.18" style="margin-left: 1.5em">See <a class="auto internal xref" href="#ECM_extensions">Section 6.1</a>.<a class="pilcrow" href="#section-6.2-3.18">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-3.19">EID HMAC:</dt>
          <dd id="section-6.2-3.20" style="margin-left: 1.5em">See <a class="auto internal xref" href="#ECM_extensions">Section 6.1</a>.<a class="pilcrow" href="#section-6.2-3.20">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-3.21">PKT-AD Length:</dt>
          <dd id="section-6.2-3.22" style="margin-left: 1.5em">Length (in bytes) of the Packet Authentication
          Data (PKT-AD).<a class="pilcrow" href="#section-6.2-3.22">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-3.23">PKT HMAC ID:</dt>
          <dd id="section-6.2-3.24" style="margin-left: 1.5em">Identifier of the HMAC algorithm used to protect
          the integrity of the Map-Reply (see <a class="auto internal xref" href="#encryption">Section 6.5</a>).<a class="pilcrow" href="#section-6.2-3.24">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-3.25">PKT HMAC:</dt>
          <dd id="section-6.2-3.26" style="margin-left: 1.5em">HMAC of the whole Map-Reply packet to protect its integrity,
   including the LISP-SEC Authentication Data (from the 'Map-Reply Type'
   field to the 'PKT HMAC' field), which allow message authentication.<a class="pilcrow" href="#section-6.2-3.26">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<section id="section-6.3">
        <h3 id="name-map-register-lisp-sec-exten">
<a class="section-number selfRef" href="#section-6.3">6.3. </a><a class="section-name selfRef" href="#name-map-register-lisp-sec-exten">Map-Register LISP-SEC Extensions</a>
        </h3>
<p id="section-6.3-1">The S-bit in the Map-Register message (see <span>[<a class="cite xref" href="#RFC9301">RFC9301</a>]</span>) indicates to the Map-Server that the registering ETR is LISP-SEC enabled. An ETR that supports LISP-SEC <span class="bcp14">MUST</span> set the S-bit in its Map-Register messages.<a class="pilcrow" href="#section-6.3-1">¶</a></p>
</section>
<div id="itr">
<section id="section-6.4">
        <h3 id="name-itr-processing-generating-a">
<a class="section-number selfRef" href="#section-6.4">6.4. </a><a class="section-name selfRef" href="#name-itr-processing-generating-a">ITR Processing: Generating a Map-Request</a>
        </h3>
<p id="section-6.4-1">Upon creating a Map-Request, the ITR generates a random ITR-OTK
        that is stored locally, until the corresponding Map-Reply is
        received (see <a class="auto internal xref" href="#itr-receive">Section 6.9</a>), together with the nonce generated as specified in <span>[<a class="cite xref" href="#RFC9301">RFC9301</a>]</span>.<a class="pilcrow" href="#section-6.4-1">¶</a></p>
<p id="section-6.4-2">The ITR <span class="bcp14">MAY</span> use the 'KDF ID' field to indicate the recommended KDF algorithm according to local policy. The Map-Server can overwrite the KDF ID if it does not support the KDF ID recommended by the ITR (see <a class="auto internal xref" href="#map-server">Section 6.7</a>). A KDF value of NOPREF (0) may be used to specify that the ITR has no preferred KDF ID.<a class="pilcrow" href="#section-6.4-2">¶</a></p>
<p id="section-6.4-3">ITR-OTK confidentiality and integrity protection <span class="bcp14">MUST</span> be provided
        in the path between the ITR and the Map-Resolver. This can be achieved
        either by encrypting the ITR-OTK with the pre-shared secret known to
        the ITR and the Map-Resolver (see <a class="auto internal xref" href="#encryption">Section 6.5</a>) or by
        enabling DTLS <span>[<a class="cite xref" href="#RFC9147">RFC9147</a>]</span> between the ITR and the Map-Resolver.<a class="pilcrow" href="#section-6.4-3">¶</a></p>
<p id="section-6.4-4">The Map-Request (as defined in <span>[<a class="cite xref" href="#RFC9301">RFC9301</a>]</span>) <span class="bcp14">MUST</span> be encapsulated as a LISP Control Message in an ECM, with the S-bit set to 1, to indicate the presence of Authentication Data. Such a message is also called a "Protected Map-Request" in this memo.<a class="pilcrow" href="#section-6.4-4">¶</a></p>
<p id="section-6.4-5">The ITR-OTK is wrapped with the algorithm specified by the 'OTK Wrapping
        ID' field. See <a class="auto internal xref" href="#encryption">Section 6.5</a> for further details on OTK
        encryption. If the NULL-KEY-WRAP-128 algorithm (see <a class="auto internal xref" href="#wrap">Section 8.4</a>) is selected, and no other encryption mechanism (e.g., DTLS) is enabled in the path between the ITR and the Map-Resolver, the Map-Request <span class="bcp14">MUST</span> be dropped, and an appropriate log action <span class="bcp14">SHOULD</span> be taken. Implementations may include mechanisms (which are beyond the scope of this document) to avoid log resource exhaustion attacks.<a class="pilcrow" href="#section-6.4-5">¶</a></p>
<p id="section-6.4-6">The 'Requested HMAC ID' field contains the suggested HMAC algorithm
        to be used by the Map-Server and the ETR to protect the integrity of
        the ECM Authentication Data and of the Map-Reply.  A HMAC ID value of
        NONE (0) <span class="bcp14">MAY</span> be used to specify that the ITR has no preferred HMAC ID.<a class="pilcrow" href="#section-6.4-6">¶</a></p>
<p id="section-6.4-7">The 'KDF ID' field specifies the suggested Key Derivation Function to
        be used by the Map-Server to derive the MS-OTK. A KDF value of NONE
        (0) may be used to specify that the ITR has no preferred KDF ID.<a class="pilcrow" href="#section-6.4-7">¶</a></p>
<p id="section-6.4-8">The EID-AD Length is set to 4 bytes, since the Authentication Data
        does not contain EID-Prefix Authentication Data, and the EID-AD
        contains only the 'KDF ID' field.<a class="pilcrow" href="#section-6.4-8">¶</a></p>
<p id="section-6.4-9">If the ITR is directly connected to a Mapping System, such as LISP+ALT <span>[<a class="cite xref" href="#RFC6836">RFC6836</a>]</span>, it performs the functions of both the ITR and the Map-Resolver, forwarding the Protected Map-Request as described in <a class="auto internal xref" href="#map-resolver">Section 6.6</a>.<a class="pilcrow" href="#section-6.4-9">¶</a></p>
<p id="section-6.4-10">The processing performed by Proxy ITRs (PITRs) is equivalent to the
        processing of an ITR; hence, the procedure described above applies.<a class="pilcrow" href="#section-6.4-10">¶</a></p>
</section>
</div>
<div id="encryption">
<section id="section-6.5">
        <h3 id="name-encrypting-and-decrypting-a">
<a class="section-number selfRef" href="#section-6.5">6.5. </a><a class="section-name selfRef" href="#name-encrypting-and-decrypting-a">Encrypting and Decrypting an OTK</a>
        </h3>
<p id="section-6.5-1">MS-OTK confidentiality and integrity protection <span class="bcp14">MUST</span> be provided in
        the path between the Map-Server and the ETR. This can be achieved
        either by enabling DTLS between the Map-Server and the ETR or by
        encrypting the MS-OTK with the pre-shared secret known to the
        Map-Server and the ETR <span>[<a class="cite xref" href="#RFC9301">RFC9301</a>]</span>.<a class="pilcrow" href="#section-6.5-1">¶</a></p>
<p id="section-6.5-2">Similarly, ITR-OTK confidentiality and integrity protection <span class="bcp14">MUST</span> be
        provided in the path between the ITR and the Map-Resolver. This can be
        achieved either by enabling DTLS between the Map-Server and the ITR
        or by encrypting the ITR-OTK with the pre-shared secret known to the
        ITR and the Map-Resolver. The ITR/Map-Resolver pre-shared key is
        similar to the Map-Server/ETR pre-shared key.<a class="pilcrow" href="#section-6.5-2">¶</a></p>
<p id="section-6.5-3">This section describes OTK processing in the ITR/Map-Resolver path,
        as well as in the Map-Server/ETR path.<a class="pilcrow" href="#section-6.5-3">¶</a></p>
<p id="section-6.5-4">It's important to note that, to prevent ETR's overclaiming attacks,
        the ITR/Map-Resolver pre-shared secret <span class="bcp14">MUST</span> be independent from the
        Map-Server/ETR pre-shared secret.<a class="pilcrow" href="#section-6.5-4">¶</a></p>
<p id="section-6.5-5">The OTK is wrapped using the algorithm specified in the 'OTK
        Wrapping ID' field. This field identifies both the:<a class="pilcrow" href="#section-6.5-5">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.5-6.1">Key Encryption Algorithm used to encrypt the wrapped OTK and<a class="pilcrow" href="#section-6.5-6.1">¶</a>
</li>
          <li class="normal" id="section-6.5-6.2">Key Derivation Function used to derive a per-message encryption
            key.<a class="pilcrow" href="#section-6.5-6.2">¶</a>
</li>
        </ul>
<p id="section-6.5-7">
          Implementations of this specification <span class="bcp14">MUST</span> support the OTK
          Wrapping ID AES-KEY-WRAP-128+HKDF-SHA256, which specifies the use of the
          HKDF-SHA256 Key Derivation Function specified in <span>[<a class="cite xref" href="#RFC5869">RFC5869</a>]</span> to derive a per-message encryption key
          (per-msg-key), as well as the AES-KEY-WRAP-128 key wrap algorithm used
          to encrypt a 128-bit OTK, according to <span>[<a class="cite xref" href="#RFC3394">RFC3394</a>]</span>.<a class="pilcrow" href="#section-6.5-7">¶</a></p>
<p id="section-6.5-8">Implementations of this specification <span class="bcp14">MUST</span> support OTK
          Wrapping NULL-KEY-WRAP-128. NULL-KEY-WRAP-128 is used to carry an unencrypted 128-bit OTK, with a 64-bit preamble set to 0x0000000000000000 (64 bits).<a class="pilcrow" href="#section-6.5-8">¶</a></p>
<p id="section-6.5-9">The key wrapping process for OTK Wrapping ID
        AES-KEY-WRAP-128+HKDF-SHA256 is described below:<a class="pilcrow" href="#section-6.5-9">¶</a></p>
<ol class="normal type-1" id="section-6.5-10" start="1" type="1">
   <li id="section-6.5-10.1">The KDF and key wrap algorithms are identified by the value of the 'OTK Wrapping ID' field. The initial values are documented in <a class="auto internal xref" href="#tableKWF">Table 5</a>.<a class="pilcrow" href="#section-6.5-10.1">¶</a>
</li>
          <li id="section-6.5-10.2">If the NULL-KEY-WRAP-128 algorithm (see <a class="auto internal xref" href="#wrap">Section 8.4</a>) is selected and DTLS is not enabled, the Map-Request
            <span class="bcp14">MUST</span> be dropped and an appropriate log action <span class="bcp14">SHOULD</span> be taken. Implementations may include mechanisms (which are beyond the scope of this document) to avoid log resource exhaustion attacks.<a class="pilcrow" href="#section-6.5-10.2">¶</a>
</li>
          <li id="section-6.5-10.3">The pre-shared secret used to derive the per-msg-key is
            represented by PSK[Key ID], which is the pre-shared secret
            identified by the 'Key ID'.<a class="pilcrow" href="#section-6.5-10.3">¶</a>
</li>
          <li id="section-6.5-10.4">
            <p id="section-6.5-10.4.1">The 128-bit-long per-message encryption key is computed as:<a class="pilcrow" href="#section-6.5-10.4.1">¶</a></p>
<p id="section-6.5-10.4.2" style="margin-left: 1.5em">per-msg-key = KDF( nonce + s + PSK[Key ID] )<a class="pilcrow" href="#section-6.5-10.4.2">¶</a></p>
<p id="section-6.5-10.4.3">where the nonce is the value in the 'Nonce' field of the
            Map-Request, 's' is the string "OTK-Key-Wrap", and the operation'+'
     just indicates string concatenation.<a class="pilcrow" href="#section-6.5-10.4.3">¶</a></p>
</li>
          <li id="section-6.5-10.5">The per-msg-key is then used to wrap the OTK with AES-KEY-WRAP-128, as specified in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc3394#section-2.2.1">Section 2.2.1</a> of [<a class="cite xref" href="#RFC3394">RFC3394</a>]</span>. The AES Key Wrap
            Initialization Value <span class="bcp14">MUST</span> be set to 0xA6A6A6A6A6A6A6A6 (64 bits).
            The output of the AES key wrap operation is 192 bits long.
     The most significant 64 bits
       are copied in the 'One-Time Key Preamble' field, while the 128
       least significant bits are copied in the 'One-Time Key' field of
       the LISP-SEC Authentication Data.<a class="pilcrow" href="#section-6.5-10.5">¶</a>
</li>
        </ol>
<p id="section-6.5-11">When decrypting an encrypted OTK, the receiver <span class="bcp14">MUST</span> verify that the
        Initialization Value resulting from the AES key wrap decryption
        operation is equal to 0xA6A6A6A6A6A6A6A6. If this verification fails,
        the receiver <span class="bcp14">MUST</span> discard the entire message.<a class="pilcrow" href="#section-6.5-11">¶</a></p>
<div id="null">
<section id="section-6.5.1">
          <h4 id="name-unencrypted-otk">
<a class="section-number selfRef" href="#section-6.5.1">6.5.1. </a><a class="section-name selfRef" href="#name-unencrypted-otk">Unencrypted OTK</a>
          </h4>
<p id="section-6.5.1-1">However, when DTLS is enabled, the OTK <span class="bcp14">MAY</span> be sent unencrypted as
          transport layer security is providing confidentiality and integrity
          protection.<a class="pilcrow" href="#section-6.5.1-1">¶</a></p>
<p id="section-6.5.1-2">When a 128-bit OTK is sent unencrypted, the OTK Wrapping ID is set
          to NULL_KEY_WRAP_128, and the OTK Preamble is set to
          0x0000000000000000 (64 bits).<a class="pilcrow" href="#section-6.5.1-2">¶</a></p>
</section>
</div>
</section>
</div>
<div id="map-resolver">
<section id="section-6.6">
        <h3 id="name-map-resolver-processing">
<a class="section-number selfRef" href="#section-6.6">6.6. </a><a class="section-name selfRef" href="#name-map-resolver-processing">Map-Resolver Processing</a>
        </h3>
<p id="section-6.6-1">Upon receiving a Protected Map-Request, the Map-Resolver decapsulates the ECM. The ITR-OTK, if encrypted,
        is decrypted as specified in <a class="auto internal xref" href="#encryption">Section 6.5</a>.<a class="pilcrow" href="#section-6.6-1">¶</a></p>
<p id="section-6.6-2">Protecting the confidentiality of the ITR-OTK and, in general, the
        security of how the Map-Request is handed by the Map-Resolver to the
        Map-Server is specific to the particular Mapping System used and is
        outside of the scope of this memo.<a class="pilcrow" href="#section-6.6-2">¶</a></p>
<p id="section-6.6-3">In Mapping Systems where the Map-Server is compliant with <span>[<a class="cite xref" href="#RFC9301">RFC9301</a>]</span>, the Map-Resolver originates a new
        ECM header with the S-bit set, which contains the unencrypted ITR-OTK,
        as specified in <a class="auto internal xref" href="#encryption">Section 6.5</a>, and the other data
        derived from the ECM Authentication Data of the received Encapsulated
        Map-Request.<a class="pilcrow" href="#section-6.6-3">¶</a></p>
<p id="section-6.6-4">The Map-Resolver then forwards to the Map-Server the received
        Map-Request, which is encapsulated in the new ECM header that includes the
        newly computed 'Authentication Data' fields.<a class="pilcrow" href="#section-6.6-4">¶</a></p>
</section>
</div>
<div id="map-server">
<section id="section-6.7">
        <h3 id="name-map-server-processing">
<a class="section-number selfRef" href="#section-6.7">6.7. </a><a class="section-name selfRef" href="#name-map-server-processing">Map-Server Processing</a>
        </h3>
<p id="section-6.7-1">Upon receiving a Protected Map-Request, the Map-Server processes it according to the setting of the S-bit and the P-bit in the Map-Register received from the ETRs authoritative for that prefix, as described below.<a class="pilcrow" href="#section-6.7-1">¶</a></p>
<p id="section-6.7-2">While processing the Map-Request, the Map-Server can overwrite the 'KDF ID' field if it does not support the KDF ID recommended by the ITR.
        Processing of the Map-Request <span class="bcp14">MUST</span> proceed in the order described
        in the table below, applying the process corresponding to the first
        rule that matches the conditions indicated in the first column:<a class="pilcrow" href="#section-6.7-2">¶</a></p>
<span id="name-map-request-processing"></span><div id="tableMRP">
<table class="center" id="table-1">
          <caption>
<a class="selfRef" href="#table-1">Table 1</a>:
<a class="selfRef" href="#name-map-request-processing">Map-Request Processing</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Matching Condition</th>
              <th class="text-left" colspan="1" rowspan="1">Processing</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">1. At least one of the ETRs authoritative for the
       EID-Prefix included in the Map-Request registered with the P-bit set
       to 1</td>
              <td class="text-left" colspan="1" rowspan="1">The Map-Server <span class="bcp14">MUST</span> generate a
       LISP-SEC-protected Map-Reply, as
              specified in <a class="auto internal xref" href="#proxy">Section 6.7.2</a>. The
       ETR-Cant-Sign E-bit in the
              EID Authentication Data (EID-AD) <span class="bcp14">MUST</span> be set to 0.</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">2. At least one of the ETRs authoritative for the
       EID-Prefix included in the Map-Request registered with the S-bit set
       to 1</td>
              <td class="text-left" colspan="1" rowspan="1">The Map-Server <span class="bcp14">MUST</span> generate a
       LISP-SEC-protected Encapsulated
              Map-Request (as specified in <a class="auto internal xref" href="#EID-AD">Section 6.7.1</a>) to be sent to
              one of the authoritative ETRs that registered with the S-bit set to
              1 (and the P-bit set to 0). If there is at least one ETR that
              registered with the S-bit set to 0, the ETR-Cant-Sign E-bit of the
              EID-AD <span class="bcp14">MUST</span> be set to 1 to signal the ITR that a non-LISP-SEC
       Map-Request might reach additional ETRs that have LISP-SEC
              disabled.</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">3. All the ETRs authoritative for the EID-Prefix
       included in the
              Map-Request registered with the S-bit set to 0</td>
              <td class="text-left" colspan="1" rowspan="1">The Map-Server <span class="bcp14">MUST</span> send a Negative
       Map-Reply protected with
              LISP-SEC, as described in <a class="auto internal xref" href="#proxy">Section 6.7.2</a>.
       The ETR-Cant-Sign
              E-bit <span class="bcp14">MUST</span> be set to 1 to signal the ITR that a non-LISP-SEC
       Map-Request might reach additional ETRs that have LISP-SEC
              disabled.</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-6.7-4">In this way, the ITR that sent a LISP-SEC-protected Map-Request
        always receives a LISP-SEC-protected Map-Reply. However, the
        ETR-Cant-Sign E-bit set to 1 specifies that a non-LISP-SEC Map-Request
        might reach additional ETRs that have LISP-SEC disabled. This
        mechanism allows the ITR to downgrade to non-LISP-SEC
        requests, which does not protect against threats described in <a class="auto internal xref" href="#threat-model">Section 4</a>.<a class="pilcrow" href="#section-6.7-4">¶</a></p>
<div id="EID-AD">
<section id="section-6.7.1">
          <h4 id="name-generating-a-lisp-sec-prote">
<a class="section-number selfRef" href="#section-6.7.1">6.7.1. </a><a class="section-name selfRef" href="#name-generating-a-lisp-sec-prote">Generating a LISP-SEC-Protected Encapsulated Map-Request</a>
          </h4>
<p id="section-6.7.1-1">The Map-Server decapsulates the ECM and generates new ECM
          Authentication Data. The Authentication Data includes the OTK-AD and
          the EID-AD, which contains EID-Prefix authorization information that
          are eventually received by the requesting ITR.<a class="pilcrow" href="#section-6.7.1-1">¶</a></p>
<p id="section-6.7.1-2">The Map-Server updates the OTK-AD by deriving a new OTK (MS-OTK)
          from the ITR-OTK received with the Map-Request. MS-OTK is derived by
          applying the Key Derivation Function specified in the 'KDF ID' field.
          If the algorithm specified in the 'KDF ID' field is not supported, the
          Map-Server uses a different algorithm to derive the key and updates
          the 'KDF ID' field accordingly.<a class="pilcrow" href="#section-6.7.1-2">¶</a></p>
<p id="section-6.7.1-3">The Map-Request <span class="bcp14">MUST</span> be encapsulated in an ECM, with the S-bit
          set to 1, to indicate the presence of Authentication Data.<a class="pilcrow" href="#section-6.7.1-3">¶</a></p>
<p id="section-6.7.1-4">MS-OTK is wrapped with the algorithm specified by the 'OTK
          Wrapping ID' field. See <a class="auto internal xref" href="#encryption">Section 6.5</a> for further
          details on OTK encryption. If the NULL-KEY-WRAP-128 algorithm is
          selected and DTLS is not enabled in the path between the Map-Server
          and the ETR, the Map-Request <span class="bcp14">MUST</span> be dropped and an appropriate log
          action <span class="bcp14">SHOULD</span> be taken.<a class="pilcrow" href="#section-6.7.1-4">¶</a></p>
<p id="section-6.7.1-5">In the EID-AD, the Map-Server includes in the EID-AD the longest-match-registered
   EID-Prefix for the destination EID and an HMAC of this
          EID-Prefix. The HMAC is keyed with the ITR-OTK contained in the
          received ECM Authentication Data, and the HMAC algorithm is chosen
          according to the 'Requested HMAC ID' field. If the Map-Server does not
          support this algorithm, the Map-Server uses a different algorithm
          and specifies it in the 'EID HMAC ID' field. The scope of the HMAC
          operation <span class="bcp14">MUST</span> cover the entire EID-AD, from the 'EID-AD Length' field to the 'EID HMAC' field, which <span class="bcp14">MUST</span> be set to 0 before the
          computation.<a class="pilcrow" href="#section-6.7.1-5">¶</a></p>
<p id="section-6.7.1-6">The Map-Server then forwards the updated ECM-Encapsulated
          Map-Request, which contains the OTK-AD, the EID-AD, and the received
          Map-Request to an authoritative ETR as specified in <span>[<a class="cite xref" href="#RFC9301">RFC9301</a>]</span>.<a class="pilcrow" href="#section-6.7.1-6">¶</a></p>
</section>
</div>
<div id="proxy">
<section id="section-6.7.2">
          <h4 id="name-generating-a-proxy-map-repl">
<a class="section-number selfRef" href="#section-6.7.2">6.7.2. </a><a class="section-name selfRef" href="#name-generating-a-proxy-map-repl">Generating a Proxy Map-Reply</a>
          </h4>
<p id="section-6.7.2-1">A LISP-SEC proxy Map-Reply is generated according to <span>[<a class="cite xref" href="#RFC9301">RFC9301</a>]</span>, with the Map-Reply S-bit set
          to 1. The Map-Reply includes the Authentication Data that contains
          the EID-AD computed as specified in <a class="auto internal xref" href="#EID-AD">Section 6.7.1</a>, as
          well as the PKT-AD computed as specified in <a class="auto internal xref" href="#etr">Section 6.8</a>.<a class="pilcrow" href="#section-6.7.2-1">¶</a></p>
</section>
</div>
</section>
</div>
<div id="etr">
<section id="section-6.8">
        <h3 id="name-etr-processing">
<a class="section-number selfRef" href="#section-6.8">6.8. </a><a class="section-name selfRef" href="#name-etr-processing">ETR Processing</a>
        </h3>
<p id="section-6.8-1">Upon receiving an ECM-Encapsulated Map-Request with the S-bit set,
        the ETR decapsulates the ECM. The 'OTK' field, if encrypted, is
        decrypted as specified in <a class="auto internal xref" href="#encryption">Section 6.5</a> to obtain the
        unencrypted MS-OTK.<a class="pilcrow" href="#section-6.8-1">¶</a></p>
<p id="section-6.8-2">The ETR then generates a Map-Reply as specified in <span>[<a class="cite xref" href="#RFC9301">RFC9301</a>]</span> and includes the Authentication
        Data that contains the EID-AD, as received in the Encapsulated
        Map-Request, as well as the PKT-AD.<a class="pilcrow" href="#section-6.8-2">¶</a></p>
<p id="section-6.8-3">The EID-AD is copied from the Authentication Data of the received
        Encapsulated Map-Request.<a class="pilcrow" href="#section-6.8-3">¶</a></p>
<p id="section-6.8-4">The PKT-AD contains the HMAC of the whole Map-Reply packet, keyed
        with the MS-OTK and computed using the HMAC algorithm specified in the
        'Requested HMAC ID' field of the received Encapsulated Map-Request.
        If the ETR does not support the Requested HMAC ID, it uses a different algorithm and updates the 'PKT HMAC ID' field accordingly.
        The HMAC operation <span class="bcp14">MUST</span> cover the entire Map-Reply, where the 'PKT HMAC' field <span class="bcp14">MUST</span> be set to 0 before the computation.<a class="pilcrow" href="#section-6.8-4">¶</a></p>
<p id="section-6.8-5">Finally, the ETR sends the Map-Reply to the requesting ITR as
        specified in <span>[<a class="cite xref" href="#RFC9301">RFC9301</a>]</span>.<a class="pilcrow" href="#section-6.8-5">¶</a></p>
</section>
</div>
<div id="itr-receive">
<section id="section-6.9">
        <h3 id="name-itr-processing-receiving-a-">
<a class="section-number selfRef" href="#section-6.9">6.9. </a><a class="section-name selfRef" href="#name-itr-processing-receiving-a-">ITR Processing: Receiving a Map-Reply</a>
        </h3>
<p id="section-6.9-1">In response to a Protected Map-Request, an ITR expects a Map-Reply with the S-bit set to 1, including an EID-AD and a PKT-AD.  The ITR <span class="bcp14">MUST</span> discard the Map-Reply otherwise.<a class="pilcrow" href="#section-6.9-1">¶</a></p>
<p id="section-6.9-2">Upon receiving a Map-Reply, the ITR must verify the integrity of
        both the EID-AD and the PKT-AD and <span class="bcp14">MUST</span> discard the Map-Reply if one
        of the integrity checks fails. After processing the Map-Reply, the ITR
        <span class="bcp14">MUST</span> discard the &lt;nonce,ITR-OTK&gt; pair associated to the
        Map-Reply.<a class="pilcrow" href="#section-6.9-2">¶</a></p>
<p id="section-6.9-3">The integrity of the EID-AD is verified using the ITR-OTK (stored
        locally for the duration of this exchange) to recompute the HMAC of
        the EID-AD using the algorithm specified in the 'EID HMAC ID' field.
        If the ITR did indicate a Requested HMAC ID in the Map-Request and the PKT HAMC ID in the corresponding Map-Reply is different, or if the ITR did not indicate a Requested HMAC ID in the Map-Request and the PKT HMAC ID in the corresponding Map-Reply is not supported, then the ITR <span class="bcp14">MUST</span> discard the Map-Reply and send, according to rate-limitation policies defined in <span>[<a class="cite xref" href="#RFC9301">RFC9301</a>]</span>, a new Map-Request with a different 'Requested HMAC ID' field, according to ITR's local policy. The scope of the HMAC operation covers the entire EID-AD, from the 'EID-AD Length' field to the 'EID HMAC' field.<a class="pilcrow" href="#section-6.9-3">¶</a></p>
<p id="section-6.9-4">ITR <span class="bcp14">MUST</span> set the 'EID HMAC ID' field to 0 before computing the
        HMAC.<a class="pilcrow" href="#section-6.9-4">¶</a></p>
<p id="section-6.9-5">To verify the integrity of the PKT-AD, first the MS-OTK is derived
        from the locally stored ITR-OTK using the algorithm specified in the
        'KDF ID' field.
        This is because the PKT-AD is generated by the ETR using
        the MS-OTK. If the ITR did indicate a recommended KDF ID in the Map-Request and the KDF ID in the corresponding Map-Reply is different or if the ITR did not indicate a recommended KDF ID in the Map-Request and the KDF ID in the corresponding Map-Reply is not supported, then the ITR <span class="bcp14">MUST</span> discard the Map-Reply and
        send, according to rate-limitation policies defined in <span>[<a class="cite xref" href="#RFC9301">RFC9301</a>]</span>, a new Map-Request with a
        different KDF ID, according to ITR's local policy.
        The Key Derivation Function HKDF-SHA256 <span class="bcp14">MUST</span> be supported in LISP-SEC implementations. LISP-SEC deployments <span class="bcp14">SHOULD</span> use the HKDF-SHA256 HKDF function, unless older implementations using HKDF-SHA1-128 are present in the same deployment.
         Without consistent configuration of involved entities, extra delays may be experienced.
        However, since HKDF-SHA1-128 and HKDF-SHA256 are supported, the process will eventually converge.<a class="pilcrow" href="#section-6.9-5">¶</a></p>
<p id="section-6.9-6">The derived MS-OTK is then used to recompute the HMAC of the
        PKT-AD using the algorithm specified in the 'PKT HMAC ID' field. If the
        'PKT HMAC ID' field does not match the Requested HMAC ID, the ITR <span class="bcp14">MUST</span>
        discard the Map-Reply and send, according to rate-limitation policies defined in <span>[<a class="cite xref" href="#RFC9301">RFC9301</a>]</span>,
        a new Map-Request with a different Requested HMAC ID, according to
        ITR's local policy or until all HMAC IDs supported by the ITR have
        been attempted. When the 'PKT HMAC ID' field does not match the Requested HMAC ID, it is not possible to validate the Map-Reply.<a class="pilcrow" href="#section-6.9-6">¶</a></p>
<p id="section-6.9-7">Each individual Map-Reply EID-Record is considered valid only if:
        (1) both EID-AD and PKT-AD are valid and (2) the intersection of the
        EID-Prefix in the Map-Reply EID-Record with one of the EID-Prefixes
        contained in the EID-AD is not empty. After identifying the Map-Reply
        record as valid, the ITR sets the EID-Prefix in the Map-Reply record
        to the value of the intersection set computed before and adds the
        Map-Reply EID-Record to its EID-to-RLOC Map-Cache, as described in <span>[<a class="cite xref" href="#RFC9301">RFC9301</a>]</span>. An example of Map-Reply record
        validation is provided in <a class="auto internal xref" href="#validation">Section 6.9.1</a>.<a class="pilcrow" href="#section-6.9-7">¶</a></p>
<p id="section-6.9-8"><span>[<a class="cite xref" href="#RFC9301">RFC9301</a>]</span> allows ETRs to send
        Solicit-Map-Requests (SMRs) directly to the ITR. The corresponding SMR-invoked Map-Request will be sent through the Mapping System, hence, secured with the specifications of this memo if in use.
        If an ITR accepts Map-Replies piggybacked in Map-Requests and its content is not already present in its EID-to-RLOC Map-Cache, it <span class="bcp14">MUST</span> send a Map-Request over the Mapping System in order to verify its content with a secured Map-Reply before using the content.<a class="pilcrow" href="#section-6.9-8">¶</a></p>
<div id="validation">
<section id="section-6.9.1">
          <h4 id="name-map-reply-record-validation">
<a class="section-number selfRef" href="#section-6.9.1">6.9.1. </a><a class="section-name selfRef" href="#name-map-reply-record-validation">Map-Reply Record Validation</a>
          </h4>
<p id="section-6.9.1-1">The payload of a Map-Reply may contain multiple EID-Records. The
          whole Map-Reply is signed by the ETR, with the PKT HMAC, to provide
          integrity protection and origin authentication to the EID-Prefix
          records claimed by the ETR. The 'Authentication Data' field of a
          Map-Reply may contain multiple EID-Records in the EID-AD. The EID-AD
          is signed by the Map-Server, with the EID HMAC, to provide integrity
          protection and origin authentication to the EID-Prefix records
          inserted by the Map-Server.<a class="pilcrow" href="#section-6.9.1-1">¶</a></p>
<p id="section-6.9.1-2">Upon receiving a Map-Reply with the S-bit set, the ITR first
          checks the validity of both the EID HMAC and of the PKT-AD HMAC. If
          either one of the HMACs is not valid, a log action <span class="bcp14">SHOULD</span> be taken and
          the Map-Reply <span class="bcp14">MUST NOT</span> be processed any further. Implementations may include mechanisms (which are beyond the scope of this document) to avoid log resource exhaustion attacks. If both HMACs are
          valid, the ITR proceeds with validating each individual EID-Record
          claimed by the ETR by computing the intersection of each one of the
          EID-Prefixes contained in the payload of the Map-Reply, with each one
          of the EID-Prefixes contained in the EID-AD. An EID-Record is valid
          only if at least one of the intersections is not the empty set; otherwise, a log action <span class="bcp14">MUST</span> be taken and the EID-Record <span class="bcp14">MUST</span> be discarded. Implementations may include mechanisms (which are beyond the scope of this document) to avoid log resource exhaustion attacks.<a class="pilcrow" href="#section-6.9.1-2">¶</a></p>
<p id="section-6.9.1-3">For instance, the Map-Reply payload contains 3 mapping record
          EID-Prefixes:<a class="pilcrow" href="#section-6.9.1-3">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.9.1-4.1">2001:db8:102::/48<a class="pilcrow" href="#section-6.9.1-4.1">¶</a>
</li>
            <li class="normal ulEmpty" id="section-6.9.1-4.2">2001:db8:103::/48<a class="pilcrow" href="#section-6.9.1-4.2">¶</a>
</li>
            <li class="normal ulEmpty" id="section-6.9.1-4.3">2001:db8:200::/40<a class="pilcrow" href="#section-6.9.1-4.3">¶</a>
</li>
          </ul>
<p id="section-6.9.1-5">
          The EID-AD contains two EID-Prefixes:<a class="pilcrow" href="#section-6.9.1-5">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.9.1-6.1">2001:db8:103::/48<a class="pilcrow" href="#section-6.9.1-6.1">¶</a>
</li>
            <li class="normal ulEmpty" id="section-6.9.1-6.2">2001:db8:203::/48<a class="pilcrow" href="#section-6.9.1-6.2">¶</a>
</li>
          </ul>
<p id="section-6.9.1-7">
          The EID-Record with EID-Prefix 2001:db8:102::/48 is not
          eligible to be used by the ITR, since it is not included in any of
          the EID-ADs signed by the Map-Server. A log action <span class="bcp14">MUST</span> be taken, and the EID-Record <span class="bcp14">MUST</span> be
     discarded. Implementations may include mechanisms (which are beyond the scope of this document) to avoid log resource exhaustion attacks.<a class="pilcrow" href="#section-6.9.1-7">¶</a></p>
<p id="section-6.9.1-8">The EID-Record with EID-Prefix 2001:db8:103::/48 is eligible to
          be used by the ITR because it matches the second EID-Prefix
          contained in the EID-AD.<a class="pilcrow" href="#section-6.9.1-8">¶</a></p>
<p id="section-6.9.1-9">The EID-Record with EID-Prefix 2001:db8:200::/40 is not eligible
          to be used by the ITR, since it is not included in any of the EID-ADs
          signed by the Map-Server. A log action <span class="bcp14">MUST</span> be taken and the EID-Record <span class="bcp14">MUST</span> be
     discarded. Implementations may include mechanisms (which are beyond the scope of this document) to avoid log resource exhaustion attacks. In this last example, the ETR is trying to over claim the EID-Prefix 2001:db8:200::/40, but the Map-Server authorized only
          2001:db8:203::/48; hence, the EID-Record is discarded.<a class="pilcrow" href="#section-6.9.1-9">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="security">
<section id="section-7">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<p id="section-7-1">This document extends the LISP control plane defined in <span>[<a class="cite xref" href="#RFC9301">RFC9301</a>]</span>; hence, its security considerations apply to this document  as well.<a class="pilcrow" href="#section-7-1">¶</a></p>
<div id="mapping-system">
<section id="section-7.1">
        <h3 id="name-mapping-system-security">
<a class="section-number selfRef" href="#section-7.1">7.1. </a><a class="section-name selfRef" href="#name-mapping-system-security">Mapping System Security</a>
        </h3>
<p id="section-7.1-1">The LISP-SEC threat model described in <a class="auto internal xref" href="#threat-model">Section 4</a> assumes that the LISP Mapping System is
        working properly and delivers Map-Request messages to a
        Map-Server that is authoritative for the requested EID.<a class="pilcrow" href="#section-7.1-1">¶</a></p>
<p id="section-7.1-2">It is assumed that the Mapping System ensures the confidentiality
        of the OTK and the integrity of the Map-Reply data. However, how the
        LISP Mapping System is secured is out of the scope of this
        document.<a class="pilcrow" href="#section-7.1-2">¶</a></p>
<p id="section-7.1-3">Similarly, Map-Register security, including the right for a LISP
        entity to register an EID-Prefix or to claim presence at an RLOC, is
        out of the scope of LISP-SEC.<a class="pilcrow" href="#section-7.1-3">¶</a></p>
</section>
</div>
<div id="random">
<section id="section-7.2">
        <h3 id="name-random-number-generation">
<a class="section-number selfRef" href="#section-7.2">7.2. </a><a class="section-name selfRef" href="#name-random-number-generation">Random Number Generation</a>
        </h3>
<p id="section-7.2-1">The ITR-OTK <span class="bcp14">MUST</span> be generated by a properly seeded pseudo-random
        (or strong random) source. See <span>[<a class="cite xref" href="#RFC4086">RFC4086</a>]</span> for advice on
        generating security-sensitive random data.<a class="pilcrow" href="#section-7.2-1">¶</a></p>
</section>
</div>
<div id="colocation">
<section id="section-7.3">
        <h3 id="name-map-server-and-etr-colocati">
<a class="section-number selfRef" href="#section-7.3">7.3. </a><a class="section-name selfRef" href="#name-map-server-and-etr-colocati">Map-Server and ETR Colocation</a>
        </h3>
<p id="section-7.3-1">If the Map-Server and the ETR are colocated, LISP-SEC does not
        provide protection from overclaiming attacks mounted by the ETR.
        However, in this particular case, since the ETR is within the trust
        boundaries of the Map-Server, ETR's overclaiming attacks are not
        included in the threat model.<a class="pilcrow" href="#section-7.3-1">¶</a></p>
</section>
</div>
<div id="deploying">
<section id="section-7.4">
        <h3 id="name-deploying-lisp-sec">
<a class="section-number selfRef" href="#section-7.4">7.4. </a><a class="section-name selfRef" href="#name-deploying-lisp-sec">Deploying LISP-SEC</a>
        </h3>
<p id="section-7.4-1">Those deploying LISP-SEC according to this memo should carefully
        weigh how the LISP-SEC threat model applies to their particular use
        case or deployment. If they decide to ignore a particular
        recommendation, they should make sure the risk associated with the corresponding threats is well understood.<a class="pilcrow" href="#section-7.4-1">¶</a></p>
<p id="section-7.4-2">As an example, in certain other
        deployments, attackers may be very sophisticated and force the
        deployers to enforce very strict policies in terms of HMAC algorithms
        accepted by an ITR.<a class="pilcrow" href="#section-7.4-2">¶</a></p>
<p id="section-7.4-3">Similar considerations apply to the entire LISP-SEC threat model
        and should guide the deployers and implementors whenever they
        encounter the key word <span class="bcp14">SHOULD</span> across this memo.<a class="pilcrow" href="#section-7.4-3">¶</a></p>
</section>
</div>
<div id="provisioning">
<section id="section-7.5">
        <h3 id="name-shared-keys-provisioning">
<a class="section-number selfRef" href="#section-7.5">7.5. </a><a class="section-name selfRef" href="#name-shared-keys-provisioning">Shared Keys Provisioning</a>
        </h3>
<p id="section-7.5-1">Provisioning of the keys shared between ITR and
        Map-Resolver pairs as well as between ETR and Map-Server pairs should be performed via an orchestration infrastructure, and is out of the scope of this memo. It is recommended that both shared keys be refreshed at periodical intervals to address key aging or attackers gaining unauthorized access to the shared keys. Shared keys should be unpredictable random values.<a class="pilcrow" href="#section-7.5-1">¶</a></p>
</section>
</div>
<div id="reply">
<section id="section-7.6">
        <h3 id="name-replay-attacks">
<a class="section-number selfRef" href="#section-7.6">7.6. </a><a class="section-name selfRef" href="#name-replay-attacks">Replay Attacks</a>
        </h3>
<p id="section-7.6-1">An attacker can capture a valid Map-Request and/or Map-Reply and
        replay it; however, once the ITR receives the original Map-Reply, the
        &lt;nonce,ITR-OTK&gt; pair stored at the ITR will be discarded.
           If a replayed Map-Reply arrives at the ITR, there is no &lt;nonce,ITR-OTK&gt;
   that matches the incoming Map-Reply and the replayed Map-Reply will be
   discarded.<a class="pilcrow" href="#section-7.6-1">¶</a></p>
<p id="section-7.6-2">In the case of a replayed Map-Request, the Map-Server, Map-Resolver, and
        ETR will have to do a LISP-SEC computation. This is equivalent, in terms of resources, to a valid LISP-SEC computation and, beyond a risk of DoS attack, an attacker does not obtain any additional effect, since the corresponding Map-Reply is discarded as previously explained.<a class="pilcrow" href="#section-7.6-2">¶</a></p>
</section>
</div>
<div id="DTLS">
<section id="section-7.7">
        <h3 id="name-message-privacy">
<a class="section-number selfRef" href="#section-7.7">7.7. </a><a class="section-name selfRef" href="#name-message-privacy">Message Privacy</a>
        </h3>
<p id="section-7.7-1">DTLS <span>[<a class="cite xref" href="#RFC9147">RFC9147</a>]</span> <span class="bcp14">SHOULD</span> be used (conforming to <span>[<a class="cite xref" href="#RFC7525">RFC7525</a>]</span>) to provide communication privacy and to prevent eavesdropping, tampering, or message forgery to the messages exchanged between the ITR, Map-Resolver, Map-Server, and ETR, unless the OTK is encrypted in another way, e.g., using a pre-shared secret.  DTLS has the responder be verified by the initiator, which enables an ITR to authenticate the Map-Resolver and the Map-Server to authenticate the responding ETR.<a class="pilcrow" href="#section-7.7-1">¶</a></p>
</section>
</div>
<div id="dos">
<section id="section-7.8">
        <h3 id="name-denial-of-service-and-distr">
<a class="section-number selfRef" href="#section-7.8">7.8. </a><a class="section-name selfRef" href="#name-denial-of-service-and-distr">Denial-of-Service and Distributed Denial-of-Service Attacks</a>
        </h3>
<p id="section-7.8-1">LISP-SEC mitigates the risks of DoS and DDoS attacks by protecting the integrity and
        authenticating the origin of the Map-Request/Map-Reply messages and
        by preventing malicious ETRs from overclaiming EID-Prefixes that could
        redirect traffic directed to a potentially large number of hosts.<a class="pilcrow" href="#section-7.8-1">¶</a></p>
</section>
</div>
</section>
</div>
<div id="IANA">
<section id="section-8">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-8">8. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<p id="section-8-1">IANA has created the subregistries listed in the following sections in the "Locator/ID Separation Protocol (LISP) Parameters" registry.<a class="pilcrow" href="#section-8-1">¶</a></p>
<p id="section-8-2"> For all of the subregistries, new values are assigned according to the Specification Required policy defined in <span>[<a class="cite xref" href="#RFC8126">RFC8126</a>]</span>. Expert Review should assess the security properties of newly added functions so that encryption robustness remains strong. For instance, at the time of this writing, the use of SHA-256-based functions is considered to provide sufficient protection. Consultation with security experts may be needed.<a class="pilcrow" href="#section-8-2">¶</a></p>
<div id="ECM-AD-Type">
<section id="section-8.1">
        <h3 id="name-ecm-ad-type-registry">
<a class="section-number selfRef" href="#section-8.1">8.1. </a><a class="section-name selfRef" href="#name-ecm-ad-type-registry">ECM AD Type Registry</a>
        </h3>
<p id="section-8.1-1">IANA has created the "LISP ECM Authentication Data Types"
        registry with values 0-255 for use in the ECM LISP-SEC extensions
        (see <a class="auto internal xref" href="#ECM_extensions">Section 6.1</a>). Initial allocations are shown in <a class="auto internal xref" href="#tableEADT">Table 2</a>.<a class="pilcrow" href="#section-8.1-1">¶</a></p>
<span id="name-lisp-ecm-authentication-dat"></span><div id="tableEADT">
<table class="center" id="table-2">
          <caption>
<a class="selfRef" href="#table-2">Table 2</a>:
<a class="selfRef" href="#name-lisp-ecm-authentication-dat">LISP ECM Authentication Data Types</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Name</th>
              <th class="text-center" colspan="1" rowspan="1">Number</th>
              <th class="text-left" colspan="1" rowspan="1">Defined in</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">Reserved</td>
              <td class="text-center" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9303</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">LISP-SEC-ECM-EXT</td>
              <td class="text-center" colspan="1" rowspan="1">1</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9303</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-8.1-3">Values 2-255 are unassigned.<a class="pilcrow" href="#section-8.1-3">¶</a></p>
</section>
</div>
<div id="MR-AD-Type">
<section id="section-8.2">
        <h3 id="name-map-reply-ad-types-registry">
<a class="section-number selfRef" href="#section-8.2">8.2. </a><a class="section-name selfRef" href="#name-map-reply-ad-types-registry">Map-Reply AD Types Registry</a>
        </h3>
<p id="section-8.2-1">IANA has created the "LISP Map-Reply Authentication Data
        Types" registry with values 0-255 for use in the Map-Reply LISP-SEC
        extensions (see <a class="auto internal xref" href="#MR_extensions">Section 6.2</a>). Initial allocations are shown in <a class="auto internal xref" href="#tableADT">Table 3</a>.<a class="pilcrow" href="#section-8.2-1">¶</a></p>
<span id="name-map-reply-authentication-da"></span><div id="tableADT">
<table class="center" id="table-3">
          <caption>
<a class="selfRef" href="#table-3">Table 3</a>:
<a class="selfRef" href="#name-map-reply-authentication-da">Map-Reply Authentication Data Types</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Name</th>
              <th class="text-center" colspan="1" rowspan="1">Number</th>
              <th class="text-left" colspan="1" rowspan="1">Defined in</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">Reserved</td>
              <td class="text-center" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9303</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">LISP-SEC-MR-EXT</td>
              <td class="text-center" colspan="1" rowspan="1">1</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9303</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-8.2-3">Values 2-255 are unassigned.<a class="pilcrow" href="#section-8.2-3">¶</a></p>
</section>
</div>
<div id="HMAC">
<section id="section-8.3">
        <h3 id="name-hmac-functions">
<a class="section-number selfRef" href="#section-8.3">8.3. </a><a class="section-name selfRef" href="#name-hmac-functions">HMAC Functions</a>
        </h3>
<p id="section-8.3-1">IANA is requested to create the "LISP-SEC Preferred Authentication Data HMAC IDs" registry with values 0-65535 for use as Requested HMAC IDs, EID HMAC IDs, and PKT HMAC IDs in the LISP-SEC Authentication Data. Initial allocations are shown in <a class="auto internal xref" href="#tableHMACF">Table 4</a>.<a class="pilcrow" href="#section-8.3-1">¶</a></p>
<span id="name-lisp-sec-preferred-authenti"></span><div id="tableHMACF">
<table class="center" id="table-4">
          <caption>
<a class="selfRef" href="#table-4">Table 4</a>:
<a class="selfRef" href="#name-lisp-sec-preferred-authenti">LISP-SEC Preferred Authentication Data HMAC IDs</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Name</th>
              <th class="text-center" colspan="1" rowspan="1">Number</th>
              <th class="text-left" colspan="1" rowspan="1">Defined in</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">NOPREF</td>
              <td class="text-center" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9303</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">AUTH-HMAC-SHA-1-96</td>
              <td class="text-center" colspan="1" rowspan="1">1</td>
              <td class="text-left" colspan="1" rowspan="1">
                <span>[<a class="cite xref" href="#RFC2104">RFC2104</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">AUTH-HMAC-SHA-256-128</td>
              <td class="text-center" colspan="1" rowspan="1">2</td>
              <td class="text-left" colspan="1" rowspan="1">
                <span>[<a class="cite xref" href="#RFC6234">RFC6234</a>]</span>
</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-8.3-3">Values 3-65535 are unassigned.<a class="pilcrow" href="#section-8.3-3">¶</a></p>
</section>
</div>
<div id="wrap">
<section id="section-8.4">
        <h3 id="name-key-wrap-functions">
<a class="section-number selfRef" href="#section-8.4">8.4. </a><a class="section-name selfRef" href="#name-key-wrap-functions">Key Wrap Functions</a>
        </h3>
<p id="section-8.4-1">IANA has created the "LISP-SEC Authentication Data Key
        Wrap IDs" registry with values 0-65535 for use as OTK key wrap
        algorithm IDs in the LISP-SEC Authentication Data. Initial allocations are shown in <a class="auto internal xref" href="#tableKWF">Table 5</a>.<a class="pilcrow" href="#section-8.4-1">¶</a></p>
<span id="name-lisp-sec-authentication-dat"></span><div id="tableKWF">
<table class="center" id="table-5">
          <caption>
<a class="selfRef" href="#table-5">Table 5</a>:
<a class="selfRef" href="#name-lisp-sec-authentication-dat">LISP-SEC Authentication Data Key Wrap IDs</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Name</th>
              <th class="text-center" colspan="1" rowspan="1">Number</th>
              <th class="text-left" colspan="1" rowspan="1">Key Wrap</th>
              <th class="text-left" colspan="1" rowspan="1">KDF</th>
              <th class="text-left" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">Reserved</td>
              <td class="text-center" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">None</td>
              <td class="text-left" colspan="1" rowspan="1">None</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9303</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">NULL-KEY-WRAP-128</td>
              <td class="text-center" colspan="1" rowspan="1">1</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9303</td>
              <td class="text-left" colspan="1" rowspan="1">None</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9303</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">AES-KEY-WRAP-128+HKDF-SHA256</td>
              <td class="text-center" colspan="1" rowspan="1">2</td>
              <td class="text-left" colspan="1" rowspan="1">
                <span>[<a class="cite xref" href="#RFC3394">RFC3394</a>]</span>
</td>
              <td class="text-left" colspan="1" rowspan="1">
                <span>[<a class="cite xref" href="#RFC4868">RFC4868</a>]</span>
</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9303</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-8.4-3">Values 3-65535 are unassigned.<a class="pilcrow" href="#section-8.4-3">¶</a></p>
</section>
</div>
<div id="kdf">
<section id="section-8.5">
        <h3 id="name-key-derivation-functions">
<a class="section-number selfRef" href="#section-8.5">8.5. </a><a class="section-name selfRef" href="#name-key-derivation-functions">Key Derivation Functions</a>
        </h3>
<p id="section-8.5-1">IANA has created the "LISP-SEC Authentication Data Key
        Derivation Function IDs" registry with values 0-65535 for use as KDF IDs.
        Initial allocations are shown in <a class="auto internal xref" href="#tableKDF">Table 6</a>.<a class="pilcrow" href="#section-8.5-1">¶</a></p>
<span id="name-lisp-sec-authentication-data"></span><div id="tableKDF">
<table class="center" id="table-6">
          <caption>
<a class="selfRef" href="#table-6">Table 6</a>:
<a class="selfRef" href="#name-lisp-sec-authentication-data">LISP-SEC Authentication Data Key Derivation Function IDs</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Name</th>
              <th class="text-center" colspan="1" rowspan="1">Number</th>
              <th class="text-center" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">NOPREF</td>
              <td class="text-center" colspan="1" rowspan="1">0</td>
              <td class="text-center" colspan="1" rowspan="1">RFC 9303</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">HKDF-SHA1-128</td>
              <td class="text-center" colspan="1" rowspan="1">1</td>
              <td class="text-center" colspan="1" rowspan="1">
                <span>[<a class="cite xref" href="#RFC5869">RFC5869</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">HKDF-SHA256</td>
              <td class="text-center" colspan="1" rowspan="1">2</td>
              <td class="text-center" colspan="1" rowspan="1">
                <span>[<a class="cite xref" href="#RFC5869">RFC5869</a>]</span>
</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-8.5-3">Values 3-65535 are unassigned.<a class="pilcrow" href="#section-8.5-3">¶</a></p>
</section>
</div>
</section>
</div>
<section id="section-9">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-9">9. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-9.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-9.1">9.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2104">[RFC2104]</dt>
        <dd>
<span class="refAuthor">Krawczyk, H.</span>, <span class="refAuthor">Bellare, M.</span>, and <span class="refAuthor">R. Canetti</span>, <span class="refTitle">"HMAC: Keyed-Hashing for Message Authentication"</span>, <span class="seriesInfo">RFC 2104</span>, <span class="seriesInfo">DOI 10.17487/RFC2104</span>, <time class="refDate" datetime="1997-02">February 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2104">https://www.rfc-editor.org/info/rfc2104</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time class="refDate" datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3394">[RFC3394]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span> and <span class="refAuthor">R. Housley</span>, <span class="refTitle">"Advanced Encryption Standard (AES) Key Wrap Algorithm"</span>, <span class="seriesInfo">RFC 3394</span>, <span class="seriesInfo">DOI 10.17487/RFC3394</span>, <time class="refDate" datetime="2002-09">September 2002</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3394">https://www.rfc-editor.org/info/rfc3394</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4868">[RFC4868]</dt>
        <dd>
<span class="refAuthor">Kelly, S.</span> and <span class="refAuthor">S. Frankel</span>, <span class="refTitle">"Using HMAC-SHA-256, HMAC-SHA-384, and HMAC-SHA-512 with IPsec"</span>, <span class="seriesInfo">RFC 4868</span>, <span class="seriesInfo">DOI 10.17487/RFC4868</span>, <time class="refDate" datetime="2007-05">May 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4868">https://www.rfc-editor.org/info/rfc4868</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5869">[RFC5869]</dt>
        <dd>
<span class="refAuthor">Krawczyk, H.</span> and <span class="refAuthor">P. Eronen</span>, <span class="refTitle">"HMAC-based Extract-and-Expand Key Derivation Function (HKDF)"</span>, <span class="seriesInfo">RFC 5869</span>, <span class="seriesInfo">DOI 10.17487/RFC5869</span>, <time class="refDate" datetime="2010-05">May 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5869">https://www.rfc-editor.org/info/rfc5869</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6234">[RFC6234]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span> and <span class="refAuthor">T. Hansen</span>, <span class="refTitle">"US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)"</span>, <span class="seriesInfo">RFC 6234</span>, <span class="seriesInfo">DOI 10.17487/RFC6234</span>, <time class="refDate" datetime="2011-05">May 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6234">https://www.rfc-editor.org/info/rfc6234</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7525">[RFC7525]</dt>
        <dd>
<span class="refAuthor">Sheffer, Y.</span>, <span class="refAuthor">Holz, R.</span>, and <span class="refAuthor">P. Saint-Andre</span>, <span class="refTitle">"Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"</span>, <span class="seriesInfo">BCP 195</span>, <span class="seriesInfo">RFC 7525</span>, <span class="seriesInfo">DOI 10.17487/RFC7525</span>, <time class="refDate" datetime="2015-05">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7525">https://www.rfc-editor.org/info/rfc7525</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7835">[RFC7835]</dt>
        <dd>
<span class="refAuthor">Saucez, D.</span>, <span class="refAuthor">Iannone, L.</span>, and <span class="refAuthor">O. Bonaventure</span>, <span class="refTitle">"Locator/ID Separation Protocol (LISP) Threat Analysis"</span>, <span class="seriesInfo">RFC 7835</span>, <span class="seriesInfo">DOI 10.17487/RFC7835</span>, <time class="refDate" datetime="2016-04">April 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7835">https://www.rfc-editor.org/info/rfc7835</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time class="refDate" datetime="2017-06">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time class="refDate" datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9147">[RFC9147]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refAuthor">Tschofenig, H.</span>, and <span class="refAuthor">N. Modadugu</span>, <span class="refTitle">"The Datagram Transport Layer Security (DTLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 9147</span>, <span class="seriesInfo">DOI 10.17487/RFC9147</span>, <time class="refDate" datetime="2022-04">April 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9147">https://www.rfc-editor.org/info/rfc9147</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9300">[RFC9300]</dt>
        <dd>
<span class="refAuthor">Farinacci, D.</span>, <span class="refAuthor">Fuller, V.</span>, <span class="refAuthor">Meyer, D.</span>, <span class="refAuthor">Lewis, D.</span>, and <span class="refAuthor">A. Cabellos, Ed.</span>, <span class="refTitle">"The Locator/ID Separation Protocol (LISP)"</span>, <span class="seriesInfo">RFC 9300</span>, <span class="seriesInfo">DOI 10.17487/RFC9300</span>, <time class="refDate" datetime="2022-10">October 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9300">https://www.rfc-editor.org/info/rfc9300</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9301">[RFC9301]</dt>
      <dd>
<span class="refAuthor">Farinacci, D.</span>, <span class="refAuthor">Maino, F.</span>, <span class="refAuthor">Fuller, V.</span>, and <span class="refAuthor">A. Cabellos, Ed.</span>, <span class="refTitle">"Locator/ID Separation Protocol (LISP) Control Plane"</span>, <span class="seriesInfo">RFC 9301</span>, <span class="seriesInfo">DOI 10.17487/RFC9301</span>, <time class="refDate" datetime="2022-10">October 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9301">https://www.rfc-editor.org/info/rfc9301</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-9.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-9.2">9.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC4086">[RFC4086]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refAuthor">Schiller, J.</span>, and <span class="refAuthor">S. Crocker</span>, <span class="refTitle">"Randomness Requirements for Security"</span>, <span class="seriesInfo">BCP 106</span>, <span class="seriesInfo">RFC 4086</span>, <span class="seriesInfo">DOI 10.17487/RFC4086</span>, <time class="refDate" datetime="2005-06">June 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4086">https://www.rfc-editor.org/info/rfc4086</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6836">[RFC6836]</dt>
      <dd>
<span class="refAuthor">Fuller, V.</span>, <span class="refAuthor">Farinacci, D.</span>, <span class="refAuthor">Meyer, D.</span>, and <span class="refAuthor">D. Lewis</span>, <span class="refTitle">"Locator/ID Separation Protocol Alternative Logical Topology (LISP+ALT)"</span>, <span class="seriesInfo">RFC 6836</span>, <span class="seriesInfo">DOI 10.17487/RFC6836</span>, <time class="refDate" datetime="2013-01">January 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6836">https://www.rfc-editor.org/info/rfc6836</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="Acknowledgments">
<section id="appendix-A">
      <h2 id="name-acknowledgments">
<a class="section-name selfRef" href="#name-acknowledgments">Acknowledgments</a>
      </h2>
<p id="appendix-A-1">The authors would like to acknowledge <span class="contact-name">Luigi Iannone</span>, <span class="contact-name">Pere Monclus</span>, <span class="contact-name">Dave Meyer</span>, <span class="contact-name">Dino Farinacci</span>, <span class="contact-name">Brian Weis</span>, <span class="contact-name">David McGrew</span>, <span class="contact-name">Darrel Lewis</span>, and <span class="contact-name">Landon Curt Noll</span> for their valuable suggestions provided during the preparation of this document.<a class="pilcrow" href="#appendix-A-1">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a class="section-name selfRef" href="#name-authors-addresses">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Fabio Maino</span></div>
<div class="left" dir="auto"><span class="org">Cisco Systems</span></div>
<div class="left" dir="auto">
<span class="locality">San Jose</span>, <span class="region">CA</span> </div>
<div class="left" dir="auto"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:fmaino@cisco.com">fmaino@cisco.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Vina Ermagan</span></div>
<div class="left" dir="auto"><span class="org">Google, Inc.</span></div>
<div class="left" dir="auto"><span class="street-address">1600 Amphitheatre Parkway</span></div>
<div class="left" dir="auto">
<span class="locality">Mountain View</span>, <span class="region">CA</span> <span class="postal-code">94043</span>
</div>
<div class="left" dir="auto"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:ermagan@gmail.com">ermagan@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Albert Cabellos</span></div>
<div class="left" dir="auto"><span class="org">Universitat Politecnica de Catalunya</span></div>
<div class="left" dir="auto"><span class="street-address">c/ Jordi Girona s/n</span></div>
<div class="left" dir="auto">
<span class="postal-code">08034</span> <span class="locality">Barcelona</span> </div>
<div class="left" dir="auto"><span class="country-name">Spain</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:acabello@ac.upc.edu">acabello@ac.upc.edu</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Damien Saucez</span></div>
<div class="left" dir="auto"><span class="org">Inria</span></div>
<div class="left" dir="auto"><span class="street-address">2004 route des Lucioles - BP 93</span></div>
<div class="left" dir="auto"><span class="locality">Sophia Antipolis</span></div>
<div class="left" dir="auto"><span class="country-name">France</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:damien.saucez@inria.fr">damien.saucez@inria.fr</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>