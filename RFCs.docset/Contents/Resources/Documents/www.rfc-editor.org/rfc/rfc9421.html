<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 9421: HTTP Message Signatures</title>
<meta content="Annabelle Backman" name="author"/>
<meta content="Justin Richer" name="author"/>
<meta content="Manu Sporny" name="author"/>
<meta content="
       This document describes a mechanism for creating, encoding, and verifying digital signatures or message authentication codes over components of an HTTP message. This mechanism supports use cases where the full HTTP message may not be known to the signer and where the message may be transformed (e.g., by intermediaries) before reaching the verifier.
This document also describes a means for requesting that a signature be applied to a subsequent HTTP message in an ongoing HTTP exchange. 
    " name="description"/>
<meta content="xml2rfc 3.19.4" name="generator"/>
<meta content="PKI" name="keyword"/>
<meta content="9421" name="rfc.number"/>
<!-- Generator version information:
  xml2rfc 3.19.4
    Python 3.9.15
    ConfigArgParse 1.5.3
    google-i18n-address 3.0.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.0
    platformdirs 3.8.0
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.28.0
    setuptools 44.1.1
    six 1.16.0
    wcwidth 0.2.5
    weasyprint 56.1
-->
<link href="rfc9421.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
  overflow-wrap: break-word;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
blockquote > *:last-child {
  margin-bottom: 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://datatracker.ietf.org/doc/draft-ietf-httpbis-message-signatures-19" rel="prev"/>
  <link href="https://dx.doi.org/10.17487/rfc9421" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  </head>
<body class="xml2rfc">
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9421</td>
<td class="center">HTTP Message Signatures</td>
<td class="right">February 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Backman, et al.</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc9421">9421</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2024-02">February 2024</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">A. Backman, <span class="editor">Ed.</span>
</div>
<div class="org">Amazon</div>
</div>
<div class="author">
      <div class="author-name">J. Richer, <span class="editor">Ed.</span>
</div>
<div class="org">Bespoke Engineering</div>
</div>
<div class="author">
      <div class="author-name">M. Sporny</div>
<div class="org">Digital Bazaar</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9421</h1>
<h1 id="title">HTTP Message Signatures</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">This document describes a mechanism for creating, encoding, and verifying digital signatures or message authentication codes over components of an HTTP message. This mechanism supports use cases where the full HTTP message may not be known to the signer and where the message may be transformed (e.g., by intermediaries) before reaching the verifier.
This document also describes a means for requesting that a signature be applied to a subsequent HTTP message in an ongoing HTTP exchange.<a class="pilcrow" href="#section-abstract-1">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a class="pilcrow" href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9421">https://www.rfc-editor.org/info/rfc9421</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">▲</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a class="auto internal xref" href="#section-1">1</a>.  <a class="internal xref" href="#name-introduction">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p class="keepWithNext" id="section-toc.1-1.1.2.1.1"><a class="auto internal xref" href="#section-1.1">1.1</a>.  <a class="internal xref" href="#name-conventions-and-terminology">Conventions and Terminology</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p class="keepWithNext" id="section-toc.1-1.1.2.2.1"><a class="auto internal xref" href="#section-1.2">1.2</a>.  <a class="internal xref" href="#name-requirements">Requirements</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3">
                <p class="keepWithNext" id="section-toc.1-1.1.2.3.1"><a class="auto internal xref" href="#section-1.3">1.3</a>.  <a class="internal xref" href="#name-http-message-transformation">HTTP Message Transformations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.4">
                <p id="section-toc.1-1.1.2.4.1"><a class="auto internal xref" href="#section-1.4">1.4</a>.  <a class="internal xref" href="#name-application-of-http-message">Application of HTTP Message Signatures</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a class="auto internal xref" href="#section-2">2</a>.  <a class="internal xref" href="#name-http-message-components">HTTP Message Components</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a class="auto internal xref" href="#section-2.1">2.1</a>.  <a class="internal xref" href="#name-http-fields">HTTP Fields</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.1">
                    <p id="section-toc.1-1.2.2.1.2.1.1"><a class="auto internal xref" href="#section-2.1.1">2.1.1</a>.  <a class="internal xref" href="#name-strict-serialization-of-htt">Strict Serialization of HTTP Structured Fields</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.2">
                    <p id="section-toc.1-1.2.2.1.2.2.1"><a class="auto internal xref" href="#section-2.1.2">2.1.2</a>.  <a class="internal xref" href="#name-dictionary-structured-field">Dictionary Structured Field Members</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.3">
                    <p id="section-toc.1-1.2.2.1.2.3.1"><a class="auto internal xref" href="#section-2.1.3">2.1.3</a>.  <a class="internal xref" href="#name-binary-wrapped-http-fields">Binary-Wrapped HTTP Fields</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.4">
                    <p id="section-toc.1-1.2.2.1.2.4.1"><a class="auto internal xref" href="#section-2.1.4">2.1.4</a>.  <a class="internal xref" href="#name-trailer-fields">Trailer Fields</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a class="auto internal xref" href="#section-2.2">2.2</a>.  <a class="internal xref" href="#name-derived-components">Derived Components</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.1">
                    <p id="section-toc.1-1.2.2.2.2.1.1"><a class="auto internal xref" href="#section-2.2.1">2.2.1</a>.  <a class="internal xref" href="#name-method">Method</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.2">
                    <p id="section-toc.1-1.2.2.2.2.2.1"><a class="auto internal xref" href="#section-2.2.2">2.2.2</a>.  <a class="internal xref" href="#name-target-uri">Target URI</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.3">
                    <p id="section-toc.1-1.2.2.2.2.3.1"><a class="auto internal xref" href="#section-2.2.3">2.2.3</a>.  <a class="internal xref" href="#name-authority">Authority</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.4">
                    <p id="section-toc.1-1.2.2.2.2.4.1"><a class="auto internal xref" href="#section-2.2.4">2.2.4</a>.  <a class="internal xref" href="#name-scheme">Scheme</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.5">
                    <p id="section-toc.1-1.2.2.2.2.5.1"><a class="auto internal xref" href="#section-2.2.5">2.2.5</a>.  <a class="internal xref" href="#name-request-target">Request Target</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.6">
                    <p id="section-toc.1-1.2.2.2.2.6.1"><a class="auto internal xref" href="#section-2.2.6">2.2.6</a>.  <a class="internal xref" href="#name-path">Path</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.7">
                    <p id="section-toc.1-1.2.2.2.2.7.1"><a class="auto internal xref" href="#section-2.2.7">2.2.7</a>.  <a class="internal xref" href="#name-query">Query</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.8">
                    <p id="section-toc.1-1.2.2.2.2.8.1"><a class="auto internal xref" href="#section-2.2.8">2.2.8</a>.  <a class="internal xref" href="#name-query-parameters">Query Parameters</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.9">
                    <p id="section-toc.1-1.2.2.2.2.9.1"><a class="auto internal xref" href="#section-2.2.9">2.2.9</a>.  <a class="internal xref" href="#name-status-code">Status Code</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a class="auto internal xref" href="#section-2.3">2.3</a>.  <a class="internal xref" href="#name-signature-parameters">Signature Parameters</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a class="auto internal xref" href="#section-2.4">2.4</a>.  <a class="internal xref" href="#name-signing-request-components-">Signing Request Components in a Response Message</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.5">
                <p id="section-toc.1-1.2.2.5.1"><a class="auto internal xref" href="#section-2.5">2.5</a>.  <a class="internal xref" href="#name-creating-the-signature-base">Creating the Signature Base</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a class="auto internal xref" href="#section-3">3</a>.  <a class="internal xref" href="#name-http-message-signatures">HTTP Message Signatures</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a class="auto internal xref" href="#section-3.1">3.1</a>.  <a class="internal xref" href="#name-creating-a-signature">Creating a Signature</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a class="auto internal xref" href="#section-3.2">3.2</a>.  <a class="internal xref" href="#name-verifying-a-signature">Verifying a Signature</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a class="auto internal xref" href="#section-3.2.1">3.2.1</a>.  <a class="internal xref" href="#name-enforcing-application-requi">Enforcing Application Requirements</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a class="auto internal xref" href="#section-3.3">3.3</a>.  <a class="internal xref" href="#name-signature-algorithms">Signature Algorithms</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.1">
                    <p id="section-toc.1-1.3.2.3.2.1.1"><a class="auto internal xref" href="#section-3.3.1">3.3.1</a>.  <a class="internal xref" href="#name-rsassa-pss-using-sha-512">RSASSA-PSS Using SHA-512</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.2">
                    <p id="section-toc.1-1.3.2.3.2.2.1"><a class="auto internal xref" href="#section-3.3.2">3.3.2</a>.  <a class="internal xref" href="#name-rsassa-pkcs1-v1_5-using-sha">RSASSA-PKCS1-v1_5 Using SHA-256</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.3">
                    <p id="section-toc.1-1.3.2.3.2.3.1"><a class="auto internal xref" href="#section-3.3.3">3.3.3</a>.  <a class="internal xref" href="#name-hmac-using-sha-256">HMAC Using SHA-256</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.4">
                    <p id="section-toc.1-1.3.2.3.2.4.1"><a class="auto internal xref" href="#section-3.3.4">3.3.4</a>.  <a class="internal xref" href="#name-ecdsa-using-curve-p-256-dss">ECDSA Using Curve P-256 DSS and SHA-256</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.5">
                    <p id="section-toc.1-1.3.2.3.2.5.1"><a class="auto internal xref" href="#section-3.3.5">3.3.5</a>.  <a class="internal xref" href="#name-ecdsa-using-curve-p-384-dss">ECDSA Using Curve P-384 DSS and SHA-384</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.6">
                    <p id="section-toc.1-1.3.2.3.2.6.1"><a class="auto internal xref" href="#section-3.3.6">3.3.6</a>.  <a class="internal xref" href="#name-eddsa-using-curve-edwards25">EdDSA Using Curve edwards25519</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.7">
                    <p id="section-toc.1-1.3.2.3.2.7.1"><a class="auto internal xref" href="#section-3.3.7">3.3.7</a>.  <a class="internal xref" href="#name-json-web-signature-jws-algo">JSON Web Signature (JWS) Algorithms</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="auto internal xref" href="#section-4">4</a>.  <a class="internal xref" href="#name-including-a-message-signatu">Including a Message Signature in a Message</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a class="auto internal xref" href="#section-4.1">4.1</a>.  <a class="internal xref" href="#name-the-signature-input-http-fi">The Signature-Input HTTP Field</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a class="auto internal xref" href="#section-4.2">4.2</a>.  <a class="internal xref" href="#name-the-signature-http-field">The Signature HTTP Field</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a class="auto internal xref" href="#section-4.3">4.3</a>.  <a class="internal xref" href="#name-multiple-signatures">Multiple Signatures</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="auto internal xref" href="#section-5">5</a>.  <a class="internal xref" href="#name-requesting-signatures">Requesting Signatures</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a class="auto internal xref" href="#section-5.1">5.1</a>.  <a class="internal xref" href="#name-the-accept-signature-field">The Accept-Signature Field</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a class="auto internal xref" href="#section-5.2">5.2</a>.  <a class="internal xref" href="#name-processing-an-accept-signat">Processing an Accept-Signature</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="auto internal xref" href="#section-6">6</a>.  <a class="internal xref" href="#name-iana-considerations">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a class="auto internal xref" href="#section-6.1">6.1</a>.  <a class="internal xref" href="#name-http-field-name-registratio">HTTP Field Name Registration</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a class="auto internal xref" href="#section-6.2">6.2</a>.  <a class="internal xref" href="#name-http-signature-algorithms-r">HTTP Signature Algorithms Registry</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.1">
                    <p id="section-toc.1-1.6.2.2.2.1.1"><a class="auto internal xref" href="#section-6.2.1">6.2.1</a>.  <a class="internal xref" href="#name-registration-template">Registration Template</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.2">
                    <p id="section-toc.1-1.6.2.2.2.2.1"><a class="auto internal xref" href="#section-6.2.2">6.2.2</a>.  <a class="internal xref" href="#name-initial-contents">Initial Contents</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a class="auto internal xref" href="#section-6.3">6.3</a>.  <a class="internal xref" href="#name-http-signature-metadata-par">HTTP Signature Metadata Parameters Registry</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3.2.1">
                    <p id="section-toc.1-1.6.2.3.2.1.1"><a class="auto internal xref" href="#section-6.3.1">6.3.1</a>.  <a class="internal xref" href="#name-registration-template-2">Registration Template</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3.2.2">
                    <p id="section-toc.1-1.6.2.3.2.2.1"><a class="auto internal xref" href="#section-6.3.2">6.3.2</a>.  <a class="internal xref" href="#name-initial-contents-2">Initial Contents</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a class="auto internal xref" href="#section-6.4">6.4</a>.  <a class="internal xref" href="#name-http-signature-derived-comp">HTTP Signature Derived Component Names Registry</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4.2.1">
                    <p id="section-toc.1-1.6.2.4.2.1.1"><a class="auto internal xref" href="#section-6.4.1">6.4.1</a>.  <a class="internal xref" href="#name-registration-template-3">Registration Template</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4.2.2">
                    <p id="section-toc.1-1.6.2.4.2.2.1"><a class="auto internal xref" href="#section-6.4.2">6.4.2</a>.  <a class="internal xref" href="#name-initial-contents-3">Initial Contents</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5">
                <p id="section-toc.1-1.6.2.5.1"><a class="auto internal xref" href="#section-6.5">6.5</a>.  <a class="internal xref" href="#name-http-signature-component-pa">HTTP Signature Component Parameters Registry</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5.2.1">
                    <p id="section-toc.1-1.6.2.5.2.1.1"><a class="auto internal xref" href="#section-6.5.1">6.5.1</a>.  <a class="internal xref" href="#name-registration-template-4">Registration Template</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5.2.2">
                    <p id="section-toc.1-1.6.2.5.2.2.1"><a class="auto internal xref" href="#section-6.5.2">6.5.2</a>.  <a class="internal xref" href="#name-initial-contents-4">Initial Contents</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="auto internal xref" href="#section-7">7</a>.  <a class="internal xref" href="#name-security-considerations">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a class="auto internal xref" href="#section-7.1">7.1</a>.  <a class="internal xref" href="#name-general-considerations">General Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1.2.1">
                    <p id="section-toc.1-1.7.2.1.2.1.1"><a class="auto internal xref" href="#section-7.1.1">7.1.1</a>.  <a class="internal xref" href="#name-skipping-signature-verifica">Skipping Signature Verification</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1.2.2">
                    <p id="section-toc.1-1.7.2.1.2.2.1"><a class="auto internal xref" href="#section-7.1.2">7.1.2</a>.  <a class="internal xref" href="#name-use-of-tls">Use of TLS</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a class="auto internal xref" href="#section-7.2">7.2</a>.  <a class="internal xref" href="#name-message-processing-and-sele">Message Processing and Selection</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.1">
                    <p id="section-toc.1-1.7.2.2.2.1.1"><a class="auto internal xref" href="#section-7.2.1">7.2.1</a>.  <a class="internal xref" href="#name-insufficient-coverage">Insufficient Coverage</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.2">
                    <p id="section-toc.1-1.7.2.2.2.2.1"><a class="auto internal xref" href="#section-7.2.2">7.2.2</a>.  <a class="internal xref" href="#name-signature-replay">Signature Replay</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.3">
                    <p id="section-toc.1-1.7.2.2.2.3.1"><a class="auto internal xref" href="#section-7.2.3">7.2.3</a>.  <a class="internal xref" href="#name-choosing-message-components">Choosing Message Components</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.4">
                    <p id="section-toc.1-1.7.2.2.2.4.1"><a class="auto internal xref" href="#section-7.2.4">7.2.4</a>.  <a class="internal xref" href="#name-choosing-signature-paramete">Choosing Signature Parameters and Derived Components over HTTP Fields</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.5">
                    <p id="section-toc.1-1.7.2.2.2.5.1"><a class="auto internal xref" href="#section-7.2.5">7.2.5</a>.  <a class="internal xref" href="#name-signature-labels">Signature Labels</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.6">
                    <p id="section-toc.1-1.7.2.2.2.6.1"><a class="auto internal xref" href="#section-7.2.6">7.2.6</a>.  <a class="internal xref" href="#name-multiple-signature-confusio">Multiple Signature Confusion</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.7">
                    <p id="section-toc.1-1.7.2.2.2.7.1"><a class="auto internal xref" href="#section-7.2.7">7.2.7</a>.  <a class="internal xref" href="#name-collision-of-application-sp">Collision of Application-Specific Signature Tag</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.8">
                    <p id="section-toc.1-1.7.2.2.2.8.1"><a class="auto internal xref" href="#section-7.2.8">7.2.8</a>.  <a class="internal xref" href="#name-message-content">Message Content</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a class="auto internal xref" href="#section-7.3">7.3</a>.  <a class="internal xref" href="#name-cryptographic-consideration">Cryptographic Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.1">
                    <p id="section-toc.1-1.7.2.3.2.1.1"><a class="auto internal xref" href="#section-7.3.1">7.3.1</a>.  <a class="internal xref" href="#name-cryptography-and-signature-">Cryptography and Signature Collision</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.2">
                    <p id="section-toc.1-1.7.2.3.2.2.1"><a class="auto internal xref" href="#section-7.3.2">7.3.2</a>.  <a class="internal xref" href="#name-key-theft">Key Theft</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.3">
                    <p id="section-toc.1-1.7.2.3.2.3.1"><a class="auto internal xref" href="#section-7.3.3">7.3.3</a>.  <a class="internal xref" href="#name-symmetric-cryptography">Symmetric Cryptography</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.4">
                    <p id="section-toc.1-1.7.2.3.2.4.1"><a class="auto internal xref" href="#section-7.3.4">7.3.4</a>.  <a class="internal xref" href="#name-key-specification-mixup">Key Specification Mixup</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.5">
                    <p id="section-toc.1-1.7.2.3.2.5.1"><a class="auto internal xref" href="#section-7.3.5">7.3.5</a>.  <a class="internal xref" href="#name-non-deterministic-signature">Non-deterministic Signature Primitives</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.6">
                    <p id="section-toc.1-1.7.2.3.2.6.1"><a class="auto internal xref" href="#section-7.3.6">7.3.6</a>.  <a class="internal xref" href="#name-key-and-algorithm-specifica">Key and Algorithm Specification Downgrades</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.7">
                    <p id="section-toc.1-1.7.2.3.2.7.1"><a class="auto internal xref" href="#section-7.3.7">7.3.7</a>.  <a class="internal xref" href="#name-signing-signature-values">Signing Signature Values</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a class="auto internal xref" href="#section-7.4">7.4</a>.  <a class="internal xref" href="#name-matching-signature-paramete">Matching Signature Parameters to the Target Message</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4.2.1">
                    <p id="section-toc.1-1.7.2.4.2.1.1"><a class="auto internal xref" href="#section-7.4.1">7.4.1</a>.  <a class="internal xref" href="#name-modification-of-required-me">Modification of Required Message Parameters</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4.2.2">
                    <p id="section-toc.1-1.7.2.4.2.2.1"><a class="auto internal xref" href="#section-7.4.2">7.4.2</a>.  <a class="internal xref" href="#name-matching-values-of-covered-">Matching Values of Covered Components to Values in the Target Message</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4.2.3">
                    <p id="section-toc.1-1.7.2.4.2.3.1"><a class="auto internal xref" href="#section-7.4.3">7.4.3</a>.  <a class="internal xref" href="#name-message-component-source-an">Message Component Source and Context</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4.2.4">
                    <p id="section-toc.1-1.7.2.4.2.4.1"><a class="auto internal xref" href="#section-7.4.4">7.4.4</a>.  <a class="internal xref" href="#name-multiple-message-component-">Multiple Message Component Contexts</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5">
                <p id="section-toc.1-1.7.2.5.1"><a class="auto internal xref" href="#section-7.5">7.5</a>.  <a class="internal xref" href="#name-http-processing">HTTP Processing</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5.2.1">
                    <p id="section-toc.1-1.7.2.5.2.1.1"><a class="auto internal xref" href="#section-7.5.1">7.5.1</a>.  <a class="internal xref" href="#name-processing-invalid-http-fie">Processing Invalid HTTP Field Names as Derived Component Names</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5.2.2">
                    <p id="section-toc.1-1.7.2.5.2.2.1"><a class="auto internal xref" href="#section-7.5.2">7.5.2</a>.  <a class="internal xref" href="#name-semantically-equivalent-fie">Semantically Equivalent Field Values</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5.2.3">
                    <p id="section-toc.1-1.7.2.5.2.3.1"><a class="auto internal xref" href="#section-7.5.3">7.5.3</a>.  <a class="internal xref" href="#name-parsing-structured-field-va">Parsing Structured Field Values</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5.2.4">
                    <p id="section-toc.1-1.7.2.5.2.4.1"><a class="auto internal xref" href="#section-7.5.4">7.5.4</a>.  <a class="internal xref" href="#name-http-versions-and-component">HTTP Versions and Component Ambiguity</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5.2.5">
                    <p id="section-toc.1-1.7.2.5.2.5.1"><a class="auto internal xref" href="#section-7.5.5">7.5.5</a>.  <a class="internal xref" href="#name-canonicalization-attacks">Canonicalization Attacks</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5.2.6">
                    <p id="section-toc.1-1.7.2.5.2.6.1"><a class="auto internal xref" href="#section-7.5.6">7.5.6</a>.  <a class="internal xref" href="#name-non-list-field-values">Non-List Field Values</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5.2.7">
                    <p id="section-toc.1-1.7.2.5.2.7.1"><a class="auto internal xref" href="#section-7.5.7">7.5.7</a>.  <a class="internal xref" href="#name-padding-attacks-with-multip">Padding Attacks with Multiple Field Values</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5.2.8">
                    <p id="section-toc.1-1.7.2.5.2.8.1"><a class="auto internal xref" href="#section-7.5.8">7.5.8</a>.  <a class="internal xref" href="#name-ambiguous-handling-of-query">Ambiguous Handling of Query Elements</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="auto internal xref" href="#section-8">8</a>.  <a class="internal xref" href="#name-privacy-considerations">Privacy Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a class="auto internal xref" href="#section-8.1">8.1</a>.  <a class="internal xref" href="#name-identification-through-keys">Identification through Keys</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a class="auto internal xref" href="#section-8.2">8.2</a>.  <a class="internal xref" href="#name-signatures-do-not-provide-c">Signatures do not provide confidentiality</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a class="auto internal xref" href="#section-8.3">8.3</a>.  <a class="internal xref" href="#name-oracles">Oracles</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4">
                <p id="section-toc.1-1.8.2.4.1"><a class="auto internal xref" href="#section-8.4">8.4</a>.  <a class="internal xref" href="#name-required-content">Required Content</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="auto internal xref" href="#section-9">9</a>.  <a class="internal xref" href="#name-references">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a class="auto internal xref" href="#section-9.1">9.1</a>.  <a class="internal xref" href="#name-normative-references">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a class="auto internal xref" href="#section-9.2">9.2</a>.  <a class="internal xref" href="#name-informative-references">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a class="auto internal xref" href="#appendix-A">Appendix A</a>.  <a class="internal xref" href="#name-detecting-http-message-sign">Detecting HTTP Message Signatures</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a class="auto internal xref" href="#appendix-B">Appendix B</a>.  <a class="internal xref" href="#name-examples">Examples</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a class="auto internal xref" href="#appendix-B.1">B.1</a>.  <a class="internal xref" href="#name-example-keys">Example Keys</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1.2.1">
                    <p id="section-toc.1-1.11.2.1.2.1.1"><a class="auto internal xref" href="#appendix-B.1.1">B.1.1</a>.  <a class="internal xref" href="#name-example-rsa-key">Example RSA Key</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1.2.2">
                    <p id="section-toc.1-1.11.2.1.2.2.1"><a class="auto internal xref" href="#appendix-B.1.2">B.1.2</a>.  <a class="internal xref" href="#name-example-rsa-pss-key">Example RSA-PSS Key</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1.2.3">
                    <p id="section-toc.1-1.11.2.1.2.3.1"><a class="auto internal xref" href="#appendix-B.1.3">B.1.3</a>.  <a class="internal xref" href="#name-example-ecc-p-256-test-key">Example ECC P-256 Test Key</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1.2.4">
                    <p id="section-toc.1-1.11.2.1.2.4.1"><a class="auto internal xref" href="#appendix-B.1.4">B.1.4</a>.  <a class="internal xref" href="#name-example-ed25519-test-key">Example Ed25519 Test Key</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1.2.5">
                    <p id="section-toc.1-1.11.2.1.2.5.1"><a class="auto internal xref" href="#appendix-B.1.5">B.1.5</a>.  <a class="internal xref" href="#name-example-shared-secret">Example Shared Secret</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a class="auto internal xref" href="#appendix-B.2">B.2</a>.  <a class="internal xref" href="#name-test-cases">Test Cases</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2.2.1">
                    <p id="section-toc.1-1.11.2.2.2.1.1"><a class="auto internal xref" href="#appendix-B.2.1">B.2.1</a>.  <a class="internal xref" href="#name-minimal-signature-using-rsa">Minimal Signature Using rsa-pss-sha512</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2.2.2">
                    <p id="section-toc.1-1.11.2.2.2.2.1"><a class="auto internal xref" href="#appendix-B.2.2">B.2.2</a>.  <a class="internal xref" href="#name-selective-covered-component">Selective Covered Components Using rsa-pss-sha512</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2.2.3">
                    <p id="section-toc.1-1.11.2.2.2.3.1"><a class="auto internal xref" href="#appendix-B.2.3">B.2.3</a>.  <a class="internal xref" href="#name-full-coverage-using-rsa-pss">Full Coverage Using rsa-pss-sha512</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2.2.4">
                    <p id="section-toc.1-1.11.2.2.2.4.1"><a class="auto internal xref" href="#appendix-B.2.4">B.2.4</a>.  <a class="internal xref" href="#name-signing-a-response-using-ec">Signing a Response Using ecdsa-p256-sha256</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2.2.5">
                    <p id="section-toc.1-1.11.2.2.2.5.1"><a class="auto internal xref" href="#appendix-B.2.5">B.2.5</a>.  <a class="internal xref" href="#name-signing-a-request-using-hma">Signing a Request Using hmac-sha256</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2.2.6">
                    <p id="section-toc.1-1.11.2.2.2.6.1"><a class="auto internal xref" href="#appendix-B.2.6">B.2.6</a>.  <a class="internal xref" href="#name-signing-a-request-using-ed2">Signing a Request Using ed25519</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.3">
                <p id="section-toc.1-1.11.2.3.1"><a class="auto internal xref" href="#appendix-B.3">B.3</a>.  <a class="internal xref" href="#name-tls-terminating-proxies">TLS-Terminating Proxies</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.4">
                <p id="section-toc.1-1.11.2.4.1"><a class="auto internal xref" href="#appendix-B.4">B.4</a>.  <a class="internal xref" href="#name-http-message-transformations">HTTP Message Transformations</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a class="auto internal xref" href="#appendix-C"></a><a class="internal xref" href="#name-acknowledgements">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a class="auto internal xref" href="#appendix-D"></a><a class="internal xref" href="#name-authors-addresses">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="intro">
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">Message integrity and authenticity are security properties that are critical to the secure operation of many HTTP applications.
Application developers typically rely on the transport layer to provide these properties, by operating their application over TLS <span>[<a class="cite xref" href="#RFC8446">TLS</a>]</span>. However, TLS only guarantees these properties over a single TLS connection, and the path between the client and application may be composed of multiple independent TLS connections (for example, if the application is hosted behind a TLS-terminating gateway or if the client is behind a TLS Inspection appliance). In such cases, TLS cannot guarantee end-to-end message integrity or authenticity between the client and application. Additionally, some operating environments present obstacles that make it impractical to use TLS (such as the presentation of client certificates from a browser) or to use features necessary to provide message authenticity. Furthermore, some applications require the binding of a higher-level application-specific key to the HTTP message, separate from any TLS certificates in use. Consequently, while TLS can meet message integrity and authenticity needs for many HTTP-based applications, it is not a universal solution.<a class="pilcrow" href="#section-1-1">¶</a></p>
<p id="section-1-2">Additionally, many applications need to be able to generate and verify signatures despite incomplete knowledge of the HTTP message as seen on the wire, due to the use of libraries, proxies, or application frameworks that alter or hide portions of the message from the application at the time of signing or verification. These applications need a means to protect the parts of the message that are most relevant to the application without having to violate layering and abstraction.<a class="pilcrow" href="#section-1-2">¶</a></p>
<p id="section-1-3">Finally, object-based signature mechanisms such as JSON Web Signature <span>[<a class="cite xref" href="#RFC7515">JWS</a>]</span> require the intact conveyance of the exact information that was signed. When applying such technologies to an HTTP message, elements of the HTTP message need to be duplicated in the object payload either directly or through the inclusion of a hash. This practice introduces complexity, since the repeated information needs to be carefully checked for consistency when the signature is verified.<a class="pilcrow" href="#section-1-3">¶</a></p>
<p id="section-1-4">This document defines a mechanism for providing end-to-end integrity and authenticity for components of an HTTP message by using a detached signature on HTTP messages. The mechanism allows applications to create digital signatures or message authentication codes (MACs) over only the components of the message that are meaningful and appropriate for the application. Strict canonicalization rules ensure that the verifier can verify the signature even if the message has been transformed in many of the ways permitted by HTTP.<a class="pilcrow" href="#section-1-4">¶</a></p>
<p id="section-1-5">The signing mechanism described in this document consists of three parts:<a class="pilcrow" href="#section-1-5">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-6.1">A common nomenclature and canonicalization rule set for the different protocol elements and other components of HTTP messages, used to create the signature base (<a class="auto internal xref" href="#covered-components">Section 2</a>).<a class="pilcrow" href="#section-1-6.1">¶</a>
</li>
        <li class="normal" id="section-1-6.2">Algorithms for generating and verifying signatures over HTTP message components using this signature base through the application of cryptographic primitives (<a class="auto internal xref" href="#message-signatures">Section 3</a>).<a class="pilcrow" href="#section-1-6.2">¶</a>
</li>
        <li class="normal" id="section-1-6.3">A mechanism for attaching a signature and related metadata to an HTTP message and for parsing attached signatures and metadata from HTTP messages. To facilitate this, this document defines the "Signature-Input" and "Signature" fields (<a class="auto internal xref" href="#attach-signature">Section 4</a>).<a class="pilcrow" href="#section-1-6.3">¶</a>
</li>
      </ul>
<p id="section-1-7">This document also provides a mechanism for negotiating the use of signatures in one or more subsequent messages via the "Accept-Signature" field (<a class="auto internal xref" href="#request-signature">Section 5</a>). This optional negotiation mechanism can be used along with opportunistic or application-driven message signatures by either party.<a class="pilcrow" href="#section-1-7">¶</a></p>
<p id="section-1-8">The mechanisms defined in this document are important tools that can be used to build an overall security mechanism for an application. This toolkit provides some powerful capabilities but is not sufficient in creating an overall security story. In particular, the requirements listed in <a class="auto internal xref" href="#application">Section 1.4</a> and the security considerations discussed in <a class="auto internal xref" href="#security">Section 7</a> are of high importance to all implementors of this specification. For example, this specification does not define a means to directly cover HTTP message content (defined in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc9110#section-6.4">Section 6.4</a> of [<a class="cite xref" href="#RFC9110">HTTP</a>]</span>); rather, it relies on the Digest specification <span>[<a class="cite xref" href="#RFC9530">DIGEST</a>]</span> to provide a hash of the message content, as discussed in <a class="auto internal xref" href="#security-message-content">Section 7.2.8</a>.<a class="pilcrow" href="#section-1-8">¶</a></p>
<div id="definitions">
<section id="section-1.1">
        <h3 id="name-conventions-and-terminology">
<a class="section-number selfRef" href="#section-1.1">1.1. </a><a class="section-name selfRef" href="#name-conventions-and-terminology">Conventions and Terminology</a>
        </h3>
<p id="section-1.1-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>",
        "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>",
        "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>",
        "<span class="bcp14">SHOULD NOT</span>",
        "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
        "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document
        are to be interpreted as described in BCP 14
        <span>[<a class="cite xref" href="#RFC2119">RFC2119</a>]</span> <span>[<a class="cite xref" href="#RFC8174">RFC8174</a>]</span> when, and only
        when, they appear in all capitals, as shown here.<a class="pilcrow" href="#section-1.1-1">¶</a></p>
<p id="section-1.1-2">The terms "HTTP message", "HTTP request", "HTTP response",
"target URI", "gateway", "header field", "intermediary", "request target",
"trailer field", "sender", "method", and "recipient" are used as defined in <span>[<a class="cite xref" href="#RFC9110">HTTP</a>]</span>.<a class="pilcrow" href="#section-1.1-2">¶</a></p>
<p id="section-1.1-3">For brevity, the term "signature" on its own is used in this document to refer to both digital signatures (which use asymmetric cryptography) and keyed MACs (which use symmetric cryptography). Similarly, the verb "sign" refers to the generation of either a digital signature or keyed MAC over a given signature base. The qualified term "digital signature" refers specifically to the output of an asymmetric cryptographic signing operation.<a class="pilcrow" href="#section-1.1-3">¶</a></p>
<p id="section-1.1-4">This document uses the following terminology from <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8941#section-3">Section 3</a> of [<a class="cite xref" href="#RFC8941">STRUCTURED-FIELDS</a>]</span>
to specify data types: List, Inner List, Dictionary, Item, String, Integer, Byte Sequence, and Boolean.<a class="pilcrow" href="#section-1.1-4">¶</a></p>
<p id="section-1.1-5">This document defines several string constructions using ABNF <span>[<a class="cite xref" href="#RFC5234">ABNF</a>]</span> and uses the following ABNF rules: <code>VCHAR</code>, <code>SP</code>, <code>DQUOTE</code>, and <code>LF</code>. This document uses the following ABNF rules from <span>[<a class="cite xref" href="#RFC8941">STRUCTURED-FIELDS</a>]</span>: <code>sf-string</code>, <code>inner-list</code>, and <code>parameters</code>. This document uses the following ABNF rules from <span>[<a class="cite xref" href="#RFC9110">HTTP</a>]</span> and <span>[<a class="cite xref" href="#RFC9112">HTTP/1.1</a>]</span>: <code>field-content</code>, <code>obs-fold</code>, and <code>obs-text</code>.<a class="pilcrow" href="#section-1.1-5">¶</a></p>
<p id="section-1.1-6">In addition to those listed above, this document uses the following terms:<a class="pilcrow" href="#section-1.1-6">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-1.1-7">
          <dt id="section-1.1-7.1">HTTP Message Signature:</dt>
          <dd id="section-1.1-7.2" style="margin-left: 1.5em">
            <p id="section-1.1-7.2.1">A digital signature or keyed MAC that covers one or more portions of an HTTP message. Note that a given HTTP message can contain multiple HTTP message signatures.<a class="pilcrow" href="#section-1.1-7.2.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-7.3">Signer:</dt>
          <dd id="section-1.1-7.4" style="margin-left: 1.5em">
            <p id="section-1.1-7.4.1">The entity that is generating or has generated an HTTP message signature. Note that multiple entities can act as signers and apply separate HTTP message signatures to a given HTTP message.<a class="pilcrow" href="#section-1.1-7.4.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-7.5">Verifier:</dt>
          <dd id="section-1.1-7.6" style="margin-left: 1.5em">
            <p id="section-1.1-7.6.1">An entity that is verifying or has verified an HTTP message signature against an HTTP message. Note that an HTTP message signature may be verified multiple times, potentially by different entities.<a class="pilcrow" href="#section-1.1-7.6.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-7.7">HTTP Message Component:</dt>
          <dd id="section-1.1-7.8" style="margin-left: 1.5em">
            <p id="section-1.1-7.8.1">A portion of an HTTP message that is capable of being covered by an HTTP message signature.<a class="pilcrow" href="#section-1.1-7.8.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-7.9">Derived Component:</dt>
          <dd id="section-1.1-7.10" style="margin-left: 1.5em">
            <p id="section-1.1-7.10.1">An HTTP message component derived from the HTTP message through the use of a specified algorithm or process. See <a class="auto internal xref" href="#derived-components">Section 2.2</a>.<a class="pilcrow" href="#section-1.1-7.10.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-7.11">HTTP Message Component Name:</dt>
          <dd id="section-1.1-7.12" style="margin-left: 1.5em">
            <p id="section-1.1-7.12.1">A String that identifies an HTTP message component's source, such as a field name or derived component name.<a class="pilcrow" href="#section-1.1-7.12.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-7.13">HTTP Message Component Identifier:</dt>
          <dd id="section-1.1-7.14" style="margin-left: 1.5em">
            <p id="section-1.1-7.14.1">The combination of an HTTP message component name and any parameters. This combination uniquely identifies a specific HTTP message component with respect to a particular HTTP message signature and the HTTP message it applies to.<a class="pilcrow" href="#section-1.1-7.14.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-7.15">HTTP Message Component Value:</dt>
          <dd id="section-1.1-7.16" style="margin-left: 1.5em">
            <p id="section-1.1-7.16.1">The value associated with a given component identifier within the context of a particular HTTP message. Component values are derived from the HTTP message and are usually subject to a canonicalization process.<a class="pilcrow" href="#section-1.1-7.16.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-7.17">Covered Components:</dt>
          <dd id="section-1.1-7.18" style="margin-left: 1.5em">
            <p id="section-1.1-7.18.1">An ordered set of HTTP message component identifiers for fields (<a class="auto internal xref" href="#http-fields">Section 2.1</a>) and derived components (<a class="auto internal xref" href="#derived-components">Section 2.2</a>) that indicates the set of message components covered by the signature, never including the <code>@signature-params</code> identifier itself. The order of this set is preserved and communicated between the signer and verifier to facilitate reconstruction of the signature base.<a class="pilcrow" href="#section-1.1-7.18.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-7.19">Signature Base:</dt>
          <dd id="section-1.1-7.20" style="margin-left: 1.5em">
            <p id="section-1.1-7.20.1">The sequence of bytes generated by the signer and verifier using the covered components set and the HTTP message. The signature base is processed by the cryptographic algorithm to produce or verify the HTTP message signature.<a class="pilcrow" href="#section-1.1-7.20.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-7.21">HTTP Message Signature Algorithm:</dt>
          <dd id="section-1.1-7.22" style="margin-left: 1.5em">
            <p id="section-1.1-7.22.1">A cryptographic algorithm that describes the signing and verification process for the signature, defined in terms of the <code>HTTP_SIGN</code> and <code>HTTP_VERIFY</code> primitives described in <a class="auto internal xref" href="#signature-methods">Section 3.3</a>.<a class="pilcrow" href="#section-1.1-7.22.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-7.23">Key Material:</dt>
          <dd id="section-1.1-7.24" style="margin-left: 1.5em">
            <p id="section-1.1-7.24.1">The key material required to create or verify the signature. The key material is often identified with an explicit key identifier, allowing the signer to indicate to the verifier which key was used.<a class="pilcrow" href="#section-1.1-7.24.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-7.25">Creation Time:</dt>
          <dd id="section-1.1-7.26" style="margin-left: 1.5em">
            <p id="section-1.1-7.26.1">A timestamp representing the point in time that the signature was generated, as asserted by the signer.<a class="pilcrow" href="#section-1.1-7.26.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-7.27">Expiration Time:</dt>
          <dd id="section-1.1-7.28" style="margin-left: 1.5em">
            <p id="section-1.1-7.28.1">A timestamp representing the point in time after which the signature should no longer be accepted by the verifier, as asserted by the signer.<a class="pilcrow" href="#section-1.1-7.28.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-7.29">Target Message:</dt>
          <dd id="section-1.1-7.30" style="margin-left: 1.5em">
            <p id="section-1.1-7.30.1">The HTTP message to which an HTTP message signature is applied.<a class="pilcrow" href="#section-1.1-7.30.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-7.31">Signature Context:</dt>
          <dd id="section-1.1-7.32" style="margin-left: 1.5em">
            <p id="section-1.1-7.32.1">The data source from which the HTTP message component values are drawn. The context includes the target message and any additional information the signer or verifier might have, such as the full target URI of a request or the related request message for a response.<a class="pilcrow" href="#section-1.1-7.32.1">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-1.1-8">The term "UNIX timestamp" refers to what Section 4.16 of <span>[<a class="cite xref" href="#POSIX">POSIX.1</a>]</span> calls "seconds since the Epoch".<a class="pilcrow" href="#section-1.1-8">¶</a></p>
<p id="section-1.1-9">This document contains non-normative examples of partial and complete HTTP messages. Some examples use a single trailing backslash (<code>\</code>) to indicate line wrapping for long values, as per <span>[<a class="cite xref" href="#RFC8792">RFC8792</a>]</span>. The <code>\</code> character and leading spaces on wrapped lines are not part of the value.<a class="pilcrow" href="#section-1.1-9">¶</a></p>
</section>
</div>
<div id="requirements">
<section id="section-1.2">
        <h3 id="name-requirements">
<a class="section-number selfRef" href="#section-1.2">1.2. </a><a class="section-name selfRef" href="#name-requirements">Requirements</a>
        </h3>
<p id="section-1.2-1">HTTP permits, and sometimes requires, intermediaries to transform messages in a variety of ways. This can result in a recipient receiving a message that is not bitwise-equivalent to the message that was originally sent. In such a case, the recipient will be unable to verify integrity protections over the raw bytes of the sender's HTTP message, as verifying digital signatures or MACs requires both signer and verifier to have the exact same signature base. Since the exact raw bytes of the message cannot be relied upon as a reliable source for a signature base, the signer and verifier have to independently create the signature base from their respective versions of the message, via a mechanism that is resilient to safe changes that do not alter the meaning of the message.<a class="pilcrow" href="#section-1.2-1">¶</a></p>
<p id="section-1.2-2">For a variety of reasons, it is impractical to strictly define what constitutes a safe change versus an unsafe one. Applications use HTTP in a wide variety of ways and may disagree on whether a particular piece of information in a message (e.g., the message content, the method, or a particular header field) is relevant. Thus, a general-purpose solution needs to provide signers with some degree of control over which message components are signed.<a class="pilcrow" href="#section-1.2-2">¶</a></p>
<p id="section-1.2-3">HTTP applications may be running in environments that do not provide complete access to or control over HTTP messages (such as a web browser's JavaScript environment) or may be using libraries that abstract away the details of the protocol (such as <a href="https://openjdk.java.net/groups/net/httpclient/intro.html">the Java HTTP Client (HttpClient) library</a>). These applications need to be able to generate and verify signatures despite incomplete knowledge of the HTTP message.<a class="pilcrow" href="#section-1.2-3">¶</a></p>
</section>
</div>
<div id="transforms">
<section id="section-1.3">
        <h3 id="name-http-message-transformation">
<a class="section-number selfRef" href="#section-1.3">1.3. </a><a class="section-name selfRef" href="#name-http-message-transformation">HTTP Message Transformations</a>
        </h3>
<p id="section-1.3-1">As mentioned earlier, HTTP explicitly permits, and in some cases requires, implementations to transform messages in a variety of ways. Implementations are required to tolerate many of these transformations. What follows is a non-normative and non-exhaustive list of transformations that could occur under HTTP, provided as context:<a class="pilcrow" href="#section-1.3-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.3-2.1">Reordering of fields with different field names (<span><a class="relref" href="https://rfc-editor.org/rfc/rfc9110#section-5.3">Section 5.3</a> of [<a class="cite xref" href="#RFC9110">HTTP</a>]</span>).<a class="pilcrow" href="#section-1.3-2.1">¶</a>
</li>
          <li class="normal" id="section-1.3-2.2">Combination of fields with the same field name (<span><a class="relref" href="https://rfc-editor.org/rfc/rfc9110#section-5.2">Section 5.2</a> of [<a class="cite xref" href="#RFC9110">HTTP</a>]</span>).<a class="pilcrow" href="#section-1.3-2.2">¶</a>
</li>
          <li class="normal" id="section-1.3-2.3">Removal of fields listed in the Connection header field (<span><a class="relref" href="https://rfc-editor.org/rfc/rfc9110#section-7.6.1">Section 7.6.1</a> of [<a class="cite xref" href="#RFC9110">HTTP</a>]</span>).<a class="pilcrow" href="#section-1.3-2.3">¶</a>
</li>
          <li class="normal" id="section-1.3-2.4">Addition of fields that indicate control options (<span><a class="relref" href="https://rfc-editor.org/rfc/rfc9110#section-7.6.1">Section 7.6.1</a> of [<a class="cite xref" href="#RFC9110">HTTP</a>]</span>).<a class="pilcrow" href="#section-1.3-2.4">¶</a>
</li>
          <li class="normal" id="section-1.3-2.5">Addition or removal of a transfer coding (<span><a class="relref" href="https://rfc-editor.org/rfc/rfc9110#section-7.7">Section 7.7</a> of [<a class="cite xref" href="#RFC9110">HTTP</a>]</span>).<a class="pilcrow" href="#section-1.3-2.5">¶</a>
</li>
          <li class="normal" id="section-1.3-2.6">Addition of fields such as Via (<span><a class="relref" href="https://rfc-editor.org/rfc/rfc9110#section-7.6.3">Section 7.6.3</a> of [<a class="cite xref" href="#RFC9110">HTTP</a>]</span>) and Forwarded (<span><a class="relref" href="https://rfc-editor.org/rfc/rfc7239#section-4">Section 4</a> of [<a class="cite xref" href="#RFC7239">RFC7239</a>]</span>).<a class="pilcrow" href="#section-1.3-2.6">¶</a>
</li>
          <li class="normal" id="section-1.3-2.7">Conversion between different versions of HTTP (e.g., HTTP/1.x to HTTP/2, or vice versa).<a class="pilcrow" href="#section-1.3-2.7">¶</a>
</li>
          <li class="normal" id="section-1.3-2.8">Changes in case (e.g., "Origin" to "origin") of any case-insensitive components such as field names, request URI scheme, or host.<a class="pilcrow" href="#section-1.3-2.8">¶</a>
</li>
          <li class="normal" id="section-1.3-2.9">Changes to the request target and authority that, when applied together, do not
  result in a change to the message's target URI, as defined in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc9110#section-7.1">Section 7.1</a> of [<a class="cite xref" href="#RFC9110">HTTP</a>]</span>.<a class="pilcrow" href="#section-1.3-2.9">¶</a>
</li>
        </ul>
<p id="section-1.3-3">Additionally, there are some transformations that are either deprecated or otherwise not allowed but that could still occur in the wild. These transformations can still be handled without breaking the signature; they include
such actions as:<a class="pilcrow" href="#section-1.3-3">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.3-4.1">Use, addition, or removal of leading or trailing whitespace in a field value.<a class="pilcrow" href="#section-1.3-4.1">¶</a>
</li>
          <li class="normal" id="section-1.3-4.2">Use, addition, or removal of <code>obs-fold</code> in field values (<span><a class="relref" href="https://rfc-editor.org/rfc/rfc9112#section-5.2">Section 5.2</a> of [<a class="cite xref" href="#RFC9112">HTTP/1.1</a>]</span>).<a class="pilcrow" href="#section-1.3-4.2">¶</a>
</li>
        </ul>
<p id="section-1.3-5">We can identify these types of transformations as transformations that should not prevent signature verification, even when performed on message components covered by the signature. Additionally, all changes to components not covered by the signature should not prevent signature verification.<a class="pilcrow" href="#section-1.3-5">¶</a></p>
<p id="section-1.3-6">Some examples of these kinds of transformations, and the effect they have on the message signature, are found in <a class="auto internal xref" href="#example-transform">Appendix B.4</a>.<a class="pilcrow" href="#section-1.3-6">¶</a></p>
<p id="section-1.3-7">Other transformations, such as parsing and reserializing the field values of a covered component or changing the value of a derived component, can cause a signature to no longer validate against a target message. Applications of this specification need to take care to ensure that the transformations expected by the application are adequately handled by the choice of covered components.<a class="pilcrow" href="#section-1.3-7">¶</a></p>
</section>
</div>
<div id="application">
<section id="section-1.4">
        <h3 id="name-application-of-http-message">
<a class="section-number selfRef" href="#section-1.4">1.4. </a><a class="section-name selfRef" href="#name-application-of-http-message">Application of HTTP Message Signatures</a>
        </h3>
<p id="section-1.4-1">HTTP message signatures are designed to be a general-purpose tool applicable in a wide variety of circumstances and applications. In order to properly and safely apply HTTP message signatures, an application or profile of this specification <span class="bcp14">MUST</span> specify, at a minimum, all of the following items:<a class="pilcrow" href="#section-1.4-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.4-2.1">The set of <span><a class="internal xref" href="#covered-components">component identifiers</a> (<a class="auto internal xref" href="#covered-components">Section 2</a>)</span> and <span><a class="internal xref" href="#signature-params">signature parameters</a> (<a class="auto internal xref" href="#signature-params">Section 2.3</a>)</span> that are expected and required to be included in the covered components list. For example, an authorization protocol could mandate that the Authorization field be covered to protect the authorization credentials and mandate that the signature parameters contain a <code>created</code> parameter (<a class="auto internal xref" href="#signature-params">Section 2.3</a>), while an API expecting semantically relevant HTTP message content could require the Content-Digest field defined in <span>[<a class="cite xref" href="#RFC9530">DIGEST</a>]</span> to be present and covered as well as mandate a value for the <code>tag</code> parameter (<a class="auto internal xref" href="#signature-params">Section 2.3</a>) that is specific to the API being protected.<a class="pilcrow" href="#section-1.4-2.1">¶</a>
</li>
          <li class="normal" id="section-1.4-2.2">The expected Structured Field types <span>[<a class="cite xref" href="#RFC8941">STRUCTURED-FIELDS</a>]</span> of any required or expected covered component fields or parameters.<a class="pilcrow" href="#section-1.4-2.2">¶</a>
</li>
          <li class="normal" id="section-1.4-2.3">A means of retrieving the key material used to verify the signature. An application will usually use the <code>keyid</code> parameter of the signature parameters (<a class="auto internal xref" href="#signature-params">Section 2.3</a>) and define rules for resolving a key from there, though the appropriate key could be known from other means such as preregistration of a signer's key.<a class="pilcrow" href="#section-1.4-2.3">¶</a>
</li>
          <li class="normal" id="section-1.4-2.4">The set of allowable signature algorithms to be used by signers and accepted by verifiers.<a class="pilcrow" href="#section-1.4-2.4">¶</a>
</li>
          <li class="normal" id="section-1.4-2.5">A means of determining that the signature algorithm used to verify the signature is appropriate for the key material and context of the message. For example, the process could use the <code>alg</code> parameter of the signature parameters (<a class="auto internal xref" href="#signature-params">Section 2.3</a>) to state the algorithm explicitly, derive the algorithm from the key material, or use some preconfigured algorithm agreed upon by the signer and verifier.<a class="pilcrow" href="#section-1.4-2.5">¶</a>
</li>
          <li class="normal" id="section-1.4-2.6">A means of determining that a given key and algorithm used for a signature are appropriate for the context of the message. For example, a server expecting only ECDSA signatures should know to reject any RSA signatures, or a server expecting asymmetric cryptography should know to reject any symmetric cryptography.<a class="pilcrow" href="#section-1.4-2.6">¶</a>
</li>
          <li class="normal" id="section-1.4-2.7">A means of determining the context for derivation of message components from an HTTP message and its application context. While this is normally the target HTTP message itself, the context could include additional information known to the application through configuration, such as an external hostname.<a class="pilcrow" href="#section-1.4-2.7">¶</a>
</li>
          <li class="normal" id="section-1.4-2.8">If binding between a request and response is needed using the mechanism provided in <a class="auto internal xref" href="#content-request-response">Section 2.4</a>, all elements of the request message and the response message that would be required to provide properties of such a binding.<a class="pilcrow" href="#section-1.4-2.8">¶</a>
</li>
          <li class="normal" id="section-1.4-2.9">The error messages and codes that are returned from the verifier to the signer when the signature is invalid, the key material is inappropriate, the validity time window is out of specification, a component value cannot be calculated, or any other errors occur during the signature verification process. For example, if a signature is being used as an authentication mechanism, an HTTP status code of 401 (Unauthorized) or 403 (Forbidden) could be appropriate. If the response is from an HTTP API, a response with an HTTP status code such as 400 (Bad Request) could include more details <span>[<a class="cite xref" href="#RFC7807">RFC7807</a>]</span> <span>[<a class="cite xref" href="#RFC9457">RFC9457</a>]</span>, such as an indicator that the wrong key material was used.<a class="pilcrow" href="#section-1.4-2.9">¶</a>
</li>
        </ul>
<p id="section-1.4-3">When choosing these parameters, an application of HTTP message signatures has to ensure that the verifier will have access to all required information needed to recreate the signature base. For example, a server behind a reverse proxy would need to know the original request URI to make use of the derived component <code>@target-uri</code>, even though the apparent target URI would be changed by the reverse proxy (see also <a class="auto internal xref" href="#security-message-component-context">Section 7.4.3</a>). Additionally, an application using signatures in responses would need to ensure that clients receiving signed responses have access to all the signed portions of the message, including any portions of the request that were signed by the server using the <code>req</code> ("request-response") parameter (<a class="auto internal xref" href="#content-request-response">Section 2.4</a>).<a class="pilcrow" href="#section-1.4-3">¶</a></p>
<p id="section-1.4-4">Details regarding this kind of profiling are within the purview of the application and outside the scope of this specification; however, some additional considerations are discussed in <a class="auto internal xref" href="#security">Section 7</a>. In particular, when choosing the required set of component identifiers, care has to be taken to make sure that the coverage is sufficient for the application, as discussed in
Sections <a class="auto internal xref" href="#security-coverage">7.2.1</a> and  <a class="auto internal xref" href="#security-message-content">7.2.8</a>. This specification defines only part of a full security system for an application. When building a complete security system based on this tool, it is important to perform a security analysis of the entire system, of which HTTP message signatures is a part. Historical systems, such as AWS Signature Version 4 <span>[<a class="cite xref" href="#AWS-SIGv4">AWS-SIGv4</a>]</span>, can provide inspiration and examples of how to apply similar mechanisms to an application, though review of such historical systems does not negate the need for a security analysis of an application of HTTP message signatures.<a class="pilcrow" href="#section-1.4-4">¶</a></p>
</section>
</div>
</section>
</div>
<div id="covered-components">
<section id="section-2">
      <h2 id="name-http-message-components">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-http-message-components">HTTP Message Components</a>
      </h2>
<p id="section-2-1">In order to allow signers and verifiers to establish which components are covered by a signature, this document defines component identifiers for components covered by an HTTP message signature, a set of rules for deriving and canonicalizing the values associated with these component identifiers from the HTTP message, and the means for combining these canonicalized values into a signature base.<a class="pilcrow" href="#section-2-1">¶</a></p>
<p id="section-2-2">The signature context for deriving these values <span class="bcp14">MUST</span> be accessible to both the signer and the verifier of the message. The context <span class="bcp14">MUST</span> be the same across all components in a given signature. For example, it would be an error to use the raw query string for the <code>@query</code> derived component but combined query and form parameters for the <code>@query-param</code> derived component. For more considerations regarding the message component context, see <a class="auto internal xref" href="#security-message-component-context">Section 7.4.3</a>.<a class="pilcrow" href="#section-2-2">¶</a></p>
<p id="section-2-3">A component identifier is composed of a component name and any parameters associated with that name. Each component name is either an HTTP field name (<a class="auto internal xref" href="#http-fields">Section 2.1</a>) or a registered derived component name (<a class="auto internal xref" href="#derived-components">Section 2.2</a>). The possible parameters for a component identifier are dependent on the component identifier. The "HTTP Signature Component Parameters" registry, which catalogs all possible parameters, is defined in <a class="auto internal xref" href="#component-param-registry">Section 6.5</a>.<a class="pilcrow" href="#section-2-3">¶</a></p>
<p id="section-2-4">Within a single list of covered components, each component identifier <span class="bcp14">MUST</span> occur only once. One component identifier is distinct from another if the component name differs or if any of the parameters differ for the same component name. Multiple component identifiers having the same component name <span class="bcp14">MAY</span> be included if they have parameters that make them distinct, such as <code>"foo";bar</code> and <code>"foo";baz</code>. The order of parameters <span class="bcp14">MUST</span> be preserved when processing a component identifier (such as when parsing during verification), but the order of parameters is not significant when comparing two component identifiers for equality checks. That is to say, <code>"foo";bar;baz</code> cannot be in the same message as <code>"foo";baz;bar</code>, since these two component identifiers are equivalent, but a system processing one form is not allowed to transform it into the other form.<a class="pilcrow" href="#section-2-4">¶</a></p>
<p id="section-2-5">The component value associated with a component identifier is defined by the identifier itself. Component values <span class="bcp14">MUST NOT</span> contain newline (<code>\n</code>) characters. Some HTTP message components can undergo transformations that change the bitwise value without altering the meaning of the component's value (for example, when combining field values). Message component values therefore need to be canonicalized before they are signed, to ensure that a signature can be verified despite such intermediary transformations. This document defines rules for each component identifier that transform the identifier's associated component value into such a canonical form.<a class="pilcrow" href="#section-2-5">¶</a></p>
<p id="section-2-6">The following sections define component identifier names, their parameters, their associated values, and the canonicalization rules for their values. The method for combining message components into the signature base is defined in <a class="auto internal xref" href="#create-sig-input">Section 2.5</a>.<a class="pilcrow" href="#section-2-6">¶</a></p>
<div id="http-fields">
<section id="section-2.1">
        <h3 id="name-http-fields">
<a class="section-number selfRef" href="#section-2.1">2.1. </a><a class="section-name selfRef" href="#name-http-fields">HTTP Fields</a>
        </h3>
<p id="section-2.1-1">The component name for an HTTP field is the lowercased form of its field name as defined in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc9110#section-5.1">Section 5.1</a> of [<a class="cite xref" href="#RFC9110">HTTP</a>]</span>. While HTTP field names are case insensitive, implementations <span class="bcp14">MUST</span> use lowercased field names (e.g., <code>content-type</code>, <code>date</code>, <code>etag</code>) when using them as component names.<a class="pilcrow" href="#section-2.1-1">¶</a></p>
<p id="section-2.1-2">The component value for an HTTP field is the field value for the named field as defined in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc9110#section-5.5">Section 5.5</a> of [<a class="cite xref" href="#RFC9110">HTTP</a>]</span>. The field value <span class="bcp14">MUST</span> be taken from the named header field of the target message unless this behavior is overridden by additional parameters and rules, such as the <code>req</code> and <code>tr</code> flags, below. For most fields, the field value is an ASCII string as recommended by <span>[<a class="cite xref" href="#RFC9110">HTTP</a>]</span>, and the component value is exactly that string. Other encodings could exist in some implementations, and all non-ASCII field values <span class="bcp14">MUST</span> be encoded to ASCII before being added to the signature base. The <code>bs</code> parameter, as described in <a class="auto internal xref" href="#http-field-byte-sequence">Section 2.1.3</a>, provides a method for wrapping such problematic field values.<a class="pilcrow" href="#section-2.1-2">¶</a></p>
<p id="section-2.1-3">Unless overridden by additional parameters and rules, HTTP field values <span class="bcp14">MUST</span> be combined into a single value as defined in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc9110#section-5.2">Section 5.2</a> of [<a class="cite xref" href="#RFC9110">HTTP</a>]</span> to create the component value. Specifically, HTTP fields sent as multiple fields <span class="bcp14">MUST</span> be combined by concatenating the values using a single comma and a single space as a separator ("," + " "). Note that intermediaries are allowed to combine values of HTTP fields with any amount of whitespace between the commas, and if this behavior is not accounted for by the verifier, the signature can fail, since the signer and verifier will see a different component value in their respective signature bases. For robustness, it is <span class="bcp14">RECOMMENDED</span> that signed messages include only a single instance of any field covered under the signature, particularly with the value for any list-based fields serialized using the algorithm below. This approach increases the chances of the field value remaining untouched through intermediaries. Where that approach is not possible and multiple instances of a field need to be sent separately, it is <span class="bcp14">RECOMMENDED</span> that signers and verifiers process any list-based fields taking all individual field values and combining them based on the strict algorithm below, to counter possible intermediary behavior. When the field in question is a Structured Field of type List or Dictionary, this effect can be accomplished more directly by requiring the strict Structured Field serialization of the field value, as described in <a class="auto internal xref" href="#http-field-structured">Section 2.1.1</a>.<a class="pilcrow" href="#section-2.1-3">¶</a></p>
<p id="section-2.1-4">Note that some HTTP fields, such as Set-Cookie <span>[<a class="cite xref" href="#RFC6265">COOKIE</a>]</span>, do not follow a syntax that allows for the combination of field values in this manner (such that the combined output is unambiguous from multiple inputs). Even though the component value is never parsed by the message signature process and is used only as part of the signature base (<a class="auto internal xref" href="#create-sig-input">Section 2.5</a>), caution needs to be taken when including such fields in signatures, since the combined value could be ambiguous. The <code>bs</code> parameter, as described in <a class="auto internal xref" href="#http-field-byte-sequence">Section 2.1.3</a>, provides a method for wrapping such problematic fields. See <a class="auto internal xref" href="#security-non-list">Section 7.5.6</a> for more discussion regarding this issue.<a class="pilcrow" href="#section-2.1-4">¶</a></p>
<p id="section-2.1-5">If the correctly combined value is not directly available for a given field by an implementation, the following algorithm will produce canonicalized results for list-based fields:<a class="pilcrow" href="#section-2.1-5">¶</a></p>
<ol class="normal type-1" id="section-2.1-6" start="1" type="1">
<li id="section-2.1-6.1">Create an ordered list of the field values of each instance of the field in the message, in the order they occur (or will occur) in the message.<a class="pilcrow" href="#section-2.1-6.1">¶</a>
</li>
          <li id="section-2.1-6.2">Strip leading and trailing whitespace from each item in the list. Note that since HTTP field values are not allowed to contain leading and trailing whitespace, this would be a no-op in a compliant implementation.<a class="pilcrow" href="#section-2.1-6.2">¶</a>
</li>
          <li id="section-2.1-6.3">Remove any obsolete line folding within the line, and replace it with a single space (" "), as discussed in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc9112#section-5.2">Section 5.2</a> of [<a class="cite xref" href="#RFC9112">HTTP/1.1</a>]</span>. Note that this behavior is specific to HTTP/1.1 and does not apply to other versions of the HTTP specification, which do not allow internal line folding.<a class="pilcrow" href="#section-2.1-6.3">¶</a>
</li>
          <li id="section-2.1-6.4">Concatenate the list of values with a single comma (",") and a single space (" ") between each item.<a class="pilcrow" href="#section-2.1-6.4">¶</a>
</li>
        </ol>
<p id="section-2.1-7">The resulting string is the component value for the field.<a class="pilcrow" href="#section-2.1-7">¶</a></p>
<p id="section-2.1-8">Note that some HTTP fields have values with multiple valid serializations that have equivalent semantics, such as allowing case-insensitive values that intermediaries could change. Applications signing and processing such fields <span class="bcp14">MUST</span> consider how to handle the values of such fields to ensure that the signer and verifier can derive the same value, as discussed in <a class="auto internal xref" href="#security-field-values">Section 7.5.2</a>.<a class="pilcrow" href="#section-2.1-8">¶</a></p>
<p id="section-2.1-9">The following are non-normative examples of component values for header fields, given the following example HTTP message fragment:<a class="pilcrow" href="#section-2.1-9">¶</a></p>
<div class="lang-http-message sourcecode" id="section-2.1-10">
<pre>Host: www.example.com
Date: Tue, 20 Apr 2021 02:07:56 GMT
X-OWS-Header:   Leading and trailing whitespace.
X-Obs-Fold-Header: Obsolete
    line folding.
Cache-Control: max-age=60
Cache-Control:    must-revalidate
Example-Dict:  a=1,    b=2;x=1;y=2,   c=(a   b   c)
</pre><a class="pilcrow" href="#section-2.1-10">¶</a>
</div>
<p id="section-2.1-11">The following example shows the component values for these example header fields, presented using the signature base format defined in <a class="auto internal xref" href="#create-sig-input">Section 2.5</a>:<a class="pilcrow" href="#section-2.1-11">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.1-12">
<pre>"host": www.example.com
"date": Tue, 20 Apr 2021 02:07:56 GMT
"x-ows-header": Leading and trailing whitespace.
"x-obs-fold-header": Obsolete line folding.
"cache-control": max-age=60, must-revalidate
"example-dict": a=1,    b=2;x=1;y=2,   c=(a   b   c)
</pre><a class="pilcrow" href="#section-2.1-12">¶</a>
</div>
<p id="section-2.1-13">Empty HTTP fields can also be signed when present in a message. The canonicalized value is the empty string. This means that the following empty header field, with (SP) indicating a single trailing space character before the empty field value:<a class="pilcrow" href="#section-2.1-13">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.1-14">
<pre>X-Empty-Header:(SP)
</pre><a class="pilcrow" href="#section-2.1-14">¶</a>
</div>
<p id="section-2.1-15">is serialized by the <span><a class="internal xref" href="#create-sig-input">signature base generation algorithm</a> (<a class="auto internal xref" href="#create-sig-input">Section 2.5</a>)</span> with an empty string value following the colon and space added after the component identifier.<a class="pilcrow" href="#section-2.1-15">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.1-16">
<pre>"x-empty-header":(SP)
</pre><a class="pilcrow" href="#section-2.1-16">¶</a>
</div>
<p id="section-2.1-17">Any HTTP field component identifiers <span class="bcp14">MAY</span> have the following parameters in specific circumstances, each described in detail in their own sections:<a class="pilcrow" href="#section-2.1-17">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.1-18">
          <dt id="section-2.1-18.1"><code>sf</code></dt>
          <dd id="section-2.1-18.2" style="margin-left: 1.5em">
            <p id="section-2.1-18.2.1">A Boolean flag indicating that the component value is serialized using strict encoding
of the Structured Field value (<a class="auto internal xref" href="#http-field-structured">Section 2.1.1</a>).<a class="pilcrow" href="#section-2.1-18.2.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-18.3"><code>key</code></dt>
          <dd id="section-2.1-18.4" style="margin-left: 1.5em">
            <p id="section-2.1-18.4.1">A String parameter used to select a single member value from a Dictionary Structured Field (<a class="auto internal xref" href="#http-field-dictionary">Section 2.1.2</a>).<a class="pilcrow" href="#section-2.1-18.4.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-18.5"><code>bs</code></dt>
          <dd id="section-2.1-18.6" style="margin-left: 1.5em">
            <p id="section-2.1-18.6.1">A Boolean flag indicating that individual field values are encoded using Byte Sequence data structures before being combined into the component value (<a class="auto internal xref" href="#http-field-byte-sequence">Section 2.1.3</a>).<a class="pilcrow" href="#section-2.1-18.6.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-18.7"><code>req</code></dt>
          <dd id="section-2.1-18.8" style="margin-left: 1.5em">
            <p id="section-2.1-18.8.1">A Boolean flag for signed responses indicating that the component value is derived from the request that triggered this response message and not from the response message directly. Note that this parameter can also be applied to any derived component identifiers that target the request (<a class="auto internal xref" href="#content-request-response">Section 2.4</a>).<a class="pilcrow" href="#section-2.1-18.8.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-18.9"><code>tr</code></dt>
          <dd id="section-2.1-18.10" style="margin-left: 1.5em">
            <p id="section-2.1-18.10.1">A Boolean flag indicating that the field value is taken from the trailers of the message as defined in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc9110#section-6.5">Section 6.5</a> of [<a class="cite xref" href="#RFC9110">HTTP</a>]</span>. If this flag is absent, the field value is taken from the header fields of the message as defined in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc9110#section-6.3">Section 6.3</a> of [<a class="cite xref" href="#RFC9110">HTTP</a>]</span> (<a class="auto internal xref" href="#http-trailer">Section 2.1.4</a>).<a class="pilcrow" href="#section-2.1-18.10.1">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-2.1-19">Multiple parameters <span class="bcp14">MAY</span> be specified together, though some combinations are redundant or incompatible. For example, the <code>sf</code> parameter's functionality is already covered when the <code>key</code> parameter is used on a Dictionary item, since <code>key</code> requires strict serialization of the value. The <code>bs</code> parameter, which requires the raw bytes of the field values from the message, is not compatible with the use of the <code>sf</code> or <code>key</code> parameters, which require the parsed data structures of the field values after combination.<a class="pilcrow" href="#section-2.1-19">¶</a></p>
<p id="section-2.1-20">Additional parameters can be defined in the "HTTP Signature Component Parameters" registry established in <a class="auto internal xref" href="#component-param-registry">Section 6.5</a>.<a class="pilcrow" href="#section-2.1-20">¶</a></p>
<div id="http-field-structured">
<section id="section-2.1.1">
          <h4 id="name-strict-serialization-of-htt">
<a class="section-number selfRef" href="#section-2.1.1">2.1.1. </a><a class="section-name selfRef" href="#name-strict-serialization-of-htt">Strict Serialization of HTTP Structured Fields</a>
          </h4>
<p id="section-2.1.1-1">If the value of an HTTP field is known by the application to be a Structured Field type (as defined in <span>[<a class="cite xref" href="#RFC8941">STRUCTURED-FIELDS</a>]</span> or its extensions or updates) and the expected type of the Structured Field is known, the signer <span class="bcp14">MAY</span> include the <code>sf</code> parameter in the component identifier.
If this parameter is included with a component identifier, the HTTP field value <span class="bcp14">MUST</span> be serialized using the formal serialization rules specified in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8941#section-4">Section 4</a> of [<a class="cite xref" href="#RFC8941">STRUCTURED-FIELDS</a>]</span> (or the
applicable formal serialization section of its extensions or updates) applicable to
the type of the HTTP field. Note that this process
will replace any optional internal whitespace with a single space character, among other potential transformations of the value.<a class="pilcrow" href="#section-2.1.1-1">¶</a></p>
<p id="section-2.1.1-2">If multiple field values occur within a message, these values <span class="bcp14">MUST</span> be combined into a single List or Dictionary structure before serialization.<a class="pilcrow" href="#section-2.1.1-2">¶</a></p>
<p id="section-2.1.1-3">If the application does not know the type of the field or does not know how to serialize the type of the field, the use of this flag will produce an error. As a consequence, the signer can only reliably sign fields using this flag when the verifier's system knows the type as well.<a class="pilcrow" href="#section-2.1.1-3">¶</a></p>
<p id="section-2.1.1-4">For example, the following Dictionary field is a valid serialization:<a class="pilcrow" href="#section-2.1.1-4">¶</a></p>
<div class="lang-http-message sourcecode" id="section-2.1.1-5">
<pre>Example-Dict:  a=1,    b=2;x=1;y=2,   c=(a   b   c)
</pre><a class="pilcrow" href="#section-2.1.1-5">¶</a>
</div>
<p id="section-2.1.1-6">If included in the signature base without parameters, its value would be:<a class="pilcrow" href="#section-2.1.1-6">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.1.1-7">
<pre>"example-dict": a=1,    b=2;x=1;y=2,   c=(a   b   c)
</pre><a class="pilcrow" href="#section-2.1.1-7">¶</a>
</div>
<p id="section-2.1.1-8">However, if the <code>sf</code> parameter is added, the value is reserialized as follows:<a class="pilcrow" href="#section-2.1.1-8">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.1.1-9">
<pre>"example-dict";sf: a=1, b=2;x=1;y=2, c=(a b c)
</pre><a class="pilcrow" href="#section-2.1.1-9">¶</a>
</div>
<p id="section-2.1.1-10">The resulting string is used as the component value; see <a class="auto internal xref" href="#http-fields">Section 2.1</a>.<a class="pilcrow" href="#section-2.1.1-10">¶</a></p>
</section>
</div>
<div id="http-field-dictionary">
<section id="section-2.1.2">
          <h4 id="name-dictionary-structured-field">
<a class="section-number selfRef" href="#section-2.1.2">2.1.2. </a><a class="section-name selfRef" href="#name-dictionary-structured-field">Dictionary Structured Field Members</a>
          </h4>
<p id="section-2.1.2-1">If a given field is known by the application to be a Dictionary Structured Field, an individual member in the value of that Dictionary is identified by using the parameter <code>key</code> and the Dictionary member key as a String value.<a class="pilcrow" href="#section-2.1.2-1">¶</a></p>
<p id="section-2.1.2-2">If multiple field values occur within a message, these values <span class="bcp14">MUST</span> be combined into a single Dictionary structure before serialization.<a class="pilcrow" href="#section-2.1.2-2">¶</a></p>
<p id="section-2.1.2-3">An individual member value of a Dictionary Structured Field is canonicalized by applying the serialization algorithm described in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8941#section-4.1.2">Section 4.1.2</a> of [<a class="cite xref" href="#RFC8941">STRUCTURED-FIELDS</a>]</span> on the <code>member_value</code> and its parameters, not including the Dictionary key itself. Specifically, the value is serialized as an Item or Inner List (the two possible values of a Dictionary member), with all parameters and possible subfields serialized using the strict serialization rules defined in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8941#section-4">Section 4</a> of [<a class="cite xref" href="#RFC8941">STRUCTURED-FIELDS</a>]</span> (or the applicable section of its extensions or updates).<a class="pilcrow" href="#section-2.1.2-3">¶</a></p>
<p id="section-2.1.2-4">Each parameterized key for a given field <span class="bcp14">MUST NOT</span> appear more than once in the signature base. Parameterized keys <span class="bcp14">MAY</span> appear in any order in the signature base, regardless of the order they occur in the source Dictionary.<a class="pilcrow" href="#section-2.1.2-4">¶</a></p>
<p id="section-2.1.2-5">If a Dictionary key is named as a covered component but it does not occur in the Dictionary, this <span class="bcp14">MUST</span> cause an error in the signature base generation.<a class="pilcrow" href="#section-2.1.2-5">¶</a></p>
<p id="section-2.1.2-6">The following are non-normative examples of canonicalized values for Dictionary Structured Field members, given the following example header field, whose value is known by the application to be a Dictionary:<a class="pilcrow" href="#section-2.1.2-6">¶</a></p>
<div class="lang-http-message sourcecode" id="section-2.1.2-7">
<pre>Example-Dict:  a=1, b=2;x=1;y=2, c=(a   b    c), d
</pre><a class="pilcrow" href="#section-2.1.2-7">¶</a>
</div>
<p id="section-2.1.2-8">The following example shows canonicalized values for different component identifiers of this field, presented using the signature base format discussed in <a class="auto internal xref" href="#create-sig-input">Section 2.5</a>:<a class="pilcrow" href="#section-2.1.2-8">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.1.2-9">
<pre>"example-dict";key="a": 1
"example-dict";key="d": ?1
"example-dict";key="b": 2;x=1;y=2
"example-dict";key="c": (a b c)
</pre><a class="pilcrow" href="#section-2.1.2-9">¶</a>
</div>
<p id="section-2.1.2-10">Note that the value for <code>key="c"</code> has been reserialized according to the strict <code>member_value</code> algorithm, and the value for <code>key="d"</code> has been serialized as a Boolean value.<a class="pilcrow" href="#section-2.1.2-10">¶</a></p>
</section>
</div>
<div id="http-field-byte-sequence">
<section id="section-2.1.3">
          <h4 id="name-binary-wrapped-http-fields">
<a class="section-number selfRef" href="#section-2.1.3">2.1.3. </a><a class="section-name selfRef" href="#name-binary-wrapped-http-fields">Binary-Wrapped HTTP Fields</a>
          </h4>
<p id="section-2.1.3-1">If the value of the HTTP field in question is known by the application to cause problems with serialization, particularly with the combination of multiple values into a single line as discussed in <a class="auto internal xref" href="#security-non-list">Section 7.5.6</a>, the signer <span class="bcp14">SHOULD</span> include the <code>bs</code> parameter in a component identifier to indicate that the values of the field need to be wrapped as binary structures before being combined.<a class="pilcrow" href="#section-2.1.3-1">¶</a></p>
<p id="section-2.1.3-2">If this parameter is included with a component identifier, the component value <span class="bcp14">MUST</span> be calculated using the following algorithm:<a class="pilcrow" href="#section-2.1.3-2">¶</a></p>
<ol class="normal type-1" id="section-2.1.3-3" start="1" type="1">
<li id="section-2.1.3-3.1">Let the input be the ordered set of values for a field, in the order they appear in the message.<a class="pilcrow" href="#section-2.1.3-3.1">¶</a>
</li>
            <li id="section-2.1.3-3.2">Create an empty List for accumulating processed field values.<a class="pilcrow" href="#section-2.1.3-3.2">¶</a>
</li>
            <li id="section-2.1.3-3.3">
              <p id="section-2.1.3-3.3.1">For each field value in the set:<a class="pilcrow" href="#section-2.1.3-3.3.1">¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-2.1.3-3.3.2">
<dt>3.1.</dt>
<dd id="section-2.1.3-3.3.2.1">Strip leading and trailing whitespace from the field value. Note that since HTTP field values are not allowed to contain leading and trailing whitespace, this would be a no-op in a compliant implementation.<a class="pilcrow" href="#section-2.1.3-3.3.2.1">¶</a>
</dd>
                <dd class="break"></dd>
<dt>3.2.</dt>
<dd id="section-2.1.3-3.3.2.2">Remove any obsolete line folding within the line, and replace it with a single space (" "), as discussed in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc9112#section-5.2">Section 5.2</a> of [<a class="cite xref" href="#RFC9112">HTTP/1.1</a>]</span>. Note that this behavior is specific to <span>[<a class="cite xref" href="#RFC9112">HTTP/1.1</a>]</span> and does not apply to other versions of the HTTP specification.<a class="pilcrow" href="#section-2.1.3-3.3.2.2">¶</a>
</dd>
                <dd class="break"></dd>
<dt>3.3.</dt>
<dd id="section-2.1.3-3.3.2.3">Encode the bytes of the resulting field value as a Byte Sequence. Note that most fields are restricted to ASCII characters, but other octets could be included in the value in some implementations.<a class="pilcrow" href="#section-2.1.3-3.3.2.3">¶</a>
</dd>
                <dd class="break"></dd>
<dt>3.4.</dt>
<dd id="section-2.1.3-3.3.2.4">Add the Byte Sequence to the List accumulator.<a class="pilcrow" href="#section-2.1.3-3.3.2.4">¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</li>
            <li id="section-2.1.3-3.4">The intermediate result is a List of Byte Sequence values.<a class="pilcrow" href="#section-2.1.3-3.4">¶</a>
</li>
            <li id="section-2.1.3-3.5">Follow the strict serialization of a List as described in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8941#section-4.1.1">Section 4.1.1</a> of [<a class="cite xref" href="#RFC8941">STRUCTURED-FIELDS</a>]</span>, and return this output.<a class="pilcrow" href="#section-2.1.3-3.5">¶</a>
</li>
          </ol>
<p id="section-2.1.3-4">For example, the following field with internal commas prevents the distinct field values from being safely combined:<a class="pilcrow" href="#section-2.1.3-4">¶</a></p>
<div class="lang-http-message sourcecode" id="section-2.1.3-5">
<pre>Example-Header: value, with, lots
Example-Header: of, commas
</pre><a class="pilcrow" href="#section-2.1.3-5">¶</a>
</div>
<p id="section-2.1.3-6">In our example, the same field can be sent with a semantically different single value:<a class="pilcrow" href="#section-2.1.3-6">¶</a></p>
<div class="lang-http-message sourcecode" id="section-2.1.3-7">
<pre>Example-Header: value, with, lots, of, commas
</pre><a class="pilcrow" href="#section-2.1.3-7">¶</a>
</div>
<p id="section-2.1.3-8">Both of these versions are treated differently by the application. However, if included in the signature base without parameters, the component value would be the same in both cases:<a class="pilcrow" href="#section-2.1.3-8">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.1.3-9">
<pre>"example-header": value, with, lots, of, commas
</pre><a class="pilcrow" href="#section-2.1.3-9">¶</a>
</div>
<p id="section-2.1.3-10">However, if the <code>bs</code> parameter is added, the two separate instances are encoded and serialized as follows:<a class="pilcrow" href="#section-2.1.3-10">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.1.3-11">
<pre>"example-header";bs: :dmFsdWUsIHdpdGgsIGxvdHM=:, :b2YsIGNvbW1hcw==:
</pre><a class="pilcrow" href="#section-2.1.3-11">¶</a>
</div>
<p id="section-2.1.3-12">For the single-instance field above, the encoding with the <code>bs</code> parameter is:<a class="pilcrow" href="#section-2.1.3-12">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.1.3-13">
<pre>"example-header";bs: :dmFsdWUsIHdpdGgsIGxvdHMsIG9mLCBjb21tYXM=:
</pre><a class="pilcrow" href="#section-2.1.3-13">¶</a>
</div>
<p id="section-2.1.3-14">This component value is distinct from the multiple-instance field above, preventing a collision that could potentially be exploited.<a class="pilcrow" href="#section-2.1.3-14">¶</a></p>
</section>
</div>
<div id="http-trailer">
<section id="section-2.1.4">
          <h4 id="name-trailer-fields">
<a class="section-number selfRef" href="#section-2.1.4">2.1.4. </a><a class="section-name selfRef" href="#name-trailer-fields">Trailer Fields</a>
          </h4>
<p id="section-2.1.4-1">If the signer wants to include a trailer field in the signature, the signer <span class="bcp14">MUST</span> include the <code>tr</code> Boolean parameter to indicate that the value <span class="bcp14">MUST</span> be taken from the trailer fields and not from the header fields.<a class="pilcrow" href="#section-2.1.4-1">¶</a></p>
<p id="section-2.1.4-2">For example, given the following message:<a class="pilcrow" href="#section-2.1.4-2">¶</a></p>
<div class="lang-http-message sourcecode" id="section-2.1.4-3">
<pre>HTTP/1.1 200 OK
Content-Type: text/plain
Transfer-Encoding: chunked
Trailer: Expires

4
HTTP
7
Message
a
Signatures
0
Expires: Wed, 9 Nov 2022 07:28:00 GMT
</pre><a class="pilcrow" href="#section-2.1.4-3">¶</a>
</div>
<p id="section-2.1.4-4">The signer decides to add both the Trailer header field and the Expires trailer field to the signature base, along with the status code derived component:<a class="pilcrow" href="#section-2.1.4-4">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.1.4-5">
<pre>"@status": 200
"trailer": Expires
"expires";tr: Wed, 9 Nov 2022 07:28:00 GMT
</pre><a class="pilcrow" href="#section-2.1.4-5">¶</a>
</div>
<p id="section-2.1.4-6">If a field is available as both a header and a trailer in a message, both values <span class="bcp14">MAY</span> be signed, but the values <span class="bcp14">MUST</span> be signed separately. The values of header fields and trailer fields of the same name <span class="bcp14">MUST NOT</span> be combined for purposes of the signature.<a class="pilcrow" href="#section-2.1.4-6">¶</a></p>
<p id="section-2.1.4-7">Since trailer fields could be merged into the header fields or dropped entirely by intermediaries as per <span><a class="relref" href="https://rfc-editor.org/rfc/rfc9110#section-6.5.1">Section 6.5.1</a> of [<a class="cite xref" href="#RFC9110">HTTP</a>]</span>, it is <span class="bcp14">NOT RECOMMENDED</span> to include trailers in the signature unless the signer knows that the verifier will have access to the values of the trailers as sent.<a class="pilcrow" href="#section-2.1.4-7">¶</a></p>
</section>
</div>
</section>
</div>
<div id="derived-components">
<section id="section-2.2">
        <h3 id="name-derived-components">
<a class="section-number selfRef" href="#section-2.2">2.2. </a><a class="section-name selfRef" href="#name-derived-components">Derived Components</a>
        </h3>
<p id="section-2.2-1">In addition to HTTP fields, there are a number of different components that can be derived from the control data, signature context, or other aspects of the HTTP message being signed. Such derived components can be included in the signature base by defining a component name, possible parameters, message targets, and the derivation method for its component value.<a class="pilcrow" href="#section-2.2-1">¶</a></p>
<p id="section-2.2-2">Derived component names <span class="bcp14">MUST</span> start with the "at" (<code>@</code>) character. This differentiates derived component names from HTTP field names, which cannot contain the <code>@</code> character as per <span><a class="relref" href="https://rfc-editor.org/rfc/rfc9110#section-5.1">Section 5.1</a> of [<a class="cite xref" href="#RFC9110">HTTP</a>]</span>. Processors of HTTP message signatures <span class="bcp14">MUST</span> treat derived component names separately from field names, as discussed in <a class="auto internal xref" href="#security-lazy-header-parser">Section 7.5.1</a>.<a class="pilcrow" href="#section-2.2-2">¶</a></p>
<p id="section-2.2-3">This specification defines the following derived components:<a class="pilcrow" href="#section-2.2-3">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.2-4">
          <dt id="section-2.2-4.1">@method</dt>
          <dd id="section-2.2-4.2" style="margin-left: 1.5em">
            <p id="section-2.2-4.2.1">The method used for a request (<a class="auto internal xref" href="#content-request-method">Section 2.2.1</a>).<a class="pilcrow" href="#section-2.2-4.2.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-4.3">@target-uri</dt>
          <dd id="section-2.2-4.4" style="margin-left: 1.5em">
            <p id="section-2.2-4.4.1">The full target URI for a request (<a class="auto internal xref" href="#content-target-uri">Section 2.2.2</a>).<a class="pilcrow" href="#section-2.2-4.4.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-4.5">@authority</dt>
          <dd id="section-2.2-4.6" style="margin-left: 1.5em">
            <p id="section-2.2-4.6.1">The authority of the target URI for a request (<a class="auto internal xref" href="#content-request-authority">Section 2.2.3</a>).<a class="pilcrow" href="#section-2.2-4.6.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-4.7">@scheme</dt>
          <dd id="section-2.2-4.8" style="margin-left: 1.5em">
            <p id="section-2.2-4.8.1">The scheme of the target URI for a request (<a class="auto internal xref" href="#content-request-scheme">Section 2.2.4</a>).<a class="pilcrow" href="#section-2.2-4.8.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-4.9">@request-target</dt>
          <dd id="section-2.2-4.10" style="margin-left: 1.5em">
            <p id="section-2.2-4.10.1">The request target (<a class="auto internal xref" href="#content-request-target">Section 2.2.5</a>).<a class="pilcrow" href="#section-2.2-4.10.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-4.11">@path</dt>
          <dd id="section-2.2-4.12" style="margin-left: 1.5em">
            <p id="section-2.2-4.12.1">The absolute path portion of the target URI for a request (<a class="auto internal xref" href="#content-request-path">Section 2.2.6</a>).<a class="pilcrow" href="#section-2.2-4.12.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-4.13">@query</dt>
          <dd id="section-2.2-4.14" style="margin-left: 1.5em">
            <p id="section-2.2-4.14.1">The query portion of the target URI for a request (<a class="auto internal xref" href="#content-request-query">Section 2.2.7</a>).<a class="pilcrow" href="#section-2.2-4.14.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-4.15">@query-param</dt>
          <dd id="section-2.2-4.16" style="margin-left: 1.5em">
            <p id="section-2.2-4.16.1">A parsed and encoded query parameter of the target URI for a request (<a class="auto internal xref" href="#content-request-query-param">Section 2.2.8</a>).<a class="pilcrow" href="#section-2.2-4.16.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-4.17">@status</dt>
          <dd id="section-2.2-4.18" style="margin-left: 1.5em">
            <p id="section-2.2-4.18.1">The status code for a response (<a class="auto internal xref" href="#content-status-code">Section 2.2.9</a>).<a class="pilcrow" href="#section-2.2-4.18.1">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-2.2-5">Additional derived component names are defined in the <span><a class="internal xref" href="#content-registry">"HTTP Signature Derived Component Names" registry</a> (<a class="auto internal xref" href="#content-registry">Section 6.4</a>)</span>.<a class="pilcrow" href="#section-2.2-5">¶</a></p>
<p id="section-2.2-6">Derived component values are taken from the context of the target message for the signature. This context includes information about the message itself, such as its control data, as well as any additional state and context held by the signer or verifier. In particular, when signing a response, the signer can include any derived components from the originating request by using the <span><a class="internal xref" href="#content-request-response"><code>req</code> parameter</a> (<a class="auto internal xref" href="#content-request-response">Section 2.4</a>)</span>.<a class="pilcrow" href="#section-2.2-6">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.2-7">
          <dt id="section-2.2-7.1">request:</dt>
          <dd id="section-2.2-7.2" style="margin-left: 1.5em">
            <p id="section-2.2-7.2.1">Values derived from, and results applied to, an HTTP request message as described in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc9110#section-3.4">Section 3.4</a> of [<a class="cite xref" href="#RFC9110">HTTP</a>]</span>. If the target message of the signature is a response, derived components that target request messages can be included by using the <code>req</code> parameter as defined in
<a class="auto internal xref" href="#content-request-response">Section 2.4</a>.<a class="pilcrow" href="#section-2.2-7.2.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-7.3">response:</dt>
          <dd id="section-2.2-7.4" style="margin-left: 1.5em">
            <p id="section-2.2-7.4.1">Values derived from, and results applied to, an HTTP response message as described in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc9110#section-3.4">Section 3.4</a> of [<a class="cite xref" href="#RFC9110">HTTP</a>]</span>.<a class="pilcrow" href="#section-2.2-7.4.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-7.5">request, response:</dt>
          <dd id="section-2.2-7.6" style="margin-left: 1.5em">Values derived from, and results applied to, either a request message or a response message.<a class="pilcrow" href="#section-2.2-7.6">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-2.2-8">A derived component definition <span class="bcp14">MUST</span> define all target message types to which it can be applied.<a class="pilcrow" href="#section-2.2-8">¶</a></p>
<p id="section-2.2-9">Derived component values <span class="bcp14">MUST</span> be limited to printable characters and spaces and <span class="bcp14">MUST NOT</span> contain any newline characters. Derived component values <span class="bcp14">MUST NOT</span> start or end with whitespace characters.<a class="pilcrow" href="#section-2.2-9">¶</a></p>
<div id="content-request-method">
<section id="section-2.2.1">
          <h4 id="name-method">
<a class="section-number selfRef" href="#section-2.2.1">2.2.1. </a><a class="section-name selfRef" href="#name-method">Method</a>
          </h4>
<p id="section-2.2.1-1">The <code>@method</code> derived component refers to the HTTP method of a request message. The component value is canonicalized by taking the value of the method as a string. Note that the method name is case sensitive as per <span>[<a class="cite xref" href="#RFC9110">HTTP</a>], <a class="relref" href="https://rfc-editor.org/rfc/rfc9110#section-9.1">Section 9.1</a></span>. While conventionally standardized method names are uppercase <span>[<a class="cite xref" href="#RFC0020">ASCII</a>]</span>, no transformation to the input method value's case is performed.<a class="pilcrow" href="#section-2.2.1-1">¶</a></p>
<p id="section-2.2.1-2">For example, the following request message:<a class="pilcrow" href="#section-2.2.1-2">¶</a></p>
<div class="lang-http-message sourcecode" id="section-2.2.1-3">
<pre>POST /path?param=value HTTP/1.1
Host: www.example.com
</pre><a class="pilcrow" href="#section-2.2.1-3">¶</a>
</div>
<p id="section-2.2.1-4">would result in the following <code>@method</code> component value:<a class="pilcrow" href="#section-2.2.1-4">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.1-5">
<pre>POST
</pre><a class="pilcrow" href="#section-2.2.1-5">¶</a>
</div>
<p id="section-2.2.1-6">and the following signature base line:<a class="pilcrow" href="#section-2.2.1-6">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.1-7">
<pre>"@method": POST
</pre><a class="pilcrow" href="#section-2.2.1-7">¶</a>
</div>
</section>
</div>
<div id="content-target-uri">
<section id="section-2.2.2">
          <h4 id="name-target-uri">
<a class="section-number selfRef" href="#section-2.2.2">2.2.2. </a><a class="section-name selfRef" href="#name-target-uri">Target URI</a>
          </h4>
<p id="section-2.2.2-1">The <code>@target-uri</code> derived component refers to the target URI of a request message. The component value is the target URI of the request (<span>[<a class="cite xref" href="#RFC9110">HTTP</a>], <a class="relref" href="https://rfc-editor.org/rfc/rfc9110#section-7.1">Section 7.1</a></span>), assembled from all available URI components, including the authority.<a class="pilcrow" href="#section-2.2.2-1">¶</a></p>
<p id="section-2.2.2-2">For example, the following message sent over HTTPS:<a class="pilcrow" href="#section-2.2.2-2">¶</a></p>
<div class="lang-http-message sourcecode" id="section-2.2.2-3">
<pre>POST /path?param=value HTTP/1.1
Host: www.example.com
</pre><a class="pilcrow" href="#section-2.2.2-3">¶</a>
</div>
<p id="section-2.2.2-4">would result in the following <code>@target-uri</code> component value:<a class="pilcrow" href="#section-2.2.2-4">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.2-5">
<pre>https://www.example.com/path?param=value
</pre><a class="pilcrow" href="#section-2.2.2-5">¶</a>
</div>
<p id="section-2.2.2-6">and the following signature base line:<a class="pilcrow" href="#section-2.2.2-6">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.2-7">
<pre>"@target-uri": https://www.example.com/path?param=value
</pre><a class="pilcrow" href="#section-2.2.2-7">¶</a>
</div>
</section>
</div>
<div id="content-request-authority">
<section id="section-2.2.3">
          <h4 id="name-authority">
<a class="section-number selfRef" href="#section-2.2.3">2.2.3. </a><a class="section-name selfRef" href="#name-authority">Authority</a>
          </h4>
<p id="section-2.2.3-1">The <code>@authority</code> derived component refers to the authority component of the target URI of the HTTP request message, as defined in <span>[<a class="cite xref" href="#RFC9110">HTTP</a>], <a class="relref" href="https://rfc-editor.org/rfc/rfc9110#section-7.2">Section 7.2</a></span>. In HTTP/1.1, this is usually conveyed using the Host header field, while in HTTP/2 and HTTP/3 it is conveyed using the :authority pseudo-header. The value is the fully qualified authority component of the request, comprised of the host and, optionally, port of the request target, as a string.
The component value <span class="bcp14">MUST</span> be normalized according to the rules provided in <span>[<a class="cite xref" href="#RFC9110">HTTP</a>], <a class="relref" href="https://rfc-editor.org/rfc/rfc9110#section-4.2.3">Section 4.2.3</a></span>. Namely, the hostname is normalized to lowercase, and the default port is omitted.<a class="pilcrow" href="#section-2.2.3-1">¶</a></p>
<p id="section-2.2.3-2">For example, the following request message:<a class="pilcrow" href="#section-2.2.3-2">¶</a></p>
<div class="lang-http-message sourcecode" id="section-2.2.3-3">
<pre>POST /path?param=value HTTP/1.1
Host: www.example.com
</pre><a class="pilcrow" href="#section-2.2.3-3">¶</a>
</div>
<p id="section-2.2.3-4">would result in the following <code>@authority</code> component value:<a class="pilcrow" href="#section-2.2.3-4">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.3-5">
<pre>www.example.com
</pre><a class="pilcrow" href="#section-2.2.3-5">¶</a>
</div>
<p id="section-2.2.3-6">and the following signature base line:<a class="pilcrow" href="#section-2.2.3-6">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.3-7">
<pre>"@authority": www.example.com
</pre><a class="pilcrow" href="#section-2.2.3-7">¶</a>
</div>
<p id="section-2.2.3-8">The <code>@authority</code> derived component <span class="bcp14">SHOULD</span> be used instead of signing the Host header field directly.  See <a class="auto internal xref" href="#security-not-fields">Section 7.2.4</a>.<a class="pilcrow" href="#section-2.2.3-8">¶</a></p>
</section>
</div>
<div id="content-request-scheme">
<section id="section-2.2.4">
          <h4 id="name-scheme">
<a class="section-number selfRef" href="#section-2.2.4">2.2.4. </a><a class="section-name selfRef" href="#name-scheme">Scheme</a>
          </h4>
<p id="section-2.2.4-1">The <code>@scheme</code> derived component refers to the scheme of the target URL of the HTTP request message. The component value is the scheme as a lowercase string as defined in <span>[<a class="cite xref" href="#RFC9110">HTTP</a>], <a class="relref" href="https://rfc-editor.org/rfc/rfc9110#section-4.2">Section 4.2</a></span>.
While the scheme itself is case insensitive, it <span class="bcp14">MUST</span> be normalized to lowercase for
inclusion in the signature base.<a class="pilcrow" href="#section-2.2.4-1">¶</a></p>
<p id="section-2.2.4-2">For example, the following request message sent over plain HTTP:<a class="pilcrow" href="#section-2.2.4-2">¶</a></p>
<div class="lang-http-message sourcecode" id="section-2.2.4-3">
<pre>POST /path?param=value HTTP/1.1
Host: www.example.com
</pre><a class="pilcrow" href="#section-2.2.4-3">¶</a>
</div>
<p id="section-2.2.4-4">would result in the following <code>@scheme</code> component value:<a class="pilcrow" href="#section-2.2.4-4">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.4-5">
<pre>http
</pre><a class="pilcrow" href="#section-2.2.4-5">¶</a>
</div>
<p id="section-2.2.4-6">and the following signature base line:<a class="pilcrow" href="#section-2.2.4-6">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.4-7">
<pre>"@scheme": http
</pre><a class="pilcrow" href="#section-2.2.4-7">¶</a>
</div>
</section>
</div>
<div id="content-request-target">
<section id="section-2.2.5">
          <h4 id="name-request-target">
<a class="section-number selfRef" href="#section-2.2.5">2.2.5. </a><a class="section-name selfRef" href="#name-request-target">Request Target</a>
          </h4>
<p id="section-2.2.5-1">The <code>@request-target</code> derived component refers to the full request target of the HTTP request message,
as defined in <span>[<a class="cite xref" href="#RFC9110">HTTP</a>], <a class="relref" href="https://rfc-editor.org/rfc/rfc9110#section-7.1">Section 7.1</a></span>. The component value of the request target can take different forms,
depending on the type of request, as described below.<a class="pilcrow" href="#section-2.2.5-1">¶</a></p>
<p id="section-2.2.5-2">For HTTP/1.1, the component value is equivalent to the request target
portion of the request line. However, this value is more difficult to reliably construct in
other versions of HTTP. Therefore, it is <span class="bcp14">NOT RECOMMENDED</span> that this component be used
when versions of HTTP other than 1.1 might be in use.<a class="pilcrow" href="#section-2.2.5-2">¶</a></p>
<p id="section-2.2.5-3">The origin form value is a combination of the absolute path and query components of the request URL.<a class="pilcrow" href="#section-2.2.5-3">¶</a></p>
<p id="section-2.2.5-4">For example, the following request message:<a class="pilcrow" href="#section-2.2.5-4">¶</a></p>
<div class="lang-http-message sourcecode" id="section-2.2.5-5">
<pre>POST /path?param=value HTTP/1.1
Host: www.example.com
</pre><a class="pilcrow" href="#section-2.2.5-5">¶</a>
</div>
<p id="section-2.2.5-6">would result in the following <code>@request-target</code> component value:<a class="pilcrow" href="#section-2.2.5-6">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.5-7">
<pre>/path?param=value
</pre><a class="pilcrow" href="#section-2.2.5-7">¶</a>
</div>
<p id="section-2.2.5-8">and the following signature base line:<a class="pilcrow" href="#section-2.2.5-8">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.5-9">
<pre>"@request-target": /path?param=value
</pre><a class="pilcrow" href="#section-2.2.5-9">¶</a>
</div>
<p id="section-2.2.5-10">The following request to an HTTP proxy with the absolute-form value, containing the fully qualified target URI:<a class="pilcrow" href="#section-2.2.5-10">¶</a></p>
<div class="lang-http-message sourcecode" id="section-2.2.5-11">
<pre>GET https://www.example.com/path?param=value HTTP/1.1
</pre><a class="pilcrow" href="#section-2.2.5-11">¶</a>
</div>
<p id="section-2.2.5-12">would result in the following <code>@request-target</code> component value:<a class="pilcrow" href="#section-2.2.5-12">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.5-13">
<pre>https://www.example.com/path?param=value
</pre><a class="pilcrow" href="#section-2.2.5-13">¶</a>
</div>
<p id="section-2.2.5-14">and the following signature base line:<a class="pilcrow" href="#section-2.2.5-14">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.5-15">
<pre>"@request-target": https://www.example.com/path?param=value
</pre><a class="pilcrow" href="#section-2.2.5-15">¶</a>
</div>
<p id="section-2.2.5-16">The following CONNECT request with an authority-form value, containing the host and port of the target:<a class="pilcrow" href="#section-2.2.5-16">¶</a></p>
<div class="lang-http-message sourcecode" id="section-2.2.5-17">
<pre>CONNECT www.example.com:80 HTTP/1.1
Host: www.example.com
</pre><a class="pilcrow" href="#section-2.2.5-17">¶</a>
</div>
<p id="section-2.2.5-18">would result in the following <code>@request-target</code> component value:<a class="pilcrow" href="#section-2.2.5-18">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.5-19">
<pre>www.example.com:80
</pre><a class="pilcrow" href="#section-2.2.5-19">¶</a>
</div>
<p id="section-2.2.5-20">and the following signature base line:<a class="pilcrow" href="#section-2.2.5-20">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.5-21">
<pre>"@request-target": www.example.com:80
</pre><a class="pilcrow" href="#section-2.2.5-21">¶</a>
</div>
<p id="section-2.2.5-22">The following OPTIONS request message with the asterisk-form value, containing a single asterisk (<code>*</code>) character:<a class="pilcrow" href="#section-2.2.5-22">¶</a></p>
<div class="lang-http-message sourcecode" id="section-2.2.5-23">
<pre>OPTIONS * HTTP/1.1
Host: www.example.com
</pre><a class="pilcrow" href="#section-2.2.5-23">¶</a>
</div>
<p id="section-2.2.5-24">would result in the following <code>@request-target</code> component value:<a class="pilcrow" href="#section-2.2.5-24">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.5-25">
<pre>*
</pre><a class="pilcrow" href="#section-2.2.5-25">¶</a>
</div>
<p id="section-2.2.5-26">and the following signature base line:<a class="pilcrow" href="#section-2.2.5-26">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.5-27">
<pre>"@request-target": *
</pre><a class="pilcrow" href="#section-2.2.5-27">¶</a>
</div>
</section>
</div>
<div id="content-request-path">
<section id="section-2.2.6">
          <h4 id="name-path">
<a class="section-number selfRef" href="#section-2.2.6">2.2.6. </a><a class="section-name selfRef" href="#name-path">Path</a>
          </h4>
<p id="section-2.2.6-1">The <code>@path</code> derived component refers to the target path of the HTTP request message. The component value is the absolute path of the request target defined by <span>[<a class="cite xref" href="#RFC3986">URI</a>]</span>, with no query component and no trailing question mark (<code>?</code>) character. The value is normalized according to the rules provided in <span>[<a class="cite xref" href="#RFC9110">HTTP</a>], <a class="relref" href="https://rfc-editor.org/rfc/rfc9110#section-4.2.3">Section 4.2.3</a></span>. Namely, an empty path string is normalized as a single slash (<code>/</code>) character. Path components are represented by their values before decoding any percent-encoded octets, as described in the simple string comparison rules provided in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc3986#section-6.2.1">Section 6.2.1</a> of [<a class="cite xref" href="#RFC3986">URI</a>]</span>.<a class="pilcrow" href="#section-2.2.6-1">¶</a></p>
<p id="section-2.2.6-2">For example, the following request message:<a class="pilcrow" href="#section-2.2.6-2">¶</a></p>
<div class="lang-http-message sourcecode" id="section-2.2.6-3">
<pre>GET /path?param=value HTTP/1.1
Host: www.example.com
</pre><a class="pilcrow" href="#section-2.2.6-3">¶</a>
</div>
<p id="section-2.2.6-4">would result in the following <code>@path</code> component value:<a class="pilcrow" href="#section-2.2.6-4">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.6-5">
<pre>/path
</pre><a class="pilcrow" href="#section-2.2.6-5">¶</a>
</div>
<p id="section-2.2.6-6">and the following signature base line:<a class="pilcrow" href="#section-2.2.6-6">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.6-7">
<pre>"@path": /path
</pre><a class="pilcrow" href="#section-2.2.6-7">¶</a>
</div>
</section>
</div>
<div id="content-request-query">
<section id="section-2.2.7">
          <h4 id="name-query">
<a class="section-number selfRef" href="#section-2.2.7">2.2.7. </a><a class="section-name selfRef" href="#name-query">Query</a>
          </h4>
<p id="section-2.2.7-1">The <code>@query</code> derived component refers to the query component of the HTTP request message. The component value is the entire normalized query string defined by <span>[<a class="cite xref" href="#RFC3986">URI</a>]</span>, including the leading <code>?</code> character. The value is read using the simple string comparison rules provided in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc3986#section-6.2.1">Section 6.2.1</a> of [<a class="cite xref" href="#RFC3986">URI</a>]</span>. Namely, percent-encoded octets are not decoded.<a class="pilcrow" href="#section-2.2.7-1">¶</a></p>
<p id="section-2.2.7-2">For example, the following request message:<a class="pilcrow" href="#section-2.2.7-2">¶</a></p>
<div class="lang-http-message sourcecode" id="section-2.2.7-3">
<pre>GET /path?param=value&amp;foo=bar&amp;baz=bat%2Dman HTTP/1.1
Host: www.example.com
</pre><a class="pilcrow" href="#section-2.2.7-3">¶</a>
</div>
<p id="section-2.2.7-4">would result in the following <code>@query</code> component value:<a class="pilcrow" href="#section-2.2.7-4">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.7-5">
<pre>?param=value&amp;foo=bar&amp;baz=bat%2Dman
</pre><a class="pilcrow" href="#section-2.2.7-5">¶</a>
</div>
<p id="section-2.2.7-6">and the following signature base line:<a class="pilcrow" href="#section-2.2.7-6">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.7-7">
<pre>"@query": ?param=value&amp;foo=bar&amp;baz=bat%2Dman
</pre><a class="pilcrow" href="#section-2.2.7-7">¶</a>
</div>
<p id="section-2.2.7-8">The following request message:<a class="pilcrow" href="#section-2.2.7-8">¶</a></p>
<div class="lang-http-message sourcecode" id="section-2.2.7-9">
<pre>POST /path?queryString HTTP/1.1
Host: www.example.com
</pre><a class="pilcrow" href="#section-2.2.7-9">¶</a>
</div>
<p id="section-2.2.7-10">would result in the following <code>@query</code> component value:<a class="pilcrow" href="#section-2.2.7-10">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.7-11">
<pre>?queryString
</pre><a class="pilcrow" href="#section-2.2.7-11">¶</a>
</div>
<p id="section-2.2.7-12">and the following signature base line:<a class="pilcrow" href="#section-2.2.7-12">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.7-13">
<pre>"@query": ?queryString
</pre><a class="pilcrow" href="#section-2.2.7-13">¶</a>
</div>
<p id="section-2.2.7-14">Just like including an empty path component, the signer can include an empty query component to indicate that this component is not used in the message. If the query string is absent from the request message, the component value is the leading <code>?</code> character alone:<a class="pilcrow" href="#section-2.2.7-14">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.7-15">
<pre>?
</pre><a class="pilcrow" href="#section-2.2.7-15">¶</a>
</div>
<p id="section-2.2.7-16">resulting in the following signature base line:<a class="pilcrow" href="#section-2.2.7-16">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.7-17">
<pre>"@query": ?
</pre><a class="pilcrow" href="#section-2.2.7-17">¶</a>
</div>
</section>
</div>
<div id="content-request-query-param">
<section id="section-2.2.8">
          <h4 id="name-query-parameters">
<a class="section-number selfRef" href="#section-2.2.8">2.2.8. </a><a class="section-name selfRef" href="#name-query-parameters">Query Parameters</a>
          </h4>
<p id="section-2.2.8-1">If the query portion of a request target URI uses HTML form parameters in the format defined in Section <span><a class="relref" href="https://url.spec.whatwg.org/#application/x-www-form-urlencoded">5</a> (<a class="relref" href="https://url.spec.whatwg.org/#application/x-www-form-urlencoded">"application/x-www-form-urlencoded"</a>)</span> of
<span>[<a class="cite xref" href="#HTMLURL">HTMLURL</a>]</span>,
the <code>@query-param</code> derived component allows addressing of these individual query parameters. The query parameters <span class="bcp14">MUST</span> be parsed according to
Section <span><a class="relref" href="https://url.spec.whatwg.org/#urlencoded-parsing">5.1</a> (<a class="relref" href="https://url.spec.whatwg.org/#urlencoded-parsing">"application/x-www-form-urlencoded parsing"</a>)</span>
of <span>[<a class="cite xref" href="#HTMLURL">HTMLURL</a>]</span>, resulting in a list of (<code>nameString</code>, <code>valueString</code>) tuples.
The <span class="bcp14">REQUIRED</span> <code>name</code> parameter of each component identifier contains the encoded <code>nameString</code> of a single query parameter as a String value.
The component value of a single named parameter is the encoded <code>valueString</code> of that single query parameter.
Several different named query parameters <span class="bcp14">MAY</span> be included in the covered components.
Single named parameters <span class="bcp14">MAY</span> occur in any order in the covered components, regardless of the order they occur in the query string.<a class="pilcrow" href="#section-2.2.8-1">¶</a></p>
<p id="section-2.2.8-2">The value of the <code>name</code> parameter and the component value of a single named parameter are calculated via the following process:<a class="pilcrow" href="#section-2.2.8-2">¶</a></p>
<ol class="normal type-1" id="section-2.2.8-3" start="1" type="1">
<li id="section-2.2.8-3.1">Parse the <code>nameString</code> or <code>valueString</code> of the named query parameter defined by 
Section <span><a class="relref" href="https://url.spec.whatwg.org/#urlencoded-parsing">5.1</a> (<a class="relref" href="https://url.spec.whatwg.org/#urlencoded-parsing">"application/x-www-form-urlencoded parsing"</a>)</span>
of <span>[<a class="cite xref" href="#HTMLURL">HTMLURL</a>]</span>; this is the value after percent-encoded octets are decoded.<a class="pilcrow" href="#section-2.2.8-3.1">¶</a>
</li>
            <li id="section-2.2.8-3.2">Encode the <code>nameString</code> or <code>valueString</code> using the "percent-encode after encoding" process defined by 
Section <span><a class="relref" href="https://url.spec.whatwg.org/#urlencoded-serializing">5.2</a> (<a class="relref" href="https://url.spec.whatwg.org/#urlencoded-serializing">"application/x-www-form-urlencoded serializing"</a>)</span> of <span>[<a class="cite xref" href="#HTMLURL">HTMLURL</a>]</span>; this results in an ASCII string <span>[<a class="cite xref" href="#RFC0020">ASCII</a>]</span>.<a class="pilcrow" href="#section-2.2.8-3.2">¶</a>
</li>
            <li id="section-2.2.8-3.3">Output the ASCII string.<a class="pilcrow" href="#section-2.2.8-3.3">¶</a>
</li>
          </ol>
<p id="section-2.2.8-4">Note that the component value does not include any leading question mark (<code>?</code>) characters, equals sign (<code>=</code>) characters, or separating ampersand (<code>&amp;</code>) characters.
Named query parameters with an empty <code>valueString</code> have an empty string as the component value. Note that due to inconsistencies in implementations, some query parameter parsing libraries drop such empty values.<a class="pilcrow" href="#section-2.2.8-4">¶</a></p>
<p id="section-2.2.8-5">If a query parameter is named as a covered component but it does not occur in the query parameters, this <span class="bcp14">MUST</span> cause an error in the signature base generation.<a class="pilcrow" href="#section-2.2.8-5">¶</a></p>
<p id="section-2.2.8-6">For example, for the following request:<a class="pilcrow" href="#section-2.2.8-6">¶</a></p>
<div class="lang-http-message sourcecode" id="section-2.2.8-7">
<pre>GET /path?param=value&amp;foo=bar&amp;baz=batman&amp;qux= HTTP/1.1
Host: www.example.com
</pre><a class="pilcrow" href="#section-2.2.8-7">¶</a>
</div>
<p id="section-2.2.8-8">Indicating the <code>baz</code>, <code>qux</code>, and <code>param</code> named query parameters would result in the following <code>@query-param</code> component values:<a class="pilcrow" href="#section-2.2.8-8">¶</a></p>
<p id="section-2.2.8-9"><em>baz</em>: <code>batman</code><a class="pilcrow" href="#section-2.2.8-9">¶</a></p>
<p id="section-2.2.8-10"><em>qux</em>: an empty string<a class="pilcrow" href="#section-2.2.8-10">¶</a></p>
<p id="section-2.2.8-11"><em>param</em>: <code>value</code><a class="pilcrow" href="#section-2.2.8-11">¶</a></p>
<p id="section-2.2.8-12">and the following signature base lines, with (SP) indicating a single trailing space character before the empty component value:<a class="pilcrow" href="#section-2.2.8-12">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.8-13">
<pre>"@query-param";name="baz": batman
"@query-param";name="qux":(SP)
"@query-param";name="param": value
</pre><a class="pilcrow" href="#section-2.2.8-13">¶</a>
</div>
<p id="section-2.2.8-14">This derived component has some limitations. Specifically, the algorithms provided in Section <span><a class="relref" href="https://url.spec.whatwg.org/#application/x-www-form-urlencoded">5</a> (<a class="relref" href="https://url.spec.whatwg.org/#application/x-www-form-urlencoded">"application/x-www-form-urlencoded"</a>)</span> of
<span>[<a class="cite xref" href="#HTMLURL">HTMLURL</a>]</span> only support query parameters using percent-escaped UTF-8 encoding. Other encodings are not supported.
Additionally, multiple instances of a named parameter are not reliably supported in the wild. If a parameter name occurs multiple times in a request, the named query parameter <span class="bcp14">MUST NOT</span> be included. If multiple parameters are common within an application, it is <span class="bcp14">RECOMMENDED</span> to sign the entire query string using the <code>@query</code> component identifier defined in <a class="auto internal xref" href="#content-request-query">Section 2.2.7</a>.<a class="pilcrow" href="#section-2.2.8-14">¶</a></p>
<p id="section-2.2.8-15">The encoding process allows query parameters that include newlines or other problematic characters in their values, or with alternative encodings such as using the plus (+) character to represent spaces. For the query parameters in this message:<a class="pilcrow" href="#section-2.2.8-15">¶</a></p>
<div class="lang-http-message sourcecode" id="section-2.2.8-16">
<pre>NOTE: '\' line wrapping per RFC 8792

GET /parameters?var=this%20is%20a%20big%0Amultiline%20value&amp;\
  bar=with+plus+whitespace&amp;fa%C3%A7ade%22%3A%20=something HTTP/1.1
Host: www.example.com
Date: Tue, 20 Apr 2021 02:07:56 GMT
</pre><a class="pilcrow" href="#section-2.2.8-16">¶</a>
</div>
<p id="section-2.2.8-17">The resulting values are encoded as follows:<a class="pilcrow" href="#section-2.2.8-17">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.8-18">
<pre>"@query-param";name="var": this%20is%20a%20big%0Amultiline%20value
"@query-param";name="bar": with%20plus%20whitespace
"@query-param";name="fa%C3%A7ade%22%3A%20": something
</pre><a class="pilcrow" href="#section-2.2.8-18">¶</a>
</div>
<p id="section-2.2.8-19">If the encoding were not applied, the resultant values would be:<a class="pilcrow" href="#section-2.2.8-19">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.8-20">
<pre>"@query-param";name="var": this is a big
multiline value
"@query-param";name="bar": with plus whitespace
"@query-param";name="façade\": ": something
</pre><a class="pilcrow" href="#section-2.2.8-20">¶</a>
</div>
<p id="section-2.2.8-21">This base string contains characters that violate the constraints on component names and values and is therefore invalid.<a class="pilcrow" href="#section-2.2.8-21">¶</a></p>
</section>
</div>
<div id="content-status-code">
<section id="section-2.2.9">
          <h4 id="name-status-code">
<a class="section-number selfRef" href="#section-2.2.9">2.2.9. </a><a class="section-name selfRef" href="#name-status-code">Status Code</a>
          </h4>
<p id="section-2.2.9-1">The <code>@status</code> derived component refers to the three-digit numeric HTTP status code of a response message as defined in <span>[<a class="cite xref" href="#RFC9110">HTTP</a>], <a class="relref" href="https://rfc-editor.org/rfc/rfc9110#section-15">Section 15</a></span>. The component value is the serialized three-digit integer of the HTTP status code, with no descriptive text.<a class="pilcrow" href="#section-2.2.9-1">¶</a></p>
<p id="section-2.2.9-2">For example, the following response message:<a class="pilcrow" href="#section-2.2.9-2">¶</a></p>
<div class="lang-http-message sourcecode" id="section-2.2.9-3">
<pre>HTTP/1.1 200 OK
Date: Fri, 26 Mar 2010 00:05:00 GMT
</pre><a class="pilcrow" href="#section-2.2.9-3">¶</a>
</div>
<p id="section-2.2.9-4">would result in the following <code>@status</code> component value:<a class="pilcrow" href="#section-2.2.9-4">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.9-5">
<pre>200
</pre><a class="pilcrow" href="#section-2.2.9-5">¶</a>
</div>
<p id="section-2.2.9-6">and the following signature base line:<a class="pilcrow" href="#section-2.2.9-6">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.9-7">
<pre>"@status": 200
</pre><a class="pilcrow" href="#section-2.2.9-7">¶</a>
</div>
<p id="section-2.2.9-8">The <code>@status</code> component identifier <span class="bcp14">MUST NOT</span> be used in a request message.<a class="pilcrow" href="#section-2.2.9-8">¶</a></p>
</section>
</div>
</section>
</div>
<div id="signature-params">
<section id="section-2.3">
        <h3 id="name-signature-parameters">
<a class="section-number selfRef" href="#section-2.3">2.3. </a><a class="section-name selfRef" href="#name-signature-parameters">Signature Parameters</a>
        </h3>
<p id="section-2.3-1">HTTP message signatures have metadata properties that provide information regarding the signature's generation and verification, consisting of the ordered set of covered components and the ordered set of parameters, where the parameters include a timestamp of signature creation, identifiers for verification key material, and other utilities. This metadata is represented by a special message component in the signature base for signature parameters; this special message component is treated slightly differently from other message components. Specifically, the signature parameters message component is <span class="bcp14">REQUIRED</span> as the last line of the <span><a class="internal xref" href="#create-sig-input">signature base</a> (<a class="auto internal xref" href="#create-sig-input">Section 2.5</a>)</span>, and the component identifier <span class="bcp14">MUST NOT</span> be enumerated within the set of covered components for any signature, including itself.<a class="pilcrow" href="#section-2.3-1">¶</a></p>
<p id="section-2.3-2">The signature parameters component name is <code>@signature-params</code>.<a class="pilcrow" href="#section-2.3-2">¶</a></p>
<p id="section-2.3-3">The signature parameters component value is the serialization of the signature parameters for this signature, including the covered components ordered set with all associated parameters. These parameters include any of the following:<a class="pilcrow" href="#section-2.3-3">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.3-4">
          <dt id="section-2.3-4.1">
            <code>created</code>:
          </dt>
          <dd id="section-2.3-4.2" style="margin-left: 1.5em">Creation time as a UNIX timestamp value of type Integer. Sub-second precision is not supported. The inclusion of this parameter is <span class="bcp14">RECOMMENDED</span>.<a class="pilcrow" href="#section-2.3-4.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-4.3">
            <code>expires</code>:
          </dt>
          <dd id="section-2.3-4.4" style="margin-left: 1.5em">Expiration time as a UNIX timestamp value of type Integer. Sub-second precision is not supported.<a class="pilcrow" href="#section-2.3-4.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-4.5">
            <code>nonce</code>:
          </dt>
          <dd id="section-2.3-4.6" style="margin-left: 1.5em">A random unique value generated for this signature as a String value.<a class="pilcrow" href="#section-2.3-4.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-4.7">
            <code>alg</code>:
          </dt>
          <dd id="section-2.3-4.8" style="margin-left: 1.5em">The HTTP message signature algorithm from the "HTTP Signature Algorithms" registry, as a String value.<a class="pilcrow" href="#section-2.3-4.8">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-4.9">
            <code>keyid</code>:
          </dt>
          <dd id="section-2.3-4.10" style="margin-left: 1.5em">The identifier for the key material as a String value.<a class="pilcrow" href="#section-2.3-4.10">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.3-4.11">
            <code>tag</code>:
          </dt>
          <dd id="section-2.3-4.12" style="margin-left: 1.5em">An application-specific tag for the signature as a String value. This value is used by applications to help identify signatures relevant for specific applications or protocols.<a class="pilcrow" href="#section-2.3-4.12">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-2.3-5">Additional parameters can be defined in the <span><a class="internal xref" href="#param-registry">"HTTP Signature Metadata Parameters" registry</a> (<a class="auto internal xref" href="#param-registry">Section 6.3</a>)</span>. Note that the parameters are not in any general order, but once an ordering is chosen for a given set of parameters, it cannot be changed without altering the signature parameters value.<a class="pilcrow" href="#section-2.3-5">¶</a></p>
<p id="section-2.3-6">The signature parameters component value is serialized as a parameterized Inner List using the rules provided in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8941#section-4">Section 4</a> of [<a class="cite xref" href="#RFC8941">STRUCTURED-FIELDS</a>]</span> as follows:<a class="pilcrow" href="#section-2.3-6">¶</a></p>
<ol class="normal type-1" id="section-2.3-7" start="1" type="1">
<li id="section-2.3-7.1">Let the output be an empty string.<a class="pilcrow" href="#section-2.3-7.1">¶</a>
</li>
          <li id="section-2.3-7.2">Determine an order for the component identifiers of the covered components, not including the <code>@signature-params</code> component identifier itself. Once this order is chosen, it cannot be changed. This order <span class="bcp14">MUST</span> be the same order as that used in creating the signature base
(<a class="auto internal xref" href="#create-sig-input">Section 2.5</a>).<a class="pilcrow" href="#section-2.3-7.2">¶</a>
</li>
          <li id="section-2.3-7.3">Serialize the component identifiers of the covered components, including all parameters, as an ordered Inner List of String values according to <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8941#section-4.1.1.1">Section 4.1.1.1</a> of [<a class="cite xref" href="#RFC8941">STRUCTURED-FIELDS</a>]</span>; then, append this to the output. Note that the component identifiers can include their own parameters, and these parameters are ordered sets. Once an order is chosen for a component's parameters, the order cannot be changed.<a class="pilcrow" href="#section-2.3-7.3">¶</a>
</li>
          <li id="section-2.3-7.4">Determine an order for any signature parameters. Once this order is chosen, it cannot be changed.<a class="pilcrow" href="#section-2.3-7.4">¶</a>
</li>
          <li id="section-2.3-7.5">Append the parameters to the Inner List in order according to <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8941#section-4.1.1.2">Section 4.1.1.2</a> of [<a class="cite xref" href="#RFC8941">STRUCTURED-FIELDS</a>]</span>,
 skipping parameters that are not available or not used for this message signature.<a class="pilcrow" href="#section-2.3-7.5">¶</a>
</li>
          <li id="section-2.3-7.6">The output contains the signature parameters component value.<a class="pilcrow" href="#section-2.3-7.6">¶</a>
</li>
        </ol>
<p id="section-2.3-8">Note that the Inner List serialization from <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8941#section-4.1.1.1">Section 4.1.1.1</a> of [<a class="cite xref" href="#RFC8941">STRUCTURED-FIELDS</a>]</span> is used for the covered component value instead of the List serialization from <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8941#section-4.1.1">Section 4.1.1</a> of [<a class="cite xref" href="#RFC8941">STRUCTURED-FIELDS</a>]</span>
in order to facilitate parallelism with this value's inclusion in the Signature-Input field,
as discussed in <a class="auto internal xref" href="#signature-input-header">Section 4.1</a>.<a class="pilcrow" href="#section-2.3-8">¶</a></p>
<p id="section-2.3-9">This example shows the serialized component value for the parameters of an example message signature:<a class="pilcrow" href="#section-2.3-9">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.3-10">
<pre>NOTE: '\' line wrapping per RFC 8792

("@target-uri" "@authority" "date" "cache-control")\
  ;keyid="test-key-rsa-pss";alg="rsa-pss-sha512";\
  created=1618884475;expires=1618884775
</pre><a class="pilcrow" href="#section-2.3-10">¶</a>
</div>
<p id="section-2.3-11">Note that an HTTP message could contain <span><a class="internal xref" href="#signature-multiple">multiple signatures</a> (<a class="auto internal xref" href="#signature-multiple">Section 4.3</a>)</span>, but only the signature parameters used for a single signature are included in a given signature parameters entry.<a class="pilcrow" href="#section-2.3-11">¶</a></p>
</section>
</div>
<div id="content-request-response">
<section id="section-2.4">
        <h3 id="name-signing-request-components-">
<a class="section-number selfRef" href="#section-2.4">2.4. </a><a class="section-name selfRef" href="#name-signing-request-components-">Signing Request Components in a Response Message</a>
        </h3>
<p id="section-2.4-1">When a request message results in a signed response message, the signer can include portions of the request message in the signature base by adding the <code>req</code> parameter to the component identifier.<a class="pilcrow" href="#section-2.4-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.4-2">
          <dt id="section-2.4-2.1"><code>req</code></dt>
          <dd id="section-2.4-2.2" style="margin-left: 1.5em">
            <p id="section-2.4-2.2.1">A Boolean flag indicating that the component value is derived from the request that triggered this response message and not from the response message directly.<a class="pilcrow" href="#section-2.4-2.2.1">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-2.4-3">This parameter can be applied to both HTTP fields and derived components that target the request, with the same semantics. The component value for a message component using this parameter is calculated in the same manner as it is normally, but data is pulled from the request message instead of the target response message to which the signature is applied.<a class="pilcrow" href="#section-2.4-3">¶</a></p>
<p id="section-2.4-4">Note that the same component name <span class="bcp14">MAY</span> be included with and without the <code>req</code> parameter in a single signature base, indicating the same named component from both the request message and the response message.<a class="pilcrow" href="#section-2.4-4">¶</a></p>
<p id="section-2.4-5">The <code>req</code> parameter <span class="bcp14">MAY</span> be combined with other parameters as appropriate for the component identifier, such as the <code>key</code> parameter for a Dictionary field.<a class="pilcrow" href="#section-2.4-5">¶</a></p>
<p id="section-2.4-6">For example, when serving a response for this request:<a class="pilcrow" href="#section-2.4-6">¶</a></p>
<div class="lang-http-message sourcecode" id="section-2.4-7">
<pre>NOTE: '\' line wrapping per RFC 8792

POST /foo?param=Value&amp;Pet=dog HTTP/1.1
Host: example.com
Date: Tue, 20 Apr 2021 02:07:55 GMT
Content-Digest: sha-512=:WZDPaVn/7XgHaAy8pmojAkGWoRx2UFChF41A2svX+T\
  aPm+AbwAgBWnrIiYllu7BNNyealdVLvRwEmTHWXvJwew==:
Content-Type: application/json
Content-Length: 18

{"hello": "world"}
</pre><a class="pilcrow" href="#section-2.4-7">¶</a>
</div>
<p id="section-2.4-8">This would result in the following unsigned response message:<a class="pilcrow" href="#section-2.4-8">¶</a></p>
<div class="lang-http-message sourcecode" id="section-2.4-9">
<pre>NOTE: '\' line wrapping per RFC 8792

HTTP/1.1 503 Service Unavailable
Date: Tue, 20 Apr 2021 02:07:56 GMT
Content-Type: application/json
Content-Length: 62
Content-Digest: sha-512=:0Y6iCBzGg5rZtoXS95Ijz03mslf6KAMCloESHObfwn\
  HJDbkkWWQz6PhhU9kxsTbARtY2PTBOzq24uJFpHsMuAg==:

{"busy": true, "message": "Your call is very important to us"}
</pre><a class="pilcrow" href="#section-2.4-9">¶</a>
</div>
<p id="section-2.4-10">The server signs the response with its own key, including the <code>@status</code> code and several header fields in the covered components. While this covers a reasonable amount of the response for this application, the server additionally includes several components derived from the original request message that triggered this response. In this example, the server includes the method, authority, path, and content digest from the request in the covered components of the response. The Content-Digest for both the request and the response is included under the response signature. For the application in this example, the query is deemed not to be relevant to the response and is therefore not covered. Other applications would make different decisions based on application needs, as discussed in <a class="auto internal xref" href="#application">Section 1.4</a>.<a class="pilcrow" href="#section-2.4-10">¶</a></p>
<p id="section-2.4-11">The signature base for this example is:<a class="pilcrow" href="#section-2.4-11">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.4-12">
<pre>NOTE: '\' line wrapping per RFC 8792

"@status": 503
"content-digest": sha-512=:0Y6iCBzGg5rZtoXS95Ijz03mslf6KAMCloESHObf\
  wnHJDbkkWWQz6PhhU9kxsTbARtY2PTBOzq24uJFpHsMuAg==:
"content-type": application/json
"@authority";req: example.com
"@method";req: POST
"@path";req: /foo
"content-digest";req: sha-512=:WZDPaVn/7XgHaAy8pmojAkGWoRx2UFChF41A\
  2svX+TaPm+AbwAgBWnrIiYllu7BNNyealdVLvRwEmTHWXvJwew==:
"@signature-params": ("@status" "content-digest" "content-type" \
  "@authority";req "@method";req "@path";req "content-digest";req)\
  ;created=1618884479;keyid="test-key-ecc-p256"
</pre><a class="pilcrow" href="#section-2.4-12">¶</a>
</div>
<p id="section-2.4-13">The signed response message is:<a class="pilcrow" href="#section-2.4-13">¶</a></p>
<div class="lang-http-message sourcecode" id="section-2.4-14">
<pre>NOTE: '\' line wrapping per RFC 8792

HTTP/1.1 503 Service Unavailable
Date: Tue, 20 Apr 2021 02:07:56 GMT
Content-Type: application/json
Content-Length: 62
Content-Digest: sha-512=:0Y6iCBzGg5rZtoXS95Ijz03mslf6KAMCloESHObfwn\
  HJDbkkWWQz6PhhU9kxsTbARtY2PTBOzq24uJFpHsMuAg==:
Signature-Input: reqres=("@status" "content-digest" "content-type" \
  "@authority";req "@method";req "@path";req "content-digest";req)\
  ;created=1618884479;keyid="test-key-ecc-p256"
Signature: reqres=:dMT/A/76ehrdBTD/2Xx8QuKV6FoyzEP/I9hdzKN8LQJLNgzU\
  4W767HK05rx1i8meNQQgQPgQp8wq2ive3tV5Ag==:

{"busy": true, "message": "Your call is very important to us"}
</pre><a class="pilcrow" href="#section-2.4-14">¶</a>
</div>
<p id="section-2.4-15">Note that the ECDSA signature algorithm in use here is non-deterministic, meaning that a different signature value will be created every time the algorithm is run. The signature value provided here can be validated against the given keys, but newly generated signature values are not expected to match the example. See <a class="auto internal xref" href="#security-nondeterministic">Section 7.3.5</a>.<a class="pilcrow" href="#section-2.4-15">¶</a></p>
<p id="section-2.4-16">Since the component values from the request are not repeated in the response message, the requester <span class="bcp14">MUST</span> keep the original message component values around long enough to validate the signature of the response that uses this component identifier parameter. In most cases, this means the requester needs to keep the original request message around, since the signer could choose to include any portions of the request in its response, according to the needs of the application. Since it is possible for an intermediary to alter a request message before it is processed by the server, applications need to take care not to sign such altered values, as the client would not be able to validate the resulting signature.<a class="pilcrow" href="#section-2.4-16">¶</a></p>
<p id="section-2.4-17">It is also possible for a server to create a signed response in response to a signed request.  For this example of a signed request:<a class="pilcrow" href="#section-2.4-17">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.4-18">
<pre>NOTE: '\' line wrapping per RFC 8792

POST /foo?param=Value&amp;Pet=dog HTTP/1.1
Host: example.com
Date: Tue, 20 Apr 2021 02:07:55 GMT
Content-Digest: sha-512=:WZDPaVn/7XgHaAy8pmojAkGWoRx2UFChF41A2svX+T\
  aPm+AbwAgBWnrIiYllu7BNNyealdVLvRwEmTHWXvJwew==:
Content-Type: application/json
Content-Length: 18
Signature-Input: sig1=("@method" "@authority" "@path" "@query" \
  "content-digest" "content-type" "content-length")\
  ;created=1618884475;keyid="test-key-rsa-pss"
Signature: sig1=:e8UJ5wMiRaonlth5ERtE8GIiEH7Akcr493nQ07VPNo6y3qvjdK\
  t0fo8VHO8xXDjmtYoatGYBGJVlMfIp06eVMEyNW2I4vN7XDAz7m5v1108vGzaDljr\
  d0H8+SJ28g7bzn6h2xeL/8q+qUwahWA/JmC8aOC9iVnwbOKCc0WSrLgWQwTY6VLp4\
  2Qt7jjhYT5W7/wCvfK9A1VmHH1lJXsV873Z6hpxesd50PSmO+xaNeYvDLvVdZlhtw\
  5PCtUYzKjHqwmaQ6DEuM8udRjYsoNqp2xZKcuCO1nKc0V3RjpqMZLuuyVbHDAbCzr\
  0pg2d2VM/OC33JAU7meEjjaNz+d7LWPg==:

{"hello": "world"}
</pre><a class="pilcrow" href="#section-2.4-18">¶</a>
</div>
<p id="section-2.4-19">The server could choose to sign portions of this response, including several portions of the request, resulting in this signature base:<a class="pilcrow" href="#section-2.4-19">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.4-20">
<pre>NOTE: '\' line wrapping per RFC 8792

"@status": 503
"content-digest": sha-512=:0Y6iCBzGg5rZtoXS95Ijz03mslf6KAMCloESHObf\
  wnHJDbkkWWQz6PhhU9kxsTbARtY2PTBOzq24uJFpHsMuAg==:
"content-type": application/json
"@authority";req: example.com
"@method";req: POST
"@path";req: /foo
"@query";req: ?param=Value&amp;Pet=dog
"content-digest";req: sha-512=:WZDPaVn/7XgHaAy8pmojAkGWoRx2UFChF41A\
  2svX+TaPm+AbwAgBWnrIiYllu7BNNyealdVLvRwEmTHWXvJwew==:
"content-type";req: application/json
"content-length";req: 18
"@signature-params": ("@status" "content-digest" "content-type" \
  "@authority";req "@method";req "@path";req "@query";req \
  "content-digest";req "content-type";req "content-length";req)\
  ;created=1618884479;keyid="test-key-ecc-p256"
</pre><a class="pilcrow" href="#section-2.4-20">¶</a>
</div>
<p id="section-2.4-21">and the following signed response:<a class="pilcrow" href="#section-2.4-21">¶</a></p>
<div class="lang-http-message sourcecode" id="section-2.4-22">
<pre>NOTE: '\' line wrapping per RFC 8792

HTTP/1.1 503 Service Unavailable
Date: Tue, 20 Apr 2021 02:07:56 GMT
Content-Type: application/json
Content-Length: 62
Content-Digest: sha-512=:0Y6iCBzGg5rZtoXS95Ijz03mslf6KAMCloESHObfwn\
  HJDbkkWWQz6PhhU9kxsTbARtY2PTBOzq24uJFpHsMuAg==:
Signature-Input: reqres=("@status" "content-digest" "content-type" \
  "@authority";req "@method";req "@path";req "@query";req \
  "content-digest";req "content-type";req "content-length";req)\
  ;created=1618884479;keyid="test-key-ecc-p256"
Signature: reqres=:C73J41GVKc+TYXbSobvZf0CmNcptRiWN+NY1Or0A36ISg6ym\
  dRN6ZgR2QfrtopFNzqAyv+CeWrMsNbcV2Ojsgg==:

{"busy": true, "message": "Your call is very important to us"}
</pre><a class="pilcrow" href="#section-2.4-22">¶</a>
</div>
<p id="section-2.4-23">Note that the ECDSA signature algorithm in use here is non-deterministic, meaning that a different signature value will be created every time the algorithm is run. The signature value provided here can be validated against the given keys, but newly generated signature values are not expected to match the example. See <a class="auto internal xref" href="#security-nondeterministic">Section 7.3.5</a>.<a class="pilcrow" href="#section-2.4-23">¶</a></p>
<p id="section-2.4-24">Applications signing a response to a signed request <span class="bcp14">SHOULD</span> sign all of the components of the request signature value to provide sufficient coverage and protection against a class of collision attacks, as discussed in <a class="auto internal xref" href="#security-sign-signature">Section 7.3.7</a>. The server in this example has included all components listed in the Signature-Input field of the client's signature on the request in the response signature, in addition to components of the response.<a class="pilcrow" href="#section-2.4-24">¶</a></p>
<p id="section-2.4-25">While it is syntactically possible to include the Signature and Signature-Input fields of the request message in the signature components of a response to a message using this mechanism, this practice is <span class="bcp14">NOT RECOMMENDED</span>. This is because signatures of signatures do not provide transitive coverage of covered components as one might expect, and the practice is susceptible to several attacks as discussed in <a class="auto internal xref" href="#security-sign-signature">Section 7.3.7</a>. An application that needs to signal successful processing or receipt of a signature would need to carefully specify alternative mechanisms for sending such a signal securely.<a class="pilcrow" href="#section-2.4-25">¶</a></p>
<p id="section-2.4-26">The response signature can only ever cover what is included in the request message when using this flag. Consequently, if an application needs to include the message content of the request under the signature of its response, the client needs to include a means for covering that content, such as a Content-Digest field. See the discussion in <a class="auto internal xref" href="#security-message-content">Section 7.2.8</a> for more information.<a class="pilcrow" href="#section-2.4-26">¶</a></p>
<p id="section-2.4-27">The <code>req</code> parameter <span class="bcp14">MUST NOT</span> be used for any component in a signature that targets a request message.<a class="pilcrow" href="#section-2.4-27">¶</a></p>
</section>
</div>
<div id="create-sig-input">
<section id="section-2.5">
        <h3 id="name-creating-the-signature-base">
<a class="section-number selfRef" href="#section-2.5">2.5. </a><a class="section-name selfRef" href="#name-creating-the-signature-base">Creating the Signature Base</a>
        </h3>
<p id="section-2.5-1">The signature base is an ASCII string <span>[<a class="cite xref" href="#RFC0020">ASCII</a>]</span> containing the canonicalized HTTP message components covered by the signature. The input to the signature base creation algorithm is the ordered set of covered component identifiers and their associated values, along with any additional signature parameters discussed in <a class="auto internal xref" href="#signature-params">Section 2.3</a>.<a class="pilcrow" href="#section-2.5-1">¶</a></p>
<p id="section-2.5-2">Component identifiers are serialized using the strict serialization rules defined by <span>[<a class="cite xref" href="#RFC8941">STRUCTURED-FIELDS</a>], <a class="relref" href="https://rfc-editor.org/rfc/rfc8941#section-4">Section 4</a></span>.
The component identifier has a component name, which is a String Item value serialized using the <code>sf-string</code> ABNF rule. The component identifier <span class="bcp14">MAY</span> also include defined parameters that are serialized using the <code>parameters</code> ABNF rule. The signature parameters line defined in <a class="auto internal xref" href="#signature-params">Section 2.3</a> follows this same pattern, but the component identifier is a String Item with a fixed value and no parameters, and the component value is always an Inner List with optional parameters.<a class="pilcrow" href="#section-2.5-2">¶</a></p>
<p id="section-2.5-3">Note that this means the serialization of the component name itself is encased in double quotes, with parameters following as a semicolon-separated list, such as <code>"cache-control"</code>, <code>"@authority"</code>, <code>"@signature-params"</code>, or <code>"example-dictionary";key="foo"</code>.<a class="pilcrow" href="#section-2.5-3">¶</a></p>
<p id="section-2.5-4">The output is the ordered set of bytes that form the signature base, which conforms to the following ABNF:<a class="pilcrow" href="#section-2.5-4">¶</a></p>
<div class="lang-abnf sourcecode" id="section-2.5-5">
<pre>signature-base = *( signature-base-line LF ) signature-params-line
signature-base-line = component-identifier ":" SP
    ( derived-component-value / *field-content )
    ; no obs-fold nor obs-text
component-identifier = component-name parameters
component-name = sf-string
derived-component-value = *( VCHAR / SP )
signature-params-line = DQUOTE "@signature-params" DQUOTE
     ":" SP inner-list
</pre><a class="pilcrow" href="#section-2.5-5">¶</a>
</div>
<p id="section-2.5-6">To create the signature base, the signer or verifier concatenates entries for each component identifier in the signature's covered components (including their parameters) using the following algorithm. All errors produced as described <span class="bcp14">MUST</span> fail the algorithm immediately, without outputting a signature base.<a class="pilcrow" href="#section-2.5-6">¶</a></p>
<ol class="normal type-1" id="section-2.5-7" start="1" type="1">
<li id="section-2.5-7.1">Let the output be an empty string.<a class="pilcrow" href="#section-2.5-7.1">¶</a>
</li>
          <li id="section-2.5-7.2">
            <p id="section-2.5-7.2.1">For each message component item in the covered components set (in order):<a class="pilcrow" href="#section-2.5-7.2.1">¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-2.5-7.2.2">
<dt>2.1.</dt>
<dd id="section-2.5-7.2.2.1">If the component identifier (including its parameters) has already been added to the signature base, produce an error.<a class="pilcrow" href="#section-2.5-7.2.2.1">¶</a>
</dd>
              <dd class="break"></dd>
<dt>2.2.</dt>
<dd id="section-2.5-7.2.2.2">Append the component identifier for the covered component serialized according to the <code>component-identifier</code> ABNF rule. Note that this serialization places the component name in double quotes and appends any parameters outside of the quotes.<a class="pilcrow" href="#section-2.5-7.2.2.2">¶</a>
</dd>
              <dd class="break"></dd>
<dt>2.3.</dt>
<dd id="section-2.5-7.2.2.3">Append a single colon (<code>:</code>).<a class="pilcrow" href="#section-2.5-7.2.2.3">¶</a>
</dd>
              <dd class="break"></dd>
<dt>2.4.</dt>
<dd id="section-2.5-7.2.2.4">Append a single space (" ").<a class="pilcrow" href="#section-2.5-7.2.2.4">¶</a>
</dd>
              <dd class="break"></dd>
<dt>2.5.</dt>
<dd id="section-2.5-7.2.2.5">
                <p id="section-2.5-7.2.2.5.1">Determine the component value for the component identifier.<a class="pilcrow" href="#section-2.5-7.2.2.5.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.5-7.2.2.5.2.1">If the component identifier has a parameter that is not understood, produce an error.<a class="pilcrow" href="#section-2.5-7.2.2.5.2.1">¶</a>
</li>
                  <li class="normal" id="section-2.5-7.2.2.5.2.2">If the component identifier has parameters that are mutually incompatible with one another, such as <code>bs</code> and <code>sf</code>, produce an error.<a class="pilcrow" href="#section-2.5-7.2.2.5.2.2">¶</a>
</li>
                  <li class="normal" id="section-2.5-7.2.2.5.2.3">If the component identifier contains the <code>req</code> parameter and the target message is a request, produce an error.<a class="pilcrow" href="#section-2.5-7.2.2.5.2.3">¶</a>
</li>
                  <li class="normal" id="section-2.5-7.2.2.5.2.4">If the component identifier contains the <code>req</code> parameter and the target message is a response, the context for the component value is the related request message of the target response message. Otherwise, the context for the component value is the target message.<a class="pilcrow" href="#section-2.5-7.2.2.5.2.4">¶</a>
</li>
                  <li class="normal" id="section-2.5-7.2.2.5.2.5">If the component name starts with an "at" (<code>@</code>) character, derive the component's value from the message according to the specific rules defined for the derived component, as provided in <a class="auto internal xref" href="#derived-components">Section 2.2</a>, including processing of any known valid parameters. If the derived component name is unknown or the value cannot be derived, produce an error.<a class="pilcrow" href="#section-2.5-7.2.2.5.2.5">¶</a>
</li>
                  <li class="normal" id="section-2.5-7.2.2.5.2.6">If the component name does not start with an "at" (<code>@</code>) character, canonicalize the HTTP field value as described in <a class="auto internal xref" href="#http-fields">Section 2.1</a>, including processing of any known valid parameters. If the field cannot be found in the message or the value cannot be obtained in the context, produce an error.<a class="pilcrow" href="#section-2.5-7.2.2.5.2.6">¶</a>
</li>
                </ul>
</dd>
              <dd class="break"></dd>
<dt>2.6.</dt>
<dd id="section-2.5-7.2.2.6">Append the covered component's canonicalized component value.<a class="pilcrow" href="#section-2.5-7.2.2.6">¶</a>
</dd>
              <dd class="break"></dd>
<dt>2.7.</dt>
<dd id="section-2.5-7.2.2.7">Append a single newline (<code>\n</code>).<a class="pilcrow" href="#section-2.5-7.2.2.7">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</li>
          <li id="section-2.5-7.3">
            <p id="section-2.5-7.3.1">Append the signature parameters component (<a class="auto internal xref" href="#signature-params">Section 2.3</a>) according to the <code>signature-params-line</code> rule as follows:<a class="pilcrow" href="#section-2.5-7.3.1">¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-2.5-7.3.2">
<dt>3.1.</dt>
<dd id="section-2.5-7.3.2.1">Append the component identifier for the signature parameters serialized according to the <code>component-identifier</code> rule, i.e., the exact value <code>"@signature-params"</code> (including double quotes).<a class="pilcrow" href="#section-2.5-7.3.2.1">¶</a>
</dd>
              <dd class="break"></dd>
<dt>3.2.</dt>
<dd id="section-2.5-7.3.2.2">Append a single colon (<code>:</code>).<a class="pilcrow" href="#section-2.5-7.3.2.2">¶</a>
</dd>
              <dd class="break"></dd>
<dt>3.3.</dt>
<dd id="section-2.5-7.3.2.3">Append a single space (" ").<a class="pilcrow" href="#section-2.5-7.3.2.3">¶</a>
</dd>
              <dd class="break"></dd>
<dt>3.4.</dt>
<dd id="section-2.5-7.3.2.4">Append the signature parameters' canonicalized component values as defined in <a class="auto internal xref" href="#signature-params">Section 2.3</a>, i.e., Inner List Structured Field values with parameters.<a class="pilcrow" href="#section-2.5-7.3.2.4">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</li>
          <li id="section-2.5-7.4">Produce an error if the output string contains any non-ASCII characters <span>[<a class="cite xref" href="#RFC0020">ASCII</a>]</span>.<a class="pilcrow" href="#section-2.5-7.4">¶</a>
</li>
          <li id="section-2.5-7.5">Return the output string.<a class="pilcrow" href="#section-2.5-7.5">¶</a>
</li>
        </ol>
<p id="section-2.5-8">If covered components reference a component identifier that cannot be resolved to a component value in the message, the implementation <span class="bcp14">MUST</span> produce an error and not create a signature base. Such situations include, but are not limited to, the following:<a class="pilcrow" href="#section-2.5-8">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.5-9.1">The signer or verifier does not understand the derived component name.<a class="pilcrow" href="#section-2.5-9.1">¶</a>
</li>
          <li class="normal" id="section-2.5-9.2">The component name identifies a field that is not present in the message or whose value is malformed.<a class="pilcrow" href="#section-2.5-9.2">¶</a>
</li>
          <li class="normal" id="section-2.5-9.3">The component identifier includes a parameter that is unknown or does not apply to the component identifier to which it is attached.<a class="pilcrow" href="#section-2.5-9.3">¶</a>
</li>
          <li class="normal" id="section-2.5-9.4">The component identifier indicates that a Structured Field serialization is used (via the <code>sf</code> parameter), but the field in question is known to not be a Structured Field or the type of Structured Field is not known to the implementation.<a class="pilcrow" href="#section-2.5-9.4">¶</a>
</li>
          <li class="normal" id="section-2.5-9.5">The component identifier is a Dictionary member identifier that references a field that is not present in the message, that is not a Dictionary Structured Field, or whose value is malformed.<a class="pilcrow" href="#section-2.5-9.5">¶</a>
</li>
          <li class="normal" id="section-2.5-9.6">The component identifier is a Dictionary member identifier or a named query parameter identifier that references a member that is not present in the component value or whose value is malformed. For example, the identifier is <code>"example-dict";key="c"</code>, and the value of the Example-Dict header field is <code>a=1, b=2</code>, which does not have the <code>c</code> value.<a class="pilcrow" href="#section-2.5-9.6">¶</a>
</li>
        </ul>
<p id="section-2.5-10">In the following non-normative example, the HTTP message being signed is the following request:<a class="pilcrow" href="#section-2.5-10">¶</a></p>
<div class="lang-http-message sourcecode" id="section-2.5-11">
<pre>NOTE: '\' line wrapping per RFC 8792

POST /foo?param=Value&amp;Pet=dog HTTP/1.1
Host: example.com
Date: Tue, 20 Apr 2021 02:07:55 GMT
Content-Type: application/json
Content-Digest: sha-512=:WZDPaVn/7XgHaAy8pmojAkGWoRx2UFChF41A2svX+T\
  aPm+AbwAgBWnrIiYllu7BNNyealdVLvRwEmTHWXvJwew==:
Content-Length: 18

{"hello": "world"}
</pre><a class="pilcrow" href="#section-2.5-11">¶</a>
</div>
<p id="section-2.5-12">The covered components consist of the <code>@method</code>, <code>@authority</code>, and <code>@path</code> derived components followed by the <code>Content-Digest</code>, <code>Content-Length</code>, and <code>Content-Type</code> HTTP header fields, in order. The signature parameters consist of a creation timestamp of <code>1618884473</code> and a key identifier of <code>test-key-rsa-pss</code>. Note that no explicit <code>alg</code> parameter is given here, since the verifier is known by the application to use the RSA-PSS algorithm based on the identified key. The signature base for this message with these parameters is:<a class="pilcrow" href="#section-2.5-12">¶</a></p>
<span id="name-non-normative-example-signa"></span><div id="example-sig-input">
<figure id="figure-1">
          <div class="lang-http-message sourcecode" id="section-2.5-13.1">
<pre>NOTE: '\' line wrapping per RFC 8792

"@method": POST
"@authority": example.com
"@path": /foo
"content-digest": sha-512=:WZDPaVn/7XgHaAy8pmojAkGWoRx2UFChF41A2svX\
  +TaPm+AbwAgBWnrIiYllu7BNNyealdVLvRwEmTHWXvJwew==:
"content-length": 18
"content-type": application/json
"@signature-params": ("@method" "@authority" "@path" \
  "content-digest" "content-length" "content-type")\
  ;created=1618884473;keyid="test-key-rsa-pss"
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-1">Figure 1</a>:
<a class="selfRef" href="#name-non-normative-example-signa">Non-normative Example Signature Base</a>
          </figcaption></figure>
</div>
<p id="section-2.5-14">Note that the example signature base above does not include the final newline that ends the displayed example, nor do other example signature bases displayed elsewhere in this specification.<a class="pilcrow" href="#section-2.5-14">¶</a></p>
</section>
</div>
</section>
</div>
<div id="message-signatures">
<section id="section-3">
      <h2 id="name-http-message-signatures">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-http-message-signatures">HTTP Message Signatures</a>
      </h2>
<p id="section-3-1">An HTTP message signature is a signature over a string generated from a subset of the components of an HTTP message in addition to metadata about the signature itself. When successfully verified against an HTTP message, an HTTP message signature provides cryptographic proof that the message is semantically equivalent to the message for which the signature was generated, with respect to the subset of message components that was signed.<a class="pilcrow" href="#section-3-1">¶</a></p>
<div id="sign">
<section id="section-3.1">
        <h3 id="name-creating-a-signature">
<a class="section-number selfRef" href="#section-3.1">3.1. </a><a class="section-name selfRef" href="#name-creating-a-signature">Creating a Signature</a>
        </h3>
<p id="section-3.1-1">Creation of an HTTP message signature is a process that takes as its input the signature context (including the target message) and the requirements for the application. The output is a signature value and set of signature parameters that can be communicated to the verifier by adding them to the message.<a class="pilcrow" href="#section-3.1-1">¶</a></p>
<p id="section-3.1-2">In order to create a signature, a signer <span class="bcp14">MUST</span> apply the following algorithm:<a class="pilcrow" href="#section-3.1-2">¶</a></p>
<ol class="normal type-1" id="section-3.1-3" start="1" type="1">
<li id="section-3.1-3.1">The signer chooses an HTTP signature algorithm and key material for signing from the set of potential signing algorithms.
 The set of potential algorithms is determined by the application and is out of scope for this document.
 The signer <span class="bcp14">MUST</span> choose key material that is appropriate
 for the signature's algorithm and that conforms to any requirements defined by the algorithm, such as key size or format. The
 mechanism by which the signer chooses the algorithm and key material is out of scope for this document.<a class="pilcrow" href="#section-3.1-3.1">¶</a>
</li>
          <li id="section-3.1-3.2">The signer sets the signature's creation time to the current time.<a class="pilcrow" href="#section-3.1-3.2">¶</a>
</li>
          <li id="section-3.1-3.3">If applicable, the signer sets the signature's expiration time property to the time at which the signature is to expire. The expiration is a hint to the verifier, expressing the time at which the signer is no longer willing to vouch for the signature. An appropriate expiration length, and the processing requirements of this parameter, are application specific.<a class="pilcrow" href="#section-3.1-3.3">¶</a>
</li>
          <li id="section-3.1-3.4">
            <p id="section-3.1-3.4.1">The signer creates an ordered set of component identifiers representing the message components to be covered by the signature and attaches signature metadata parameters to this set. The serialized value of this set is later used as the value of the Signature-Input field as described in <a class="auto internal xref" href="#signature-input-header">Section 4.1</a>.<a class="pilcrow" href="#section-3.1-3.4.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-3.4.2.1">Once an order of covered components is chosen, the order <span class="bcp14">MUST NOT</span> change for the life of the signature.<a class="pilcrow" href="#section-3.1-3.4.2.1">¶</a>
</li>
              <li class="normal" id="section-3.1-3.4.2.2">Each covered component identifier <span class="bcp14">MUST</span> be either
(1) an HTTP field (<a class="auto internal xref" href="#http-fields">Section 2.1</a>) in the signature context or
(2) a derived component listed in <a class="auto internal xref" href="#derived-components">Section 2.2</a> or in the "HTTP Signature Derived Component Names" registry.<a class="pilcrow" href="#section-3.1-3.4.2.2">¶</a>
</li>
              <li class="normal" id="section-3.1-3.4.2.3">Signers of a request <span class="bcp14">SHOULD</span> include some or all of the message control data in the covered components, such as the <code>@method</code>, <code>@authority</code>, <code>@target-uri</code>, or some combination thereof.<a class="pilcrow" href="#section-3.1-3.4.2.3">¶</a>
</li>
              <li class="normal" id="section-3.1-3.4.2.4">Signers <span class="bcp14">SHOULD</span> include the <code>created</code> signature metadata parameter to indicate when the signature was created.<a class="pilcrow" href="#section-3.1-3.4.2.4">¶</a>
</li>
              <li class="normal" id="section-3.1-3.4.2.5">The <code>@signature-params</code> derived component identifier <span class="bcp14">MUST NOT</span> be present in the list of covered component identifiers. The derived component is required to always be the last line in the signature base, ensuring that a signature always covers its own metadata and the metadata cannot be substituted.<a class="pilcrow" href="#section-3.1-3.4.2.5">¶</a>
</li>
              <li class="normal" id="section-3.1-3.4.2.6">Further guidance on what to include in this set and in what order is out of scope for this document.<a class="pilcrow" href="#section-3.1-3.4.2.6">¶</a>
</li>
            </ul>
</li>
          <li id="section-3.1-3.5">The signer creates the signature base using these parameters and the signature base creation algorithm (<a class="auto internal xref" href="#create-sig-input">Section 2.5</a>).<a class="pilcrow" href="#section-3.1-3.5">¶</a>
</li>
          <li id="section-3.1-3.6">The signer uses the <code>HTTP_SIGN</code> primitive function to sign the signature base with the chosen signing algorithm using the key material chosen by the signer. The <code>HTTP_SIGN</code> primitive and several concrete applications of signing algorithms are defined in <a class="auto internal xref" href="#signature-methods">Section 3.3</a>.<a class="pilcrow" href="#section-3.1-3.6">¶</a>
</li>
          <li id="section-3.1-3.7">The byte array output of the signature function is the HTTP message signature output value to be included in the Signature field as defined in <a class="auto internal xref" href="#signature-header">Section 4.2</a>.<a class="pilcrow" href="#section-3.1-3.7">¶</a>
</li>
        </ol>
<p id="section-3.1-4">For example, given the HTTP message and signature parameters in the example in <a class="auto internal xref" href="#create-sig-input">Section 2.5</a>, the example signature base is signed with the <code>test-key-rsa-pss</code> key (see <a class="auto internal xref" href="#example-key-rsa-pss-test">Appendix B.1.2</a>) and the RSASSA-PSS algorithm described in <a class="auto internal xref" href="#method-rsa-pss-sha512">Section 3.3.1</a>, giving the following message signature output value, encoded in Base64:<a class="pilcrow" href="#section-3.1-4">¶</a></p>
<span id="name-non-normative-example-signat"></span><div id="example-sig-value">
<figure id="figure-2">
          <div class="alignLeft art-text artwork" id="section-3.1-5.1">
<pre>NOTE: '\' line wrapping per RFC 8792

HIbjHC5rS0BYaa9v4QfD4193TORw7u9edguPh0AW3dMq9WImrlFrCGUDih47vAxi4L2\
YRZ3XMJc1uOKk/J0ZmZ+wcta4nKIgBkKq0rM9hs3CQyxXGxHLMCy8uqK488o+9jrptQ\
+xFPHK7a9sRL1IXNaagCNN3ZxJsYapFj+JXbmaI5rtAdSfSvzPuBCh+ARHBmWuNo1Uz\
VVdHXrl8ePL4cccqlazIJdC4QEjrF+Sn4IxBQzTZsL9y9TP5FsZYzHvDqbInkTNigBc\
E9cKOYNFCn4D/WM7F6TNuZO9EgtzepLWcjTymlHzK7aXq6Am6sfOrpIC49yXjj3ae6H\
RalVc/g==
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-2">Figure 2</a>:
<a class="selfRef" href="#name-non-normative-example-signat">Non-normative Example Signature Value</a>
          </figcaption></figure>
</div>
<p id="section-3.1-6">Note that the RSA-PSS algorithm in use here is non-deterministic, meaning that a different signature value will be created every time the algorithm is run. The signature value provided here can be validated against the given keys, but newly generated signature values are not expected to match the example. See <a class="auto internal xref" href="#security-nondeterministic">Section 7.3.5</a>.<a class="pilcrow" href="#section-3.1-6">¶</a></p>
</section>
</div>
<div id="verify">
<section id="section-3.2">
        <h3 id="name-verifying-a-signature">
<a class="section-number selfRef" href="#section-3.2">3.2. </a><a class="section-name selfRef" href="#name-verifying-a-signature">Verifying a Signature</a>
        </h3>
<p id="section-3.2-1">Verification of an HTTP message signature is a process that takes as its input the signature context (including the target message, particularly its Signature and Signature-Input fields) and the requirements for the application. The output of the verification is either a positive verification or an error.<a class="pilcrow" href="#section-3.2-1">¶</a></p>
<p id="section-3.2-2">In order to verify a signature, a verifier <span class="bcp14">MUST</span> apply the following algorithm:<a class="pilcrow" href="#section-3.2-2">¶</a></p>
<ol class="normal type-1" id="section-3.2-3" start="1" type="1">
<li id="section-3.2-3.1">
            <p id="section-3.2-3.1.1">Parse the Signature and Signature-Input fields as described in
Sections <a class="auto internal xref" href="#signature-input-header">4.1</a> and <a class="auto internal xref" href="#signature-header">4.2</a>, and extract the signatures to be verified and their labels.<a class="pilcrow" href="#section-3.2-3.1.1">¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-3.2-3.1.2">
<dt>1.1.</dt>
<dd id="section-3.2-3.1.2.1">If there is more than one signature value present, determine which signature should be processed
 for this message based on the policy and configuration of the verifier. If an applicable signature is not found, produce an error.<a class="pilcrow" href="#section-3.2-3.1.2.1">¶</a>
</dd>
              <dd class="break"></dd>
<dt>1.2.</dt>
<dd id="section-3.2-3.1.2.2">If the chosen Signature field value does not have a corresponding Signature-Input field value (i.e., one with the same label),
 produce an error.<a class="pilcrow" href="#section-3.2-3.1.2.2">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</li>
          <li id="section-3.2-3.2">Parse the values of the chosen Signature-Input field as a parameterized Inner List to get the ordered list of covered components and the signature parameters for the signature to be verified.<a class="pilcrow" href="#section-3.2-3.2">¶</a>
</li>
          <li id="section-3.2-3.3">Parse the value of the corresponding Signature field to get the byte array value of the signature
 to be verified.<a class="pilcrow" href="#section-3.2-3.3">¶</a>
</li>
          <li id="section-3.2-3.4">Examine the signature parameters to confirm that the signature meets the requirements described
 in this document, as well as any additional requirements defined by the application such as which
 message components are required to be covered by the signature (<a class="auto internal xref" href="#verify-requirements">Section 3.2.1</a>).<a class="pilcrow" href="#section-3.2-3.4">¶</a>
</li>
          <li id="section-3.2-3.5">Determine the verification key material for this signature. If the key material is known through external
 means such as static configuration or external protocol negotiation, the verifier will use the applicable technique to obtain the key material from this external knowledge. If the key is
 identified in the signature parameters, the verifier will dereference the key identifier to appropriate key material to use
 with the signature. The verifier has to determine the trustworthiness of the key material for the context
 in which the signature is presented. If a key is identified that the verifier does not know or trust for this request or that does not match something preconfigured, the verification <span class="bcp14">MUST</span> fail.<a class="pilcrow" href="#section-3.2-3.5">¶</a>
</li>
          <li id="section-3.2-3.6">
            <p id="section-3.2-3.6.1">Determine the algorithm to apply for verification:<a class="pilcrow" href="#section-3.2-3.6.1">¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-3.2-3.6.2">
<dt>6.1.</dt>
<dd id="section-3.2-3.6.2.1">Start with the set of allowable algorithms known to the application. If any of the following steps select an algorithm that is not in this set, the signature validation fails.<a class="pilcrow" href="#section-3.2-3.6.2.1">¶</a>
</dd>
              <dd class="break"></dd>
<dt>6.2.</dt>
<dd id="section-3.2-3.6.2.2">If the algorithm is known through external means such as static configuration or external protocol
 negotiation, the verifier will use that algorithm.<a class="pilcrow" href="#section-3.2-3.6.2.2">¶</a>
</dd>
              <dd class="break"></dd>
<dt>6.3.</dt>
<dd id="section-3.2-3.6.2.3">If the algorithm can be determined from the keying material, such as through an algorithm field
 on the key value itself, the verifier will use that algorithm.<a class="pilcrow" href="#section-3.2-3.6.2.3">¶</a>
</dd>
              <dd class="break"></dd>
<dt>6.4.</dt>
<dd id="section-3.2-3.6.2.4">If the algorithm is explicitly stated in the signature parameters using a value from the
 "HTTP Signature Algorithms" registry, the verifier will use the referenced algorithm.<a class="pilcrow" href="#section-3.2-3.6.2.4">¶</a>
</dd>
              <dd class="break"></dd>
<dt>6.5.</dt>
<dd id="section-3.2-3.6.2.5">If the algorithm is specified in more than one location (e.g.,
a combination of static configuration, the algorithm signature parameter, and the
key material itself), the resolved algorithms <span class="bcp14">MUST</span> be the same. If the algorithms are
 not the same, the verifier <span class="bcp14">MUST</span> fail the verification.<a class="pilcrow" href="#section-3.2-3.6.2.5">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</li>
          <li id="section-3.2-3.7">Use the received HTTP message and the parsed signature parameters to recreate the signature base, using
 the algorithm defined in <a class="auto internal xref" href="#create-sig-input">Section 2.5</a>. The value of the <code>@signature-params</code> input is
 the value of the Signature-Input field for this signature serialized according to the rules described
 in <a class="auto internal xref" href="#signature-params">Section 2.3</a>. Note that this does not include the signature's label from the Signature-Input field.<a class="pilcrow" href="#section-3.2-3.7">¶</a>
</li>
          <li id="section-3.2-3.8">If the key material is appropriate for the algorithm, apply the appropriate <code>HTTP_VERIFY</code> cryptographic verification algorithm to the signature,
 recalculated signature base, key material, and signature value. The <code>HTTP_VERIFY</code> primitive and several concrete algorithms are defined in
 <a class="auto internal xref" href="#signature-methods">Section 3.3</a>.<a class="pilcrow" href="#section-3.2-3.8">¶</a>
</li>
          <li id="section-3.2-3.9">The results of the verification algorithm function are the final results of the cryptographic verification function.<a class="pilcrow" href="#section-3.2-3.9">¶</a>
</li>
        </ol>
<p id="section-3.2-4">If any of the above steps fail or produce an error, the signature validation fails.<a class="pilcrow" href="#section-3.2-4">¶</a></p>
<p id="section-3.2-5">For example, verifying the signature with the label <code>sig1</code> of the following message with the <code>test-key-rsa-pss</code> key (see <a class="auto internal xref" href="#example-key-rsa-pss-test">Appendix B.1.2</a>) and the RSASSA-PSS algorithm described in <a class="auto internal xref" href="#method-rsa-pss-sha512">Section 3.3.1</a>:<a class="pilcrow" href="#section-3.2-5">¶</a></p>
<div class="lang-http-message sourcecode" id="section-3.2-6">
<pre>NOTE: '\' line wrapping per RFC 8792

POST /foo?param=Value&amp;Pet=dog HTTP/1.1
Host: example.com
Date: Tue, 20 Apr 2021 02:07:55 GMT
Content-Type: application/json
Content-Digest: sha-512=:WZDPaVn/7XgHaAy8pmojAkGWoRx2UFChF41A2svX+T\
  aPm+AbwAgBWnrIiYllu7BNNyealdVLvRwEmTHWXvJwew==:
Content-Length: 18
Signature-Input: sig1=("@method" "@authority" "@path" \
  "content-digest" "content-length" "content-type")\
  ;created=1618884473;keyid="test-key-rsa-pss"
Signature: sig1=:HIbjHC5rS0BYaa9v4QfD4193TORw7u9edguPh0AW3dMq9WImrl\
  FrCGUDih47vAxi4L2YRZ3XMJc1uOKk/J0ZmZ+wcta4nKIgBkKq0rM9hs3CQyxXGxH\
  LMCy8uqK488o+9jrptQ+xFPHK7a9sRL1IXNaagCNN3ZxJsYapFj+JXbmaI5rtAdSf\
  SvzPuBCh+ARHBmWuNo1UzVVdHXrl8ePL4cccqlazIJdC4QEjrF+Sn4IxBQzTZsL9y\
  9TP5FsZYzHvDqbInkTNigBcE9cKOYNFCn4D/WM7F6TNuZO9EgtzepLWcjTymlHzK7\
  aXq6Am6sfOrpIC49yXjj3ae6HRalVc/g==:

{"hello": "world"}
</pre><a class="pilcrow" href="#section-3.2-6">¶</a>
</div>
<p id="section-3.2-7">With the additional requirements that at least the method, authority, path, content-digest, content-length, and content-type entries be signed, and that the signature creation timestamp be recent enough at the time of verification, the verification passes.<a class="pilcrow" href="#section-3.2-7">¶</a></p>
<div id="verify-requirements">
<section id="section-3.2.1">
          <h4 id="name-enforcing-application-requi">
<a class="section-number selfRef" href="#section-3.2.1">3.2.1. </a><a class="section-name selfRef" href="#name-enforcing-application-requi">Enforcing Application Requirements</a>
          </h4>
<p id="section-3.2.1-1">The verification requirements specified in this document are intended as a baseline set of restrictions that are generally applicable to all use cases. Applications using HTTP message signatures <span class="bcp14">MAY</span> impose requirements above and beyond those specified by this document, as appropriate for their use case.<a class="pilcrow" href="#section-3.2.1-1">¶</a></p>
<p id="section-3.2.1-2">Some non-normative examples of additional requirements an application might define are:<a class="pilcrow" href="#section-3.2.1-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.1-3.1">Requiring a specific set of header fields to be signed (e.g., Authorization, Content-Digest).<a class="pilcrow" href="#section-3.2.1-3.1">¶</a>
</li>
            <li class="normal" id="section-3.2.1-3.2">Enforcing a maximum signature age from the time of the <code>created</code> timestamp.<a class="pilcrow" href="#section-3.2.1-3.2">¶</a>
</li>
            <li class="normal" id="section-3.2.1-3.3">Rejecting signatures past the expiration time in the <code>expires</code> timestamp. Note that the expiration time is a hint from the signer and that a verifier can always reject a signature ahead of its expiration time.<a class="pilcrow" href="#section-3.2.1-3.3">¶</a>
</li>
            <li class="normal" id="section-3.2.1-3.4">Prohibiting certain signature metadata parameters, such as runtime algorithm signaling with the <code>alg</code> parameter when the algorithm is determined from the key information.<a class="pilcrow" href="#section-3.2.1-3.4">¶</a>
</li>
            <li class="normal" id="section-3.2.1-3.5">Ensuring successful dereferencing of the <code>keyid</code> parameter to valid and appropriate key material.<a class="pilcrow" href="#section-3.2.1-3.5">¶</a>
</li>
            <li class="normal" id="section-3.2.1-3.6">Prohibiting the use of certain algorithms or mandating the use of a specific algorithm.<a class="pilcrow" href="#section-3.2.1-3.6">¶</a>
</li>
            <li class="normal" id="section-3.2.1-3.7">Requiring keys to be of a certain size (e.g., 2048 bits vs. 1024 bits).<a class="pilcrow" href="#section-3.2.1-3.7">¶</a>
</li>
            <li class="normal" id="section-3.2.1-3.8">Enforcing uniqueness of the <code>nonce</code> parameter.<a class="pilcrow" href="#section-3.2.1-3.8">¶</a>
</li>
            <li class="normal" id="section-3.2.1-3.9">Requiring an application-specific value for the <code>tag</code> parameter.<a class="pilcrow" href="#section-3.2.1-3.9">¶</a>
</li>
          </ul>
<p id="section-3.2.1-4">Application-specific requirements are expected and encouraged. When an application defines additional requirements, it <span class="bcp14">MUST</span> enforce them during the signature verification process, and signature verification <span class="bcp14">MUST</span> fail if the signature does not conform to the application's requirements.<a class="pilcrow" href="#section-3.2.1-4">¶</a></p>
<p id="section-3.2.1-5">Applications <span class="bcp14">MUST</span> enforce the requirements defined in this document. Regardless of use case, applications <span class="bcp14">MUST NOT</span> accept signatures that do not conform to these requirements.<a class="pilcrow" href="#section-3.2.1-5">¶</a></p>
</section>
</div>
</section>
</div>
<div id="signature-methods">
<section id="section-3.3">
        <h3 id="name-signature-algorithms">
<a class="section-number selfRef" href="#section-3.3">3.3. </a><a class="section-name selfRef" href="#name-signature-algorithms">Signature Algorithms</a>
        </h3>
<p id="section-3.3-1">An HTTP message signature <span class="bcp14">MUST</span> use a cryptographic digital signature or MAC method that is
appropriate for the key material, environment, and needs of the signer and verifier. This specification does not strictly limit the available signature algorithms, and any signature algorithm that meets these basic requirements <span class="bcp14">MAY</span> be used by an application of HTTP message signatures.<a class="pilcrow" href="#section-3.3-1">¶</a></p>
<p id="section-3.3-2">For each signing method, <code>HTTP_SIGN</code> takes as its input the signature base defined in <a class="auto internal xref" href="#create-sig-input">Section 2.5</a> as a byte array (<code>M</code>) and the signing key material
(<code>Ks</code>), and outputs the resultant signature as a byte array (<code>S</code>):<a class="pilcrow" href="#section-3.3-2">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.3-3">
<pre>HTTP_SIGN (M, Ks)  -&gt;  S
</pre><a class="pilcrow" href="#section-3.3-3">¶</a>
</div>
<p id="section-3.3-4">For each verification method, <code>HTTP_VERIFY</code> takes as its input the regenerated signature base defined in <a class="auto internal xref" href="#create-sig-input">Section 2.5</a> as a byte array (<code>M</code>), the verification key
material (<code>Kv</code>), and the presented signature to be verified as a byte array (<code>S</code>), and outputs the verification result (<code>V</code>) as a Boolean:<a class="pilcrow" href="#section-3.3-4">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.3-5">
<pre>HTTP_VERIFY (M, Kv, S) -&gt; V
</pre><a class="pilcrow" href="#section-3.3-5">¶</a>
</div>
<p id="section-3.3-6">The following sections contain several common signature algorithms and demonstrate how these cryptographic primitives map to the <code>HTTP_SIGN</code> and <code>HTTP_VERIFY</code> definitions above. Which method to use can be communicated through the explicit algorithm (<code>alg</code>) signature parameter (<a class="auto internal xref" href="#signature-params">Section 2.3</a>), by reference to the key material, or through mutual agreement between the signer and verifier. Signature algorithms selected using the <code>alg</code> parameter <span class="bcp14">MUST</span> use values from the <span><a class="internal xref" href="#hsa-registry">"HTTP Signature Algorithms" registry</a> (<a class="auto internal xref" href="#hsa-registry">Section 6.2</a>)</span>.<a class="pilcrow" href="#section-3.3-6">¶</a></p>
<div id="method-rsa-pss-sha512">
<section id="section-3.3.1">
          <h4 id="name-rsassa-pss-using-sha-512">
<a class="section-number selfRef" href="#section-3.3.1">3.3.1. </a><a class="section-name selfRef" href="#name-rsassa-pss-using-sha-512">RSASSA-PSS Using SHA-512</a>
          </h4>
<p id="section-3.3.1-1">To sign using this algorithm, the signer applies the <code>RSASSA-PSS-SIGN (K, M)</code> function defined in <span>[<a class="cite xref" href="#RFC8017">RFC8017</a>]</span> with the signer's private signing key (<code>K</code>) and the signature base (<code>M</code>)
(<a class="auto internal xref" href="#create-sig-input">Section 2.5</a>).
The mask generation function is <code>MGF1</code> as specified in <span>[<a class="cite xref" href="#RFC8017">RFC8017</a>]</span> with a hash function of SHA-512 <span>[<a class="cite xref" href="#RFC6234">RFC6234</a>]</span>.
The salt length (<code>sLen</code>) is 64 bytes.
The hash function (<code>Hash</code>) SHA-512 <span>[<a class="cite xref" href="#RFC6234">RFC6234</a>]</span> is applied to the signature base to create
the digest content to which the digital signature is applied.
The resulting signed content byte array (<code>S</code>) is the HTTP message signature output used in <a class="auto internal xref" href="#sign">Section 3.1</a>.<a class="pilcrow" href="#section-3.3.1-1">¶</a></p>
<p id="section-3.3.1-2">To verify using this algorithm, the verifier applies the <code>RSASSA-PSS-VERIFY ((n, e), M, S)</code> function <span>[<a class="cite xref" href="#RFC8017">RFC8017</a>]</span> using the public key portion of the verification key material (<code>n, e</code>) and the signature base (<code>M</code>) recreated as described in <a class="auto internal xref" href="#verify">Section 3.2</a>.
The mask generation function is <code>MGF1</code> as specified in <span>[<a class="cite xref" href="#RFC8017">RFC8017</a>]</span> with a hash function of SHA-512 <span>[<a class="cite xref" href="#RFC6234">RFC6234</a>]</span>.
The salt length (<code>sLen</code>) is 64 bytes.
The hash function (<code>Hash</code>) SHA-512 <span>[<a class="cite xref" href="#RFC6234">RFC6234</a>]</span> is applied to the signature base to create the digest content to which the verification function is applied.
The verifier extracts the HTTP message signature to be verified (<code>S</code>) as described in <a class="auto internal xref" href="#verify">Section 3.2</a>.
The results of the verification function indicate whether the signature presented is valid.<a class="pilcrow" href="#section-3.3.1-2">¶</a></p>
<p id="section-3.3.1-3">Note that the output of the RSASSA-PSS algorithm is non-deterministic; therefore, it is not correct to recalculate a new signature on the signature base and compare the results to an existing signature. Instead, the verification algorithm defined here needs to be used. See <a class="auto internal xref" href="#security-nondeterministic">Section 7.3.5</a>.<a class="pilcrow" href="#section-3.3.1-3">¶</a></p>
<p id="section-3.3.1-4">The use of this algorithm can be indicated at runtime using the <code>rsa-pss-sha512</code> value for the <code>alg</code> signature parameter.<a class="pilcrow" href="#section-3.3.1-4">¶</a></p>
</section>
</div>
<div id="method-rsa-v1_5-sha256">
<section id="section-3.3.2">
          <h4 id="name-rsassa-pkcs1-v1_5-using-sha">
<a class="section-number selfRef" href="#section-3.3.2">3.3.2. </a><a class="section-name selfRef" href="#name-rsassa-pkcs1-v1_5-using-sha">RSASSA-PKCS1-v1_5 Using SHA-256</a>
          </h4>
<p id="section-3.3.2-1">To sign using this algorithm, the signer applies the <code>RSASSA-PKCS1-V1_5-SIGN (K, M)</code> function defined in <span>[<a class="cite xref" href="#RFC8017">RFC8017</a>]</span> with the signer's private signing key (<code>K</code>) and the
signature base (<code>M</code>) (<a class="auto internal xref" href="#create-sig-input">Section 2.5</a>).
The hash SHA-256 <span>[<a class="cite xref" href="#RFC6234">RFC6234</a>]</span> is applied to the signature base to create
the digest content to which the digital signature is applied.
The resulting signed content byte array (<code>S</code>) is the HTTP message signature output used in <a class="auto internal xref" href="#sign">Section 3.1</a>.<a class="pilcrow" href="#section-3.3.2-1">¶</a></p>
<p id="section-3.3.2-2">To verify using this algorithm, the verifier applies the <code>RSASSA-PKCS1-V1_5-VERIFY ((n, e), M, S)</code> function <span>[<a class="cite xref" href="#RFC8017">RFC8017</a>]</span> using the public key portion of the verification key material (<code>n, e</code>) and the signature base (<code>M</code>) recreated as described in <a class="auto internal xref" href="#verify">Section 3.2</a>.
The hash function SHA-256 <span>[<a class="cite xref" href="#RFC6234">RFC6234</a>]</span> is applied to the signature base to create the digest content to which the verification function is applied.
The verifier extracts the HTTP message signature to be verified (<code>S</code>) as described in <a class="auto internal xref" href="#verify">Section 3.2</a>.
The results of the verification function indicate whether the signature presented is valid.<a class="pilcrow" href="#section-3.3.2-2">¶</a></p>
<p id="section-3.3.2-3">The use of this algorithm can be indicated at runtime using the <code>rsa-v1_5-sha256</code> value for the <code>alg</code> signature parameter.<a class="pilcrow" href="#section-3.3.2-3">¶</a></p>
</section>
</div>
<div id="method-hmac-sha256">
<section id="section-3.3.3">
          <h4 id="name-hmac-using-sha-256">
<a class="section-number selfRef" href="#section-3.3.3">3.3.3. </a><a class="section-name selfRef" href="#name-hmac-using-sha-256">HMAC Using SHA-256</a>
          </h4>
<p id="section-3.3.3-1">To sign and verify using this algorithm, the signer applies the <code>HMAC</code> function <span>[<a class="cite xref" href="#RFC2104">RFC2104</a>]</span> with the shared signing key (<code>K</code>) and the
signature base (<code>text</code>) (<a class="auto internal xref" href="#create-sig-input">Section 2.5</a>).
The hash function SHA-256 <span>[<a class="cite xref" href="#RFC6234">RFC6234</a>]</span> is applied to the signature base to create the digest content to which the HMAC is applied, giving the signature result.<a class="pilcrow" href="#section-3.3.3-1">¶</a></p>
<p id="section-3.3.3-2">For signing, the resulting value is the HTTP message signature output used in <a class="auto internal xref" href="#sign">Section 3.1</a>.<a class="pilcrow" href="#section-3.3.3-2">¶</a></p>
<p id="section-3.3.3-3">For verification, the verifier extracts the HTTP message signature to be verified (<code>S</code>) as described in <a class="auto internal xref" href="#verify">Section 3.2</a>.
The output of the HMAC function is compared bytewise to the value of the HTTP message signature, and the results of the comparison determine the validity of the signature presented.<a class="pilcrow" href="#section-3.3.3-3">¶</a></p>
<p id="section-3.3.3-4">The use of this algorithm can be indicated at runtime using the <code>hmac-sha256</code> value for the <code>alg</code> signature parameter.<a class="pilcrow" href="#section-3.3.3-4">¶</a></p>
</section>
</div>
<div id="method-ecdsa-p256-sha256">
<section id="section-3.3.4">
          <h4 id="name-ecdsa-using-curve-p-256-dss">
<a class="section-number selfRef" href="#section-3.3.4">3.3.4. </a><a class="section-name selfRef" href="#name-ecdsa-using-curve-p-256-dss">ECDSA Using Curve P-256 DSS and SHA-256</a>
          </h4>
<p id="section-3.3.4-1">To sign using this algorithm, the signer applies the <code>ECDSA</code> signature algorithm defined in <span>[<a class="cite xref" href="#FIPS186-5">FIPS186-5</a>]</span> using curve P-256 with the signer's private signing key and
the signature base (<a class="auto internal xref" href="#create-sig-input">Section 2.5</a>).
The hash SHA-256 <span>[<a class="cite xref" href="#RFC6234">RFC6234</a>]</span> is applied to the signature base to create
the digest content to which the digital signature is applied (<code>M</code>).
The signature algorithm returns two integer values: <code>r</code> and <code>s</code>. These are both encoded as big-endian unsigned integers, zero-padded to 32 octets each. These encoded values are concatenated into a single 64-octet array consisting of the encoded value of <code>r</code> followed by the encoded value of <code>s</code>. The resulting concatenation of <code>(r, s)</code> is a byte array of the HTTP message signature output used in <a class="auto internal xref" href="#sign">Section 3.1</a>.<a class="pilcrow" href="#section-3.3.4-1">¶</a></p>
<p id="section-3.3.4-2">To verify using this algorithm, the verifier applies the <code>ECDSA</code> signature algorithm defined in <span>[<a class="cite xref" href="#FIPS186-5">FIPS186-5</a>]</span>  using the public key portion of the verification key material and the signature base recreated as described in <a class="auto internal xref" href="#verify">Section 3.2</a>.
The hash function SHA-256 <span>[<a class="cite xref" href="#RFC6234">RFC6234</a>]</span> is applied to the signature base to create the digest content to which the signature verification function is applied (<code>M</code>).
The verifier extracts the HTTP message signature to be verified (<code>S</code>) as described in <a class="auto internal xref" href="#verify">Section 3.2</a>. This value is a 64-octet array consisting of the encoded values of <code>r</code> and <code>s</code> concatenated in order. These are both encoded as big-endian unsigned integers, zero-padded to 32 octets each. The resulting signature value <code>(r, s)</code> is used as input to the signature verification function.
The results of the verification function indicate whether the signature presented is valid.<a class="pilcrow" href="#section-3.3.4-2">¶</a></p>
<p id="section-3.3.4-3">Note that the output of ECDSA signature algorithms is non-deterministic; therefore, it is not correct to recalculate a new signature on the signature base and compare the results to an existing signature. Instead, the verification algorithm defined here needs to be used. See <a class="auto internal xref" href="#security-nondeterministic">Section 7.3.5</a>.<a class="pilcrow" href="#section-3.3.4-3">¶</a></p>
<p id="section-3.3.4-4">The use of this algorithm can be indicated at runtime using the <code>ecdsa-p256-sha256</code> value for the <code>alg</code> signature parameter.<a class="pilcrow" href="#section-3.3.4-4">¶</a></p>
</section>
</div>
<div id="method-ecdsa-p384-sha384">
<section id="section-3.3.5">
          <h4 id="name-ecdsa-using-curve-p-384-dss">
<a class="section-number selfRef" href="#section-3.3.5">3.3.5. </a><a class="section-name selfRef" href="#name-ecdsa-using-curve-p-384-dss">ECDSA Using Curve P-384 DSS and SHA-384</a>
          </h4>
<p id="section-3.3.5-1">To sign using this algorithm, the signer applies the <code>ECDSA</code> signature algorithm defined in <span>[<a class="cite xref" href="#FIPS186-5">FIPS186-5</a>]</span> using curve P-384 with the signer's private signing key and the
signature base (<a class="auto internal xref" href="#create-sig-input">Section 2.5</a>).
The hash SHA-384 <span>[<a class="cite xref" href="#RFC6234">RFC6234</a>]</span> is applied to the signature base to create
the digest content to which the digital signature is applied (<code>M</code>).
The signature algorithm returns two integer values: <code>r</code> and <code>s</code>. These are both encoded as big-endian unsigned integers, zero-padded to 48 octets each. These encoded values are concatenated into a single 96-octet array consisting of the encoded value of <code>r</code> followed by the encoded value of <code>s</code>. The resulting concatenation of <code>(r, s)</code> is a byte array of the HTTP message signature output used in <a class="auto internal xref" href="#sign">Section 3.1</a>.<a class="pilcrow" href="#section-3.3.5-1">¶</a></p>
<p id="section-3.3.5-2">To verify using this algorithm, the verifier applies the <code>ECDSA</code> signature algorithm defined in <span>[<a class="cite xref" href="#FIPS186-5">FIPS186-5</a>]</span>  using the public key portion of the verification key material and the signature base recreated as described in <a class="auto internal xref" href="#verify">Section 3.2</a>.
The hash function SHA-384 <span>[<a class="cite xref" href="#RFC6234">RFC6234</a>]</span> is applied to the signature base to create the digest content to which the signature verification function is applied (<code>M</code>).
The verifier extracts the HTTP message signature to be verified (<code>S</code>) as described in <a class="auto internal xref" href="#verify">Section 3.2</a>. This value is a 96-octet array consisting of the encoded values of <code>r</code> and <code>s</code> concatenated in order. These are both encoded as big-endian unsigned integers, zero-padded to 48 octets each. The resulting signature value <code>(r, s)</code> is used as input to the signature verification function.
The results of the verification function indicate whether the signature presented is valid.<a class="pilcrow" href="#section-3.3.5-2">¶</a></p>
<p id="section-3.3.5-3">Note that the output of ECDSA signature algorithms is non-deterministic; therefore, it is not correct to recalculate a new signature on the signature base and compare the results to an existing signature. Instead, the verification algorithm defined here needs to be used. See <a class="auto internal xref" href="#security-nondeterministic">Section 7.3.5</a>.<a class="pilcrow" href="#section-3.3.5-3">¶</a></p>
<p id="section-3.3.5-4">The use of this algorithm can be indicated at runtime using the <code>ecdsa-p384-sha384</code> value for the <code>alg</code> signature parameter.<a class="pilcrow" href="#section-3.3.5-4">¶</a></p>
</section>
</div>
<div id="method-ed25519">
<section id="section-3.3.6">
          <h4 id="name-eddsa-using-curve-edwards25">
<a class="section-number selfRef" href="#section-3.3.6">3.3.6. </a><a class="section-name selfRef" href="#name-eddsa-using-curve-edwards25">EdDSA Using Curve edwards25519</a>
          </h4>
<p id="section-3.3.6-1">To sign using this algorithm, the signer applies the <code>Ed25519</code> algorithm defined in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8032#section-5.1.6">Section 5.1.6</a> of [<a class="cite xref" href="#RFC8032">RFC8032</a>]</span> with the signer's private signing key and
the signature base (<a class="auto internal xref" href="#create-sig-input">Section 2.5</a>).
The signature base is taken as the input message (<code>M</code>) with no prehash function.
The signature is a 64-octet concatenation of <code>R</code> and <code>S</code> as specified in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8032#section-5.1.6">Section 5.1.6</a> of [<a class="cite xref" href="#RFC8032">RFC8032</a>]</span>, and this is taken as a byte array for the HTTP message signature output used in <a class="auto internal xref" href="#sign">Section 3.1</a>.<a class="pilcrow" href="#section-3.3.6-1">¶</a></p>
<p id="section-3.3.6-2">To verify using this algorithm, the signer applies the <code>Ed25519</code> algorithm defined in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8032#section-5.1.7">Section 5.1.7</a> of [<a class="cite xref" href="#RFC8032">RFC8032</a>]</span> using the public key portion of the verification key material (<code>A</code>) and the signature base recreated as described in <a class="auto internal xref" href="#verify">Section 3.2</a>.
The signature base is taken as the input message (<code>M</code>) with no prehash function.
The signature to be verified is processed as the 64-octet concatenation of <code>R</code> and <code>S</code> as specified in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8032#section-5.1.7">Section 5.1.7</a> of [<a class="cite xref" href="#RFC8032">RFC8032</a>]</span>.
The results of the verification function indicate whether the signature presented is valid.<a class="pilcrow" href="#section-3.3.6-2">¶</a></p>
<p id="section-3.3.6-3">The use of this algorithm can be indicated at runtime using the <code>ed25519</code> value for the <code>alg</code> signature parameter.<a class="pilcrow" href="#section-3.3.6-3">¶</a></p>
</section>
</div>
<div id="method-jose">
<section id="section-3.3.7">
          <h4 id="name-json-web-signature-jws-algo">
<a class="section-number selfRef" href="#section-3.3.7">3.3.7. </a><a class="section-name selfRef" href="#name-json-web-signature-jws-algo">JSON Web Signature (JWS) Algorithms</a>
          </h4>
<p id="section-3.3.7-1">If the signing algorithm is a JSON Object Signing and Encryption (JOSE) signing algorithm from the "JSON Web Signature and Encryption Algorithms" registry established by <span>[<a class="cite xref" href="#RFC7518">RFC7518</a>]</span>, the
JWS algorithm definition determines the signature and hashing algorithms to apply for both signing and verification.<a class="pilcrow" href="#section-3.3.7-1">¶</a></p>
<p id="section-3.3.7-2">For both signing and verification, the HTTP message's signature base (<a class="auto internal xref" href="#create-sig-input">Section 2.5</a>) is used as the entire "JWS Signing Input".
The JOSE Header <span>[<a class="cite xref" href="#RFC7515">JWS</a>]</span> <span>[<a class="cite xref" href="#RFC7517">RFC7517</a>]</span> is not used, and the signature base is not first encoded in Base64 before applying the algorithm.
The output of the JWS Signature is taken as a byte array prior to the Base64url encoding used in JOSE.<a class="pilcrow" href="#section-3.3.7-2">¶</a></p>
<p id="section-3.3.7-3">The JWS algorithm <span class="bcp14">MUST NOT</span> be "<code>none</code>" and <span class="bcp14">MUST NOT</span> be any algorithm with a JOSE Implementation Requirement of "<code>Prohibited</code>".<a class="pilcrow" href="#section-3.3.7-3">¶</a></p>
<p id="section-3.3.7-4">JSON Web Algorithm (JWA) values from the "JSON Web Signature and Encryption Algorithms" registry are not included as signature parameters. Typically, the JWS algorithm can be signaled using JSON Web Keys (JWKs) or other mechanisms common to JOSE implementations. In fact, JWA values are not registered in the <span><a class="internal xref" href="#hsa-registry">"HTTP Signature Algorithms" registry</a> (<a class="auto internal xref" href="#hsa-registry">Section 6.2</a>)</span>, and so the explicit <code>alg</code> signature parameter is not used at all when using JOSE signing algorithms.<a class="pilcrow" href="#section-3.3.7-4">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="attach-signature">
<section id="section-4">
      <h2 id="name-including-a-message-signatu">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-including-a-message-signatu">Including a Message Signature in a Message</a>
      </h2>
<p id="section-4-1">HTTP message signatures can be included within an HTTP message via the Signature-Input and Signature fields, both defined within this specification.<a class="pilcrow" href="#section-4-1">¶</a></p>
<p id="section-4-2">The Signature-Input field identifies the covered components and parameters that describe how the signature was generated, while the Signature field contains the signature value. Each field <span class="bcp14">MAY</span> contain multiple labeled values.<a class="pilcrow" href="#section-4-2">¶</a></p>
<p id="section-4-3">An HTTP message signature is identified by a label within an HTTP message. This label <span class="bcp14">MUST</span> be unique within a given HTTP message and <span class="bcp14">MUST</span> be used in both the Signature-Input field and the Signature field. The label is chosen by the signer, except where a specific label is dictated by protocol negotiations such as those described in <a class="auto internal xref" href="#request-signature">Section 5</a>.<a class="pilcrow" href="#section-4-3">¶</a></p>
<p id="section-4-4">An HTTP message signature <span class="bcp14">MUST</span> use both the Signature-Input field and the Signature field, and each field <span class="bcp14">MUST</span> contain the same labels. The presence of a label in one field but not the other is an error.<a class="pilcrow" href="#section-4-4">¶</a></p>
<div id="signature-input-header">
<section id="section-4.1">
        <h3 id="name-the-signature-input-http-fi">
<a class="section-number selfRef" href="#section-4.1">4.1. </a><a class="section-name selfRef" href="#name-the-signature-input-http-fi">The Signature-Input HTTP Field</a>
        </h3>
<p id="section-4.1-1">The Signature-Input field is a Dictionary Structured Field (defined in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8941#section-3.2">Section 3.2</a> of [<a class="cite xref" href="#RFC8941">STRUCTURED-FIELDS</a>]</span>) containing the metadata for one or more message signatures generated from components within the HTTP message. Each member describes a single message signature. The member's key is the label that uniquely identifies the message signature within the HTTP message. The member's value is the covered components ordered set serialized as an Inner List, including all signature metadata parameters identified by the label:<a class="pilcrow" href="#section-4.1-1">¶</a></p>
<div class="lang-http-message sourcecode" id="section-4.1-2">
<pre>NOTE: '\' line wrapping per RFC 8792

Signature-Input: sig1=("@method" "@target-uri" "@authority" \
  "content-digest" "cache-control");\
  created=1618884475;keyid="test-key-rsa-pss"
</pre><a class="pilcrow" href="#section-4.1-2">¶</a>
</div>
<p id="section-4.1-3">To facilitate signature validation, the Signature-Input field value <span class="bcp14">MUST</span> contain the same serialized value used
in generating the signature base's <code>@signature-params</code> value defined in <a class="auto internal xref" href="#signature-params">Section 2.3</a>. Note that in a Structured Field value, list order and parameter order have to be preserved.<a class="pilcrow" href="#section-4.1-3">¶</a></p>
<p id="section-4.1-4">The signer <span class="bcp14">MAY</span> include the Signature-Input field as a trailer to facilitate signing a message after its content has been processed by the signer. However, since intermediaries are allowed to drop trailers as per <span>[<a class="cite xref" href="#RFC9110">HTTP</a>]</span>, it is <span class="bcp14">RECOMMENDED</span> that the Signature-Input field be included only as a header field to avoid signatures being inadvertently stripped from a message.<a class="pilcrow" href="#section-4.1-4">¶</a></p>
<p id="section-4.1-5">Multiple Signature-Input fields <span class="bcp14">MAY</span> be included in a single HTTP message. The signature labels <span class="bcp14">MUST</span> be unique across all field values.<a class="pilcrow" href="#section-4.1-5">¶</a></p>
</section>
</div>
<div id="signature-header">
<section id="section-4.2">
        <h3 id="name-the-signature-http-field">
<a class="section-number selfRef" href="#section-4.2">4.2. </a><a class="section-name selfRef" href="#name-the-signature-http-field">The Signature HTTP Field</a>
        </h3>
<p id="section-4.2-1">The Signature field is a Dictionary Structured Field (defined in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8941#section-3.2">Section 3.2</a> of [<a class="cite xref" href="#RFC8941">STRUCTURED-FIELDS</a>]</span>) containing one or more message signatures generated from the signature context of the target message. The member's key is the label that uniquely identifies the message signature within the HTTP message. The member's value is a Byte Sequence containing the signature value for the message signature identified by the label:<a class="pilcrow" href="#section-4.2-1">¶</a></p>
<div class="lang-http-message sourcecode" id="section-4.2-2">
<pre>NOTE: '\' line wrapping per RFC 8792

Signature: sig1=:P0wLUszWQjoi54udOtydf9IWTfNhy+r53jGFj9XZuP4uKwxyJo\
  1RSHi+oEF1FuX6O29d+lbxwwBao1BAgadijW+7O/PyezlTnqAOVPWx9GlyntiCiHz\
  C87qmSQjvu1CFyFuWSjdGa3qLYYlNm7pVaJFalQiKWnUaqfT4LyttaXyoyZW84jS8\
  gyarxAiWI97mPXU+OVM64+HVBHmnEsS+lTeIsEQo36T3NFf2CujWARPQg53r58Rmp\
  Z+J9eKR2CD6IJQvacn5A4Ix5BUAVGqlyp8JYm+S/CWJi31PNUjRRCusCVRj05NrxA\
  BNFv3r5S9IXf2fYJK+eyW4AiGVMvMcOg==:
</pre><a class="pilcrow" href="#section-4.2-2">¶</a>
</div>
<p id="section-4.2-3">The signer <span class="bcp14">MAY</span> include the Signature field as a trailer to facilitate signing a message after its content has been processed by the signer. However, since intermediaries are allowed to drop trailers as per <span>[<a class="cite xref" href="#RFC9110">HTTP</a>]</span>, it is <span class="bcp14">RECOMMENDED</span> that the Signature field be included only as a header field to avoid signatures being inadvertently stripped from a message.<a class="pilcrow" href="#section-4.2-3">¶</a></p>
<p id="section-4.2-4">Multiple Signature fields <span class="bcp14">MAY</span> be included in a single HTTP message. The signature labels <span class="bcp14">MUST</span> be unique across all field values.<a class="pilcrow" href="#section-4.2-4">¶</a></p>
</section>
</div>
<div id="signature-multiple">
<section id="section-4.3">
        <h3 id="name-multiple-signatures">
<a class="section-number selfRef" href="#section-4.3">4.3. </a><a class="section-name selfRef" href="#name-multiple-signatures">Multiple Signatures</a>
        </h3>
<p id="section-4.3-1">Multiple distinct signatures <span class="bcp14">MAY</span> be included in a single message. Each distinct signature <span class="bcp14">MUST</span> have a unique label. These multiple signatures could all be added by the same signer, or they could come from several different signers. For example, a signer may include multiple signatures signing the same message components with different keys or algorithms to support verifiers with different capabilities, or a reverse proxy may include information about the client in fields when forwarding the request to a service host, including a signature over the client's original signature values.<a class="pilcrow" href="#section-4.3-1">¶</a></p>
<p id="section-4.3-2">The following non-normative example starts with a signed request from the client. A reverse proxy takes this request and validates the client's signature:<a class="pilcrow" href="#section-4.3-2">¶</a></p>
<div class="lang-http-message sourcecode" id="section-4.3-3">
<pre>NOTE: '\' line wrapping per RFC 8792

POST /foo?param=Value&amp;Pet=dog HTTP/1.1
Host: example.com
Date: Tue, 20 Apr 2021 02:07:55 GMT
Content-Type: application/json
Content-Length: 18
Content-Digest: sha-512=:WZDPaVn/7XgHaAy8pmojAkGWoRx2UFChF41A2svX+T\
  aPm+AbwAgBWnrIiYllu7BNNyealdVLvRwEmTHWXvJwew==:
Signature-Input: sig1=("@method" "@authority" "@path" \
  "content-digest" "content-type" "content-length")\
  ;created=1618884475;keyid="test-key-ecc-p256"
Signature: sig1=:X5spyd6CFnAG5QnDyHfqoSNICd+BUP4LYMz2Q0JXlb//4Ijpzp\
  +kve2w4NIyqeAuM7jTDX+sNalzA8ESSaHD3A==:

{"hello": "world"}
</pre><a class="pilcrow" href="#section-4.3-3">¶</a>
</div>
<p id="section-4.3-4">The proxy then alters the message before forwarding it on to the origin server, changing the target host and adding the Forwarded header field defined in <span>[<a class="cite xref" href="#RFC7239">RFC7239</a>]</span>:<a class="pilcrow" href="#section-4.3-4">¶</a></p>
<div class="lang-http-message sourcecode" id="section-4.3-5">
<pre>NOTE: '\' line wrapping per RFC 8792

POST /foo?param=Value&amp;Pet=dog HTTP/1.1
Host: origin.host.internal.example
Date: Tue, 20 Apr 2021 02:07:56 GMT
Content-Type: application/json
Content-Length: 18
Forwarded: for=192.0.2.123;host=example.com;proto=https
Content-Digest: sha-512=:WZDPaVn/7XgHaAy8pmojAkGWoRx2UFChF41A2svX+T\
  aPm+AbwAgBWnrIiYllu7BNNyealdVLvRwEmTHWXvJwew==:
Signature-Input: sig1=("@method" "@authority" "@path" \
  "content-digest" "content-type" "content-length")\
  ;created=1618884475;keyid="test-key-ecc-p256"
Signature: sig1=:X5spyd6CFnAG5QnDyHfqoSNICd+BUP4LYMz2Q0JXlb//4Ijpzp\
  +kve2w4NIyqeAuM7jTDX+sNalzA8ESSaHD3A==:

{"hello": "world"}
</pre><a class="pilcrow" href="#section-4.3-5">¶</a>
</div>
<p id="section-4.3-6">The proxy is in a position to validate the incoming client's signature and make its own statement to the origin server about the nature of the request that it is forwarding by adding its own signature over the new message before passing it along to the origin server.
The proxy also includes all the elements from the original message that are relevant to the origin server's processing. In many cases, the proxy will want to cover all the same components that were covered by the client's signature, which is the case in the following example. Note that in this example, the proxy is signing over the new authority value, which it has changed. The proxy also adds the Forwarded header field to its own signature value.
The proxy identifies its own key and algorithm and, in this example, includes an expiration for the signature to indicate to downstream systems that the proxy will not vouch for this signed message past this short time window. This results in a signature base of:<a class="pilcrow" href="#section-4.3-6">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3-7">
<pre>NOTE: '\' line wrapping per RFC 8792

"@method": POST
"@authority": origin.host.internal.example
"@path": /foo
"content-digest": sha-512=:WZDPaVn/7XgHaAy8pmojAkGWoRx2UFChF41A2svX\
  +TaPm+AbwAgBWnrIiYllu7BNNyealdVLvRwEmTHWXvJwew==:
"content-type": application/json
"content-length": 18
"forwarded": for=192.0.2.123;host=example.com;proto=https
"@signature-params": ("@method" "@authority" "@path" \
  "content-digest" "content-type" "content-length" "forwarded")\
  ;created=1618884480;keyid="test-key-rsa";alg="rsa-v1_5-sha256"\
  ;expires=1618884540
</pre><a class="pilcrow" href="#section-4.3-7">¶</a>
</div>
<p id="section-4.3-8">and a signature output value of:<a class="pilcrow" href="#section-4.3-8">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3-9">
<pre>NOTE: '\' line wrapping per RFC 8792

S6ZzPXSdAMOPjN/6KXfXWNO/f7V6cHm7BXYUh3YD/fRad4BCaRZxP+JH+8XY1I6+8Cy\
+CM5g92iHgxtRPz+MjniOaYmdkDcnL9cCpXJleXsOckpURl49GwiyUpZ10KHgOEe11s\
x3G2gxI8S0jnxQB+Pu68U9vVcasqOWAEObtNKKZd8tSFu7LB5YAv0RAGhB8tmpv7sFn\
Im9y+7X5kXQfi8NMaZaA8i2ZHwpBdg7a6CMfwnnrtflzvZdXAsD3LH2TwevU+/PBPv0\
B6NMNk93wUs/vfJvye+YuI87HU38lZHowtznbLVdp770I6VHR6WfgS9ddzirrswsE1w\
5o0LV/g==
</pre><a class="pilcrow" href="#section-4.3-9">¶</a>
</div>
<p id="section-4.3-10">These values are added to the HTTP request message by the proxy. The original signature is included under the label <code>sig1</code>, and the reverse proxy's signature is included under the label <code>proxy_sig</code>. The proxy uses the key <code>test-key-rsa</code> to create its signature using the <code>rsa-v1_5-sha256</code> signature algorithm, while the client's original signature was made using the key <code>test-key-rsa-pss</code> and an RSA-PSS signature algorithm:<a class="pilcrow" href="#section-4.3-10">¶</a></p>
<div class="lang-http-message sourcecode" id="section-4.3-11">
<pre>NOTE: '\' line wrapping per RFC 8792

POST /foo?param=Value&amp;Pet=dog HTTP/1.1
Host: origin.host.internal.example
Date: Tue, 20 Apr 2021 02:07:56 GMT
Content-Type: application/json
Content-Length: 18
Forwarded: for=192.0.2.123;host=example.com;proto=https
Content-Digest: sha-512=:WZDPaVn/7XgHaAy8pmojAkGWoRx2UFChF41A2svX+T\
  aPm+AbwAgBWnrIiYllu7BNNyealdVLvRwEmTHWXvJwew==:
Signature-Input: sig1=("@method" "@authority" "@path" \
    "content-digest" "content-type" "content-length")\
    ;created=1618884475;keyid="test-key-ecc-p256", \
  proxy_sig=("@method" "@authority" "@path" "content-digest" \
    "content-type" "content-length" "forwarded")\
    ;created=1618884480;keyid="test-key-rsa";alg="rsa-v1_5-sha256"\
    ;expires=1618884540
Signature: sig1=:X5spyd6CFnAG5QnDyHfqoSNICd+BUP4LYMz2Q0JXlb//4Ijpzp\
    +kve2w4NIyqeAuM7jTDX+sNalzA8ESSaHD3A==:, \
  proxy_sig=:S6ZzPXSdAMOPjN/6KXfXWNO/f7V6cHm7BXYUh3YD/fRad4BCaRZxP+\
    JH+8XY1I6+8Cy+CM5g92iHgxtRPz+MjniOaYmdkDcnL9cCpXJleXsOckpURl49G\
    wiyUpZ10KHgOEe11sx3G2gxI8S0jnxQB+Pu68U9vVcasqOWAEObtNKKZd8tSFu7\
    LB5YAv0RAGhB8tmpv7sFnIm9y+7X5kXQfi8NMaZaA8i2ZHwpBdg7a6CMfwnnrtf\
    lzvZdXAsD3LH2TwevU+/PBPv0B6NMNk93wUs/vfJvye+YuI87HU38lZHowtznbL\
    Vdp770I6VHR6WfgS9ddzirrswsE1w5o0LV/g==:

{"hello": "world"}
</pre><a class="pilcrow" href="#section-4.3-11">¶</a>
</div>
<p id="section-4.3-12">While the proxy could additionally include the client's Signature field value and Signature-Input fields from the original message in the new signature's covered components, this practice is <span class="bcp14">NOT RECOMMENDED</span> due to known weaknesses in signing signature values as discussed in <a class="auto internal xref" href="#security-sign-signature">Section 7.3.7</a>. The proxy is in a position to validate the client's signature; the changes the proxy makes to the message will invalidate the existing signature when the message is seen by the origin server. In this example, it is possible for the origin server to have additional information in its signature context to account for the change in authority, though this practice requires additional configuration and extra care as discussed in <a class="auto internal xref" href="#security-context-multiple-signatures">Section 7.4.4</a>. In other applications, the origin server will not be able to verify the original signature itself but will still want to verify that the proxy has done the appropriate validation of the client's signature. An application that needs to signal successful processing or receipt of a signature would need to carefully specify alternative mechanisms for sending such a signal securely.<a class="pilcrow" href="#section-4.3-12">¶</a></p>
</section>
</div>
</section>
</div>
<div id="request-signature">
<section id="section-5">
      <h2 id="name-requesting-signatures">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-requesting-signatures">Requesting Signatures</a>
      </h2>
<p id="section-5-1">While a signer is free to attach a signature to a request or response without prompting, it is often desirable for a potential verifier to signal that it expects a signature from a potential signer using the Accept-Signature field.<a class="pilcrow" href="#section-5-1">¶</a></p>
<p id="section-5-2">When the Accept-Signature field is sent in an HTTP request message, the field indicates that the client desires the server to sign the response using the identified parameters, and the target message is the response to this request. All responses from resources that support such signature negotiation <span class="bcp14">SHOULD</span> either be uncacheable or contain a Vary header field that lists Accept-Signature, in order to prevent a cache from returning a response with a signature intended for a different request.<a class="pilcrow" href="#section-5-2">¶</a></p>
<p id="section-5-3">When the Accept-Signature field is used in an HTTP response message, the field indicates that the server desires the client to sign its next request to the server with the identified parameters, and the target message is the client's next request. The client can choose to also continue signing future requests to the same server in the same way.<a class="pilcrow" href="#section-5-3">¶</a></p>
<p id="section-5-4">The target message of an Accept-Signature field <span class="bcp14">MUST</span> include all labeled signatures indicated in the Accept-Signature field, each covering the same identified components of the Accept-Signature field.<a class="pilcrow" href="#section-5-4">¶</a></p>
<p id="section-5-5">The sender of an Accept-Signature field <span class="bcp14">MUST</span> include only identifiers that are appropriate for the type of the target message. For example, if the target message is a request, the covered components cannot include the <code>@status</code> component identifier.<a class="pilcrow" href="#section-5-5">¶</a></p>
<div id="accept-signature-header">
<section id="section-5.1">
        <h3 id="name-the-accept-signature-field">
<a class="section-number selfRef" href="#section-5.1">5.1. </a><a class="section-name selfRef" href="#name-the-accept-signature-field">The Accept-Signature Field</a>
        </h3>
<p id="section-5.1-1">The Accept-Signature field is a Dictionary Structured Field (defined in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8941#section-3.2">Section 3.2</a> of [<a class="cite xref" href="#RFC8941">STRUCTURED-FIELDS</a>]</span>) containing the metadata for one or more requested message signatures to be generated from message components of the target HTTP message. Each member describes a single message signature. The member's key is the label that uniquely identifies the requested message signature within the context of the target HTTP message.<a class="pilcrow" href="#section-5.1-1">¶</a></p>
<p id="section-5.1-2">The member's value is the serialization of the desired covered components of the target message, including any allowed component metadata parameters, using the serialization process defined in <a class="auto internal xref" href="#signature-params">Section 2.3</a>:<a class="pilcrow" href="#section-5.1-2">¶</a></p>
<div class="lang-http-message sourcecode" id="section-5.1-3">
<pre>NOTE: '\' line wrapping per RFC 8792

Accept-Signature: sig1=("@method" "@target-uri" "@authority" \
  "content-digest" "cache-control");\
  keyid="test-key-rsa-pss";created;tag="app-123"
</pre><a class="pilcrow" href="#section-5.1-3">¶</a>
</div>
<p id="section-5.1-4">The list of component identifiers indicates the exact set of component identifiers to be included in the requested signature, including all applicable component parameters.<a class="pilcrow" href="#section-5.1-4">¶</a></p>
<p id="section-5.1-5">The signature request <span class="bcp14">MAY</span> include signature metadata parameters that indicate desired behavior for the signer. The following behavior is defined by this specification:<a class="pilcrow" href="#section-5.1-5">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.1-6">
          <dt id="section-5.1-6.1">
            <code>created</code>:</dt>
          <dd id="section-5.1-6.2" style="margin-left: 1.5em">The signer is requested to generate and include a creation time. This parameter has no associated value when sent as a signature request.<a class="pilcrow" href="#section-5.1-6.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-6.3">
            <code>expires</code>:</dt>
          <dd id="section-5.1-6.4" style="margin-left: 1.5em">The signer is requested to generate and include an expiration time. This parameter has no associated value when sent as a signature request.<a class="pilcrow" href="#section-5.1-6.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-6.5">
            <code>nonce</code>:</dt>
          <dd id="section-5.1-6.6" style="margin-left: 1.5em">The signer is requested to include the value of this parameter as the signature <code>nonce</code> in the target signature.<a class="pilcrow" href="#section-5.1-6.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-6.7">
            <code>alg</code>:</dt>
          <dd id="section-5.1-6.8" style="margin-left: 1.5em">The signer is requested to use the indicated signature algorithm from the "HTTP Signature Algorithms" registry to create the target signature.<a class="pilcrow" href="#section-5.1-6.8">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-6.9">
            <code>keyid</code>:</dt>
          <dd id="section-5.1-6.10" style="margin-left: 1.5em">The signer is requested to use the indicated key material to create the target signature.<a class="pilcrow" href="#section-5.1-6.10">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-6.11">
            <code>tag</code>:</dt>
          <dd id="section-5.1-6.12" style="margin-left: 1.5em">The signer is requested to include the value of this parameter as the signature <code>tag</code> in the target signature.<a class="pilcrow" href="#section-5.1-6.12">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="processing-an-accept-signature">
<section id="section-5.2">
        <h3 id="name-processing-an-accept-signat">
<a class="section-number selfRef" href="#section-5.2">5.2. </a><a class="section-name selfRef" href="#name-processing-an-accept-signat">Processing an Accept-Signature</a>
        </h3>
<p id="section-5.2-1">The receiver of an Accept-Signature field fulfills that header as follows:<a class="pilcrow" href="#section-5.2-1">¶</a></p>
<ol class="normal type-1" id="section-5.2-2" start="1" type="1">
<li id="section-5.2-2.1">Parse the field value as a Dictionary.<a class="pilcrow" href="#section-5.2-2.1">¶</a>
</li>
          <li id="section-5.2-2.2">
            <p id="section-5.2-2.2.1">For each member of the Dictionary:<a class="pilcrow" href="#section-5.2-2.2.1">¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-5.2-2.2.2">
<dt>2.1.</dt>
<dd id="section-5.2-2.2.2.1">The key is taken as the label of the output signature as specified in <a class="auto internal xref" href="#signature-input-header">Section 4.1</a>.<a class="pilcrow" href="#section-5.2-2.2.2.1">¶</a>
</dd>
              <dd class="break"></dd>
<dt>2.2.</dt>
<dd id="section-5.2-2.2.2.2">Parse the value of the member to obtain the set of covered component identifiers.<a class="pilcrow" href="#section-5.2-2.2.2.2">¶</a>
</dd>
              <dd class="break"></dd>
<dt>2.3.</dt>
<dd id="section-5.2-2.2.2.3">Determine that the covered components are applicable to the target message. If not, the process fails and returns an error.<a class="pilcrow" href="#section-5.2-2.2.2.3">¶</a>
</dd>
              <dd class="break"></dd>
<dt>2.4.</dt>
<dd id="section-5.2-2.2.2.4">Process the requested parameters, such as the signing algorithm and key material. If any requested parameters cannot be fulfilled or if the requested parameters conflict with those deemed appropriate to the target message, the process fails and returns an error.<a class="pilcrow" href="#section-5.2-2.2.2.4">¶</a>
</dd>
              <dd class="break"></dd>
<dt>2.5.</dt>
<dd id="section-5.2-2.2.2.5">Select and generate any additional parameters necessary for completing the signature.<a class="pilcrow" href="#section-5.2-2.2.2.5">¶</a>
</dd>
              <dd class="break"></dd>
<dt>2.6.</dt>
<dd id="section-5.2-2.2.2.6">Create the HTTP message signature over the target message.<a class="pilcrow" href="#section-5.2-2.2.2.6">¶</a>
</dd>
              <dd class="break"></dd>
<dt>2.7.</dt>
<dd id="section-5.2-2.2.2.7">Create the Signature-Input and Signature field values, and associate them with the label.<a class="pilcrow" href="#section-5.2-2.2.2.7">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</li>
          <li id="section-5.2-2.3">Optionally create any additional Signature-Input and Signature field values, with unique labels not found in the Accept-Signature field.<a class="pilcrow" href="#section-5.2-2.3">¶</a>
</li>
          <li id="section-5.2-2.4">Combine all labeled Signature-Input and Signature field values, and attach both fields to the target message.<a class="pilcrow" href="#section-5.2-2.4">¶</a>
</li>
        </ol>
<p id="section-5.2-3">By this process, a signature applied to a target message <span class="bcp14">MUST</span> have the same label, <span class="bcp14">MUST</span> include the same set of covered components, <span class="bcp14">MUST</span> process all requested parameters, and <span class="bcp14">MAY</span> have additional parameters.<a class="pilcrow" href="#section-5.2-3">¶</a></p>
<p id="section-5.2-4">The receiver of an Accept-Signature field <span class="bcp14">MAY</span> ignore any signature request that does not fit application parameters.<a class="pilcrow" href="#section-5.2-4">¶</a></p>
<p id="section-5.2-5">The target message <span class="bcp14">MAY</span> include additional signatures not specified by the Accept-Signature field. For example, to cover additional message components, the signer can create a second signature that includes the additional components as well as the signature output of the requested signature.<a class="pilcrow" href="#section-5.2-5">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana">
<section id="section-6">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<p id="section-6-1">IANA has updated one registry and created four new registries, according to the following sections.<a class="pilcrow" href="#section-6-1">¶</a></p>
<div id="http-field-name-registration">
<section id="section-6.1">
        <h3 id="name-http-field-name-registratio">
<a class="section-number selfRef" href="#section-6.1">6.1. </a><a class="section-name selfRef" href="#name-http-field-name-registratio">HTTP Field Name Registration</a>
        </h3>
<p id="section-6.1-1">IANA has updated the entries in the 
"Hypertext Transfer Protocol (HTTP) Field Name Registry" as follows:<a class="pilcrow" href="#section-6.1-1">¶</a></p>
<span id="name-updates-to-the-hypertext-tr"></span><table class="center" id="table-1">
          <caption>
<a class="selfRef" href="#table-1">Table 1</a>:
<a class="selfRef" href="#name-updates-to-the-hypertext-tr">Updates to the Hypertext Transfer Protocol (HTTP) Field Name Registry</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Field Name</th>
              <th class="text-left" colspan="1" rowspan="1">Status</th>
              <th class="text-left" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">Signature-Input</td>
              <td class="text-left" colspan="1" rowspan="1">permanent</td>
              <td class="text-left" colspan="1" rowspan="1">
                <a class="auto internal xref" href="#signature-input-header">Section 4.1</a> of RFC 9421</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">Signature</td>
              <td class="text-left" colspan="1" rowspan="1">permanent</td>
              <td class="text-left" colspan="1" rowspan="1">
                <a class="auto internal xref" href="#signature-header">Section 4.2</a> of RFC 9421</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">Accept-Signature</td>
              <td class="text-left" colspan="1" rowspan="1">permanent</td>
              <td class="text-left" colspan="1" rowspan="1">
                <a class="auto internal xref" href="#accept-signature-header">Section 5.1</a> of RFC 9421</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="hsa-registry">
<section id="section-6.2">
        <h3 id="name-http-signature-algorithms-r">
<a class="section-number selfRef" href="#section-6.2">6.2. </a><a class="section-name selfRef" href="#name-http-signature-algorithms-r">HTTP Signature Algorithms Registry</a>
        </h3>
<p id="section-6.2-1">This document defines HTTP signature algorithms, for which IANA has created and now maintains a new registry titled "HTTP Signature Algorithms". Initial values for this registry are given in <a class="auto internal xref" href="#iana-hsa-contents">Section 6.2.2</a>. Future assignments and modifications to existing assignments are to be made through the Specification Required registration policy <span>[<a class="cite xref" href="#RFC8126">RFC8126</a>]</span>.<a class="pilcrow" href="#section-6.2-1">¶</a></p>
<p id="section-6.2-2">The algorithms listed in this registry identify some possible cryptographic algorithms for applications to use with this specification, but the entries neither represent an exhaustive list of possible algorithms nor indicate fitness for purpose with any particular application of this specification. An application is free to implement any algorithm that suits its needs, provided the signer and verifier can agree to the parameters of that algorithm in a secure and deterministic fashion. When an application needs to signal the use of a particular algorithm at runtime using the <code>alg</code> signature parameter, this registry provides a mapping between the value of that parameter and a particular algorithm. However, the use of the <code>alg</code> parameter needs to be treated with caution to avoid various forms of algorithm confusion and substitution attacks, as discussed in <a class="auto internal xref" href="#security">Section 7</a>.<a class="pilcrow" href="#section-6.2-2">¶</a></p>
<p id="section-6.2-3">The Status value should reflect standardization status and the broad opinion of relevant interest groups such as the IETF or security-related Standards Development Organizations (SDOs). When an algorithm is first registered, the designated expert (DE) should set the Status field to "Active" if there is consensus for the algorithm to be generally recommended as secure or "Provisional" if the algorithm has not reached that consensus, e.g., for an experimental algorithm. A status of "Provisional" does not mean that the algorithm is known to be insecure but instead indicates that the algorithm has not reached consensus regarding its properties. If at a future time the algorithm as registered is found to have flaws, the registry entry can be updated and the algorithm can be marked as "Deprecated" to indicate that the algorithm has been found to have problems. This status does not preclude an application from using a particular algorithm; rather, it serves to provide a warning regarding possible known issues with an algorithm that need to be considered by the application. The DE can further ensure that the registration includes an explanation and reference for the Status value; this is particularly important for deprecated algorithms.<a class="pilcrow" href="#section-6.2-3">¶</a></p>
<p id="section-6.2-4">The DE is expected to do the following:<a class="pilcrow" href="#section-6.2-4">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2-5.1">Ensure that the algorithms referenced by a registered algorithm identifier are fully defined with all parameters (e.g., salt, hash, required key length) fixed by the defining text.<a class="pilcrow" href="#section-6.2-5.1">¶</a>
</li>
          <li class="normal" id="section-6.2-5.2">Ensure that the algorithm definition fully specifies the <code>HTTP_SIGN</code> and <code>HTTP_VERIFY</code> primitive functions, including how all defined inputs and outputs map to the underlying cryptographic algorithm.<a class="pilcrow" href="#section-6.2-5.2">¶</a>
</li>
          <li class="normal" id="section-6.2-5.3">Reject any registrations that are aliases of existing registrations.<a class="pilcrow" href="#section-6.2-5.3">¶</a>
</li>
          <li class="normal" id="section-6.2-5.4">Ensure that all registrations follow the template presented in <a class="auto internal xref" href="#iana-hsa-template">Section 6.2.1</a>; this includes ensuring that the length of the name is not excessive while still being unique and recognizable.<a class="pilcrow" href="#section-6.2-5.4">¶</a>
</li>
        </ul>
<p id="section-6.2-6">This specification creates algorithm identifiers by including major parameters in the identifier String in order to make the algorithm name unique and recognizable by developers. However, algorithm identifiers in this registry are to be interpreted as whole String values and not as a combination of parts. That is to say, it is expected that implementors understand <code>rsa-pss-sha512</code> as referring to one specific algorithm with its hash, mask, and salt values set as defined in the defining text that establishes the identifier in question. Implementors do not parse out the <code>rsa</code>, <code>pss</code>, and <code>sha512</code> portions of the identifier to determine parameters of the signing algorithm from the String, and the registration of one combination of parameters does not imply the registration of other combinations.<a class="pilcrow" href="#section-6.2-6">¶</a></p>
<div id="iana-hsa-template">
<section id="section-6.2.1">
          <h4 id="name-registration-template">
<a class="section-number selfRef" href="#section-6.2.1">6.2.1. </a><a class="section-name selfRef" href="#name-registration-template">Registration Template</a>
          </h4>
<span class="break"></span><dl class="dlNewline" id="section-6.2.1-1">
            <dt id="section-6.2.1-1.1">Algorithm Name:</dt>
            <dd id="section-6.2.1-1.2" style="margin-left: 1.5em">
              <p id="section-6.2.1-1.2.1">An identifier for the HTTP signature algorithm. The name <span class="bcp14">MUST</span> be an ASCII string that conforms to the <code>sf-string</code> ABNF rule in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8941#section-3.3.3">Section 3.3.3</a> of [<a class="cite xref" href="#RFC8941">STRUCTURED-FIELDS</a>]</span> and <span class="bcp14">SHOULD NOT</span> exceed 20 characters in length. The identifier <span class="bcp14">MUST</span> be unique within the context of the registry.<a class="pilcrow" href="#section-6.2.1-1.2.1">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-6.2.1-1.3">Description:</dt>
            <dd id="section-6.2.1-1.4" style="margin-left: 1.5em">
              <p id="section-6.2.1-1.4.1">A brief description of the algorithm used to sign the signature base.<a class="pilcrow" href="#section-6.2.1-1.4.1">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-6.2.1-1.5">Status:</dt>
            <dd id="section-6.2.1-1.6" style="margin-left: 1.5em">
              <p id="section-6.2.1-1.6.1">The status of the algorithm. <span class="bcp14">MUST</span> start with one of the following values and <span class="bcp14">MAY</span> contain additional explanatory text. The options are:<a class="pilcrow" href="#section-6.2.1-1.6.1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-6.2.1-1.6.2">
                <dt id="section-6.2.1-1.6.2.1">"Active":</dt>
                <dd id="section-6.2.1-1.6.2.2" style="margin-left: 1.5em">For algorithms without known problems. The signature algorithm is fully specified, and its security properties are understood.<a class="pilcrow" href="#section-6.2.1-1.6.2.2">¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-6.2.1-1.6.2.3">"Provisional":</dt>
                <dd id="section-6.2.1-1.6.2.4" style="margin-left: 1.5em">For unproven algorithms. The signature algorithm is fully specified, but its security properties are not known or proven.<a class="pilcrow" href="#section-6.2.1-1.6.2.4">¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-6.2.1-1.6.2.5">"Deprecated":</dt>
                <dd id="section-6.2.1-1.6.2.6" style="margin-left: 1.5em">For algorithms with known security issues. The signature algorithm is no longer recommended for general use and might be insecure or unsafe in some known circumstances.<a class="pilcrow" href="#section-6.2.1-1.6.2.6">¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</dd>
            <dd class="break"></dd>
<dt id="section-6.2.1-1.7">Reference:</dt>
            <dd id="section-6.2.1-1.8" style="margin-left: 1.5em">
              <p id="section-6.2.1-1.8.1">Reference to the document or documents that specify the
  algorithm, preferably including a URI that can be used
  to retrieve a copy of the document(s). An indication of the
  relevant sections may also be included but is not required.<a class="pilcrow" href="#section-6.2.1-1.8.1">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="iana-hsa-contents">
<section id="section-6.2.2">
          <h4 id="name-initial-contents">
<a class="section-number selfRef" href="#section-6.2.2">6.2.2. </a><a class="section-name selfRef" href="#name-initial-contents">Initial Contents</a>
          </h4>
<p id="section-6.2.2-1">The table below contains the initial contents of the "HTTP Signature Algorithms" registry.<a class="pilcrow" href="#section-6.2.2-1">¶</a></p>
<span id="name-initial-contents-of-the-htt"></span><table class="center" id="table-2">
            <caption>
<a class="selfRef" href="#table-2">Table 2</a>:
<a class="selfRef" href="#name-initial-contents-of-the-htt">Initial Contents of the HTTP Signature Algorithms Registry</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" colspan="1" rowspan="1">Algorithm Name</th>
                <th class="text-left" colspan="1" rowspan="1">Description</th>
                <th class="text-left" colspan="1" rowspan="1">Status</th>
                <th class="text-left" colspan="1" rowspan="1">Reference</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">
                  <code>rsa-pss-sha512</code>
</td>
                <td class="text-left" colspan="1" rowspan="1">RSASSA-PSS using SHA-512</td>
                <td class="text-left" colspan="1" rowspan="1">Active</td>
                <td class="text-left" colspan="1" rowspan="1">
                  <a class="auto internal xref" href="#method-rsa-pss-sha512">Section 3.3.1</a> of RFC 9421</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">
                  <code>rsa-v1_5-sha256</code>
</td>
                <td class="text-left" colspan="1" rowspan="1">RSASSA-PKCS1-v1_5 using SHA-256</td>
                <td class="text-left" colspan="1" rowspan="1">Active</td>
                <td class="text-left" colspan="1" rowspan="1">
                  <a class="auto internal xref" href="#method-rsa-v1_5-sha256">Section 3.3.2</a> of RFC 9421</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">
                  <code>hmac-sha256</code>
</td>
                <td class="text-left" colspan="1" rowspan="1">HMAC using SHA-256</td>
                <td class="text-left" colspan="1" rowspan="1">Active</td>
                <td class="text-left" colspan="1" rowspan="1">
                  <a class="auto internal xref" href="#method-hmac-sha256">Section 3.3.3</a> of RFC 9421</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">
                  <code>ecdsa-p256-sha256</code>
</td>
                <td class="text-left" colspan="1" rowspan="1">ECDSA using curve P-256 DSS and SHA-256</td>
                <td class="text-left" colspan="1" rowspan="1">Active</td>
                <td class="text-left" colspan="1" rowspan="1">
                  <a class="auto internal xref" href="#method-ecdsa-p256-sha256">Section 3.3.4</a> of RFC 9421</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">
                  <code>ecdsa-p384-sha384</code>
</td>
                <td class="text-left" colspan="1" rowspan="1">ECDSA using curve P-384 DSS and SHA-384</td>
                <td class="text-left" colspan="1" rowspan="1">Active</td>
                <td class="text-left" colspan="1" rowspan="1">
                  <a class="auto internal xref" href="#method-ecdsa-p384-sha384">Section 3.3.5</a> of RFC 9421</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">
                  <code>ed25519</code>
</td>
                <td class="text-left" colspan="1" rowspan="1">EdDSA using curve edwards25519</td>
                <td class="text-left" colspan="1" rowspan="1">Active</td>
                <td class="text-left" colspan="1" rowspan="1">
                  <a class="auto internal xref" href="#method-ed25519">Section 3.3.6</a> of RFC 9421</td>
              </tr>
            </tbody>
          </table>
</section>
</div>
</section>
</div>
<div id="param-registry">
<section id="section-6.3">
        <h3 id="name-http-signature-metadata-par">
<a class="section-number selfRef" href="#section-6.3">6.3. </a><a class="section-name selfRef" href="#name-http-signature-metadata-par">HTTP Signature Metadata Parameters Registry</a>
        </h3>
<p id="section-6.3-1">This document defines the signature parameters structure (<a class="auto internal xref" href="#signature-params">Section 2.3</a>), which may have parameters containing metadata about a message signature. IANA has created and now maintains a new registry titled "HTTP Signature Metadata Parameters" to record and maintain the set of parameters defined for use with member values in the signature parameters structure. Initial values for this registry are given in <a class="auto internal xref" href="#iana-param-contents">Section 6.3.2</a>. Future assignments and modifications to existing assignments are to be made through the Expert Review registration policy <span>[<a class="cite xref" href="#RFC8126">RFC8126</a>]</span>.<a class="pilcrow" href="#section-6.3-1">¶</a></p>
<p id="section-6.3-2">The DE is expected to do the following:<a class="pilcrow" href="#section-6.3-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.3-3.1">Ensure that the name follows the template presented in <a class="auto internal xref" href="#iana-param-template">Section 6.3.1</a>; this includes ensuring that the length of the name is not excessive while still being unique and recognizable for its defined function.<a class="pilcrow" href="#section-6.3-3.1">¶</a>
</li>
          <li class="normal" id="section-6.3-3.2">Ensure that the defined functionality is clear and does not conflict with other registered parameters.<a class="pilcrow" href="#section-6.3-3.2">¶</a>
</li>
          <li class="normal" id="section-6.3-3.3">Ensure that the definition of the metadata parameter includes its behavior when used as part of the normal signature process as well as when used in an Accept-Signature field.<a class="pilcrow" href="#section-6.3-3.3">¶</a>
</li>
        </ul>
<div id="iana-param-template">
<section id="section-6.3.1">
          <h4 id="name-registration-template-2">
<a class="section-number selfRef" href="#section-6.3.1">6.3.1. </a><a class="section-name selfRef" href="#name-registration-template-2">Registration Template</a>
          </h4>
<span class="break"></span><dl class="dlNewline" id="section-6.3.1-1">
            <dt id="section-6.3.1-1.1">Name:</dt>
            <dd id="section-6.3.1-1.2" style="margin-left: 1.5em">
              <p id="section-6.3.1-1.2.1">An identifier for the HTTP signature metadata parameter. The name <span class="bcp14">MUST</span> be an ASCII string that conforms to the <code>key</code> ABNF rule defined in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8941#section-3.1.2">Section 3.1.2</a> of [<a class="cite xref" href="#RFC8941">STRUCTURED-FIELDS</a>]</span> and <span class="bcp14">SHOULD NOT</span> exceed 20 characters in length. The identifier <span class="bcp14">MUST</span> be unique within the context of the registry.<a class="pilcrow" href="#section-6.3.1-1.2.1">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-6.3.1-1.3">Description:</dt>
            <dd id="section-6.3.1-1.4" style="margin-left: 1.5em">
              <p id="section-6.3.1-1.4.1">A brief description of the metadata parameter and what it represents.<a class="pilcrow" href="#section-6.3.1-1.4.1">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-6.3.1-1.5">Reference:</dt>
            <dd id="section-6.3.1-1.6" style="margin-left: 1.5em">
              <p id="section-6.3.1-1.6.1">Reference to the document or documents that specify the
  parameter, preferably including a URI that can be used
  to retrieve a copy of the document(s). An indication of the
  relevant sections may also be included but is not required.<a class="pilcrow" href="#section-6.3.1-1.6.1">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="iana-param-contents">
<section id="section-6.3.2">
          <h4 id="name-initial-contents-2">
<a class="section-number selfRef" href="#section-6.3.2">6.3.2. </a><a class="section-name selfRef" href="#name-initial-contents-2">Initial Contents</a>
          </h4>
<p id="section-6.3.2-1">The table below contains the initial contents of the "HTTP Signature Metadata Parameters" registry. Each row in the table represents a distinct entry in the registry.<a class="pilcrow" href="#section-6.3.2-1">¶</a></p>
<span id="name-initial-contents-of-the-http"></span><table class="center" id="table-3">
            <caption>
<a class="selfRef" href="#table-3">Table 3</a>:
<a class="selfRef" href="#name-initial-contents-of-the-http">Initial Contents of the HTTP Signature Metadata Parameters Registry</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" colspan="1" rowspan="1">Name</th>
                <th class="text-left" colspan="1" rowspan="1">Description</th>
                <th class="text-left" colspan="1" rowspan="1">Reference</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">
                  <code>alg</code>
</td>
                <td class="text-left" colspan="1" rowspan="1">Explicitly declared signature algorithm</td>
                <td class="text-left" colspan="1" rowspan="1">
                  <a class="auto internal xref" href="#signature-params">Section 2.3</a> of RFC 9421</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">
                  <code>created</code>
</td>
                <td class="text-left" colspan="1" rowspan="1">Timestamp of signature creation</td>
                <td class="text-left" colspan="1" rowspan="1">
                  <a class="auto internal xref" href="#signature-params">Section 2.3</a> of RFC 9421</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">
                  <code>expires</code>
</td>
                <td class="text-left" colspan="1" rowspan="1">Timestamp of proposed signature expiration</td>
                <td class="text-left" colspan="1" rowspan="1">
                  <a class="auto internal xref" href="#signature-params">Section 2.3</a> of RFC 9421</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">
                  <code>keyid</code>
</td>
                <td class="text-left" colspan="1" rowspan="1">Key identifier for the signing and verification keys used to create this signature</td>
                <td class="text-left" colspan="1" rowspan="1">
                  <a class="auto internal xref" href="#signature-params">Section 2.3</a> of RFC 9421</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">
                  <code>nonce</code>
</td>
                <td class="text-left" colspan="1" rowspan="1">A single-use nonce value</td>
                <td class="text-left" colspan="1" rowspan="1">
                  <a class="auto internal xref" href="#signature-params">Section 2.3</a> of RFC 9421</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">
                  <code>tag</code>
</td>
                <td class="text-left" colspan="1" rowspan="1">An application-specific tag for a signature</td>
                <td class="text-left" colspan="1" rowspan="1">
                  <a class="auto internal xref" href="#signature-params">Section 2.3</a> of RFC 9421</td>
              </tr>
            </tbody>
          </table>
</section>
</div>
</section>
</div>
<div id="content-registry">
<section id="section-6.4">
        <h3 id="name-http-signature-derived-comp">
<a class="section-number selfRef" href="#section-6.4">6.4. </a><a class="section-name selfRef" href="#name-http-signature-derived-comp">HTTP Signature Derived Component Names Registry</a>
        </h3>
<p id="section-6.4-1">This document defines a method for canonicalizing HTTP message components, including components that can be derived from the context of the target message outside of the HTTP fields. These derived components are identified by a unique String, known as the component name. Component names for derived components always start with the "at" (@) symbol to distinguish them from HTTP field names. IANA has created and now maintains a new registry titled "HTTP Signature Derived Component Names" to record and maintain the set of non-field component names and the methods used to produce their associated component values. Initial values for this registry are given in <a class="auto internal xref" href="#iana-content-contents">Section 6.4.2</a>. Future assignments and modifications to existing assignments are to be made through the Expert Review registration policy <span>[<a class="cite xref" href="#RFC8126">RFC8126</a>]</span>.<a class="pilcrow" href="#section-6.4-1">¶</a></p>
<p id="section-6.4-2">The DE is expected to do the following:<a class="pilcrow" href="#section-6.4-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.4-3.1">Ensure that the name follows the template presented in <a class="auto internal xref" href="#iana-content-template">Section 6.4.1</a>; this includes ensuring that the length of the name is not excessive while still being unique and recognizable for its defined function.<a class="pilcrow" href="#section-6.4-3.1">¶</a>
</li>
          <li class="normal" id="section-6.4-3.2">Ensure that the component value represented by the registration request can be deterministically derived from the target HTTP message.<a class="pilcrow" href="#section-6.4-3.2">¶</a>
</li>
          <li class="normal" id="section-6.4-3.3">Ensure that any parameters defined for the registration request are clearly documented, along with their effects on the component value.<a class="pilcrow" href="#section-6.4-3.3">¶</a>
</li>
        </ul>
<p id="section-6.4-4">The DE should ensure that a registration is sufficiently distinct from existing derived component definitions to warrant its registration.<a class="pilcrow" href="#section-6.4-4">¶</a></p>
<p id="section-6.4-5">When setting a registered item's status to "Deprecated", the DE should ensure that a reason for the deprecation is documented, along with instructions for moving away from the deprecated functionality.<a class="pilcrow" href="#section-6.4-5">¶</a></p>
<div id="iana-content-template">
<section id="section-6.4.1">
          <h4 id="name-registration-template-3">
<a class="section-number selfRef" href="#section-6.4.1">6.4.1. </a><a class="section-name selfRef" href="#name-registration-template-3">Registration Template</a>
          </h4>
<span class="break"></span><dl class="dlNewline" id="section-6.4.1-1">
            <dt id="section-6.4.1-1.1">Name:</dt>
            <dd id="section-6.4.1-1.2" style="margin-left: 1.5em">
              <p id="section-6.4.1-1.2.1">A name for the HTTP derived component. The name <span class="bcp14">MUST</span> begin with the "at" (<code>@</code>) character followed by an ASCII string consisting only of lowercase characters (<code>"a"</code>-<code>"z"</code>), digits (<code>"0"</code>-<code>"9"</code>), and hyphens (<code>"-"</code>), and <span class="bcp14">SHOULD NOT</span> exceed 20 characters in length. The name <span class="bcp14">MUST</span> be unique within the context of the registry.<a class="pilcrow" href="#section-6.4.1-1.2.1">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-6.4.1-1.3">Description:</dt>
            <dd id="section-6.4.1-1.4" style="margin-left: 1.5em">
              <p id="section-6.4.1-1.4.1">A description of the derived component.<a class="pilcrow" href="#section-6.4.1-1.4.1">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-6.4.1-1.5">Status:</dt>
            <dd id="section-6.4.1-1.6" style="margin-left: 1.5em">
              <p id="section-6.4.1-1.6.1">A brief text description of the status of the algorithm. The description <span class="bcp14">MUST</span> begin with one of "Active" or "Deprecated" and <span class="bcp14">MAY</span> provide further context or explanation as to the reason for the status. A value of "Deprecated" indicates that the derived component name is no longer recommended for use.<a class="pilcrow" href="#section-6.4.1-1.6.1">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-6.4.1-1.7">Target:</dt>
            <dd id="section-6.4.1-1.8" style="margin-left: 1.5em">
              <p id="section-6.4.1-1.8.1">The valid message targets for the derived parameter. <span class="bcp14">MUST</span> be one of the values "Request", "Response", or "Request, Response". The semantics of these entries are defined in <a class="auto internal xref" href="#derived-components">Section 2.2</a>.<a class="pilcrow" href="#section-6.4.1-1.8.1">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-6.4.1-1.9">Reference:</dt>
            <dd id="section-6.4.1-1.10" style="margin-left: 1.5em">
              <p id="section-6.4.1-1.10.1">Reference to the document or documents that specify the
  derived component, preferably including a URI that can be used
  to retrieve a copy of the document(s). An indication of the
  relevant sections may also be included but is not required.<a class="pilcrow" href="#section-6.4.1-1.10.1">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="iana-content-contents">
<section id="section-6.4.2">
          <h4 id="name-initial-contents-3">
<a class="section-number selfRef" href="#section-6.4.2">6.4.2. </a><a class="section-name selfRef" href="#name-initial-contents-3">Initial Contents</a>
          </h4>
<p id="section-6.4.2-1">The table below contains the initial contents of the "HTTP Signature Derived Component Names" registry.<a class="pilcrow" href="#section-6.4.2-1">¶</a></p>
<span id="name-initial-contents-of-the-http-"></span><table class="center" id="table-4">
            <caption>
<a class="selfRef" href="#table-4">Table 4</a>:
<a class="selfRef" href="#name-initial-contents-of-the-http-">Initial Contents of the HTTP Signature Derived Component Names Registry</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" colspan="1" rowspan="1">Name</th>
                <th class="text-left" colspan="1" rowspan="1">Description</th>
                <th class="text-left" colspan="1" rowspan="1">Status</th>
                <th class="text-left" colspan="1" rowspan="1">Target</th>
                <th class="text-left" colspan="1" rowspan="1">Reference</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">
                  <code>@signature-params</code>
</td>
                <td class="text-left" colspan="1" rowspan="1">Reserved for signature parameters line in signature base</td>
                <td class="text-left" colspan="1" rowspan="1">Active</td>
                <td class="text-left" colspan="1" rowspan="1">Request, Response</td>
                <td class="text-left" colspan="1" rowspan="1">
                  <a class="auto internal xref" href="#signature-params">Section 2.3</a> of RFC 9421</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">
                  <code>@method</code>
</td>
                <td class="text-left" colspan="1" rowspan="1">The HTTP request method</td>
                <td class="text-left" colspan="1" rowspan="1">Active</td>
                <td class="text-left" colspan="1" rowspan="1">Request</td>
                <td class="text-left" colspan="1" rowspan="1">
                  <a class="auto internal xref" href="#content-request-method">Section 2.2.1</a> of RFC 9421</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">
                  <code>@authority</code>
</td>
                <td class="text-left" colspan="1" rowspan="1">The HTTP authority, or target host</td>
                <td class="text-left" colspan="1" rowspan="1">Active</td>
                <td class="text-left" colspan="1" rowspan="1">Request</td>
                <td class="text-left" colspan="1" rowspan="1">
                  <a class="auto internal xref" href="#content-request-authority">Section 2.2.3</a> of RFC 9421</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">
                  <code>@scheme</code>
</td>
                <td class="text-left" colspan="1" rowspan="1">The URI scheme of the request URI</td>
                <td class="text-left" colspan="1" rowspan="1">Active</td>
                <td class="text-left" colspan="1" rowspan="1">Request</td>
                <td class="text-left" colspan="1" rowspan="1">
                  <a class="auto internal xref" href="#content-request-scheme">Section 2.2.4</a> of RFC 9421</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">
                  <code>@target-uri</code>
</td>
                <td class="text-left" colspan="1" rowspan="1">The full target URI of the request</td>
                <td class="text-left" colspan="1" rowspan="1">Active</td>
                <td class="text-left" colspan="1" rowspan="1">Request</td>
                <td class="text-left" colspan="1" rowspan="1">
                  <a class="auto internal xref" href="#content-target-uri">Section 2.2.2</a> of RFC 9421</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">
                  <code>@request-target</code>
</td>
                <td class="text-left" colspan="1" rowspan="1">The request target of the request</td>
                <td class="text-left" colspan="1" rowspan="1">Active</td>
                <td class="text-left" colspan="1" rowspan="1">Request</td>
                <td class="text-left" colspan="1" rowspan="1">
                  <a class="auto internal xref" href="#content-request-target">Section 2.2.5</a> of RFC 9421</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">
                  <code>@path</code>
</td>
                <td class="text-left" colspan="1" rowspan="1">The full path of the request URI</td>
                <td class="text-left" colspan="1" rowspan="1">Active</td>
                <td class="text-left" colspan="1" rowspan="1">Request</td>
                <td class="text-left" colspan="1" rowspan="1">
                  <a class="auto internal xref" href="#content-request-path">Section 2.2.6</a> of RFC 9421</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">
                  <code>@query</code>
</td>
                <td class="text-left" colspan="1" rowspan="1">The full query of the request URI</td>
                <td class="text-left" colspan="1" rowspan="1">Active</td>
                <td class="text-left" colspan="1" rowspan="1">Request</td>
                <td class="text-left" colspan="1" rowspan="1">
                  <a class="auto internal xref" href="#content-request-query">Section 2.2.7</a> of RFC 9421</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">
                  <code>@query-param</code>
</td>
                <td class="text-left" colspan="1" rowspan="1">A single named query parameter</td>
                <td class="text-left" colspan="1" rowspan="1">Active</td>
                <td class="text-left" colspan="1" rowspan="1">Request</td>
                <td class="text-left" colspan="1" rowspan="1">
                  <a class="auto internal xref" href="#content-request-query-param">Section 2.2.8</a> of RFC 9421</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">
                  <code>@status</code>
</td>
                <td class="text-left" colspan="1" rowspan="1">The status code of the response</td>
                <td class="text-left" colspan="1" rowspan="1">Active</td>
                <td class="text-left" colspan="1" rowspan="1">Response</td>
                <td class="text-left" colspan="1" rowspan="1">
                  <a class="auto internal xref" href="#content-status-code">Section 2.2.9</a> of RFC 9421</td>
              </tr>
            </tbody>
          </table>
</section>
</div>
</section>
</div>
<div id="component-param-registry">
<section id="section-6.5">
        <h3 id="name-http-signature-component-pa">
<a class="section-number selfRef" href="#section-6.5">6.5. </a><a class="section-name selfRef" href="#name-http-signature-component-pa">HTTP Signature Component Parameters Registry</a>
        </h3>
<p id="section-6.5-1">This document defines several kinds of component identifiers, some of which can be parameterized in specific circumstances to provide unique modified behavior. IANA has created and now maintains a new registry titled "HTTP Signature Component Parameters" to record and maintain the set of parameter names, the component identifiers they are associated with, and the modifications these parameters make to the component value. Definitions of parameters <span class="bcp14">MUST</span> define the targets to which they apply (such as specific field types, derived components, or contexts). Initial values for this registry are given in <a class="auto internal xref" href="#iana-component-param-contents">Section 6.5.2</a>. Future assignments and modifications to existing assignments are to be made through the Expert Review registration policy <span>[<a class="cite xref" href="#RFC8126">RFC8126</a>]</span>.<a class="pilcrow" href="#section-6.5-1">¶</a></p>
<p id="section-6.5-2">The DE is expected to do the following:<a class="pilcrow" href="#section-6.5-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.5-3.1">Ensure that the name follows the template presented in <a class="auto internal xref" href="#iana-component-param-template">Section 6.5.1</a>; this includes ensuring that the length of the name is not excessive while still being unique and recognizable for its defined function.<a class="pilcrow" href="#section-6.5-3.1">¶</a>
</li>
          <li class="normal" id="section-6.5-3.2">Ensure that the definition of the field sufficiently defines any interactions or incompatibilities with other existing parameters known at the time of the registration request.<a class="pilcrow" href="#section-6.5-3.2">¶</a>
</li>
          <li class="normal" id="section-6.5-3.3">Ensure that the component value defined by the component identifier with the parameter applied can be deterministically derived from the target HTTP message in cases where the parameter changes the component value.<a class="pilcrow" href="#section-6.5-3.3">¶</a>
</li>
        </ul>
<div id="iana-component-param-template">
<section id="section-6.5.1">
          <h4 id="name-registration-template-4">
<a class="section-number selfRef" href="#section-6.5.1">6.5.1. </a><a class="section-name selfRef" href="#name-registration-template-4">Registration Template</a>
          </h4>
<span class="break"></span><dl class="dlNewline" id="section-6.5.1-1">
            <dt id="section-6.5.1-1.1">Name:</dt>
            <dd id="section-6.5.1-1.2" style="margin-left: 1.5em">
              <p id="section-6.5.1-1.2.1">A name for the parameter. The name <span class="bcp14">MUST</span> be an ASCII string that conforms to the <code>key</code> ABNF rule defined in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8941#section-3.1.2">Section 3.1.2</a> of [<a class="cite xref" href="#RFC8941">STRUCTURED-FIELDS</a>]</span> and <span class="bcp14">SHOULD NOT</span> exceed 20 characters in length. The name <span class="bcp14">MUST</span> be unique within the context of the registry.<a class="pilcrow" href="#section-6.5.1-1.2.1">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-6.5.1-1.3">Description:</dt>
            <dd id="section-6.5.1-1.4" style="margin-left: 1.5em">
              <p id="section-6.5.1-1.4.1">A description of the parameter's function.<a class="pilcrow" href="#section-6.5.1-1.4.1">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-6.5.1-1.5">Reference:</dt>
            <dd id="section-6.5.1-1.6" style="margin-left: 1.5em">
              <p id="section-6.5.1-1.6.1">Reference to the document or documents that specify the
  derived component, preferably including a URI that can be used
  to retrieve a copy of the document(s). An indication of the
  relevant sections may also be included but is not required.<a class="pilcrow" href="#section-6.5.1-1.6.1">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="iana-component-param-contents">
<section id="section-6.5.2">
          <h4 id="name-initial-contents-4">
<a class="section-number selfRef" href="#section-6.5.2">6.5.2. </a><a class="section-name selfRef" href="#name-initial-contents-4">Initial Contents</a>
          </h4>
<p id="section-6.5.2-1">The table below contains the initial contents of the "HTTP Signature Component Parameters" registry.<a class="pilcrow" href="#section-6.5.2-1">¶</a></p>
<span id="name-initial-contents-of-the-http-s"></span><table class="center" id="table-5">
            <caption>
<a class="selfRef" href="#table-5">Table 5</a>:
<a class="selfRef" href="#name-initial-contents-of-the-http-s">Initial Contents of the HTTP Signature Component Parameters Registry</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" colspan="1" rowspan="1">Name</th>
                <th class="text-left" colspan="1" rowspan="1">Description</th>
                <th class="text-left" colspan="1" rowspan="1">Reference</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">
                  <code>sf</code>
</td>
                <td class="text-left" colspan="1" rowspan="1">Strict Structured Field serialization</td>
                <td class="text-left" colspan="1" rowspan="1">
                  <a class="auto internal xref" href="#http-field-structured">Section 2.1.1</a> of RFC 9421</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">
                  <code>key</code>
</td>
                <td class="text-left" colspan="1" rowspan="1">Single key value of Dictionary Structured Fields</td>
                <td class="text-left" colspan="1" rowspan="1">
                  <a class="auto internal xref" href="#http-field-dictionary">Section 2.1.2</a> of RFC 9421</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">
                  <code>bs</code>
</td>
                <td class="text-left" colspan="1" rowspan="1">Byte Sequence wrapping indicator</td>
                <td class="text-left" colspan="1" rowspan="1">
                  <a class="auto internal xref" href="#http-field-byte-sequence">Section 2.1.3</a> of RFC 9421</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">
                  <code>tr</code>
</td>
                <td class="text-left" colspan="1" rowspan="1">Trailer</td>
                <td class="text-left" colspan="1" rowspan="1">
                  <a class="auto internal xref" href="#http-trailer">Section 2.1.4</a> of RFC 9421</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">
                  <code>req</code>
</td>
                <td class="text-left" colspan="1" rowspan="1">Related request indicator</td>
                <td class="text-left" colspan="1" rowspan="1">
                  <a class="auto internal xref" href="#content-request-response">Section 2.4</a> of RFC 9421</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">
                  <code>name</code>
</td>
                <td class="text-left" colspan="1" rowspan="1">Single named query parameter</td>
                <td class="text-left" colspan="1" rowspan="1">
                  <a class="auto internal xref" href="#content-request-query-param">Section 2.2.8</a> of RFC 9421</td>
              </tr>
            </tbody>
          </table>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="security">
<section id="section-7">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<p id="section-7-1">In order for an HTTP message to be considered <em>covered</em> by a signature, all of the following conditions have to be true:<a class="pilcrow" href="#section-7-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-2.1">A signature is expected or allowed on the message by the verifier.<a class="pilcrow" href="#section-7-2.1">¶</a>
</li>
        <li class="normal" id="section-7-2.2">The signature exists on the message.<a class="pilcrow" href="#section-7-2.2">¶</a>
</li>
        <li class="normal" id="section-7-2.3">The signature is verified against the identified key material and algorithm.<a class="pilcrow" href="#section-7-2.3">¶</a>
</li>
        <li class="normal" id="section-7-2.4">The key material and algorithm are appropriate for the context of the message.<a class="pilcrow" href="#section-7-2.4">¶</a>
</li>
        <li class="normal" id="section-7-2.5">The signature is within expected time boundaries.<a class="pilcrow" href="#section-7-2.5">¶</a>
</li>
        <li class="normal" id="section-7-2.6">The signature covers the expected content, including any critical components.<a class="pilcrow" href="#section-7-2.6">¶</a>
</li>
        <li class="normal" id="section-7-2.7">The list of covered components is applicable to the context of the message.<a class="pilcrow" href="#section-7-2.7">¶</a>
</li>
      </ul>
<p id="section-7-3">In addition to the application requirement definitions listed in <a class="auto internal xref" href="#application">Section 1.4</a>, the following security considerations provide discussion and context regarding the requirements of creating and verifying signatures on HTTP messages.<a class="pilcrow" href="#section-7-3">¶</a></p>
<div id="general-considerations">
<section id="section-7.1">
        <h3 id="name-general-considerations">
<a class="section-number selfRef" href="#section-7.1">7.1. </a><a class="section-name selfRef" href="#name-general-considerations">General Considerations</a>
        </h3>
<div id="security-ignore">
<section id="section-7.1.1">
          <h4 id="name-skipping-signature-verifica">
<a class="section-number selfRef" href="#section-7.1.1">7.1.1. </a><a class="section-name selfRef" href="#name-skipping-signature-verifica">Skipping Signature Verification</a>
          </h4>
<p id="section-7.1.1-1">HTTP message signatures only provide security if the signature is verified by the verifier. Since the message to which the signature is attached remains a valid HTTP message without the Signature or Signature-Input fields, it is possible for a verifier to ignore the output of the verification function and still process the message. Common reasons for this could be relaxed requirements in a development environment or a temporary suspension of enforcing verification while debugging an overall system. Such temporary suspensions are difficult to detect under positive-example testing, since a good signature will always trigger a valid response whether or not it has been checked.<a class="pilcrow" href="#section-7.1.1-1">¶</a></p>
<p id="section-7.1.1-2">To detect this, verifiers should be tested using both valid and invalid signatures, ensuring that an invalid signature fails as expected.<a class="pilcrow" href="#section-7.1.1-2">¶</a></p>
</section>
</div>
<div id="security-tls">
<section id="section-7.1.2">
          <h4 id="name-use-of-tls">
<a class="section-number selfRef" href="#section-7.1.2">7.1.2. </a><a class="section-name selfRef" href="#name-use-of-tls">Use of TLS</a>
          </h4>
<p id="section-7.1.2-1">The use of HTTP message signatures does not negate the need for TLS or its equivalent to protect information in transit. Message signatures provide message integrity over the covered message components but do not provide any confidentiality for communication between parties.<a class="pilcrow" href="#section-7.1.2-1">¶</a></p>
<p id="section-7.1.2-2">TLS provides such confidentiality between the TLS endpoints. As part of this, TLS also protects the signature data itself from being captured by an attacker.  This is an important step in preventing <span><a class="internal xref" href="#security-replay">signature replay</a> (<a class="auto internal xref" href="#security-replay">Section 7.2.2</a>)</span>.<a class="pilcrow" href="#section-7.1.2-2">¶</a></p>
<p id="section-7.1.2-3">When TLS is used, it needs to be deployed according to the recommendations provided in <span>[<a class="cite xref" href="#BCP195">BCP195</a>]</span>.<a class="pilcrow" href="#section-7.1.2-3">¶</a></p>
</section>
</div>
</section>
</div>
<div id="message-processing-and-selection">
<section id="section-7.2">
        <h3 id="name-message-processing-and-sele">
<a class="section-number selfRef" href="#section-7.2">7.2. </a><a class="section-name selfRef" href="#name-message-processing-and-sele">Message Processing and Selection</a>
        </h3>
<div id="security-coverage">
<section id="section-7.2.1">
          <h4 id="name-insufficient-coverage">
<a class="section-number selfRef" href="#section-7.2.1">7.2.1. </a><a class="section-name selfRef" href="#name-insufficient-coverage">Insufficient Coverage</a>
          </h4>
<p id="section-7.2.1-1">Any portions of the message not covered by the signature are susceptible to modification by an attacker without affecting the signature. An attacker can take advantage of this by introducing or modifying a header field or other message component that will change the processing of the message but will not be covered by the signature. Such an altered message would still pass signature verification, but when the verifier processes the message as a whole, the unsigned content injected by the attacker would subvert the trust conveyed by the valid signature and change the outcome of processing the message.<a class="pilcrow" href="#section-7.2.1-1">¶</a></p>
<p id="section-7.2.1-2">To combat this, an application of this specification should require as much of the message as possible to be signed, within the limits of the application and deployment. The verifier should only trust message components that have been signed. Verifiers could also strip out any sensitive unsigned portions of the message before processing of the message continues.<a class="pilcrow" href="#section-7.2.1-2">¶</a></p>
</section>
</div>
<div id="security-replay">
<section id="section-7.2.2">
          <h4 id="name-signature-replay">
<a class="section-number selfRef" href="#section-7.2.2">7.2.2. </a><a class="section-name selfRef" href="#name-signature-replay">Signature Replay</a>
          </h4>
<p id="section-7.2.2-1">Since HTTP message signatures allow sub-portions of the HTTP message to be signed, it is possible for two different HTTP messages to validate against the same signature. The most extreme form of this would be a signature over no message components. If such a signature were intercepted, it could be replayed at will by an attacker, attached to any HTTP message. Even with sufficient component coverage, a given signature could be applied to two similar HTTP messages, allowing a message to be replayed by an attacker with the signature intact.<a class="pilcrow" href="#section-7.2.2-1">¶</a></p>
<p id="section-7.2.2-2">To counteract these kinds of attacks, it's first important for the signer to cover sufficient portions of the message to differentiate it from other messages. In addition, the signature can use the <code>nonce</code> signature parameter to provide a per-message unique value to allow the verifier to detect replay of the signature itself if a nonce value is repeated. Furthermore, the signer can provide a timestamp for when the signature was created and a time at which the signer considers the signature to be expired, limiting the utility of a captured signature value.<a class="pilcrow" href="#section-7.2.2-2">¶</a></p>
<p id="section-7.2.2-3">If a verifier wants to trigger a new signature from a signer, it can send the Accept-Signature header field with a new <code>nonce</code> parameter. An attacker that is simply replaying a signature would not be able to generate a new signature with the chosen nonce value.<a class="pilcrow" href="#section-7.2.2-3">¶</a></p>
</section>
</div>
<div id="security-components">
<section id="section-7.2.3">
          <h4 id="name-choosing-message-components">
<a class="section-number selfRef" href="#section-7.2.3">7.2.3. </a><a class="section-name selfRef" href="#name-choosing-message-components">Choosing Message Components</a>
          </h4>
<p id="section-7.2.3-1">Applications of HTTP message signatures need to decide which message components will be covered by the signature. Depending on the application, some components could be expected to be changed by intermediaries prior to the signature's verification. If these components are covered, such changes would, by design, break the signature.<a class="pilcrow" href="#section-7.2.3-1">¶</a></p>
<p id="section-7.2.3-2">However, this document allows for flexibility in determining which components are signed precisely so that a given application can choose the appropriate portions of the message that need to be signed, avoiding problematic components. For example, a web application framework that relies on rewriting query parameters might avoid using the <code>@query</code> derived component in favor of sub-indexing the query value using <code>@query-param</code> derived components instead.<a class="pilcrow" href="#section-7.2.3-2">¶</a></p>
<p id="section-7.2.3-3">Some components are expected to be changed by intermediaries and ought not to be signed under most circumstances. The Via and Forwarded header fields, for example, are expected to be manipulated by proxies and other middleboxes, including replacing or entirely dropping existing values. These fields should not be covered by the signature, except in very limited and tightly coupled scenarios.<a class="pilcrow" href="#section-7.2.3-3">¶</a></p>
<p id="section-7.2.3-4">Additional considerations for choosing signature aspects are discussed in <a class="auto internal xref" href="#application">Section 1.4</a>.<a class="pilcrow" href="#section-7.2.3-4">¶</a></p>
</section>
</div>
<div id="security-not-fields">
<section id="section-7.2.4">
          <h4 id="name-choosing-signature-paramete">
<a class="section-number selfRef" href="#section-7.2.4">7.2.4. </a><a class="section-name selfRef" href="#name-choosing-signature-paramete">Choosing Signature Parameters and Derived Components over HTTP Fields</a>
          </h4>
<p id="section-7.2.4-1">Some HTTP fields have values and interpretations that are similar to HTTP signature parameters or derived components. In most cases, it is more desirable to sign the non-field alternative. In particular, the following fields should usually not be included in the signature unless the application specifically requires it:<a class="pilcrow" href="#section-7.2.4-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-7.2.4-2">
            <dt id="section-7.2.4-2.1">"date"</dt>
            <dd id="section-7.2.4-2.2" style="margin-left: 1.5em">
              <p id="section-7.2.4-2.2.1">The Date header field value represents the timestamp of the HTTP message. However, the creation time of the signature itself is encoded in the <code>created</code> signature parameter. These two values can be different, depending on how the signature and the HTTP message are created and serialized. Applications processing signatures for valid time windows should use the <code>created</code> signature parameter for such calculations. An application could also put limits on how much skew there is between the Date field and the <code>created</code> signature parameter, in order to limit the application of a generated signature to different HTTP messages. See also Sections <a class="auto internal xref" href="#security-replay">7.2.2</a> and <a class="auto internal xref" href="#security-coverage">7.2.1</a>.<a class="pilcrow" href="#section-7.2.4-2.2.1">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-7.2.4-2.3">"host"</dt>
            <dd id="section-7.2.4-2.4" style="margin-left: 1.5em">
              <p id="section-7.2.4-2.4.1">The Host header field is specific to HTTP/1.1, and its functionality is subsumed by the <code>@authority</code> derived component, defined in <a class="auto internal xref" href="#content-request-authority">Section 2.2.3</a>. In order to preserve the value across different HTTP versions, applications should always use the <code>@authority</code> derived component. See also <a class="auto internal xref" href="#security-versions">Section 7.5.4</a>.<a class="pilcrow" href="#section-7.2.4-2.4.1">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="security-labels">
<section id="section-7.2.5">
          <h4 id="name-signature-labels">
<a class="section-number selfRef" href="#section-7.2.5">7.2.5. </a><a class="section-name selfRef" href="#name-signature-labels">Signature Labels</a>
          </h4>
<p id="section-7.2.5-1">HTTP message signature values are identified in the Signature and Signature-Input field values by unique labels. These labels are chosen only when attaching the signature values to the message and are not accounted for during the signing process. An intermediary is allowed to relabel an existing signature when processing the message.<a class="pilcrow" href="#section-7.2.5-1">¶</a></p>
<p id="section-7.2.5-2">Therefore, applications should not rely on specific labels being present, and applications should not put semantic meaning on the labels themselves. Instead, additional signature parameters can be used to convey whatever additional meaning is required to be attached to, and covered by, the signature. In particular, the <code>tag</code> parameter can be used to define an application-specific value as described in <a class="auto internal xref" href="#security-signature-tag">Section 7.2.7</a>.<a class="pilcrow" href="#section-7.2.5-2">¶</a></p>
</section>
</div>
<div id="security-multiple">
<section id="section-7.2.6">
          <h4 id="name-multiple-signature-confusio">
<a class="section-number selfRef" href="#section-7.2.6">7.2.6. </a><a class="section-name selfRef" href="#name-multiple-signature-confusio">Multiple Signature Confusion</a>
          </h4>
<p id="section-7.2.6-1">Since <span><a class="internal xref" href="#signature-multiple">multiple signatures can be applied to one message</a> (<a class="auto internal xref" href="#signature-multiple">Section 4.3</a>)</span>, it is possible for an attacker to attach their own signature to a captured message without modifying existing signatures. This new signature could be completely valid based on the attacker's key, or it could be an invalid signature for any number of reasons. Each of these situations needs to be accounted for.<a class="pilcrow" href="#section-7.2.6-1">¶</a></p>
<p id="section-7.2.6-2">A verifier processing a set of valid signatures needs to account for all of the signers, identified by the signing keys. Only signatures from expected signers should be accepted, regardless of the cryptographic validity of the signature itself.<a class="pilcrow" href="#section-7.2.6-2">¶</a></p>
<p id="section-7.2.6-3">A verifier processing a set of signatures on a message also needs to determine what to do when one or more of the signatures are not valid. If a message is accepted when at least one signature is valid, then a verifier could drop all invalid signatures from the request before processing the message further. Alternatively, if the verifier rejects a message for a single invalid signature, an attacker could use this to deny service to otherwise valid messages by injecting invalid signatures alongside the valid signatures.<a class="pilcrow" href="#section-7.2.6-3">¶</a></p>
</section>
</div>
<div id="security-signature-tag">
<section id="section-7.2.7">
          <h4 id="name-collision-of-application-sp">
<a class="section-number selfRef" href="#section-7.2.7">7.2.7. </a><a class="section-name selfRef" href="#name-collision-of-application-sp">Collision of Application-Specific Signature Tag</a>
          </h4>
<p id="section-7.2.7-1">Multiple applications and protocols could apply HTTP signatures on the same message simultaneously. In fact, this is a desired feature in many circumstances; see <a class="auto internal xref" href="#signature-multiple">Section 4.3</a>. A naive verifier could become confused while processing multiple signatures, either accepting or rejecting a message based on an unrelated or irrelevant signature. In order to help an application select which signatures apply to its own processing, the application can declare a specific value for the <code>tag</code> signature parameter as defined in <a class="auto internal xref" href="#signature-params">Section 2.3</a>. For example, a signature targeting an application gateway could require <code>tag="app-gateway"</code> as part of the signature parameters for that application.<a class="pilcrow" href="#section-7.2.7-1">¶</a></p>
<p id="section-7.2.7-2">The use of the <code>tag</code> parameter does not prevent an attacker from also using the same value as a target application, since the parameter's value is public and otherwise unrestricted. As a consequence, a verifier should only use a value of the <code>tag</code> parameter to limit which signatures to check. Each signature still needs to be examined by the verifier to ensure that sufficient coverage is provided, as discussed in <a class="auto internal xref" href="#security-coverage">Section 7.2.1</a>.<a class="pilcrow" href="#section-7.2.7-2">¶</a></p>
</section>
</div>
<div id="security-message-content">
<section id="section-7.2.8">
          <h4 id="name-message-content">
<a class="section-number selfRef" href="#section-7.2.8">7.2.8. </a><a class="section-name selfRef" href="#name-message-content">Message Content</a>
          </h4>
<p id="section-7.2.8-1">On its own, this specification does not provide coverage for the content of an HTTP message under the signature, in either a request or a response. However, <span>[<a class="cite xref" href="#RFC9530">DIGEST</a>]</span> defines a set of fields that allow a cryptographic digest of the content to be represented in a field. Once this field is created, it can be included just like any other field as defined in <a class="auto internal xref" href="#http-fields">Section 2.1</a>.<a class="pilcrow" href="#section-7.2.8-1">¶</a></p>
<p id="section-7.2.8-2">For example, in the following response message:<a class="pilcrow" href="#section-7.2.8-2">¶</a></p>
<div class="lang-http-message sourcecode" id="section-7.2.8-3">
<pre>HTTP/1.1 200 OK
Content-Type: application/json

{"hello": "world"}
</pre><a class="pilcrow" href="#section-7.2.8-3">¶</a>
</div>
<p id="section-7.2.8-4">The digest of the content can be added to the Content-Digest field as follows:<a class="pilcrow" href="#section-7.2.8-4">¶</a></p>
<div class="lang-http-message sourcecode" id="section-7.2.8-5">
<pre>NOTE: '\' line wrapping per RFC 8792

HTTP/1.1 200 OK
Content-Type: application/json
Content-Digest: \
  sha-256=:X48E9qOokqqrvdts8nOJRJN3OWDUoyWxBf7kbu9DBPE=:

{"hello": "world"}
</pre><a class="pilcrow" href="#section-7.2.8-5">¶</a>
</div>
<p id="section-7.2.8-6">This field can be included in a signature base just like any other field along with the basic signature parameters:<a class="pilcrow" href="#section-7.2.8-6">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.2.8-7">
<pre>"@status": 200
"content-digest": \
  sha-256=:X48E9qOokqqrvdts8nOJRJN3OWDUoyWxBf7kbu9DBPE=:
"@signature-input": ("@status" "content-digest")
</pre><a class="pilcrow" href="#section-7.2.8-7">¶</a>
</div>
<p id="section-7.2.8-8">From here, the signing process proceeds as usual.<a class="pilcrow" href="#section-7.2.8-8">¶</a></p>
<p id="section-7.2.8-9">Upon verification, it is important that the verifier validate not only the signature but also the value of the Content-Digest field itself against the actual received content. Unless the verifier performs this step, it would be possible for an attacker to substitute the message content but leave the Content-Digest field value untouched to pass the signature. Since only the field value is covered by the signature directly, checking only the signature is not sufficient protection against such a substitution attack.<a class="pilcrow" href="#section-7.2.8-9">¶</a></p>
<p id="section-7.2.8-10">As discussed in <span>[<a class="cite xref" href="#RFC9530">DIGEST</a>]</span>, the value of the Content-Digest field is dependent on the content encoding of the message. If an intermediary changes the content encoding, the resulting Content-Digest value would change. This would in turn invalidate the signature. Any intermediary performing such an action would need to apply a new signature with the updated Content-Digest field value, similar to the reverse proxy use case discussed in <a class="auto internal xref" href="#signature-multiple">Section 4.3</a>.<a class="pilcrow" href="#section-7.2.8-10">¶</a></p>
<p id="section-7.2.8-11">Applications that make use of the <span><a class="internal xref" href="#content-request-response"><code>req</code> parameter</a> (<a class="auto internal xref" href="#content-request-response">Section 2.4</a>)</span> also need to be aware of the limitations of this functionality. Specifically, if a client does not include something like a Content-Digest header field in the request, the server is unable to include a signature that covers the request's content.<a class="pilcrow" href="#section-7.2.8-11">¶</a></p>
</section>
</div>
</section>
</div>
<div id="cryptographic-considerations">
<section id="section-7.3">
        <h3 id="name-cryptographic-consideration">
<a class="section-number selfRef" href="#section-7.3">7.3. </a><a class="section-name selfRef" href="#name-cryptographic-consideration">Cryptographic Considerations</a>
        </h3>
<div id="security-collision">
<section id="section-7.3.1">
          <h4 id="name-cryptography-and-signature-">
<a class="section-number selfRef" href="#section-7.3.1">7.3.1. </a><a class="section-name selfRef" href="#name-cryptography-and-signature-">Cryptography and Signature Collision</a>
          </h4>
<p id="section-7.3.1-1">This document does not define any of its own cryptographic primitives and instead relies on other specifications to define such elements. If the signature algorithm or key used to process the signature base is vulnerable to any attacks, the resulting signature will also be susceptible to these same attacks.<a class="pilcrow" href="#section-7.3.1-1">¶</a></p>
<p id="section-7.3.1-2">A common attack against signature systems is to force a signature collision, where the same signature value successfully verifies against multiple different inputs. Since this specification relies on reconstruction of the signature base from an HTTP message and the list of components signed is fixed in the signature, it is difficult but not impossible for an attacker to effect such a collision. An attacker would need to manipulate the HTTP message and its covered message components in order to make the collision effective.<a class="pilcrow" href="#section-7.3.1-2">¶</a></p>
<p id="section-7.3.1-3">To counter this, only vetted keys and signature algorithms should be used to sign HTTP messages. The "HTTP Signature Algorithms" registry is one source of trusted signature algorithms for applications to apply to their messages.<a class="pilcrow" href="#section-7.3.1-3">¶</a></p>
<p id="section-7.3.1-4">While it is possible for an attacker to substitute the signature parameters value or the signature value separately, the <span><a class="internal xref" href="#create-sig-input">signature base generation algorithm</a> (<a class="auto internal xref" href="#create-sig-input">Section 2.5</a>)</span> always covers the signature parameters as the final value in the signature base using a deterministic serialization method. This step strongly binds the signature base with the signature value in a way that makes it much more difficult for an attacker to perform a partial substitution on the signature base.<a class="pilcrow" href="#section-7.3.1-4">¶</a></p>
</section>
</div>
<div id="security-keys">
<section id="section-7.3.2">
          <h4 id="name-key-theft">
<a class="section-number selfRef" href="#section-7.3.2">7.3.2. </a><a class="section-name selfRef" href="#name-key-theft">Key Theft</a>
          </h4>
<p id="section-7.3.2-1">A foundational assumption of signature-based cryptographic systems is that the signing key is not compromised by an attacker. If the keys used to sign the message are exfiltrated or stolen, the attacker will be able to generate their own signatures using those keys. As a consequence, signers have to protect any signing key material from exfiltration, capture, and use by an attacker.<a class="pilcrow" href="#section-7.3.2-1">¶</a></p>
<p id="section-7.3.2-2">To combat this, signers can rotate keys over time to limit the amount of time that stolen keys are useful. Signers can also use key escrow and storage systems to limit the attack surface against keys. Furthermore, the use of asymmetric signing algorithms exposes key material less than the use of <span><a class="internal xref" href="#security-symmetric">symmetric signing algorithms</a> (<a class="auto internal xref" href="#security-symmetric">Section 7.3.3</a>)</span>.<a class="pilcrow" href="#section-7.3.2-2">¶</a></p>
</section>
</div>
<div id="security-symmetric">
<section id="section-7.3.3">
          <h4 id="name-symmetric-cryptography">
<a class="section-number selfRef" href="#section-7.3.3">7.3.3. </a><a class="section-name selfRef" href="#name-symmetric-cryptography">Symmetric Cryptography</a>
          </h4>
<p id="section-7.3.3-1">This document allows both asymmetric and symmetric cryptography to be applied to HTTP messages. By their nature, symmetric cryptographic methods require the same key material to be known by both the signer and verifier. This effectively means that a verifier is capable of generating a valid signature, since they have access to the same key material. An attacker that is able to compromise a verifier would be able to then impersonate a signer.<a class="pilcrow" href="#section-7.3.3-1">¶</a></p>
<p id="section-7.3.3-2">Where possible, asymmetric methods or secure key agreement mechanisms should be used in order to avoid this type of attack. When symmetric methods are used, distribution of the key material needs to be protected by the overall system. One technique for this is the use of separate cryptographic modules that separate the verification process (and therefore the key material) from other code, minimizing the vulnerable attack surface. Another technique is the use of key derivation functions that allow the signer and verifier to agree on unique keys for each message without having to share the key values directly.<a class="pilcrow" href="#section-7.3.3-2">¶</a></p>
<p id="section-7.3.3-3">Additionally, if symmetric algorithms are allowed within a system, special care must be taken to avoid <span><a class="internal xref" href="#security-keydowngrade">key downgrade attacks</a> (<a class="auto internal xref" href="#security-keydowngrade">Section 7.3.6</a>)</span>.<a class="pilcrow" href="#section-7.3.3-3">¶</a></p>
</section>
</div>
<div id="security-keymixup">
<section id="section-7.3.4">
          <h4 id="name-key-specification-mixup">
<a class="section-number selfRef" href="#section-7.3.4">7.3.4. </a><a class="section-name selfRef" href="#name-key-specification-mixup">Key Specification Mixup</a>
          </h4>
<p id="section-7.3.4-1">The existence of a valid signature on an HTTP message is not sufficient to prove that the message has been signed by the appropriate party. It is up to the verifier to ensure that a given key and algorithm are appropriate for the message in question. If the verifier does not perform such a step, an attacker could substitute their own signature using their own key on a message and force a verifier to accept and process it. To combat this, the verifier needs to ensure not only that the signature can be validated for a message but that the key and algorithm used are appropriate.<a class="pilcrow" href="#section-7.3.4-1">¶</a></p>
</section>
</div>
<div id="security-nondeterministic">
<section id="section-7.3.5">
          <h4 id="name-non-deterministic-signature">
<a class="section-number selfRef" href="#section-7.3.5">7.3.5. </a><a class="section-name selfRef" href="#name-non-deterministic-signature">Non-deterministic Signature Primitives</a>
          </h4>
<p id="section-7.3.5-1">Some cryptographic primitives, such as RSA-PSS and ECDSA, have non-deterministic outputs, which include some amount of entropy within the algorithm. For such algorithms, multiple signatures generated in succession will not match. A lazy implementation of a verifier could ignore this distinction and simply check for the same value being created by re-signing the signature base. Such an implementation would work for deterministic algorithms such as HMAC and EdDSA but fail to verify valid signatures made using non-deterministic algorithms. It is therefore important that a verifier always use the correctly defined verification function for the algorithm in question and not do a simple comparison.<a class="pilcrow" href="#section-7.3.5-1">¶</a></p>
</section>
</div>
<div id="security-keydowngrade">
<section id="section-7.3.6">
          <h4 id="name-key-and-algorithm-specifica">
<a class="section-number selfRef" href="#section-7.3.6">7.3.6. </a><a class="section-name selfRef" href="#name-key-and-algorithm-specifica">Key and Algorithm Specification Downgrades</a>
          </h4>
<p id="section-7.3.6-1">Applications of this specification need to protect against key specification downgrade attacks. For example, the same RSA key can be used for both RSA-PSS and RSA v1.5 signatures. If an application expects a key to only be used with RSA-PSS, it needs to reject signatures for any key that uses the weaker RSA 1.5 specification.<a class="pilcrow" href="#section-7.3.6-1">¶</a></p>
<p id="section-7.3.6-2">Another example of a downgrade attack would be when an asymmetric algorithm is expected, such as RSA-PSS, but an attacker substitutes a signature using a symmetric algorithm, such as HMAC. A naive verifier implementation could use the value of the public RSA key as the input to the HMAC verification function. Since the public key is known to the attacker, this would allow the attacker to create a valid HMAC signature against this known key. To prevent this, the verifier needs to ensure that both the key material and the algorithm are appropriate for the usage in question. Additionally, while this specification does allow runtime specification of the algorithm using the <code>alg</code> signature parameter, applications are encouraged to use other mechanisms such as static configuration or a higher-protocol-level algorithm specification instead, preventing an attacker from substituting the algorithm specified.<a class="pilcrow" href="#section-7.3.6-2">¶</a></p>
</section>
</div>
<div id="security-sign-signature">
<section id="section-7.3.7">
          <h4 id="name-signing-signature-values">
<a class="section-number selfRef" href="#section-7.3.7">7.3.7. </a><a class="section-name selfRef" href="#name-signing-signature-values">Signing Signature Values</a>
          </h4>
<p id="section-7.3.7-1">When applying the <span><a class="internal xref" href="#content-request-response"><code>req</code>
parameter</a> (<a class="auto internal xref" href="#content-request-response">Section 2.4</a>)</span> or <span><a class="internal xref" href="#signature-multiple">multiple signatures</a> (<a class="auto internal xref" href="#signature-multiple">Section 4.3</a>)</span> to a message, it is possible to sign the value of an existing Signature field, thereby covering the bytes of the existing signature output in the new signature's value. While it would seem that this practice would transitively cover the components under the original signature in a verifiable fashion, the attacks described in <span>[<a class="cite xref" href="#JACKSON2019">JACKSON2019</a>]</span> can be used to impersonate a signature output value on an unrelated message.<a class="pilcrow" href="#section-7.3.7-1">¶</a></p>
<p id="section-7.3.7-2">In this example, Alice intends to send a signed request to Bob, and Bob wants to provide a signed response to Alice that includes a cryptographic proof that Bob is responding to Alice's incoming message. Mallory wants to intercept this traffic and replace Alice's message with her own, without Alice being aware that the interception has taken place.<a class="pilcrow" href="#section-7.3.7-2">¶</a></p>
<ol class="normal type-1" id="section-7.3.7-3" start="1" type="1">
<li id="section-7.3.7-3.1">Alice creates a message <code>Req_A</code> and applies a signature <code>Sig_A</code> using her private key <code>Key_A_Sign</code>.<a class="pilcrow" href="#section-7.3.7-3.1">¶</a>
</li>
            <li id="section-7.3.7-3.2">Alice believes she is sending <code>Req_A</code> to Bob.<a class="pilcrow" href="#section-7.3.7-3.2">¶</a>
</li>
            <li id="section-7.3.7-3.3">Mallory intercepts <code>Req_A</code> and reads the value <code>Sig_A</code> from this message.<a class="pilcrow" href="#section-7.3.7-3.3">¶</a>
</li>
            <li id="section-7.3.7-3.4">Mallory generates a different message <code>Req_M</code> to send to Bob instead.<a class="pilcrow" href="#section-7.3.7-3.4">¶</a>
</li>
            <li id="section-7.3.7-3.5">Mallory crafts a signing key <code>Key_M_Sign</code> such that she can create a valid signature <code>Sig_M</code> over her request <code>Req_M</code> using this key, but the byte value of <code>Sig_M</code> exactly equals that of <code>Sig_A</code>.<a class="pilcrow" href="#section-7.3.7-3.5">¶</a>
</li>
            <li id="section-7.3.7-3.6">Mallory sends <code>Req_M</code> with <code>Sig_M</code> to Bob.<a class="pilcrow" href="#section-7.3.7-3.6">¶</a>
</li>
            <li id="section-7.3.7-3.7">Bob validates <code>Sig_M</code> against Mallory's verification key <code>Key_M_Verify</code>. At no time does Bob think that he's responding to Alice.<a class="pilcrow" href="#section-7.3.7-3.7">¶</a>
</li>
            <li id="section-7.3.7-3.8">Bob responds with response message <code>Res_B</code> to <code>Req_M</code> and creates signature <code>Sig_B</code> over this message using his key <code>Key_B_Sign</code>. Bob includes the value of <code>Sig_M</code> under <code>Sig_B</code>'s covered components but does not include anything else from the request message.<a class="pilcrow" href="#section-7.3.7-3.8">¶</a>
</li>
            <li id="section-7.3.7-3.9">Mallory receives the response <code>Res_B</code> from Bob, including the signature <code>Sig_B</code> value. Mallory replays this response to Alice.<a class="pilcrow" href="#section-7.3.7-3.9">¶</a>
</li>
            <li id="section-7.3.7-3.10">Alice reads <code>Res_B</code> from Mallory and verifies <code>Sig_B</code> using Bob's verification key <code>Key_B_Verify</code>. Alice includes the bytes of her original signature <code>Sig_A</code> in the signature base, and the signature verifies.<a class="pilcrow" href="#section-7.3.7-3.10">¶</a>
</li>
            <li id="section-7.3.7-3.11">Alice is led to believe that Bob has responded to her message and believes she has cryptographic proof of this happening, but in fact Bob responded to Mallory's malicious request and Alice is none the wiser.<a class="pilcrow" href="#section-7.3.7-3.11">¶</a>
</li>
          </ol>
<p id="section-7.3.7-4">To mitigate this, Bob can sign more portions of the request message than just the Signature field, in order to more fully differentiate Alice's message from Mallory's. Applications using this feature, particularly for non-repudiation purposes, can stipulate that any components required in the original signature also be covered separately in the second signature. For signed messages, requiring coverage of the corresponding Signature-Input field of the first signature ensures that unique items such as nonces and timestamps are also covered sufficiently by the second signature.<a class="pilcrow" href="#section-7.3.7-4">¶</a></p>
</section>
</div>
</section>
</div>
<div id="matching-covered-components-to-message">
<section id="section-7.4">
        <h3 id="name-matching-signature-paramete">
<a class="section-number selfRef" href="#section-7.4">7.4. </a><a class="section-name selfRef" href="#name-matching-signature-paramete">Matching Signature Parameters to the Target Message</a>
        </h3>
<div id="security-modify">
<section id="section-7.4.1">
          <h4 id="name-modification-of-required-me">
<a class="section-number selfRef" href="#section-7.4.1">7.4.1. </a><a class="section-name selfRef" href="#name-modification-of-required-me">Modification of Required Message Parameters</a>
          </h4>
<p id="section-7.4.1-1">An attacker could effectively deny a service by modifying an otherwise benign signature parameter or signed message component. While rejecting a modified message is the desired behavior, consistently failing signatures could lead to (1) the verifier turning off signature checking in order to make systems work again (see <a class="auto internal xref" href="#security-ignore">Section 7.1.1</a>) or (2) the application minimizing the requirements related to the signed component.<a class="pilcrow" href="#section-7.4.1-1">¶</a></p>
<p id="section-7.4.1-2">If such failures are common within an application, the signer and verifier should compare their generated signature bases with each other to determine which part of the message is being modified. If an expected modification is found, the signer and verifier can agree on an alternative set of requirements that will pass. However, the signer and verifier should not remove the requirement to sign the modified component when it is suspected that an attacker is modifying the component.<a class="pilcrow" href="#section-7.4.1-2">¶</a></p>
</section>
</div>
<div id="security-mismatch">
<section id="section-7.4.2">
          <h4 id="name-matching-values-of-covered-">
<a class="section-number selfRef" href="#section-7.4.2">7.4.2. </a><a class="section-name selfRef" href="#name-matching-values-of-covered-">Matching Values of Covered Components to Values in the Target Message</a>
          </h4>
<p id="section-7.4.2-1">The verifier needs to make sure that the signed message components match those in the message itself. For example, the <code>@method</code> derived component requires that the value within the signature base be the same as the HTTP method used when presenting this message. This specification encourages this by requiring the verifier to derive the signature base from the message, but lazy caching or conveyance of a raw signature base to a processing subsystem could lead to downstream verifiers accepting a message that does not match the presented signature.<a class="pilcrow" href="#section-7.4.2-1">¶</a></p>
<p id="section-7.4.2-2">To counter this, the component that generates the signature base needs to be trusted by both the signer and verifier within a system.<a class="pilcrow" href="#section-7.4.2-2">¶</a></p>
</section>
</div>
<div id="security-message-component-context">
<section id="section-7.4.3">
          <h4 id="name-message-component-source-an">
<a class="section-number selfRef" href="#section-7.4.3">7.4.3. </a><a class="section-name selfRef" href="#name-message-component-source-an">Message Component Source and Context</a>
          </h4>
<p id="section-7.4.3-1">The signature context for deriving message component values includes the target HTTP message itself, any associated messages (such as the request that triggered a response), and additional information that the signer or verifier has access to. Both signers and verifiers need to carefully consider the source of all information when creating component values for the signature base and take care not to take information from untrusted sources. Otherwise, an attacker could leverage such a loosely defined message context to inject their own values into the signature base string, overriding or corrupting the intended values.<a class="pilcrow" href="#section-7.4.3-1">¶</a></p>
<p id="section-7.4.3-2">For example, in most situations, the target URI of the message is as defined in <span>[<a class="cite xref" href="#RFC9110">HTTP</a>], <a class="relref" href="https://rfc-editor.org/rfc/rfc9110#section-7.1">Section 7.1</a></span>. However, let's say that there is an application that requires signing of the <code>@authority</code> of the incoming request, but the application doing the processing is behind a reverse proxy. Such an application would expect a change in the <code>@authority</code> value, and it could be configured to know the external target URI as seen by the client on the other side of the proxy. This application would use this configured value as its target URI for the purposes of deriving message component values such as <code>@authority</code> instead of using the target URI of the incoming message.<a class="pilcrow" href="#section-7.4.3-2">¶</a></p>
<p id="section-7.4.3-3">This approach is not without problems, as a misconfigured system could accept signed requests intended for different components in the system. For this scenario, an intermediary could instead add its own signature to be verified by the application directly, as demonstrated in <a class="auto internal xref" href="#signature-multiple">Section 4.3</a>. This alternative approach requires a more active intermediary but relies less on the target application knowing external configuration values.<a class="pilcrow" href="#section-7.4.3-3">¶</a></p>
<p id="section-7.4.3-4">As another example, <a class="auto internal xref" href="#content-request-response">Section 2.4</a> defines a method for signing response messages and also including portions of the request message that triggered the response. In this case, the context for component value calculation is the combination of the response and request messages, not just the single message to which the signature is applied. For this feature, the <code>req</code> flag allows both signers to explicitly signal which part of the context is being sourced for a component identifier's value. Implementations need to ensure that only the intended message is being referred to for each component; otherwise, an attacker could attempt to subvert a signature by manipulating one side or the other.<a class="pilcrow" href="#section-7.4.3-4">¶</a></p>
</section>
</div>
<div id="security-context-multiple-signatures">
<section id="section-7.4.4">
          <h4 id="name-multiple-message-component-">
<a class="section-number selfRef" href="#section-7.4.4">7.4.4. </a><a class="section-name selfRef" href="#name-multiple-message-component-">Multiple Message Component Contexts</a>
          </h4>
<p id="section-7.4.4-1">It is possible that the context for deriving message component values could be distinct for each signature present within a single message. This is particularly the case when proxies mutate messages and include signatures over the mutated values, in addition to any existing signatures. For example, a reverse proxy can replace a public hostname in a request to a service with the hostname for the individual service host to which it is forwarding the request. If both the client and the reverse proxy add signatures covering <code>@authority</code>, the service host will see two signatures on the request, each signing different values for the <code>@authority</code> message component, reflecting the change to that component as the message made its way from the client to the service host.<a class="pilcrow" href="#section-7.4.4-1">¶</a></p>
<p id="section-7.4.4-2">In such a case, it's common for the internal service to verify only one of the signatures or to use externally configured information, as discussed in <a class="auto internal xref" href="#security-message-component-context">Section 7.4.3</a>. However, a verifier processing both signatures has to use a different message component context for each signature, since the component value for the <code>@authority</code> component will be different for each signature. Verifiers like this need to be aware of both the reverse proxy's context for incoming messages and the target service's context for the message coming from the reverse proxy. The verifier needs to take particular care to apply the correct context to the correct signature; otherwise, an attacker could use knowledge of this complex setup to confuse the inputs to the verifier.<a class="pilcrow" href="#section-7.4.4-2">¶</a></p>
<p id="section-7.4.4-3">Such verifiers also need to ensure that any differences in message component contexts between signatures are expected and permitted. For example, in the above scenario, the reverse proxy could include the original hostname in a Forwarded header field and could sign <code>@authority</code>, forwarded, and the client's entry in the Signature field. The verifier can use the hostname from the Forwarded header field to confirm that the hostname was transformed as expected.<a class="pilcrow" href="#section-7.4.4-3">¶</a></p>
</section>
</div>
</section>
</div>
<div id="http-processing">
<section id="section-7.5">
        <h3 id="name-http-processing">
<a class="section-number selfRef" href="#section-7.5">7.5. </a><a class="section-name selfRef" href="#name-http-processing">HTTP Processing</a>
        </h3>
<div id="security-lazy-header-parser">
<section id="section-7.5.1">
          <h4 id="name-processing-invalid-http-fie">
<a class="section-number selfRef" href="#section-7.5.1">7.5.1. </a><a class="section-name selfRef" href="#name-processing-invalid-http-fie">Processing Invalid HTTP Field Names as Derived Component Names</a>
          </h4>
<p id="section-7.5.1-1">The definition of HTTP field names does not allow for the use of the 
<code>@</code> character anywhere in the name. As such, since all derived component names start with the <code>@</code> character, these namespaces should be completely separate. However, some HTTP implementations are not sufficiently strict about the characters accepted in HTTP field names. In such implementations, a sender (or attacker) could inject a header field starting with an <code>@</code> character and have it passed through to the application code. These invalid header fields could be used to override a portion of the derived message content and substitute an arbitrary value, providing a potential place for an attacker to mount a <span><a class="internal xref" href="#security-collision">signature collision</a> (<a class="auto internal xref" href="#security-collision">Section 7.3.1</a>)</span> attack or other functional substitution attack (such as using the signature from a GET request on a crafted POST request).<a class="pilcrow" href="#section-7.5.1-1">¶</a></p>
<p id="section-7.5.1-2">To combat this, when selecting values for a message component, if the component name starts with the <code>@</code> character, it needs to be processed as a derived component and never processed as an HTTP field. Only if the component name does not start with the <code>@</code> character can it be taken from the fields of the message. The algorithm discussed in <a class="auto internal xref" href="#create-sig-input">Section 2.5</a> provides a safe order of operations.<a class="pilcrow" href="#section-7.5.1-2">¶</a></p>
</section>
</div>
<div id="security-field-values">
<section id="section-7.5.2">
          <h4 id="name-semantically-equivalent-fie">
<a class="section-number selfRef" href="#section-7.5.2">7.5.2. </a><a class="section-name selfRef" href="#name-semantically-equivalent-fie">Semantically Equivalent Field Values</a>
          </h4>
<p id="section-7.5.2-1">The <span><a class="internal xref" href="#create-sig-input">signature base generation algorithm</a> (<a class="auto internal xref" href="#create-sig-input">Section 2.5</a>)</span> uses the value of an HTTP field as its component value. In the common case, this amounts to taking the actual bytes of the field value as the component value for both the signer and verifier. However, some field values allow for transformation of the values in semantically equivalent ways that alter the bytes used in the value itself. For example, a field definition can declare some or all of its values to be case insensitive or to have special handling of internal whitespace characters. Other fields have expected transformations from intermediaries, such as the removal of comments in the Via header field. In such cases, a verifier could be tripped up by using the equivalent transformed field value, which would differ from the byte value used by the signer. The verifier would have a difficult time finding this class of errors, since the value of the field is still acceptable for the application but the actual bytes required by the signature base would not match.<a class="pilcrow" href="#section-7.5.2-1">¶</a></p>
<p id="section-7.5.2-2">When processing such fields, the signer and verifier have to agree on how to handle such transformations, if at all. One option is to not sign problematic fields, but care must be taken to ensure that there is still <span><a class="internal xref" href="#security-coverage">sufficient signature coverage</a> (<a class="auto internal xref" href="#security-coverage">Section 7.2.1</a>)</span> for the application. Another option is to define an application-specific canonicalization value for the field before it is added to the HTTP message, such as to always remove internal comments before signing or to always transform values to lowercase. Since these transformations are applied prior to the field being used as input to the signature base generation algorithm, the signature base will still simply contain the byte value of the field as it appears within the message. If the transformations were to be applied after the value is extracted from the message but before it is added to the signature base, different attack surfaces such as value substitution attacks could be launched against the application. All application-specific additional rules are outside the scope of this specification, and by their very nature these transformations would harm interoperability of the implementation outside of this specific application. It is recommended that applications avoid the use of such additional rules wherever possible.<a class="pilcrow" href="#section-7.5.2-2">¶</a></p>
</section>
</div>
<div id="security-structured">
<section id="section-7.5.3">
          <h4 id="name-parsing-structured-field-va">
<a class="section-number selfRef" href="#section-7.5.3">7.5.3. </a><a class="section-name selfRef" href="#name-parsing-structured-field-va">Parsing Structured Field Values</a>
          </h4>
<p id="section-7.5.3-1">Several parts of this specification rely on the parsing of Structured Field values <span>[<a class="cite xref" href="#RFC8941">STRUCTURED-FIELDS</a>]</span> -- in particular, <span><a class="internal xref" href="#http-field-structured">strict serialization of HTTP Structured Field values</a> (<a class="auto internal xref" href="#http-field-structured">Section 2.1.1</a>)</span>, <span><a class="internal xref" href="#http-field-dictionary">referencing members of a Dictionary Structured Field</a> (<a class="auto internal xref" href="#http-field-dictionary">Section 2.1.2</a>)</span>, and processing the <code>@signature-input</code> value when <span><a class="internal xref" href="#verify">verifying a signature</a> (<a class="auto internal xref" href="#verify">Section 3.2</a>)</span>. While Structured Field values are designed to be relatively simple to parse, a naive or broken implementation of such a parser could lead to subtle attack surfaces being exposed in the implementation.<a class="pilcrow" href="#section-7.5.3-1">¶</a></p>
<p id="section-7.5.3-2">For example, if a buggy parser of the <code>@signature-input</code> value does not enforce proper closing of quotes around string values within the list of component identifiers, an attacker could take advantage of this and inject additional content into the signature base through manipulating the Signature-Input field value on a message.<a class="pilcrow" href="#section-7.5.3-2">¶</a></p>
<p id="section-7.5.3-3">To counteract this, implementations should use fully compliant and trusted parsers for all Structured Field processing, on both the signer side and the verifier side.<a class="pilcrow" href="#section-7.5.3-3">¶</a></p>
</section>
</div>
<div id="security-versions">
<section id="section-7.5.4">
          <h4 id="name-http-versions-and-component">
<a class="section-number selfRef" href="#section-7.5.4">7.5.4. </a><a class="section-name selfRef" href="#name-http-versions-and-component">HTTP Versions and Component Ambiguity</a>
          </h4>
<p id="section-7.5.4-1">Some message components are expressed in different ways across HTTP versions. For example, the authority of the request target is sent using the Host header field in HTTP/1.1 but with the <code>:authority</code> pseudo-header in HTTP/2. If a signer sends an HTTP/1.1 message and signs the Host header field but the message is translated to HTTP/2 before it reaches the verifier, the signature will not validate, as the Host header field could be dropped.<a class="pilcrow" href="#section-7.5.4-1">¶</a></p>
<p id="section-7.5.4-2">It is for this reason that HTTP message signatures define a set of derived components that define a single way to get the value in question, such as the <code>@authority</code> derived component (<a class="auto internal xref" href="#content-request-authority">Section 2.2.3</a>) in lieu of the Host header field. Applications should therefore prefer derived components for such options where possible.<a class="pilcrow" href="#section-7.5.4-2">¶</a></p>
</section>
</div>
<div id="security-canonicalization">
<section id="section-7.5.5">
          <h4 id="name-canonicalization-attacks">
<a class="section-number selfRef" href="#section-7.5.5">7.5.5. </a><a class="section-name selfRef" href="#name-canonicalization-attacks">Canonicalization Attacks</a>
          </h4>
<p id="section-7.5.5-1">Any ambiguity in the generation of the signature base could provide an attacker with leverage to substitute or break a signature on a message. Some message component values, particularly HTTP field values, are potentially susceptible to broken implementations that could lead to unexpected and insecure behavior. Naive implementations of this specification might implement HTTP field processing by taking the single value of a field and using it as the direct component value without processing it appropriately.<a class="pilcrow" href="#section-7.5.5-1">¶</a></p>
<p id="section-7.5.5-2">For example, if the handling of <code>obs-fold</code> field values does not remove the internal line folding and whitespace, additional newlines could be introduced into the signature base by the signer, providing a potential place for an attacker to mount a <span><a class="internal xref" href="#security-collision">signature collision</a> (<a class="auto internal xref" href="#security-collision">Section 7.3.1</a>)</span> attack. Alternatively, if header fields that appear multiple times are not joined into a single string value, as required by this specification, similar attacks can be mounted, as a signed component value would show up in the signature base more than once and could be substituted or otherwise attacked in this way.<a class="pilcrow" href="#section-7.5.5-2">¶</a></p>
<p id="section-7.5.5-3">To counter this, the entire field value processing algorithm needs to be implemented by all implementations of signers and verifiers.<a class="pilcrow" href="#section-7.5.5-3">¶</a></p>
</section>
</div>
<div id="security-non-list">
<section id="section-7.5.6">
          <h4 id="name-non-list-field-values">
<a class="section-number selfRef" href="#section-7.5.6">7.5.6. </a><a class="section-name selfRef" href="#name-non-list-field-values">Non-List Field Values</a>
          </h4>
<p id="section-7.5.6-1">When an HTTP field occurs multiple times in a single message, these values need to be combined into a single one-line string value to be included in the HTTP signature base, as described in <a class="auto internal xref" href="#create-sig-input">Section 2.5</a>. Not all HTTP fields can be combined into a single value in this way and still be a valid value for the field. For the purposes of generating the signature base, the message component value is never meant to be read back out of the signature base string or used in the application. Therefore, it is considered best practice to treat the signature base generation algorithm separately from processing the field values by the application, particularly for fields that are known to have this property. If the field values that are being signed do not validate, the signed message should also be rejected.<a class="pilcrow" href="#section-7.5.6-1">¶</a></p>
<p id="section-7.5.6-2">If an HTTP field allows for unquoted commas within its values, combining multiple field values can lead to a situation where two semantically different messages produce the same line in a signature base. For example, take the following hypothetical header field with an internal comma in its syntax, here used to define two separate lists of values:<a class="pilcrow" href="#section-7.5.6-2">¶</a></p>
<div class="lang-http-message sourcecode" id="section-7.5.6-3">
<pre>Example-Header: value, with, lots
Example-Header: of, commas
</pre><a class="pilcrow" href="#section-7.5.6-3">¶</a>
</div>
<p id="section-7.5.6-4">For this header field, sending all of these values as a single field value results in a single list of values:<a class="pilcrow" href="#section-7.5.6-4">¶</a></p>
<div class="lang-http-message sourcecode" id="section-7.5.6-5">
<pre>Example-Header: value, with, lots, of, commas
</pre><a class="pilcrow" href="#section-7.5.6-5">¶</a>
</div>
<p id="section-7.5.6-6">Both of these messages would create the following line in the signature base:<a class="pilcrow" href="#section-7.5.6-6">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.5.6-7">
<pre>"example-header": value, with, lots, of, commas
</pre><a class="pilcrow" href="#section-7.5.6-7">¶</a>
</div>
<p id="section-7.5.6-8">Since two semantically distinct inputs can create the same output in the signature base, special care has to be taken when handling such values.<a class="pilcrow" href="#section-7.5.6-8">¶</a></p>
<p id="section-7.5.6-9">Specifically, the Set-Cookie field <span>[<a class="cite xref" href="#RFC6265">COOKIE</a>]</span> defines an internal syntax that does not conform to the List syntax provided in <span>[<a class="cite xref" href="#RFC8941">STRUCTURED-FIELDS</a>]</span>. In particular, some portions allow unquoted commas, and the field is typically sent as multiple separate field lines with distinct values when sending multiple cookies. When multiple Set-Cookie fields are sent in the same message, it is not generally possible to combine these into a single line and be able to parse and use the results, as discussed in <span>[<a class="cite xref" href="#RFC9110">HTTP</a>], <a class="relref" href="https://rfc-editor.org/rfc/rfc9110#section-5.3">Section 5.3</a></span>. Therefore, all the cookies need to be processed from their separate field values, without being combined, while the signature base needs to be processed from the special combined value generated solely for this purpose. If the cookie value is invalid, the signed message ought to be rejected, as this is a possible padding attack as described in <a class="auto internal xref" href="#security-multiple-fields">Section 7.5.7</a>.<a class="pilcrow" href="#section-7.5.6-9">¶</a></p>
<p id="section-7.5.6-10">To deal with this, an application can choose to limit signing of problematic fields like Set-Cookie, such as including the field in a signature only when a single field value is present and the results would be unambiguous. Similar caution needs to be taken with all fields that could have non-deterministic mappings into the signature base. Signers can also make use of the <code>bs</code> parameter to armor such fields, as described in <a class="auto internal xref" href="#http-field-byte-sequence">Section 2.1.3</a>.<a class="pilcrow" href="#section-7.5.6-10">¶</a></p>
</section>
</div>
<div id="security-multiple-fields">
<section id="section-7.5.7">
          <h4 id="name-padding-attacks-with-multip">
<a class="section-number selfRef" href="#section-7.5.7">7.5.7. </a><a class="section-name selfRef" href="#name-padding-attacks-with-multip">Padding Attacks with Multiple Field Values</a>
          </h4>
<p id="section-7.5.7-1">Since HTTP field values need to be combined into a single string value to be included in the HTTP signature base (see <a class="auto internal xref" href="#create-sig-input">Section 2.5</a>), it is possible for an attacker to inject an additional value for a given field and add this to the signature base of the verifier.<a class="pilcrow" href="#section-7.5.7-1">¶</a></p>
<p id="section-7.5.7-2">In most circumstances, this causes the signature validation to fail as expected, since the new signature base value will not match the one used by the signer to create the signature. However, it is theoretically possible for the attacker to inject both a garbage value into a field and a desired value into another field in order to force a particular input. This is a variation of the collision attack described in <a class="auto internal xref" href="#security-collision">Section 7.3.1</a>, where the attacker accomplishes their change in the message by adding to existing field values.<a class="pilcrow" href="#section-7.5.7-2">¶</a></p>
<p id="section-7.5.7-3">To counter this, an application needs to validate the content of the fields covered in the signature in addition to ensuring that the signature itself validates. With such protections, the attacker's padding attack would be rejected by the field value processor, even in the case where the attacker could force a signature collision.<a class="pilcrow" href="#section-7.5.7-3">¶</a></p>
</section>
</div>
<div id="security-query-elements">
<section id="section-7.5.8">
          <h4 id="name-ambiguous-handling-of-query">
<a class="section-number selfRef" href="#section-7.5.8">7.5.8. </a><a class="section-name selfRef" href="#name-ambiguous-handling-of-query">Ambiguous Handling of Query Elements</a>
          </h4>
<p id="section-7.5.8-1">The HTML form parameters format defined in Section <span><a class="relref" href="https://url.spec.whatwg.org/#application/x-www-form-urlencoded">5</a> (<a class="relref" href="https://url.spec.whatwg.org/#application/x-www-form-urlencoded">"application/x-www-form-urlencoded"</a>)</span> of
<span>[<a class="cite xref" href="#HTMLURL">HTMLURL</a>]</span> is widely deployed and supported by many application frameworks. For convenience, some of these frameworks in particular combine query parameters that are found in the HTTP query and those found in the message content, particularly for POST messages with a Content-Type value of "application/x-www-form-urlencoded". The <code>@query-param</code> derived component identifier defined in <a class="auto internal xref" href="#content-request-query-param">Section 2.2.8</a> draws its values only from the query section of the target URI of the request. As such, it would be possible for an attacker to shadow or replace query parameters in a request by overriding a signed query parameter with an unsigned form parameter, or vice versa.<a class="pilcrow" href="#section-7.5.8-1">¶</a></p>
<p id="section-7.5.8-2">To counter this, an application needs to make sure that values used for the signature base and the application are drawn from a consistent context, in this case the query component of the target URI. Additionally, when the HTTP request has content, an application should sign the message content as well, as discussed in <a class="auto internal xref" href="#security-message-content">Section 7.2.8</a>.<a class="pilcrow" href="#section-7.5.8-2">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="privacy">
<section id="section-8">
      <h2 id="name-privacy-considerations">
<a class="section-number selfRef" href="#section-8">8. </a><a class="section-name selfRef" href="#name-privacy-considerations">Privacy Considerations</a>
      </h2>
<div id="privacy-identify-keys">
<section id="section-8.1">
        <h3 id="name-identification-through-keys">
<a class="section-number selfRef" href="#section-8.1">8.1. </a><a class="section-name selfRef" href="#name-identification-through-keys">Identification through Keys</a>
        </h3>
<p id="section-8.1-1">If a signer uses the same key with multiple verifiers or uses the same key over time with a single verifier, the ongoing use of that key can be used to track the signer throughout the set of verifiers that messages are sent to. Since cryptographic keys are meant to be functionally unique, the use of the same key over time is a strong indicator that it is the same party signing multiple messages.<a class="pilcrow" href="#section-8.1-1">¶</a></p>
<p id="section-8.1-2">In many applications, this is a desirable trait, and it allows HTTP message signatures to be used as part of authenticating the signer to the verifier. However, it could also result in unintentional tracking that a signer might not be aware of. To counter this kind of tracking, a signer can use a different key for each verifier that it is in communication with. Sometimes, a signer could also rotate their key when sending messages to a given verifier. These approaches do not negate the need for other anti-tracking techniques to be applied as necessary.<a class="pilcrow" href="#section-8.1-2">¶</a></p>
</section>
</div>
<div id="privacy-confidentiality">
<section id="section-8.2">
        <h3 id="name-signatures-do-not-provide-c">
<a class="section-number selfRef" href="#section-8.2">8.2. </a><a class="section-name selfRef" href="#name-signatures-do-not-provide-c">Signatures do not provide confidentiality</a>
        </h3>
<p id="section-8.2-1">HTTP message signatures do not provide confidentiality for any of the information protected by the signature. The content of the HTTP message, including the value of all fields and the value of the signature itself, is presented in plaintext to any party with access to the message.<a class="pilcrow" href="#section-8.2-1">¶</a></p>
<p id="section-8.2-2">To provide confidentiality at the transport level, TLS or its equivalent can be used, as discussed in <a class="auto internal xref" href="#security-tls">Section 7.1.2</a>.<a class="pilcrow" href="#section-8.2-2">¶</a></p>
</section>
</div>
<div id="privacy-oracle">
<section id="section-8.3">
        <h3 id="name-oracles">
<a class="section-number selfRef" href="#section-8.3">8.3. </a><a class="section-name selfRef" href="#name-oracles">Oracles</a>
        </h3>
<p id="section-8.3-1">It is important to balance the need for providing useful feedback to developers regarding error conditions without providing additional information to an attacker. For example, a naive but helpful server implementation might try to indicate the required key identifier needed for requesting a resource. If someone knows who controls that key, a correlation can be made between the resource's existence and the party identified by the key. Access to such information could be used by an attacker as a means to target the legitimate owner of the resource for further attacks.<a class="pilcrow" href="#section-8.3-1">¶</a></p>
</section>
</div>
<div id="privacy-required">
<section id="section-8.4">
        <h3 id="name-required-content">
<a class="section-number selfRef" href="#section-8.4">8.4. </a><a class="section-name selfRef" href="#name-required-content">Required Content</a>
        </h3>
<p id="section-8.4-1">A core design tenet of this specification is that all message components covered by the signature need to be available to the verifier in order to recreate the signature base and verify the signature. As a consequence, if an application of this specification requires that a particular field be signed, the verifier will need access to the value of that field.<a class="pilcrow" href="#section-8.4-1">¶</a></p>
<p id="section-8.4-2">For example, in some complex systems with intermediary processors, this could cause surprising behavior where, for fear of breaking the signature, an intermediary cannot remove privacy-sensitive information from a message before forwarding it on for processing. One way to mitigate this specific situation would be for the intermediary to verify the signature itself and then modify the message to remove the privacy-sensitive information. The intermediary can add its own signature at this point to signal to the next destination that the incoming signature was validated, as shown in the example in <a class="auto internal xref" href="#signature-multiple">Section 4.3</a>.<a class="pilcrow" href="#section-8.4-2">¶</a></p>
</section>
</div>
</section>
</div>
<section id="section-9">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-9">9. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-9.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-9.1">9.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC5234">[ABNF]</dt>
        <dd>
<span class="refAuthor">Crocker, D., Ed.</span> and <span class="refAuthor">P. Overell</span>, <span class="refTitle">"Augmented BNF for Syntax Specifications: ABNF"</span>, <span class="seriesInfo">STD 68</span>, <span class="seriesInfo">RFC 5234</span>, <span class="seriesInfo">DOI 10.17487/RFC5234</span>, <time class="refDate" datetime="2008-01">January 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5234">https://www.rfc-editor.org/info/rfc5234</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC0020">[ASCII]</dt>
        <dd>
<span class="refAuthor">Cerf, V.</span>, <span class="refTitle">"ASCII format for network interchange"</span>, <span class="seriesInfo">STD 80</span>, <span class="seriesInfo">RFC 20</span>, <span class="seriesInfo">DOI 10.17487/RFC0020</span>, <time class="refDate" datetime="1969-10">October 1969</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc20">https://www.rfc-editor.org/info/rfc20</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="FIPS186-5">[FIPS186-5]</dt>
        <dd>
<span class="refAuthor">NIST</span>, <span class="refTitle">"Digital Signature Standard (DSS)"</span>, <span class="seriesInfo">DOI 10.6028/NIST.FIPS.186-5</span>, <time class="refDate" datetime="2023-02">February 2023</time>, <span>&lt;<a href="https://doi.org/10.6028/NIST.FIPS.186-5">https://doi.org/10.6028/NIST.FIPS.186-5</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="HTMLURL">[HTMLURL]</dt>
        <dd>
<span class="refAuthor">WHATWG</span>, <span class="refTitle">"URL (Living Standard)"</span>, <time class="refDate" datetime="2024-01">January 2024</time>, <span>&lt;<a href="https://url.spec.whatwg.org/">https://url.spec.whatwg.org/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9110">[HTTP]</dt>
        <dd>
<span class="refAuthor">Fielding, R., Ed.</span>, <span class="refAuthor">Nottingham, M., Ed.</span>, and <span class="refAuthor">J. Reschke, Ed.</span>, <span class="refTitle">"HTTP Semantics"</span>, <span class="seriesInfo">STD 97</span>, <span class="seriesInfo">RFC 9110</span>, <span class="seriesInfo">DOI 10.17487/RFC9110</span>, <time class="refDate" datetime="2022-06">June 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9110">https://www.rfc-editor.org/info/rfc9110</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9112">[HTTP/1.1]</dt>
        <dd>
<span class="refAuthor">Fielding, R., Ed.</span>, <span class="refAuthor">Nottingham, M., Ed.</span>, and <span class="refAuthor">J. Reschke, Ed.</span>, <span class="refTitle">"HTTP/1.1"</span>, <span class="seriesInfo">STD 99</span>, <span class="seriesInfo">RFC 9112</span>, <span class="seriesInfo">DOI 10.17487/RFC9112</span>, <time class="refDate" datetime="2022-06">June 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9112">https://www.rfc-editor.org/info/rfc9112</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="POSIX">[POSIX.1]</dt>
        <dd>
<span class="refAuthor">IEEE</span>, <span class="refTitle">"The Open Group Base Specifications Issue 7, 2018 edition"</span>, <time class="refDate" datetime="2018">2018</time>, <span>&lt;<a href="https://pubs.opengroup.org/onlinepubs/9699919799/">https://pubs.opengroup.org/onlinepubs/9699919799/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2104">[RFC2104]</dt>
        <dd>
<span class="refAuthor">Krawczyk, H.</span>, <span class="refAuthor">Bellare, M.</span>, and <span class="refAuthor">R. Canetti</span>, <span class="refTitle">"HMAC: Keyed-Hashing for Message Authentication"</span>, <span class="seriesInfo">RFC 2104</span>, <span class="seriesInfo">DOI 10.17487/RFC2104</span>, <time class="refDate" datetime="1997-02">February 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2104">https://www.rfc-editor.org/info/rfc2104</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time class="refDate" datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6234">[RFC6234]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span> and <span class="refAuthor">T. Hansen</span>, <span class="refTitle">"US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)"</span>, <span class="seriesInfo">RFC 6234</span>, <span class="seriesInfo">DOI 10.17487/RFC6234</span>, <time class="refDate" datetime="2011-05">May 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6234">https://www.rfc-editor.org/info/rfc6234</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7517">[RFC7517]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refTitle">"JSON Web Key (JWK)"</span>, <span class="seriesInfo">RFC 7517</span>, <span class="seriesInfo">DOI 10.17487/RFC7517</span>, <time class="refDate" datetime="2015-05">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7517">https://www.rfc-editor.org/info/rfc7517</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7518">[RFC7518]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refTitle">"JSON Web Algorithms (JWA)"</span>, <span class="seriesInfo">RFC 7518</span>, <span class="seriesInfo">DOI 10.17487/RFC7518</span>, <time class="refDate" datetime="2015-05">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7518">https://www.rfc-editor.org/info/rfc7518</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8017">[RFC8017]</dt>
        <dd>
<span class="refAuthor">Moriarty, K., Ed.</span>, <span class="refAuthor">Kaliski, B.</span>, <span class="refAuthor">Jonsson, J.</span>, and <span class="refAuthor">A. Rusch</span>, <span class="refTitle">"PKCS #1: RSA Cryptography Specifications Version 2.2"</span>, <span class="seriesInfo">RFC 8017</span>, <span class="seriesInfo">DOI 10.17487/RFC8017</span>, <time class="refDate" datetime="2016-11">November 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8017">https://www.rfc-editor.org/info/rfc8017</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8032">[RFC8032]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span> and <span class="refAuthor">I. Liusvaara</span>, <span class="refTitle">"Edwards-Curve Digital Signature Algorithm (EdDSA)"</span>, <span class="seriesInfo">RFC 8032</span>, <span class="seriesInfo">DOI 10.17487/RFC8032</span>, <time class="refDate" datetime="2017-01">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8032">https://www.rfc-editor.org/info/rfc8032</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time class="refDate" datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8941">[STRUCTURED-FIELDS]</dt>
        <dd>
<span class="refAuthor">Nottingham, M.</span> and <span class="refAuthor">P. Kamp</span>, <span class="refTitle">"Structured Field Values for HTTP"</span>, <span class="seriesInfo">RFC 8941</span>, <span class="seriesInfo">DOI 10.17487/RFC8941</span>, <time class="refDate" datetime="2021-02">February 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8941">https://www.rfc-editor.org/info/rfc8941</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3986">[URI]</dt>
      <dd>
<span class="refAuthor">Berners-Lee, T.</span>, <span class="refAuthor">Fielding, R.</span>, and <span class="refAuthor">L. Masinter</span>, <span class="refTitle">"Uniform Resource Identifier (URI): Generic Syntax"</span>, <span class="seriesInfo">STD 66</span>, <span class="seriesInfo">RFC 3986</span>, <span class="seriesInfo">DOI 10.17487/RFC3986</span>, <time class="refDate" datetime="2005-01">January 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3986">https://www.rfc-editor.org/info/rfc3986</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-9.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-9.2">9.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="AWS-SIGv4">[AWS-SIGv4]</dt>
        <dd>
<span class="refAuthor">Amazon Simple Storage Service</span>, <span class="refTitle">"Authenticating Requests (AWS Signature Version 4)"</span>, <time class="refDate" datetime="2006-03">March 2006</time>, <span>&lt;<a href="https://docs.aws.amazon.com/AmazonS3/latest/API/sig-v4-authenticating-requests.html">https://docs.aws.amazon.com/AmazonS3/latest/API/sig-v4-authenticating-requests.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="BCP195">[BCP195]</dt>
        <dd>
<div class="refInstance" id="RFC8996">
            <span class="refAuthor">Moriarty, K.</span> and <span class="refAuthor">S. Farrell</span>, <span class="refTitle">"Deprecating TLS 1.0 and TLS 1.1"</span>, <span class="seriesInfo">BCP 195</span>, <span class="seriesInfo">RFC 8996</span>, <time class="refDate" datetime="2021-03">March 2021</time>. </div>
<div class="refInstance" id="RFC9325">
            <span class="refAuthor">Sheffer, Y.</span>, <span class="refAuthor">Saint-Andre, P.</span>, and <span class="refAuthor">T. Fossati</span>, <span class="refTitle">"Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"</span>, <span class="seriesInfo">BCP 195</span>, <span class="seriesInfo">RFC 9325</span>, <time class="refDate" datetime="2022-11">November 2022</time>. </div>
<span>&lt;<a href="https://www.rfc-editor.org/info/bcp195">https://www.rfc-editor.org/info/bcp195</a>&gt;</span>
</dd>
<dd class="break"></dd>
<dt id="RFC9440">[CLIENT-CERT]</dt>
        <dd>
<span class="refAuthor">Campbell, B.</span> and <span class="refAuthor">M. Bishop</span>, <span class="refTitle">"Client-Cert HTTP Header Field"</span>, <span class="seriesInfo">RFC 9440</span>, <span class="seriesInfo">DOI 10.17487/RFC9440</span>, <time class="refDate" datetime="2023-07">July 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9440">https://www.rfc-editor.org/info/rfc9440</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6265">[COOKIE]</dt>
        <dd>
<span class="refAuthor">Barth, A.</span>, <span class="refTitle">"HTTP State Management Mechanism"</span>, <span class="seriesInfo">RFC 6265</span>, <span class="seriesInfo">DOI 10.17487/RFC6265</span>, <time class="refDate" datetime="2011-04">April 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6265">https://www.rfc-editor.org/info/rfc6265</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9530">[DIGEST]</dt>
        <dd>
<span class="refAuthor">Polli, R.</span> and <span class="refAuthor">L. Pardue</span>, <span class="refTitle">"Digest Fields"</span>, <span class="seriesInfo">RFC 9530</span>, <span class="seriesInfo">DOI 10.17487/RFC9530</span>, <time class="refDate" datetime="2024-02">February 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9530">https://www.rfc-editor.org/info/rfc9530</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="JACKSON2019">[JACKSON2019]</dt>
        <dd>
<span class="refAuthor">Jackson, D.</span>, <span class="refAuthor">Cremers, C.</span>, <span class="refAuthor">Cohn-Gordon, K.</span>, and <span class="refAuthor">R. Sasse</span>, <span class="refTitle">"Seems Legit: Automated Analysis of Subtle Attacks on Protocols that Use Signatures"</span>, <span class="refContent">CCS '19: Proceedings of the 2019 ACM SIGSAC Conference on Computer and Communications Security, pp. 2165-2180</span>, <span class="seriesInfo">DOI 10.1145/3319535.3339813</span>, <time class="refDate" datetime="2019-11">November 2019</time>, <span>&lt;<a href="https://dl.acm.org/doi/10.1145/3319535.3339813">https://dl.acm.org/doi/10.1145/3319535.3339813</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7515">[JWS]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">N. Sakimura</span>, <span class="refTitle">"JSON Web Signature (JWS)"</span>, <span class="seriesInfo">RFC 7515</span>, <span class="seriesInfo">DOI 10.17487/RFC7515</span>, <time class="refDate" datetime="2015-05">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7515">https://www.rfc-editor.org/info/rfc7515</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7239">[RFC7239]</dt>
        <dd>
<span class="refAuthor">Petersson, A.</span> and <span class="refAuthor">M. Nilsson</span>, <span class="refTitle">"Forwarded HTTP Extension"</span>, <span class="seriesInfo">RFC 7239</span>, <span class="seriesInfo">DOI 10.17487/RFC7239</span>, <time class="refDate" datetime="2014-06">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7239">https://www.rfc-editor.org/info/rfc7239</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7468">[RFC7468]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span> and <span class="refAuthor">S. Leonard</span>, <span class="refTitle">"Textual Encodings of PKIX, PKCS, and CMS Structures"</span>, <span class="seriesInfo">RFC 7468</span>, <span class="seriesInfo">DOI 10.17487/RFC7468</span>, <time class="refDate" datetime="2015-04">April 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7468">https://www.rfc-editor.org/info/rfc7468</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7807">[RFC7807]</dt>
        <dd>
<span class="refAuthor">Nottingham, M.</span> and <span class="refAuthor">E. Wilde</span>, <span class="refTitle">"Problem Details for HTTP APIs"</span>, <span class="seriesInfo">RFC 7807</span>, <span class="seriesInfo">DOI 10.17487/RFC7807</span>, <time class="refDate" datetime="2016-03">March 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7807">https://www.rfc-editor.org/info/rfc7807</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time class="refDate" datetime="2017-06">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8792">[RFC8792]</dt>
        <dd>
<span class="refAuthor">Watsen, K.</span>, <span class="refAuthor">Auerswald, E.</span>, <span class="refAuthor">Farrel, A.</span>, and <span class="refAuthor">Q. Wu</span>, <span class="refTitle">"Handling Long Lines in Content of Internet-Drafts and RFCs"</span>, <span class="seriesInfo">RFC 8792</span>, <span class="seriesInfo">DOI 10.17487/RFC8792</span>, <time class="refDate" datetime="2020-06">June 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8792">https://www.rfc-editor.org/info/rfc8792</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9457">[RFC9457]</dt>
        <dd>
<span class="refAuthor">Nottingham, M.</span>, <span class="refAuthor">Wilde, E.</span>, and <span class="refAuthor">S. Dalal</span>, <span class="refTitle">"Problem Details for HTTP APIs"</span>, <span class="seriesInfo">RFC 9457</span>, <span class="seriesInfo">DOI 10.17487/RFC9457</span>, <time class="refDate" datetime="2023-07">July 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9457">https://www.rfc-editor.org/info/rfc9457</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.cavage-http-signatures">[SIGNING-HTTP-MESSAGES]</dt>
        <dd>
<span class="refAuthor">Cavage, M.</span> and <span class="refAuthor">M. Sporny</span>, <span class="refTitle">"Signing HTTP Messages"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-cavage-http-signatures-12</span>, <time class="refDate" datetime="2019-10-21">21 October 2019</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-cavage-http-signatures-12">https://datatracker.ietf.org/doc/html/draft-cavage-http-signatures-12</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SIGNING-HTTP-REQS-OAUTH">[SIGNING-HTTP-REQS-OAUTH]</dt>
        <dd>
<span class="refAuthor">Richer, J., Ed.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"A Method for Signing HTTP Requests for OAuth"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-oauth-signed-http-request-03</span>, <time class="refDate" datetime="2016-08-08">8 August 2016</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-oauth-signed-http-request-03">https://datatracker.ietf.org/doc/html/draft-ietf-oauth-signed-http-request-03</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[TLS]</dt>
      <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time class="refDate" datetime="2018-08">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="detection">
<section id="appendix-A">
      <h2 id="name-detecting-http-message-sign">
<a class="section-number selfRef" href="#appendix-A">Appendix A. </a><a class="section-name selfRef" href="#name-detecting-http-message-sign">Detecting HTTP Message Signatures</a>
      </h2>
<p id="appendix-A-1">There have been many attempts to create signed HTTP messages in the past, including other non-standardized definitions of the Signature field that is used within this specification. It is recommended that developers wishing to support this specification, other published documents, or other historical drafts do so carefully and deliberately, as incompatibilities between this specification and other documents or various versions of other drafts could lead to unexpected problems.<a class="pilcrow" href="#appendix-A-1">¶</a></p>
<p id="appendix-A-2">It is recommended that implementors first detect and validate the Signature-Input field defined in this specification to detect that the mechanism described in this document is in use and not an alternative. If the Signature-Input field is present, all Signature fields can be parsed and interpreted in the context of this specification.<a class="pilcrow" href="#appendix-A-2">¶</a></p>
</section>
</div>
<div id="examples">
<section id="appendix-B">
      <h2 id="name-examples">
<a class="section-number selfRef" href="#appendix-B">Appendix B. </a><a class="section-name selfRef" href="#name-examples">Examples</a>
      </h2>
<p id="appendix-B-1">The following non-normative examples are provided as a means of testing implementations of HTTP message signatures. The signed messages given can be used to create the signature base with the stated parameters, creating signatures using the stated algorithms and keys.<a class="pilcrow" href="#appendix-B-1">¶</a></p>
<p id="appendix-B-2">The private keys given can be used to generate signatures, though since several of the demonstrated algorithms are non-deterministic, the results of a signature are expected to be different from the exact bytes of the examples. The public keys given can be used to validate all signed examples.<a class="pilcrow" href="#appendix-B-2">¶</a></p>
<div id="example-keys">
<section id="appendix-B.1">
        <h3 id="name-example-keys">
<a class="section-number selfRef" href="#appendix-B.1">B.1. </a><a class="section-name selfRef" href="#name-example-keys">Example Keys</a>
        </h3>
<p id="appendix-B.1-1">This section provides cryptographic keys that are referenced in example signatures throughout this document. These keys <span class="bcp14">MUST NOT</span> be used for any purpose other than testing.<a class="pilcrow" href="#appendix-B.1-1">¶</a></p>
<p id="appendix-B.1-2">The key identifiers for each key are used throughout the examples in this specification. It is assumed for these examples that the signer and verifier can unambiguously dereference all key identifiers used here and that the keys and algorithms used are appropriate for the context in which the signature is presented.<a class="pilcrow" href="#appendix-B.1-2">¶</a></p>
<p id="appendix-B.1-3">The components for each private key, in PEM format <span>[<a class="cite xref" href="#RFC7468">RFC7468</a>]</span>, can be displayed by executing the following OpenSSL command:<a class="pilcrow" href="#appendix-B.1-3">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.1-4">
<pre>openssl pkey -text
</pre><a class="pilcrow" href="#appendix-B.1-4">¶</a>
</div>
<p id="appendix-B.1-5">This command was tested with all the example keys on OpenSSL version 1.1.1m. Note that some systems cannot produce or use all of these keys directly and may require additional processing. All keys are also made available in JWK format.<a class="pilcrow" href="#appendix-B.1-5">¶</a></p>
<div id="example-key-rsa-test">
<section id="appendix-B.1.1">
          <h4 id="name-example-rsa-key">
<a class="section-number selfRef" href="#appendix-B.1.1">B.1.1. </a><a class="section-name selfRef" href="#name-example-rsa-key">Example RSA Key</a>
          </h4>
<p id="appendix-B.1.1-1">The following key is a 2048-bit RSA public and private key pair, referred to in this document
as <code>test-key-rsa</code>. This key is encoded in PEM format, with no encryption.<a class="pilcrow" href="#appendix-B.1.1-1">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.1.1-2">
<pre>-----BEGIN RSA PUBLIC KEY-----
MIIBCgKCAQEAhAKYdtoeoy8zcAcR874L8cnZxKzAGwd7v36APp7Pv6Q2jdsPBRrw
WEBnez6d0UDKDwGbc6nxfEXAy5mbhgajzrw3MOEt8uA5txSKobBpKDeBLOsdJKFq
MGmXCQvEG7YemcxDTRPxAleIAgYYRjTSd/QBwVW9OwNFhekro3RtlinV0a75jfZg
kne/YiktSvLG34lw2zqXBDTC5NHROUqGTlML4PlNZS5Ri2U4aCNx2rUPRcKIlE0P
uKxI4T+HIaFpv8+rdV6eUgOrB2xeI1dSFFn/nnv5OoZJEIB+VmuKn3DCUcCZSFlQ
PSXSfBDiUGhwOw76WuSSsf1D4b/vLoJ10wIDAQAB
-----END RSA PUBLIC KEY-----

-----BEGIN RSA PRIVATE KEY-----
MIIEqAIBAAKCAQEAhAKYdtoeoy8zcAcR874L8cnZxKzAGwd7v36APp7Pv6Q2jdsP
BRrwWEBnez6d0UDKDwGbc6nxfEXAy5mbhgajzrw3MOEt8uA5txSKobBpKDeBLOsd
JKFqMGmXCQvEG7YemcxDTRPxAleIAgYYRjTSd/QBwVW9OwNFhekro3RtlinV0a75
jfZgkne/YiktSvLG34lw2zqXBDTC5NHROUqGTlML4PlNZS5Ri2U4aCNx2rUPRcKI
lE0PuKxI4T+HIaFpv8+rdV6eUgOrB2xeI1dSFFn/nnv5OoZJEIB+VmuKn3DCUcCZ
SFlQPSXSfBDiUGhwOw76WuSSsf1D4b/vLoJ10wIDAQABAoIBAG/JZuSWdoVHbi56
vjgCgkjg3lkO1KrO3nrdm6nrgA9P9qaPjxuKoWaKO1cBQlE1pSWp/cKncYgD5WxE
CpAnRUXG2pG4zdkzCYzAh1i+c34L6oZoHsirK6oNcEnHveydfzJL5934egm6p8DW
+m1RQ70yUt4uRc0YSor+q1LGJvGQHReF0WmJBZHrhz5e63Pq7lE0gIwuBqL8SMaA
yRXtK+JGxZpImTq+NHvEWWCu09SCq0r838ceQI55SvzmTkwqtC+8AT2zFviMZkKR
Qo6SPsrqItxZWRty2izawTF0Bf5S2VAx7O+6t3wBsQ1sLptoSgX3QblELY5asI0J
YFz7LJECgYkAsqeUJmqXE3LP8tYoIjMIAKiTm9o6psPlc8CrLI9CH0UbuaA2JCOM
cCNq8SyYbTqgnWlB9ZfcAm/cFpA8tYci9m5vYK8HNxQr+8FS3Qo8N9RJ8d0U5Csw
DzMYfRghAfUGwmlWj5hp1pQzAuhwbOXFtxKHVsMPhz1IBtF9Y8jvgqgYHLbmyiu1
mwJ5AL0pYF0G7x81prlARURwHo0Yf52kEw1dxpx+JXER7hQRWQki5/NsUEtv+8RT
qn2m6qte5DXLyn83b1qRscSdnCCwKtKWUug5q2ZbwVOCJCtmRwmnP131lWRYfj67
B/xJ1ZA6X3GEf4sNReNAtaucPEelgR2nsN0gKQKBiGoqHWbK1qYvBxX2X3kbPDkv
9C+celgZd2PW7aGYLCHq7nPbmfDV0yHcWjOhXZ8jRMjmANVR/eLQ2EfsRLdW69bn
f3ZD7JS1fwGnO3exGmHO3HZG+6AvberKYVYNHahNFEw5TsAcQWDLRpkGybBcxqZo
81YCqlqidwfeO5YtlO7etx1xLyqa2NsCeG9A86UjG+aeNnXEIDk1PDK+EuiThIUa
/2IxKzJKWl1BKr2d4xAfR0ZnEYuRrbeDQYgTImOlfW6/GuYIxKYgEKCFHFqJATAG
IxHrq1PDOiSwXd2GmVVYyEmhZnbcp8CxaEMQoevxAta0ssMK3w6UsDtvUvYvF22m
qQKBiD5GwESzsFPy3Ga0MvZpn3D6EJQLgsnrtUPZx+z2Ep2x0xc5orneB5fGyF1P
WtP+fG5Q6Dpdz3LRfm+KwBCWFKQjg7uTxcjerhBWEYPmEMKYwTJF5PBG9/ddvHLQ
EQeNC8fHGg4UXU8mhHnSBt3EA10qQJfRDs15M38eG2cYwB1PZpDHScDnDA0=
-----END RSA PRIVATE KEY-----
</pre><a class="pilcrow" href="#appendix-B.1.1-2">¶</a>
</div>
<p id="appendix-B.1.1-3">The same public and private key pair in JWK format:<a class="pilcrow" href="#appendix-B.1.1-3">¶</a></p>
<div class="lang-json sourcecode" id="appendix-B.1.1-4">
<pre>NOTE: '\' line wrapping per RFC 8792

{
  "kty": "RSA",
  "kid": "test-key-rsa",
  "p": "sqeUJmqXE3LP8tYoIjMIAKiTm9o6psPlc8CrLI9CH0UbuaA2JCOMcCNq8Sy\
  YbTqgnWlB9ZfcAm_cFpA8tYci9m5vYK8HNxQr-8FS3Qo8N9RJ8d0U5CswDzMYfRgh\
  AfUGwmlWj5hp1pQzAuhwbOXFtxKHVsMPhz1IBtF9Y8jvgqgYHLbmyiu1mw",
  "q": "vSlgXQbvHzWmuUBFRHAejRh_naQTDV3GnH4lcRHuFBFZCSLn82xQS2_7xFO\
  qfabqq17kNcvKfzdvWpGxxJ2cILAq0pZS6DmrZlvBU4IkK2ZHCac_XfWVZFh-PrsH\
  _EnVkDpfcYR_iw1F40C1q5w8R6WBHaew3SAp",
  "d": "b8lm5JZ2hUduLnq-OAKCSODeWQ7Uqs7eet2bqeuAD0_2po-PG4qhZoo7VwF\
  CUTWlJan9wqdxiAPlbEQKkCdFRcbakbjN2TMJjMCHWL5zfgvqhmgeyKsrqg1wSce9\
  7J1_Mkvn3fh6CbqnwNb6bVFDvTJS3i5FzRhKiv6rUsYm8ZAdF4XRaYkFkeuHPl7rc\
  -ruUTSAjC4GovxIxoDJFe0r4kbFmkiZOr40e8RZYK7T1IKrSvzfxx5AjnlK_OZOTC\
  q0L7wBPbMW-IxmQpFCjpI-yuoi3FlZG3LaLNrBMXQF_lLZUDHs77q3fAGxDWwum2h\
  KBfdBuUQtjlqwjQlgXPsskQ",
  "e": "AQAB",
  "qi": "PkbARLOwU_LcZrQy9mmfcPoQlAuCyeu1Q9nH7PYSnbHTFzmiud4Hl8bIXU\
  9a0_58blDoOl3PctF-b4rAEJYUpCODu5PFyN6uEFYRg-YQwpjBMkXk8Eb39128ctA\
  RB40Lx8caDhRdTyaEedIG3cQDXSpAl9EOzXkzfx4bZxjAHU9mkMdJwOcMDQ",
  "dp": "aiodZsrWpi8HFfZfeRs8OS_0L5x6WBl3Y9btoZgsIeruc9uZ8NXTIdxaM6\
  FdnyNEyOYA1VH94tDYR-xEt1br1ud_dkPslLV_Aac7d7EaYc7cdkb7oC9t6sphVg0\
  dqE0UTDlOwBxBYMtGmQbJsFzGpmjzVgKqWqJ3B947li2U7t63HXEvKprY2w",
  "dq": "b0DzpSMb5p42dcQgOTU8Mr4S6JOEhRr_YjErMkpaXUEqvZ3jEB9HRmcRi5\
  Gtt4NBiBMiY6V9br8a5gjEpiAQoIUcWokBMAYjEeurU8M6JLBd3YaZVVjISaFmdty\
  nwLFoQxCh6_EC1rSywwrfDpSwO29S9i8Xbaap",
  "n": "hAKYdtoeoy8zcAcR874L8cnZxKzAGwd7v36APp7Pv6Q2jdsPBRrwWEBnez6\
  d0UDKDwGbc6nxfEXAy5mbhgajzrw3MOEt8uA5txSKobBpKDeBLOsdJKFqMGmXCQvE\
  G7YemcxDTRPxAleIAgYYRjTSd_QBwVW9OwNFhekro3RtlinV0a75jfZgkne_YiktS\
  vLG34lw2zqXBDTC5NHROUqGTlML4PlNZS5Ri2U4aCNx2rUPRcKIlE0PuKxI4T-HIa\
  Fpv8-rdV6eUgOrB2xeI1dSFFn_nnv5OoZJEIB-VmuKn3DCUcCZSFlQPSXSfBDiUGh\
  wOw76WuSSsf1D4b_vLoJ10w"
}
</pre><a class="pilcrow" href="#appendix-B.1.1-4">¶</a>
</div>
</section>
</div>
<div id="example-key-rsa-pss-test">
<section id="appendix-B.1.2">
          <h4 id="name-example-rsa-pss-key">
<a class="section-number selfRef" href="#appendix-B.1.2">B.1.2. </a><a class="section-name selfRef" href="#name-example-rsa-pss-key">Example RSA-PSS Key</a>
          </h4>
<p id="appendix-B.1.2-1">The following key is a 2048-bit RSA public and private key pair, referred to in this document
as <code>test-key-rsa-pss</code>. This key is PKCS #8 encoded in PEM format, with no encryption.<a class="pilcrow" href="#appendix-B.1.2-1">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.1.2-2">
<pre>-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAr4tmm3r20Wd/PbqvP1s2
+QEtvpuRaV8Yq40gjUR8y2Rjxa6dpG2GXHbPfvMs8ct+Lh1GH45x28Rw3Ry53mm+
oAXjyQ86OnDkZ5N8lYbggD4O3w6M6pAvLkhk95AndTrifbIFPNU8PPMO7OyrFAHq
gDsznjPFmTOtCEcN2Z1FpWgchwuYLPL+Wokqltd11nqqzi+bJ9cvSKADYdUAAN5W
Utzdpiy6LbTgSxP7ociU4Tn0g5I6aDZJ7A8Lzo0KSyZYoA485mqcO0GVAdVw9lq4
aOT9v6d+nb4bnNkQVklLQ3fVAvJm+xdDOp9LCNCN48V2pnDOkFV6+U9nV5oyc6XI
2wIDAQAB
-----END PUBLIC KEY-----

-----BEGIN PRIVATE KEY-----
MIIEvgIBADALBgkqhkiG9w0BAQoEggSqMIIEpgIBAAKCAQEAr4tmm3r20Wd/Pbqv
P1s2+QEtvpuRaV8Yq40gjUR8y2Rjxa6dpG2GXHbPfvMs8ct+Lh1GH45x28Rw3Ry5
3mm+oAXjyQ86OnDkZ5N8lYbggD4O3w6M6pAvLkhk95AndTrifbIFPNU8PPMO7Oyr
FAHqgDsznjPFmTOtCEcN2Z1FpWgchwuYLPL+Wokqltd11nqqzi+bJ9cvSKADYdUA
AN5WUtzdpiy6LbTgSxP7ociU4Tn0g5I6aDZJ7A8Lzo0KSyZYoA485mqcO0GVAdVw
9lq4aOT9v6d+nb4bnNkQVklLQ3fVAvJm+xdDOp9LCNCN48V2pnDOkFV6+U9nV5oy
c6XI2wIDAQABAoIBAQCUB8ip+kJiiZVKF8AqfB/aUP0jTAqOQewK1kKJ/iQCXBCq
pbo360gvdt05H5VZ/RDVkEgO2k73VSsbulqezKs8RFs2tEmU+JgTI9MeQJPWcP6X
aKy6LIYs0E2cWgp8GADgoBs8llBq0UhX0KffglIeek3n7Z6Gt4YFge2TAcW2WbN4
XfK7lupFyo6HHyWRiYHMMARQXLJeOSdTn5aMBP0PO4bQyk5ORxTUSeOciPJUFktQ
HkvGbym7KryEfwH8Tks0L7WhzyP60PL3xS9FNOJi9m+zztwYIXGDQuKM2GDsITeD
2mI2oHoPMyAD0wdI7BwSVW18p1h+jgfc4dlexKYRAoGBAOVfuiEiOchGghV5vn5N
RDNscAFnpHj1QgMr6/UG05RTgmcLfVsI1I4bSkbrIuVKviGGf7atlkROALOG/xRx
DLadgBEeNyHL5lz6ihQaFJLVQ0u3U4SB67J0YtVO3R6lXcIjBDHuY8SjYJ7Ci6Z6
vuDcoaEujnlrtUhaMxvSfcUJAoGBAMPsCHXte1uWNAqYad2WdLjPDlKtQJK1diCm
rqmB2g8QE99hDOHItjDBEdpyFBKOIP+NpVtM2KLhRajjcL9Ph8jrID6XUqikQuVi
4J9FV2m42jXMuioTT13idAILanYg8D3idvy/3isDVkON0X3UAVKrgMEne0hJpkPL
FYqgetvDAoGBAKLQ6JZMbSe0pPIJkSamQhsehgL5Rs51iX4m1z7+sYFAJfhvN3Q/
OGIHDRp6HjMUcxHpHw7U+S1TETxePwKLnLKj6hw8jnX2/nZRgWHzgVcY+sPsReRx
NJVf+Cfh6yOtznfX00p+JWOXdSY8glSSHJwRAMog+hFGW1AYdt7w80XBAoGBAImR
NUugqapgaEA8TrFxkJmngXYaAqpA0iYRA7kv3S4QavPBUGtFJHBNULzitydkNtVZ
3w6hgce0h9YThTo/nKc+OZDZbgfN9s7cQ75x0PQCAO4fx2P91Q+mDzDUVTeG30mE
t2m3S0dGe47JiJxifV9P3wNBNrZGSIF3mrORBVNDAoGBAI0QKn2Iv7Sgo4T/XjND
dl2kZTXqGAk8dOhpUiw/HdM3OGWbhHj2NdCzBliOmPyQtAr770GITWvbAI+IRYyF
S7Fnk6ZVVVHsxjtaHy1uJGFlaZzKR4AGNaUTOJMs6NadzCmGPAxNQQOCqoUjn4XR
rOjr9w349JooGXhOxbu8nOxX
-----END PRIVATE KEY-----
</pre><a class="pilcrow" href="#appendix-B.1.2-2">¶</a>
</div>
<p id="appendix-B.1.2-3">The same public and private key pair in JWK format:<a class="pilcrow" href="#appendix-B.1.2-3">¶</a></p>
<div class="lang-json sourcecode" id="appendix-B.1.2-4">
<pre>NOTE: '\' line wrapping per RFC 8792

{
  "kty": "RSA",
  "kid": "test-key-rsa-pss",
  "p": "5V-6ISI5yEaCFXm-fk1EM2xwAWekePVCAyvr9QbTlFOCZwt9WwjUjhtKRus\
  i5Uq-IYZ_tq2WRE4As4b_FHEMtp2AER43IcvmXPqKFBoUktVDS7dThIHrsnRi1U7d\
  HqVdwiMEMe5jxKNgnsKLpnq-4NyhoS6OeWu1SFozG9J9xQk",
  "q": "w-wIde17W5Y0Cphp3ZZ0uM8OUq1AkrV2IKauqYHaDxAT32EM4ci2MMER2nI\
  UEo4g_42lW0zYouFFqONwv0-HyOsgPpdSqKRC5WLgn0VXabjaNcy6KhNPXeJ0Agtq\
  diDwPeJ2_L_eKwNWQ43RfdQBUquAwSd7SEmmQ8sViqB628M",
  "d": "lAfIqfpCYomVShfAKnwf2lD9I0wKjkHsCtZCif4kAlwQqqW6N-tIL3bdOR-\
  VWf0Q1ZBIDtpO91UrG7pansyrPERbNrRJlPiYEyPTHkCT1nD-l2isuiyGLNBNnFoK\
  fBgA4KAbPJZQatFIV9Cn34JSHnpN5-2ehreGBYHtkwHFtlmzeF3yu5bqRcqOhx8lk\
  YmBzDAEUFyyXjknU5-WjAT9DzuG0MpOTkcU1EnjnIjyVBZLUB5Lxm8puyq8hH8B_E\
  5LNC-1oc8j-tDy98UvRTTiYvZvs87cGCFxg0LijNhg7CE3g9piNqB6DzMgA9MHSOw\
  cElVtfKdYfo4H3OHZXsSmEQ",
  "e": "AQAB",
  "qi": "jRAqfYi_tKCjhP9eM0N2XaRlNeoYCTx06GlSLD8d0zc4ZZuEePY10LMGWI\
  6Y_JC0CvvvQYhNa9sAj4hFjIVLsWeTplVVUezGO1ofLW4kYWVpnMpHgAY1pRM4kyz\
  o1p3MKYY8DE1BA4KqhSOfhdGs6Ov3Dfj0migZeE7Fu7yc7Fc",
  "dp": "otDolkxtJ7Sk8gmRJqZCGx6GAvlGznWJfibXPv6xgUAl-G83dD84YgcNGn\
  oeMxRzEekfDtT5LVMRPF4_AoucsqPqHDyOdfb-dlGBYfOBVxj6w-xF5HE0lV_4J-H\
  rI63Od9fTSn4lY5d1JjyCVJIcnBEAyiD6EUZbUBh23vDzRcE",
  "dq": "iZE1S6CpqmBoQDxOsXGQmaeBdhoCqkDSJhEDuS_dLhBq88FQa0UkcE1QvO\
  K3J2Q21VnfDqGBx7SH1hOFOj-cpz45kNluB832ztxDvnHQ9AIA7h_HY_3VD6YPMNR\
  VN4bfSYS3abdLR0Z7jsmInGJ9X0_fA0E2tkZIgXeas5EFU0M",
  "n": "r4tmm3r20Wd_PbqvP1s2-QEtvpuRaV8Yq40gjUR8y2Rjxa6dpG2GXHbPfvM\
  s8ct-Lh1GH45x28Rw3Ry53mm-oAXjyQ86OnDkZ5N8lYbggD4O3w6M6pAvLkhk95An\
  dTrifbIFPNU8PPMO7OyrFAHqgDsznjPFmTOtCEcN2Z1FpWgchwuYLPL-Wokqltd11\
  nqqzi-bJ9cvSKADYdUAAN5WUtzdpiy6LbTgSxP7ociU4Tn0g5I6aDZJ7A8Lzo0KSy\
  ZYoA485mqcO0GVAdVw9lq4aOT9v6d-nb4bnNkQVklLQ3fVAvJm-xdDOp9LCNCN48V\
  2pnDOkFV6-U9nV5oyc6XI2w"
}
</pre><a class="pilcrow" href="#appendix-B.1.2-4">¶</a>
</div>
</section>
</div>
<div id="example-key-ecc-p256">
<section id="appendix-B.1.3">
          <h4 id="name-example-ecc-p-256-test-key">
<a class="section-number selfRef" href="#appendix-B.1.3">B.1.3. </a><a class="section-name selfRef" href="#name-example-ecc-p-256-test-key">Example ECC P-256 Test Key</a>
          </h4>
<p id="appendix-B.1.3-1">The following key is a public and private elliptical curve key pair over the curve P-256, referred
to in this document as <code>test-key-ecc-p256</code>. This key is encoded in PEM format, with no encryption.<a class="pilcrow" href="#appendix-B.1.3-1">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.1.3-2">
<pre>-----BEGIN PUBLIC KEY-----
MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEqIVYZVLCrPZHGHjP17CTW0/+D9Lf
w0EkjqF7xB4FivAxzic30tMM4GF+hR6Dxh71Z50VGGdldkkDXZCnTNnoXQ==
-----END PUBLIC KEY-----

-----BEGIN EC PRIVATE KEY-----
MHcCAQEEIFKbhfNZfpDsW43+0+JjUr9K+bTeuxopu653+hBaXGA7oAoGCCqGSM49
AwEHoUQDQgAEqIVYZVLCrPZHGHjP17CTW0/+D9Lfw0EkjqF7xB4FivAxzic30tMM
4GF+hR6Dxh71Z50VGGdldkkDXZCnTNnoXQ==
-----END EC PRIVATE KEY-----
</pre><a class="pilcrow" href="#appendix-B.1.3-2">¶</a>
</div>
<p id="appendix-B.1.3-3">The same public and private key pair in JWK format:<a class="pilcrow" href="#appendix-B.1.3-3">¶</a></p>
<div class="lang-json sourcecode" id="appendix-B.1.3-4">
<pre>{
  "kty": "EC",
  "crv": "P-256",
  "kid": "test-key-ecc-p256",
  "d": "UpuF81l-kOxbjf7T4mNSv0r5tN67Gim7rnf6EFpcYDs",
  "x": "qIVYZVLCrPZHGHjP17CTW0_-D9Lfw0EkjqF7xB4FivA",
  "y": "Mc4nN9LTDOBhfoUeg8Ye9WedFRhnZXZJA12Qp0zZ6F0"
}
</pre><a class="pilcrow" href="#appendix-B.1.3-4">¶</a>
</div>
</section>
</div>
<div id="example-key-ed25519">
<section id="appendix-B.1.4">
          <h4 id="name-example-ed25519-test-key">
<a class="section-number selfRef" href="#appendix-B.1.4">B.1.4. </a><a class="section-name selfRef" href="#name-example-ed25519-test-key">Example Ed25519 Test Key</a>
          </h4>
<p id="appendix-B.1.4-1">The following key is an elliptical curve key over the Edwards curve ed25519, referred to in this document as <code>test-key-ed25519</code>. This key is PKCS #8 encoded in PEM format, with no encryption.<a class="pilcrow" href="#appendix-B.1.4-1">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.1.4-2">
<pre>-----BEGIN PUBLIC KEY-----
MCowBQYDK2VwAyEAJrQLj5P/89iXES9+vFgrIy29clF9CC/oPPsw3c5D0bs=
-----END PUBLIC KEY-----

-----BEGIN PRIVATE KEY-----
MC4CAQAwBQYDK2VwBCIEIJ+DYvh6SEqVTm50DFtMDoQikTmiCqirVv9mWG9qfSnF
-----END PRIVATE KEY-----
</pre><a class="pilcrow" href="#appendix-B.1.4-2">¶</a>
</div>
<p id="appendix-B.1.4-3">The same public and private key pair in JWK format:<a class="pilcrow" href="#appendix-B.1.4-3">¶</a></p>
<div class="lang-json sourcecode" id="appendix-B.1.4-4">
<pre>{
  "kty": "OKP",
  "crv": "Ed25519",
  "kid": "test-key-ed25519",
  "d": "n4Ni-HpISpVObnQMW0wOhCKROaIKqKtW_2ZYb2p9KcU",
  "x": "JrQLj5P_89iXES9-vFgrIy29clF9CC_oPPsw3c5D0bs"
}
</pre><a class="pilcrow" href="#appendix-B.1.4-4">¶</a>
</div>
</section>
</div>
<div id="example-shared-secret">
<section id="appendix-B.1.5">
          <h4 id="name-example-shared-secret">
<a class="section-number selfRef" href="#appendix-B.1.5">B.1.5. </a><a class="section-name selfRef" href="#name-example-shared-secret">Example Shared Secret</a>
          </h4>
<p id="appendix-B.1.5-1">The following shared secret is 64 randomly generated bytes encoded in Base64,
referred to in this document as <code>test-shared-secret</code>:<a class="pilcrow" href="#appendix-B.1.5-1">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.1.5-2">
<pre>NOTE: '\' line wrapping per RFC 8792

uzvJfB4u3N0Jy4T7NZ75MDVcr8zSTInedJtkgcu46YW4XByzNJjxBdtjUkdJPBt\
  bmHhIDi6pcl8jsasjlTMtDQ==
</pre><a class="pilcrow" href="#appendix-B.1.5-2">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="test-cases">
<section id="appendix-B.2">
        <h3 id="name-test-cases">
<a class="section-number selfRef" href="#appendix-B.2">B.2. </a><a class="section-name selfRef" href="#name-test-cases">Test Cases</a>
        </h3>
<p id="appendix-B.2-1">This section provides non-normative examples that may be used as test cases to validate implementation correctness. These examples are based on the following HTTP messages:<a class="pilcrow" href="#appendix-B.2-1">¶</a></p>
<p id="appendix-B.2-2">For requests, this <code>test-request</code> message is used:<a class="pilcrow" href="#appendix-B.2-2">¶</a></p>
<div class="lang-http-message sourcecode" id="appendix-B.2-3">
<pre>NOTE: '\' line wrapping per RFC 8792

POST /foo?param=Value&amp;Pet=dog HTTP/1.1
Host: example.com
Date: Tue, 20 Apr 2021 02:07:55 GMT
Content-Type: application/json
Content-Digest: sha-512=:WZDPaVn/7XgHaAy8pmojAkGWoRx2UFChF41A2svX+T\
  aPm+AbwAgBWnrIiYllu7BNNyealdVLvRwEmTHWXvJwew==:
Content-Length: 18

{"hello": "world"}
</pre><a class="pilcrow" href="#appendix-B.2-3">¶</a>
</div>
<p id="appendix-B.2-4">For responses, this <code>test-response</code> message is used:<a class="pilcrow" href="#appendix-B.2-4">¶</a></p>
<div class="lang-http-message sourcecode" id="appendix-B.2-5">
<pre>NOTE: '\' line wrapping per RFC 8792

HTTP/1.1 200 OK
Date: Tue, 20 Apr 2021 02:07:56 GMT
Content-Type: application/json
Content-Digest: sha-512=:mEWXIS7MaLRuGgxOBdODa3xqM1XdEvxoYhvlCFJ41Q\
  JgJc4GTsPp29l5oGX69wWdXymyU0rjJuahq4l5aGgfLQ==:
Content-Length: 23

{"message": "good dog"}
</pre><a class="pilcrow" href="#appendix-B.2-5">¶</a>
</div>
<div id="minimal-signature-using-rsa-pss-sha512">
<section id="appendix-B.2.1">
          <h4 id="name-minimal-signature-using-rsa">
<a class="section-number selfRef" href="#appendix-B.2.1">B.2.1. </a><a class="section-name selfRef" href="#name-minimal-signature-using-rsa">Minimal Signature Using rsa-pss-sha512</a>
          </h4>
<p id="appendix-B.2.1-1">This example presents a minimal signature using the <code>rsa-pss-sha512</code> algorithm over <code>test-request</code>, covering none
of the components of the HTTP message but providing a timestamped signature proof of possession of the key with a signer-provided nonce.<a class="pilcrow" href="#appendix-B.2.1-1">¶</a></p>
<p id="appendix-B.2.1-2">The corresponding signature base is:<a class="pilcrow" href="#appendix-B.2.1-2">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.2.1-3">
<pre>NOTE: '\' line wrapping per RFC 8792

"@signature-params": ();created=1618884473;keyid="test-key-rsa-pss"\
  ;nonce="b3k2pp5k7z-50gnwp.yemd"
</pre><a class="pilcrow" href="#appendix-B.2.1-3">¶</a>
</div>
<p id="appendix-B.2.1-4">This results in the following Signature-Input and Signature header fields being added to the message under the signature label <code>sig-b21</code>:<a class="pilcrow" href="#appendix-B.2.1-4">¶</a></p>
<div class="lang-http-message sourcecode" id="appendix-B.2.1-5">
<pre>NOTE: '\' line wrapping per RFC 8792

Signature-Input: sig-b21=();created=1618884473\
  ;keyid="test-key-rsa-pss";nonce="b3k2pp5k7z-50gnwp.yemd"
Signature: sig-b21=:d2pmTvmbncD3xQm8E9ZV2828BjQWGgiwAaw5bAkgibUopem\
  LJcWDy/lkbbHAve4cRAtx31Iq786U7it++wgGxbtRxf8Udx7zFZsckzXaJMkA7ChG\
  52eSkFxykJeNqsrWH5S+oxNFlD4dzVuwe8DhTSja8xxbR/Z2cOGdCbzR72rgFWhzx\
  2VjBqJzsPLMIQKhO4DGezXehhWwE56YCE+O6c0mKZsfxVrogUvA4HELjVKWmAvtl6\
  UnCh8jYzuVG5WSb/QEVPnP5TmcAnLH1g+s++v6d4s8m0gCw1fV5/SITLq9mhho8K3\
  +7EPYTU8IU1bLhdxO5Nyt8C8ssinQ98Xw9Q==:
</pre><a class="pilcrow" href="#appendix-B.2.1-5">¶</a>
</div>
<p id="appendix-B.2.1-6">Note that since the covered components list is empty, this signature could be applied by an attacker to an unrelated HTTP message. In this example, the <code>nonce</code> parameter is included to prevent the same signature from being replayed more than once, but if an attacker intercepts the signature and prevents its delivery to the verifier, the attacker could apply this signature to another message. Therefore, the use of an empty covered components set is discouraged. See <a class="auto internal xref" href="#security-coverage">Section 7.2.1</a> for more discussion.<a class="pilcrow" href="#appendix-B.2.1-6">¶</a></p>
<p id="appendix-B.2.1-7">Note that the RSA-PSS algorithm in use here is non-deterministic, meaning that a different signature value will be created every time the algorithm is run. The signature value provided here can be validated against the given keys, but newly generated signature values are not expected to match the example. See <a class="auto internal xref" href="#security-nondeterministic">Section 7.3.5</a>.<a class="pilcrow" href="#appendix-B.2.1-7">¶</a></p>
</section>
</div>
<div id="selective-covered-components-using-rsa-pss-sha512">
<section id="appendix-B.2.2">
          <h4 id="name-selective-covered-component">
<a class="section-number selfRef" href="#appendix-B.2.2">B.2.2. </a><a class="section-name selfRef" href="#name-selective-covered-component">Selective Covered Components Using rsa-pss-sha512</a>
          </h4>
<p id="appendix-B.2.2-1">This example covers additional components (the authority, the Content-Digest header field, and a single named query parameter) in <code>test-request</code> using the <code>rsa-pss-sha512</code> algorithm. This example also adds a <code>tag</code> parameter with the application-specific value of <code>header-example</code>.<a class="pilcrow" href="#appendix-B.2.2-1">¶</a></p>
<p id="appendix-B.2.2-2">The corresponding signature base is:<a class="pilcrow" href="#appendix-B.2.2-2">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.2.2-3">
<pre>NOTE: '\' line wrapping per RFC 8792

"@authority": example.com
"content-digest": sha-512=:WZDPaVn/7XgHaAy8pmojAkGWoRx2UFChF41A2svX\
  +TaPm+AbwAgBWnrIiYllu7BNNyealdVLvRwEmTHWXvJwew==:
"@query-param";name="Pet": dog
"@signature-params": ("@authority" "content-digest" \
  "@query-param";name="Pet")\
  ;created=1618884473;keyid="test-key-rsa-pss"\
  ;tag="header-example"
</pre><a class="pilcrow" href="#appendix-B.2.2-3">¶</a>
</div>
<p id="appendix-B.2.2-4">This results in the following Signature-Input and Signature header fields being added to the message under the label <code>sig-b22</code>:<a class="pilcrow" href="#appendix-B.2.2-4">¶</a></p>
<div class="lang-http-message sourcecode" id="appendix-B.2.2-5">
<pre>NOTE: '\' line wrapping per RFC 8792

Signature-Input: sig-b22=("@authority" "content-digest" \
  "@query-param";name="Pet");created=1618884473\
  ;keyid="test-key-rsa-pss";tag="header-example"
Signature: sig-b22=:LjbtqUbfmvjj5C5kr1Ugj4PmLYvx9wVjZvD9GsTT4F7GrcQ\
  EdJzgI9qHxICagShLRiLMlAJjtq6N4CDfKtjvuJyE5qH7KT8UCMkSowOB4+ECxCmT\
  8rtAmj/0PIXxi0A0nxKyB09RNrCQibbUjsLS/2YyFYXEu4TRJQzRw1rLEuEfY17SA\
  RYhpTlaqwZVtR8NV7+4UKkjqpcAoFqWFQh62s7Cl+H2fjBSpqfZUJcsIk4N6wiKYd\
  4je2U/lankenQ99PZfB4jY3I5rSV2DSBVkSFsURIjYErOs0tFTQosMTAoxk//0RoK\
  UqiYY8Bh0aaUEb0rQl3/XaVe4bXTugEjHSw==:
</pre><a class="pilcrow" href="#appendix-B.2.2-5">¶</a>
</div>
<p id="appendix-B.2.2-6">Note that the RSA-PSS algorithm in use here is non-deterministic, meaning that a different signature value will be created every time the algorithm is run. The signature value provided here can be validated against the given keys, but newly generated signature values are not expected to match the example. See <a class="auto internal xref" href="#security-nondeterministic">Section 7.3.5</a>.<a class="pilcrow" href="#appendix-B.2.2-6">¶</a></p>
</section>
</div>
<div id="full-coverage-using-rsa-pss-sha512">
<section id="appendix-B.2.3">
          <h4 id="name-full-coverage-using-rsa-pss">
<a class="section-number selfRef" href="#appendix-B.2.3">B.2.3. </a><a class="section-name selfRef" href="#name-full-coverage-using-rsa-pss">Full Coverage Using rsa-pss-sha512</a>
          </h4>
<p id="appendix-B.2.3-1">This example covers all applicable message components in <code>test-request</code> (including the content type and length) plus many derived components, again using the <code>rsa-pss-sha512</code> algorithm. Note that the Host header field is not covered because the <code>@authority</code> derived component is included instead.<a class="pilcrow" href="#appendix-B.2.3-1">¶</a></p>
<p id="appendix-B.2.3-2">The corresponding signature base is:<a class="pilcrow" href="#appendix-B.2.3-2">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.2.3-3">
<pre>NOTE: '\' line wrapping per RFC 8792

"date": Tue, 20 Apr 2021 02:07:55 GMT
"@method": POST
"@path": /foo
"@query": ?param=Value&amp;Pet=dog
"@authority": example.com
"content-type": application/json
"content-digest": sha-512=:WZDPaVn/7XgHaAy8pmojAkGWoRx2UFChF41A2svX\
  +TaPm+AbwAgBWnrIiYllu7BNNyealdVLvRwEmTHWXvJwew==:
"content-length": 18
"@signature-params": ("date" "@method" "@path" "@query" \
  "@authority" "content-type" "content-digest" "content-length")\
  ;created=1618884473;keyid="test-key-rsa-pss"
</pre><a class="pilcrow" href="#appendix-B.2.3-3">¶</a>
</div>
<p id="appendix-B.2.3-4">This results in the following Signature-Input and Signature header fields being added to the message under the label <code>sig-b23</code>:<a class="pilcrow" href="#appendix-B.2.3-4">¶</a></p>
<div class="lang-http-message sourcecode" id="appendix-B.2.3-5">
<pre>NOTE: '\' line wrapping per RFC 8792

Signature-Input: sig-b23=("date" "@method" "@path" "@query" \
  "@authority" "content-type" "content-digest" "content-length")\
  ;created=1618884473;keyid="test-key-rsa-pss"
Signature: sig-b23=:bbN8oArOxYoyylQQUU6QYwrTuaxLwjAC9fbY2F6SVWvh0yB\
  iMIRGOnMYwZ/5MR6fb0Kh1rIRASVxFkeGt683+qRpRRU5p2voTp768ZrCUb38K0fU\
  xN0O0iC59DzYx8DFll5GmydPxSmme9v6ULbMFkl+V5B1TP/yPViV7KsLNmvKiLJH1\
  pFkh/aYA2HXXZzNBXmIkoQoLd7YfW91kE9o/CCoC1xMy7JA1ipwvKvfrs65ldmlu9\
  bpG6A9BmzhuzF8Eim5f8ui9eH8LZH896+QIF61ka39VBrohr9iyMUJpvRX2Zbhl5Z\
  JzSRxpJyoEZAFL2FUo5fTIztsDZKEgM4cUA==:
</pre><a class="pilcrow" href="#appendix-B.2.3-5">¶</a>
</div>
<p id="appendix-B.2.3-6">Note in this example that the value of the Date header field and the value of the <code>created</code> signature parameter need not be the same. This is due to the fact that the Date header field is added when creating the HTTP message and the <code>created</code> parameter is populated when creating the signature over that message, and these two times could vary. If the Date header field is covered by the signature, it is up to the verifier to determine whether its value has to match that of the <code>created</code> parameter or not. See <a class="auto internal xref" href="#security-not-fields">Section 7.2.4</a> for more discussion.<a class="pilcrow" href="#appendix-B.2.3-6">¶</a></p>
<p id="appendix-B.2.3-7">Note that the RSA-PSS algorithm in use here is non-deterministic, meaning that a different signature value will be created every time the algorithm is run. The signature value provided here can be validated against the given keys, but newly generated signature values are not expected to match the example. See <a class="auto internal xref" href="#security-nondeterministic">Section 7.3.5</a>.<a class="pilcrow" href="#appendix-B.2.3-7">¶</a></p>
</section>
</div>
<div id="signing-a-response-using-ecdsa-p256-sha256">
<section id="appendix-B.2.4">
          <h4 id="name-signing-a-response-using-ec">
<a class="section-number selfRef" href="#appendix-B.2.4">B.2.4. </a><a class="section-name selfRef" href="#name-signing-a-response-using-ec">Signing a Response Using ecdsa-p256-sha256</a>
          </h4>
<p id="appendix-B.2.4-1">This example covers portions of the <code>test-response</code> message using the <code>ecdsa-p256-sha256</code> algorithm
and the key <code>test-key-ecc-p256</code>.<a class="pilcrow" href="#appendix-B.2.4-1">¶</a></p>
<p id="appendix-B.2.4-2">The corresponding signature base is:<a class="pilcrow" href="#appendix-B.2.4-2">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.2.4-3">
<pre>NOTE: '\' line wrapping per RFC 8792

"@status": 200
"content-type": application/json
"content-digest": sha-512=:mEWXIS7MaLRuGgxOBdODa3xqM1XdEvxoYhvlCFJ4\
  1QJgJc4GTsPp29l5oGX69wWdXymyU0rjJuahq4l5aGgfLQ==:
"content-length": 23
"@signature-params": ("@status" "content-type" "content-digest" \
  "content-length");created=1618884473;keyid="test-key-ecc-p256"
</pre><a class="pilcrow" href="#appendix-B.2.4-3">¶</a>
</div>
<p id="appendix-B.2.4-4">This results in the following Signature-Input and Signature header fields being added to the message under the label <code>sig-b24</code>:<a class="pilcrow" href="#appendix-B.2.4-4">¶</a></p>
<div class="lang-http-message sourcecode" id="appendix-B.2.4-5">
<pre>NOTE: '\' line wrapping per RFC 8792

Signature-Input: sig-b24=("@status" "content-type" \
  "content-digest" "content-length");created=1618884473\
  ;keyid="test-key-ecc-p256"
Signature: sig-b24=:wNmSUAhwb5LxtOtOpNa6W5xj067m5hFrj0XQ4fvpaCLx0NK\
  ocgPquLgyahnzDnDAUy5eCdlYUEkLIj+32oiasw==:
</pre><a class="pilcrow" href="#appendix-B.2.4-5">¶</a>
</div>
<p id="appendix-B.2.4-6">Note that the ECDSA signature algorithm in use here is non-deterministic, meaning that a different signature value will be created every time the algorithm is run. The signature value provided here can be validated against the given keys, but newly generated signature values are not expected to match the example. See <a class="auto internal xref" href="#security-nondeterministic">Section 7.3.5</a>.<a class="pilcrow" href="#appendix-B.2.4-6">¶</a></p>
</section>
</div>
<div id="signing-a-request-using-hmac-sha256">
<section id="appendix-B.2.5">
          <h4 id="name-signing-a-request-using-hma">
<a class="section-number selfRef" href="#appendix-B.2.5">B.2.5. </a><a class="section-name selfRef" href="#name-signing-a-request-using-hma">Signing a Request Using hmac-sha256</a>
          </h4>
<p id="appendix-B.2.5-1">This example covers portions of the <code>test-request</code> message using the <code>hmac-sha256</code> algorithm and the
secret <code>test-shared-secret</code>.<a class="pilcrow" href="#appendix-B.2.5-1">¶</a></p>
<p id="appendix-B.2.5-2">The corresponding signature base is:<a class="pilcrow" href="#appendix-B.2.5-2">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.2.5-3">
<pre>NOTE: '\' line wrapping per RFC 8792

"date": Tue, 20 Apr 2021 02:07:55 GMT
"@authority": example.com
"content-type": application/json
"@signature-params": ("date" "@authority" "content-type")\
  ;created=1618884473;keyid="test-shared-secret"
</pre><a class="pilcrow" href="#appendix-B.2.5-3">¶</a>
</div>
<p id="appendix-B.2.5-4">This results in the following Signature-Input and Signature header fields being added to the message under the label <code>sig-b25</code>:<a class="pilcrow" href="#appendix-B.2.5-4">¶</a></p>
<div class="lang-http-message sourcecode" id="appendix-B.2.5-5">
<pre>NOTE: '\' line wrapping per RFC 8792

Signature-Input: sig-b25=("date" "@authority" "content-type")\
  ;created=1618884473;keyid="test-shared-secret"
Signature: sig-b25=:pxcQw6G3AjtMBQjwo8XzkZf/bws5LelbaMk5rGIGtE8=:
</pre><a class="pilcrow" href="#appendix-B.2.5-5">¶</a>
</div>
<p id="appendix-B.2.5-6">Before using symmetric signatures in practice, see the discussion regarding security trade-offs in <a class="auto internal xref" href="#security-symmetric">Section 7.3.3</a>.<a class="pilcrow" href="#appendix-B.2.5-6">¶</a></p>
</section>
</div>
<div id="signing-a-request-using-ed25519">
<section id="appendix-B.2.6">
          <h4 id="name-signing-a-request-using-ed2">
<a class="section-number selfRef" href="#appendix-B.2.6">B.2.6. </a><a class="section-name selfRef" href="#name-signing-a-request-using-ed2">Signing a Request Using ed25519</a>
          </h4>
<p id="appendix-B.2.6-1">This example covers portions of the <code>test-request</code> message using the <code>Ed25519</code> algorithm
and the key <code>test-key-ed25519</code>.<a class="pilcrow" href="#appendix-B.2.6-1">¶</a></p>
<p id="appendix-B.2.6-2">The corresponding signature base is:<a class="pilcrow" href="#appendix-B.2.6-2">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.2.6-3">
<pre>NOTE: '\' line wrapping per RFC 8792

"date": Tue, 20 Apr 2021 02:07:55 GMT
"@method": POST
"@path": /foo
"@authority": example.com
"content-type": application/json
"content-length": 18
"@signature-params": ("date" "@method" "@path" "@authority" \
  "content-type" "content-length");created=1618884473\
  ;keyid="test-key-ed25519"
</pre><a class="pilcrow" href="#appendix-B.2.6-3">¶</a>
</div>
<p id="appendix-B.2.6-4">This results in the following Signature-Input and Signature header fields being added to the message under the label <code>sig-b26</code>:<a class="pilcrow" href="#appendix-B.2.6-4">¶</a></p>
<div class="lang-http-message sourcecode" id="appendix-B.2.6-5">
<pre>NOTE: '\' line wrapping per RFC 8792

Signature-Input: sig-b26=("date" "@method" "@path" "@authority" \
  "content-type" "content-length");created=1618884473\
  ;keyid="test-key-ed25519"
Signature: sig-b26=:wqcAqbmYJ2ji2glfAMaRy4gruYYnx2nEFN2HN6jrnDnQCK1\
  u02Gb04v9EDgwUPiu4A0w6vuQv5lIp5WPpBKRCw==:
</pre><a class="pilcrow" href="#appendix-B.2.6-5">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="tls-terminating-proxies">
<section id="appendix-B.3">
        <h3 id="name-tls-terminating-proxies">
<a class="section-number selfRef" href="#appendix-B.3">B.3. </a><a class="section-name selfRef" href="#name-tls-terminating-proxies">TLS-Terminating Proxies</a>
        </h3>
<p id="appendix-B.3-1">In this example, there is a TLS-terminating reverse proxy sitting in front of the resource. The client does not sign the request but instead uses mutual TLS to make its call. The terminating proxy validates the TLS stream and injects a Client-Cert header field according to <span>[<a class="cite xref" href="#RFC9440">CLIENT-CERT</a>]</span>, and then applies a signature to this field. By signing this header field, a reverse proxy not only can attest to its own validation of the initial request's TLS parameters but can also authenticate itself to the backend system independently of the client's actions.<a class="pilcrow" href="#appendix-B.3-1">¶</a></p>
<p id="appendix-B.3-2">The client makes the following request to the TLS-terminating proxy using mutual TLS:<a class="pilcrow" href="#appendix-B.3-2">¶</a></p>
<div class="lang-http-message sourcecode" id="appendix-B.3-3">
<pre>POST /foo?param=Value&amp;Pet=dog HTTP/1.1
Host: example.com
Date: Tue, 20 Apr 2021 02:07:55 GMT
Content-Type: application/json
Content-Length: 18

{"hello": "world"}
</pre><a class="pilcrow" href="#appendix-B.3-3">¶</a>
</div>
<p id="appendix-B.3-4">The proxy processes the TLS connection and extracts the client's TLS certificate to a Client-Cert header field and passes it along to the internal service hosted at <code>service.internal.example</code>. This results in the following unsigned request:<a class="pilcrow" href="#appendix-B.3-4">¶</a></p>
<div class="lang-http-message sourcecode" id="appendix-B.3-5">
<pre>NOTE: '\' line wrapping per RFC 8792

POST /foo?param=Value&amp;Pet=dog HTTP/1.1
Host: service.internal.example
Date: Tue, 20 Apr 2021 02:07:55 GMT
Content-Type: application/json
Content-Length: 18
Client-Cert: :MIIBqDCCAU6gAwIBAgIBBzAKBggqhkjOPQQDAjA6MRswGQYDVQQKD\
  BJMZXQncyBBdXRoZW50aWNhdGUxGzAZBgNVBAMMEkxBIEludGVybWVkaWF0ZSBDQT\
  AeFw0yMDAxMTQyMjU1MzNaFw0yMTAxMjMyMjU1MzNaMA0xCzAJBgNVBAMMAkJDMFk\
  wEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE8YnXXfaUgmnMtOXU/IncWalRhebrXmck\
  C8vdgJ1p5Be5F/3YC8OthxM4+k1M6aEAEFcGzkJiNy6J84y7uzo9M6NyMHAwCQYDV\
  R0TBAIwADAfBgNVHSMEGDAWgBRm3WjLa38lbEYCuiCPct0ZaSED2DAOBgNVHQ8BAf\
  8EBAMCBsAwEwYDVR0lBAwwCgYIKwYBBQUHAwIwHQYDVR0RAQH/BBMwEYEPYmRjQGV\
  4YW1wbGUuY29tMAoGCCqGSM49BAMCA0gAMEUCIBHda/r1vaL6G3VliL4/Di6YK0Q6\
  bMjeSkC3dFCOOB8TAiEAx/kHSB4urmiZ0NX5r5XarmPk0wmuydBVoU4hBVZ1yhk=:

{"hello": "world"}
</pre><a class="pilcrow" href="#appendix-B.3-5">¶</a>
</div>
<p id="appendix-B.3-6">Without a signature, the internal service would need to trust that the incoming connection has the right information. By signing the Client-Cert header field and other portions of the internal request, the internal service can be assured that the correct party, the trusted proxy, has processed the request and presented it to the correct service. The proxy's signature base consists of the following:<a class="pilcrow" href="#appendix-B.3-6">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.3-7">
<pre>NOTE: '\' line wrapping per RFC 8792

"@path": /foo
"@query": ?param=Value&amp;Pet=dog
"@method": POST
"@authority": service.internal.example
"client-cert": :MIIBqDCCAU6gAwIBAgIBBzAKBggqhkjOPQQDAjA6MRswGQYDVQQ\
  KDBJMZXQncyBBdXRoZW50aWNhdGUxGzAZBgNVBAMMEkxBIEludGVybWVkaWF0ZSBD\
  QTAeFw0yMDAxMTQyMjU1MzNaFw0yMTAxMjMyMjU1MzNaMA0xCzAJBgNVBAMMAkJDM\
  FkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE8YnXXfaUgmnMtOXU/IncWalRhebrXm\
  ckC8vdgJ1p5Be5F/3YC8OthxM4+k1M6aEAEFcGzkJiNy6J84y7uzo9M6NyMHAwCQY\
  DVR0TBAIwADAfBgNVHSMEGDAWgBRm3WjLa38lbEYCuiCPct0ZaSED2DAOBgNVHQ8B\
  Af8EBAMCBsAwEwYDVR0lBAwwCgYIKwYBBQUHAwIwHQYDVR0RAQH/BBMwEYEPYmRjQ\
  GV4YW1wbGUuY29tMAoGCCqGSM49BAMCA0gAMEUCIBHda/r1vaL6G3VliL4/Di6YK0\
  Q6bMjeSkC3dFCOOB8TAiEAx/kHSB4urmiZ0NX5r5XarmPk0wmuydBVoU4hBVZ1yhk=:
"@signature-params": ("@path" "@query" "@method" "@authority" \
  "client-cert");created=1618884473;keyid="test-key-ecc-p256"
</pre><a class="pilcrow" href="#appendix-B.3-7">¶</a>
</div>
<p id="appendix-B.3-8">This results in the following signature:<a class="pilcrow" href="#appendix-B.3-8">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.3-9">
<pre>NOTE: '\' line wrapping per RFC 8792

xVMHVpawaAC/0SbHrKRs9i8I3eOs5RtTMGCWXm/9nvZzoHsIg6Mce9315T6xoklyy0y\
zhD9ah4JHRwMLOgmizw==
</pre><a class="pilcrow" href="#appendix-B.3-9">¶</a>
</div>
<p id="appendix-B.3-10">which results in the following signed request sent from the proxy to the internal service with the proxy's signature under the label <code>ttrp</code>:<a class="pilcrow" href="#appendix-B.3-10">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.3-11">
<pre>NOTE: '\' line wrapping per RFC 8792

POST /foo?param=Value&amp;Pet=dog HTTP/1.1
Host: service.internal.example
Date: Tue, 20 Apr 2021 02:07:55 GMT
Content-Type: application/json
Content-Length: 18
Client-Cert: :MIIBqDCCAU6gAwIBAgIBBzAKBggqhkjOPQQDAjA6MRswGQYDVQQKD\
  BJMZXQncyBBdXRoZW50aWNhdGUxGzAZBgNVBAMMEkxBIEludGVybWVkaWF0ZSBDQT\
  AeFw0yMDAxMTQyMjU1MzNaFw0yMTAxMjMyMjU1MzNaMA0xCzAJBgNVBAMMAkJDMFk\
  wEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE8YnXXfaUgmnMtOXU/IncWalRhebrXmck\
  C8vdgJ1p5Be5F/3YC8OthxM4+k1M6aEAEFcGzkJiNy6J84y7uzo9M6NyMHAwCQYDV\
  R0TBAIwADAfBgNVHSMEGDAWgBRm3WjLa38lbEYCuiCPct0ZaSED2DAOBgNVHQ8BAf\
  8EBAMCBsAwEwYDVR0lBAwwCgYIKwYBBQUHAwIwHQYDVR0RAQH/BBMwEYEPYmRjQGV\
  4YW1wbGUuY29tMAoGCCqGSM49BAMCA0gAMEUCIBHda/r1vaL6G3VliL4/Di6YK0Q6\
  bMjeSkC3dFCOOB8TAiEAx/kHSB4urmiZ0NX5r5XarmPk0wmuydBVoU4hBVZ1yhk=:
Signature-Input: ttrp=("@path" "@query" "@method" "@authority" \
  "client-cert");created=1618884473;keyid="test-key-ecc-p256"
Signature: ttrp=:xVMHVpawaAC/0SbHrKRs9i8I3eOs5RtTMGCWXm/9nvZzoHsIg6\
  Mce9315T6xoklyy0yzhD9ah4JHRwMLOgmizw==:

{"hello": "world"}
</pre><a class="pilcrow" href="#appendix-B.3-11">¶</a>
</div>
<p id="appendix-B.3-12">The internal service can validate the proxy's signature and therefore be able to trust that the client's certificate has been appropriately processed.<a class="pilcrow" href="#appendix-B.3-12">¶</a></p>
</section>
</div>
<div id="example-transform">
<section id="appendix-B.4">
        <h3 id="name-http-message-transformations">
<a class="section-number selfRef" href="#appendix-B.4">B.4. </a><a class="section-name selfRef" href="#name-http-message-transformations">HTTP Message Transformations</a>
        </h3>
<p id="appendix-B.4-1">HTTP allows intermediaries and applications to transform an HTTP message without affecting the semantics of the message itself. HTTP message signatures are designed to be robust against many of these transformations in different circumstances.<a class="pilcrow" href="#appendix-B.4-1">¶</a></p>
<p id="appendix-B.4-2">For example, the following HTTP request message has been signed using the <code>Ed25519</code> algorithm
and the key <code>test-key-ed25519</code>:<a class="pilcrow" href="#appendix-B.4-2">¶</a></p>
<div class="lang-http-message sourcecode" id="appendix-B.4-3">
<pre>NOTE: '\' line wrapping per RFC 8792

GET /demo?name1=Value1&amp;Name2=value2 HTTP/1.1
Host: example.org
Date: Fri, 15 Jul 2022 14:24:55 GMT
Accept: application/json
Accept: */*
Signature-Input: transform=("@method" "@path" "@authority" \
  "accept");created=1618884473;keyid="test-key-ed25519"
Signature: transform=:ZT1kooQsEHpZ0I1IjCqtQppOmIqlJPeo7DHR3SoMn0s5J\
  Z1eRGS0A+vyYP9t/LXlh5QMFFQ6cpLt2m0pmj3NDA==:
</pre><a class="pilcrow" href="#appendix-B.4-3">¶</a>
</div>
<p id="appendix-B.4-4">The signature base string for this message is:<a class="pilcrow" href="#appendix-B.4-4">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.4-5">
<pre>"@method": GET
"@path": /demo
"@authority": example.org
"accept": application/json, */*
"@signature-params": ("@method" "@path" "@authority" "accept")\
  ;created=1618884473;keyid="test-key-ed25519"
</pre><a class="pilcrow" href="#appendix-B.4-5">¶</a>
</div>
<p id="appendix-B.4-6">The following message has been altered by adding the Accept-Language header field as well as adding a query parameter. However, since neither the Accept-Language header field nor the query is covered by the signature, the same signature is still valid:<a class="pilcrow" href="#appendix-B.4-6">¶</a></p>
<div class="lang-http-message sourcecode" id="appendix-B.4-7">
<pre>NOTE: '\' line wrapping per RFC 8792

GET /demo?name1=Value1&amp;Name2=value2&amp;param=added HTTP/1.1
Host: example.org
Date: Fri, 15 Jul 2022 14:24:55 GMT
Accept: application/json
Accept: */*
Accept-Language: en-US,en;q=0.5
Signature-Input: transform=("@method" "@path" "@authority" \
  "accept");created=1618884473;keyid="test-key-ed25519"
Signature: transform=:ZT1kooQsEHpZ0I1IjCqtQppOmIqlJPeo7DHR3SoMn0s5J\
  Z1eRGS0A+vyYP9t/LXlh5QMFFQ6cpLt2m0pmj3NDA==:
</pre><a class="pilcrow" href="#appendix-B.4-7">¶</a>
</div>
<p id="appendix-B.4-8">The following message has been altered by removing the Date header field, adding a Referer header field, and collapsing the Accept header field into a single line. The Date and Referer header fields are not covered by the signature, and the collapsing of the Accept header field is an allowed transformation that is already accounted for by the canonicalization algorithm for HTTP field values. The same signature is still valid:<a class="pilcrow" href="#appendix-B.4-8">¶</a></p>
<div class="lang-http-message sourcecode" id="appendix-B.4-9">
<pre>NOTE: '\' line wrapping per RFC 8792

GET /demo?name1=Value1&amp;Name2=value2 HTTP/1.1
Host: example.org
Referer: https://developer.example.org/demo
Accept: application/json, */*
Signature-Input: transform=("@method" "@path" "@authority" \
  "accept");created=1618884473;keyid="test-key-ed25519"
Signature: transform=:ZT1kooQsEHpZ0I1IjCqtQppOmIqlJPeo7DHR3SoMn0s5J\
  Z1eRGS0A+vyYP9t/LXlh5QMFFQ6cpLt2m0pmj3NDA==:
</pre><a class="pilcrow" href="#appendix-B.4-9">¶</a>
</div>
<p id="appendix-B.4-10">The following message has been altered by reordering the field values of the original message but not reordering the individual Accept header fields. The same signature is still valid:<a class="pilcrow" href="#appendix-B.4-10">¶</a></p>
<div class="lang-http-message sourcecode" id="appendix-B.4-11">
<pre>NOTE: '\' line wrapping per RFC 8792

GET /demo?name1=Value1&amp;Name2=value2 HTTP/1.1
Accept: application/json
Accept: */*
Date: Fri, 15 Jul 2022 14:24:55 GMT
Host: example.org
Signature-Input: transform=("@method" "@path" "@authority" \
  "accept");created=1618884473;keyid="test-key-ed25519"
Signature: transform=:ZT1kooQsEHpZ0I1IjCqtQppOmIqlJPeo7DHR3SoMn0s5J\
  Z1eRGS0A+vyYP9t/LXlh5QMFFQ6cpLt2m0pmj3NDA==:
</pre><a class="pilcrow" href="#appendix-B.4-11">¶</a>
</div>
<p id="appendix-B.4-12">The following message has been altered by changing the method to POST and the authority to "example.com" (inside the Host header field). Since both the method and authority are covered by the signature, the same signature is NOT still valid:<a class="pilcrow" href="#appendix-B.4-12">¶</a></p>
<div class="lang-http-message sourcecode" id="appendix-B.4-13">
<pre>NOTE: '\' line wrapping per RFC 8792

POST /demo?name1=Value1&amp;Name2=value2 HTTP/1.1
Host: example.com
Date: Fri, 15 Jul 2022 14:24:55 GMT
Accept: application/json
Accept: */*
Signature-Input: transform=("@method" "@path" "@authority" \
  "accept");created=1618884473;keyid="test-key-ed25519"
Signature: transform=:ZT1kooQsEHpZ0I1IjCqtQppOmIqlJPeo7DHR3SoMn0s5J\
  Z1eRGS0A+vyYP9t/LXlh5QMFFQ6cpLt2m0pmj3NDA==:
</pre><a class="pilcrow" href="#appendix-B.4-13">¶</a>
</div>
<p id="appendix-B.4-14">The following message has been altered by changing the order of the two instances of the Accept header field. Since the order of fields with the same name is semantically significant in HTTP, this changes the value used in the signature base, and the same signature is NOT still valid:<a class="pilcrow" href="#appendix-B.4-14">¶</a></p>
<div class="lang-http-message sourcecode" id="appendix-B.4-15">
<pre>NOTE: '\' line wrapping per RFC 8792

GET /demo?name1=Value1&amp;Name2=value2 HTTP/1.1
Host: example.org
Date: Fri, 15 Jul 2022 14:24:55 GMT
Accept: */*
Accept: application/json
Signature-Input: transform=("@method" "@path" "@authority" \
  "accept");created=1618884473;keyid="test-key-ed25519"
Signature: transform=:ZT1kooQsEHpZ0I1IjCqtQppOmIqlJPeo7DHR3SoMn0s5J\
  Z1eRGS0A+vyYP9t/LXlh5QMFFQ6cpLt2m0pmj3NDA==:
</pre><a class="pilcrow" href="#appendix-B.4-15">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="acknowledgements">
<section id="appendix-C">
      <h2 id="name-acknowledgements">
<a class="section-name selfRef" href="#name-acknowledgements">Acknowledgements</a>
      </h2>
<p id="appendix-C-1">This specification was initially based on <span>[<a class="cite xref" href="#I-D.cavage-http-signatures">SIGNING-HTTP-MESSAGES</a>]</span>. The editors would like to thank the authors of <span>[<a class="cite xref" href="#I-D.cavage-http-signatures">SIGNING-HTTP-MESSAGES</a>]</span> -- <span class="contact-name">Mark Cavage</span> and <span class="contact-name">Manu Sporny</span> -- for their work on that Internet-Draft and their continuing contributions. This specification also includes contributions from <span>[<a class="cite xref" href="#SIGNING-HTTP-REQS-OAUTH">SIGNING-HTTP-REQS-OAUTH</a>]</span> and other similar efforts.<a class="pilcrow" href="#appendix-C-1">¶</a></p>
<p id="appendix-C-2">The editors would also like to thank the following individuals (listed in alphabetical order) for feedback, insight, and implementation of this document and its predecessors:
<span class="contact-name">Mark Adamcin</span>,
<span class="contact-name">Mark Allen</span>,
<span class="contact-name">Paul Annesley</span>,
<span class="contact-name">Karl Böhlmark</span>,
<span class="contact-name">Stéphane Bortzmeyer</span>,
<span class="contact-name">Sarven Capadisli</span>,
<span class="contact-name">Liam Dennehy</span>,
<span class="contact-name">Stephen Farrell</span>,
<span class="contact-name">Phillip Hallam-Baker</span>,
<span class="contact-name">Tyler Ham</span>,
<span class="contact-name">Eric Holmes</span>,
<span class="contact-name">Andrey Kislyuk</span>,
<span class="contact-name">Adam Knight</span>,
<span class="contact-name">Dave Lehn</span>,
<span class="contact-name">Ilari Liusvaara</span>,
<span class="contact-name">Dave Longley</span>,
<span class="contact-name">James H. Manger</span>,
<span class="contact-name">Kathleen Moriarty</span>,
<span class="contact-name">Yoav Nir</span>,
<span class="contact-name">Mark Nottingham</span>,
<span class="contact-name">Adrian Palmer</span>,
<span class="contact-name">Lucas Pardue</span>,
<span class="contact-name">Roberto Polli</span>,
<span class="contact-name">Julian Reschke</span>,
<span class="contact-name">Michael Richardson</span>,
<span class="contact-name">Wojciech Rygielski</span>,
<span class="contact-name">Rich Salz</span>,
<span class="contact-name">Adam Scarr</span>,
<span class="contact-name">Cory J. Slep</span>,
<span class="contact-name">Dirk Stein</span>,
<span class="contact-name">Henry Story</span>,
<span class="contact-name">Lukasz Szewc</span>,
<span class="contact-name">Chris Webber</span>, and
<span class="contact-name">Jeffrey Yasskin</span>.<a class="pilcrow" href="#appendix-C-2">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-D">
      <h2 id="name-authors-addresses">
<a class="section-name selfRef" href="#name-authors-addresses">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Annabelle Backman (<span class="role">editor</span>)</span></div>
<div class="left" dir="auto"><span class="org">Amazon</span></div>
<div class="left" dir="auto"><span class="street-address">P.O. Box 81226</span></div>
<div class="left" dir="auto">
<span class="locality">Seattle</span>, <span class="region">WA</span> <span class="postal-code">98108-1226</span>
</div>
<div class="left" dir="auto"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:richanna@amazon.com">richanna@amazon.com</a>
</div>
<div class="url">
<span>URI:</span>
<a class="url" href="https://www.amazon.com/">https://www.amazon.com/</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Justin Richer (<span class="role">editor</span>)</span></div>
<div class="left" dir="auto"><span class="org">Bespoke Engineering</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:ietf@justin.richer.org">ietf@justin.richer.org</a>
</div>
<div class="url">
<span>URI:</span>
<a class="url" href="https://bspk.io/">https://bspk.io/</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Manu Sporny</span></div>
<div class="left" dir="auto"><span class="org">Digital Bazaar</span></div>
<div class="left" dir="auto"><span class="street-address">203 Roanoke Street W.</span></div>
<div class="left" dir="auto">
<span class="locality">Blacksburg</span>, <span class="region">VA</span> <span class="postal-code">24060</span>
</div>
<div class="left" dir="auto"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:msporny@digitalbazaar.com">msporny@digitalbazaar.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>