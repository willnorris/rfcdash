<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 8955: Dissemination of Flow Specification Rules</title>
<meta content="Christoph Loibl" name="author"/>
<meta content="Susan Hares" name="author"/>
<meta content="Robert Raszuk" name="author"/>
<meta content="Danny McPherson" name="author"/>
<meta content="Martin Bacher" name="author"/>
<meta content="
       
  This document defines a Border Gateway Protocol Network Layer
  Reachability Information (BGP NLRI) encoding format that can be used
  to distribute (intra-domain and inter-domain) traffic Flow Specifications
  for IPv4 unicast and IPv4 BGP/MPLS VPN services. This allows the routing
  system to propagate information regarding more specific components of
  the traffic aggregate defined by an IP destination prefix.
       
       
    It also specifies BGP Extended Community encoding formats, which can
    be used to propagate Traffic Filtering Actions along with the Flow
    Specification NLRI.  Those Traffic Filtering Actions encode actions a
    routing system can take if the packet matches the Flow Specification.
       
       
    This document obsoletes both RFC 5575 and RFC 7674.
       
    " name="description"/>
<meta content="xml2rfc 3.5.0" name="generator"/>
<meta content="8955" name="rfc.number"/>
<!-- Generator version information:
  xml2rfc 3.5.0
    Python 3.6.10
    appdirs 1.4.4
    ConfigArgParse 1.2.3
    google-i18n-address 2.3.5
    html5lib 1.0.1
    intervaltree 3.0.2
    Jinja2 2.11.2
    kitchen 1.2.6
    lxml 4.4.2
    pycairo 1.19.0
    pycountry 19.8.18
    pyflakes 2.1.1
    PyYAML 5.3.1
    requests 2.22.0
    setuptools 40.6.2
    six 1.14.0
    WeasyPrint 51
-->
<link href="rfc8955.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://dx.doi.org/10.17487/rfc8955" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <link href="https://datatracker.ietf.org/doc/draft-ietf-idr-rfc5575bis-25" rel="prev"/>
  </head>
<body>
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 8955</td>
<td class="center">Flow Specification</td>
<td class="right">December 2020</td>
</tr></thead>
<tfoot><tr>
<td class="left">Loibl, et al.</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc8955">8955</a></dd>
<dt class="label-obsoletes">Obsoletes:</dt>
<dd class="obsoletes">
<a class="eref" href="https://www.rfc-editor.org/rfc/rfc5575">5575</a>, <a class="eref" href="https://www.rfc-editor.org/rfc/rfc7674">7674</a> </dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2020-12">December 2020</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">C. Loibl</div>
<div class="org">next layer Telekom GmbH</div>
</div>
<div class="author">
      <div class="author-name">S. Hares</div>
<div class="org">Huawei</div>
</div>
<div class="author">
      <div class="author-name">R. Raszuk</div>
<div class="org">NTT Network Innovations</div>
</div>
<div class="author">
      <div class="author-name">D. McPherson</div>
<div class="org">Verisign</div>
</div>
<div class="author">
      <div class="author-name">M. Bacher</div>
<div class="org">T-Mobile Austria</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 8955</h1>
<h1 id="title">Dissemination of Flow Specification Rules</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">
  This document defines a Border Gateway Protocol Network Layer
  Reachability Information (BGP NLRI) encoding format that can be used
  to distribute (intra-domain and inter-domain) traffic Flow Specifications
  for IPv4 unicast and IPv4 BGP/MPLS VPN services. This allows the routing
  system to propagate information regarding more specific components of
  the traffic aggregate defined by an IP destination prefix.<a class="pilcrow" href="#section-abstract-1">¶</a></p>
<p id="section-abstract-2">
    It also specifies BGP Extended Community encoding formats, which can
    be used to propagate Traffic Filtering Actions along with the Flow
    Specification NLRI.  Those Traffic Filtering Actions encode actions a
    routing system can take if the packet matches the Flow Specification.<a class="pilcrow" href="#section-abstract-2">¶</a></p>
<p id="section-abstract-3">
    This document obsoletes both RFC 5575 and RFC 7674.<a class="pilcrow" href="#section-abstract-3">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a class="pilcrow" href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc8955">https://www.rfc-editor.org/info/rfc8955</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2020 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">▲</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.1">
            <p class="keepWithNext" id="section-toc.1-1.1.1"><a class="xref" href="#section-1">1</a>.  <a class="xref" href="#name-introduction">Introduction</a><a class="pilcrow" href="#section-toc.1-1.1.1">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.2">
            <p class="keepWithNext" id="section-toc.1-1.2.1"><a class="xref" href="#section-2">2</a>.  <a class="xref" href="#name-definitions-of-terms-used-i">Definitions of Terms Used in This Memo</a><a class="pilcrow" href="#section-toc.1-1.2.1">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.3">
            <p class="keepWithNext" id="section-toc.1-1.3.1"><a class="xref" href="#section-3">3</a>.  <a class="xref" href="#name-flow-specifications">Flow Specifications</a><a class="pilcrow" href="#section-toc.1-1.3.1">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="xref" href="#section-4">4</a>.  <a class="xref" href="#name-dissemination-of-ipv4-flow-">Dissemination of IPv4 Flow Specification Information</a><a class="pilcrow" href="#section-toc.1-1.4.1">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a class="xref" href="#section-4.1">4.1</a>.  <a class="xref" href="#name-length-encoding">Length Encoding</a><a class="pilcrow" href="#section-toc.1-1.4.2.1.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a class="xref" href="#section-4.2">4.2</a>.  <a class="xref" href="#name-nlri-value-encoding">NLRI Value Encoding</a><a class="pilcrow" href="#section-toc.1-1.4.2.2.1">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a class="xref" href="#section-4.2.1">4.2.1</a>.  <a class="xref" href="#name-operators">Operators</a><a class="pilcrow" href="#section-toc.1-1.4.2.2.2.1.1">¶</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.2.2.2">
                    <p id="section-toc.1-1.4.2.2.2.2.1"><a class="xref" href="#section-4.2.2">4.2.2</a>.  <a class="xref" href="#name-components">Components</a><a class="pilcrow" href="#section-toc.1-1.4.2.2.2.2.1">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.4.2.2.2.2.2.1">
                        <p id="section-toc.1-1.4.2.2.2.2.2.1.1"><a class="xref" href="#section-4.2.2.1">4.2.2.1</a>.  <a class="xref" href="#name-type-1-destination-prefix">Type 1 - Destination Prefix</a><a class="pilcrow" href="#section-toc.1-1.4.2.2.2.2.2.1.1">¶</a></p>
</li>
                      <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.2.2.2.2.2">
                        <p id="section-toc.1-1.4.2.2.2.2.2.2.1"><a class="xref" href="#section-4.2.2.2">4.2.2.2</a>.  <a class="xref" href="#name-type-2-source-prefix">Type 2 - Source Prefix</a><a class="pilcrow" href="#section-toc.1-1.4.2.2.2.2.2.2.1">¶</a></p>
</li>
                      <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.2.2.2.2.3">
                        <p id="section-toc.1-1.4.2.2.2.2.2.3.1"><a class="xref" href="#section-4.2.2.3">4.2.2.3</a>.  <a class="xref" href="#name-type-3-ip-protocol">Type 3 - IP Protocol</a><a class="pilcrow" href="#section-toc.1-1.4.2.2.2.2.2.3.1">¶</a></p>
</li>
                      <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.2.2.2.2.4">
                        <p id="section-toc.1-1.4.2.2.2.2.2.4.1"><a class="xref" href="#section-4.2.2.4">4.2.2.4</a>.  <a class="xref" href="#name-type-4-port">Type 4 - Port</a><a class="pilcrow" href="#section-toc.1-1.4.2.2.2.2.2.4.1">¶</a></p>
</li>
                      <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.2.2.2.2.5">
                        <p id="section-toc.1-1.4.2.2.2.2.2.5.1"><a class="xref" href="#section-4.2.2.5">4.2.2.5</a>.  <a class="xref" href="#name-type-5-destination-port">Type 5 - Destination Port</a><a class="pilcrow" href="#section-toc.1-1.4.2.2.2.2.2.5.1">¶</a></p>
</li>
                      <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.2.2.2.2.6">
                        <p id="section-toc.1-1.4.2.2.2.2.2.6.1"><a class="xref" href="#section-4.2.2.6">4.2.2.6</a>.  <a class="xref" href="#name-type-6-source-port">Type 6 - Source Port</a><a class="pilcrow" href="#section-toc.1-1.4.2.2.2.2.2.6.1">¶</a></p>
</li>
                      <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.2.2.2.2.7">
                        <p id="section-toc.1-1.4.2.2.2.2.2.7.1"><a class="xref" href="#section-4.2.2.7">4.2.2.7</a>.  <a class="xref" href="#name-type-7-icmp-type">Type 7 - ICMP Type</a><a class="pilcrow" href="#section-toc.1-1.4.2.2.2.2.2.7.1">¶</a></p>
</li>
                      <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.2.2.2.2.8">
                        <p id="section-toc.1-1.4.2.2.2.2.2.8.1"><a class="xref" href="#section-4.2.2.8">4.2.2.8</a>.  <a class="xref" href="#name-type-8-icmp-code">Type 8 - ICMP Code</a><a class="pilcrow" href="#section-toc.1-1.4.2.2.2.2.2.8.1">¶</a></p>
</li>
                      <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.2.2.2.2.9">
                        <p id="section-toc.1-1.4.2.2.2.2.2.9.1"><a class="xref" href="#section-4.2.2.9">4.2.2.9</a>.  <a class="xref" href="#name-type-9-tcp-flags">Type 9 - TCP Flags</a><a class="pilcrow" href="#section-toc.1-1.4.2.2.2.2.2.9.1">¶</a></p>
</li>
                      <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.2.2.2.2.10">
                        <p id="section-toc.1-1.4.2.2.2.2.2.10.1"><a class="xref" href="#section-4.2.2.10">4.2.2.10</a>. <a class="xref" href="#name-type-10-packet-length">Type 10 - Packet Length</a><a class="pilcrow" href="#section-toc.1-1.4.2.2.2.2.2.10.1">¶</a></p>
</li>
                      <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.2.2.2.2.11">
                        <p id="section-toc.1-1.4.2.2.2.2.2.11.1"><a class="xref" href="#section-4.2.2.11">4.2.2.11</a>. <a class="xref" href="#name-type-11-dscp-diffserv-code-">Type 11 - DSCP (Diffserv Code Point)</a><a class="pilcrow" href="#section-toc.1-1.4.2.2.2.2.2.11.1">¶</a></p>
</li>
                      <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.2.2.2.2.12">
                        <p id="section-toc.1-1.4.2.2.2.2.2.12.1"><a class="xref" href="#section-4.2.2.12">4.2.2.12</a>. <a class="xref" href="#name-type-12-fragment">Type 12 - Fragment</a><a class="pilcrow" href="#section-toc.1-1.4.2.2.2.2.2.12.1">¶</a></p>
</li>
                    </ul>
</li>
                </ul>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a class="xref" href="#section-4.3">4.3</a>.  <a class="xref" href="#name-examples-of-encodings">Examples of Encodings</a><a class="pilcrow" href="#section-toc.1-1.4.2.3.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="xref" href="#section-5">5</a>.  <a class="xref" href="#name-traffic-filtering">Traffic Filtering</a><a class="pilcrow" href="#section-toc.1-1.5.1">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a class="xref" href="#section-5.1">5.1</a>.  <a class="xref" href="#name-ordering-of-flow-specificat">Ordering of Flow Specifications</a><a class="pilcrow" href="#section-toc.1-1.5.2.1.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="xref" href="#section-6">6</a>.  <a class="xref" href="#name-validation-procedure">Validation Procedure</a><a class="pilcrow" href="#section-toc.1-1.6.1">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="xref" href="#section-7">7</a>.  <a class="xref" href="#name-traffic-filtering-actions">Traffic Filtering Actions</a><a class="pilcrow" href="#section-toc.1-1.7.1">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a class="xref" href="#section-7.1">7.1</a>.  <a class="xref" href="#name-traffic-rate-in-bytes-traff">Traffic Rate in Bytes (traffic-rate-bytes) Sub-Type 0x06</a><a class="pilcrow" href="#section-toc.1-1.7.2.1.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a class="xref" href="#section-7.2">7.2</a>.  <a class="xref" href="#name-traffic-rate-in-packets-tra">Traffic Rate in Packets (traffic-rate-packets) Sub-Type 0x0c</a><a class="pilcrow" href="#section-toc.1-1.7.2.2.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a class="xref" href="#section-7.3">7.3</a>.  <a class="xref" href="#name-traffic-action-traffic-acti">Traffic-Action (traffic-action) Sub-Type 0x07</a><a class="pilcrow" href="#section-toc.1-1.7.2.3.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a class="xref" href="#section-7.4">7.4</a>.  <a class="xref" href="#name-rt-redirect-rt-redirect-sub">RT Redirect (rt-redirect) Sub-Type 0x08</a><a class="pilcrow" href="#section-toc.1-1.7.2.4.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.7.2.5">
                <p id="section-toc.1-1.7.2.5.1"><a class="xref" href="#section-7.5">7.5</a>.  <a class="xref" href="#name-traffic-marking-traffic-mar">Traffic Marking (traffic-marking) Sub-Type 0x09</a><a class="pilcrow" href="#section-toc.1-1.7.2.5.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.7.2.6">
                <p id="section-toc.1-1.7.2.6.1"><a class="xref" href="#section-7.6">7.6</a>.  <a class="xref" href="#name-interaction-with-other-filt">Interaction with Other Filtering Mechanisms in Routers</a><a class="pilcrow" href="#section-toc.1-1.7.2.6.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.7.2.7">
                <p id="section-toc.1-1.7.2.7.1"><a class="xref" href="#section-7.7">7.7</a>.  <a class="xref" href="#name-considerations-on-traffic-f">Considerations on Traffic Filtering Action Interference</a><a class="pilcrow" href="#section-toc.1-1.7.2.7.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="xref" href="#section-8">8</a>.  <a class="xref" href="#name-dissemination-of-traffic-fi">Dissemination of Traffic Filtering in BGP/MPLS VPN Networks</a><a class="pilcrow" href="#section-toc.1-1.8.1">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="xref" href="#section-9">9</a>.  <a class="xref" href="#name-traffic-monitoring">Traffic Monitoring</a><a class="pilcrow" href="#section-toc.1-1.9.1">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a class="xref" href="#section-10">10</a>. <a class="xref" href="#name-error-handling">Error Handling</a><a class="pilcrow" href="#section-toc.1-1.10.1">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a class="xref" href="#section-11">11</a>. <a class="xref" href="#name-iana-considerations">IANA Considerations</a><a class="pilcrow" href="#section-toc.1-1.11.1">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a class="xref" href="#section-11.1">11.1</a>.  <a class="xref" href="#name-afi-safi-definitions">AFI/SAFI Definitions</a><a class="pilcrow" href="#section-toc.1-1.11.2.1.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a class="xref" href="#section-11.2">11.2</a>.  <a class="xref" href="#name-flow-component-definitions">Flow Component Definitions</a><a class="pilcrow" href="#section-toc.1-1.11.2.2.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.11.2.3">
                <p id="section-toc.1-1.11.2.3.1"><a class="xref" href="#section-11.3">11.3</a>.  <a class="xref" href="#name-extended-community-flow-spe">Extended Community Flow Specification Actions</a><a class="pilcrow" href="#section-toc.1-1.11.2.3.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a class="xref" href="#section-12">12</a>. <a class="xref" href="#name-security-considerations">Security Considerations</a><a class="pilcrow" href="#section-toc.1-1.12.1">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a class="xref" href="#section-13">13</a>. <a class="xref" href="#name-references">References</a><a class="pilcrow" href="#section-toc.1-1.13.1">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a class="xref" href="#section-13.1">13.1</a>.  <a class="xref" href="#name-normative-references">Normative References</a><a class="pilcrow" href="#section-toc.1-1.13.2.1.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a class="xref" href="#section-13.2">13.2</a>.  <a class="xref" href="#name-informative-references">Informative References</a><a class="pilcrow" href="#section-toc.1-1.13.2.2.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a class="xref" href="#section-appendix.a">Appendix A</a>.  <a class="xref" href="#name-example-python-code-flow_ru">Example Python code: flow_rule_cmp</a><a class="pilcrow" href="#section-toc.1-1.14.1">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a class="xref" href="#section-appendix.b">Appendix B</a>.  <a class="xref" href="#name-comparison-with-rfc-5575">Comparison with RFC 5575</a><a class="pilcrow" href="#section-toc.1-1.15.1">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a class="xref" href="#section-appendix.c"></a><a class="xref" href="#name-acknowledgments">Acknowledgments</a><a class="pilcrow" href="#section-toc.1-1.16.1">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a class="xref" href="#section-appendix.d"></a><a class="xref" href="#name-contributors">Contributors</a><a class="pilcrow" href="#section-toc.1-1.17.1">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.18">
            <p id="section-toc.1-1.18.1"><a class="xref" href="#section-appendix.e"></a><a class="xref" href="#name-authors-addresses">Authors' Addresses</a><a class="pilcrow" href="#section-toc.1-1.18.1">¶</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="intro">
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">This document obsoletes <span><a class="xref" href="#RFC5575">"Dissemination of Flow Specification Rules"</a> [<a class="xref" href="#RFC5575">RFC5575</a>]</span> (see <a class="xref" href="#rfc5575differences">Appendix B</a> for the
      differences). This document also obsoletes <span><a class="xref" href="#RFC7674">"Clarification of the Flowspec Redirect Extended Community"</a> [<a class="xref" href="#RFC7674">RFC7674</a>]</span>, since it
      incorporates the encoding of the BGP Flow Specification Redirect
      Extended Community in <a class="xref" href="#rt_redirect_action_subtype">Section 7.4</a>.<a class="pilcrow" href="#section-1-1">¶</a></p>
<p id="section-1-2">
    Modern IP routers have the capability to forward traffic
    and to classify, shape, rate limit,
    filter, or redirect packets based on administratively defined
    policies.
    These traffic policy mechanisms allow the operator to define match
    rules that operate on multiple fields of the packet header.  Actions,
    such as the ones described above, can be associated with each rule.<a class="pilcrow" href="#section-1-2">¶</a></p>
<p id="section-1-3">
    The n-tuple consisting of the matching criteria defines an aggregate
    traffic Flow Specification. The matching criteria can include
    elements such as source and destination address prefixes, IP
    protocol, and transport protocol port numbers.<a class="pilcrow" href="#section-1-3">¶</a></p>
<p id="section-1-4"><a class="xref" href="#dissemination_ipv4_flowspec">Section 4</a> of this
      document defines a general procedure to encode Flow Specifications for
      aggregated traffic flows so that they can be distributed as a BGP <span>[<a class="xref" href="#RFC4271">RFC4271</a>]</span> NLRI. Additionally, <a class="xref" href="#traffic_filtering_actions">Section 7</a> of this 
 document defines the required Traffic Filtering Actions BGP Extended
 Communities and mechanisms to use BGP for intra- and inter-provider
 distribution of traffic filtering rules in order to mitigate DoS and 
 DDoS attacks.<a class="pilcrow" href="#section-1-4">¶</a></p>
<p id="section-1-5">
 By expanding routing information with Flow Specifications, the
 routing system can take advantage of the ACL (Access Control List) or
 firewall capabilities in the router's forwarding path.  Flow
 Specifications can be seen as more specific routing entries to a
 unicast prefix and are expected to depend upon the existing unicast
 data information.<a class="pilcrow" href="#section-1-5">¶</a></p>
<p id="section-1-6">A Flow Specification received from an external autonomous system will
      need to be validated against unicast routing before being accepted
      (<a class="xref" href="#validation_procedure">Section 6</a>). The Flow
      Specification received from an internal BGP peer within the same
      autonomous system <span>[<a class="xref" href="#RFC4271">RFC4271</a>]</span> is assumed
      to have been validated prior to transmission within the internal BGP
      (iBGP) mesh of an autonomous system. If the aggregate traffic flow
      defined by the unicast destination prefix is forwarded to a given BGP
      peer, then the local system can install more specific Flow
      Specifications that may result in different forwarding behavior, as
      requested by this system.<a class="pilcrow" href="#section-1-6">¶</a></p>
<p id="section-1-7">From an operational perspective, the utilization of BGP as the
      carrier for this information allows a network service provider to reuse
      both internal route distribution infrastructure (e.g., route reflector
      or confederation design) and existing external relationships (e.g.,
      inter-domain BGP sessions to a customer network).<a class="pilcrow" href="#section-1-7">¶</a></p>
<p id="section-1-8">
   While it is certainly possible to address this problem using other
   mechanisms, this solution has been utilized in deployments because of the
   substantial advantage of being an incremental addition to already
   deployed mechanisms.<a class="pilcrow" href="#section-1-8">¶</a></p>
<p id="section-1-9">
  Possible applications of that extension are:
  Automated inter-domain coordination of traffic filtering, such as what 
  is required in order to mitigate DoS and DDoS attacks
  or traffic filtering in the context of a BGP/MPLS VPN service. Other
  applications (e.g., centralized control of traffic in a
  Software-Defined Networking (SDN) or Network Function Virtualization
  (NFV) context) are also possible.<a class="pilcrow" href="#section-1-9">¶</a></p>
<p id="section-1-10">In current deployments, the information distributed by this
   extension is originated both manually as well as automatically, the
   latter by systems that are able to detect malicious traffic flows.
   When automated systems are used, care should be taken
   to ensure the correctness of the automated system. The
   limitations of the receiving systems that need to process
   these automated Flow Specifications need to be taken in consideration
   as well (see also <a class="xref" href="#security_considerations">Section 12</a>).<a class="pilcrow" href="#section-1-10">¶</a></p>
<p id="section-1-11">
   This specification defines required protocol extensions to address
   most common applications of IPv4 unicast and VPNv4 unicast filtering.
   The same mechanism can be reused and new match criteria added to
   address similar filtering needs for other BGP address families, such as
   IPv6 families <span>[<a class="xref" href="#RFC8956">RFC8956</a>]</span>.<a class="pilcrow" href="#section-1-11">¶</a></p>
</section>
</div>
<section id="section-2">
      <h2 id="name-definitions-of-terms-used-i">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-definitions-of-terms-used-i">Definitions of Terms Used in This Memo</a>
      </h2>
<span class="break"></span><dl class="dlParallel" id="section-2-1">
        <dt id="section-2-1.1">AFI:</dt>
        <dd id="section-2-1.2" style="margin-left: 5.0em">Address Family Identifier<a class="pilcrow" href="#section-2-1.2">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.3">AS:</dt>
        <dd id="section-2-1.4" style="margin-left: 5.0em">Autonomous System<a class="pilcrow" href="#section-2-1.4">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.5">Loc-RIB:</dt>
        <dd id="section-2-1.6" style="margin-left: 5.0em">The Loc-RIB contains the routes that have been selected by the
 local BGP speaker's Decision Process <span>[<a class="xref" href="#RFC4271">RFC4271</a>]</span>.<a class="pilcrow" href="#section-2-1.6">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.7">NLRI:</dt>
        <dd id="section-2-1.8" style="margin-left: 5.0em">Network Layer Reachability Information<a class="pilcrow" href="#section-2-1.8">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.9">PE:</dt>
        <dd id="section-2-1.10" style="margin-left: 5.0em">Provider Edge router<a class="pilcrow" href="#section-2-1.10">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.11">RIB:</dt>
        <dd id="section-2-1.12" style="margin-left: 5.0em">Routing Information Base<a class="pilcrow" href="#section-2-1.12">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.13">SAFI:</dt>
        <dd id="section-2-1.14" style="margin-left: 5.0em">Subsequent Address Family Identifier<a class="pilcrow" href="#section-2-1.14">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.15">VRF:</dt>
        <dd id="section-2-1.16" style="margin-left: 5.0em">Virtual Routing and Forwarding<a class="pilcrow" href="#section-2-1.16">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-2-2">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>",
 "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>",
 "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
 "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document
 are to be interpreted as described in BCP 14 <span>[<a class="xref" href="#RFC2119">RFC2119</a>]</span> <span>[<a class="xref" href="#RFC8174">RFC8174</a>]</span>  when, and only when, they
 appear in all capitals, as shown here.<a class="pilcrow" href="#section-2-2">¶</a></p>
</section>
<section id="section-3">
      <h2 id="name-flow-specifications">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-flow-specifications">Flow Specifications</a>
      </h2>
<p id="section-3-1">A Flow Specification is an n-tuple consisting of several matching
      criteria that can be applied to IP traffic.  A given IP packet is said
      to match the defined Flow Specification if it matches all the specified
      criteria. This n-tuple is encoded into a BGP NLRI defined below.<a class="pilcrow" href="#section-3-1">¶</a></p>
<p id="section-3-2">A given Flow Specification may be associated with a set of
      attributes, depending on the particular application; such attributes may
      or may not include reachability information (i.e., NEXT_HOP).
      Well-known or AS-specific community attributes can be used to encode a
      set of predetermined actions.<a class="pilcrow" href="#section-3-2">¶</a></p>
<p id="section-3-3">A particular application is identified by a specific (Address Family
      Identifier, Subsequent Address Family Identifier (AFI, SAFI)) pair <span>[<a class="xref" href="#RFC4760">RFC4760</a>]</span> and corresponds to a distinct set of
      RIBs.  Those RIBs should be treated independently from each other in
      order to assure noninterference between distinct applications.<a class="pilcrow" href="#section-3-3">¶</a></p>
<p id="section-3-4">BGP itself treats the NLRI as a key to an entry in its databases.
      Entries that are placed in the Loc-RIB are then associated with a given
      set of semantics, which is application dependent.  This is consistent
      with existing BGP applications.  For instance, IP unicast routing
      (AFI=1, SAFI=1) and IP multicast reverse-path information (AFI=1,
      SAFI=2) are handled by BGP without any particular semantics being
      associated with them until installed in the Loc-RIB.<a class="pilcrow" href="#section-3-4">¶</a></p>
<p id="section-3-5">
    Standard BGP policy mechanisms, such as UPDATE filtering by NLRI
    prefix as well as community matching, must apply to
    the Flow specification defined NLRI-type.
    Network operators can also control propagation of such
    routing updates by enabling or disabling the exchange of a particular
    (AFI, SAFI) pair on a given BGP peering session.<a class="pilcrow" href="#section-3-5">¶</a></p>
</section>
<div id="dissemination_ipv4_flowspec">
<section id="section-4">
      <h2 id="name-dissemination-of-ipv4-flow-">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-dissemination-of-ipv4-flow-">Dissemination of IPv4 Flow Specification Information</a>
      </h2>
<p id="section-4-1">This document defines a Flow Specification NLRI type (<a class="xref" href="#fs_nlri">Figure 1</a>) that may include several components,
      such as destination prefix, source prefix, protocol, ports, and others
      (see <a class="xref" href="#nlri_value_encoding">Section 4.2</a> below).<a class="pilcrow" href="#section-4-1">¶</a></p>
<p id="section-4-2">This NLRI information is encoded using MP_REACH_NLRI and
      MP_UNREACH_NLRI attributes, as defined in  <span>[<a class="xref" href="#RFC4760">RFC4760</a>]</span>. When advertising Flow Specifications, the Length of the
      Next-Hop Network Address <span class="bcp14">MUST</span> be set to 0. The Network
      Address of the Next-Hop field <span class="bcp14">MUST</span> be ignored.<a class="pilcrow" href="#section-4-2">¶</a></p>
<p id="section-4-3">The NLRI field of the MP_REACH_NLRI and MP_UNREACH_NLRI is encoded as
      one or more 2-tuples of the form &lt;length, NLRI value&gt;. It consists
      of a 1- or 2-octet length field followed by a variable-length NLRI
      value. The length is expressed in octets.<a class="pilcrow" href="#section-4-3">¶</a></p>
<span id="name-flow-specification-nlri-for"></span><div id="fs_nlri">
<figure id="figure-1">
        <div class="artwork art-text alignLeft" id="section-4-4.1">
<pre>                  +-------------------------------+
                  |    length (0xnn or 0xfnnn)    |
                  +-------------------------------+
                  |    NLRI value   (variable)    |
                  +-------------------------------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-1">Figure 1</a>:
<a class="selfRef" href="#name-flow-specification-nlri-for">Flow Specification NLRI for IPv4</a>
        </figcaption></figure>
</div>
<p id="section-4-5">Implementations wishing to exchange Flow Specification
      <span class="bcp14">MUST</span> use BGP's Capability Advertisement facility to
      exchange the Multiprotocol Extension Capability Code (Code 1), as defined
      in <span>[<a class="xref" href="#RFC4760">RFC4760</a>]</span>. The (AFI, SAFI) pair
      carried in the Multiprotocol Extension Capability <span class="bcp14">MUST</span> be
      (AFI=1, SAFI=133) for IPv4 Flow Specification and (AFI=1, SAFI=134) for
      VPNv4 Flow Specification.<a class="pilcrow" href="#section-4-5">¶</a></p>
<section id="section-4.1">
        <h3 id="name-length-encoding">
<a class="section-number selfRef" href="#section-4.1">4.1. </a><a class="section-name selfRef" href="#name-length-encoding">Length Encoding</a>
        </h3>
<p id="section-4.1-1">
   The length field indicates the length in octets of the variable NLRI value:<a class="pilcrow" href="#section-4.1-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-2.1">If the NLRI length is smaller than 240 (0xf0 hex) octets, the
   length field can be encoded as a single octet.<a class="pilcrow" href="#section-4.1-2.1">¶</a>
</li>
          <li class="normal" id="section-4.1-2.2">Otherwise, it is encoded as an extended-length 2-octet value in
   which the most significant nibble has the hex value 0xf.<a class="pilcrow" href="#section-4.1-2.2">¶</a>
</li>
        </ul>
<p id="section-4.1-3">In <a class="xref" href="#fs_nlri">Figure 1</a> above, values
 less than 240 are encoded using two hex digits (0xnn).  Values above
 239 are encoded using 3 hex digits (0xfnnn).  The highest value that
 can be represented with this encoding is 4095. For example, the length
 value of 239 is encoded as 0xef (single octet), while 240 is encoded as
 0xf0f0 (2 octets).<a class="pilcrow" href="#section-4.1-3">¶</a></p>
</section>
<div id="nlri_value_encoding">
<section id="section-4.2">
        <h3 id="name-nlri-value-encoding">
<a class="section-number selfRef" href="#section-4.2">4.2. </a><a class="section-name selfRef" href="#name-nlri-value-encoding">NLRI Value Encoding</a>
        </h3>
<p id="section-4.2-1">
    The Flow Specification NLRI value consists of a list of optional
   components and is encoded as follows:<a class="pilcrow" href="#section-4.2-1">¶</a></p>
<p id="section-4.2-2">Encoding: &lt;[component]+&gt;<a class="pilcrow" href="#section-4.2-2">¶</a></p>
<p id="section-4.2-3">A specific packet is considered to match the Flow Specification
 when it matches the intersection (AND) of all the components present
 in the Flow Specification.<a class="pilcrow" href="#section-4.2-3">¶</a></p>
<p id="section-4.2-4">Components <span class="bcp14">MUST</span> follow strict type ordering by
 increasing numerical order. A given component type <span class="bcp14">MAY</span>
 (exactly once) be present in the Flow Specification. If present, it
 <span class="bcp14">MUST</span> precede any component of higher numeric type
 value.<a class="pilcrow" href="#section-4.2-4">¶</a></p>
<p id="section-4.2-5">All combinations of components within a single Flow Specification
 are allowed. However, some combinations cannot match any packets
 (e.g., "ICMP Type AND Port" will never match any packets) and thus
 <span class="bcp14">SHOULD NOT</span> be propagated by BGP.<a class="pilcrow" href="#section-4.2-5">¶</a></p>
<p id="section-4.2-6">An NLRI value not encoded as specified here, including an NLRI that
        contains an unknown component type, is considered malformed
 and error handling according to <a class="xref" href="#errorhandling">Section 10</a> is performed.<a class="pilcrow" href="#section-4.2-6">¶</a></p>
<div id="operators">
<section id="section-4.2.1">
          <h4 id="name-operators">
<a class="section-number selfRef" href="#section-4.2.1">4.2.1. </a><a class="section-name selfRef" href="#name-operators">Operators</a>
          </h4>
<p id="section-4.2.1-1">Most of the components described below make use of comparison
   operators. Which of the two operators is used is defined by the
   components in <a class="xref" href="#flowspec_components">Section 4.2.2</a>. The operators are encoded as a single octet.<a class="pilcrow" href="#section-4.2.1-1">¶</a></p>
<div id="numeric_operator">
<section id="section-4.2.1.1">
            <h5 id="name-numeric-operator-numeric_op">
<a class="section-number selfRef" href="#section-4.2.1.1">4.2.1.1. </a><a class="section-name selfRef" href="#name-numeric-operator-numeric_op">Numeric Operator (numeric_op)</a>
            </h5>
<p id="section-4.2.1.1-1">This operator is encoded as shown in <a class="xref" href="#figure_numeric_operator">Figure 2</a>.<a class="pilcrow" href="#section-4.2.1.1-1">¶</a></p>
<span id="name-numeric-operator-numeric_op-2"></span><div id="figure_numeric_operator">
<figure id="figure-2">
              <div class="artwork art-text alignLeft" id="section-4.2.1.1-2.1">
<pre>                    0   1   2   3   4   5   6   7
                  +---+---+---+---+---+---+---+---+
                  | e | a |  len  | 0 |lt |gt |eq |
                  +---+---+---+---+---+---+---+---+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-2">Figure 2</a>:
<a class="selfRef" href="#name-numeric-operator-numeric_op-2">Numeric Operator (numeric_op)</a>
              </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.2.1.1-3">
              <dt id="section-4.2.1.1-3.1">e (end-of-list bit):</dt>
              <dd id="section-4.2.1.1-3.2" style="margin-left: 3.0em">Set in the last {op, value} pair in the list<a class="pilcrow" href="#section-4.2.1.1-3.2">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-4.2.1.1-3.3">a (AND bit):</dt>
              <dd id="section-4.2.1.1-3.4" style="margin-left: 3.0em">If unset, the result of the previous {op, value}
       pair is logically ORed with the current one.  If set, the
       operation is a logical AND. In the first operator octet of a
       sequence, it <span class="bcp14">MUST</span> be encoded as unset and
       <span class="bcp14">MUST</span> be treated as always unset on decoding. The
       AND operator has higher priority than OR for the purposes of
       evaluating logical expressions.<a class="pilcrow" href="#section-4.2.1.1-3.4">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-4.2.1.1-3.5">len (length):</dt>
              <dd id="section-4.2.1.1-3.6" style="margin-left: 3.0em">The length of the value field for this operator
       given as (1 &lt;&lt; len). This encodes 1 (len=00), 2 (len=01),
       4 (len=10), and 8 (len=11) octets.<a class="pilcrow" href="#section-4.2.1.1-3.6">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-4.2.1.1-3.7">0:</dt>
              <dd id="section-4.2.1.1-3.8" style="margin-left: 3.0em">
                <span class="bcp14">MUST</span> be set to 0 on NLRI encoding and
       <span class="bcp14">MUST</span> be ignored during decoding<a class="pilcrow" href="#section-4.2.1.1-3.8">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-4.2.1.1-3.9">lt:</dt>
              <dd id="section-4.2.1.1-3.10" style="margin-left: 3.0em">less-than comparison between data and value<a class="pilcrow" href="#section-4.2.1.1-3.10">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-4.2.1.1-3.11">gt:</dt>
              <dd id="section-4.2.1.1-3.12" style="margin-left: 3.0em">greater-than comparison between data and value<a class="pilcrow" href="#section-4.2.1.1-3.12">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-4.2.1.1-3.13">eq:</dt>
              <dd id="section-4.2.1.1-3.14" style="margin-left: 3.0em">equality between data and value<a class="pilcrow" href="#section-4.2.1.1-3.14">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
<p id="section-4.2.1.1-4">The bits lt, gt, and eq can be combined to produce common
     relational operators, such as "less or equal", "greater or equal",
     and "not equal to", as shown in <a class="xref" href="#table_comparison_operator">Table 1</a>.<a class="pilcrow" href="#section-4.2.1.1-4">¶</a></p>
<span id="name-comparison-operation-combin"></span><div id="table_comparison_operator">
<table class="center" id="table-1">
              <caption>
<a class="selfRef" href="#table-1">Table 1</a>:
<a class="selfRef" href="#name-comparison-operation-combin">Comparison Operation Combinations</a>
              </caption>
<thead>
                <tr>
                  <th class="text-center" colspan="1" rowspan="1">lt</th>
                  <th class="text-center" colspan="1" rowspan="1">gt</th>
                  <th class="text-center" colspan="1" rowspan="1">eq</th>
                  <th class="text-left" colspan="1" rowspan="1">Resulting operation</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-center" colspan="1" rowspan="1">0</td>
                  <td class="text-center" colspan="1" rowspan="1">0</td>
                  <td class="text-center" colspan="1" rowspan="1">0</td>
                  <td class="text-left" colspan="1" rowspan="1"> false (independent of the value)</td>
                </tr>
                <tr>
                  <td class="text-center" colspan="1" rowspan="1">0</td>
                  <td class="text-center" colspan="1" rowspan="1">0</td>
                  <td class="text-center" colspan="1" rowspan="1">1</td>
                  <td class="text-left" colspan="1" rowspan="1"> == (equal) </td>
                </tr>
                <tr>
                  <td class="text-center" colspan="1" rowspan="1">0</td>
                  <td class="text-center" colspan="1" rowspan="1">1</td>
                  <td class="text-center" colspan="1" rowspan="1">0</td>
                  <td class="text-left" colspan="1" rowspan="1"> &gt; (greater than) </td>
                </tr>
                <tr>
                  <td class="text-center" colspan="1" rowspan="1">0</td>
                  <td class="text-center" colspan="1" rowspan="1">1</td>
                  <td class="text-center" colspan="1" rowspan="1">1</td>
                  <td class="text-left" colspan="1" rowspan="1"> &gt;= (greater than or equal)</td>
                </tr>
                <tr>
                  <td class="text-center" colspan="1" rowspan="1">1</td>
                  <td class="text-center" colspan="1" rowspan="1">0</td>
                  <td class="text-center" colspan="1" rowspan="1">0</td>
                  <td class="text-left" colspan="1" rowspan="1"> &lt; (less than)</td>
                </tr>
                <tr>
                  <td class="text-center" colspan="1" rowspan="1">1</td>
                  <td class="text-center" colspan="1" rowspan="1">0</td>
                  <td class="text-center" colspan="1" rowspan="1">1</td>
                  <td class="text-left" colspan="1" rowspan="1"> &lt;= (less than or equal)</td>
                </tr>
                <tr>
                  <td class="text-center" colspan="1" rowspan="1">1</td>
                  <td class="text-center" colspan="1" rowspan="1">1</td>
                  <td class="text-center" colspan="1" rowspan="1">0</td>
                  <td class="text-left" colspan="1" rowspan="1"> != (not equal value)</td>
                </tr>
                <tr>
                  <td class="text-center" colspan="1" rowspan="1">1</td>
                  <td class="text-center" colspan="1" rowspan="1">1</td>
                  <td class="text-center" colspan="1" rowspan="1">1</td>
                  <td class="text-left" colspan="1" rowspan="1"> true (independent of the value)</td>
                </tr>
              </tbody>
            </table>
</div>
</section>
</div>
<div id="bitmask_operator">
<section id="section-4.2.1.2">
            <h5 id="name-bitmask-operator-bitmask_op">
<a class="section-number selfRef" href="#section-4.2.1.2">4.2.1.2. </a><a class="section-name selfRef" href="#name-bitmask-operator-bitmask_op">Bitmask Operator (bitmask_op)</a>
            </h5>
<p id="section-4.2.1.2-1">This operator is encoded as shown in <a class="xref" href="#figure_bitmask_operator">Figure 3</a>.<a class="pilcrow" href="#section-4.2.1.2-1">¶</a></p>
<span id="name-bitmask-operator-bitmask_op-2"></span><div id="figure_bitmask_operator">
<figure id="figure-3">
              <div class="artwork art-text alignLeft" id="section-4.2.1.2-2.1">
<pre>                    0   1   2   3   4   5   6   7
                  +---+---+---+---+---+---+---+---+
                  | e | a |  len  | 0 | 0 |not| m |
                  +---+---+---+---+---+---+---+---+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-3">Figure 3</a>:
<a class="selfRef" href="#name-bitmask-operator-bitmask_op-2">Bitmask Operator (bitmask_op)</a>
              </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.2.1.2-3">
              <dt id="section-4.2.1.2-3.1">e, a, len (end-of-list bit, AND bit, and
       length field):</dt>
              <dd id="section-4.2.1.2-3.2" style="margin-left: 3.0em">Most significant nibble; defined in the Numeric Operator format in
       <a class="xref" href="#numeric_operator">Section 4.2.1.1</a>.<a class="pilcrow" href="#section-4.2.1.2-3.2">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-4.2.1.2-3.3">not (NOT bit):</dt>
              <dd id="section-4.2.1.2-3.4" style="margin-left: 3.0em">If set, logical negation of operation.<a class="pilcrow" href="#section-4.2.1.2-3.4">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-4.2.1.2-3.5">m (Match bit):</dt>
              <dd id="section-4.2.1.2-3.6" style="margin-left: 3.0em">If set, this is a bitwise match operation defined as "(data
       AND value) == value"; if unset, (data AND value) evaluates to
       TRUE if any of the bits in the value mask are set in the
       data.<a class="pilcrow" href="#section-4.2.1.2-3.6">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-4.2.1.2-3.7">0 (all 0 bits):</dt>
              <dd id="section-4.2.1.2-3.8" style="margin-left: 3.0em">
                <span class="bcp14">MUST</span> be set to 0 on NLRI encoding and
       <span class="bcp14">MUST</span> be ignored during decoding<a class="pilcrow" href="#section-4.2.1.2-3.8">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="flowspec_components">
<section id="section-4.2.2">
          <h4 id="name-components">
<a class="section-number selfRef" href="#section-4.2.2">4.2.2. </a><a class="section-name selfRef" href="#name-components">Components</a>
          </h4>
<p id="section-4.2.2-1">
     The encoding of each of the components begins with a type field
     (1 octet) followed by a variable length parameter. The following sections
     define component types and parameter encodings for the IPv4 IP layer and
     transport layer headers. IPv6 NLRI component types are described
     in <span>[<a class="xref" href="#RFC8956">RFC8956</a>]</span>.<a class="pilcrow" href="#section-4.2.2-1">¶</a></p>
<div id="type_1">
<section id="section-4.2.2.1">
            <h5 id="name-type-1-destination-prefix">
<a class="section-number selfRef" href="#section-4.2.2.1">4.2.2.1. </a><a class="section-name selfRef" href="#name-type-1-destination-prefix">Type 1 - Destination Prefix</a>
            </h5>
<p id="section-4.2.2.1-1">Encoding: &lt;type (1 octet), length (1 octet), prefix
     (variable)&gt;<a class="pilcrow" href="#section-4.2.2.1-1">¶</a></p>
<p id="section-4.2.2.1-2">Defines the destination prefix to match. The length and prefix
     fields are encoded as in BGP UPDATE messages <span>[<a class="xref" href="#RFC4271">RFC4271</a>]</span>.<a class="pilcrow" href="#section-4.2.2.1-2">¶</a></p>
</section>
</div>
<div id="type_2">
<section id="section-4.2.2.2">
            <h5 id="name-type-2-source-prefix">
<a class="section-number selfRef" href="#section-4.2.2.2">4.2.2.2. </a><a class="section-name selfRef" href="#name-type-2-source-prefix">Type 2 - Source Prefix</a>
            </h5>
<p id="section-4.2.2.2-1">Encoding: &lt;type (1 octet), length (1 octet), prefix (variable)&gt;<a class="pilcrow" href="#section-4.2.2.2-1">¶</a></p>
<p id="section-4.2.2.2-2">Defines the source prefix to match. The length and prefix
     fields are encoded as in BGP UPDATE messages <span>[<a class="xref" href="#RFC4271">RFC4271</a>]</span>.<a class="pilcrow" href="#section-4.2.2.2-2">¶</a></p>
</section>
</div>
<div id="type_3">
<section id="section-4.2.2.3">
            <h5 id="name-type-3-ip-protocol">
<a class="section-number selfRef" href="#section-4.2.2.3">4.2.2.3. </a><a class="section-name selfRef" href="#name-type-3-ip-protocol">Type 3 - IP Protocol</a>
            </h5>
<p id="section-4.2.2.3-1">Encoding: &lt;type (1 octet), [numeric_op, value]+&gt;<a class="pilcrow" href="#section-4.2.2.3-1">¶</a></p>
<p id="section-4.2.2.3-2">Contains a list of {numeric_op, value} pairs that are used to
     match the IP protocol value octet in IP packet header (see <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc791#section-3.1">Section 3.1</a> of [<a class="xref" href="#RFC0791">RFC0791</a>]</span>).<a class="pilcrow" href="#section-4.2.2.3-2">¶</a></p>
<p id="section-4.2.2.3-3">This component uses the Numeric Operator (numeric_op) described
     in <a class="xref" href="#numeric_operator">Section 4.2.1.1</a>. Type 3
     component values <span class="bcp14">SHOULD</span> be encoded as single octet
     (numeric_op len=00).<a class="pilcrow" href="#section-4.2.2.3-3">¶</a></p>
</section>
</div>
<div id="type_4">
<section id="section-4.2.2.4">
            <h5 id="name-type-4-port">
<a class="section-number selfRef" href="#section-4.2.2.4">4.2.2.4. </a><a class="section-name selfRef" href="#name-type-4-port">Type 4 - Port</a>
            </h5>
<p id="section-4.2.2.4-1">Encoding: &lt;type (1 octet), [numeric_op, value]+&gt;<a class="pilcrow" href="#section-4.2.2.4-1">¶</a></p>
<p id="section-4.2.2.4-2">Defines a list of {numeric_op, value} pairs that match source
     OR destination TCP/UDP ports (see <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc793#section-3.1">Section 3.1</a> of [<a class="xref" href="#RFC0793">RFC0793</a>]</span> and the "Format" section of
     <span>[<a class="xref" href="#RFC0768">RFC0768</a>]</span>). This component matches
     if 
     either the destination port OR the source port of an IP packet
     matches the value.<a class="pilcrow" href="#section-4.2.2.4-2">¶</a></p>
<p id="section-4.2.2.4-3">This component uses the Numeric Operator (numeric_op) described
     in <a class="xref" href="#numeric_operator">Section 4.2.1.1</a>. Type 4
     component values <span class="bcp14">SHOULD</span> be encoded as 1- or 2-octet
     quantities (numeric_op len=00 or len=01).<a class="pilcrow" href="#section-4.2.2.4-3">¶</a></p>
<p id="section-4.2.2.4-4">In case of the presence of the port (destination-port (<a class="xref" href="#type_5">Section 4.2.2.5</a>), source-port (<a class="xref" href="#type_6">Section 4.2.2.6</a>)) component, only TCP or UDP
     packets can match the entire Flow Specification. The port
     component, if present, never matches when the packet's IP protocol
     value is not 6 (TCP) or 17 (UDP), if the packet is fragmented and
     this is not the first fragment, or if the system is unable to
     locate the transport header. Different implementations may or may
     not be able to decode the transport header in the presence of IP
     options or Encapsulating Security Payload (ESP) NULL <span>[<a class="xref" href="#RFC4303">RFC4303</a>]</span> encryption.<a class="pilcrow" href="#section-4.2.2.4-4">¶</a></p>
</section>
</div>
<div id="type_5">
<section id="section-4.2.2.5">
            <h5 id="name-type-5-destination-port">
<a class="section-number selfRef" href="#section-4.2.2.5">4.2.2.5. </a><a class="section-name selfRef" href="#name-type-5-destination-port">Type 5 - Destination Port</a>
            </h5>
<p id="section-4.2.2.5-1">Encoding: &lt;type (1 octet), [numeric_op, value]+&gt;<a class="pilcrow" href="#section-4.2.2.5-1">¶</a></p>
<p id="section-4.2.2.5-2"> Defines a list of {numeric_op, value} pairs used to match the
     destination port of a TCP or UDP packet (see also <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc793#section-3.1">Section 3.1</a> of [<a class="xref" href="#RFC0793">RFC0793</a>]</span> and the
     "Format" section of <span>[<a class="xref" href="#RFC0768">RFC0768</a>]</span>.<a class="pilcrow" href="#section-4.2.2.5-2">¶</a></p>
<p id="section-4.2.2.5-3">This component uses the Numeric Operator (numeric_op) described
     in <a class="xref" href="#numeric_operator">Section 4.2.1.1</a>. Type 5
     component values <span class="bcp14">SHOULD</span> be encoded as 1- or 2-octet
     quantities (numeric_op len=00 or len=01).<a class="pilcrow" href="#section-4.2.2.5-3">¶</a></p>
<p id="section-4.2.2.5-4">The last paragraph of <a class="xref" href="#type_4">Section 4.2.2.4</a>
     also applies to this component.<a class="pilcrow" href="#section-4.2.2.5-4">¶</a></p>
</section>
</div>
<div id="type_6">
<section id="section-4.2.2.6">
            <h5 id="name-type-6-source-port">
<a class="section-number selfRef" href="#section-4.2.2.6">4.2.2.6. </a><a class="section-name selfRef" href="#name-type-6-source-port">Type 6 - Source Port</a>
            </h5>
<p id="section-4.2.2.6-1">Encoding: &lt;type (1 octet), [numeric_op, value]+&gt;<a class="pilcrow" href="#section-4.2.2.6-1">¶</a></p>
<p id="section-4.2.2.6-2">Defines a list of {numeric_op, value} pairs used to match the
     source port of a TCP or UDP packet (see also <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc793#section-3.1">Section 3.1</a> of [<a class="xref" href="#RFC0793">RFC0793</a>]</span> and the
     "Format" section of <span>[<a class="xref" href="#RFC0768">RFC0768</a>]</span>.<a class="pilcrow" href="#section-4.2.2.6-2">¶</a></p>
<p id="section-4.2.2.6-3">This component uses the Numeric Operator (numeric_op) described
     in <a class="xref" href="#numeric_operator">Section 4.2.1.1</a>. Type 6
     component values <span class="bcp14">SHOULD</span> be encoded as 1- or 2-octet
     quantities (numeric_op len=00 or len=01).<a class="pilcrow" href="#section-4.2.2.6-3">¶</a></p>
<p id="section-4.2.2.6-4">The last paragraph of <a class="xref" href="#type_4">Section 4.2.2.4</a>
     also applies to this component.<a class="pilcrow" href="#section-4.2.2.6-4">¶</a></p>
</section>
</div>
<div id="type_7">
<section id="section-4.2.2.7">
            <h5 id="name-type-7-icmp-type">
<a class="section-number selfRef" href="#section-4.2.2.7">4.2.2.7. </a><a class="section-name selfRef" href="#name-type-7-icmp-type">Type 7 - ICMP Type</a>
            </h5>
<p id="section-4.2.2.7-1">Encoding: &lt;type (1 octet), [numeric_op, value]+&gt;<a class="pilcrow" href="#section-4.2.2.7-1">¶</a></p>
<p id="section-4.2.2.7-2">Defines a list of {numeric_op, value} pairs used to match the
     type field of an ICMP packet (see also the "Message Formats"
     section of <span>[<a class="xref" href="#RFC0792">RFC0792</a>]</span>).<a class="pilcrow" href="#section-4.2.2.7-2">¶</a></p>
<p id="section-4.2.2.7-3">This component uses the Numeric Operator (numeric_op) described
     in <a class="xref" href="#numeric_operator">Section 4.2.1.1</a>. Type 7
     component values <span class="bcp14">SHOULD</span> be encoded as single octet
     (numeric_op len=00).<a class="pilcrow" href="#section-4.2.2.7-3">¶</a></p>
<p id="section-4.2.2.7-4">
    In case of the presence of the ICMP type
    component, only ICMP packets can match the entire Flow Specification.
    The ICMP type component, if present, never matches when the packet's IP
    protocol value is not 1 (ICMP), if the packet is fragmented
    and this is not the first fragment, or if the system is unable to
    locate the transport header. Different implementations may or may not be
    able to decode the transport header in the presence of IP
    options or Encapsulating Security Payload (ESP) NULL
    <span>[<a class="xref" href="#RFC4303">RFC4303</a>]</span> encryption.<a class="pilcrow" href="#section-4.2.2.7-4">¶</a></p>
</section>
</div>
<div id="type_8">
<section id="section-4.2.2.8">
            <h5 id="name-type-8-icmp-code">
<a class="section-number selfRef" href="#section-4.2.2.8">4.2.2.8. </a><a class="section-name selfRef" href="#name-type-8-icmp-code">Type 8 - ICMP Code</a>
            </h5>
<p id="section-4.2.2.8-1">Encoding: &lt;type (1 octet), [numeric_op, value]+&gt;<a class="pilcrow" href="#section-4.2.2.8-1">¶</a></p>
<p id="section-4.2.2.8-2">Defines a list of {numeric_op, value} pairs used to match the
     code field of an ICMP packet (see also the "Message Formats"
     section of <span>[<a class="xref" href="#RFC0792">RFC0792</a>]</span>).<a class="pilcrow" href="#section-4.2.2.8-2">¶</a></p>
<p id="section-4.2.2.8-3">This component uses the Numeric Operator (numeric_op) described
     in <a class="xref" href="#numeric_operator">Section 4.2.1.1</a>. Type 8
     component values <span class="bcp14">SHOULD</span> be encoded as single octet
     (numeric_op len=00).<a class="pilcrow" href="#section-4.2.2.8-3">¶</a></p>
<p id="section-4.2.2.8-4">
    In case of the presence of the ICMP code
    component, only ICMP packets can match the entire Flow Specification.
    The ICMP code component, if present, never matches when the packet's IP
    protocol value is not 1 (ICMP), if the packet is fragmented
    and this is not the first fragment, or if the system is unable to
    locate the transport header. Different implementations may or may not be
    able to decode the transport header in the presence of IP
    options or Encapsulating Security Payload (ESP) NULL
    <span>[<a class="xref" href="#RFC4303">RFC4303</a>]</span> encryption.<a class="pilcrow" href="#section-4.2.2.8-4">¶</a></p>
</section>
</div>
<div id="type_9">
<section id="section-4.2.2.9">
            <h5 id="name-type-9-tcp-flags">
<a class="section-number selfRef" href="#section-4.2.2.9">4.2.2.9. </a><a class="section-name selfRef" href="#name-type-9-tcp-flags">Type 9 - TCP Flags</a>
            </h5>
<p id="section-4.2.2.9-1">Encoding: &lt;type (1 octet), [bitmask_op, bitmask]+&gt;<a class="pilcrow" href="#section-4.2.2.9-1">¶</a></p>
<p id="section-4.2.2.9-2">Defines a list of {bitmask_op, bitmask} pairs used to match TCP
     control bits (see also <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc793#section-3.1">Section 3.1</a> of [<a class="xref" href="#RFC0793">RFC0793</a>]</span>).<a class="pilcrow" href="#section-4.2.2.9-2">¶</a></p>
<p id="section-4.2.2.9-3">This component uses the Bitmask Operator (bitmask_op) described
     in <a class="xref" href="#bitmask_operator">Section 4.2.1.2</a>. Type 9
     component bitmasks <span class="bcp14">MUST</span> be encoded as 1- or 2-octet
     bitmask (bitmask_op len=00 or len=01).<a class="pilcrow" href="#section-4.2.2.9-3">¶</a></p>
<p id="section-4.2.2.9-4">When a single octet (bitmask_op len=00) is specified, it
     matches octet 14 of the TCP header (see also <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc793#section-3.1">Section 3.1</a> of [<a class="xref" href="#RFC0793">RFC0793</a>]</span>), which
     contains the TCP control bits. When a 2-octet (bitmask_op len=01)
     encoding is used, it matches octets 13 and 14 of the TCP header
     with the data offset (leftmost 4 bits) always treated as 0.<a class="pilcrow" href="#section-4.2.2.9-4">¶</a></p>
<p id="section-4.2.2.9-5">
    In case of the presence of the TCP flags
    component, only TCP packets can match the entire Flow Specification.
    The TCP flags component, if present, never matches when the packet's IP
    protocol value is not 6 (TCP), if the packet is fragmented
    and this is not the first fragment, or if the system is unable to
    locate the transport header. Different implementations may or may not be
    able to decode the transport header in the presence of IP
    options or Encapsulating Security Payload (ESP) NULL
    <span>[<a class="xref" href="#RFC4303">RFC4303</a>]</span> encryption.<a class="pilcrow" href="#section-4.2.2.9-5">¶</a></p>
</section>
</div>
<div id="type_10">
<section id="section-4.2.2.10">
            <h5 id="name-type-10-packet-length">
<a class="section-number selfRef" href="#section-4.2.2.10">4.2.2.10. </a><a class="section-name selfRef" href="#name-type-10-packet-length">Type 10 - Packet Length</a>
            </h5>
<p id="section-4.2.2.10-1">Encoding: &lt;type (1 octet), [numeric_op, value]+&gt;<a class="pilcrow" href="#section-4.2.2.10-1">¶</a></p>
<p id="section-4.2.2.10-2">Defines a list of {numeric_op, value} pairs used to match on
     the total IP packet length (excluding Layer 2 but including IP
     header).<a class="pilcrow" href="#section-4.2.2.10-2">¶</a></p>
<p id="section-4.2.2.10-3">This component uses the Numeric Operator (numeric_op) described
     in <a class="xref" href="#numeric_operator">Section 4.2.1.1</a>. Type 10
     component values <span class="bcp14">SHOULD</span> be encoded as 1- or 2-octet
     quantities (numeric_op len=00 or len=01).<a class="pilcrow" href="#section-4.2.2.10-3">¶</a></p>
</section>
</div>
<div id="type_11">
<section id="section-4.2.2.11">
            <h5 id="name-type-11-dscp-diffserv-code-">
<a class="section-number selfRef" href="#section-4.2.2.11">4.2.2.11. </a><a class="section-name selfRef" href="#name-type-11-dscp-diffserv-code-">Type 11 - DSCP (Diffserv Code Point)</a>
            </h5>
<p id="section-4.2.2.11-1">Encoding: &lt;type (1 octet), [numeric_op, value]+&gt;<a class="pilcrow" href="#section-4.2.2.11-1">¶</a></p>
<p id="section-4.2.2.11-2"> Defines a list of {numeric_op, value} pairs used to match the
     6-bit DSCP field (see also <span>[<a class="xref" href="#RFC2474">RFC2474</a>]</span>).<a class="pilcrow" href="#section-4.2.2.11-2">¶</a></p>
<p id="section-4.2.2.11-3">This component uses the Numeric Operator (numeric_op) described
     in <a class="xref" href="#numeric_operator">Section 4.2.1.1</a>. Type 11
     component values <span class="bcp14">MUST</span> be encoded as single octet
     (numeric_op len=00).<a class="pilcrow" href="#section-4.2.2.11-3">¶</a></p>
<p id="section-4.2.2.11-4">The six least significant bits contain the DSCP value. All
     other bits <span class="bcp14">SHOULD</span> be treated as 0.<a class="pilcrow" href="#section-4.2.2.11-4">¶</a></p>
</section>
</div>
<div id="type_12">
<section id="section-4.2.2.12">
            <h5 id="name-type-12-fragment">
<a class="section-number selfRef" href="#section-4.2.2.12">4.2.2.12. </a><a class="section-name selfRef" href="#name-type-12-fragment">Type 12 - Fragment</a>
            </h5>
<p id="section-4.2.2.12-1">Encoding: &lt;type (1 octet), [bitmask_op, bitmask]+&gt;<a class="pilcrow" href="#section-4.2.2.12-1">¶</a></p>
<p id="section-4.2.2.12-2"> Defines a list of {bitmask_op, bitmask} pairs used to match
     specific IP fragments.<a class="pilcrow" href="#section-4.2.2.12-2">¶</a></p>
<p id="section-4.2.2.12-3">This component uses the Bitmask Operator (bitmask_op) described
     in <a class="xref" href="#bitmask_operator">Section 4.2.1.2</a>. The Type 12
     component bitmask <span class="bcp14">MUST</span> be encoded as single octet
     bitmask (bitmask_op len=00).<a class="pilcrow" href="#section-4.2.2.12-3">¶</a></p>
<span id="name-fragment-bitmask-operand"></span><div id="figure_fragment_bitmask_operand">
<figure id="figure-4">
              <div class="artwork art-text alignLeft" id="section-4.2.2.12-4.1">
<pre>                   0   1   2   3   4   5   6   7
                 +---+---+---+---+---+---+---+---+
                 | 0 | 0 | 0 | 0 |LF |FF |IsF|DF |
                 +---+---+---+---+---+---+---+---+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-4">Figure 4</a>:
<a class="selfRef" href="#name-fragment-bitmask-operand">Fragment Bitmask Operand</a>
              </figcaption></figure>
</div>
<p id="section-4.2.2.12-5">Bitmask values:<a class="pilcrow" href="#section-4.2.2.12-5">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.2.2.12-6">
              <dt id="section-4.2.2.12-6.1">DF (Don't Fragment):</dt>
              <dd id="section-4.2.2.12-6.2" style="margin-left: 3.0em">match if IP Header Flags Bit-1 (DF) <span>[<a class="xref" href="#RFC0791">RFC0791</a>]</span> is 1<a class="pilcrow" href="#section-4.2.2.12-6.2">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-4.2.2.12-6.3">IsF (Is a fragment other than the first):</dt>
              <dd id="section-4.2.2.12-6.4" style="margin-left: 3.0em">match if the <span>[<a class="xref" href="#RFC0791">RFC0791</a>]</span> IP Header Fragment Offset is not 0<a class="pilcrow" href="#section-4.2.2.12-6.4">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-4.2.2.12-6.5">FF (First Fragment):</dt>
              <dd id="section-4.2.2.12-6.6" style="margin-left: 3.0em">match if the <span>[<a class="xref" href="#RFC0791">RFC0791</a>]</span> IP Header Fragment
       Offset  is 0 AND Flags
       Bit-2 (MF) is 1<a class="pilcrow" href="#section-4.2.2.12-6.6">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-4.2.2.12-6.7">LF (Last Fragment):</dt>
              <dd id="section-4.2.2.12-6.8" style="margin-left: 3.0em">match if the <span>[<a class="xref" href="#RFC0791">RFC0791</a>]</span> IP Header Fragment Offset 
        is not 0 AND Flags
       Bit-2 (MF) is 0<a class="pilcrow" href="#section-4.2.2.12-6.8">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-4.2.2.12-6.9">0:</dt>
              <dd id="section-4.2.2.12-6.10" style="margin-left: 3.0em">
                <span class="bcp14">MUST</span> be set to 0 on NLRI encoding and
       <span class="bcp14">MUST</span> be ignored during decoding<a class="pilcrow" href="#section-4.2.2.12-6.10">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
</section>
</div>
<section id="section-4.3">
        <h3 id="name-examples-of-encodings">
<a class="section-number selfRef" href="#section-4.3">4.3. </a><a class="section-name selfRef" href="#name-examples-of-encodings">Examples of Encodings</a>
        </h3>
<section id="section-4.3.1">
          <h4 id="name-example-1">
<a class="section-number selfRef" href="#section-4.3.1">4.3.1. </a><a class="section-name selfRef" href="#name-example-1">Example 1</a>
          </h4>
<p id="section-4.3.1-1">An example of a Flow Specification NLRI encoding for: "all
   packets to 192.0.2.0/24 and TCP port 25".<a class="pilcrow" href="#section-4.3.1-1">¶</a></p>
<div id="ex-1">
<table class="center" id="table-2">
            <caption><a class="selfRef" href="#table-2">Table 2</a></caption>
<thead>
              <tr>
                <th class="text-left" colspan="1" rowspan="1">length</th>
                <th class="text-left" colspan="1" rowspan="1">destination</th>
                <th class="text-left" colspan="1" rowspan="1">protocol</th>
                <th class="text-left" colspan="1" rowspan="1">port</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0x0b</td>
                <td class="text-left" colspan="1" rowspan="1">01 18 c0 00 02</td>
                <td class="text-left" colspan="1" rowspan="1">03 81 06</td>
                <td class="text-left" colspan="1" rowspan="1">04 81 19</td>
              </tr>
            </tbody>
          </table>
</div>
<p id="section-4.3.1-3">Decoded:<a class="pilcrow" href="#section-4.3.1-3">¶</a></p>
<div id="ex-1-decoded">
<table class="center" id="table-3">
            <caption><a class="selfRef" href="#table-3">Table 3</a></caption>
<thead>
              <tr>
                <th class="text-left" colspan="1" rowspan="1">Value</th>
                <th class="text-left" colspan="2" rowspan="1"></th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0x0b</td>
                <td class="text-left" colspan="1" rowspan="1">length</td>
                <td class="text-left" colspan="1" rowspan="1"> 11 octets (if len&lt;240, 1 octet)</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0x01</td>
                <td class="text-left" colspan="1" rowspan="1">type</td>
                <td class="text-left" colspan="1" rowspan="1">Type 1 - Destination Prefix</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0x18</td>
                <td class="text-left" colspan="1" rowspan="1">length</td>
                <td class="text-left" colspan="1" rowspan="1">24 bit</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0xc0</td>
                <td class="text-left" colspan="1" rowspan="1">prefix</td>
                <td class="text-left" colspan="1" rowspan="1">192</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0x00</td>
                <td class="text-left" colspan="1" rowspan="1">prefix</td>
                <td class="text-left" colspan="1" rowspan="1">0</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0x02</td>
                <td class="text-left" colspan="1" rowspan="1">prefix</td>
                <td class="text-left" colspan="1" rowspan="1">2</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0x03</td>
                <td class="text-left" colspan="1" rowspan="1">type</td>
                <td class="text-left" colspan="1" rowspan="1">Type 3 - IP Protocol</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0x81</td>
                <td class="text-left" colspan="1" rowspan="1">numeric_op</td>
                <td class="text-left" colspan="1" rowspan="1">end-of-list, value size=1, ==</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0x06</td>
                <td class="text-left" colspan="1" rowspan="1">value</td>
                <td class="text-left" colspan="1" rowspan="1">6 (TCP)</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0x04</td>
                <td class="text-left" colspan="1" rowspan="1">type</td>
                <td class="text-left" colspan="1" rowspan="1">Type 4 - Port</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0x81</td>
                <td class="text-left" colspan="1" rowspan="1">numeric_op</td>
                <td class="text-left" colspan="1" rowspan="1">end-of-list, value size=1, ==</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0x19</td>
                <td class="text-left" colspan="1" rowspan="1">value</td>
                <td class="text-left" colspan="1" rowspan="1">25</td>
              </tr>
            </tbody>
          </table>
</div>
<p id="section-4.3.1-5">This constitutes an NLRI with an NLRI length of 11 octets.<a class="pilcrow" href="#section-4.3.1-5">¶</a></p>
</section>
<section id="section-4.3.2">
          <h4 id="name-example-2">
<a class="section-number selfRef" href="#section-4.3.2">4.3.2. </a><a class="section-name selfRef" href="#name-example-2">Example 2</a>
          </h4>
<p id="section-4.3.2-1">An example of a Flow Specification NLRI encoding for: "all
   packets to 192.0.2.0/24 from 203.0.113.0/24 and port {range [137,
   139] or 8080}".<a class="pilcrow" href="#section-4.3.2-1">¶</a></p>
<div id="ex-2">
<table class="center" id="table-4">
            <caption><a class="selfRef" href="#table-4">Table 4</a></caption>
<thead>
              <tr>
                <th class="text-left" colspan="1" rowspan="1">length</th>
                <th class="text-left" colspan="1" rowspan="1">destination</th>
                <th class="text-left" colspan="1" rowspan="1">source</th>
                <th class="text-left" colspan="1" rowspan="1">port</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0x12</td>
                <td class="text-left" colspan="1" rowspan="1">01 18 c0 00 02</td>
                <td class="text-left" colspan="1" rowspan="1">02 18 cb 00 71</td>
                <td class="text-left" colspan="1" rowspan="1">04 03 89 45 8b 91 1f 90</td>
              </tr>
            </tbody>
          </table>
</div>
<p id="section-4.3.2-3">Decoded:<a class="pilcrow" href="#section-4.3.2-3">¶</a></p>
<div id="ex-2-decoded">
<table class="center" id="table-5">
            <caption><a class="selfRef" href="#table-5">Table 5</a></caption>
<thead>
              <tr>
                <th class="text-left" colspan="1" rowspan="1">Value</th>
                <th class="text-left" colspan="2" rowspan="1"></th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0x12</td>
                <td class="text-left" colspan="1" rowspan="1">length</td>
                <td class="text-left" colspan="1" rowspan="1">18 octets (if len&lt;240, 1 octet)</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0x01</td>
                <td class="text-left" colspan="1" rowspan="1">type</td>
                <td class="text-left" colspan="1" rowspan="1">Type 1 - Destination Prefix</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0x18</td>
                <td class="text-left" colspan="1" rowspan="1">length</td>
                <td class="text-left" colspan="1" rowspan="1">24 bit</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0xc0</td>
                <td class="text-left" colspan="1" rowspan="1">prefix</td>
                <td class="text-left" colspan="1" rowspan="1">192</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0x00</td>
                <td class="text-left" colspan="1" rowspan="1">prefix</td>
                <td class="text-left" colspan="1" rowspan="1">0</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0x02</td>
                <td class="text-left" colspan="1" rowspan="1">prefix</td>
                <td class="text-left" colspan="1" rowspan="1">2</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0x02</td>
                <td class="text-left" colspan="1" rowspan="1">type</td>
                <td class="text-left" colspan="1" rowspan="1">Type 2 - Source Prefix</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0x18</td>
                <td class="text-left" colspan="1" rowspan="1">length</td>
                <td class="text-left" colspan="1" rowspan="1"> 24 bit</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0xcb</td>
                <td class="text-left" colspan="1" rowspan="1">prefix</td>
                <td class="text-left" colspan="1" rowspan="1">203</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0x00</td>
                <td class="text-left" colspan="1" rowspan="1">prefix</td>
                <td class="text-left" colspan="1" rowspan="1">0</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0x71</td>
                <td class="text-left" colspan="1" rowspan="1">prefix</td>
                <td class="text-left" colspan="1" rowspan="1">113</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0x04</td>
                <td class="text-left" colspan="1" rowspan="1">type</td>
                <td class="text-left" colspan="1" rowspan="1">Type 4 - Port</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0x03</td>
                <td class="text-left" colspan="1" rowspan="1">numeric_op</td>
                <td class="text-left" colspan="1" rowspan="1">value size=1, &gt;=</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0x89</td>
                <td class="text-left" colspan="1" rowspan="1">value</td>
                <td class="text-left" colspan="1" rowspan="1">137</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0x45</td>
                <td class="text-left" colspan="1" rowspan="1">numeric_op</td>
                <td class="text-left" colspan="1" rowspan="1">"AND", value size=1, &lt;=</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0x8b</td>
                <td class="text-left" colspan="1" rowspan="1">value</td>
                <td class="text-left" colspan="1" rowspan="1">139</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0x91</td>
                <td class="text-left" colspan="1" rowspan="1">numeric_op</td>
                <td class="text-left" colspan="1" rowspan="1">end-of-list, value size=2, ==</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0x1f90</td>
                <td class="text-left" colspan="1" rowspan="1">value</td>
                <td class="text-left" colspan="1" rowspan="1">8080</td>
              </tr>
            </tbody>
          </table>
</div>
<p id="section-4.3.2-5">This constitutes an NLRI with an NLRI length of 18 octets.<a class="pilcrow" href="#section-4.3.2-5">¶</a></p>
</section>
<section id="section-4.3.3">
          <h4 id="name-example-3">
<a class="section-number selfRef" href="#section-4.3.3">4.3.3. </a><a class="section-name selfRef" href="#name-example-3">Example 3</a>
          </h4>
<p id="section-4.3.3-1">An example of a Flow Specification NLRI encoding for: "all
   packets to 192.0.2.1/32 and fragment { DF or FF } (matching packet
   with DF bit set or First Fragments)<a class="pilcrow" href="#section-4.3.3-1">¶</a></p>
<div id="ex-3">
<table class="center" id="table-6">
            <caption><a class="selfRef" href="#table-6">Table 6</a></caption>
<thead>
              <tr>
                <th class="text-left" colspan="1" rowspan="1">length</th>
                <th class="text-left" colspan="1" rowspan="1">destination</th>
                <th class="text-left" colspan="1" rowspan="1">fragment</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0x09</td>
                <td class="text-left" colspan="1" rowspan="1">01 20 c0 00 02 01</td>
                <td class="text-left" colspan="1" rowspan="1">0c 80 05</td>
              </tr>
            </tbody>
          </table>
</div>
<p id="section-4.3.3-3">Decoded:<a class="pilcrow" href="#section-4.3.3-3">¶</a></p>
<table class="center" id="table-7">
            <caption><a class="selfRef" href="#table-7">Table 7</a></caption>
<thead>
              <tr>
                <th class="text-left" colspan="1" rowspan="1">Value</th>
                <th class="text-left" colspan="2" rowspan="1"></th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0x09</td>
                <td class="text-left" colspan="1" rowspan="1">length</td>
                <td class="text-left" colspan="1" rowspan="1">9 octets (if len&lt;240, 1 octet)</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0x01</td>
                <td class="text-left" colspan="1" rowspan="1">type</td>
                <td class="text-left" colspan="1" rowspan="1">Type 1 - Destination Prefix</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0x20</td>
                <td class="text-left" colspan="1" rowspan="1">length</td>
                <td class="text-left" colspan="1" rowspan="1"> 32 bit</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0xc0</td>
                <td class="text-left" colspan="1" rowspan="1">prefix</td>
                <td class="text-left" colspan="1" rowspan="1">192</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0x00</td>
                <td class="text-left" colspan="1" rowspan="1">prefix</td>
                <td class="text-left" colspan="1" rowspan="1">0</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0x02</td>
                <td class="text-left" colspan="1" rowspan="1">prefix</td>
                <td class="text-left" colspan="1" rowspan="1">2</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0x01</td>
                <td class="text-left" colspan="1" rowspan="1">prefix</td>
                <td class="text-left" colspan="1" rowspan="1">1</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0x0c</td>
                <td class="text-left" colspan="1" rowspan="1">type</td>
                <td class="text-left" colspan="1" rowspan="1">Type 12 - Fragment</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0x80</td>
                <td class="text-left" colspan="1" rowspan="1">bitmask_op</td>
                <td class="text-left" colspan="1" rowspan="1">end-of-list, value size=1</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">0x05</td>
                <td class="text-left" colspan="1" rowspan="1">bitmask</td>
                <td class="text-left" colspan="1" rowspan="1">DF=1, FF=1</td>
              </tr>
            </tbody>
          </table>
<p id="section-4.3.3-5">This constitutes an NLRI with an NLRI length of 9 octets.<a class="pilcrow" href="#section-4.3.3-5">¶</a></p>
</section>
</section>
</section>
</div>
<div id="traffic_filtering">
<section id="section-5">
      <h2 id="name-traffic-filtering">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-traffic-filtering">Traffic Filtering</a>
      </h2>
<p id="section-5-1">Traffic filtering policies have been traditionally considered to be
      relatively static.  Limitations of these static mechanisms caused this
      new dynamic mechanism to be designed for the three new applications of
      traffic filtering:<a class="pilcrow" href="#section-5-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-2.1">Prevention of traffic-based, denial-of-service (DoS) attacks<a class="pilcrow" href="#section-5-2.1">¶</a>
</li>
        <li class="normal" id="section-5-2.2">Traffic filtering in the context of BGP/MPLS VPN service<a class="pilcrow" href="#section-5-2.2">¶</a>
</li>
        <li class="normal" id="section-5-2.3">Centralized traffic control for SDN/NFV networks<a class="pilcrow" href="#section-5-2.3">¶</a>
</li>
      </ul>
<p id="section-5-3">These applications require coordination among service providers
      and/or coordination among the AS within a service provider.<a class="pilcrow" href="#section-5-3">¶</a></p>
<p id="section-5-4">The Flow Specification NLRI defined in <a class="xref" href="#dissemination_ipv4_flowspec">Section 4</a> conveys
      information about traffic filtering rules for traffic that should be
      discarded or handled in a manner specified by a set of predefined
      actions (which are defined in BGP Extended Communities). This mechanism
      is primarily designed to allow an upstream autonomous system to perform
      inbound filtering in their ingress routers of traffic that a given
      downstream AS wishes to drop.<a class="pilcrow" href="#section-5-4">¶</a></p>
<p id="section-5-5">In order to achieve this goal, this document specifies two
      application-specific NLRI identifiers that provide traffic filters and
      a set of actions encoding in BGP Extended Communities.  The two
      application-specific NLRI identifiers are:<a class="pilcrow" href="#section-5-5">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-6.1">IPv4 Flow Specification identifier (AFI=1, SAFI=133) along with
 specific semantic rules for IPv4 routes and<a class="pilcrow" href="#section-5-6.1">¶</a>
</li>
        <li class="normal" id="section-5-6.2">VPNv4 Flow Specification identifier (AFI=1, SAFI=134) value, which
 can be used to propagate traffic filtering information in a BGP/MPLS
 VPN environment.<a class="pilcrow" href="#section-5-6.2">¶</a>
</li>
      </ul>
<p id="section-5-7">
       Encoding of the NLRI is described in <a class="xref" href="#dissemination_ipv4_flowspec">Section 4</a> for IPv4 Flow Specification and   in
       <a class="xref" href="#traffic_filtering_vpn">Section 8</a> for VPNv4 Flow Specification. The filtering actions are described
       in <a class="xref" href="#traffic_filtering_actions">Section 7</a>.<a class="pilcrow" href="#section-5-7">¶</a></p>
<div id="ordering_of_flow_spec">
<section id="section-5.1">
        <h3 id="name-ordering-of-flow-specificat">
<a class="section-number selfRef" href="#section-5.1">5.1. </a><a class="section-name selfRef" href="#name-ordering-of-flow-specificat">Ordering of Flow Specifications</a>
        </h3>
<p id="section-5.1-1">More than one Flow Specification may match a particular traffic
 flow.  Thus, it is necessary to define the order in which Flow
 Specifications get matched and actions being applied to a particular
 traffic flow. This ordering function is such that it does not depend
 on the arrival order of the Flow Specification via BGP and thus is
 consistent in the network.<a class="pilcrow" href="#section-5.1-1">¶</a></p>
<p id="section-5.1-2">The relative order of two Flow Specifications is determined by
 comparing their respective components. The algorithm starts by
 comparing the left-most components (lowest component type value) of
 the Flow Specifications.  If the types differ, the Flow Specification
 with lowest numeric type value has higher precedence (and thus will
 match before) than the Flow Specification that doesn't contain that
 component type. If the component types are the same, then a
 type-specific comparison is performed (see below). If the types are
 equal, the algorithm continues with the next component.<a class="pilcrow" href="#section-5.1-2">¶</a></p>
<p id="section-5.1-3">For IP prefix values (IP destination or source prefix), if one of
 the two prefixes to compare is a more specific prefix of the other,
 the more specific prefix has higher precedence. Otherwise, the one with
 the lowest IP value has higher precedence.<a class="pilcrow" href="#section-5.1-3">¶</a></p>
<p id="section-5.1-4">For all other component types, unless otherwise specified, the
 comparison is performed by comparing the component data as a binary
 string using the memcmp() function as defined by <span>[<a class="xref" href="#ISO_IEC_9899">ISO_IEC_9899</a>]</span>. For strings with equal
 lengths, the lowest string (memcmp) has higher precedence. For strings
 of different lengths, the common prefix is compared. If the common
 prefix is not equal, the string with the lowest prefix has higher
 precedence. If the common prefix is equal, the longest string is
 considered to have higher precedence than the shorter one.<a class="pilcrow" href="#section-5.1-4">¶</a></p>
<p id="section-5.1-5">The code in <a class="xref" href="#flow_rule_cmp_src">Appendix A</a>
 shows a Python3 implementation of the comparison algorithm. The full
 code was tested with Python 3.6.3 and can be obtained at <span>&lt;<a href="https://github.com/stoffi92/rfc5575bis/tree/master/flowspec-cmp">https://github.com/stoffi92/rfc5575bis/tree/master/flowspec-cmp</a>&gt;</span>.<a class="pilcrow" href="#section-5.1-5">¶</a></p>
</section>
</div>
</section>
</div>
<div id="validation_procedure">
<section id="section-6">
      <h2 id="name-validation-procedure">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-validation-procedure">Validation Procedure</a>
      </h2>
<p id="section-6-1">Flow Specifications received from a BGP peer that are accepted in the
      respective Adj-RIB-In are used as input to the route selection process.
      Although the forwarding attributes of two routes for the same Flow
      Specification prefix may be the same, BGP is still required to perform
      its path selection algorithm in order to select the correct set of
      attributes to advertise.<a class="pilcrow" href="#section-6-1">¶</a></p>
<p id="section-6-2">The first step of the BGP Route Selection procedure (<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc4271#section-9.1.2">Section 9.1.2</a> of [<a class="xref" href="#RFC4271">RFC4271</a>]</span>) is to exclude from
      the selection procedure routes that are considered unfeasible. 
      In the
      context of IP routing information, this step is used to validate that
      the NEXT_HOP attribute of a given route is resolvable.<a class="pilcrow" href="#section-6-2">¶</a></p>
<p id="section-6-3">
   The concept can be extended, in the case of the Flow Specification NLRI,
   to allow other validation procedures.<a class="pilcrow" href="#section-6-3">¶</a></p>
<p id="section-6-4">
    The validation process described below validates Flow Specifications against
    unicast routes received over the same AFI but the associated unicast routing
    information SAFI:<a class="pilcrow" href="#section-6-4">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-5.1">Flow Specification received over SAFI=133 will be validated
 against routes received over SAFI=1.<a class="pilcrow" href="#section-6-5.1">¶</a>
</li>
        <li class="normal" id="section-6-5.2">Flow Specification received over SAFI=134 will be validated
 against routes received over SAFI=128.<a class="pilcrow" href="#section-6-5.2">¶</a>
</li>
      </ul>
<p id="section-6-6">In the absence of explicit configuration, a Flow Specification NLRI
      <span class="bcp14">MUST</span> be validated such that it is considered feasible if
      and only if all of the conditions below are true:<a class="pilcrow" href="#section-6-6">¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-6-7">
        <dt>a)</dt>
<dd id="section-6-7.1">A destination prefix component is embedded in the Flow Specification.<a class="pilcrow" href="#section-6-7.1">¶</a>
</dd>
        <dd class="break"></dd>
<dt>b)</dt>
<dd id="section-6-7.2">The originator of the Flow Specification matches the originator of
 the best-match unicast route for the destination prefix embedded in
 the Flow Specification (this is the unicast route with the longest
 possible prefix length covering the destination prefix embedded in the
 Flow Specification).<a class="pilcrow" href="#section-6-7.2">¶</a>
</dd>
        <dd class="break"></dd>
<dt>c)</dt>
<dd id="section-6-7.3">There are no "more-specific" unicast routes, when compared with
 the flow destination prefix, that have been received from a different
 neighboring AS than the best-match unicast route, which has been
 determined in rule b.<a class="pilcrow" href="#section-6-7.3">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-6-8">However, rule a <span class="bcp14">MAY</span> be relaxed by explicit
      configuration, permitting Flow Specifications that include no
      destination prefix component. If such is the case, rules b and c are
      moot and <span class="bcp14">MUST</span> be disregarded.<a class="pilcrow" href="#section-6-8">¶</a></p>
<p id="section-6-9">By "originator" of a BGP route, we mean either the address of the
      originator in the ORIGINATOR_ID Attribute <span>[<a class="xref" href="#RFC4456">RFC4456</a>]</span> or the source IP address of the BGP peer, if this
      path attribute is not present.<a class="pilcrow" href="#section-6-9">¶</a></p>
<p id="section-6-10">BGP implementations <span class="bcp14">MUST</span> also enforce that the AS_PATH
      attribute of a route received via the External Border Gateway Protocol
      (eBGP) contains the neighboring AS in the left-most position of the
      AS_PATH attribute.  While this rule is optional in the BGP
      specification, it becomes necessary to enforce it here for security
      reasons.<a class="pilcrow" href="#section-6-10">¶</a></p>
<p id="section-6-11">The best-match unicast route may change over the time independently
      of the Flow Specification NLRI. Therefore, a revalidation of the Flow
      Specification NLRI <span class="bcp14">MUST</span> be performed whenever unicast
      routes change. Revalidation is defined as retesting rules a to c as
      described above.<a class="pilcrow" href="#section-6-11">¶</a></p>
<p id="section-6-12">Explanation:<a class="pilcrow" href="#section-6-12">¶</a></p>
<p id="section-6-13">The underlying concept is that the neighboring AS that advertises the
      best unicast route for a destination is allowed to advertise Flow
      Specification information that conveys a destination prefix that is more
      or equally specific. Thus, as long as there are no "more-specific"
      unicast routes received from a different neighboring AS, which would be
      affected by that Flow Specification, the Flow Specification is validated
      successfully.<a class="pilcrow" href="#section-6-13">¶</a></p>
<p id="section-6-14">The neighboring AS is the immediate destination of the traffic
      described by the Flow Specification.  If it requests these flows to be
      dropped, that request can be honored without concern that it represents
      a denial of service in itself.  The reasoning is that this is as if the
      traffic is being dropped by the downstream autonomous system, and there
      is no added value in carrying the traffic to it.<a class="pilcrow" href="#section-6-14">¶</a></p>
</section>
</div>
<div id="traffic_filtering_actions">
<section id="section-7">
      <h2 id="name-traffic-filtering-actions">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-traffic-filtering-actions">Traffic Filtering Actions</a>
      </h2>
<p id="section-7-1">This document defines a minimum set of Traffic Filtering Actions that
      it standardizes as BGP Extended Communities <span>[<a class="xref" href="#RFC4360">RFC4360</a>]</span>. This is not meant to be an inclusive list of all the
      possible actions but only a subset that can be interpreted consistently
      across the network. Additional actions can be defined as either
      requiring standards or as vendor specific.<a class="pilcrow" href="#section-7-1">¶</a></p>
<p id="section-7-2">The default action for a matching Flow Specification is to accept the
      packet (treat the packet according to the normal forwarding behavior of
      the system).<a class="pilcrow" href="#section-7-2">¶</a></p>
<p id="section-7-3">This document defines the following Extended Communities values shown
      in <a class="xref" href="#traffic_extended_communities">Table 8</a> in the
      form 0xttss, where tt indicates the type and ss indicates the sub-type
      of the Extended Community. Encodings for these Extended Communities are
      described below.<a class="pilcrow" href="#section-7-3">¶</a></p>
<span id="name-traffic-filtering-action-ex"></span><div id="traffic_extended_communities">
<table class="center" id="table-8">
        <caption>
<a class="selfRef" href="#table-8">Table 8</a>:
<a class="selfRef" href="#name-traffic-filtering-action-ex">Traffic Filtering Action Extended Communities</a>
        </caption>
<thead>
          <tr>
            <th class="text-left" colspan="1" rowspan="1">community 0xttss</th>
            <th class="text-left" colspan="1" rowspan="1">action</th>
            <th class="text-left" colspan="1" rowspan="1">encoding</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">0x8006</td>
            <td class="text-left" colspan="1" rowspan="1">traffic-rate-bytes (<a class="xref" href="#traffic_rate_in_bytes">Section 7.1</a>)</td>
            <td class="text-left" colspan="1" rowspan="1">2-octet AS, 4-octet float</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">0x800c</td>
            <td class="text-left" colspan="1" rowspan="1">traffic-rate-packets (<a class="xref" href="#traffic_rate_in_packets">Section 7.2</a>)</td>
            <td class="text-left" colspan="1" rowspan="1">2-octet AS, 4-octet float</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">0x8007</td>
            <td class="text-left" colspan="1" rowspan="1">traffic-action (<a class="xref" href="#traffic_action_subtype">Section 7.3</a>)</td>
            <td class="text-left" colspan="1" rowspan="1">bitmask</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">0x8008</td>
            <td class="text-left" colspan="1" rowspan="1">rt-redirect AS-2octet (<a class="xref" href="#rt_redirect_action_subtype">Section 7.4</a>)</td>
            <td class="text-left" colspan="1" rowspan="1">2-octet AS, 4-octet value</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">0x8108</td>
            <td class="text-left" colspan="1" rowspan="1">rt-redirect IPv4 (<a class="xref" href="#rt_redirect_action_subtype">Section 7.4</a>)</td>
            <td class="text-left" colspan="1" rowspan="1">4-octet IPv4 address, 2-octet value</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">0x8208</td>
            <td class="text-left" colspan="1" rowspan="1">rt-redirect AS-4octet (<a class="xref" href="#rt_redirect_action_subtype">Section 7.4</a>)</td>
            <td class="text-left" colspan="1" rowspan="1">4-octet AS, 2-octet value</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">0x8009</td>
            <td class="text-left" colspan="1" rowspan="1">traffic-marking (<a class="xref" href="#traffic_marking_subtype">Section 7.5</a>)</td>
            <td class="text-left" colspan="1" rowspan="1">DSCP value</td>
          </tr>
        </tbody>
      </table>
</div>
<p id="section-7-5">Multiple Traffic Filtering Actions defined in this document may be
      present for a single Flow Specification and <span class="bcp14">SHOULD</span> be
      applied to the traffic flow (for example, traffic-rate-bytes and
      rt-redirect can be applied to packets at the same time). If not all of
      the Traffic Filtering Actions can be applied to a traffic flow, they
      should be treated as interfering Traffic Filtering Actions (see
      below).<a class="pilcrow" href="#section-7-5">¶</a></p>
<p id="section-7-6">Some Traffic Filtering Actions may interfere with each other or even
      contradict. <a class="xref" href="#rules_action_interference">Section 7.7</a>
      of this document provides general considerations on such Traffic
      Filtering Action interference. Any additional definition of Traffic
      Filtering Actions <span class="bcp14">SHOULD</span> specify the action to take if
      those Traffic Filtering Actions interfere (also with existing Traffic
      Filtering Actions).<a class="pilcrow" href="#section-7-6">¶</a></p>
<p id="section-7-7">All Traffic Filtering Actions are specified as transitive BGP
      Extended Communities.<a class="pilcrow" href="#section-7-7">¶</a></p>
<div id="traffic_rate_in_bytes">
<section id="section-7.1">
        <h3 id="name-traffic-rate-in-bytes-traff">
<a class="section-number selfRef" href="#section-7.1">7.1. </a><a class="section-name selfRef" href="#name-traffic-rate-in-bytes-traff">Traffic Rate in Bytes (traffic-rate-bytes) Sub-Type 0x06</a>
        </h3>
<p id="section-7.1-1">The traffic-rate-bytes Extended Community uses the following
 Extended Community encoding:<a class="pilcrow" href="#section-7.1-1">¶</a></p>
<p id="section-7.1-2">
 The first two octets carry the 2-octet id, which can be
 assigned from a 2-octet AS number.  When a 4-octet AS number is
 locally present, the 2 least significant octets of such an AS
 number can be used.  This value is purely informational and
 <span class="bcp14">SHOULD NOT</span> be interpreted by the implementation.<a class="pilcrow" href="#section-7.1-2">¶</a></p>
<p id="section-7.1-3">The remaining 4 octets carry the maximum rate information in IEEE
 floating point <span>[<a class="xref" href="#IEEE.754.1985">IEEE.754.1985</a>]</span> format,
 units being bytes per second.  A traffic-rate of 0 should result on
 all traffic for the particular flow to be discarded. On encoding, the
 traffic-rate <span class="bcp14">MUST NOT</span> be negative. On decoding, negative
 values <span class="bcp14">MUST</span> be treated as zero (discard all
 traffic).<a class="pilcrow" href="#section-7.1-3">¶</a></p>
<p id="section-7.1-4">Interferes with: May interfere with the traffic-rate-packets (see
 <a class="xref" href="#traffic_rate_in_packets">Section 7.2</a>). A policy
 may allow both filtering by traffic-rate-packets and
 traffic-rate-bytes. If the policy does not allow this, these two
 actions will conflict.<a class="pilcrow" href="#section-7.1-4">¶</a></p>
</section>
</div>
<div id="traffic_rate_in_packets">
<section id="section-7.2">
        <h3 id="name-traffic-rate-in-packets-tra">
<a class="section-number selfRef" href="#section-7.2">7.2. </a><a class="section-name selfRef" href="#name-traffic-rate-in-packets-tra">Traffic Rate in Packets (traffic-rate-packets) Sub-Type 0x0c</a>
        </h3>
<p id="section-7.2-1">The traffic-rate-packets Extended Community uses the same encoding
 as the traffic-rate-bytes Extended Community. The floating point value
 carries the maximum packet rate in packets per second. A
 traffic-rate-packets of 0 should result in all traffic for the
 particular flow to be discarded. On encoding, the traffic-rate-packets
 <span class="bcp14">MUST NOT</span> be negative. On decoding, negative values
 <span class="bcp14">MUST</span> be treated as zero (discard all traffic).<a class="pilcrow" href="#section-7.2-1">¶</a></p>
<p id="section-7.2-2">Interferes with: May interfere with the traffic-rate-bytes (see
 <a class="xref" href="#traffic_rate_in_bytes">Section 7.1</a>). A policy may
 allow both filtering by traffic-rate-packets and
 traffic-rate-bytes. If the policy does not allow this, these two
 actions will conflict.<a class="pilcrow" href="#section-7.2-2">¶</a></p>
</section>
</div>
<div id="traffic_action_subtype">
<section id="section-7.3">
        <h3 id="name-traffic-action-traffic-acti">
<a class="section-number selfRef" href="#section-7.3">7.3. </a><a class="section-name selfRef" href="#name-traffic-action-traffic-acti">Traffic-Action (traffic-action) Sub-Type 0x07</a>
        </h3>
<p id="section-7.3-1">The traffic-action Extended Community consists of 6
      octets of which only the 2 least significant bits of the 6th octet
      (from left to right) are defined by this document, as shown in
     <a class="xref" href="#figure_traffic_action_encoding">Figure 5</a>.<a class="pilcrow" href="#section-7.3-1">¶</a></p>
<span id="name-traffic-action-extended-com"></span><div id="figure_traffic_action_encoding">
<figure id="figure-5">
          <div class="artwork art-text alignLeft" id="section-7.3-2.1">
<pre>   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  | Traffic Action Field                                          |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  | Tr. Action Field (cont.)  |S|T|
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-5">Figure 5</a>:
<a class="selfRef" href="#name-traffic-action-extended-com">Traffic-Action Extended Community Encoding</a>
          </figcaption></figure>
</div>
<p id="section-7.3-3">S and T are defined as:<a class="pilcrow" href="#section-7.3-3">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-7.3-4">
          <dt id="section-7.3-4.1">T</dt>
          <dd id="section-7.3-4.2" style="margin-left: 3.0em">Terminal Action (bit 47): When this bit is set, the traffic
   filtering engine will evaluate any subsequent Flow Specifications
   (as defined by the ordering procedure <a class="xref" href="#ordering_of_flow_spec">Section 5.1</a>). If not set, the
   evaluation of the traffic filters stops when this Flow Specification
   is evaluated.<a class="pilcrow" href="#section-7.3-4.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.3-4.3">S</dt>
          <dd id="section-7.3-4.4" style="margin-left: 3.0em">Sample (bit 46): Enables traffic sampling and logging for this
   Flow Specification (only effective when set).<a class="pilcrow" href="#section-7.3-4.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.3-4.5">Traffic Action Field:</dt>
          <dd id="section-7.3-4.6" style="margin-left: 3.0em">Other Traffic Action Field (see <a class="xref" href="#IANA">Section 11</a>) bits unused in this
   specification. These bits <span class="bcp14">MUST</span> be set to 0 on
   encoding and <span class="bcp14">MUST</span> be ignored during decoding.<a class="pilcrow" href="#section-7.3-4.6">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-7.3-5">The use of the Terminal Action (bit 47) may result in more than one
 Flow Specification matching a particular traffic flow. All the Traffic
 Filtering Actions from these Flow Specifications shall be collected
 and applied. In case of interfering Traffic Filtering Actions, it is an
 implementation decision which Traffic Filtering Actions are
 selected. See also <a class="xref" href="#rules_action_interference">Section 7.7</a>.<a class="pilcrow" href="#section-7.3-5">¶</a></p>
<p id="section-7.3-6">Interferes with: No other BGP Flow Specification Traffic Filtering
 Action in this document.<a class="pilcrow" href="#section-7.3-6">¶</a></p>
</section>
</div>
<div id="rt_redirect_action_subtype">
<section id="section-7.4">
        <h3 id="name-rt-redirect-rt-redirect-sub">
<a class="section-number selfRef" href="#section-7.4">7.4. </a><a class="section-name selfRef" href="#name-rt-redirect-rt-redirect-sub">RT Redirect (rt-redirect) Sub-Type 0x08</a>
        </h3>
<p id="section-7.4-1">The redirect Extended Community allows the traffic to be redirected
 to a VRF routing instance that lists the specified route-target in its
 import policy. If several local instances match this criteria, the
 choice between them is a local matter (for example, the instance with
 the lowest Route Distinguisher value can be elected).<a class="pilcrow" href="#section-7.4-1">¶</a></p>
<p id="section-7.4-2">This Extended Community allows 3 different encodings formats for
 the route-target (type 0x80, 0x81, 0x82). It uses the same encoding as
 the Route Target Extended Community in Sections <a class="relref" href="https://www.rfc-editor.org/rfc/rfc4360#section-3.1">3.1</a> (type 0x80: 2-octet AS, 4-octet
 value), <a class="relref" href="https://www.rfc-editor.org/rfc/rfc4360#section-3.2">3.2</a>
 (type 0x81: 4-octet IPv4 address, 2-octet value), and <a class="relref" href="https://www.rfc-editor.org/rfc/rfc4360#section-4">4</a> of <span>[<a class="xref" href="#RFC4360">RFC4360</a>]</span> and <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc5668#section-2">Section 2</a> of [<a class="xref" href="#RFC5668">RFC5668</a>]</span> (type 0x82: 4-octet AS,
 2-octet value) with the high-order octet of the Type field 0x80, 0x81,
 0x82 respectively and the low-order octet of the Type field (Sub-Type)
 always 0x08.<a class="pilcrow" href="#section-7.4-2">¶</a></p>
<p id="section-7.4-3">Interferes with: No other BGP Flow Specification Traffic Filtering
 Action in this document.<a class="pilcrow" href="#section-7.4-3">¶</a></p>
</section>
</div>
<div id="traffic_marking_subtype">
<section id="section-7.5">
        <h3 id="name-traffic-marking-traffic-mar">
<a class="section-number selfRef" href="#section-7.5">7.5. </a><a class="section-name selfRef" href="#name-traffic-marking-traffic-mar">Traffic Marking (traffic-marking) Sub-Type 0x09</a>
        </h3>
<p id="section-7.5-1"> The traffic marking Extended Community instructs a system to
 modify the DSCP bits in the IP header (<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc2474#section-3">Section 3</a> of [<a class="xref" href="#RFC2474">RFC2474</a>]</span>) of a transiting IP packet to the
 corresponding value encoded in the 6 least significant bits of the
 Extended Community value, as shown in <a class="xref" href="#figure_traffic_marking_encoding">Figure 6</a>.<a class="pilcrow" href="#section-7.5-1">¶</a></p>
<p id="section-7.5-2">The Extended Community is encoded as follows:<a class="pilcrow" href="#section-7.5-2">¶</a></p>
<span id="name-traffic-marking-extended-co"></span><div id="figure_traffic_marking_encoding">
<figure id="figure-6">
          <div class="artwork art-text alignLeft" id="section-7.5-3.1">
<pre>   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |   reserved    |   reserved    |   reserved    |   reserved    |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |   reserved    | r.|    DSCP   |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-6">Figure 6</a>:
<a class="selfRef" href="#name-traffic-marking-extended-co">Traffic Marking Extended Community Encoding</a>
          </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-7.5-4">
          <dt id="section-7.5-4.1">DSCP:</dt>
          <dd id="section-7.5-4.2" style="margin-left: 3.0em">new DSCP value for the transiting IP packet<a class="pilcrow" href="#section-7.5-4.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.5-4.3">reserved (r):</dt>
          <dd id="section-7.5-4.4" style="margin-left: 3.0em">
            <span class="bcp14">MUST</span> be set to 0 on encoding and
   <span class="bcp14">MUST</span> be ignored during decoding<a class="pilcrow" href="#section-7.5-4.4">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-7.5-5">Interferes with: No other BGP Flow Specification Traffic Filtering
 Action in this document.<a class="pilcrow" href="#section-7.5-5">¶</a></p>
</section>
</div>
<section id="section-7.6">
        <h3 id="name-interaction-with-other-filt">
<a class="section-number selfRef" href="#section-7.6">7.6. </a><a class="section-name selfRef" href="#name-interaction-with-other-filt">Interaction with Other Filtering Mechanisms in Routers</a>
        </h3>
<p id="section-7.6-1">
   Implementations should provide mechanisms that map an arbitrary BGP
   community value (normal or extended) to Traffic Filtering Actions that
   require different mappings on different systems in the network.  For
   instance, providing packets with a worse-than-best-effort per-hop
   behavior is a functionality that is likely to be implemented
   differently in different systems and for which no standard behavior
   is currently known.  Rather than attempting to define it here, this
   can be accomplished by mapping a user-defined community value to
   platform-/network-specific behavior via user configuration.<a class="pilcrow" href="#section-7.6-1">¶</a></p>
</section>
<div id="rules_action_interference">
<section id="section-7.7">
        <h3 id="name-considerations-on-traffic-f">
<a class="section-number selfRef" href="#section-7.7">7.7. </a><a class="section-name selfRef" href="#name-considerations-on-traffic-f">Considerations on Traffic Filtering Action Interference</a>
        </h3>
<p id="section-7.7-1">Since Traffic Filtering Actions are represented as BGP extended
 community values, Traffic Filtering Actions may interfere with each
 other (e.g., there may be more than one conflicting traffic-rate-bytes
 Traffic Filtering Action associated with a single Flow
 Specification). Traffic Filtering Action interference has no impact on
 BGP propagation of Flow Specifications (all communities are propagated
 according to policies).<a class="pilcrow" href="#section-7.7-1">¶</a></p>
<p id="section-7.7-2">If a Flow Specification associated with interfering Traffic
 Filtering Actions is selected for packet forwarding, it is an
 implementation decision which of the interfering Traffic Filtering
 Actions are selected. Implementors of this specification
 <span class="bcp14">SHOULD</span> document the behavior of their implementation in
 such cases.<a class="pilcrow" href="#section-7.7-2">¶</a></p>
<p id="section-7.7-3">Operators are encouraged to make use of the BGP policy framework
 supported by their implementation in order to achieve a predictable
 behavior. See also <a class="xref" href="#security_considerations">Section 12</a>.<a class="pilcrow" href="#section-7.7-3">¶</a></p>
</section>
</div>
</section>
</div>
<div id="traffic_filtering_vpn">
<section id="section-8">
      <h2 id="name-dissemination-of-traffic-fi">
<a class="section-number selfRef" href="#section-8">8. </a><a class="section-name selfRef" href="#name-dissemination-of-traffic-fi">Dissemination of Traffic Filtering in BGP/MPLS VPN Networks</a>
      </h2>
<p id="section-8-1">
   Provider-based Layer 3 VPN networks, such as the ones using a BGP/ MPLS IP
   VPN <span>[<a class="xref" href="#RFC4364">RFC4364</a>]</span> control plane, may have different traffic
   filtering requirements than Internet service providers. But also Internet
   service providers may use those VPNs for scenarios like having the Internet
   routing table in a VRF, resulting in the same traffic filtering requirements
   as defined for the global routing table environment within this document.
   This document defines an additional BGP NLRI type (AFI=1, SAFI=134) value,
   which can be used to propagate Flow Specification in a BGP/MPLS
   VPN environment.<a class="pilcrow" href="#section-8-1">¶</a></p>
<p id="section-8-2">
   The NLRI format for this address family consists of a fixed-length Route
   Distinguisher field (8 octets) followed by the Flow Specification NLRI value (<a class="xref" href="#nlri_value_encoding">Section 4.2</a>).
   The NLRI length field shall include both the 8 octets of the Route
   Distinguisher as well as the subsequent Flow Specification NLRI value.
   The resulting encoding is shown in <a class="xref" href="#figure_fs_nlri_mpls">Figure 7</a>.<a class="pilcrow" href="#section-8-2">¶</a></p>
<span id="name-flow-specification-nlri-for-"></span><div id="figure_fs_nlri_mpls">
<figure id="figure-7">
        <div class="artwork art-text alignLeft" id="section-8-3.1">
<pre>                 +--------------------------------+
                 | length (0xnn or 0xfnnn)        |
                 +--------------------------------+
                 | Route Distinguisher (8 octets) |
                 +--------------------------------+
                 |    NLRI value  (variable)      |
                 +--------------------------------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-7">Figure 7</a>:
<a class="selfRef" href="#name-flow-specification-nlri-for-">Flow Specification NLRI for MPLS</a>
        </figcaption></figure>
</div>
<p id="section-8-4">
   Propagation of this NLRI is controlled by matching Route Target
   extended communities associated with the BGP path advertisement with
   the VRF import policy, using the same mechanism as described in BGP/
   MPLS IP VPNs <span>[<a class="xref" href="#RFC4364">RFC4364</a>]</span>.<a class="pilcrow" href="#section-8-4">¶</a></p>
<p id="section-8-5">
   Flow Specifications received via this NLRI apply only to traffic
   that belongs to the VRF(s) in which it is imported. By default,
   traffic received from a remote PE is switched via an MPLS forwarding
   decision and is not subject to filtering.<a class="pilcrow" href="#section-8-5">¶</a></p>
<p id="section-8-6">Contrary to the behavior specified for the non-VPN NLRI, Flow
      Specifications are accepted by default, when received from remote PE
      routers.<a class="pilcrow" href="#section-8-6">¶</a></p>
<p id="section-8-7">The validation procedure (<a class="xref" href="#validation_procedure">Section 6</a>) and Traffic Filtering Actions (<a class="xref" href="#traffic_filtering_actions">Section 7</a>) are the same as
      for IPv4.<a class="pilcrow" href="#section-8-7">¶</a></p>
</section>
</div>
<section id="section-9">
      <h2 id="name-traffic-monitoring">
<a class="section-number selfRef" href="#section-9">9. </a><a class="section-name selfRef" href="#name-traffic-monitoring">Traffic Monitoring</a>
      </h2>
<p id="section-9-1">
   Traffic filtering applications require monitoring and traffic
   statistics facilities.  While this is an implementation specific
   choice, implementations <span class="bcp14">SHOULD</span> provide:<a class="pilcrow" href="#section-9-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9-2.1">A mechanism to log the packet header of filtered traffic.<a class="pilcrow" href="#section-9-2.1">¶</a>
</li>
        <li class="normal" id="section-9-2.2">A mechanism to count the number of matches for a given Flow
 Specification rule.<a class="pilcrow" href="#section-9-2.2">¶</a>
</li>
      </ul>
</section>
<div id="errorhandling">
<section id="section-10">
      <h2 id="name-error-handling">
<a class="section-number selfRef" href="#section-10">10. </a><a class="section-name selfRef" href="#name-error-handling">Error Handling</a>
      </h2>
<p id="section-10-1">
      Error handling according to <span>[<a class="xref" href="#RFC7606">RFC7606</a>]</span> and
      <span>[<a class="xref" href="#RFC4760">RFC4760</a>]</span> applies to this specification.<a class="pilcrow" href="#section-10-1">¶</a></p>
<p id="section-10-2">
        This document introduces Traffic Filtering Action Extended Communities.
        Malformed Traffic Filtering Action Extended Communities in the sense
 of <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc7606#section-7.14">Section 7.14</a> of [<a class="xref" href="#RFC7606">RFC7606</a>]</span>
        are Extended Community values that cannot be decoded according
        to <a class="xref" href="#traffic_filtering_actions">Section 7</a> of this document.<a class="pilcrow" href="#section-10-2">¶</a></p>
</section>
</div>
<div id="IANA">
<section id="section-11">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-11">11. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<p id="section-11-1">
    This section complies with <span>[<a class="xref" href="#RFC7153">RFC7153</a>]</span>.<a class="pilcrow" href="#section-11-1">¶</a></p>
<section id="section-11.1">
        <h3 id="name-afi-safi-definitions">
<a class="section-number selfRef" href="#section-11.1">11.1. </a><a class="section-name selfRef" href="#name-afi-safi-definitions">AFI/SAFI Definitions</a>
        </h3>
<p id="section-11.1-1">
      IANA maintains a registry entitled "SAFI Values". For the purpose of this
      work, IANA has updated the following SAFIs as shown in the table below.
         (Note: This document obsoletes both <span>[<a class="xref" href="#RFC7674">RFC7674</a>]</span> and <span>[<a class="xref" href="#RFC5575">RFC5575</a>]</span>, and all references
      to those documents have been deleted from the registry.)<a class="pilcrow" href="#section-11.1-1">¶</a></p>
<span id="name-registry-safi-values"></span><div id="iana_safi">
<table class="center" id="table-9">
          <caption>
<a class="selfRef" href="#table-9">Table 9</a>:
<a class="selfRef" href="#name-registry-safi-values">Registry: SAFI Values</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Value</th>
              <th class="text-left" colspan="1" rowspan="1">Name</th>
              <th class="text-left" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">133</td>
              <td class="text-left" colspan="1" rowspan="1">Dissemination of Flow Specification rules</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 8955</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">134</td>
              <td class="text-left" colspan="1" rowspan="1">L3VPN Dissemination of Flow Specification rules</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 8955</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-11.1-3">The above textual changes generalize the definition of the SAFIs
 rather than change its underlying meaning. Therefore, based on <span><a class="xref" href="#RFC7950">"The YANG 1.1 Data Modeling Language"</a> [<a class="xref" href="#RFC7950">RFC7950</a>]</span>, the above text means that the following YANG
 enums from <span><a class="xref" href="#RFC8294">"Common YANG Data Types for the Routing Area"</a> [<a class="xref" href="#RFC8294">RFC8294</a>]</span> have had their names and
 descriptions at <span>&lt;<a href="https://www.iana.org/assignments/iana-routing-types">https://www.iana.org/assignments/iana-routing-types</a>&gt;</span> changed to:<a class="pilcrow" href="#section-11.1-3">¶</a></p>
<div id="section-11.1-4">
<pre class="sourcecode lang-yang">&lt;CODE BEGINS&gt;
   enum flow-spec-safi {
          value 133;
          description
            "Dissemination of Flow Specification rules SAFI.";
        }
   enum l3vpn-flow-spec-safi {
          value 134;
          description
            "L3VPN Dissemination of Flow Specification rules SAFI.";
        }

&lt;CODE ENDS&gt;</pre><a class="pilcrow" href="#section-11.1-4">¶</a>
</div>
<p id="section-11.1-5">A new revision statement has been added to the module as follows:<a class="pilcrow" href="#section-11.1-5">¶</a></p>
<div id="section-11.1-6">
<pre class="sourcecode lang-yang">&lt;CODE BEGINS&gt;
   revision 2020-12-31 {
     description "Non-backwards-compatible change of SAFI names
                  (SAFI values 133, 134).";
     reference
       "RFC 8955: Dissemination of Flow Specification Rules.";
  }

&lt;CODE ENDS&gt;</pre><a class="pilcrow" href="#section-11.1-6">¶</a>
</div>
</section>
<section id="section-11.2">
        <h3 id="name-flow-component-definitions">
<a class="section-number selfRef" href="#section-11.2">11.2. </a><a class="section-name selfRef" href="#name-flow-component-definitions">Flow Component Definitions</a>
        </h3>
<p id="section-11.2-1">
      A Flow Specification consists of a sequence of flow components, which
      are identified by an 8-bit component type. IANA has created and maintains
      a registry entitled "Flow Spec Component Types". IANA has
      updated the reference for this registry to RFC 8955. Furthermore, the
      references to the values have been updated according to the table below
      (Note: This document obsoletes both <span>[<a class="xref" href="#RFC7674">RFC7674</a>]</span> and <span>[<a class="xref" href="#RFC5575">RFC5575</a>]</span>, and all references
      to those documents have been deleted from the registry.)<a class="pilcrow" href="#section-11.2-1">¶</a></p>
<span id="name-registry-flow-spec-componen"></span><div id="iana_flow_component_types">
<table class="center" id="table-10">
          <caption>
<a class="selfRef" href="#table-10">Table 10</a>:
<a class="selfRef" href="#name-registry-flow-spec-componen">Registry: Flow Spec Component Types</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Value</th>
              <th class="text-left" colspan="1" rowspan="1">Name</th>
              <th class="text-left" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">1</td>
              <td class="text-left" colspan="1" rowspan="1">Destination Prefix</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 8955</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">2</td>
              <td class="text-left" colspan="1" rowspan="1">Source Prefix</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 8955</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">3</td>
              <td class="text-left" colspan="1" rowspan="1">IP Protocol</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 8955</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">4</td>
              <td class="text-left" colspan="1" rowspan="1">Port</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 8955</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">5</td>
              <td class="text-left" colspan="1" rowspan="1">Destination port</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 8955</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">6</td>
              <td class="text-left" colspan="1" rowspan="1">Source port</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 8955</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">7</td>
              <td class="text-left" colspan="1" rowspan="1">ICMP type</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 8955</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">8</td>
              <td class="text-left" colspan="1" rowspan="1">ICMP code</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 8955</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">9</td>
              <td class="text-left" colspan="1" rowspan="1">TCP flags</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 8955</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">10</td>
              <td class="text-left" colspan="1" rowspan="1">Packet length</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 8955</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">11</td>
              <td class="text-left" colspan="1" rowspan="1">DSCP</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 8955</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">12</td>
              <td class="text-left" colspan="1" rowspan="1">Fragment</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 8955</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-11.2-3">In order to manage the limited number space and accommodate several
 usages, the following policies defined by <span>[<a class="xref" href="#RFC8126">RFC8126</a>]</span> are used:<a class="pilcrow" href="#section-11.2-3">¶</a></p>
<span id="name-flow-spec-component-types-p"></span><div id="iana_flow_component_types_policies">
<table class="center" id="table-11">
          <caption>
<a class="selfRef" href="#table-11">Table 11</a>:
<a class="selfRef" href="#name-flow-spec-component-types-p">Flow Spec Component Types Policies</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Type Values</th>
              <th class="text-left" colspan="1" rowspan="1">Policy</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">Reserved</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">[1 .. 127]</td>
              <td class="text-left" colspan="1" rowspan="1">Specification Required</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">[128 .. 254]</td>
              <td class="text-left" colspan="1" rowspan="1">Expert Review</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">255</td>
              <td class="text-left" colspan="1" rowspan="1">Reserved</td>
            </tr>
          </tbody>
        </table>
</div>
<span class="break"></span><dl class="dlNewline" id="section-11.2-5">
          <dt id="section-11.2-5.1">Guidance for Experts:</dt>
          <dd id="section-11.2-5.2" style="margin-left: 1.5em">
         The registration policy for the range 128-254 is Expert Review.  The
         experts are expected to check the clarity of purpose and use of
         the requested code points.  The experts must also verify that
         any specification produced in the IETF that requests one of
         these code points has been made available for review by the IDR
         Working Group and that any specification produced outside the
         IETF does not conflict with work that is active or already
         published within the IETF.  It must be pointed out that
         introducing new component types may break interoperability with
         existing implementations of this protocol.<a class="pilcrow" href="#section-11.2-5.2">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
<section id="section-11.3">
        <h3 id="name-extended-community-flow-spe">
<a class="section-number selfRef" href="#section-11.3">11.3. </a><a class="section-name selfRef" href="#name-extended-community-flow-spe">Extended Community Flow Specification Actions</a>
        </h3>
<p id="section-11.3-1">The Extended Community Flow Specification Action types defined in
 this document consist of two parts:<a class="pilcrow" href="#section-11.3-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.3-2.1">Type (BGP Transitive Extended Community Type)<a class="pilcrow" href="#section-11.3-2.1">¶</a>
</li>
          <li class="normal" id="section-11.3-2.2">Sub-Type<a class="pilcrow" href="#section-11.3-2.2">¶</a>
</li>
        </ul>
<p id="section-11.3-3">For the type part, IANA maintains a registry entitled "BGP
 Transitive Extended Community Types". For the purpose of this work
 (<a class="xref" href="#traffic_filtering_actions">Section 7</a>), IANA has
 updated the references as shown in the table below. (Note: This document obsoletes both <span>[<a class="xref" href="#RFC7674">RFC7674</a>]</span> and
 <span>[<a class="xref" href="#RFC5575">RFC5575</a>]</span>, and all references to those
 documents have been deleted in the 
 registry.)<a class="pilcrow" href="#section-11.3-3">¶</a></p>
<span id="name-registry-bgp-transitive-ext"></span><div id="iana_ext_comm_types">
<table class="center" id="table-12">
          <caption>
<a class="selfRef" href="#table-12">Table 12</a>:
<a class="selfRef" href="#name-registry-bgp-transitive-ext">Registry: BGP Transitive Extended Community Types</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Type Value</th>
              <th class="text-left" colspan="1" rowspan="1">Name</th>
              <th class="text-left" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0x81</td>
              <td class="text-left" colspan="1" rowspan="1">
           Generic Transitive Experimental Use Extended Community Part 2
           (Sub-Types are defined in the "Generic Transitive Experimental Use
           Extended Community Part 2 Sub-Types" Registry)
         </td>
              <td class="text-left" colspan="1" rowspan="1">RFC 8955</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0x82</td>
              <td class="text-left" colspan="1" rowspan="1">
           Generic Transitive Experimental Use Extended Community Part 3
           (Sub-Types are defined in the "Generic Transitive Experimental Use
           Extended Community Part 3 Sub-Types" Registry)
         </td>
              <td class="text-left" colspan="1" rowspan="1">RFC 8955</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-11.3-5">For the sub-type part of the Extended Community Traffic Filtering
 Actions, IANA maintains the following registries. IANA has 
 updated all names and references according to the tables below and
 assign a new value for the "Flow spec traffic-rate-packets" Sub-Type.
 (Note: This document obsoletes both <span>[<a class="xref" href="#RFC7674">RFC7674</a>]</span> and <span>[<a class="xref" href="#RFC5575">RFC5575</a>]</span>, and
 all references to those documents have been deleted from the
 registries below.)<a class="pilcrow" href="#section-11.3-5">¶</a></p>
<span id="name-registry-generic-transitive"></span><div id="iana_ext_comm_subtypes">
<table class="center" id="table-13">
          <caption>
<a class="selfRef" href="#table-13">Table 13</a>:
<a class="selfRef" href="#name-registry-generic-transitive">Registry: Generic Transitive Experimental Use Extended
          Community Sub-Types</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Sub-Type Value</th>
              <th class="text-left" colspan="1" rowspan="1">Name</th>
              <th class="text-left" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0x06</td>
              <td class="text-left" colspan="1" rowspan="1">Flow spec traffic-rate-bytes</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 8955</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0x0c</td>
              <td class="text-left" colspan="1" rowspan="1">Flow spec traffic-rate-packets</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 8955</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0x07</td>
              <td class="text-left" colspan="1" rowspan="1">Flow spec traffic-action (Use of the "Value"
       field is defined in the "Traffic Action Fields" registry)</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 8955</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0x08</td>
              <td class="text-left" colspan="1" rowspan="1">
           Flow spec rt-redirect AS-2octet format
         </td>
              <td class="text-left" colspan="1" rowspan="1">RFC 8955</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0x09</td>
              <td class="text-left" colspan="1" rowspan="1">
           Flow spec traffic-remarking
         </td>
              <td class="text-left" colspan="1" rowspan="1">RFC 8955</td>
            </tr>
          </tbody>
        </table>
</div>
<span id="name-registry-generic-transitive-"></span><div id="iana_ext_comm_subtypes2">
<table class="center" id="table-14">
          <caption>
<a class="selfRef" href="#table-14">Table 14</a>:
<a class="selfRef" href="#name-registry-generic-transitive-">Registry: Generic Transitive Experimental Use Extended
   Community Part 2 Sub-Types</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Sub-Type Value</th>
              <th class="text-left" colspan="1" rowspan="1">Name</th>
              <th class="text-left" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0x08</td>
              <td class="text-left" colspan="1" rowspan="1">
           Flow spec rt-redirect IPv4 format
         </td>
              <td class="text-left" colspan="1" rowspan="1">RFC 8955</td>
            </tr>
          </tbody>
        </table>
</div>
<span id="name-registry-generic-transitive-e"></span><div id="iana_ext_comm_subtypes3">
<table class="center" id="table-15">
          <caption>
<a class="selfRef" href="#table-15">Table 15</a>:
<a class="selfRef" href="#name-registry-generic-transitive-e">Registry: Generic Transitive Experimental Use Extended
   Community Part 3 Sub-Types</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Sub-Type Value</th>
              <th class="text-left" colspan="1" rowspan="1">Name</th>
              <th class="text-left" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0x08</td>
              <td class="text-left" colspan="1" rowspan="1">
           Flow spec rt-redirect AS-4octet format
         </td>
              <td class="text-left" colspan="1" rowspan="1">RFC 8955</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-11.3-9">
   Furthermore, IANA has updated the reference for the registries
   "Generic Transitive Experimental Use Extended Community Part 2 Sub-Types" and
   "Generic Transitive Experimental Use Extended Community Part 3 Sub-Types"
   to RFC 8955.<a class="pilcrow" href="#section-11.3-9">¶</a></p>
<p id="section-11.3-10">The "traffic-action" Extended Community (<a class="xref" href="#traffic_action_subtype">Section 7.3</a>) defined in this
 document has 46 unused bits, which can be used to convey additional
 meaning. IANA created and maintains a registry entitled "Traffic
 Action Fields".  IANA has updated the reference for this
 registry to RFC 8955. Furthermore, IANA has updated
 the references according to the table below. These values should be
 assigned via IETF Review rules only. (Note: This document obsoletes
 both <span>[<a class="xref" href="#RFC7674">RFC7674</a>]</span> and <span>[<a class="xref" href="#RFC5575">RFC5575</a>]</span>, and all references to those
 documents have been deleted from the registry.)<a class="pilcrow" href="#section-11.3-10">¶</a></p>
<span id="name-registry-traffic-action-fie"></span><div id="iana_traffic_action_subtype">
<table class="center" id="table-16">
          <caption>
<a class="selfRef" href="#table-16">Table 16</a>:
<a class="selfRef" href="#name-registry-traffic-action-fie">Registry: Traffic Action Fields</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Bit</th>
              <th class="text-left" colspan="1" rowspan="1">Name</th>
              <th class="text-left" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">47</td>
              <td class="text-left" colspan="1" rowspan="1">Terminal Action</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 8955</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">46</td>
              <td class="text-left" colspan="1" rowspan="1">Sample</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 8955</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</section>
</div>
<div id="security_considerations">
<section id="section-12">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-12">12. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<p id="section-12-1"> As long as Flow Specifications are restricted to match the
      corresponding unicast routing paths for the relevant prefixes (<a class="xref" href="#validation_procedure">Section 6</a>), the security
      characteristics of this proposal are equivalent to the existing security
      properties of BGP unicast routing. Any relaxation of the validation
      procedure described in <a class="xref" href="#validation_procedure">Section 6</a> may allow unwanted Flow Specifications to be
      propagated, and thus unwanted Traffic Filtering Actions may be applied to
      flows.<a class="pilcrow" href="#section-12-1">¶</a></p>
<p id="section-12-2">Where the above mechanisms are not in place, this could open the door
      to further denial-of-service attacks, such as unwanted traffic
      filtering, remarking, or redirection.<a class="pilcrow" href="#section-12-2">¶</a></p>
<p id="section-12-3">
   Deployment of specific relaxations of the validation within an
   administrative boundary of a network are useful in some networks for quickly
   distributing filters to prevent denial-of-service attacks.
    For a network to utilize this relaxation, the BGP policies must
    support additional filtering since the origin AS field is empty.
    Specifications relaxing the validation restrictions <span class="bcp14">MUST</span>
    contain security considerations that provide details on the
    required additional filtering.
    For example, the use of origin validation can provide
    enhanced filtering within an AS confederation.<a class="pilcrow" href="#section-12-3">¶</a></p>
<p id="section-12-4">
       Inter-provider routing is based on a web of trust. Neighboring
   autonomous systems are trusted to advertise valid reachability
   information. If this trust model is violated, a neighboring
   autonomous system may cause a denial-of-service attack by advertising
   reachability information for a given prefix for which it does not
   provide service (unfiltered address space hijack). Since validation of
   the Flow Specification is tied to the announcement of the best unicast
   route, the failure in the validation of best path route may prevent the
   Flow Specification from being used by a local router. Possible
   mitigations are <span>[<a class="xref" href="#RFC6811">RFC6811</a>]</span> and
   <span>[<a class="xref" href="#RFC8205">RFC8205</a>]</span>.<a class="pilcrow" href="#section-12-4">¶</a></p>
<p id="section-12-5">On Internet Exchange Points (IXPs), routes are often exchanged via
      route servers that do not extend the AS_PATH. In such cases, it is not
      possible to enforce the left-most AS in the AS_PATH to be the neighbor
      AS (the AS of the route server). Since the validation of Flow
      Specification (<a class="xref" href="#validation_procedure">Section 6</a>)
      depends on this, additional care must be taken. It is advised to use a
      strict inbound route policy in such scenarios.<a class="pilcrow" href="#section-12-5">¶</a></p>
<p id="section-12-6"> Enabling firewall-like capabilities in routers without centralized
      management could make certain failures harder to diagnose.  For example,
      it is possible to allow TCP packets to pass between a pair of addresses
      but not ICMP packets.  It is also possible to permit packets smaller
      than 900 or greater than 1000 octets to pass between a pair of addresses
      but not packets whose length is in the range 900-1000.  Such behavior
      may be confusing, and these capabilities should be used with care whether
      manually configured or coordinated through the protocol extensions
      described in this document.<a class="pilcrow" href="#section-12-6">¶</a></p>
<p id="section-12-7">Flow Specification BGP speakers (e.g., automated DDoS controllers) not
      properly programmed, algorithms that are not performing as expected, or
      simply rogue systems may announce unintended Flow Specifications, send
      updates at a high rate, or generate a high number of Flow
      Specifications. This may stress the receiving systems, exceed their
      capacity, or lead to unwanted Traffic Filtering Actions being applied to
      flows.<a class="pilcrow" href="#section-12-7">¶</a></p>
<p id="section-12-8">
  Systems may not be able to locate all header values
  required to identify a packet. This can be especially problematic
  in the case of fragmented packets that are not the first fragment
  and thus lack upper-layer protocol headers or Encapsulating Security
  Payload (ESP) NULL <span>[<a class="xref" href="#RFC4303">RFC4303</a>]</span> encryption.<a class="pilcrow" href="#section-12-8">¶</a></p>
<p id="section-12-9"> While the general verification of the Flow Specification NLRI is
      specified in this document (<a class="xref" href="#validation_procedure">Section 6</a>), the Traffic Filtering Actions received by a third
      party may need custom verification or filtering. In particular, all
      non-traffic-rate actions may allow a third party to modify packet
      forwarding 
      properties and potentially gain access to other routing-tables/VPNs or
      undesired queues. This can be avoided by proper filtering/screening of
      the Traffic Filtering Action communities at network borders and only
      exposing a predefined subset of Traffic Filtering Actions (see <a class="xref" href="#traffic_filtering_actions">Section 7</a>) to third
      parties. One way to achieve this is by mapping user-defined communities,
      which can be set by the third party, to Traffic Filtering Actions and not
      accepting Traffic Filtering Action extended communities from third
      parties.<a class="pilcrow" href="#section-12-9">¶</a></p>
<p id="section-12-10">This extension adds additional information to Internet routers.
          These are limited in terms of the maximum number of data elements
          they can hold as well as the number of events they are able to
          process in a given unit of time. Service providers need to consider
          the maximum capacity of their devices and may need to limit the
          number of Flow Specifications accepted and processed.<a class="pilcrow" href="#section-12-10">¶</a></p>
</section>
</div>
<section id="section-13">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-13">13. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-13.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-13.1">13.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="IEEE.754.1985">[IEEE.754.1985]</dt>
        <dd>
<span class="refAuthor">IEEE</span>, <span class="refTitle">"Standard for Binary Floating-Point Arithmetic"</span>, <span class="seriesInfo">IEEE 754-1985</span>, <span class="seriesInfo">DOI 10.1109/IEEESTD.2019.8766229</span>, <time class="refDate" datetime="1985-08">August 1985</time>, <span>&lt;<a href="https://doi.org/10.1109/IEEESTD.2019.8766229">https://doi.org/10.1109/IEEESTD.2019.8766229</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ISO_IEC_9899">[ISO_IEC_9899]</dt>
        <dd>
<span class="refAuthor">ISO</span>, <span class="refTitle">"Information technology -- Programming languages -- C"</span>, <span class="seriesInfo">ISO/IEC 9899:2018</span>, <time class="refDate" datetime="2018-06">June 2018</time>. </dd>
<dd class="break"></dd>
<dt id="RFC0768">[RFC0768]</dt>
        <dd>
<span class="refAuthor">Postel, J.</span>, <span class="refTitle">"User Datagram Protocol"</span>, <span class="seriesInfo">STD 6</span>, <span class="seriesInfo">RFC 768</span>, <span class="seriesInfo">DOI 10.17487/RFC0768</span>, <time class="refDate" datetime="1980-08">August 1980</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc768">https://www.rfc-editor.org/info/rfc768</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC0791">[RFC0791]</dt>
        <dd>
<span class="refAuthor">Postel, J.</span>, <span class="refTitle">"Internet Protocol"</span>, <span class="seriesInfo">STD 5</span>, <span class="seriesInfo">RFC 791</span>, <span class="seriesInfo">DOI 10.17487/RFC0791</span>, <time class="refDate" datetime="1981-09">September 1981</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc791">https://www.rfc-editor.org/info/rfc791</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC0792">[RFC0792]</dt>
        <dd>
<span class="refAuthor">Postel, J.</span>, <span class="refTitle">"Internet Control Message Protocol"</span>, <span class="seriesInfo">STD 5</span>, <span class="seriesInfo">RFC 792</span>, <span class="seriesInfo">DOI 10.17487/RFC0792</span>, <time class="refDate" datetime="1981-09">September 1981</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc792">https://www.rfc-editor.org/info/rfc792</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC0793">[RFC0793]</dt>
        <dd>
<span class="refAuthor">Postel, J.</span>, <span class="refTitle">"Transmission Control Protocol"</span>, <span class="seriesInfo">STD 7</span>, <span class="seriesInfo">RFC 793</span>, <span class="seriesInfo">DOI 10.17487/RFC0793</span>, <time class="refDate" datetime="1981-09">September 1981</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc793">https://www.rfc-editor.org/info/rfc793</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time class="refDate" datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2474">[RFC2474]</dt>
        <dd>
<span class="refAuthor">Nichols, K.</span><span class="refAuthor">, Blake, S.</span><span class="refAuthor">, Baker, F.</span><span class="refAuthor">, and D. Black</span>, <span class="refTitle">"Definition of the Differentiated Services Field (DS Field) in the IPv4 and IPv6 Headers"</span>, <span class="seriesInfo">RFC 2474</span>, <span class="seriesInfo">DOI 10.17487/RFC2474</span>, <time class="refDate" datetime="1998-12">December 1998</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2474">https://www.rfc-editor.org/info/rfc2474</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4271">[RFC4271]</dt>
        <dd>
<span class="refAuthor">Rekhter, Y., Ed.</span><span class="refAuthor">, Li, T., Ed.</span><span class="refAuthor">, and S. Hares, Ed.</span>, <span class="refTitle">"A Border Gateway Protocol 4 (BGP-4)"</span>, <span class="seriesInfo">RFC 4271</span>, <span class="seriesInfo">DOI 10.17487/RFC4271</span>, <time class="refDate" datetime="2006-01">January 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4271">https://www.rfc-editor.org/info/rfc4271</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4360">[RFC4360]</dt>
        <dd>
<span class="refAuthor">Sangli, S.</span><span class="refAuthor">, Tappan, D.</span><span class="refAuthor">, and Y. Rekhter</span>, <span class="refTitle">"BGP Extended Communities Attribute"</span>, <span class="seriesInfo">RFC 4360</span>, <span class="seriesInfo">DOI 10.17487/RFC4360</span>, <time class="refDate" datetime="2006-02">February 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4360">https://www.rfc-editor.org/info/rfc4360</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4364">[RFC4364]</dt>
        <dd>
<span class="refAuthor">Rosen, E.</span><span class="refAuthor"> and Y. Rekhter</span>, <span class="refTitle">"BGP/MPLS IP Virtual Private Networks (VPNs)"</span>, <span class="seriesInfo">RFC 4364</span>, <span class="seriesInfo">DOI 10.17487/RFC4364</span>, <time class="refDate" datetime="2006-02">February 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4364">https://www.rfc-editor.org/info/rfc4364</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4456">[RFC4456]</dt>
        <dd>
<span class="refAuthor">Bates, T.</span><span class="refAuthor">, Chen, E.</span><span class="refAuthor">, and R. Chandra</span>, <span class="refTitle">"BGP Route Reflection: An Alternative to Full Mesh Internal BGP (IBGP)"</span>, <span class="seriesInfo">RFC 4456</span>, <span class="seriesInfo">DOI 10.17487/RFC4456</span>, <time class="refDate" datetime="2006-04">April 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4456">https://www.rfc-editor.org/info/rfc4456</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4760">[RFC4760]</dt>
        <dd>
<span class="refAuthor">Bates, T.</span><span class="refAuthor">, Chandra, R.</span><span class="refAuthor">, Katz, D.</span><span class="refAuthor">, and Y. Rekhter</span>, <span class="refTitle">"Multiprotocol Extensions for BGP-4"</span>, <span class="seriesInfo">RFC 4760</span>, <span class="seriesInfo">DOI 10.17487/RFC4760</span>, <time class="refDate" datetime="2007-01">January 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4760">https://www.rfc-editor.org/info/rfc4760</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5668">[RFC5668]</dt>
        <dd>
<span class="refAuthor">Rekhter, Y.</span><span class="refAuthor">, Sangli, S.</span><span class="refAuthor">, and D. Tappan</span>, <span class="refTitle">"4-Octet AS Specific BGP Extended Community"</span>, <span class="seriesInfo">RFC 5668</span>, <span class="seriesInfo">DOI 10.17487/RFC5668</span>, <time class="refDate" datetime="2009-10">October 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5668">https://www.rfc-editor.org/info/rfc5668</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7153">[RFC7153]</dt>
        <dd>
<span class="refAuthor">Rosen, E.</span><span class="refAuthor"> and Y. Rekhter</span>, <span class="refTitle">"IANA Registries for BGP Extended Communities"</span>, <span class="seriesInfo">RFC 7153</span>, <span class="seriesInfo">DOI 10.17487/RFC7153</span>, <time class="refDate" datetime="2014-03">March 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7153">https://www.rfc-editor.org/info/rfc7153</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7606">[RFC7606]</dt>
        <dd>
<span class="refAuthor">Chen, E., Ed.</span><span class="refAuthor">, Scudder, J., Ed.</span><span class="refAuthor">, Mohapatra, P.</span><span class="refAuthor">, and K. Patel</span>, <span class="refTitle">"Revised Error Handling for BGP UPDATE Messages"</span>, <span class="seriesInfo">RFC 7606</span>, <span class="seriesInfo">DOI 10.17487/RFC7606</span>, <time class="refDate" datetime="2015-08">August 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7606">https://www.rfc-editor.org/info/rfc7606</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span><span class="refAuthor">, Leiba, B.</span><span class="refAuthor">, and T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time class="refDate" datetime="2017-06">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time class="refDate" datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-13.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-13.2">13.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC4303">[RFC4303]</dt>
        <dd>
<span class="refAuthor">Kent, S.</span>, <span class="refTitle">"IP Encapsulating Security Payload (ESP)"</span>, <span class="seriesInfo">RFC 4303</span>, <span class="seriesInfo">DOI 10.17487/RFC4303</span>, <time class="refDate" datetime="2005-12">December 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4303">https://www.rfc-editor.org/info/rfc4303</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5575">[RFC5575]</dt>
        <dd>
<span class="refAuthor">Marques, P.</span><span class="refAuthor">, Sheth, N.</span><span class="refAuthor">, Raszuk, R.</span><span class="refAuthor">, Greene, B.</span><span class="refAuthor">, Mauch, J.</span><span class="refAuthor">, and D. McPherson</span>, <span class="refTitle">"Dissemination of Flow Specification Rules"</span>, <span class="seriesInfo">RFC 5575</span>, <span class="seriesInfo">DOI 10.17487/RFC5575</span>, <time class="refDate" datetime="2009-08">August 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5575">https://www.rfc-editor.org/info/rfc5575</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6811">[RFC6811]</dt>
        <dd>
<span class="refAuthor">Mohapatra, P.</span><span class="refAuthor">, Scudder, J.</span><span class="refAuthor">, Ward, D.</span><span class="refAuthor">, Bush, R.</span><span class="refAuthor">, and R. Austein</span>, <span class="refTitle">"BGP Prefix Origin Validation"</span>, <span class="seriesInfo">RFC 6811</span>, <span class="seriesInfo">DOI 10.17487/RFC6811</span>, <time class="refDate" datetime="2013-01">January 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6811">https://www.rfc-editor.org/info/rfc6811</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7674">[RFC7674]</dt>
        <dd>
<span class="refAuthor">Haas, J., Ed.</span>, <span class="refTitle">"Clarification of the Flowspec Redirect Extended Community"</span>, <span class="seriesInfo">RFC 7674</span>, <span class="seriesInfo">DOI 10.17487/RFC7674</span>, <time class="refDate" datetime="2015-10">October 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7674">https://www.rfc-editor.org/info/rfc7674</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7950">[RFC7950]</dt>
        <dd>
<span class="refAuthor">Bjorklund, M., Ed.</span>, <span class="refTitle">"The YANG 1.1 Data Modeling Language"</span>, <span class="seriesInfo">RFC 7950</span>, <span class="seriesInfo">DOI 10.17487/RFC7950</span>, <time class="refDate" datetime="2016-08">August 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7950">https://www.rfc-editor.org/info/rfc7950</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8205">[RFC8205]</dt>
        <dd>
<span class="refAuthor">Lepinski, M., Ed.</span><span class="refAuthor"> and K. Sriram, Ed.</span>, <span class="refTitle">"BGPsec Protocol Specification"</span>, <span class="seriesInfo">RFC 8205</span>, <span class="seriesInfo">DOI 10.17487/RFC8205</span>, <time class="refDate" datetime="2017-09">September 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8205">https://www.rfc-editor.org/info/rfc8205</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8294">[RFC8294]</dt>
        <dd>
<span class="refAuthor">Liu, X.</span><span class="refAuthor">, Qu, Y.</span><span class="refAuthor">, Lindem, A.</span><span class="refAuthor">, Hopps, C.</span><span class="refAuthor">, and L. Berger</span>, <span class="refTitle">"Common YANG Data Types for the Routing Area"</span>, <span class="seriesInfo">RFC 8294</span>, <span class="seriesInfo">DOI 10.17487/RFC8294</span>, <time class="refDate" datetime="2017-12">December 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8294">https://www.rfc-editor.org/info/rfc8294</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8956">[RFC8956]</dt>
      <dd>
<span class="refAuthor">Loibl, C., Ed.</span><span class="refAuthor">, Raszuk, R., Ed.</span><span class="refAuthor">, and S. Hares, Ed.</span>, <span class="refTitle">"Dissemination of Flow Specification Rules for IPv6"</span>, <span class="seriesInfo">RFC 8956</span>, <span class="seriesInfo">DOI 10.17487/RFC8956</span>, <time class="refDate" datetime="2020-12">December 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8956">https://www.rfc-editor.org/info/rfc8956</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="flow_rule_cmp_src">
<section id="section-appendix.a">
      <h2 id="name-example-python-code-flow_ru">
<a class="section-number selfRef" href="#section-appendix.a">Appendix A. </a><a class="section-name selfRef" href="#name-example-python-code-flow_ru">Example Python code: flow_rule_cmp</a>
      </h2>
<div id="section-appendix.a-1">
<pre class="sourcecode lang-python">&lt;CODE BEGINS&gt;
"""
Copyright (c) 2020 IETF Trust and the persons identified as
authors of the code.  All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, is permitted pursuant to, and subject to the license
terms contained in, the Simplified BSD License set forth in Section
4.c of the IETF Trust's Legal Provisions Relating to IETF Documents
(https://trustee.ietf.org/license-info).
"""

import itertools
import collections
import ipaddress


EQUAL = 0
A_HAS_PRECEDENCE = 1
B_HAS_PRECEDENCE = 2
IP_DESTINATION = 1
IP_SOURCE = 2

FS_component = collections.namedtuple('FS_component',
                                      'component_type op_value')


class FS_nlri(object):
    """
    FS_nlri class implementation that allows sorting.

    By calling .sort() on an array of FS_nlri objects these will be
    sorted according to the flow_rule_cmp algorithm.

    Example:
    nlri = [ FS_nlri(components=[
             FS_component(component_type=IP_DESTINATION,
                    op_value=ipaddress.ip_network('10.1.0.0/16') ),
             FS_component(component_type=4,
                    op_value=bytearray([0,1,2,3,4,5,6])),
             ]),
             FS_nlri(components=[
             FS_component(component_type=5,
                    op_value=bytearray([0,1,2,3,4,5,6])),
             FS_component(component_type=6,
                    op_value=bytearray([0,1,2,3,4,5,6])),
             ]),
           ]
    nlri.sort() # sorts the array according to the algorithm
    """
    def __init__(self, components = None):
        """
        components: list of type FS_component
        """
        self.components = components

    def __lt__(self, other):
        # use the below algorithm for sorting
        result = flow_rule_cmp(self, other)
        if result == B_HAS_PRECEDENCE:
            return True
        else:
            return False


def flow_rule_cmp(a, b):
    """
    Example of the flowspec comparison algorithm.
    """
    for comp_a, comp_b in itertools.zip_longest(a.components,
                                           b.components):
        # If a component type does not exist in one rule
        # this rule has lower precedence
        if not comp_a:
            return B_HAS_PRECEDENCE
        if not comp_b:
            return A_HAS_PRECEDENCE
        # Higher precedence for lower component type
        if comp_a.component_type &lt; comp_b.component_type:
            return A_HAS_PRECEDENCE
        if comp_a.component_type &gt; comp_b.component_type:
            return B_HAS_PRECEDENCE
        # component types are equal -&gt; type specific comparison
        if comp_a.component_type in (IP_DESTINATION, IP_SOURCE):
            # assuming comp_a.op_value, comp_b.op_value of
            # type ipaddress.IPv4Network
            if comp_a.op_value.overlaps(comp_b.op_value):
                # longest prefixlen has precedence
                if comp_a.op_value.prefixlen &gt; \
                        comp_b.op_value.prefixlen:
                    return A_HAS_PRECEDENCE
                if comp_a.op_value.prefixlen &lt; \
                        comp_b.op_value.prefixlen:
                    return B_HAS_PRECEDENCE
                # components equal -&gt; continue with next component
            elif comp_a.op_value &gt; comp_b.op_value:
                return B_HAS_PRECEDENCE
            elif comp_a.op_value &lt; comp_b.op_value:
                return A_HAS_PRECEDENCE
        else:
            # assuming comp_a.op_value, comp_b.op_value of type
            # bytearray
            if len(comp_a.op_value) == len(comp_b.op_value):
                if comp_a.op_value &gt; comp_b.op_value:
                    return B_HAS_PRECEDENCE
                if comp_a.op_value &lt; comp_b.op_value:
                    return A_HAS_PRECEDENCE
                # components equal -&gt; continue with next component
            else:
                common = min(len(comp_a.op_value),
                             len(comp_b.op_value))
                if comp_a.op_value[:common] &gt; \
                   comp_b.op_value[:common]:
                    return B_HAS_PRECEDENCE
                elif comp_a.op_value[:common] &lt; \
                        comp_b.op_value[:common]:
                    return A_HAS_PRECEDENCE
                # the first common bytes match
                elif len(comp_a.op_value) &gt; len(comp_b.op_value):
                    return A_HAS_PRECEDENCE
                else:
                    return B_HAS_PRECEDENCE
    return EQUAL

&lt;CODE ENDS&gt;</pre><a class="pilcrow" href="#section-appendix.a-1">¶</a>
</div>
</section>
</div>
<div id="rfc5575differences">
<section id="section-appendix.b">
      <h2 id="name-comparison-with-rfc-5575">
<a class="section-number selfRef" href="#section-appendix.b">Appendix B. </a><a class="section-name selfRef" href="#name-comparison-with-rfc-5575">Comparison with RFC 5575</a>
      </h2>
<p id="section-appendix.b-1">This document includes numerous editorial changes to <span>[<a class="xref" href="#RFC5575">RFC5575</a>]</span>. It also completely incorporates the
      redirect action clarification document <span>[<a class="xref" href="#RFC7674">RFC7674</a>]</span>. It is recommended to read the entire document. The
      authors, however, want to point out the following technical changes to
      <span>[<a class="xref" href="#RFC5575">RFC5575</a>]</span>:<a class="pilcrow" href="#section-appendix.b-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.b-2.1">
          <a class="xref" href="#intro">Section 1</a> introduces the Flow
 Specification NLRI. In <span>[<a class="xref" href="#RFC5575">RFC5575</a>]</span>, BGP 
 treats this NLRI as an opaque key to an entry in its databases. This specification
 has removed all references to an opaque key property. BGP
 implementations are able to understand the NLRI encoding.<a class="pilcrow" href="#section-appendix.b-2.1">¶</a>
</li>
        <li class="normal" id="section-appendix.b-2.2">
          <a class="xref" href="#numeric_operator">Section 4.2.1.1</a> defines a
 numeric operator and comparison bit combinations. In <span>[<a class="xref" href="#RFC5575">RFC5575</a>]</span>, the meaning of those bit
 combination was not explicitly defined and left open to the
 reader.<a class="pilcrow" href="#section-appendix.b-2.2">¶</a>
</li>
        <li class="normal" id="section-appendix.b-2.3">Sections <a class="xref" href="#type_3">4.2.2.3</a> - <a class="xref" href="#type_8">4.2.2.8</a>, <a class="xref" href="#type_10">4.2.2.10</a>, and <a class="xref" href="#type_11">4.2.2.11</a> make use of the above numeric
 operator. The allowed length of the comparison value was not
 consistently defined in <span>[<a class="xref" href="#RFC5575">RFC5575</a>]</span>.<a class="pilcrow" href="#section-appendix.b-2.3">¶</a>
</li>
        <li class="normal" id="section-appendix.b-2.4">
          <a class="xref" href="#traffic_filtering_actions">Section 7</a>
 defines all Traffic Filtering Action Extended Communities as
 transitive Extended Communities. <span>[<a class="xref" href="#RFC5575">RFC5575</a>]</span> defined the traffic-rate action to be
 non-transitive and did not define the transitivity of the other
 Traffic Filtering Action communities at all.<a class="pilcrow" href="#section-appendix.b-2.4">¶</a>
</li>
        <li class="normal" id="section-appendix.b-2.5">
          <a class="xref" href="#traffic_rate_in_packets">Section 7.2</a>
 introduces a new Traffic Filtering Action (traffic-rate-packets). This
 action did not exist in <span>[<a class="xref" href="#RFC5575">RFC5575</a>]</span>.<a class="pilcrow" href="#section-appendix.b-2.5">¶</a>
</li>
        <li class="normal" id="section-appendix.b-2.6">
          <a class="xref" href="#rt_redirect_action_subtype">Section 7.4</a>
 contains the same redirect actions already defined in <span>[<a class="xref" href="#RFC5575">RFC5575</a>]</span>, however, these actions have been
 renamed  to "rt-redirect" to make it clearer that the redirection is
 based on route-target. This section also completely incorporates the
 <span>[<a class="xref" href="#RFC7674">RFC7674</a>]</span> clarifications of the
 Flowspec Redirect Extended Community.<a class="pilcrow" href="#section-appendix.b-2.6">¶</a>
</li>
        <li class="normal" id="section-appendix.b-2.7">
          <a class="xref" href="#rules_action_interference">Section 7.7</a>
 contains general considerations on interfering traffic actions. <a class="xref" href="#traffic_action_subtype">Section 7.3</a> also
 cross-references <a class="xref" href="#rules_action_interference">Section 7.7</a>. <span>[<a class="xref" href="#RFC5575">RFC5575</a>]</span> did not
 mention this.<a class="pilcrow" href="#section-appendix.b-2.7">¶</a>
</li>
        <li class="normal" id="section-appendix.b-2.8">
          <a class="xref" href="#errorhandling">Section 10</a> contains new error
 handling.<a class="pilcrow" href="#section-appendix.b-2.8">¶</a>
</li>
      </ul>
</section>
</div>
<section id="section-appendix.c">
      <h2 id="name-acknowledgments">
<a class="section-name selfRef" href="#name-acknowledgments">Acknowledgments</a>
      </h2>
<p id="section-appendix.c-1">The authors would like to thank <span class="contact-name">Yakov Rekhter</span>,
      <span class="contact-name">Dennis Ferguson</span>, <span class="contact-name">Chris       Morrow</span>, <span class="contact-name">Charlie Kaufman</span>, and <span class="contact-name">David Smith</span> for their comments on the
      original <span>[<a class="xref" href="#RFC5575">RFC5575</a>]</span>.  <span class="contact-name">Chaitanya Kodeboyina</span> helped design the flow validation
      procedure, and <span class="contact-name">Steven Lin</span> and <span class="contact-name">Jim Washburn</span> ironed out all the details necessary to
      produce a working implementation in the original <span>[<a class="xref" href="#RFC5575">RFC5575</a>]</span>.<a class="pilcrow" href="#section-appendix.c-1">¶</a></p>
<p id="section-appendix.c-2">A packet rate Traffic Filtering Action was also described in a Flow
      Specification extension draft and the authors would like to thank <span class="contact-name">Wesley Eddy</span>, <span class="contact-name">Justin Dailey</span>, and
      <span class="contact-name">Gilbert Clark</span> for their work.<a class="pilcrow" href="#section-appendix.c-2">¶</a></p>
<p id="section-appendix.c-3">Additionally, the authors would like to thank <span class="contact-name">Alexander Mayrhofer</span>, <span class="contact-name">Nicolas Fevrier</span>,
      <span class="contact-name">Job Snijders</span>, <span class="contact-name">Jeffrey Haas</span>,
      and <span class="contact-name">Adam Chappell</span> for their comments and
      review.<a class="pilcrow" href="#section-appendix.c-3">¶</a></p>
</section>
<section id="section-appendix.d">
      <h2 id="name-contributors">
<a class="section-name selfRef" href="#name-contributors">Contributors</a>
      </h2>
<p id="section-appendix.d-1"><span class="contact-name">Barry Greene</span>,  <span class="contact-name">Pedro       Marques</span>, <span class="contact-name">Jared Mauch</span>, and <span class="contact-name">Nischal Sheth were</span> authors on <span>[<a class="xref" href="#RFC5575">RFC5575</a>]</span> and, therefore, are contributing authors on this
      document.<a class="pilcrow" href="#section-appendix.d-1">¶</a></p>
</section>
<div id="authors-addresses">
<section id="section-appendix.e">
      <h2 id="name-authors-addresses">
<a class="section-name selfRef" href="#name-authors-addresses">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Christoph Loibl</span></div>
<div class="left" dir="auto"><span class="org">next layer Telekom GmbH</span></div>
<div class="left" dir="auto"><span class="street-address">Mariahilfer Guertel 37/7</span></div>
<div class="left" dir="auto">
<span class="postal-code">1150</span> <span class="locality">Vienna</span>
</div>
<div class="left" dir="auto"><span class="country-name">Austria</span></div>
<div class="tel">
<span>Phone:</span>
<a class="tel" href="tel:+43%20664%201176414">+43 664 1176414</a>
</div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:cl@tix.at">cl@tix.at</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Susan Hares</span></div>
<div class="left" dir="auto"><span class="org">Huawei</span></div>
<div class="left" dir="auto"><span class="street-address">7453 Hickory Hill</span></div>
<div class="left" dir="auto">
<span class="locality">Saline</span>, <span class="region">MI</span> <span class="postal-code">48176</span>
</div>
<div class="left" dir="auto"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:shares@ndzh.com">shares@ndzh.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Robert Raszuk</span></div>
<div class="left" dir="auto"><span class="org">NTT Network Innovations</span></div>
<div class="left" dir="auto"><span class="street-address">940 Stewart Dr</span></div>
<div class="left" dir="auto">
<span class="locality">Sunnyvale</span>, <span class="region">CA</span> <span class="postal-code">94085</span>
</div>
<div class="left" dir="auto"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:robert@raszuk.net">robert@raszuk.net</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Danny McPherson</span></div>
<div class="left" dir="auto"><span class="org">Verisign</span></div>
<div class="left" dir="auto"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:dmcpherson@verisign.com">dmcpherson@verisign.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Martin Bacher</span></div>
<div class="left" dir="auto"><span class="org">T-Mobile Austria</span></div>
<div class="left" dir="auto"><span class="street-address">Rennweg 97-99</span></div>
<div class="left" dir="auto">
<span class="postal-code">1030</span> <span class="locality">Vienna</span>
</div>
<div class="left" dir="auto"><span class="country-name">Austria</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:mb.ietf@gmail.com">mb.ietf@gmail.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>