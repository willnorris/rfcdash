<html><head></head><body><pre>Internet Engineering Task Force (IETF)                    J. Merkle, Ed.
Request for Comments: 7860                     Secunet Security Networks
Obsoletes: <a href="./rfc7630">7630</a>                                               M. Lochter
Category: Standards Track                                            BSI
ISSN: 2070-1721                                               April 2016


                 <span class="h1">HMAC-SHA-2 Authentication Protocols in</span>
               <span class="h1">User-Based Security Model (USM) for SNMPv3</span>

Abstract

   This document specifies several authentication protocols based on the
   SHA-2 hash functions for the User-based Security Model (USM) for
   SNMPv3 defined in <a href="./rfc3414">RFC 3414</a>.  It obsoletes <a href="./rfc7630">RFC 7630</a>, in which the MIB
   MODULE-IDENTITY value was incorrectly specified.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="./rfc5741#section-2">Section 2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc7860">http://www.rfc-editor.org/info/rfc7860</a>.

Copyright Notice

   Copyright (c) 2016 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://www.rfc-editor.org/bcp/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.






<span class="grey">Merkle &amp; Lochter             Standards Track                    [Page 1]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-2"></span>
<span class="grey"><a href="./rfc7860">RFC 7860</a>                   HMAC-SHA-2_Auth_USM                April 2016</span>


Table of Contents

   <a href="#section-1">1</a>.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-3">3</a>
   <a href="#section-2">2</a>.  The Internet-Standard Management Framework  . . . . . . . . .   <a href="#page-3">3</a>
   <a href="#section-3">3</a>.  Conventions . . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-3">3</a>
   <a href="#section-4">4</a>.  The HMAC-SHA-2 Authentication Protocols . . . . . . . . . . .   <a href="#page-4">4</a>
     4.1.  Deviations from the HMAC-SHA-96 Authentication Protocol .   4
     <a href="#section-4.2">4.2</a>.  Processing  . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-5">5</a>
       <a href="#section-4.2.1">4.2.1</a>.  Processing an Outgoing Message  . . . . . . . . . . .   <a href="#page-6">6</a>
       <a href="#section-4.2.2">4.2.2</a>.  Processing an Incoming Message  . . . . . . . . . . .   <a href="#page-6">6</a>
   <a href="#section-5">5</a>.  Key Localization and Key Change . . . . . . . . . . . . . . .   <a href="#page-7">7</a>
   <a href="#section-6">6</a>.  Structure of the MIB Module . . . . . . . . . . . . . . . . .   <a href="#page-7">7</a>
   <a href="#section-7">7</a>.  Relationship to Other MIB Modules . . . . . . . . . . . . . .   <a href="#page-7">7</a>
     <a href="#section-7.1">7.1</a>.  Relationship to SNMP-USER-BASED-SM-MIB  . . . . . . . . .   <a href="#page-7">7</a>
     <a href="#section-7.2">7.2</a>.  Relationship to SNMP-FRAMEWORK-MIB  . . . . . . . . . . .   <a href="#page-7">7</a>
     <a href="#section-7.3">7.3</a>.  MIB Modules Required for IMPORTS  . . . . . . . . . . . .   <a href="#page-8">8</a>
   <a href="#section-8">8</a>.  Definitions . . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-8">8</a>
   <a href="#section-9">9</a>.  Security Considerations . . . . . . . . . . . . . . . . . . .  <a href="#page-10">10</a>
     <a href="#section-9.1">9.1</a>.  Use of the HMAC-SHA-2 Authentication Protocols in USM . .  <a href="#page-10">10</a>
     9.2.  Cryptographic Strength of the Authentication Protocols  .  10
     <a href="#section-9.3">9.3</a>.  Derivation of Keys from Passwords . . . . . . . . . . . .  <a href="#page-11">11</a>
     <a href="#section-9.4">9.4</a>.  Access to the SNMP-USM-HMAC-SHA2-MIB  . . . . . . . . . .  <a href="#page-11">11</a>
   <a href="#section-10">10</a>. IANA Considerations . . . . . . . . . . . . . . . . . . . . .  <a href="#page-12">12</a>
   <a href="#section-11">11</a>. References  . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-12">12</a>
     <a href="#section-11.1">11.1</a>.  Normative References . . . . . . . . . . . . . . . . . .  <a href="#page-12">12</a>
     <a href="#section-11.2">11.2</a>.  Informative References . . . . . . . . . . . . . . . . .  <a href="#page-13">13</a>
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-14">14</a>
























<span class="grey">Merkle &amp; Lochter             Standards Track                    [Page 2]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-3"></span>
<span class="grey"><a href="./rfc7860">RFC 7860</a>                   HMAC-SHA-2_Auth_USM                April 2016</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" id="section-1">1</a>.  Introduction</span>

   Within the Architecture for describing Simple Network Management
   Protocol (SNMP) Management Frameworks [<a href="./rfc3411" title='"An Architecture for Describing Simple Network Management Protocol (SNMP) Management Frameworks"'>RFC3411</a>], the User-based
   Security Model (USM) [<a href="./rfc3414" title='"User-based Security Model (USM) for version 3 of the Simple Network Management Protocol (SNMPv3)"'>RFC3414</a>] for SNMPv3 is defined as a Security
   Subsystem within an SNMP engine.  In <a href="./rfc3414">RFC 3414</a>, two different
   authentication protocols, HMAC-MD5-96 and HMAC-SHA-96, are defined
   based on the hash functions MD5 and SHA-1, respectively.

   This memo specifies new HMAC-SHA-2 authentication protocols for USM
   using a Hashed Message Authentication Code (HMAC) based on the SHA-2
   family of hash functions [<a href="#ref-SHA" title='"Secure Hash Standard (SHS)"'>SHA</a>] and truncated to 128 bits for SHA-224,
   to 192 bits for SHA-256, to 256 bits for SHA-384, and to 384 bits for
   SHA-512.  These protocols are straightforward adaptations of the
   authentication protocols HMAC-MD5-96 and HMAC-SHA-96 to the
   SHA-2-based HMAC.

   This document obsoletes <a href="./rfc7630">RFC 7630</a>, in which the MIB MODULE-IDENTITY
   value was incorrectly specified.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.%20%20The%20Internet-Standard%20Management%20Framework"></a><a class="selflink" href="#section-2" id="section-2">2</a>.  The Internet-Standard Management Framework</span>

   For a detailed overview of the documents that describe the current
   Internet-Standard Management Framework, please refer to <a href="./rfc3410#section-7">section 7 of
   RFC 3410</a> [<a href="./rfc3410" title='"Introduction and Applicability Statements for Internet- Standard Management Framework"'>RFC3410</a>].

   Managed objects are accessed via a virtual information store, termed
   the Management Information Base or MIB.  MIB objects are generally
   accessed through the Simple Network Management Protocol (SNMP).
   Objects in the MIB are defined using the mechanisms defined in the
   Structure of Management Information (SMI).  This memo specifies a MIB
   module that is compliant to the SMIv2, which is described in STD 58,
   [<a href="./rfc2578" title='"Structure of Management Information Version 2 (SMIv2)"'>RFC2578</a>], STD 58, [<a href="./rfc2579" title='"Textual Conventions for SMIv2"'>RFC2579</a>] and STD 58, [<a href="./rfc2580" title='"Conformance Statements for SMIv2"'>RFC2580</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.%20%20Conventions"></a><a class="selflink" href="#section-3" id="section-3">3</a>.  Conventions</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in <a href="https://www.rfc-editor.org/bcp/bcp14">BCP 14</a>, <a href="./rfc2119">RFC 2119</a>
   [<a href="./rfc2119" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].











<span class="grey">Merkle &amp; Lochter             Standards Track                    [Page 3]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-4"></span>
<span class="grey"><a href="./rfc7860">RFC 7860</a>                   HMAC-SHA-2_Auth_USM                April 2016</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/4.%20%20The%20HMAC-SHA-2%20Authentication%20Protocols"></a><a class="selflink" href="#section-4" id="section-4">4</a>.  The HMAC-SHA-2 Authentication Protocols</span>

   This section describes the HMAC-SHA-2 authentication protocols, which
   use the SHA-2 hash functions (described in FIPS PUB 180-4 [<a href="#ref-SHA" title='"Secure Hash Standard (SHS)"'>SHA</a>] and
   <a href="./rfc6234">RFC 6234</a> [<a href="./rfc6234" title='"US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)"'>RFC6234</a>]) in the HMAC mode (described in [<a href="./rfc2104" title='"HMAC: Keyed- Hashing for Message Authentication"'>RFC2104</a>] and
   [<a href="./rfc6234" title='"US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)"'>RFC6234</a>]), truncating the output to 128 bits for SHA-224, 192 bits
   for SHA-256, 256 bits for SHA-384, and 384 bits for SHA-512.  <a href="./rfc6234">RFC</a>
   <a href="./rfc6234">6234</a> also provides source code for all the SHA-2 algorithms and HMAC
   (without truncation).  It also includes test harness and standard
   test vectors for all the defined hash functions and HMAC examples.

   The following protocols are defined:

      usmHMAC128SHA224AuthProtocol: uses SHA-224 and truncates the
      output to 128 bits (16 octets);

      usmHMAC192SHA256AuthProtocol: uses SHA-256 and truncates the
      output to 192 bits (24 octets);

      usmHMAC256SHA384AuthProtocol: uses SHA-384 and truncates the
      output to 256 bits (32 octets);

      usmHMAC384SHA512AuthProtocol: uses SHA-512 and truncates the
      output to 384 bits (48 octets).

   Implementations conforming to this specification MUST support
   usmHMAC192SHA256AuthProtocol and SHOULD support
   usmHMAC384SHA512AuthProtocol.  The protocols
   usmHMAC128SHA224AuthProtocol and usmHMAC256SHA384AuthProtocol are
   OPTIONAL.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/4.1.%20%20Deviations%20from%20the%20HMAC-SHA-96%20Authentication%20Protocol"></a><a class="selflink" href="#section-4.1" id="section-4.1">4.1</a>.  Deviations from the HMAC-SHA-96 Authentication Protocol</span>

   All the HMAC-SHA-2 authentication protocols are straightforward
   adaptations of the HMAC-MD5-96 and HMAC-SHA-96 authentication
   protocols.  Specifically, they differ from the HMAC-MD5-96 and HMAC-
   SHA-96 authentication protocols in the following aspects:

   o  The SHA-2 hash function is used to compute the message digest in
      the HMAC computation according to <a href="./rfc2104">RFC 2104</a> and <a href="./rfc6234">RFC 6234</a>, as
      opposed to the MD5 hash function [<a href="./rfc1321" title='"The MD5 Message-Digest Algorithm"'>RFC1321</a>] and the SHA-1 hash
      function [<a href="#ref-SHA" title='"Secure Hash Standard (SHS)"'>SHA</a>] used in HMAC-MD5-96 and HMAC-SHA-96, respectively.
      Consequently, the length of the message digest prior to truncation
      is 224 bits for the SHA-224-based protocol, 256 bits for the
      SHA-256-based protocol, 384 bits for the SHA-384-based protocol,
      and 512 bits for the SHA-512-based protocol.





<span class="grey">Merkle &amp; Lochter             Standards Track                    [Page 4]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-5"></span>
<span class="grey"><a href="./rfc7860">RFC 7860</a>                   HMAC-SHA-2_Auth_USM                April 2016</span>


   o  The resulting message digest (output of HMAC) is truncated to:

      *  16 octets for usmHMAC128SHA224AuthProtocol

      *  24 octets for usmHMAC192SHA256AuthProtocol

      *  32 octets for usmHMAC256SHA384AuthProtocol

      *  48 octets for usmHMAC384SHA512AuthProtocol

      as opposed to the truncation to 12 octets in HMAC-MD5-96 and HMAC-
      SHA-96.

   o  The user's secret key to be used when calculating a digest MUST be

      *  28 octets long and derived with SHA-224 for the SHA-224-based
         protocol usmHMAC128SHA224AuthProtocol

      *  32 octets long and derived with SHA-256 for the SHA-256-based
         protocol usmHMAC192SHA256AuthProtocol

      *  48 octets long and derived with SHA-384 for the SHA-384-based
         protocol usmHMAC256SHA384AuthProtocol

      *  64 octets long and derived with SHA-512 for the SHA-512-based
         protocol usmHMAC384SHA512AuthProtocol

      as opposed to the keys being 16 and 20 octets long in HMAC-MD5-96
      and HMAC-SHA-96, respectively.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/4.2.%20%20Processing"></a><a class="selflink" href="#section-4.2" id="section-4.2">4.2</a>.  Processing</span>

   This section describes the procedures for the HMAC-SHA-2
   authentication protocols.  The descriptions are based on the
   definition of services and data elements specified for HMAC-SHA-96 in
   <a href="./rfc3414">RFC 3414</a> with the deviations listed in <a href="#section-4.1">Section 4.1</a>.

   Values of constants M (the length of the secret key in octets) and N
   (the length of the Message Authentication Code (MAC) output in
   octets), and the hash function H used below are:

      usmHMAC128SHA224AuthProtocol: M=28, N=16, H=SHA-224;

      usmHMAC192SHA256AuthProtocol: M=32, N=24, H=SHA-256;

      usmHMAC256SHA384AuthProtocol: M=48, N=32, H=SHA-384;

      usmHMAC384SHA512AuthProtocol: M=64, N=48, H=SHA-512.



<span class="grey">Merkle &amp; Lochter             Standards Track                    [Page 5]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-6"></span>
<span class="grey"><a href="./rfc7860">RFC 7860</a>                   HMAC-SHA-2_Auth_USM                April 2016</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/4.2.1.%20%20Processing%20an%20Outgoing%20Message"></a><a class="selflink" href="#section-4.2.1" id="section-4.2.1">4.2.1</a>.  Processing an Outgoing Message</span>

   This section describes the procedure followed by an SNMP engine
   whenever it must authenticate an outgoing message using one of the
   authentication protocols defined above.  Values of the constants M
   and N, and the hash function H are as defined in <a href="#section-4.2">Section 4.2</a> and are
   selected based on which authentication protocol is configured for the
   given USM usmUser Table entry.

   1.  The msgAuthenticationParameters field is set to the serialization
       of an OCTET STRING containing N zero octets; it is serialized
       according to the rules in [<a href="./rfc3417" title='"Transport Mappings for the Simple Network Management Protocol (SNMP)"'>RFC3417</a>].

   2.  Using the secret authKey of M octets, the HMAC is calculated over
       the wholeMsg according to <a href="./rfc6234">RFC 6234</a> with hash function H.

   3.  The N first octets of the above HMAC are taken as the computed
       MAC value.

   4.  The msgAuthenticationParameters field is replaced with the MAC
       obtained in the previous step.

   5.  The authenticatedWholeMsg is then returned to the caller together
       with the statusInformation indicating success.

<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/4.2.2.%20%20Processing%20an%20Incoming%20Message"></a><a class="selflink" href="#section-4.2.2" id="section-4.2.2">4.2.2</a>.  Processing an Incoming Message</span>

   This section describes the procedure followed by an SNMP engine
   whenever it must authenticate an incoming message using one of the
   HMAC-SHA-2 authentication protocols.  Values of the constants M and
   N, and the hash function H are as defined in <a href="#section-4.2">Section 4.2</a> and are
   selected based on which authentication protocol is configured for the
   given USM usmUser Table entry.

   1.  If the digest received in the msgAuthenticationParameters field
       is not N octets long, then a failure and an errorIndication
       (authenticationError) are returned to the calling module.

   2.  The MAC received in the msgAuthenticationParameters field is
       saved.

   3.  The digest in the msgAuthenticationParameters field is replaced
       by the N zero octets.

   4.  Using the secret authKey of M octets, the HMAC is calculated over
       the wholeMsg according to <a href="./rfc6234">RFC 6234</a> with hash function H.





<span class="grey">Merkle &amp; Lochter             Standards Track                    [Page 6]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-7"></span>
<span class="grey"><a href="./rfc7860">RFC 7860</a>                   HMAC-SHA-2_Auth_USM                April 2016</span>


   5.  The N first octets of the above HMAC are taken as the computed
       MAC value.

   6.  The msgAuthenticationParameters field is replaced with the MAC
       value that was saved in step 2.

   7.  The newly calculated MAC is compared with the MAC saved in step
       2.  If they do not match, then a failure and an errorIndication
       (authenticationFailure) are returned to the calling module.

   8.  The authenticatedWholeMsg and statusInformation indicating
       success are then returned to the caller.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.%20%20Key%20Localization%20and%20Key%20Change"></a><a class="selflink" href="#section-5" id="section-5">5</a>.  Key Localization and Key Change</span>

   For any of the protocols defined in <a href="#section-4">Section 4</a>, key localization and
   key change SHALL be performed according to [<a href="./rfc3414" title='"User-based Security Model (USM) for version 3 of the Simple Network Management Protocol (SNMPv3)"'>RFC3414</a>] using the same
   SHA-2 hash function as in the HMAC-SHA-2 authentication protocol.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/6.%20%20Structure%20of%20the%20MIB%20Module"></a><a class="selflink" href="#section-6" id="section-6">6</a>.  Structure of the MIB Module</span>

   The MIB module specified in this memo does not define any managed
   objects, subtrees, notifications, or tables; rather, it only defines
   object identities (for authentication protocols) under a subtree of
   an existing MIB.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/7.%20%20Relationship%20to%20Other%20MIB%20Modules"></a><a class="selflink" href="#section-7" id="section-7">7</a>.  Relationship to Other MIB Modules</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/7.1.%20%20Relationship%20to%20SNMP-USER-BASED-SM-MIB"></a><a class="selflink" href="#section-7.1" id="section-7.1">7.1</a>.  Relationship to SNMP-USER-BASED-SM-MIB</span>

   [<a id="ref-RFC3414">RFC3414</a>] specifies the MIB module for USM for SNMPv3 (SNMP-USER-
   BASED-SM-MIB), which defines authentication protocols for USM based
   on the hash functions MD5 and SHA-1, respectively.  The following MIB
   module defines new HMAC-SHA2 authentication protocols for USM based
   on the SHA-2 hash functions [<a href="#ref-SHA" title='"Secure Hash Standard (SHS)"'>SHA</a>].  The use of the HMAC-SHA2
   authentication protocols requires the usage of the objects defined in
   the SNMP-USER-BASED-SM-MIB.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/7.2.%20%20Relationship%20to%20SNMP-FRAMEWORK-MIB"></a><a class="selflink" href="#section-7.2" id="section-7.2">7.2</a>.  Relationship to SNMP-FRAMEWORK-MIB</span>

   [<a id="ref-RFC3411">RFC3411</a>] specifies the SNMP-FRAMEWORK-MIB, which defines a subtree
   snmpAuthProtocols for SNMP authentication protocols.  The following
   MIB module defines new authentication protocols in the
   snmpAuthProtocols subtree.







<span class="grey">Merkle &amp; Lochter             Standards Track                    [Page 7]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-8"></span>
<span class="grey"><a href="./rfc7860">RFC 7860</a>                   HMAC-SHA-2_Auth_USM                April 2016</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/7.3.%20%20MIB%20Modules%20Required%20for%20IMPORTS"></a><a class="selflink" href="#section-7.3" id="section-7.3">7.3</a>.  MIB Modules Required for IMPORTS</span>

   The following MIB module IMPORTS definitions from SNMPv2-SMI
   [<a href="./rfc2578" title='"Structure of Management Information Version 2 (SMIv2)"'>RFC2578</a>] and SNMP-FRAMEWORK-MIB [<a href="./rfc3411" title='"An Architecture for Describing Simple Network Management Protocol (SNMP) Management Frameworks"'>RFC3411</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/8.%20%20Definitions"></a><a class="selflink" href="#section-8" id="section-8">8</a>.  Definitions</span>

 SNMP-USM-HMAC-SHA2-MIB DEFINITIONS ::= BEGIN
    IMPORTS
       MODULE-IDENTITY, OBJECT-IDENTITY,
           mib-2 FROM SNMPv2-SMI -- <a href="./rfc2578">RFC 2578</a>
           snmpAuthProtocols FROM SNMP-FRAMEWORK-MIB; -- <a href="./rfc3411">RFC 3411</a>

snmpUsmHmacSha2MIB MODULE-IDENTITY
    LAST-UPDATED    "201604180000Z" -- 18 April 2016, midnight
    ORGANIZATION    "SNMPv3 Working Group"
    CONTACT-INFO    "WG email: OPSAWG@ietf.org
                    Subscribe:
                        <a href="https://www.ietf.org/mailman/listinfo/opsawg">https://www.ietf.org/mailman/listinfo/opsawg</a>
                    Editor:    Johannes Merkle
                               secunet Security Networks
                    Postal:    Mergenthaler Allee 77
                               D-65760 Eschborn
                               Germany
                    Phone:     +49 20154543091
                    Email:     johannes.merkle@secunet.com

                    Co-Editor: Manfred Lochter
                               Bundesamt fuer Sicherheit in der
                               Informationstechnik (BSI)
                    Postal:    Postfach 200363
                               D-53133 Bonn
                               Germany
                    Phone:     +49 228 9582 5643
                    Email:     manfred.lochter@bsi.bund.de"

    DESCRIPTION
        "Definitions of Object Identities needed for the use of
        HMAC-SHA2 Authentication Protocols by SNMP's User-based Security
        Model.

        Copyright (c) 2016 IETF Trust and the persons identified as
        authors of the code.  All rights reserved.

        Redistribution and use in source and binary forms, with or
        without modification, is permitted pursuant to, and subject
        to the license terms contained in, the Simplified BSD License
        set forth in <a href="#section-4">Section 4</a>.c of the IETF Trust's Legal Provisions



<span class="grey">Merkle &amp; Lochter             Standards Track                    [Page 8]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-9"></span>
<span class="grey"><a href="./rfc7860">RFC 7860</a>                   HMAC-SHA-2_Auth_USM                April 2016</span>


        Relating to IETF Documents
        (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>)."

    REVISION "201604180000Z" -- 18 April 2016, midnight
    DESCRIPTION
        "Version correcting the MODULE-IDENTITY value,
        published as <a href="./rfc7860">RFC 7860</a>"

    REVISION "201510140000Z" -- 14 October 2015, midnight
    DESCRIPTION
        "Initial version, published as <a href="./rfc7630">RFC 7630</a>"

    ::= { mib-2 235 }


usmHMAC128SHA224AuthProtocol OBJECT-IDENTITY
    STATUS      current
    DESCRIPTION "The Authentication Protocol
                usmHMAC128SHA224AuthProtocol uses HMAC-SHA-224 and
                truncates output to 128 bits."
    REFERENCE   "- Krawczyk, H., Bellare, M., and R. Canetti,
                HMAC: Keyed-Hashing for Message Authentication,
                <a href="./rfc2104">RFC 2104</a>.
                - National Institute of Standards and Technology,
                Secure Hash Standard (SHS), FIPS PUB 180-4, 2012."
    ::= { snmpAuthProtocols 4 }

usmHMAC192SHA256AuthProtocol OBJECT-IDENTITY
    STATUS      current
    DESCRIPTION "The Authentication Protocol
                usmHMAC192SHA256AuthProtocol uses HMAC-SHA-256 and
                truncates output to 192 bits."
    REFERENCE   "- Krawczyk, H., Bellare, M., and R. Canetti,
                HMAC: Keyed-Hashing for Message Authentication,
                <a href="./rfc2104">RFC 2104</a>.
                - National Institute of Standards and Technology,
                Secure Hash Standard (SHS), FIPS PUB 180-4, 2012."
    ::= { snmpAuthProtocols 5 }

usmHMAC256SHA384AuthProtocol OBJECT-IDENTITY
    STATUS      current
    DESCRIPTION "The Authentication Protocol
                usmHMAC256SHA384AuthProtocol uses HMAC-SHA-384 and
                truncates output to 256 bits."
    REFERENCE   "- Krawczyk, H., Bellare, M., and R. Canetti,
                HMAC: Keyed-Hashing for Message Authentication,
                <a href="./rfc2104">RFC 2104</a>.
                - National Institute of Standards and Technology,



<span class="grey">Merkle &amp; Lochter             Standards Track                    [Page 9]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-10"></span>
<span class="grey"><a href="./rfc7860">RFC 7860</a>                   HMAC-SHA-2_Auth_USM                April 2016</span>


                Secure Hash Standard (SHS), FIPS PUB 180-4, 2012."
    ::= { snmpAuthProtocols 6 }

usmHMAC384SHA512AuthProtocol OBJECT-IDENTITY
    STATUS      current
    DESCRIPTION "The Authentication Protocol
                usmHMAC384SHA512AuthProtocol uses HMAC-SHA-512 and
                truncates output to 384 bits."
    REFERENCE   "- Krawczyk, H., Bellare, M., and R. Canetti,
                HMAC: Keyed-Hashing for Message Authentication,
                <a href="./rfc2104">RFC 2104</a>.
                - National Institute of Standards and Technology,
                Secure Hash Standard (SHS), FIPS PUB 180-4, 2012."
    ::= { snmpAuthProtocols 7 }

END

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/9.%20%20Security%20Considerations"></a><a class="selflink" href="#section-9" id="section-9">9</a>.  Security Considerations</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/9.1.%20%20Use%20of%20the%20HMAC-SHA-2%20Authentication%20Protocols%20in%20USM"></a><a class="selflink" href="#section-9.1" id="section-9.1">9.1</a>.  Use of the HMAC-SHA-2 Authentication Protocols in USM</span>

   The security considerations of [<a href="./rfc3414" title='"User-based Security Model (USM) for version 3 of the Simple Network Management Protocol (SNMPv3)"'>RFC3414</a>] also apply to the HMAC-SHA-2
   authentication protocols defined in this document.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/9.2.%20%20Cryptographic%20Strength%20of%20the%20Authentication%20Protocols"></a><a class="selflink" href="#section-9.2" id="section-9.2">9.2</a>.  Cryptographic Strength of the Authentication Protocols</span>

   At the time of publication of this document, all of the HMAC-SHA-2
   authentication protocols provide a very high level of security.  The
   security of each HMAC-SHA-2 authentication protocol depends on the
   parameters used in the corresponding HMAC computation, which are the
   length of the key (if the key has maximum entropy), the size of the
   hash function's internal state, and the length of the truncated MAC.
   For the HMAC-SHA-2 authentication protocols, these values are as
   follows (values are given in bits).

   +------------------------------+---------+----------------+---------+
   |           Protocol           |   Key   |    Size of     |   MAC   |
   |                              |  length | internal state |  length |
   +------------------------------+---------+----------------+---------+
   | usmHMAC128SHA224AuthProtocol |   224   |      256       |   128   |
   | usmHMAC192SHA256AuthProtocol |   256   |      256       |   192   |
   | usmHMAC256SHA384AuthProtocol |   384   |      512       |   256   |
   | usmHMAC384SHA512AuthProtocol |   512   |      512       |   384   |
   +------------------------------+---------+----------------+---------+

    Table 1: HMAC Parameters of the HMAC-SHA-2 Authentication Protocols





<span class="grey">Merkle &amp; Lochter             Standards Track                   [Page 10]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-11"></span>
<span class="grey"><a href="./rfc7860">RFC 7860</a>                   HMAC-SHA-2_Auth_USM                April 2016</span>


   The security of the HMAC scales with both the key length and the size
   of the internal state: longer keys render key guessing attacks more
   difficult, and a larger internal state decreases the success
   probability of MAC forgeries based on internal collisions of the hash
   function.

   The role of the truncated output length is more complicated:
   according to [<a href="#ref-BCK" title='"Keyed Hash Functions for Message Authentication"'>BCK</a>], there is a trade-off in that

      by outputting less bits the attacker has less bits to predict in a
      MAC forgery but, on the other hand, the attacker also learns less
      about the output of the compression function from seeing the
      authentication tags computed by legitimate parties.

   Thus, truncation weakens the HMAC against forgery by guessing but, at
   the same time, strengthens it against chosen message attacks aiming
   at MAC forgery based on internal collisions or at key guessing.  <a href="./rfc2104">RFC</a>
   <a href="./rfc2104">2104</a> and [<a href="#ref-BCK" title='"Keyed Hash Functions for Message Authentication"'>BCK</a>] allow truncation to any length that is not less than
   half the size of the internal state.

   Further discussion of the security of the HMAC construction is given
   in <a href="./rfc2104">RFC 2104</a>.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/9.3.%20%20Derivation%20of%20Keys%20from%20Passwords"></a><a class="selflink" href="#section-9.3" id="section-9.3">9.3</a>.  Derivation of Keys from Passwords</span>

   If secret keys to be used for HMAC-SHA-2 authentication protocols are
   derived from passwords, the derivation SHOULD be performed using the
   password-to-key algorithm from <a href="./rfc3414#appendix-A.1">Appendix A.1 of RFC 3414</a> with MD5
   being replaced by the SHA-2 hash function H used in the HMAC-SHA-2
   authentication protocol.  Specifically, the password is converted
   into the required secret key by the following steps:

   o  forming a string of length 1,048,576 octets by repeating the value
      of the password as often as necessary, truncating accordingly, and
      using the resulting string as the input to the hash function H.
      The resulting digest, termed "digest1", is used in the next step.

   o  forming a second string by concatenating digest1, the SNMP
      engine's snmpEngineID value, and digest1.  This string is used as
      input to the hash function H.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/9.4.%20%20Access%20to%20the%20SNMP-USM-HMAC-SHA2-MIB"></a><a class="selflink" href="#section-9.4" id="section-9.4">9.4</a>.  Access to the SNMP-USM-HMAC-SHA2-MIB</span>

   The SNMP-USM-HMAC-SHA2-MIB module defines OBJECT IDENTIFIER values
   for use in other MIB modules.  It does not define any objects that
   can be accessed.  As such, the SNMP-USM-HMAC-SHA2-MIB does not, by
   itself, have any effect on the security of the Internet.




<span class="grey">Merkle &amp; Lochter             Standards Track                   [Page 11]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-12"></span>
<span class="grey"><a href="./rfc7860">RFC 7860</a>                   HMAC-SHA-2_Auth_USM                April 2016</span>


   The values defined in this module are expected to be used with the
   usmUserTable defined in the SNMP-USER-BASED-SM-MIB [<a href="./rfc3414" title='"User-based Security Model (USM) for version 3 of the Simple Network Management Protocol (SNMPv3)"'>RFC3414</a>].  The
   considerations in <a href="./rfc3414#section-11.5">Section 11.5 of RFC 3414</a> should be taken into
   account.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/10.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-10" id="section-10">10</a>.  IANA Considerations</span>

   IANA has assigned an OID for the MIB as follows.

             +--------------------+-------------------------+
             |     Descriptor     | OBJECT IDENTIFIER value |
             +--------------------+-------------------------+
             | snmpUsmHmacSha2MIB |      { mib-2 235 }      |
             +--------------------+-------------------------+

                            Table 2: OID of MIB

   Furthermore, IANA has assigned a value in the SnmpAuthProtocols
   registry for each of the following protocols.

           +------------------------------+-------+-----------+
           |         Description          | Value | Reference |
           +------------------------------+-------+-----------+
           | usmHMAC128SHA224AuthProtocol |   4   |  <a href="./rfc7860">RFC 7860</a> |
           | usmHMAC192SHA256AuthProtocol |   5   |  <a href="./rfc7860">RFC 7860</a> |
           | usmHMAC256SHA384AuthProtocol |   6   |  <a href="./rfc7860">RFC 7860</a> |
           | usmHMAC384SHA512AuthProtocol |   7   |  <a href="./rfc7860">RFC 7860</a> |
           +------------------------------+-------+-----------+

   Table 3: Code Points Assigned to HMAC-SHA-2 Authentication Protocols

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/11.%20%20References"></a><a class="selflink" href="#section-11" id="section-11">11</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/11.1.%20%20Normative%20References"></a><a class="selflink" href="#section-11.1" id="section-11.1">11.1</a>.  Normative References</span>

   [<a id="ref-RFC2104">RFC2104</a>]  Krawczyk, H., Bellare, M., and R. Canetti, "HMAC: Keyed-
              Hashing for Message Authentication", <a href="./rfc2104">RFC 2104</a>,
              DOI 10.17487/RFC2104, February 1997,
              &lt;<a href="http://www.rfc-editor.org/info/rfc2104">http://www.rfc-editor.org/info/rfc2104</a>&gt;.

   [<a id="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="https://www.rfc-editor.org/bcp/bcp14">BCP 14</a>, <a href="./rfc2119">RFC 2119</a>,
              DOI 10.17487/RFC2119, March 1997,
              &lt;<a href="http://www.rfc-editor.org/info/rfc2119">http://www.rfc-editor.org/info/rfc2119</a>&gt;.







<span class="grey">Merkle &amp; Lochter             Standards Track                   [Page 12]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-13"></span>
<span class="grey"><a href="./rfc7860">RFC 7860</a>                   HMAC-SHA-2_Auth_USM                April 2016</span>


   [<a id="ref-RFC2578">RFC2578</a>]  McCloghrie, K., Ed., Perkins, D., Ed., and J.
              Schoenwaelder, Ed., "Structure of Management Information
              Version 2 (SMIv2)", STD 58, <a href="./rfc2578">RFC 2578</a>,
              DOI 10.17487/RFC2578, April 1999,
              &lt;<a href="http://www.rfc-editor.org/info/rfc2578">http://www.rfc-editor.org/info/rfc2578</a>&gt;.

   [<a id="ref-RFC2579">RFC2579</a>]  McCloghrie, K., Ed., Perkins, D., Ed., and J.
              Schoenwaelder, Ed., "Textual Conventions for SMIv2",
              STD 58, <a href="./rfc2579">RFC 2579</a>, DOI 10.17487/RFC2579, April 1999,
              &lt;<a href="http://www.rfc-editor.org/info/rfc2579">http://www.rfc-editor.org/info/rfc2579</a>&gt;.

   [<a id="ref-RFC2580">RFC2580</a>]  McCloghrie, K., Ed., Perkins, D., Ed., and J.
              Schoenwaelder, Ed., "Conformance Statements for SMIv2",
              STD 58, <a href="./rfc2580">RFC 2580</a>, DOI 10.17487/RFC2580, April 1999,
              &lt;<a href="http://www.rfc-editor.org/info/rfc2580">http://www.rfc-editor.org/info/rfc2580</a>&gt;.

   [<a id="ref-RFC3414">RFC3414</a>]  Blumenthal, U. and B. Wijnen, "User-based Security Model
              (USM) for version 3 of the Simple Network Management
              Protocol (SNMPv3)", STD 62, <a href="./rfc3414">RFC 3414</a>,
              DOI 10.17487/RFC3414, December 2002,
              &lt;<a href="http://www.rfc-editor.org/info/rfc3414">http://www.rfc-editor.org/info/rfc3414</a>&gt;.

   [<a id="ref-RFC6234">RFC6234</a>]  Eastlake 3rd, D. and T. Hansen, "US Secure Hash Algorithms
              (SHA and SHA-based HMAC and HKDF)", <a href="./rfc6234">RFC 6234</a>,
              DOI 10.17487/RFC6234, May 2011,
              &lt;<a href="http://www.rfc-editor.org/info/rfc6234">http://www.rfc-editor.org/info/rfc6234</a>&gt;.

   [<a id="ref-SHA">SHA</a>]      National Institute of Standards and Technology, "Secure
              Hash Standard (SHS)", FIPS PUB 180-4,
              DOI 10.6028/NIST.FIPS.180-4, August 2015,
              &lt;<a href="http://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf">http://nvlpubs.nist.gov/nistpubs/FIPS/</a>
              <a href="http://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf">NIST.FIPS.180-4.pdf</a>&gt;.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/11.2.%20%20Informative%20References"></a><a class="selflink" href="#section-11.2" id="section-11.2">11.2</a>.  Informative References</span>

   [<a id="ref-BCK">BCK</a>]      Bellare, M., Canetti, R., and H. Krawczyk, "Keyed Hash
              Functions for Message Authentication", Advances in
              Cryptology - CRYPTO 96, Lecture Notes in Computer
              Science 1109, Springer-Verlag Berlin Heidelberg,
              DOI 10.1007/3-540-68697-5_1, 1996.

   [<a id="ref-RFC1321">RFC1321</a>]  Rivest, R., "The MD5 Message-Digest Algorithm", <a href="./rfc1321">RFC 1321</a>,
              DOI 10.17487/RFC1321, April 1992,
              &lt;<a href="http://www.rfc-editor.org/info/rfc1321">http://www.rfc-editor.org/info/rfc1321</a>&gt;.







<span class="grey">Merkle &amp; Lochter             Standards Track                   [Page 13]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-14"></span>
<span class="grey"><a href="./rfc7860">RFC 7860</a>                   HMAC-SHA-2_Auth_USM                April 2016</span>


   [<a id="ref-RFC3410">RFC3410</a>]  Case, J., Mundy, R., Partain, D., and B. Stewart,
              "Introduction and Applicability Statements for Internet-
              Standard Management Framework", <a href="./rfc3410">RFC 3410</a>,
              DOI 10.17487/RFC3410, December 2002,
              &lt;<a href="http://www.rfc-editor.org/info/rfc3410">http://www.rfc-editor.org/info/rfc3410</a>&gt;.

   [<a id="ref-RFC3411">RFC3411</a>]  Harrington, D., Presuhn, R., and B. Wijnen, "An
              Architecture for Describing Simple Network Management
              Protocol (SNMP) Management Frameworks", STD 62, <a href="./rfc3411">RFC 3411</a>,
              DOI 10.17487/RFC3411, December 2002,
              &lt;<a href="http://www.rfc-editor.org/info/rfc3411">http://www.rfc-editor.org/info/rfc3411</a>&gt;.

   [<a id="ref-RFC3417">RFC3417</a>]  Presuhn, R., Ed., "Transport Mappings for the Simple
              Network Management Protocol (SNMP)", STD 62, <a href="./rfc3417">RFC 3417</a>,
              DOI 10.17487/RFC3417, December 2002,
              &lt;<a href="http://www.rfc-editor.org/info/rfc3417">http://www.rfc-editor.org/info/rfc3417</a>&gt;.

Authors' Addresses

   Johannes Merkle (editor)
   Secunet Security Networks
   Mergenthaler Allee 77
   65760 Eschborn
   Germany

   Phone: +49 201 5454 3091
   Email: johannes.merkle@secunet.com


   Manfred Lochter
   BSI
   Postfach 200363
   53133 Bonn
   Germany

   Phone: +49 228 9582 5643
   Email: manfred.lochter@bsi.bund.de














Merkle &amp; Lochter             Standards Track                   [Page 14]
</pre>
</body></html>