<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 9427: TLS-Based Extensible Authentication Protocol (EAP) Types for Use with TLS 1.3</title>
<meta content="Alan DeKok" name="author"/>
<meta content="
       
   The Extensible Authentication Protocol-TLS (EAP-TLS) (RFC 5216) has been updated for TLS
   1.3 in RFC 9190.  Many other EAP Types
   also depend on TLS, such as EAP-Flexible Authentication via Secure Tunneling (EAP-FAST) (RFC 4851), EAP-Tunneled TLS (EAP-TTLS) (RFC 5281), the Tunnel Extensible Authentication Protocol (TEAP) (RFC 7170). It is possible that many vendor-specific EAP methods, such as the Protected Extensible Authentication Protocol (PEAP), depend on TLS as well. This document
   updates those methods in order to use the new key derivation methods
   available in TLS 1.3.  Additional changes necessitated by TLS 1.3 are also
   discussed. 
    " name="description"/>
<meta content="xml2rfc 3.17.4" name="generator"/>
<meta content="9427" name="rfc.number"/>
<!-- Generator version information:
  xml2rfc 3.17.4
    Python 3.9.15
    ConfigArgParse 1.5.3
    google-i18n-address 3.0.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.0
    platformdirs 3.8.0
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.28.0
    setuptools 44.1.1
    six 1.16.0
    wcwidth 0.2.5
    weasyprint 56.1
-->
<link href="rfc9427.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef,
.iref + a[href].internal {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://dx.doi.org/10.17487/rfc9427" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <link href="https://datatracker.ietf.org/doc/draft-ietf-emu-tls-eap-types-13" rel="prev"/>
  </head>
<body class="xml2rfc">
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9427</td>
<td class="center">TLS-Based EAP Types for Use with TLS 1.3</td>
<td class="right">June 2023</td>
</tr></thead>
<tfoot><tr>
<td class="left">DeKok</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc9427">9427</a></dd>
<dt class="label-updates">Updates:</dt>
<dd class="updates">
<a class="eref" href="https://www.rfc-editor.org/rfc/rfc4851">4851</a>, <a class="eref" href="https://www.rfc-editor.org/rfc/rfc5281">5281</a>, <a class="eref" href="https://www.rfc-editor.org/rfc/rfc7170">7170</a> </dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2023-06">June 2023</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">A. DeKok</div>
<div class="org">FreeRADIUS</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9427</h1>
<h1 id="title">TLS-Based Extensible Authentication Protocol (EAP) Types for Use with TLS 1.3</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">
   The Extensible Authentication Protocol-TLS (EAP-TLS) (RFC 5216) has been updated for TLS
   1.3 in RFC 9190.  Many other EAP Types
   also depend on TLS, such as EAP-Flexible Authentication via Secure Tunneling (EAP-FAST) (RFC 4851), EAP-Tunneled TLS (EAP-TTLS) (RFC 5281), the Tunnel Extensible Authentication Protocol (TEAP) (RFC 7170). It is possible that many vendor-specific EAP methods, such as the Protected Extensible Authentication Protocol (PEAP), depend on TLS as well. This document
   updates those methods in order to use the new key derivation methods
   available in TLS 1.3.  Additional changes necessitated by TLS 1.3 are also
   discussed.<a class="pilcrow" href="#section-abstract-1">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a class="pilcrow" href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9427">https://www.rfc-editor.org/info/rfc9427</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2023 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">▲</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p class="keepWithNext" id="section-toc.1-1.1.1"><a class="auto internal xref" href="#section-1">1</a>.  <a class="internal xref" href="#name-introduction">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p class="keepWithNext" id="section-toc.1-1.1.2.1.1"><a class="auto internal xref" href="#section-1.1">1.1</a>.  <a class="internal xref" href="#name-requirements-language">Requirements Language</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a class="auto internal xref" href="#section-2">2</a>.  <a class="internal xref" href="#name-using-tls-based-eap-methods">Using TLS-Based EAP Methods with TLS 1.3</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p class="keepWithNext" id="section-toc.1-1.2.2.1.1"><a class="auto internal xref" href="#section-2.1">2.1</a>.  <a class="internal xref" href="#name-key-derivation">Key Derivation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a class="auto internal xref" href="#section-2.2">2.2</a>.  <a class="internal xref" href="#name-teap">TEAP</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.1">
                    <p id="section-toc.1-1.2.2.2.2.1.1"><a class="auto internal xref" href="#section-2.2.1">2.2.1</a>.  <a class="internal xref" href="#name-client-certificates">Client Certificates</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a class="auto internal xref" href="#section-2.3">2.3</a>.  <a class="internal xref" href="#name-eap-fast">EAP-FAST</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.1">
                    <p id="section-toc.1-1.2.2.3.2.1.1"><a class="auto internal xref" href="#section-2.3.1">2.3.1</a>.  <a class="internal xref" href="#name-client-certificates-2">Client Certificates</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a class="auto internal xref" href="#section-2.4">2.4</a>.  <a class="internal xref" href="#name-eap-ttls">EAP-TTLS</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4.2.1">
                    <p id="section-toc.1-1.2.2.4.2.1.1"><a class="auto internal xref" href="#section-2.4.1">2.4.1</a>.  <a class="internal xref" href="#name-client-certificates-3">Client Certificates</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.5">
                <p id="section-toc.1-1.2.2.5.1"><a class="auto internal xref" href="#section-2.5">2.5</a>.  <a class="internal xref" href="#name-peap">PEAP</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.5.2.1">
                    <p id="section-toc.1-1.2.2.5.2.1.1"><a class="auto internal xref" href="#section-2.5.1">2.5.1</a>.  <a class="internal xref" href="#name-client-certificates-4">Client Certificates</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a class="auto internal xref" href="#section-3">3</a>.  <a class="internal xref" href="#name-application-data">Application Data</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a class="auto internal xref" href="#section-3.1">3.1</a>.  <a class="internal xref" href="#name-identities">Identities</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="auto internal xref" href="#section-4">4</a>.  <a class="internal xref" href="#name-resumption">Resumption</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="auto internal xref" href="#section-5">5</a>.  <a class="internal xref" href="#name-security-considerations">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a class="auto internal xref" href="#section-5.1">5.1</a>.  <a class="internal xref" href="#name-handling-of-tls-newsessiont">Handling of TLS NewSessionTicket Messages</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a class="auto internal xref" href="#section-5.2">5.2</a>.  <a class="internal xref" href="#name-protected-success-and-failu">Protected Success and Failure Indications</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="auto internal xref" href="#section-6">6</a>.  <a class="internal xref" href="#name-iana-considerations">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="auto internal xref" href="#section-7">7</a>.  <a class="internal xref" href="#name-references">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a class="auto internal xref" href="#section-7.1">7.1</a>.  <a class="internal xref" href="#name-normative-references">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a class="auto internal xref" href="#section-7.2">7.2</a>.  <a class="internal xref" href="#name-informative-references">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="auto internal xref" href="#appendix-A"></a><a class="internal xref" href="#name-acknowledgments">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="auto internal xref" href="#appendix-B"></a><a class="internal xref" href="#name-authors-address">Author's Address</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="sect-1">
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">
   EAP-TLS has been updated for TLS 1.3 in <span>[<a class="cite xref" href="#RFC9190">RFC9190</a>]</span>. Many other EAP
   Types also depend on TLS, such as EAP-FAST <span>[<a class="cite xref" href="#RFC4851">RFC4851</a>]</span>, EAP-TTLS
   <span>[<a class="cite xref" href="#RFC5281">RFC5281</a>]</span>, and TEAP <span>[<a class="cite xref" href="#RFC7170">RFC7170</a>]</span>. It is possible that many vendor-specific EAP
   methods, such as PEAP <span>[<a class="cite xref" href="#I-D.josefsson-pppext-eap-tls-eap">PEAP</a>]</span>, depend on TLS as well.  All of these methods use key derivation
   functions that are no longer applicable to TLS 1.3; thus, these methods are incompatible with TLS 1.3.<a class="pilcrow" href="#section-1-1">¶</a></p>
<p id="section-1-2">
   This document updates these methods in order to be used with TLS 1.3.
   These changes involve defining new key derivation functions.  We also
   discuss implementation issues in order to highlight differences
   between TLS 1.3 and earlier versions of TLS.<a class="pilcrow" href="#section-1-2">¶</a></p>
<div id="sect-1.1">
<section id="section-1.1">
        <h3 id="name-requirements-language">
<a class="section-number selfRef" href="#section-1.1">1.1. </a><a class="section-name selfRef" href="#name-requirements-language">Requirements Language</a>
        </h3>
<p id="section-1.1-1">
    The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
    "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
    described in BCP 14 <span>[<a class="cite xref" href="#RFC2119">RFC2119</a>]</span> <span>[<a class="cite xref" href="#RFC8174">RFC8174</a>]</span> 
    when, and only when, they appear in all capitals, as shown here.<a class="pilcrow" href="#section-1.1-1">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-2">
<section id="section-2">
      <h2 id="name-using-tls-based-eap-methods">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-using-tls-based-eap-methods">Using TLS-Based EAP Methods with TLS 1.3</a>
      </h2>
<p id="section-2-1">
   In general, all of the requirements in <span>[<a class="cite xref" href="#RFC9190">RFC9190</a>]</span> apply to other EAP
   methods that wish to use TLS 1.3.  Unless otherwise required herein,
   implementations of EAP methods that wish to use TLS 1.3 <span class="bcp14">MUST</span> follow
   the guidelines in <span>[<a class="cite xref" href="#RFC9190">RFC9190</a>]</span>.<a class="pilcrow" href="#section-2-1">¶</a></p>
<p id="section-2-2">
   There remain some differences between EAP-TLS and other TLS-based EAP
   methods that are addressed by this document.  The main difference is
   that <span>[<a class="cite xref" href="#RFC9190">RFC9190</a>]</span> uses the EAP-TLS Type (value 0x0D) in a number of
   calculations, whereas other method types will use their own Type
   value instead of the EAP-TLS Type value.  This topic is discussed
   further in <a class="auto internal xref" href="#sect-2.1">Section 2.1</a>.<a class="pilcrow" href="#section-2-2">¶</a></p>
<p id="section-2-3">
   An additional difference is that <span>[<a class="cite xref" href="#RFC9190">RFC9190</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc9190#section-2.5">Section 2.5</a></span> requires the EAP server to send a                               
   protected success result indication 
   once the EAP-TLS handshake has completed. This indication is composed of
   one octet (0x00) of application data.  Other TLS-based EAP methods
   also use this result indication, but only during resumption.  When
   other TLS-based EAP methods use full authentication, the result
   indication is not needed or used.  This topic is explained
   in more detail in Sections <a class="auto internal xref" href="#sect-3">3</a> and <a class="auto internal xref" href="#sect-4">4</a>.<a class="pilcrow" href="#section-2-3">¶</a></p>
<p id="section-2-4">
   Finally, this document includes clarifications on how various TLS-
   based parameters are calculated when using TLS 1.3.  These parameters
   are different for each EAP method, so they are discussed separately.<a class="pilcrow" href="#section-2-4">¶</a></p>
<div id="sect-2.1">
<section id="section-2.1">
        <h3 id="name-key-derivation">
<a class="section-number selfRef" href="#section-2.1">2.1. </a><a class="section-name selfRef" href="#name-key-derivation">Key Derivation</a>
        </h3>
<p id="section-2.1-1">
   The key derivation for TLS-based EAP methods depends on the value of
   the EAP Type as defined by <span>[<a class="cite xref" href="#IANA">IANA</a>]</span> in the "Extensible Authentication
   Protocol (EAP) Registry".  The most important definition is of the
   Type field, as first defined in <span>[<a class="cite xref" href="#RFC3748">RFC3748</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc3748#section-2">Section 2</a></span>:<a class="pilcrow" href="#section-2.1-1">¶</a></p>
<p id="section-2.1-2" style="margin-left: 1.5em">Type = value of the EAP Method type<a class="pilcrow" href="#section-2.1-2">¶</a></p>
<p id="section-2.1-3">
   For the purposes of this specification, when we refer to logical
   Type, we mean that the logical Type is defined as one octet for
   values smaller than 254 (the value for the Expanded Type). When
   Expanded EAP Types are used, the logical Type is defined as the
   concatenation of the fields required to define the Expanded Type,
   including the Type with value 0xfe, Vendor-Id (in network byte order),
 and Vendor-Type fields (in network byte order) defined in <span>[<a class="cite xref" href="#RFC3748">RFC3748</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc3748#section-5.7">Section 5.7</a></span>, as given below:<a class="pilcrow" href="#section-2.1-3">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.1-4">
<pre>Type = 0xFE || Vendor-Id || Vendor-Type
</pre><a class="pilcrow" href="#section-2.1-4">¶</a>
</div>
<p id="section-2.1-5">
   This definition does not alter the meaning of Type in <span>[<a class="cite xref" href="#RFC3748">RFC3748</a>]</span> or
   change the structure of EAP packets.  Instead, this definition allows
   us to simplify references to EAP Types by using a logical "Type"
   instead of referring to "the Type field or the Type field with value 0xfe, plus the Vendor-ID and Vendor-Type".  For example, the value of
   Type for PEAP is simply 0x19.<a class="pilcrow" href="#section-2.1-5">¶</a></p>
<p id="section-2.1-6">
   Note that unlike TLS 1.2 and earlier, the calculation of the TLS-Exporter function
   depends on the length passed to it.  Therefore, implementations <span class="bcp14">MUST</span>
   pass the correct length instead of passing a large length and
   truncating the output.  Any output calculated using a larger length
   value, which is then truncated, will be different from the output
   that was calculated using the correct length.<a class="pilcrow" href="#section-2.1-6">¶</a></p>
<p id="section-2.1-7">
   Unless otherwise discussed below, the key derivation functions for
   all TLS-based EAP Types are defined in <span>[<a class="cite xref" href="#RFC9190">RFC9190</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc9190#section-2.3">Section 2.3</a></span> and
   reproduced here for clarity.  These definitions include ones for the
   Master Session Key (MSK) and the Extended Master Session Key (EMSK):<a class="pilcrow" href="#section-2.1-7">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.1-8">
<pre>Key_Material = TLS-Exporter("EXPORTER_EAP_TLS_Key_Material",
                             Type, 128)
Method-Id    = TLS-Exporter("EXPORTER_EAP_TLS_Method-Id",
                             Type, 64)
Session-Id   = Type || Method-Id
MSK          = Key_Material(0, 63)
EMSK         = Key_Material(64, 127)
</pre><a class="pilcrow" href="#section-2.1-8">¶</a>
</div>
<p id="section-2.1-9">
   We note that these definitions reuse the EAP-TLS exporter labels
   and change the derivation only by adding a dependency on the logical
   Type.  The reason for this change is simplicity.  The inclusion of
   the EAP Type makes the derivation method specific.  There is no need
   to use different labels for different EAP Types as was done earlier.<a class="pilcrow" href="#section-2.1-9">¶</a></p>
<p id="section-2.1-10">
   These definitions apply in their entirety to EAP-TTLS <span>[<a class="cite xref" href="#RFC5281">RFC5281</a>]</span> and
   PEAP as defined in <span>[<a class="cite xref" href="#I-D.josefsson-pppext-eap-tls-eap">PEAP</a>]</span> and <span>[<a class="cite xref" href="#MSPEAP">MSPEAP</a>]</span>.  Some definitions apply to
   EAP-FAST and TEAP with exceptions as noted below.<a class="pilcrow" href="#section-2.1-10">¶</a></p>
<p id="section-2.1-11">
   It is <span class="bcp14">RECOMMENDED</span> that vendor-defined and TLS-based EAP methods use the
   above definitions for TLS 1.3.  There is no compelling reason to use
   different definitions.<a class="pilcrow" href="#section-2.1-11">¶</a></p>
</section>
</div>
<div id="sect-2.2">
<section id="section-2.2">
        <h3 id="name-teap">
<a class="section-number selfRef" href="#section-2.2">2.2. </a><a class="section-name selfRef" href="#name-teap">TEAP</a>
        </h3>
<p id="section-2.2-1">
   TEAP previously used a Protected Access Credential (PAC), which is
   functionally equivalent to session tickets provided by TLS 1.3 that
   contain a pre-shared key (PSK) along with other data. As such, the
   use of a PAC is deprecated for TEAP in TLS 1.3. PAC provisioning, as
   defined in <span>[<a class="cite xref" href="#RFC7170">RFC7170</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc7170#section-3.8.1">Section 3.8.1</a></span>, is also no longer part of TEAP
   when TLS 1.3 is used.<a class="pilcrow" href="#section-2.2-1">¶</a></p>
<p id="section-2.2-2">
   <span>[<a class="cite xref" href="#RFC7170">RFC7170</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc7170#section-5.2">Section 5.2</a></span> gives a definition for the Inner Method Session
   Key (IMSK), which depends on the TLS Pseudorandom Function (PRF) (also known as TLS-PRF).  When the j'th inner method
   generates an EMSK, we update that definition for TLS 1.3 as:<a class="pilcrow" href="#section-2.2-2">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2-3">
<pre>IMSK[j] = TLS-Exporter("TEAPbindkey@ietf.org", secret, 32)
</pre><a class="pilcrow" href="#section-2.2-3">¶</a>
</div>
<p id="section-2.2-4">
   The secret is the EMSK or MSK from the j'th inner method.  When an
   inner method does not provide an EMSK or MSK, IMSK[j] is 32 octets of
   zero.<a class="pilcrow" href="#section-2.2-4">¶</a></p>
<p id="section-2.2-5">
   The other key derivations for TEAP are given here.  All derivations
   not given here are the same as given above in the previous section.
   These derivations are also used for EAP-FAST, but using the EAP-FAST
   Type.<a class="pilcrow" href="#section-2.2-5">¶</a></p>
<p id="section-2.2-6">
   The derivation of the IMSKs, Inner Method
   Compound Keys (IMCKs), and Compound Session Keys (CMKs) is given below.<a class="pilcrow" href="#section-2.2-6">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2-7">
<pre>session_key_seed = TLS-Exporter("EXPORTER: teap session key seed",
                                Type, 40)

S-IMCK[0] = session_key_seed
For j = 1 to n-1 do
  IMCK[j] = TLS-Exporter("EXPORTER: Inner Methods Compound Keys",
                         S-IMCK[j-1] || IMSK[j], 60)
  S-IMCK[j] = first 40 octets of IMCK[j]
  CMK[j] = last 20 octets of IMCK[j]
</pre><a class="pilcrow" href="#section-2.2-7">¶</a>
</div>
<p id="section-2.2-8" style="margin-left: 1.5em">
   Note: In these definitions, || denotes concatenation.<a class="pilcrow" href="#section-2.2-8">¶</a></p>
<p id="section-2.2-9">
   In TLS 1.3, the derivation of IMCK[j] uses both a different label
   and a different order of concatenating fields than what was used by TEAP
   with TLS 1.2.  Similarly, the session_key_seed in TLS 1.3 uses the
   Type as the context. In TLS 1.2, the context was a zero-length
   field.<a class="pilcrow" href="#section-2.2-9">¶</a></p>
<p id="section-2.2-10">
   The outer MSK and EMSK are then derived from the final ("n"th) inner
 method, as follows:<a class="pilcrow" href="#section-2.2-10">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2-11">
<pre>MSK  = TLS-Exporter(
     "EXPORTER: Session Key Generating Function",
     S-IMCK[n], 64)

EMSK = TLS-Exporter(
     "EXPORTER: Extended Session Key Generating Function",
     S-IMCK[n], 64)
</pre><a class="pilcrow" href="#section-2.2-11">¶</a>
</div>
<p id="section-2.2-12">
   The TEAP Compound Message Authentication Code (MAC) defined in <span>[<a class="cite xref" href="#RFC7170">RFC7170</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc7170#section-5.3">Section 5.3</a></span> remains the
   same, but the MAC for TLS 1.3 is
   computed with the Hashed Message Authentication Code (HMAC) algorithm negotiated for the HMAC-based Key Derivation Function (HKDF) in the key
   schedule, as per <span>[<a class="cite xref" href="#RFC8446">RFC8446</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc8446#section-7.1">Section 7.1</a></span>. That is, the MAC used is
   the MAC derived from the TLS handshake:<a class="pilcrow" href="#section-2.2-12">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2-13">
<pre>Compound-MAC = MAC( CMK[n], BUFFER )
</pre><a class="pilcrow" href="#section-2.2-13">¶</a>
</div>
<p id="section-2.2-14">
where we define CMK[n] as the CMK taken from the final ("n"th) inner
   method.<a class="pilcrow" href="#section-2.2-14">¶</a></p>
<p id="section-2.2-15">
   For TLS 1.3, the MAC is computed with
   the HMAC algorithm negotiated for HKDF in the key schedule, as per <span>[<a class="cite xref" href="#RFC8446">RFC8446</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc8446#section-7.1">Section 7.1</a></span>.  

That is, the MAC used is the MAC derived
   from the TLS handshake.<a class="pilcrow" href="#section-2.2-15">¶</a></p>
<p id="section-2.2-16">
   The definition of BUFFER is unchanged from <span>[<a class="cite xref" href="#RFC7170">RFC7170</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc7170#section-5.3">Section 5.3</a></span>.<a class="pilcrow" href="#section-2.2-16">¶</a></p>
<div id="sect-2.2.1">
<section id="section-2.2.1">
          <h4 id="name-client-certificates">
<a class="section-number selfRef" href="#section-2.2.1">2.2.1. </a><a class="section-name selfRef" href="#name-client-certificates">Client Certificates</a>
          </h4>
<p id="section-2.2.1-1">
   The use of client certificates is still permitted when using TEAP
   with TLS 1.3.  However, if the client certificate is accepted, then
   the EAP peer <span class="bcp14">MUST</span> proceed with additional authentication of Phase 2,
   as per <span>[<a class="cite xref" href="#RFC7170">RFC7170</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc7170#section-7.6">Section 7.6</a></span>.  If there is no Phase 2 data, then the EAP server <span class="bcp14">MUST</span> reject the session.<a class="pilcrow" href="#section-2.2.1-1">¶</a></p>
<p id="section-2.2.1-2">
   While <span>[<a class="cite xref" href="#RFC5281">RFC5281</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc5281#section-7.6">Section 7.6</a></span> permits "authentication of the client via client certificate during phase 1, with no additional authentication or information exchange required," this practice is
   forbidden when TEAP is used with TLS 1.3.  If there is a requirement
   to use client certificates with no inner tunnel methods, then EAP-TLS
   should be used instead of TEAP.<a class="pilcrow" href="#section-2.2.1-2">¶</a></p>
<p id="section-2.2.1-3">
   <span>[<a class="cite xref" href="#RFC7170">RFC7170</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc7170#section-7.4.1">Section 7.4.1</a></span> suggests that client certificates should be
   sent in Phase 2 of the TEAP exchange "since TLS client certificates are sent in the clear".  While TLS 1.3 no longer sends client
   certificates in the clear, TEAP implementations need to distinguish
   identities for both User and Machine using the Identity-Type TLV
   (with values 1 and 2, respectively).  When a client certificate is
   sent outside of the TLS tunnel, it <span class="bcp14">MUST</span> include Identity-Type as an
   outer TLV in order to signal the type of identity which that client
   certificate is for.<a class="pilcrow" href="#section-2.2.1-3">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-2.3">
<section id="section-2.3">
        <h3 id="name-eap-fast">
<a class="section-number selfRef" href="#section-2.3">2.3. </a><a class="section-name selfRef" href="#name-eap-fast">EAP-FAST</a>
        </h3>
<p id="section-2.3-1">
   For EAP-FAST, the session_key_seed is also part of the key_block as
   defined in <span>[<a class="cite xref" href="#RFC4851">RFC4851</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc4851#section-5.1">Section 5.1</a></span>.<a class="pilcrow" href="#section-2.3-1">¶</a></p>
<p id="section-2.3-2">
   The definitions of S-IMCK[n], MSK, and EMSK are the same as given
   above for TEAP.  We reiterate that the EAP-FAST Type must be used
   when deriving the session_key_seed and not the TEAP Type.<a class="pilcrow" href="#section-2.3-2">¶</a></p>
<p id="section-2.3-3">
   Unlike <span>[<a class="cite xref" href="#RFC4851">RFC4851</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc4851#section-5.2">Section 5.2</a></span>, the definition of IMCK[j] places the
   reference to S-IMCK after the textual label and then concatenates the
   IMSK instead of the MSK.<a class="pilcrow" href="#section-2.3-3">¶</a></p>
<p id="section-2.3-4">
   EAP-FAST previously used a PAC that is functionally equivalent to
   session tickets provided by TLS 1.3, which contain a PSK along with other data. As such, the use of a PAC is deprecated
   for EAP-FAST in TLS 1.3. PAC provisioning <span>[<a class="cite xref" href="#RFC5422">RFC5422</a>]</span> is also no longer
   part of EAP-FAST when TLS 1.3 is used.<a class="pilcrow" href="#section-2.3-4">¶</a></p>
<p id="section-2.3-5">
   The T-PRF given in <span>[<a class="cite xref" href="#RFC4851">RFC4851</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc4851#section-5.5">Section 5.5</a></span> is not used for TLS 1.3.
   Instead, it is replaced with the TLS 1.3 TLS-Exporter function.<a class="pilcrow" href="#section-2.3-5">¶</a></p>
<div id="sect-2.3.1">
<section id="section-2.3.1">
          <h4 id="name-client-certificates-2">
<a class="section-number selfRef" href="#section-2.3.1">2.3.1. </a><a class="section-name selfRef" href="#name-client-certificates-2">Client Certificates</a>
          </h4>
<p id="section-2.3.1-1">
   The use of client certificates is still permitted when using EAP-FAST
   with TLS 1.3.  However, if the client certificate is accepted, then
   the EAP peer <span class="bcp14">MUST</span> proceed with additional authentication of Phase 2,
   as per <span>[<a class="cite xref" href="#RFC4851">RFC4851</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc4851#section-7.4.1">Section 7.4.1</a></span>.  If there is no Phase 2 data, then
   the EAP server <span class="bcp14">MUST</span> reject the session.<a class="pilcrow" href="#section-2.3.1-1">¶</a></p>
<p id="section-2.3.1-2">
   While <span>[<a class="cite xref" href="#RFC4851">RFC4851</a>]</span> implicitly permits the use of client
   certificates without proceeding to Phase 2, this practice is
   forbidden when EAP-FAST is used with TLS 1.3.  If there is a
   requirement to use client certificates with no inner tunnel methods,
   then EAP-TLS should be used instead of EAP-FAST.<a class="pilcrow" href="#section-2.3.1-2">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-2.4">
<section id="section-2.4">
        <h3 id="name-eap-ttls">
<a class="section-number selfRef" href="#section-2.4">2.4. </a><a class="section-name selfRef" href="#name-eap-ttls">EAP-TTLS</a>
        </h3>
<p id="section-2.4-1">
   <span>[<a class="cite xref" href="#RFC5281">RFC5281</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc5281#section-11.1">Section 11.1</a></span> defines an implicit challenge when the inner
   methods of the Challenge Handshake Authentication Protocol (CHAP) <span>[<a class="cite xref" href="#RFC1994">RFC1994</a>]</span>, MS-CHAP <span>[<a class="cite xref" href="#RFC2433">RFC2433</a>]</span>, or MS-CHAPv2 <span>[<a class="cite xref" href="#RFC2759">RFC2759</a>]</span>
   are used.  The derivation for TLS 1.3 is instead given as:<a class="pilcrow" href="#section-2.4-1">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.4-2">
<pre>EAP-TTLS_challenge = TLS-Exporter("ttls challenge",, n)
</pre><a class="pilcrow" href="#section-2.4-2">¶</a>
</div>
<p id="section-2.4-3">
   There is no "context_value" (<span>[<a class="cite xref" href="#RFC8446">RFC8446</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc8446#section-7.5">Section 7.5</a></span>) passed to the
   TLS-Exporter function.  The value "n" given here is the length of the
   data required; <span>[<a class="cite xref" href="#RFC5281">RFC5281</a>]</span> requires it to be 17 octets for CHAP
   (<span>[<a class="cite xref" href="#RFC5281">RFC5281</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc5281#section-11.2.2">Section 11.2.2</a></span>) and MS-CHAPv2 (<span>[<a class="cite xref" href="#RFC5281">RFC5281</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc5281#section-11.2.4">Section 11.2.4</a></span>), and 9 octets
   for MS-CHAP (<span>[<a class="cite xref" href="#RFC5281">RFC5281</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc5281#section-11.2.3">Section 11.2.3</a></span>).<a class="pilcrow" href="#section-2.4-3">¶</a></p>
<p id="section-2.4-4">
   When the Password Authentication Protocol (PAP), CHAP, or MS-CHAPv1 are used as inner authentication
   methods, there is no opportunity for the EAP server to send a
   protected success indication, as is done in <span>[<a class="cite xref" href="#RFC9190">RFC9190</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc9190#section-2.5">Section 2.5</a></span>.
   Instead, when TLS session tickets are disabled, the response from the
   EAP server <span class="bcp14">MUST</span> be either EAP-Success or EAP-Failure.  These
   responses are unprotected and can be forged by a skilled attacker.<a class="pilcrow" href="#section-2.4-4">¶</a></p>
<p id="section-2.4-5">
   Where TLS session tickets are enabled, the response from the EAP
   server may also continue TLS negotiation with a TLS NewSessionTicket
   message.  Since this message is protected by TLS, it can serve as the
   protected success indication.<a class="pilcrow" href="#section-2.4-5">¶</a></p>
<p id="section-2.4-6">
   Therefore, it is <span class="bcp14">RECOMMENDED</span> that EAP servers always send a TLS
   NewSessionTicket message, even if resumption is not configured.  When
   the EAP peer attempts to use the ticket, the EAP server can instead
   request a full authentication. As noted earlier, implementations
   <span class="bcp14">SHOULD NOT</span> send TLS NewSessionTicket messages until the "inner tunnel" authentication has completed in order to take full advantage
   of the message as a protected success indication.<a class="pilcrow" href="#section-2.4-6">¶</a></p>
<p id="section-2.4-7">
   When resumption is not used, the TLS NewSessionTicket message is not
   available and some authentication methods will not have a protected
   success indication.  While we would like to always have a protected
   success indication, limitations of the underlying protocols,
   implementations, and deployment requirements make that impossible.<a class="pilcrow" href="#section-2.4-7">¶</a></p>
<p id="section-2.4-8">
   EAP peers <span class="bcp14">MUST</span> continue running their EAP state machine until they
   receive either an EAP-Success or an EAP-Failure.  Receiving a TLS
   NewSessionTicket message in response to inner method PAP, CHAP, or
   MS-CHAP authentication is normal and <span class="bcp14">MUST NOT</span> be treated as a
   failure.<a class="pilcrow" href="#section-2.4-8">¶</a></p>
<div id="sect-2.4.1">
<section id="section-2.4.1">
          <h4 id="name-client-certificates-3">
<a class="section-number selfRef" href="#section-2.4.1">2.4.1. </a><a class="section-name selfRef" href="#name-client-certificates-3">Client Certificates</a>
          </h4>
<p id="section-2.4.1-1">
   <span>[<a class="cite xref" href="#RFC5281">RFC5281</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc5281#section-7.6">Section 7.6</a></span> permits "authentication of the client via client certificate during phase 1, with no additional authentication or information exchange required." This practice is forbidden when
   EAP-TTLS is used with TLS 1.3.  If there is a requirement to use
   client certificates with no inner tunnel methods, then EAP-TLS should
   be used instead of EAP-TTLS.<a class="pilcrow" href="#section-2.4.1-1">¶</a></p>
<p id="section-2.4.1-2">
   The use of client certificates is still permitted when using EAP-TTLS
   with TLS 1.3.  However, if the client certificate is accepted, then
   the EAP peer <span class="bcp14">MUST</span> proceed with additional authentication of Phase 2,
   as per <span>[<a class="cite xref" href="#RFC5281">RFC5281</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc5281#section-7.2">Section 7.2</a></span>.  If there is no Phase 2
   data, then the EAP server <span class="bcp14">MUST</span> reject the session.<a class="pilcrow" href="#section-2.4.1-2">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-2.5">
<section id="section-2.5">
        <h3 id="name-peap">
<a class="section-number selfRef" href="#section-2.5">2.5. </a><a class="section-name selfRef" href="#name-peap">PEAP</a>
        </h3>
<p id="section-2.5-1">
   When PEAP uses crypto binding, it uses a different key calculation
   defined in <span>[<a class="cite xref" href="#PEAP-MPPE">PEAP-MPPE</a>]</span> that consumes inner EAP method keying
   material. The PRF+ function used in <span>[<a class="cite xref" href="#PEAP-MPPE">PEAP-MPPE</a>]</span> is
   not taken from the TLS exporter but is instead calculated via a
   different method that is given in <span>[<a class="cite xref" href="#PEAP-PRF">PEAP-PRF</a>]</span>.  That derivation
   remains unchanged in this specification.<a class="pilcrow" href="#section-2.5-1">¶</a></p>
<p id="section-2.5-2">
   Note that the above derivation uses SHA-1, which may be formally
   deprecated in the near future.<a class="pilcrow" href="#section-2.5-2">¶</a></p>
<p id="section-2.5-3">
   However, the PRF+ calculation uses a PEAP
   Tunnel Key (TK), which is defined in <span>[<a class="cite xref" href="#PEAP-TK">PEAP-TK</a>]</span> as:<a class="pilcrow" href="#section-2.5-3">¶</a></p>
<blockquote id="section-2.5-4">... the TK is the first 60 octets of the Key_Material, as
      specified in <span>[<a class="cite xref" href="#RFC5216">RFC5216</a>]</span>: TLS-PRF-128 (master secret, "client EAP encryption", client.random || server.random).<a class="pilcrow" href="#section-2.5-4">¶</a>
</blockquote>
<p id="section-2.5-5">
   We note that the text in <span>[<a class="cite xref" href="#PEAP-PRF">PEAP-PRF</a>]</span> does not define Key_Material.
   Instead, it defines TK as the first octets of Key_Material and gives
   a definition of Key_Material that is appropriate for TLS versions
   before TLS 1.3.<a class="pilcrow" href="#section-2.5-5">¶</a></p>
<p id="section-2.5-6">
   For TLS 1.3, the TK should be derived from the Key_Material defined
   here in <a class="auto internal xref" href="#sect-2.1">Section 2.1</a> instead of using the TLS-PRF-128 derivation
   given in <span>[<a class="cite xref" href="#PEAP-PRF">PEAP-PRF</a>]</span>.  The method defined in <span>[<a class="cite xref" href="#PEAP-TK">PEAP-TK</a>]</span> <span class="bcp14">MUST NOT</span> be
   used.<a class="pilcrow" href="#section-2.5-6">¶</a></p>
<div id="sect-2.5.1">
<section id="section-2.5.1">
          <h4 id="name-client-certificates-4">
<a class="section-number selfRef" href="#section-2.5.1">2.5.1. </a><a class="section-name selfRef" href="#name-client-certificates-4">Client Certificates</a>
          </h4>
<p id="section-2.5.1-1">
   As with EAP-TTLS, <span>[<a class="cite xref" href="#I-D.josefsson-pppext-eap-tls-eap">PEAP</a>]</span> permits the use of client certificates in
   addition to inner tunnel methods. The practice of using client
   certificates with no "inner method" is forbidden when PEAP is used
   with TLS 1.3.  If there is a requirement to use client certificates
   with no inner tunnel methods, then EAP-TLS should be used instead of
   PEAP.<a class="pilcrow" href="#section-2.5.1-1">¶</a></p>
<p id="section-2.5.1-2">
   The use of client certificates is still permitted when using PEAP
   with TLS 1.3.  However, if the client certificate is accepted, then
   the EAP peer <span class="bcp14">MUST</span> proceed with additional authentication of the inner
   tunnel.  If there is no inner tunnel authentication data, then the
   EAP server <span class="bcp14">MUST</span> reject the session.<a class="pilcrow" href="#section-2.5.1-2">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="sect-3">
<section id="section-3">
      <h2 id="name-application-data">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-application-data">Application Data</a>
      </h2>
<p id="section-3-1">
   Unlike previous TLS versions, TLS 1.3 can continue negotiation after
   the initial TLS handshake has been completed; TLS 1.3 calls this the
   "CONNECTED" state.  Some implementations use receipt of a Finished
   message as an indication that TLS negotiation has completed and that
   an "inner tunnel" session can now be negotiated.  This assumption is
   not always correct with TLS 1.3.<a class="pilcrow" href="#section-3-1">¶</a></p>
<p id="section-3-2">
   Earlier TLS versions did not send application data along with the
   Finished message.  It was then possible for implementations to assume
   that a receipt of a Finished message also meant that there was no
   application data available and that another round trip was required.<a class="pilcrow" href="#section-3-2">¶</a></p>
<p id="section-3-3">
   This assumption is not true with TLS 1.3, and applications relying on
   that behavior will not operate correctly with TLS 1.3.<a class="pilcrow" href="#section-3-3">¶</a></p>
<p id="section-3-4">
   As a result, implementations <span class="bcp14">MUST</span> check for application data once the
   TLS session has been established.  This check <span class="bcp14">MUST</span> be performed
   before proceeding with another round trip of TLS negotiation.  TLS-
   based EAP methods, such as EAP-TTLS, PEAP, and EAP-FAST, each have
   method-specific application data that <span class="bcp14">MUST</span> be processed according to
   the EAP Type.<a class="pilcrow" href="#section-3-4">¶</a></p>
<p id="section-3-5">
   TLS 1.3 in <span>[<a class="cite xref" href="#RFC8446">RFC8446</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc8446#section-4.6.1">Section 4.6.1</a></span> also permits NewSessionTicket
   messages to be sent after the server has received the client Finished
   message, which is a change from earlier TLS versions.  This change
   can cause implementations to fail in a number of different ways due
   to a reliance on implicit behavior seen in earlier TLS versions.<a class="pilcrow" href="#section-3-5">¶</a></p>
<p id="section-3-6">
   In order to correct this failure, we require that implementations
   <span class="bcp14">MUST NOT</span> send or expect to receive application data in the TLS
   session if the underlying                      
   TLS connection is still performing negotiation.  Implementations <span class="bcp14">MUST</span> delay processing of application data
   until such time as the TLS negotiation has finished.  If the TLS
   negotiation is successful, then the application data can be examined.
   If the TLS negotiation is unsuccessful, then the application data is
   untrusted; therefore, it <span class="bcp14">MUST</span> be discarded without being examined.<a class="pilcrow" href="#section-3-6">¶</a></p>
<p id="section-3-7">
   The default for many TLS library implementations is to send a
   NewSessionTicket message immediately after or along with the
   Finished message.  This ticket could be used for resumption, even if
   the "inner tunnel" authentication has not been completed.  If the
   ticket could be used, then it could allow a malicious EAP peer to
   completely bypass the "inner tunnel" authentication.<a class="pilcrow" href="#section-3-7">¶</a></p>
<p id="section-3-8">
   Therefore, the EAP server <span class="bcp14">MUST NOT</span> permit any session ticket to
   successfully resume authentication unless the inner tunnel
   authentication has completed successfully.  The alternative would
   allow an attacker to bypass authentication by obtaining a session
   ticket, immediately closing the current session, and
   "resuming" using the session ticket.<a class="pilcrow" href="#section-3-8">¶</a></p>
<p id="section-3-9">
   To protect against that attack, implementations <span class="bcp14">SHOULD NOT</span> send
   NewSessionTicket messages until the "inner tunnel" authentication has
   completed.  There is no reason to send session tickets that will
   later be invalidated or ignored.  However, we recognize that this
   suggestion may not always be possible to implement with some
   available TLS libraries.  As such, EAP servers <span class="bcp14">MUST</span> take care to
   either invalidate or discard session tickets that are associated
   with sessions that terminate in EAP Failure.<a class="pilcrow" href="#section-3-9">¶</a></p>
<p id="section-3-10">
   The NewSessionTicket message <span class="bcp14">SHOULD</span> also be sent along with other
   application data, if possible.  Sending that message alone prolongs
   the packet exchange to no benefit.  In addition to prolonging the
   packet exchange, using a separate NewSessionTicket message can lead
   to non-interoperable implementations.<a class="pilcrow" href="#section-3-10">¶</a></p>
<p id="section-3-11">
   <span>[<a class="cite xref" href="#RFC9190">RFC9190</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc9190#section-2.5">Section 2.5</a></span> requires a protected result indication, which indicates that TLS negotiation has finished.  Methods that use
   "inner tunnel" methods <span class="bcp14">MUST</span> instead begin their "inner tunnel"
   negotiation by sending Type-specific application data.<a class="pilcrow" href="#section-3-11">¶</a></p>
<div id="sect-3.1">
<section id="section-3.1">
        <h3 id="name-identities">
<a class="section-number selfRef" href="#section-3.1">3.1. </a><a class="section-name selfRef" href="#name-identities">Identities</a>
        </h3>
<p id="section-3.1-1">
   For EAP-TLS, Sections <a class="relref" href="https://www.rfc-editor.org/rfc/rfc9190#section-2.1.3">2.1.3</a> and <a class="relref" href="https://www.rfc-editor.org/rfc/rfc9190#section-2.1.7">2.1.7</a> of <span>[<a class="cite xref" href="#RFC9190">RFC9190</a>]</span> recommend the use of
   anonymous Network Access Identifiers (NAIs) <span>[<a class="cite xref" href="#RFC7542">RFC7542</a>]</span> in the EAP
   Response/Identity packet.  However, as EAP-TLS does not send
   application data inside of the TLS tunnel, that specification does
   not address the subject of "inner" identities in tunneled EAP
   methods.  However, this subject must be addressed for the tunneled
   methods.<a class="pilcrow" href="#section-3.1-1">¶</a></p>
<p id="section-3.1-2">
   Using an anonymous NAI for the outer identity as per <span>[<a class="cite xref" href="#RFC7542">RFC7542</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc7542#section-2.4">Section 2.4</a></span> has a few benefits.  An NAI allows the EAP session to be
   routed in a AAA framework as described in <span>[<a class="cite xref" href="#RFC7542">RFC7542</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc7542#section-3">Section 3</a></span>.
   Using an anonymous realm also ensures that user identifiers are kept
   private.<a class="pilcrow" href="#section-3.1-2">¶</a></p>
<p id="section-3.1-3">
   As for the inner identity, we define it generically as the
   identification information carried inside of the TLS tunnel.  For
   PEAP, that identity may be an EAP Response/Identity.  For EAP-TTLS,
   it may be the User-Name attribute.  Vendor-specific EAP methods that
   use TLS will generally also have an inner identity.  
This identity is
   carried inside of the TLS tunnel and is therefore both routed to the
   correct destination by the outer identity and kept private by the
   use of TLS.<a class="pilcrow" href="#section-3.1-3">¶</a></p>
<p id="section-3.1-4">
   In other words, we can view the outer TLS layer of tunneled EAP
   methods as a secure transport layer that is responsible for getting
   the actual (inner) authentication credentials securely from the EAP
   peer to the EAP server.  The EAP server then uses the inner identity
   and inner authentication data to identify and authenticate a
   particular user.<a class="pilcrow" href="#section-3.1-4">¶</a></p>
<p id="section-3.1-5">
   As the authentication data is routed to the correct destination,
   there is little reason for the inner identity to also contain a
   realm.  Therefore, we have a few recommendations on the inner and
   outer identities, along with their relationship to each other.<a class="pilcrow" href="#section-3.1-5">¶</a></p>
<p id="section-3.1-6">
   The outer identity <span class="bcp14">SHOULD</span> use an anonymous NAI realm that allows
   for both user privacy and for the EAP session to be routed in a AAA
   framework as described in <span>[<a class="cite xref" href="#RFC7542">RFC7542</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc7542#section-3">Section 3</a></span>. Where NAI realms are
   not used, packets will not be routable outside of the local
   organization.<a class="pilcrow" href="#section-3.1-6">¶</a></p>
<p id="section-3.1-7">
   The inner identity <span class="bcp14">MUST NOT</span> use an anonymous NAI realm.  If anonymous
   network access is desired, EAP peers <span class="bcp14">MUST</span> use EAP-TLS without peer
   authentication, as per <span>[<a class="cite xref" href="#RFC9190">RFC9190</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc9190#section-2.1.5">Section 2.1.5</a></span>.  EAP servers <span class="bcp14">MUST</span>
   cause authentication to fail if an EAP peer uses an anonymous "inner"
   identity for any TLS-based EAP method.<a class="pilcrow" href="#section-3.1-7">¶</a></p>
<p id="section-3.1-8">
   Implementations <span class="bcp14">SHOULD NOT</span> use inner identities that contain an NAI
   realm.  Many organizations typically use only one realm for all user
   accounts.<a class="pilcrow" href="#section-3.1-8">¶</a></p>
<p id="section-3.1-9">
   However, there are situations where it is useful for an inner
   identity to contain a realm.  For example, an organization may have
   multiple independent sub-organizations, each with a different and
   unique realm.  These realms may be independent of one another, or the
   realms may be a subdomain (or subdomains) of the public outer realm.<a class="pilcrow" href="#section-3.1-9">¶</a></p>
<p id="section-3.1-10">
   In that case, an organization can configure one public "routing"
   realm and multiple separate "inner" realms.  This separation of
   realms also allows an organization to split users into logical groups
   by realm, where the "user" portion of the NAI may otherwise conflict.
   For example, "user@example.com" and "user@example.org" are different
   NAIs that can both be used as inner identities.<a class="pilcrow" href="#section-3.1-10">¶</a></p>
<p id="section-3.1-11">
   Using only one public realm both keeps internal information private
   and simplifies realm management for external entities by
   minimizing the number of realms that have to be tracked by them.<a class="pilcrow" href="#section-3.1-11">¶</a></p>
<p id="section-3.1-12">
   In most situations, routing identifiers should be associated with the
   authentication data that they are routing.  For example, if a user
   has an inner identity of "user@example.com", then it generally makes
   little sense to have an outer identity of "@example.org".  The
   authentication request would then be routed to the "example.org"
   domain, which may have no idea what to do with the credentials for
   "user@example.com".  At best, the authentication request would be
   discarded.  At worst, the "example.org" domain could harvest user
   credentials for later use in attacks on "example.com".<a class="pilcrow" href="#section-3.1-12">¶</a></p>
<p id="section-3.1-13">
   When an EAP server receives an inner identity for a realm which it
   is not authoritative, it <span class="bcp14">MUST</span> reject the authentication.  
There is no
   reason for one organization to authenticate users from a different
   (and independent) organization.<a class="pilcrow" href="#section-3.1-13">¶</a></p>
<p id="section-3.1-14">
   In addition, associating inner/outer identities from different
   organizations in the same EAP authentication session means that
   otherwise unrelated realms are tied together, which can make networks
   more fragile.<a class="pilcrow" href="#section-3.1-14">¶</a></p>
<p id="section-3.1-15">
   For example, an organization that uses a "hosted" AAA provider may
   choose to use the realm of the AAA provider as the outer identity for
   user authentication. The inner identity can then be fully qualified:
   username plus realm of the organization.  This practice may result
   in successful authentications, but it has practical difficulties.<a class="pilcrow" href="#section-3.1-15">¶</a></p>
<p id="section-3.1-16">
   Additionally, an organization may host their own AAA servers but use
   a "cloud" identity provider to hold user accounts.  In that
   situation, the organizations could try to use their own realm as
   the outer (routing) identity and then use an identity from the "cloud"
   provider as the inner identity.<a class="pilcrow" href="#section-3.1-16">¶</a></p>
<p id="section-3.1-17">
   This practice is <span class="bcp14">NOT RECOMMENDED</span>.  User accounts for an organization
   should be qualified as belonging to that organization and not to an
   unrelated third party.  
There is no reason to tie the configuration
   of user systems to public realm routing; that configuration more
   properly belongs in the network.<a class="pilcrow" href="#section-3.1-17">¶</a></p>
<p id="section-3.1-18">
   Both of these practices mean that changing "cloud" providers is
   difficult.  When such a change happens, each individual EAP peer must
   be updated with a different outer identity that points to the new
   "cloud" provider.  This process can be expensive, and some EAP peers
   may not be online when this changeover happens.  The result could be
   devices or users who are unable to obtain network access, even if all
   relevant network systems are online and functional.<a class="pilcrow" href="#section-3.1-18">¶</a></p>
<p id="section-3.1-19">
   Further, standards such as <span>[<a class="cite xref" href="#RFC7585">RFC7585</a>]</span> allow for dynamic discovery of
   home servers for authentication.  This specification has been widely
   deployed and means that there is minimal cost to routing
   authentication to a particular domain.  The authentication can also
   be routed to a particular identity provider and changed at will
   with no loss of functionality.  That specification is also scalable
   since it does not require changes to many systems when a domain
   updates its configuration.  Instead, only one thing has to change:
   the configuration of that domain.  Everything else is discovered
   dynamically.<a class="pilcrow" href="#section-3.1-19">¶</a></p>
<p id="section-3.1-20">
   That is, changing the configuration for one domain is significantly
   simpler and more scalable than changing the configuration for
   potentially millions of end-user devices.<a class="pilcrow" href="#section-3.1-20">¶</a></p>
<p id="section-3.1-21">
   We recognize that there may be existing use cases where the inner and
   outer identities use different realms.  As such, we cannot forbid
   that practice.  We hope that the discussion above shows not only why
   such practices are problematic, but how
   alternative methods are more flexible, more scalable, and are easier
   to manage.<a class="pilcrow" href="#section-3.1-21">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-4">
<section id="section-4">
      <h2 id="name-resumption">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-resumption">Resumption</a>
      </h2>
<p id="section-4-1">
   <span>[<a class="cite xref" href="#RFC9190">RFC9190</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc9190#section-2.1.3">Section 2.1.3</a></span> defines the process for resumption.  This
   process is the same for all TLS-based EAP Types.  The only practical
   difference is that the value of the Type field is different. The
   requirements on identities, use of TLS cipher suites, resumption, etc. remain unchanged from that document.<a class="pilcrow" href="#section-4-1">¶</a></p>
<p id="section-4-2">
   Note that if resumption is performed, then the EAP server <span class="bcp14">MUST</span> send
   the protected success result indication (one octet of 0x00) inside
   the TLS tunnel, as per <span>[<a class="cite xref" href="#RFC9190">RFC9190</a>]</span>.  

   The EAP peer <span class="bcp14">MUST</span> in turn check for
   the existence of the protected success result indication (one octet of
   0x00) and cause authentication to fail if that octet is not
   received.  If either the peer or the server initiates an inner tunnel
   method instead, then that method <span class="bcp14">MUST</span> be followed, and inner authentication
   <span class="bcp14">MUST NOT</span> be skipped.<a class="pilcrow" href="#section-4-2">¶</a></p>
<p id="section-4-3">
   All TLS-based EAP methods support resumption, as it is a property of
   the underlying TLS protocol.  All EAP servers and peers <span class="bcp14">MUST</span> support
   resumption for all TLS-based EAP methods.  We note that EAP servers
   and peers can still choose to not resume any particular session.  For
   example, EAP servers may forbid resumption for administrative or
   other policy reasons.<a class="pilcrow" href="#section-4-3">¶</a></p>
<p id="section-4-4">
   It is <span class="bcp14">RECOMMENDED</span> that EAP servers and peers enable resumption and
   use it where possible.  The use of resumption decreases the number of
   round trips used for authentication.  This decrease leads to lower
   latency for authentications and less load on the EAP server.
   Resumption can also lower load on external systems, such as databases
   that contain user credentials.<a class="pilcrow" href="#section-4-4">¶</a></p>
<p id="section-4-5">
   As the packet flows for resumption are essentially identical across
   all TLS-based EAP Types, it is technically possible to authenticate
   using EAP-TLS (Type 13) and then perform resumption using another
   EAP Type, such as with EAP-TTLS (Type 21).  However, there is no
   practical benefit to doing so.  It is also not clear what this
   behavior would mean or what (if any) security issues there may be
   with it.  As a result, this behavior is forbidden.<a class="pilcrow" href="#section-4-5">¶</a></p>
<p id="section-4-6">
   EAP servers therefore <span class="bcp14">MUST NOT</span> resume sessions across different EAP
   Types, and EAP servers <span class="bcp14">MUST</span> reject resumptions in which the EAP Type
   value is different from the original authentication.<a class="pilcrow" href="#section-4-6">¶</a></p>
</section>
</div>
<div id="sect-7">
<section id="section-5">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<p id="section-5-1">
   <span>[<a class="cite xref" href="#RFC9190">RFC9190</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc9190#section-5">Section 5</a></span> is included here by reference.<a class="pilcrow" href="#section-5-1">¶</a></p>
<p id="section-5-2">
   Updating the above EAP methods to use TLS 1.3 is of high importance
   for the Internet community.  Using the most recent security protocols
   can significantly improve security and privacy of a network.<a class="pilcrow" href="#section-5-2">¶</a></p>
<p id="section-5-3">
   For PEAP, some derivations use HMAC-SHA1 <span>[<a class="cite xref" href="#PEAP-MPPE">PEAP-MPPE</a>]</span>.  In the
   interests of interoperability and minimal changes, we do not change
   that derivation, as there are no known security issues with HMAC-
   SHA1.  Further, the data derived from the HMAC-SHA1 calculations is
   exchanged inside of the TLS tunnel and is visible only to users who
   have already successfully authenticated.  As such, the security risks
   are minimal.<a class="pilcrow" href="#section-5-3">¶</a></p>
<div id="sect-7.1">
<section id="section-5.1">
        <h3 id="name-handling-of-tls-newsessiont">
<a class="section-number selfRef" href="#section-5.1">5.1. </a><a class="section-name selfRef" href="#name-handling-of-tls-newsessiont">Handling of TLS NewSessionTicket Messages</a>
        </h3>
<p id="section-5.1-1">
   In some cases, client certificates are not used for TLS-based EAP
   methods.  In those cases, the user is authenticated only after
   successful completion of the inner tunnel authentication. 
 However, <span>[<a class="cite xref" href="#RFC8446">RFC8446</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc8446#section-4.6.1">Section 4.6.1</a></span> states that "at any time after the server has received the client Finished message, it <span class="bcp14">MAY</span> send a NewSessionTicket message."  This message is sent by the server before
   the inner authentication method has been run and therefore before
   the user has been authenticated.<a class="pilcrow" href="#section-5.1-1">¶</a></p>
<p id="section-5.1-2">
   This separation of data allows for a "time of use, time of check"
   security issue.  Malicious clients can begin a session and receive a
   NewSessionTicket message.  The malicious client can then abort the
   authentication session and use the obtained NewSessionTicket to
   "resume" the previous session.  
If the server allows the session to
   resume without verifying that the user had first been authenticated,
   the malicious client can then obtain network access without ever
   being authenticated.<a class="pilcrow" href="#section-5.1-2">¶</a></p>
<p id="section-5.1-3">
   As a result, EAP servers <span class="bcp14">MUST NOT</span> assume that a user has been
   authenticated simply because a TLS session is being resumed.  Even if
   a session is being resumed, an EAP server <span class="bcp14">MAY</span> have policies that
   still force the inner authentication methods to be run.  For example,
   the user's password may have expired in the time interval between
   first authentication and session resumption.<a class="pilcrow" href="#section-5.1-3">¶</a></p>
<p id="section-5.1-4">
   Therefore, the guidelines given here describe situations where an EAP
   server is permitted to allow session resumption rather than where an EAP server is
   required to allow session resumption.  An EAP server could simply
   refuse to issue session tickets or could run the full inner
   authentication, even if a session was resumed.<a class="pilcrow" href="#section-5.1-4">¶</a></p>
<p id="section-5.1-5">
   Where session tickets are used, the EAP server <span class="bcp14">SHOULD</span> track the
   successful completion of an inner authentication and associate that
   status with any session tickets issued for that session.  This
   requirement can be met in a number of different ways.<a class="pilcrow" href="#section-5.1-5">¶</a></p>
<p id="section-5.1-6">
   One way is for the EAP server to simply not send any TLS
   NewSessionTicket messages until the inner authentication has
   completed successfully.  The EAP server then knows that the existence
   of a session ticket is proof that a user was authenticated, and the
   session can be resumed.<a class="pilcrow" href="#section-5.1-6">¶</a></p>
<p id="section-5.1-7">
   Another way is for the EAP server to simply discard or invalidate any
   session tickets until after the inner authentication has completed
   successfully.  When the user is authenticated, a new TLS
   NewSessionTicket message can be sent to the client, and the new
   ticket can be cached and/or validated.<a class="pilcrow" href="#section-5.1-7">¶</a></p>
<p id="section-5.1-8">
   Another way is for the EAP server to associate the inner
   authentication status with each session ticket.  When a session
   ticket is used, the authentication status is checked.  When a session
   ticket shows that the inner authentication did not succeed, the EAP
   server <span class="bcp14">MUST</span> run the inner authentication method(s) in the resumed
   tunnel and only grant access based on the success or failure of
   those inner methods.<a class="pilcrow" href="#section-5.1-8">¶</a></p>
<p id="section-5.1-9">
   However, the interaction between EAP implementations and any
   underlying TLS library may be complex, and the EAP server may not be
   able to make the above guarantees.  Where the EAP server is unable to
   determine the user's authentication status from the session ticket, it
   <span class="bcp14">MUST</span> assume that inner authentication has not completed, and it <span class="bcp14">MUST</span>
   run the inner authentication method(s) successfully in the resumed
   tunnel before granting access.<a class="pilcrow" href="#section-5.1-9">¶</a></p>
<p id="section-5.1-10">
   This issue is not relevant for EAP-TLS, which only uses client
   certificates for authentication in the TLS handshake. It is only
   relevant for TLS-based EAP methods that do not use the TLS layer to
   authenticate.<a class="pilcrow" href="#section-5.1-10">¶</a></p>
</section>
</div>
<div id="sect-7.2">
<section id="section-5.2">
        <h3 id="name-protected-success-and-failu">
<a class="section-number selfRef" href="#section-5.2">5.2. </a><a class="section-name selfRef" href="#name-protected-success-and-failu">Protected Success and Failure Indications</a>
        </h3>
<p id="section-5.2-1">
   <span>[<a class="cite xref" href="#RFC9190">RFC9190</a>]</span> provides for protected success and failure indications as
   discussed in <span>[<a class="cite xref" href="#RFC4137">RFC4137</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc4137#section-4.1.1">Section 4.1.1</a></span>.  These result indications
   are provided for both full authentication and resumption.<a class="pilcrow" href="#section-5.2-1">¶</a></p>
<p id="section-5.2-2">
   Other TLS-based EAP methods provide these result indications only for
   resumption.<a class="pilcrow" href="#section-5.2-2">¶</a></p>
<p id="section-5.2-3">
   For full authentication, the other TLS-based EAP methods do not
   provide for protected success and failure indications as part of the
   outer TLS exchange.  That is, the protected result indication is not
   used, and there is no TLS-layer alert sent when the inner
   authentication fails.  Instead, there is simply either an EAP-Success
   or an EAP-Failure sent.  This behavior is the same as for previous TLS
   versions; therefore, it introduces no new security issues.<a class="pilcrow" href="#section-5.2-3">¶</a></p>
<p id="section-5.2-4">
   We note that most TLS-based EAP methods provide for success and
   failure indications as part of the authentication exchange performed
   inside of the TLS tunnel.  These result indications are therefore
   protected, as they cannot be modified or forged.<a class="pilcrow" href="#section-5.2-4">¶</a></p>
<p id="section-5.2-5">
   However, some inner methods do not provide for success or failure
   indications.  For example, the use of EAP-TTLS with inner PAP, CHAP,
   or MS-CHAP.  Those methods send authentication credentials to the EAP
   server via the inner tunnel with no method to signal success or
   failure inside of the tunnel.<a class="pilcrow" href="#section-5.2-5">¶</a></p>
<p id="section-5.2-6">
   There are functionally equivalent authentication methods that can be
   used to provide protected result indications.  PAP can often be
   replaced with EAP-GTC, CHAP with EAP-MD5, and MS-CHAPv1 with
   MS-CHAPv2 or EAP-MSCHAPv2.  All of the replacement methods provide for
   similar functionality and have protected success and failure
   indication.  The main cost to this change is additional round trips.<a class="pilcrow" href="#section-5.2-6">¶</a></p>
<p id="section-5.2-7">
   It is <span class="bcp14">RECOMMENDED</span> that implementations deprecate inner tunnel methods
   that do not provide protected success and failure indications when
   TLS session tickets cannot be used.  Implementations <span class="bcp14">SHOULD</span> use EAP-
   GTC instead of PAP and EAP-MD5 instead of CHAP.  Implementations
   <span class="bcp14">SHOULD</span> use MS-CHAPv2 or EAP-MSCHAPv2 instead of MS-CHAPv1.  New TLS-
   based EAP methods <span class="bcp14">MUST</span> provide protected success and failure
   indications inside of the TLS tunnel.<a class="pilcrow" href="#section-5.2-7">¶</a></p>
<p id="section-5.2-8">
   When the inner authentication protocol indicates that authentication
   has failed, then implementations <span class="bcp14">MUST</span> fail authentication for the
   entire session.  There may be additional protocol exchanges in order
   to exchange more detailed failure indications, but the final result
   <span class="bcp14">MUST</span> be a failed authentication.  As noted earlier, any session
   tickets for this failed authentication <span class="bcp14">MUST</span> be either invalidated or
   discarded.<a class="pilcrow" href="#section-5.2-8">¶</a></p>
<p id="section-5.2-9">
   Similarly, when the inner authentication protocol indicates that
   authentication has succeeded, implementations <span class="bcp14">SHOULD</span> cause
   authentication to succeed for the entire session.  There <span class="bcp14">MAY</span> be
   additional protocol exchanges that could still cause failure, so we
   cannot mandate sending success on successful authentication.<a class="pilcrow" href="#section-5.2-9">¶</a></p>
<p id="section-5.2-10">
   In both of these cases, the EAP server <span class="bcp14">MUST</span> send an EAP-Failure or
   EAP-Success message, as indicated by Step 4 in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc3748#section-2">Section 2</a> of [<a class="cite xref" href="#RFC3748">RFC3748</a>]</span>.
   Even though both parties have already determined the final
   authentication status, the full EAP state machine must still be
   followed.<a class="pilcrow" href="#section-5.2-10">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-6">
<section id="section-6">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<p id="section-6-1">                                                                                               
   This section provides guidance to the Internet Assigned Numbers                                      
   Authority (IANA) regarding the registration of values related to the                           TLS-based EAP methods for the TLS 1.3 protocol in accordance with <span>[<a class="cite xref" href="#RFC8126">RFC8126</a>]</span>.<a class="pilcrow" href="#section-6-1">¶</a></p>
<p id="section-6-2">                                                                                               
   IANA has added the following labels to the "TLS                                       
   Exporter Label" registry defined by <span>[<a class="cite xref" href="#RFC5705">RFC5705</a>]</span>.  These labels are used
   in the derivation of Key_Material and Method-Id as defined above in                                  
   <a class="auto internal xref" href="#sect-2">Section 2</a>, and they are used only for TEAP.<a class="pilcrow" href="#section-6-2">¶</a></p>
<span id="name-tls-exporter-labels-registr"></span><div id="IANA_table">
<table class="center" id="table-1">
        <caption>
<a class="selfRef" href="#table-1">Table 1</a>:
<a class="selfRef" href="#name-tls-exporter-labels-registr">TLS Exporter Labels Registry</a>
        </caption>
<thead>
          <tr>
            <th class="text-left" colspan="1" rowspan="1">Value</th>
            <th class="text-left" colspan="1" rowspan="1">DTLS-OK</th>
            <th class="text-left" colspan="1" rowspan="1">Recommended</th>
            <th class="text-left" colspan="1" rowspan="1">Reference</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">EXPORTER: teap session key seed</td>
            <td class="text-center" colspan="1" rowspan="1">N</td>
            <td class="text-center" colspan="1" rowspan="1">Y</td>
            <td class="text-center" colspan="1" rowspan="1">RFC 9427</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">EXPORTER: Inner Methods Compound Keys</td>
            <td class="text-center" colspan="1" rowspan="1">N</td>
            <td class="text-center" colspan="1" rowspan="1">Y</td>
            <td class="text-center" colspan="1" rowspan="1">RFC 9427</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">EXPORTER: Session Key Generating Function</td>
            <td class="text-center" colspan="1" rowspan="1">N</td>
            <td class="text-center" colspan="1" rowspan="1">Y</td>
            <td class="text-center" colspan="1" rowspan="1">RFC 9427</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">EXPORTER: Extended Session Key Generating Function</td>
            <td class="text-center" colspan="1" rowspan="1">N</td>
            <td class="text-center" colspan="1" rowspan="1">Y</td>
            <td class="text-center" colspan="1" rowspan="1">RFC 9427</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">TEAPbindkey@ietf.org</td>
            <td class="text-center" colspan="1" rowspan="1">N</td>
            <td class="text-center" colspan="1" rowspan="1">Y</td>
            <td class="text-center" colspan="1" rowspan="1">RFC 9427</td>
          </tr>
        </tbody>
      </table>
</div>
</section>
</div>
<section id="section-7">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-7.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-7.1">7.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="IANA">[IANA]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Method Types"</span>, <span>&lt;<a href="https://www.iana.org/assignments/eap-numbers/">https://www.iana.org/assignments/eap-numbers/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time class="refDate" datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3748">[RFC3748]</dt>
        <dd>
<span class="refAuthor">Aboba, B.</span>, <span class="refAuthor">Blunk, L.</span>, <span class="refAuthor">Vollbrecht, J.</span>, <span class="refAuthor">Carlson, J.</span>, and <span class="refAuthor">H. Levkowetz, Ed.</span>, <span class="refTitle">"Extensible Authentication Protocol (EAP)"</span>, <span class="seriesInfo">RFC 3748</span>, <span class="seriesInfo">DOI 10.17487/RFC3748</span>, <time class="refDate" datetime="2004-06">June 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3748">https://www.rfc-editor.org/info/rfc3748</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5216">[RFC5216]</dt>
        <dd>
<span class="refAuthor">Simon, D.</span>, <span class="refAuthor">Aboba, B.</span>, and <span class="refAuthor">R. Hurst</span>, <span class="refTitle">"The EAP-TLS Authentication Protocol"</span>, <span class="seriesInfo">RFC 5216</span>, <span class="seriesInfo">DOI 10.17487/RFC5216</span>, <time class="refDate" datetime="2008-03">March 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5216">https://www.rfc-editor.org/info/rfc5216</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5705">[RFC5705]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"Keying Material Exporters for Transport Layer Security (TLS)"</span>, <span class="seriesInfo">RFC 5705</span>, <span class="seriesInfo">DOI 10.17487/RFC5705</span>, <time class="refDate" datetime="2010-03">March 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5705">https://www.rfc-editor.org/info/rfc5705</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7170">[RFC7170]</dt>
        <dd>
<span class="refAuthor">Zhou, H.</span>, <span class="refAuthor">Cam-Winget, N.</span>, <span class="refAuthor">Salowey, J.</span>, and <span class="refAuthor">S. Hanna</span>, <span class="refTitle">"Tunnel Extensible Authentication Protocol (TEAP) Version 1"</span>, <span class="seriesInfo">RFC 7170</span>, <span class="seriesInfo">DOI 10.17487/RFC7170</span>, <time class="refDate" datetime="2014-05">May 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7170">https://www.rfc-editor.org/info/rfc7170</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time class="refDate" datetime="2017-06">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time class="refDate" datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time class="refDate" datetime="2018-08">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9190">[RFC9190]</dt>
      <dd>
<span class="refAuthor">Preuß Mattsson, J.</span> and <span class="refAuthor">M. Sethi</span>, <span class="refTitle">"EAP-TLS 1.3: Using the Extensible Authentication Protocol with TLS 1.3"</span>, <span class="seriesInfo">RFC 9190</span>, <span class="seriesInfo">DOI 10.17487/RFC9190</span>, <time class="refDate" datetime="2022-02">February 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9190">https://www.rfc-editor.org/info/rfc9190</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-7.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-7.2">7.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="MSPEAP">[MSPEAP]</dt>
        <dd>
<span class="refAuthor">Microsoft Corporation</span>, <span class="refTitle">"[MS-PEAP]: Protected Extensible Authentication Protocol (PEAP)"</span>, <span class="refContent">Protocol Revision 31.0</span>, <time class="refDate" datetime="2021-06">June 2021</time>, <span>&lt;<a href="https://msdn.microsoft.com/en-us/library/cc238354.aspx">https://msdn.microsoft.com/en-us/library/cc238354.aspx</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.josefsson-pppext-eap-tls-eap">[PEAP]</dt>
        <dd>
<span class="refAuthor">Palekar, A.</span>, <span class="refAuthor">Josefsson, S.</span>, <span class="refAuthor">Simon, D.</span>, <span class="refAuthor">Zorn, G.</span>, <span class="refAuthor">Salowey, J.</span>, and <span class="refAuthor">H. Zhou</span>, <span class="refTitle">"Protected EAP Protocol (PEAP) Version 2"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-josefsson-pppext-eap-tls-eap-10</span>, <time class="refDate" datetime="2004-10-15">15 October 2004</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-josefsson-pppext-eap-tls-eap-10">https://datatracker.ietf.org/doc/html/draft-josefsson-pppext-eap-tls-eap-10</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="PEAP-MPPE">[PEAP-MPPE]</dt>
        <dd>
<span class="refAuthor">Microsoft Corporation</span>, <span class="refTitle">"Key Management"</span>, <span class="refContent">Section 3.1.5.7</span>, <time class="refDate" datetime="2020-10">October 2020</time>, <span>&lt;<a href="https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-peap/e75b0385-915a-4fc3-a549-fd3d06b995b0">https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-peap/e75b0385-915a-4fc3-a549-fd3d06b995b0</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="PEAP-PRF">[PEAP-PRF]</dt>
        <dd>
<span class="refAuthor">Microsoft Corporation</span>, <span class="refTitle">"Intermediate PEAP MAC Key (IPMK) and Compound MAC Key (CMK)"</span>, <span class="refContent">Section 3.1.5.5.2.2</span>, <time class="refDate" datetime="2019-02">February 2019</time>, <span>&lt;<a href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/MS-PEAP/0de54161-0bd3-424a-9b1a-854b4040a6df">https://docs.microsoft.com/en-us/openspecs/windows_protocols/MS-PEAP/0de54161-0bd3-424a-9b1a-854b4040a6df</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="PEAP-TK">[PEAP-TK]</dt>
        <dd>
<span class="refAuthor">Microsoft Corporation</span>, <span class="refTitle">"PEAP Tunnel Key (TK)"</span>, <span class="refContent">Section 3.1.5.5.2.1</span>, <time class="refDate" datetime="2021-04">April 2021</time>, <span>&lt;<a href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/MS-PEAP/41288c09-3d7d-482f-a57f-e83691d4d246">https://docs.microsoft.com/en-us/openspecs/windows_protocols/MS-PEAP/41288c09-3d7d-482f-a57f-e83691d4d246</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1994">[RFC1994]</dt>
        <dd>
<span class="refAuthor">Simpson, W.</span>, <span class="refTitle">"PPP Challenge Handshake Authentication Protocol (CHAP)"</span>, <span class="seriesInfo">RFC 1994</span>, <span class="seriesInfo">DOI 10.17487/RFC1994</span>, <time class="refDate" datetime="1996-08">August 1996</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1994">https://www.rfc-editor.org/info/rfc1994</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2433">[RFC2433]</dt>
        <dd>
<span class="refAuthor">Zorn, G.</span> and <span class="refAuthor">S. Cobb</span>, <span class="refTitle">"Microsoft PPP CHAP Extensions"</span>, <span class="seriesInfo">RFC 2433</span>, <span class="seriesInfo">DOI 10.17487/RFC2433</span>, <time class="refDate" datetime="1998-10">October 1998</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2433">https://www.rfc-editor.org/info/rfc2433</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2759">[RFC2759]</dt>
        <dd>
<span class="refAuthor">Zorn, G.</span>, <span class="refTitle">"Microsoft PPP CHAP Extensions, Version 2"</span>, <span class="seriesInfo">RFC 2759</span>, <span class="seriesInfo">DOI 10.17487/RFC2759</span>, <time class="refDate" datetime="2000-01">January 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2759">https://www.rfc-editor.org/info/rfc2759</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4137">[RFC4137]</dt>
        <dd>
<span class="refAuthor">Vollbrecht, J.</span>, <span class="refAuthor">Eronen, P.</span>, <span class="refAuthor">Petroni, N.</span>, and <span class="refAuthor">Y. Ohba</span>, <span class="refTitle">"State Machines for Extensible Authentication Protocol (EAP) Peer and Authenticator"</span>, <span class="seriesInfo">RFC 4137</span>, <span class="seriesInfo">DOI 10.17487/RFC4137</span>, <time class="refDate" datetime="2005-08">August 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4137">https://www.rfc-editor.org/info/rfc4137</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4851">[RFC4851]</dt>
        <dd>
<span class="refAuthor">Cam-Winget, N.</span>, <span class="refAuthor">McGrew, D.</span>, <span class="refAuthor">Salowey, J.</span>, and <span class="refAuthor">H. Zhou</span>, <span class="refTitle">"The Flexible Authentication via Secure Tunneling Extensible Authentication Protocol Method (EAP-FAST)"</span>, <span class="seriesInfo">RFC 4851</span>, <span class="seriesInfo">DOI 10.17487/RFC4851</span>, <time class="refDate" datetime="2007-05">May 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4851">https://www.rfc-editor.org/info/rfc4851</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5281">[RFC5281]</dt>
        <dd>
<span class="refAuthor">Funk, P.</span> and <span class="refAuthor">S. Blake-Wilson</span>, <span class="refTitle">"Extensible Authentication Protocol Tunneled Transport Layer Security Authenticated Protocol Version 0 (EAP-TTLSv0)"</span>, <span class="seriesInfo">RFC 5281</span>, <span class="seriesInfo">DOI 10.17487/RFC5281</span>, <time class="refDate" datetime="2008-08">August 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5281">https://www.rfc-editor.org/info/rfc5281</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5422">[RFC5422]</dt>
        <dd>
<span class="refAuthor">Cam-Winget, N.</span>, <span class="refAuthor">McGrew, D.</span>, <span class="refAuthor">Salowey, J.</span>, and <span class="refAuthor">H. Zhou</span>, <span class="refTitle">"Dynamic Provisioning Using Flexible Authentication via Secure Tunneling Extensible Authentication Protocol (EAP-FAST)"</span>, <span class="seriesInfo">RFC 5422</span>, <span class="seriesInfo">DOI 10.17487/RFC5422</span>, <time class="refDate" datetime="2009-03">March 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5422">https://www.rfc-editor.org/info/rfc5422</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7542">[RFC7542]</dt>
        <dd>
<span class="refAuthor">DeKok, A.</span>, <span class="refTitle">"The Network Access Identifier"</span>, <span class="seriesInfo">RFC 7542</span>, <span class="seriesInfo">DOI 10.17487/RFC7542</span>, <time class="refDate" datetime="2015-05">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7542">https://www.rfc-editor.org/info/rfc7542</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7585">[RFC7585]</dt>
      <dd>
<span class="refAuthor">Winter, S.</span> and <span class="refAuthor">M. McCauley</span>, <span class="refTitle">"Dynamic Peer Discovery for RADIUS/TLS and RADIUS/DTLS Based on the Network Access Identifier (NAI)"</span>, <span class="seriesInfo">RFC 7585</span>, <span class="seriesInfo">DOI 10.17487/RFC7585</span>, <time class="refDate" datetime="2015-10">October 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7585">https://www.rfc-editor.org/info/rfc7585</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="acknowledgments">
<section id="appendix-A">
      <h2 id="name-acknowledgments">
<a class="section-name selfRef" href="#name-acknowledgments">Acknowledgments</a>
      </h2>
<p id="appendix-A-1">
   Thanks to <span class="contact-name">Jorge Vergara</span> for a detailed review of the requirements for
   various EAP Types.<a class="pilcrow" href="#appendix-A-1">¶</a></p>
<p id="appendix-A-2">
   Thanks to <span class="contact-name">Jorge Vergara</span>, <span class="contact-name">Bruno Periera Vidal</span>, <span class="contact-name">Alexander Clouter</span>,
   <span class="contact-name">Karri Huhtanen</span>, and <span class="contact-name">Heikki Vatiainen</span> for reviews of this document
   and for assistance with interoperability testing.<a class="pilcrow" href="#appendix-A-2">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-address">
<a class="section-name selfRef" href="#name-authors-address">Author's Address</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Alan DeKok</span></div>
<div class="left" dir="auto"><span class="org">The FreeRADIUS Server Project</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:aland@freeradius.org">aland@freeradius.org</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>