<html><head></head><body><pre>Network Working Group                                       G. Camarillo
Request for Comments: 5368                                      Ericsson
Category: Standards Track                                       A. Niemi
                                                              M. Isomaki
                                                                   Nokia
                                                        M. Garcia-Martin
                                                                Ericsson
                                                            H. Khartabil
                                                      Ericsson Australia
                                                            October 2008


Referring to Multiple Resources in the Session Initiation Protocol (SIP)

Status of This Memo

   This document specifies an Internet standards track protocol for the
   Internet community, and requests discussion and suggestions for
   improvements.  Please refer to the current edition of the "Internet
   Official Protocol Standards" (STD 1) for the standardization state
   and status of this protocol.  Distribution of this memo is unlimited.

Abstract

   This document defines extensions to the SIP REFER method so that it
   can be used to refer to multiple resources in a single request.
   These extensions include the use of pointers to Uniform Resource
   Identifier (URI) lists in the Refer-To header field and the
   "multiple-refer" SIP option-tag.

Table of Contents

   <a href="#section-1">1</a>.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-2">2</a>
   <a href="#section-2">2</a>.  Terminology  . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-2">2</a>
   <a href="#section-3">3</a>.  Overview of Operation  . . . . . . . . . . . . . . . . . . . .  <a href="#page-3">3</a>
   <a href="#section-4">4</a>.  The multiple-refer SIP Option-Tag  . . . . . . . . . . . . . .  <a href="#page-4">4</a>
   <a href="#section-5">5</a>.  Suppressing REFER's Implicit Subscription  . . . . . . . . . .  <a href="#page-4">4</a>
   <a href="#section-6">6</a>.  URI-List Format  . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-5">5</a>
   <a href="#section-7">7</a>.  Behavior of SIP REFER-Issuers  . . . . . . . . . . . . . . . .  <a href="#page-6">6</a>
   <a href="#section-8">8</a>.  Behavior of REFER-Recipients . . . . . . . . . . . . . . . . .  <a href="#page-6">6</a>
   <a href="#section-9">9</a>.  Example  . . . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-7">7</a>
   <a href="#section-10">10</a>. Security Considerations  . . . . . . . . . . . . . . . . . . . <a href="#page-10">10</a>
   <a href="#section-11">11</a>. IANA Considerations  . . . . . . . . . . . . . . . . . . . . . <a href="#page-10">10</a>
   <a href="#section-12">12</a>. References . . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-10">10</a>
     <a href="#section-12.1">12.1</a>.  Normative References  . . . . . . . . . . . . . . . . . . <a href="#page-10">10</a>
     <a href="#section-12.2">12.2</a>.  Informative References  . . . . . . . . . . . . . . . . . <a href="#page-11">11</a>





<span class="grey">Camarillo, et al.           Standards Track                     [Page 1]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-2"></span>
<span class="grey"><a href="./rfc5368">RFC 5368</a>                   SIP Multiple REFER               October 2008</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" id="section-1">1</a>.  Introduction</span>

   <a href="./rfc3261">RFC 3261</a> (SIP) [<a href="./rfc3261" title='"SIP: Session Initiation Protocol"'>RFC3261</a>] is extended by <a href="./rfc3515">RFC 3515</a> [<a href="./rfc3515" title='"The Session Initiation Protocol (SIP) Refer Method"'>RFC3515</a>] with a
   REFER method that allows a user agent (UA) to request a second UA to
   send a SIP request to a third party.  For example, if Alice is in a
   call with Bob, and decides Bob needs to talk to Carol, Alice can
   instruct her SIP UA to send a REFER request to Bob's UA providing
   Carol's SIP Contact information.  Assuming Bob has given it
   permission, Bob's UA will attempt to call Carol using that contact.
   That is, it will send an INVITE request to that contact.

   A number of applications need to request this second UA to initiate
   transactions towards a set of destinations.  In one example, the
   moderator of a conference may want the conference server to send BYE
   requests to a group of participants.  In another example, the same
   moderator may want the conference server to INVITE a set of new
   participants.

   We define an extension to the REFER method so that REFER requests can
   be used to refer other user agents (such as conference servers) to
   multiple destinations.  In addition, this mechanism uses the
   suppression of the REFER method implicit subscription specified in
   <a href="./rfc4488">RFC 4488</a> [<a href="./rfc4488" title='"Suppression of Session Initiation Protocol (SIP) REFER Method Implicit Subscription"'>RFC4488</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.%20%20Terminology"></a><a class="selflink" href="#section-2" id="section-2">2</a>.  Terminology</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in <a href="https://www.rfc-editor.org/bcp/bcp14">BCP 14</a>, <a href="./rfc2119">RFC 2119</a>
   [<a href="./rfc2119" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>] and indicate requirement levels for compliant
   implementations.

   This document reuses the following terminology defined in <a href="./rfc3261">RFC 3261</a>
   [<a href="./rfc3261" title='"SIP: Session Initiation Protocol"'>RFC3261</a>]:

   o  User Agent (UA)
   o  User Agent Client (UAC)
   o  User Agent Server (UAS)

   This document defines the following new terms:

   REFER-Issuer:  a user agent issuing a REFER request.

   REFER-Recipient:  an entity receiving a REFER request and forwarding
      a SIP request to a number of REFER-Targets.  The REFER-Recipient
      is typically a network entity, such as a URI-list server, that
      acts as a UAS for REFER requests and as a UAC for other SIP
      requests.



<span class="grey">Camarillo, et al.           Standards Track                     [Page 2]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-3"></span>
<span class="grey"><a href="./rfc5368">RFC 5368</a>                   SIP Multiple REFER               October 2008</span>


   REFER-Target:  a UA of the intended final recipient of a SIP request
      generated by the REFER-Recipient.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.%20%20Overview%20of%20Operation"></a><a class="selflink" href="#section-3" id="section-3">3</a>.  Overview of Operation</span>

   This document describes an application of URI-list services [<a href="./rfc5363" title='"Framework and Security Considerations for Session Initiation Protocol (SIP) URI- List Services"'>RFC5363</a>]
   that allows a URI-list service to receive a SIP REFER request
   containing a list of targets.  The URI-list service invokes the
   requested SIP method to each of the targets contained in the list.
   This type of URI-list service is referred to as a REFER-Recipient
   throughout this document.

   This document defines an extension to the SIP REFER method specified
   in <a href="./rfc3515">RFC 3515</a> [<a href="./rfc3515" title='"The Session Initiation Protocol (SIP) Refer Method"'>RFC3515</a>] that allows a SIP UAC to include a URI list as
   specified in <a href="./rfc4826">RFC 4826</a> [<a href="./rfc4826" title='"Extensible Markup Language (XML) Formats for Representing Resource Lists"'>RFC4826</a>] of REFER-Targets in a REFER request
   and send it to a REFER-Recipient.  The REFER-Recipient creates a new
   SIP request for each entry in the URI list and sends it to each
   REFER-Recipient.

   The URI list that contains the list of targets is used in conjunction
   with <a href="./rfc5364">RFC 5364</a> [<a href="./rfc5364" title='"Extensible Markup Language (XML) Format Extension for Representing Copy Control Attributes in Resource Lists"'>RFC5364</a>] to allow the sender indicate the role (e.g.,
   'to', 'cc', or anonymous) in which the REFER-Target is involved in
   the signalling.

   We represent multiple targets of a REFER request using a URI list as
   specified in <a href="./rfc4826">RFC 4826</a> [<a href="./rfc4826" title='"Extensible Markup Language (XML) Formats for Representing Resource Lists"'>RFC4826</a>].  A REFER-Issuer that wants to refer
   a REFER-Recipient to a set of destinations creates a SIP REFER
   request.  The Refer-To header contains a pointer to a URI list, which
   is included in a body part, and an option-tag in the Require header
   field: "multiple-refer".  This option-tag indicates the requirement
   to support the functionality described in this specification.

   When the REFER-Recipient receives such a request, it creates a new
   request per REFER-Target and sends them, one to each REFER-Target.

   This document does not provide any mechanism for REFER-Issuers to
   find out about the results of a REFER request containing multiple
   REFER-Targets.  Furthermore, it does not provide support for the
   implicit subscription mechanism that is part of the SIP REFER method.
   The way REFER-Issuers are kept informed about the results of a REFER
   is service specific.  For example, a REFER-Issuer sending a REFER
   request to invite a set of participants to a conference can discover
   which participants were successfully brought into the conference by
   subscribing to the conference state event package specified in <a href="./rfc4575">RFC</a>
   <a href="./rfc4575">4575</a> [<a href="./rfc4575" title='"A Session Initiation Protocol (SIP) Event Package for Conference State"'>RFC4575</a>].






<span class="grey">Camarillo, et al.           Standards Track                     [Page 3]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-4"></span>
<span class="grey"><a href="./rfc5368">RFC 5368</a>                   SIP Multiple REFER               October 2008</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/4.%20%20The%20multiple-refer%20SIP%20Option-Tag"></a><a class="selflink" href="#section-4" id="section-4">4</a>.  The multiple-refer SIP Option-Tag</span>

   We define a new SIP option-tag for the Require and Supported header
   fields: "multiple-refer".

   A user agent including the "multiple-refer" option-tag in a Supported
   header field indicates compliance with this specification.

   A user agent generating a REFER with a pointer to a URI list in its
   Refer-To header field MUST include the "multiple-refer" option-tag in
   the Require header field of the REFER.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.%20%20Suppressing%20REFER%27s%20Implicit%20Subscription"></a><a class="selflink" href="#section-5" id="section-5">5</a>.  Suppressing REFER's Implicit Subscription</span>

   REFER requests with a single REFER-Target establish implicitly a
   subscription to the refer event.  The REFER-Issuer is informed about
   the result of the transaction towards the REFER-Target through this
   implicit subscription.  As described in <a href="./rfc3515">RFC 3515</a> [<a href="./rfc3515" title='"The Session Initiation Protocol (SIP) Refer Method"'>RFC3515</a>], NOTIFY
   requests sent as a result of an implicit subscription created by a
   REFER request contain a body of type "message/sipfrag", <a href="./rfc3420">RFC 3420</a>
   [<a href="./rfc3420" title='"Internet Media Type message/sipfrag"'>RFC3420</a>], that describes the status of the transaction initiated by
   the REFER-Recipient.

   In the case of a REFER-Issuer that generates a REFER with multiple
   REFER-targets, the REFER-Issuer is typically already subscribed to
   other event packages that can provide the information about the
   result of the transactions towards the REFER-Targets.  For example, a
   moderator instructing a conference server to send a BYE request to a
   set of participants is usually subscribed to the conference state
   event package for the conference.  Notifications to this event
   package will keep the moderator and the rest of the subscribers
   informed of the current list of conference participants.

   Most of the applications using the multiple REFER technology
   described in this memo do not need its implicit subscription.
   Consequently, a SIP REFER-Issuer generating a REFER request with
   multiple REFER-Targets SHOULD include the "norefersub" option-tag in
   a Require header field and SHOULD include a Refer-Sub header field
   set to "false" to indicate that no notifications about the requests
   should be sent to the REFER-Issuer.  The REFER-Recipient SHOULD honor
   the suggestion and also include a Refer-Sub header field set to
   "false" in the 200 (OK) response.  The "norefersub" SIP option-tag
   and the Refer-Sub header field are specified in <a href="./rfc4488">RFC 4488</a> [<a href="./rfc4488" title='"Suppression of Session Initiation Protocol (SIP) REFER Method Implicit Subscription"'>RFC4488</a>].

      <a href="./rfc4488">RFC 4488</a> [<a href="./rfc4488" title='"Suppression of Session Initiation Protocol (SIP) REFER Method Implicit Subscription"'>RFC4488</a>] indicates that a condition for the REFER-Issuer
      to include a Refer-Sub header is that the REFER-Issuer is sure
      that the REFER request will not fork.




<span class="grey">Camarillo, et al.           Standards Track                     [Page 4]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-5"></span>
<span class="grey"><a href="./rfc5368">RFC 5368</a>                   SIP Multiple REFER               October 2008</span>


   At the time of writing, there is no extension that allows to report
   the status of several transactions over the implicit subscription
   associated with a REFER dialog.  That is the motivation for this
   document to recommend the usage of the "norefersub" option-tag.  If
   in the future such an extension is defined, REFER-Issuers using it
   could refrain from using the "norefersub" option-tag and use the new
   extension instead.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/6.%20%20URI-List%20Format"></a><a class="selflink" href="#section-6" id="section-6">6</a>.  URI-List Format</span>

   As described in <a href="./rfc5363">RFC 5363</a> [<a href="./rfc5363" title='"Framework and Security Considerations for Session Initiation Protocol (SIP) URI- List Services"'>RFC5363</a>], specifications of individual URI-
   list services need to specify a default format for 'recipient-list'
   bodies used within the particular service.

   The default format for 'recipient-list' bodies for REFER-Issuers and
   REFER-Recipients is <a href="./rfc4826">RFC 4826</a> [<a href="./rfc4826" title='"Extensible Markup Language (XML) Formats for Representing Resource Lists"'>RFC4826</a>] extended with <a href="./rfc5364">RFC 5364</a>
   [<a href="./rfc5364" title='"Extensible Markup Language (XML) Format Extension for Representing Copy Control Attributes in Resource Lists"'>RFC5364</a>].  REFER-Recipients handling 'recipient-list' bodies MUST
   support both of these formats.  Both REFER-Issuers and REFER-
   Recipients MAY support other formats.

   As described in <a href="./rfc5364">RFC 5364</a> [<a href="./rfc5364" title='"Extensible Markup Language (XML) Format Extension for Representing Copy Control Attributes in Resource Lists"'>RFC5364</a>], each URI can be tagged with a
   'copyControl' attribute set to either "to", "cc", or "bcc",
   indicating the role in which the target will get the referred SIP
   request.  However, depending on the target SIP method, a
   'copyControl' attribute lacks sense.  For example, while a
   'copyControl' attribute can be applied to INVITE requests, it does
   not make sense with mid-dialog requests such as BYE requests.

   In addition to the 'copyControl' attribute, URIs can be tagged with
   the 'anonymize' attribute (also specified in <a href="./rfc5364">RFC 5364</a> [<a href="./rfc5364" title='"Extensible Markup Language (XML) Format Extension for Representing Copy Control Attributes in Resource Lists"'>RFC5364</a>]) to
   prevent that the REFER-Recipient discloses the target URI in a URI
   list.

   Additionally, <a href="./rfc5364">RFC 5364</a> [<a href="./rfc5364" title='"Extensible Markup Language (XML) Format Extension for Representing Copy Control Attributes in Resource Lists"'>RFC5364</a>] defines a 'recipient-list-history'
   body that contains the list of targets.  The default format for
   'recipient-list-history' bodies for conference services is also <a href="./rfc4826">RFC</a>
   <a href="./rfc4826">4826</a> [<a href="./rfc4826" title='"Extensible Markup Language (XML) Formats for Representing Resource Lists"'>RFC4826</a>] extended with <a href="./rfc5364">RFC 5364</a> [<a href="./rfc5364" title='"Extensible Markup Language (XML) Format Extension for Representing Copy Control Attributes in Resource Lists"'>RFC5364</a>].  REFER-Recipients
   supporting this specification MUST support both of these formats;
   REFER-Targets MAY support these formats.  Both REFER-Recipients and
   REFER-Targets MAY support other formats.

   Nevertheless, <a href="./rfc4826">RFC 4826</a> [<a href="./rfc4826" title='"Extensible Markup Language (XML) Formats for Representing Resource Lists"'>RFC4826</a>] provides features, such as
   hierarchical lists and the ability to include entries by reference
   relative to the XML Configuration Access Protocol (XCAP) root URI,
   that are not needed by the multiple REFER service defined in this
   document.





<span class="grey">Camarillo, et al.           Standards Track                     [Page 5]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-6"></span>
<span class="grey"><a href="./rfc5368">RFC 5368</a>                   SIP Multiple REFER               October 2008</span>


   Figure 1 shows an example of a flat list that follows the resource
   list document.

   &lt;?xml version="1.0" encoding="UTF-8"?&gt;
   &lt;resource-lists xmlns="urn:ietf:params:xml:ns:resource-lists"
              xmlns:cp="urn:ietf:params:xml:ns:copycontrol"&gt;

     &lt;list&gt;
       &lt;entry uri="sip:bill@example.com" cp:copyControl="to"  /&gt;
       &lt;entry uri="sip:joe@example.org" cp:copyControl="cc" /&gt;
       &lt;entry uri="sip:ted@example.net" cp:copyControl="bcc" /&gt;
     &lt;/list&gt;
   &lt;/resource-lists&gt;

                            Figure 1: URI list

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/7.%20%20Behavior%20of%20SIP%20REFER-Issuers"></a><a class="selflink" href="#section-7" id="section-7">7</a>.  Behavior of SIP REFER-Issuers</span>

   As indicated in Sections <a href="#section-4">4</a> and <a href="#section-5">5</a>, a SIP REFER-Issuer that creates a
   REFER request with multiple REFER-Targets includes a "multiple-refer"
   and "norefersub" option-tags in the Require header field and, if
   appropriate, a Refer-Sub header field set to "false".  The REFER-
   Issuer includes the set of REFER-Targets in a recipient-list body
   whose disposition type is 'recipient-list', as defined in <a href="./rfc5363">RFC 5363</a>
   [<a href="./rfc5363" title='"Framework and Security Considerations for Session Initiation Protocol (SIP) URI- List Services"'>RFC5363</a>].  The URI-list body is further described in <a href="#section-6">Section 6</a>.

   The Refer-To header field of a REFER request with multiple REFER-
   Targets MUST contain a pointer (i.e., a Content-ID Uniform Resource
   Locator (URL) as per <a href="./rfc2392">RFC 2392</a> [<a href="./rfc2392" title='"Content-ID and Message-ID Uniform Resource Locators"'>RFC2392</a>]) that points to the body part
   that carries the URI list.  The REFER-Issuer SHOULD NOT include any
   particular URI more than once in the URI list.

   <a href="./rfc4826">RFC 4826</a> [<a href="./rfc4826" title='"Extensible Markup Language (XML) Formats for Representing Resource Lists"'>RFC4826</a>] provides features, such as hierarchical lists and
   the ability to include entries by reference relative to the XCAP root
   URI.  However, these features are not needed by the multiple REFER
   service defined in this document.  Therefore, when using the default
   resource list document, SIP REFER-Issuers generating REFER requests
   with multiple REFER-Targets SHOULD use flat lists (i.e., no
   hierarchical lists) and SHOULD NOT use &lt;entry-ref&gt; elements.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/8.%20%20Behavior%20of%20REFER-Recipients"></a><a class="selflink" href="#section-8" id="section-8">8</a>.  Behavior of REFER-Recipients</span>

   The REFER-Recipient follows the rules in <a href="./rfc3515#section-2.4.2">Section 2.4.2 of RFC 3515</a>
   [<a href="./rfc3515" title='"The Session Initiation Protocol (SIP) Refer Method"'>RFC3515</a>] to determine the status code of the response to the REFER.

   The REFER-Recipient SHOULD not create an implicit subscription, and
   SHOULD add a Refer-Sub header field set to "false" in the 200 OK
   response.



<span class="grey">Camarillo, et al.           Standards Track                     [Page 6]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-7"></span>
<span class="grey"><a href="./rfc5368">RFC 5368</a>                   SIP Multiple REFER               October 2008</span>


   The incoming REFER request typically contains a URI-list document or
   reference with the actual list of targets.  If this URI list includes
   resources tagged with the 'copyControl' attribute set to a value of
   "to" or "cc", and if the request is appropriate for the service,
   e.g., it is not received mid-dialog, the REFER-Recipient SHOULD
   include a URI list in each of the outgoing requests.  This list
   SHOULD be formatted according to <a href="./rfc4826">RFC 4826</a> [<a href="./rfc4826" title='"Extensible Markup Language (XML) Formats for Representing Resource Lists"'>RFC4826</a>] and <a href="./rfc5364">RFC 5364</a>
   [<a href="./rfc5364" title='"Extensible Markup Language (XML) Format Extension for Representing Copy Control Attributes in Resource Lists"'>RFC5364</a>].  The REFER-Recipient MUST follow the procedures specified
   in <a href="./rfc4826">RFC 4826</a> [<a href="./rfc4826" title='"Extensible Markup Language (XML) Formats for Representing Resource Lists"'>RFC4826</a>] with respect to handling of the 'anonymize',
   'count', and 'copyControl' attributes.

   <a href="./rfc5363#section-4">Section 4 of RFC 5363</a> [<a href="./rfc5363" title='"Framework and Security Considerations for Session Initiation Protocol (SIP) URI- List Services"'>RFC5363</a>] discusses cases when duplicated URIs
   are found in a URI list.  In order to avoid duplicated requests,
   REFER-Recipients MUST take those actions specified in <a href="./rfc5363">RFC 5363</a>
   [<a href="./rfc5363" title='"Framework and Security Considerations for Session Initiation Protocol (SIP) URI- List Services"'>RFC5363</a>] into account to avoid sending a duplicated request to the
   same target.

   If the REFER-Recipient includes a URI list in an outgoing request, it
   MUST include a Content-Disposition header field, specified in <a href="./rfc2183">RFC</a>
   <a href="./rfc2183">2183</a> [<a href="./rfc2183" title='"Communicating Presentation Information in Internet Messages: The Content-Disposition Header Field"'>RFC2183</a>], with the value set to 'recipient-list-history' and a
   'handling' parameter, specified in <a href="./rfc3204">RFC 3204</a> [<a href="./rfc3204" title='"MIME media types for ISUP and QSIG Objects"'>RFC3204</a>], set to
   "optional".

   Since the multiple REFER service does not use hierarchical lists nor
   lists that include entries by reference to the XCAP root URI, a
   REFER-Recipient receiving a URI list with more information than what
   has been described in <a href="#section-6">Section 6</a> MAY discard all the extra
   information.

   The REFER-Recipient follows the rules in <a href="./rfc3515">RFC 3515</a> [<a href="./rfc3515" title='"The Session Initiation Protocol (SIP) Refer Method"'>RFC3515</a>] to
   generate the necessary requests towards the REFER-Targets, acting as
   if it had received a regular (no URI list) REFER per each URI in the
   URI list.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/9.%20%20Example"></a><a class="selflink" href="#section-9" id="section-9">9</a>.  Example</span>

   Figure 2 shows an example flow where a REFER-Issuer sends a multiple-
   REFER request to the focus of a conference, which acts as the REFER-
   Recipient.  The REFER-Recipient generates a BYE request per REFER-
   Target.  Details for using REFER request to remove participants from
   a conference are specified in <a href="./rfc4579">RFC 4579</a> [<a href="./rfc4579" title='"Session Initiation Protocol (SIP) Call Control - Conferencing for User Agents"'>RFC4579</a>].










<span class="grey">Camarillo, et al.           Standards Track                     [Page 7]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-8"></span>
<span class="grey"><a href="./rfc5368">RFC 5368</a>                   SIP Multiple REFER               October 2008</span>


   +--------+         +---------+    +--------+  +--------+  +--------+
   | REFER  |         |  REFER  |    | REFER  |  | REFER  |  | REFER  |
   | issuer |         |recipient|    |target 1|  |target 2|  |target 3|
   |        |         |         |    |        |  |        |  |        |
   | Carol  |         | (focus) |    |  Bill  |  |  Joe   |  |  Ted   |
   +--------+         +---------+    +--------+  +--------+  +--------+
        | 1. REFER         |             |           |           |
        | ----------------&gt;|             |           |           |
        | 2. 202 Accepted  |             |           |           |
        |&lt;---------------- |   3. BYE    |           |           |
        |                  | -----------&gt;|           |           |
        |                  |   4. BYE    |           |           |
        |                  | -----------------------&gt;|           |
        |                  |   5. BYE    |           |           |
        |                  | -----------------------------------&gt;|
        |                  |   6. 200 OK |           |           |
        |                  |&lt;----------- |           |           |
        |                  |   7. 200 OK |           |           |
        |                  |&lt;----------------------- |           |
        |                  |   8. 200 OK |           |           |
        |                  |&lt;----------------------------------- |
        |                  |             |           |           |
        |                  |             |           |           |
        |                  |             |           |           |

           Figure 2: Example flow of a REFER request containing
                          multiple REFER-Targets

   The REFER request (1) contains a Refer-To header field that includes
   a pointer to the message body, which carries a list with the URIs of
   the REFER-Targets.  In this example, the URI list does not contain
   the 'copyControl' attribute extension.  The REFER's Require header
   field carries the "multiple-refer" and "norefersub" option-tags.  The
   Request-URI is set to a Globally Routable User Agent URI (GRUU)
   [<a href="#ref-SIP-GRUU" title='"Obtaining and Using Globally Routable User Agent (UA) URIs (GRUU) in the Session Initiation Protocol (SIP)"'>SIP-GRUU</a>] (as a guarantee that the REFER request will not fork).
   The Refer-Sub header field is set to "false" to request the
   suppression of the implicit subscription.  Figure 3 shows an example
   of this REFER request.  The resource list document contains the list
   of REFER-Target URIs along with the method of the SIP request that
   the REFER-Recipient generates.











<span class="grey">Camarillo, et al.           Standards Track                     [Page 8]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-9"></span>
<span class="grey"><a href="./rfc5368">RFC 5368</a>                   SIP Multiple REFER               October 2008</span>


   REFER sip:conf-123@example.com;gruu;opaque=hha9s8d-999a  SIP/2.0
   Via: SIP/2.0/TCP client.chicago.example.com
           ;branch=z9hG4bKhjhs8ass83
   Max-Forwards: 70
   To: "Conference 123" &lt;sip:conf-123@example.com&gt;
   From: Carol &lt;sip:carol@chicago.example.com&gt;;tag=32331
   Call-ID: d432fa84b4c76e66710
   CSeq: 2 REFER
   Contact: &lt;sip:carol@client.chicago.example.com&gt;
   Refer-To: &lt;cid:cn35t8jf02@example.com&gt;
   Refer-Sub: false
   Require: multiple-refer, norefersub
   Allow: INVITE, ACK, CANCEL, OPTIONS, BYE, REFER, SUBSCRIBE, NOTIFY
   Allow-Events: dialog
   Accept: application/sdp, message/sipfrag
   Content-Type: application/resource-lists+xml
   Content-Disposition: recipient-list
   Content-Length: 362
   Content-ID: &lt;cn35t8jf02@example.com&gt;

   &lt;?xml version="1.0" encoding="UTF-8"?&gt;
   &lt;resource-lists xmlns="urn:ietf:params:xml:ns:resource-lists"
           xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;
     &lt;list&gt;
       &lt;entry uri="sip:bill@example.com?method=BYE" /&gt;
       &lt;entry uri="sip:joe@example.org?method=BYE" /&gt;
       &lt;entry uri="sip:ted@example.net?method=BYE" /&gt;
     &lt;/list&gt;
   &lt;/resource-lists&gt;

            Figure 3: REFER request with multiple REFER-Targets

   Figure 4 shows an example of the BYE request (3) that the REFER-
   Recipient sends to the first REFER-Target.

   BYE sip:bill@example.com SIP/2.0
   Via: SIP/2.0/TCP conference.example.com
           ;branch=z9hG4bKhjhs8assmm
   Max-Forwards: 70
   From: "Conference 123" &lt;sip:conf-123@example.com&gt;;tag=88734
   To: &lt;sip:bill@example.com&gt;;tag=29872
   Call-ID: d432fa84b4c34098s812
   CSeq: 34 BYE
   Content-Length: 0

                           Figure 4: BYE request





<span class="grey">Camarillo, et al.           Standards Track                     [Page 9]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-10"></span>
<span class="grey"><a href="./rfc5368">RFC 5368</a>                   SIP Multiple REFER               October 2008</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/10.%20%20Security%20Considerations"></a><a class="selflink" href="#section-10" id="section-10">10</a>.  Security Considerations</span>

   <a href="./rfc5363">RFC 5363</a> [<a href="./rfc5363" title='"Framework and Security Considerations for Session Initiation Protocol (SIP) URI- List Services"'>RFC5363</a>] discusses issues related to SIP URI-list services.
   Given that a REFER-Recipient accepting REFER requests with multiple
   REFER-targets acts as a URI-list service, implementations of this
   type of server MUST follow the security-related rules in <a href="./rfc5363">RFC 5363</a>
   [<a href="./rfc5363" title='"Framework and Security Considerations for Session Initiation Protocol (SIP) URI- List Services"'>RFC5363</a>].  These rules include opt-in lists and mandatory
   authentication and authorization of clients.

   Additionally, REFER-Recipients SHOULD only accept REFER requests
   within the context of an application that the REFER-Recipient
   understands (e.g., a conferencing application).  This implies that
   REFER-Recipients MUST NOT accept REFER requests for methods they do
   not understand.  The idea behind these two rules is that REFER-
   Recipients are not used as dumb servers whose only function is to
   fan-out random messages they do not understand.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/11.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-11" id="section-11">11</a>.  IANA Considerations</span>

   This document defines a new SIP option-tag: "multiple-refer".  This
   option-tag has been registered in the SIP Parameters registry.

   The following row has been added to the "Option Tags" section of the
   SIP Parameter Registry:

   +-----------------+-------------------------------------+-----------+
   | Name            | Description                         | Reference |
   +-----------------+-------------------------------------+-----------+
   | multiple-refer  | This option tag indicates support   | [<a href="./rfc5368">RFC5368</a>] |
   |                 | for REFER requests that contain a   |           |
   |                 | resource list document describing   |           |
   |                 | multiple REFER targets.             |           |
   +-----------------+-------------------------------------+-----------+

      Table 1: Registration of the 'multiple-refer' option-tag in SIP

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/12.%20%20References"></a><a class="selflink" href="#section-12" id="section-12">12</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/12.1.%20%20Normative%20References"></a><a class="selflink" href="#section-12.1" id="section-12.1">12.1</a>.  Normative References</span>

   [<a id="ref-RFC2119">RFC2119</a>]   Bradner, S., "Key words for use in RFCs to Indicate
               Requirement Levels", <a href="https://www.rfc-editor.org/bcp/bcp14">BCP 14</a>, <a href="./rfc2119">RFC 2119</a>, March 1997.

   [<a id="ref-RFC2183">RFC2183</a>]   Troost, R., Dorner, S., and K. Moore, "Communicating
               Presentation Information in Internet Messages: The
               Content-Disposition Header Field", <a href="./rfc2183">RFC 2183</a>, August 1997.





<span class="grey">Camarillo, et al.           Standards Track                    [Page 10]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-11"></span>
<span class="grey"><a href="./rfc5368">RFC 5368</a>                   SIP Multiple REFER               October 2008</span>


   [<a id="ref-RFC2392">RFC2392</a>]   Levinson, E., "Content-ID and Message-ID Uniform Resource
               Locators", <a href="./rfc2392">RFC 2392</a>, August 1998.

   [<a id="ref-RFC3204">RFC3204</a>]   Zimmerer, E., Peterson, J., Vemuri, A., Ong, L., Audet,
               F., Watson, M., and M. Zonoun, "MIME media types for ISUP
               and QSIG Objects", <a href="./rfc3204">RFC 3204</a>, December 2001.

   [<a id="ref-RFC3261">RFC3261</a>]   Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston,
               A., Peterson, J., Sparks, R., Handley, M., and E.
               Schooler, "SIP: Session Initiation Protocol", <a href="./rfc3261">RFC 3261</a>,
               June 2002.

   [<a id="ref-RFC3420">RFC3420</a>]   Sparks, R., "Internet Media Type message/sipfrag",
               <a href="./rfc3420">RFC 3420</a>, November 2002.

   [<a id="ref-RFC3515">RFC3515</a>]   Sparks, R., "The Session Initiation Protocol (SIP) Refer
               Method", <a href="./rfc3515">RFC 3515</a>, April 2003.

   [<a id="ref-RFC4488">RFC4488</a>]   Levin, O., "Suppression of Session Initiation Protocol
               (SIP) REFER Method Implicit Subscription", <a href="./rfc4488">RFC 4488</a>,
               May 2006.

   [<a id="ref-RFC4826">RFC4826</a>]   Rosenberg, J., "Extensible Markup Language (XML) Formats
               for Representing Resource Lists", <a href="./rfc4826">RFC 4826</a>, May 2007.

   [<a id="ref-RFC5363">RFC5363</a>]   Camarillo, G. and A.B. Roach, "Framework and Security
               Considerations for Session Initiation Protocol (SIP) URI-
               List Services", <a href="./rfc5363">RFC 5363</a>, October 2008.

   [<a id="ref-RFC5364">RFC5364</a>]   Garcia-Martin, M. and G. Camarillo, "Extensible Markup
               Language (XML) Format Extension for Representing Copy
               Control Attributes in Resource Lists", <a href="./rfc5364">RFC 5364</a>,
               October 2008.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/12.2.%20%20Informative%20References"></a><a class="selflink" href="#section-12.2" id="section-12.2">12.2</a>.  Informative References</span>

   [<a id="ref-RFC4575">RFC4575</a>]   Rosenberg, J., Schulzrinne, H., and O. Levin, "A Session
               Initiation Protocol (SIP) Event Package for Conference
               State", <a href="./rfc4575">RFC 4575</a>, August 2006.

   [<a id="ref-RFC4579">RFC4579</a>]   Johnston, A. and O. Levin, "Session Initiation Protocol
               (SIP) Call Control - Conferencing for User Agents",
               <a href="https://www.rfc-editor.org/bcp/bcp119">BCP 119</a>, <a href="./rfc4579">RFC 4579</a>, August 2006.

   [<a id="ref-SIP-GRUU">SIP-GRUU</a>]  Rosenberg, J., "Obtaining and Using Globally Routable
               User Agent (UA) URIs (GRUU) in the Session Initiation
               Protocol (SIP)", Work in Progress, October 2007.




<span class="grey">Camarillo, et al.           Standards Track                    [Page 11]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-12"></span>
<span class="grey"><a href="./rfc5368">RFC 5368</a>                   SIP Multiple REFER               October 2008</span>


Authors' Addresses

   Gonzalo Camarillo
   Ericsson
   Hirsalantie 11
   Jorvas  02420
   Finland

   EMail: Gonzalo.Camarillo@ericsson.com


   Aki Niemi
   Nokia
   P.O. Box 321
   NOKIA GROUP, FIN 00045
   Finland

   EMail: Aki.Niemi@nokia.com


   Markus Isomaki
   Nokia
   P.O. Box 100
   NOKIA GROUP, FIN  00045
   Finland

   EMail: markus.isomaki@nokia.com


   Miguel A. Garcia-Martin
   Ericsson
   Via de los Poblados 13
   Madrid  28033
   Spain

   EMail: miguel.a.garcia@ericsson.com


   Hisham Khartabil
   Ericsson Australia

   EMail: hisham.khartabil@gmail.com









<span class="grey">Camarillo, et al.           Standards Track                    [Page 12]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-13"></span>
<span class="grey"><a href="./rfc5368">RFC 5368</a>                   SIP Multiple REFER               October 2008</span>


Full Copyright Statement

   Copyright (C) The IETF Trust (2008).

   This document is subject to the rights, licenses and restrictions
   contained in <a href="https://www.rfc-editor.org/bcp/bcp78">BCP 78</a>, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST AND
   THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS
   OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF
   THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in <a href="https://www.rfc-editor.org/bcp/bcp78">BCP 78</a> and <a href="https://www.rfc-editor.org/bcp/bcp79">BCP 79</a>.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   <a href="http://www.ietf.org/ipr">http://www.ietf.org/ipr</a>.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.












Camarillo, et al.           Standards Track                    [Page 13]
</pre>
</body></html>