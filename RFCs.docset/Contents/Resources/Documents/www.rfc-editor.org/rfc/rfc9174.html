<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 9174: Delay-Tolerant Networking TCP Convergence-Layer Protocol Version 4</title>
<meta content="Brian Sipos" name="author"/>
<meta content="Michael Demmer" name="author"/>
<meta content="JÃ¶rg Ott" name="author"/>
<meta content="Simon Perreault" name="author"/>
<meta content="
       
This document describes a TCP convergence layer (TCPCL) for Delay-Tolerant Networking (DTN). This version of the TCPCL protocol resolves implementation issues in the earlier TCPCL version 3 as defined in RFC 7242 and provides updates to the Bundle Protocol (BP) contents, encodings, and convergence-layer requirements in BP version 7 (BPv7). Specifically, TCPCLv4 uses BPv7 bundles encoded by the Concise Binary Object Representation (CBOR) as its service data unit being transported and provides a reliable transport of such bundles.
This TCPCL version also includes security and extensibility mechanisms.
       
    " name="description"/>
<meta content="xml2rfc 3.12.0" name="generator"/>
<meta content="DTN" name="keyword"/>
<meta content="TCP" name="keyword"/>
<meta content="TLS" name="keyword"/>
<meta content="PKIX" name="keyword"/>
<meta content="9174" name="rfc.number"/>
<!-- Generator version information:
  xml2rfc 3.12.0
    Python 3.6.15
    appdirs 1.4.4
    ConfigArgParse 1.4.1
    google-i18n-address 2.4.0
    html5lib 1.0.1
    intervaltree 3.0.2
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.4.2
    pycairo 1.15.1
    pycountry 19.8.18
    pyflakes 2.1.1
    PyYAML 5.4.1
    requests 2.24.0
    setuptools 40.5.0
    six 1.14.0
    WeasyPrint 52.5
-->
<link href="rfc9174.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://dx.doi.org/10.17487/rfc9174" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <link href="https://datatracker.ietf.org/doc/draft-ietf-dtn-tcpclv4-26" rel="prev"/>
  </head>
<body>
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9174</td>
<td class="center">DTN TCPCLv4</td>
<td class="right">January 2022</td>
</tr></thead>
<tfoot><tr>
<td class="left">Sipos, et al.</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc9174">9174</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2022-01">January 2022</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">B. Sipos</div>
<div class="org">RKF Engineering</div>
</div>
<div class="author">
      <div class="author-name">M. Demmer</div>
</div>
<div class="author">
      <div class="author-name">J. Ott</div>
<div class="org">Technical University of Munich</div>
</div>
<div class="author">
      <div class="author-name">S. Perreault</div>
<div class="org">LogMeIn</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9174</h1>
<h1 id="title">Delay-Tolerant Networking TCP Convergence-Layer Protocol Version 4</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">
This document describes a TCP convergence layer (TCPCL) for Delay-Tolerant Networking (DTN). This version of the TCPCL protocol resolves implementation issues in the earlier TCPCL version 3 as defined in RFC 7242 and provides updates to the Bundle Protocol (BP) contents, encodings, and convergence-layer requirements in BP version 7 (BPv7). Specifically, TCPCLv4 uses BPv7 bundles encoded by the Concise Binary Object Representation (CBOR) as its service data unit being transported and provides a reliable transport of such bundles.
This TCPCL version also includes security and extensibility mechanisms.<a class="pilcrow" href="#section-abstract-1">Â¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a class="pilcrow" href="#section-boilerplate.1-1">Â¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">Â¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9174">https://www.rfc-editor.org/info/rfc9174</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">Â¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">Â¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">Â¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">â²</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p class="keepWithNext" id="section-toc.1-1.1.1"><a class="xref" href="#section-1">1</a>.Â Â <a class="xref" href="#name-introduction">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p class="keepWithNext" id="section-toc.1-1.1.2.1.1"><a class="xref" href="#section-1.1">1.1</a>.Â Â <a class="xref" href="#name-scope">Scope</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a class="xref" href="#section-2">2</a>.Â Â <a class="xref" href="#name-requirements-language">Requirements Language</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p class="keepWithNext" id="section-toc.1-1.2.2.1.1"><a class="xref" href="#section-2.1">2.1</a>.Â Â <a class="xref" href="#name-definitions-specific-to-the">Definitions Specific to the TCPCL Protocol</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a class="xref" href="#section-3">3</a>.Â Â <a class="xref" href="#name-general-protocol-descriptio">General Protocol Description</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a class="xref" href="#section-3.1">3.1</a>.Â Â <a class="xref" href="#name-convergence-layer-services">Convergence-Layer Services</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a class="xref" href="#section-3.2">3.2</a>.Â Â <a class="xref" href="#name-tcpcl-session-overview">TCPCL Session Overview</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a class="xref" href="#section-3.3">3.3</a>.Â Â <a class="xref" href="#name-tcpcl-states-and-transition">TCPCL States and Transitions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a class="xref" href="#section-3.4">3.4</a>.Â Â <a class="xref" href="#name-pkix-environments-and-ca-po">PKIX Environments and CA Policy</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a class="xref" href="#section-3.5">3.5</a>.Â Â <a class="xref" href="#name-session-keeping-policies">Session-Keeping Policies</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6">
                <p id="section-toc.1-1.3.2.6.1"><a class="xref" href="#section-3.6">3.6</a>.Â Â <a class="xref" href="#name-transfer-segmentation-polic">Transfer Segmentation Policies</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7">
                <p id="section-toc.1-1.3.2.7.1"><a class="xref" href="#section-3.7">3.7</a>.Â Â <a class="xref" href="#name-example-message-exchange">Example Message Exchange</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="xref" href="#section-4">4</a>.Â Â <a class="xref" href="#name-session-establishment">Session Establishment</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a class="xref" href="#section-4.1">4.1</a>.Â Â <a class="xref" href="#name-tcp-connection">TCP Connection</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a class="xref" href="#section-4.2">4.2</a>.Â Â <a class="xref" href="#name-contact-header">Contact Header</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a class="xref" href="#section-4.3">4.3</a>.Â Â <a class="xref" href="#name-contact-validation-and-nego">Contact Validation and Negotiation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a class="xref" href="#section-4.4">4.4</a>.Â Â <a class="xref" href="#name-session-security">Session Security</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.1">
                    <p id="section-toc.1-1.4.2.4.2.1.1"><a class="xref" href="#section-4.4.1">4.4.1</a>.Â Â <a class="xref" href="#name-entity-identification">Entity Identification</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.2">
                    <p id="section-toc.1-1.4.2.4.2.2.1"><a class="xref" href="#section-4.4.2">4.4.2</a>.Â Â <a class="xref" href="#name-certificate-profile-for-the">Certificate Profile for the TCPCL</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.3">
                    <p id="section-toc.1-1.4.2.4.2.3.1"><a class="xref" href="#section-4.4.3">4.4.3</a>.Â Â <a class="xref" href="#name-tls-handshake">TLS Handshake</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.4">
                    <p id="section-toc.1-1.4.2.4.2.4.1"><a class="xref" href="#section-4.4.4">4.4.4</a>.Â Â <a class="xref" href="#name-tls-authentication">TLS Authentication</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.5">
                    <p id="section-toc.1-1.4.2.4.2.5.1"><a class="xref" href="#section-4.4.5">4.4.5</a>.Â Â <a class="xref" href="#name-policy-recommendations">Policy Recommendations</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.6">
                    <p id="section-toc.1-1.4.2.4.2.6.1"><a class="xref" href="#section-4.4.6">4.4.6</a>.Â Â <a class="xref" href="#name-example-tls-initiation">Example TLS Initiation</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a class="xref" href="#section-4.5">4.5</a>.Â Â <a class="xref" href="#name-message-header">Message Header</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.6">
                <p id="section-toc.1-1.4.2.6.1"><a class="xref" href="#section-4.6">4.6</a>.Â Â <a class="xref" href="#name-session-initialization-mess">Session Initialization Message (SESS_INIT)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.7">
                <p id="section-toc.1-1.4.2.7.1"><a class="xref" href="#section-4.7">4.7</a>.Â Â <a class="xref" href="#name-session-parameter-negotiati">Session Parameter Negotiation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.8">
                <p id="section-toc.1-1.4.2.8.1"><a class="xref" href="#section-4.8">4.8</a>.Â Â <a class="xref" href="#name-session-extension-items">Session Extension Items</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="xref" href="#section-5">5</a>.Â Â <a class="xref" href="#name-established-session-operati">Established Session Operation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a class="xref" href="#section-5.1">5.1</a>.Â Â <a class="xref" href="#name-upkeep-and-status-messages">Upkeep and Status Messages</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.1">
                    <p id="section-toc.1-1.5.2.1.2.1.1"><a class="xref" href="#section-5.1.1">5.1.1</a>.Â Â <a class="xref" href="#name-session-upkeep-keepalive">Session Upkeep (KEEPALIVE)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.2">
                    <p id="section-toc.1-1.5.2.1.2.2.1"><a class="xref" href="#section-5.1.2">5.1.2</a>.Â Â <a class="xref" href="#name-message-rejection-msg_rejec">Message Rejection (MSG_REJECT)</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a class="xref" href="#section-5.2">5.2</a>.Â Â <a class="xref" href="#name-bundle-transfer">Bundle Transfer</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1">
                    <p id="section-toc.1-1.5.2.2.2.1.1"><a class="xref" href="#section-5.2.1">5.2.1</a>.Â Â <a class="xref" href="#name-bundle-transfer-id">Bundle Transfer ID</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.2">
                    <p id="section-toc.1-1.5.2.2.2.2.1"><a class="xref" href="#section-5.2.2">5.2.2</a>.Â Â <a class="xref" href="#name-data-transmission-xfer_segm">Data Transmission (XFER_SEGMENT)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3">
                    <p id="section-toc.1-1.5.2.2.2.3.1"><a class="xref" href="#section-5.2.3">5.2.3</a>.Â Â <a class="xref" href="#name-data-acknowledgments-xfer_a">Data Acknowledgments (XFER_ACK)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.4">
                    <p id="section-toc.1-1.5.2.2.2.4.1"><a class="xref" href="#section-5.2.4">5.2.4</a>.Â Â <a class="xref" href="#name-transfer-refusal-xfer_refus">Transfer Refusal (XFER_REFUSE)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.5">
                    <p id="section-toc.1-1.5.2.2.2.5.1"><a class="xref" href="#section-5.2.5">5.2.5</a>.Â Â <a class="xref" href="#name-transfer-extension-items">Transfer Extension Items</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="xref" href="#section-6">6</a>.Â Â <a class="xref" href="#name-session-termination">Session Termination</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a class="xref" href="#section-6.1">6.1</a>.Â Â <a class="xref" href="#name-session-termination-message">Session Termination Message (SESS_TERM)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a class="xref" href="#section-6.2">6.2</a>.Â Â <a class="xref" href="#name-idle-session-termination">Idle Session Termination</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="xref" href="#section-7">7</a>.Â Â <a class="xref" href="#name-security-considerations">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a class="xref" href="#section-7.1">7.1</a>.Â Â <a class="xref" href="#name-threat-passive-leak-of-node">Threat: Passive Leak of Node Data</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a class="xref" href="#section-7.2">7.2</a>.Â Â <a class="xref" href="#name-threat-passive-leak-of-bund">Threat: Passive Leak of Bundle Data</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a class="xref" href="#section-7.3">7.3</a>.Â Â <a class="xref" href="#name-threat-tcpcl-version-downgr">Threat: TCPCL Version Downgrade</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a class="xref" href="#section-7.4">7.4</a>.Â Â <a class="xref" href="#name-threat-transport-security-s">Threat: Transport Security Stripping</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5">
                <p id="section-toc.1-1.7.2.5.1"><a class="xref" href="#section-7.5">7.5</a>.Â Â <a class="xref" href="#name-threat-weak-tls-configurati">Threat: Weak TLS Configurations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.6">
                <p id="section-toc.1-1.7.2.6.1"><a class="xref" href="#section-7.6">7.6</a>.Â Â <a class="xref" href="#name-threat-untrusted-end-entity">Threat: Untrusted End-Entity Certificate</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.7">
                <p id="section-toc.1-1.7.2.7.1"><a class="xref" href="#section-7.7">7.7</a>.Â Â <a class="xref" href="#name-threat-certificate-validati">Threat: Certificate Validation Vulnerabilities</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.8">
                <p id="section-toc.1-1.7.2.8.1"><a class="xref" href="#section-7.8">7.8</a>.Â Â <a class="xref" href="#name-threat-symmetric-key-limits">Threat: Symmetric Key Limits</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.9">
                <p id="section-toc.1-1.7.2.9.1"><a class="xref" href="#section-7.9">7.9</a>.Â Â <a class="xref" href="#name-threat-bp-node-impersonatio">Threat: BP Node Impersonation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.10">
                <p id="section-toc.1-1.7.2.10.1"><a class="xref" href="#section-7.10">7.10</a>.Â <a class="xref" href="#name-threat-denial-of-service">Threat: Denial of Service</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.11">
                <p id="section-toc.1-1.7.2.11.1"><a class="xref" href="#section-7.11">7.11</a>.Â <a class="xref" href="#name-mandatory-to-implement-tls">Mandatory-to-Implement TLS</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.12">
                <p id="section-toc.1-1.7.2.12.1"><a class="xref" href="#section-7.12">7.12</a>.Â <a class="xref" href="#name-alternate-uses-of-tls">Alternate Uses of TLS</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.12.2.1">
                    <p id="section-toc.1-1.7.2.12.2.1.1"><a class="xref" href="#section-7.12.1">7.12.1</a>.Â Â <a class="xref" href="#name-tls-without-authentication">TLS without Authentication</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.12.2.2">
                    <p id="section-toc.1-1.7.2.12.2.2.1"><a class="xref" href="#section-7.12.2">7.12.2</a>.Â Â <a class="xref" href="#name-non-certificate-tls-use">Non-certificate TLS Use</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.13">
                <p id="section-toc.1-1.7.2.13.1"><a class="xref" href="#section-7.13">7.13</a>.Â <a class="xref" href="#name-predictability-of-transfer-">Predictability of Transfer IDs</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="xref" href="#section-8">8</a>.Â Â <a class="xref" href="#name-iana-considerations">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a class="xref" href="#section-8.1">8.1</a>.Â Â <a class="xref" href="#name-port-number">Port Number</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a class="xref" href="#section-8.2">8.2</a>.Â Â <a class="xref" href="#name-protocol-versions">Protocol Versions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a class="xref" href="#section-8.3">8.3</a>.Â Â <a class="xref" href="#name-session-extension-types">Session Extension Types</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4">
                <p id="section-toc.1-1.8.2.4.1"><a class="xref" href="#section-8.4">8.4</a>.Â Â <a class="xref" href="#name-transfer-extension-types">Transfer Extension Types</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.5">
                <p id="section-toc.1-1.8.2.5.1"><a class="xref" href="#section-8.5">8.5</a>.Â Â <a class="xref" href="#name-message-types">Message Types</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.6">
                <p id="section-toc.1-1.8.2.6.1"><a class="xref" href="#section-8.6">8.6</a>.Â Â <a class="xref" href="#name-xfer_refuse-reason-codes-2">XFER_REFUSE Reason Codes</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.7">
                <p id="section-toc.1-1.8.2.7.1"><a class="xref" href="#section-8.7">8.7</a>.Â Â <a class="xref" href="#name-sess_term-reason-codes-2">SESS_TERM Reason Codes</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.8">
                <p id="section-toc.1-1.8.2.8.1"><a class="xref" href="#section-8.8">8.8</a>.Â Â <a class="xref" href="#name-msg_reject-reason-codes-2">MSG_REJECT Reason Codes</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.9">
                <p id="section-toc.1-1.8.2.9.1"><a class="xref" href="#section-8.9">8.9</a>.Â Â <a class="xref" href="#name-object-identifier-for-pkix-">Object Identifier for PKIX Module Identifier</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.10">
                <p id="section-toc.1-1.8.2.10.1"><a class="xref" href="#section-8.10">8.10</a>.Â <a class="xref" href="#name-object-identifier-for-pkix-o">Object Identifier for PKIX Other Name Forms</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.11">
                <p id="section-toc.1-1.8.2.11.1"><a class="xref" href="#section-8.11">8.11</a>.Â <a class="xref" href="#name-object-identifier-for-pkix-e">Object Identifier for PKIX Extended Key Usage</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="xref" href="#section-9">9</a>.Â Â <a class="xref" href="#name-references">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a class="xref" href="#section-9.1">9.1</a>.Â Â <a class="xref" href="#name-normative-references">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a class="xref" href="#section-9.2">9.2</a>.Â Â <a class="xref" href="#name-informative-references">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a class="xref" href="#appendix-A">Appendix A</a>.Â Â <a class="xref" href="#name-significant-changes-from-rf">Significant Changes from RFC 7242</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a class="xref" href="#appendix-B">Appendix B</a>.Â Â <a class="xref" href="#name-asn1-module">ASN.1 Module</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a class="xref" href="#appendix-C">Appendix C</a>.Â Â <a class="xref" href="#name-example-of-the-bundleeid-ot">Example of the BundleEID Other Name Form</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a class="xref" href="#appendix-D"></a><a class="xref" href="#name-acknowledgments">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a class="xref" href="#appendix-E"></a><a class="xref" href="#name-authors-addresses">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="sec-intro">
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">
This document describes the TCP convergence-layer protocol for Delay-Tolerant Networking (DTN).
DTN is an end-to-end architecture providing communications in and/or through highly stressed environments, including those with intermittent connectivity, long and/or variable delays, and high bit error rates.
More detailed descriptions of the rationale and capabilities of these networks can be found in "<a class="xref" href="#RFC4838">Delay-Tolerant Networking Architecture</a>" <span>[<a class="xref" href="#RFC4838">RFC4838</a>]</span>.<a class="pilcrow" href="#section-1-1">Â¶</a></p>
<p id="section-1-2">
An important goal of the DTN architecture is to accommodate a wide range of networking technologies and environments.
The protocol used for DTN communications is the Bundle Protocol version 7 (BPv7) <span>[<a class="xref" href="#RFC9171">RFC9171</a>]</span>, an application-layer protocol that is used to construct a store-and-forward overlay network.
BPv7 requires the services of a "convergence-layer adapter" (CLA) to send and receive bundles using the service of some "native" link, network, or Internet protocol.
This document describes one such convergence-layer adapter that uses the well-known Transmission Control Protocol (TCP).
This convergence layer is referred to as TCP Convergence Layer version 4 (TCPCLv4).
For the remainder of this document,<a class="pilcrow" href="#section-1-2">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-3.1">the abbreviation "BP" without the version suffix refers to BPv7.<a class="pilcrow" href="#section-1-3.1">Â¶</a>
</li>
        <li class="normal" id="section-1-3.2">the abbreviation "TCPCL" without the version suffix refers to TCPCLv4.<a class="pilcrow" href="#section-1-3.2">Â¶</a>
</li>
      </ul>
<p id="section-1-4">
The locations of the TCPCL and the Bundle Protocol in the Internet model protocol stack (described in <span>[<a class="xref" href="#RFC1122">RFC1122</a>]</span>) are shown in <a class="xref" href="#fig-tcpcl-ip-stack">Figure 1</a>.
In particular, when BP is using TCP as its bearer with the TCPCL as its convergence layer, both BP and the TCPCL reside at the application layer of the Internet model.<a class="pilcrow" href="#section-1-4">Â¶</a></p>
<span id="name-the-locations-of-the-bundle"></span><div id="fig-tcpcl-ip-stack">
<figure id="figure-1">
        <div class="alignCenter art-ascii-art art-text artwork" id="section-1-5.1">
<pre>+-------------------------+
|     DTN Application     | -\
+-------------------------|   |
|  Bundle Protocol (BP)   |   -&gt; Application Layer
+-------------------------+   |
| TCP Conv. Layer (TCPCL) |   |
+-------------------------+   |
|     TLS (optional)      | -/
+-------------------------+
|          TCP            | ---&gt; Transport Layer
+-------------------------+
|       IPv4/IPv6         | ---&gt; Network Layer
+-------------------------+
|   Link-Layer Protocol   | ---&gt; Link Layer
+-------------------------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-1">Figure 1</a>:
<a class="selfRef" href="#name-the-locations-of-the-bundle">The Locations of the Bundle Protocol and the TCP Convergence-Layer Protocol above the Internet Protocol Stack</a>
        </figcaption></figure>
</div>
<section id="section-1.1">
        <h3 id="name-scope">
<a class="section-number selfRef" href="#section-1.1">1.1. </a><a class="section-name selfRef" href="#name-scope">Scope</a>
        </h3>
<p id="section-1.1-1">
This document describes the format of the protocol data units passed between entities participating in TCPCL communications.
This document does not address:<a class="pilcrow" href="#section-1.1-1">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-2.1">
The format of protocol data units of the Bundle Protocol, as those are defined elsewhere in <span>[<a class="xref" href="#RFC9171">RFC9171</a>]</span>.
This includes the concept of bundle fragmentation or bundle encapsulation.
The TCPCL transfers bundles as opaque data blocks.<a class="pilcrow" href="#section-1.1-2.1">Â¶</a>
</li>
          <li class="normal" id="section-1.1-2.2">
Mechanisms for locating or identifying other bundle entities (peers) within a network or across an internet.
The mapping of a node ID to a potential convergence layer (CL) protocol and network address is left to implementation and configuration of the BP Agent (BPA) and its various potential routing strategies, as is the mapping of a DNS name and/or address to a choice of an end-entity certificate to authenticate a node to its peers.<a class="pilcrow" href="#section-1.1-2.2">Â¶</a>
</li>
          <li class="normal" id="section-1.1-2.3">
Logic for routing bundles along a path toward a bundle's endpoint.
This CL protocol is involved only in transporting bundles between adjacent entities in a routing sequence.<a class="pilcrow" href="#section-1.1-2.3">Â¶</a>
</li>
          <li class="normal" id="section-1.1-2.4">
Policies or mechanisms for issuing Public Key Infrastructure Using X.509 (PKIX) certificates; provisioning, deploying, or accessing certificates and private keys; deploying or accessing certificate revocation lists (CRLs); or configuring security parameters on an individual entity or across a network.<a class="pilcrow" href="#section-1.1-2.4">Â¶</a>
</li>
          <li class="normal" id="section-1.1-2.5">
Uses of TLS that are not based on PKIX certificate authentication (see <a class="xref" href="#sec-security-tlsnopki">Section 7.12.2</a>) or in which authentication of both entities is not possible (see <a class="xref" href="#sec-security-tlsnoauth">Section 7.12.1</a>).<a class="pilcrow" href="#section-1.1-2.5">Â¶</a>
</li>
        </ul>
<p id="section-1.1-3">
Any TCPCL implementation requires a BPA to perform those above-listed functions in order to perform end-to-end bundle delivery.<a class="pilcrow" href="#section-1.1-3">Â¶</a></p>
</section>
</section>
</div>
<section id="section-2">
      <h2 id="name-requirements-language">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-requirements-language">Requirements Language</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>",
       "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>",
       "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>",
       "<span class="bcp14">SHOULD NOT</span>",
       "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
       "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document
       are to be interpreted as described in BCPÂ 14
       <span>[<a class="xref" href="#RFC2119">RFC2119</a>]</span> <span>[<a class="xref" href="#RFC8174">RFC8174</a>]</span> when, and only
       when, they appear in all capitals, as shown here.<a class="pilcrow" href="#section-2-1">Â¶</a></p>
<div id="sec-term-defs">
<section id="section-2.1">
        <h3 id="name-definitions-specific-to-the">
<a class="section-number selfRef" href="#section-2.1">2.1. </a><a class="section-name selfRef" href="#name-definitions-specific-to-the">Definitions Specific to the TCPCL Protocol</a>
        </h3>
<p id="section-2.1-1">
This section contains definitions specific to the TCPCL protocol.<a class="pilcrow" href="#section-2.1-1">Â¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.1-2">
          <dt id="section-2.1-2.1">Network Byte Order:</dt>
          <dd id="section-2.1-2.2" style="margin-left: 1.5em">
Here, "network byte order" means most significant byte first, a.k.a. big endian.
All of the integer encodings in this protocol <span class="bcp14">SHALL</span> be transmitted in network byte order.<a class="pilcrow" href="#section-2.1-2.2">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-2.3">TCPCL Entity:</dt>
          <dd id="section-2.1-2.4" style="margin-left: 1.5em">
            <p id="section-2.1-2.4.1">
This is the notional TCPCL application that initiates TCPCL sessions.
This design, implementation, configuration, and specific behavior of such an entity is outside of the scope of this document.
However, the concept of an entity has utility within the scope of this document as the container and initiator of TCPCL sessions.
The relationship between a TCPCL entity and TCPCL sessions is defined as follows:<a class="pilcrow" href="#section-2.1-2.4.1">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-2.4.2.1">
A TCPCL entity <span class="bcp14">MAY</span> actively initiate any number of TCPCL sessions and should do so whenever the entity is the initial transmitter of information to another entity in the network.<a class="pilcrow" href="#section-2.1-2.4.2.1">Â¶</a>
</li>
              <li class="normal" id="section-2.1-2.4.2.2">
A TCPCL entity <span class="bcp14">MAY</span> support zero or more passive listening elements that listen for connection requests from other TCPCL entities operating on other entities in the network.<a class="pilcrow" href="#section-2.1-2.4.2.2">Â¶</a>
</li>
              <li class="normal" id="section-2.1-2.4.2.3">
A TCPCL entity <span class="bcp14">MAY</span> passively initiate any number of TCPCL sessions from requests received by its passive listening element(s) if the entity uses such elements.<a class="pilcrow" href="#section-2.1-2.4.2.3">Â¶</a>
</li>
            </ul>
<p id="section-2.1-2.4.3">
These relationships are illustrated in <a class="xref" href="#fig-entity-session-relations">Figure 2</a>.
For most TCPCL behavior within a session, the two entities are symmetric and there is no protocol distinction between them.
Some specific behavior, particularly during session establishment, distinguishes between the active entity and the passive entity.
For the remainder of this document, the term "entity" without the prefix "TCPCL" refers to a TCPCL entity.<a class="pilcrow" href="#section-2.1-2.4.3">Â¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-2.5">TCP Connection:</dt>
          <dd id="section-2.1-2.6" style="margin-left: 1.5em">
The term "connection" in this specification exclusively refers to a TCP connection and any and all behaviors, sessions, and other states associated with that TCP connection.<a class="pilcrow" href="#section-2.1-2.6">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-2.7">TCPCL Session:</dt>
          <dd id="section-2.1-2.8" style="margin-left: 1.5em">
A TCPCL session (as opposed to a TCP connection) is a TCPCL communication relationship between two TCPCL entities.
A TCPCL session operates within a single underlying TCP connection, and the lifetime of a TCPCL session is bound to the lifetime of that TCP connection.
A TCPCL session is terminated when the TCP connection ends, due to either (1)Â one or both entities actively closing the TCP connection or (2)Â network errors causing a failure of the TCP connection.
Within a single TCPCL session, there are two possible transfer streams: one in each direction, with one stream from each entity being the outbound stream and the other being the inbound stream (see <a class="xref" href="#fig-session-stream">Figure 3</a>).
From the perspective of a TCPCL session, the two transfer streams do not logically interact with each other.
The streams do operate over the same TCP connection and between the same BPAs, so there are logical relationships at those layers (message and bundle interleaving, respectively).
For the remainder of this document, the term "session" without the prefix "TCPCL" refers to a TCPCL session.<a class="pilcrow" href="#section-2.1-2.8">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-2.9">Session Parameters:</dt>
          <dd id="section-2.1-2.10" style="margin-left: 1.5em">
These are a set of values used to affect the operation of the TCPCL for a given session.
The manner in which these parameters are conveyed to the bundle entity and thereby to the TCPCL is implementation dependent.
However, the mechanism by which two entities exchange and negotiate the values to be used for a given session is described in <a class="xref" href="#sec-contact-negotiate">Section 4.3</a>.<a class="pilcrow" href="#section-2.1-2.10">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-2.11">Transfer Stream:</dt>
          <dd id="section-2.1-2.12" style="margin-left: 1.5em">
A transfer stream is a unidirectional user-data path within a TCPCL session.
Transfers sent over a transfer stream are serialized, meaning that one transfer must complete its transmission prior to another transfer being started over the same transfer stream.
At the stream layer, there is no logical relationship between transfers in that stream; it's only within the BPA that transfers are fully decoded as bundles.
Each unidirectional stream has a single sender entity and a single receiver entity.<a class="pilcrow" href="#section-2.1-2.12">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-2.13">Transfer:</dt>
          <dd id="section-2.1-2.14" style="margin-left: 1.5em">
This refers to the procedures and mechanisms for conveyance of an individual bundle from one node to another.
Each transfer within the TCPCL is identified by a Transfer ID number, which is guaranteed to be unique only to a single direction within a single session.<a class="pilcrow" href="#section-2.1-2.14">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-2.15">Transfer Segment:</dt>
          <dd id="section-2.1-2.16" style="margin-left: 1.5em">
A transfer segment is a subset of a transfer of user data being communicated over a transfer stream.<a class="pilcrow" href="#section-2.1-2.16">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-2.17">Idle Session:</dt>
          <dd id="section-2.1-2.18" style="margin-left: 1.5em">
A TCPCL session is idle while there is no transmission in progress in either direction.
While idle, the only messages being transmitted or received are KEEPALIVE messages.<a class="pilcrow" href="#section-2.1-2.18">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-2.19">Live Session:</dt>
          <dd id="section-2.1-2.20" style="margin-left: 1.5em">
A TCPCL session is live while there is a transmission in progress in either direction.<a class="pilcrow" href="#section-2.1-2.20">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-2.21">Reason Codes:</dt>
          <dd id="section-2.1-2.22" style="margin-left: 1.5em">
The TCPCL uses numeric codes to encode specific reasons for individual failure/error message types.<a class="pilcrow" href="#section-2.1-2.22">Â¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-2.1-3">
The relationship between connections, sessions, and streams is shown in <a class="xref" href="#fig-session-stream">Figure 3</a>.<a class="pilcrow" href="#section-2.1-3">Â¶</a></p>
<span id="name-the-relationships-between-t"></span><div id="fig-entity-session-relations">
<figure id="figure-2">
          <div class="alignCenter art-ascii-art art-text artwork" id="section-2.1-4.1">
<pre>+--------------------------------------------+
|                 TCPCL Entity               |
|                                            |      +----------------+
|   +--------------------------------+       |      |                |-+
|   | Actively Initiated Session #1  +-------------&gt;| Other          | |
|   +--------------------------------+       |      | TCPCL Entity's | |
|                  ...                       |      | Passive        | |
|   +--------------------------------+       |      | Listener       | |
|   | Actively Initiated Session #n  +-------------&gt;|                | |
|   +--------------------------------+       |      +----------------+ |
|                                            |       +-----------------+
|      +---------------------------+         |
|  +---| +---------------------------+       |      +----------------+
|  |   | | Optional Passive          |       |      |                |-+
|  |   +-| Listener(s)               +&lt;-------------+                | |
|  |     +---------------------------+       |      |                | |
|  |                                         |      | Other          | |
|  |    +---------------------------------+  |      | TCPCL Entity's | |
|  +---&gt;| Passively Initiated Session #1  +--------&gt;| Active         | |
|  |    +---------------------------------+  |      | Initiator(s)   | |
|  |                                         |      |                | |
|  |    +---------------------------------+  |      |                | |
|  +---&gt;| Passively Initiated Session #n  +--------&gt;|                | |
|       +---------------------------------+  |      +----------------+ |
|                                            |       +-----------------+
+--------------------------------------------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-2">Figure 2</a>:
<a class="selfRef" href="#name-the-relationships-between-t">The Relationships between TCPCL Entities</a>
          </figcaption></figure>
</div>
<span id="name-the-relationship-within-a-t"></span><div id="fig-session-stream">
<figure id="figure-3">
          <div class="alignCenter art-ascii-art art-text artwork" id="section-2.1-5.1">
<pre>+---------------------------+              +---------------------------+
|    "Own" TCPCL Session    |              |   "Other" TCPCL Session   |
|                           |              |                           |
| +----------------------+  |              |  +----------------------+ |
| |   TCP Connection     |  |              |  |    TCP Connection    | |
| |                      |  |              |  |                      | |
| | +-----------------+  |  |   Messages   |  |  +-----------------+ | |
| | |   Own Inbound   |  +--------------------+  |  Peer Outbound  | | |
| | | Transfer Stream |                          | Transfer Stream | | |
| | |       -----     |&lt;---[Seg]--[Seg]--[Seg]---|       -----     | | |
| | |     RECEIVER    |---[Ack]----[Ack]--------&gt;|      SENDER     | | |
| | +-----------------+                          +-----------------+ | |
| |                                                                  | |
| | +-----------------+                          +-----------------+ | |
| | | Own Outbound    |-------[Seg]---[Seg]-----&gt;|  Peer Inbound   | | |
| | | Transfer Stream |&lt;---[Ack]----[Ack]-[Ack]--| Transfer Stream | | |
| | |       -----     |                          |       -----     | | |
| | |      SENDER     |   +--------------------+ |     RECEIVER    | | |
| | +-----------------+   |  |              |  | +-----------------+ | |
| +-----------------------+  |              |  +---------------------+ |
+----------------------------+              +--------------------------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-3">Figure 3</a>:
<a class="selfRef" href="#name-the-relationship-within-a-t">The Relationship within a TCPCL Session of its Two Streams</a>
          </figcaption></figure>
</div>
</section>
</div>
</section>
<div id="sec-prococol">
<section id="section-3">
      <h2 id="name-general-protocol-descriptio">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-general-protocol-descriptio">General Protocol Description</a>
      </h2>
<p id="section-3-1">
The service of this protocol is the transmission of DTN bundles via TCP.
This document specifies the encapsulation of bundles, procedures for TCP setup and teardown, and a set of messages and entity requirements.
The general operation of the protocol is as follows.<a class="pilcrow" href="#section-3-1">Â¶</a></p>
<div id="sec-cl-services">
<section id="section-3.1">
        <h3 id="name-convergence-layer-services">
<a class="section-number selfRef" href="#section-3.1">3.1. </a><a class="section-name selfRef" href="#name-convergence-layer-services">Convergence-Layer Services</a>
        </h3>
<p id="section-3.1-1">
This version of the TCPCL protocol provides the following services to support the overlaying BPA.
In all cases, this is not an API definition but a logical description of how the CL can interact with the BPA.
Each of these interactions can be associated with any number of additional metadata items as necessary to support the operation of the CL or BPA.<a class="pilcrow" href="#section-3.1-1">Â¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.1-2">
          <dt id="section-3.1-2.1">Attempt Session:</dt>
          <dd id="section-3.1-2.2" style="margin-left: 1.5em">
The TCPCL allows a BPA to preemptively attempt to establish a TCPCL session with a peer entity.
Each session attempt can send a different set of session negotiation parameters as directed by the BPA.<a class="pilcrow" href="#section-3.1-2.2">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-2.3">Terminate Session:</dt>
          <dd id="section-3.1-2.4" style="margin-left: 1.5em">
The TCPCL allows a BPA to preemptively terminate an established TCPCL session with a peer entity.
The terminate request is done on a per-session basis.<a class="pilcrow" href="#section-3.1-2.4">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-2.5">Session State Changed:</dt>
          <dd id="section-3.1-2.6" style="margin-left: 1.5em">
            <p id="section-3.1-2.6.1">
The TCPCL entity indicates to the BPA when the session state changes.
The top-level session states indicated are as follows:<a class="pilcrow" href="#section-3.1-2.6.1">Â¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.1-2.6.2">
              <dt id="section-3.1-2.6.2.1">Connecting:</dt>
              <dd id="section-3.1-2.6.2.2" style="margin-left: 1.5em">A TCP connection is being established. This state only applies to the active entity.<a class="pilcrow" href="#section-3.1-2.6.2.2">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-3.1-2.6.2.3">Contact Negotiating:</dt>
              <dd id="section-3.1-2.6.2.4" style="margin-left: 1.5em">A TCP connection has been made (as either the active or passive entity), and contact negotiation has begun.<a class="pilcrow" href="#section-3.1-2.6.2.4">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-3.1-2.6.2.5">Session Negotiating:</dt>
              <dd id="section-3.1-2.6.2.6" style="margin-left: 1.5em">Contact negotiation has been completed (including possible TLS use), and session negotiation has begun.<a class="pilcrow" href="#section-3.1-2.6.2.6">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-3.1-2.6.2.7">Established:</dt>
              <dd id="section-3.1-2.6.2.8" style="margin-left: 1.5em">
The session has been fully established and is ready for its first transfer.
When the session is established, the peer node ID (along with an indication of whether or not it was authenticated) and the negotiated session parameters (see <a class="xref" href="#sec-session-negotiate">Section 4.7</a>) are also communicated to the BPA.<a class="pilcrow" href="#section-3.1-2.6.2.8">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-3.1-2.6.2.9">Ending:</dt>
              <dd id="section-3.1-2.6.2.10" style="margin-left: 1.5em">The entity sent a SESS_TERM message and is in the Ending state.<a class="pilcrow" href="#section-3.1-2.6.2.10">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-3.1-2.6.2.11">Terminated:</dt>
              <dd id="section-3.1-2.6.2.12" style="margin-left: 1.5em">The session has finished normal termination sequencing.<a class="pilcrow" href="#section-3.1-2.6.2.12">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-3.1-2.6.2.13">Failed:</dt>
              <dd id="section-3.1-2.6.2.14" style="margin-left: 1.5em">The session ended without normal termination sequencing.<a class="pilcrow" href="#section-3.1-2.6.2.14">Â¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-2.7">Session Idle Changed:</dt>
          <dd id="section-3.1-2.8" style="margin-left: 1.5em">
The TCPCL entity indicates to the BPA when the Live/Idle substate of the session changes.
This occurs only when the top-level session state is "Established".
The session transitions from Idle to Live at the start of a transfer in either transfer stream; the session transitions from Live to Idle at the end of a transfer when the other transfer stream does not have an ongoing transfer.
Because the TCPCL transmits serially over a TCP connection, it suffers from "head-of-queue blocking", so a transfer in either direction can block an immediate start of a new transfer in the session.<a class="pilcrow" href="#section-3.1-2.8">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-2.9">Begin Transmission:</dt>
          <dd id="section-3.1-2.10" style="margin-left: 1.5em">
The principal purpose of the TCPCL is to allow a BPA to transmit bundle data over an established TCPCL session.
Transmission requests are done on a per-session basis, and the CL does not necessarily perform any per-session or inter-session queueing.
Any queueing of transmissions is the obligation of the BPA.<a class="pilcrow" href="#section-3.1-2.10">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-2.11">Transmission Success:</dt>
          <dd id="section-3.1-2.12" style="margin-left: 1.5em">
The TCPCL entity indicates to the BPA when a bundle has been fully transferred to a peer entity.<a class="pilcrow" href="#section-3.1-2.12">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-2.13">Transmission Intermediate Progress:</dt>
          <dd id="section-3.1-2.14" style="margin-left: 1.5em">
The TCPCL entity indicates to the BPA the intermediate progress of a transfer to a peer entity.
This intermediate progress is at the granularity of each transferred segment.<a class="pilcrow" href="#section-3.1-2.14">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-2.15">Transmission Failure:</dt>
          <dd id="section-3.1-2.16" style="margin-left: 1.5em">
The TCPCL entity indicates to the BPA certain reasons for bundle transmission failure, notably when the peer entity rejects the bundle or when a TCPCL session ends before transfer success.
The TCPCL itself does not have a notion of transfer timeout.<a class="pilcrow" href="#section-3.1-2.16">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-2.17">Reception Initialized:</dt>
          <dd id="section-3.1-2.18" style="margin-left: 1.5em">
The TCPCL entity indicates this status to the receiving BPA just before any transmission data is sent.
This corresponds to reception of the XFER_SEGMENT message with the <code>START</code> flag set to 1.<a class="pilcrow" href="#section-3.1-2.18">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-2.19">Interrupt Reception:</dt>
          <dd id="section-3.1-2.20" style="margin-left: 1.5em">
The TCPCL entity allows a BPA to interrupt an individual transfer before it has fully completed (successfully or not).
Interruption can occur any time after the reception is initialized.<a class="pilcrow" href="#section-3.1-2.20">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-2.21">Reception Success:</dt>
          <dd id="section-3.1-2.22" style="margin-left: 1.5em">
The TCPCL entity indicates to the BPA when a bundle has been fully transferred from a peer entity.<a class="pilcrow" href="#section-3.1-2.22">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-2.23">Reception Intermediate Progress:</dt>
          <dd id="section-3.1-2.24" style="margin-left: 1.5em">
The TCPCL entity indicates to the BPA the intermediate progress of a transfer from the peer entity.
This intermediate progress is at the granularity of each transferred segment.
An indication of intermediate reception gives a BPA the chance to inspect bundle header contents before the entire bundle is available and thus supports the "Interrupt Reception" capability.<a class="pilcrow" href="#section-3.1-2.24">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-2.25">Reception Failure:</dt>
          <dd id="section-3.1-2.26" style="margin-left: 1.5em">
The TCPCL entity indicates to the BPA certain reasons for reception failure, notably when the local entity rejects an attempted transfer for some local policy reason or when a TCPCL session ends before transfer success.
The TCPCL itself does not have a notion of transfer timeout.<a class="pilcrow" href="#section-3.1-2.26">Â¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-protocol-session">
<section id="section-3.2">
        <h3 id="name-tcpcl-session-overview">
<a class="section-number selfRef" href="#section-3.2">3.2. </a><a class="section-name selfRef" href="#name-tcpcl-session-overview">TCPCL Session Overview</a>
        </h3>
<p id="section-3.2-1">
First, one entity establishes a TCPCL session to the other by initiating a TCP connection in accordance with <span>[<a class="xref" href="#RFC0793">RFC0793</a>]</span>.
After setup of the TCP connection is complete, an initial Contact Header is exchanged in both directions to establish a shared TCPCL version and negotiate the use of TLS security (as described in <a class="xref" href="#sec-session-establishment">Section 4</a>).
Once contact negotiation is complete, TCPCL messaging is available and the session negotiation is used to set parameters of the TCPCL session.
One of these parameters is a node ID; each TCPCL entity is acting on behalf of a BPA having a node ID.
This is used to assist in routing and forwarding messages by the BPA and is part of the authentication capability provided by TLS.<a class="pilcrow" href="#section-3.2-1">Â¶</a></p>
<p id="section-3.2-2">
Once negotiated, the parameters of a TCPCL session cannot change; if there is a desire by either peer to transfer data under different parameters, then a new session must be established.
This makes CL logic simpler but relies on the assumption that establishing a TCP connection is lightweight enough that TCP connection overhead is negligible compared to TCPCL data sizes.<a class="pilcrow" href="#section-3.2-2">Â¶</a></p>
<p id="section-3.2-3">
Once the TCPCL session is established and configured in this way, bundles can be transferred in either direction.
Each transfer is performed by segmenting the transfer data into one or more XFER_SEGMENT messages.
Multiple bundles can be transmitted consecutively in a single direction on a single TCPCL connection.
Segments from different bundles are never interleaved.
Bundle interleaving can be accomplished by fragmentation at the BP layer or by establishing multiple TCPCL sessions between the same peers.
There is no fundamental limit on the number of TCPCL sessions that a single entity can establish, beyond the limit imposed by the number of available (ephemeral) TCP ports of the active entity.<a class="pilcrow" href="#section-3.2-3">Â¶</a></p>
<p id="section-3.2-4">
One feature of this protocol is that the receiving entity can send acknowledgment (XFER_ACK) messages as bundle data segments arrive.
The rationale behind these acknowledgments is to enable the transmitting entity to determine how much of the bundle has been received, so that if the session is interrupted, it can perform reactive fragmentation to avoid resending the
already-transmitted part of the bundle.
In addition, there is no explicit flow control on the TCPCL.<a class="pilcrow" href="#section-3.2-4">Â¶</a></p>
<p id="section-3.2-5">
A TCPCL receiver can interrupt the transmission of a bundle at any point in time by replying with a XFER_REFUSE message, which causes the sender to stop transmission of the associated bundle (if it hasn't already finished transmission).<a class="pilcrow" href="#section-3.2-5">Â¶</a></p>
<aside id="section-3.2-6">
          <p id="section-3.2-6.1">
Note: This enables a cross-layer optimization in that it allows a receiver that detects that it has already received a certain bundle to interrupt transmission as early as possible and thus save transmission capacity for other bundles.<a class="pilcrow" href="#section-3.2-6.1">Â¶</a></p>
</aside>
<p id="section-3.2-7">
For sessions that are idle, a KEEPALIVE message is sent at a negotiated interval.
This is used to convey entity liveness information during otherwise messageless time intervals.<a class="pilcrow" href="#section-3.2-7">Â¶</a></p>
<p id="section-3.2-8">
A SESS_TERM message is used to initiate the ending of a TCPCL session (see <a class="xref" href="#sec-SESS_TERM">Section 6.1</a>).
During termination sequencing, in-progress transfers can be completed but no new transfers can be initiated.
A SESS_TERM message can also be used to refuse a session setup by a peer (see <a class="xref" href="#sec-contact-negotiate">Section 4.3</a>).
Regardless of the reason, session termination is initiated by one of the entities and  the other entity responds to it, as illustrated by FiguresÂ <a class="xref" href="#fig-sessterm-init">13</a> and <a class="xref" href="#fig-sessterm-respond">14</a> in the next subsection.
Even when there are no transfers queued or in progress, the session termination procedure allows each entity to distinguish between a clean end to a session and the TCP connection being closed because of some underlying network issue.<a class="pilcrow" href="#section-3.2-8">Â¶</a></p>
<p id="section-3.2-9">
Once a session is established, the TCPCL is a symmetric protocol between the peers.
Both sides can start sending data segments in a session, and one side's bundle transfer does not have to complete before the other side can start sending data segments on its own.
Hence, the protocol allows for a bidirectional mode of communication.
Note that in the case of concurrent bidirectional transmission, acknowledgment segments <span class="bcp14">MAY</span> be interleaved with data segments.<a class="pilcrow" href="#section-3.2-9">Â¶</a></p>
</section>
</div>
<div id="sec-protocol-states">
<section id="section-3.3">
        <h3 id="name-tcpcl-states-and-transition">
<a class="section-number selfRef" href="#section-3.3">3.3. </a><a class="section-name selfRef" href="#name-tcpcl-states-and-transition">TCPCL States and Transitions</a>
        </h3>
<p id="section-3.3-1">
The states of a normal TCPCL session (i.e., without session failures) are indicated in <a class="xref" href="#fig-session-states">Figure 4</a>.<a class="pilcrow" href="#section-3.3-1">Â¶</a></p>
<span id="name-top-level-states-of-a-tcpcl"></span><div id="fig-session-states">
<figure id="figure-4">
          <div class="alignCenter art-ascii-art art-text artwork" id="section-3.3-2.1">
<pre>  +-------+
  | START |
  +-------+
      |
  TCP Establishment
      |
      V
+-----------+            +---------------------+
|    TCP    |-----------&gt;|  Contact / Session  |
| Connected |            |     Negotiation     |
+-----------+            +---------------------+
                                    |
       +-----Session Parameters-----+
       |         Negotiated
       V
+-------------+                     +-------------+
| Established |----New Transfer----&gt;| Established |
|   Session   |                     |   Session   |
|    Idle     |&lt;---Transfers Done---|     Live    |
+-------------+                     +-------------+
      |                                    |
      +------------------------------------+
      |
      V
+-------------+
| Established |                    +-------------+
|   Session   |----Transfers------&gt;|     TCP     |
|   Ending    |      Done          | Terminating |
+-------------+                    +-------------+
                                           |
     +----------TCP Close Message----------+
     |
     V
 +-------+
 |  END  |
 +-------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-4">Figure 4</a>:
<a class="selfRef" href="#name-top-level-states-of-a-tcpcl">Top-Level States of a TCPCL Session</a>
          </figcaption></figure>
</div>
<p id="section-3.3-3">
Notes on established session states:<a class="pilcrow" href="#section-3.3-3">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3-4.1">Session "Live" means transmitting or receiving over a transfer stream.<a class="pilcrow" href="#section-3.3-4.1">Â¶</a>
</li>
          <li class="normal" id="section-3.3-4.2">Session "Idle" means no transmission/reception over a transfer stream.<a class="pilcrow" href="#section-3.3-4.2">Â¶</a>
</li>
          <li class="normal" id="section-3.3-4.3">Session "Ending" means no new transfers will be allowed.<a class="pilcrow" href="#section-3.3-4.3">Â¶</a>
</li>
        </ul>
<p id="section-3.3-5">
Contact negotiation involves exchanging a Contact Header ("CH" in FiguresÂ <a class="xref" href="#fig-contact-init-active">5</a>, <a class="xref" href="#fig-contact-init-passive">6</a>, and <a class="xref" href="#fig-contact-init-process">7</a>) in both directions and deriving a negotiated state from the two headers.
The contact negotiation sequencing is performed as either the active or passive entity and is illustrated in FiguresÂ <a class="xref" href="#fig-contact-init-active">5</a> and <a class="xref" href="#fig-contact-init-passive">6</a>, respectively, which both share the data validation and negotiation of the Processing of Contact Header ("[PCH]") activity (<a class="xref" href="#fig-contact-init-process">Figure 7</a>) and the "[TCPCLOSE]" activity, which indicates TCP connection close.
Successful negotiation results in one of the Session Initiation ("[SI]") activities being performed, as shown further below.
To avoid data loss, a Session Termination ("[ST]") exchange allows cleanly finishing transfers before a session is ended.<a class="pilcrow" href="#section-3.3-5">Â¶</a></p>
<span id="name-contact-initiation-as-activ"></span><div id="fig-contact-init-active">
<figure id="figure-5">
          <div class="alignCenter art-ascii-art art-text artwork" id="section-3.3-6.1">
<pre>+-------+
| START |
+-------+
    |
TCP Connecting
    V
+-----------+
|    TCP    |            +---------+
| Connected |--Send CH--&gt;| Waiting |--Timeout--&gt;[TCPCLOSE]
+-----------+            +---------+
                              |
                          Received CH
                              V
                            [PCH]
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-5">Figure 5</a>:
<a class="selfRef" href="#name-contact-initiation-as-activ">Contact Initiation as Active Entity</a>
          </figcaption></figure>
</div>
<span id="name-contact-initiation-as-passi"></span><div id="fig-contact-init-passive">
<figure id="figure-6">
          <div class="alignCenter art-ascii-art art-text artwork" id="section-3.3-7.1">
<pre>+-----------+             +---------+
|   TCP     |--Wait for--&gt;| Waiting |--Timeout--&gt;[TCPCLOSE]
| Connected |     CH      +---------+
+-----------+                  |
                          Received CH
                               V
                       +-----------------+
                       | Preparing reply |--Send CH--&gt;[PCH]
                       +-----------------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-6">Figure 6</a>:
<a class="selfRef" href="#name-contact-initiation-as-passi">Contact Initiation as Passive Entity</a>
          </figcaption></figure>
</div>
<span id="name-processing-of-contact-heade"></span><div id="fig-contact-init-process">
<figure id="figure-7">
          <div class="alignCenter art-ascii-art art-text artwork" id="section-3.3-8.1">
<pre>+-----------+
|  Peer CH  |
| available |
+-----------+
      |
 Validate and
  Negotiate
      V
 +------------+
 | Negotiated |--Failure--&gt;[TCPCLOSE]
 +------------+
    |       |
  No TLS    +----Negotiate---+      [ST]
    |               TLS      |       ^
    V                        |    Failure
  +-----------+              V       |
  |   TCPCL   |            +---------------+
  | Messaging |&lt;--Success--| TLS Handshake |
  | Available |            +---------------+
  +-----------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-7">Figure 7</a>:
<a class="selfRef" href="#name-processing-of-contact-heade">Processing of Contact Header [PCH]</a>
          </figcaption></figure>
</div>
<p id="section-3.3-9">
Session negotiation involves exchanging a session initialization (SESS_INIT) message in both directions and deriving a negotiated state from the two messages.
The session negotiation sequencing is performed as either the active or passive entity and is illustrated in FiguresÂ <a class="xref" href="#fig-sess-init-active">8</a> and <a class="xref" href="#fig-sess-init-passive">9</a>, respectively (where "[PSI]" means "Processing of Session Initiation"), which both share the data validation and negotiation shown in <a class="xref" href="#fig-sess-init-process">Figure 10</a>.
The validation here includes certificate validation and authentication when TLS is used for the session.<a class="pilcrow" href="#section-3.3-9">Â¶</a></p>
<span id="name-session-initiation-si-as-ac"></span><div id="fig-sess-init-active">
<figure id="figure-8">
          <div class="alignCenter art-ascii-art art-text artwork" id="section-3.3-10.1">
<pre>+-----------+
|   TCPCL   |                   +---------+
| Messaging |--Send SESS_INIT--&gt;| Waiting |--Timeout--&gt;[ST]
| Available |                   +---------+
+-----------+                       |
                            Received SESS_INIT
                                    |
                                    V
                                  [PSI]
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-8">Figure 8</a>:
<a class="selfRef" href="#name-session-initiation-si-as-ac">Session Initiation [SI] as Active Entity</a>
          </figcaption></figure>
</div>
<span id="name-session-initiation-si-as-pa"></span><div id="fig-sess-init-passive">
<figure id="figure-9">
          <div class="alignCenter art-ascii-art art-text artwork" id="section-3.3-11.1">
<pre>+-----------+
|   TCPCL   |                  +---------+
| Messaging |----Wait for ----&gt;| Waiting |--Timeout--&gt;[ST]
| Available |    SESS_INIT     +---------+
+-----------+                       |
                            Received SESS_INIT
                                    |
                            +-----------------+
                            | Preparing reply |--Send SESS_INIT--&gt;[PSI]
                            +-----------------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-9">Figure 9</a>:
<a class="selfRef" href="#name-session-initiation-si-as-pa">Session Initiation [SI] as Passive Entity</a>
          </figcaption></figure>
</div>
<span id="name-processing-of-session-initi"></span><div id="fig-sess-init-process">
<figure id="figure-10">
          <div class="alignCenter art-ascii-art art-text artwork" id="section-3.3-12.1">
<pre>+----------------+
| Peer SESS_INIT |
|   available    |
+----------------+
        |
   Validate and
    Negotiate
        V
   +------------+
   | Negotiated |---Failure---&gt;[ST]
   +------------+
        |
     Success
        V
  +--------------+
  | Established  |
  | Session Idle |
  +--------------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-10">Figure 10</a>:
<a class="selfRef" href="#name-processing-of-session-initi">Processing of Session Initiation [PSI]</a>
          </figcaption></figure>
</div>
<p id="section-3.3-13">
Transfers can occur after a session is established and it's not in the Ending state.
Each transfer occurs within a single logical transfer stream between a sender and a receiver, as illustrated in FiguresÂ <a class="xref" href="#fig-transfer-tx-states">11</a> and <a class="xref" href="#fig-transfer-rx-states">12</a>, respectively.<a class="pilcrow" href="#section-3.3-13">Â¶</a></p>
<span id="name-transfer-sender-states"></span><div id="fig-transfer-tx-states">
<figure id="figure-11">
          <div class="alignCenter art-ascii-art art-text artwork" id="section-3.3-14.1">
<pre>                                       +--Send XFER_SEGMENT--+
+--------+                             |                     |
| Stream |                       +-------------+             |
|  Idle  |---Send XFER_SEGMENT--&gt;| In Progress |&lt;------------+
+--------+                       +-------------+
                                       |
     +---------All segments sent-------+
     |
     V
+---------+                       +--------+
| Waiting |---- Receive Final----&gt;| Stream |
| for Ack |       XFER_ACK        |  Idle  |
+---------+                       +--------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-11">Figure 11</a>:
<a class="selfRef" href="#name-transfer-sender-states">Transfer Sender States</a>
          </figcaption></figure>
</div>
<aside id="section-3.3-15">
          <p id="section-3.3-15.1">
Note on transfer sending: Pipelining of transfers can occur when the sending entity begins a new transfer while in the "Waiting for Ack" state.<a class="pilcrow" href="#section-3.3-15.1">Â¶</a></p>
</aside>
<span id="name-transfer-receiver-states"></span><div id="fig-transfer-rx-states">
<figure id="figure-12">
          <div class="alignCenter art-ascii-art art-text artwork" id="section-3.3-16.1">
<pre>                                         +-Receive XFER_SEGMENT-+
+--------+                               |    Send XFER_ACK     |
| Stream |                         +-------------+              |
|  Idle  |--Receive XFER_SEGMENT--&gt;| In Progress |&lt;-------------+
+--------+                         +-------------+
                                         |
     +--------Sent Final XFER_ACK--------+
     |
     V
+--------+
| Stream |
|  Idle  |
+--------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-12">Figure 12</a>:
<a class="selfRef" href="#name-transfer-receiver-states">Transfer Receiver States</a>
          </figcaption></figure>
</div>
<p id="section-3.3-17">
Session termination involves one entity initiating the termination of the session and the other entity acknowledging the termination.
For either entity, it is the sending of the SESS_TERM message, which transitions the session to the Ending substate.
While a session is in the Ending state, only in-progress transfers can be completed and no new transfers can be started.<a class="pilcrow" href="#section-3.3-17">Â¶</a></p>
<span id="name-session-termination-st-from"></span><div id="fig-sessterm-init">
<figure id="figure-13">
          <div class="alignCenter art-ascii-art art-text artwork" id="section-3.3-18.1">
<pre>+-----------+                   +---------+
|  Session  |--Send SESS_TERM--&gt;| Session |
| Live/Idle |                   | Ending  |
+-----------+                   +---------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-13">Figure 13</a>:
<a class="selfRef" href="#name-session-termination-st-from">Session Termination [ST] from the Initiator</a>
          </figcaption></figure>
</div>
<span id="name-session-termination-st-from-"></span><div id="fig-sessterm-respond">
<figure id="figure-14">
          <div class="alignCenter art-ascii-art art-text artwork" id="section-3.3-19.1">
<pre>+-----------+                   +---------+
|  Session  |--Send SESS_TERM--&gt;| Session |
| Live/Idle |                   | Ending  |
+-----------+&lt;------+           +---------+
      |             |
 Receive SESS_TERM  |
      |             |
      +-------------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-14">Figure 14</a>:
<a class="selfRef" href="#name-session-termination-st-from-">Session Termination [ST] from the Responder</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="sec-pkix-env">
<section id="section-3.4">
        <h3 id="name-pkix-environments-and-ca-po">
<a class="section-number selfRef" href="#section-3.4">3.4. </a><a class="section-name selfRef" href="#name-pkix-environments-and-ca-po">PKIX Environments and CA Policy</a>
        </h3>
<p id="section-3.4-1">
This specification defines requirements regarding how to use PKIX certificates issued by a Certificate Authority (CA) but does not define any mechanisms for how those certificates come to be.
The requirements regarding TCPCL certificate use are broad, to support two quite different PKIX environments:<a class="pilcrow" href="#section-3.4-1">Â¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.4-2">
          <dt id="section-3.4-2.1">DTN-Aware CAs:</dt>
          <dd id="section-3.4-2.2" style="margin-left: 1.5em">
In the ideal case, the CA or CAs issuing certificates for TCPCL entities are aware of the end use of the certificate, have a mechanism for verifying ownership of a node ID, and are issuing certificates directly for that node ID.
In this environment, the ability to authenticate a peer entity node ID directly avoids the need to authenticate a network name or address and then implicitly trust the node ID of the peer.
The TCPCL authenticates the node ID whenever possible; this is preferred over lower-level PKIX identities.<a class="pilcrow" href="#section-3.4-2.2">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.4-2.3">DTN-Ignorant CAs:</dt>
          <dd id="section-3.4-2.4" style="margin-left: 1.5em">
It is expected that Internet-scale "public" CAs will continue to focus on DNS names as the preferred PKIX identifier.
There are large infrastructures already in place for managing network-level authentication and protocols to manage identity verification in those environments <span>[<a class="xref" href="#RFC8555">RFC8555</a>]</span>.
The TCPCL allows for this type of environment by authenticating a lower-level identifier for a peer and requiring the entity to trust that the node ID given by the peer (during session initialization) is valid.
This situation is not ideal, as it allows the vulnerabilities described in <a class="xref" href="#sec-threat-node-impersonation">Section 7.9</a>, but it still provides some amount of mutual authentication to take place for a TCPCL session.<a class="pilcrow" href="#section-3.4-2.4">Â¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-3.4-3">
Even within a single TCPCL session, each entity may operate within different PKI environments and with different identifier limitations.
The requirements related to identifiers in a PKIX certificate are provided in <a class="xref" href="#sec-tls-identification">Section 4.4.1</a>.<a class="pilcrow" href="#section-3.4-3">Â¶</a></p>
<p id="section-3.4-4">
It is important for interoperability that a TCPCL entity have its own security policy tailored to accommodate the peers with which it is expected to operate.
Some security policy recommendations are given in <a class="xref" href="#sec-tls-auth-policy-rec">Section 4.4.5</a>, but these are meant as a starting point for tailoring.
A strict TLS security policy is appropriate for a private network with a single shared CA.
Operation on the Internet (such as inter-site BP gateways) could trade more lax TCPCL security with the use of encrypted bundle encapsulation <span>[<a class="xref" href="#I-D.ietf-dtn-bibect">DTN-BIBECT</a>]</span> to ensure strong bundle security.<a class="pilcrow" href="#section-3.4-4">Â¶</a></p>
<p id="section-3.4-5">
By using the Server Name Indication (SNI) DNS name (see <a class="xref" href="#sec-tls-handshake">Section 4.4.3</a>), a single passive entity can act as a convergence layer for multiple BPAs with distinct node IDs.
When this "virtual host" behavior is used, the DNS name is used as the indication of which BP node the active entity is attempting to communicate with.
A virtual host CL entity can be authenticated by a certificate containing all of the DNS names and/or node IDs being hosted or by several certificates each authenticating a single DNS name and/or node ID, using the SNI value from the peer to select which certificate to use.
The logic for mapping an SNI DNS name to an end-entity certificate is an implementation matter and can involve correlating a DNS name with a node ID or other certificate attributes.<a class="pilcrow" href="#section-3.4-5">Â¶</a></p>
</section>
</div>
<div id="sec-session-keeping">
<section id="section-3.5">
        <h3 id="name-session-keeping-policies">
<a class="section-number selfRef" href="#section-3.5">3.5. </a><a class="section-name selfRef" href="#name-session-keeping-policies">Session-Keeping Policies</a>
        </h3>
<p id="section-3.5-1">
This specification defines requirements regarding how to initiate, sustain, and terminate a TCPCL session but does not impose any requirements on how sessions need to be managed by a BPA.
It is a network administration matter to determine an appropriate session-keeping policy, but guidance given here can be used to steer policy toward performance goals.<a class="pilcrow" href="#section-3.5-1">Â¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.5-2">
          <dt id="section-3.5-2.1">Persistent Session:</dt>
          <dd id="section-3.5-2.2" style="margin-left: 1.5em">
This policy preemptively establishes a single session to known entities in the network and keeps the session active using KEEPALIVEs.
Benefits of this policy include reducing the total amount of TCP data that needs to be exchanged for a set of transfers (assuming that the KEEPALIVE size is significantly smaller than the transfer size) and allowing the session state to indicate peer connectivity.
Drawbacks include wasted network resources when a session is mostly idle or when  network connectivity is inconsistent (which requires that failed sessions be reestablished), and potential queueing issues when multiple transfers are requested simultaneously.
This policy assumes that there is agreement between pairs of entities as to which of the peers will initiate sessions; if there is no such agreement, there is potential for duplicate sessions to be established between peers.<a class="pilcrow" href="#section-3.5-2.2">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.5-2.3">Ephemeral Sessions:</dt>
          <dd id="section-3.5-2.4" style="margin-left: 1.5em">
This policy only establishes a session when an outgoing transfer needs to be sent.
Benefits of this policy include not wasting network resources on sessions that are idle for long periods of time and avoiding potential queueing issues as can be seen when using a single persistent session. Drawbacks include the TCP and TLS overhead of establishing a new session for each transfer.
This policy assumes that each entity can function in a passive role to listen for session requests from any peer that needs to send a transfer; when that is not the case, the polling behavior discussed below needs to happen.
This policy can be augmented to keep the session established as long as any transfers are queued.<a class="pilcrow" href="#section-3.5-2.4">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.5-2.5">Active-Only Polling Sessions:</dt>
          <dd id="section-3.5-2.6" style="margin-left: 1.5em">
When naming and/or addressing of one entity is variable (i.e., a dynamically assigned IP address or domain name) or when firewall or routing rules prevent incoming TCP connections, that entity can only function in the active role.
In these cases, sessions also need to be established when an incoming transfer is expected from a peer or based on a periodic schedule.
This polling behavior causes inefficiencies compared to as-needed ephemeral sessions.<a class="pilcrow" href="#section-3.5-2.6">Â¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-3.5-3">
Many other policies can be established in a TCPCL network between the two extremes of single persistent sessions and only ephemeral sessions.
Different policies can be applied to each peer entity and to each bundle as it needs to be transferred (e.g., for quality of service).
Additionally, future session extension types can apply further nuance to session policies and policy negotiation.<a class="pilcrow" href="#section-3.5-3">Â¶</a></p>
</section>
</div>
<div id="sec-transfer-segmentation">
<section id="section-3.6">
        <h3 id="name-transfer-segmentation-polic">
<a class="section-number selfRef" href="#section-3.6">3.6. </a><a class="section-name selfRef" href="#name-transfer-segmentation-polic">Transfer Segmentation Policies</a>
        </h3>
<p id="section-3.6-1">
Each TCPCL session allows a negotiated transfer segmentation policy to be applied in each transfer direction.
A receiving entity can set the Segment Maximum Receive Unit (MRU) in its SESS_INIT message to determine the largest acceptable segment size, and a transmitting entity can segment a transfer into any sizes smaller than the receiver's Segment MRU.
It is a network administration matter to determine an appropriate segmentation policy for entities using the TCPCL protocol, but guidance given here can be used to steer policy toward performance goals.
Administrators are also advised to consider the Segment MRU in relation to chunking/packetization performed by TLS, TCP, and any intermediate network-layer nodes.<a class="pilcrow" href="#section-3.6-1">Â¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.6-2">
          <dt id="section-3.6-2.1">Minimum Overhead:</dt>
          <dd id="section-3.6-2.2" style="margin-left: 1.5em">
For a simple network expected to exchange relatively small bundles, the Segment MRU can be set to be identical to the Transfer MRU, which indicates that all transfers can be sent with a single data segment (i.e., no actual segmentation).
If the network is closed and all transmitters are known to follow a single-segment transfer policy, then receivers can avoid the necessity of segment reassembly.
Because this CL operates over a TCP stream, which suffers from a form of head-of-queue blocking between messages, while one entity is transmitting a single XFER_SEGMENT message it is not able to transmit any XFER_ACK or XFER_REFUSE messages for any associated received transfers.<a class="pilcrow" href="#section-3.6-2.2">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.6-2.3">Predictable Message Sizing:</dt>
          <dd id="section-3.6-2.4" style="margin-left: 1.5em">
In situations where the maximum message size is desired to be well controlled, the Segment MRU can be set to the largest acceptable size (the message size less the XFER_SEGMENT header size) and transmitters can always segment a transfer into maximum-size chunks no larger than the Segment MRU.
This guarantees that any single XFER_SEGMENT will not monopolize the TCP stream for too long, which would prevent outgoing XFER_ACK and XFER_REFUSE messages associated with received transfers.<a class="pilcrow" href="#section-3.6-2.4">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.6-2.5">Dynamic Segmentation:</dt>
          <dd id="section-3.6-2.6" style="margin-left: 1.5em">
Even after negotiation of a Segment MRU for each receiving entity, the actual transfer segmentation only needs to guarantee that any individual segment is no larger than that MRU.
In a situation where TCP throughput is dynamic, the transfer segmentation size can also be dynamic in order to control message transmission duration.<a class="pilcrow" href="#section-3.6-2.6">Â¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-3.6-3">
Many other policies can be established in a TCPCL network between the two extremes of minimum overhead (large MRU, single segment) and predictable message sizing (small MRU, highly segmented).
Different policies can be applied to each transfer stream to and from any particular entity.
Additionally, future session extension and transfer extension types can apply further nuance to transfer policies and policy negotiation.<a class="pilcrow" href="#section-3.6-3">Â¶</a></p>
</section>
</div>
<div id="sec-protocol-example">
<section id="section-3.7">
        <h3 id="name-example-message-exchange">
<a class="section-number selfRef" href="#section-3.7">3.7. </a><a class="section-name selfRef" href="#name-example-message-exchange">Example Message Exchange</a>
        </h3>
<p id="section-3.7-1">
<a class="xref" href="#fig-contact-example">Figure 15</a> depicts the protocol exchange for a simple session, showing the session establishment and the transmission of a single bundle split into three data segments (of lengths "L1", "L2", and "L3") from Entity A to Entity B.<a class="pilcrow" href="#section-3.7-1">Â¶</a></p>
<p id="section-3.7-2">
Note that the sending entity can transmit multiple XFER_SEGMENT messages without waiting for the corresponding XFER_ACK responses.
This enables pipelining of messages on a transfer stream.
Although this example only demonstrates a single bundle transmission, it is also possible to pipeline multiple XFER_SEGMENT messages for different bundles without necessarily waiting for XFER_ACK messages to be returned for each one.
However, interleaving data segments from different bundles is not allowed.<a class="pilcrow" href="#section-3.7-2">Â¶</a></p>
<p id="section-3.7-3">
No errors or rejections are shown in this example.<a class="pilcrow" href="#section-3.7-3">Â¶</a></p>
<span id="name-an-example-of-the-flow-of-p"></span><div id="fig-contact-example">
<figure id="figure-15">
          <div class="alignCenter art-ascii-art art-text artwork" id="section-3.7-4.1">
<pre>             Entity A                             Entity B
             ========                             ========
    +-------------------------+
    |  Open TCP Connection    | -&gt;      +-------------------------+
    +-------------------------+      &lt;- |    Accept Connection    |
                                        +-------------------------+
    +-------------------------+
    |     Contact Header      | -&gt;      +-------------------------+
    +-------------------------+      &lt;- |     Contact Header      |
                                        +-------------------------+
    +-------------------------+
    |        SESS_INIT        | -&gt;      +-------------------------+
    +-------------------------+      &lt;- |        SESS_INIT        |
                                        +-------------------------+

    +-------------------------+
    |   XFER_SEGMENT (start)  | -&gt;
    |     Transfer ID [I1]    |
    |       Length [L1]       |
    |  Bundle Data 0..(L1-1)  |
    +-------------------------+
    +-------------------------+         +-------------------------+
    |     XFER_SEGMENT        | -&gt;   &lt;- |     XFER_ACK (start)    |
    |     Transfer ID [I1]    |         |     Transfer ID [I1]    |
    |       Length   [L2]     |         |        Length   [L1]    |
    |Bundle Data L1..(L1+L2-1)|         +-------------------------+
    +-------------------------+
    +-------------------------+         +-------------------------+
    |    XFER_SEGMENT (end)   | -&gt;   &lt;- |         XFER_ACK        |
    |     Transfer ID [I1]    |         |     Transfer ID [I1]    |
    |        Length   [L3]    |         |      Length   [L1+L2]   |
    |Bundle Data              |         +-------------------------+
    |    (L1+L2)..(L1+L2+L3-1)|
    +-------------------------+
                                        +-------------------------+
                                     &lt;- |      XFER_ACK (end)     |
                                        |     Transfer ID [I1]    |
                                        |     Length   [L1+L2+L3] |
                                        +-------------------------+

    +-------------------------+
    |       SESS_TERM         | -&gt;      +-------------------------+
    +-------------------------+      &lt;- |        SESS_TERM        |
                                        +-------------------------+
    +-------------------------+         +-------------------------+
    |        TCP Close        | -&gt;   &lt;- |        TCP Close        |
    +-------------------------+         +-------------------------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-15">Figure 15</a>:
<a class="selfRef" href="#name-an-example-of-the-flow-of-p">An Example of the Flow of Protocol Messages on a Single TCP Session between Two Entities</a>
          </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="sec-session-establishment">
<section id="section-4">
      <h2 id="name-session-establishment">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-session-establishment">Session Establishment</a>
      </h2>
<p id="section-4-1">
For bundle transmissions to occur using the TCPCL, a TCPCL session <span class="bcp14">MUST</span> first be established between communicating entities.
It is up to the implementation to decide how and when session setup is triggered.
For example, some sessions can be opened proactively and maintained for as long as is possible given the network conditions, while other sessions will be opened only when there is a bundle that is queued for transmission and the routing algorithm selects a certain next-hop node.<a class="pilcrow" href="#section-4-1">Â¶</a></p>
<div id="sec-tcp-connection">
<section id="section-4.1">
        <h3 id="name-tcp-connection">
<a class="section-number selfRef" href="#section-4.1">4.1. </a><a class="section-name selfRef" href="#name-tcp-connection">TCP Connection</a>
        </h3>
<p id="section-4.1-1">
To establish a TCPCL session, an entity <span class="bcp14">MUST</span> first establish a TCP connection with the intended peer entity, typically by using the services provided by the operating system.
Destination port number 4556 has been assigned by IANA as the registered port number for the TCPCL; see <a class="xref" href="#sec-iana-port">Section 8.1</a>.
Other destination port numbers <span class="bcp14">MAY</span> be used per local configuration.
Determining a peer's destination port number (if different from the registered TCPCL port number) is left up to the implementation.
Any source port number <span class="bcp14">MAY</span> be used for TCPCL sessions.
Typically, an operating system assigned number in the TCP Ephemeral range (49152-65535) is used.<a class="pilcrow" href="#section-4.1-1">Â¶</a></p>
<p id="section-4.1-2">
If the entity is unable to establish a TCP connection for any reason, then it is an implementation matter to determine how to handle the connection failure.
An entity <span class="bcp14">MAY</span> decide to reattempt to establish the connection.
If it does so, it <span class="bcp14">MUST NOT</span> overwhelm its target with repeated connection attempts.
Therefore, the entity <span class="bcp14">MUST NOT</span> retry the connection setup earlier than some delay time from the last attempt, and it <span class="bcp14">SHOULD</span> use a (binary) exponential backoff mechanism to increase this delay in the case of repeated failures.
The upper limit on a reattempt backoff is implementation defined but <span class="bcp14">SHOULD</span> be no longer than one minute (60 seconds) before signaling to the BPA that a connection cannot be made.<a class="pilcrow" href="#section-4.1-2">Â¶</a></p>
<p id="section-4.1-3">
Once a TCP connection is established, the active entity <span class="bcp14">SHALL</span> immediately transmit its Contact Header. The passive entity <span class="bcp14">SHALL</span> wait for the active entity's Contact Header.
Upon reception of a Contact Header, the passive entity <span class="bcp14">SHALL</span> transmit its Contact Header.
If either entity does not receive a Contact Header after some implementation-defined time duration after the TCP connection is established, the waiting entity <span class="bcp14">SHALL</span> close the TCP connection. Entities <span class="bcp14">SHOULD</span> choose a Contact Header reception timeout interval no longer than one minute (60 seconds).
The ordering of the Contact Header exchange allows the passive entity to avoid allocating resources to a potential TCPCL session until after a valid Contact Header has been received from the active entity.
This ordering also allows the passive peer to adapt to alternate TCPCL protocol versions.<a class="pilcrow" href="#section-4.1-3">Â¶</a></p>
<p id="section-4.1-4">
The format of the Contact Header is described in <a class="xref" href="#sec-contact-header">Section 4.2</a>.
Because the TCPCL protocol version in use is part of the initial Contact Header, entities using TCPCL version 4 can coexist on a network with entities using earlier TCPCL versions (with some negotiation needed for interoperation, as described in <a class="xref" href="#sec-contact-negotiate">Section 4.3</a>).<a class="pilcrow" href="#section-4.1-4">Â¶</a></p>
<p id="section-4.1-5">
Within this specification, when an entity is said to "close" a TCP connection the entity <span class="bcp14">SHALL</span> use the TCP FIN mechanism and not the RST mechanism.
However, either mechanism, when received, will cause a TCP connection to become closed.<a class="pilcrow" href="#section-4.1-5">Â¶</a></p>
</section>
</div>
<div id="sec-contact-header">
<section id="section-4.2">
        <h3 id="name-contact-header">
<a class="section-number selfRef" href="#section-4.2">4.2. </a><a class="section-name selfRef" href="#name-contact-header">Contact Header</a>
        </h3>
<p id="section-4.2-1">
This section describes the format of the Contact Header and the meaning of its fields.<a class="pilcrow" href="#section-4.2-1">Â¶</a></p>
<p id="section-4.2-2">
If the entity is configured to enable the exchange of messages according to TLS 1.3 <span>[<a class="xref" href="#RFC8446">RFC8446</a>]</span> or any successors that are compatible with that TLS ClientHello, the <code>CAN_TLS</code> flag within its Contact Header <span class="bcp14">SHALL</span> be set to 1.
The <span class="bcp14">RECOMMENDED</span> policy is to enable TLS for all sessions, even if security policy does not allow or require authentication.
This follows the "opportunistic security" model specified in <span>[<a class="xref" href="#RFC7435">RFC7435</a>]</span>, though an active attacker could interfere with the exchange in such cases (see <a class="xref" href="#sec-threat-tls-strip">Section 7.4</a>).<a class="pilcrow" href="#section-4.2-2">Â¶</a></p>
<p id="section-4.2-3">
Upon receipt of the Contact Header, both entities perform the validation and negotiation procedures defined in <a class="xref" href="#sec-contact-negotiate">Section 4.3</a>.
After receiving the Contact Header from the other entity, either entity <span class="bcp14">MAY</span> refuse the session by sending a SESS_TERM message with an appropriate reason code.<a class="pilcrow" href="#section-4.2-3">Â¶</a></p>
<p id="section-4.2-4">
The format for the Contact Header is as follows:<a class="pilcrow" href="#section-4.2-4">Â¶</a></p>
<span id="name-contact-header-format"></span><div id="fig-contact-header">
<figure id="figure-16">
          <div class="alignCenter art-ascii-art art-text artwork" id="section-4.2-5.1">
<pre>                     1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 3 3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|                          magic='dtn!'                         |
+---------------+---------------+---------------+---------------+
|     Version   |   Flags       |
+---------------+---------------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-16">Figure 16</a>:
<a class="selfRef" href="#name-contact-header-format">Contact Header Format</a>
          </figcaption></figure>
</div>
<p id="section-4.2-6">
See <a class="xref" href="#sec-contact-negotiate">Section 4.3</a> for details on the use of each of these Contact Header fields.<a class="pilcrow" href="#section-4.2-6">Â¶</a></p>
<p id="section-4.2-7">
The fields of the Contact Header are as follows:<a class="pilcrow" href="#section-4.2-7">Â¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.2-8">
          <dt id="section-4.2-8.1">magic:</dt>
          <dd id="section-4.2-8.2" style="margin-left: 1.5em">
A four-octet field that always contains the octet sequence 0x64 0x74 0x6E 0x21, i.e., the text string "dtn!" in US-ASCII (and UTF-8).<a class="pilcrow" href="#section-4.2-8.2">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-8.3">Version:</dt>
          <dd id="section-4.2-8.4" style="margin-left: 1.5em">
A one-octet field value containing the value 4 (current version of the TCPCL protocol).<a class="pilcrow" href="#section-4.2-8.4">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-8.5">Flags:</dt>
          <dd id="section-4.2-8.6" style="margin-left: 1.5em">
A one-octet field of single-bit flags, interpreted according to the descriptions in <a class="xref" href="#tab-contact-header-flags">Table 1</a>.
All reserved header flag bits <span class="bcp14">SHALL</span> be set to 0 by the sender.
All reserved header flag bits <span class="bcp14">SHALL</span> be ignored by the receiver.<a class="pilcrow" href="#section-4.2-8.6">Â¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<span id="name-contact-header-flags"></span><div id="tab-contact-header-flags">
<table class="center" id="table-1">
          <caption>
<a class="selfRef" href="#table-1">Table 1</a>:
<a class="selfRef" href="#name-contact-header-flags">Contact Header Flags</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Name</th>
              <th class="text-left" colspan="1" rowspan="1">Code</th>
              <th class="text-left" colspan="1" rowspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">
                <code>CAN_TLS</code>
</td>
              <td class="text-left" colspan="1" rowspan="1">0x01</td>
              <td class="text-left" colspan="1" rowspan="1">If this bit is set, it indicates that the sending peer has enabled TLS security.</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">Reserved</td>
              <td class="text-left" colspan="1" rowspan="1">others</td>
              <td class="text-left" colspan="1" rowspan="1"></td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="sec-contact-negotiate">
<section id="section-4.3">
        <h3 id="name-contact-validation-and-nego">
<a class="section-number selfRef" href="#section-4.3">4.3. </a><a class="section-name selfRef" href="#name-contact-validation-and-nego">Contact Validation and Negotiation</a>
        </h3>
<p id="section-4.3-1">
Upon reception of the Contact Header, each entity follows the following procedures to ensure the validity of the TCPCL session and to negotiate values for the session parameters.<a class="pilcrow" href="#section-4.3-1">Â¶</a></p>
<p id="section-4.3-2">
If the "magic string" is not present or is not valid, the connection <span class="bcp14">MUST</span> be terminated.
The intent of the magic string is to provide some protection against an inadvertent TCP connection by a different protocol than the one described in this document.
To prevent a flood of repeated connections from a misconfigured application, a passive entity <span class="bcp14">MAY</span> deny new TCP connections from a specific peer address for a period of time after one or more connections fail to provide a decodable Contact Header.<a class="pilcrow" href="#section-4.3-2">Â¶</a></p>
<p id="section-4.3-3">
The first negotiation attempts to determine which TCPCL protocol version to use.
The active entity always sends its Contact Header first and waits for a response from the passive entity.
During contact initiation, the active TCPCL entity <span class="bcp14">SHALL</span> send the highest TCPCL protocol version on a first session attempt for a TCPCL peer.
If the active entity receives a Contact Header with a lower protocol version than the one sent earlier on the TCP connection, the TCP connection <span class="bcp14">SHALL</span> be closed.
If the active entity receives a SESS_TERM message with a reason code of "Version mismatch", that entity <span class="bcp14">MAY</span> attempt further TCPCL sessions with the peer using earlier protocol version numbers in decreasing order.
Managing multi-TCPCL-session state such as this is an implementation matter.<a class="pilcrow" href="#section-4.3-3">Â¶</a></p>
<p id="section-4.3-4">
If the passive entity receives a Contact Header containing a version that is not a version of the TCPCL protocol that the entity implements, then the entity <span class="bcp14">SHALL</span> send its Contact Header and immediately terminate the session with a reason code of "Version mismatch".
If the passive entity receives a Contact Header with a version that is lower than the latest version of the protocol that the entity implements, the entity <span class="bcp14">MAY</span> either terminate the session (with a reason code of "Version mismatch") or adapt its operation to conform to the older version of the protocol.
The decision of version fallback is an implementation matter.<a class="pilcrow" href="#section-4.3-4">Â¶</a></p>
<p id="section-4.3-5">
The negotiated contact parameters defined by this specification are described in the following paragraphs.<a class="pilcrow" href="#section-4.3-5">Â¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.3-6">
          <dt id="section-4.3-6.1">TCPCL Version:</dt>
          <dd id="section-4.3-6.2" style="margin-left: 1.5em">
Both Contact Headers of a successful contact negotiation have identical TCPCL version numbers as described above.
Only upon response of a Contact Header from the passive entity is the TCPCL protocol version established and session negotiation begun.<a class="pilcrow" href="#section-4.3-6.2">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.3-6.3">Enable TLS:</dt>
          <dd id="section-4.3-6.4" style="margin-left: 1.5em">
            <p id="section-4.3-6.4.1">
Negotiation of the Enable TLS parameter is performed by taking the logical AND of the two Contact Headers' <code>CAN_TLS</code> flags.
A local security policy is then applied to determine whether the negotiated value of Enable TLS is acceptable.
A reasonable security policy would require or disallow the use of TLS, depending upon the desired network flows.
The <span class="bcp14">RECOMMENDED</span> policy is to require TLS for all sessions, even if security policy does not allow or require authentication.
Because this state is negotiated over an unsecured medium, there is a risk of TLS Stripping as described in <a class="xref" href="#sec-threat-tls-strip">Section 7.4</a>.<a class="pilcrow" href="#section-4.3-6.4.1">Â¶</a></p>
<p id="section-4.3-6.4.2">
If the Enable TLS state is unacceptable, the entity <span class="bcp14">SHALL</span> terminate the session with a reason code of "Contact Failure".
Note that this "Contact Failure" reason is different than a failure of a TLS handshake or TLS authentication after an agreed-upon and acceptable Enable TLS state.
If the negotiated Enable TLS value is "true" and acceptable, then the TLS negotiation feature described in <a class="xref" href="#sec-session-security">Section 4.4</a> begins immediately following the Contact Header exchange.<a class="pilcrow" href="#section-4.3-6.4.2">Â¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-session-security">
<section id="section-4.4">
        <h3 id="name-session-security">
<a class="section-number selfRef" href="#section-4.4">4.4. </a><a class="section-name selfRef" href="#name-session-security">Session Security</a>
        </h3>
<p id="section-4.4-1">
This version of the TCPCL protocol supports establishing a TLS session within an existing TCP connection.
When TLS is used within the TCPCL, it affects the entire session.
Once TLS is established, there is no mechanism available to downgrade the TCPCL session to non-TLS operation.<a class="pilcrow" href="#section-4.4-1">Â¶</a></p>
<p id="section-4.4-2">
Once established, the lifetime of a TLS connection <span class="bcp14">SHALL</span> be bound to the lifetime of the underlying TCP connection.
Immediately prior to actively ending a TLS connection after TCPCL session termination, the peer that sent the original (non-reply) SESS_TERM message <span class="bcp14">SHOULD</span> follow the closure alert procedure provided in <span>[<a class="xref" href="#RFC8446">RFC8446</a>]</span> to cleanly terminate the TLS connection.
Because each TCPCL message is either fixed length or self-indicates its length, the lack of a TLS closure alert will not cause data truncation or corruption.<a class="pilcrow" href="#section-4.4-2">Â¶</a></p>
<p id="section-4.4-3">
Subsequent TCPCL session attempts to the same passive entity <span class="bcp14">MAY</span> attempt to use the TLS session resumption feature.
There is no guarantee that the passive entity will accept the request to resume a TLS session, and the active entity cannot assume any resumption outcome.<a class="pilcrow" href="#section-4.4-3">Â¶</a></p>
<div id="sec-tls-identification">
<section id="section-4.4.1">
          <h4 id="name-entity-identification">
<a class="section-number selfRef" href="#section-4.4.1">4.4.1. </a><a class="section-name selfRef" href="#name-entity-identification">Entity Identification</a>
          </h4>
<p id="section-4.4.1-1">
The TCPCL uses TLS for certificate exchange in both directions to identify each entity and to allow each entity to authenticate its peer.
Each certificate can potentially identify multiple entities, and there is no problem using such a certificate as long as the identifiers are sufficient to meet authentication policy (as described in later sections) for the entity that presents it.<a class="pilcrow" href="#section-4.4.1-1">Â¶</a></p>
<p id="section-4.4.1-2">
Because the PKIX environment of each TCPCL entity is likely not controlled by the certificate end users (see <a class="xref" href="#sec-pkix-env">Section 3.4</a>), the TCPCL defines a prioritized list of what a certificate can identify regarding a TCPCL entity:<a class="pilcrow" href="#section-4.4.1-2">Â¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.4.1-3">
            <dt id="section-4.4.1-3.1">Node ID:</dt>
            <dd id="section-4.4.1-3.2" style="margin-left: 1.5em">
The ideal certificate identity is the node ID of the entity using the NODE-ID, as defined below.
When the node ID is identified, there is no need for any lower-level identification to be present (though it can still be present, and if so it is also validated).<a class="pilcrow" href="#section-4.4.1-3.2">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.4.1-3.3">DNS Name:</dt>
            <dd id="section-4.4.1-3.4" style="margin-left: 1.5em">
If CA policy forbids a certificate to contain an arbitrary NODE-ID but allows a DNS-ID to be identified, then one or more stable DNS names can be identified in the certificate.
The use of wildcard DNS-IDs is discouraged due to the complex rules for matching and dependence on implementation support for wildcard matching (see <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6125#section-6.4.3">Section 6.4.3</a> of [<a class="xref" href="#RFC6125">RFC6125</a>]</span>).<a class="pilcrow" href="#section-4.4.1-3.4">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.4.1-3.5">Network Address:</dt>
            <dd id="section-4.4.1-3.6" style="margin-left: 1.5em">
If no stable DNS name is available but a stable network address is available and CA policy allows a certificate to contain an IPADDR-ID (as defined below), then one or more network addresses can be identified in the certificate.<a class="pilcrow" href="#section-4.4.1-3.6">Â¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-4.4.1-4">
This specification defines a NODE-ID of a certificate as being the subjectAltName entry of type otherName with a name form of <code>BundleEID</code> (see <a class="xref" href="#sec-pkix-oids">Section 4.4.2.1</a>) and a value limited to a node ID.
An entity <span class="bcp14">SHALL</span> ignore any entry of type otherName with a name form of <code>BundleEID</code> and a value that is some URI other than a node ID.
The NODE-ID is similar to the URI-ID as defined in <span>[<a class="xref" href="#RFC6125">RFC6125</a>]</span> but is restricted to a node ID rather than a URI with a qualified-name authority part.
Unless specified otherwise by the definition of the URI scheme being authenticated, URI matching of a NODE-ID <span class="bcp14">SHALL</span> use the URI comparison logic provided in <span>[<a class="xref" href="#RFC3986">RFC3986</a>]</span> and scheme-based normalization of those schemes specified in <span>[<a class="xref" href="#RFC9171">RFC9171</a>]</span>.
A URI scheme can refine this "exact match" logic with rules regarding how node IDs within that scheme are to be compared with the certificate-authenticated NODE-ID.<a class="pilcrow" href="#section-4.4.1-4">Â¶</a></p>
<p id="section-4.4.1-5">
This specification reuses the DNS-ID definition in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6125#section-1.8">Section 1.8</a> of [<a class="xref" href="#RFC6125">RFC6125</a>]</span>, which is the subjectAltName entry of type dNSName whose value is encoded according to <span>[<a class="xref" href="#RFC5280">RFC5280</a>]</span>.<a class="pilcrow" href="#section-4.4.1-5">Â¶</a></p>
<p id="section-4.4.1-6">
This specification defines an IPADDR-ID of a certificate as being the subjectAltName entry of type iPAddress whose value is encoded according to <span>[<a class="xref" href="#RFC5280">RFC5280</a>]</span>.<a class="pilcrow" href="#section-4.4.1-6">Â¶</a></p>
</section>
</div>
<div id="sec-tcpcl-cert-profile">
<section id="section-4.4.2">
          <h4 id="name-certificate-profile-for-the">
<a class="section-number selfRef" href="#section-4.4.2">4.4.2. </a><a class="section-name selfRef" href="#name-certificate-profile-for-the">Certificate Profile for the TCPCL</a>
          </h4>
<p id="section-4.4.2-1">
All end-entity certificates used by a TCPCL entity <span class="bcp14">SHALL</span> conform to <span>[<a class="xref" href="#RFC5280">RFC5280</a>]</span>, or any updates or successors to that profile.
When an end-entity certificate is supplied, the full certification chain <span class="bcp14">SHOULD</span> be included unless security policy indicates that is unnecessary.
An entity <span class="bcp14">SHOULD</span> omit the root CA certificate (the last item of the chain) when sending a certification chain, as the recipient already has the root CA to anchor its validation.<a class="pilcrow" href="#section-4.4.2-1">Â¶</a></p>
<p id="section-4.4.2-2">
The TCPCL requires version 3 certificates due to the extensions used by this profile.
TCPCL entities <span class="bcp14">SHALL</span> reject as invalid version 1 and version 2 end-entity certificates.<a class="pilcrow" href="#section-4.4.2-2">Â¶</a></p>
<p id="section-4.4.2-3">
TCPCL entities <span class="bcp14">SHALL</span> accept certificates that contain an empty Subject field or contain a Subject without a Common Name.
Identity information in end-entity certificates is contained entirely in the subjectAltName extension as defined in <a class="xref" href="#sec-tls-identification">Section 4.4.1</a> and discussed in the paragraphs below.<a class="pilcrow" href="#section-4.4.2-3">Â¶</a></p>
<p id="section-4.4.2-4">
All end-entity and CA certificates used for the TCPCL <span class="bcp14">SHOULD</span> contain both a subject key identifier and an authority key identifier extension in accordance with <span>[<a class="xref" href="#RFC5280">RFC5280</a>]</span>.
TCPCL entities <span class="bcp14">SHOULD NOT</span> rely on either a subject key identifier or an authority key identifier being present in any received certificate. Including key identifiers simplifies the work of an entity that needs to assemble a certification chain.<a class="pilcrow" href="#section-4.4.2-4">Â¶</a></p>
<p id="section-4.4.2-5">
Unless prohibited by CA policy, a TCPCL end-entity certificate <span class="bcp14">SHALL</span> contain a NODE-ID that authenticates the node ID of the peer.
When assigned one or more stable DNS names, a TCPCL end-entity certificate <span class="bcp14">SHOULD</span> contain a DNS-ID that authenticates those (fully qualified) names.
When assigned one or more stable network addresses, a TCPCL end-entity certificate <span class="bcp14">MAY</span> contain an IPADDR-ID that authenticates those addresses.<a class="pilcrow" href="#section-4.4.2-5">Â¶</a></p>
<p id="section-4.4.2-6">
When allowed by CA policy, a Bundle Protocol Security (BPSec; see <span>[<a class="xref" href="#RFC9172">RFC9172</a>]</span>) end-entity certificate <span class="bcp14">SHOULD</span> contain a PKIX Extended Key Usage (EKU) extension in accordance with <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc5280#section-4.2.1.12">Section 4.2.1.12</a> of [<a class="xref" href="#RFC5280">RFC5280</a>]</span>.
When the PKIX EKU extension is present, it <span class="bcp14">SHOULD</span> contain the key purpose <code>id-kp-bundleSecurity</code> (see <a class="xref" href="#sec-pkix-oids">Section 4.4.2.1</a>). 
Although not specifically required by the TCPCL, some networks or TLS implementations assume that <code>id-kp-clientAuth</code> and <code>id-kp-serverAuth</code> need to be used for the client side and the server side of TLS authentication, respectively.
For interoperability, a TCPCL end-entity certificate <span class="bcp14">MAY</span> contain an EKU with both <code>id-kp-clientAuth</code> and <code>id-kp-serverAuth</code> values.<a class="pilcrow" href="#section-4.4.2-6">Â¶</a></p>
<p id="section-4.4.2-7">
When allowed by CA policy, a TCPCL end-entity certificate <span class="bcp14">SHOULD</span> contain a PKIX key usage extension in accordance with <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc5280#section-4.2.1.3">Section 4.2.1.3</a> of [<a class="xref" href="#RFC5280">RFC5280</a>]</span>.
The PKIX key usage bit that is consistent with TCPCL security using TLS 1.3 is digitalSignature.
The specific algorithms used during the TLS handshake will determine which of those key uses are exercised.
Earlier versions of TLS can mandate the use of the keyEncipherment bit or the keyAgreement bit.<a class="pilcrow" href="#section-4.4.2-7">Â¶</a></p>
<p id="section-4.4.2-8">
When allowed by CA policy, a TCPCL end-entity certificate <span class="bcp14">SHOULD</span> contain an Online Certificate Status Protocol (OCSP) URI within an authority information access extension in accordance with <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc5280#section-4.2.2.1">Section 4.2.2.1</a> of [<a class="xref" href="#RFC5280">RFC5280</a>]</span>.<a class="pilcrow" href="#section-4.4.2-8">Â¶</a></p>
<div id="sec-pkix-oids">
<section id="section-4.4.2.1">
            <h5 id="name-pkix-oid-allocations">
<a class="section-number selfRef" href="#section-4.4.2.1">4.4.2.1. </a><a class="section-name selfRef" href="#name-pkix-oid-allocations">PKIX OID Allocations</a>
            </h5>
<p id="section-4.4.2.1-1">
This document defines a PKIX Other Name Form identifier, <code>id-on-bundleEID</code>, in <a class="xref" href="#sec-asn1-mod">Appendix B</a>; this identifier can be used as the <code>type-id</code> in a subjectAltName entry of type otherName.
The <code>BundleEID</code> value associated with the otherName type-id <code>id-on-bundleEID</code> <span class="bcp14">SHALL</span> be a URI, encoded as an IA5String, with a scheme that is present in the IANA "Bundle Protocol URI Scheme Types" registry <span>[<a class="xref" href="#IANA-BUNDLE">IANA-BUNDLE</a>]</span>.
Although this Other Name Form allows any endpoint ID to be present, the NODE-ID defined in <a class="xref" href="#sec-tls-identification">Section 4.4.1</a> limits its use to contain only a node ID.<a class="pilcrow" href="#section-4.4.2.1-1">Â¶</a></p>
<p id="section-4.4.2.1-2">
This document defines a PKIX EKU key purpose, <code>id-kp-bundleSecurity</code>, in <a class="xref" href="#sec-asn1-mod">Appendix B</a>; this purpose  can be used to restrict a certificate's use.
The <code>id-kp-bundleSecurity</code> purpose can be combined with other purposes in the same certificate.<a class="pilcrow" href="#section-4.4.2.1-2">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-tls-handshake">
<section id="section-4.4.3">
          <h4 id="name-tls-handshake">
<a class="section-number selfRef" href="#section-4.4.3">4.4.3. </a><a class="section-name selfRef" href="#name-tls-handshake">TLS Handshake</a>
          </h4>
<p id="section-4.4.3-1">
The use of TLS is negotiated via the Contact Header, as described in <a class="xref" href="#sec-contact-negotiate">Section 4.3</a>.
After negotiating an Enable TLS parameter of "true", and before any other TCPCL messages are sent within the session, the session entities <span class="bcp14">SHALL</span> begin a TLS handshake in accordance with <span>[<a class="xref" href="#RFC8446">RFC8446</a>]</span>.
By convention, this protocol uses the entity that initiated the underlying TCP connection (the active peer) as the "client" role of the TLS handshake request.<a class="pilcrow" href="#section-4.4.3-1">Â¶</a></p>
<p id="section-4.4.3-2">
The TLS handshake, if it occurs, is considered to be part of the contact negotiation before the TCPCL session itself is established.
Specifics regarding exposure of sensitive data are discussed in <a class="xref" href="#sec-security">Section 7</a>.<a class="pilcrow" href="#section-4.4.3-2">Â¶</a></p>
<p id="section-4.4.3-3">
The parameters within each TLS negotiation are implementation dependent but any TCPCL entity <span class="bcp14">SHALL</span> follow all recommended practices specified in <span><a class="xref" href="#RFC7525">BCP 195</a> [<a class="xref" href="#RFC7525">RFC7525</a>]</span>, or any updates or successors that become part of BCP 195.
Within each TLS handshake, the following requirements apply (using the rough order in which they occur):<a class="pilcrow" href="#section-4.4.3-3">Â¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.4.3-4">
            <dt id="section-4.4.3-4.1">ClientHello:</dt>
            <dd id="section-4.4.3-4.2" style="margin-left: 1.5em">
              <p id="section-4.4.3-4.2.1">
When a resolved DNS name was used to establish the TCP connection, the TLS ClientHello <span class="bcp14">SHOULD</span> include a "server_name" extension in accordance with <span>[<a class="xref" href="#RFC6066">RFC6066</a>]</span>.
When present, the server_name extension <span class="bcp14">SHALL</span> contain a "HostName" value taken from the DNS name (of the passive entity) that was resolved.<a class="pilcrow" href="#section-4.4.3-4.2.1">Â¶</a></p>
<aside id="section-4.4.3-4.2.2">
                <p id="section-4.4.3-4.2.2.1">
Note: The "HostName" in the server_name extension is the network name for the passive entity, not the node ID of that entity.<a class="pilcrow" href="#section-4.4.3-4.2.2.1">Â¶</a></p>
</aside>
</dd>
            <dd class="break"></dd>
<dt id="section-4.4.3-4.3">Server Certificate:</dt>
            <dd id="section-4.4.3-4.4" style="margin-left: 1.5em">
The passive entity <span class="bcp14">SHALL</span> supply a certificate within the TLS handshake to allow authentication of its side of the session.
The supplied end-entity certificate <span class="bcp14">SHALL</span> conform to the profile described in <a class="xref" href="#sec-tcpcl-cert-profile">Section 4.4.2</a>.
The passive entity <span class="bcp14">MAY</span> use the SNI DNS name to choose an appropriate server-side certificate that authenticates that DNS name.<a class="pilcrow" href="#section-4.4.3-4.4">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.4.3-4.5">Certificate Request:</dt>
            <dd id="section-4.4.3-4.6" style="margin-left: 1.5em">
During the TLS handshake, the passive entity <span class="bcp14">SHALL</span> request a client-side certificate.<a class="pilcrow" href="#section-4.4.3-4.6">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.4.3-4.7">Client Certificate:</dt>
            <dd id="section-4.4.3-4.8" style="margin-left: 1.5em">
The active entity <span class="bcp14">SHALL</span> supply a certificate chain within the TLS handshake to allow authentication of its side of the session.
The supplied end-entity certificate <span class="bcp14">SHALL</span> conform to the profile described in <a class="xref" href="#sec-tcpcl-cert-profile">Section 4.4.2</a>.<a class="pilcrow" href="#section-4.4.3-4.8">Â¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-4.4.3-5">
If a TLS handshake cannot negotiate a TLS connection, both entities of the TCPCL session <span class="bcp14">SHALL</span> close the TCP connection.
At this point, the TCPCL session has not yet been established, so there is no TCPCL session to terminate.<a class="pilcrow" href="#section-4.4.3-5">Â¶</a></p>
<p id="section-4.4.3-6">
After a TLS connection is successfully established, the active entity <span class="bcp14">SHALL</span> send a SESS_INIT message to begin session negotiation.
This session negotiation and all subsequent messaging are secured.<a class="pilcrow" href="#section-4.4.3-6">Â¶</a></p>
</section>
</div>
<div id="sec-tls-authentication">
<section id="section-4.4.4">
          <h4 id="name-tls-authentication">
<a class="section-number selfRef" href="#section-4.4.4">4.4.4. </a><a class="section-name selfRef" href="#name-tls-authentication">TLS Authentication</a>
          </h4>
<p id="section-4.4.4-1">
Using PKIX certificates exchanged during the TLS handshake, each of the entities can authenticate a peer node ID directly or authenticate the peer DNS name or network address.
The logic for handling certificates and certificate data is separated into the following phases:<a class="pilcrow" href="#section-4.4.4-1">Â¶</a></p>
<ol class="normal type-1" id="section-4.4.4-2" start="1" type="1">
            <li id="section-4.4.4-2.1">Validating the certification path from the end-entity certificate up to a trusted root CA.<a class="pilcrow" href="#section-4.4.4-2.1">Â¶</a>
</li>
            <li id="section-4.4.4-2.2">Validating the EKU and other properties of the end-entity certificate.<a class="pilcrow" href="#section-4.4.4-2.2">Â¶</a>
</li>
            <li id="section-4.4.4-2.3">Authenticating identities from a valid end-entity certificate.<a class="pilcrow" href="#section-4.4.4-2.3">Â¶</a>
</li>
            <li id="section-4.4.4-2.4">Applying security policy to the result of each identity type authentication.<a class="pilcrow" href="#section-4.4.4-2.4">Â¶</a>
</li>
          </ol>
<p id="section-4.4.4-3">
The result of validating a peer identity (see <a class="xref" href="#sec-tls-identification">Section 4.4.1</a>) against one or more types of certificate claims is one of the following:<a class="pilcrow" href="#section-4.4.4-3">Â¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.4.4-4">
            <dt id="section-4.4.4-4.1">Absent:</dt>
            <dd id="section-4.4.4-4.2" style="margin-left: 1.5em">
Indicating that no such claims are present in the certificate and the identity cannot be authenticated.<a class="pilcrow" href="#section-4.4.4-4.2">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.4.4-4.3">Success:</dt>
            <dd id="section-4.4.4-4.4" style="margin-left: 1.5em">
Indicating that one or more such claims are present and at least one matches the peer identity value.<a class="pilcrow" href="#section-4.4.4-4.4">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.4.4-4.5">Failure:</dt>
            <dd id="section-4.4.4-4.6" style="margin-left: 1.5em">
Indicating that one or more such claims are present and none match the peer identity.<a class="pilcrow" href="#section-4.4.4-4.6">Â¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<div id="sec-tls-auth-valid-cert">
<section id="section-4.4.4.1">
            <h5 id="name-certificate-path-and-purpos">
<a class="section-number selfRef" href="#section-4.4.4.1">4.4.4.1. </a><a class="section-name selfRef" href="#name-certificate-path-and-purpos">Certificate Path and Purpose Validation</a>
            </h5>
<p id="section-4.4.4.1-1">
For any peer end-entity certificate received during the TLS handshake, the entity <span class="bcp14">SHALL</span> perform the certification path validation described in <span>[<a class="xref" href="#RFC5280">RFC5280</a>]</span> up to one of the entity's trusted CA certificates.
If enabled by local policy, the entity <span class="bcp14">SHALL</span> perform an OCSP check of each certificate providing OCSP authority information in accordance with <span>[<a class="xref" href="#RFC6960">RFC6960</a>]</span>.
If certificate validation fails or if security policy disallows a certificate for any reason, the entity <span class="bcp14">SHALL</span> fail the TLS handshake with a "bad_certificate" alert.
Leaving out part of the certification chain can cause the entity to fail to validate a certificate if the certificates that were left out are unknown to the entity (see <a class="xref" href="#sec-threat-untrust-cert">Section 7.6</a>).<a class="pilcrow" href="#section-4.4.4.1-1">Â¶</a></p>
<p id="section-4.4.4.1-2">
For the end-entity peer certificate received during the TLS handshake, the entity <span class="bcp14">SHALL</span> apply security policy to the key usage extension (if present) and EKU extension (if present) in accordance with SectionsÂ <a class="relref" href="https://www.rfc-editor.org/rfc/rfc5280#section-4.2.1.12">4.2.1.12</a> and <a class="relref" href="https://www.rfc-editor.org/rfc/rfc5280#section-4.2.1.3">4.2.1.3</a> of <span>[<a class="xref" href="#RFC5280">RFC5280</a>]</span>, respectively, and with the profile discussed in <a class="xref" href="#sec-tcpcl-cert-profile">Section 4.4.2</a> of this document.<a class="pilcrow" href="#section-4.4.4.1-2">Â¶</a></p>
</section>
</div>
<div id="sec-tls-auth-valid-netid">
<section id="section-4.4.4.2">
            <h5 id="name-network-level-authenticatio">
<a class="section-number selfRef" href="#section-4.4.4.2">4.4.4.2. </a><a class="section-name selfRef" href="#name-network-level-authenticatio">Network-Level Authentication</a>
            </h5>
<p id="section-4.4.4.2-1">
Either during or immediately after the TLS handshake, each entity, if required by security policy, <span class="bcp14">SHALL</span> validate the following certificate identifiers together in accordance with <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6125#section-6">Section 6</a> of [<a class="xref" href="#RFC6125">RFC6125</a>]</span>:<a class="pilcrow" href="#section-4.4.4.2-1">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4.4.2-2.1">
If the active entity resolved a DNS name (of the passive entity) in order to initiate the TCP connection, that DNS name <span class="bcp14">SHALL</span> be used as a DNS-ID reference identifier.<a class="pilcrow" href="#section-4.4.4.2-2.1">Â¶</a>
</li>
              <li class="normal" id="section-4.4.4.2-2.2">
The IP address of the other side of the TCP connection <span class="bcp14">SHALL</span> be used as an IPADDR-ID reference identifier.<a class="pilcrow" href="#section-4.4.4.2-2.2">Â¶</a>
</li>
            </ul>
<p id="section-4.4.4.2-3">
If the network-level identifier's authentication result is Failure or if the result is Absent and security policy requires an authenticated network-level identifier, the entity <span class="bcp14">SHALL</span> terminate the session (with a reason code of "Contact Failure").<a class="pilcrow" href="#section-4.4.4.2-3">Â¶</a></p>
</section>
</div>
<div id="sec-tls-auth-valid-nodeid">
<section id="section-4.4.4.3">
            <h5 id="name-node-id-authentication">
<a class="section-number selfRef" href="#section-4.4.4.3">4.4.4.3. </a><a class="section-name selfRef" href="#name-node-id-authentication">Node ID Authentication</a>
            </h5>
<p id="section-4.4.4.3-1">
Immediately before session parameter negotiation, each entity, if required by security policy, <span class="bcp14">SHALL</span> validate the certificate NODE-ID in accordance with <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6125#section-6">Section 6</a> of [<a class="xref" href="#RFC6125">RFC6125</a>]</span> using the node ID of the peer's SESS_INIT message as the NODE-ID reference identifier.
If the NODE-ID validation result is Failure or if the result is Absent and security policy requires an authenticated node ID, the entity <span class="bcp14">SHALL</span> terminate the session (with a reason code of "Contact Failure").<a class="pilcrow" href="#section-4.4.4.3-1">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-tls-auth-policy-rec">
<section id="section-4.4.5">
          <h4 id="name-policy-recommendations">
<a class="section-number selfRef" href="#section-4.4.5">4.4.5. </a><a class="section-name selfRef" href="#name-policy-recommendations">Policy Recommendations</a>
          </h4>
<p id="section-4.4.5-1">
A <span class="bcp14">RECOMMENDED</span> security policy encompasses the following:<a class="pilcrow" href="#section-4.4.5-1">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4.5-2.1">enabling the use of OCSP checking during the TLS handshake.<a class="pilcrow" href="#section-4.4.5-2.1">Â¶</a>
</li>
            <li class="normal" id="section-4.4.5-2.2">instructing that, if an EKU extension is present, the extension needs to contain <code>id-kp-bundleSecurity</code> (<a class="xref" href="#sec-pkix-oids">Section 4.4.2.1</a>) to be usable with TCPCL security.<a class="pilcrow" href="#section-4.4.5-2.2">Â¶</a>
</li>
            <li class="normal" id="section-4.4.5-2.3">requiring a validated node ID (<a class="xref" href="#sec-tls-auth-valid-nodeid">Section 4.4.4.3</a>) and  ignoring any network-level identifier (<a class="xref" href="#sec-tls-auth-valid-netid">Section 4.4.4.2</a>).<a class="pilcrow" href="#section-4.4.5-2.3">Â¶</a>
</li>
          </ul>
<p id="section-4.4.5-3">
This policy relies on and informs the certificate requirements provided in <a class="xref" href="#sec-tls-handshake">Section 4.4.3</a>.
This policy assumes that a DTN-aware CA (see <a class="xref" href="#sec-pkix-env">Section 3.4</a>) will only issue a certificate for a node ID when it has verified that the private key holder actually controls the bundle node; this is needed to avoid the threat identified in <a class="xref" href="#sec-threat-node-impersonation">Section 7.9</a>.
This policy requires that a certificate contain a NODE-ID and allows the certificate to also contain network-level identifiers.
A tailored policy on a more controlled network could relax the requirement on node ID validation and allow just network-level identifiers to authenticate a peer.<a class="pilcrow" href="#section-4.4.5-3">Â¶</a></p>
</section>
</div>
<section id="section-4.4.6">
          <h4 id="name-example-tls-initiation">
<a class="section-number selfRef" href="#section-4.4.6">4.4.6. </a><a class="section-name selfRef" href="#name-example-tls-initiation">Example TLS Initiation</a>
          </h4>
<p id="section-4.4.6-1">
A summary of a typical TLS initiation is shown in the sequence in <a class="xref" href="#fig-tls-example">Figure 17</a> below.
In this example, the active peer terminates the session, but termination can be initiated from either peer.<a class="pilcrow" href="#section-4.4.6-1">Â¶</a></p>
<span id="name-a-simple-visual-example-of-"></span><div id="fig-tls-example">
<figure id="figure-17">
            <div class="alignCenter art-ascii-art art-text artwork" id="section-4.4.6-2.1">
<pre>         Entity A                             Entity B
        active peer                         passive peer

+-------------------------+
|  Open TCP Connection    | -&gt;      +-------------------------+
+-------------------------+      &lt;- |    Accept Connection    |
                                    +-------------------------+
+-------------------------+
|     Contact Header      | -&gt;      +-------------------------+
+-------------------------+      &lt;- |     Contact Header      |
                                    +-------------------------+

+-------------------------+         +-------------------------+
|     TLS Negotiation     | -&gt;   &lt;- |     TLS Negotiation     |
|       (as client)       |         |       (as server)       |
+-------------------------+         +-------------------------+

           DNS-ID and IPADDR-ID authentication occurs.
               Secured TCPCL messaging can begin.

+-------------------------+
|        SESS_INIT        | -&gt;      +-------------------------+
+-------------------------+      &lt;- |        SESS_INIT        |
                                    +-------------------------+

                  NODE-ID authentication occurs.
           Session is established, transfers can begin.

+-------------------------+
|       SESS_TERM         | -&gt;      +-------------------------+
+-------------------------+      &lt;- |        SESS_TERM        |
                                    +-------------------------+
+-------------------------+
|    TLS Closure Alert    | -&gt;      +-------------------------+
+-------------------------+      &lt;- |    TLS Closure Alert    |
                                    +-------------------------+
+-------------------------+         +-------------------------+
|        TCP Close        | -&gt;   &lt;- |        TCP Close        |
+-------------------------+         +-------------------------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-17">Figure 17</a>:
<a class="selfRef" href="#name-a-simple-visual-example-of-">A Simple Visual Example of TCPCL TLS Establishment between Two Entities</a>
            </figcaption></figure>
</div>
</section>
</section>
</div>
<div id="sec-msg-header">
<section id="section-4.5">
        <h3 id="name-message-header">
<a class="section-number selfRef" href="#section-4.5">4.5. </a><a class="section-name selfRef" href="#name-message-header">Message Header</a>
        </h3>
<p id="section-4.5-1">
After the initial exchange of a Contact Header and (if TLS is negotiated to be used) the TLS handshake, all messages transmitted over the session are identified by a one-octet header with the following structure:<a class="pilcrow" href="#section-4.5-1">Â¶</a></p>
<span id="name-format-of-the-message-heade"></span><div id="fig-msg-header">
<figure id="figure-18">
          <div class="alignCenter art-ascii-art art-text artwork" id="section-4.5-2.1">
<pre> 0 1 2 3 4 5 6 7
+---------------+
| Message Type  |
+---------------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-18">Figure 18</a>:
<a class="selfRef" href="#name-format-of-the-message-heade">Format of the Message Header</a>
          </figcaption></figure>
</div>
<p id="section-4.5-3">The Message Header contains the following field:<a class="pilcrow" href="#section-4.5-3">Â¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.5-4">
          <dt id="section-4.5-4.1">Message Type:</dt>
          <dd id="section-4.5-4.2" style="margin-left: 1.5em">Indicates the type of the message as per <a class="xref" href="#tab-msg-types">Table 2</a> below.
Encoded values are listed in <a class="xref" href="#sec-iana-message-types">Section 8.5</a>.<a class="pilcrow" href="#section-4.5-4.2">Â¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<span id="name-tcpcl-message-types"></span><div id="tab-msg-types">
<table class="center" id="table-2">
          <caption>
<a class="selfRef" href="#table-2">Table 2</a>:
<a class="selfRef" href="#name-tcpcl-message-types">TCPCL Message Types</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Name</th>
              <th class="text-left" colspan="1" rowspan="1">Code</th>
              <th class="text-left" colspan="1" rowspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">SESS_INIT</td>
              <td class="text-left" colspan="1" rowspan="1">0x07</td>
              <td class="text-left" colspan="1" rowspan="1">
Contains the session parameter inputs from one of the entities, as described in <a class="xref" href="#sec-SESS_INIT">Section 4.6</a>.
          </td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">SESS_TERM</td>
              <td class="text-left" colspan="1" rowspan="1">0x05</td>
              <td class="text-left" colspan="1" rowspan="1">
Indicates that one of the entities participating in the session wishes to cleanly terminate the session, as described in <a class="xref" href="#sec-SESS_TERM">Section 6.1</a>.
          </td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">XFER_SEGMENT</td>
              <td class="text-left" colspan="1" rowspan="1">0x01</td>
              <td class="text-left" colspan="1" rowspan="1">
Indicates the transmission of a segment of bundle data, as described in <a class="xref" href="#sec-XFER_SEGMENT">Section 5.2.2</a>.
          </td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">XFER_ACK</td>
              <td class="text-left" colspan="1" rowspan="1">0x02</td>
              <td class="text-left" colspan="1" rowspan="1">
Acknowledges reception of a data segment, as described in <a class="xref" href="#sec-XFER_ACK">Section 5.2.3</a>.
          </td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">XFER_REFUSE</td>
              <td class="text-left" colspan="1" rowspan="1">0x03</td>
              <td class="text-left" colspan="1" rowspan="1">
Indicates that the transmission of the current bundle <span class="bcp14">SHALL</span> be stopped, as described in <a class="xref" href="#sec-XFER_REFUSE">Section 5.2.4</a>.
          </td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">KEEPALIVE</td>
              <td class="text-left" colspan="1" rowspan="1">0x04</td>
              <td class="text-left" colspan="1" rowspan="1">
Used to keep the TCPCL session active, as described in <a class="xref" href="#sec-KEEPALIVE">Section 5.1.1</a>.
          </td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">MSG_REJECT</td>
              <td class="text-left" colspan="1" rowspan="1">0x06</td>
              <td class="text-left" colspan="1" rowspan="1">
Contains a TCPCL message rejection, as described in <a class="xref" href="#sec-MSG_REJECT">Section 5.1.2</a>.
          </td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="sec-SESS_INIT">
<section id="section-4.6">
        <h3 id="name-session-initialization-mess">
<a class="section-number selfRef" href="#section-4.6">4.6. </a><a class="section-name selfRef" href="#name-session-initialization-mess">Session Initialization Message (SESS_INIT)</a>
        </h3>
<p id="section-4.6-1">
Before a session is established and ready to transfer bundles, the session parameters are negotiated between the connected entities.
The SESS_INIT message is used to convey the per-entity parameters, which are used together to negotiate the per-session parameters as described in <a class="xref" href="#sec-session-negotiate">Section 4.7</a>.<a class="pilcrow" href="#section-4.6-1">Â¶</a></p>
<p id="section-4.6-2">
The format of a SESS_INIT message is shown in <a class="xref" href="#fig-msg-SESS_INIT-fields">Figure 19</a>.<a class="pilcrow" href="#section-4.6-2">Â¶</a></p>
<span id="name-sess_init-format"></span><div id="fig-msg-SESS_INIT-fields">
<figure id="figure-19">
          <div class="alignCenter art-ascii-art art-text artwork" id="section-4.6-3.1">
<pre>+-----------------------------+
|       Message Header        |
+-----------------------------+
|   Keepalive Interval (U16)  |
+-----------------------------+
|       Segment MRU (U64)     |
+-----------------------------+
|      Transfer MRU (U64)     |
+-----------------------------+
|     Node ID Length (U16)    |
+-----------------------------+
|    Node ID Data (variable)  |
+-----------------------------+
|      Session Extension      |
|      Items Length (U32)     |
+-----------------------------+
|      Session Extension      |
|         Items (var.)        |
+-----------------------------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-19">Figure 19</a>:
<a class="selfRef" href="#name-sess_init-format">SESS_INIT Format</a>
          </figcaption></figure>
</div>
<p id="section-4.6-4">
The fields of the SESS_INIT message are as follows:<a class="pilcrow" href="#section-4.6-4">Â¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.6-5">
          <dt id="section-4.6-5.1">Keepalive Interval:</dt>
          <dd id="section-4.6-5.2" style="margin-left: 1.5em">
A 16-bit unsigned integer indicating the minimum interval, in seconds, to negotiate as the Session Keepalive using the method described in <a class="xref" href="#sec-session-negotiate">Section 4.7</a>.<a class="pilcrow" href="#section-4.6-5.2">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.6-5.3">Segment MRU:</dt>
          <dd id="section-4.6-5.4" style="margin-left: 1.5em">
A 64-bit unsigned integer indicating the largest allowable single-segment data payload size to be received in this session.
Any XFER_SEGMENT sent to this peer <span class="bcp14">SHALL</span> have a data payload no longer than the peer's Segment MRU.
The two entities of a single session <span class="bcp14">MAY</span> have different Segment MRUs, and no relationship between the two is required.<a class="pilcrow" href="#section-4.6-5.4">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.6-5.5">Transfer MRU:</dt>
          <dd id="section-4.6-5.6" style="margin-left: 1.5em">
A 64-bit unsigned integer indicating the largest allowable total-bundle data size to be received in this session.
Any bundle transfer sent to this peer <span class="bcp14">SHALL</span> have a Total Bundle Length payload no longer than the peer's Transfer MRU.
This value can be used to perform proactive bundle fragmentation.
The two entities of a single session <span class="bcp14">MAY</span> have different Transfer MRUs, and no relationship between the two is required.<a class="pilcrow" href="#section-4.6-5.6">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.6-5.7">Node ID Length and Node ID Data:</dt>
          <dd id="section-4.6-5.8" style="margin-left: 1.5em">
Together, these fields represent a variable-length text string.
The Node ID Length is a 16-bit unsigned integer indicating the number of octets of Node ID Data to follow.
A zero-length node ID <span class="bcp14">SHALL</span> be used to indicate the lack of a node ID rather than a truly empty node ID.
This case allows an entity to avoid exposing node ID information on an untrusted network.
A non-zero-length Node ID Data <span class="bcp14">SHALL</span> contain the UTF-8 encoded node ID of the entity that sent the SESS_INIT message.
Every node ID <span class="bcp14">SHALL</span> be a URI consistent with the requirements in <span>[<a class="xref" href="#RFC3986">RFC3986</a>]</span> and the URI schemes of the IANA "Bundle Protocol URI Scheme Types" registry <span>[<a class="xref" href="#IANA-BUNDLE">IANA-BUNDLE</a>]</span>.
The node ID itself can be authenticated as described in <a class="xref" href="#sec-tls-authentication">Section 4.4.4</a>.<a class="pilcrow" href="#section-4.6-5.8">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.6-5.9">Session Extension Items Length and Session Extension Items list:Â Â </dt>
          <dd id="section-4.6-5.10" style="margin-left: 1.5em">â Together, these fields represent protocol extension data not defined by this specification.
The Session Extension Items Length is the total number of octets to follow that are used to encode the Session Extension Items list. The encoding of each Session Extension Item is within a consistent data container as described in <a class="xref" href="#sec-session-extension">Section 4.8</a>.
The full set of Session Extension Items apply for the duration of the TCPCL session to follow.
The order and multiplicity of these Session Extension Items are significant, as defined in the associated type specification(s).
If the content of the Session Extension Items list disagrees with the Session Extension Items Length (e.g., the last item claims to use more or fewer octets than are indicated in the Session Extension Items Length), the reception of the SESS_INIT is considered to have failed.<a class="pilcrow" href="#section-4.6-5.10">Â¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.6-6">
If an entity receives a peer node ID that is not authenticated (by the procedure described in <a class="xref" href="#sec-tls-auth-valid-nodeid">Section 4.4.4.3</a>), that node ID <span class="bcp14">SHOULD NOT</span> be used by a BPA for any discovery or routing functions.
Trusting an unauthenticated node ID can lead to the threat described in <a class="xref" href="#sec-threat-node-impersonation">Section 7.9</a>.<a class="pilcrow" href="#section-4.6-6">Â¶</a></p>
<p id="section-4.6-7">
When the active entity initiates a TCPCL session, it is likely based on routing information that binds a node ID to CL parameters used to initiate the session.
If the active entity receives a SESS_INIT with a different node ID than was intended for the TCPCL session, the session <span class="bcp14">MAY</span> be allowed to be established.
If allowed, such a session <span class="bcp14">SHALL</span> be associated with the node ID provided in the SESS_INIT message rather than any intended value.<a class="pilcrow" href="#section-4.6-7">Â¶</a></p>
</section>
</div>
<div id="sec-session-negotiate">
<section id="section-4.7">
        <h3 id="name-session-parameter-negotiati">
<a class="section-number selfRef" href="#section-4.7">4.7. </a><a class="section-name selfRef" href="#name-session-parameter-negotiati">Session Parameter Negotiation</a>
        </h3>
<p id="section-4.7-1">
An entity calculates the parameters for a TCPCL session by negotiating the values from its own preferences (conveyed by the SESS_INIT it sent to the peer) with the preferences of the peer entity (expressed in the SESS_INIT that it received from the peer).
The negotiated parameters defined by this specification are described in the following paragraphs.<a class="pilcrow" href="#section-4.7-1">Â¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.7-2">
          <dt id="section-4.7-2.1">Transfer MTU and Segment MTU:</dt>
          <dd id="section-4.7-2.2" style="margin-left: 1.5em">
The Maximum Transmission Unit (MTU) for whole transfers and individual segments is identical to the Transfer MRU and Segment MRU, respectively, of the received SESS_INIT message. A transmitting peer can send individual segments with any size smaller than the Segment MTU, depending on local policy, dynamic network conditions, etc.
Determining the size of each transmitted segment is an implementation matter.
If either the Transfer MRU or Segment MRU is unacceptable, the entity <span class="bcp14">SHALL</span> terminate the session with a reason code of "Contact Failure".<a class="pilcrow" href="#section-4.7-2.2">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.7-2.3">Session Keepalive:</dt>
          <dd id="section-4.7-2.4" style="margin-left: 1.5em">
            <p id="section-4.7-2.4.1">
Negotiation of the Session Keepalive parameter is performed by taking the minimum of the two Keepalive Interval values from the two SESS_INIT messages.
The Session Keepalive Interval is a parameter for the behavior described in <a class="xref" href="#sec-KEEPALIVE">Section 5.1.1</a>.
If the Session Keepalive Interval is unacceptable, the entity <span class="bcp14">SHALL</span> terminate the session with a reason code of "Contact Failure".<a class="pilcrow" href="#section-4.7-2.4.1">Â¶</a></p>
<aside id="section-4.7-2.4.2">
              <p id="section-4.7-2.4.2.1">
Note: A negotiated Session Keepalive of zero indicates that KEEPALIVEs are disabled.<a class="pilcrow" href="#section-4.7-2.4.2.1">Â¶</a></p>
</aside>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.7-3">
Once this process of parameter negotiation is completed, this protocol defines no additional mechanism to change the parameters of an established session; to effect such a change, the TCPCL session <span class="bcp14">MUST</span> be terminated and a new session established.<a class="pilcrow" href="#section-4.7-3">Â¶</a></p>
</section>
</div>
<div id="sec-session-extension">
<section id="section-4.8">
        <h3 id="name-session-extension-items">
<a class="section-number selfRef" href="#section-4.8">4.8. </a><a class="section-name selfRef" href="#name-session-extension-items">Session Extension Items</a>
        </h3>
<p id="section-4.8-1">
Each of the Session Extension Items <span class="bcp14">SHALL</span> be encoded in an identical Type-Length-Value (TLV) container form as indicated in <a class="xref" href="#fig-session-extension">Figure 20</a>.<a class="pilcrow" href="#section-4.8-1">Â¶</a></p>
<p id="section-4.8-2">
The fields of the Session Extension Item are as follows:<a class="pilcrow" href="#section-4.8-2">Â¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.8-3">
          <dt id="section-4.8-3.1">Item Flags:</dt>
          <dd id="section-4.8-3.2" style="margin-left: 1.5em">
A one-octet field containing generic bit flags related to the Item, which are listed in <a class="xref" href="#tab-session-extension-flags">Table 3</a>.
All reserved header flag bits <span class="bcp14">SHALL</span> be set to 0 by the sender.
All reserved header flag bits <span class="bcp14">SHALL</span> be ignored by the receiver.
If a TCPCL entity receives a Session Extension Item with an unknown Item Type and the <code>CRITICAL</code> flag set to 1, the entity <span class="bcp14">SHALL</span> terminate the TCPCL session with a SESS_TERM reason code of "Contact Failure".
If the <code>CRITICAL</code> flag is 0, an entity <span class="bcp14">SHALL</span> skip over and ignore any item with an unknown Item Type.<a class="pilcrow" href="#section-4.8-3.2">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.8-3.3">Item Type:</dt>
          <dd id="section-4.8-3.4" style="margin-left: 1.5em">
A 16-bit unsigned integer field containing the type of the extension item.
This specification does not define any extension types directly but does create an IANA registry for such codes (see <a class="xref" href="#sec-iana-session-extension-type">Section 8.3</a>).<a class="pilcrow" href="#section-4.8-3.4">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.8-3.5">Item Length:</dt>
          <dd id="section-4.8-3.6" style="margin-left: 1.5em">
A 16-bit unsigned integer field containing the number of Item Value octets to follow.<a class="pilcrow" href="#section-4.8-3.6">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.8-3.7">Item Value:</dt>
          <dd id="section-4.8-3.8" style="margin-left: 1.5em">
A variable-length data field that is interpreted according to the associated Item Type.
This specification places no restrictions on an extension's use of available Item Value data.
Extension specifications <span class="bcp14">SHOULD</span> avoid the use of large data lengths, as no bundle transfers can begin until the full extension data is sent.<a class="pilcrow" href="#section-4.8-3.8">Â¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<span id="name-session-extension-item-form"></span><div id="fig-session-extension">
<figure id="figure-20">
          <div class="alignCenter art-ascii-art art-text artwork" id="section-4.8-4.1">
<pre>                     1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 3 3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|  Item Flags   |           Item Type           | Item Length...|
+---------------+---------------+---------------+---------------+
| length contd. | Item Value...                                 |
+---------------+---------------+---------------+---------------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-20">Figure 20</a>:
<a class="selfRef" href="#name-session-extension-item-form">Session Extension Item Format</a>
          </figcaption></figure>
</div>
<span id="name-session-extension-item-flag"></span><div id="tab-session-extension-flags">
<table class="center" id="table-3">
          <caption>
<a class="selfRef" href="#table-3">Table 3</a>:
<a class="selfRef" href="#name-session-extension-item-flag">Session Extension Item Flags</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Name</th>
              <th class="text-left" colspan="1" rowspan="1">Code</th>
              <th class="text-left" colspan="1" rowspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">
                <code>CRITICAL</code>
</td>
              <td class="text-left" colspan="1" rowspan="1">0x01</td>
              <td class="text-left" colspan="1" rowspan="1">If this bit is set, it indicates that the receiving peer must handle the extension item.</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">Reserved</td>
              <td class="text-left" colspan="1" rowspan="1">others</td>
              <td class="text-left" colspan="1" rowspan="1"></td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
</section>
</div>
<div id="sec-session">
<section id="section-5">
      <h2 id="name-established-session-operati">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-established-session-operati">Established Session Operation</a>
      </h2>
<p id="section-5-1">
This section describes the protocol operation for the duration of an established session, including the mechanism for transmitting bundles over the session.<a class="pilcrow" href="#section-5-1">Â¶</a></p>
<div id="sec-conn-upkeep">
<section id="section-5.1">
        <h3 id="name-upkeep-and-status-messages">
<a class="section-number selfRef" href="#section-5.1">5.1. </a><a class="section-name selfRef" href="#name-upkeep-and-status-messages">Upkeep and Status Messages</a>
        </h3>
<div id="sec-KEEPALIVE">
<section id="section-5.1.1">
          <h4 id="name-session-upkeep-keepalive">
<a class="section-number selfRef" href="#section-5.1.1">5.1.1. </a><a class="section-name selfRef" href="#name-session-upkeep-keepalive">Session Upkeep (KEEPALIVE)</a>
          </h4>
<p id="section-5.1.1-1">
The protocol includes a provision for transmission of KEEPALIVE messages over the TCPCL session to help determine if the underlying TCP connection has been disrupted.<a class="pilcrow" href="#section-5.1.1-1">Â¶</a></p>
<p id="section-5.1.1-2">
As described in <a class="xref" href="#sec-session-negotiate">Section 4.7</a>, a negotiated parameter of each session is the Session Keepalive Interval. If the negotiated Session Keepalive is zero (i.e., one or both SESS_INIT messages contain a zero Keepalive Interval), then the keepalive feature is disabled.
There is no logical minimum value for the Keepalive Interval (within the minimum imposed by the positive-value encoding), but when used for many sessions on an open, shared network, a short interval could lead to excessive traffic.
For shared network use, entities <span class="bcp14">SHOULD</span> choose a Keepalive Interval no shorter than 30 seconds.
There is no logical maximum value for the Keepalive Interval (within the maximum imposed by the fixed-size encoding), but an idle TCP connection is liable for closure by the host operating system if the keepalive time is longer than tens of minutes.
Entities <span class="bcp14">SHOULD</span> choose a Keepalive Interval no longer than 10 minutes (600 seconds).<a class="pilcrow" href="#section-5.1.1-2">Â¶</a></p>
<p id="section-5.1.1-3">
The chosen Keepalive Interval <span class="bcp14">SHOULD NOT</span> be too short, as TCP retransmissions may occur in the case of packet loss.
Those will have to be triggered by a timeout (TCP retransmission timeout (RTO)), which is dependent on the measured RTT for the TCP connection so that KEEPALIVE messages can experience noticeable latency.<a class="pilcrow" href="#section-5.1.1-3">Â¶</a></p>
<p id="section-5.1.1-4">
The format of a KEEPALIVE message is a one-octet Message Type code of KEEPALIVE (as described in <a class="xref" href="#tab-msg-types">Table 2</a>) with no additional data.
Both sides <span class="bcp14">SHALL</span> send a KEEPALIVE message whenever the negotiated interval has elapsed with no transmission of any message (KEEPALIVE or other).<a class="pilcrow" href="#section-5.1.1-4">Â¶</a></p>
<p id="section-5.1.1-5">
If no message (KEEPALIVE or other) has been received in a session after some implementation-defined time duration, then the entity <span class="bcp14">SHALL</span> terminate the session by transmitting a SESS_TERM message (as described in <a class="xref" href="#sec-SESS_TERM">Section 6.1</a>) with a reason code of "Idle timeout".
If configurable, the idle timeout duration <span class="bcp14">SHOULD</span> be no shorter than twice the Keepalive Interval.
If not configurable, the idle timeout duration <span class="bcp14">SHOULD</span> be exactly twice the Keepalive Interval.<a class="pilcrow" href="#section-5.1.1-5">Â¶</a></p>
</section>
</div>
<div id="sec-MSG_REJECT">
<section id="section-5.1.2">
          <h4 id="name-message-rejection-msg_rejec">
<a class="section-number selfRef" href="#section-5.1.2">5.1.2. </a><a class="section-name selfRef" href="#name-message-rejection-msg_rejec">Message Rejection (MSG_REJECT)</a>
          </h4>
<p id="section-5.1.2-1">
This message type is not expected to be seen in a well-functioning session.
Its purpose is to aid in troubleshooting bad entity behavior by allowing the peer to observe why an entity is not responding as expected to its messages.<a class="pilcrow" href="#section-5.1.2-1">Â¶</a></p>
<p id="section-5.1.2-2">
If a TCPCL entity receives a message type that is unknown to it (possibly due to an unhandled protocol version mismatch or an incorrectly negotiated session extension that defines a new message type), the entity <span class="bcp14">SHALL</span> send a MSG_REJECT message with a reason code of "Message Type Unknown" and close the TCP connection.
If a TCPCL entity receives a message type that is known but is inappropriate for the negotiated session parameters (possibly due to an incorrectly negotiated session extension), the entity <span class="bcp14">SHALL</span> send a MSG_REJECT message with a reason code of "Message Unsupported".
If a TCPCL entity receives a message that is inappropriate for the current session state (e.g., a SESS_INIT after the session has already been established or a XFER_ACK message with an unknown Transfer ID), the entity <span class="bcp14">SHALL</span> send a MSG_REJECT message with a reason code of "Message Unexpected".<a class="pilcrow" href="#section-5.1.2-2">Â¶</a></p>
<p id="section-5.1.2-3">
The format of a MSG_REJECT message is shown in <a class="xref" href="#fig-MSG_REJECT-fields">Figure 21</a>.<a class="pilcrow" href="#section-5.1.2-3">Â¶</a></p>
<span id="name-format-of-msg_reject-messag"></span><div id="fig-MSG_REJECT-fields">
<figure id="figure-21">
            <div class="alignCenter art-ascii-art art-text artwork" id="section-5.1.2-4.1">
<pre>+-----------------------------+
|       Message Header        |
+-----------------------------+
|      Reason Code (U8)       |
+-----------------------------+
|   Rejected Message Header   |
+-----------------------------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-21">Figure 21</a>:
<a class="selfRef" href="#name-format-of-msg_reject-messag">Format of MSG_REJECT Messages</a>
            </figcaption></figure>
</div>
<p id="section-5.1.2-5">
The fields of the MSG_REJECT message are as follows:<a class="pilcrow" href="#section-5.1.2-5">Â¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.1.2-6">
            <dt id="section-5.1.2-6.1">Reason Code:</dt>
            <dd id="section-5.1.2-6.2" style="margin-left: 1.5em">
A one-octet refusal reason code interpreted according to the descriptions in <a class="xref" href="#tab-MSG_REJECT-reasons">Table 4</a>.<a class="pilcrow" href="#section-5.1.2-6.2">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.1.2-6.3">Rejected Message Header:</dt>
            <dd id="section-5.1.2-6.4" style="margin-left: 1.5em">
The Rejected Message Header is a copy of the Message Header to which the MSG_REJECT message is sent as a response.<a class="pilcrow" href="#section-5.1.2-6.4">Â¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<span id="name-msg_reject-reason-codes"></span><div id="tab-MSG_REJECT-reasons">
<table class="center" id="table-4">
            <caption>
<a class="selfRef" href="#table-4">Table 4</a>:
<a class="selfRef" href="#name-msg_reject-reason-codes">MSG_REJECT Reason Codes</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" colspan="1" rowspan="1">Name</th>
                <th class="text-left" colspan="1" rowspan="1">Code</th>
                <th class="text-left" colspan="1" rowspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">Message Type Unknown</td>
                <td class="text-left" colspan="1" rowspan="1">0x01</td>
                <td class="text-left" colspan="1" rowspan="1">A message was received with a Message Type code unknown to the TCPCL entity.</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">Message Unsupported</td>
                <td class="text-left" colspan="1" rowspan="1">0x02</td>
                <td class="text-left" colspan="1" rowspan="1">A message was received, but the TCPCL entity cannot comply with the message contents.</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">Message Unexpected</td>
                <td class="text-left" colspan="1" rowspan="1">0x03</td>
                <td class="text-left" colspan="1" rowspan="1">A message was received while the session is in a state in which the message is not expected.</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
</div>
</section>
</div>
<div id="sec-transfer">
<section id="section-5.2">
        <h3 id="name-bundle-transfer">
<a class="section-number selfRef" href="#section-5.2">5.2. </a><a class="section-name selfRef" href="#name-bundle-transfer">Bundle Transfer</a>
        </h3>
<p id="section-5.2-1">
All of the messages discussed in this section are directly associated with transferring a bundle between TCPCL entities.<a class="pilcrow" href="#section-5.2-1">Â¶</a></p>
<p id="section-5.2-2">
A single TCPCL transfer results in the exchange of a bundle (handled by the convergence layer as opaque data) between two entities.
In the TCPCL, a transfer is accomplished by dividing a single bundle up into "segments" based on the receiving-side Segment MRU, which is defined in <a class="xref" href="#sec-SESS_INIT">Section 4.6</a>.
The choice of the length to use for segments is an implementation matter, but each segment <span class="bcp14">MUST NOT</span> be larger than the receiving entity's Segment MRU.
The first segment for a bundle is indicated by the <code>START</code> flag, and the last segment is indicated by the <code>END</code> flag.<a class="pilcrow" href="#section-5.2-2">Â¶</a></p>
<p id="section-5.2-3">
A single transfer (and, by extension, a single segment) <span class="bcp14">SHALL NOT</span> contain data of more than a single bundle.
This requirement is imposed on the agent using the TCPCL, rather than on the TCPCL itself.<a class="pilcrow" href="#section-5.2-3">Â¶</a></p>
<p id="section-5.2-4">
If multiple bundles are transmitted on a single TCPCL connection, they <span class="bcp14">MUST</span> be transmitted consecutively, without the interleaving of segments from multiple bundles.<a class="pilcrow" href="#section-5.2-4">Â¶</a></p>
<div id="sec-transfer-id">
<section id="section-5.2.1">
          <h4 id="name-bundle-transfer-id">
<a class="section-number selfRef" href="#section-5.2.1">5.2.1. </a><a class="section-name selfRef" href="#name-bundle-transfer-id">Bundle Transfer ID</a>
          </h4>
<p id="section-5.2.1-1">
Each of the bundle transfer messages contains a Transfer ID, which is used to correlate messages (from both sides of a transfer) for each bundle.
A Transfer ID does not attempt to address uniqueness of the bundle data itself and is not related to such concepts as bundle fragmentation.
Each invocation of the TCPCL by the BPA, requesting transmission of a bundle (fragmentary or otherwise), results in the initiation of a single TCPCL transfer.
Each transfer entails the sending of a sequence of some number of XFER_SEGMENT and XFER_ACK messages; all are correlated by the same Transfer ID.
The sending entity originates a Transfer ID, and the receiving entity uses that same Transfer ID in acknowledgments.<a class="pilcrow" href="#section-5.2.1-1">Â¶</a></p>
<p id="section-5.2.1-2">
Transfer IDs from each entity <span class="bcp14">SHALL</span> be unique within a single TCPCL session.
Upon exhaustion of the entire 64-bit Transfer ID space, the sending entity <span class="bcp14">SHALL</span> terminate the session with a SESS_TERM reason code of "Resource Exhaustion".
For bidirectional bundle transfers, a TCPCL entity <span class="bcp14">SHOULD NOT</span> rely on any relationship between Transfer IDs originating from each side of the TCPCL session.<a class="pilcrow" href="#section-5.2.1-2">Â¶</a></p>
<p id="section-5.2.1-3">
Although there is not a strict requirement for initial Transfer ID values or the ordering of Transfer IDs (see <a class="xref" href="#sec-security-xferid">Section 7.13</a>), in the absence of any other mechanism for generating Transfer IDs, an entity <span class="bcp14">SHALL</span> use the following algorithm: the initial Transfer ID from each entity is zero, and subsequent Transfer ID values are incremented from the prior Transfer ID value by one.<a class="pilcrow" href="#section-5.2.1-3">Â¶</a></p>
</section>
</div>
<div id="sec-XFER_SEGMENT">
<section id="section-5.2.2">
          <h4 id="name-data-transmission-xfer_segm">
<a class="section-number selfRef" href="#section-5.2.2">5.2.2. </a><a class="section-name selfRef" href="#name-data-transmission-xfer_segm">Data Transmission (XFER_SEGMENT)</a>
          </h4>
<p id="section-5.2.2-1">
Each bundle is transmitted in one or more data segments.
The format of a XFER_SEGMENT message is shown in <a class="xref" href="#fig-XFER_SEGMENT-fields">Figure 22</a>.<a class="pilcrow" href="#section-5.2.2-1">Â¶</a></p>
<span id="name-format-of-xfer_segment-mess"></span><div id="fig-XFER_SEGMENT-fields">
<figure id="figure-22">
            <div class="alignCenter art-ascii-art art-text artwork" id="section-5.2.2-2.1">
<pre>+------------------------------+
|       Message Header         |
+------------------------------+
|     Message Flags (U8)       |
+------------------------------+
|      Transfer ID (U64)       |
+------------------------------+
|     Transfer Extension       |
|      Items Length (U32)      |
|   (only for START segment)   |
+------------------------------+
|     Transfer Extension       |
|         Items (var.)         |
|   (only for START segment)   |
+------------------------------+
|      Data length (U64)       |
+------------------------------+
| Data contents (octet string) |
+------------------------------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-22">Figure 22</a>:
<a class="selfRef" href="#name-format-of-xfer_segment-mess">Format of XFER_SEGMENT Messages</a>
            </figcaption></figure>
</div>
<p id="section-5.2.2-3">
The fields of the XFER_SEGMENT message are as follows:<a class="pilcrow" href="#section-5.2.2-3">Â¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.2.2-4">
            <dt id="section-5.2.2-4.1">Message Flags:</dt>
            <dd id="section-5.2.2-4.2" style="margin-left: 1.5em">
A one-octet field of single-bit flags, interpreted according to the descriptions in <a class="xref" href="#tab-XFER_SEGMENT-flags">Table 5</a>.
All reserved header flag bits <span class="bcp14">SHALL</span> be set to 0 by the sender.
All reserved header flag bits <span class="bcp14">SHALL</span> be ignored by the receiver.<a class="pilcrow" href="#section-5.2.2-4.2">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.2-4.3">Transfer ID:</dt>
            <dd id="section-5.2.2-4.4" style="margin-left: 1.5em">
A 64-bit unsigned integer identifying the transfer being made.<a class="pilcrow" href="#section-5.2.2-4.4">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.2-4.5">Transfer Extension Items Length and Transfer Extension Items list:</dt>
            <dd id="section-5.2.2-4.6" style="margin-left: 1.5em">â Together, these fields represent protocol extension data for this specification.
The Transfer Extension Items Length and Transfer Extension Items list <span class="bcp14">SHALL</span> only be present when the <code>START</code> flag is set to 1 on the message.
The Transfer Extension Items Length is the total number of octets to follow that are used to encode the Transfer Extension Items list.
The encoding of each Transfer Extension Item is within a consistent data container, as described in <a class="xref" href="#sec-transfer-extension">Section 5.2.5</a>.
The full set of Transfer Extension Items apply only to the associated single transfer.
The order and multiplicity of these Transfer Extension Items are significant, as defined in the associated type specification(s).
If the content of the Transfer Extension Items list disagrees with the Transfer Extension Items Length (e.g., the last item claims to use more or fewer octets than are indicated in the Transfer Extension Items Length), the reception of the XFER_SEGMENT is considered to have failed.<a class="pilcrow" href="#section-5.2.2-4.6">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.2-4.7">Data length:</dt>
            <dd id="section-5.2.2-4.8" style="margin-left: 1.5em">
A 64-bit unsigned integer indicating the number of octets in Data contents to follow.<a class="pilcrow" href="#section-5.2.2-4.8">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.2-4.9">Data contents:</dt>
            <dd id="section-5.2.2-4.10" style="margin-left: 1.5em">
The variable-length data payload of the message.<a class="pilcrow" href="#section-5.2.2-4.10">Â¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<span id="name-xfer_segment-flags"></span><div id="tab-XFER_SEGMENT-flags">
<table class="center" id="table-5">
            <caption>
<a class="selfRef" href="#table-5">Table 5</a>:
<a class="selfRef" href="#name-xfer_segment-flags">XFER_SEGMENT Flags</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" colspan="1" rowspan="1">Name</th>
                <th class="text-left" colspan="1" rowspan="1">Code</th>
                <th class="text-left" colspan="1" rowspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">
                  <code>END</code>
</td>
                <td class="text-left" colspan="1" rowspan="1">0x01</td>
                <td class="text-left" colspan="1" rowspan="1">If this bit is set, it indicates that this is the last segment of the transfer.</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">
                  <code>START</code>
</td>
                <td class="text-left" colspan="1" rowspan="1">0x02</td>
                <td class="text-left" colspan="1" rowspan="1">If this bit is set, it indicates that this is the first segment of the transfer.</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">Reserved</td>
                <td class="text-left" colspan="1" rowspan="1">others</td>
                <td class="text-left" colspan="1" rowspan="1"></td>
              </tr>
            </tbody>
          </table>
</div>
<p id="section-5.2.2-6">
The flags portion of the message contains two flag values in the two low-order bits, denoted <code>START</code> and <code>END</code> in <a class="xref" href="#tab-XFER_SEGMENT-flags">Table 5</a>.
The <code>START</code> flag <span class="bcp14">SHALL</span> be set to 1 when transmitting the first segment of a transfer.
The <code>END</code> flag <span class="bcp14">SHALL</span> be set to 1 when transmitting the last segment of a transfer.
In the case where an entire transfer is accomplished in a single segment, both the <code>START</code> flag and the <code>END</code> flag <span class="bcp14">SHALL</span> be set to 1.<a class="pilcrow" href="#section-5.2.2-6">Â¶</a></p>
<p id="section-5.2.2-7">
Once a transfer of a bundle has commenced, the entity <span class="bcp14">MUST</span> only send segments containing sequential portions of that bundle until it sends a segment with the <code>END</code> flag set to 1.
No interleaving of multiple transfers from the same entity is possible within a single TCPCL session.
Simultaneous transfers between two entities <span class="bcp14">MAY</span> be achieved using multiple TCPCL sessions.<a class="pilcrow" href="#section-5.2.2-7">Â¶</a></p>
</section>
</div>
<div id="sec-XFER_ACK">
<section id="section-5.2.3">
          <h4 id="name-data-acknowledgments-xfer_a">
<a class="section-number selfRef" href="#section-5.2.3">5.2.3. </a><a class="section-name selfRef" href="#name-data-acknowledgments-xfer_a">Data Acknowledgments (XFER_ACK)</a>
          </h4>
<p id="section-5.2.3-1">
Although the TCP transport provides reliable transfer of data between transport peers, the typical BSD sockets interface provides no means to inform a sending application of when the receiving application has processed some amount of transmitted data.
Thus, after transmitting some data, the TCPCL needs an additional mechanism to determine whether the receiving agent has successfully received and fully processed the segment.
To this end, the TCPCL protocol provides feedback messaging whereby a receiving entity transmits acknowledgments of reception of data segments.<a class="pilcrow" href="#section-5.2.3-1">Â¶</a></p>
<p id="section-5.2.3-2">
The format of a XFER_ACK message is shown in <a class="xref" href="#fig-XFER_ACK-fields">Figure 23</a>.<a class="pilcrow" href="#section-5.2.3-2">Â¶</a></p>
<span id="name-format-of-xfer_ack-messages"></span><div id="fig-XFER_ACK-fields">
<figure id="figure-23">
            <div class="alignCenter art-ascii-art art-text artwork" id="section-5.2.3-3.1">
<pre>+-----------------------------+
|       Message Header        |
+-----------------------------+
|     Message Flags (U8)      |
+-----------------------------+
|      Transfer ID (U64)      |
+-----------------------------+
| Acknowledged length (U64)   |
+-----------------------------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-23">Figure 23</a>:
<a class="selfRef" href="#name-format-of-xfer_ack-messages">Format of XFER_ACK Messages</a>
            </figcaption></figure>
</div>
<p id="section-5.2.3-4">
The fields of the XFER_ACK message are as follows:<a class="pilcrow" href="#section-5.2.3-4">Â¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.2.3-5">
            <dt id="section-5.2.3-5.1">Message Flags:</dt>
            <dd id="section-5.2.3-5.2" style="margin-left: 1.5em">
A one-octet field of single-bit flags, interpreted according to the descriptions in <a class="xref" href="#tab-XFER_SEGMENT-flags">Table 5</a>.
All reserved header flag bits <span class="bcp14">SHALL</span> be set to 0 by the sender.
All reserved header flag bits <span class="bcp14">SHALL</span> be ignored by the receiver.<a class="pilcrow" href="#section-5.2.3-5.2">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.3-5.3">Transfer ID:</dt>
            <dd id="section-5.2.3-5.4" style="margin-left: 1.5em">
A 64-bit unsigned integer identifying the transfer being acknowledged.<a class="pilcrow" href="#section-5.2.3-5.4">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.3-5.5">Acknowledged length:</dt>
            <dd id="section-5.2.3-5.6" style="margin-left: 1.5em">
A 64-bit unsigned integer indicating the total number of octets in the transfer that are being acknowledged.<a class="pilcrow" href="#section-5.2.3-5.6">Â¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-5.2.3-6">
A receiving TCPCL entity <span class="bcp14">SHALL</span> send a XFER_ACK message in response to each received XFER_SEGMENT message after the segment has been fully processed.
The flags portion of the XFER_ACK header <span class="bcp14">SHALL</span> be set to match the corresponding XFER_SEGMENT message being acknowledged (including flags not decodable to the entity).
The acknowledged length of each XFER_ACK contains the sum of the Data length fields of all XFER_SEGMENT messages received so far in the course of the indicated transfer.
The sending entity <span class="bcp14">SHOULD</span> transmit multiple XFER_SEGMENT messages without waiting for the corresponding XFER_ACK responses.
This enables pipelining of messages on a transfer stream.<a class="pilcrow" href="#section-5.2.3-6">Â¶</a></p>
<p id="section-5.2.3-7">
For example, suppose the sending entity transmits four segments of bundle data with lengths 100, 200, 500, and 1000, respectively.
After receiving the first segment, the entity sends an acknowledgment of length 100.
After the second segment is received, the entity sends an acknowledgment of length 300.
The third and fourth acknowledgments are of lengths 800 and 1800, respectively.<a class="pilcrow" href="#section-5.2.3-7">Â¶</a></p>
<p id="section-5.2.3-8"></p>
</section>
</div>
<div id="sec-XFER_REFUSE">
<section id="section-5.2.4">
          <h4 id="name-transfer-refusal-xfer_refus">
<a class="section-number selfRef" href="#section-5.2.4">5.2.4. </a><a class="section-name selfRef" href="#name-transfer-refusal-xfer_refus">Transfer Refusal (XFER_REFUSE)</a>
          </h4>
<p id="section-5.2.4-1">
The TCPCL supports a mechanism by which a receiving entity can indicate to the sender that it does not want to receive the corresponding bundle.
To do so, upon receiving a XFER_SEGMENT message, the entity <span class="bcp14">MAY</span> transmit a XFER_REFUSE message.
As data segments and acknowledgments can cross on the wire, the bundle that is being refused <span class="bcp14">SHALL</span> be identified by the Transfer ID of the refusal.<a class="pilcrow" href="#section-5.2.4-1">Â¶</a></p>
<p id="section-5.2.4-2">
There is no required relationship between the Transfer MRU of a TCPCL entity (which is supposed to represent a firm limitation of what the entity will accept) and the sending of a XFER_REFUSE message.
A XFER_REFUSE can be used in cases where the agent's bundle storage is temporarily depleted or somehow constrained.
A XFER_REFUSE can also be used after the bundle header or any bundle data is inspected by an agent and determined to be unacceptable.<a class="pilcrow" href="#section-5.2.4-2">Â¶</a></p>
<p id="section-5.2.4-3">
A transfer receiver <span class="bcp14">MAY</span> send a XFER_REFUSE message as soon as it receives any XFER_SEGMENT message.
The transfer sender <span class="bcp14">MUST</span> be prepared for this and <span class="bcp14">MUST</span> associate the refusal with the correct bundle via the Transfer ID fields.<a class="pilcrow" href="#section-5.2.4-3">Â¶</a></p>
<p id="section-5.2.4-4">
The TCPCL itself does not have any required behavior related to responding to a XFER_REFUSE based on its reason code; the refusal is passed up as an indication to the BPA that the transfer has been refused.
If a transfer refusal has a reason code that is not decodable to the BPA, the agent <span class="bcp14">SHOULD</span> treat the refusal as having a reason code of "Unknown".<a class="pilcrow" href="#section-5.2.4-4">Â¶</a></p>
<p id="section-5.2.4-5">
The format of the XFER_REFUSE message is shown in <a class="xref" href="#fig-msg-XFER_REFUSE">Figure 24</a>.<a class="pilcrow" href="#section-5.2.4-5">Â¶</a></p>
<span id="name-format-of-xfer_refuse-messa"></span><div id="fig-msg-XFER_REFUSE">
<figure id="figure-24">
            <div class="alignCenter art-ascii-art art-text artwork" id="section-5.2.4-6.1">
<pre>+-----------------------------+
|       Message Header        |
+-----------------------------+
|      Reason Code (U8)       |
+-----------------------------+
|      Transfer ID (U64)      |
+-----------------------------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-24">Figure 24</a>:
<a class="selfRef" href="#name-format-of-xfer_refuse-messa">Format of XFER_REFUSE Messages</a>
            </figcaption></figure>
</div>
<p id="section-5.2.4-7">
The fields of the XFER_REFUSE message are as follows:<a class="pilcrow" href="#section-5.2.4-7">Â¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.2.4-8">
            <dt id="section-5.2.4-8.1">Reason Code:</dt>
            <dd id="section-5.2.4-8.2" style="margin-left: 1.5em">
A one-octet refusal reason code interpreted according to the descriptions in <a class="xref" href="#tab-XFER_REFUSE-reasons">Table 6</a>.<a class="pilcrow" href="#section-5.2.4-8.2">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.4-8.3">Transfer ID:</dt>
            <dd id="section-5.2.4-8.4" style="margin-left: 1.5em">
A 64-bit unsigned integer identifying the transfer being refused.<a class="pilcrow" href="#section-5.2.4-8.4">Â¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<span id="name-xfer_refuse-reason-codes"></span><div id="tab-XFER_REFUSE-reasons">
<table class="center" id="table-6">
            <caption>
<a class="selfRef" href="#table-6">Table 6</a>:
<a class="selfRef" href="#name-xfer_refuse-reason-codes">XFER_REFUSE Reason Codes</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" colspan="1" rowspan="1">Name</th>
                <th class="text-left" colspan="1" rowspan="1">Code</th>
                <th class="text-left" colspan="1" rowspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">Unknown</td>
                <td class="text-left" colspan="1" rowspan="1">0x00</td>
                <td class="text-left" colspan="1" rowspan="1">The reason for refusal is unknown or is not specified.</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">Completed</td>
                <td class="text-left" colspan="1" rowspan="1">0x01</td>
                <td class="text-left" colspan="1" rowspan="1">The receiver already has the complete bundle. The sender <span class="bcp14">MAY</span> consider the bundle as completely received.</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">No Resources</td>
                <td class="text-left" colspan="1" rowspan="1">0x02</td>
                <td class="text-left" colspan="1" rowspan="1">The receiver's resources are exhausted. The sender <span class="bcp14">SHOULD</span> apply reactive bundle fragmentation before retrying.</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">Retransmit</td>
                <td class="text-left" colspan="1" rowspan="1">0x03</td>
                <td class="text-left" colspan="1" rowspan="1">The receiver has encountered a problem that requires the bundle to be retransmitted in its entirety.</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">Not Acceptable</td>
                <td class="text-left" colspan="1" rowspan="1">0x04</td>
                <td class="text-left" colspan="1" rowspan="1">Some issue with the bundle data or the transfer extension data was encountered. The sender <span class="bcp14">SHOULD NOT</span> retry the same bundle with the same extensions.</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">Extension Failure</td>
                <td class="text-left" colspan="1" rowspan="1">0x05</td>
                <td class="text-left" colspan="1" rowspan="1">A failure processing the Transfer Extension Items has occurred.</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">Session Terminating</td>
                <td class="text-left" colspan="1" rowspan="1">0x06</td>
                <td class="text-left" colspan="1" rowspan="1">The receiving entity is in the process of terminating the session. The sender <span class="bcp14">MAY</span> retry the same bundle at a later time in a different session.</td>
              </tr>
            </tbody>
          </table>
</div>
<p id="section-5.2.4-10">
The receiver <span class="bcp14">MUST</span>, for each transfer preceding the one to be refused, have either acknowledged all XFER_SEGMENT messages or refused the bundle transfer.<a class="pilcrow" href="#section-5.2.4-10">Â¶</a></p>
<p id="section-5.2.4-11">
The bundle transfer refusal <span class="bcp14">MAY</span> be sent before an entire data segment is received.
If a sender receives a XFER_REFUSE message, the sender <span class="bcp14">MUST</span> complete the transmission of any partially sent XFER_SEGMENT message.
There is no way to interrupt an individual TCPCL message partway through sending it.
The sender <span class="bcp14">MUST NOT</span> subsequently commence transmission of any further segments of the refused bundle.
Note, however, that this requirement does not ensure that an entity will not receive another XFER_SEGMENT for the same bundle after transmitting a XFER_REFUSE message, since messages can cross on the wire; if this happens, subsequent segments of the bundle <span class="bcp14">SHALL</span> also be refused with a XFER_REFUSE message.<a class="pilcrow" href="#section-5.2.4-11">Â¶</a></p>
<aside id="section-5.2.4-12">
            <p id="section-5.2.4-12.1">
Note: If a bundle transmission is aborted in this way, the receiver does not receive a segment with the <code>END</code> flag set to 1 for the aborted bundle.
The beginning of the next bundle is identified by the <code>START</code> flag set to 1, indicating the start of a new transfer, and with a distinct Transfer ID value.<a class="pilcrow" href="#section-5.2.4-12.1">Â¶</a></p>
</aside>
</section>
</div>
<div id="sec-transfer-extension">
<section id="section-5.2.5">
          <h4 id="name-transfer-extension-items">
<a class="section-number selfRef" href="#section-5.2.5">5.2.5. </a><a class="section-name selfRef" href="#name-transfer-extension-items">Transfer Extension Items</a>
          </h4>
<p id="section-5.2.5-1">
Each of the Transfer Extension Items <span class="bcp14">SHALL</span> be encoded in an identical Type-Length-Value (TLV) container form as indicated in <a class="xref" href="#fig-transfer-extension">Figure 25</a>.<a class="pilcrow" href="#section-5.2.5-1">Â¶</a></p>
<p id="section-5.2.5-2">
The fields of the Transfer Extension Item are as follows:<a class="pilcrow" href="#section-5.2.5-2">Â¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.2.5-3">
            <dt id="section-5.2.5-3.1">Item Flags:</dt>
            <dd id="section-5.2.5-3.2" style="margin-left: 1.5em">
A one-octet field containing generic bit flags related to the Item, which are listed in <a class="xref" href="#tab-transfer-extension-flags">Table 7</a>.
All reserved header flag bits <span class="bcp14">SHALL</span> be set to 0 by the sender.
All reserved header flag bits <span class="bcp14">SHALL</span> be ignored by the receiver.
If a TCPCL entity receives a Transfer Extension Item with an unknown Item Type and the <code>CRITICAL</code> flag is 1, the entity <span class="bcp14">SHALL</span> refuse the transfer with a XFER_REFUSE reason code of "Extension Failure".
If the <code>CRITICAL</code> flag is 0, an entity <span class="bcp14">SHALL</span> skip over and ignore any item with an unknown Item Type.<a class="pilcrow" href="#section-5.2.5-3.2">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.5-3.3">Item Type:</dt>
            <dd id="section-5.2.5-3.4" style="margin-left: 1.5em">
A 16-bit unsigned integer field containing the type of the extension item.
This specification creates an IANA registry for such codes (see <a class="xref" href="#sec-iana-transfer-extension-type">Section 8.4</a>).<a class="pilcrow" href="#section-5.2.5-3.4">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.5-3.5">Item Length:</dt>
            <dd id="section-5.2.5-3.6" style="margin-left: 1.5em">
A 16-bit unsigned integer field containing the number of Item Value octets to follow.<a class="pilcrow" href="#section-5.2.5-3.6">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.5-3.7">Item Value:</dt>
            <dd id="section-5.2.5-3.8" style="margin-left: 1.5em">
A variable-length data field that is interpreted according to the associated Item Type.
This specification places no restrictions on an extension's use of available Item Value data.
Extension specifications <span class="bcp14">SHOULD</span> avoid the use of large data lengths, as the associated transfer cannot begin until the full extension data is sent.<a class="pilcrow" href="#section-5.2.5-3.8">Â¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<span id="name-transfer-extension-item-for"></span><div id="fig-transfer-extension">
<figure id="figure-25">
            <div class="alignCenter art-ascii-art art-text artwork" id="section-5.2.5-4.1">
<pre>                     1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 3 3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+---------------+---------------+
|  Item Flags   |           Item Type           | Item Length...|
+---------------+---------------+---------------+---------------+
| length contd. | Item Value...                                 |
+---------------+---------------+---------------+---------------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-25">Figure 25</a>:
<a class="selfRef" href="#name-transfer-extension-item-for">Transfer Extension Item Format</a>
            </figcaption></figure>
</div>
<span id="name-transfer-extension-item-fla"></span><div id="tab-transfer-extension-flags">
<table class="center" id="table-7">
            <caption>
<a class="selfRef" href="#table-7">Table 7</a>:
<a class="selfRef" href="#name-transfer-extension-item-fla">Transfer Extension Item Flags</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" colspan="1" rowspan="1">Name</th>
                <th class="text-left" colspan="1" rowspan="1">Code</th>
                <th class="text-left" colspan="1" rowspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">
                  <code>CRITICAL</code>
</td>
                <td class="text-left" colspan="1" rowspan="1">0x01</td>
                <td class="text-left" colspan="1" rowspan="1">If this bit is set, it indicates that the receiving peer must handle the extension item.</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">Reserved</td>
                <td class="text-left" colspan="1" rowspan="1">others</td>
                <td class="text-left" colspan="1" rowspan="1"></td>
              </tr>
            </tbody>
          </table>
</div>
<div id="sec-transfer-extension-transfer-length">
<section id="section-5.2.5.1">
            <h5 id="name-transfer-length-extension">
<a class="section-number selfRef" href="#section-5.2.5.1">5.2.5.1. </a><a class="section-name selfRef" href="#name-transfer-length-extension">Transfer Length Extension</a>
            </h5>
<p id="section-5.2.5.1-1">
The purpose of the Transfer Length Extension is to allow entities to preemptively refuse bundles that would exceed their resources or to prepare storage on the receiving entity for the upcoming bundle data.<a class="pilcrow" href="#section-5.2.5.1-1">Â¶</a></p>
<p id="section-5.2.5.1-2">
Multiple Transfer Length Extension Items <span class="bcp14">SHALL NOT</span> occur within the same transfer.
The lack of a Transfer Length Extension Item in any transfer <span class="bcp14">SHALL NOT</span> imply anything regarding the potential length of the transfer.
The Transfer Length Extension <span class="bcp14">SHALL</span> use the IANA-assigned code point from <a class="xref" href="#sec-iana-transfer-extension-type">Section 8.4</a>.<a class="pilcrow" href="#section-5.2.5.1-2">Â¶</a></p>
<p id="section-5.2.5.1-3">
If a transfer occupies exactly one segment (i.e., both the <code>START</code> flag and the <code>END</code> flag are 1), the Transfer Length Extension <span class="bcp14">SHOULD NOT</span> be present.
The extension does not provide any additional information for single-segment transfers.<a class="pilcrow" href="#section-5.2.5.1-3">Â¶</a></p>
<p id="section-5.2.5.1-4">
The format of the Transfer Length Extension data is shown in <a class="xref" href="#fig-Transfer-Length-fields">Figure 26</a>.<a class="pilcrow" href="#section-5.2.5.1-4">Â¶</a></p>
<span id="name-format-of-transfer-length-e"></span><div id="fig-Transfer-Length-fields">
<figure id="figure-26">
              <div class="alignCenter art-ascii-art art-text artwork" id="section-5.2.5.1-5.1">
<pre>+----------------------+
|  Total Length (U64)  |
+----------------------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-26">Figure 26</a>:
<a class="selfRef" href="#name-format-of-transfer-length-e">Format of Transfer Length Extension Data</a>
              </figcaption></figure>
</div>
<p id="section-5.2.5.1-6">The Transfer Length Extension data contains the following field:<a class="pilcrow" href="#section-5.2.5.1-6">Â¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.2.5.1-7">
              <dt id="section-5.2.5.1-7.1">Total Length:</dt>
              <dd id="section-5.2.5.1-7.2" style="margin-left: 1.5em">
A 64-bit unsigned integer indicating the size of the data to be transferred.
The Total Length field <span class="bcp14">SHALL</span> be treated as authoritative by the receiver.
If, for whatever reason, the actual total length of bundle data received differs from the value indicated by the Total Length value, the receiver <span class="bcp14">SHALL</span> treat the transmitted data as invalid and send a XFER_REFUSE with a reason code of "Not Acceptable".<a class="pilcrow" href="#section-5.2.5.1-7.2">Â¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="sec-termination">
<section id="section-6">
      <h2 id="name-session-termination">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-session-termination">Session Termination</a>
      </h2>
<p id="section-6-1">
This section describes the procedures for terminating a TCPCL session.
The purpose of terminating a session is to allow transfers to complete before the TCP connection is closed but not allow any new transfers to start.
A session state change is necessary for this to happen, because transfers can be in progress in either direction (transfer stream) within a session.
Waiting for a transfer to complete in one direction does not control or influence the possibility of a transfer in the other direction.
Either peer of a session can terminate an established session at any time.<a class="pilcrow" href="#section-6-1">Â¶</a></p>
<div id="sec-SESS_TERM">
<section id="section-6.1">
        <h3 id="name-session-termination-message">
<a class="section-number selfRef" href="#section-6.1">6.1. </a><a class="section-name selfRef" href="#name-session-termination-message">Session Termination Message (SESS_TERM)</a>
        </h3>
<p id="section-6.1-1">
To cleanly terminate a session, a SESS_TERM message <span class="bcp14">SHALL</span> be transmitted by either entity at any point following complete transmission of any other message.
When sent to initiate a termination, the <code>REPLY</code> flag of a SESS_TERM message <span class="bcp14">SHALL</span> be 0.
Upon receiving a SESS_TERM message after not sending a SESS_TERM message in the same session, an entity <span class="bcp14">SHALL</span> send an acknowledging SESS_TERM message.
When sent to acknowledge a termination, a SESS_TERM message <span class="bcp14">SHALL</span> have identical data content from the message being acknowledged except for the <code>REPLY</code> flag, which is set to 1 to indicate acknowledgment.<a class="pilcrow" href="#section-6.1-1">Â¶</a></p>
<p id="section-6.1-2">
Once a SESS_TERM message is sent, the state of that TCPCL session changes to Ending.
While the session is in the Ending state,<a class="pilcrow" href="#section-6.1-2">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-3.1">an entity <span class="bcp14">MAY</span> finish an in-progress transfer in either direction.<a class="pilcrow" href="#section-6.1-3.1">Â¶</a>
</li>
          <li class="normal" id="section-6.1-3.2">an entity <span class="bcp14">SHALL NOT</span> begin any new outgoing transfer for the remainder of the session.<a class="pilcrow" href="#section-6.1-3.2">Â¶</a>
</li>
          <li class="normal" id="section-6.1-3.3">an entity <span class="bcp14">SHALL NOT</span> accept any new incoming transfer for the remainder of the session.<a class="pilcrow" href="#section-6.1-3.3">Â¶</a>
</li>
        </ul>
<p id="section-6.1-4">If a new incoming transfer is attempted while in the Ending state, the receiving entity <span class="bcp14">SHALL</span> send a XFER_REFUSE with a reason code of "Session Terminating".<a class="pilcrow" href="#section-6.1-4">Â¶</a></p>
<p id="section-6.1-5">
There are circumstances where an entity has an urgent need to close a TCP connection associated with a TCPCL session, without waiting for transfers to complete but also in a way that doesn't force timeouts to occur -- for example, due to impending shutdown of the underlying data-link layer.
Instead of following a clean termination sequence, after transmitting a SESS_TERM message, an entity <span class="bcp14">MAY</span> perform an unclean termination by immediately closing the associated TCP connection.
When performing an unclean termination, an entity <span class="bcp14">SHOULD</span> acknowledge all received XFER_SEGMENTs with a XFER_ACK before closing the TCP connection.
Not acknowledging received segments can result in unnecessary bundle or bundle fragment retransmissions.
Any delay between a request to close the TCP connection and the actual closing of the connection (a "half-closed" state) <span class="bcp14">MAY</span> be ignored by the TCPCL entity.
If the underlying TCP connection is closed during a transmission (in either transfer stream), the transfer <span class="bcp14">SHALL</span> be indicated to the BPA as failed (see the transmission failure and reception failure indications defined in <a class="xref" href="#sec-cl-services">Section 3.1</a>).<a class="pilcrow" href="#section-6.1-5">Â¶</a></p>
<p id="section-6.1-6">
The TCPCL itself does not have any required behavior related to responding to a SESS_TERM based on its reason code; the termination is passed up as an indication to the BPA that the session state has changed.
If a termination has a reason code that is not decodable to the BPA, the agent <span class="bcp14">SHOULD</span> treat the termination as having a reason code of "Unknown".<a class="pilcrow" href="#section-6.1-6">Â¶</a></p>
<p id="section-6.1-7">
The format of the SESS_TERM message is shown in <a class="xref" href="#fig-msg-SESS_TERM-fields">Figure 27</a>.<a class="pilcrow" href="#section-6.1-7">Â¶</a></p>
<span id="name-format-of-sess_term-message"></span><div id="fig-msg-SESS_TERM-fields">
<figure id="figure-27">
          <div class="alignCenter art-ascii-art art-text artwork" id="section-6.1-8.1">
<pre>+-----------------------------+
|       Message Header        |
+-----------------------------+
|     Message Flags (U8)      |
+-----------------------------+
|      Reason Code (U8)       |
+-----------------------------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-27">Figure 27</a>:
<a class="selfRef" href="#name-format-of-sess_term-message">Format of SESS_TERM Messages</a>
          </figcaption></figure>
</div>
<p id="section-6.1-9">
The fields of the SESS_TERM message are as follows:<a class="pilcrow" href="#section-6.1-9">Â¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-6.1-10">
          <dt id="section-6.1-10.1">Message Flags:</dt>
          <dd id="section-6.1-10.2" style="margin-left: 1.5em">
A one-octet field of single-bit flags, interpreted according to the descriptions in <a class="xref" href="#tab-SESS_TERM-flags">Table 8</a>.
All reserved header flag bits <span class="bcp14">SHALL</span> be set to 0 by the sender.
All reserved header flag bits <span class="bcp14">SHALL</span> be ignored by the receiver.<a class="pilcrow" href="#section-6.1-10.2">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-10.3">Reason Code:</dt>
          <dd id="section-6.1-10.4" style="margin-left: 1.5em">
A one-octet refusal reason code interpreted according to the descriptions in <a class="xref" href="#tab-SESS_TERM-reasons">Table 9</a>.<a class="pilcrow" href="#section-6.1-10.4">Â¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<span id="name-sess_term-flags"></span><div id="tab-SESS_TERM-flags">
<table class="center" id="table-8">
          <caption>
<a class="selfRef" href="#table-8">Table 8</a>:
<a class="selfRef" href="#name-sess_term-flags">SESS_TERM Flags</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Name</th>
              <th class="text-left" colspan="1" rowspan="1">Code</th>
              <th class="text-left" colspan="1" rowspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">
                <code>REPLY</code>
</td>
              <td class="text-left" colspan="1" rowspan="1">0x01</td>
              <td class="text-left" colspan="1" rowspan="1">If this bit is set, it indicates that this message is an acknowledgment of an earlier SESS_TERM message.</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">Reserved</td>
              <td class="text-left" colspan="1" rowspan="1">others</td>
              <td class="text-left" colspan="1" rowspan="1"></td>
            </tr>
          </tbody>
        </table>
</div>
<span id="name-sess_term-reason-codes"></span><div id="tab-SESS_TERM-reasons">
<table class="center" id="table-9">
          <caption>
<a class="selfRef" href="#table-9">Table 9</a>:
<a class="selfRef" href="#name-sess_term-reason-codes">SESS_TERM Reason Codes</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Name</th>
              <th class="text-left" colspan="1" rowspan="1">Code</th>
              <th class="text-left" colspan="1" rowspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">Unknown</td>
              <td class="text-left" colspan="1" rowspan="1">0x00</td>
              <td class="text-left" colspan="1" rowspan="1">A termination reason is not available.</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">Idle timeout</td>
              <td class="text-left" colspan="1" rowspan="1">0x01</td>
              <td class="text-left" colspan="1" rowspan="1">The session is being terminated due to idleness.</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">Version mismatch</td>
              <td class="text-left" colspan="1" rowspan="1">0x02</td>
              <td class="text-left" colspan="1" rowspan="1">The entity cannot conform to the specified TCPCL protocol version.</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">Busy</td>
              <td class="text-left" colspan="1" rowspan="1">0x03</td>
              <td class="text-left" colspan="1" rowspan="1">The entity is too busy to handle the current session.</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">Contact Failure</td>
              <td class="text-left" colspan="1" rowspan="1">0x04</td>
              <td class="text-left" colspan="1" rowspan="1">The entity cannot interpret or negotiate a Contact Header or SESS_INIT option.</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">Resource Exhaustion</td>
              <td class="text-left" colspan="1" rowspan="1">0x05</td>
              <td class="text-left" colspan="1" rowspan="1">The entity has run into some resource limit and cannot continue the session.</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-6.1-13">
The earliest a TCPCL session termination <span class="bcp14">MAY</span> occur is immediately after transmission of a Contact Header (and prior to any further message transmissions).
This can, for example, be used as a notification that the entity is currently not able or willing to communicate.
However, an entity <span class="bcp14">MUST</span> always send the Contact Header to its peer before sending a SESS_TERM message.<a class="pilcrow" href="#section-6.1-13">Â¶</a></p>
<p id="section-6.1-14">
Termination of the TCP connection <span class="bcp14">MAY</span> occur prior to receiving the Contact Header as discussed in <a class="xref" href="#sec-tcp-connection">Section 4.1</a>.
If reception of the Contact Header itself somehow fails (e.g., an invalid magic string is received), an entity <span class="bcp14">SHALL</span> close the TCP connection without sending a SESS_TERM message.<a class="pilcrow" href="#section-6.1-14">Â¶</a></p>
<p id="section-6.1-15">
If a session is to be terminated before the sending of a protocol message has  completed, then the entity <span class="bcp14">MUST NOT</span> transmit the SESS_TERM message but still <span class="bcp14">SHALL</span> close the TCP connection.
Each TCPCL message is contiguous in the octet stream and has no ability to be cut short and/or preempted by another message.
This is particularly important when large segment sizes are being transmitted; either the entire XFER_SEGMENT is sent before a SESS_TERM message or the connection is simply terminated mid-XFER_SEGMENT.<a class="pilcrow" href="#section-6.1-15">Â¶</a></p>
</section>
</div>
<div id="sec-idle-terminate">
<section id="section-6.2">
        <h3 id="name-idle-session-termination">
<a class="section-number selfRef" href="#section-6.2">6.2. </a><a class="section-name selfRef" href="#name-idle-session-termination">Idle Session Termination</a>
        </h3>
<p id="section-6.2-1">
The protocol includes a provision for clean termination of idle sessions.
Determining the length of time to wait before terminating idle sessions, if they are to be terminated at all, is an implementation and configuration matter.<a class="pilcrow" href="#section-6.2-1">Â¶</a></p>
<p id="section-6.2-2">
If there is a configured time to terminate idle sessions and if no TCPCL messages (other than KEEPALIVE messages) have been received for at least that amount of time, then either entity <span class="bcp14">MAY</span> terminate the session by transmitting a SESS_TERM message with a reason code of "Idle timeout" (as described in <a class="xref" href="#tab-SESS_TERM-reasons">Table 9</a>).<a class="pilcrow" href="#section-6.2-2">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-security">
<section id="section-7">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<p id="section-7-1">
This section separates security considerations into threat categories based on guidance provided in <span><a class="xref" href="#RFC3552">BCP 72</a> [<a class="xref" href="#RFC3552">RFC3552</a>]</span>.<a class="pilcrow" href="#section-7-1">Â¶</a></p>
<section id="section-7.1">
        <h3 id="name-threat-passive-leak-of-node">
<a class="section-number selfRef" href="#section-7.1">7.1. </a><a class="section-name selfRef" href="#name-threat-passive-leak-of-node">Threat: Passive Leak of Node Data</a>
        </h3>
<p id="section-7.1-1">
When used without TLS security, the TCPCL exposes the node ID and other configuration data to passive eavesdroppers.
This occurs even when no transfers occur within a TCPCL session.
This can be avoided by always using TLS, even if authentication is not available (see <a class="xref" href="#sec-security-tlsalt">Section 7.12</a>).<a class="pilcrow" href="#section-7.1-1">Â¶</a></p>
</section>
<section id="section-7.2">
        <h3 id="name-threat-passive-leak-of-bund">
<a class="section-number selfRef" href="#section-7.2">7.2. </a><a class="section-name selfRef" href="#name-threat-passive-leak-of-bund">Threat: Passive Leak of Bundle Data</a>
        </h3>
<p id="section-7.2-1">
The TCPCL can be used to provide point-to-point transport security, but it does not provide security of data at rest and does not guarantee end-to-end bundle security.
The bundle security mechanisms defined in <span>[<a class="xref" href="#RFC9172">RFC9172</a>]</span> are to be used instead.<a class="pilcrow" href="#section-7.2-1">Â¶</a></p>
<p id="section-7.2-2">
When used without TLS security, the TCPCL exposes all bundle data to passive eavesdroppers.
This can be avoided by always using TLS, even if authentication is not available (see <a class="xref" href="#sec-security-tlsalt">Section 7.12</a>).<a class="pilcrow" href="#section-7.2-2">Â¶</a></p>
</section>
<section id="section-7.3">
        <h3 id="name-threat-tcpcl-version-downgr">
<a class="section-number selfRef" href="#section-7.3">7.3. </a><a class="section-name selfRef" href="#name-threat-tcpcl-version-downgr">Threat: TCPCL Version Downgrade</a>
        </h3>
<p id="section-7.3-1">
When a TCPCL entity supports multiple versions of the protocol, it is possible for a malicious or misconfigured peer to use an older version of the TCPCL protocol that does not support transport security.
An on-path attacker can also manipulate a Contact Header to present a lower protocol version than desired.<a class="pilcrow" href="#section-7.3-1">Â¶</a></p>
<p id="section-7.3-2">
It is up to security policies within each TCPCL entity to ensure that the negotiated TCPCL version meets transport security requirements.<a class="pilcrow" href="#section-7.3-2">Â¶</a></p>
</section>
<div id="sec-threat-tls-strip">
<section id="section-7.4">
        <h3 id="name-threat-transport-security-s">
<a class="section-number selfRef" href="#section-7.4">7.4. </a><a class="section-name selfRef" href="#name-threat-transport-security-s">Threat: Transport Security Stripping</a>
        </h3>
<p id="section-7.4-1">
When security policy allows non-TLS sessions, the TCPCL does not protect against active network attackers.
It is possible for an on-path attacker to set the <code>CAN_TLS</code> flag to 0 on either side of the Contact Header exchange, which will cause the negotiation discussed in <a class="xref" href="#sec-contact-negotiate">Section 4.3</a> to disable TLS.
This leads to the "SSL Stripping" attack described in <span>[<a class="xref" href="#RFC7457">RFC7457</a>]</span>.<a class="pilcrow" href="#section-7.4-1">Â¶</a></p>
<p id="section-7.4-2">
The purpose of the <code>CAN_TLS</code> flag is to allow the use of the TCPCL on entities that simply do not have a TLS implementation available.
When TLS is available on an entity, it is strongly encouraged that the security policy disallow non-TLS sessions.
This requires that the TLS handshake occur, regardless of the policy-driven parameters of the handshake and policy-driven handling of the handshake outcome.<a class="pilcrow" href="#section-7.4-2">Â¶</a></p>
<p id="section-7.4-3">
One mechanism to mitigate the possibility of TLS Stripping is the use of DNS-based Authentication of Named Entities (DANE) <span>[<a class="xref" href="#RFC6698">RFC6698</a>]</span> toward the passive peer.
This mechanism relies on DNS and is unidirectional, so it doesn't help with applying policy toward the active peer, but it can be useful in an environment using opportunistic security.
The configuration and use of DANE are outside of the scope of this document.<a class="pilcrow" href="#section-7.4-3">Â¶</a></p>
<p id="section-7.4-4">
The negotiated use of TLS is identical in behavior to the use of STARTTLS as described in <span>[<a class="xref" href="#RFC2595">RFC2595</a>]</span>, <span>[<a class="xref" href="#RFC4511">RFC4511</a>]</span>, and others.<a class="pilcrow" href="#section-7.4-4">Â¶</a></p>
</section>
</div>
<section id="section-7.5">
        <h3 id="name-threat-weak-tls-configurati">
<a class="section-number selfRef" href="#section-7.5">7.5. </a><a class="section-name selfRef" href="#name-threat-weak-tls-configurati">Threat: Weak TLS Configurations</a>
        </h3>
<p id="section-7.5-1">
Even when using TLS to secure the TCPCL session, the actual cipher suite negotiated between the TLS peers can be insecure.
Recommendations for using cipher suites are included in <span><a class="xref" href="#RFC7525">BCP 195</a> [<a class="xref" href="#RFC7525">RFC7525</a>]</span>.
It is up to security policies within each TCPCL entity to ensure that the negotiated TLS cipher suite meets transport security requirements.<a class="pilcrow" href="#section-7.5-1">Â¶</a></p>
</section>
<div id="sec-threat-untrust-cert">
<section id="section-7.6">
        <h3 id="name-threat-untrusted-end-entity">
<a class="section-number selfRef" href="#section-7.6">7.6. </a><a class="section-name selfRef" href="#name-threat-untrusted-end-entity">Threat: Untrusted End-Entity Certificate</a>
        </h3>
<p id="section-7.6-1">
The authentication method discussed in <a class="xref" href="#sec-tls-authentication">Section 4.4.4</a> uses end-entity certificates chained to a trusted root CA. During a TLS handshake, either entity can send a certificate set that does not contain the full chain, possibly excluding intermediate or root CAs.
In an environment where peers are known to already contain needed root and intermediate CAs, there is no need to include those CAs, but this carries the risk of an entity not actually having one of the needed CAs.<a class="pilcrow" href="#section-7.6-1">Â¶</a></p>
</section>
</div>
<section id="section-7.7">
        <h3 id="name-threat-certificate-validati">
<a class="section-number selfRef" href="#section-7.7">7.7. </a><a class="section-name selfRef" href="#name-threat-certificate-validati">Threat: Certificate Validation Vulnerabilities</a>
        </h3>
<p id="section-7.7-1">
Even when TLS itself is operating properly, an attacker can attempt to exploit vulnerabilities within certificate check algorithms or configuration to establish a secure TCPCL session using an invalid certificate.
A BPA treats the peer node ID within a TCPCL session as authoritative, and exploitation via an invalid certificate could lead to bundle data leaking and/or denial of service to the node ID being impersonated.<a class="pilcrow" href="#section-7.7-1">Â¶</a></p>
<p id="section-7.7-2">
There are many reasons, as described in <span>[<a class="xref" href="#RFC5280">RFC5280</a>]</span> and <span>[<a class="xref" href="#RFC6125">RFC6125</a>]</span>, why a certificate can fail to validate, including using the certificate outside of its valid time interval, using purposes for which it was not authorized, or using it after it has been revoked by its CA.
Validating a certificate is a complex task and can require network connectivity outside of the primary TCPCL network path(s) if a mechanism such as OCSP <span>[<a class="xref" href="#RFC6960">RFC6960</a>]</span> is used by the CA.
The configuration and use of particular certificate validation methods are outside of the scope of this document.<a class="pilcrow" href="#section-7.7-2">Â¶</a></p>
</section>
<section id="section-7.8">
        <h3 id="name-threat-symmetric-key-limits">
<a class="section-number selfRef" href="#section-7.8">7.8. </a><a class="section-name selfRef" href="#name-threat-symmetric-key-limits">Threat: Symmetric Key Limits</a>
        </h3>
<p id="section-7.8-1">Even with a secure block cipher and securely established session keys, there are limits to the amount of plaintext that can be safely encrypted with a given set of keys, as described in <span>[<a class="xref" href="#AEAD-LIMITS">AEAD-LIMITS</a>]</span>.
When permitted by the negotiated TLS version (see <span>[<a class="xref" href="#RFC8446">RFC8446</a>]</span>), it is advisable to take advantage of session key updates to avoid those limits.<a class="pilcrow" href="#section-7.8-1">Â¶</a></p>
</section>
<div id="sec-threat-node-impersonation">
<section id="section-7.9">
        <h3 id="name-threat-bp-node-impersonatio">
<a class="section-number selfRef" href="#section-7.9">7.9. </a><a class="section-name selfRef" href="#name-threat-bp-node-impersonatio">Threat: BP Node Impersonation</a>
        </h3>
<p id="section-7.9-1">
The certificates exchanged by TLS enable authentication of the peer DNS name and node ID, but it is possible that either a peer does not provide a valid certificate or the certificate does not validate either the DNS-ID/IPADDR-ID or NODE-ID of the peer (see <a class="xref" href="#sec-pkix-env">Section 3.4</a>).
Having a CA-validated certificate does not alone guarantee the identity of the network host or BP node from which the certificate is provided; additional validation procedures as provided in <a class="xref" href="#sec-tls-authentication">Section 4.4.4</a> bind the DNS-ID/IPADDR-ID or NODE-ID based on the contents of the certificate.<a class="pilcrow" href="#section-7.9-1">Â¶</a></p>
<p id="section-7.9-2">
The DNS-ID/IPADDR-ID validation is a weaker form of authentication, because even if a peer is operating on an authenticated network DNS name or IP address it can provide an invalid node ID and cause bundles to be "leaked" to an invalid node.
Especially in DTN environments, network names and addresses of nodes can be time-variable, so binding a certificate to a node ID results in a more stable identity.<a class="pilcrow" href="#section-7.9-2">Â¶</a></p>
<p id="section-7.9-3">
NODE-ID validation ensures that the peer to which a bundle is transferred is in fact the node that the BPA expects it to be.
In circumstances where certificates can only be issued to DNS names, node ID validation is not possible, but it could be reasonable to assume that a trusted host is not going to present an invalid node ID.
Determining when a DNS-ID/IPADDR-ID authentication can be trusted to validate a node ID is also a policy matter outside of the scope of this document.<a class="pilcrow" href="#section-7.9-3">Â¶</a></p>
<p id="section-7.9-4">
One mitigation regarding arbitrary entities with valid PKIX certificates impersonating arbitrary node IDs is the use of the PKIX EKU key purpose <code>id-kp-bundleSecurity</code> (<a class="xref" href="#sec-pkix-oids">Section 4.4.2.1</a>).
When this EKU is present in the certificate, it represents a stronger assertion that the private key holder should in fact be trusted to operate as a bundle node.<a class="pilcrow" href="#section-7.9-4">Â¶</a></p>
</section>
</div>
<section id="section-7.10">
        <h3 id="name-threat-denial-of-service">
<a class="section-number selfRef" href="#section-7.10">7.10. </a><a class="section-name selfRef" href="#name-threat-denial-of-service">Threat: Denial of Service</a>
        </h3>
<p id="section-7.10-1">
The behaviors described in this section all amount to a potential denial of service to a TCPCL entity.
The denial of service could be limited to an individual TCPCL session, could affect other well-behaved sessions on an entity, or could affect all sessions on a host.<a class="pilcrow" href="#section-7.10-1">Â¶</a></p>
<p id="section-7.10-2">
A malicious entity can trigger timeouts by continually establishing TCPCL sessions and delaying the sending of protocol-required data.
The victim entity can block TCP connections from network peers that are thought to  behave incorrectly within the TCPCL.<a class="pilcrow" href="#section-7.10-2">Â¶</a></p>
<p id="section-7.10-3">
An entity can send a large amount of data over a TCPCL session, requiring the receiving entity to handle the data.
The victim entity can attempt to stop the flood of data by sending a XFER_REFUSE message or can forcibly terminate the session.<a class="pilcrow" href="#section-7.10-3">Â¶</a></p>
<p id="section-7.10-4">
A "data dribble" attack is also possible, in which an entity presents a very small Segment MRU that causes transfers to be split among a large number of very small segments and causes the resultant segmentation overhead to overwhelm the actual bundle data segments.
Similarly, an entity can present a very small Transfer MRU that will cause resources to be wasted on establishment and upkeep of a TCPCL session over which a bundle could never be transferred.
The victim entity can terminate the session during parameter negotiation (<a class="xref" href="#sec-session-negotiate">Section 4.7</a>) if the MRUs are unacceptable.<a class="pilcrow" href="#section-7.10-4">Â¶</a></p>
<p id="section-7.10-5">
An abusive entity could cause the keepalive mechanism to waste throughput within a network link that would otherwise be usable for bundle transmissions.
Due to the quantization of the Keepalive Interval parameter, the smallest Session Keepalive is one second, which should be long enough to not flood the link.
The victim entity can terminate the session during parameter negotiation (<a class="xref" href="#sec-session-negotiate">Section 4.7</a>) if the Keepalive Interval is unacceptable.<a class="pilcrow" href="#section-7.10-5">Â¶</a></p>
<p id="section-7.10-6">
Finally, an attacker or a misconfigured entity can cause issues at the TCP connection that will cause unnecessary TCP retransmissions or connection resets, effectively denying the use of the overlying TCPCL session.<a class="pilcrow" href="#section-7.10-6">Â¶</a></p>
</section>
<div id="sec-security-tls-mandate">
<section id="section-7.11">
        <h3 id="name-mandatory-to-implement-tls">
<a class="section-number selfRef" href="#section-7.11">7.11. </a><a class="section-name selfRef" href="#name-mandatory-to-implement-tls">Mandatory-to-Implement TLS</a>
        </h3>
<p id="section-7.11-1">
Following IETF best current practice, TLS is mandatory to implement for all TCPCL implementations but TLS is optional to use for a given TCPCL session.
The policy recommendations in SectionsÂ <a class="xref" href="#sec-contact-header">4.2</a> and <a class="xref" href="#sec-contact-negotiate">4.3</a> both enable TLS and require TLS, but entities are permitted to disable and not require TLS based on local configuration. The configuration to enable or require TLS for an entity or a session is outside of the scope of this document.
The configuration to disable TLS is different from the threat of TLS Stripping as  described in <a class="xref" href="#sec-threat-tls-strip">Section 7.4</a>.<a class="pilcrow" href="#section-7.11-1">Â¶</a></p>
</section>
</div>
<div id="sec-security-tlsalt">
<section id="section-7.12">
        <h3 id="name-alternate-uses-of-tls">
<a class="section-number selfRef" href="#section-7.12">7.12. </a><a class="section-name selfRef" href="#name-alternate-uses-of-tls">Alternate Uses of TLS</a>
        </h3>
<p id="section-7.12-1">
This specification makes use of PKIX certificate validation and authentication within TLS.
There are alternate uses of TLS that are not necessarily incompatible with the security goals of this specification but that are outside of the scope of this document.
The following subsections give examples of alternate TLS uses.<a class="pilcrow" href="#section-7.12-1">Â¶</a></p>
<div id="sec-security-tlsnoauth">
<section id="section-7.12.1">
          <h4 id="name-tls-without-authentication">
<a class="section-number selfRef" href="#section-7.12.1">7.12.1. </a><a class="section-name selfRef" href="#name-tls-without-authentication">TLS without Authentication</a>
          </h4>
<p id="section-7.12.1-1"> In environments where PKI is available but there are restrictions on the issuance of certificates (including the contents of certificates), it may be possible to make use of TLS in a way that authenticates only the passive entity of a TCPCL session or that does not authenticate either entity.
Using TLS in a way that does not successfully authenticate some claim of both peer entities of a TCPCL session is outside of the scope of this document but does have  properties similar to the opportunistic security model <span>[<a class="xref" href="#RFC7435">RFC7435</a>]</span>.<a class="pilcrow" href="#section-7.12.1-1">Â¶</a></p>
</section>
</div>
<div id="sec-security-tlsnopki">
<section id="section-7.12.2">
          <h4 id="name-non-certificate-tls-use">
<a class="section-number selfRef" href="#section-7.12.2">7.12.2. </a><a class="section-name selfRef" href="#name-non-certificate-tls-use">Non-certificate TLS Use</a>
          </h4>
<p id="section-7.12.2-1">
In environments where PKI is unavailable, alternate uses of TLS that do not require certificates such as pre-shared key (PSK) authentication <span>[<a class="xref" href="#RFC5489">RFC5489</a>]</span> and the use of raw public keys <span>[<a class="xref" href="#RFC7250">RFC7250</a>]</span> are available and can be used to ensure confidentiality within the TCPCL.
Using non-PKI node authentication methods is outside of the scope of this document.<a class="pilcrow" href="#section-7.12.2-1">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-security-xferid">
<section id="section-7.13">
        <h3 id="name-predictability-of-transfer-">
<a class="section-number selfRef" href="#section-7.13">7.13. </a><a class="section-name selfRef" href="#name-predictability-of-transfer-">Predictability of Transfer IDs</a>
        </h3>
<p id="section-7.13-1">
The only requirement on Transfer IDs is that they be unique within each session from the sending peer only.
The trivial algorithm of the first transfer starting at zero and later transfers incrementing by one causes absolutely predictable Transfer IDs.
Even when a TCPCL session is not TLS secured and there is an on-path attacker causing denial of service with XFER_REFUSE messages, it is not possible to preemptively refuse a transfer, so there is no benefit in having unpredictable Transfer IDs within a session.<a class="pilcrow" href="#section-7.13-1">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-iana">
<section id="section-8">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-8">8. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<p id="section-8-1">
Registration procedures referred to in this section (e.g., the RFC Required policy) are defined in <span>[<a class="xref" href="#RFC8126">RFC8126</a>]</span>.<a class="pilcrow" href="#section-8-1">Â¶</a></p>
<p id="section-8-2">
Some of the registries have been defined as version specific for TCPCLv4, and these registries reuse some or all codepoints from TCPCLv3. This was done to disambiguate the use of these codepoints between TCPCLv3 and TCPCLv4 while preserving the semantics of some of the codepoints.<a class="pilcrow" href="#section-8-2">Â¶</a></p>
<div id="sec-iana-port">
<section id="section-8.1">
        <h3 id="name-port-number">
<a class="section-number selfRef" href="#section-8.1">8.1. </a><a class="section-name selfRef" href="#name-port-number">Port Number</a>
        </h3>
<p id="section-8.1-1">
Within the "Service Name and Transport Protocol Port Number Registry" <span>[<a class="xref" href="#IANA-PORTS">IANA-PORTS</a>]</span>, TCP port number 4556 had previously been assigned as the default port for the TCPCL; see <span>[<a class="xref" href="#RFC7242">RFC7242</a>]</span>.
This assignment is unchanged by TCPCL version 4, but the assignment reference has been updated to point to this specification.
Each TCPCL entity identifies its TCPCL protocol version in its initial contact (see SectionsÂ <a class="xref" href="#sec-protocol-session">3.2</a> and <a class="xref" href="#sec-iana-protonum">8.2</a>), so there is no ambiguity regarding what protocol is being used.
The related assignments for UDP and DCCP port 4556 (both registered by <span>[<a class="xref" href="#RFC7122">RFC7122</a>]</span>) are unchanged.<a class="pilcrow" href="#section-8.1-1">Â¶</a></p>
<span id="name-tcp-port-number-for-the-tcp"></span><table class="center" id="table-10">
          <caption>
<a class="selfRef" href="#table-10">Table 10</a>:
<a class="selfRef" href="#name-tcp-port-number-for-the-tcp">TCP Port Number for the TCPCL</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Parameter</th>
              <th class="text-left" colspan="1" rowspan="1">Value</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">Service Name:</td>
              <td class="text-left" colspan="1" rowspan="1">dtn-bundle</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">Transport Protocol(s):</td>
              <td class="text-left" colspan="1" rowspan="1">TCP</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">Assignee:</td>
              <td class="text-left" colspan="1" rowspan="1">IESG (iesg@ietf.org)</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">Contact:</td>
              <td class="text-left" colspan="1" rowspan="1">IESG (iesg@ietf.org)</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">Description:</td>
              <td class="text-left" colspan="1" rowspan="1">DTN Bundle TCP CL Protocol</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">Reference:</td>
              <td class="text-left" colspan="1" rowspan="1">This specification</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">Port Number:</td>
              <td class="text-left" colspan="1" rowspan="1">4556</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="sec-iana-protonum">
<section id="section-8.2">
        <h3 id="name-protocol-versions">
<a class="section-number selfRef" href="#section-8.2">8.2. </a><a class="section-name selfRef" href="#name-protocol-versions">Protocol Versions</a>
        </h3>
<p id="section-8.2-1">
IANA has registered the following value in the "Bundle Protocol TCP Convergence-Layer Version Numbers" registry <span>[<a class="xref" href="#RFC7242">RFC7242</a>]</span>.<a class="pilcrow" href="#section-8.2-1">Â¶</a></p>
<span id="name-new-tcpcl-version-number"></span><table class="center" id="table-11">
          <caption>
<a class="selfRef" href="#table-11">Table 11</a>:
<a class="selfRef" href="#name-new-tcpcl-version-number">New TCPCL Version Number</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Value</th>
              <th class="text-left" colspan="1" rowspan="1">Description</th>
              <th class="text-left" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">4</td>
              <td class="text-left" colspan="1" rowspan="1">TCPCLv4</td>
              <td class="text-left" colspan="1" rowspan="1">This specification</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="sec-iana-session-extension-type">
<section id="section-8.3">
        <h3 id="name-session-extension-types">
<a class="section-number selfRef" href="#section-8.3">8.3. </a><a class="section-name selfRef" href="#name-session-extension-types">Session Extension Types</a>
        </h3>
<p id="section-8.3-1">
Under the "Bundle Protocol" registry <span>[<a class="xref" href="#IANA-BUNDLE">IANA-BUNDLE</a>]</span>, IANA has created the "Bundle Protocol TCP Convergence-Layer Version 4 Session Extension Types" registry and populated it with the contents of <a class="xref" href="#tab-iana-session-extension-type">Table 12</a>.
The registration procedure is Expert Review within the lower range 0x0001-0x7FFF.
Values in the range 0x8000-0xFFFF are reserved for Private or Experimental Use, which are not recorded by IANA.<a class="pilcrow" href="#section-8.3-1">Â¶</a></p>
<p id="section-8.3-2">
Specifications of new session extension types need to define the encoding of the Item Value data as well as any meaning or restriction on the number of or order of instances of the type within an extension item list.
Specifications need to define how the extension functions when no instance of the new extension type is received during session negotiation.<a class="pilcrow" href="#section-8.3-2">Â¶</a></p>
<p id="section-8.3-3">
Experts are encouraged to be biased towards approving registrations unless they are abusive, frivolous, or actively harmful (not merely esthetically displeasing or architecturally dubious).<a class="pilcrow" href="#section-8.3-3">Â¶</a></p>
<span id="name-session-extension-type-code"></span><div id="tab-iana-session-extension-type">
<table class="center" id="table-12">
          <caption>
<a class="selfRef" href="#table-12">Table 12</a>:
<a class="selfRef" href="#name-session-extension-type-code">Session Extension Type Codes</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Code</th>
              <th class="text-left" colspan="1" rowspan="1">Session Extension Type</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0x0000</td>
              <td class="text-left" colspan="1" rowspan="1">Reserved</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0x0001-0x7FFF</td>
              <td class="text-left" colspan="1" rowspan="1">Unassigned</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0x8000-0xFFFF</td>
              <td class="text-left" colspan="1" rowspan="1">Reserved for Private or Experimental Use</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="sec-iana-transfer-extension-type">
<section id="section-8.4">
        <h3 id="name-transfer-extension-types">
<a class="section-number selfRef" href="#section-8.4">8.4. </a><a class="section-name selfRef" href="#name-transfer-extension-types">Transfer Extension Types</a>
        </h3>
<p id="section-8.4-1">
Under the "Bundle Protocol" registry <span>[<a class="xref" href="#IANA-BUNDLE">IANA-BUNDLE</a>]</span>, IANA has created the "Bundle Protocol TCP Convergence-Layer Version 4 Transfer Extension Types" registry and populated it with the contents of <a class="xref" href="#tab-iana-transfer-extension-type">Table 13</a>. The registration procedure is Expert Review within the lower range 0x0001-0x7FFF.
Values in the range 0x8000-0xFFFF are reserved for Private or Experimental Use, which are not recorded by 
IANA.<a class="pilcrow" href="#section-8.4-1">Â¶</a></p>
<p id="section-8.4-2">
Specifications of new transfer extension types need to define the encoding of the Item Value data as well as any meaning or restriction on the number of or order of instances of the type within an extension item list.
Specifications need to define how the extension functions when no instance of the new extension type is received in a transfer.<a class="pilcrow" href="#section-8.4-2">Â¶</a></p>
<p id="section-8.4-3">
Experts are encouraged to be biased towards approving registrations unless they are abusive, frivolous, or actively harmful (not merely esthetically displeasing or architecturally dubious).<a class="pilcrow" href="#section-8.4-3">Â¶</a></p>
<span id="name-transfer-extension-type-cod"></span><div id="tab-iana-transfer-extension-type">
<table class="center" id="table-13">
          <caption>
<a class="selfRef" href="#table-13">Table 13</a>:
<a class="selfRef" href="#name-transfer-extension-type-cod">Transfer Extension Type Codes</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Code</th>
              <th class="text-left" colspan="1" rowspan="1">Transfer Extension Type</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0x0000</td>
              <td class="text-left" colspan="1" rowspan="1">Reserved</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0x0001</td>
              <td class="text-left" colspan="1" rowspan="1">Transfer Length Extension</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0x0002-0x7FFF</td>
              <td class="text-left" colspan="1" rowspan="1">Unassigned</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0x8000-0xFFFF</td>
              <td class="text-left" colspan="1" rowspan="1">Reserved for Private or Experimental Use</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="sec-iana-message-types">
<section id="section-8.5">
        <h3 id="name-message-types">
<a class="section-number selfRef" href="#section-8.5">8.5. </a><a class="section-name selfRef" href="#name-message-types">Message Types</a>
        </h3>
<p id="section-8.5-1">
Under the "Bundle Protocol" registry <span>[<a class="xref" href="#IANA-BUNDLE">IANA-BUNDLE</a>]</span>, IANA has created the "Bundle Protocol TCP Convergence-Layer Version 4 Message Types" registry and populated it with the contents of <a class="xref" href="#tab-iana-message-types">Table 14</a>.
The registration procedure is RFC Required within the lower range 0x01-0xEF.
Values in the range 0xF0-0xFF are reserved for Private or Experimental Use, which are not recorded by     
IANA.<a class="pilcrow" href="#section-8.5-1">Â¶</a></p>
<p id="section-8.5-2">
Specifications of new message types need to define the encoding of the message data as well as the purpose and relationship of the new message to existing session/transfer state within the baseline message sequencing.
The use of new message types needs to be negotiated between TCPCL entities within a session (using the session extension mechanism) so that the receiving entity can properly decode all message types used in the session.<a class="pilcrow" href="#section-8.5-2">Â¶</a></p>
<p id="section-8.5-3">
Experts are encouraged to favor new session/transfer extension types over new message types.
TCPCL messages are not self-delimiting, so care must be taken in introducing new message types.
If an entity receives an unknown message type, the only thing that can be done is to send a MSG_REJECT and close the TCP connection; not even a clean termination can be done at that point.<a class="pilcrow" href="#section-8.5-3">Â¶</a></p>
<span id="name-message-type-codes"></span><div id="tab-iana-message-types">
<table class="center" id="table-14">
          <caption>
<a class="selfRef" href="#table-14">Table 14</a>:
<a class="selfRef" href="#name-message-type-codes">Message Type Codes</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Code</th>
              <th class="text-left" colspan="1" rowspan="1">Message Type</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0x00</td>
              <td class="text-left" colspan="1" rowspan="1">Reserved</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0x01</td>
              <td class="text-left" colspan="1" rowspan="1">XFER_SEGMENT</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0x02</td>
              <td class="text-left" colspan="1" rowspan="1">XFER_ACK</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0x03</td>
              <td class="text-left" colspan="1" rowspan="1">XFER_REFUSE</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0x04</td>
              <td class="text-left" colspan="1" rowspan="1">KEEPALIVE</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0x05</td>
              <td class="text-left" colspan="1" rowspan="1">SESS_TERM</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0x06</td>
              <td class="text-left" colspan="1" rowspan="1">MSG_REJECT</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0x07</td>
              <td class="text-left" colspan="1" rowspan="1">SESS_INIT</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0x08-0xEF</td>
              <td class="text-left" colspan="1" rowspan="1">Unassigned</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0xF0-0xFF</td>
              <td class="text-left" colspan="1" rowspan="1">Reserved for Private or Experimental Use</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="sec-iana-XFER_REFUSE-codes">
<section id="section-8.6">
        <h3 id="name-xfer_refuse-reason-codes-2">
<a class="section-number selfRef" href="#section-8.6">8.6. </a><a class="section-name selfRef" href="#name-xfer_refuse-reason-codes-2">XFER_REFUSE Reason Codes</a>
        </h3>
<p id="section-8.6-1">
Under the "Bundle Protocol" registry <span>[<a class="xref" href="#IANA-BUNDLE">IANA-BUNDLE</a>]</span>, IANA has created the "Bundle Protocol TCP Convergence-Layer Version 4 XFER_REFUSE Reason Codes" registry and populated it with the contents of <a class="xref" href="#tab-iana-XFER_REFUSE-codes">Table 15</a>.
The registration procedure is Specification Required within the lower range 0x00-0xEF.
Values in the range 0xF0-0xFF are reserved for Private or Experimental Use, which are not recorded by
IANA.<a class="pilcrow" href="#section-8.6-1">Â¶</a></p>
<p id="section-8.6-2">
Specifications of new XFER_REFUSE reason codes need to define the meaning of the reason and disambiguate it from preexisting reasons. Each refusal reason needs to be usable by the receiving BPA to make retransmission or rerouting decisions.<a class="pilcrow" href="#section-8.6-2">Â¶</a></p>
<p id="section-8.6-3">
Experts are encouraged to be biased towards approving registrations unless they are abusive, frivolous, or actively harmful (not merely esthetically displeasing or architecturally dubious).<a class="pilcrow" href="#section-8.6-3">Â¶</a></p>
<span id="name-xfer_refuse-reason-codes-3"></span><div id="tab-iana-XFER_REFUSE-codes">
<table class="center" id="table-15">
          <caption>
<a class="selfRef" href="#table-15">Table 15</a>:
<a class="selfRef" href="#name-xfer_refuse-reason-codes-3">XFER_REFUSE Reason Codes</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Code</th>
              <th class="text-left" colspan="1" rowspan="1">Refusal Reason</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0x00</td>
              <td class="text-left" colspan="1" rowspan="1">Unknown</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0x01</td>
              <td class="text-left" colspan="1" rowspan="1">Completed</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0x02</td>
              <td class="text-left" colspan="1" rowspan="1">No Resources</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0x03</td>
              <td class="text-left" colspan="1" rowspan="1">Retransmit</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0x04</td>
              <td class="text-left" colspan="1" rowspan="1">Not Acceptable</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0x05</td>
              <td class="text-left" colspan="1" rowspan="1">Extension Failure</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0x06</td>
              <td class="text-left" colspan="1" rowspan="1">Session Terminating</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0x07-0xEF</td>
              <td class="text-left" colspan="1" rowspan="1">Unassigned</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0xF0-0xFF</td>
              <td class="text-left" colspan="1" rowspan="1">Reserved for Private or Experimental Use</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="sec-iana-SESS_TERM-codes">
<section id="section-8.7">
        <h3 id="name-sess_term-reason-codes-2">
<a class="section-number selfRef" href="#section-8.7">8.7. </a><a class="section-name selfRef" href="#name-sess_term-reason-codes-2">SESS_TERM Reason Codes</a>
        </h3>
<p id="section-8.7-1">
Under the "Bundle Protocol" registry <span>[<a class="xref" href="#IANA-BUNDLE">IANA-BUNDLE</a>]</span>, IANA has created the "Bundle Protocol TCP Convergence-Layer Version 4 SESS_TERM Reason Codes" registry and populated it with the contents of <a class="xref" href="#tab-iana-SESS_TERM-codes">Table 16</a>.
The registration procedure is Specification Required within the lower range 0x00-0xEF.
Values in the range 0xF0-0xFF are reserved for Private or Experimental Use, which are not recorded by 
IANA.<a class="pilcrow" href="#section-8.7-1">Â¶</a></p>
<p id="section-8.7-2">
Specifications of new SESS_TERM reason codes need to define the meaning of the reason and disambiguate it from preexisting reasons.
Each termination reason needs to be usable by the receiving BPA to make reconnection decisions.<a class="pilcrow" href="#section-8.7-2">Â¶</a></p>
<p id="section-8.7-3">
Experts are encouraged to be biased towards approving registrations unless they are abusive, frivolous, or actively harmful (not merely esthetically displeasing or architecturally dubious).<a class="pilcrow" href="#section-8.7-3">Â¶</a></p>
<span id="name-sess_term-reason-codes-3"></span><div id="tab-iana-SESS_TERM-codes">
<table class="center" id="table-16">
          <caption>
<a class="selfRef" href="#table-16">Table 16</a>:
<a class="selfRef" href="#name-sess_term-reason-codes-3">SESS_TERM Reason Codes</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Code</th>
              <th class="text-left" colspan="1" rowspan="1">Termination Reason</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0x00</td>
              <td class="text-left" colspan="1" rowspan="1">Unknown</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0x01</td>
              <td class="text-left" colspan="1" rowspan="1">Idle timeout</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0x02</td>
              <td class="text-left" colspan="1" rowspan="1">Version mismatch</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0x03</td>
              <td class="text-left" colspan="1" rowspan="1">Busy</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0x04</td>
              <td class="text-left" colspan="1" rowspan="1">Contact Failure</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0x05</td>
              <td class="text-left" colspan="1" rowspan="1">Resource Exhaustion</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0x06-0xEF</td>
              <td class="text-left" colspan="1" rowspan="1">Unassigned</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0xF0-0xFF</td>
              <td class="text-left" colspan="1" rowspan="1">Reserved for Private or Experimental Use</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="sec-iana-MSG_REJECT-codes">
<section id="section-8.8">
        <h3 id="name-msg_reject-reason-codes-2">
<a class="section-number selfRef" href="#section-8.8">8.8. </a><a class="section-name selfRef" href="#name-msg_reject-reason-codes-2">MSG_REJECT Reason Codes</a>
        </h3>
<p id="section-8.8-1">
Under the "Bundle Protocol" registry <span>[<a class="xref" href="#IANA-BUNDLE">IANA-BUNDLE</a>]</span>, IANA has created the "Bundle Protocol TCP Convergence-Layer Version 4 MSG_REJECT Reason Codes" registry and populated it with the contents of <a class="xref" href="#tab-iana-MSG_REJECT-codes">Table 17</a>.
The registration procedure is Specification Required within the lower range 0x01-0xEF.
Values in the range 0xF0-0xFF are reserved for Private or Experimental Use, which are not recorded 
by IANA.<a class="pilcrow" href="#section-8.8-1">Â¶</a></p>
<p id="section-8.8-2">
Specifications of new MSG_REJECT reason codes need to define the meaning of the reason and disambiguate it from preexisting reasons.
Each rejection reason needs to be usable by the receiving TCPCL entity to make message sequencing and/or session termination decisions.<a class="pilcrow" href="#section-8.8-2">Â¶</a></p>
<p id="section-8.8-3">
Experts are encouraged to be biased towards approving registrations unless they are abusive, frivolous, or actively harmful (not merely esthetically displeasing or architecturally dubious).<a class="pilcrow" href="#section-8.8-3">Â¶</a></p>
<span id="name-msg_reject-reason-codes-3"></span><div id="tab-iana-MSG_REJECT-codes">
<table class="center" id="table-17">
          <caption>
<a class="selfRef" href="#table-17">Table 17</a>:
<a class="selfRef" href="#name-msg_reject-reason-codes-3">MSG_REJECT Reason Codes</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Code</th>
              <th class="text-left" colspan="1" rowspan="1">Rejection Reason</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0x00</td>
              <td class="text-left" colspan="1" rowspan="1">Reserved</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0x01</td>
              <td class="text-left" colspan="1" rowspan="1">Message Type Unknown</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0x02</td>
              <td class="text-left" colspan="1" rowspan="1">Message Unsupported</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0x03</td>
              <td class="text-left" colspan="1" rowspan="1">Message Unexpected</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0x04-0xEF</td>
              <td class="text-left" colspan="1" rowspan="1">Unassigned</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0xF0-0xFF</td>
              <td class="text-left" colspan="1" rowspan="1">Reserved for Private or Experimental Use</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="sec-iana-smi-mod">
<section id="section-8.9">
        <h3 id="name-object-identifier-for-pkix-">
<a class="section-number selfRef" href="#section-8.9">8.9. </a><a class="section-name selfRef" href="#name-object-identifier-for-pkix-">Object Identifier for PKIX Module Identifier</a>
        </h3>
<p id="section-8.9-1">
IANA has registered the following in the "SMI Security for PKIX Module Identifier" registry <span>[<a class="xref" href="#IANA-SMI">IANA-SMI</a>]</span> for identifying the module described in <a class="xref" href="#sec-asn1-mod">Appendix B</a>.<a class="pilcrow" href="#section-8.9-1">Â¶</a></p>
<span id="name-new-smi-security-module"></span><div id="id-mod-dtn-tcpclv4-2021">
<table class="center" id="table-18">
          <caption>
<a class="selfRef" href="#table-18">Table 18</a>:
<a class="selfRef" href="#name-new-smi-security-module">New SMI Security Module</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Decimal</th>
              <th class="text-left" colspan="1" rowspan="1">Description</th>
              <th class="text-left" colspan="1" rowspan="1">References</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">103</td>
              <td class="text-left" colspan="1" rowspan="1">id-mod-dtn-tcpclv4-2021</td>
              <td class="text-left" colspan="1" rowspan="1">This specification</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="sec-iana-pkix-on-oid">
<section id="section-8.10">
        <h3 id="name-object-identifier-for-pkix-o">
<a class="section-number selfRef" href="#section-8.10">8.10. </a><a class="section-name selfRef" href="#name-object-identifier-for-pkix-o">Object Identifier for PKIX Other Name Forms</a>
        </h3>
<p id="section-8.10-1">
IANA has registered the following in the "SMI Security for PKIX Other Name Forms" registry <span>[<a class="xref" href="#IANA-SMI">IANA-SMI</a>]</span> for 
identifying bundle endpoint IDs:<a class="pilcrow" href="#section-8.10-1">Â¶</a></p>
<span id="name-new-pkix-other-name-form"></span><div id="id-on-bundleEID">
<table class="center" id="table-19">
          <caption>
<a class="selfRef" href="#table-19">Table 19</a>:
<a class="selfRef" href="#name-new-pkix-other-name-form">New PKIX Other Name Form</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Decimal</th>
              <th class="text-left" colspan="1" rowspan="1">Description</th>
              <th class="text-left" colspan="1" rowspan="1">References</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">11</td>
              <td class="text-left" colspan="1" rowspan="1">id-on-bundleEID</td>
              <td class="text-left" colspan="1" rowspan="1">This specification</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-8.10-3">The formal structure of the associated Other Name Form is provided in <a class="xref" href="#sec-asn1-mod">Appendix B</a>. The use of this OID is defined in SectionsÂ <a class="xref" href="#sec-tls-identification">4.4.1</a> and <a class="xref" href="#sec-tcpcl-cert-profile">4.4.2</a>.<a class="pilcrow" href="#section-8.10-3">Â¶</a></p>
</section>
</div>
<div id="sec-iana-pkix-kp-oid">
<section id="section-8.11">
        <h3 id="name-object-identifier-for-pkix-e">
<a class="section-number selfRef" href="#section-8.11">8.11. </a><a class="section-name selfRef" href="#name-object-identifier-for-pkix-e">Object Identifier for PKIX Extended Key Usage</a>
        </h3>
<p id="section-8.11-1">
IANA has registered the following in the "SMI Security for PKIX Extended Key Purpose" registry <span>[<a class="xref" href="#IANA-SMI">IANA-SMI</a>]</span> for securing BP bundles.<a class="pilcrow" href="#section-8.11-1">Â¶</a></p>
<span id="name-new-pkix-extended-key-purpo"></span><div id="tbl-id-kp-bundleSecurity">
<table class="center" id="table-20">
          <caption>
<a class="selfRef" href="#table-20">Table 20</a>:
<a class="selfRef" href="#name-new-pkix-extended-key-purpo">New PKIX Extended Key Purpose</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Decimal</th>
              <th class="text-left" colspan="1" rowspan="1">Description</th>
              <th class="text-left" colspan="1" rowspan="1">References</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">35</td>
              <td class="text-left" colspan="1" rowspan="1">id-kp-bundleSecurity</td>
              <td class="text-left" colspan="1" rowspan="1">This specification</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-8.11-3">The formal definition of this EKU is provided in <a class="xref" href="#sec-asn1-mod">Appendix B</a>. The use of this OID is defined in <a class="xref" href="#sec-tcpcl-cert-profile">Section 4.4.2</a>.<a class="pilcrow" href="#section-8.11-3">Â¶</a></p>
</section>
</div>
</section>
</div>
<section id="section-9">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-9">9. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-9.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-9.1">9.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="IANA-BUNDLE">[IANA-BUNDLE]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Bundle Protocol"</span>, <span>&lt;<a href="https://www.iana.org/assignments/bundle/">https://www.iana.org/assignments/bundle/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA-PORTS">[IANA-PORTS]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Service Name and Transport Protocol Port Number Registry"</span>, <span>&lt;<a href="https://www.iana.org/assignments/service-names-port-numbers/">https://www.iana.org/assignments/service-names-port-numbers/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA-SMI">[IANA-SMI]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Structure of Management Information (SMI) Numbers (MIB Module Registrations)"</span>, <span>&lt;<a href="https://www.iana.org/assignments/smi-numbers/">https://www.iana.org/assignments/smi-numbers/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC0793">[RFC0793]</dt>
        <dd>
<span class="refAuthor">Postel, J.</span>, <span class="refTitle">"Transmission Control Protocol"</span>, <span class="seriesInfo">STD 7</span>, <span class="seriesInfo">RFC 793</span>, <span class="seriesInfo">DOI 10.17487/RFC0793</span>, <time class="refDate" datetime="1981-09">September 1981</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc793">https://www.rfc-editor.org/info/rfc793</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1122">[RFC1122]</dt>
        <dd>
<span class="refAuthor">Braden, R., Ed.</span>, <span class="refTitle">"Requirements for Internet Hosts - Communication Layers"</span>, <span class="seriesInfo">STD 3</span>, <span class="seriesInfo">RFC 1122</span>, <span class="seriesInfo">DOI 10.17487/RFC1122</span>, <time class="refDate" datetime="1989-10">October 1989</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1122">https://www.rfc-editor.org/info/rfc1122</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time class="refDate" datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3986">[RFC3986]</dt>
        <dd>
<span class="refAuthor">Berners-Lee, T.</span>, <span class="refAuthor">Fielding, R.</span>, and <span class="refAuthor">L. Masinter</span>, <span class="refTitle">"Uniform Resource Identifier (URI): Generic Syntax"</span>, <span class="seriesInfo">STD 66</span>, <span class="seriesInfo">RFC 3986</span>, <span class="seriesInfo">DOI 10.17487/RFC3986</span>, <time class="refDate" datetime="2005-01">January 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3986">https://www.rfc-editor.org/info/rfc3986</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time class="refDate" datetime="2008-05">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5280">https://www.rfc-editor.org/info/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6066">[RFC6066]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refTitle">"Transport Layer Security (TLS) Extensions: Extension Definitions"</span>, <span class="seriesInfo">RFC 6066</span>, <span class="seriesInfo">DOI 10.17487/RFC6066</span>, <time class="refDate" datetime="2011-01">January 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6066">https://www.rfc-editor.org/info/rfc6066</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6125">[RFC6125]</dt>
        <dd>
<span class="refAuthor">Saint-Andre, P.</span> and <span class="refAuthor">J. Hodges</span>, <span class="refTitle">"Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS)"</span>, <span class="seriesInfo">RFC 6125</span>, <span class="seriesInfo">DOI 10.17487/RFC6125</span>, <time class="refDate" datetime="2011-03">March 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6125">https://www.rfc-editor.org/info/rfc6125</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6960">[RFC6960]</dt>
        <dd>
<span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Myers, M.</span>, <span class="refAuthor">Ankney, R.</span>, <span class="refAuthor">Malpani, A.</span>, <span class="refAuthor">Galperin, S.</span>, and <span class="refAuthor">C. Adams</span>, <span class="refTitle">"X.509 Internet Public Key Infrastructure Online Certificate Status Protocol - OCSP"</span>, <span class="seriesInfo">RFC 6960</span>, <span class="seriesInfo">DOI 10.17487/RFC6960</span>, <time class="refDate" datetime="2013-06">June 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6960">https://www.rfc-editor.org/info/rfc6960</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7525">[RFC7525]</dt>
        <dd>
<span class="refAuthor">Sheffer, Y.</span>, <span class="refAuthor">Holz, R.</span>, and <span class="refAuthor">P. Saint-Andre</span>, <span class="refTitle">"Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"</span>, <span class="seriesInfo">BCP 195</span>, <span class="seriesInfo">RFC 7525</span>, <span class="seriesInfo">DOI 10.17487/RFC7525</span>, <time class="refDate" datetime="2015-05">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7525">https://www.rfc-editor.org/info/rfc7525</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time class="refDate" datetime="2017-06">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time class="refDate" datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time class="refDate" datetime="2018-08">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9171">[RFC9171]</dt>
        <dd>
<span class="refAuthor">Burleigh, S.</span>, <span class="refAuthor">Fall, K.</span>, and <span class="refAuthor">E. Birrane, III</span>, <span class="refTitle">"Bundle Protocol Version 7"</span>, <span class="seriesInfo">RFC 9171</span>, <span class="seriesInfo">DOI 10.17487/RFC9171</span>, <time class="refDate" datetime="2022-01">January 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9171">https://www.rfc-editor.org/info/rfc9171</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="X.680">[X.680]</dt>
      <dd>
<span class="refAuthor">ITU-T</span>, <span class="refTitle">"Information technology - Abstract Syntax Notation One (ASN.1): Specification of basic notation"</span>, <span class="refContent">ITU-T Recommendation X.680, ISO/IEC 8824-1:2021</span>, <time class="refDate" datetime="2021-02">February 2021</time>, <span>&lt;<a href="https://www.itu.int/rec/T-REC-X.680-202102-I/en">https://www.itu.int/rec/T-REC-X.680-202102-I/en</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-9.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-9.2">9.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="AEAD-LIMITS">[AEAD-LIMITS]</dt>
        <dd>
<span class="refAuthor">Luykx, A.</span> and <span class="refAuthor">K. Paterson</span>, <span class="refTitle">"Limits on Authenticated Encryption Use in TLS"</span>, <time class="refDate" datetime="2017-08">August 2017</time>, <span>&lt;<a href="https://www.isg.rhul.ac.uk/~kp/TLS-AEbounds.pdf">https://www.isg.rhul.ac.uk/~kp/TLS-AEbounds.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2595">[RFC2595]</dt>
        <dd>
<span class="refAuthor">Newman, C.</span>, <span class="refTitle">"Using TLS with IMAP, POP3 and ACAP"</span>, <span class="seriesInfo">RFC 2595</span>, <span class="seriesInfo">DOI 10.17487/RFC2595</span>, <time class="refDate" datetime="1999-06">June 1999</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2595">https://www.rfc-editor.org/info/rfc2595</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3552">[RFC3552]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span> and <span class="refAuthor">B. Korver</span>, <span class="refTitle">"Guidelines for Writing RFC Text on Security Considerations"</span>, <span class="seriesInfo">BCP 72</span>, <span class="seriesInfo">RFC 3552</span>, <span class="seriesInfo">DOI 10.17487/RFC3552</span>, <time class="refDate" datetime="2003-07">July 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3552">https://www.rfc-editor.org/info/rfc3552</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4511">[RFC4511]</dt>
        <dd>
<span class="refAuthor">Sermersheim, J., Ed.</span>, <span class="refTitle">"Lightweight Directory Access Protocol (LDAP): The Protocol"</span>, <span class="seriesInfo">RFC 4511</span>, <span class="seriesInfo">DOI 10.17487/RFC4511</span>, <time class="refDate" datetime="2006-06">June 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4511">https://www.rfc-editor.org/info/rfc4511</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4838">[RFC4838]</dt>
        <dd>
<span class="refAuthor">Cerf, V.</span>, <span class="refAuthor">Burleigh, S.</span>, <span class="refAuthor">Hooke, A.</span>, <span class="refAuthor">Torgerson, L.</span>, <span class="refAuthor">Durst, R.</span>, <span class="refAuthor">Scott, K.</span>, <span class="refAuthor">Fall, K.</span>, and <span class="refAuthor">H. Weiss</span>, <span class="refTitle">"Delay-Tolerant Networking Architecture"</span>, <span class="seriesInfo">RFC 4838</span>, <span class="seriesInfo">DOI 10.17487/RFC4838</span>, <time class="refDate" datetime="2007-04">April 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4838">https://www.rfc-editor.org/info/rfc4838</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5489">[RFC5489]</dt>
        <dd>
<span class="refAuthor">Badra, M.</span> and <span class="refAuthor">I. Hajjeh</span>, <span class="refTitle">"ECDHE_PSK Cipher Suites for Transport Layer Security (TLS)"</span>, <span class="seriesInfo">RFC 5489</span>, <span class="seriesInfo">DOI 10.17487/RFC5489</span>, <time class="refDate" datetime="2009-03">March 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5489">https://www.rfc-editor.org/info/rfc5489</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5912">[RFC5912]</dt>
        <dd>
<span class="refAuthor">Hoffman, P.</span> and <span class="refAuthor">J. Schaad</span>, <span class="refTitle">"New ASN.1 Modules for the Public Key Infrastructure Using X.509 (PKIX)"</span>, <span class="seriesInfo">RFC 5912</span>, <span class="seriesInfo">DOI 10.17487/RFC5912</span>, <time class="refDate" datetime="2010-06">June 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5912">https://www.rfc-editor.org/info/rfc5912</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6698">[RFC6698]</dt>
        <dd>
<span class="refAuthor">Hoffman, P.</span> and <span class="refAuthor">J. Schlyter</span>, <span class="refTitle">"The DNS-Based Authentication of Named Entities (DANE) Transport Layer Security (TLS) Protocol: TLSA"</span>, <span class="seriesInfo">RFC 6698</span>, <span class="seriesInfo">DOI 10.17487/RFC6698</span>, <time class="refDate" datetime="2012-08">August 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6698">https://www.rfc-editor.org/info/rfc6698</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7122">[RFC7122]</dt>
        <dd>
<span class="refAuthor">Kruse, H.</span>, <span class="refAuthor">Jero, S.</span>, and <span class="refAuthor">S. Ostermann</span>, <span class="refTitle">"Datagram Convergence Layers for the Delay- and Disruption-Tolerant Networking (DTN) Bundle Protocol and Licklider Transmission Protocol (LTP)"</span>, <span class="seriesInfo">RFC 7122</span>, <span class="seriesInfo">DOI 10.17487/RFC7122</span>, <time class="refDate" datetime="2014-03">March 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7122">https://www.rfc-editor.org/info/rfc7122</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7242">[RFC7242]</dt>
        <dd>
<span class="refAuthor">Demmer, M.</span>, <span class="refAuthor">Ott, J.</span>, and <span class="refAuthor">S. Perreault</span>, <span class="refTitle">"Delay-Tolerant Networking TCP Convergence-Layer Protocol"</span>, <span class="seriesInfo">RFC 7242</span>, <span class="seriesInfo">DOI 10.17487/RFC7242</span>, <time class="refDate" datetime="2014-06">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7242">https://www.rfc-editor.org/info/rfc7242</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7250">[RFC7250]</dt>
        <dd>
<span class="refAuthor">Wouters, P., Ed.</span>, <span class="refAuthor">Tschofenig, H., Ed.</span>, <span class="refAuthor">Gilmore, J.</span>, <span class="refAuthor">Weiler, S.</span>, and <span class="refAuthor">T. Kivinen</span>, <span class="refTitle">"Using Raw Public Keys in Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"</span>, <span class="seriesInfo">RFC 7250</span>, <span class="seriesInfo">DOI 10.17487/RFC7250</span>, <time class="refDate" datetime="2014-06">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7250">https://www.rfc-editor.org/info/rfc7250</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7435">[RFC7435]</dt>
        <dd>
<span class="refAuthor">Dukhovni, V.</span>, <span class="refTitle">"Opportunistic Security: Some Protection Most of the Time"</span>, <span class="seriesInfo">RFC 7435</span>, <span class="seriesInfo">DOI 10.17487/RFC7435</span>, <time class="refDate" datetime="2014-12">December 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7435">https://www.rfc-editor.org/info/rfc7435</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7457">[RFC7457]</dt>
        <dd>
<span class="refAuthor">Sheffer, Y.</span>, <span class="refAuthor">Holz, R.</span>, and <span class="refAuthor">P. Saint-Andre</span>, <span class="refTitle">"Summarizing Known Attacks on Transport Layer Security (TLS) and Datagram TLS (DTLS)"</span>, <span class="seriesInfo">RFC 7457</span>, <span class="seriesInfo">DOI 10.17487/RFC7457</span>, <time class="refDate" datetime="2015-02">February 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7457">https://www.rfc-editor.org/info/rfc7457</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8555">[RFC8555]</dt>
        <dd>
<span class="refAuthor">Barnes, R.</span>, <span class="refAuthor">Hoffman-Andrews, J.</span>, <span class="refAuthor">McCarney, D.</span>, and <span class="refAuthor">J. Kasten</span>, <span class="refTitle">"Automatic Certificate Management Environment (ACME)"</span>, <span class="seriesInfo">RFC 8555</span>, <span class="seriesInfo">DOI 10.17487/RFC8555</span>, <time class="refDate" datetime="2019-03">March 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8555">https://www.rfc-editor.org/info/rfc8555</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9172">[RFC9172]</dt>
        <dd>
<span class="refAuthor">Birrane, III, E.</span> and <span class="refAuthor">K. McKeever</span>, <span class="refTitle">"Bundle Protocol Security (BPSec)"</span>, <span class="seriesInfo">RFC 9172</span>, <span class="seriesInfo">DOI 10.17487/RFC9172</span>, <time class="refDate" datetime="2022-01">January 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9172">https://www.rfc-editor.org/info/rfc9172</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-dtn-bibect">[DTN-BIBECT]</dt>
      <dd>
<span class="refAuthor">Burleigh, S.</span>, <span class="refTitle">"Bundle-in-Bundle Encapsulation"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-dtn-bibect-03</span>, <time class="refDate" datetime="2020-02-18">18 February 2020</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-dtn-bibect-03">https://datatracker.ietf.org/doc/html/draft-ietf-dtn-bibect-03</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<section id="appendix-A">
      <h2 id="name-significant-changes-from-rf">
<a class="section-number selfRef" href="#appendix-A">Appendix A. </a><a class="section-name selfRef" href="#name-significant-changes-from-rf">Significant Changes from RFC 7242</a>
      </h2>
<p id="appendix-A-1">
The areas in which changes from <span>[<a class="xref" href="#RFC7242">RFC7242</a>]</span> have been made to existing headers and messages are as follows:<a class="pilcrow" href="#appendix-A-1">Â¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-2.1">Split Contact Header into pre-TLS protocol negotiation and SESS_INIT parameter negotiation. The Contact Header is now fixed length.<a class="pilcrow" href="#appendix-A-2.1">Â¶</a>
</li>
        <li class="normal" id="appendix-A-2.2">Changed Contact Header content to limit number of negotiated options.<a class="pilcrow" href="#appendix-A-2.2">Â¶</a>
</li>
        <li class="normal" id="appendix-A-2.3">Added session option to negotiate maximum segment size (per each direction).<a class="pilcrow" href="#appendix-A-2.3">Â¶</a>
</li>
        <li class="normal" id="appendix-A-2.4">Renamed "endpoint ID" to "node ID" to conform with BPv7 terminology.<a class="pilcrow" href="#appendix-A-2.4">Â¶</a>
</li>
        <li class="normal" id="appendix-A-2.5">Added session extension capability.<a class="pilcrow" href="#appendix-A-2.5">Â¶</a>
</li>
        <li class="normal" id="appendix-A-2.6">Added transfer extension capability. Moved transfer total length into an extension item.<a class="pilcrow" href="#appendix-A-2.6">Â¶</a>
</li>
        <li class="normal" id="appendix-A-2.7">Defined new IANA registries for message / type / reason codes to allow renaming some codes for clarity.<a class="pilcrow" href="#appendix-A-2.7">Â¶</a>
</li>
        <li class="normal" id="appendix-A-2.8">Pointed out that segments of all new IANA registries are reserved for private/experimental use.<a class="pilcrow" href="#appendix-A-2.8">Â¶</a>
</li>
        <li class="normal" id="appendix-A-2.9">Expanded Message Header to octet-aligned fields instead of bit-packing.<a class="pilcrow" href="#appendix-A-2.9">Â¶</a>
</li>
        <li class="normal" id="appendix-A-2.10">Added a bundle transfer identification number to all bundle-related messages (XFER_SEGMENT, XFER_ACK, XFER_REFUSE).<a class="pilcrow" href="#appendix-A-2.10">Â¶</a>
</li>
        <li class="normal" id="appendix-A-2.11">Added flags in XFER_ACK to mirror flags from XFER_SEGMENT.<a class="pilcrow" href="#appendix-A-2.11">Â¶</a>
</li>
        <li class="normal" id="appendix-A-2.12">Removed all uses of Self-Delimiting Numeric Value (SDNV) fields and replaced with fixed-bit-length (network byte order) fields.<a class="pilcrow" href="#appendix-A-2.12">Â¶</a>
</li>
        <li class="normal" id="appendix-A-2.13">Renamed SHUTDOWN to SESS_TERM to deconflict term "shutdown" related to TCP connections.<a class="pilcrow" href="#appendix-A-2.13">Â¶</a>
</li>
        <li class="normal" id="appendix-A-2.14">Removed the notion of a reconnection delay parameter.<a class="pilcrow" href="#appendix-A-2.14">Â¶</a>
</li>
      </ul>
<p id="appendix-A-3">
The areas in which extensions from <span>[<a class="xref" href="#RFC7242">RFC7242</a>]</span> have been made as new messages and codes are as follows:<a class="pilcrow" href="#appendix-A-3">Â¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-4.1">Added MSG_REJECT message to indicate that an unknown or unhandled message was received.<a class="pilcrow" href="#appendix-A-4.1">Â¶</a>
</li>
        <li class="normal" id="appendix-A-4.2">Added TLS connection security mechanism.<a class="pilcrow" href="#appendix-A-4.2">Â¶</a>
</li>
        <li class="normal" id="appendix-A-4.3">Added "Not Acceptable", "Extension Failure", and "Session Terminating" XFER_REFUSE reason codes.<a class="pilcrow" href="#appendix-A-4.3">Â¶</a>
</li>
        <li class="normal" id="appendix-A-4.4">Added "Contact Failure" (contact negotiation failure) and "Resource Exhaustion" SESS_TERM reason codes.<a class="pilcrow" href="#appendix-A-4.4">Â¶</a>
</li>
      </ul>
</section>
<div id="sec-asn1-mod">
<section id="appendix-B">
      <h2 id="name-asn1-module">
<a class="section-number selfRef" href="#appendix-B">Appendix B. </a><a class="section-name selfRef" href="#name-asn1-module">ASN.1 Module</a>
      </h2>
<p id="appendix-B-1">
The following ASN.1 module formally specifies the <code>BundleEID</code> structure, its Other Name Form, and the <code>bundleSecurity</code> EKU, using ASN.1 syntax per <span>[<a class="xref" href="#X.680">X.680</a>]</span>.
This specification uses the ASN.1 definitions from <span>[<a class="xref" href="#RFC5912">RFC5912</a>]</span> with the 2002 ASN.1 notation used in that document.<a class="pilcrow" href="#appendix-B-1">Â¶</a></p>
<div id="appendix-B-2">
<pre class="lang-asn.1 sourcecode">&lt;CODE BEGINS&gt;
DTN-TCPCLv4-2021
  { iso(1) identified-organization(3) dod(6)
    internet(1) security(5) mechanisms(5) pkix(7) id-mod(0)
    id-mod-dtn-tcpclv4-2021(103) }

DEFINITIONS IMPLICIT TAGS ::=
BEGIN

IMPORTS
  OTHER-NAME
  FROM PKIX1Implicit-2009 -- [RFC5912]
    { iso(1) identified-organization(3) dod(6) internet(1)
      security(5) mechanisms(5) pkix(7) id-mod(0)
      id-mod-pkix1-implicit-02(59) }

  id-pkix
  FROM PKIX1Explicit-2009 -- [RFC5912]
    { iso(1) identified-organization(3) dod(6) internet(1)
      security(5) mechanisms(5) pkix(7) id-mod(0)
      id-mod-pkix1-explicit-02(51) } ;

id-kp OBJECT IDENTIFIER ::= { id-pkix 3 }

id-on OBJECT IDENTIFIER ::= { id-pkix 8 }

DTNOtherNames OTHER-NAME ::= { on-bundleEID, ... }

-- The otherName definition for BundleEID
on-bundleEID OTHER-NAME ::= {
    BundleEID IDENTIFIED BY { id-on-bundleEID }
}

id-on-bundleEID OBJECT IDENTIFIER ::= { id-on 11 }

-- Same encoding as GeneralName of uniformResourceIdentifier
BundleEID ::= IA5String

-- The Extended Key Usage key for bundle security
id-kp-bundleSecurity OBJECT IDENTIFIER ::= { id-kp 35 }

END

&lt;CODE ENDS&gt;</pre><a class="pilcrow" href="#appendix-B-2">Â¶</a>
</div>
</section>
</div>
<section id="appendix-C">
      <h2 id="name-example-of-the-bundleeid-ot">
<a class="section-number selfRef" href="#appendix-C">Appendix C. </a><a class="section-name selfRef" href="#name-example-of-the-bundleeid-ot">Example of the BundleEID Other Name Form</a>
      </h2>
<p id="appendix-C-1">
This non-normative example demonstrates an otherName with a name form of <code>BundleEID</code> to encode the node ID "dtn://example/".<a class="pilcrow" href="#appendix-C-1">Â¶</a></p>
<p id="appendix-C-2">
The hexadecimal form of the DER encoding of the otherName is as follows:<a class="pilcrow" href="#appendix-C-2">Â¶</a></p>
<div id="appendix-C-3">
<pre class="lang-hex sourcecode">a01c06082b0601050507080ba010160e64746e3a2f2f6578616d706c652f
</pre><a class="pilcrow" href="#appendix-C-3">Â¶</a>
</div>
<p id="appendix-C-4">
And the text decoding in <a class="xref" href="#fig-example-dtneid">Figure 28</a> is an output of Peter Gutmann's "dumpasn1" program.<a class="pilcrow" href="#appendix-C-4">Â¶</a></p>
<span id="name-visualized-decoding-of-the-"></span><div id="fig-example-dtneid">
<figure id="figure-28">
        <div class="alignLeft art-ascii-art art-text artwork" id="appendix-C-5.1">
<pre>  0  28: [0] {
  2   8:   OBJECT IDENTIFIER '1 3 6 1 5 5 7 8 11'
 12  16:   [0] {
 14  14:     IA5String 'dtn://example/'
       :     }
       :   }
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-28">Figure 28</a>:
<a class="selfRef" href="#name-visualized-decoding-of-the-">Visualized Decoding of the on-bundleEID</a>
        </figcaption></figure>
</div>
</section>
<div id="sec-doc-ack">
<section id="appendix-D">
      <h2 id="name-acknowledgments">
<a class="section-name selfRef" href="#name-acknowledgments">Acknowledgments</a>
      </h2>
<p id="appendix-D-1">
This specification is based on comments regarding the implementation of <span>[<a class="xref" href="#RFC7242">RFC7242</a>]</span> as provided by <span class="contact-name">Scott Burleigh</span>.<a class="pilcrow" href="#appendix-D-1">Â¶</a></p>
<p id="appendix-D-2">
The ASN.1 module and its Other Name Form are based on a recommendation provided by <span class="contact-name">Russ Housley</span>.<a class="pilcrow" href="#appendix-D-2">Â¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-E">
      <h2 id="name-authors-addresses">
<a class="section-name selfRef" href="#name-authors-addresses">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Brian Sipos</span></div>
<div class="left" dir="auto"><span class="org">RKF Engineering Solutions, LLC</span></div>
<div class="left" dir="auto"><span class="street-address">7500 Old Georgetown Road<br/>Suite 1275</span></div>
<div class="left" dir="auto">
<span class="locality">Bethesda</span>, <span class="region">MD</span> <span class="postal-code">20814-6198</span>
</div>
<div class="left" dir="auto"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:brian.sipos+ietf@gmail.com">brian.sipos+ietf@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Michael Demmer</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:demmer@gmail.com">demmer@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">JÃ¶rg Ott</span></div>
<div class="left" dir="auto"><span class="org">Technical University of Munich</span></div>
<div class="left" dir="auto"><span class="extended-address">Department of Informatics<br/>Chair of Connected Mobility</span></div>
<div class="left" dir="auto"><span class="street-address">Boltzmannstrasse 3</span></div>
<div class="left" dir="auto">
<span class="postal-code">DE-85748</span> <span class="locality">Garching</span>
</div>
<div class="left" dir="auto"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:ott@in.tum.de">ott@in.tum.de</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Simon Perreault</span></div>
<div class="left" dir="auto"><span class="org">LogMeIn</span></div>
<div class="left" dir="auto"><span class="street-address">410 boulevard Charest Est<br/>Suite 250</span></div>
<div class="left" dir="auto">
<span class="locality">Quebec</span> <span class="region">QC</span> <span class="postal-code">G1K 8G3</span>
</div>
<div class="left" dir="auto"><span class="country-name">Canada</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:simon.perreault@logmein.com">simon.perreault@logmein.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>