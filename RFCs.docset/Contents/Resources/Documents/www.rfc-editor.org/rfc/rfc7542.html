<html><head></head><body><pre>Internet Engineering Task Force (IETF)                          A. DeKok
Request for Comments: 7542                                    FreeRADIUS
Obsoletes: <a href="./rfc4282">4282</a>                                                 May 2015
Category: Standards Track
ISSN: 2070-1721


                     <span class="h1">The Network Access Identifier</span>

Abstract

   In order to provide inter-domain authentication services, it is
   necessary to have a standardized method that domains can use to
   identify each other's users.  This document defines the syntax for
   the Network Access Identifier (NAI), the user identifier submitted by
   the client prior to accessing resources.  This document is a revised
   version of <a href="./rfc4282">RFC 4282</a>.  It addresses issues with international
   character sets and makes a number of other corrections to <a href="./rfc4282">RFC 4282</a>.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="./rfc5741#section-2">Section 2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc7542">http://www.rfc-editor.org/info/rfc7542</a>.



















<span class="grey">DeKok                        Standards Track                    [Page 1]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-2"></span>
<span class="grey"><a href="./rfc7542">RFC 7542</a>              The Network Access Identifier             May 2015</span>


Copyright Notice

   Copyright (c) 2015 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://www.rfc-editor.org/bcp/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

   This document may contain material from IETF Documents or IETF
   Contributions published or made publicly available before November
   10, 2008.  The person(s) controlling the copyright in some of this
   material may not have granted the IETF Trust the right to allow
   modifications of such material outside the IETF Standards Process.
   Without obtaining an adequate license from the person(s) controlling
   the copyright in such materials, this document may not be modified
   outside the IETF Standards Process, and derivative works of it may
   not be created outside the IETF Standards Process, except to format
   it for publication as an RFC or to translate it into languages other
   than English.

























<span class="grey">DeKok                        Standards Track                    [Page 2]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-3"></span>
<span class="grey"><a href="./rfc7542">RFC 7542</a>              The Network Access Identifier             May 2015</span>


Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-4">4</a>
      <a href="#section-1.1">1.1</a>. Terminology ................................................<a href="#page-6">6</a>
      <a href="#section-1.2">1.2</a>. Requirements Language ......................................<a href="#page-7">7</a>
      <a href="#section-1.3">1.3</a>. Purpose ....................................................<a href="#page-7">7</a>
      <a href="#section-1.4">1.4</a>. Motivation .................................................<a href="#page-9">9</a>
   <a href="#section-2">2</a>. NAI Definition .................................................<a href="#page-10">10</a>
      <a href="#section-2.1">2.1</a>. UTF-8 Syntax and Normalization ............................<a href="#page-10">10</a>
      <a href="#section-2.2">2.2</a>. Formal Syntax .............................................<a href="#page-11">11</a>
      <a href="#section-2.3">2.3</a>. NAI Length Considerations .................................<a href="#page-11">11</a>
      <a href="#section-2.4">2.4</a>. Support for Username Privacy ..............................<a href="#page-12">12</a>
      <a href="#section-2.5">2.5</a>. International Character Sets ..............................<a href="#page-13">13</a>
      <a href="#section-2.6">2.6</a>. The Normalization Process .................................<a href="#page-14">14</a>
           <a href="#section-2.6.1">2.6.1</a>. Issues with the Normalization Process ..............<a href="#page-15">15</a>
      <a href="#section-2.7">2.7</a>. Use in Other Protocols ....................................<a href="#page-16">16</a>
      <a href="#section-2.8">2.8</a>. Using the NAI Format for Other Identifiers ................<a href="#page-17">17</a>
   <a href="#section-3">3</a>. Routing inside of AAA Systems ..................................<a href="#page-18">18</a>
      <a href="#section-3.1">3.1</a>. Compatibility with Email Usernames ........................<a href="#page-19">19</a>
      <a href="#section-3.2">3.2</a>. Compatibility with DNS ....................................<a href="#page-20">20</a>
      <a href="#section-3.3">3.3</a>. Realm Construction ........................................<a href="#page-20">20</a>
           <a href="#section-3.3.1">3.3.1</a>. Historical Practices ...............................<a href="#page-21">21</a>
      <a href="#section-3.4">3.4</a>. Examples ..................................................<a href="#page-22">22</a>
   <a href="#section-4">4</a>. Security Considerations ........................................<a href="#page-23">23</a>
      <a href="#section-4.1">4.1</a>. Correlation of Identities over Time and Protocols .........<a href="#page-23">23</a>
      <a href="#section-4.2">4.2</a>. Multiple Identifiers ......................................<a href="#page-24">24</a>
   <a href="#section-5">5</a>. Administration of Names ........................................<a href="#page-25">25</a>
   <a href="#section-6">6</a>. References .....................................................<a href="#page-26">26</a>
      <a href="#section-6.1">6.1</a>. Normative References ......................................<a href="#page-26">26</a>
      <a href="#section-6.2">6.2</a>. Informative References ....................................<a href="#page-26">26</a>
   <a href="#appendix-A">Appendix A</a>. Changes from <a href="./rfc4282">RFC 4282</a> .................................<a href="#page-29">29</a>
   Acknowledgments ...................................................<a href="#page-30">30</a>
   Author's Address ..................................................<a href="#page-30">30</a>


















<span class="grey">DeKok                        Standards Track                    [Page 3]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-4"></span>
<span class="grey"><a href="./rfc7542">RFC 7542</a>              The Network Access Identifier             May 2015</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" id="section-1">1</a>.  Introduction</span>

   Considerable interest exists for a set of features that fit within
   the general category of inter-domain authentication, or "roaming
   capability" for network access, including dialup Internet users,
   Virtual Private Network (VPN) usage, wireless LAN authentication, and
   other applications.

   By "inter-domain authentication", this document refers to situations
   where a user has authentication credentials at one "home" domain but
   is able to present them at a second "visited" domain to access
   certain services at the visited domain.  The two domains generally
   have a pre-existing relationship, so that the credentials can be
   passed from the visited domain to the home domain for verification.
   The home domain typically responds with a permit/deny response, which
   may also include authorization parameters that the visited domain is
   expected to enforce on the user.

   That is, the "roaming" scenario involves a user visiting, or
   "roaming" to, a non-home domain and requesting the use of services at
   that visited domain.

   Interested parties have included the following:

   *  Regional Internet Service Providers (ISPs) operating within a
      particular state or province, looking to combine their efforts
      with those of other regional providers to offer dialup service
      over a wider area.

   *  Telecommunications companies who wish to combine their operations
      with those of one or more companies in other areas or nations, in
      order to offer more comprehensive network access service in areas
      where there is no native service (e.g., in another country).

   *  Wireless LAN hotspots providing service to one or more ISPs.

   *  Businesses desiring to offer their employees a comprehensive
      package of dialup services on a global basis.  Those services may
      include Internet access as well as secure access to corporate
      intranets via a VPN, enabled by tunneling protocols such as the
      Point-to-Point Tunneling Protocol (PPTP) [<a href="./rfc2637" title='"Point-to-Point Tunneling Protocol (PPTP)"'>RFC2637</a>], the Layer 2
      Forwarding (L2F) protocol [<a href="./rfc2341" title='"Cisco Layer Two Forwarding (Protocol) "'>RFC2341</a>], the Layer 2 Tunneling
      Protocol (L2TP) [<a href="./rfc2661" title='"Layer Two Tunneling Protocol "'>RFC2661</a>], and the IPsec tunnel mode [<a href="./rfc4301" title='"Security Architecture for the Internet Protocol"'>RFC4301</a>].

   *  Other protocols that are interested in leveraging the users'
      credentials in order to take advantage of an existing
      authentication framework.




<span class="grey">DeKok                        Standards Track                    [Page 4]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-5"></span>
<span class="grey"><a href="./rfc7542">RFC 7542</a>              The Network Access Identifier             May 2015</span>


   In order to enhance the interoperability of these services, it is
   necessary to have a standardized method for identifying users.  This
   document defines syntax for the Network Access Identifier (NAI).
   Examples of implementations that use the NAI, and descriptions of its
   semantics, can be found in [<a href="./rfc2194" title='"Review of Roaming Implementations"'>RFC2194</a>].

   When the NAI was defined for network access, it had the side effect
   of defining an identifier that could be used in non-AAA systems.
   Some non-AAA systems defined identifiers that were compatible with
   the NAI, and deployments used the NAI.  This process simplified the
   management of credentials, by reusing the same credential in multiple
   situations.  Protocols that reuse the same credential or the same
   identifier format can benefit from this simplified management.  The
   alternative is to have protocol-specific credentials or identifier
   formats, which increases cost to both the user and the administrator.

   There are privacy implications to using one identifier across
   multiple protocols.  See Sections <a href="#section-2.7">2.7</a> and <a href="#section-4">4</a> for further discussion of
   this topic.

   The goal of this document is to define the format of an identifier
   that can be used in many protocols.  A protocol may transport an
   encoded version of the NAI (e.g., '.' as %2E).  However, the
   definition of the NAI is protocol independent.  The goal of this
   document is to encourage the widespread adoption of the NAI format.
   This adoption will decrease the work required to leverage
   identification and authentication in other protocols.  It will also
   decrease the complexity of non-AAA systems for end users and
   administrators.

   This document only suggests that the NAI format be used; it does not
   require such use.  Many protocols already define their own identifier
   formats.  Some of these are incompatible with the NAI, while others
   allow the NAI in addition to non-NAI identifiers.  The definition of
   the NAI in this document has no requirements on protocol
   specifications, implementations, or deployments.

   However, this document suggests that using one standard identifier
   format is preferable to using multiple incompatible identifier
   formats.  Where identifiers need to be used in new protocols and/or
   specifications, it is RECOMMENDED that the format of the NAI be used.
   That is, the interpretation of the identifier is context specific,
   while the format of the identifier remains the same.  These issues
   are discussed in more detail in <a href="#section-2.8">Section 2.8</a>, below.







<span class="grey">DeKok                        Standards Track                    [Page 5]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-6"></span>
<span class="grey"><a href="./rfc7542">RFC 7542</a>              The Network Access Identifier             May 2015</span>


   The recommendation for a standard identifier format is not a
   recommendation that each user have one universal identifier.  In
   contrast, this document allows for the use of multiple identifiers
   and recommends the use of anonymous identifiers where those
   identifiers are publicly visible.

   This document is a revised version of [<a href="./rfc4282" title='"The Network Access Identifier"'>RFC4282</a>], which originally
   defined internationalized NAIs.  Differences and enhancements
   compared to that document are listed in <a href="#appendix-A">Appendix A</a>.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/1.1.%20%20Terminology"></a><a class="selflink" href="#section-1.1" id="section-1.1">1.1</a>.  Terminology</span>

   This document frequently uses the following terms:

   "Local" or "Localized" Text

      "Local" or "localized" text is text that is in either non-UTF-8 or
      non-normalized form.  The character set, encoding, and locale are
      (in general) unknown to Authentication, Authorization, and
      Accounting (AAA) network protocols.  The client that "knows" the
      locale may have a different concept of this text than other AAA
      entities, which do not know the same locale.

   Network Access Identifier

      The Network Access Identifier (NAI) is a common format for user
      identifiers submitted by a client during authentication.  The
      purpose of the NAI is to allow a user to be associated with an
      account name, as well as to assist in the routing of the
      authentication request across multiple domains.  Please note that
      the NAI may not necessarily be the same as the user's email
      address or the user identifier submitted in an application-layer
      authentication.

   Network Access Server

      The Network Access Server (NAS) is the device that clients connect
      to in order to get access to the network.  In PPTP terminology,
      this is referred to as the PPTP Access Concentrator (PAC), and in
      L2TP terminology, it is referred to as the L2TP Access
      Concentrator (LAC).  In IEEE 802.11, it is referred to as an
      Access Point.









<span class="grey">DeKok                        Standards Track                    [Page 6]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-7"></span>
<span class="grey"><a href="./rfc7542">RFC 7542</a>              The Network Access Identifier             May 2015</span>


   Roaming Capability

      Roaming capability can be loosely defined as the ability to use
      any one of multiple Internet Service Providers (ISPs), while
      maintaining a formal customer-vendor relationship with only one.
      Examples of cases where roaming capability might be required
      include ISP "confederations" and ISP-provided corporate network
      access support.

   Normalization or Canonicalization

      These terms are defined in <a href="./rfc6365#section-4">Section 4 of [RFC6365]</a>; those
      definitions are incorporated here by reference.

   Locale

      This term is defined in <a href="./rfc6365#section-8">[RFC6365], Section 8</a>; that definition is
      incorporated here by reference.

   Tunneling Service

      A tunneling service is any network service enabled by tunneling
      protocols such as PPTP, L2F, L2TP, and IPsec tunnel mode.  One
      example of a tunneling service is secure access to corporate
      intranets via a Virtual Private Network (VPN).

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/1.2.%20%20Requirements%20Language"></a><a class="selflink" href="#section-1.2" id="section-1.2">1.2</a>.  Requirements Language</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in
   [<a href="./rfc2119" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/1.3.%20%20Purpose"></a><a class="selflink" href="#section-1.3" id="section-1.3">1.3</a>.  Purpose</span>

   As described in [<a href="./rfc2194" title='"Review of Roaming Implementations"'>RFC2194</a>], there are a number of providers offering
   network access services, and essentially all Internet Service
   Providers are involved in roaming consortia.

   In order to be able to offer roaming capability, one of the
   requirements is to be able to identify the user's home authentication
   server.  For use in roaming, this function is accomplished via the
   Network Access Identifier (NAI) submitted by the user to the NAS in
   the initial network authentication.  It is also expected that NASes
   will use the NAI as part of the process of opening a new tunnel, in
   order to determine the tunnel endpoint.





<span class="grey">DeKok                        Standards Track                    [Page 7]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-8"></span>
<span class="grey"><a href="./rfc7542">RFC 7542</a>              The Network Access Identifier             May 2015</span>


   This document suggests that other protocols can take advantage of the
   NAI format.  Many protocols include authentication capabilities,
   including defining their own identifier formats.  These identifiers
   can then end up being transported in AAA protocols, so that the
   originating protocols can leverage AAA for user authentication.
   There is therefore a need for a definition of a user identifier that
   can be used in multiple protocols.

   While the NAI is defined herein, it should be noted that existing
   protocols and deployments do not always use it.  AAA systems MUST
   therefore be able to handle user identifiers that are not in the NAI
   format.  The process by which that is done is outside of the scope of
   this document.

   Non-AAA systems can accept user identifiers in forms other than the
   NAI.  This specification does not forbid that practice.  It only
   codifies the format and interpretation of the NAI.  This document
   cannot change existing protocols or practices.  It can, however,
   suggest that using a consistent form for a user identifier is of
   benefit to the community.

   This document does not make any protocol-specific definitions for an
   identifier format, and it does not make changes to any existing
   protocol.  Instead, it defines a protocol-independent form for the
   NAI.  It is hoped that the NAI is a user identifier that can be used
   in multiple protocols.

   Using a common identifier format simplifies protocols requiring
   authentication, as they no longer need to specify a protocol-specific
   format for user identifiers.  It increases security, as multiple
   identifier formats allow attackers to make contradictory claims
   without being detected (see <a href="#section-4.2">Section 4.2</a> for further discussion of
   this topic).  It simplifies deployments, as a user can have one
   identifier in multiple contexts, which allows them to be uniquely
   identified, so long as that identifier is itself protected against
   unauthorized access.

   In short, having a standard is better than having no standard at all.













<span class="grey">DeKok                        Standards Track                    [Page 8]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-9"></span>
<span class="grey"><a href="./rfc7542">RFC 7542</a>              The Network Access Identifier             May 2015</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/1.4.%20%20Motivation"></a><a class="selflink" href="#section-1.4" id="section-1.4">1.4</a>.  Motivation</span>

   The changes from [<a href="./rfc4282" title='"The Network Access Identifier"'>RFC4282</a>] are listed in detail in <a href="#appendix-A">Appendix A</a>.
   However, some additional discussion is appropriate to motivate those
   changes.

   The motivation to revise [<a href="./rfc4282" title='"The Network Access Identifier"'>RFC4282</a>] began with internationalization
   concerns raised in the context of [<a href="#ref-EDUROAM" title='"eduroam (EDUcation ROAMing)"'>EDUROAM</a>].  <a href="./rfc4282#section-2.1">Section 2.1 of
   [RFC4282]</a> defines ABNF for realms and limits the realm grammar to
   English letters, digits, and the hyphen "-" character.  The intent
   appears to have been to encode, compare, and transport realms with
   the Punycode [<a href="./rfc3492" title='"Punycode: A Bootstring encoding of Unicode for Internationalized Domain Names in Applications (IDNA)"'>RFC3492</a>] encoding form as described in [<a href="./rfc5891" title='"Internationalized Domain Names in Applications (IDNA): Protocol"'>RFC5891</a>].
   There are a number of problems with this approach:

   *  The [<a href="./rfc4282" title='"The Network Access Identifier"'>RFC4282</a>] ABNF is not aligned with internationalization
      of DNS.

   *  The requirement in <a href="./rfc4282#section-2.1">Section 2.1 of [RFC4282]</a> that realms are ASCII
      conflicts with the Extensible Authentication Protocol (EAP) as
      defined in [<a href="./rfc3748" title='"Extensible Authentication Protocol (EAP)"'>RFC3748</a>], and RADIUS, which are both 8-bit clean, and
      which both recommend the use of UTF-8 for identifiers.

   *  <a href="./rfc4282#section-2.4">Section 2.4 of [RFC4282]</a> required mappings that are language
      specific and that are nearly impossible for intermediate nodes to
      perform correctly without information about that language.

   *  <a href="./rfc4282#section-2.4">Section 2.4 of [RFC4282]</a> requires normalization of usernames,
      which may conflict with local system or administrative
      requirements.

   *  The recommendations in <a href="./rfc4282#section-2.4">Section 2.4 of [RFC4282]</a> for treatment of
      bidirectional characters have proven to be unworkable.

   *  The prohibition of the use of unassigned code points in
      <a href="./rfc4282#section-2.4">Section 2.4 of [RFC4282]</a> effectively prohibits support for new
      scripts.

   *  No Authentication, Authorization, and Accounting (AAA) client,
      proxy, or server has implemented any of the requirements in
      <a href="./rfc4282#section-2.4">Section 2.4 of [RFC4282]</a>, among other sections.

   With international roaming growing in popularity, it is important for
   these issues to be corrected in order to provide robust and
   interoperable network services.

   Furthermore, this document was motivated by a desire to codify
   existing practice related to the use of the NAI format and to
   encourage widespread use of the format.



<span class="grey">DeKok                        Standards Track                    [Page 9]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-10"></span>
<span class="grey"><a href="./rfc7542">RFC 7542</a>              The Network Access Identifier             May 2015</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.%20%20NAI%20Definition"></a><a class="selflink" href="#section-2" id="section-2">2</a>.  NAI Definition</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.1.%20%20UTF-8%20Syntax%20and%20Normalization"></a><a class="selflink" href="#section-2.1" id="section-2.1">2.1</a>.  UTF-8 Syntax and Normalization</span>

   UTF-8 characters can be defined in terms of octets using the
   following ABNF [<a href="./rfc5234" title='"Augmented BNF for Syntax Specifications: ABNF"'>RFC5234</a>], taken from [<a href="./rfc3629" title='"UTF-8, a transformation format of ISO 10646"'>RFC3629</a>]:

   UTF8-xtra-char  =   UTF8-2 / UTF8-3 / UTF8-4

   UTF8-2          =   %xC2-DF UTF8-tail

   UTF8-3          =   %xE0 %xA0-BF UTF8-tail /
                       %xE1-EC 2( UTF8-tail ) /
                       %xED %x80-9F UTF8-tail /
                       %xEE-EF 2( UTF8-tail )

   UTF8-4          =   %xF0 %x90-BF 2( UTF8-tail ) /
                       %xF1-F3 3( UTF8-tail ) /
                       %xF4 %x80-8F 2( UTF8-tail )

   UTF8-tail       =   %x80-BF

   These are normatively defined in [<a href="./rfc3629" title='"UTF-8, a transformation format of ISO 10646"'>RFC3629</a>] but are repeated in this
   document for reasons of convenience.

   See [<a href="./rfc5198" title='"Unicode Format for Network Interchange"'>RFC5198</a>] and <a href="#section-2.6">Section 2.6</a> of this specification for a discussion
   of normalization.  Strings that are not Normal Form Composed (NFC)
   are not valid NAIs and SHOULD NOT be treated as such.
   Implementations that expect to receive an NAI but that instead
   receive non-normalized (but otherwise valid) UTF-8 strings instead
   SHOULD attempt to create a local version of the NAI, which is
   normalized from the input identifier.  This local version can then be
   used for local processing.  This local version of the identifier MUST
   NOT be used outside of the local context.

   Where protocols carry identifiers that are expected to be transported
   over a AAA protocol, it is RECOMMENDED that the identifiers be in NAI
   format.  Where the identifiers are not in the NAI format, it is up to
   the AAA systems to discover this and to process them.  This document
   does not suggest how that is done.  However, existing practice
   indicates that it is possible.

   As internationalized domain names become more widely used, existing
   practices are likely to become inadequate.  This document therefore
   defines the NAI, which is a user identifier format that can correctly
   deal with internationalized identifiers.





<span class="grey">DeKok                        Standards Track                   [Page 10]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-11"></span>
<span class="grey"><a href="./rfc7542">RFC 7542</a>              The Network Access Identifier             May 2015</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.2.%20%20Formal%20Syntax"></a><a class="selflink" href="#section-2.2" id="section-2.2">2.2</a>.  Formal Syntax</span>

   The grammar for the NAI is given below, described in Augmented
   Backus-Naur Form (ABNF) as documented in [<a href="./rfc5234" title='"Augmented BNF for Syntax Specifications: ABNF"'>RFC5234</a>].

   nai            =   utf8-username
   nai            =/  "@" utf8-realm
   nai            =/  utf8-username "@" utf8-realm

   utf8-username  =  dot-string

   dot-string     = string *("." string)
   string         = 1*utf8-atext

   utf8-atext     =  ALPHA / DIGIT /
                     "!" / "#" /
                     "$" / "%" /
                     "&amp;" / "'" /
                     "*" / "+" /
                     "-" / "/" /
                     "=" / "?" /
                     "^" / "_" /
                     "`" / "{" /
                     "|" / "}" /
                     "~" /
                     UTF8-xtra-char

   utf8-realm     =  1*( label "." ) label

   label          =  utf8-rtext *(ldh-str)
   ldh-str        =  *( utf8-rtext / "-" ) utf8-rtext
   utf8-rtext     =  ALPHA / DIGIT / UTF8-xtra-char

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.3.%20%20NAI%20Length%20Considerations"></a><a class="selflink" href="#section-2.3" id="section-2.3">2.3</a>.  NAI Length Considerations</span>

   Devices handling NAIs MUST support an NAI length of at least
   72 octets.  Devices SHOULD support an NAI length of 253 octets.
   However, the following implementation issues should be considered:

   *  NAI octet length constraints may impose a more severe constraint
      on the number of UTF-8 characters.

   *  NAIs are often transported in the User-Name attribute of the
      Remote Authentication Dial-In User Service (RADIUS) protocol.
      Unfortunately, <a href="./rfc2865#section-5.1">[RFC2865], Section 5.1</a> states that "the ability to
      handle at least 63 octets is recommended."  As a result, it may
      not be possible to transfer NAIs beyond 63 octets through all
      devices.  In addition, since only a single User-Name attribute may



<span class="grey">DeKok                        Standards Track                   [Page 11]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-12"></span>
<span class="grey"><a href="./rfc7542">RFC 7542</a>              The Network Access Identifier             May 2015</span>


      be included in a RADIUS message and the maximum attribute length
      is 253 octets, RADIUS is unable to support NAI lengths beyond
      253 octets.

   *  NAIs can also be transported in the User-Name attribute of
      Diameter [<a href="./rfc6733" title='"Diameter Base Protocol"'>RFC6733</a>], which supports content lengths up to
      2^24 - 9 octets.  As a result, NAIs processed only by Diameter
      nodes can be very long.  However, an NAI transported over Diameter
      may eventually be translated to RADIUS, in which case the above
      limitations will apply.

   *  NAIs may be transported in other protocols.  Each protocol can
      have its own limitations on maximum NAI length.

   The above criteria should permit the widest use and widest possible
   interoperability of the NAI.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.4.%20%20Support%20for%20Username%20Privacy"></a><a class="selflink" href="#section-2.4" id="section-2.4">2.4</a>.  Support for Username Privacy</span>

   Interpretation of the username part of the NAI depends on the realm
   in question.  Therefore, the utf8-username portion SHOULD be treated
   as opaque data when processed by nodes that are not a part of the
   home domain for that realm.

   That is, the only domain that is capable of interpreting the meaning
   of the utf8-username portion of the NAI is the home domain.  Any
   third-party domains cannot form any conclusions about the
   utf8-username and cannot decode it into subfields.  For example, it
   may be used as "firstname.lastname", or it may be entirely digits, or
   it may be a random hex identifier.  There is simply no way (and no
   reason) for any other domain to interpret the utf8-username field as
   having any meaning whatsoever.

   In some situations, NAIs are used together with a separate
   authentication method that can transfer the username part in a more
   secure manner to increase privacy.  In this case, NAIs MAY be
   provided in an abbreviated form by omitting the username part.
   Omitting the username part is RECOMMENDED over using a fixed username
   part, such as "anonymous", since including a fixed username part is
   ambiguous as to whether or not the NAI refers to a single user.
   However, current practice is to use the username "anonymous" instead
   of omitting the username part.  This behavior is also permitted.

   The most common use case of omitting or obfuscating the username part
   is with TLS-based EAP methods such as Tunneled Transport Layer
   Security (TTLS) [<a href="./rfc5281" title='"Extensible Authentication Protocol Tunneled Transport Layer Security Authenticated Protocol Version 0 (EAP-TTLSv0)"'>RFC5281</a>].  Those methods allow for an "outer"
   identifier, which is typically an anonymous "@realm".  This outer
   identifier allows the authentication request to be routed from a



<span class="grey">DeKok                        Standards Track                   [Page 12]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-13"></span>
<span class="grey"><a href="./rfc7542">RFC 7542</a>              The Network Access Identifier             May 2015</span>


   visited domain to a home domain.  At the same time, the username part
   is kept confidential from the visited network.  The protocol provides
   for an "inner" authentication exchange, in which a full identifier is
   used to authenticate a user.

   That scenario offers the best of both worlds.  An anonymous NAI can
   be used to route authentication to the home domain, and the home
   domain has sufficient information to identify and authenticate users.

   However, some protocols do not support authentication methods that
   allow for "inner" and "outer" exchanges.  Those protocols are limited
   to using an identifier that is publicly visible.  It is therefore
   RECOMMENDED that such protocols use ephemeral identifiers.  We
   recognize that this practice is not currently used and will likely be
   difficult to implement.

   Similar to the anonymous user, there may be situations where portions
   of the realm are sensitive.  For those situations, it is RECOMMENDED
   that the sensitive portion of the realm also be omitted (e.g., to use
   "@example.com" instead of "@sensitive.example.com", or
   "anonymous@sensitive.example.com").  The home domain is authoritative
   for users in all subdomains and can (if necessary) route the
   authentication request to the appropriate subsystem within the home
   domain.

   For roaming purposes, it is typically necessary to locate the
   appropriate backend authentication server for the given NAI before
   the authentication conversation can proceed.  As a result,
   authentication routing is impossible unless the realm portion is
   available and is in a well-known format.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.5.%20%20International%20Character%20Sets"></a><a class="selflink" href="#section-2.5" id="section-2.5">2.5</a>.  International Character Sets</span>

   This specification allows both international usernames and realms.
   International usernames are based on the use of Unicode characters,
   encoded as UTF-8.  Internationalization of the username portion of
   the NAI is based on the "Internationalized Email Headers" [<a href="./rfc6532" title='"Internationalized Email Headers"'>RFC6532</a>]
   extensions to the "local-part" portion of email addresses [<a href="./rfc5322" title='"Internet Message Format"'>RFC5322</a>].

   In order to ensure a canonical representation, characters of the
   realm portion in an NAI MUST match the ABNF in this specification as
   well as the requirements specified in [<a href="./rfc5891" title='"Internationalized Domain Names in Applications (IDNA): Protocol"'>RFC5891</a>].  In practice, these
   requirements consist of the following item:

   *  Realms MUST be of the form that can be registered as a Fully
      Qualified Domain Name (FQDN) within the DNS.





<span class="grey">DeKok                        Standards Track                   [Page 13]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-14"></span>
<span class="grey"><a href="./rfc7542">RFC 7542</a>              The Network Access Identifier             May 2015</span>


   This list is significantly shorter and simpler than the list in
   <a href="./rfc4282#section-2.4">Section 2.4 of [RFC4282]</a>.  The form suggested in [<a href="./rfc4282" title='"The Network Access Identifier"'>RFC4282</a>] depended
   on intermediate nodes performing canonicalizations based on
   insufficient information, which meant that the form was not
   canonical.

   Specifying the realm requirement as above means that the requirements
   depend on specifications that are referenced here, rather than copied
   here.  This allows the realm definition to be updated when the
   referenced documents change, without requiring a revision of this
   specification.

   One caveat on the above recommendation is the issues noted in
   [<a href="./rfc6912" title='"Principles for Unicode Code Point Inclusion in Labels in the DNS"'>RFC6912</a>].  That document notes that there are additional
   restrictions around DNS registration that forbid some code points
   from being valid in a DNS U-label.  These restrictions cannot be
   expressed algorithmically.

   For this specification, that caveat means the following:
   Realms not matching the above ABNF are not valid NAIs.  However, some
   realms that do match the ABNF are still invalid NAIs.  That is,
   matching the ABNF is a necessary, but not sufficient, requirement for
   an NAI.

   In general, the above requirement means following the requirements
   specified in [<a href="./rfc5891" title='"Internationalized Domain Names in Applications (IDNA): Protocol"'>RFC5891</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.6.%20%20The%20Normalization%20Process"></a><a class="selflink" href="#section-2.6" id="section-2.6">2.6</a>.  The Normalization Process</span>

   Conversion to Unicode as well as normalization SHOULD be performed by
   edge systems (e.g., laptops, desktops, smart phones, etc.) that take
   "local" text as input.  These edge systems are best suited to
   determine the user's intent and can best convert from "local" text to
   a normalized form.

   Other AAA systems such as proxies do not have access to locale and
   character set information that is available to edge systems.
   Therefore, they may not always be able to convert local input to
   Unicode.

   That is, all processing of NAIs from "local" character sets and
   locales to UTF-8 SHOULD be performed by edge systems, prior to the
   NAIs entering the AAA system.  Inside of a AAA system, NAIs are sent
   over the wire in their canonical form, and this canonical form is
   used for all NAI and/or realm comparisons.






<span class="grey">DeKok                        Standards Track                   [Page 14]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-15"></span>
<span class="grey"><a href="./rfc7542">RFC 7542</a>              The Network Access Identifier             May 2015</span>


   Copying of localized text into fields that can subsequently be placed
   into the RADIUS User-Name attribute is problematic.  This practice
   can result in a AAA proxy encountering non-UTF-8 characters within
   what it expects to be an NAI.  An example of this requirement is
   <a href="./rfc3579#section-2.1">Section 2.1 of [RFC3579]</a>, which states:

      the NAS MUST copy the contents of the Type-Data field of the
      EAP-Response/Identity received from the peer into the User-Name
      attribute

   As a result, AAA proxies expect the contents of the
   EAP-Response/Identity sent by an EAP supplicant to consist of UTF-8
   characters, not localized text.  Using localized text in AAA username
   or identity fields means that realm routing becomes difficult or
   impossible.

   In contrast to <a href="./rfc4282#section-2.4">Section 2.4 of [RFC4282]</a>, AAA systems are now expected
   to perform NAI comparisons, matching, and AAA routing based on the
   NAI as it is received.  This specification provides a canonical
   representation, ensures that intermediate AAA systems such as proxies
   are not required to perform translations, and can be expected to work
   through AAA systems that are unaware of international character sets.

   In an ideal world, the following requirements would be widely
   implemented:

   *  Edge systems using "localized" text SHOULD normalize the NAI prior
      to it being used as an identifier in an authentication protocol.

   *  AAA systems SHOULD NOT normalize the NAI, as they may not have
      sufficient information to perform the normalization.

   There are issues with this approach, however.

<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.6.1.%20%20Issues%20with%20the%20Normalization%20Process"></a><a class="selflink" href="#section-2.6.1" id="section-2.6.1">2.6.1</a>.  Issues with the Normalization Process</span>

   The requirements in the preceding section are not implemented today.
   For example, most EAP implementations use a user identifier that is
   passed to them from some other local system.  This identifier is
   treated as an opaque blob and is placed as is into the EAP Identity
   field.  Any subsequent system that receives that identifier is
   assumed to be able to understand and process it.

   This opaque blob unfortunately can contain localized text, which
   means that the AAA systems have to process that text.






<span class="grey">DeKok                        Standards Track                   [Page 15]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-16"></span>
<span class="grey"><a href="./rfc7542">RFC 7542</a>              The Network Access Identifier             May 2015</span>


   These limitations have the following theoretical and practical
   implications:

   *  Edge systems used today generally do not normalize the NAI.

   *  Therefore, AAA systems SHOULD attempt to normalize the NAI.

   The suggestions above contradict the suggestions in the previous
   section.  This is the reality of imperfect protocols.

   Where the user identifier can be normalized, or determined to be in
   normal form, the normal form MUST be used as the NAI.  In all other
   circumstances, the user identifier MUST NOT be treated as an NAI.
   That data is still, however, a user identifier.  AAA systems MUST NOT
   fail authentication simply because the user identifier is not an NAI.

   That is, when the realm portion of the NAI is not recognized by a AAA
   server, it SHOULD try to normalize the NAI into NFC form.  That
   normalized form can then be used to see if the realm matches a known
   realm.  If no match is found, the original form of the NAI SHOULD be
   used in all subsequent processing.

   The AAA server may also convert realms to Punycode and perform all
   realm comparisons on the resulting Punycode strings.  This conversion
   follows the recommendations above but may have different operational
   effects and failure modes.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.7.%20%20Use%20in%20Other%20Protocols"></a><a class="selflink" href="#section-2.7" id="section-2.7">2.7</a>.  Use in Other Protocols</span>

   As noted earlier, the NAI format can be used in other, non-AAA
   protocols.  It is RECOMMENDED that the definition given here be used
   unchanged.  Using other definitions for user identifiers may hinder
   interoperability, along with the user's ability to authenticate
   successfully.  It is RECOMMENDED that protocols requiring the use of
   a user identifier use the NAI format.

   This document cannot require other protocols to use the NAI format
   for user identifiers.  Their needs are unknown and, at this time,
   unknowable.  This document suggests that interoperability and
   inter-domain authentication are useful and should be encouraged.

   Where a protocol is 8-bit clean, it can likely transport the NAI as
   is, without further modification.








<span class="grey">DeKok                        Standards Track                   [Page 16]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-17"></span>
<span class="grey"><a href="./rfc7542">RFC 7542</a>              The Network Access Identifier             May 2015</span>


   Where a protocol is not 8-bit clean, it cannot transport the NAI as
   is.  Instead, this document presumes that a protocol-specific
   transport layer takes care of encoding the NAI on input to the
   protocol and decoding it when the NAI exits the protocol.  The
   encoded or escaped version of the NAI is not a valid NAI and MUST NOT
   be presented to the AAA system.

   For example, HTTP carries user identifiers but escapes the '.'
   character as "%2E" (among others).  When HTTP is used to transport
   the NAI "fred@example.com", the data as transported will be in the
   form "fred@example%2Ecom".  That data exists only within HTTP and has
   no relevance to any AAA system.

   Any comparison, validation, or use of the NAI MUST be done on its
   unescaped (i.e., utf8-clean) form.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.8.%20%20Using%20the%20NAI%20Format%20for%20Other%20Identifiers"></a><a class="selflink" href="#section-2.8" id="section-2.8">2.8</a>.  Using the NAI Format for Other Identifiers</span>

   As discussed in <a href="#section-1">Section 1</a>, above, it is RECOMMENDED that the NAI
   format be used as the standard format for user identifiers.  This
   section discusses that use in more detail.

   It is often useful to create new identifiers for use in specific
   contexts.  These identifiers may have a number of different
   properties, most of which are unimportant to this document.  The
   goal of this document is to create identifiers that are to be in a
   well-known format and that will have namespaces.  The NAI format fits
   these requirements.

   One example of such use is the "private user identity", which is an
   identifier defined by the 3rd Generation Partnership Project (3GPP).
   That identifier is used to uniquely identify the user to the network.
   The identifier is used for authorization, authentication, accounting,
   administration, etc.  The "private user identity" is globally unique
   and is defined by the home network operator.  The format of the
   identifier is explicitly the NAI, as stated by Section 13.3 of
   [<a href="#ref-3GPP" title='"Numbering, addressing and Identification"'>3GPP</a>]:

      The private user identity shall take the form of an NAI, and shall
      have the form username@realm as specified in clause 2.1 of IETF
      <a href="./rfc4282">RFC 4282</a>

   For 3GPP, the "username" portion is a unique identifier that is
   derived from device-specific information.  The "realm" portion is
   composed of information about the home network, followed by the base
   string "3gppnetwork.org" (e.g.,
   234150999999999@ims.mnc015.mcc234.3gppnetwork.org).




<span class="grey">DeKok                        Standards Track                   [Page 17]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-18"></span>
<span class="grey"><a href="./rfc7542">RFC 7542</a>              The Network Access Identifier             May 2015</span>


   This format as defined by 3GPP ensures that the identifier is
   globally unique, as it is based on the "3gppnetwork.org" domain.  It
   ensures that the "realm" portion is specific to a particular home
   network (or organization), via the "ims.mnc015.mcc234" prefix to the
   realm.  Finally, it ensures that the "username" portion follows a
   well-known format.

   This document suggests that the NAI format be used for all new
   specifications and/or protocols where a user identifier is required.
   Where the username portions need to be created with subfields, a
   well-known and documented method, as has been done with 3GPP, is
   preferred to ad hoc methods.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.%20%20Routing%20inside%20of%20AAA%20Systems"></a><a class="selflink" href="#section-3" id="section-3">3</a>.  Routing inside of AAA Systems</span>

   Many AAA systems use the "utf8-realm" portion of the NAI to route
   requests within a AAA proxy network.  The semantics of this operation
   involves a logical AAA routing table, where the "utf8-realm" portion
   acts as a key, and the values stored in the table are one or more
   "next hop" AAA servers.

   Intermediate nodes MUST use the "utf8-realm" portion of the NAI
   without modification to perform this lookup.  As noted earlier,
   intermediate nodes may not have access to the same locale information
   as the system that injected the NAI into the AAA routing systems.
   Therefore, almost all "case insensitive" comparisons can be wrong.
   Where the "utf8-realm" is entirely ASCII, current AAA systems
   sometimes perform case-insensitive matching on realms.  This method
   MAY be continued, as it has been shown to work in practice.

   Many existing non-AAA systems have user identifiers that are similar
   in format to the NAI but that are not compliant with this
   specification.  For example, they may use non-NFC form, or they may
   have multiple "@" characters in the user identifier.  Intermediate
   nodes SHOULD normalize non-NFC identifiers to NFC, prior to looking
   up the "utf8-realm" in the logical routing table.  Intermediate nodes
   MUST NOT modify the identifiers that they forward.  The data as
   entered by the user is inviolate.

   The "utf8-realm" provisioned in the logical AAA routing table SHOULD
   be provisioned to the proxy prior to it receiving any AAA traffic.
   The "utf8-realm" SHOULD be supplied by the "next hop" or "home"
   system that also supplies the routing information necessary for
   packets to reach the next hop.







<span class="grey">DeKok                        Standards Track                   [Page 18]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-19"></span>
<span class="grey"><a href="./rfc7542">RFC 7542</a>              The Network Access Identifier             May 2015</span>


   This "next hop" information may be any of, or all of, the following
   information: IP address, port, RADIUS shared secret, TLS certificate,
   DNS host name, or instruction to use dynamic DNS discovery (i.e.,
   look up a record in the "utf8-realm" domain).  This list is not
   exhaustive and may be extended by future specifications.

   It is RECOMMENDED to use the entirety of the "utf8-realm" for the
   routing decisions.  However, AAA systems MAY use a portion of the
   "utf8-realm" portion, so long as that portion is a valid "utf8-realm"
   and is handled as above.  For example, routing "fred@example.com" to
   a "com" destination is forbidden, because "com" is not a valid
   "utf8-realm".  However, routing "fred@sales.example.com" to the
   "example.com" destination is permissible.

   Another reason to forbid the use of a single label (e.g.,
   "fred@sales") is that many non-AAA systems treat a single label as
   being a local identifier within their realm.  That is, a user logging
   in as "fred@sales" to a domain "example.com" would be treated as if
   the NAI was instead "fred@sales.example.com".  Permitting the use of
   a single label would mean changing the interpretation and meaning of
   a single label, which cannot be done.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.1.%20%20Compatibility%20with%20Email%20Usernames"></a><a class="selflink" href="#section-3.1" id="section-3.1">3.1</a>.  Compatibility with Email Usernames</span>

   As proposed in this document, the Network Access Identifier is of the
   form "user@realm".  Please note that while the user portion of the
   NAI is based on the "Internet Message Format" [<a href="./rfc5322" title='"Internet Message Format"'>RFC5322</a>] "local-part"
   portion of an email address as extended by "Internationalized Email
   Headers" [<a href="./rfc6532" title='"Internationalized Email Headers"'>RFC6532</a>], it has been modified for the purposes of
   <a href="#section-2.2">Section 2.2</a>.  It does not permit quoted text along with "folding" or
   "non-folding" whitespace that is commonly used in email addresses.
   As such, the NAI is not necessarily equivalent to usernames used in
   email.

   However, it is a common practice to use email addresses as user
   identifiers in AAA systems.  The ABNF in <a href="#section-2.2">Section 2.2</a> is defined to be
   close to the "addr-spec" portion of [<a href="./rfc5322" title='"Internet Message Format"'>RFC5322</a>] as extended by
   [<a href="./rfc6532" title='"Internationalized Email Headers"'>RFC6532</a>], while still being compatible with [<a href="./rfc4282" title='"The Network Access Identifier"'>RFC4282</a>].

   In contrast to <a href="./rfc4282#section-2.5">Section 2.5 of [RFC4282]</a>, this document states that
   the internationalization requirements for NAIs and email addresses
   are substantially similar.  The NAI and email identifiers may be the
   same, and both need to be entered by the user and/or the operator
   supplying network access to that user.  There is therefore good
   reason for the internationalization requirements to be similar.






<span class="grey">DeKok                        Standards Track                   [Page 19]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-20"></span>
<span class="grey"><a href="./rfc7542">RFC 7542</a>              The Network Access Identifier             May 2015</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.2.%20%20Compatibility%20with%20DNS"></a><a class="selflink" href="#section-3.2" id="section-3.2">3.2</a>.  Compatibility with DNS</span>

   The "utf8-realm" portion of the NAI is intended to be compatible with
   Internationalized Domain Names (IDNs) [<a href="./rfc5890" title='"Internationalized Domain Names for Applications (IDNA): Definitions and Document Framework"'>RFC5890</a>].  As defined above,
   the "utf8-realm" portion as transported within an 8-bit clean
   protocol such as RADIUS and EAP can contain any valid UTF-8
   character.  There is therefore no reason for a NAS to convert the
   "utf8-realm" portion of an NAI into Punycode encoding form [<a href="./rfc3492" title='"Punycode: A Bootstring encoding of Unicode for Internationalized Domain Names in Applications (IDNA)"'>RFC3492</a>]
   prior to placing the NAI into a RADIUS User-Name attribute.

   The NAI does not make a distinction between A-labels and U-labels, as
   those are terms specific to DNS.  It is instead an IDNA-valid label,
   as per the first item in <a href="./rfc5890#section-2.3.2.1">Section 2.3.2.1 of [RFC5890]</a>.  As noted in
   that section, the term "IDNA-valid label" encompasses both "A-label"
   and "U-label".

   When the realm portion of the NAI is used as the basis for name
   resolution, it may be necessary to convert internationalized realm
   names to Punycode [<a href="./rfc3492" title='"Punycode: A Bootstring encoding of Unicode for Internationalized Domain Names in Applications (IDNA)"'>RFC3492</a>] encoding form as described in [<a href="./rfc5891" title='"Internationalized Domain Names in Applications (IDNA): Protocol"'>RFC5891</a>].
   As noted in <a href="./rfc6055#section-2">Section 2 of [RFC6055]</a>, resolver Application Programming
   Interfaces (APIs) are not necessarily DNS specific, so conversion to
   Punycode needs to be done carefully:

   Applications that convert an IDN to A-label form before calling (for
   example) getaddrinfo() will result in name resolution failures if the
   Punycode name is directly used in such protocols.  Having libraries
   or protocols to convert from A-labels to the encoding scheme defined
   by the protocol (e.g., UTF-8) would require changes to APIs and/or
   servers, which Internationalized Domain Names for Applications (IDNA)
   was intended to avoid.

   As a result, applications SHOULD NOT assume that non-ASCII names are
   resolvable using the public DNS and blindly convert them to A-labels
   without knowledge of what protocol will be selected by the name
   resolution library.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.3.%20%20Realm%20Construction"></a><a class="selflink" href="#section-3.3" id="section-3.3">3.3</a>.  Realm Construction</span>

   The home realm usually appears in the "utf8-realm" portion of the
   NAI, but in some cases a different realm can be used.  This may be
   useful, for instance, when the home realm is reachable only via
   intermediate proxies.

   Such usage may prevent interoperability unless the parties involved
   have a mutual agreement that the usage is allowed.  In particular,
   NAIs MUST NOT use a different realm than the home realm unless the
   sender has explicit knowledge that (a) the specified other realm is
   available and (b) the other realm supports such usage.  The sender



<span class="grey">DeKok                        Standards Track                   [Page 20]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-21"></span>
<span class="grey"><a href="./rfc7542">RFC 7542</a>              The Network Access Identifier             May 2015</span>


   may determine the fulfillment of these conditions through a database,
   dynamic discovery, or other means not specified here.  Note that the
   first condition is affected by roaming, as the availability of the
   other realm may depend on the user's location or the desired
   application.

   The use of the home realm MUST be the default unless otherwise
   configured.

<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.3.1.%20%20Historical%20Practices"></a><a class="selflink" href="#section-3.3.1" id="section-3.3.1">3.3.1</a>.  Historical Practices</span>

   Some AAA systems have historically used NAI modifications with
   multiple "prefix" and "suffix" decorations to perform explicit
   routing through multiple proxies inside of a AAA network.

   In RADIUS-based environments, the use of decorated NAI is NOT
   RECOMMENDED for the following reasons:

   *  Using explicit routing paths is fragile and is unresponsive to
      changes in the network due to servers going up or down or to
      changing business relationships.

   *  There is no RADIUS routing protocol, meaning that routing paths
      have to be communicated "out of band" to all intermediate AAA
      nodes, and also to all edge systems (e.g., supplicants) expecting
      to obtain network access.

   *  Using explicit routing paths requires thousands, if not millions,
      of edge systems to be updated with new path information when a AAA
      routing path changes.  This adds huge expense for updates that
      would be better done at only a few AAA systems in the network.

   *  Manual updates to RADIUS paths are expensive, time-consuming, and
      prone to error.

   *  Creating compatible formats for the NAI is difficult when locally
      defined "prefixes" and "suffixes" conflict with similar practices
      elsewhere in the network.  These conflicts mean that connecting
      two networks may be impossible in some cases, as there is no way
      for packets to be routed properly in a way that meets all
      requirements at all intermediate proxies.

   *  Leveraging the DNS name system for realm names establishes a
      globally unique namespace for realms.







<span class="grey">DeKok                        Standards Track                   [Page 21]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-22"></span>
<span class="grey"><a href="./rfc7542">RFC 7542</a>              The Network Access Identifier             May 2015</span>


   In summary, network practices and capabilities have changed
   significantly since NAIs were first overloaded to define AAA routes
   through a network.  While manually managed explicit path routing was
   once useful, the time has come for better methods to be used.

   Notwithstanding the above recommendations, the above practice is
   widely used for Diameter routing [<a href="./rfc5729" title='"Clarifications on the Routing of Diameter Requests Based on the Username and the Realm"'>RFC5729</a>].  The routes described
   there are managed automatically, for both credential provisioning and
   routing updates.  Those routes also exist within a particular
   framework (typically 3G), where membership is controlled and system
   behavior is standardized.  There are no known issues with using
   explicit routing in such an environment.

   However, if decorated identifiers are used, such as:

      homerealm.example.org!user@otherrealm.example.net

   then the part before the (non-escaped) '!' MUST be a "utf8-realm" as
   defined in the ABNF in <a href="#section-2.2">Section 2.2</a>.  When receiving such an
   identifier, the "otherrealm.example.net" system MUST convert the
   identifier to "user@homerealm.example.org" before forwarding the
   request.  The forwarding system MUST then apply normal AAA routing
   for the transaction, based on the updated identifier.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.4.%20%20Examples"></a><a class="selflink" href="#section-3.4" id="section-3.4">3.4</a>.  Examples</span>

   Examples of valid Network Access Identifiers include the following:

           bob
           joe@example.com
           fred@foo-9.example.com
           jack@3rd.depts.example.com
           fred.smith@example.com
           fred_smith@example.com
           fred$@example.com
           fred=?#$&amp;*+-/^smith@example.com
           nancy@eng.example.net
           eng.example.net!nancy@example.net
           eng%nancy@example.net
           @privatecorp.example.net
           \(user\)@example.net

   An additional valid NAI is the following -- shown here as a
   hex string, as this document can only contain ASCII characters:

           626f 6240 ceb4 cebf ceba ceb9 cebc ceae 2e63 6f6d





<span class="grey">DeKok                        Standards Track                   [Page 22]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-23"></span>
<span class="grey"><a href="./rfc7542">RFC 7542</a>              The Network Access Identifier             May 2015</span>


   Examples of invalid Network Access Identifiers include the following:

           fred@example
           fred@example_9.com
           fred@example.net@example.net
           fred.@example.net
           eng:nancy@example.net
           eng;nancy@example.net
           (user)@example.net
           &lt;nancy&gt;@example.net

   One example given in [<a href="./rfc4282" title='"The Network Access Identifier"'>RFC4282</a>] is still permitted by the ABNF, but it
   is NOT RECOMMENDED because of the use of the Punycode [<a href="./rfc3492" title='"Punycode: A Bootstring encoding of Unicode for Internationalized Domain Names in Applications (IDNA)"'>RFC3492</a>]
   encoding form for what is now a valid UTF-8 string:

           alice@xn--tmonesimerkki-bfbb.example.net

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/4.%20%20Security%20Considerations"></a><a class="selflink" href="#section-4" id="section-4">4</a>.  Security Considerations</span>

   Since an NAI reveals the home affiliation of a user, it may assist an
   attacker in further probing the username space.  Typically, this
   problem is of most concern in protocols that transmit the username in
   clear-text across the Internet, such as in RADIUS [<a href="./rfc2865" title='"Remote Authentication Dial In User Service (RADIUS)"'>RFC2865</a>]
   [<a href="./rfc2866" title='"RADIUS Accounting"'>RFC2866</a>].  In order to prevent snooping of the username, protocols
   may use confidentiality services provided by protocols transporting
   them, such as RADIUS protected by IPsec [<a href="./rfc3579" title='"RADIUS (Remote Authentication Dial In User Service) Support For Extensible Authentication Protocol (EAP)"'>RFC3579</a>] or Diameter
   protected by TLS [<a href="./rfc6733" title='"Diameter Base Protocol"'>RFC6733</a>].

   This specification adds the possibility of hiding the username part
   in the NAI, by omitting it.  As discussed in <a href="#section-2.4">Section 2.4</a>, this is
   possible only when NAIs are used together with a separate
   authentication method that can transfer the username in a secure
   manner.  In some cases, application-specific privacy mechanisms have
   also been used with NAIs.  For instance, some EAP methods apply
   method-specific pseudonyms in the username part of the NAI [<a href="./rfc3748" title='"Extensible Authentication Protocol (EAP)"'>RFC3748</a>].
   While neither of these approaches can protect the realm part, their
   advantage over transport protection is that the privacy of the
   username is protected, even through intermediate nodes such as NASes.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/4.1.%20%20Correlation%20of%20Identities%20over%20Time%20and%20Protocols"></a><a class="selflink" href="#section-4.1" id="section-4.1">4.1</a>.  Correlation of Identities over Time and Protocols</span>

   The recommendations in Sections <a href="#section-2.7">2.7</a> and <a href="#section-2.8">2.8</a> for using the NAI in
   other protocols have implications for privacy.  Any attacker who is
   capable of observing traffic containing the NAI can track the user
   and can correlate his activity across time and across multiple
   protocols.  The authentication credentials therefore SHOULD be





<span class="grey">DeKok                        Standards Track                   [Page 23]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-24"></span>
<span class="grey"><a href="./rfc7542">RFC 7542</a>              The Network Access Identifier             May 2015</span>


   transported over channels that permit private communications, or
   multiple identifiers SHOULD be used, so that user tracking is
   impossible.

   It is RECOMMENDED that user privacy be enhanced by configuring
   multiple identifiers for one user.  These identifiers can be changed
   over time, in order to make user tracking more difficult for a
   malicious observer.  However, provisioning and management of the
   identifiers may be difficult to do in practice -- a likely reason why
   multiple identifiers are rarely used today.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/4.2.%20%20Multiple%20Identifiers"></a><a class="selflink" href="#section-4.2" id="section-4.2">4.2</a>.  Multiple Identifiers</span>

   <a href="#section-1.3">Section 1.3</a> states that multiple identifier formats allow attackers
   to make contradictory claims without being detected.  This statement
   deserves further discussion.

   <a href="#section-2.4">Section 2.4</a> discussed "inner" and "outer" identifiers in the context
   of TTLS [<a href="./rfc5281" title='"Extensible Authentication Protocol Tunneled Transport Layer Security Authenticated Protocol Version 0 (EAP-TTLSv0)"'>RFC5281</a>].  A close reading of that specification shows there
   is no requirement that the inner and outer identifiers be in any way
   related.  That is, it is perfectly valid to use "@example.com" for an
   outer identifier and "user@example.org" as an inner identifier.  The
   authentication request will then be routed to "example.com", which
   will likely be unable to authenticate "user@example.org".

   Even worse, a misconfiguration of "example.com" means that it may in
   turn proxy the inner authentication request to the "example.org"
   domain.  Such cross-domain authentication is highly problematic, and
   there are few good reasons to allow it.

   It is therefore RECOMMENDED that systems that permit anonymous
   "outer" identifiers require that the "inner" domain be the same as,
   or a subdomain of, the "outer" domain.  An authentication request
   using disparate realms is a security violation, and the request
   SHOULD be rejected.

   The situation gets worse when multiple protocols are involved.  The
   TTLS protocol permits Microsoft CHAP (MS-CHAP) [<a href="./rfc2433" title='"Microsoft PPP CHAP Extensions"'>RFC2433</a>] to be
   carried inside of the TLS tunnel.  MS-CHAP defines its own
   identifier, which is encapsulated inside of the MS-CHAP exchange.
   That identifier is not required to be any particular format, is not
   required to be in UTF-8, and, in practice, can be one of many unknown
   character sets.  There is no way in practice to determine which
   character set was used for that identifier.







<span class="grey">DeKok                        Standards Track                   [Page 24]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-25"></span>
<span class="grey"><a href="./rfc7542">RFC 7542</a>              The Network Access Identifier             May 2015</span>


   The result is that the "outer" EAP Identity carried by TTLS is likely
   to not even share the same character set as the "inner" identifier
   used by MS-CHAP.  The two identifiers are entirely independent and
   fundamentally incomparable.

   Such a protocol design is NOT RECOMMENDED.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.%20%20Administration%20of%20Names"></a><a class="selflink" href="#section-5" id="section-5">5</a>.  Administration of Names</span>

   In order to avoid creating any new administrative procedures,
   administration of the NAI realm namespace piggybacks on the
   administration of the DNS namespace.

   NAI realm names are required to be unique, and the rights to use a
   given NAI realm for roaming purposes are obtained coincident with
   acquiring the rights to use a particular Fully Qualified Domain Name
   (FQDN).  Those wishing to use an NAI realm name should first acquire
   the rights to use the corresponding FQDN.  Administrators MUST NOT
   publicly use an NAI realm without first owning the corresponding
   FQDN.  Private use of unowned NAI realms within an administrative
   domain is allowed, though it is RECOMMENDED that example names be
   used, such as "example.com".

   Note that the use of an FQDN as the realm name does not require use
   of the DNS for location of the authentication server.  While Diameter
   [<a href="./rfc6733" title='"Diameter Base Protocol"'>RFC6733</a>] supports the use of DNS for location of authentication
   servers, existing RADIUS implementations typically use proxy
   configuration files in order to locate authentication servers within
   a domain and perform authentication routing.  The implementations
   described in [<a href="./rfc2194" title='"Review of Roaming Implementations"'>RFC2194</a>] did not use DNS for location of the
   authentication server within a domain.  Similarly, existing
   implementations have not found a need for dynamic routing protocols
   or propagation of global routing information.  Note also that there
   is no requirement that the NAI represent a valid email address.

















<span class="grey">DeKok                        Standards Track                   [Page 25]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-26"></span>
<span class="grey"><a href="./rfc7542">RFC 7542</a>              The Network Access Identifier             May 2015</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/6.%20%20References"></a><a class="selflink" href="#section-6" id="section-6">6</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/6.1.%20%20Normative%20References"></a><a class="selflink" href="#section-6.1" id="section-6.1">6.1</a>.  Normative References</span>

   [<a id="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="https://www.rfc-editor.org/bcp/bcp14">BCP 14</a>, <a href="./rfc2119">RFC 2119</a>, March 1997,
              &lt;<a href="http://www.rfc-editor.org/info/rfc2119">http://www.rfc-editor.org/info/rfc2119</a>&gt;.

   [<a id="ref-RFC3629">RFC3629</a>]  Yergeau, F., "UTF-8, a transformation format of
              ISO 10646", STD 63, <a href="./rfc3629">RFC 3629</a>, November 2003,
              &lt;<a href="http://www.rfc-editor.org/info/rfc3629">http://www.rfc-editor.org/info/rfc3629</a>&gt;.

   [<a id="ref-RFC5198">RFC5198</a>]  Klensin, J. and M. Padlipsky, "Unicode Format for Network
              Interchange", <a href="./rfc5198">RFC 5198</a>, March 2008,
              &lt;<a href="http://www.rfc-editor.org/info/rfc5198">http://www.rfc-editor.org/info/rfc5198</a>&gt;.

   [<a id="ref-RFC5234">RFC5234</a>]  Crocker, D., Ed., and P. Overell, "Augmented BNF for
              Syntax Specifications: ABNF", STD 68, <a href="./rfc5234">RFC 5234</a>,
              January 2008, &lt;<a href="http://www.rfc-editor.org/info/rfc5234">http://www.rfc-editor.org/info/rfc5234</a>&gt;.

   [<a id="ref-RFC5890">RFC5890</a>]  Klensin, J., "Internationalized Domain Names for
              Applications (IDNA): Definitions and Document Framework",
              <a href="./rfc5890">RFC 5890</a>, August 2010,
              &lt;<a href="http://www.rfc-editor.org/info/rfc5890">http://www.rfc-editor.org/info/rfc5890</a>&gt;.

   [<a id="ref-RFC5891">RFC5891</a>]  Klensin, J., "Internationalized Domain Names in
              Applications (IDNA): Protocol", <a href="./rfc5891">RFC 5891</a>, August 2010,
              &lt;<a href="http://www.rfc-editor.org/info/rfc5891">http://www.rfc-editor.org/info/rfc5891</a>&gt;.

   [<a id="ref-RFC6365">RFC6365</a>]  Hoffman, P. and J. Klensin, "Terminology Used in
              Internationalization in the IETF", <a href="https://www.rfc-editor.org/bcp/bcp166">BCP 166</a>, <a href="./rfc6365">RFC 6365</a>,
              September 2011, &lt;<a href="http://www.rfc-editor.org/info/rfc6365">http://www.rfc-editor.org/info/rfc6365</a>&gt;.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/6.2.%20%20Informative%20References"></a><a class="selflink" href="#section-6.2" id="section-6.2">6.2</a>.  Informative References</span>

   [<a id="ref-RFC2194">RFC2194</a>]  Aboba, B., Lu, J., Alsop, J., Ding, J., and W. Wang,
              "Review of Roaming Implementations", <a href="./rfc2194">RFC 2194</a>,
              September 1997, &lt;<a href="http://www.rfc-editor.org/info/rfc2194">http://www.rfc-editor.org/info/rfc2194</a>&gt;.

   [<a id="ref-RFC2341">RFC2341</a>]  Valencia, A., Littlewood, M., and T. Kolar, "Cisco
              Layer Two Forwarding (Protocol) "L2F"", <a href="./rfc2341">RFC 2341</a>,
              May 1998, &lt;<a href="http://www.rfc-editor.org/info/rfc2341">http://www.rfc-editor.org/info/rfc2341</a>&gt;.

   [<a id="ref-RFC2433">RFC2433</a>]  Zorn, G. and S. Cobb, "Microsoft PPP CHAP Extensions",
              <a href="./rfc2433">RFC 2433</a>, October 1998,
              &lt;<a href="http://www.rfc-editor.org/info/rfc2433">http://www.rfc-editor.org/info/rfc2433</a>&gt;.





<span class="grey">DeKok                        Standards Track                   [Page 26]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-27"></span>
<span class="grey"><a href="./rfc7542">RFC 7542</a>              The Network Access Identifier             May 2015</span>


   [<a id="ref-RFC2637">RFC2637</a>]  Hamzeh, K., Pall, G., Verthein, W., Taarud, J., Little,
              W., and G. Zorn, "Point-to-Point Tunneling Protocol
              (PPTP)", <a href="./rfc2637">RFC 2637</a>, July 1999,
              &lt;<a href="http://www.rfc-editor.org/info/rfc2637">http://www.rfc-editor.org/info/rfc2637</a>&gt;.

   [<a id="ref-RFC2661">RFC2661</a>]  Townsley, W., Valencia, A., Rubens, A., Pall, G., Zorn,
              G., and B. Palter, "Layer Two Tunneling Protocol "L2TP"",
              <a href="./rfc2661">RFC 2661</a>, August 1999,
              &lt;<a href="http://www.rfc-editor.org/info/rfc2661">http://www.rfc-editor.org/info/rfc2661</a>&gt;.

   [<a id="ref-RFC2865">RFC2865</a>]  Rigney, C., Willens, S., Rubens, A., and W. Simpson,
              "Remote Authentication Dial In User Service (RADIUS)",
              <a href="./rfc2865">RFC 2865</a>, June 2000,
              &lt;<a href="http://www.rfc-editor.org/info/rfc2865">http://www.rfc-editor.org/info/rfc2865</a>&gt;.

   [<a id="ref-RFC2866">RFC2866</a>]  Rigney, C., "RADIUS Accounting", <a href="./rfc2866">RFC 2866</a>, June 2000,
              &lt;<a href="http://www.rfc-editor.org/info/rfc2866">http://www.rfc-editor.org/info/rfc2866</a>&gt;.

   [<a id="ref-RFC3492">RFC3492</a>]  Costello, A., "Punycode: A Bootstring encoding of Unicode
              for Internationalized Domain Names in Applications
              (IDNA)", <a href="./rfc3492">RFC 3492</a>, March 2003,
              &lt;<a href="http://www.rfc-editor.org/info/rfc3492">http://www.rfc-editor.org/info/rfc3492</a>&gt;.

   [<a id="ref-RFC3579">RFC3579</a>]  Aboba, B. and P. Calhoun, "RADIUS (Remote Authentication
              Dial In User Service) Support For Extensible
              Authentication Protocol (EAP)", <a href="./rfc3579">RFC 3579</a>, September 2003,
              &lt;<a href="http://www.rfc-editor.org/info/rfc3579">http://www.rfc-editor.org/info/rfc3579</a>&gt;.

   [<a id="ref-RFC3748">RFC3748</a>]  Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H.
              Levkowetz, Ed., "Extensible Authentication Protocol
              (EAP)", <a href="./rfc3748">RFC 3748</a>, June 2004,
              &lt;<a href="http://www.rfc-editor.org/info/rfc3748">http://www.rfc-editor.org/info/rfc3748</a>&gt;.

   [<a id="ref-RFC4282">RFC4282</a>]  Aboba, B., Beadles, M., Arkko, J., and P. Eronen, "The
              Network Access Identifier", <a href="./rfc4282">RFC 4282</a>, December 2005,
              &lt;<a href="http://www.rfc-editor.org/info/rfc4282">http://www.rfc-editor.org/info/rfc4282</a>&gt;.

   [<a id="ref-RFC4301">RFC4301</a>]  Kent, S. and K. Seo, "Security Architecture for the
              Internet Protocol", <a href="./rfc4301">RFC 4301</a>, December 2005,
              &lt;<a href="http://www.rfc-editor.org/info/rfc4301">http://www.rfc-editor.org/info/rfc4301</a>&gt;.

   [<a id="ref-RFC5281">RFC5281</a>]  Funk, P. and S. Blake-Wilson, "Extensible Authentication
              Protocol Tunneled Transport Layer Security Authenticated
              Protocol Version 0 (EAP-TTLSv0)", <a href="./rfc5281">RFC 5281</a>, August 2008,
              &lt;<a href="http://www.rfc-editor.org/info/rfc5281">http://www.rfc-editor.org/info/rfc5281</a>&gt;.

   [<a id="ref-RFC5322">RFC5322</a>]  Resnick, P., Ed., "Internet Message Format", <a href="./rfc5322">RFC 5322</a>,
              October 2008, &lt;<a href="http://www.rfc-editor.org/info/rfc5322">http://www.rfc-editor.org/info/rfc5322</a>&gt;.



<span class="grey">DeKok                        Standards Track                   [Page 27]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-28"></span>
<span class="grey"><a href="./rfc7542">RFC 7542</a>              The Network Access Identifier             May 2015</span>


   [<a id="ref-RFC5335">RFC5335</a>]  Yang, A., Ed., "Internationalized Email Headers",
              <a href="./rfc5335">RFC 5335</a>, September 2008,
              &lt;<a href="http://www.rfc-editor.org/info/rfc5335">http://www.rfc-editor.org/info/rfc5335</a>&gt;.

   [<a id="ref-RFC5729">RFC5729</a>]  Korhonen, J., Ed., Jones, M., Morand, L., and T. Tsou,
              "Clarifications on the Routing of Diameter Requests Based
              on the Username and the Realm", <a href="./rfc5729">RFC 5729</a>, December 2009,
              &lt;<a href="http://www.rfc-editor.org/info/rfc5729">http://www.rfc-editor.org/info/rfc5729</a>&gt;.

   [<a id="ref-RFC6055">RFC6055</a>]  Thaler, D., Klensin, J., and S. Cheshire, "IAB Thoughts on
              Encodings for Internationalized Domain Names", <a href="./rfc6055">RFC 6055</a>,
              February 2011, &lt;<a href="http://www.rfc-editor.org/info/rfc6055">http://www.rfc-editor.org/info/rfc6055</a>&gt;.

   [<a id="ref-RFC6532">RFC6532</a>]  Yang, A., Steele, S., and N. Freed, "Internationalized
              Email Headers", <a href="./rfc6532">RFC 6532</a>, February 2012,
              &lt;<a href="http://www.rfc-editor.org/info/rfc6532">http://www.rfc-editor.org/info/rfc6532</a>&gt;.

   [<a id="ref-RFC6733">RFC6733</a>]  Fajardo, V., Ed., Arkko, J., Loughney, J., and G. Zorn,
              Ed., "Diameter Base Protocol", <a href="./rfc6733">RFC 6733</a>, October 2012,
              &lt;<a href="http://www.rfc-editor.org/info/rfc6733">http://www.rfc-editor.org/info/rfc6733</a>&gt;.

   [<a id="ref-RFC6912">RFC6912</a>]  Sullivan, A., Thaler, D., Klensin, J., and O. Kolkman,
              "Principles for Unicode Code Point Inclusion in Labels in
              the DNS", <a href="./rfc6912">RFC 6912</a>, April 2013,
              &lt;<a href="http://www.rfc-editor.org/info/rfc6912">http://www.rfc-editor.org/info/rfc6912</a>&gt;.

   [<a id="ref-EDUROAM">EDUROAM</a>]  "eduroam (EDUcation ROAMing)", &lt;<a href="http://eduroam.org">http://eduroam.org</a>&gt;.

   [<a id="ref-3GPP">3GPP</a>]     3GPP, "Numbering, addressing and Identification", 3GPP TS
              23.003, Release 12, July 2014,
              &lt;<a href="ftp://ftp.3gpp.org/Specs/archive/23_series/23.003/">ftp://ftp.3gpp.org/Specs/archive/23_series/23.003/</a>&gt;.




















<span class="grey">DeKok                        Standards Track                   [Page 28]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-29"></span>
<span class="grey"><a href="./rfc7542">RFC 7542</a>              The Network Access Identifier             May 2015</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/Appendix%20A.%20%20Changes%20from%20RFC%204282"></a><a class="selflink" href="#appendix-A" id="appendix-A">Appendix A</a>.  Changes from <a href="./rfc4282">RFC 4282</a></span>

   This document contains the following updates with respect to the
   previous NAI definition in <a href="./rfc4282">RFC 4282</a> [<a href="./rfc4282" title='"The Network Access Identifier"'>RFC4282</a>]:

   *  The formal syntax in <a href="#section-2.1">Section 2.1</a> has been updated to forbid
      non-UTF-8 characters (e.g., characters with the "high bit" set).

   *  The formal syntax in <a href="./rfc4282#section-2.1">Section 2.1 of [RFC4282]</a> has been updated to
      allow UTF-8 in the "realm" portion of the NAI.

   *  The formal syntax in <a href="./rfc4282#section-2.1">Section 2.1 of [RFC4282]</a> applied to the NAI
      after it was "internationalized" via the ToAscii function.  The
      contents of the NAI before it was "internationalized" were left
      indeterminate.  This document updates the formal syntax to define
      an internationalized form of the NAI and forbids the use of the
      ToAscii function for NAI "internationalization".

   *  The grammar for the user and realm portion is based on a
      combination of the "nai" defined in <a href="./rfc4282#section-2.1">Section 2.1 of [RFC4282]</a> and
      the "utf8-addr-spec" defined in <a href="./rfc5335#section-4.4">Section 4.4 of [RFC5335]</a>.

   *  All use of the ToAscii function has been moved to normal
      requirements on DNS implementations when realms are used as the
      basis for DNS lookups.  This involves no changes to the existing
      DNS infrastructure.

   *  The discussions on internationalized character sets in <a href="./rfc4282#section-2.4">Section 2.4
      of [RFC4282]</a> have been updated.  The suggestion to use the ToAscii
      function for realm comparisons has been removed.  No AAA system
      has implemented these suggestions, so this change should have no
      operational impact.

   *  The "Routing inside of AAA Systems" section is new in this
      document.  The concept of a "local AAA routing table" is also new,
      although it accurately describes the functionality of widespread
      implementations.

   *  The "Compatibility with EMail Usernames" and "Compatibility with
      DNS" sections have been revised and updated.  The Punycode
      transformation is suggested to be used only when a realm name is
      used for DNS lookups, and even then the function is only used by a
      resolving API on the local system, and even then it is recommended
      that only the home network perform this conversion.







<span class="grey">DeKok                        Standards Track                   [Page 29]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-30"></span>
<span class="grey"><a href="./rfc7542">RFC 7542</a>              The Network Access Identifier             May 2015</span>


   *  The "Realm Construction" section has been updated to note that
      editing of the NAI is NOT RECOMMENDED.

   *  The "Examples" section has been updated to remove the instance of
      the IDN being converted to ASCII.  This behavior is now forbidden.

Acknowledgments

   The initial text for this document was [<a href="./rfc4282" title='"The Network Access Identifier"'>RFC4282</a>], which was then
   heavily edited.  The original authors of [<a href="./rfc4282" title='"The Network Access Identifier"'>RFC4282</a>] were Bernard
   Aboba, Mark A. Beadles, Jari Arkko, and Pasi Eronen.

Author's Address

   Alan DeKok
   The FreeRADIUS Server Project

   EMail: aland@freeradius.org

































DeKok                        Standards Track                   [Page 30]
</pre>
</body></html>