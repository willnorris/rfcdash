<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 9463: DHCP and Router Advertisement Options for the Discovery of Network-designated Resolvers (DNR)</title>
<meta content="Mohamed Boucadair" name="author"/>
<meta content="Tirumaleswar Reddy.K" name="author"/>
<meta content="Dan Wing" name="author"/>
<meta content="Neil Cook" name="author"/>
<meta content="Tommy Jensen" name="author"/>
<meta content="
       This document specifies new DHCP and IPv6 Router Advertisement options
      to discover encrypted DNS resolvers (e.g., DNS over HTTPS, DNS over TLS,
      and DNS over QUIC). Particularly, it allows a host to learn an
      Authentication Domain Name together with a list of IP addresses and a
      set of service parameters to reach such encrypted DNS resolvers. 
    " name="description"/>
<meta content="xml2rfc 3.18.2" name="generator"/>
<meta content="DNS" name="keyword"/>
<meta content="service resolution" name="keyword"/>
<meta content="encryption" name="keyword"/>
<meta content="service discovery" name="keyword"/>
<meta content="service provider" name="keyword"/>
<meta content="network provider" name="keyword"/>
<meta content="automation" name="keyword"/>
<meta content="DoH" name="keyword"/>
<meta content="DoT" name="keyword"/>
<meta content="DoQ" name="keyword"/>
<meta content="9463" name="rfc.number"/>
<!-- Generator version information:
  xml2rfc 3.18.2
    Python 3.9.15
    ConfigArgParse 1.5.3
    google-i18n-address 3.0.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.0
    platformdirs 3.8.0
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.28.0
    setuptools 44.1.1
    six 1.16.0
    wcwidth 0.2.5
    weasyprint 56.1
-->
<link href="rfc9463.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
  overflow-wrap: break-word;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef,
.iref + a[href].internal {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
blockquote > *:last-child {
  margin-bottom: 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://datatracker.ietf.org/doc/draft-ietf-add-dnr-16" rel="prev"/>
  <link href="https://dx.doi.org/10.17487/rfc9463" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  </head>
<body class="xml2rfc">
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9463</td>
<td class="center">DNR</td>
<td class="right">November 2023</td>
</tr></thead>
<tfoot><tr>
<td class="left">Boucadair, et al.</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc9463">9463</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2023-11">November 2023</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">M. Boucadair, <span class="editor">Ed.</span>
</div>
<div class="org">Orange</div>
</div>
<div class="author">
      <div class="author-name">T. Reddy.K, <span class="editor">Ed.</span>
</div>
<div class="org">Nokia</div>
</div>
<div class="author">
      <div class="author-name">D. Wing</div>
<div class="org">Cloud Software Group</div>
</div>
<div class="author">
      <div class="author-name">N. Cook</div>
<div class="org">Open-Xchange</div>
</div>
<div class="author">
      <div class="author-name">T. Jensen</div>
<div class="org">Microsoft</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9463</h1>
<h1 id="title">DHCP and Router Advertisement Options for the Discovery of Network-designated Resolvers (DNR)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">This document specifies new DHCP and IPv6 Router Advertisement options
      to discover encrypted DNS resolvers (e.g., DNS over HTTPS, DNS over TLS,
      and DNS over QUIC). Particularly, it allows a host to learn an
      Authentication Domain Name together with a list of IP addresses and a
      set of service parameters to reach such encrypted DNS resolvers.<a class="pilcrow" href="#section-abstract-1">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a class="pilcrow" href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9463">https://www.rfc-editor.org/info/rfc9463</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2023 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">▲</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p class="keepWithNext" id="section-toc.1-1.1.1"><a class="auto internal xref" href="#section-1">1</a>.  <a class="internal xref" href="#name-introduction">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p class="keepWithNext" id="section-toc.1-1.2.1"><a class="auto internal xref" href="#section-2">2</a>.  <a class="internal xref" href="#name-terminology">Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a class="auto internal xref" href="#section-3">3</a>.  <a class="internal xref" href="#name-overview">Overview</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a class="auto internal xref" href="#section-3.1">3.1</a>.  <a class="internal xref" href="#name-configuration-data-for-encr">Configuration Data for Encrypted DNS</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.1">
                    <p class="keepWithNext" id="section-toc.1-1.3.2.1.2.1.1"><a class="auto internal xref" href="#section-3.1.1">3.1.1</a>.  <a class="internal xref" href="#name-adn-as-reference-identifier">ADN as Reference Identifier for DNS Authentication</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.2">
                    <p id="section-toc.1-1.3.2.1.2.2.1"><a class="auto internal xref" href="#section-3.1.2">3.1.2</a>.  <a class="internal xref" href="#name-avoiding-dependency-on-exte">Avoiding Dependency on External Resolvers</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.3">
                    <p id="section-toc.1-1.3.2.1.2.3.1"><a class="auto internal xref" href="#section-3.1.3">3.1.3</a>.  <a class="internal xref" href="#name-single-vs-multiple-ip-addre">Single vs. Multiple IP Addresses</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.4">
                    <p id="section-toc.1-1.3.2.1.2.4.1"><a class="auto internal xref" href="#section-3.1.4">3.1.4</a>.  <a class="internal xref" href="#name-why-not-separate-options-fo">Why Not Separate Options for the ADN and IP Addresses?</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.5">
                    <p id="section-toc.1-1.3.2.1.2.5.1"><a class="auto internal xref" href="#section-3.1.5">3.1.5</a>.  <a class="internal xref" href="#name-service-parameters">Service Parameters</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.6">
                    <p id="section-toc.1-1.3.2.1.2.6.1"><a class="auto internal xref" href="#section-3.1.6">3.1.6</a>.  <a class="internal xref" href="#name-adn-only-mode">ADN-Only Mode</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.7">
                    <p id="section-toc.1-1.3.2.1.2.7.1"><a class="auto internal xref" href="#section-3.1.7">3.1.7</a>.  <a class="internal xref" href="#name-ordering-of-encrypted-dns-o">Ordering of Encrypted DNS Options</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.8">
                    <p id="section-toc.1-1.3.2.1.2.8.1"><a class="auto internal xref" href="#section-3.1.8">3.1.8</a>.  <a class="internal xref" href="#name-dnr-validation-checks">DNR Validation Checks</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.9">
                    <p id="section-toc.1-1.3.2.1.2.9.1"><a class="auto internal xref" href="#section-3.1.9">3.1.9</a>.  <a class="internal xref" href="#name-dnr-information-using-other">DNR Information Using Other Provisioning Mechanisms</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a class="auto internal xref" href="#section-3.2">3.2</a>.  <a class="internal xref" href="#name-handling-configuration-data">Handling Configuration Data Conflicts</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a class="auto internal xref" href="#section-3.3">3.3</a>.  <a class="internal xref" href="#name-validating-discovered-resol">Validating Discovered Resolvers</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a class="auto internal xref" href="#section-3.4">3.4</a>.  <a class="internal xref" href="#name-multihoming-considerations">Multihoming Considerations</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="auto internal xref" href="#section-4">4</a>.  <a class="internal xref" href="#name-dhcpv6-encrypted-dns-option">DHCPv6 Encrypted DNS Option</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a class="auto internal xref" href="#section-4.1">4.1</a>.  <a class="internal xref" href="#name-option-format">Option Format</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a class="auto internal xref" href="#section-4.2">4.2</a>.  <a class="internal xref" href="#name-dhcpv6-client-behavior">DHCPv6 Client Behavior</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="auto internal xref" href="#section-5">5</a>.  <a class="internal xref" href="#name-dhcpv4-encrypted-dns-option">DHCPv4 Encrypted DNS Option</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a class="auto internal xref" href="#section-5.1">5.1</a>.  <a class="internal xref" href="#name-option-format-2">Option Format</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a class="auto internal xref" href="#section-5.2">5.2</a>.  <a class="internal xref" href="#name-dhcpv4-client-behavior">DHCPv4 Client Behavior</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="auto internal xref" href="#section-6">6</a>.  <a class="internal xref" href="#name-ipv6-ra-encrypted-dns-optio">IPv6 RA Encrypted DNS Option</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a class="auto internal xref" href="#section-6.1">6.1</a>.  <a class="internal xref" href="#name-option-format-3">Option Format</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a class="auto internal xref" href="#section-6.2">6.2</a>.  <a class="internal xref" href="#name-ipv6-host-behavior">IPv6 Host Behavior</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="auto internal xref" href="#section-7">7</a>.  <a class="internal xref" href="#name-security-considerations">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a class="auto internal xref" href="#section-7.1">7.1</a>.  <a class="internal xref" href="#name-spoofing-attacks">Spoofing Attacks</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a class="auto internal xref" href="#section-7.2">7.2</a>.  <a class="internal xref" href="#name-deletion-attacks">Deletion Attacks</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a class="auto internal xref" href="#section-7.3">7.3</a>.  <a class="internal xref" href="#name-passive-attacks">Passive Attacks</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a class="auto internal xref" href="#section-7.4">7.4</a>.  <a class="internal xref" href="#name-wireless-security-authentic">Wireless Security - Authentication Attacks</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="auto internal xref" href="#section-8">8</a>.  <a class="internal xref" href="#name-privacy-considerations">Privacy Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="auto internal xref" href="#section-9">9</a>.  <a class="internal xref" href="#name-iana-considerations">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a class="auto internal xref" href="#section-9.1">9.1</a>.  <a class="internal xref" href="#name-dhcpv6-option">DHCPv6 Option</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a class="auto internal xref" href="#section-9.2">9.2</a>.  <a class="internal xref" href="#name-dhcpv4-option">DHCPv4 Option</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a class="auto internal xref" href="#section-9.3">9.3</a>.  <a class="internal xref" href="#name-neighbor-discovery-option">Neighbor Discovery Option</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a class="auto internal xref" href="#section-10">10</a>. <a class="internal xref" href="#name-references">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a class="auto internal xref" href="#section-10.1">10.1</a>.  <a class="internal xref" href="#name-normative-references">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a class="auto internal xref" href="#section-10.2">10.2</a>.  <a class="internal xref" href="#name-informative-references">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a class="auto internal xref" href="#appendix-A"></a><a class="internal xref" href="#name-acknowledgments">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a class="auto internal xref" href="#appendix-B"></a><a class="internal xref" href="#name-contributors">Contributors</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a class="auto internal xref" href="#appendix-C"></a><a class="internal xref" href="#name-authors-addresses">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="intro">
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">This document focuses on the discovery of encrypted DNS resolvers that are using protocols such as
      DNS over HTTPS (DoH) <span>[<a class="cite xref" href="#RFC8484">RFC8484</a>]</span>, DNS over TLS (DoT) <span>[<a class="cite xref" href="#RFC7858">RFC7858</a>]</span>, or DNS over QUIC (DoQ) <span>[<a class="cite xref" href="#RFC9250">RFC9250</a>]</span> in
      local networks.<a class="pilcrow" href="#section-1-1">¶</a></p>
<p id="section-1-2">In particular, this document specifies how a local encrypted DNS
      resolver can be discovered by connected hosts by means of DHCPv4 <span>[<a class="cite xref" href="#RFC2132">RFC2132</a>]</span>, DHCPv6 <span>[<a class="cite xref" href="#RFC8415">RFC8415</a>]</span>, and IPv6 Router
      Advertisement (RA) options <span>[<a class="cite xref" href="#RFC4861">RFC4861</a>]</span>. These options are
      designed to convey the following information: the DNS Authentication
      Domain Name (ADN), a list of IP addresses, and a set of service
      parameters. This procedure is called Discovery of Network-designated
      Resolvers (DNR).<a class="pilcrow" href="#section-1-2">¶</a></p>
<p id="section-1-3">The options defined in this document can be deployed in a variety of
      deployments (e.g., local networks with Customer Premises Equipment
      (CPEs) that may or may not be managed by an Internet Service Provider
      (ISP), or local networks with or without DNS forwarders). Providing an inventory of such deployments is beyond the scope of this document.<a class="pilcrow" href="#section-1-3">¶</a></p>
<p id="section-1-4">Resolver selection considerations are out of scope. Likewise,
      policies (including any interactions with users) are out of scope.<a class="pilcrow" href="#section-1-4">¶</a></p>
</section>
</div>
<div id="notation">
<section id="section-2">
      <h2 id="name-terminology">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-terminology">Terminology</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>",
       "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>",
       "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>",
       "<span class="bcp14">SHOULD NOT</span>",
       "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
       "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document
       are to be interpreted as described in BCP 14
       <span>[<a class="cite xref" href="#RFC2119">RFC2119</a>]</span> <span>[<a class="cite xref" href="#RFC8174">RFC8174</a>]</span> when, and only
       when, they appear in all capitals, as shown here.<a class="pilcrow" href="#section-2-1">¶</a></p>
<p id="section-2-2">This document makes use of the terms defined in <span>[<a class="cite xref" href="#RFC8499">RFC8499</a>]</span>. The following additional terms are used:<a class="pilcrow" href="#section-2-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2-3">
        <dt id="section-2-3.1">Authentication Domain Name (ADN):</dt>
        <dd id="section-2-3.2" style="margin-left: 1.5em">Refers to a domain
          name that is used by a DNS client to authenticate a DNS
          resolver.<a class="pilcrow" href="#section-2-3.2">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.3">ADN-only mode:</dt>
        <dd id="section-2-3.4" style="margin-left: 1.5em">Refers to a DNS discovery mode where
          only the ADN of the DNS resolver is retrieved. See <a class="auto internal xref" href="#adn-only">Section 3.1.6</a>.<a class="pilcrow" href="#section-2-3.4">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.5">Do53:</dt>
        <dd id="section-2-3.6" style="margin-left: 1.5em">Refers to unencrypted DNS.<a class="pilcrow" href="#section-2-3.6">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.7">DNR:</dt>
        <dd id="section-2-3.8" style="margin-left: 1.5em">Refers to the procedure called Discovery of Network-designated
          Resolvers.<a class="pilcrow" href="#section-2-3.8">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.9">Encrypted DNS:</dt>
        <dd id="section-2-3.10" style="margin-left: 1.5em">Refers to a scheme where DNS exchanges
          are transported over an encrypted channel. Examples include
          DoT, DoH, and DoQ.<a class="pilcrow" href="#section-2-3.10">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.11">Encrypted DNS resolver:</dt>
        <dd id="section-2-3.12" style="margin-left: 1.5em">Refers to a DNS resolver that
          supports any encrypted DNS scheme.<a class="pilcrow" href="#section-2-3.12">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.13">Encrypted DNS options:</dt>
        <dd id="section-2-3.14" style="margin-left: 1.5em">Refers to the options defined
          in Sections <a class="auto internal xref" href="#DHCPv6">4</a>, <a class="auto internal xref" href="#DHCP">5</a>, and <a class="auto internal xref" href="#RA">6</a>.<a class="pilcrow" href="#section-2-3.14">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.15">DHCP:</dt>
        <dd id="section-2-3.16" style="margin-left: 1.5em">Refers to both DHCPv4 and DHCPv6.<a class="pilcrow" href="#section-2-3.16">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<div id="RI">
<section id="section-3">
      <h2 id="name-overview">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-overview">Overview</a>
      </h2>
<p id="section-3-1">This document describes how a DNS client can discover local encrypted
      DNS resolvers using DHCP (Sections <a class="auto internal xref" href="#DHCPv6">4</a> and <a class="auto internal xref" href="#DHCP">5</a>) and
      Neighbor Discovery protocol (<a class="auto internal xref" href="#RA">Section 6</a>) Encrypted DNS
      options.<a class="pilcrow" href="#section-3-1">¶</a></p>
<p id="section-3-2">These options configure an ADN, a list of IP
      addresses, and a set of service parameters of the encrypted DNS
      resolver. More information about the design of these options is provided
      in the following subsections.<a class="pilcrow" href="#section-3-2">¶</a></p>
<div id="rationale">
<section id="section-3.1">
        <h3 id="name-configuration-data-for-encr">
<a class="section-number selfRef" href="#section-3.1">3.1. </a><a class="section-name selfRef" href="#name-configuration-data-for-encr">Configuration Data for Encrypted DNS</a>
        </h3>
<section id="section-3.1.1">
          <h4 id="name-adn-as-reference-identifier">
<a class="section-number selfRef" href="#section-3.1.1">3.1.1. </a><a class="section-name selfRef" href="#name-adn-as-reference-identifier">ADN as Reference Identifier for DNS Authentication</a>
          </h4>
<p id="section-3.1.1-1">In order to allow for a PKIX-based authentication of the
          encrypted DNS resolver to the DNS client, the Encrypted DNS options
          are designed to always include an ADN. This
          ADN is presented as a reference identifier for DNS authentication
          purposes. This design accommodates the current best practices for
          issuing certificates as per <span><a class="relref" href="https://rfc-editor.org/rfc/rfc6125#section-1.7.2">Section 1.7.2</a> of [<a class="cite xref" href="#RFC6125">RFC6125</a>]</span>:<a class="pilcrow" href="#section-3.1.1-1">¶</a></p>
<aside id="section-3.1.1-2">
            <p id="section-3.1.1-2.1">Some certification authorities issue server
            certificates based on IP addresses, but preliminary evidence
            indicates that such certificates are a very small percentage (less
            than 1%) of issued certificates.<a class="pilcrow" href="#section-3.1.1-2.1">¶</a></p>
</aside>
</section>
<section id="section-3.1.2">
          <h4 id="name-avoiding-dependency-on-exte">
<a class="section-number selfRef" href="#section-3.1.2">3.1.2. </a><a class="section-name selfRef" href="#name-avoiding-dependency-on-exte">Avoiding Dependency on External Resolvers</a>
          </h4>
<p id="section-3.1.2-1">To avoid adding a dependency on another server to resolve the
          ADN, the Encrypted DNS options return the IP address(es) to locate
          an encrypted DNS resolver. These encrypted DNS resolvers may be
          hosted on the same IP address or distinct IP addresses. Such a decision is
          deployment specific.<a class="pilcrow" href="#section-3.1.2-1">¶</a></p>
<p id="section-3.1.2-2">In order to optimize the size of discovery messages when all DNS
          resolvers terminate on the same IP address, early draft versions of this
          document considered relying upon the discovery mechanisms specified
          in <span>[<a class="cite xref" href="#RFC2132">RFC2132</a>]</span>, <span>[<a class="cite xref" href="#RFC3646">RFC3646</a>]</span>, and <span>[<a class="cite xref" href="#RFC8106">RFC8106</a>]</span> to retrieve a list of IP addresses to reach
          their DNS resolvers. Nevertheless, this approach requires a client
          that supports more than one encrypted DNS protocol (e.g., DoH and
          DoT) to probe that list of IP addresses. To avoid such probing,
          the options defined in Sections <a class="auto internal xref" href="#DHCPv6">4</a>, <a class="auto internal xref" href="#DHCP">5</a>, and
          <a class="auto internal xref" href="#RA">6</a> associate an encrypted DNS
          protocol with an IP address. No probing is required in such a
          design.<a class="pilcrow" href="#section-3.1.2-2">¶</a></p>
</section>
<section id="section-3.1.3">
          <h4 id="name-single-vs-multiple-ip-addre">
<a class="section-number selfRef" href="#section-3.1.3">3.1.3. </a><a class="section-name selfRef" href="#name-single-vs-multiple-ip-addre">Single vs. Multiple IP Addresses</a>
          </h4>
<p id="section-3.1.3-1">A list of IP addresses to reach an encrypted DNS resolver may be
          returned in an Encrypted DNS option to accommodate current
          deployments relying upon primary and backup resolvers. Also, DNR can
          be used in contexts where other DNS redundancy schemes (e.g.,
          anycast as discussed in <span><a class="internal xref" href="#RFC4786">BCP 126</a> [<a class="cite xref" href="#RFC4786">RFC4786</a>]</span>) are used.<a class="pilcrow" href="#section-3.1.3-1">¶</a></p>
<p id="section-3.1.3-2">Whether one or more IP addresses are returned in an Encrypted DNS
          option is deployment specific. For example, a router embedding a
          recursive server or a forwarder has to include one single IP address
          pointing to one of its LAN-facing interfaces. Typically, this IP
          address can be a private IPv4 address, a Link-Local address, an IPv6
          Unique Local Address (ULA), or a Global Unicast Address
          (GUA).<a class="pilcrow" href="#section-3.1.3-2">¶</a></p>
<p id="section-3.1.3-3">If multiple IP addresses are to be returned in an Encrypted DNS
          option, these addresses are returned, ordered by preference, for use by the
          client.<a class="pilcrow" href="#section-3.1.3-3">¶</a></p>
</section>
<section id="section-3.1.4">
          <h4 id="name-why-not-separate-options-fo">
<a class="section-number selfRef" href="#section-3.1.4">3.1.4. </a><a class="section-name selfRef" href="#name-why-not-separate-options-fo">Why Not Separate Options for the ADN and IP Addresses?</a>
          </h4>
<p id="section-3.1.4-1">A single option is used to convey both the ADN and IP addresses.
          Otherwise, a means to correlate an IP address conveyed in an option
          with an ADN conveyed in another option will be required if, for
          example, more than one ADN is supported by the network.<a class="pilcrow" href="#section-3.1.4-1">¶</a></p>
</section>
<section id="section-3.1.5">
          <h4 id="name-service-parameters">
<a class="section-number selfRef" href="#section-3.1.5">3.1.5. </a><a class="section-name selfRef" href="#name-service-parameters">Service Parameters</a>
          </h4>
<p id="section-3.1.5-1">Because distinct encrypted DNS protocols (e.g., DoT, DoH, and
          DoQ) may be provisioned by a network and some of these
          protocols may make use of customized port numbers instead of default
          port numbers, the Encrypted DNS options are designed to return a set of
          service parameters. These parameters are encoded following the same
          rules for encoding SvcParams using the wire format specified in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc9460#section-2.2">Section 2.2</a> of [<a class="cite xref" href="#RFC9460">RFC9460</a>]</span>. This encoding approach may
          increase the size of the options, but it has the merit of relying
          upon an existing IANA registry and, thus, accommodating new
          encrypted DNS protocols and service parameters that may be defined
          in the future.<a class="pilcrow" href="#section-3.1.5-1">¶</a></p>
<p id="section-3.1.5-2">The following service parameters <span class="bcp14">MUST</span> be supported by a DNR
          implementation:<a class="pilcrow" href="#section-3.1.5-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.1.5-3">
            <dt id="section-3.1.5-3.1">alpn:</dt>
            <dd id="section-3.1.5-3.2" style="margin-left: 1.5em">Used to indicate the set of supported
              protocols (<span><a class="relref" href="https://rfc-editor.org/rfc/rfc9460#section-7.1">Section 7.1</a> of [<a class="cite xref" href="#RFC9460">RFC9460</a>]</span>).<a class="pilcrow" href="#section-3.1.5-3.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.1.5-3.3">port:</dt>
            <dd id="section-3.1.5-3.4" style="margin-left: 1.5em">Used to indicate the target port number for
              the encrypted DNS connection (<span><a class="relref" href="https://rfc-editor.org/rfc/rfc9460#section-7.2">Section 7.2</a> of [<a class="cite xref" href="#RFC9460">RFC9460</a>]</span>).<a class="pilcrow" href="#section-3.1.5-3.4">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-3.1.5-4">In addition, the following service parameter is <span class="bcp14">RECOMMENDED</span> to be
          supported by a DNR implementation:<a class="pilcrow" href="#section-3.1.5-4">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.1.5-5">
            <dt id="section-3.1.5-5.1">dohpath:</dt>
            <dd id="section-3.1.5-5.2" style="margin-left: 1.5em">Used to supply a relative DoH URI
              Template (<span><a class="relref" href="https://rfc-editor.org/rfc/rfc9461#section-5.1">Section 5.1</a> of [<a class="cite xref" href="#RFC9461">RFC9461</a>]</span>).<a class="pilcrow" href="#section-3.1.5-5.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
<div id="adn-only">
<section id="section-3.1.6">
          <h4 id="name-adn-only-mode">
<a class="section-number selfRef" href="#section-3.1.6">3.1.6. </a><a class="section-name selfRef" href="#name-adn-only-mode">ADN-Only Mode</a>
          </h4>
<p id="section-3.1.6-1">The provisioning mode in which an ADN, a list of IP addresses,
          and a set of service parameters of the encrypted DNS resolver are
          supplied to a host <span class="bcp14">SHOULD</span> be used because the Encrypted DNS options
          are self-contained and do not require any additional DNS queries.
          The reader may refer to <span>[<a class="cite xref" href="#RFC7969">RFC7969</a>]</span> for an overview of
          advanced capabilities that are supported by DHCP servers to populate
          configuration data (e.g., issue DNS queries).<a class="pilcrow" href="#section-3.1.6-1">¶</a></p>
<p id="section-3.1.6-2">In contexts where putting additional complexity on requesting
          hosts is acceptable, returning an ADN only can be considered. The
          supplied ADN will be passed to a local resolution library (a DNS
          client, typically), which will then issue Service Binding (SVCB)
          queries <span>[<a class="cite xref" href="#RFC9461">RFC9461</a>]</span>. These SVCB queries
          can be sent to the discovered encrypted DNS resolver itself or to
          the network-designated Do53 resolver. Note that this mode may be
          subject to active attacks, which can be mitigated by DNSSEC.<a class="pilcrow" href="#section-3.1.6-2">¶</a></p>
<aside id="section-3.1.6-3">
            <p id="section-3.1.6-3.1">How an ADN is passed to a local resolution library
            is implementation specific.<a class="pilcrow" href="#section-3.1.6-3.1">¶</a></p>
</aside>
</section>
</div>
<section id="section-3.1.7">
          <h4 id="name-ordering-of-encrypted-dns-o">
<a class="section-number selfRef" href="#section-3.1.7">3.1.7. </a><a class="section-name selfRef" href="#name-ordering-of-encrypted-dns-o">Ordering of Encrypted DNS Options</a>
          </h4>
<p id="section-3.1.7-1">The DHCP options defined in Sections <a class="auto internal xref" href="#DHCPv6">4</a> and <a class="auto internal xref" href="#DHCP">5</a>
          follow the option ordering guidelines in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc7227#section-17">Section 17</a> of [<a class="cite xref" href="#RFC7227">RFC7227</a>]</span>.<a class="pilcrow" href="#section-3.1.7-1">¶</a></p>
<p id="section-3.1.7-2">Likewise, the RA option (<a class="auto internal xref" href="#RA">Section 6</a>)
          adheres to the recommendations in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc4861#section-9">Section 9</a> of [<a class="cite xref" href="#RFC4861">RFC4861</a>]</span>.<a class="pilcrow" href="#section-3.1.7-2">¶</a></p>
</section>
<div id="VC">
<section id="section-3.1.8">
          <h4 id="name-dnr-validation-checks">
<a class="section-number selfRef" href="#section-3.1.8">3.1.8. </a><a class="section-name selfRef" href="#name-dnr-validation-checks">DNR Validation Checks</a>
          </h4>
<p id="section-3.1.8-1">On receipt of an Encrypted DNS option, the DHCP client (or IPv6
          host) makes the following validation checks:<a class="pilcrow" href="#section-3.1.8-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.8-2.1">The ADN is present and encoded as per <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8415#section-10">Section 10</a> of [<a class="cite xref" href="#RFC8415">RFC8415</a>]</span>.<a class="pilcrow" href="#section-3.1.8-2.1">¶</a>
</li>
            <li class="normal" id="section-3.1.8-2.2">
              <p id="section-3.1.8-2.2.1">If additional data is supplied:<a class="pilcrow" href="#section-3.1.8-2.2.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.8-2.2.2.1">The service parameters are encoded following the rules
                  specified in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc9460#section-2.2">Section 2.2</a> of [<a class="cite xref" href="#RFC9460">RFC9460</a>]</span>.<a class="pilcrow" href="#section-3.1.8-2.2.2.1">¶</a>
</li>
                <li class="normal" id="section-3.1.8-2.2.2.2">The option includes at least one valid IP address.<a class="pilcrow" href="#section-3.1.8-2.2.2.2">¶</a>
</li>
                <li class="normal" id="section-3.1.8-2.2.2.3">The service parameters do not include "ipv4hint" or
                  "ipv6hint" parameters.<a class="pilcrow" href="#section-3.1.8-2.2.2.3">¶</a>
</li>
              </ul>
</li>
          </ul>
<p id="section-3.1.8-3">If any of the checks fail, the receiver discards the received
          Encrypted DNS option.<a class="pilcrow" href="#section-3.1.8-3">¶</a></p>
</section>
</div>
<section id="section-3.1.9">
          <h4 id="name-dnr-information-using-other">
<a class="section-number selfRef" href="#section-3.1.9">3.1.9. </a><a class="section-name selfRef" href="#name-dnr-information-using-other">DNR Information Using Other Provisioning Mechanisms</a>
          </h4>
<p id="section-3.1.9-1">The provisioning mechanisms specified in this document may not be
          available in specific networks (e.g., some cellular networks
          exclusively use Protocol Configuration Options (PCOs) <span>[<a class="cite xref" href="#TS.24008">TS.24008</a>]</span>) or may not be suitable in some contexts (e.g., where
          secure discovery is needed). Other mechanisms may be considered in
          these contexts for the provisioning of encrypted DNS resolvers. It
          is <span class="bcp14">RECOMMENDED</span> that at least the following DNR information be made
          available to a requesting host:<a class="pilcrow" href="#section-3.1.9-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.9-2.1">A service priority whenever the discovery mechanism does not
              rely on implicit ordering if multiple instances of the encrypted
              DNS are used.<a class="pilcrow" href="#section-3.1.9-2.1">¶</a>
</li>
            <li class="normal" id="section-3.1.9-2.2">An ADN. This parameter is
              mandatory.<a class="pilcrow" href="#section-3.1.9-2.2">¶</a>
</li>
            <li class="normal" id="section-3.1.9-2.3">A list of IP addresses to locate the encrypted DNS
              resolver.<a class="pilcrow" href="#section-3.1.9-2.3">¶</a>
</li>
            <li class="normal" id="section-3.1.9-2.4">A set of service parameters.<a class="pilcrow" href="#section-3.1.9-2.4">¶</a>
</li>
          </ul>
</section>
</section>
</div>
<section id="section-3.2">
        <h3 id="name-handling-configuration-data">
<a class="section-number selfRef" href="#section-3.2">3.2. </a><a class="section-name selfRef" href="#name-handling-configuration-data">Handling Configuration Data Conflicts</a>
        </h3>
<p id="section-3.2-1">If encrypted DNS resolvers are discovered by a host using both RA and
        DHCP, the rules discussed in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8106#section-5.3.1">Section 5.3.1</a> of [<a class="cite xref" href="#RFC8106">RFC8106</a>]</span> <span class="bcp14">MUST</span> be followed.<a class="pilcrow" href="#section-3.2-1">¶</a></p>
<p id="section-3.2-2">DHCP/RA options to discover encrypted DNS resolvers (including DoH
        URI Templates) takes precedence over Discovery of Designated Resolvers
        (DDR) <span>[<a class="cite xref" href="#RFC9462">RFC9462</a>]</span>, since DDR uses Do53 to an
        external DNS resolver, which is susceptible to both internal and
        external attacks whereas DHCP/RA is typically protected using the
        mechanisms discussed in <a class="auto internal xref" href="#spoof">Section 7.1</a>.<a class="pilcrow" href="#section-3.2-2">¶</a></p>
<p id="section-3.2-3">If a client learns both Do53 and encrypted DNS resolvers from the
        same network, and absent explicit configuration otherwise, it is
        <span class="bcp14">RECOMMENDED</span> that the client use the encrypted DNS resolvers for that
        network. If the client cannot establish an authenticated and encrypted
        connection with the encrypted DNS resolver, it may fall back to using
        the Do53 resolver.<a class="pilcrow" href="#section-3.2-3">¶</a></p>
</section>
<section id="section-3.3">
        <h3 id="name-validating-discovered-resol">
<a class="section-number selfRef" href="#section-3.3">3.3. </a><a class="section-name selfRef" href="#name-validating-discovered-resol">Validating Discovered Resolvers</a>
        </h3>
<p id="section-3.3-1">This section describes a set of validation checks to confirm that
        an encrypted DNS resolver matches what is provided using DNR (e.g.,
        DHCP or RA). Such validation checks do not intend to validate the
        security of the DNR provisioning mechanisms or the user's trust
        relationship to the network.<a class="pilcrow" href="#section-3.3-1">¶</a></p>
<p id="section-3.3-2">If the local DNS client supports one of the discovered encrypted
        DNS protocols identified by Application-Layer Protocol Negotiation
        (ALPN) protocol identifiers (or another service parameter that indicates
        some other protocol disambiguation mechanism), the DNS client
        establishes an encrypted DNS session following the service priority of
        the discovered encrypted resolvers.<a class="pilcrow" href="#section-3.3-2">¶</a></p>
<p id="section-3.3-3">The DNS client verifies the connection based on PKIX validation
        <span>[<a class="cite xref" href="#RFC5280">RFC5280</a>]</span> of the DNS resolver certificate and uses the
        validation techniques as described in <span>[<a class="cite xref" href="#RFC6125">RFC6125</a>]</span> to
        compare the ADN conveyed in the Encrypted DNS
        options to the certificate provided (see <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8310#section-8.1">Section 8.1</a> of [<a class="cite xref" href="#RFC8310">RFC8310</a>]</span> for more details). The DNS client uses the default
        system or application PKI trust anchors unless configured otherwise to
        use explicit trust anchors. ALPN-related considerations can be found
        in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc9460#section-7.1">Section 7.1</a> of [<a class="cite xref" href="#RFC9460">RFC9460</a>]</span>.
        Operational considerations related to checking the revocation status of the
        certificate of an encrypted DNS resolver are discussed in
        <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8484#section-10">Section 10</a> of [<a class="cite xref" href="#RFC8484">RFC8484</a>]</span>.<a class="pilcrow" href="#section-3.3-3">¶</a></p>
</section>
<section id="section-3.4">
        <h3 id="name-multihoming-considerations">
<a class="section-number selfRef" href="#section-3.4">3.4. </a><a class="section-name selfRef" href="#name-multihoming-considerations">Multihoming Considerations</a>
        </h3>
<p id="section-3.4-1">Devices may be connected to multiple networks, each providing their
        own DNS configuration using the discovery mechanisms specified in this
        document. Nevertheless, discussing DNS selection of multi-interfaced devices is beyond the scope of this specification. Such
        considerations fall under the generic issue of handling multiple
        provisioning sources and should not be processed in each option
        separately, as per the recommendation in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc7227#section-12">Section 12</a> of [<a class="cite xref" href="#RFC7227">RFC7227</a>]</span>.<a class="pilcrow" href="#section-3.4-1">¶</a></p>
<p id="section-3.4-2">The reader may refer to <span>[<a class="cite xref" href="#RFC6731">RFC6731</a>]</span> for a discussion
        of DNS selection issues and an example of DNS resolver selection for
        multi-interfaced devices. Also, the reader may refer to <span>[<a class="cite xref" href="#Local-DNS-Authority">Local-DNS-Authority</a>]</span> for a discussion on
        how DNR and Provisioning Domain (PvD) key "dnsZones" (<span><a class="relref" href="https://rfc-editor.org/rfc/rfc8801#section-4.3">Section 4.3</a> of [<a class="cite xref" href="#RFC8801">RFC8801</a>]</span>) can be used in "split DNS"
        environments (<span><a class="relref" href="https://rfc-editor.org/rfc/rfc8499#section-6">Section 6</a> of [<a class="cite xref" href="#RFC8499">RFC8499</a>]</span>).<a class="pilcrow" href="#section-3.4-2">¶</a></p>
</section>
</section>
</div>
<div id="DHCPv6">
<section id="section-4">
      <h2 id="name-dhcpv6-encrypted-dns-option">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-dhcpv6-encrypted-dns-option">DHCPv6 Encrypted DNS Option</a>
      </h2>
<div id="DHCPv6-ADN">
<section id="section-4.1">
        <h3 id="name-option-format">
<a class="section-number selfRef" href="#section-4.1">4.1. </a><a class="section-name selfRef" href="#name-option-format">Option Format</a>
        </h3>
<p id="section-4.1-1">The format of the DHCPv6 Encrypted DNS option is shown in <a class="auto internal xref" href="#dhcpv6-format">Figure 1</a>.<a class="pilcrow" href="#section-4.1-1">¶</a></p>
<span id="name-dhcpv6-encrypted-dns-option-2"></span><div id="dhcpv6-format">
<figure id="figure-1">
          <div class="alignCenter art-text artwork" id="section-4.1-2.1">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|       OPTION_V6_DNR           |         Option-length         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|       Service Priority        |         ADN Length            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
~                   authentication-domain-name                  ~
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|         Addr Length           |                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
~                        ipv6-address(es)                       ~
|                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                               |                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
~                 Service Parameters (SvcParams)                ~
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-1">Figure 1</a>:
<a class="selfRef" href="#name-dhcpv6-encrypted-dns-option-2">DHCPv6 Encrypted DNS Option</a>
          </figcaption></figure>
</div>
<p id="section-4.1-3">The fields of the option shown in <a class="auto internal xref" href="#dhcpv6-format">Figure 1</a> are as follows:<a class="pilcrow" href="#section-4.1-3">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.1-4">
          <dt id="section-4.1-4.1">Option-code:</dt>
          <dd id="section-4.1-4.2" style="margin-left: 1.5em">OPTION_V6_DNR (144; see <a class="auto internal xref" href="#iana6">Section 9.1</a>).<a class="pilcrow" href="#section-4.1-4.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-4.3">Option-length:</dt>
          <dd id="section-4.1-4.4" style="margin-left: 1.5em">Length of the enclosed data in
            octets. The option length is ('ADN Length' + 4) when only an ADN
            is included in the option.<a class="pilcrow" href="#section-4.1-4.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-4.5">Service Priority:</dt>
          <dd id="section-4.1-4.6" style="margin-left: 1.5em">The priority of this OPTION_V6_DNR
            instance compared to other instances. This 16-bit unsigned integer
            is interpreted following the rules specified in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc9460#section-2.4.1">Section 2.4.1</a> of [<a class="cite xref" href="#RFC9460">RFC9460</a>]</span>.<a class="pilcrow" href="#section-4.1-4.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-4.7">ADN Length:</dt>
          <dd id="section-4.1-4.8" style="margin-left: 1.5em">Length of the authentication-domain-name
            field in octets.<a class="pilcrow" href="#section-4.1-4.8">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-4.9">authentication-domain-name (variable length):</dt>
          <dd id="section-4.1-4.10" style="margin-left: 1.5em">
            <p id="section-4.1-4.10.1">A
            Fully Qualified Domain Name (FQDN) of the encrypted DNS resolver. This
            field is formatted as specified in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8415#section-10">Section 10</a> of [<a class="cite xref" href="#RFC8415">RFC8415</a>]</span>.<a class="pilcrow" href="#section-4.1-4.10.1">¶</a></p>
<p id="section-4.1-4.10.2">An example of the
            authentication-domain-name encoding is shown in <a class="auto internal xref" href="#fqdn">Figure 2</a>. This example conveys the FQDN
            "doh1.example.com.", and the resulting ADN Length field is
            18.<a class="pilcrow" href="#section-4.1-4.10.2">¶</a></p>
<span id="name-an-example-of-the-dns-authe"></span><div id="fqdn">
<figure id="figure-2">
              <div class="alignCenter art-text artwork" id="section-4.1-4.10.3.1">
<pre>+------+------+------+------+------+------+------+------+------+
| 0x04 |   d  |   o  |   h  |  1   | 0x07 |   e  |   x  |   a  |
+------+------+------+------+------+------+------+------+------+
|   m  |   p  |   l  |   e  | 0x03 |   c  |   o  |   m  | 0x00 |
+------+------+------+------+------+------+------+------+------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-2">Figure 2</a>:
<a class="selfRef" href="#name-an-example-of-the-dns-authe">An Example of the DNS authentication-domain-name Encoding</a>
              </figcaption></figure>
</div>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-4.11">Addr Length:</dt>
          <dd id="section-4.1-4.12" style="margin-left: 1.5em">Length of enclosed IPv6 addresses in
            octets. When present, it <span class="bcp14">MUST</span> be a multiple of 16.<a class="pilcrow" href="#section-4.1-4.12">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-4.13">ipv6-address(es) (variable length):</dt>
          <dd id="section-4.1-4.14" style="margin-left: 1.5em">
            <p id="section-4.1-4.14.1">Indicates one or
            more IPv6 addresses to reach the encrypted DNS resolver. An
            address can be a Link-Local address, a ULA, or a GUA. The format of this field
            is shown in <a class="auto internal xref" href="#v6add">Figure 3</a>.<a class="pilcrow" href="#section-4.1-4.14.1">¶</a></p>
<span id="name-format-of-the-ipv6-addresse"></span><div id="v6add">
<figure id="figure-3">
              <div class="alignCenter art-text artwork" id="section-4.1-4.14.2.1">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
|                         ipv6-address                          |
|                                                               |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                              ...                              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-3">Figure 3</a>:
<a class="selfRef" href="#name-format-of-the-ipv6-addresse">Format of the ipv6-address(es) Field</a>
              </figcaption></figure>
</div>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-4.15">Service Parameters (SvcParams) (variable length):</dt>
          <dd id="section-4.1-4.16" style="margin-left: 1.5em">
            <p id="section-4.1-4.16.1">Specifies
            a set of service parameters that are encoded following the rules
            in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc9460#section-2.2">Section 2.2</a> of [<a class="cite xref" href="#RFC9460">RFC9460</a>]</span>.
            Service parameters may include, for example, a list of ALPN
            protocol identifiers or alternate port numbers. This field <span class="bcp14">SHOULD</span>
            include at least the "alpn" SvcParam. The "alpn" SvcParam may not be
            required in contexts such as a variant of DNS over the Constrained Application Protocol (CoAP) where
            messages are encrypted using Object Security for Constrained
            RESTful Environments (OSCORE) <span>[<a class="cite xref" href="#RFC8613">RFC8613</a>]</span>. The
            service parameters <span class="bcp14">MUST NOT</span> include "ipv4hint" or "ipv6hint"
            SvcParams, as they are superseded by the included IP addresses.<a class="pilcrow" href="#section-4.1-4.16.1">¶</a></p>
<p id="section-4.1-4.16.2">If no port service parameter is included,
            this indicates that default port numbers should be used. As a
            reminder, the default port number is 853 for DoT, 443 for DoH, and
            853 for DoQ.<a class="pilcrow" href="#section-4.1-4.16.2">¶</a></p>
<p id="section-4.1-4.16.3">The length of this field is
            ('Option-length' - 6 - 'ADN Length' - 'Addr Length').<a class="pilcrow" href="#section-4.1-4.16.3">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.1-5">Note that the "Addr Length", "ipv6-address(es)", and "Service
        Parameters (SvcParams)" fields are not present if the ADN-only mode is
        used (<a class="auto internal xref" href="#adn-only">Section 3.1.6</a>).<a class="pilcrow" href="#section-4.1-5">¶</a></p>
</section>
</div>
<section id="section-4.2">
        <h3 id="name-dhcpv6-client-behavior">
<a class="section-number selfRef" href="#section-4.2">4.2. </a><a class="section-name selfRef" href="#name-dhcpv6-client-behavior">DHCPv6 Client Behavior</a>
        </h3>
<p id="section-4.2-1">To discover an encrypted DNS resolver, the DHCPv6 client <span class="bcp14">MUST</span>
        include OPTION_V6_DNR in an Option Request Option (ORO), per
        Sections <a class="relref" href="https://rfc-editor.org/rfc/rfc8415#section-18.2.1">18.2.1</a>, <a class="relref" href="https://rfc-editor.org/rfc/rfc8415#section-18.2.2">18.2.2</a>, <a class="relref" href="https://rfc-editor.org/rfc/rfc8415#section-18.2.4">18.2.4</a>, <a class="relref" href="https://rfc-editor.org/rfc/rfc8415#section-18.2.5">18.2.5</a>, <a class="relref" href="https://rfc-editor.org/rfc/rfc8415#section-18.2.6">18.2.6</a>, and <a class="relref" href="https://rfc-editor.org/rfc/rfc8415#section-21.7">21.7</a> of <span>[<a class="cite xref" href="#RFC8415">RFC8415</a>]</span>.<a class="pilcrow" href="#section-4.2-1">¶</a></p>
<p id="section-4.2-2">The DHCPv6 client <span class="bcp14">MUST</span> be prepared to receive multiple instances of
        the OPTION_V6_DNR option; each option is to be treated as a separate
        encrypted DNS resolver. These instances <span class="bcp14">MUST</span> be processed following
        their service priority (i.e., a smaller service priority value indicates a
        higher preference).<a class="pilcrow" href="#section-4.2-2">¶</a></p>
<p id="section-4.2-3">The DHCPv6 client <span class="bcp14">MUST</span> silently discard any OPTION_V6_DNR that
        fails to pass the validation steps defined in <a class="auto internal xref" href="#VC">Section 3.1.8</a>.<a class="pilcrow" href="#section-4.2-3">¶</a></p>
<p id="section-4.2-4">The DHCPv6 client <span class="bcp14">MUST</span> silently discard multicast and host loopback
        addresses conveyed in OPTION_V6_DNR.<a class="pilcrow" href="#section-4.2-4">¶</a></p>
</section>
</section>
</div>
<div id="DHCP">
<section id="section-5">
      <h2 id="name-dhcpv4-encrypted-dns-option">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-dhcpv4-encrypted-dns-option">DHCPv4 Encrypted DNS Option</a>
      </h2>
<section id="section-5.1">
        <h3 id="name-option-format-2">
<a class="section-number selfRef" href="#section-5.1">5.1. </a><a class="section-name selfRef" href="#name-option-format-2">Option Format</a>
        </h3>
<p id="section-5.1-1">The format of the DHCPv4 Encrypted DNS option is illustrated in
        <a class="auto internal xref" href="#dhcpri_dns">Figure 4</a>.<a class="pilcrow" href="#section-5.1-1">¶</a></p>
<span id="name-dhcpv4-encrypted-dns-option-2"></span><div id="dhcpri_dns">
<figure id="figure-4">
          <div class="alignCenter art-text artwork" id="section-5.1-2.1">
<pre> 0                   1
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| OPTION_V4_DNR |     Length    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
~      DNR Instance Data #1     ~
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+   ---
.              ...              .    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ optional
~      DNR Instance Data #n     ~    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+   ---
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-4">Figure 4</a>:
<a class="selfRef" href="#name-dhcpv4-encrypted-dns-option-2">DHCPv4 Encrypted DNS Option</a>
          </figcaption></figure>
</div>
<p id="section-5.1-3">The fields of the option shown in <a class="auto internal xref" href="#dhcpri_dns">Figure 4</a> are
        as follows:<a class="pilcrow" href="#section-5.1-3">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.1-4">
          <dt id="section-5.1-4.1">Code:</dt>
          <dd id="section-5.1-4.2" style="margin-left: 1.5em">OPTION_V4_DNR (162; see <a class="auto internal xref" href="#iana4">Section 9.2</a>).<a class="pilcrow" href="#section-5.1-4.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-4.3">Length:</dt>
          <dd id="section-5.1-4.4" style="margin-left: 1.5em">Indicates the length of the enclosed data in
            octets.<a class="pilcrow" href="#section-5.1-4.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-4.5">DNR Instance Data:</dt>
          <dd id="section-5.1-4.6" style="margin-left: 1.5em">
            <p id="section-5.1-4.6.1">Includes the configuration data
            of an encrypted DNS resolver. The format of this field is shown in
            <a class="auto internal xref" href="#dhcpri_dns2">Figure 5</a>.<a class="pilcrow" href="#section-5.1-4.6.1">¶</a></p>
<span id="name-dnr-instance-data-format"></span><div id="dhcpri_dns2">
<figure id="figure-5">
              <div class="alignCenter art-text artwork" id="section-5.1-4.6.2.1">
<pre> 0                   1
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|    DNR Instance Data Length   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|       Service Priority        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   ADN Length  |               |
+-+-+-+-+-+-+-+-+               |
~  authentication-domain-name   ~
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Addr Length  |               |
+-+-+-+-+-+-+-+-+               |
~        IPv4 Address(es)       ~
|               +-+-+-+-+-+-+-+-+
|               |               |
+-+-+-+-+-+-+-+-+               |
~Service Parameters (SvcParams) ~
|                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-5">Figure 5</a>:
<a class="selfRef" href="#name-dnr-instance-data-format">DNR Instance Data Format</a>
              </figcaption></figure>
</div>
<p id="section-5.1-4.6.3">When several encrypted DNS
            resolvers are to be included, the "DNR Instance Data" field is
            repeated.<a class="pilcrow" href="#section-5.1-4.6.3">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-5.1-5">The fields shown in <a class="auto internal xref" href="#dhcpri_dns2">Figure 5</a> are as
        follows:<a class="pilcrow" href="#section-5.1-5">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.1-6">
          <dt id="section-5.1-6.1">DNR Instance Data Length:</dt>
          <dd id="section-5.1-6.2" style="margin-left: 1.5em">Length of all following
            data in octets. This field is set to ('ADN Length' + 3) when only
            an ADN is provided for a DNR instance.<a class="pilcrow" href="#section-5.1-6.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-6.3">Service Priority:</dt>
          <dd id="section-5.1-6.4" style="margin-left: 1.5em">The priority of this instance
            compared to other DNR instances. This 16-bit unsigned integer is
            interpreted following the rules specified in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc9460#section-2.4.1">Section 2.4.1</a> of [<a class="cite xref" href="#RFC9460">RFC9460</a>]</span>.<a class="pilcrow" href="#section-5.1-6.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-6.5">ADN Length:</dt>
          <dd id="section-5.1-6.6" style="margin-left: 1.5em">Length of the authentication-domain-name field
            in octets.<a class="pilcrow" href="#section-5.1-6.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-6.7">authentication-domain-name (variable length):</dt>
          <dd id="section-5.1-6.8" style="margin-left: 1.5em">The
            ADN of the encrypted DNS resolver. This
            field is formatted as specified in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8415#section-10">Section 10</a> of [<a class="cite xref" href="#RFC8415">RFC8415</a>]</span>. An example is provided in <a class="auto internal xref" href="#fqdn">Figure 2</a>.<a class="pilcrow" href="#section-5.1-6.8">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-6.9">Addr Length:</dt>
          <dd id="section-5.1-6.10" style="margin-left: 1.5em">Length of included IPv4 addresses in
            octets. When present, it <span class="bcp14">MUST</span> be a multiple of 4.<a class="pilcrow" href="#section-5.1-6.10">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-6.11">IPv4 Address(es) (variable length):</dt>
          <dd id="section-5.1-6.12" style="margin-left: 1.5em">
            <p id="section-5.1-6.12.1">Indicates one or
            more IPv4 addresses to reach the encrypted DNS resolver. Both
            private and public IPv4 addresses can be included in this field.
            The format of this field is shown in <a class="auto internal xref" href="#v4">Figure 6</a>. This
            format assumes that an IPv4 address is encoded as
            a1.a2.a3.a4.<a class="pilcrow" href="#section-5.1-6.12.1">¶</a></p>
<span id="name-format-of-the-ipv4-addresse"></span><div id="v4">
<figure id="figure-6">
              <div class="alignCenter art-text artwork" id="section-5.1-6.12.2.1">
<pre>0     8     16    24    32    40    48
+-----+-----+-----+-----+-----+-----+--
|  a1 |  a2 |  a3 |  a4 |  a1 |  a2 | ...
+-----+-----+-----+-----+-----+-----+--
  IPv4 Address 1          IPv4 Address 2 ...
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-6">Figure 6</a>:
<a class="selfRef" href="#name-format-of-the-ipv4-addresse">Format of the IPv4 Address(es) Field</a>
              </figcaption></figure>
</div>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-6.13">Service Parameters (SvcParams) (variable length):</dt>
          <dd id="section-5.1-6.14" style="margin-left: 1.5em">
            <p id="section-5.1-6.14.1">Specifies
            a set of service parameters that are encoded following the rules
            in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc9460#section-2.2">Section 2.2</a> of [<a class="cite xref" href="#RFC9460">RFC9460</a>]</span>.
            Service parameters may include, for example, a list of ALPN
            protocol identifiers or alternate port numbers. This field <span class="bcp14">SHOULD</span>
            include at least the "alpn" SvcParam. The "alpn" SvcParam may not be
            required in contexts such as a variant of DNS over CoAP where
            messages are encrypted using OSCORE. The service parameters
            <span class="bcp14">MUST NOT</span> include "ipv4hint" or "ipv6hint" SvcParams, as they are
            superseded by the included IP addresses.<a class="pilcrow" href="#section-5.1-6.14.1">¶</a></p>
<p id="section-5.1-6.14.2">If no port service parameter is included, this
            indicates that default port numbers should be used.<a class="pilcrow" href="#section-5.1-6.14.2">¶</a></p>
<p id="section-5.1-6.14.3">The length of this field is ('DNR Instance Data
            Length' - 4 - 'ADN Length' - 'Addr Length').<a class="pilcrow" href="#section-5.1-6.14.3">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-5.1-7">Note that the "Addr Length", "IPv4 Address(es)", and "Service
        Parameters (SvcParams)" fields are not present if the ADN-only mode is
        used (<a class="auto internal xref" href="#adn-only">Section 3.1.6</a>).<a class="pilcrow" href="#section-5.1-7">¶</a></p>
<p id="section-5.1-8">OPTION_V4_DNR is a concatenation-requiring option. As such, the
        mechanism specified in <span>[<a class="cite xref" href="#RFC3396">RFC3396</a>]</span> <span class="bcp14">MUST</span> be used if
        OPTION_V4_DNR exceeds the maximum DHCPv4 option size of 255
        octets.<a class="pilcrow" href="#section-5.1-8">¶</a></p>
</section>
<section id="section-5.2">
        <h3 id="name-dhcpv4-client-behavior">
<a class="section-number selfRef" href="#section-5.2">5.2. </a><a class="section-name selfRef" href="#name-dhcpv4-client-behavior">DHCPv4 Client Behavior</a>
        </h3>
<p id="section-5.2-1">To discover an encrypted DNS resolver, the DHCPv4 client requests
        the encrypted DNS resolver by including OPTION_V4_DNR in a Parameter
        Request List option <span>[<a class="cite xref" href="#RFC2132">RFC2132</a>]</span>.<a class="pilcrow" href="#section-5.2-1">¶</a></p>
<p id="section-5.2-2">The DHCPv4 client <span class="bcp14">MUST</span> be prepared to receive multiple "DNR Instance
        Data" field entries in the OPTION_V4_DNR option; each instance is to be treated as a
        separate encrypted DNS resolver. These instances <span class="bcp14">MUST</span> be processed
        following their service priority (i.e., a smaller service priority value
        indicates a higher preference).<a class="pilcrow" href="#section-5.2-2">¶</a></p>
<p id="section-5.2-3">The DHCPv4 client <span class="bcp14">MUST</span> silently discard any OPTION_V4_DNR that
        fails to pass the validation steps defined in <a class="auto internal xref" href="#VC">Section 3.1.8</a>.<a class="pilcrow" href="#section-5.2-3">¶</a></p>
<p id="section-5.2-4">The DHCPv4 client <span class="bcp14">MUST</span> silently discard multicast and host loopback
        addresses conveyed in OPTION_V4_DNR.<a class="pilcrow" href="#section-5.2-4">¶</a></p>
</section>
</section>
</div>
<div id="RA">
<section id="section-6">
      <h2 id="name-ipv6-ra-encrypted-dns-optio">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-ipv6-ra-encrypted-dns-optio">IPv6 RA Encrypted DNS Option</a>
      </h2>
<div id="RA-ADN">
<section id="section-6.1">
        <h3 id="name-option-format-3">
<a class="section-number selfRef" href="#section-6.1">6.1. </a><a class="section-name selfRef" href="#name-option-format-3">Option Format</a>
        </h3>
<p id="section-6.1-1">This section defines a new Neighbor Discovery option <span>[<a class="cite xref" href="#RFC4861">RFC4861</a>]</span>: the IPv6 RA Encrypted DNS option. This option is
        useful in contexts similar to those discussed in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8106#section-1.1">Section 1.1</a> of [<a class="cite xref" href="#RFC8106">RFC8106</a>]</span>.<a class="pilcrow" href="#section-6.1-1">¶</a></p>
<p id="section-6.1-2">The format of the IPv6 RA Encrypted DNS option is illustrated in
        <a class="auto internal xref" href="#ra_dns">Figure 7</a>.<a class="pilcrow" href="#section-6.1-2">¶</a></p>
<span id="name-ra-encrypted-dns-option"></span><div id="ra_dns">
<figure id="figure-7">
          <div class="alignCenter art-text artwork" id="section-6.1-3.1">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     Type      |     Length    |        Service Priority       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           Lifetime                            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|          ADN Length           |                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
~                   authentication-domain-name                  ~
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|         Addr Length           |                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
~                        ipv6-address(es)                       ~
|                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                               |     SvcParams Length          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
~                 Service Parameters (SvcParams)                ~
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-7">Figure 7</a>:
<a class="selfRef" href="#name-ra-encrypted-dns-option">RA Encrypted DNS Option</a>
          </figcaption></figure>
</div>
<p id="section-6.1-4">The fields of the option shown in <a class="auto internal xref" href="#ra_dns">Figure 7</a> are as
        follows:<a class="pilcrow" href="#section-6.1-4">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-6.1-5">
          <dt id="section-6.1-5.1">Type:</dt>
          <dd id="section-6.1-5.2" style="margin-left: 1.5em">8-bit identifier of the Encrypted DNS option
            as assigned by IANA (144; see <a class="auto internal xref" href="#iana7">Section 9.3</a>).<a class="pilcrow" href="#section-6.1-5.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-5.3">Length:</dt>
          <dd id="section-6.1-5.4" style="margin-left: 1.5em">8-bit unsigned integer. The length of the
            option (including the Type and Length fields) is in units of 8
            octets.<a class="pilcrow" href="#section-6.1-5.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-5.5">Service Priority:</dt>
          <dd id="section-6.1-5.6" style="margin-left: 1.5em">16-bit unsigned integer.  The priority of this Encrypted DNS option instance compared to other instances.  This field is interpreted following the rules specified
            in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc9460#section-2.4.1">Section 2.4.1</a> of [<a class="cite xref" href="#RFC9460">RFC9460</a>]</span>.<a class="pilcrow" href="#section-6.1-5.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-5.7">Lifetime:</dt>
          <dd id="section-6.1-5.8" style="margin-left: 1.5em">
            <p id="section-6.1-5.8.1">32-bit unsigned integer. This represents the maximum time
            in seconds (relative to the time the packet is received) over
            which the discovered ADN is valid.<a class="pilcrow" href="#section-6.1-5.8.1">¶</a></p>
<p id="section-6.1-5.8.2">The value of Lifetime <span class="bcp14">SHOULD</span> by default be at
            least 3 * MaxRtrAdvInterval, where MaxRtrAdvInterval is the
            maximum RA interval as defined in <span>[<a class="cite xref" href="#RFC4861">RFC4861</a>]</span>.<a class="pilcrow" href="#section-6.1-5.8.2">¶</a></p>
<p id="section-6.1-5.8.3">A value of all one bits (0xffffffff)
            represents infinity.<a class="pilcrow" href="#section-6.1-5.8.3">¶</a></p>
<p id="section-6.1-5.8.4">A value of zero
            means that this ADN <span class="bcp14">MUST</span> no longer be
            used.<a class="pilcrow" href="#section-6.1-5.8.4">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-5.9">ADN Length:</dt>
          <dd id="section-6.1-5.10" style="margin-left: 1.5em">16-bit unsigned integer. This field
            indicates the length of the authentication-domain-name field in
            octets.<a class="pilcrow" href="#section-6.1-5.10">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-5.11">authentication-domain-name (variable length):</dt>
          <dd id="section-6.1-5.12" style="margin-left: 1.5em">The
            ADN of the encrypted DNS resolver. This
            field is formatted as specified in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8415#section-10">Section 10</a> of [<a class="cite xref" href="#RFC8415">RFC8415</a>]</span>.<a class="pilcrow" href="#section-6.1-5.12">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-5.13">Addr Length:</dt>
          <dd id="section-6.1-5.14" style="margin-left: 1.5em">16-bit unsigned integer. This field
            indicates the length of enclosed IPv6 addresses in octets. When
            present, it <span class="bcp14">MUST</span> be a multiple of 16.<a class="pilcrow" href="#section-6.1-5.14">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-5.15">ipv6-address(es) (variable length):</dt>
          <dd id="section-6.1-5.16" style="margin-left: 1.5em">
            <p id="section-6.1-5.16.1">One or more IPv6
            addresses of the encrypted DNS resolver. An address can be a
            Link-Local address, a ULA, or a GUA.<a class="pilcrow" href="#section-6.1-5.16.1">¶</a></p>
<p id="section-6.1-5.16.2">All of the
            addresses share the same Lifetime value. As also discussed in <span>[<a class="cite xref" href="#RFC8106">RFC8106</a>]</span>, if it is desirable to have different Lifetime
            values per IP address, multiple Encrypted DNS options may be
            used.<a class="pilcrow" href="#section-6.1-5.16.2">¶</a></p>
<p id="section-6.1-5.16.3">The format of this field is shown in
            <a class="auto internal xref" href="#v6add">Figure 3</a>.<a class="pilcrow" href="#section-6.1-5.16.3">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-5.17">SvcParams Length:</dt>
          <dd id="section-6.1-5.18" style="margin-left: 1.5em">16-bit unsigned integer. This
            field indicates the length of the "Service Parameters (SvcParams)" field in
            octets.<a class="pilcrow" href="#section-6.1-5.18">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-5.19">Service Parameters (SvcParams) (variable length):</dt>
          <dd id="section-6.1-5.20" style="margin-left: 1.5em">
            <p id="section-6.1-5.20.1">Specifies
            a set of service parameters that are encoded following the rules
            in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc9460#section-2.2">Section 2.2</a> of [<a class="cite xref" href="#RFC9460">RFC9460</a>]</span>.
            Service parameters may include, for example, a list of ALPN
            protocol identifiers or alternate port numbers. This field <span class="bcp14">SHOULD</span>
            include at least the "alpn" SvcParam. The "alpn" SvcParam may not be
            required in contexts such as a variant of DNS over CoAP where
            messages are encrypted using OSCORE. The service parameters
            <span class="bcp14">MUST NOT</span> include "ipv4hint" or "ipv6hint" SvcParams, as they are
            superseded by the included IP addresses.<a class="pilcrow" href="#section-6.1-5.20.1">¶</a></p>
<p id="section-6.1-5.20.2">If no port service parameter is included, this
            indicates that default port numbers should be used.<a class="pilcrow" href="#section-6.1-5.20.2">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-6.1-6">Note that the "Addr Length", "ipv6-address(es)", and "Service
        Parameters (SvcParams)" fields are not present if the ADN-only mode is
        used (<a class="auto internal xref" href="#adn-only">Section 3.1.6</a>).<a class="pilcrow" href="#section-6.1-6">¶</a></p>
<p id="section-6.1-7">The option <span class="bcp14">MUST</span> be padded with zeros so that the full enclosed data
        is a multiple of 8 octets (<span><a class="relref" href="https://rfc-editor.org/rfc/rfc4861#section-4.6">Section 4.6</a> of [<a class="cite xref" href="#RFC4861">RFC4861</a>]</span>).<a class="pilcrow" href="#section-6.1-7">¶</a></p>
</section>
</div>
<section id="section-6.2">
        <h3 id="name-ipv6-host-behavior">
<a class="section-number selfRef" href="#section-6.2">6.2. </a><a class="section-name selfRef" href="#name-ipv6-host-behavior">IPv6 Host Behavior</a>
        </h3>
<p id="section-6.2-1">The procedure for DNS configuration is the same as it is with any
        other Neighbor Discovery option <span>[<a class="cite xref" href="#RFC4861">RFC4861</a>]</span>. In
        addition, the host follows the same procedure as the procedure described in
        <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8106#section-5.3.1">Section 5.3.1</a> of [<a class="cite xref" href="#RFC8106">RFC8106</a>]</span> for processing received
        Encrypted DNS options, with the formatting requirements listed in <a class="auto internal xref" href="#RA-ADN">Section 6.1</a> and the validation checks listed in <a class="auto internal xref" href="#VC">Section 3.1.8</a>
        substituted for length and field validations.<a class="pilcrow" href="#section-6.2-1">¶</a></p>
<p id="section-6.2-2">The host <span class="bcp14">MUST</span> be prepared to receive multiple Encrypted DNS options
        in RAs. These instances <span class="bcp14">MUST</span> be processed following their service
        priority (i.e., a smaller service priority value indicates a higher
        preference).<a class="pilcrow" href="#section-6.2-2">¶</a></p>
<p id="section-6.2-3">The host <span class="bcp14">MUST</span> silently discard multicast and host loopback
        addresses conveyed in the Encrypted DNS options.<a class="pilcrow" href="#section-6.2-3">¶</a></p>
</section>
</section>
</div>
<div id="Security">
<section id="section-7">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<div id="spoof">
<section id="section-7.1">
        <h3 id="name-spoofing-attacks">
<a class="section-number selfRef" href="#section-7.1">7.1. </a><a class="section-name selfRef" href="#name-spoofing-attacks">Spoofing Attacks</a>
        </h3>
<p id="section-7.1-1">DHCP/RA messages are not encrypted or protected against
        modification within the LAN. Unless spoofing attacks are mitigated as described below, the
        content of DHCP and RA messages can be spoofed or modified by active
        attackers, such as compromised devices within the local network. An
        active attacker (<span><a class="relref" href="https://rfc-editor.org/rfc/rfc3552#section-3.3">Section 3.3</a> of [<a class="cite xref" href="#RFC3552">RFC3552</a>]</span>) can spoof
        the DHCP/RA response to provide the attacker's encrypted DNS resolver.
        Note that such an attacker can launch other attacks as discussed in
        <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8415#section-22">Section 22</a> of [<a class="cite xref" href="#RFC8415">RFC8415</a>]</span>. The attacker can get a domain
        name with a domain-validated public certificate from a Certificate Authority (CA) and host an
        encrypted DNS resolver.<a class="pilcrow" href="#section-7.1-1">¶</a></p>
<p id="section-7.1-2">Attacks of spoofed or modified DHCP responses and RA messages by
        attackers within the local network may be mitigated by making use of
        the following mechanisms:<a class="pilcrow" href="#section-7.1-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-7.1-3">
          <dt id="section-7.1-3.1">DHCPv6-Shield <span>[<a class="cite xref" href="#RFC7610">RFC7610</a>]</span>:</dt>
          <dd id="section-7.1-3.2" style="margin-left: 1.5em">The network access
            node (e.g., a border router, a CPE, an Access Point (AP)) discards
            DHCP response messages received from any local endpoint.<a class="pilcrow" href="#section-7.1-3.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.1-3.3">RA-Guard <span>[<a class="cite xref" href="#RFC7113">RFC7113</a>]</span>:</dt>
          <dd id="section-7.1-3.4" style="margin-left: 1.5em">The network access node
            discards RA messages received from any local endpoint.<a class="pilcrow" href="#section-7.1-3.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.1-3.5">Source Address Validation Improvement (SAVI) solution for DHCP
            <span>[<a class="cite xref" href="#RFC7513">RFC7513</a>]</span>:</dt>
          <dd id="section-7.1-3.6" style="margin-left: 1.5em">The network access node filters packets
            with forged source IP addresses.<a class="pilcrow" href="#section-7.1-3.6">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-7.1-4">The above mechanisms would ensure that the endpoint receives the
        correct configuration information of the encrypted DNS resolvers
        selected by the DHCP server (or RA sender), but these mechanisms cannot provide any
        information about the DHCP server or the entity hosting the DHCP
        server (or RA sender).<a class="pilcrow" href="#section-7.1-4">¶</a></p>
<p id="section-7.1-5">Encrypted DNS sessions with rogue resolvers that spoof the IP
        address of a DNS resolver will fail because the DNS client will fail
        to authenticate that rogue resolver based upon PKIX authentication
        <span>[<a class="cite xref" href="#RFC6125">RFC6125</a>]</span>, particularly the ADN
        in the Encrypted DNS option. DNS clients that ignore authentication
        failures and accept spoofed certificates will be subject to attacks
        (e.g., attacks that redirect to malicious resolvers or intercept sensitive data).<a class="pilcrow" href="#section-7.1-5">¶</a></p>
</section>
</div>
<section id="section-7.2">
        <h3 id="name-deletion-attacks">
<a class="section-number selfRef" href="#section-7.2">7.2. </a><a class="section-name selfRef" href="#name-deletion-attacks">Deletion Attacks</a>
        </h3>
<p id="section-7.2-1">If the DHCP responses or RAs are dropped by the attacker, the
        client can fall back to using a preconfigured encrypted DNS resolver.
        However, the use of policies to select resolvers is beyond the scope
        of this document.<a class="pilcrow" href="#section-7.2-1">¶</a></p>
<p id="section-7.2-2">Note that deletion attacks are not specific to DHCP/RA.<a class="pilcrow" href="#section-7.2-2">¶</a></p>
</section>
<section id="section-7.3">
        <h3 id="name-passive-attacks">
<a class="section-number selfRef" href="#section-7.3">7.3. </a><a class="section-name selfRef" href="#name-passive-attacks">Passive Attacks</a>
        </h3>
<p id="section-7.3-1">A passive attacker (<span><a class="relref" href="https://rfc-editor.org/rfc/rfc3552#section-3.2">Section 3.2</a> of [<a class="cite xref" href="#RFC3552">RFC3552</a>]</span>) can
        determine that a host is using DHCP/RA to discover an encrypted DNS resolver
        and can infer that the host is capable of using DoH/DoT/DoQ to encrypt DNS
        messages. However, a passive attacker cannot spoof or modify DHCP/RA
        messages.<a class="pilcrow" href="#section-7.3-1">¶</a></p>
</section>
<section id="section-7.4">
        <h3 id="name-wireless-security-authentic">
<a class="section-number selfRef" href="#section-7.4">7.4. </a><a class="section-name selfRef" href="#name-wireless-security-authentic">Wireless Security - Authentication Attacks</a>
        </h3>
<p id="section-7.4-1">Wireless LANs (WLANs), frequently deployed in local networks (e.g.,
        home networks), are vulnerable to various attacks (e.g., <span>[<a class="cite xref" href="#Evil-Twin">Evil-Twin</a>]</span>, <span>[<a class="cite xref" href="#Krack">Krack</a>]</span>, <span>[<a class="cite xref" href="#Dragonblood">Dragonblood</a>]</span>). Because of these attacks, only
        cryptographically authenticated communications are trusted on WLANs.
        This means that any information (e.g., regarding NTP servers, DNS resolvers, or
        domain search lists) provided by such networks via DHCP, DHCPv6, or RA
        is untrusted because DHCP and RA messages are not authenticated.<a class="pilcrow" href="#section-7.4-1">¶</a></p>
<p id="section-7.4-2">If the pre-shared key (PSK) is the same for all clients that
        connect to the same WLAN (e.g., Wi-Fi Protected Access Pre-Shared
Key (WPA-PSK)), the shared key will be
        available to all nodes, including attackers. As such, it is possible
        to mount an active on-path attack. On-path attacks are possible within
        local networks because this form of WLAN authentication lacks peer entity
        authentication.<a class="pilcrow" href="#section-7.4-2">¶</a></p>
<p id="section-7.4-3">This leads to the need for provisioning unique credentials for
        different clients. Endpoints can be provisioned with unique
        credentials (username and password, typically) provided by the local
        network administrator to mutually authenticate to the local WLAN AP
        (e.g., 802.1x Wireless User Authentication on OpenWrt <span>[<a class="cite xref" href="#dot1x">dot1x</a>]</span>, EAP-pwd <span>[<a class="cite xref" href="#RFC8146">RFC8146</a>]</span> ("EAP" stands for "Extensible Authentication Protocol")). Not all
        endpoint devices (e.g., Internet of Things (IoT) devices) support 802.1x supplicants and
        need an alternate mechanism to connect to the local network. To
        address this limitation, unique PSKs can be created for
        each such device and WPA-PSK is used (e.g., <span>[<a class="cite xref" href="#IPSK">IPSK</a>]</span>).<a class="pilcrow" href="#section-7.4-3">¶</a></p>
</section>
</section>
</div>
<section id="section-8">
      <h2 id="name-privacy-considerations">
<a class="section-number selfRef" href="#section-8">8. </a><a class="section-name selfRef" href="#name-privacy-considerations">Privacy Considerations</a>
      </h2>
<p id="section-8-1">Privacy considerations that are also specific to DNR provisioning
      mechanisms are discussed in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8415#section-23">Section 23</a> of [<a class="cite xref" href="#RFC8415">RFC8415</a>]</span> and in
      <span>[<a class="cite xref" href="#RFC7824">RFC7824</a>]</span>. Anonymity profiles for DHCP clients are
      discussed in <span>[<a class="cite xref" href="#RFC7844">RFC7844</a>]</span>. The mechanisms defined in this
      document can be used to infer that a DHCP client or IPv6 host supports
      Encrypted DNS options, but these mechanisms do not explicitly reveal whether local DNS
      clients are able to consume these options or infer their encryption
      capabilities. Other than that, this document does not expose more
      privacy information compared to Do53 discovery options.<a class="pilcrow" href="#section-8-1">¶</a></p>
<p id="section-8-2">As discussed in <span>[<a class="cite xref" href="#RFC9076">RFC9076</a>]</span>, the use of encrypted DNS
      does not reduce the data available in the DNS resolver. For example, the
      reader may refer to <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8484#section-8">Section 8</a> of [<a class="cite xref" href="#RFC8484">RFC8484</a>]</span> or <span><a class="relref" href="https://rfc-editor.org/rfc/rfc9250#section-7">Section 7</a> of [<a class="cite xref" href="#RFC9250">RFC9250</a>]</span> for a discussion on specific privacy
      considerations for encrypted DNS.<a class="pilcrow" href="#section-8-2">¶</a></p>
</section>
<div id="IANA">
<section id="section-9">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-9">9. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<div id="iana6">
<section id="section-9.1">
        <h3 id="name-dhcpv6-option">
<a class="section-number selfRef" href="#section-9.1">9.1. </a><a class="section-name selfRef" href="#name-dhcpv6-option">DHCPv6 Option</a>
        </h3>
<p id="section-9.1-1">IANA has assigned the following new DHCPv6 Option Code in
        the "Option Codes" registry maintained at <span>[<a class="cite xref" href="#DHCPV6">DHCPV6</a>]</span>.<a class="pilcrow" href="#section-9.1-1">¶</a></p>
<span id="name-dhcpv6-encrypted-dns-option-3"></span><div id="dhcpv6t">
<table class="center" id="table-1">
          <caption>
<a class="selfRef" href="#table-1">Table 1</a>:
<a class="selfRef" href="#name-dhcpv6-encrypted-dns-option-3">DHCPv6 Encrypted DNS Option</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Value</th>
              <th class="text-left" colspan="1" rowspan="1">Description</th>
              <th class="text-left" colspan="1" rowspan="1">Client ORO</th>
              <th class="text-left" colspan="1" rowspan="1">Singleton Option</th>
              <th class="text-left" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">144</td>
              <td class="text-left" colspan="1" rowspan="1">OPTION_V6_DNR</td>
              <td class="text-left" colspan="1" rowspan="1">Yes</td>
              <td class="text-left" colspan="1" rowspan="1">No</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9463</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="iana4">
<section id="section-9.2">
        <h3 id="name-dhcpv4-option">
<a class="section-number selfRef" href="#section-9.2">9.2. </a><a class="section-name selfRef" href="#name-dhcpv4-option">DHCPv4 Option</a>
        </h3>
<p id="section-9.2-1">IANA has assigned the following new DHCP Option Code in
        the "BOOTP Vendor Extensions and DHCP Options" registry maintained at <span>[<a class="cite xref" href="#BOOTP">BOOTP</a>]</span>.<a class="pilcrow" href="#section-9.2-1">¶</a></p>
<span id="name-dhcpv4-encrypted-dns-option-3"></span><div id="dhcpv4t">
<table class="center" id="table-2">
          <caption>
<a class="selfRef" href="#table-2">Table 2</a>:
<a class="selfRef" href="#name-dhcpv4-encrypted-dns-option-3">DHCPv4 Encrypted DNS Option</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Tag</th>
              <th class="text-left" colspan="1" rowspan="1">Name</th>
              <th class="text-left" colspan="1" rowspan="1">Data Length</th>
              <th class="text-left" colspan="1" rowspan="1">Meaning</th>
              <th class="text-left" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">162</td>
              <td class="text-left" colspan="1" rowspan="1">OPTION_V4_DNR</td>
              <td class="text-left" colspan="1" rowspan="1">N</td>
              <td class="text-left" colspan="1" rowspan="1">Encrypted DNS Server</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9463</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="iana7">
<section id="section-9.3">
        <h3 id="name-neighbor-discovery-option">
<a class="section-number selfRef" href="#section-9.3">9.3. </a><a class="section-name selfRef" href="#name-neighbor-discovery-option">Neighbor Discovery Option</a>
        </h3>
<p id="section-9.3-1">IANA has assigned the following new IPv6 Neighbor
        Discovery Option type in the "IPv6 Neighbor Discovery Option Formats"
        subregistry under the "Internet Control Message Protocol version 6
        (ICMPv6) Parameters" registry maintained at <span>[<a class="cite xref" href="#ND">ND</a>]</span>.<a class="pilcrow" href="#section-9.3-1">¶</a></p>
<span id="name-neighbor-discovery-encrypte"></span><div id="ndt">
<table class="center" id="table-3">
          <caption>
<a class="selfRef" href="#table-3">Table 3</a>:
<a class="selfRef" href="#name-neighbor-discovery-encrypte">Neighbor Discovery Encrypted DNS Option</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Type</th>
              <th class="text-left" colspan="1" rowspan="1">Description</th>
              <th class="text-left" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">144</td>
              <td class="text-left" colspan="1" rowspan="1">Encrypted DNS Option</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9463</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
</section>
</div>
<section id="section-10">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-10">10. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-10.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-10.1">10.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time class="refDate" datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2132">[RFC2132]</dt>
        <dd>
<span class="refAuthor">Alexander, S.</span> and <span class="refAuthor">R. Droms</span>, <span class="refTitle">"DHCP Options and BOOTP Vendor Extensions"</span>, <span class="seriesInfo">RFC 2132</span>, <span class="seriesInfo">DOI 10.17487/RFC2132</span>, <time class="refDate" datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2132">https://www.rfc-editor.org/info/rfc2132</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3396">[RFC3396]</dt>
        <dd>
<span class="refAuthor">Lemon, T.</span> and <span class="refAuthor">S. Cheshire</span>, <span class="refTitle">"Encoding Long Options in the Dynamic Host Configuration Protocol (DHCPv4)"</span>, <span class="seriesInfo">RFC 3396</span>, <span class="seriesInfo">DOI 10.17487/RFC3396</span>, <time class="refDate" datetime="2002-11">November 2002</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3396">https://www.rfc-editor.org/info/rfc3396</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4861">[RFC4861]</dt>
        <dd>
<span class="refAuthor">Narten, T.</span>, <span class="refAuthor">Nordmark, E.</span>, <span class="refAuthor">Simpson, W.</span>, and <span class="refAuthor">H. Soliman</span>, <span class="refTitle">"Neighbor Discovery for IP version 6 (IPv6)"</span>, <span class="seriesInfo">RFC 4861</span>, <span class="seriesInfo">DOI 10.17487/RFC4861</span>, <time class="refDate" datetime="2007-09">September 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4861">https://www.rfc-editor.org/info/rfc4861</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8106">[RFC8106]</dt>
        <dd>
<span class="refAuthor">Jeong, J.</span>, <span class="refAuthor">Park, S.</span>, <span class="refAuthor">Beloeil, L.</span>, and <span class="refAuthor">S. Madanapalli</span>, <span class="refTitle">"IPv6 Router Advertisement Options for DNS Configuration"</span>, <span class="seriesInfo">RFC 8106</span>, <span class="seriesInfo">DOI 10.17487/RFC8106</span>, <time class="refDate" datetime="2017-03">March 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8106">https://www.rfc-editor.org/info/rfc8106</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time class="refDate" datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8415">[RFC8415]</dt>
        <dd>
<span class="refAuthor">Mrugalski, T.</span>, <span class="refAuthor">Siodelski, M.</span>, <span class="refAuthor">Volz, B.</span>, <span class="refAuthor">Yourtchenko, A.</span>, <span class="refAuthor">Richardson, M.</span>, <span class="refAuthor">Jiang, S.</span>, <span class="refAuthor">Lemon, T.</span>, and <span class="refAuthor">T. Winters</span>, <span class="refTitle">"Dynamic Host Configuration Protocol for IPv6 (DHCPv6)"</span>, <span class="seriesInfo">RFC 8415</span>, <span class="seriesInfo">DOI 10.17487/RFC8415</span>, <time class="refDate" datetime="2018-11">November 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8415">https://www.rfc-editor.org/info/rfc8415</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9460">[RFC9460]</dt>
        <dd>
<span class="refAuthor">Schwartz, B.</span>, <span class="refAuthor">Bishop, M.</span>, and <span class="refAuthor">E. Nygren</span>, <span class="refTitle">"Service Binding and Parameter Specification via the DNS (SVCB and HTTPS Resource Records)"</span>, <span class="seriesInfo">RFC 9460</span>, <span class="seriesInfo">DOI 10.17487/RFC9460</span>, <time class="refDate" datetime="2023-11">November 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9460">https://www.rfc-editor.org/info/rfc9460</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9461">[RFC9461]</dt>
      <dd>
<span class="refAuthor">Schwartz, B.</span>, <span class="refTitle">"Service Binding Mapping for DNS Servers"</span>, <span class="seriesInfo">RFC 9461</span>, <span class="seriesInfo">DOI 10.17487/RFC9461</span>, <time class="refDate" datetime="2023-11">November 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9461">https://www.rfc-editor.org/info/rfc9461</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-10.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-10.2">10.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="BOOTP">[BOOTP]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"BOOTP Vendor Extensions and DHCP Options"</span>, <span>&lt;<a href="https://www.iana.org/assignments/bootp-dhcp-parameters/">https://www.iana.org/assignments/bootp-dhcp-parameters/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="DHCPV6">[DHCPV6]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Option Codes"</span>, <span>&lt;<a href="https://www.iana.org/assignments/dhcpv6-parameters/">https://www.iana.org/assignments/dhcpv6-parameters/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.pusateri-dhc-dns-driu">[DNS-TLS-DHCPv6-Opt]</dt>
        <dd>
<span class="refAuthor">Pusateri, T.</span> and <span class="refAuthor">W. Toorop</span>, <span class="refTitle">"DHCPv6 Options for private DNS Discovery"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-pusateri-dhc-dns-driu-00</span>, <time class="refDate" datetime="2018-07-02">2 July 2018</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-pusateri-dhc-dns-driu-00">https://datatracker.ietf.org/doc/html/draft-pusateri-dhc-dns-driu-00</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="dot1x">[dot1x]</dt>
        <dd>
<span class="refAuthor">OpenWrt</span>, <span class="refTitle">"Introduction to 802.1X"</span>, <time class="refDate" datetime="2021-12">December 2021</time>, <span>&lt;<a href="https://openwrt.org/docs/guide-user/network/wifi/wireless.security.8021x">https://openwrt.org/docs/guide-user/network/wifi/wireless.security.8021x</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Dragonblood">[Dragonblood]</dt>
        <dd>
<span class="refAuthor">Vanhoef, M.</span> and <span class="refAuthor">E. Ronen</span>, <span class="refTitle">"Dragonblood: Analyzing the Dragonfly Handshake of WPA3 and EAP-pwd"</span>, <span class="refContent">2020 IEEE Symposium on Security and Privacy (SP), San Francisco, pp. 517-533</span>, <span class="seriesInfo">DOI 10.1109/SP40000.2020.00031</span>, <time class="refDate" datetime="2020-05">May 2020</time>, <span>&lt;<a href="https://ieeexplore.ieee.org/document/9152782">https://ieeexplore.ieee.org/document/9152782</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Evil-Twin">[Evil-Twin]</dt>
        <dd>
<span class="refAuthor">Wikipedia</span>, <span class="refTitle">"Evil twin (wireless networks)"</span>, <time class="refDate" datetime="2022-11">November 2022</time>, <span>&lt;<a href="https://en.wikipedia.org/wiki/Evil_twin_(wireless_networks)">https://en.wikipedia.org/wiki/Evil_twin_(wireless_networks)</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IPSK">[IPSK]</dt>
        <dd>
<span class="refAuthor">Cisco</span>, <span class="refTitle">"8.5 Identity PSK Feature Deployment Guide"</span>, <time class="refDate" datetime="2021-12">December 2021</time>, <span>&lt;<a href="https://www.cisco.com/c/en/us/td/docs/wireless/controller/technotes/8-5/b_Identity_PSK_Feature_Deployment_Guide.html">https://www.cisco.com/c/en/us/td/docs/wireless/controller/technotes/8-5/b_Identity_PSK_Feature_Deployment_Guide.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Krack">[Krack]</dt>
        <dd>
<span class="refAuthor">Vanhoef, M.</span> and <span class="refAuthor">F. Piessens</span>, <span class="refTitle">"Key Reinstallation Attacks: Forcing Nonce Reuse in WPA2"</span>, <span class="refContent">CCS '17: Proceedings of the 2017 ACM SIGSAC Conference on Computer and Communications Security, pp. 1313-1328</span>, <span class="seriesInfo">DOI 10.1145/3133956.3134027</span>, <time class="refDate" datetime="2017-10">October 2017</time>, <span>&lt;<a href="https://dl.acm.org/doi/10.1145/3133956.3134027">https://dl.acm.org/doi/10.1145/3133956.3134027</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Local-DNS-Authority">[Local-DNS-Authority]</dt>
        <dd>
<span class="refAuthor">Reddy, T.</span>, <span class="refAuthor">Wing, D.</span>, <span class="refAuthor">Smith, K.</span>, and <span class="refAuthor">B. Schwartz</span>, <span class="refTitle">"Establishing Local DNS Authority in Validated Split-Horizon Environments"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-add-split-horizon-authority-04</span>, <time class="refDate" datetime="2023-03-08">8 March 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-add-split-horizon-authority-04">https://datatracker.ietf.org/doc/html/draft-ietf-add-split-horizon-authority-04</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ND">[ND]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"IPv6 Neighbor Discovery Option Formats"</span>, <span>&lt;<a href="https://www.iana.org/assignments/icmpv6-parameters/">https://www.iana.org/assignments/icmpv6-parameters/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3552">[RFC3552]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span> and <span class="refAuthor">B. Korver</span>, <span class="refTitle">"Guidelines for Writing RFC Text on Security Considerations"</span>, <span class="seriesInfo">BCP 72</span>, <span class="seriesInfo">RFC 3552</span>, <span class="seriesInfo">DOI 10.17487/RFC3552</span>, <time class="refDate" datetime="2003-07">July 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3552">https://www.rfc-editor.org/info/rfc3552</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3646">[RFC3646]</dt>
        <dd>
<span class="refAuthor">Droms, R., Ed.</span>, <span class="refTitle">"DNS Configuration options for Dynamic Host Configuration Protocol for IPv6 (DHCPv6)"</span>, <span class="seriesInfo">RFC 3646</span>, <span class="seriesInfo">DOI 10.17487/RFC3646</span>, <time class="refDate" datetime="2003-12">December 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3646">https://www.rfc-editor.org/info/rfc3646</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4786">[RFC4786]</dt>
        <dd>
<span class="refAuthor">Abley, J.</span> and <span class="refAuthor">K. Lindqvist</span>, <span class="refTitle">"Operation of Anycast Services"</span>, <span class="seriesInfo">BCP 126</span>, <span class="seriesInfo">RFC 4786</span>, <span class="seriesInfo">DOI 10.17487/RFC4786</span>, <time class="refDate" datetime="2006-12">December 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4786">https://www.rfc-editor.org/info/rfc4786</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time class="refDate" datetime="2008-05">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5280">https://www.rfc-editor.org/info/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6125">[RFC6125]</dt>
        <dd>
<span class="refAuthor">Saint-Andre, P.</span> and <span class="refAuthor">J. Hodges</span>, <span class="refTitle">"Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS)"</span>, <span class="seriesInfo">RFC 6125</span>, <span class="seriesInfo">DOI 10.17487/RFC6125</span>, <time class="refDate" datetime="2011-03">March 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6125">https://www.rfc-editor.org/info/rfc6125</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6731">[RFC6731]</dt>
        <dd>
<span class="refAuthor">Savolainen, T.</span>, <span class="refAuthor">Kato, J.</span>, and <span class="refAuthor">T. Lemon</span>, <span class="refTitle">"Improved Recursive DNS Server Selection for Multi-Interfaced Nodes"</span>, <span class="seriesInfo">RFC 6731</span>, <span class="seriesInfo">DOI 10.17487/RFC6731</span>, <time class="refDate" datetime="2012-12">December 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6731">https://www.rfc-editor.org/info/rfc6731</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7113">[RFC7113]</dt>
        <dd>
<span class="refAuthor">Gont, F.</span>, <span class="refTitle">"Implementation Advice for IPv6 Router Advertisement Guard (RA-Guard)"</span>, <span class="seriesInfo">RFC 7113</span>, <span class="seriesInfo">DOI 10.17487/RFC7113</span>, <time class="refDate" datetime="2014-02">February 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7113">https://www.rfc-editor.org/info/rfc7113</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7227">[RFC7227]</dt>
        <dd>
<span class="refAuthor">Hankins, D.</span>, <span class="refAuthor">Mrugalski, T.</span>, <span class="refAuthor">Siodelski, M.</span>, <span class="refAuthor">Jiang, S.</span>, and <span class="refAuthor">S. Krishnan</span>, <span class="refTitle">"Guidelines for Creating New DHCPv6 Options"</span>, <span class="seriesInfo">BCP 187</span>, <span class="seriesInfo">RFC 7227</span>, <span class="seriesInfo">DOI 10.17487/RFC7227</span>, <time class="refDate" datetime="2014-05">May 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7227">https://www.rfc-editor.org/info/rfc7227</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7513">[RFC7513]</dt>
        <dd>
<span class="refAuthor">Bi, J.</span>, <span class="refAuthor">Wu, J.</span>, <span class="refAuthor">Yao, G.</span>, and <span class="refAuthor">F. Baker</span>, <span class="refTitle">"Source Address Validation Improvement (SAVI) Solution for DHCP"</span>, <span class="seriesInfo">RFC 7513</span>, <span class="seriesInfo">DOI 10.17487/RFC7513</span>, <time class="refDate" datetime="2015-05">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7513">https://www.rfc-editor.org/info/rfc7513</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7610">[RFC7610]</dt>
        <dd>
<span class="refAuthor">Gont, F.</span>, <span class="refAuthor">Liu, W.</span>, and <span class="refAuthor">G. Van de Velde</span>, <span class="refTitle">"DHCPv6-Shield: Protecting against Rogue DHCPv6 Servers"</span>, <span class="seriesInfo">BCP 199</span>, <span class="seriesInfo">RFC 7610</span>, <span class="seriesInfo">DOI 10.17487/RFC7610</span>, <time class="refDate" datetime="2015-08">August 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7610">https://www.rfc-editor.org/info/rfc7610</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7824">[RFC7824]</dt>
        <dd>
<span class="refAuthor">Krishnan, S.</span>, <span class="refAuthor">Mrugalski, T.</span>, and <span class="refAuthor">S. Jiang</span>, <span class="refTitle">"Privacy Considerations for DHCPv6"</span>, <span class="seriesInfo">RFC 7824</span>, <span class="seriesInfo">DOI 10.17487/RFC7824</span>, <time class="refDate" datetime="2016-05">May 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7824">https://www.rfc-editor.org/info/rfc7824</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7844">[RFC7844]</dt>
        <dd>
<span class="refAuthor">Huitema, C.</span>, <span class="refAuthor">Mrugalski, T.</span>, and <span class="refAuthor">S. Krishnan</span>, <span class="refTitle">"Anonymity Profiles for DHCP Clients"</span>, <span class="seriesInfo">RFC 7844</span>, <span class="seriesInfo">DOI 10.17487/RFC7844</span>, <time class="refDate" datetime="2016-05">May 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7844">https://www.rfc-editor.org/info/rfc7844</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7858">[RFC7858]</dt>
        <dd>
<span class="refAuthor">Hu, Z.</span>, <span class="refAuthor">Zhu, L.</span>, <span class="refAuthor">Heidemann, J.</span>, <span class="refAuthor">Mankin, A.</span>, <span class="refAuthor">Wessels, D.</span>, and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Specification for DNS over Transport Layer Security (TLS)"</span>, <span class="seriesInfo">RFC 7858</span>, <span class="seriesInfo">DOI 10.17487/RFC7858</span>, <time class="refDate" datetime="2016-05">May 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7858">https://www.rfc-editor.org/info/rfc7858</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7969">[RFC7969]</dt>
        <dd>
<span class="refAuthor">Lemon, T.</span> and <span class="refAuthor">T. Mrugalski</span>, <span class="refTitle">"Customizing DHCP Configuration on the Basis of Network Topology"</span>, <span class="seriesInfo">RFC 7969</span>, <span class="seriesInfo">DOI 10.17487/RFC7969</span>, <time class="refDate" datetime="2016-10">October 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7969">https://www.rfc-editor.org/info/rfc7969</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8146">[RFC8146]</dt>
        <dd>
<span class="refAuthor">Harkins, D.</span>, <span class="refTitle">"Adding Support for Salted Password Databases to EAP-pwd"</span>, <span class="seriesInfo">RFC 8146</span>, <span class="seriesInfo">DOI 10.17487/RFC8146</span>, <time class="refDate" datetime="2017-04">April 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8146">https://www.rfc-editor.org/info/rfc8146</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8310">[RFC8310]</dt>
        <dd>
<span class="refAuthor">Dickinson, S.</span>, <span class="refAuthor">Gillmor, D.</span>, and <span class="refAuthor">T. Reddy</span>, <span class="refTitle">"Usage Profiles for DNS over TLS and DNS over DTLS"</span>, <span class="seriesInfo">RFC 8310</span>, <span class="seriesInfo">DOI 10.17487/RFC8310</span>, <time class="refDate" datetime="2018-03">March 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8310">https://www.rfc-editor.org/info/rfc8310</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8484">[RFC8484]</dt>
        <dd>
<span class="refAuthor">Hoffman, P.</span> and <span class="refAuthor">P. McManus</span>, <span class="refTitle">"DNS Queries over HTTPS (DoH)"</span>, <span class="seriesInfo">RFC 8484</span>, <span class="seriesInfo">DOI 10.17487/RFC8484</span>, <time class="refDate" datetime="2018-10">October 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8484">https://www.rfc-editor.org/info/rfc8484</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8499">[RFC8499]</dt>
        <dd>
<span class="refAuthor">Hoffman, P.</span>, <span class="refAuthor">Sullivan, A.</span>, and <span class="refAuthor">K. Fujiwara</span>, <span class="refTitle">"DNS Terminology"</span>, <span class="seriesInfo">BCP 219</span>, <span class="seriesInfo">RFC 8499</span>, <span class="seriesInfo">DOI 10.17487/RFC8499</span>, <time class="refDate" datetime="2019-01">January 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8499">https://www.rfc-editor.org/info/rfc8499</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8613">[RFC8613]</dt>
        <dd>
<span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Mattsson, J.</span>, <span class="refAuthor">Palombini, F.</span>, and <span class="refAuthor">L. Seitz</span>, <span class="refTitle">"Object Security for Constrained RESTful Environments (OSCORE)"</span>, <span class="seriesInfo">RFC 8613</span>, <span class="seriesInfo">DOI 10.17487/RFC8613</span>, <time class="refDate" datetime="2019-07">July 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8613">https://www.rfc-editor.org/info/rfc8613</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8801">[RFC8801]</dt>
        <dd>
<span class="refAuthor">Pfister, P.</span>, <span class="refAuthor">Vyncke, É.</span>, <span class="refAuthor">Pauly, T.</span>, <span class="refAuthor">Schinazi, D.</span>, and <span class="refAuthor">W. Shao</span>, <span class="refTitle">"Discovering Provisioning Domain Names and Data"</span>, <span class="seriesInfo">RFC 8801</span>, <span class="seriesInfo">DOI 10.17487/RFC8801</span>, <time class="refDate" datetime="2020-07">July 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8801">https://www.rfc-editor.org/info/rfc8801</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9076">[RFC9076]</dt>
        <dd>
<span class="refAuthor">Wicinski, T., Ed.</span>, <span class="refTitle">"DNS Privacy Considerations"</span>, <span class="seriesInfo">RFC 9076</span>, <span class="seriesInfo">DOI 10.17487/RFC9076</span>, <time class="refDate" datetime="2021-07">July 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9076">https://www.rfc-editor.org/info/rfc9076</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9250">[RFC9250]</dt>
        <dd>
<span class="refAuthor">Huitema, C.</span>, <span class="refAuthor">Dickinson, S.</span>, and <span class="refAuthor">A. Mankin</span>, <span class="refTitle">"DNS over Dedicated QUIC Connections"</span>, <span class="seriesInfo">RFC 9250</span>, <span class="seriesInfo">DOI 10.17487/RFC9250</span>, <time class="refDate" datetime="2022-05">May 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9250">https://www.rfc-editor.org/info/rfc9250</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9462">[RFC9462]</dt>
        <dd>
<span class="refAuthor">Pauly, T.</span>, <span class="refAuthor">Kinnear, E.</span>, <span class="refAuthor">Wood, C. A.</span>, <span class="refAuthor">McManus, P.</span>, and <span class="refAuthor">T. Jensen</span>, <span class="refTitle">"Discovery of Designated Resolvers"</span>, <span class="seriesInfo">RFC 9462</span>, <span class="seriesInfo">DOI 10.17487/RFC9462</span>, <time class="refDate" datetime="2023-11">November 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9462">https://www.rfc-editor.org/info/rfc9462</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TS.24008">[TS.24008]</dt>
      <dd>
<span class="refAuthor">3GPP</span>, <span class="refTitle">"Technical Specification Group Core Network and Terminals; Mobile radio interface Layer 3 specification; Core network protocols; Stage 3 (Release 18)"</span>, <span class="refContent">version 18.4.0</span>, <time class="refDate" datetime="2023-09">September 2023</time>, <span>&lt;<a href="https://www.3gpp.org/DynaReport/24008.htm">https://www.3gpp.org/DynaReport/24008.htm</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<section id="appendix-A">
      <h2 id="name-acknowledgments">
<a class="section-name selfRef" href="#name-acknowledgments">Acknowledgments</a>
      </h2>
<p id="appendix-A-1">Many thanks to <span class="contact-name">Christian Jacquenet</span> and <span class="contact-name">Michael Richardson</span> for their
      reviews.<a class="pilcrow" href="#appendix-A-1">¶</a></p>
<p id="appendix-A-2">Thanks to <span class="contact-name">Stephen Farrell</span>, <span class="contact-name">Martin Thomson</span>, <span class="contact-name">Vittorio Bertola</span>, <span class="contact-name">Stéphane Bortzmeyer</span>, <span class="contact-name">Ben Schwartz</span>, <span class="contact-name">Iain Sharp</span>, and <span class="contact-name">Chris Box</span> for their
      comments.<a class="pilcrow" href="#appendix-A-2">¶</a></p>
<p id="appendix-A-3">Thanks to <span class="contact-name">Mark Nottingham</span> for the feedback on HTTP redirection that
      was discussed in previous draft versions of this specification.<a class="pilcrow" href="#appendix-A-3">¶</a></p>
<p id="appendix-A-4">The use of DHCP as a candidate protocol to retrieve an ADN was
      mentioned in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8310#section-7.3.1">Section 7.3.1</a> of [<a class="cite xref" href="#RFC8310">RFC8310</a>]</span> and in an
      Internet-Draft authored by <span class="contact-name">Tom Pusateri</span> and <span class="contact-name">Willem Toorop</span> <span>[<a class="cite xref" href="#I-D.pusateri-dhc-dns-driu">DNS-TLS-DHCPv6-Opt</a>]</span>.<a class="pilcrow" href="#appendix-A-4">¶</a></p>
<p id="appendix-A-5">Thanks to <span class="contact-name">Bernie Volz</span> for the review of the DHCP part.<a class="pilcrow" href="#appendix-A-5">¶</a></p>
<p id="appendix-A-6"><span class="contact-name">Christian Amsüss</span> reported a case where the ALPN service parameter cannot
      be used.<a class="pilcrow" href="#appendix-A-6">¶</a></p>
<p id="appendix-A-7">Thanks to <span class="contact-name">Andrew Campling</span> for the Shepherd review and <span class="contact-name">Éric Vyncke</span> for
      the AD review.<a class="pilcrow" href="#appendix-A-7">¶</a></p>
<p id="appendix-A-8">Thanks to <span class="contact-name">Rich Salz</span> for the secdir reviews, <span class="contact-name">Joe Clarke</span> for the
      opsdir review, <span class="contact-name">Robert Sparks</span> for the artart review, and <span class="contact-name">David Blacka</span>
      for the dnsdir review.<a class="pilcrow" href="#appendix-A-8">¶</a></p>
<p id="appendix-A-9">Thanks to <span class="contact-name">Lars Eggert</span>, <span class="contact-name">Roman Danyliw</span>, <span class="contact-name">Erik Kline</span>, <span class="contact-name">Martin Duke</span>, <span class="contact-name">Robert Wilton</span>, <span class="contact-name">Paul Wouters</span>, and <span class="contact-name">Zaheduzzaman Sarker</span> for the IESG review.<a class="pilcrow" href="#appendix-A-9">¶</a></p>
</section>
<section id="appendix-B">
      <h2 id="name-contributors">
<a class="section-name selfRef" href="#name-contributors">Contributors</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Nicolai Leymann</span></div>
<div class="left" dir="auto"><span class="org">Deutsche Telekom</span></div>
<div class="left" dir="auto"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:n.leymann@telekom.de">n.leymann@telekom.de</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Zhiwei Yan</span></div>
<div class="left" dir="auto"><span class="org">CNNIC</span></div>
<div class="left" dir="auto"><span class="street-address">No.4 South 4th Street, Zhongguancun</span></div>
<div class="left" dir="auto"><span class="locality">Beijing</span></div>
<div class="left" dir="auto"><span class="postal-code">100190</span></div>
<div class="left" dir="auto"><span class="country-name">China</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:yan@cnnic.cn">yan@cnnic.cn</a>
</div>
</address>
</section>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-addresses">
<a class="section-name selfRef" href="#name-authors-addresses">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Mohamed Boucadair (<span class="role">editor</span>)</span></div>
<div class="left" dir="auto"><span class="org">Orange</span></div>
<div class="left" dir="auto">
<span class="postal-code">35000</span> <span class="locality">Rennes</span>
</div>
<div class="left" dir="auto"><span class="country-name">France</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:mohamed.boucadair@orange.com">mohamed.boucadair@orange.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Tirumaleswar Reddy.K (<span class="role">editor</span>)</span></div>
<div class="left" dir="auto"><span class="org">Nokia</span></div>
<div class="left" dir="auto"><span class="country-name">India</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:kondtir@gmail.com">kondtir@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Dan Wing</span></div>
<div class="left" dir="auto"><span class="org">Cloud Software Group Holdings, Inc.</span></div>
<div class="left" dir="auto"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:dwing-ietf@fuggles.com">dwing-ietf@fuggles.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Neil Cook</span></div>
<div class="left" dir="auto"><span class="org">Open-Xchange</span></div>
<div class="left" dir="auto"><span class="country-name">United Kingdom</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:neil.cook@noware.co.uk">neil.cook@noware.co.uk</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Tommy Jensen</span></div>
<div class="left" dir="auto"><span class="org">Microsoft</span></div>
<div class="left" dir="auto"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:tojens@microsoft.com">tojens@microsoft.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>