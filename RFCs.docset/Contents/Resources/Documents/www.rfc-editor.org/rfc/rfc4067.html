<html><head></head><body><pre>Network Working Group                                   J. Loughney, Ed.
Request for Comments: 4067                                   M. Nakhjiri
Category: Experimental                                        C. Perkins
                                                               R. Koodli
                                                               July 2005


                    <span class="h1">Context Transfer Protocol (CXTP)</span>

Status of This Memo

   This memo defines an Experimental Protocol for the Internet
   community.  It does not specify an Internet standard of any kind.
   Discussion and suggestions for improvement are requested.
   Distribution of this memo is unlimited.

Copyright Notice

   Copyright (C) The Internet Society (2005).

Abstract

   This document presents the Context Transfer Protocol (CXTP) that
   enables authorized context transfers.  Context transfers allow better
   support for node based mobility so that the applications running on
   mobile nodes can operate with minimal disruption.  Key objectives are
   to reduce latency and packet losses, and to avoid the re-initiation
   of signaling to and from the mobile node.

Table of Contents

   <a href="#section-1">1</a>.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-2">2</a>
       <a href="#section-1.1">1.1</a>.  The Problem. . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-2">2</a>
       <a href="#section-1.2">1.2</a>.  Conventions Used in This Document. . . . . . . . . . . .  <a href="#page-3">3</a>
       <a href="#section-1.3">1.3</a>.  Abbreviations Used in the Document . . . . . . . . . . .  <a href="#page-3">3</a>
   <a href="#section-2">2</a>.  Protocol Overview. . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-3">3</a>
       <a href="#section-2.1">2.1</a>.  Context Transfer Scenarios . . . . . . . . . . . . . . .  <a href="#page-4">4</a>
       <a href="#section-2.2">2.2</a>.  Context Transfer Message Format. . . . . . . . . . . . .  <a href="#page-5">5</a>
       <a href="#section-2.3">2.3</a>.  Context Types. . . . . . . . . . . . . . . . . . . . . .  <a href="#page-6">6</a>
       <a href="#section-2.4">2.4</a>.  Context Data Block (CDB) . . . . . . . . . . . . . . . .  <a href="#page-7">7</a>
       <a href="#section-2.5">2.5</a>.  Messages . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-8">8</a>
   <a href="#section-3">3</a>.  Transport. . . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-16">16</a>
       <a href="#section-3.1">3.1</a>.  Inter-Router Transport . . . . . . . . . . . . . . . . . <a href="#page-16">16</a>
       <a href="#section-3.2">3.2</a>.  MN-AR Transport. . . . . . . . . . . . . . . . . . . . . <a href="#page-19">19</a>
   <a href="#section-4">4</a>.  Error Codes and Constants. . . . . . . . . . . . . . . . . . . <a href="#page-20">20</a>
   <a href="#section-5">5</a>.  Examples and Signaling Flows . . . . . . . . . . . . . . . . . <a href="#page-21">21</a>
       <a href="#section-5.1">5.1</a>.  Network controlled, Initiated by pAR, Predictive . . . . <a href="#page-21">21</a>
       <a href="#section-5.2">5.2</a>.  Network controlled, Initiated by nAR, Reactive . . . . . <a href="#page-21">21</a>



<span class="grey">Loughney, et al.              Experimental                      [Page 1]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-2"></span>
<span class="grey"><a href="./rfc4067">RFC 4067</a>            Context Transfer Protocol (CXTP)           July 2005</span>


       <a href="#section-5.3">5.3</a>.  Mobile controlled, Predictive New L2 up/Old L2 down. . . <a href="#page-22">22</a>
   <a href="#section-6">6</a>.  Security Considerations. . . . . . . . . . . . . . . . . . . . <a href="#page-22">22</a>
       <a href="#section-6.1">6.1</a>.  Threats. . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-22">22</a>
       <a href="#section-6.2">6.2</a>.  Access Router Considerations . . . . . . . . . . . . . . <a href="#page-23">23</a>
       <a href="#section-6.3">6.3</a>.  Mobile Node Considerations . . . . . . . . . . . . . . . <a href="#page-24">24</a>
   <a href="#section-7">7</a>.  Acknowledgements &amp; Contributors. . . . . . . . . . . . . . . . <a href="#page-25">25</a>
   <a href="#section-8">8</a>.  References . . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-25">25</a>
       <a href="#section-8.1">8.1</a>.  Normative References . . . . . . . . . . . . . . . . . . <a href="#page-25">25</a>
       <a href="#section-8.2">8.2</a>.  Informative References . . . . . . . . . . . . . . . . . <a href="#page-26">26</a>
   <a href="#appendix-A">Appendix A</a>.  Timing and Trigger Considerations . . . . . . . . . . <a href="#page-28">28</a>
   <a href="#appendix-B">Appendix B</a>.  Multicast Listener Context Transfer . . . . . . . . . <a href="#page-28">28</a>

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" id="section-1">1</a>.  Introduction</span>

   This document describes the Context Transfer Protocol, which
   provides:

      *  Representation for feature contexts.

      *  Messages to initiate and authorize context transfer, and notify
         a mobile node of the status of the transfer.

      *  Messages for transferring contexts prior to, during and after
         handovers.

   The proposed protocol is designed to work in conjunction with other
   protocols in order to provide seamless mobility.  The protocol
   supports both IPv4 and IPv6, though support for IPv4 private
   addresses is for future study.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/1.1.%20%20The%20Problem"></a><a class="selflink" href="#section-1.1" id="section-1.1">1.1</a>.  The Problem</span>

   "Problem Description: Reasons For Performing Context Transfers
   between Nodes in an IP Access Network" [<a href="./rfc3374" title='"Problem Description: Reasons For Performing Context Transfers Between Nodes in an IP Access Network"'>RFC3374</a>] defines the
   following main reasons why Context Transfer procedures may be useful
   in IP networks.

   1) As mentioned in the introduction, the primary motivation is to
      quickly re-establish context transfer-candidate services without
      requiring the mobile host to explicitly perform all protocol flows
      for those services from scratch.  An example of such a service is
      included in <a href="#appendix-B">Appendix B</a> of this document.

   2) An additional motivation is to provide an interoperable solution
      that supports various Layer 2 radio access technologies.






<span class="grey">Loughney, et al.              Experimental                      [Page 2]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-3"></span>
<span class="grey"><a href="./rfc4067">RFC 4067</a>            Context Transfer Protocol (CXTP)           July 2005</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/1.2.%20%20Conventions%20Used%20in%20This%20Document"></a><a class="selflink" href="#section-1.2" id="section-1.2">1.2</a>.  Conventions Used in This Document</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in <a href="./rfc2119">RFC 2119</a> [<a href="./rfc2119" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/1.3.%20%20Abbreviations%20Used%20in%20the%20Document"></a><a class="selflink" href="#section-1.3" id="section-1.3">1.3</a>.  Abbreviations Used in the Document</span>

   Mobility Related Terminology [<a href="#ref-TERM" title='"Mobility Related Terminology"'>TERM</a>] defines basic mobility
   terminology.  In addition to the material in that document, we use
   the following terms and abbreviations in this document.

      CXTP            Context Transfer Protocol

      DoS             Denial-of-Service

      FPT             Feature Profile Types

      PCTD            Predictive Context Transfer Data

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.%20%20Protocol%20Overview"></a><a class="selflink" href="#section-2" id="section-2">2</a>.  Protocol Overview</span>

   This section provides a protocol overview.  A context transfer can be
   either started by a request from the mobile node ("mobile
   controlled") or at the initiative of the new or the previous access
   router ("network controlled").

      *  The mobile node (MN) sends the CT Activate Request (CTAR) to
         its current access router (AR) immediately prior to handover
         when it is possible to initiate a predictive context transfer.
         In any case, the MN always sends the CTAR message to the new AR
         (nAR).  If the contexts are already present, nAR verifies the
         authorization token present in CTAR with its own computation
         using the parameters supplied by the previous access router
         (pAR), and subsequently activates those contexts.  If the
         contexts are not present, nAR requests pAR to supply them using
         the Context Transfer Request message, in which it supplies the
         authorization token present in CTAR.

      *  Either nAR or pAR may request or start (respectively) context
         transfer based on internal or network triggers (see <a href="#appendix-A">Appendix</a>
         <a href="#appendix-A">A</a>).

   The Context Transfer protocol typically operates between a source
   node and a target node.  In the future, there may be multiple target
   nodes involved; the protocol described here would work with multiple
   target nodes.  For simplicity, we describe the protocol assuming a
   single receiver or target node.



<span class="grey">Loughney, et al.              Experimental                      [Page 3]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-4"></span>
<span class="grey"><a href="./rfc4067">RFC 4067</a>            Context Transfer Protocol (CXTP)           July 2005</span>


   Typically, the source node is an MN's pAR and the target node is an
   MN's nAR.  Context Transfer takes place when an event, such as a
   handover, takes place.  We call such an event a Context Transfer
   Trigger.  In response to such a trigger, the pAR may transfer the
   contexts; the nAR may request contexts; and the MN may send a message
   to the routers to transfer contexts.  Such a trigger must be capable
   of providing the necessary information (such as the MN's IP address)
   by which the contexts are identified.  In addition, the trigger must
   be able to provide the IP addresses of the access routers, and the
   authorization to transfer context.

   Context transfer protocol messages use Feature Profile Types (FPTs)
   that identify the way that data is organized for the particular
   feature contexts.  The FPTs are registered in a number space (with
   IANA Type Numbers) that allows a node to unambiguously determine the
   type of context and the context parameters present in the protocol
   messages.  Contexts are transferred by laying out the appropriate
   feature data within Context Data Blocks according to the format in
   <a href="#section-2.3">Section 2.3</a>, as well as any IP addresses necessary to associate the
   contexts to a particular MN.  The context transfer initiation
   messages contain parameters that identify the source and target
   nodes, the desired list of feature contexts, and IP addresses to
   identify the contexts.  The messages that request the transfer of
   context data also contain an appropriate token to authorize the
   context transfer.

   Performing a context transfer in advance of the MN attaching to nAR
   can increase handover performance.  For this to take place, certain
   conditions must be met.  For example, pAR must have sufficient time
   and knowledge of the impending handover.  This is feasible, for
   instance, in Mobile IP fast handovers [<a href="#ref-LLMIP" title='"Low Latency Handoffs in Mobile IPv4"'>LLMIP</a>][FMIPv6].  Additionally,
   many cellular networks have mechanisms to detect handovers in
   advance.  However, when the advance knowledge of impending handover
   is not available, or if a mechanism such as fast handover fails,
   retrieving feature contexts after the MN attaches to nAR is the only
   available means for context transfer.  Performing context transfer
   after handover might still be better than having to re-establish all
   the contexts from scratch, as shown in [<a href="#ref-FHCT" title='"Fast Handovers and Context Transfers"'>FHCT</a>] and [<a href="#ref-TEXT" title='"A time efficient context transfer method with Selective reliability for seamless IP mobility"'>TEXT</a>].  Finally,
   some contexts may simply need to be transferred during handover
   signaling.  For instance, any context that gets updated on a per-
   packet basis must clearly be transferred only after packet forwarding
   to the MN on its previous link has been terminated.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.1.%20%20Context%20Transfer%20Scenarios"></a><a class="selflink" href="#section-2.1" id="section-2.1">2.1</a>.  Context Transfer Scenarios</span>

   The Previous Access Router transfers feature contexts under two
   general scenarios.




<span class="grey">Loughney, et al.              Experimental                      [Page 4]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-5"></span>
<span class="grey"><a href="./rfc4067">RFC 4067</a>            Context Transfer Protocol (CXTP)           July 2005</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.1.1.%20%20Scenario%201"></a><a class="selflink" href="#section-2.1.1" id="section-2.1.1">2.1.1</a>.  Scenario 1</span>

   The pAR receives a Context Transfer Activate Request (CTAR) message
   from the MN whose feature contexts are to be transferred, or it
   receives an internally generated trigger (e.g., a link-layer trigger
   on the interface to which the MN is connected).  The CTAR message,
   described in <a href="#section-2.5">Section 2.5</a>, provides the IP address of nAR, the IP
   address of MN on pAR, the list of feature contexts to be transferred
   (by default requesting all contexts to be transferred), and a token
   authorizing the transfer.  In response to a CT-Activate Request
   message or to the CT trigger, pAR predictively transmits a Context
   Transfer Data (CTD) message that contains feature contexts.  This
   message, described in <a href="#section-2.5">Section 2.5</a>, contains the MN's previous IP
   address.  It also contains parameters for nAR to compute an
   authorization token to verify the MN's token that is present in the
   CTAR message.  Recall that the MN always sends a CTAR message to nAR
   regardless of whether it sent the CTAR message to pAR because there
   is no means for the MN to ascertain that context transfer has
   reliably taken place.  By always sending the CTAR message to nAR, the
   Context Transfer Request (see below) can be sent to pAR if necessary.

   When context transfer takes place without the nAR requesting it, nAR
   requires MN to present its authorization token.  Doing this locally
   at nAR when the MN attaches to it improves performance and increases
   security, since the contexts are likely to already be present.  Token
   verification takes place at the router possessing the contexts.

<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.1.2.%20%20Scenario%202"></a><a class="selflink" href="#section-2.1.2" id="section-2.1.2">2.1.2</a>.  Scenario 2</span>

   In the second scenario, pAR receives a Context Transfer Request (CT-
   Req) message from nAR, as described in <a href="#section-2.5">Section 2.5</a>.  The nAR itself
   generates the CT-Req message as a result of receiving the CTAR
   message, or alternatively, from receiving a context transfer trigger.
   In the CT-Req message, nAR supplies the MN's previous IP address, the
   FPTs for the feature contexts to be transferred, the sequence number
   from the CTAR, and the authorization token from the CTAR.  In
   response to a CT-Req message, pAR transmits a Context Transfer Data
   (CTD) message that includes the MN's previous IP address and feature
   contexts.  When it receives a corresponding CTD message, nAR may
   generate a CTD Reply (CTDR) message to report the status of
   processing the received contexts.  The nAR installs the contexts once
   it has received them from the pAR.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.2.%20%20Context%20Transfer%20Message%20Format"></a><a class="selflink" href="#section-2.2" id="section-2.2">2.2</a>.  Context Transfer Message Format</span>

   A CXTP message consists of a message-specific header and one or more
   data blocks.  Data blocks may be bundled together to ensure a more
   efficient transfer.  On the inter-AR interface, SCTP is used so



<span class="grey">Loughney, et al.              Experimental                      [Page 5]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-6"></span>
<span class="grey"><a href="./rfc4067">RFC 4067</a>            Context Transfer Protocol (CXTP)           July 2005</span>


   fragmentation should not be a problem.  On the MN-AR interface, the
   total packet size, including transport protocol and IP protocol
   headers, SHOULD be less than the path MTU to avoid packet
   fragmentation.  Each message contains a 3 bit version number field in
   the low order octet, along with the 5 bit message type code.  This
   specification only applies to Version 1 of the protocol, and the
   therefore version number field MUST be set to 0x1.  If future
   revisions of the protocol make binary incompatible changes, the
   version number MUST be incremented.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.3.%20%20Context%20Types"></a><a class="selflink" href="#section-2.3" id="section-2.3">2.3</a>.  Context Types</span>

   Contexts are identified by the FPT code, which is a 16 bit unsigned
   integer.  The meaning of each context type is determined by a
   specification document.  The context type numbers are to be tabulated
   in a registry maintained by IANA [<a href="#ref-IANA" title='"Instructions for Seamoby and Experimental Mobility Protocol IANA Allocations"'>IANA</a>] and handled according to the
   message specifications in this document.  The instantiation of each
   context by nAR is determined by the messages in this document along
   with the specification associated with the particular context type.
   The following diagram illustrates the general format for CXTP
   messages:

               +----------------------+
               |    Message Header    |
               +----------------------+
               |     CXTP Data 1      |
               +----------------------+
               |     CXTP Data 2      |
               +----------------------+
               |         ...          |

   Each context type specification contains the following details:

      -  Number, size (in bits), and ordering of data fields in the
         state variable vector that embodies the context.

      -  Default values (if any) for each individual datum of the
         context state vector.

      -  Procedures and requirements for creating a context at a new
         access router, given the data transferred from a previous
         access router and formatted according to the ordering rules and
         data field sizes presented in the specification.

      -  If possible, status codes for success or failure related to the
         context transfer.  For instance, a QoS context transfer might
         have different status codes depending on which elements of the
         context data failed to be instantiated at nAR.



<span class="grey">Loughney, et al.              Experimental                      [Page 6]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-7"></span>
<span class="grey"><a href="./rfc4067">RFC 4067</a>            Context Transfer Protocol (CXTP)           July 2005</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.4.%20%20Context%20Data%20Block%20%28CDB%29"></a><a class="selflink" href="#section-2.4" id="section-2.4">2.4</a>.  Context Data Block (CDB)</span>

   The Context Data Block (CDB) is used both for request and response
   operations.  When a request is constructed, only the first 4 octets
   are typically necessary (See CTAR below).  When used for transferring
   the actual feature context itself, the context data is present, and
   the presence vector is sometimes present.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   Feature Profile Type (FPT)  |  Length       |P|  Reserved   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                   Presence Vector (if P = 1)                  |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ~                              Data                             ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

      Feature Profile Type
                           16 bit integer, assigned by IANA,
                           indicating the type of data
                           included in the Data field.

      Length               Message length in units of 8 octet words.

      'P' bit              0 = No presence vector.
                           1 = Presence vector present.

      Reserved             Reserved for future use.  Set to
                           zero by the sender.

      Data                 Context type-dependent data, whose
                           length is defined by the Length
                           Field.  If the data is not 64 bit
                           aligned, the data field is
                           padded with zeros.

   The Feature Profile Type (FPT) code indicates the type of data in the
   data field.  Typically, this will be context data, but it could be an
   error indication.  The 'P' bit specifies whether the "presence
   vector" is used.  When the presence vector is in use, it is
   interpreted to indicate whether particular data fields are present
   (and contain non-default values).  The ordering of the bits in the
   presence vector is the same as the ordering of the data fields
   according to the context type specification, one bit per data field
   regardless of the size of the data field.  The Length field indicates
   the size of the CDB in 8 octet words, including the first 4 octets
   starting from FPT.



<span class="grey">Loughney, et al.              Experimental                      [Page 7]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-8"></span>
<span class="grey"><a href="./rfc4067">RFC 4067</a>            Context Transfer Protocol (CXTP)           July 2005</span>


   Notice that the length of the context data block is defined by the
   sum of the lengths of each data field specified by the context type
   specification, plus 4 octets if the 'P' bit is set, minus the
   accumulated size of all the context data that is implicitly given as
   a default value.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.5.%20%20Messages"></a><a class="selflink" href="#section-2.5" id="section-2.5">2.5</a>.  Messages</span>

   In this section, the CXTP messages are defined.  The MN for which
   context transfer protocol operations are undertaken is always
   identified by its previous IP access address.  Only one context
   transfer operation per MN may be in progress at a time so that the
   CTDR message unambiguously identifies which CTD message is
   acknowledged simply by including the MN's identifying previous IP
   address.  The 'V' flag indicates whether the IP addresses are IPv4 or
   IPv6.

<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.5.1.%20%20Context%20Transfer%20Activate%20Request%20%28CTAR%29%20Message"></a><a class="selflink" href="#section-2.5.1" id="section-2.5.1">2.5.1</a>.  Context Transfer Activate Request (CTAR) Message</span>

   This message is always sent by the MN to the nAR to request a context
   transfer.  Even when the MN does not know if contexts need to be
   transferred, the MN sends the CTAR message.  If an acknowledgement
   for this message is needed, the MN sets the 'A' flag to 1; otherwise
   the MN does not expect an acknowledgement.  This message may include
   a list of FPTs that require transfer.

   The MN may also send this message to pAR while still connected to
   pAR.  In this case, the MN includes the nAR's IP address; otherwise,
   if the message is sent to nAR, the pAR address is sent.  The MN MUST
   set the sequence number to the same value as was set for the message
   sent on both pAR and nAR so pAR can determine whether to use a cached
   message.



















<span class="grey">Loughney, et al.              Experimental                      [Page 8]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-9"></span>
<span class="grey"><a href="./rfc4067">RFC 4067</a>            Context Transfer Protocol (CXTP)           July 2005</span>


    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |Vers.|   Type  |V|A| Reserved  |            Length             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ~                   MN's Previous IP Address                    ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ~                  Previous (New) AR IP Address                 ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                        Sequence Number                        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                     MN Authorization Token                    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |            Requested Context Data Block (if present)          |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |          Next Requested Context Data Block (if present)       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                           ........                            |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

      Vers.                Version number of CXTP protocol = 0x1

      Type                 CTAR = 0x1

      'V' flag             When set to '0', IPv6 addresses.
                           When set to '1', IPv4 addresses.

      'A' bit              If set, the MN requests an acknowledgement.

      Reserved             Set to zero by the sender, ignored by the
                           receiver.

      Length               Message length in units of octets.

      MN's Previous IP Address Field contains either:
                           IPv4 [<a href="./rfc791" title='"Internet Protocol"'>RFC791</a>] Address, 4 octets, or
                           IPv6 [<a href="./rfc3513" title='"Internet Protocol Version 6 (IPv6) Addressing Architecture"'>RFC3513</a>] Address, 16 octets.

      nAR / pAR IP Address Field contains either:
                           IPv4 [<a href="./rfc791" title='"Internet Protocol"'>RFC791</a>] Address, 4 octets, or
                           IPv6 [<a href="./rfc3513" title='"Internet Protocol Version 6 (IPv6) Addressing Architecture"'>RFC3513</a>] Address, 16 octets.

      Sequence Number      A value used to identify requests and
                           acknowledgements (see <a href="#section-3.2">Section 3.2</a>).







<span class="grey">Loughney, et al.              Experimental                      [Page 9]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-10"></span>
<span class="grey"><a href="./rfc4067">RFC 4067</a>            Context Transfer Protocol (CXTP)           July 2005</span>


      Authorization Token  An unforgeable value calculated as
                           discussed below.  This authorizes the
                           receiver of CTAR to perform context
                           transfer.

      Context Block        Variable length field defined in
                           <a href="#section-2.4">Section 2.4</a>.

   If no context types are specified, all contexts for the MN are
   requested.

   The Authorization Token is calculated as:

      First (32, HMAC_SHA1
              (Key, (Previous IP address | Sequence Number | CDBs)))

   where Key is a shared secret between the MN and pAR, and CDB is a
   concatenation of all the Context Data Blocks specifying the contexts
   to be transferred that are included in the CTAR message.

<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.5.2.%20%20Context%20Transfer%20Activate%20Acknowledge%20%28CTAA%29%20Message"></a><a class="selflink" href="#section-2.5.2" id="section-2.5.2">2.5.2</a>.  Context Transfer Activate Acknowledge (CTAA) Message</span>

   This is an informative message sent by the receiver of CTAR to the MN
   to acknowledge a CTAR message.  Acknowledgement is optional,
   depending on whether the MN requested it.  This message may include a
   list of FPTs that were not successfully transferred.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |Vers.|  Type   |V|  Reserved   |            Length             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ~              Mobile Node's Previous IP address                ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |       FPT (if present)        |  Status code  |   Reserved    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                           ........                            |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

      Vers.                Version number of CXTP protocol = 0x1

      Type                 CTAA = 0x2

      'V' flag             When set to '0', IPv6 addresses.
                           When set to '1', IPv4 addresses.

      Reserved             Set to zero by the sender and ignored by
                           the receiver.



<span class="grey">Loughney, et al.              Experimental                     [Page 10]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-11"></span>
<span class="grey"><a href="./rfc4067">RFC 4067</a>            Context Transfer Protocol (CXTP)           July 2005</span>


      Length               Message length in units of octets.

      MN's Previous IP Address Field contains either:
                           IPv4 [<a href="./rfc791" title='"Internet Protocol"'>RFC791</a>] Address, 4 octets, or
                           IPv6 [<a href="./rfc3513" title='"Internet Protocol Version 6 (IPv6) Addressing Architecture"'>RFC3513</a>] Address, 16 octets.

      FPT                  16 bit unsigned integer, listing the Feature
                           Profile Type that was not successfully
                           transferred.

      Status Code          An octet, containing failure reason.

      ........             more FPTs and status codes as necessary

<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.5.3.%20%20Context%20Transfer%20Data%20%28CTD%29%20Message"></a><a class="selflink" href="#section-2.5.3" id="section-2.5.3">2.5.3</a>.  Context Transfer Data (CTD) Message</span>

   Sent by pAR to nAR, and includes feature data (CXTP data).  This
   message handles both predictive and normal CT.  An acknowledgement
   flag, 'A', included in this message indicates whether a reply is
   required by pAR.

   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |Vers.|   Type  |V|A| Reserved  |          Length               |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |               Elapsed Time (in milliseconds)                  |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  ~            Mobile Node's Previous Care-of Address             ~
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ^
  |            Algorithm          |            Key Length         |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ PCTD
  |                              Key                              | only
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ V
  ~                   First Context Data Block                    ~
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  ~                    Next Context Data Block                    ~
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  ~                           ........                            ~
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

      Vers.                Version number of CXTP protocol = 0x1

      Type                 CTD =  0x3 (Context Transfer Data)
                           PCTD = 0x4 (Predictive Context Transfer
                                       Data)





<span class="grey">Loughney, et al.              Experimental                     [Page 11]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-12"></span>
<span class="grey"><a href="./rfc4067">RFC 4067</a>            Context Transfer Protocol (CXTP)           July 2005</span>


      'V' flag             When set to '0', IPv6 addresses.
                           When set to '1', IPv4 addresses.

      'A' bit              When set, the pAR requests an
                           acknowledgement.

      Length               Message length in units of octets.

      Elapsed Time         The number of milliseconds since the
                           transmission of the first CTD message for
                           this MN.

      MN's Previous IP Address Field contains either:
                           IPv4 [<a href="./rfc791" title='"Internet Protocol"'>RFC791</a>] Address, 4 octets, or
                           IPv6 [<a href="./rfc3513" title='"Internet Protocol Version 6 (IPv6) Addressing Architecture"'>RFC3513</a>] Address, 16 octets.

      Algorithm            Algorithm for carrying out the computation
                           of the MN Authorization Token.  Currently
                           only 1 algorithm is defined, HMAC_SHA1 = 1.

      Key Length           Length of key, in octets.

      Key                  Shared key between MN and AR for CXTP.

      Context Data Block   The Context Data Block (see <a href="#section-2.4">Section 2.4</a>).

   When CTD is sent predictively, the supplied parameters (including the
   algorithm, key length, and the key itself) allow the nAR to compute a
   token locally and verify it against the token present in the CTAR
   message.  This material is also sent if the pAR receives a CTD
   message with a null Authorization Token, indicating that the CT-Req
   message was sent before the nAR received the CTAR message.  CTD MUST
   be protected by IPsec; see <a href="#section-6">Section 6</a>.

   As described previously, the algorithm for carrying out the
   computation of the MN Authorization Token is HMAC_SHA1.  The token
   authentication calculation algorithm is described in <a href="#section-2.5.1">Section 2.5.1</a>.

   For predictive handover, the pAR SHOULD keep track of the CTAR
   sequence number and cache the CTD message until a CTDR message for
   the MN's previous IP address has been received from the pAR,
   indicating that the context transfer was successful, or until
   CT_MAX_HANDOVER_TIME expires.  The nAR MAY send a CT-Req message
   containing the same sequence number if the predictive CTD message
   failed to arrive or the context was corrupted.  In this case, the nAR






<span class="grey">Loughney, et al.              Experimental                     [Page 12]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-13"></span>
<span class="grey"><a href="./rfc4067">RFC 4067</a>            Context Transfer Protocol (CXTP)           July 2005</span>


   sends a CT-Req message with a matching sequence number and pAR can
   resend the context.

<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.5.4.%20%20Context%20Transfer%20Data%20Reply%20%28CTDR%29%20Message"></a><a class="selflink" href="#section-2.5.4" id="section-2.5.4">2.5.4</a>.  Context Transfer Data Reply (CTDR) Message</span>

   This message is sent by nAR to pAR depending on the value of the 'A'
   flag in CTD, indicating success or failure.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |Vers.|  Type   |V|S| Reserved  |          Length               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ~             Mobile Node's Previous IP Address                 ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |        FPT (if present)       |  Status code  |   Reserved    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ~                           ........                            ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

      Vers.                Version number of CXTP protocol = 0x1

      Type                 CTDR = 0x5 (Context Transfer Data)

      'V' flag             When set to '0', IPv6 addresses.
                           When set to '1', IPv4 addresses.

      'S' bit              When set to one, this bit indicates
                           that all feature contexts sent in CTD
                           or PCTD were received successfully.

      Reserved             Set to zero by the sender and ignored by
                           the receiver.

      Length               Message length in units of octets.

      MN's Previous IP Address Field contains either:
                           IPv4 [<a href="./rfc791" title='"Internet Protocol"'>RFC791</a>] Address, 4 octets, or
                           IPv6 [<a href="./rfc3513" title='"Internet Protocol Version 6 (IPv6) Addressing Architecture"'>RFC3513</a>] Address, 16 octets.

      FPT                  16 bit unsigned integer, listing the Feature
                           Profile Type that is being acknowledged.

      Status Code          A context-specific return value,
                           zero for success, nonzero when 'S' is
                           not set to one.





<span class="grey">Loughney, et al.              Experimental                     [Page 13]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-14"></span>
<span class="grey"><a href="./rfc4067">RFC 4067</a>            Context Transfer Protocol (CXTP)           July 2005</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.5.5.%20%20Context%20Transfer%20Cancel%20%28CTC%29%20Message"></a><a class="selflink" href="#section-2.5.5" id="section-2.5.5">2.5.5</a>.  Context Transfer Cancel (CTC) Message</span>

   If transferring a context cannot be completed in a timely fashion,
   then nAR may send CTC to pAR to cancel an ongoing CT process.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |Vers.|  Type   |V|   Reserved  |            Length             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ~               Mobile Node's Previous IP Address               ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

      Vers.                Version number of CXTP protocol = 0x1

      Type                 CTC = 0x6 (Context Transfer Cancel)

      Length               Message length in units of octets.

      'V' flag             When set to '0', IPv6 addresses.
                           When set to '1', IPv4 addresses.

      Reserved             Set to zero by the sender and ignored by
                           the receiver.

      MN's Previous IP Address Field contains either:
                           IPv4 [<a href="./rfc791" title='"Internet Protocol"'>RFC791</a>] Address, 4 octets, or
                           IPv6 [<a href="./rfc3513" title='"Internet Protocol Version 6 (IPv6) Addressing Architecture"'>RFC3513</a>] Address, 16 octets.

<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.5.6.%20%20Context%20Transfer%20Request%20%28CT-Req%29%20Message"></a><a class="selflink" href="#section-2.5.6" id="section-2.5.6">2.5.6</a>.  Context Transfer Request (CT-Req) Message</span>

   Sent by nAR to pAR to request the start of context transfer.  This
   message is sent as a response to a CTAR message.  The fields
   following the Previous IP address of the MN are included verbatim
   from the CTAR message.
















<span class="grey">Loughney, et al.              Experimental                     [Page 14]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-15"></span>
<span class="grey"><a href="./rfc4067">RFC 4067</a>            Context Transfer Protocol (CXTP)           July 2005</span>


    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |Vers.|  Type   |V|  Reserved   |            Length             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ~               Mobile Node's Previous IP Address               ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                        Sequence Number                        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                     MN Authorization Token                    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ~        Next Requested Context Data Block (if present)         ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ~                           ........                            ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

      Vers.                Version number of CXTP protocol = 0x1

      Type                 CTREQ = 0x7 (Context Transfer Request)

      'V' flag             When set to '0', IPv6 addresses.
                           When set to '1', IPv4 addresses.

      Reserved             Set to zero by the sender and ignored
                           by the receiver.

      Length               Message length in units of octets.

      MN's Previous IP Address Field contains either:
                           IPv4 [<a href="./rfc791" title='"Internet Protocol"'>RFC791</a>] Address, 4 octets, or
                           IPv6 [<a href="./rfc3513" title='"Internet Protocol Version 6 (IPv6) Addressing Architecture"'>RFC3513</a>] Address, 16 octets.

      Sequence Number      Copied from the CTAR message, allows the
                           pAR to distinguish requests from previously
                           sent context.

      MN's Authorization Token
                           An unforgeable value calculated as
                           discussed in <a href="#section-2.5.1">Section 2.5.1</a>.  This
                           authorizes the receiver of CTAR to
                           perform context transfer.  Copied from
                           CTAR.

      Context Data Request Block
                           A request block for context data; see
                           <a href="#section-2.4">Section 2.4</a>.





<span class="grey">Loughney, et al.              Experimental                     [Page 15]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-16"></span>
<span class="grey"><a href="./rfc4067">RFC 4067</a>            Context Transfer Protocol (CXTP)           July 2005</span>


   The sequence number is used by pAR to correlate a request for
   previously transmitted context.  In predictive transfer, if the MN
   sends CTAR prior to handover, pAR pushes context to nAR using PCTD.
   If the CTD fails, the nAR will send a CT-Req with the same sequence
   number, enabling the pAR to determine which context to resend.  The
   pAR deletes the context after CXTP_MAX_TRANSFER_TIME.  The sequence
   number is not used in reactive transfer.

   For predictive transfer, the pAR sends the keying material and other
   information necessary to calculate the Authorization Token without
   having processed a CT-Req message.  For reactive transfer, if the nAR
   receives a context transfer trigger but has not yet received the CTAR
   message with the authorization token, the Authorization Token field
   in CT-Req is set to zero.  The pAR interprets this as an indication
   to include the keying material and other information necessary to
   calculate the Authorization Token, and includes this material into
   the CTD message as if the message were being sent due to predictive
   transfer.  This provides nAR with the information it needs to
   calculate the authorization token when the MN sends CTAR.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.%20%20Transport"></a><a class="selflink" href="#section-3" id="section-3">3</a>.  Transport</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.1.%20%20Inter-Router%20Transport"></a><a class="selflink" href="#section-3.1" id="section-3.1">3.1</a>.  Inter-Router Transport</span>

   Since most types of access networks in which CXTP might be useful are
   not today deployed or, if they have been deployed, have not been
   extensively measured, it is difficult to know whether congestion will
   be a problem for CXTP.  Part of the research task in preparing CXTP
   for consideration as a possible candidate for standardization is to
   quantify this issue.  However, to avoid potential interference with
   production applications should a prototype CXTP deployment involve
   running over the public Internet, it seems prudent to recommend a
   default transport protocol that accommodates congestion.  In
   addition, since the feature context information has a definite
   lifetime, the transport protocol must accommodate flexible
   retransmission, so stale contexts that are held up by congestion are
   dropped.  Finally, because the amount of context data can be
   arbitrarily large, the transport protocol should not be limited to a
   single packet or require implementing a custom fragmentation
   protocol.

   These considerations argue that implementations of CXTP MUST support,
   and prototype deployments of CXTP SHOULD use, the Stream Control
   Transport Protocol (SCTP) [<a href="#ref-SCTP" title='"Stream Control Transmission Protocol"'>SCTP</a>] as the transport protocol on the
   inter-router interface, especially if deployment over the public
   Internet is contemplated.  SCTP supports congestion control,
   fragmentation, and partial retransmission based on a programmable
   retransmission timer.  SCTP also supports many advanced and complex



<span class="grey">Loughney, et al.              Experimental                     [Page 16]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-17"></span>
<span class="grey"><a href="./rfc4067">RFC 4067</a>            Context Transfer Protocol (CXTP)           July 2005</span>


   features, such as multiple streams and multiple IP addresses for
   failover that are not necessary for experimental implementation and
   prototype deployment of CXTP.  The use of such SCTP features is not
   recommended at this time.

   The SCTP Payload Data Chunk carries the context transfer protocol
   messages.  The User Data part of each SCTP message contains an
   appropriate context transfer protocol message defined in this
   document.  The messages sent using SCTP are CTD (<a href="#section-2.5.3">Section 2.5.3</a>), CTDR
   (<a href="#section-2.5.4">Section 2.5.4</a>), CTC (<a href="#section-2.5.5">Section 2.5.5</a>), and CT-Req (<a href="#section-2.5.6">Section 2.5.6</a>).  In
   general, each SCTP message can carry feature contexts belonging to
   any MN.  If the SCTP checksum calculation fails, the nAR returns the
   BAD_CHECKSUM error code in a CTDR message.

   A single stream is used for context transfer without in-sequence
   delivery of SCTP messages.  Each message corresponds to a single MN's
   feature context collection.  A single stream provides simplicity.
   The use of multiple streams to prevent head-of-line blocking is for
   future study.  Unordered delivery allows the receiver to not block
   for in-sequence delivery of messages that belong to different MNs.
   The Payload Protocol Identifier in the SCTP header is 'CXTP'.
   Inter-router CXTP uses the Seamoby SCTP port [<a href="#ref-IANA" title='"Instructions for Seamoby and Experimental Mobility Protocol IANA Allocations"'>IANA</a>].

   Timeliness of the context transfer information SHOULD be accommodated
   by setting the SCTP maximum retransmission value to
   CT_MAX_TRANSFER_TIME to accommodate the maximum acceptable handover
   delay time.  The AR SHOULD be configured with CT_MAX_TRANSFER_TIME to
   accommodate the particular wireless link technology and local
   wireless propagation conditions.  SCTP message bundling SHOULD be
   turned off to reduce an extra delay in sending messages.  Within
   CXTP, the nAR SHOULD estimate the retransmit timer from the receipt
   of the first fragment of a CXTP message and avoid processing any IP
   traffic from the MN until either context transfer is complete or the
   estimated retransmit timer expires.  If both routers support PR-SCTP
   [<a href="#ref-PR-SCTP" title='"Stream Control Transmission Protocol (SCTP) Partial Reliability Extension"'>PR-SCTP</a>], then PR-SCTP SHOULD be used.  PR-SCTP modifies the
   lifetime parameter of the Send() operation (defined in <a href="#section-10.1">Section 10.1</a> E
   in [<a href="#ref-SCTP" title='"Stream Control Transmission Protocol"'>SCTP</a>]) so that it applies to retransmits as well as transmits;
   that is, in PR-SCTP, if the lifetime expires and the data chunk has
   not been acknowledged, the transmitter stops retransmitting, whereas
   in the base protocol the data would be retransmitted until
   acknowledged or the connection timed out.










<span class="grey">Loughney, et al.              Experimental                     [Page 17]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-18"></span>
<span class="grey"><a href="./rfc4067">RFC 4067</a>            Context Transfer Protocol (CXTP)           July 2005</span>


   The format of Payload Data Chunk taken from [<a href="#ref-SCTP" title='"Stream Control Transmission Protocol"'>SCTP</a>] is shown in the
   following diagram.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   Type = 0    | Reserved|U|B|E|    Length                     |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                              TSN                              |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Stream Identifier S      |   Stream Sequence Number n    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                 Payload Protocol Identifier                   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ~                 User Data (seq n of Stream S)                 ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

      'U' bit              The Unordered bit.  MUST be set to 1 (one).
      'B' bit              The Beginning fragment bit.  See [<a href="#ref-SCTP" title='"Stream Control Transmission Protocol"'>SCTP</a>].

      'E' bit              The Ending fragment bit.  See [<a href="#ref-SCTP" title='"Stream Control Transmission Protocol"'>SCTP</a>].

      TSN                  Transmission Sequence Number.  See [<a href="#ref-SCTP" title='"Stream Control Transmission Protocol"'>SCTP</a>].

      Stream Identifier S
                           Identifies the context transfer protocol
                           stream.

      Stream Sequence Number n
                           Since the 'U' bit is set to one, the
                           receiver ignores this number.  See [<a href="#ref-SCTP" title='"Stream Control Transmission Protocol"'>SCTP</a>].

      Payload Protocol Identifier
                           Set to 'CXTP' (see [<a href="#ref-IANA" title='"Instructions for Seamoby and Experimental Mobility Protocol IANA Allocations"'>IANA</a>]).

      User Data            Contains the context transfer protocol
                           messages.

   If a CXTP deployment will never run over the public Internet, and it
   is known that congestion is not a problem in the access network,
   alternative transport protocols MAY be appropriate vehicles for
   experimentation.  For example, piggybacking CXTP messages on top of
   handover signaling for routing, such as provided by FMIPv6 in ICMP
   [<a href="#ref-FMIPv6" title='"Fast Handovers for Mobile IPv6"'>FMIPv6</a>].  Implementations of CXTP MAY support ICMP for such
   purposes.  If such piggybacking is used, an experimental message
   extension for the protocol on which CXTP is piggybacking MUST be
   designed.  Direct deployment on top of a transport protocol for
   experimental purposes is also possible.  In this case, the researcher



<span class="grey">Loughney, et al.              Experimental                     [Page 18]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-19"></span>
<span class="grey"><a href="./rfc4067">RFC 4067</a>            Context Transfer Protocol (CXTP)           July 2005</span>


   MUST be careful to accommodate good Internet transport protocol
   engineering practices, including using retransmits with exponential
   backoff.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.2.%20%20MN-AR%20Transport"></a><a class="selflink" href="#section-3.2" id="section-3.2">3.2</a>.  MN-AR Transport</span>

   The MN-AR interface MUST implement and SHOULD use ICMP to transport
   the CTAR and CTAA messages.  Because ICMP contains no provisions for
   retransmitting packets if signaling is lost, the CXTP protocol
   incorporates provisions for improving transport performance on the
   MN-AR interface.  The MN and AR SHOULD limit the number of context
   data block identifiers included in the CTAR and CTAA messages so that
   the message will fit into a single packet, because ICMP has no
   provision for fragmentation above the IP level.  CXTP uses the
   Experimental Mobility ICMP type [<a href="#ref-IANA" title='"Instructions for Seamoby and Experimental Mobility Protocol IANA Allocations"'>IANA</a>].  The ICMP message format for
   CXTP messages is as follows:

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Type      |     Code      |           Checksum            |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   Subtype     |                   Reserved                    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   Message...
   +-+-+-+-+-+-+-+-+-+-+-+- - - -

   IP Fields:

      Source Address       An IP address assigned to the sending
                           interface.

      Destination Address
                           An IP address assigned to the receiving
                           interface.

      Hop Limit            255

   ICMP Fields:

      Type           Experimental Mobility Type (To be assigned by IANA,
                     for IPv4 and IPv6, see [<a href="#ref-IANA" title='"Instructions for Seamoby and Experimental Mobility Protocol IANA Allocations"'>IANA</a>])

      Code           0

      Checksum       The ICMP checksum.





<span class="grey">Loughney, et al.              Experimental                     [Page 19]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-20"></span>
<span class="grey"><a href="./rfc4067">RFC 4067</a>            Context Transfer Protocol (CXTP)           July 2005</span>


      Sub-type       The Experimental Mobility ICMP subtype for CXTP,
                     see [<a href="#ref-IANA" title='"Instructions for Seamoby and Experimental Mobility Protocol IANA Allocations"'>IANA</a>].

      Reserved       Set to zero by the sender and ignored by
                     the receiver.

      Message        The body of the CTAR or CTAA message.

      CTAR messages for which a response is requested but fail to elicit
      a response are retransmitted.  The initial retransmission occurs
      after a CXTP_REQUEST_RETRY wait period.  Retransmissions MUST be
      made with exponentially increasing wait intervals (doubling the
      wait each time).  CTAR messages should be retransmitted until
      either a response (which might be an error) has been obtained, or
      until CXTP_RETRY_MAX seconds after the initial transmission.

      MNs SHOULD generate the sequence number in the CTAR message
      randomly (also ensuring that the same sequence number has not been
      used in the last 7 seconds), and, for predictive transfer, MUST
      use the same sequence number in a CTAR message to the nAR as for
      the pAR.  An AR MUST ignore the CTAR message if it has already
      received one with the same sequence number and MN IP address.

      Implementations MAY, for research purposes, try other transport
      protocols.  Examples are the definition of a Mobile IPv6 Mobility
      Header [<a href="#ref-MIPv6" title='"Mobility Support in IPv6"'>MIPv6</a>] for use with the FMIPv6 Fast Binding Update
      [<a href="#ref-FMIPv6" title='"Fast Handovers for Mobile IPv6"'>FMIPv6</a>] to allow bundling of both routing change and context
      transfer signaling from the MN to AR, or definition of a UDP
      protocol instead of ICMP.  If such implementations are done, they
      should abide carefully by good Internet transport engineering
      practices and be used for prototype and demonstration purposes
      only.  Deployment on large scale networks should be avoided until
      the transport characteristics are well understood.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/4.%20%20Error%20Codes%20and%20Constants"></a><a class="selflink" href="#section-4" id="section-4">4</a>.  Error Codes and Constants</span>

   Error Code      Section    Value        Meaning
   ------------------------------------------------------------

   BAD_CHECKSUM    3.1        0x01         Error code if the
                                           SCTP checksum fails.










<span class="grey">Loughney, et al.              Experimental                     [Page 20]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-21"></span>
<span class="grey"><a href="./rfc4067">RFC 4067</a>            Context Transfer Protocol (CXTP)           July 2005</span>


   Constant             Section    Default Value  Meaning
   --------------------------------------------------------------------

   CT_REQUEST_RATE       6.3       10 requests/   Maximum number of
                                      sec.        CTAR messages before
                                                  AR institutes rate
                                                  limiting.

   CT_MAX_TRANSFER_TIME  3.1       200 ms         Maximum amount of time
                                                  pAR should wait before
                                                  aborting the transfer.

   CT_REQUEST_RETRY      3.2       2 seconds      Wait interval before
                                                  initial retransmit
                                                  on MN-AR interface.

   CT_RETRY_MAX          3.2     15 seconds       Give up retrying
                                                  on MN-AR interface.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.%20%20Examples%20and%20Signaling%20Flows"></a><a class="selflink" href="#section-5" id="section-5">5</a>.  Examples and Signaling Flows</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.1.%20%20Network%20Controlled%2C%20Initiated%20by%20pAR%2C%20Predictive"></a><a class="selflink" href="#section-5.1" id="section-5.1">5.1</a>.  Network Controlled, Initiated by pAR, Predictive</span>

                 MN                    nAR                     pAR
                 |                      |                       |
            T    |                      |                  CT trigger
            I    |                      |                       |
            M    |                      |&lt;------- CTD ----------|
            E    |------- CTAR --------&gt;|                       |
            :    |                      |                       |
            |    |                      |-------- CTDR --------&gt;|
            V    |                      |                       |
                 |                      |                       |

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.2.%20%20Network%20Controlled%2C%20Initiated%20by%20nAR%2C%20Reactive"></a><a class="selflink" href="#section-5.2" id="section-5.2">5.2</a>.  Network Controlled, Initiated by nAR, Reactive</span>

                 MN                    nAR                     pAR
                 |                      |                       |
            T    |                 CT trigger                   |
            I    |                      |                       |
            M    |                      |--------- CT-Req -----&gt;|
            E    |                      |                       |
            :    |                      |&lt;------- CTD ----------|
            |    |                      |                       |
            V    |------- CTAR --------&gt;|                       |
                 |                      |----- CTDR (opt) -----&gt;|
                 |                      |                       |




<span class="grey">Loughney, et al.              Experimental                     [Page 21]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-22"></span>
<span class="grey"><a href="./rfc4067">RFC 4067</a>            Context Transfer Protocol (CXTP)           July 2005</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.3.%20%20Mobile%20Controlled%2C%20Predictive%20New%20L2%20up%2FOld%20L2%20down"></a><a class="selflink" href="#section-5.3" id="section-5.3">5.3</a>.  Mobile Controlled, Predictive New L2 up/Old L2 down</span>

   CTAR request to nAR

                 MN                    nAR                     pAR
                 |                      |                       |
           new L2 link up               |                       |
                 |                      |                       |
            CT trigger                  |                       |
                 |                      |                       |
            T    |------- CTAR --------&gt;|                       |
            I    |                      |-------- CT-Req ------&gt;|
            M    |                      |                       |
            E    |                      |&lt;-------- CTD ---------|
            :    |                      |                       |
            |    |                      |                       |
            V    |                      |                       |
                 |                      |                       |

   Whether the nAR sends the MN a CTAR reject message if CT is not
   supported is for future study.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/6.%20%20Security%20Considerations"></a><a class="selflink" href="#section-6" id="section-6">6</a>.  Security Considerations</span>

   At this time, the threats to IP handover in general and context
   transfer in particular are not widely understood, particularly on the
   MN to AR link, and mechanisms for countering them are not well
   defined.  Part of the experimental task in preparing CXTP for
   eventual standards track will be to better characterize threats to
   context transfer and design specific mechanisms to counter them.
   This section provides some general guidelines about security based on
   discussions among the Design Team and Working Group members.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/6.1.%20%20Threats"></a><a class="selflink" href="#section-6.1" id="section-6.1">6.1</a>.  Threats</span>

   The Context Transfer Protocol transfers state between access routers.
   If the MNs are not authenticated and authorized before moving on the
   network, there is a potential for masquerading attacks to shift state
   between ARs, causing network disruptions.

   Additionally, DoS attacks can be launched from MNs towards the access
   routers by requesting multiple context transfers and then by
   disappearing.  Finally, a rogue access router could flood mobile
   nodes with packets, attempt DoS attacks, and issue bogus context
   transfer requests to surrounding routers.






<span class="grey">Loughney, et al.              Experimental                     [Page 22]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-23"></span>
<span class="grey"><a href="./rfc4067">RFC 4067</a>            Context Transfer Protocol (CXTP)           July 2005</span>


   Consistency and correctness in context transfer depend on
   interoperable feature context definitions and how CXTP is utilized
   for a particular application.  For some considerations regarding
   consistency and correctness that have general applicability but are
   articulated in the context of AAA context transfer, please see [<a href="#ref-EAP" title='"Extensible Authentication Protocol (EAP) Key Management Framework"'>EAP</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/6.2.%20%20Access%20Router%20Considerations"></a><a class="selflink" href="#section-6.2" id="section-6.2">6.2</a>.  Access Router Considerations</span>

   The CXTP inter-router interface relies on IETF standardized security
   mechanisms for protecting traffic between access routers, as opposed
   to creating application security mechanisms.  IPsec [<a href="./rfc2401" title='"Security Architecture for the Internet Protocol"'>RFC2401</a>] MUST be
   supported between access routers.

   To avoid the introduction of additional latency due to the need for
   establishing a secure channel between the context transfer peers
   (ARs), the two ARs SHOULD establish such a secure channel in advance.
   The two access routers need to engage in a key exchange mechanism
   such as IKE [<a href="./rfc2409" title='"The Internet Key Exchange (IKE)"'>RFC2409</a>], establish IPSec SAs, and define the keys,
   algorithms, and IPSec protocols (such as ESP) in anticipation of any
   upcoming context transfer.  This will save time during handovers that
   require secure transfer.  Such SAs can be maintained and used for all
   upcoming context transfers between the two ARs.  Security should be
   negotiated prior to the sending of context.

   Access Routers MUST implement IPsec ESP [<a href="#ref-ESP" title='"IP Encapsulating Security Payload (ESP)"'>ESP</a>] in transport mode with
   non-null encryption and authentication algorithms to provide per-
   packet authentication, integrity protection and confidentiality, and
   MUST implement the replay protection mechanisms of IPsec.  In those
   scenarios where IP layer protection is needed, ESP in tunnel mode
   SHOULD be used.  Non-null encryption should be used when using IPSec
   ESP.  Strong security on the inter-router interface is required to
   protect against attacks by rogue routers, and to ensure
   confidentiality on the context transfer authorization key in
   predicative transfer.

   The details of IKE key exchange and other details of the IPsec
   security associations between routers are to be determined as part of
   the research phase associated with finalizing the protocol for
   standardization.  These details must be determined prior to
   standardization.  Other working groups are currently working on
   general security for routing protocols.  Ideally, a possible solution
   for CXTP will be based on this work to minimize the operational
   configuration of routers for different protocols.  Requirements for
   CXTP will be brought to the appropriate IETF routing protocol
   security working groups for consideration.






<span class="grey">Loughney, et al.              Experimental                     [Page 23]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-24"></span>
<span class="grey"><a href="./rfc4067">RFC 4067</a>            Context Transfer Protocol (CXTP)           July 2005</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/6.3.%20%20Mobile%20Node%20Considerations"></a><a class="selflink" href="#section-6.3" id="section-6.3">6.3</a>.  Mobile Node Considerations</span>

   The CTAR message requires the MN and AR to possess a shared secret
   key to calculate the authorization token.  Validation of this token
   MUST precede context transfer or installation of context for the MN,
   removing the risk that an attacker could cause an unauthorized
   transfer.  How the shared key is established is out of scope of this
   specification.  If both the MN and AR know certified public keys of
   the other party, Diffie-Hellman can be used to generate a shared
   secret key [<a href="./rfc2631" title='"Diffie-Hellman Key Agreement Method"'>RFC2631</a>].  If an AAA protocol of some sort is run for
   network entry, the shared key can be established using that protocol
   [<a href="#ref-PerkCal04" title='"Authentication, Authorization, and Accounting (AAA) Registration Keys for Mobile IPv4"'>PerkCal04</a>].

   If predictive context transfer is used, the shared key for
   calculating the authorization token is transferred between ARs.  A
   transfer of confidential material of this sort poses certain security
   risks, even if the actual transfer itself is confidential and
   authenticated, as is the case for inter-router CXTP.  The more
   entities know the key, the more likely a compromise may occur.  To
   mitigate this risk, nAR MUST discard the key immediately after using
   it to validate the authorization token.  The MN MUST establish a new
   key with the AR for future CXTP transactions.  The MN and AR SHOULD
   exercise care in using a key established for other purposes for also
   authorizing context transfer.  The establishment of a separate key
   for context transfer authorization is RECOMMENDED.

   Replay protection on the MN-AR protocol is provided by limiting the
   time period in which context is maintained.  For predictive transfer,
   the pAR receives a CTAR message with a sequence number, transfers the
   context along with the authorization token key, and then drops the
   context and the authorization token key immediately upon completion
   of the transfer.  For reactive transfer, the nAR receives the CTAR,
   requests the context that includes the sequence number and
   authorization token from the CTAR message that allows the pAR to
   check whether the transfer is authorized.  The pAR drops the context
   and authorization token key after the transfer has been completed.
   The pAR and nAR ignore any requests containing the same MN IP address
   if an outstanding CTAR or CTD message is unacknowledged and has not
   timed out.  After the key has been dropped, any attempt at replay
   will fail because the authorization token will fail to validate.  The
   AR MUST NOT reuse the key for any MN, including the MN that
   originally possessed the key.

   DoS attacks on the MN-AR interface can be limited by having the AR
   rate limit the number of CTAR messages it processes.  The AR SHOULD
   limit the number of CTAR messages to the CT_REQUEST_RATE.  If the
   request exceeds this rate, the AR SHOULD randomly drop messages until
   the rate is established.  The actual rate SHOULD be configured on the



<span class="grey">Loughney, et al.              Experimental                     [Page 24]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-25"></span>
<span class="grey"><a href="./rfc4067">RFC 4067</a>            Context Transfer Protocol (CXTP)           July 2005</span>


   AR to match the maximum number of handovers that the access network
   is expected to support.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/7.%20%20Acknowledgements%20%26%20Contributors"></a><a class="selflink" href="#section-7" id="section-7">7</a>.  Acknowledgements &amp; Contributors</span>

   This document is the result of a design team formed by the chairs of
   the SeaMoby working group.  The team included John Loughney, Madjid
   Nakhjiri, Rajeev Koodli and Charles Perkins.

   Basavaraj Patil, Pekka Savola, and Antti Tuominen contributed to the
   Context Transfer Protocol review.

   The working group chairs are Pat Calhoun and James Kempf, whose
   comments have been very helpful in the creation of this
   specification.

   The authors would also like to thank Julien Bournelle, Vijay
   Devarapalli, Dan Forsberg, Xiaoming Fu, Michael Georgiades, Yusuf
   Motiwala, Phil Neumiller, Hesham Soliman, and Lucian Suciu for their
   help and suggestions with this document.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/8.%20%20References"></a><a class="selflink" href="#section-8" id="section-8">8</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/8.1.%20%20Normative%20References"></a><a class="selflink" href="#section-8.1" id="section-8.1">8.1</a>.  Normative References</span>

   [<a id="ref-RFC791">RFC791</a>]    Postel, J., "Internet Protocol", STD 5, <a href="./rfc791">RFC 791</a>,
               September 1981.

   [<a id="ref-RFC2119">RFC2119</a>]   Bradner, S., "Key words for use in RFCs to Indicate
               Requirement Levels", <a href="https://www.rfc-editor.org/bcp/bcp14">BCP 14</a>, <a href="./rfc2119">RFC 2119</a>, March 1997.

   [<a id="ref-RFC2409">RFC2409</a>]   Harkins, D. and D. Carrel, "The Internet Key Exchange
               (IKE)", <a href="./rfc2409">RFC 2409</a>, November 1998.

   [<a id="ref-RFC3513">RFC3513</a>]   Hinden, R. and S. Deering, "Internet Protocol Version 6
               (IPv6) Addressing Architecture", <a href="./rfc3513">RFC 3513</a>, April 2003.

   [<a id="ref-ESP">ESP</a>]       Kent, S. and R. Atkinson, "IP Encapsulating Security
               Payload (ESP)", <a href="./rfc2406">RFC 2406</a>, November 1998.

   [<a id="ref-SCTP">SCTP</a>]      Stewart, R., Xie, Q., Morneault, K., Sharp, C.,
               Schwarzbauer, H., Taylor, T., Rytina, I., Kalla, M.,
               Zhang, L., and V. Paxson, "Stream Control Transmission
               Protocol", <a href="./rfc2960">RFC 2960</a>, October 2000.

   [<a id="ref-PR-SCTP">PR-SCTP</a>]   Stewart, R., Ramalho, M., Xie, Q., Tuexen, M., and P.
               Conrad, "Stream Control Transmission Protocol (SCTP)
               Partial Reliability Extension", <a href="./rfc3758">RFC 3758</a>, May 2004.



<span class="grey">Loughney, et al.              Experimental                     [Page 25]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-26"></span>
<span class="grey"><a href="./rfc4067">RFC 4067</a>            Context Transfer Protocol (CXTP)           July 2005</span>


   [<a id="ref-IANA">IANA</a>]      Kempf, J., "Instructions for Seamoby and Experimental
               Mobility Protocol IANA Allocations", <a href="./rfc4065">RFC 4065</a>, July 2005.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/8.2.%20%20Informative%20References"></a><a class="selflink" href="#section-8.2" id="section-8.2">8.2</a>.  Informative References</span>

   [<a id="ref-FHCT">FHCT</a>]      R. Koodli and C. E. Perkins, "Fast Handovers and Context
               Transfers", ACM Computing Communication Review, volume
               31, number 5, October 2001.

   [<a id="ref-TEXT">TEXT</a>]      M. Nakhjiri, "A time efficient context transfer method
               with Selective reliability for seamless IP mobility",
               IEEE VTC-2003-Fall, VTC 2003 Proceedings, Vol.3, Oct.
               2003.

   [<a id="ref-FMIPv6">FMIPv6</a>]    Koodli, R., Ed., "Fast Handovers for Mobile IPv6", <a href="./rfc4068">RFC</a>
               <a href="./rfc4068">4068</a>, July 2005.

   [<a id="ref-LLMIP">LLMIP</a>]     K. El Malki et al., "Low Latency Handoffs in Mobile
               IPv4", Work in Progress.

   [<a id="ref-RFC3374">RFC3374</a>]   Kempf, J., "Problem Description: Reasons For Performing
               Context Transfers Between Nodes in an IP Access Network",
               <a href="./rfc3374">RFC 3374</a>, September 2002.

   [<a id="ref-RFC2401">RFC2401</a>]   Kent, S. and R. Atkinson, "Security Architecture for the
               Internet Protocol", <a href="./rfc2401">RFC 2401</a>, November 1998.

   [<a id="ref-TERM">TERM</a>]      Manner, J. and M. Kojo, "Mobility Related Terminology",
               <a href="./rfc3753">RFC 3753</a>, June 2004.

   [<a id="ref-RFC2631">RFC2631</a>]   Rescorla, E., "Diffie-Hellman Key Agreement Method", <a href="./rfc2631">RFC</a>
               <a href="./rfc2631">2631</a>, June 1999.

   [<a id="ref-PerkCal04">PerkCal04</a>] Perkins, C. and P. Calhoun, "Authentication,
               Authorization, and Accounting (AAA) Registration Keys for
               Mobile IPv4", <a href="./rfc3957">RFC 3957</a>, March 2005.

   [<a id="ref-MIPv6">MIPv6</a>]     Johnson, D., Perkins, C., and J. Arkko, "Mobility Support
               in IPv6", <a href="./rfc3775">RFC 3775</a>, June 2004.

   [<a id="ref-RFC2710">RFC2710</a>]   Deering, S., Fenner, W., and B. Haberman, "Multicast
               Listener Discovery (MLD) for IPv6", <a href="./rfc2710">RFC 2710</a>, October
               1999.

   [<a id="ref-RFC2461">RFC2461</a>]   Narten, T., Nordmark, E., and W. Simpson, "Neighbor
               Discovery for IP Version 6 (IPv6)", <a href="./rfc2461">RFC 2461</a>, December
               1998.




<span class="grey">Loughney, et al.              Experimental                     [Page 26]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-27"></span>
<span class="grey"><a href="./rfc4067">RFC 4067</a>            Context Transfer Protocol (CXTP)           July 2005</span>


   [<a id="ref-RFC2462">RFC2462</a>]   Thomson, S. and T. Narten, "IPv6 Stateless Address
               Autoconfiguration", <a href="./rfc2462">RFC 2462</a>, December 1998.

   [<a id="ref-RFC3095">RFC3095</a>]   Bormann, C., Burmeister, C., Degermark, M., Fukushima,
               H., Hannu, H., Jonsson, L-E., Hakenberg, R., Koren, T.,
               Le, K., Liu, Z., Martensson, A., Miyazaki, A., Svanbro,
               K., Wiebke, T., Yoshimura, T., and H. Zheng, "RObust
               Header Compression (ROHC): Framework and four profiles:
               RTP, UDP, ESP, and uncompressed ", <a href="./rfc3095">RFC 3095</a>, July 2001.

   [<a id="ref-BT">BT</a>]        IEEE, "IEEE Standard for information technology -
               Telecommunication and information exchange between
               systems - LAN/MAN - Part 15.1: Wireless Medium Access
               Control (MAC) and Physical Layer (PHY) specifications for
               Wireless Personal Area Networks (WPANs)", IEEE Standard
               802.15.1, 2002.

   [<a id="ref-EAP">EAP</a>]       Aboba, B., Simon, D., Arkko, J., Eron, P., and H.
               Levokowetz, "Extensible Authentication Protocol (EAP) Key
               Management Framework", Work in Progress.































<span class="grey">Loughney, et al.              Experimental                     [Page 27]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-28"></span>
<span class="grey"><a href="./rfc4067">RFC 4067</a>            Context Transfer Protocol (CXTP)           July 2005</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/Appendix%20A.%20%20Timing%20and%20Trigger%20Considerations"></a><a class="selflink" href="#appendix-A" id="appendix-A">Appendix A</a>.  Timing and Trigger Considerations</span>

   Basic Mobile IP handover signaling can introduce disruptions to the
   services running on top of Mobile IP, which may introduce unwanted
   latencies that practically prohibit its use for certain types of
   services.  Mobile IP latency and packet loss are optimized through
   several alternative procedures, such as Fast Mobile IP [<a href="#ref-FMIPv6" title='"Fast Handovers for Mobile IPv6"'>FMIPv6</a>] and
   Low Latency Mobile IP [<a href="#ref-LLMIP" title='"Low Latency Handoffs in Mobile IPv4"'>LLMIP</a>].

   Feature re-establishment through context transfer should contribute
   zero (optimally) or minimal extra disruption of services in
   conjunction with handovers.  This means that the timing of context
   transfer SHOULD be carefully aligned with basic Mobile IP handover
   events, and with optimized Mobile IP handover signaling mechanisms,
   as those protocols become available.

   Furthermore, some of those optimized mobile IP handover mechanisms
   may provide more flexibility in choosing the timing and ordering for
   the transfer of various context information.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/Appendix%20B.%20%20Multicast%20Listener%20Context%20Transfer"></a><a class="selflink" href="#appendix-B" id="appendix-B">Appendix B</a>.  Multicast Listener Context Transfer</span>

   In the past, credible proposals have been made in the Seamoby Working
   Group and elsewhere for using context transfer to the speed of
   handover of authentication, authorization, and accounting context,
   distributed firewall context, PPP context, and header compression
   context.  Because the Working Group was not chartered to develop
   context profile definitions for specific applications, none of the
   documents submitted to Seamoby were accepted as Working Group items.
   At this time, work to develop a context profile definition for <a href="./rfc3095">RFC</a>
   <a href="./rfc3095">3095</a> header compression context [<a href="./rfc3095" title='"RObust Header Compression (ROHC): Framework and four profiles: RTP, UDP, ESP, and uncompressed "'>RFC3095</a>] and to characterize the
   performance gains obtainable by using header compression continues,
   but is not yet complete.  In addition, there are several commercial
   wireless products that reportedly use non-standard, non-interoperable
   context transfer protocols, though none is as yet widely deployed.

   As a consequence, it is difficult at this time to point to a solid
   example of how context transfer could result in a commercially
   viable, widely deployable, interoperable benefit for wireless
   networks.  This is one reason why CXTP is being proposed as an
   Experimental protocol, rather than Standards Track.  Nevertheless, it
   seems valuable to have a simple example that shows how handover could
   benefit from using CXTP.  The example we consider here is
   transferring IPv6 MLD state [<a href="./rfc2710" title='"Multicast Listener Discovery (MLD) for IPv6"'>RFC2710</a>].  MLD state is a particularly
   good example because every IPv6 node must perform at least one MLD
   messaging sequence on the wireless link to establish itself as an MLD
   listener prior to performing router discovery [<a href="./rfc2461" title='"Neighbor Discovery for IP Version 6 (IPv6)"'>RFC2461</a>] or duplicate
   address detection [<a href="./rfc2462" title='"IPv6 Stateless Address Autoconfiguration"'>RFC2462</a>] or before sending/receiving any



<span class="grey">Loughney, et al.              Experimental                     [Page 28]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-29"></span>
<span class="grey"><a href="./rfc4067">RFC 4067</a>            Context Transfer Protocol (CXTP)           July 2005</span>


   application-specific traffic (including Mobile IP handover signaling,
   if any).  The node must subscribe to the Solicited Node Multicast
   Address as soon as it comes up on the link.  Any application-specific
   multicast addresses must be re-established as well.  Context transfer
   can significantly speed up re-establishing multicast state by
   allowing the nAR to initialize MLD for a node that just completed
   handover without any MLD signaling on the new wireless link.  The
   same approach could be used for transferring multicast context in
   IPv4.

   An approximate quantitative estimate for the amount of savings in
   handover time can be obtained as follows: MLD messages are 24 octets,
   to which the headers must be added, because there is no header
   compression on the new link, where the IPv6 header is 40 octets, and
   a required Router Alert Hop-by-Hop option is 8 octets including
   padding.  The total MLD message size is 72 octets per subscribed
   multicast address.  <a href="./rfc2710">RFC 2710</a> recommends that nodes send 2 to 3 MLD
   Report messages per address subscription, since the Report message is
   unacknowledged.  Assuming 2 MLD messages sent for a subscribed
   address, the MN would need to send 144 octets per address
   subscription.  If MLD messages are sent for both the All Nodes
   Multicast address and the Solicited Node Multicast address for the
   node's link local address, a total of 288 octets are required when
   the node hands over to the new link.  Note that some implementations
   of IPv6 are optimized by not sending an MLD message for the All Nodes
   Multicast Address, since the router can infer that at least one node
   is on the link (itself) when it comes up and always will be.
   However, for purposes of this calculation, we assume that the IPv6
   implementation is conformant and that the message is sent.  The
   amount of time required for MLD signaling will depend on the per node
   available wireless link bandwidth, but some representative numbers
   can be obtained by assuming bandwidths of 20 kbps or 100 kbps.  With
   these 2 bit rates, the savings from not having to perform the pre-
   router discovery messages are 115 msec. and 23 msec., respectively.
   If any application-specific multicast addresses are subscribed, the
   amount of time saved could be more substantial.

   This example might seem a bit contrived as MLD is not used in the 3G
   cellular protocols, and wireless local area network protocols
   typically have enough bandwidth if radio propagation conditions are
   optimal.  Therefore, sending a single MLD message might not be viewed
   as a performance burden.  An example of a wireless protocol where MLD
   context transfer might be useful is IEEE 802.15.1 (Bluetooth)[<a href="#ref-BT" title='"IEEE Standard for information technology - Telecommunication and information exchange between systems - LAN/MAN - Part 15.1: Wireless Medium Access Control (MAC) and Physical Layer (PHY) specifications for Wireless Personal Area Networks (WPANs)"'>BT</a>].
   IEEE 802.15.1 has two IP "profiles": one with PPP and one without.
   The profile without PPP would use MLD.  The 802.15.1 protocol has a
   maximum bandwidth of about 800 kbps, shared between all nodes on the
   link, so a host on a moderately loaded 802.15.1 access point could
   experience the kind of bandwidth described in the previous paragraph.



<span class="grey">Loughney, et al.              Experimental                     [Page 29]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-30"></span>
<span class="grey"><a href="./rfc4067">RFC 4067</a>            Context Transfer Protocol (CXTP)           July 2005</span>


   In addition, 802.15.1 handover times are typically run upwards of a
   second or more because the host must resynchronize its frequency
   hopping pattern with the access point, so anything the IP layer could
   do to alleviate further delay would be beneficial.

   The context-specific data field for MLD context transfer included in
   the CXTP Context Data Block message for a single IPv6 multicast
   address has the following format:

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                                                               |
      +             Subnet Prefix on nAR Wireless Interface           +
      |                                                               |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                                                               |
      +                                                               +
      |                                                               |
      +               Subscribed IPv6 Multicast Address               +
      |                                                               |
      +                                                               +
      |                                                               |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   The Subnet Prefix on a nAR Wireless Interface field contains a subnet
   prefix that identifies the interface on which multicast routing
   should be established.  The Subscribed IPv6 Multicast Address field
   contains the multicast address for which multicast routing should be
   established.

   The pAR sends one MLD context block per subscribed IPv6 multicast
   address.

   No changes are required in the MLD state machine.

   Upon receipt of a CXTP Context Data Block for MLD, the state machine
   takes the following actions:

      -  If the router is in the No Listeners present state on the
         wireless interface on which the Subnet Prefix field in the
         Context Data Block is advertised, it transitions into the
         Listeners Present state for the Subscribed IPv6 Multicast
         Address field in the Context Data Block.  This transition is
         exactly the same as if the router had received a Report
         message.





<span class="grey">Loughney, et al.              Experimental                     [Page 30]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-31"></span>
<span class="grey"><a href="./rfc4067">RFC 4067</a>            Context Transfer Protocol (CXTP)           July 2005</span>


      -  If the router is in the Listeners present state on that
         interface, it remains in that state but restarts the timer, as
         if it had received a Report message.

   If more than one MLD router is on the link, a router receiving an MLD
   Context Data Block SHOULD send the block to the other routers on the
   link.  If wireless bandwidth is not an issue, the router MAY instead
   send a proxy MLD Report message on the wireless interface that
   advertises the Subnet Prefix field from the Context Data Block.
   Since MLD routers do not keep track of which nodes are listening to
   multicast addresses (only whether a particular multicast address is
   being listened to) proxying the subscription should cause no
   difficulty.






































<span class="grey">Loughney, et al.              Experimental                     [Page 31]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-32"></span>
<span class="grey"><a href="./rfc4067">RFC 4067</a>            Context Transfer Protocol (CXTP)           July 2005</span>


Authors' Addresses

   Rajeev Koodli
   Nokia Research Center
   313 Fairchild Drive
   Mountain View, California 94043
   USA

   EMail: rajeev.koodli@nokia.com


   John Loughney
   Nokia
   Itdmerenkatu 11-13
   00180 Espoo
   Finland

   EMail: john.loughney@nokia.com


   Madjid F. Nakhjiri
   Motorola Labs
   1301 East Algonquin Rd., Room 2240
   Schaumburg, IL, 60196
   USA

   EMail: madjid.nakhjiri@motorola.com


   Charles E. Perkins
   Nokia Research Center
   313 Fairchild Drive
   Mountain View, California 94043
   USA

   EMail: charles.perkins@.nokia.com















<span class="grey">Loughney, et al.              Experimental                     [Page 32]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-33"></span>
<span class="grey"><a href="./rfc4067">RFC 4067</a>            Context Transfer Protocol (CXTP)           July 2005</span>


Full Copyright Statement

   Copyright (C) The Internet Society (2005).

   This document is subject to the rights, licenses and restrictions
   contained in <a href="https://www.rfc-editor.org/bcp/bcp78">BCP 78</a>, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY AND THE INTERNET
   ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR IMPLIED,
   INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE
   INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in <a href="https://www.rfc-editor.org/bcp/bcp78">BCP 78</a> and <a href="https://www.rfc-editor.org/bcp/bcp79">BCP 79</a>.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   <a href="http://www.ietf.org/ipr">http://www.ietf.org/ipr</a>.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at ietf-
   ipr@ietf.org.

Acknowledgement

   Funding for the RFC Editor function is currently provided by the
   Internet Society.







Loughney, et al.              Experimental                     [Page 33]
</pre>
</body></html>