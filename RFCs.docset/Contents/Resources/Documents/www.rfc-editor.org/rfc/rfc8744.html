<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 8744: Issues and Requirements for Server Name Identification (SNI) Encryption in TLS</title>
<meta content="Christian Huitema" name="author"/>
<meta content='
       This document describes the general problem of encrypting the
Server Name Identification (SNI) TLS parameter. The proposed
solutions hide a hidden service behind a fronting service,
only disclosing the SNI of the fronting service to external
observers. This document lists known attacks against
SNI encryption, discusses the current "HTTP co-tenancy" solution,
and presents requirements for future TLS-layer solutions.
 
       In practice, it may well be that no solution can meet every requirement
and that practical solutions will have to make some compromises.
 
    ' name="description"/>
<meta content="xml2rfc 2.47.0" name="generator"/>
<meta content="8744" name="rfc.number"/>
<link href="rfc8744.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://dx.doi.org/10.17487/rfc8744" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <link href="https://datatracker.ietf.org/doc/draft-ietf-tls-sni-encryption-09" rel="prev"/>
  </head>
<body>
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 8744</td>
<td class="center">TLS-SNI Encryption Requirements</td>
<td class="right">July 2020</td>
</tr></thead>
<tfoot><tr>
<td class="left">Huitema</td>
<td class="center">Informational</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc8744">8744</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Informational</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2020-07">July 2020</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">C. Huitema</div>
<div class="org">Private Octopus Inc.</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 8744</h1>
<h1 id="title">Issues and Requirements for Server Name Identification (SNI) Encryption in TLS</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">This document describes the general problem of encrypting the
Server Name Identification (SNI) TLS parameter. The proposed
solutions hide a hidden service behind a fronting service,
only disclosing the SNI of the fronting service to external
observers. This document lists known attacks against
SNI encryption, discusses the current "HTTP co-tenancy" solution,
and presents requirements for future TLS-layer solutions.<a class="pilcrow" href="#section-abstract-1">¶</a></p>
<p id="section-abstract-2">In practice, it may well be that no solution can meet every requirement
and that practical solutions will have to make some compromises.<a class="pilcrow" href="#section-abstract-2">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This document is not an Internet Standards Track specification; it is
            published for informational purposes.<a class="pilcrow" href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by the
            Internet Engineering Steering Group (IESG).  Not all documents
            approved by the IESG are candidates for any level of Internet
            Standard; see Section 2 of RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc8744">https://www.rfc-editor.org/info/rfc8744</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2020 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">▲</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.1">
            <p class="keepWithNext" id="section-toc.1-1.1.1"><a class="xref" href="#section-1">1</a>.  <a class="xref" href="#name-introduction">Introduction</a><a class="pilcrow" href="#section-toc.1-1.1.1">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a class="xref" href="#section-2">2</a>.  <a class="xref" href="#name-history-of-the-tls-sni-exte">History of the TLS SNI Extension</a><a class="pilcrow" href="#section-toc.1-1.2.1">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.2.2.1">
                <p class="keepWithNext" id="section-toc.1-1.2.2.1.1"><a class="xref" href="#section-2.1">2.1</a>.  <a class="xref" href="#name-unanticipated-usage-of-sni-">Unanticipated Usage of SNI Information</a><a class="pilcrow" href="#section-toc.1-1.2.2.1.1">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.2.2.2">
                <p class="keepWithNext" id="section-toc.1-1.2.2.2.1"><a class="xref" href="#section-2.2">2.2</a>.  <a class="xref" href="#name-sni-encryption-timeliness">SNI Encryption Timeliness</a><a class="pilcrow" href="#section-toc.1-1.2.2.2.1">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a class="xref" href="#section-2.3">2.3</a>.  <a class="xref" href="#name-end-to-end-alternatives">End-to-End Alternatives</a><a class="pilcrow" href="#section-toc.1-1.2.2.3.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a class="xref" href="#section-3">3</a>.  <a class="xref" href="#name-security-and-privacy-requir">Security and Privacy Requirements for SNI Encryption</a><a class="pilcrow" href="#section-toc.1-1.3.1">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a class="xref" href="#section-3.1">3.1</a>.  <a class="xref" href="#name-mitigate-cut-and-paste-atta">Mitigate Cut-and-Paste Attacks</a><a class="pilcrow" href="#section-toc.1-1.3.2.1.1">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a class="xref" href="#section-3.2">3.2</a>.  <a class="xref" href="#name-avoid-widely-shared-secrets">Avoid Widely Shared Secrets</a><a class="pilcrow" href="#section-toc.1-1.3.2.2.1">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a class="xref" href="#section-3.3">3.3</a>.  <a class="xref" href="#name-prevent-sni-based-denial-of">Prevent SNI-Based Denial-of-Service Attacks</a><a class="pilcrow" href="#section-toc.1-1.3.2.3.1">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a class="xref" href="#section-3.4">3.4</a>.  <a class="xref" href="#name-do-not-stick-out">Do Not Stick Out</a><a class="pilcrow" href="#section-toc.1-1.3.2.4.1">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a class="xref" href="#section-3.5">3.5</a>.  <a class="xref" href="#name-maintain-forward-secrecy">Maintain Forward Secrecy</a><a class="pilcrow" href="#section-toc.1-1.3.2.5.1">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.6">
                <p id="section-toc.1-1.3.2.6.1"><a class="xref" href="#section-3.6">3.6</a>.  <a class="xref" href="#name-enable-multi-party-security">Enable Multi-party Security Contexts</a><a class="pilcrow" href="#section-toc.1-1.3.2.6.1">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.7">
                <p id="section-toc.1-1.3.2.7.1"><a class="xref" href="#section-3.7">3.7</a>.  <a class="xref" href="#name-support-multiple-protocols">Support Multiple Protocols</a><a class="pilcrow" href="#section-toc.1-1.3.2.7.1">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.3.2.7.2.1">
                    <p id="section-toc.1-1.3.2.7.2.1.1"><a class="xref" href="#section-3.7.1">3.7.1</a>.  <a class="xref" href="#name-hiding-the-application-laye">Hiding the Application-Layer Protocol Negotiation</a><a class="pilcrow" href="#section-toc.1-1.3.2.7.2.1.1">¶</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.7.2.2">
                    <p id="section-toc.1-1.3.2.7.2.2.1"><a class="xref" href="#section-3.7.2">3.7.2</a>.  <a class="xref" href="#name-supporting-other-transports">Supporting Other Transports than TCP</a><a class="pilcrow" href="#section-toc.1-1.3.2.7.2.2.1">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="xref" href="#section-4">4</a>.  <a class="xref" href="#name-http-co-tenancy-fronting">HTTP Co-tenancy Fronting</a><a class="pilcrow" href="#section-toc.1-1.4.1">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a class="xref" href="#section-4.1">4.1</a>.  <a class="xref" href="#name-https-tunnels">HTTPS Tunnels</a><a class="pilcrow" href="#section-toc.1-1.4.2.1.1">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a class="xref" href="#section-4.2">4.2</a>.  <a class="xref" href="#name-delegation-control">Delegation Control</a><a class="pilcrow" href="#section-toc.1-1.4.2.2.1">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a class="xref" href="#section-4.3">4.3</a>.  <a class="xref" href="#name-related-work">Related Work</a><a class="pilcrow" href="#section-toc.1-1.4.2.3.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="xref" href="#section-5">5</a>.  <a class="xref" href="#name-security-considerations">Security Considerations</a><a class="pilcrow" href="#section-toc.1-1.5.1">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="xref" href="#section-6">6</a>.  <a class="xref" href="#name-iana-considerations">IANA Considerations</a><a class="pilcrow" href="#section-toc.1-1.6.1">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="xref" href="#section-7">7</a>.  <a class="xref" href="#name-informative-references">Informative References</a><a class="pilcrow" href="#section-toc.1-1.7.1">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="xref" href="#section-appendix.a"></a><a class="xref" href="#name-acknowledgements">Acknowledgements</a><a class="pilcrow" href="#section-toc.1-1.8.1">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="xref" href="#section-appendix.b"></a><a class="xref" href="#name-authors-address">Author's Address</a><a class="pilcrow" href="#section-toc.1-1.9.1">¶</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">Historically, adversaries have been able to monitor the use of web
services through three primary channels: looking at DNS requests, looking
at IP addresses in packet headers, and looking at the data stream between
user and services. These channels are getting progressively closed.
A growing fraction of
Internet communication is encrypted, mostly using Transport Layer Security
(TLS) <span>[<a class="xref" href="#RFC8446">RFC8446</a>]</span>.
Progressive deployment of solutions like DNS over
TLS <span>[<a class="xref" href="#RFC7858">RFC7858</a>]</span> and DNS over HTTPS <span>[<a class="xref" href="#RFC8484">RFC8484</a>]</span>
mitigates the disclosure of DNS information. More and
more services are colocated on multiplexed servers, loosening the
relation between IP address and web service. For example, in virtual hosting
solutions, multiple services can be hosted as co-tenants on the same server,
and the IP address and port do not uniquely identify a service. In cloud or
Content Delivery Network (CDN) solutions, a given platform hosts the services
or servers of a lot of organizations, and looking up what netblock
an IP address belongs to reveals little. However, multiplexed servers
rely on the Server Name Information (SNI) TLS extension <span>[<a class="xref" href="#RFC6066">RFC6066</a>]</span> to direct connections
to the appropriate service implementation. This protocol element
is transmitted in cleartext. As the other methods of monitoring get
blocked, monitoring focuses on the cleartext SNI. The purpose
of SNI encryption is to prevent that and aid privacy.<a class="pilcrow" href="#section-1-1">¶</a></p>
<p id="section-1-2">Replacing cleartext SNI transmission by an encrypted variant will
improve the privacy and reliability of TLS connections, but the design
of proper SNI encryption solutions is difficult.
In the past, there have been multiple attempts at defining SNI encryption.
These attempts have generally floundered, because the simple designs fail
to mitigate several of the attacks listed in <a class="xref" href="#snisecreq">Section 3</a>. In the absence of
a TLS-level solution, the most popular approach to SNI privacy for web
services is HTTP-level fronting, which we discuss in <a class="xref" href="#httpfronting">Section 4</a>.<a class="pilcrow" href="#section-1-2">¶</a></p>
<p id="section-1-3">This document does not present the design of a solution but
provides guidelines for evaluating proposed solutions. (The review of
HTTP-level solutions in <a class="xref" href="#httpfronting">Section 4</a> is not
an endorsement of these solutions.)
The need for related work on the encryption of the Application-Layer
Protocol Negotiation (ALPN) parameters of TLS is discussed in
<a class="xref" href="#hiding-alpn">Section 3.7.1</a>.<a class="pilcrow" href="#section-1-3">¶</a></p>
</section>
</div>
<div id="history-of-the-tls-sni-extension">
<section id="section-2">
      <h2 id="name-history-of-the-tls-sni-exte">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-history-of-the-tls-sni-exte">History of the TLS SNI Extension</a>
      </h2>
<p id="section-2-1">The SNI extension was specified in 2003 in <span>[<a class="xref" href="#RFC3546">RFC3546</a>]</span> to facilitate management
of "colocation servers", in which multiple services shared the same IP
address. A typical example would be multiple websites served by the
same web server. The SNI extension carries the name of a specific
server, enabling the TLS connection to be established with the desired
server context. The current SNI extension specification can be
found in <span>[<a class="xref" href="#RFC6066">RFC6066</a>]</span>.<a class="pilcrow" href="#section-2-1">¶</a></p>
<p id="section-2-2">The SNI specification allowed for different types of server names,
though only the "hostname" variant was specified and deployed. In that
variant, the SNI extension carries the domain name of the target
server. The SNI extension is carried in cleartext in the TLS "ClientHello"
message.<a class="pilcrow" href="#section-2-2">¶</a></p>
<div id="snileak">
<section id="section-2.1">
        <h3 id="name-unanticipated-usage-of-sni-">
<a class="section-number selfRef" href="#section-2.1">2.1. </a><a class="section-name selfRef" href="#name-unanticipated-usage-of-sni-">Unanticipated Usage of SNI Information</a>
        </h3>
<p id="section-2.1-1">The SNI was defined to facilitate management of servers, but the
developers of middleboxes found out that they could take
advantage of the information. Many examples of such usage are
reviewed in <span>[<a class="xref" href="#RFC8404">RFC8404</a>]</span>. Other examples came out
during discussions of this document. They include:<a class="pilcrow" href="#section-2.1-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-2.1">Filtering or censoring specific services for a variety of reasons<a class="pilcrow" href="#section-2.1-2.1">¶</a>
</li>
          <li class="normal" id="section-2.1-2.2">Content filtering by network operators or ISPs blocking specific
   websites, for example, to implement parental controls or to prevent access
to phishing or other fraudulent websites<a class="pilcrow" href="#section-2.1-2.2">¶</a>
</li>
          <li class="normal" id="section-2.1-2.3">ISP assigning different QoS profiles to target services<a class="pilcrow" href="#section-2.1-2.3">¶</a>
</li>
          <li class="normal" id="section-2.1-2.4">Firewalls within enterprise networks blocking websites not deemed
appropriate for work<a class="pilcrow" href="#section-2.1-2.4">¶</a>
</li>
          <li class="normal" id="section-2.1-2.5">Firewalls within enterprise networks exempting specific websites from
man-in-the-middle (MITM) inspection, such as healthcare or financial
sites for which inspection would intrude on the privacy of employees<a class="pilcrow" href="#section-2.1-2.5">¶</a>
</li>
        </ul>
<p id="section-2.1-3">The SNI is probably also included in the general collection of metadata
by pervasive surveillance actors <span>[<a class="xref" href="#RFC7258">RFC7258</a>]</span>,
for example, to identify services
used by surveillance targets.<a class="pilcrow" href="#section-2.1-3">¶</a></p>
</section>
</div>
<div id="sniwhyencryptnow">
<section id="section-2.2">
        <h3 id="name-sni-encryption-timeliness">
<a class="section-number selfRef" href="#section-2.2">2.2. </a><a class="section-name selfRef" href="#name-sni-encryption-timeliness">SNI Encryption Timeliness</a>
        </h3>
<p id="section-2.2-1">The cleartext transmission of the SNI was not flagged as a problem
in the Security Considerations sections of <span>[<a class="xref" href="#RFC3546">RFC3546</a>]</span>, <span>[<a class="xref" href="#RFC4366">RFC4366</a>]</span>, or
<span>[<a class="xref" href="#RFC6066">RFC6066</a>]</span>. These specifications did not anticipate the
alternative usage described
in <a class="xref" href="#snileak">Section 2.1</a>. One reason may be that, when
these RFCs were written, the
SNI information was available through a variety of other means,
such as tracking IP addresses, DNS names, or server certificates.<a class="pilcrow" href="#section-2.2-1">¶</a></p>
<p id="section-2.2-2">Many deployments still allocate different IP addresses to different
services, so that different services can be identified by their IP
addresses. However, CDNs commonly
serve a large number of services through a comparatively small
number of addresses.<a class="pilcrow" href="#section-2.2-2">¶</a></p>
<p id="section-2.2-3">The SNI carries the domain name of the server, which is also sent as
part of the DNS queries. Most of the SNI usage described in <a class="xref" href="#snileak">Section 2.1</a>
could also be implemented by monitoring DNS traffic or controlling DNS
usage. But this is changing with the advent of DNS resolvers
providing services like DNS over TLS <span>[<a class="xref" href="#RFC7858">RFC7858</a>]</span>
or DNS over HTTPS <span>[<a class="xref" href="#RFC8484">RFC8484</a>]</span>.<a class="pilcrow" href="#section-2.2-3">¶</a></p>
<p id="section-2.2-4">The subjectAltName extension of type dNSName of the server certificate
(or in its absence, the common name component) exposes
the same name as the SNI. In TLS versions 1.0 <span>[<a class="xref" href="#RFC2246">RFC2246</a>]</span>, 1.1 <span>[<a class="xref" href="#RFC4346">RFC4346</a>]</span>,
and 1.2 <span>[<a class="xref" href="#RFC5246">RFC5246</a>]</span>, servers send certificates in cleartext,
ensuring that there would be limited benefits in hiding the SNI. However,
in TLS 1.3 <span>[<a class="xref" href="#RFC8446">RFC8446</a>]</span>, server certificates are
encrypted in transit.
Note that encryption alone is insufficient to protect server certificates;
see <a class="xref" href="#cutandpasteattack">Section 3.1</a> for details.<a class="pilcrow" href="#section-2.2-4">¶</a></p>
<p id="section-2.2-5">The decoupling of IP addresses and server names, deployment of DNS
        privacy, and protection of server certificate transmissions all
        contribute to user privacy in the face of an RFC 7258-style adversary
        <span>[<a class="xref" href="#RFC7258">RFC7258</a>]</span>. Encrypting the SNI
        complements this push for privacy and makes it harder to censor or
        otherwise provide differential treatment to specific Internet
        services.<a class="pilcrow" href="#section-2.2-5">¶</a></p>
</section>
</div>
<div id="end-to-end">
<section id="section-2.3">
        <h3 id="name-end-to-end-alternatives">
<a class="section-number selfRef" href="#section-2.3">2.3. </a><a class="section-name selfRef" href="#name-end-to-end-alternatives">End-to-End Alternatives</a>
        </h3>
<p id="section-2.3-1">Deploying SNI encryption helps thwart most of the unanticipated SNI usages,
including censorship and pervasive surveillance, but it also
will break or reduce the efficacy of the operational practices and
techniques implemented in middleboxes, as described in <a class="xref" href="#snileak">Section 2.1</a>. Most of
these functions can, however, be realized by other means. For example, some DNS service
providers offer customers the provision to "opt in" to filtering services
for parental control and phishing protection. Per-stream QoS could be provided by
a combination of packet marking and end-to-end agreements. As
SNI encryption becomes common, we can expect more deployment of such "end-to-end"
solutions.<a class="pilcrow" href="#section-2.3-1">¶</a></p>
<p id="section-2.3-2">At the time of this writing, enterprises have the option of installing a
firewall performing SNI filtering to
prevent connections to certain websites. With SNI encryption, this becomes ineffective.
Obviously, managers could block usage of SNI encryption in enterprise computers, but
this wide-scale blocking would diminish the privacy protection of traffic leaving the
enterprise, which may not be desirable.
Enterprise managers could rely instead on filtering software and management
software deployed on the enterprise's computers.<a class="pilcrow" href="#section-2.3-2">¶</a></p>
</section>
</div>
</section>
</div>
<div id="snisecreq">
<section id="section-3">
      <h2 id="name-security-and-privacy-requir">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-security-and-privacy-requir">Security and Privacy Requirements for SNI Encryption</a>
      </h2>
<p id="section-3-1">Over the past years, there have been multiple proposals to add an SNI encryption
option in TLS. A review of the TLS mailing list archives shows that
many of these proposals appeared promising but were rejected
after security reviews identified plausible attacks. In this section,
we collect a list of these known attacks.<a class="pilcrow" href="#section-3-1">¶</a></p>
<div id="cutandpasteattack">
<section id="section-3.1">
        <h3 id="name-mitigate-cut-and-paste-atta">
<a class="section-number selfRef" href="#section-3.1">3.1. </a><a class="section-name selfRef" href="#name-mitigate-cut-and-paste-atta">Mitigate Cut-and-Paste Attacks</a>
        </h3>
<p id="section-3.1-1">The simplest SNI encryption designs
 replace the cleartext SNI in the initial TLS
   exchange with
an encrypted value, using a key known to the multiplexed server. Regardless of the
encryption used, these designs can be broken by a simple cut-and-paste attack, which works
as follows:<a class="pilcrow" href="#section-3.1-1">¶</a></p>
<ol class="normal type-1" id="section-3.1-2" start="1" type="1">
          <li id="section-3.1-2.1">The user starts a TLS connection to the multiplexed server, including an encrypted
   SNI value.<a class="pilcrow" href="#section-3.1-2.1">¶</a>
</li>
          <li id="section-3.1-2.2">The adversary observes the exchange and copies the encrypted SNI parameter.<a class="pilcrow" href="#section-3.1-2.2">¶</a>
</li>
          <li id="section-3.1-2.3">The adversary starts its own connection to the multiplexed server, including in its
   connection parameters the encrypted SNI copied from the observed exchange.<a class="pilcrow" href="#section-3.1-2.3">¶</a>
</li>
          <li id="section-3.1-2.4">The multiplexed server establishes the connection to the protected service, which sends its certificate, thus revealing the identity of the service.<a class="pilcrow" href="#section-3.1-2.4">¶</a>
</li>
        </ol>
<p id="section-3.1-3">One of the goals of SNI encryption is to prevent adversaries from knowing which
hidden service the client is using. Successful cut-and-paste attacks break that goal by
allowing adversaries to discover that service.<a class="pilcrow" href="#section-3.1-3">¶</a></p>
</section>
</div>
<div id="sharedsecrets">
<section id="section-3.2">
        <h3 id="name-avoid-widely-shared-secrets">
<a class="section-number selfRef" href="#section-3.2">3.2. </a><a class="section-name selfRef" href="#name-avoid-widely-shared-secrets">Avoid Widely Shared Secrets</a>
        </h3>
<p id="section-3.2-1">It is easy to think of simple schemes in which the SNI is encrypted or hashed using a
shared secret. This symmetric key must be known by the multiplexed server and by
every user of the protected services. Such schemes are thus very fragile, since the
compromise of a single user would compromise the entire set of users and protected
services.<a class="pilcrow" href="#section-3.2-1">¶</a></p>
</section>
</div>
<div id="serveroverload">
<section id="section-3.3">
        <h3 id="name-prevent-sni-based-denial-of">
<a class="section-number selfRef" href="#section-3.3">3.3. </a><a class="section-name selfRef" href="#name-prevent-sni-based-denial-of">Prevent SNI-Based Denial-of-Service Attacks</a>
        </h3>
<p id="section-3.3-1">Encrypting the SNI may create extra load for the multiplexed server. Adversaries may mount
denial-of-service (DoS) attacks by generating random encrypted SNI values and forcing the
multiplexed server to spend resources in useless decryption attempts.<a class="pilcrow" href="#section-3.3-1">¶</a></p>
<p id="section-3.3-2">It may be argued that this is not an important avenue for DoS attacks,
as regular TLS connection
attempts also require the server to perform a number of cryptographic operations. However,
in many cases, the SNI decryption will have to be performed by a front-end component
with limited resources, while the TLS operations are performed by the component dedicated
to their respective services. SNI-based DoS attacks could target the front-end component.<a class="pilcrow" href="#section-3.3-2">¶</a></p>
</section>
</div>
<div id="snireqdontstickout">
<section id="section-3.4">
        <h3 id="name-do-not-stick-out">
<a class="section-number selfRef" href="#section-3.4">3.4. </a><a class="section-name selfRef" href="#name-do-not-stick-out">Do Not Stick Out</a>
        </h3>
<p id="section-3.4-1">In some designs, handshakes using SNI encryption can be easily differentiated from
"regular" handshakes. For example, some designs require specific extensions in
the ClientHello packets or specific values of the cleartext SNI parameter.
If adversaries can easily detect the use of SNI encryption,
they could block it, or they could flag the users of SNI encryption for
special treatment.<a class="pilcrow" href="#section-3.4-1">¶</a></p>
<p id="section-3.4-2">In the future, it might be possible to assume that a large fraction of TLS handshakes
use SNI encryption. If that were the case, the detection of SNI encryption would
be a lesser concern. However, we have to assume that, in the near future, only
a small fraction of TLS connections will use SNI encryption.<a class="pilcrow" href="#section-3.4-2">¶</a></p>
<p id="section-3.4-3">This requirement to not stick out may be difficult to meet in
        practice, as noted in <a class="xref" href="#secusec">Section 5</a>.<a class="pilcrow" href="#section-3.4-3">¶</a></p>
</section>
</div>
<div id="forward-secrecy">
<section id="section-3.5">
        <h3 id="name-maintain-forward-secrecy">
<a class="section-number selfRef" href="#section-3.5">3.5. </a><a class="section-name selfRef" href="#name-maintain-forward-secrecy">Maintain Forward Secrecy</a>
        </h3>
<p id="section-3.5-1">TLS 1.3 <span>[<a class="xref" href="#RFC8446">RFC8446</a>]</span> is designed to provide forward
        secrecy, so that (for example) keys used in past sessions will not be
        compromised even if the private key of the server is compromised. The
        general concerns about forward secrecy apply to SNI encryption as
        well.  For example, some proposed designs rely on a public key of the
        multiplexed server to define the SNI encryption key. If the
        corresponding private key should be compromised, the adversaries would
        be able to process archival records of past connections and retrieve
        the protected SNI used in these connections. These designs fail to
        maintain forward secrecy of SNI encryption.<a class="pilcrow" href="#section-3.5-1">¶</a></p>
</section>
</div>
<div id="nocontextsharing">
<section id="section-3.6">
        <h3 id="name-enable-multi-party-security">
<a class="section-number selfRef" href="#section-3.6">3.6. </a><a class="section-name selfRef" href="#name-enable-multi-party-security">Enable Multi-party Security Contexts</a>
        </h3>
<p id="section-3.6-1">We can design solutions in which a fronting
service acts as a relay to reach the protected service. Some of those
solutions involve just one TLS handshake between the client and the fronting service.
The master secret is verified by verifying a certificate provided by
the fronting service but not by the protected service.
These solutions expose the client to a MITM attack by
the fronting service. Even if the client
has some reasonable trust in this service, the possibility of a
MITM attack is troubling.<a class="pilcrow" href="#section-3.6-1">¶</a></p>
<p id="section-3.6-2">There are other classes of solutions in which the master secret is verified by
verifying a certificate provided by the protected service. These solutions offer
more protection against a MITM attack by the fronting service.
The
downside is that the client will not verify the identity of the fronting service,
which enables fronting server spoofing attacks, such as the "honeypot" attack
discussed below. Overall, end-to-end TLS to the protected service is preferable,
but it is important to also provide a way to authenticate the fronting service.<a class="pilcrow" href="#section-3.6-2">¶</a></p>
<p id="section-3.6-3">The fronting service could be pressured by adversaries.
By design, it could be forced to deny access to
the protected service or to divulge which client accessed it. But
if a MITM attack is possible, the adversaries would also be able to pressure
the fronting service into intercepting or spoofing the communications between
client and protected service.<a class="pilcrow" href="#section-3.6-3">¶</a></p>
<p id="section-3.6-4">Adversaries could also mount an attack by spoofing the fronting service. A
spoofed fronting service could act as a "honeypot" for users of
hidden services. At a minimum, the fake server could record the IP
addresses of these users. If the SNI encryption solution places too
much trust on the fronting server, the fake server could also
serve fake content of its own choosing, including various forms of
malware.<a class="pilcrow" href="#section-3.6-4">¶</a></p>
<p id="section-3.6-5">There are two main channels by which adversaries can conduct this
attack. Adversaries can simply try to mislead users into believing
that the honeypot is a valid fronting server, especially if that
information is carried by word of mouth or in unprotected DNS
records. Adversaries can also attempt to hijack the traffic to the
regular fronting server, using, for example, spoofed DNS responses
or spoofed IP-level routing, combined with a spoofed certificate.<a class="pilcrow" href="#section-3.6-5">¶</a></p>
</section>
</div>
<div id="multi-protocol">
<section id="section-3.7">
        <h3 id="name-support-multiple-protocols">
<a class="section-number selfRef" href="#section-3.7">3.7. </a><a class="section-name selfRef" href="#name-support-multiple-protocols">Support Multiple Protocols</a>
        </h3>
<p id="section-3.7-1">The SNI encryption requirement does not stop with HTTP over
 TLS.
Multiple other
applications currently use TLS, including, for example, SMTP <span>[<a class="xref" href="#RFC3207">RFC3207</a>]</span>,
DNS <span>[<a class="xref" href="#RFC7858">RFC7858</a>]</span>, IMAP <span>[<a class="xref" href="#RFC8314">RFC8314</a>]</span>,
and the Extensible Messaging and Presence Protocol (XMPP) <span>[<a class="xref" href="#RFC7590">RFC7590</a>]</span>. These applications, too,
will benefit from SNI encryption.
HTTP-only methods, like those described in <a class="xref" href="#httpfrontingtunnels">Section 4.1</a>,
would not apply there. In fact, even for the HTTPS case, the HTTPS tunneling
service described in <a class="xref" href="#httpfrontingtunnels">Section 4.1</a> is
compatible with HTTP 1.0 and HTTP 1.1
but interacts awkwardly with the multiple streams feature of HTTP/2 <span>[<a class="xref" href="#RFC7540">RFC7540</a>]</span>.
This points to the need for an application-agnostic solution, which would be
implemented fully in the TLS layer.<a class="pilcrow" href="#section-3.7-1">¶</a></p>
<div id="hiding-alpn">
<section id="section-3.7.1">
          <h4 id="name-hiding-the-application-laye">
<a class="section-number selfRef" href="#section-3.7.1">3.7.1. </a><a class="section-name selfRef" href="#name-hiding-the-application-laye">Hiding the Application-Layer Protocol Negotiation</a>
          </h4>
<p id="section-3.7.1-1">The Application-Layer Protocol Negotiation (ALPN) parameters of
   TLS allow implementations to negotiate the application-layer
   protocol used on a given connection. TLS provides the ALPN values in
   cleartext during the initial handshake. While exposing the ALPN
   does not create the same privacy issues as exposing the SNI, there
   is still a risk. For example, some networks may attempt to block
   applications that they do not understand or that they wish users
   would not use.<a class="pilcrow" href="#section-3.7.1-1">¶</a></p>
<p id="section-3.7.1-2">In a sense, ALPN filtering could be very similar to the filtering
of specific port numbers exposed in some networks. This filtering by ports
has given rise to evasion tactics in which various protocols are tunneled
over HTTP in order to use open ports 80 or 443. Filtering by ALPN would
probably beget the same responses, in which the applications just move
over HTTP and only the HTTP ALPN values are used.
Applications would not
need to do that if the ALPN were hidden in the same way as the SNI.<a class="pilcrow" href="#section-3.7.1-2">¶</a></p>
<p id="section-3.7.1-3">In addition to hiding the SNI, it is thus desirable to also hide
   the ALPN. Of course, this implies engineering trade-offs. Using the
   same technique for hiding the ALPN and encrypting the SNI may result
   in excess complexity. It might be preferable to encrypt these
   independently.<a class="pilcrow" href="#section-3.7.1-3">¶</a></p>
</section>
</div>
<div id="support-other-transports-than-tcp">
<section id="section-3.7.2">
          <h4 id="name-supporting-other-transports">
<a class="section-number selfRef" href="#section-3.7.2">3.7.2. </a><a class="section-name selfRef" href="#name-supporting-other-transports">Supporting Other Transports than TCP</a>
          </h4>
<p id="section-3.7.2-1">The TLS handshake is also used over other transports, such as UDP
with both DTLS <span>[<a class="xref" href="#I-D.ietf-tls-dtls13">DTLS-1.3</a>]</span> and
QUIC <span>[<a class="xref" href="#I-D.ietf-quic-tls">QUIC</a>]</span>. The requirement to
encrypt the SNI applies just as well for these transports as for TLS over
TCP.<a class="pilcrow" href="#section-3.7.2-1">¶</a></p>
<p id="section-3.7.2-2">This points to a requirement for SNI encryption mechanisms to also
be applicable to non-TCP transports such as DTLS or QUIC.<a class="pilcrow" href="#section-3.7.2-2">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="httpfronting">
<section id="section-4">
      <h2 id="name-http-co-tenancy-fronting">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-http-co-tenancy-fronting">HTTP Co-tenancy Fronting</a>
      </h2>
<p id="section-4-1">In the absence of TLS-level SNI encryption, many sites rely on an
      "HTTP co-tenancy" solution, often referred to as "domain fronting" <span>[<a class="xref" href="#DOMFRONT">DOMFRONT</a>]</span>. The TLS connection is established
      with the fronting server, and HTTP requests are then sent over that
      connection to the hidden service.
For example, the TLS SNI could be set
      to "fronting.example.com" (the fronting server), and HTTP requests sent
      over that connection could be directed to "hidden.example.com"
      (accessing the hidden service). This solution works well in
practice when the fronting server and the hidden server
are "co-tenants" of the same multiplexed server.<a class="pilcrow" href="#section-4-1">¶</a></p>
<p id="section-4-2">The HTTP domain fronting solution can be deployed without modification to
      the TLS protocol and does not require using any specific version of
      TLS. There are, however, a few issues regarding discovery, client
      implementations, trust, and applicability:<a class="pilcrow" href="#section-4-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-3.1">The client has to discover that the hidden service can be accessed
 through the fronting server.<a class="pilcrow" href="#section-4-3.1">¶</a>
</li>
        <li class="normal" id="section-4-3.2">The client's browser has to be directed to access the hidden
 service through the fronting service.<a class="pilcrow" href="#section-4-3.2">¶</a>
</li>
        <li class="normal" id="section-4-3.3">Since the TLS connection is established with the fronting service,
 the client has no cryptographic proof that the content does, in fact,
 come from the hidden service. Thus, the solution does not mitigate the
 context sharing issues described in <a class="xref" href="#nocontextsharing">Section 3.6</a>. Note that this is already the case for
        co-tenanted sites.<a class="pilcrow" href="#section-4-3.3">¶</a>
</li>
        <li class="normal" id="section-4-3.4">Since this is an HTTP-level solution, it does not protect non-HTTP
protocols, as discussed in <a class="xref" href="#multi-protocol">Section 3.7</a>.<a class="pilcrow" href="#section-4-3.4">¶</a>
</li>
      </ul>
<p id="section-4-4">The discovery issue is common to most SNI encryption solutions.
The browser issue was solved in <span>[<a class="xref" href="#DOMFRONT">DOMFRONT</a>]</span> by
implementing domain fronting as a pluggable transport for the Tor browser. The
multi-protocol issue can be mitigated by implementing other
applications over HTTP, for example, DNS over HTTPS <span>[<a class="xref" href="#RFC8484">RFC8484</a>]</span>. The trust issue, however, requires
specific developments.<a class="pilcrow" href="#section-4-4">¶</a></p>
<div id="httpfrontingtunnels">
<section id="section-4.1">
        <h3 id="name-https-tunnels">
<a class="section-number selfRef" href="#section-4.1">4.1. </a><a class="section-name selfRef" href="#name-https-tunnels">HTTPS Tunnels</a>
        </h3>
<p id="section-4.1-1">The HTTP domain fronting solution places a lot of trust in the fronting
 server. This required trust can be reduced by tunneling HTTPS in
 HTTPS, which effectively treats the fronting server as an HTTP
 proxy. In this solution, the client establishes a TLS connection to
 the fronting server and then issues an HTTP connect request to the
 hidden server. This will establish an end-to-end HTTPS-over-TLS
 connection between the client and the hidden server, mitigating the
 issues described in <a class="xref" href="#nocontextsharing">Section 3.6</a>.<a class="pilcrow" href="#section-4.1-1">¶</a></p>
<p id="section-4.1-2">The HTTPS-in-HTTPS solution requires double encryption of every packet. It
also requires that the fronting server decrypt and relay messages to the
hidden server. Both of these requirements make the implementation onerous.<a class="pilcrow" href="#section-4.1-2">¶</a></p>
</section>
</div>
<div id="delegationtokens">
<section id="section-4.2">
        <h3 id="name-delegation-control">
<a class="section-number selfRef" href="#section-4.2">4.2. </a><a class="section-name selfRef" href="#name-delegation-control">Delegation Control</a>
        </h3>
<p id="section-4.2-1">Clients would see their privacy compromised if they contacted the wrong
fronting server to access the hidden service, since this wrong server
could disclose their access to adversaries. This requires a controlled
way to indicate which fronting server is acceptable by the hidden service.<a class="pilcrow" href="#section-4.2-1">¶</a></p>
<p id="section-4.2-2">This problem is similar to the "word of mouth" variant
of the "fronting server
spoofing" attack described in <a class="xref" href="#nocontextsharing">Section 3.6</a>. The spoofing
would be performed by distributing fake advice, such as "to reach
hidden.example.com, use fake.example.com as a fronting
server", when "fake.example.com" is under the control of an
adversary.<a class="pilcrow" href="#section-4.2-2">¶</a></p>
<p id="section-4.2-3">In practice, this attack is well mitigated when the hidden service
        is accessed through a specialized application. The name of the
        fronting server can then be programmed in the code of the
        application. But the attack is harder to mitigate when the hidden
        service has to be accessed through general-purpose web browsers.<a class="pilcrow" href="#section-4.2-3">¶</a></p>
<p id="section-4.2-4">There are several proposed solutions to this problem, such as creating
a special form of certificate to codify the relation between the fronting and
hidden server or obtaining the relation between the hidden and fronting service
through the DNS, possibly using DNSSEC, to avoid spoofing.
The experiment
described in <span>[<a class="xref" href="#DOMFRONT">DOMFRONT</a>]</span> solved the issue by
integrating with the Lantern Internet circumvention tool.<a class="pilcrow" href="#section-4.2-4">¶</a></p>
<p id="section-4.2-5">We can observe that CDNs have a similar requirement.
They need to convince the client that "www.example.com" can be accessed
through the seemingly unrelated "cdn-node-xyz.example.net". Most CDNs have
deployed DNS-based solutions to this problem. However, the CDN often
holds the authoritative certificate of the origin. There is, simultaneously,
verification of a relationship between the origin and the CDN (through the
certificate) and a risk that the CDN can spoof the
content from the origin.<a class="pilcrow" href="#section-4.2-5">¶</a></p>
</section>
</div>
<div id="related-work">
<section id="section-4.3">
        <h3 id="name-related-work">
<a class="section-number selfRef" href="#section-4.3">4.3. </a><a class="section-name selfRef" href="#name-related-work">Related Work</a>
        </h3>
<p id="section-4.3-1">The ORIGIN frame defined for HTTP/2 <span>[<a class="xref" href="#RFC8336">RFC8336</a>]</span> can be used to flag content provided by the hidden
 server. Secondary certificate authentication <span>[<a class="xref" href="#I-D.ietf-httpbis-http2-secondary-certs">HTTP2-SEC-CERTS</a>]</span> can
 be used to manage authentication of hidden server content or to
 perform client authentication before accessing hidden content.<a class="pilcrow" href="#section-4.3-1">¶</a></p>
</section>
</div>
</section>
</div>
<div id="secusec">
<section id="section-5">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<p id="section-5-1">This document lists a number of attacks against SNI encryption in Sections
      <a class="xref" href="#snisecreq">3</a> and <a class="xref" href="#delegationtokens">4.2</a> and presents a list of
      requirements to mitigate these attacks. Current HTTP-based solutions
described in <a class="xref" href="#httpfronting">Section 4</a> only meet some of
these requirements. In practice, it may well be that no solution can meet
every requirement and that practical solutions will have to make some
compromises.<a class="pilcrow" href="#section-5-1">¶</a></p>
<p id="section-5-2">In particular, the requirement to not stick out, presented in
<a class="xref" href="#snireqdontstickout">Section 3.4</a>, may have to be lifted,
especially for proposed solutions that could quickly reach large-scale
deployments.<a class="pilcrow" href="#section-5-2">¶</a></p>
<p id="section-5-3">Replacing cleartext SNI transmission by an encrypted variant will
      break or reduce the efficacy of the operational practices and techniques
implemented in middleboxes, as described in <a class="xref" href="#snileak">Section 2.1</a>. As explained in <a class="xref" href="#end-to-end">Section 2.3</a>, alternative solutions will have to be developed.<a class="pilcrow" href="#section-5-3">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-6">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<p id="section-6-1">This document has no IANA actions.<a class="pilcrow" href="#section-6-1">¶</a></p>
</section>
</div>
<section id="section-7">
      <h2 id="name-informative-references">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
      </h2>
<dl class="references">
<dt id="DOMFRONT">[DOMFRONT]</dt>
      <dd>
<span class="refAuthor">Fifield, D.</span><span class="refAuthor">, Lan, C.</span><span class="refAuthor">, Hynes, R.</span><span class="refAuthor">, Wegmann, P.</span><span class="refAuthor">, and V. Paxson</span>, <span class="refTitle">"Blocking-resistant communication through domain fronting"</span>, <span class="seriesInfo">DOI 10.1515/popets-2015-0009</span>, <time class="refDate" datetime="2015">2015</time>, <span>&lt;<a href="https://www.bamsoftware.com/papers/fronting/">https://www.bamsoftware.com/papers/fronting/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-tls-dtls13">[DTLS-1.3]</dt>
      <dd>
<span class="refAuthor">Rescorla, E.</span><span class="refAuthor">, Tschofenig, H.</span><span class="refAuthor">, and N. Modadugu</span>, <span class="refTitle">"The Datagram Transport Layer Security (DTLS) Protocol Version 1.3"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-tls-dtls13-38</span>, <time class="refDate" datetime="2020-05-29">29 May 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-tls-dtls13-38">https://tools.ietf.org/html/draft-ietf-tls-dtls13-38</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-httpbis-http2-secondary-certs">[HTTP2-SEC-CERTS]</dt>
      <dd>
<span class="refAuthor">Bishop, M.</span><span class="refAuthor">, Sullivan, N.</span><span class="refAuthor">, and M. Thomson</span>, <span class="refTitle">"Secondary Certificate Authentication in HTTP/2"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-httpbis-http2-secondary-certs-06</span>, <time class="refDate" datetime="2020-05-14">14 May 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-httpbis-http2-secondary-certs-06">https://tools.ietf.org/html/draft-ietf-httpbis-http2-secondary-certs-06</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-quic-tls">[QUIC]</dt>
      <dd>
<span class="refAuthor">Thomson, M.</span><span class="refAuthor"> and S. Turner</span>, <span class="refTitle">"Using TLS to Secure QUIC"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-quic-tls-29</span>, <time class="refDate" datetime="2020-06-09">9 June 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-quic-tls-29">https://tools.ietf.org/html/draft-ietf-quic-tls-29</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2246">[RFC2246]</dt>
      <dd>
<span class="refAuthor">Dierks, T.</span><span class="refAuthor"> and C. Allen</span>, <span class="refTitle">"The TLS Protocol Version 1.0"</span>, <span class="seriesInfo">RFC 2246</span>, <span class="seriesInfo">DOI 10.17487/RFC2246</span>, <time class="refDate" datetime="1999-01">January 1999</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2246">https://www.rfc-editor.org/info/rfc2246</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3207">[RFC3207]</dt>
      <dd>
<span class="refAuthor">Hoffman, P.</span>, <span class="refTitle">"SMTP Service Extension for Secure SMTP over Transport Layer Security"</span>, <span class="seriesInfo">RFC 3207</span>, <span class="seriesInfo">DOI 10.17487/RFC3207</span>, <time class="refDate" datetime="2002-02">February 2002</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3207">https://www.rfc-editor.org/info/rfc3207</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3546">[RFC3546]</dt>
      <dd>
<span class="refAuthor">Blake-Wilson, S.</span><span class="refAuthor">, Nystrom, M.</span><span class="refAuthor">, Hopwood, D.</span><span class="refAuthor">, Mikkelsen, J.</span><span class="refAuthor">, and T. Wright</span>, <span class="refTitle">"Transport Layer Security (TLS) Extensions"</span>, <span class="seriesInfo">RFC 3546</span>, <span class="seriesInfo">DOI 10.17487/RFC3546</span>, <time class="refDate" datetime="2003-06">June 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3546">https://www.rfc-editor.org/info/rfc3546</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4346">[RFC4346]</dt>
      <dd>
<span class="refAuthor">Dierks, T.</span><span class="refAuthor"> and E. Rescorla</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.1"</span>, <span class="seriesInfo">RFC 4346</span>, <span class="seriesInfo">DOI 10.17487/RFC4346</span>, <time class="refDate" datetime="2006-04">April 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4346">https://www.rfc-editor.org/info/rfc4346</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4366">[RFC4366]</dt>
      <dd>
<span class="refAuthor">Blake-Wilson, S.</span><span class="refAuthor">, Nystrom, M.</span><span class="refAuthor">, Hopwood, D.</span><span class="refAuthor">, Mikkelsen, J.</span><span class="refAuthor">, and T. Wright</span>, <span class="refTitle">"Transport Layer Security (TLS) Extensions"</span>, <span class="seriesInfo">RFC 4366</span>, <span class="seriesInfo">DOI 10.17487/RFC4366</span>, <time class="refDate" datetime="2006-04">April 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4366">https://www.rfc-editor.org/info/rfc4366</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5246">[RFC5246]</dt>
      <dd>
<span class="refAuthor">Dierks, T.</span><span class="refAuthor"> and E. Rescorla</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.2"</span>, <span class="seriesInfo">RFC 5246</span>, <span class="seriesInfo">DOI 10.17487/RFC5246</span>, <time class="refDate" datetime="2008-08">August 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5246">https://www.rfc-editor.org/info/rfc5246</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6066">[RFC6066]</dt>
      <dd>
<span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refTitle">"Transport Layer Security (TLS) Extensions: Extension Definitions"</span>, <span class="seriesInfo">RFC 6066</span>, <span class="seriesInfo">DOI 10.17487/RFC6066</span>, <time class="refDate" datetime="2011-01">January 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6066">https://www.rfc-editor.org/info/rfc6066</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7258">[RFC7258]</dt>
      <dd>
<span class="refAuthor">Farrell, S.</span><span class="refAuthor"> and H. Tschofenig</span>, <span class="refTitle">"Pervasive Monitoring Is an Attack"</span>, <span class="seriesInfo">BCP 188</span>, <span class="seriesInfo">RFC 7258</span>, <span class="seriesInfo">DOI 10.17487/RFC7258</span>, <time class="refDate" datetime="2014-05">May 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7258">https://www.rfc-editor.org/info/rfc7258</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7540">[RFC7540]</dt>
      <dd>
<span class="refAuthor">Belshe, M.</span><span class="refAuthor">, Peon, R.</span><span class="refAuthor">, and M. Thomson, Ed.</span>, <span class="refTitle">"Hypertext Transfer Protocol Version 2 (HTTP/2)"</span>, <span class="seriesInfo">RFC 7540</span>, <span class="seriesInfo">DOI 10.17487/RFC7540</span>, <time class="refDate" datetime="2015-05">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7540">https://www.rfc-editor.org/info/rfc7540</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7590">[RFC7590]</dt>
      <dd>
<span class="refAuthor">Saint-Andre, P.</span><span class="refAuthor"> and T. Alkemade</span>, <span class="refTitle">"Use of Transport Layer Security (TLS) in the Extensible Messaging and Presence Protocol (XMPP)"</span>, <span class="seriesInfo">RFC 7590</span>, <span class="seriesInfo">DOI 10.17487/RFC7590</span>, <time class="refDate" datetime="2015-06">June 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7590">https://www.rfc-editor.org/info/rfc7590</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7858">[RFC7858]</dt>
      <dd>
<span class="refAuthor">Hu, Z.</span><span class="refAuthor">, Zhu, L.</span><span class="refAuthor">, Heidemann, J.</span><span class="refAuthor">, Mankin, A.</span><span class="refAuthor">, Wessels, D.</span><span class="refAuthor">, and P. Hoffman</span>, <span class="refTitle">"Specification for DNS over Transport Layer Security (TLS)"</span>, <span class="seriesInfo">RFC 7858</span>, <span class="seriesInfo">DOI 10.17487/RFC7858</span>, <time class="refDate" datetime="2016-05">May 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7858">https://www.rfc-editor.org/info/rfc7858</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8314">[RFC8314]</dt>
      <dd>
<span class="refAuthor">Moore, K.</span><span class="refAuthor"> and C. Newman</span>, <span class="refTitle">"Cleartext Considered Obsolete: Use of Transport Layer Security (TLS) for Email Submission and Access"</span>, <span class="seriesInfo">RFC 8314</span>, <span class="seriesInfo">DOI 10.17487/RFC8314</span>, <time class="refDate" datetime="2018-01">January 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8314">https://www.rfc-editor.org/info/rfc8314</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8336">[RFC8336]</dt>
      <dd>
<span class="refAuthor">Nottingham, M.</span><span class="refAuthor"> and E. Nygren</span>, <span class="refTitle">"The ORIGIN HTTP/2 Frame"</span>, <span class="seriesInfo">RFC 8336</span>, <span class="seriesInfo">DOI 10.17487/RFC8336</span>, <time class="refDate" datetime="2018-03">March 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8336">https://www.rfc-editor.org/info/rfc8336</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8404">[RFC8404]</dt>
      <dd>
<span class="refAuthor">Moriarty, K., Ed.</span><span class="refAuthor"> and A. Morton, Ed.</span>, <span class="refTitle">"Effects of Pervasive Encryption on Operators"</span>, <span class="seriesInfo">RFC 8404</span>, <span class="seriesInfo">DOI 10.17487/RFC8404</span>, <time class="refDate" datetime="2018-07">July 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8404">https://www.rfc-editor.org/info/rfc8404</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
      <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time class="refDate" datetime="2018-08">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8484">[RFC8484]</dt>
    <dd>
<span class="refAuthor">Hoffman, P.</span><span class="refAuthor"> and P. McManus</span>, <span class="refTitle">"DNS Queries over HTTPS (DoH)"</span>, <span class="seriesInfo">RFC 8484</span>, <span class="seriesInfo">DOI 10.17487/RFC8484</span>, <time class="refDate" datetime="2018-10">October 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8484">https://www.rfc-editor.org/info/rfc8484</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<div id="acknowledgements">
<section id="section-appendix.a">
      <h2 id="name-acknowledgements">
<a class="section-name selfRef" href="#name-acknowledgements">Acknowledgements</a>
      </h2>
<p id="section-appendix.a-1">A large part of this document originated in discussion of SNI encryption
on the TLS WG mailing list, including comments after the tunneling
approach was first proposed in a message to that list:
<span>&lt;<a href="https://mailarchive.ietf.org/arch/msg/tls/tXvdcqnogZgqmdfCugrV8M90Ftw">https://mailarchive.ietf.org/arch/msg/tls/tXvdcqnogZgqmdfCugrV8M90Ftw</a>&gt;</span>.<a class="pilcrow" href="#section-appendix.a-1">¶</a></p>
<p id="section-appendix.a-2">Thanks to <span class="contact-name">Eric Rescorla</span> for his multiple suggestions, reviews, and edits
to the successive draft versions of this document.<a class="pilcrow" href="#section-appendix.a-2">¶</a></p>
<p id="section-appendix.a-3">Thanks to <span class="contact-name">Daniel Kahn Gillmor</span> for a pretty
      detailed review of the initial draft of this document. Thanks to
      <span class="contact-name">Bernard Aboba</span>, <span class="contact-name">Mike Bishop</span>,
      <span class="contact-name">Alissa Cooper</span>, <span class="contact-name">Roman       Danyliw</span>, <span class="contact-name">Stephen Farrell</span>, <span class="contact-name">Warren Kumari</span>, <span class="contact-name">Mirja Kuelewind</span>,
      <span class="contact-name">Barry Leiba</span>, <span class="contact-name">Martin Rex</span>,
      <span class="contact-name">Adam Roach</span>, <span class="contact-name">Meral       Shirazipour</span>, <span class="contact-name">Martin Thomson</span>, <span class="contact-name">Eric Vyncke</span>, and employees of the UK National Cyber
      Security Centre for their reviews. Thanks to <span class="contact-name">Chris       Wood</span>, <span class="contact-name">Ben Kaduk</span>, and <span class="contact-name">Sean       Turner</span> for helping move this document toward publication.<a class="pilcrow" href="#section-appendix.a-3">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="section-appendix.b">
      <h2 id="name-authors-address">
<a class="section-name selfRef" href="#name-authors-address">Author's Address</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Christian Huitema</span></div>
<div class="left" dir="auto"><span class="org">Private Octopus Inc.</span></div>
<div class="left" dir="auto">
<span class="locality">Friday Harbor</span>, <span class="region">WA</span> <span class="postal-code">98250</span>
</div>
<div class="left" dir="auto"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:huitema@huitema.net">huitema@huitema.net</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>