<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 9124: A Manifest Information Model for Firmware Updates in Internet of Things (IoT) Devices</title>
<meta content="Brendan Moran" name="author"/>
<meta content="Hannes Tschofenig" name="author"/>
<meta content="Henk Birkholz" name="author"/>
<meta content="
       Vulnerabilities with Internet of Things (IoT) devices have raised the need for a reliable and secure firmware update mechanism that is also suitable for constrained devices. Ensuring that devices function and remain secure over their service lifetime requires such an update mechanism to fix vulnerabilities, update configuration settings, and add new functionality. 
       One component of such a firmware update is a concise and machine-processable metadata document, or manifest, that describes the firmware image(s) and offers appropriate protection. This document describes the information that must be present in the manifest. 
    " name="description"/>
<meta content="xml2rfc 3.12.0" name="generator"/>
<meta content="computer security" name="keyword"/>
<meta content="smart objects" name="keyword"/>
<meta content="9124" name="rfc.number"/>
<!-- Generator version information:
  xml2rfc 3.12.0
    Python 3.6.15
    appdirs 1.4.4
    ConfigArgParse 1.4.1
    google-i18n-address 2.4.0
    html5lib 1.0.1
    intervaltree 3.0.2
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.4.2
    pycairo 1.15.1
    pycountry 19.8.18
    pyflakes 2.1.1
    PyYAML 5.4.1
    requests 2.24.0
    setuptools 40.5.0
    six 1.14.0
    WeasyPrint 52.5
-->
<link href="rfc9124.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://dx.doi.org/10.17487/rfc9124" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <link href="https://datatracker.ietf.org/doc/draft-ietf-suit-information-model-13" rel="prev"/>
  </head>
<body>
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9124</td>
<td class="center">A Firmware Manifest Information Model</td>
<td class="right">January 2022</td>
</tr></thead>
<tfoot><tr>
<td class="left">Moran, et al.</td>
<td class="center">Informational</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc9124">9124</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Informational</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2022-01">January 2022</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">B. Moran</div>
<div class="org">Arm Limited</div>
</div>
<div class="author">
      <div class="author-name">H. Tschofenig</div>
<div class="org">Arm Limited</div>
</div>
<div class="author">
      <div class="author-name">H. Birkholz</div>
<div class="org">Fraunhofer SIT</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9124</h1>
<h1 id="title">A Manifest Information Model for Firmware Updates in Internet of Things (IoT) Devices</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">Vulnerabilities with Internet of Things (IoT) devices have raised the need for a reliable and secure firmware update mechanism that is also suitable for constrained devices. Ensuring that devices function and remain secure over their service lifetime requires such an update mechanism to fix vulnerabilities, update configuration settings, and add new functionality.<a class="pilcrow" href="#section-abstract-1">¶</a></p>
<p id="section-abstract-2">One component of such a firmware update is a concise and machine-processable metadata document, or manifest, that describes the firmware image(s) and offers appropriate protection. This document describes the information that must be present in the manifest.<a class="pilcrow" href="#section-abstract-2">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This document is not an Internet Standards Track specification; it is
            published for informational purposes.<a class="pilcrow" href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by the
            Internet Engineering Steering Group (IESG).  Not all documents
            approved by the IESG are candidates for any level of Internet
            Standard; see Section 2 of RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9124">https://www.rfc-editor.org/info/rfc9124</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">▲</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p class="keepWithNext" id="section-toc.1-1.1.1"><a class="xref" href="#section-1">1</a>.  <a class="xref" href="#name-introduction">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a class="xref" href="#section-2">2</a>.  <a class="xref" href="#name-requirements-and-terminolog">Requirements and Terminology</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p class="keepWithNext" id="section-toc.1-1.2.2.1.1"><a class="xref" href="#section-2.1">2.1</a>.  <a class="xref" href="#name-requirements-notation">Requirements Notation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p class="keepWithNext" id="section-toc.1-1.2.2.2.1"><a class="xref" href="#section-2.2">2.2</a>.  <a class="xref" href="#name-terminology">Terminology</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a class="xref" href="#section-3">3</a>.  <a class="xref" href="#name-manifest-information-elemen">Manifest Information Elements</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a class="xref" href="#section-3.1">3.1</a>.  <a class="xref" href="#name-version-id-of-the-manifest-">Version ID of the Manifest Structure</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a class="xref" href="#section-3.2">3.2</a>.  <a class="xref" href="#name-monotonic-sequence-number">Monotonic Sequence Number</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a class="xref" href="#section-3.3">3.3</a>.  <a class="xref" href="#name-vendor-id">Vendor ID</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a class="xref" href="#section-3.4">3.4</a>.  <a class="xref" href="#name-class-id">Class ID</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.1">
                    <p id="section-toc.1-1.3.2.4.2.1.1"><a class="xref" href="#section-3.4.1">3.4.1</a>.  <a class="xref" href="#name-example-1-different-classes">Example 1: Different Classes</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.2">
                    <p id="section-toc.1-1.3.2.4.2.2.1"><a class="xref" href="#section-3.4.2">3.4.2</a>.  <a class="xref" href="#name-example-2-upgrading-class-i">Example 2: Upgrading Class ID</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.3">
                    <p id="section-toc.1-1.3.2.4.2.3.1"><a class="xref" href="#section-3.4.3">3.4.3</a>.  <a class="xref" href="#name-example-3-shared-functional">Example 3: Shared Functionality</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.4">
                    <p id="section-toc.1-1.3.2.4.2.4.1"><a class="xref" href="#section-3.4.4">3.4.4</a>.  <a class="xref" href="#name-example-4-rebranding">Example 4: Rebranding</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a class="xref" href="#section-3.5">3.5</a>.  <a class="xref" href="#name-precursor-image-digest-cond">Precursor Image Digest Condition</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6">
                <p id="section-toc.1-1.3.2.6.1"><a class="xref" href="#section-3.6">3.6</a>.  <a class="xref" href="#name-required-image-version-list">Required Image Version List</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7">
                <p id="section-toc.1-1.3.2.7.1"><a class="xref" href="#section-3.7">3.7</a>.  <a class="xref" href="#name-expiration-time">Expiration Time</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.8">
                <p id="section-toc.1-1.3.2.8.1"><a class="xref" href="#section-3.8">3.8</a>.  <a class="xref" href="#name-payload-format">Payload Format</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.9">
                <p id="section-toc.1-1.3.2.9.1"><a class="xref" href="#section-3.9">3.9</a>.  <a class="xref" href="#name-processing-steps">Processing Steps</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.10">
                <p id="section-toc.1-1.3.2.10.1"><a class="xref" href="#section-3.10">3.10</a>. <a class="xref" href="#name-storage-location">Storage Location</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.10.2.1">
                    <p id="section-toc.1-1.3.2.10.2.1.1"><a class="xref" href="#section-3.10.1">3.10.1</a>.  <a class="xref" href="#name-example-1-two-storage-locat">Example 1: Two Storage Locations</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.10.2.2">
                    <p id="section-toc.1-1.3.2.10.2.2.1"><a class="xref" href="#section-3.10.2">3.10.2</a>.  <a class="xref" href="#name-example-2-filesystem">Example 2: Filesystem</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.10.2.3">
                    <p id="section-toc.1-1.3.2.10.2.3.1"><a class="xref" href="#section-3.10.3">3.10.3</a>.  <a class="xref" href="#name-example-3-flash-memory">Example 3: Flash Memory</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.11">
                <p id="section-toc.1-1.3.2.11.1"><a class="xref" href="#section-3.11">3.11</a>. <a class="xref" href="#name-component-identifier">Component Identifier</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.12">
                <p id="section-toc.1-1.3.2.12.1"><a class="xref" href="#section-3.12">3.12</a>. <a class="xref" href="#name-payload-indicator">Payload Indicator</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.13">
                <p id="section-toc.1-1.3.2.13.1"><a class="xref" href="#section-3.13">3.13</a>. <a class="xref" href="#name-payload-digests">Payload Digests</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.14">
                <p id="section-toc.1-1.3.2.14.1"><a class="xref" href="#section-3.14">3.14</a>. <a class="xref" href="#name-size">Size</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.15">
                <p id="section-toc.1-1.3.2.15.1"><a class="xref" href="#section-3.15">3.15</a>. <a class="xref" href="#name-manifest-envelope-element-s">Manifest Envelope Element: Signature</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.16">
                <p id="section-toc.1-1.3.2.16.1"><a class="xref" href="#section-3.16">3.16</a>. <a class="xref" href="#name-additional-installation-ins">Additional Installation Instructions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.17">
                <p id="section-toc.1-1.3.2.17.1"><a class="xref" href="#section-3.17">3.17</a>. <a class="xref" href="#name-manifest-text-information">Manifest Text Information</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.18">
                <p id="section-toc.1-1.3.2.18.1"><a class="xref" href="#section-3.18">3.18</a>. <a class="xref" href="#name-aliases">Aliases</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.19">
                <p id="section-toc.1-1.3.2.19.1"><a class="xref" href="#section-3.19">3.19</a>. <a class="xref" href="#name-dependencies">Dependencies</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.20">
                <p id="section-toc.1-1.3.2.20.1"><a class="xref" href="#section-3.20">3.20</a>. <a class="xref" href="#name-encryption-wrapper">Encryption Wrapper</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.21">
                <p id="section-toc.1-1.3.2.21.1"><a class="xref" href="#section-3.21">3.21</a>. <a class="xref" href="#name-xip-address">XIP Address</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.22">
                <p id="section-toc.1-1.3.2.22.1"><a class="xref" href="#section-3.22">3.22</a>. <a class="xref" href="#name-load-time-metadata">Load-Time Metadata</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.23">
                <p id="section-toc.1-1.3.2.23.1"><a class="xref" href="#section-3.23">3.23</a>. <a class="xref" href="#name-runtime-metadata">Runtime Metadata</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.24">
                <p id="section-toc.1-1.3.2.24.1"><a class="xref" href="#section-3.24">3.24</a>. <a class="xref" href="#name-payload">Payload</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.25">
                <p id="section-toc.1-1.3.2.25.1"><a class="xref" href="#section-3.25">3.25</a>. <a class="xref" href="#name-manifest-envelope-element-d">Manifest Envelope Element: Delegation Chain</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="xref" href="#section-4">4</a>.  <a class="xref" href="#name-security-considerations">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a class="xref" href="#section-4.1">4.1</a>.  <a class="xref" href="#name-threat-model">Threat Model</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a class="xref" href="#section-4.2">4.2</a>.  <a class="xref" href="#name-threat-descriptions">Threat Descriptions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a class="xref" href="#section-4.2.1">4.2.1</a>.  <a class="xref" href="#name-threatimgexpired-old-firmwa">THREAT.IMG.EXPIRED: Old Firmware</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.2">
                    <p id="section-toc.1-1.4.2.2.2.2.1"><a class="xref" href="#section-4.2.2">4.2.2</a>.  <a class="xref" href="#name-threatimgexpiredoffline-off">THREAT.IMG.EXPIRED.OFFLINE: Offline Device + Old Firmware</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.3">
                    <p id="section-toc.1-1.4.2.2.2.3.1"><a class="xref" href="#section-4.2.3">4.2.3</a>.  <a class="xref" href="#name-threatimgincompatible-misma">THREAT.IMG.INCOMPATIBLE: Mismatched Firmware</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.4">
                    <p id="section-toc.1-1.4.2.2.2.4.1"><a class="xref" href="#section-4.2.4">4.2.4</a>.  <a class="xref" href="#name-threatimgformat-the-target-">THREAT.IMG.FORMAT: The Target Device Misinterprets the Type of Payload</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.5">
                    <p id="section-toc.1-1.4.2.2.2.5.1"><a class="xref" href="#section-4.2.5">4.2.5</a>.  <a class="xref" href="#name-threatimglocation-the-targe">THREAT.IMG.LOCATION: The Target Device Installs the Payload to the Wrong Location</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.6">
                    <p id="section-toc.1-1.4.2.2.2.6.1"><a class="xref" href="#section-4.2.6">4.2.6</a>.  <a class="xref" href="#name-threatnetredirect-redirecti">THREAT.NET.REDIRECT: Redirection to Inauthentic Payload Hosting</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.7">
                    <p id="section-toc.1-1.4.2.2.2.7.1"><a class="xref" href="#section-4.2.7">4.2.7</a>.  <a class="xref" href="#name-threatnetonpath-traffic-int">THREAT.NET.ONPATH: Traffic Interception</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.8">
                    <p id="section-toc.1-1.4.2.2.2.8.1"><a class="xref" href="#section-4.2.8">4.2.8</a>.  <a class="xref" href="#name-threatimgreplace-payload-re">THREAT.IMG.REPLACE: Payload Replacement</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.9">
                    <p id="section-toc.1-1.4.2.2.2.9.1"><a class="xref" href="#section-4.2.9">4.2.9</a>.  <a class="xref" href="#name-threatimgnon_auth-unauthent">THREAT.IMG.NON_AUTH: Unauthenticated Images</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.10">
                    <p id="section-toc.1-1.4.2.2.2.10.1"><a class="xref" href="#section-4.2.10">4.2.10</a>. <a class="xref" href="#name-threatupdwrong_precursor-un">THREAT.UPD.WRONG_PRECURSOR: Unexpected Precursor Images</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.11">
                    <p id="section-toc.1-1.4.2.2.2.11.1"><a class="xref" href="#section-4.2.11">4.2.11</a>. <a class="xref" href="#name-threatupdunapproved-unappro">THREAT.UPD.UNAPPROVED: Unapproved Firmware</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.12">
                    <p id="section-toc.1-1.4.2.2.2.12.1"><a class="xref" href="#section-4.2.12">4.2.12</a>. <a class="xref" href="#name-threatimgdisclosure-reverse">THREAT.IMG.DISCLOSURE: Reverse Engineering of Firmware Image for Vulnerability Analysis</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.13">
                    <p id="section-toc.1-1.4.2.2.2.13.1"><a class="xref" href="#section-4.2.13">4.2.13</a>. <a class="xref" href="#name-threatmfstoverride-overridi">THREAT.MFST.OVERRIDE: Overriding Critical Manifest Elements</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.14">
                    <p id="section-toc.1-1.4.2.2.2.14.1"><a class="xref" href="#section-4.2.14">4.2.14</a>. <a class="xref" href="#name-threatmfstexposure-confiden">THREAT.MFST.EXPOSURE: Confidential Manifest Element Exposure</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.15">
                    <p id="section-toc.1-1.4.2.2.2.15.1"><a class="xref" href="#section-4.2.15">4.2.15</a>. <a class="xref" href="#name-threatimgextra-extra-data-a">THREAT.IMG.EXTRA: Extra Data after Image</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.16">
                    <p id="section-toc.1-1.4.2.2.2.16.1"><a class="xref" href="#section-4.2.16">4.2.16</a>. <a class="xref" href="#name-threatkeyexposure-exposure-">THREAT.KEY.EXPOSURE: Exposure of Signing Keys</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.17">
                    <p id="section-toc.1-1.4.2.2.2.17.1"><a class="xref" href="#section-4.2.17">4.2.17</a>. <a class="xref" href="#name-threatmfstmodification-modi">THREAT.MFST.MODIFICATION: Modification of Manifest or Payload prior to Signing</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.18">
                    <p id="section-toc.1-1.4.2.2.2.18.1"><a class="xref" href="#section-4.2.18">4.2.18</a>. <a class="xref" href="#name-threatmfsttoctou-modificati">THREAT.MFST.TOCTOU: Modification of Manifest between Authentication and Use</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a class="xref" href="#section-4.3">4.3</a>.  <a class="xref" href="#name-security-requirements">Security Requirements</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.1">
                    <p id="section-toc.1-1.4.2.3.2.1.1"><a class="xref" href="#section-4.3.1">4.3.1</a>.  <a class="xref" href="#name-reqsecsequence-monotonic-se">REQ.SEC.SEQUENCE: Monotonic Sequence Numbers</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.2">
                    <p id="section-toc.1-1.4.2.3.2.2.1"><a class="xref" href="#section-4.3.2">4.3.2</a>.  <a class="xref" href="#name-reqseccompatible-vendor-dev">REQ.SEC.COMPATIBLE: Vendor, Device-Type Identifiers</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.3">
                    <p id="section-toc.1-1.4.2.3.2.3.1"><a class="xref" href="#section-4.3.3">4.3.3</a>.  <a class="xref" href="#name-reqsecexp-expiration-time">REQ.SEC.EXP: Expiration Time</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.4">
                    <p id="section-toc.1-1.4.2.3.2.4.1"><a class="xref" href="#section-4.3.4">4.3.4</a>.  <a class="xref" href="#name-reqsecauthentic-cryptograph">REQ.SEC.AUTHENTIC: Cryptographic Authenticity</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.5">
                    <p id="section-toc.1-1.4.2.3.2.5.1"><a class="xref" href="#section-4.3.5">4.3.5</a>.  <a class="xref" href="#name-reqsecauthimg_type-authenti">REQ.SEC.AUTH.IMG_TYPE: Authenticated Payload Type</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.6">
                    <p id="section-toc.1-1.4.2.3.2.6.1"><a class="xref" href="#section-4.3.6">4.3.6</a>.  <a class="xref" href="#name-reqsecauthimg_loc-authentic">REQ.SEC.AUTH.IMG_LOC: Authenticated Storage Location</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.7">
                    <p id="section-toc.1-1.4.2.3.2.7.1"><a class="xref" href="#section-4.3.7">4.3.7</a>.  <a class="xref" href="#name-reqsecauthremote_loc-authen">REQ.SEC.AUTH.REMOTE_LOC: Authenticated Remote Payload</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.8">
                    <p id="section-toc.1-1.4.2.3.2.8.1"><a class="xref" href="#section-4.3.8">4.3.8</a>.  <a class="xref" href="#name-reqsecauthexec-secure-execu">REQ.SEC.AUTH.EXEC: Secure Execution</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.9">
                    <p id="section-toc.1-1.4.2.3.2.9.1"><a class="xref" href="#section-4.3.9">4.3.9</a>.  <a class="xref" href="#name-reqsecauthprecursor-authent">REQ.SEC.AUTH.PRECURSOR: Authenticated Precursor Images</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.10">
                    <p id="section-toc.1-1.4.2.3.2.10.1"><a class="xref" href="#section-4.3.10">4.3.10</a>. <a class="xref" href="#name-reqsecauthcompatibility-aut">REQ.SEC.AUTH.COMPATIBILITY: Authenticated Vendor and Class IDs</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.11">
                    <p id="section-toc.1-1.4.2.3.2.11.1"><a class="xref" href="#section-4.3.11">4.3.11</a>. <a class="xref" href="#name-reqsecrights-rights-require">REQ.SEC.RIGHTS: Rights Require Authenticity</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.12">
                    <p id="section-toc.1-1.4.2.3.2.12.1"><a class="xref" href="#section-4.3.12">4.3.12</a>. <a class="xref" href="#name-reqsecimgconfidentiality-pa">REQ.SEC.IMG.CONFIDENTIALITY: Payload Encryption</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.13">
                    <p id="section-toc.1-1.4.2.3.2.13.1"><a class="xref" href="#section-4.3.13">4.3.13</a>. <a class="xref" href="#name-reqsecaccess_control-access">REQ.SEC.ACCESS_CONTROL: Access Control</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.14">
                    <p id="section-toc.1-1.4.2.3.2.14.1"><a class="xref" href="#section-4.3.14">4.3.14</a>. <a class="xref" href="#name-reqsecmfstconfidentiality-e">REQ.SEC.MFST.CONFIDENTIALITY: Encrypted Manifests</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.15">
                    <p id="section-toc.1-1.4.2.3.2.15.1"><a class="xref" href="#section-4.3.15">4.3.15</a>. <a class="xref" href="#name-reqsecimgcomplete_digest-wh">REQ.SEC.IMG.COMPLETE_DIGEST: Whole Image Digest</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.16">
                    <p id="section-toc.1-1.4.2.3.2.16.1"><a class="xref" href="#section-4.3.16">4.3.16</a>. <a class="xref" href="#name-reqsecreporting-secure-repo">REQ.SEC.REPORTING: Secure Reporting</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.17">
                    <p id="section-toc.1-1.4.2.3.2.17.1"><a class="xref" href="#section-4.3.17">4.3.17</a>. <a class="xref" href="#name-reqseckeyprotection-protect">REQ.SEC.KEY.PROTECTION: Protected Storage of Signing Keys</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.18">
                    <p id="section-toc.1-1.4.2.3.2.18.1"><a class="xref" href="#section-4.3.18">4.3.18</a>. <a class="xref" href="#name-reqseckeyrotation-protected">REQ.SEC.KEY.ROTATION: Protected Storage of Signing Keys</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.19">
                    <p id="section-toc.1-1.4.2.3.2.19.1"><a class="xref" href="#section-4.3.19">4.3.19</a>. <a class="xref" href="#name-reqsecmfstcheck-validate-ma">REQ.SEC.MFST.CHECK: Validate Manifests prior to Deployment</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.20">
                    <p id="section-toc.1-1.4.2.3.2.20.1"><a class="xref" href="#section-4.3.20">4.3.20</a>. <a class="xref" href="#name-reqsecmfsttrusted-construct">REQ.SEC.MFST.TRUSTED: Construct Manifests in a Trusted Environment</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.21">
                    <p id="section-toc.1-1.4.2.3.2.21.1"><a class="xref" href="#section-4.3.21">4.3.21</a>. <a class="xref" href="#name-reqsecmfstconst-manifest-ke">REQ.SEC.MFST.CONST: Manifest Kept Immutable between Check and Use</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a class="xref" href="#section-4.4">4.4</a>.  <a class="xref" href="#name-user-stories">User Stories</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.1">
                    <p id="section-toc.1-1.4.2.4.2.1.1"><a class="xref" href="#section-4.4.1">4.4.1</a>.  <a class="xref" href="#name-user_storyinstallinstructio">USER_STORY.INSTALL.INSTRUCTIONS: Installation Instructions</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.2">
                    <p id="section-toc.1-1.4.2.4.2.2.1"><a class="xref" href="#section-4.4.2">4.4.2</a>.  <a class="xref" href="#name-user_storymfstfail_early-fa">USER_STORY.MFST.FAIL_EARLY: Fail Early</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.3">
                    <p id="section-toc.1-1.4.2.4.2.3.1"><a class="xref" href="#section-4.4.3">4.4.3</a>.  <a class="xref" href="#name-user_storyoverride-override">USER_STORY.OVERRIDE: Override Non-critical Manifest Elements</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.4">
                    <p id="section-toc.1-1.4.2.4.2.4.1"><a class="xref" href="#section-4.4.4">4.4.4</a>.  <a class="xref" href="#name-user_storycomponent-compone">USER_STORY.COMPONENT: Component Update</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.5">
                    <p id="section-toc.1-1.4.2.4.2.5.1"><a class="xref" href="#section-4.4.5">4.4.5</a>.  <a class="xref" href="#name-user_storymulti_auth-multip">USER_STORY.MULTI_AUTH: Multiple Authorizations</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.6">
                    <p id="section-toc.1-1.4.2.4.2.6.1"><a class="xref" href="#section-4.4.6">4.4.6</a>.  <a class="xref" href="#name-user_storyimgformat-multipl">USER_STORY.IMG.FORMAT: Multiple Payload Formats</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.7">
                    <p id="section-toc.1-1.4.2.4.2.7.1"><a class="xref" href="#section-4.4.7">4.4.7</a>.  <a class="xref" href="#name-user_storyimgconfidentialit">USER_STORY.IMG.CONFIDENTIALITY: Prevent Confidential Information Disclosures</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.8">
                    <p id="section-toc.1-1.4.2.4.2.8.1"><a class="xref" href="#section-4.4.8">4.4.8</a>.  <a class="xref" href="#name-user_storyimgunknown_format">USER_STORY.IMG.UNKNOWN_FORMAT: Prevent Devices from Unpacking Unknown Formats</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.9">
                    <p id="section-toc.1-1.4.2.4.2.9.1"><a class="xref" href="#section-4.4.9">4.4.9</a>.  <a class="xref" href="#name-user_storyimgcurrent_versio">USER_STORY.IMG.CURRENT_VERSION: Specify Version Numbers of Target Firmware</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.10">
                    <p id="section-toc.1-1.4.2.4.2.10.1"><a class="xref" href="#section-4.4.10">4.4.10</a>. <a class="xref" href="#name-user_storyimgselect-enable-">USER_STORY.IMG.SELECT: Enable Devices to Choose between Images</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.11">
                    <p id="section-toc.1-1.4.2.4.2.11.1"><a class="xref" href="#section-4.4.11">4.4.11</a>. <a class="xref" href="#name-user_storyexecmfst-secure-e">USER_STORY.EXEC.MFST: Secure Execution Using Manifests</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.12">
                    <p id="section-toc.1-1.4.2.4.2.12.1"><a class="xref" href="#section-4.4.12">4.4.12</a>. <a class="xref" href="#name-user_storyexecdecompress-de">USER_STORY.EXEC.DECOMPRESS: Decompress on Load</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.13">
                    <p id="section-toc.1-1.4.2.4.2.13.1"><a class="xref" href="#section-4.4.13">4.4.13</a>. <a class="xref" href="#name-user_storymfstimg-payload-i">USER_STORY.MFST.IMG: Payload in Manifest</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.14">
                    <p id="section-toc.1-1.4.2.4.2.14.1"><a class="xref" href="#section-4.4.14">4.4.14</a>. <a class="xref" href="#name-user_storymfstparse-simple-">USER_STORY.MFST.PARSE: Simple Parsing</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.15">
                    <p id="section-toc.1-1.4.2.4.2.15.1"><a class="xref" href="#section-4.4.15">4.4.15</a>. <a class="xref" href="#name-user_storymfstdelegation-de">USER_STORY.MFST.DELEGATION: Delegated Authority in Manifest</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.16">
                    <p id="section-toc.1-1.4.2.4.2.16.1"><a class="xref" href="#section-4.4.16">4.4.16</a>. <a class="xref" href="#name-user_storymfstpre_check-upd">USER_STORY.MFST.PRE_CHECK: Update Evaluation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.17">
                    <p id="section-toc.1-1.4.2.4.2.17.1"><a class="xref" href="#section-4.4.17">4.4.17</a>. <a class="xref" href="#name-user_storymfstadministratio">USER_STORY.MFST.ADMINISTRATION: Administration of Manifests</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a class="xref" href="#section-4.5">4.5</a>.  <a class="xref" href="#name-usability-requirements">Usability Requirements</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5.2.1">
                    <p id="section-toc.1-1.4.2.5.2.1.1"><a class="xref" href="#section-4.5.1">4.5.1</a>.  <a class="xref" href="#name-requsemfstpre_check-pre-ins">REQ.USE.MFST.PRE_CHECK: Pre-installation Checks</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5.2.2">
                    <p id="section-toc.1-1.4.2.5.2.2.1"><a class="xref" href="#section-4.5.2">4.5.2</a>.  <a class="xref" href="#name-requsemfsttext-descriptive-">REQ.USE.MFST.TEXT: Descriptive Manifest Information</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5.2.3">
                    <p id="section-toc.1-1.4.2.5.2.3.1"><a class="xref" href="#section-4.5.3">4.5.3</a>.  <a class="xref" href="#name-requsemfstoverride_remote-o">REQ.USE.MFST.OVERRIDE_REMOTE: Override Remote Resource Location</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5.2.4">
                    <p id="section-toc.1-1.4.2.5.2.4.1"><a class="xref" href="#section-4.5.4">4.5.4</a>.  <a class="xref" href="#name-requsemfstcomponent-compone">REQ.USE.MFST.COMPONENT: Component Updates</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5.2.5">
                    <p id="section-toc.1-1.4.2.5.2.5.1"><a class="xref" href="#section-4.5.5">4.5.5</a>.  <a class="xref" href="#name-requsemfstmulti_auth-multip">REQ.USE.MFST.MULTI_AUTH: Multiple Authentications</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5.2.6">
                    <p id="section-toc.1-1.4.2.5.2.6.1"><a class="xref" href="#section-4.5.6">4.5.6</a>.  <a class="xref" href="#name-requseimgformat-format-usab">REQ.USE.IMG.FORMAT: Format Usability</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5.2.7">
                    <p id="section-toc.1-1.4.2.5.2.7.1"><a class="xref" href="#section-4.5.7">4.5.7</a>.  <a class="xref" href="#name-requseimgnested-nested-form">REQ.USE.IMG.NESTED: Nested Formats</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5.2.8">
                    <p id="section-toc.1-1.4.2.5.2.8.1"><a class="xref" href="#section-4.5.8">4.5.8</a>.  <a class="xref" href="#name-requseimgversions-target-ve">REQ.USE.IMG.VERSIONS: Target Version Matching</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5.2.9">
                    <p id="section-toc.1-1.4.2.5.2.9.1"><a class="xref" href="#section-4.5.9">4.5.9</a>.  <a class="xref" href="#name-requseimgselect-select-imag">REQ.USE.IMG.SELECT: Select Image by Destination</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5.2.10">
                    <p id="section-toc.1-1.4.2.5.2.10.1"><a class="xref" href="#section-4.5.10">4.5.10</a>. <a class="xref" href="#name-requseexec-executable-manif">REQ.USE.EXEC: Executable Manifest</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5.2.11">
                    <p id="section-toc.1-1.4.2.5.2.11.1"><a class="xref" href="#section-4.5.11">4.5.11</a>. <a class="xref" href="#name-requseload-load-time-inform">REQ.USE.LOAD: Load-Time Information</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5.2.12">
                    <p id="section-toc.1-1.4.2.5.2.12.1"><a class="xref" href="#section-4.5.12">4.5.12</a>. <a class="xref" href="#name-requsepayload-payload-in-ma">REQ.USE.PAYLOAD: Payload in Manifest Envelope</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5.2.13">
                    <p id="section-toc.1-1.4.2.5.2.13.1"><a class="xref" href="#section-4.5.13">4.5.13</a>. <a class="xref" href="#name-requseparse-simple-parsing">REQ.USE.PARSE: Simple Parsing</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5.2.14">
                    <p id="section-toc.1-1.4.2.5.2.14.1"><a class="xref" href="#section-4.5.14">4.5.14</a>. <a class="xref" href="#name-requsedelegation-delegation">REQ.USE.DELEGATION: Delegation of Authority in Manifest</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="xref" href="#section-5">5</a>.  <a class="xref" href="#name-iana-considerations">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="xref" href="#section-6">6</a>.  <a class="xref" href="#name-references">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a class="xref" href="#section-6.1">6.1</a>.  <a class="xref" href="#name-normative-references">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a class="xref" href="#section-6.2">6.2</a>.  <a class="xref" href="#name-informative-references">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="xref" href="#appendix-A"></a><a class="xref" href="#name-acknowledgements">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="xref" href="#appendix-B"></a><a class="xref" href="#name-authors-addresses">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">Vulnerabilities with Internet of Things (IoT) devices have raised the need for a reliable and secure firmware update mechanism that is also suitable for constrained devices. Ensuring that devices function and remain secure over their service lifetime requires such an update mechanism to fix vulnerabilities, update configuration settings, and add new functionality.<a class="pilcrow" href="#section-1-1">¶</a></p>
<p id="section-1-2">One component of such a firmware update is a concise and machine-processable metadata document, or manifest, that describes the firmware image(s) and offers appropriate protection. This document describes the information that must be present in the manifest.<a class="pilcrow" href="#section-1-2">¶</a></p>
<p id="section-1-3">This document describes all the information elements required in a manifest to secure firmware updates of IoT devices. Each information element is motivated by user stories and threats it aims to mitigate. These threats and user stories are not intended to be an exhaustive list of the threats against IoT devices and possible user stories that describe how to conduct a firmware update. Instead, they are intended to describe the threats against firmware updates in isolation and provide sufficient motivation to specify the information elements that cover a wide range of user stories.<a class="pilcrow" href="#section-1-3">¶</a></p>
<p id="section-1-4">To distinguish information elements from their encoding and serialization over the wire, this document presents an information model. RFC 3444 <span>[<a class="xref" href="#RFC3444">RFC3444</a>]</span> describes the differences between information models and data models.<a class="pilcrow" href="#section-1-4">¶</a></p>
<p id="section-1-5">Because this document covers a wide range of user stories and a wide range of threats, not all information elements apply to all scenarios. As a result, various information elements are optional to implement and optional to use, depending on which threats exist in a particular domain of application and which user stories are important for deployments.<a class="pilcrow" href="#section-1-5">¶</a></p>
</section>
</div>
<div id="requirements-and-terminology">
<section id="section-2">
      <h2 id="name-requirements-and-terminolog">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-requirements-and-terminolog">Requirements and Terminology</a>
      </h2>
<div id="requirements-notation">
<section id="section-2.1">
        <h3 id="name-requirements-notation">
<a class="section-number selfRef" href="#section-2.1">2.1. </a><a class="section-name selfRef" href="#name-requirements-notation">Requirements Notation</a>
        </h3>
<p id="section-2.1-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>",
        "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>",
        "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>",
        "<span class="bcp14">SHOULD NOT</span>",
        "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
        "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document
        are to be interpreted as described in BCP 14
        <span>[<a class="xref" href="#RFC2119">RFC2119</a>]</span> <span>[<a class="xref" href="#RFC8174">RFC8174</a>]</span> when, and only
        when, they appear in all capitals, as shown here.<a class="pilcrow" href="#section-2.1-1">¶</a></p>
<p id="section-2.1-2">Unless otherwise stated, these words apply to the design of the manifest format, not its implementation or application. Hence, whenever an information element is declared as "<span class="bcp14">REQUIRED</span>", this implies that the manifest format document has to include support for it.<a class="pilcrow" href="#section-2.1-2">¶</a></p>
</section>
</div>
<div id="terminology">
<section id="section-2.2">
        <h3 id="name-terminology">
<a class="section-number selfRef" href="#section-2.2">2.2. </a><a class="section-name selfRef" href="#name-terminology">Terminology</a>
        </h3>
<p id="section-2.2-1">This document uses terms defined in <span>[<a class="xref" href="#RFC9019">RFC9019</a>]</span>.
The term "Operator" refers to either a device operator or a network operator.<a class="pilcrow" href="#section-2.2-1">¶</a></p>
<p id="section-2.2-2">"Secure time" and "secure clock" refer to a set of requirements on time sources. For local time sources, this primarily means that the clock must be monotonically increasing, including across power cycles, firmware updates, etc. For remote time sources, the provided time must be both authenticated and guaranteed to be correct to within some predetermined bounds, whenever the time source is accessible.<a class="pilcrow" href="#section-2.2-2">¶</a></p>
<p id="section-2.2-3">The term "Envelope" (or "Manifest Envelope") is used to describe an encoding that allows the bundling of a manifest with related information elements that are not directly contained within the manifest.<a class="pilcrow" href="#section-2.2-3">¶</a></p>
<p id="section-2.2-4">The term "payload" is used to describe the data that is delivered to a device during an update. This is distinct from a "firmware image", as described in <span>[<a class="xref" href="#RFC9019">RFC9019</a>]</span>, because the payload is often in an intermediate state, such as being encrypted, compressed, and/or encoded as a differential update. The payload, taken in isolation, is often not the final firmware image.<a class="pilcrow" href="#section-2.2-4">¶</a></p>
</section>
</div>
</section>
</div>
<div id="manifest-information-elements">
<section id="section-3">
      <h2 id="name-manifest-information-elemen">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-manifest-information-elemen">Manifest Information Elements</a>
      </h2>
<p id="section-3-1">Each manifest information element is anchored in a security requirement or a usability requirement. The manifest elements are described below, justified by their requirements.<a class="pilcrow" href="#section-3-1">¶</a></p>
<div id="element-version-id">
<section id="section-3.1">
        <h3 id="name-version-id-of-the-manifest-">
<a class="section-number selfRef" href="#section-3.1">3.1. </a><a class="section-name selfRef" href="#name-version-id-of-the-manifest-">Version ID of the Manifest Structure</a>
        </h3>
<p id="section-3.1-1">This is an identifier that describes which iteration of the manifest format is contained in the structure. This allows devices to identify the version of the manifest data model that is in use.<a class="pilcrow" href="#section-3.1-1">¶</a></p>
<p id="section-3.1-2">This element is <span class="bcp14">REQUIRED</span>.<a class="pilcrow" href="#section-3.1-2">¶</a></p>
</section>
</div>
<div id="element-sequence-number">
<section id="section-3.2">
        <h3 id="name-monotonic-sequence-number">
<a class="section-number selfRef" href="#section-3.2">3.2. </a><a class="section-name selfRef" href="#name-monotonic-sequence-number">Monotonic Sequence Number</a>
        </h3>
<p id="section-3.2-1">This element provides a monotonically increasing (unsigned) sequence number to prevent malicious actors from reverting a firmware update against the policies of the relevant authority. This number must not wrap around.<a class="pilcrow" href="#section-3.2-1">¶</a></p>
<p id="section-3.2-2">For convenience, the monotonic sequence number may be a UTC timestamp. This allows global synchronization of sequence numbers without any additional management.<a class="pilcrow" href="#section-3.2-2">¶</a></p>
<p id="section-3.2-3">This element is <span class="bcp14">REQUIRED</span>.<a class="pilcrow" href="#section-3.2-3">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.2-4">
          <dt id="section-3.2-4.1">Implements:</dt>
          <dd id="section-3.2-4.2" style="margin-left: 1.5em">
            <span><a class="xref" href="#req-sec-sequence">REQ.SEC.SEQUENCE</a> (<a class="xref" href="#req-sec-sequence">Section 4.3.1</a>)</span><a class="pilcrow" href="#section-3.2-4.2">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="element-vendor-id">
<section id="section-3.3">
        <h3 id="name-vendor-id">
<a class="section-number selfRef" href="#section-3.3">3.3. </a><a class="section-name selfRef" href="#name-vendor-id">Vendor ID</a>
        </h3>
<p id="section-3.3-1">The Vendor ID element helps to distinguish between identically named products from different vendors. The Vendor ID is not intended to be a human-readable element. It is intended for binary match/mismatch comparison only.<a class="pilcrow" href="#section-3.3-1">¶</a></p>
<p id="section-3.3-2">Recommended practice is to use version 5 Universally Unique Identifiers (UUIDs) <span>[<a class="xref" href="#RFC4122">RFC4122</a>]</span> with the vendor's domain name and the DNS name space ID. Other options include type 1 and type 4 UUIDs.<a class="pilcrow" href="#section-3.3-2">¶</a></p>
<p id="section-3.3-3">Fixed-size binary identifiers are preferred because they are simple to match, unambiguous in length, explicitly non-parsable, and require no issuing authority. Guaranteed unique integers are preferred because they are small and simple to match; however, they may not be fixed length, and they may require an issuing authority to ensure uniqueness. Free-form text is avoided because it is variable length, prone to error, and often requires parsing outside the scope of the manifest serialization.<a class="pilcrow" href="#section-3.3-3">¶</a></p>
<p id="section-3.3-4">If human-readable content is required, it <span class="bcp14">SHOULD</span> be contained in a separate manifest information element: <span><a class="xref" href="#manifest-element-text">Manifest Text Information</a> (<a class="xref" href="#manifest-element-text">Section 3.17</a>)</span>.<a class="pilcrow" href="#section-3.3-4">¶</a></p>
<p id="section-3.3-5">This element is <span class="bcp14">RECOMMENDED</span>.<a class="pilcrow" href="#section-3.3-5">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.3-6">
          <dt id="section-3.3-6.1">Implements:</dt>
          <dd id="section-3.3-6.2" style="margin-left: 1.5em">
            <span><a class="xref" href="#req-sec-compatible">REQ.SEC.COMPATIBLE</a> (<a class="xref" href="#req-sec-compatible">Section 4.3.2</a>)</span>, <span><a class="xref" href="#req-sec-authentic-compatibility">REQ.SEC.AUTH.COMPATIBILITY</a> (<a class="xref" href="#req-sec-authentic-compatibility">Section 4.3.10</a>)</span><a class="pilcrow" href="#section-3.3-6.2">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-3.3-7">Here is an example for a domain-name-based UUID. Vendor A creates a UUID based on a domain name it controls, such as vendorId = UUID5(DNS, "vendor-a.example").<a class="pilcrow" href="#section-3.3-7">¶</a></p>
<p id="section-3.3-8">Because the DNS infrastructure prevents multiple registrations of the same domain name, this UUID is (with very high probability) guaranteed to be unique. Because the domain name is known, this UUID is reproducible. Type 1 and type 4 UUIDs produce similar guarantees of uniqueness, but not reproducibility.<a class="pilcrow" href="#section-3.3-8">¶</a></p>
<p id="section-3.3-9">This approach creates a contention when a vendor changes its name or relinquishes control of a domain name. In this scenario, it is possible that another vendor would start using that same domain name. However, this UUID is not proof of identity; a device's trust in a vendor must be anchored in a cryptographic key, not a UUID.<a class="pilcrow" href="#section-3.3-9">¶</a></p>
</section>
</div>
<div id="element-class-id">
<section id="section-3.4">
        <h3 id="name-class-id">
<a class="section-number selfRef" href="#section-3.4">3.4. </a><a class="section-name selfRef" href="#name-class-id">Class ID</a>
        </h3>
<p id="section-3.4-1">A device "Class" is a set of different device types that can accept the same firmware update without modification. It thereby allows devices to determine the applicability of the firmware in an unambiguous way. Class IDs must be unique within the scope of a Vendor ID. This is to prevent similarly or identically named devices from colliding in their customer's infrastructure.<a class="pilcrow" href="#section-3.4-1">¶</a></p>
<p id="section-3.4-2">Recommended practice is to use version 5 UUIDs <span>[<a class="xref" href="#RFC4122">RFC4122</a>]</span> with as much information as necessary to define firmware compatibility. Possible information used to derive the Class ID UUID includes:<a class="pilcrow" href="#section-3.4-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4-3.1">Model name or number<a class="pilcrow" href="#section-3.4-3.1">¶</a>
</li>
          <li class="normal" id="section-3.4-3.2">Hardware revision<a class="pilcrow" href="#section-3.4-3.2">¶</a>
</li>
          <li class="normal" id="section-3.4-3.3">Runtime library version<a class="pilcrow" href="#section-3.4-3.3">¶</a>
</li>
          <li class="normal" id="section-3.4-3.4">Bootloader version<a class="pilcrow" href="#section-3.4-3.4">¶</a>
</li>
          <li class="normal" id="section-3.4-3.5">ROM revision<a class="pilcrow" href="#section-3.4-3.5">¶</a>
</li>
          <li class="normal" id="section-3.4-3.6">Silicon batch number<a class="pilcrow" href="#section-3.4-3.6">¶</a>
</li>
        </ul>
<p id="section-3.4-4">The Class ID UUID should use the Vendor ID as the name space identifier. Classes may be more fine-grained than is required to identify firmware compatibility. Classes must not be less granular than is required to identify firmware compatibility. Devices may have multiple Class IDs.<a class="pilcrow" href="#section-3.4-4">¶</a></p>
<p id="section-3.4-5">The Class ID is not intended to be a human-readable element. It is intended for binary match/mismatch comparison only. A manifest serialization <span class="bcp14">SHOULD NOT</span> permit free-form text content to be used for the Class ID. A fixed-size binary identifier <span class="bcp14">SHOULD</span> be used.<a class="pilcrow" href="#section-3.4-5">¶</a></p>
<p id="section-3.4-6">Some organizations desire to keep the same product naming across multiple, incompatible hardware revisions for ease of user experience. If this naming is propagated into the firmware, then matching a specific hardware version becomes a challenge. An opaque, non-readable binary identifier has no naming implications and so is more likely to be usable for distinguishing among incompatible device groupings, regardless of naming.<a class="pilcrow" href="#section-3.4-6">¶</a></p>
<p id="section-3.4-7">Fixed-size binary identifiers are preferred because they are simple to match, unambiguous in length, opaque and free from naming implications, and explicitly non-parsable. Free-form text is avoided because it is variable length, prone to error, often requires parsing outside the scope of the manifest serialization, and may be homogenized across incompatible device groupings.<a class="pilcrow" href="#section-3.4-7">¶</a></p>
<p id="section-3.4-8">If the Class ID is not implemented, then each logical device class must use a unique trust anchor for authorization.<a class="pilcrow" href="#section-3.4-8">¶</a></p>
<p id="section-3.4-9">This element is <span class="bcp14">RECOMMENDED</span>.<a class="pilcrow" href="#section-3.4-9">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.4-10">
          <dt id="section-3.4-10.1">Implements:</dt>
          <dd id="section-3.4-10.2" style="margin-left: 1.5em">
            <span><a class="xref" href="#req-sec-compatible">REQ.SEC.COMPATIBLE</a> (<a class="xref" href="#req-sec-compatible">Section 4.3.2</a>)</span>, <span><a class="xref" href="#req-sec-authentic-compatibility">REQ.SEC.AUTH.COMPATIBILITY</a> (<a class="xref" href="#req-sec-authentic-compatibility">Section 4.3.10</a>)</span><a class="pilcrow" href="#section-3.4-10.2">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<div id="example-1-different-classes">
<section id="section-3.4.1">
          <h4 id="name-example-1-different-classes">
<a class="section-number selfRef" href="#section-3.4.1">3.4.1. </a><a class="section-name selfRef" href="#name-example-1-different-classes">Example 1: Different Classes</a>
          </h4>
<p id="section-3.4.1-1">Vendor A creates Product Z and Product Y. The firmware images of Products Z and Y are not interchangeable. Vendor A creates UUIDs as follows:<a class="pilcrow" href="#section-3.4.1-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4.1-2.1">vendorId = UUID5(DNS, "vendor-a.example")<a class="pilcrow" href="#section-3.4.1-2.1">¶</a>
</li>
            <li class="normal" id="section-3.4.1-2.2">ZclassId = UUID5(vendorId, "Product Z")<a class="pilcrow" href="#section-3.4.1-2.2">¶</a>
</li>
            <li class="normal" id="section-3.4.1-2.3">YclassId = UUID5(vendorId, "Product Y")<a class="pilcrow" href="#section-3.4.1-2.3">¶</a>
</li>
          </ul>
<p id="section-3.4.1-3">This ensures that Vendor A's Product Z cannot install firmware for Product Y and Product Y cannot install firmware for Product Z.<a class="pilcrow" href="#section-3.4.1-3">¶</a></p>
</section>
</div>
<div id="example-2-upgrading-class-id">
<section id="section-3.4.2">
          <h4 id="name-example-2-upgrading-class-i">
<a class="section-number selfRef" href="#section-3.4.2">3.4.2. </a><a class="section-name selfRef" href="#name-example-2-upgrading-class-i">Example 2: Upgrading Class ID</a>
          </h4>
<p id="section-3.4.2-1">Vendor A creates Product X. Later, Vendor A adds a new feature to Product X, creating Product X v2. Product X requires a firmware update to work with firmware intended for Product X v2.<a class="pilcrow" href="#section-3.4.2-1">¶</a></p>
<p id="section-3.4.2-2">Vendor A creates UUIDs as follows:<a class="pilcrow" href="#section-3.4.2-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4.2-3.1">vendorId = UUID5(DNS, "vendor-a.example")<a class="pilcrow" href="#section-3.4.2-3.1">¶</a>
</li>
            <li class="normal" id="section-3.4.2-3.2">XclassId = UUID5(vendorId, "Product X")<a class="pilcrow" href="#section-3.4.2-3.2">¶</a>
</li>
            <li class="normal" id="section-3.4.2-3.3">Xv2classId = UUID5(vendorId, "Product X v2")<a class="pilcrow" href="#section-3.4.2-3.3">¶</a>
</li>
          </ul>
<p id="section-3.4.2-4">When Product X receives the firmware update necessary to be compatible with Product X v2, part of the firmware update changes the Class ID to Xv2classId.<a class="pilcrow" href="#section-3.4.2-4">¶</a></p>
</section>
</div>
<div id="example-3-shared-functionality">
<section id="section-3.4.3">
          <h4 id="name-example-3-shared-functional">
<a class="section-number selfRef" href="#section-3.4.3">3.4.3. </a><a class="section-name selfRef" href="#name-example-3-shared-functional">Example 3: Shared Functionality</a>
          </h4>
<p id="section-3.4.3-1">Vendor A produces two products: Product X and Product Y. These components share a common core (such as an operating system (OS)) but have different applications. The common core and the applications can be updated independently. To enable X and Y to receive the same common core update, they require the same Class ID. To ensure that only Product X receives Application X and only Product Y receives Application Y, Product X and Product Y must have different Class IDs. The vendor creates Class IDs as follows:<a class="pilcrow" href="#section-3.4.3-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4.3-2.1">vendorId = UUID5(DNS, "vendor-a.example")<a class="pilcrow" href="#section-3.4.3-2.1">¶</a>
</li>
            <li class="normal" id="section-3.4.3-2.2">XclassId = UUID5(vendorId, "Product X")<a class="pilcrow" href="#section-3.4.3-2.2">¶</a>
</li>
            <li class="normal" id="section-3.4.3-2.3">YclassId = UUID5(vendorId, "Product Y")<a class="pilcrow" href="#section-3.4.3-2.3">¶</a>
</li>
            <li class="normal" id="section-3.4.3-2.4">CommonClassId = UUID5(vendorId, "common core")<a class="pilcrow" href="#section-3.4.3-2.4">¶</a>
</li>
          </ul>
<p id="section-3.4.3-3">Product X matches against both XclassId and CommonClassId. Product Y matches against both YclassId and CommonClassId.<a class="pilcrow" href="#section-3.4.3-3">¶</a></p>
</section>
</div>
<div id="example-4-rebranding">
<section id="section-3.4.4">
          <h4 id="name-example-4-rebranding">
<a class="section-number selfRef" href="#section-3.4.4">3.4.4. </a><a class="section-name selfRef" href="#name-example-4-rebranding">Example 4: Rebranding</a>
          </h4>
<p id="section-3.4.4-1">Vendor A creates a Product A and its firmware. Vendor B sells the product under its own name as Product B with some customized configuration. The vendors create the Class IDs as follows:<a class="pilcrow" href="#section-3.4.4-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4.4-2.1">vendorIdA = UUID5(DNS, "vendor-a.example")<a class="pilcrow" href="#section-3.4.4-2.1">¶</a>
</li>
            <li class="normal" id="section-3.4.4-2.2">classIdA = UUID5(vendorIdA, "Product A-Unlabeled")<a class="pilcrow" href="#section-3.4.4-2.2">¶</a>
</li>
            <li class="normal" id="section-3.4.4-2.3">vendorIdB = UUID5(DNS, "vendor-b.example")<a class="pilcrow" href="#section-3.4.4-2.3">¶</a>
</li>
            <li class="normal" id="section-3.4.4-2.4">classIdB = UUID5(vendorIdB, "Product B")<a class="pilcrow" href="#section-3.4.4-2.4">¶</a>
</li>
          </ul>
<p id="section-3.4.4-3">The product will match against each of these Class IDs. If Vendor A and Vendor B provide different components for the device, the implementor may choose to make ID matching scoped to each component. Then, the vendorIdA, classIdA match the component ID supplied by Vendor A, and the vendorIdB, classIdB match the component ID supplied by Vendor B.<a class="pilcrow" href="#section-3.4.4-3">¶</a></p>
</section>
</div>
</section>
</div>
<div id="element-precursor-digest">
<section id="section-3.5">
        <h3 id="name-precursor-image-digest-cond">
<a class="section-number selfRef" href="#section-3.5">3.5. </a><a class="section-name selfRef" href="#name-precursor-image-digest-cond">Precursor Image Digest Condition</a>
        </h3>
<p id="section-3.5-1">This element provides information about the payload that needs to be present on the device for an update to apply. This may, for example, be the case with differential updates.<a class="pilcrow" href="#section-3.5-1">¶</a></p>
<p id="section-3.5-2">This element is <span class="bcp14">OPTIONAL</span>.<a class="pilcrow" href="#section-3.5-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.5-3">
          <dt id="section-3.5-3.1">Implements:</dt>
          <dd id="section-3.5-3.2" style="margin-left: 1.5em">
            <span><a class="xref" href="#req-sec-authentic-precursor">REQ.SEC.AUTH.PRECURSOR</a> (<a class="xref" href="#req-sec-authentic-precursor">Section 4.3.9</a>)</span><a class="pilcrow" href="#section-3.5-3.2">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="element-required-version">
<section id="section-3.6">
        <h3 id="name-required-image-version-list">
<a class="section-number selfRef" href="#section-3.6">3.6. </a><a class="section-name selfRef" href="#name-required-image-version-list">Required Image Version List</a>
        </h3>
<p id="section-3.6-1">Payloads may only be applied to a specific firmware version or multiple firmware versions. For example, a payload containing a differential update may be applied only to a specific firmware version.<a class="pilcrow" href="#section-3.6-1">¶</a></p>
<p id="section-3.6-2">When a payload applies to multiple versions of firmware, the required image version list specifies which firmware versions must be present for the update to be applied. This allows the update author to target specific versions of firmware for an update, while excluding those to which it should not or cannot be applied.<a class="pilcrow" href="#section-3.6-2">¶</a></p>
<p id="section-3.6-3">This element is <span class="bcp14">OPTIONAL</span>.<a class="pilcrow" href="#section-3.6-3">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.6-4">
          <dt id="section-3.6-4.1">Implements:</dt>
          <dd id="section-3.6-4.2" style="margin-left: 1.5em">
            <span><a class="xref" href="#req-use-img-versions">REQ.USE.IMG.VERSIONS</a> (<a class="xref" href="#req-use-img-versions">Section 4.5.8</a>)</span><a class="pilcrow" href="#section-3.6-4.2">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="manifest-element-expiration">
<section id="section-3.7">
        <h3 id="name-expiration-time">
<a class="section-number selfRef" href="#section-3.7">3.7. </a><a class="section-name selfRef" href="#name-expiration-time">Expiration Time</a>
        </h3>
<p id="section-3.7-1">This element tells a device the time at which the manifest expires and should no longer be used. This element should be used where a secure source of time is provided and firmware is intended to expire predictably. This element may also be displayed (e.g., via an app) for user confirmation, since users typically have a reliable knowledge of the date.<a class="pilcrow" href="#section-3.7-1">¶</a></p>
<p id="section-3.7-2">Special consideration is required for end-of-life if firmware will not be updated again -- for example, if a business stops issuing updates to a device. In this case, the last valid firmware should not have an expiration time.<a class="pilcrow" href="#section-3.7-2">¶</a></p>
<p id="section-3.7-3">This element is <span class="bcp14">OPTIONAL</span>.<a class="pilcrow" href="#section-3.7-3">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.7-4">
          <dt id="section-3.7-4.1">Implements:</dt>
          <dd id="section-3.7-4.2" style="margin-left: 1.5em">
            <span><a class="xref" href="#req-sec-exp">REQ.SEC.EXP</a> (<a class="xref" href="#req-sec-exp">Section 4.3.3</a>)</span><a class="pilcrow" href="#section-3.7-4.2">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="manifest-element-format">
<section id="section-3.8">
        <h3 id="name-payload-format">
<a class="section-number selfRef" href="#section-3.8">3.8. </a><a class="section-name selfRef" href="#name-payload-format">Payload Format</a>
        </h3>
<p id="section-3.8-1">This element describes the payload format within the signed metadata. It is used to enable devices to decode payloads correctly.<a class="pilcrow" href="#section-3.8-1">¶</a></p>
<p id="section-3.8-2">This element is <span class="bcp14">REQUIRED</span>.<a class="pilcrow" href="#section-3.8-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.8-3">
          <dt id="section-3.8-3.1">Implements:</dt>
          <dd id="section-3.8-3.2" style="margin-left: 1.5em">
            <span><a class="xref" href="#req-sec-authentic-image-type">REQ.SEC.AUTH.IMG_TYPE</a> (<a class="xref" href="#req-sec-authentic-image-type">Section 4.3.5</a>)</span>, <span><a class="xref" href="#req-use-img-format">REQ.USE.IMG.FORMAT</a> (<a class="xref" href="#req-use-img-format">Section 4.5.6</a>)</span><a class="pilcrow" href="#section-3.8-3.2">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="manifest-element-processing-steps">
<section id="section-3.9">
        <h3 id="name-processing-steps">
<a class="section-number selfRef" href="#section-3.9">3.9. </a><a class="section-name selfRef" href="#name-processing-steps">Processing Steps</a>
        </h3>
<p id="section-3.9-1">This element provides a representation of the processing steps required to decode a payload -- in particular, those that are compressed, packed, or encrypted. The representation must describe which algorithms are used and must convey any additional parameters required by those algorithms.<a class="pilcrow" href="#section-3.9-1">¶</a></p>
<p id="section-3.9-2">A processing step may indicate the expected digest of the payload after the processing is complete.<a class="pilcrow" href="#section-3.9-2">¶</a></p>
<p id="section-3.9-3">This element is <span class="bcp14">RECOMMENDED</span>.<a class="pilcrow" href="#section-3.9-3">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.9-4">
          <dt id="section-3.9-4.1">Implements:</dt>
          <dd id="section-3.9-4.2" style="margin-left: 1.5em">
            <span><a class="xref" href="#req-use-img-nested">REQ.USE.IMG.NESTED</a> (<a class="xref" href="#req-use-img-nested">Section 4.5.7</a>)</span><a class="pilcrow" href="#section-3.9-4.2">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="maniest-element-storage-location">
<section id="section-3.10">
        <h3 id="name-storage-location">
<a class="section-number selfRef" href="#section-3.10">3.10. </a><a class="section-name selfRef" href="#name-storage-location">Storage Location</a>
        </h3>
<p id="section-3.10-1">This element tells the device where to store a payload within a given component. The device can use this to establish which permissions are necessary and the physical storage location to use.<a class="pilcrow" href="#section-3.10-1">¶</a></p>
<p id="section-3.10-2">This element is <span class="bcp14">REQUIRED</span>.<a class="pilcrow" href="#section-3.10-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.10-3">
          <dt id="section-3.10-3.1">Implements:</dt>
          <dd id="section-3.10-3.2" style="margin-left: 1.5em">
            <span><a class="xref" href="#req-sec-authentic-image-location">REQ.SEC.AUTH.IMG_LOC</a> (<a class="xref" href="#req-sec-authentic-image-location">Section 4.3.6</a>)</span><a class="pilcrow" href="#section-3.10-3.2">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<div id="example-1-two-storage-locations">
<section id="section-3.10.1">
          <h4 id="name-example-1-two-storage-locat">
<a class="section-number selfRef" href="#section-3.10.1">3.10.1. </a><a class="section-name selfRef" href="#name-example-1-two-storage-locat">Example 1: Two Storage Locations</a>
          </h4>
<p id="section-3.10.1-1">A device supports two components: an OS and an application. These components can be updated independently, expressing dependencies to ensure compatibility between the components. The author chooses two storage identifiers:<a class="pilcrow" href="#section-3.10.1-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.10.1-2.1">"OS"<a class="pilcrow" href="#section-3.10.1-2.1">¶</a>
</li>
            <li class="normal" id="section-3.10.1-2.2">"APP"<a class="pilcrow" href="#section-3.10.1-2.2">¶</a>
</li>
          </ul>
</section>
</div>
<div id="example-2-file-system">
<section id="section-3.10.2">
          <h4 id="name-example-2-filesystem">
<a class="section-number selfRef" href="#section-3.10.2">3.10.2. </a><a class="section-name selfRef" href="#name-example-2-filesystem">Example 2: Filesystem</a>
          </h4>
<p id="section-3.10.2-1">A device supports a full-featured filesystem. The author chooses to use the storage identifier as the path at which to install the payload. The payload may be a tarball, in which case it unpacks the tarball into the specified path.<a class="pilcrow" href="#section-3.10.2-1">¶</a></p>
</section>
</div>
<div id="example-3-flash-memory">
<section id="section-3.10.3">
          <h4 id="name-example-3-flash-memory">
<a class="section-number selfRef" href="#section-3.10.3">3.10.3. </a><a class="section-name selfRef" href="#name-example-3-flash-memory">Example 3: Flash Memory</a>
          </h4>
<p id="section-3.10.3-1">A device supports flash memory. The author chooses to make the storage identifier the offset where the image should be written.<a class="pilcrow" href="#section-3.10.3-1">¶</a></p>
</section>
</div>
</section>
</div>
<div id="manifest-element-component-identifier">
<section id="section-3.11">
        <h3 id="name-component-identifier">
<a class="section-number selfRef" href="#section-3.11">3.11. </a><a class="section-name selfRef" href="#name-component-identifier">Component Identifier</a>
        </h3>
<p id="section-3.11-1">In a device with more than one storage subsystem, a storage identifier is insufficient to identify where and how to store a payload. To resolve this, a component identifier indicates to which part of the storage subsystem the payload shall be placed.<a class="pilcrow" href="#section-3.11-1">¶</a></p>
<p id="section-3.11-2">A serialization may choose to combine the use of a component identifier and <span><a class="xref" href="#maniest-element-storage-location">storage location</a> (<a class="xref" href="#maniest-element-storage-location">Section 3.10</a>)</span>.<a class="pilcrow" href="#section-3.11-2">¶</a></p>
<p id="section-3.11-3">This element is <span class="bcp14">OPTIONAL</span>.<a class="pilcrow" href="#section-3.11-3">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.11-4">
          <dt id="section-3.11-4.1">Implements:</dt>
          <dd id="section-3.11-4.2" style="margin-left: 1.5em">
            <span><a class="xref" href="#req-use-mfst-component">REQ.USE.MFST.COMPONENT</a> (<a class="xref" href="#req-use-mfst-component">Section 4.5.4</a>)</span><a class="pilcrow" href="#section-3.11-4.2">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="manifest-element-payload-indicator">
<section id="section-3.12">
        <h3 id="name-payload-indicator">
<a class="section-number selfRef" href="#section-3.12">3.12. </a><a class="section-name selfRef" href="#name-payload-indicator">Payload Indicator</a>
        </h3>
<p id="section-3.12-1">This element provides the information required for the device to acquire the payload. This functionality is only needed when the target device does not intrinsically know where to find the payload.<a class="pilcrow" href="#section-3.12-1">¶</a></p>
<p id="section-3.12-2">This can be encoded in several ways:<a class="pilcrow" href="#section-3.12-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.12-3.1">One URI<a class="pilcrow" href="#section-3.12-3.1">¶</a>
</li>
          <li class="normal" id="section-3.12-3.2">A list of URIs<a class="pilcrow" href="#section-3.12-3.2">¶</a>
</li>
          <li class="normal" id="section-3.12-3.3">A prioritized list of URIs<a class="pilcrow" href="#section-3.12-3.3">¶</a>
</li>
          <li class="normal" id="section-3.12-3.4">A list of signed URIs<a class="pilcrow" href="#section-3.12-3.4">¶</a>
</li>
        </ul>
<p id="section-3.12-4">This element is <span class="bcp14">OPTIONAL</span>.<a class="pilcrow" href="#section-3.12-4">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.12-5">
          <dt id="section-3.12-5.1">Implements:</dt>
          <dd id="section-3.12-5.2" style="margin-left: 1.5em">
            <span><a class="xref" href="#req-sec-authenticated-remote-payload">REQ.SEC.AUTH.REMOTE_LOC</a> (<a class="xref" href="#req-sec-authenticated-remote-payload">Section 4.3.7</a>)</span><a class="pilcrow" href="#section-3.12-5.2">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="manifest-element-payload-digest">
<section id="section-3.13">
        <h3 id="name-payload-digests">
<a class="section-number selfRef" href="#section-3.13">3.13. </a><a class="section-name selfRef" href="#name-payload-digests">Payload Digests</a>
        </h3>
<p id="section-3.13-1">This element contains one or more digests of one or more payloads. This allows the target device to ensure authenticity of the payload(s) when combined with the <span><a class="xref" href="#manifest-element-signature">Signature</a> (<a class="xref" href="#manifest-element-signature">Section 3.15</a>)</span> element. A manifest format must provide a mechanism to select one payload from a list based on system parameters, such as an execute-in-place (XIP) installation address.<a class="pilcrow" href="#section-3.13-1">¶</a></p>
<p id="section-3.13-2">This element is <span class="bcp14">REQUIRED</span>. Support for more than one digest is <span class="bcp14">OPTIONAL</span>.<a class="pilcrow" href="#section-3.13-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.13-3">
          <dt id="section-3.13-3.1">Implements:</dt>
          <dd id="section-3.13-3.2" style="margin-left: 1.5em">
            <span><a class="xref" href="#req-sec-authentic">REQ.SEC.AUTHENTIC</a> (<a class="xref" href="#req-sec-authentic">Section 4.3.4</a>)</span>, <span><a class="xref" href="#req-use-img-select">REQ.USE.IMG.SELECT</a> (<a class="xref" href="#req-use-img-select">Section 4.5.9</a>)</span><a class="pilcrow" href="#section-3.13-3.2">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="manifest-element-size">
<section id="section-3.14">
        <h3 id="name-size">
<a class="section-number selfRef" href="#section-3.14">3.14. </a><a class="section-name selfRef" href="#name-size">Size</a>
        </h3>
<p id="section-3.14-1">This element provides the size of the payload in bytes, which informs the target device how big of a payload to expect. Without it, devices are exposed to some classes of denial-of-service attacks.<a class="pilcrow" href="#section-3.14-1">¶</a></p>
<p id="section-3.14-2">This element is <span class="bcp14">REQUIRED</span>.<a class="pilcrow" href="#section-3.14-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.14-3">
          <dt id="section-3.14-3.1">Implements:</dt>
          <dd id="section-3.14-3.2" style="margin-left: 1.5em">
            <span><a class="xref" href="#req-sec-authentic-execution">REQ.SEC.AUTH.EXEC</a> (<a class="xref" href="#req-sec-authentic-execution">Section 4.3.8</a>)</span><a class="pilcrow" href="#section-3.14-3.2">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="manifest-element-signature">
<section id="section-3.15">
        <h3 id="name-manifest-envelope-element-s">
<a class="section-number selfRef" href="#section-3.15">3.15. </a><a class="section-name selfRef" href="#name-manifest-envelope-element-s">Manifest Envelope Element: Signature</a>
        </h3>
<p id="section-3.15-1">The signature element contains all the information necessary to protect the contents of the manifest against modification and to offer authentication of the signer. Because the signature element authenticates the manifest, it cannot be contained within the manifest. Instead, either the manifest is contained within the signature element or the signature element is a member of the Manifest Envelope and bundled with the manifest.<a class="pilcrow" href="#section-3.15-1">¶</a></p>
<p id="section-3.15-2">The signature element represents the foundation of all security properties of the manifest. Manifests, which are included as dependencies by other manifests, should include a signature so that the recipient can distinguish between different actors with different permissions.<a class="pilcrow" href="#section-3.15-2">¶</a></p>
<p id="section-3.15-3">The signature element must support multiple signers and multiple signing algorithms. A manifest format may allow multiple manifests to be covered by a single signature element.<a class="pilcrow" href="#section-3.15-3">¶</a></p>
<p id="section-3.15-4">This element is <span class="bcp14">REQUIRED</span> in non-dependency manifests.<a class="pilcrow" href="#section-3.15-4">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.15-5">
          <dt id="section-3.15-5.1">Implements:</dt>
          <dd id="section-3.15-5.2" style="margin-left: 1.5em">
            <span><a class="xref" href="#req-sec-authentic">REQ.SEC.AUTHENTIC</a> (<a class="xref" href="#req-sec-authentic">Section 4.3.4</a>)</span>, <span><a class="xref" href="#req-sec-rights">REQ.SEC.RIGHTS</a> (<a class="xref" href="#req-sec-rights">Section 4.3.11</a>)</span>, <span><a class="xref" href="#req-use-mfst-multi-auth">REQ.USE.MFST.MULTI_AUTH</a> (<a class="xref" href="#req-use-mfst-multi-auth">Section 4.5.5</a>)</span><a class="pilcrow" href="#section-3.15-5.2">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="manifest-element-additional-install-info">
<section id="section-3.16">
        <h3 id="name-additional-installation-ins">
<a class="section-number selfRef" href="#section-3.16">3.16. </a><a class="section-name selfRef" href="#name-additional-installation-ins">Additional Installation Instructions</a>
        </h3>
<p id="section-3.16-1">Additional installation instructions are machine-readable commands the device should execute when processing the manifest. This information is distinct from the information necessary to process a payload. Additional installation instructions include information such as update timing (for example, install only on Sunday, at 0200), procedural considerations (for example, shut down the equipment under control before executing the update), and pre- and post-installation steps (for example, run a script). Other installation instructions could include requesting user confirmation before installing.<a class="pilcrow" href="#section-3.16-1">¶</a></p>
<p id="section-3.16-2">This element is <span class="bcp14">OPTIONAL</span>.<a class="pilcrow" href="#section-3.16-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.16-3">
          <dt id="section-3.16-3.1">Implements:</dt>
          <dd id="section-3.16-3.2" style="margin-left: 1.5em">
            <span><a class="xref" href="#req-use-mfst-pre-check">REQ.USE.MFST.PRE_CHECK</a> (<a class="xref" href="#req-use-mfst-pre-check">Section 4.5.1</a>)</span><a class="pilcrow" href="#section-3.16-3.2">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="manifest-element-text">
<section id="section-3.17">
        <h3 id="name-manifest-text-information">
<a class="section-number selfRef" href="#section-3.17">3.17. </a><a class="section-name selfRef" href="#name-manifest-text-information">Manifest Text Information</a>
        </h3>
<p id="section-3.17-1">This is textual information pertaining to the update described by the manifest. This information is for human consumption only. It <span class="bcp14">MUST NOT</span> be the basis of any decision made by the recipient.<a class="pilcrow" href="#section-3.17-1">¶</a></p>
<p id="section-3.17-2">This element is <span class="bcp14">OPTIONAL</span>.<a class="pilcrow" href="#section-3.17-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.17-3">
          <dt id="section-3.17-3.1">Implements:</dt>
          <dd id="section-3.17-3.2" style="margin-left: 1.5em">
            <span><a class="xref" href="#req-use-mfst-text">REQ.USE.MFST.TEXT</a> (<a class="xref" href="#req-use-mfst-text">Section 4.5.2</a>)</span><a class="pilcrow" href="#section-3.17-3.2">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="manifest-element-aliases">
<section id="section-3.18">
        <h3 id="name-aliases">
<a class="section-number selfRef" href="#section-3.18">3.18. </a><a class="section-name selfRef" href="#name-aliases">Aliases</a>
        </h3>
<p id="section-3.18-1">Aliases provide a mechanism for a manifest to augment or replace URIs or URI lists defined by one or more of its dependencies.<a class="pilcrow" href="#section-3.18-1">¶</a></p>
<p id="section-3.18-2">This element is <span class="bcp14">OPTIONAL</span>.<a class="pilcrow" href="#section-3.18-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.18-3">
          <dt id="section-3.18-3.1">Implements:</dt>
          <dd id="section-3.18-3.2" style="margin-left: 1.5em">
            <span><a class="xref" href="#req-use-mfst-override">REQ.USE.MFST.OVERRIDE_REMOTE</a> (<a class="xref" href="#req-use-mfst-override">Section 4.5.3</a>)</span><a class="pilcrow" href="#section-3.18-3.2">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="manifest-element-dependencies">
<section id="section-3.19">
        <h3 id="name-dependencies">
<a class="section-number selfRef" href="#section-3.19">3.19. </a><a class="section-name selfRef" href="#name-dependencies">Dependencies</a>
        </h3>
<p id="section-3.19-1">This is a list of other manifests that are required by the current manifest. Manifests are identified in an unambiguous way, such as a cryptographic digest.<a class="pilcrow" href="#section-3.19-1">¶</a></p>
<p id="section-3.19-2">This element is <span class="bcp14">REQUIRED</span> to support deployments that include both multiple authorities and multiple payloads.<a class="pilcrow" href="#section-3.19-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.19-3">
          <dt id="section-3.19-3.1">Implements:</dt>
          <dd id="section-3.19-3.2" style="margin-left: 1.5em">
            <span><a class="xref" href="#req-use-mfst-component">REQ.USE.MFST.COMPONENT</a> (<a class="xref" href="#req-use-mfst-component">Section 4.5.4</a>)</span><a class="pilcrow" href="#section-3.19-3.2">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="manifest-element-encryption-wrapper">
<section id="section-3.20">
        <h3 id="name-encryption-wrapper">
<a class="section-number selfRef" href="#section-3.20">3.20. </a><a class="section-name selfRef" href="#name-encryption-wrapper">Encryption Wrapper</a>
        </h3>
<p id="section-3.20-1">Encrypting firmware images requires symmetric content encryption keys. The encryption wrapper provides the information needed for a device to obtain or locate a key that it uses to decrypt the firmware.<a class="pilcrow" href="#section-3.20-1">¶</a></p>
<p id="section-3.20-2">This element is <span class="bcp14">REQUIRED</span> for encrypted payloads.<a class="pilcrow" href="#section-3.20-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.20-3">
          <dt id="section-3.20-3.1">Implements:</dt>
          <dd id="section-3.20-3.2" style="margin-left: 1.5em">
            <span><a class="xref" href="#req-sec-image-confidentiality">REQ.SEC.IMG.CONFIDENTIALITY</a> (<a class="xref" href="#req-sec-image-confidentiality">Section 4.3.12</a>)</span><a class="pilcrow" href="#section-3.20-3.2">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="manifest-element-xip-address">
<section id="section-3.21">
        <h3 id="name-xip-address">
<a class="section-number selfRef" href="#section-3.21">3.21. </a><a class="section-name selfRef" href="#name-xip-address">XIP Address</a>
        </h3>
<p id="section-3.21-1">In order to support XIP systems with multiple possible base addresses, it is necessary to specify which address the payload is linked for.<a class="pilcrow" href="#section-3.21-1">¶</a></p>
<p id="section-3.21-2">For example, a microcontroller may have a simple bootloader that chooses one of two images to boot. That microcontroller then needs to choose one of two firmware images to install, based on which of its two images is older.<a class="pilcrow" href="#section-3.21-2">¶</a></p>
<p id="section-3.21-3">This element is <span class="bcp14">OPTIONAL</span>.<a class="pilcrow" href="#section-3.21-3">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.21-4">
          <dt id="section-3.21-4.1">Implements:</dt>
          <dd id="section-3.21-4.2" style="margin-left: 1.5em">
            <span><a class="xref" href="#req-use-img-select">REQ.USE.IMG.SELECT</a> (<a class="xref" href="#req-use-img-select">Section 4.5.9</a>)</span><a class="pilcrow" href="#section-3.21-4.2">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="manifest-element-load-metadata">
<section id="section-3.22">
        <h3 id="name-load-time-metadata">
<a class="section-number selfRef" href="#section-3.22">3.22. </a><a class="section-name selfRef" href="#name-load-time-metadata">Load-Time Metadata</a>
        </h3>
<p id="section-3.22-1">Load-time metadata provides the device with information that it needs in order to load one or more images. This metadata may include any of the following:<a class="pilcrow" href="#section-3.22-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.22-2.1">The source (e.g., non-volatile storage)<a class="pilcrow" href="#section-3.22-2.1">¶</a>
</li>
          <li class="normal" id="section-3.22-2.2">The destination (e.g., an address in RAM)<a class="pilcrow" href="#section-3.22-2.2">¶</a>
</li>
          <li class="normal" id="section-3.22-2.3">Cryptographic information<a class="pilcrow" href="#section-3.22-2.3">¶</a>
</li>
          <li class="normal" id="section-3.22-2.4">Decompression information<a class="pilcrow" href="#section-3.22-2.4">¶</a>
</li>
          <li class="normal" id="section-3.22-2.5">Unpacking information<a class="pilcrow" href="#section-3.22-2.5">¶</a>
</li>
        </ul>
<p id="section-3.22-3">Typically, loading is done by copying an image from its permanent storage location into its active use location. The metadata allows operations such as decryption, decompression, and unpacking to be performed during that copy.<a class="pilcrow" href="#section-3.22-3">¶</a></p>
<p id="section-3.22-4">This element is <span class="bcp14">OPTIONAL</span>.<a class="pilcrow" href="#section-3.22-4">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.22-5">
          <dt id="section-3.22-5.1">Implements:</dt>
          <dd id="section-3.22-5.2" style="margin-left: 1.5em">
            <span><a class="xref" href="#req-use-load">REQ.USE.LOAD</a> (<a class="xref" href="#req-use-load">Section 4.5.11</a>)</span><a class="pilcrow" href="#section-3.22-5.2">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="manifest-element-exec-metadata">
<section id="section-3.23">
        <h3 id="name-runtime-metadata">
<a class="section-number selfRef" href="#section-3.23">3.23. </a><a class="section-name selfRef" href="#name-runtime-metadata">Runtime Metadata</a>
        </h3>
<p id="section-3.23-1">Runtime metadata provides the device with any extra information needed to boot the device. This may include the entry point of an XIP image or the kernel command line to boot a Linux image.<a class="pilcrow" href="#section-3.23-1">¶</a></p>
<p id="section-3.23-2">This element is <span class="bcp14">OPTIONAL</span>.<a class="pilcrow" href="#section-3.23-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.23-3">
          <dt id="section-3.23-3.1">Implements:</dt>
          <dd id="section-3.23-3.2" style="margin-left: 1.5em">
            <span><a class="xref" href="#req-use-exec">REQ.USE.EXEC</a> (<a class="xref" href="#req-use-exec">Section 4.5.10</a>)</span><a class="pilcrow" href="#section-3.23-3.2">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="manifest-element-payload">
<section id="section-3.24">
        <h3 id="name-payload">
<a class="section-number selfRef" href="#section-3.24">3.24. </a><a class="section-name selfRef" href="#name-payload">Payload</a>
        </h3>
<p id="section-3.24-1">The Payload element is contained within the manifest or Manifest Envelope and enables the manifest and payload to be delivered simultaneously. This is used for delivering small payloads, such as cryptographic keys or configuration data.<a class="pilcrow" href="#section-3.24-1">¶</a></p>
<p id="section-3.24-2">This element is <span class="bcp14">OPTIONAL</span>.<a class="pilcrow" href="#section-3.24-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.24-3">
          <dt id="section-3.24-3.1">Implements:</dt>
          <dd id="section-3.24-3.2" style="margin-left: 1.5em">
            <span><a class="xref" href="#req-use-payload">REQ.USE.PAYLOAD</a> (<a class="xref" href="#req-use-payload">Section 4.5.12</a>)</span><a class="pilcrow" href="#section-3.24-3.2">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="manifest-element-key-claims">
<section id="section-3.25">
        <h3 id="name-manifest-envelope-element-d">
<a class="section-number selfRef" href="#section-3.25">3.25. </a><a class="section-name selfRef" href="#name-manifest-envelope-element-d">Manifest Envelope Element: Delegation Chain</a>
        </h3>
<p id="section-3.25-1">The delegation chain offers enhanced authorization functionality via authorization tokens, such as Concise Binary Object Representation (CBOR) Web Tokens <span>[<a class="xref" href="#RFC8392">RFC8392</a>]</span> with Proof-of-Possession Key Semantics <span>[<a class="xref" href="#RFC8747">RFC8747</a>]</span>. Each token itself is protected and does not require another layer of protection. Each authorization token typically includes a public key or a public key fingerprint; however, this is dependent on the tokens used. Each token <span class="bcp14">MAY</span> include additional metadata, such as key usage information. Because the delegation chain is needed to verify the signature, it must be placed in the Manifest Envelope, rather than the manifest.<a class="pilcrow" href="#section-3.25-1">¶</a></p>
<p id="section-3.25-2">The first token in any delegation chain <span class="bcp14">MUST</span> be authenticated by the recipient's trust anchor. Each subsequent token <span class="bcp14">MUST</span> be authenticated using the previous token. This allows a recipient to discard each antecedent token after it has authenticated the subsequent token. The final token <span class="bcp14">MUST</span> enable authentication of the manifest. More than one delegation chain <span class="bcp14">MAY</span> be used if more than one signature is used. Note that no restriction is placed on the encoding order of these tokens; the order of elements is logical only.<a class="pilcrow" href="#section-3.25-2">¶</a></p>
<p id="section-3.25-3">This element is <span class="bcp14">OPTIONAL</span>.<a class="pilcrow" href="#section-3.25-3">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.25-4">
          <dt id="section-3.25-4.1">Implements:</dt>
          <dd id="section-3.25-4.2" style="margin-left: 1.5em">
            <span><a class="xref" href="#req-use-delegation">REQ.USE.DELEGATION</a> (<a class="xref" href="#req-use-delegation">Section 4.5.14</a>)</span>, <span><a class="xref" href="#req-sec-key-rotation">REQ.SEC.KEY.ROTATION</a> (<a class="xref" href="#req-sec-key-rotation">Section 4.3.18</a>)</span><a class="pilcrow" href="#section-3.25-4.2">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="design-motivation">
<section id="section-4">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<p id="section-4-1">The following subsections describe the threat model, user stories, security requirements, and usability requirements. This section also provides the motivations for each of the manifest information elements.<a class="pilcrow" href="#section-4-1">¶</a></p>
<p id="section-4-2">Note that it is worthwhile to recall that a firmware update is, by definition, remote code execution. Hence, if a device is configured to trust an entity to provide firmware, it trusts this entity to behave correctly. Many classes of attacks can be mitigated by verifying that a firmware update came from a trusted party and that no rollback is taking place. However, if the trusted entity has been compromised and distributes attacker-provided firmware to devices, then the possibilities for defense are limited.<a class="pilcrow" href="#section-4-2">¶</a></p>
<div id="threat-model">
<section id="section-4.1">
        <h3 id="name-threat-model">
<a class="section-number selfRef" href="#section-4.1">4.1. </a><a class="section-name selfRef" href="#name-threat-model">Threat Model</a>
        </h3>
<p id="section-4.1-1">The following subsections aim to provide information about the threats that were considered, the security requirements that are derived from those threats, and the fields that permit implementation of the security requirements. This model uses the Spoofing, Tampering, Repudiation, Information Disclosure, Denial of Service, and Elevation of Privilege (STRIDE) approach <span>[<a class="xref" href="#STRIDE">STRIDE</a>]</span>. Each threat is classified according to the following:<a class="pilcrow" href="#section-4.1-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-2.1">Spoofing identity<a class="pilcrow" href="#section-4.1-2.1">¶</a>
</li>
          <li class="normal" id="section-4.1-2.2">Tampering with data<a class="pilcrow" href="#section-4.1-2.2">¶</a>
</li>
          <li class="normal" id="section-4.1-2.3">Repudiation<a class="pilcrow" href="#section-4.1-2.3">¶</a>
</li>
          <li class="normal" id="section-4.1-2.4">Information disclosure<a class="pilcrow" href="#section-4.1-2.4">¶</a>
</li>
          <li class="normal" id="section-4.1-2.5">Denial of service<a class="pilcrow" href="#section-4.1-2.5">¶</a>
</li>
          <li class="normal" id="section-4.1-2.6">Elevation of privilege<a class="pilcrow" href="#section-4.1-2.6">¶</a>
</li>
        </ul>
<p id="section-4.1-3">This threat model only covers elements related to the transport of firmware updates. It explicitly does not cover threats outside of the transport of firmware updates. For example, threats to an IoT device due to physical access are out of scope.<a class="pilcrow" href="#section-4.1-3">¶</a></p>
</section>
</div>
<div id="threat-descriptions">
<section id="section-4.2">
        <h3 id="name-threat-descriptions">
<a class="section-number selfRef" href="#section-4.2">4.2. </a><a class="section-name selfRef" href="#name-threat-descriptions">Threat Descriptions</a>
        </h3>
<p id="section-4.2-1">Many of the threats detailed in this section contain a "threat escalation" description. This explains how the described threat might fit together with other threats and produce a high-severity threat. This is important because some of the described threats may seem low severity but could be used with others to construct a high-severity compromise.<a class="pilcrow" href="#section-4.2-1">¶</a></p>
<div id="threat-expired">
<section id="section-4.2.1">
          <h4 id="name-threatimgexpired-old-firmwa">
<a class="section-number selfRef" href="#section-4.2.1">4.2.1. </a><a class="section-name selfRef" href="#name-threatimgexpired-old-firmwa">THREAT.IMG.EXPIRED: Old Firmware</a>
          </h4>
<span class="break"></span><dl class="dlParallel" id="section-4.2.1-1">
            <dt id="section-4.2.1-1.1">Classification:</dt>
            <dd id="section-4.2.1-1.2" style="margin-left: 1.5em">Elevation of Privilege<a class="pilcrow" href="#section-4.2.1-1.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-4.2.1-2">An attacker sends an old, but valid, manifest with an old, but valid, firmware image to a device. If there is a known vulnerability in the provided firmware image, this may allow an attacker to exploit the vulnerability and gain control of the device.<a class="pilcrow" href="#section-4.2.1-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.2.1-3">
            <dt id="section-4.2.1-3.1">Threat Escalation:</dt>
            <dd id="section-4.2.1-3.2" style="margin-left: 1.5em">If the attacker is able to exploit the known vulnerability, then this threat can be escalated to all types.<a class="pilcrow" href="#section-4.2.1-3.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.2.1-3.3">Mitigated by:</dt>
            <dd id="section-4.2.1-3.4" style="margin-left: 1.5em">
              <span><a class="xref" href="#req-sec-sequence">REQ.SEC.SEQUENCE</a> (<a class="xref" href="#req-sec-sequence">Section 4.3.1</a>)</span><a class="pilcrow" href="#section-4.2.1-3.4">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="threat-expired-offline">
<section id="section-4.2.2">
          <h4 id="name-threatimgexpiredoffline-off">
<a class="section-number selfRef" href="#section-4.2.2">4.2.2. </a><a class="section-name selfRef" href="#name-threatimgexpiredoffline-off">THREAT.IMG.EXPIRED.OFFLINE: Offline Device + Old Firmware</a>
          </h4>
<span class="break"></span><dl class="dlParallel" id="section-4.2.2-1">
            <dt id="section-4.2.2-1.1">Classification:</dt>
            <dd id="section-4.2.2-1.2" style="margin-left: 1.5em">Elevation of Privilege<a class="pilcrow" href="#section-4.2.2-1.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-4.2.2-2">An attacker targets a device that has been offline for a long time and runs an old firmware version. The attacker sends an old, but valid, manifest to a device with an old, but valid, firmware image. The attacker-provided firmware is newer than the installed firmware but older than the most recently available firmware. If there is a known vulnerability in the provided firmware image, then this may allow an attacker to gain control of a device. Because the device has been offline for a long time, it is unaware of any new updates. As such, it will treat the old manifest as the most current.<a class="pilcrow" href="#section-4.2.2-2">¶</a></p>
<p id="section-4.2.2-3">The exact mitigation for this threat depends on where the threat comes from. This requires careful consideration by the implementor. If the threat is from a network actor, including an on-path attacker, or an intruder into a management system, then a user confirmation can mitigate this attack, simply by displaying an expiration date and requesting confirmation. On the other hand, if the user is the attacker, then an online confirmation system (for example, a trusted timestamp server) can be used as a mitigation system.<a class="pilcrow" href="#section-4.2.2-3">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.2.2-4">
            <dt id="section-4.2.2-4.1">Threat Escalation:</dt>
            <dd id="section-4.2.2-4.2" style="margin-left: 1.5em">If the attacker is able to exploit the known vulnerability, then this threat can be escalated to all types.<a class="pilcrow" href="#section-4.2.2-4.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.2.2-4.3">Mitigated by:</dt>
            <dd id="section-4.2.2-4.4" style="margin-left: 1.5em">
              <span><a class="xref" href="#req-sec-exp">REQ.SEC.EXP</a> (<a class="xref" href="#req-sec-exp">Section 4.3.3</a>)</span>, <span><a class="xref" href="#req-use-mfst-pre-check">REQ.USE.MFST.PRE_CHECK</a> (<a class="xref" href="#req-use-mfst-pre-check">Section 4.5.1</a>)</span><a class="pilcrow" href="#section-4.2.2-4.4">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="threat-incompatible">
<section id="section-4.2.3">
          <h4 id="name-threatimgincompatible-misma">
<a class="section-number selfRef" href="#section-4.2.3">4.2.3. </a><a class="section-name selfRef" href="#name-threatimgincompatible-misma">THREAT.IMG.INCOMPATIBLE: Mismatched Firmware</a>
          </h4>
<span class="break"></span><dl class="dlParallel" id="section-4.2.3-1">
            <dt id="section-4.2.3-1.1">Classification:</dt>
            <dd id="section-4.2.3-1.2" style="margin-left: 1.5em">Denial of Service<a class="pilcrow" href="#section-4.2.3-1.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-4.2.3-2">An attacker sends a valid firmware image, for the wrong type of device, signed by an actor with firmware installation permission on both device types. The firmware is verified by the device positively because it is signed by an actor with the appropriate permission. This could have wide-ranging consequences. For devices that are similar, it could cause minor breakage or expose security vulnerabilities. For devices that are very different, it is likely to render devices inoperable.<a class="pilcrow" href="#section-4.2.3-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.2.3-3">
            <dt id="section-4.2.3-3.1">Mitigated by:</dt>
            <dd id="section-4.2.3-3.2" style="margin-left: 1.5em">
              <span><a class="xref" href="#req-sec-compatible">REQ.SEC.COMPATIBLE</a> (<a class="xref" href="#req-sec-compatible">Section 4.3.2</a>)</span><a class="pilcrow" href="#section-4.2.3-3.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-4.2.3-4">For example, suppose that two vendors -- Vendor A and Vendor B -- adopt the same trade name in different geographic regions, and they both make products with the same names, or product name matching is not used. This causes firmware from Vendor A to match devices from Vendor B.<a class="pilcrow" href="#section-4.2.3-4">¶</a></p>
<p id="section-4.2.3-5">If the vendors are the firmware authorities, then devices from Vendor A will reject images signed by Vendor B, since they use different credentials. However, if both devices trust the same author, then devices from Vendor A could install firmware intended for devices from Vendor B.<a class="pilcrow" href="#section-4.2.3-5">¶</a></p>
</section>
</div>
<div id="threat-img-format">
<section id="section-4.2.4">
          <h4 id="name-threatimgformat-the-target-">
<a class="section-number selfRef" href="#section-4.2.4">4.2.4. </a><a class="section-name selfRef" href="#name-threatimgformat-the-target-">THREAT.IMG.FORMAT: The Target Device Misinterprets the Type of Payload</a>
          </h4>
<span class="break"></span><dl class="dlParallel" id="section-4.2.4-1">
            <dt id="section-4.2.4-1.1">Classification:</dt>
            <dd id="section-4.2.4-1.2" style="margin-left: 1.5em">Denial of Service<a class="pilcrow" href="#section-4.2.4-1.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-4.2.4-2">If a device misinterprets the format of the firmware image, it may cause a device to install a firmware image incorrectly. An incorrectly installed firmware image would likely cause the device to stop functioning.<a class="pilcrow" href="#section-4.2.4-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.2.4-3">
            <dt id="section-4.2.4-3.1">Threat Escalation:</dt>
            <dd id="section-4.2.4-3.2" style="margin-left: 1.5em">An attacker that can cause a device to misinterpret the received firmware image may gain elevation of privilege and potentially expand this to all types of threats.<a class="pilcrow" href="#section-4.2.4-3.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.2.4-3.3">Mitigated by:</dt>
            <dd id="section-4.2.4-3.4" style="margin-left: 1.5em">
              <span><a class="xref" href="#req-sec-authentic-image-type">REQ.SEC.AUTH.IMG_TYPE</a> (<a class="xref" href="#req-sec-authentic-image-type">Section 4.3.5</a>)</span><a class="pilcrow" href="#section-4.2.4-3.4">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="threat-img-location">
<section id="section-4.2.5">
          <h4 id="name-threatimglocation-the-targe">
<a class="section-number selfRef" href="#section-4.2.5">4.2.5. </a><a class="section-name selfRef" href="#name-threatimglocation-the-targe">THREAT.IMG.LOCATION: The Target Device Installs the Payload to the Wrong Location</a>
          </h4>
<span class="break"></span><dl class="dlParallel" id="section-4.2.5-1">
            <dt id="section-4.2.5-1.1">Classification:</dt>
            <dd id="section-4.2.5-1.2" style="margin-left: 1.5em">Denial of Service<a class="pilcrow" href="#section-4.2.5-1.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-4.2.5-2">If a device installs a firmware image to the wrong location on the device, then it is likely to break. For example, a firmware image installed as an application could cause a device and/or application to stop functioning.<a class="pilcrow" href="#section-4.2.5-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.2.5-3">
            <dt id="section-4.2.5-3.1">Threat Escalation:</dt>
            <dd id="section-4.2.5-3.2" style="margin-left: 1.5em">An attacker that can cause a device to misinterpret the received code may gain elevation of privilege and potentially expand this to all types of threats.<a class="pilcrow" href="#section-4.2.5-3.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.2.5-3.3">Mitigated by:</dt>
            <dd id="section-4.2.5-3.4" style="margin-left: 1.5em">
              <span><a class="xref" href="#req-sec-authentic-image-location">REQ.SEC.AUTH.IMG_LOC</a> (<a class="xref" href="#req-sec-authentic-image-location">Section 4.3.6</a>)</span><a class="pilcrow" href="#section-4.2.5-3.4">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="threat-net-redirect">
<section id="section-4.2.6">
          <h4 id="name-threatnetredirect-redirecti">
<a class="section-number selfRef" href="#section-4.2.6">4.2.6. </a><a class="section-name selfRef" href="#name-threatnetredirect-redirecti">THREAT.NET.REDIRECT: Redirection to Inauthentic Payload Hosting</a>
          </h4>
<span class="break"></span><dl class="dlParallel" id="section-4.2.6-1">
            <dt id="section-4.2.6-1.1">Classification:</dt>
            <dd id="section-4.2.6-1.2" style="margin-left: 1.5em">Denial of Service<a class="pilcrow" href="#section-4.2.6-1.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-4.2.6-2">If a device is tricked into fetching a payload for an attacker-controlled site, the attacker may send corrupted payloads to devices.<a class="pilcrow" href="#section-4.2.6-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.2.6-3">
            <dt id="section-4.2.6-3.1">Mitigated by:</dt>
            <dd id="section-4.2.6-3.2" style="margin-left: 1.5em">
              <span><a class="xref" href="#req-sec-authenticated-remote-payload">REQ.SEC.AUTH.REMOTE_LOC</a> (<a class="xref" href="#req-sec-authenticated-remote-payload">Section 4.3.7</a>)</span><a class="pilcrow" href="#section-4.2.6-3.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="threat-net-onpath">
<section id="section-4.2.7">
          <h4 id="name-threatnetonpath-traffic-int">
<a class="section-number selfRef" href="#section-4.2.7">4.2.7. </a><a class="section-name selfRef" href="#name-threatnetonpath-traffic-int">THREAT.NET.ONPATH: Traffic Interception</a>
          </h4>
<span class="break"></span><dl class="dlParallel" id="section-4.2.7-1">
            <dt id="section-4.2.7-1.1">Classification:</dt>
            <dd id="section-4.2.7-1.2" style="margin-left: 1.5em">Spoofing Identity, Tampering with Data<a class="pilcrow" href="#section-4.2.7-1.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-4.2.7-2">An attacker intercepts all traffic to and from a device. The attacker can monitor or modify any data sent to or received from the device. This can take the form of manifests, payloads, status reports, and capability reports being modified or not delivered to the intended recipient. It can also take the form of analysis of data sent to or from the device, in content, size, or frequency.<a class="pilcrow" href="#section-4.2.7-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.2.7-3">
            <dt id="section-4.2.7-3.1">Mitigated by:</dt>
            <dd id="section-4.2.7-3.2" style="margin-left: 1.5em">
              <span><a class="xref" href="#req-sec-authentic">REQ.SEC.AUTHENTIC</a> (<a class="xref" href="#req-sec-authentic">Section 4.3.4</a>)</span>, <span><a class="xref" href="#req-sec-image-confidentiality">REQ.SEC.IMG.CONFIDENTIALITY</a> (<a class="xref" href="#req-sec-image-confidentiality">Section 4.3.12</a>)</span>, <span><a class="xref" href="#req-sec-authenticated-remote-payload">REQ.SEC.AUTH.REMOTE_LOC</a> (<a class="xref" href="#req-sec-authenticated-remote-payload">Section 4.3.7</a>)</span>, <span><a class="xref" href="#req-sec-mfst-confidentiality">REQ.SEC.MFST.CONFIDENTIALITY</a> (<a class="xref" href="#req-sec-mfst-confidentiality">Section 4.3.14</a>)</span>, <span><a class="xref" href="#req-sec-reporting">REQ.SEC.REPORTING</a> (<a class="xref" href="#req-sec-reporting">Section 4.3.16</a>)</span><a class="pilcrow" href="#section-4.2.7-3.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="threat-image-replacement">
<section id="section-4.2.8">
          <h4 id="name-threatimgreplace-payload-re">
<a class="section-number selfRef" href="#section-4.2.8">4.2.8. </a><a class="section-name selfRef" href="#name-threatimgreplace-payload-re">THREAT.IMG.REPLACE: Payload Replacement</a>
          </h4>
<span class="break"></span><dl class="dlParallel" id="section-4.2.8-1">
            <dt id="section-4.2.8-1.1">Classification:</dt>
            <dd id="section-4.2.8-1.2" style="margin-left: 1.5em">Elevation of Privilege<a class="pilcrow" href="#section-4.2.8-1.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-4.2.8-2">An attacker replaces newly downloaded firmware after a device finishes verifying a manifest. This could cause the device to execute the attacker's code. This attack likely requires physical access to the device. However, it is possible that this attack is carried out in combination with another threat that allows remote execution. This is a typical Time Of Check / Time Of Use (TOCTOU) attack.<a class="pilcrow" href="#section-4.2.8-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.2.8-3">
            <dt id="section-4.2.8-3.1">Threat Escalation:</dt>
            <dd id="section-4.2.8-3.2" style="margin-left: 1.5em">If the attacker is able to exploit a known vulnerability or if the attacker can supply their own firmware, then this threat can be escalated to all types.<a class="pilcrow" href="#section-4.2.8-3.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.2.8-3.3">Mitigated by:</dt>
            <dd id="section-4.2.8-3.4" style="margin-left: 1.5em">
              <span><a class="xref" href="#req-sec-authentic-execution">REQ.SEC.AUTH.EXEC</a> (<a class="xref" href="#req-sec-authentic-execution">Section 4.3.8</a>)</span><a class="pilcrow" href="#section-4.2.8-3.4">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="threat-img-unauthenticated">
<section id="section-4.2.9">
          <h4 id="name-threatimgnon_auth-unauthent">
<a class="section-number selfRef" href="#section-4.2.9">4.2.9. </a><a class="section-name selfRef" href="#name-threatimgnon_auth-unauthent">THREAT.IMG.NON_AUTH: Unauthenticated Images</a>
          </h4>
<span class="break"></span><dl class="dlParallel" id="section-4.2.9-1">
            <dt id="section-4.2.9-1.1">Classification:</dt>
            <dd id="section-4.2.9-1.2" style="margin-left: 1.5em">Elevation of Privilege / all types<a class="pilcrow" href="#section-4.2.9-1.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-4.2.9-2">If an attacker can install their firmware on a device -- for example, by manipulating either payload or metadata -- then they have complete control of the device.<a class="pilcrow" href="#section-4.2.9-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.2.9-3">
            <dt id="section-4.2.9-3.1">Mitigated by:</dt>
            <dd id="section-4.2.9-3.2" style="margin-left: 1.5em">
              <span><a class="xref" href="#req-sec-authentic">REQ.SEC.AUTHENTIC</a> (<a class="xref" href="#req-sec-authentic">Section 4.3.4</a>)</span><a class="pilcrow" href="#section-4.2.9-3.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="threat-upd-wrong-precursor">
<section id="section-4.2.10">
          <h4 id="name-threatupdwrong_precursor-un">
<a class="section-number selfRef" href="#section-4.2.10">4.2.10. </a><a class="section-name selfRef" href="#name-threatupdwrong_precursor-un">THREAT.UPD.WRONG_PRECURSOR: Unexpected Precursor Images</a>
          </h4>
<span class="break"></span><dl class="dlParallel" id="section-4.2.10-1">
            <dt id="section-4.2.10-1.1">Classification:</dt>
            <dd id="section-4.2.10-1.2" style="margin-left: 1.5em">Denial of Service / all types<a class="pilcrow" href="#section-4.2.10-1.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-4.2.10-2">Modifications of payloads and metadata allow an attacker to introduce a number of denial-of-service attacks. Below are some examples.<a class="pilcrow" href="#section-4.2.10-2">¶</a></p>
<p id="section-4.2.10-3">An attacker sends a valid, current manifest to a device that has an unexpected precursor image. If a payload format requires a precursor image (for example, delta updates) and that precursor image is not available on the target device, it could cause the update to break.<a class="pilcrow" href="#section-4.2.10-3">¶</a></p>
<p id="section-4.2.10-4">An attacker that can cause a device to install a payload against the wrong precursor image could gain elevation of privilege and potentially expand this to all types of threats. However, it is unlikely that a valid differential update applied to an incorrect precursor would result in functional, but vulnerable, firmware.<a class="pilcrow" href="#section-4.2.10-4">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.2.10-5">
            <dt id="section-4.2.10-5.1">Mitigated by:</dt>
            <dd id="section-4.2.10-5.2" style="margin-left: 1.5em">
              <span><a class="xref" href="#req-sec-authentic-precursor">REQ.SEC.AUTH.PRECURSOR</a> (<a class="xref" href="#req-sec-authentic-precursor">Section 4.3.9</a>)</span><a class="pilcrow" href="#section-4.2.10-5.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="threat-upd-unapproved">
<section id="section-4.2.11">
          <h4 id="name-threatupdunapproved-unappro">
<a class="section-number selfRef" href="#section-4.2.11">4.2.11. </a><a class="section-name selfRef" href="#name-threatupdunapproved-unappro">THREAT.UPD.UNAPPROVED: Unapproved Firmware</a>
          </h4>
<span class="break"></span><dl class="dlParallel" id="section-4.2.11-1">
            <dt id="section-4.2.11-1.1">Classification:</dt>
            <dd id="section-4.2.11-1.2" style="margin-left: 1.5em">Denial of Service, Elevation of Privilege<a class="pilcrow" href="#section-4.2.11-1.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-4.2.11-2">This threat can appear in several ways; however, it is ultimately about ensuring that devices retain the behavior required by their owner or Operator. The owner or Operator of a device typically requires that the device maintain certain features, functions, capabilities, behaviors, or interoperability constraints (more generally, behavior). If these requirements are broken, then a device will not fulfill its purpose. Therefore, if any party other than the device's owner or the owner's contracted device operator has the ability to modify device behavior without approval, then this constitutes an elevation of privilege.<a class="pilcrow" href="#section-4.2.11-2">¶</a></p>
<p id="section-4.2.11-3">Similarly, a network operator may require that devices behave in a particular way in order to maintain the integrity of the network. If device behavior on a network can be modified without the approval of the network operator, then this constitutes an elevation of privilege with respect to the network.<a class="pilcrow" href="#section-4.2.11-3">¶</a></p>
<p id="section-4.2.11-4">For example, if the owner of a device has purchased that device because of Features A, B, and C, and a firmware update that removes Feature A is issued by the manufacturer, then the device may not fulfill the owner's requirements any more. In certain circumstances, this can cause significantly greater threats. Suppose that Feature A is used to implement a safety-critical system, whether the manufacturer intended this behavior or not. When unapproved firmware is installed, the system may become unsafe.<a class="pilcrow" href="#section-4.2.11-4">¶</a></p>
<p id="section-4.2.11-5">In a second example, the owner or Operator of a system of two or more interoperating devices needs to approve firmware for their system in order to ensure interoperability with other devices in the system. If the firmware is not qualified, the system as a whole may not work. Therefore, if a device installs firmware without the approval of the device owner or Operator, this is a threat to devices or the system as a whole.<a class="pilcrow" href="#section-4.2.11-5">¶</a></p>
<p id="section-4.2.11-6">Similarly, the Operator of a network may need to approve firmware for devices attached to the network in order to ensure favorable operating conditions within the network. If the firmware is not qualified, it may degrade the performance of the network. Therefore, if a device installs firmware without the approval of the network operator, this is a threat to the network itself.<a class="pilcrow" href="#section-4.2.11-6">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.2.11-7">
            <dt id="section-4.2.11-7.1">Threat Escalation:</dt>
            <dd id="section-4.2.11-7.2" style="margin-left: 1.5em">If the network operator expects configuration that is present in devices deployed in Network A, but not in devices deployed in Network B, then the device may experience degraded security, leading to threats of all types.<a class="pilcrow" href="#section-4.2.11-7.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.2.11-7.3">Mitigated by:</dt>
            <dd id="section-4.2.11-7.4" style="margin-left: 1.5em">
              <span><a class="xref" href="#req-sec-rights">REQ.SEC.RIGHTS</a> (<a class="xref" href="#req-sec-rights">Section 4.3.11</a>)</span>, <span><a class="xref" href="#req-sec-access-control">REQ.SEC.ACCESS_CONTROL</a> (<a class="xref" href="#req-sec-access-control">Section 4.3.13</a>)</span><a class="pilcrow" href="#section-4.2.11-7.4">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<div id="example-1-multiple-network-operators-with-a-single-device-operator">
<section id="section-4.2.11.1">
            <h5 id="name-example-1-multiple-network-">
<a class="section-number selfRef" href="#section-4.2.11.1">4.2.11.1. </a><a class="section-name selfRef" href="#name-example-1-multiple-network-">Example 1: Multiple Network Operators with a Single Device Operator</a>
            </h5>
<p id="section-4.2.11.1-1">In this example, assume that device operators expect the rights to create firmware but that network operators expect the rights to qualify firmware as "fit for purpose" on their networks. Additionally, assume that device operators manage devices that can be deployed on any network, including Network A and Network B in our example.<a class="pilcrow" href="#section-4.2.11.1-1">¶</a></p>
<p id="section-4.2.11.1-2">An attacker may obtain a manifest for a device on Network A. Then, this attacker sends that manifest to a device on Network B. Because Network A and Network B are under the control of different Operators, and the firmware for a device on Network A has not been qualified to be deployed on Network B, the target device on Network B is now in violation of Operator B's policy and may be disabled by this unqualified, but signed, firmware.<a class="pilcrow" href="#section-4.2.11.1-2">¶</a></p>
<p id="section-4.2.11.1-3">This is a denial of service because it can render devices inoperable. This is an elevation of privilege because it allows the attacker to make installation decisions that should be made by the Operator.<a class="pilcrow" href="#section-4.2.11.1-3">¶</a></p>
</section>
</div>
<div id="example-2-single-network-operator-with-multiple-device-operators">
<section id="section-4.2.11.2">
            <h5 id="name-example-2-single-network-op">
<a class="section-number selfRef" href="#section-4.2.11.2">4.2.11.2. </a><a class="section-name selfRef" href="#name-example-2-single-network-op">Example 2: Single Network Operator with Multiple Device Operators</a>
            </h5>
<p id="section-4.2.11.2-1">Multiple devices that interoperate are used on the same network and communicate with each other. Some devices are manufactured and managed by Device Operator A and other devices by Device Operator B. New firmware is released by Device Operator A that breaks compatibility with devices from Device Operator B. An attacker sends the new firmware to the devices managed by Device Operator A without the approval of the network operator. This breaks the behavior of the larger system, causing denial of service and, possibly, other threats. Where the network is a distributed Supervisory Control and Data Acquisition (SCADA) system, this could cause misbehavior of the process that is under control.<a class="pilcrow" href="#section-4.2.11.2-1">¶</a></p>
</section>
</div>
</section>
</div>
<div id="threat-img-disclosure">
<section id="section-4.2.12">
          <h4 id="name-threatimgdisclosure-reverse">
<a class="section-number selfRef" href="#section-4.2.12">4.2.12. </a><a class="section-name selfRef" href="#name-threatimgdisclosure-reverse">THREAT.IMG.DISCLOSURE: Reverse Engineering of Firmware Image for Vulnerability Analysis</a>
          </h4>
<span class="break"></span><dl class="dlParallel" id="section-4.2.12-1">
            <dt id="section-4.2.12-1.1">Classification:</dt>
            <dd id="section-4.2.12-1.2" style="margin-left: 1.5em">all types<a class="pilcrow" href="#section-4.2.12-1.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-4.2.12-2">An attacker wants to mount an attack on an IoT device. To prepare the attack, the provided firmware image is reverse engineered and analyzed for vulnerabilities.<a class="pilcrow" href="#section-4.2.12-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.2.12-3">
            <dt id="section-4.2.12-3.1">Mitigated by:</dt>
            <dd id="section-4.2.12-3.2" style="margin-left: 1.5em">
              <span><a class="xref" href="#req-sec-image-confidentiality">REQ.SEC.IMG.CONFIDENTIALITY</a> (<a class="xref" href="#req-sec-image-confidentiality">Section 4.3.12</a>)</span><a class="pilcrow" href="#section-4.2.12-3.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="threat-mfst-override">
<section id="section-4.2.13">
          <h4 id="name-threatmfstoverride-overridi">
<a class="section-number selfRef" href="#section-4.2.13">4.2.13. </a><a class="section-name selfRef" href="#name-threatmfstoverride-overridi">THREAT.MFST.OVERRIDE: Overriding Critical Manifest Elements</a>
          </h4>
<span class="break"></span><dl class="dlParallel" id="section-4.2.13-1">
            <dt id="section-4.2.13-1.1">Classification:</dt>
            <dd id="section-4.2.13-1.2" style="margin-left: 1.5em">Elevation of Privilege<a class="pilcrow" href="#section-4.2.13-1.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-4.2.13-2">An authorized actor, but not the author, uses an override mechanism (<span><a class="xref" href="#user-story-override">USER_STORY.OVERRIDE</a> (<a class="xref" href="#user-story-override">Section 4.4.3</a>)</span>) to change an information element in a manifest signed by the author. For example, if the authorized actor overrides the digest and URI of the payload, the actor can replace the entire payload with a payload of their choice.<a class="pilcrow" href="#section-4.2.13-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.2.13-3">
            <dt id="section-4.2.13-3.1">Threat Escalation:</dt>
            <dd id="section-4.2.13-3.2" style="margin-left: 1.5em">By overriding elements such as payload installation instructions or a firmware digest, this threat can be escalated to all types.<a class="pilcrow" href="#section-4.2.13-3.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.2.13-3.3">Mitigated by:</dt>
            <dd id="section-4.2.13-3.4" style="margin-left: 1.5em">
              <span><a class="xref" href="#req-sec-access-control">REQ.SEC.ACCESS_CONTROL</a> (<a class="xref" href="#req-sec-access-control">Section 4.3.13</a>)</span><a class="pilcrow" href="#section-4.2.13-3.4">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="threat-mfst-exposure">
<section id="section-4.2.14">
          <h4 id="name-threatmfstexposure-confiden">
<a class="section-number selfRef" href="#section-4.2.14">4.2.14. </a><a class="section-name selfRef" href="#name-threatmfstexposure-confiden">THREAT.MFST.EXPOSURE: Confidential Manifest Element Exposure</a>
          </h4>
<span class="break"></span><dl class="dlParallel" id="section-4.2.14-1">
            <dt id="section-4.2.14-1.1">Classification:</dt>
            <dd id="section-4.2.14-1.2" style="margin-left: 1.5em">Information Disclosure<a class="pilcrow" href="#section-4.2.14-1.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-4.2.14-2">A third party may be able to extract sensitive information from the manifest.<a class="pilcrow" href="#section-4.2.14-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.2.14-3">
            <dt id="section-4.2.14-3.1">Mitigated by:</dt>
            <dd id="section-4.2.14-3.2" style="margin-left: 1.5em">
              <span><a class="xref" href="#req-sec-mfst-confidentiality">REQ.SEC.MFST.CONFIDENTIALITY</a> (<a class="xref" href="#req-sec-mfst-confidentiality">Section 4.3.14</a>)</span><a class="pilcrow" href="#section-4.2.14-3.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="threat-img-extra">
<section id="section-4.2.15">
          <h4 id="name-threatimgextra-extra-data-a">
<a class="section-number selfRef" href="#section-4.2.15">4.2.15. </a><a class="section-name selfRef" href="#name-threatimgextra-extra-data-a">THREAT.IMG.EXTRA: Extra Data after Image</a>
          </h4>
<span class="break"></span><dl class="dlParallel" id="section-4.2.15-1">
            <dt id="section-4.2.15-1.1">Classification:</dt>
            <dd id="section-4.2.15-1.2" style="margin-left: 1.5em">all types<a class="pilcrow" href="#section-4.2.15-1.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-4.2.15-2">If a third party modifies the image so that it contains extra code after a valid, authentic image, that third party can then use their own code in order to make better use of an existing vulnerability.<a class="pilcrow" href="#section-4.2.15-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.2.15-3">
            <dt id="section-4.2.15-3.1">Mitigated by:</dt>
            <dd id="section-4.2.15-3.2" style="margin-left: 1.5em">
              <span><a class="xref" href="#req-sec-img-complete-digest">REQ.SEC.IMG.COMPLETE_DIGEST</a> (<a class="xref" href="#req-sec-img-complete-digest">Section 4.3.15</a>)</span><a class="pilcrow" href="#section-4.2.15-3.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="threat-key-exposure">
<section id="section-4.2.16">
          <h4 id="name-threatkeyexposure-exposure-">
<a class="section-number selfRef" href="#section-4.2.16">4.2.16. </a><a class="section-name selfRef" href="#name-threatkeyexposure-exposure-">THREAT.KEY.EXPOSURE: Exposure of Signing Keys</a>
          </h4>
<span class="break"></span><dl class="dlParallel" id="section-4.2.16-1">
            <dt id="section-4.2.16-1.1">Classification:</dt>
            <dd id="section-4.2.16-1.2" style="margin-left: 1.5em">all types<a class="pilcrow" href="#section-4.2.16-1.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-4.2.16-2">If a third party obtains a key or even indirect access to a key -- for example, in a hardware security module (HSM) -- then they can perform the same actions as the legitimate owner of the key. If the key is trusted for firmware updates, then the third party can perform firmware updates as though they were the legitimate owner of the key.<a class="pilcrow" href="#section-4.2.16-2">¶</a></p>
<p id="section-4.2.16-3">For example, if manifest signing is performed on a server connected to the internet, an attacker may compromise the server and then be able to sign manifests, even if the keys for manifest signing are held in an HSM that is accessed by the server.<a class="pilcrow" href="#section-4.2.16-3">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.2.16-4">
            <dt id="section-4.2.16-4.1">Mitigated by:</dt>
            <dd id="section-4.2.16-4.2" style="margin-left: 1.5em">
              <span><a class="xref" href="#req-sec-key-protection">REQ.SEC.KEY.PROTECTION</a> (<a class="xref" href="#req-sec-key-protection">Section 4.3.17</a>)</span>, <span><a class="xref" href="#req-sec-key-rotation">REQ.SEC.KEY.ROTATION</a> (<a class="xref" href="#req-sec-key-rotation">Section 4.3.18</a>)</span><a class="pilcrow" href="#section-4.2.16-4.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="threat-mfst-modification">
<section id="section-4.2.17">
          <h4 id="name-threatmfstmodification-modi">
<a class="section-number selfRef" href="#section-4.2.17">4.2.17. </a><a class="section-name selfRef" href="#name-threatmfstmodification-modi">THREAT.MFST.MODIFICATION: Modification of Manifest or Payload prior to Signing</a>
          </h4>
<span class="break"></span><dl class="dlParallel" id="section-4.2.17-1">
            <dt id="section-4.2.17-1.1">Classification:</dt>
            <dd id="section-4.2.17-1.2" style="margin-left: 1.5em">all types<a class="pilcrow" href="#section-4.2.17-1.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-4.2.17-2">If an attacker can alter a manifest or payload before it is signed, they can perform all the same actions as the manifest author. This allows the attacker to deploy firmware updates to any devices that trust the manifest author. If an attacker can modify the code of a payload before the corresponding manifest is created, they can insert their own code. If an attacker can modify the manifest before it is signed, they can redirect the manifest to their own payload.<a class="pilcrow" href="#section-4.2.17-2">¶</a></p>
<p id="section-4.2.17-3">For example, the attacker deploys malware to the developer's computer or signing service that watches manifest creation activities and inserts code into any binary that is referenced by a manifest.<a class="pilcrow" href="#section-4.2.17-3">¶</a></p>
<p id="section-4.2.17-4">For example, the attacker deploys malware to the developer's computer or signing service that replaces the referenced binary (digest) and URI with the attacker's binary (digest) and URI.<a class="pilcrow" href="#section-4.2.17-4">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.2.17-5">
            <dt id="section-4.2.17-5.1">Mitigated by:</dt>
            <dd id="section-4.2.17-5.2" style="margin-left: 1.5em">
              <span><a class="xref" href="#req-sec-mfst-check">REQ.SEC.MFST.CHECK</a> (<a class="xref" href="#req-sec-mfst-check">Section 4.3.19</a>)</span>, <span><a class="xref" href="#req-sec-mfst-trusted">REQ.SEC.MFST.TRUSTED</a> (<a class="xref" href="#req-sec-mfst-trusted">Section 4.3.20</a>)</span><a class="pilcrow" href="#section-4.2.17-5.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="threat-mfst-toctou">
<section id="section-4.2.18">
          <h4 id="name-threatmfsttoctou-modificati">
<a class="section-number selfRef" href="#section-4.2.18">4.2.18. </a><a class="section-name selfRef" href="#name-threatmfsttoctou-modificati">THREAT.MFST.TOCTOU: Modification of Manifest between Authentication and Use</a>
          </h4>
<span class="break"></span><dl class="dlParallel" id="section-4.2.18-1">
            <dt id="section-4.2.18-1.1">Classification:</dt>
            <dd id="section-4.2.18-1.2" style="margin-left: 1.5em">all types<a class="pilcrow" href="#section-4.2.18-1.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-4.2.18-2">If an attacker can modify a manifest after it is authenticated (time of check) but before it is used (time of use), then the attacker can place any content whatsoever in the manifest.<a class="pilcrow" href="#section-4.2.18-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.2.18-3">
            <dt id="section-4.2.18-3.1">Mitigated by:</dt>
            <dd id="section-4.2.18-3.2" style="margin-left: 1.5em">
              <span><a class="xref" href="#req-sec-mfst-const">REQ.SEC.MFST.CONST</a> (<a class="xref" href="#req-sec-mfst-const">Section 4.3.21</a>)</span><a class="pilcrow" href="#section-4.2.18-3.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="security-requirements">
<section id="section-4.3">
        <h3 id="name-security-requirements">
<a class="section-number selfRef" href="#section-4.3">4.3. </a><a class="section-name selfRef" href="#name-security-requirements">Security Requirements</a>
        </h3>
<p id="section-4.3-1">The security requirements here are a set of policies that mitigate the threats described in <a class="xref" href="#threat-model">Section 4.1</a>.<a class="pilcrow" href="#section-4.3-1">¶</a></p>
<div id="req-sec-sequence">
<section id="section-4.3.1">
          <h4 id="name-reqsecsequence-monotonic-se">
<a class="section-number selfRef" href="#section-4.3.1">4.3.1. </a><a class="section-name selfRef" href="#name-reqsecsequence-monotonic-se">REQ.SEC.SEQUENCE: Monotonic Sequence Numbers</a>
          </h4>
<p id="section-4.3.1-1">Only an actor with firmware installation authority is permitted to decide when device firmware can be installed. To enforce this rule, manifests <span class="bcp14">MUST</span> contain monotonically increasing sequence numbers. Manifests may use UTC epoch timestamps to coordinate monotonically increasing sequence numbers across many actors in many locations. If UTC epoch timestamps are used, they must not be treated as times; they must be treated only as sequence numbers. Devices must reject manifests with sequence numbers smaller than any onboard sequence number, i.e., there is no sequence number rollover.<a class="pilcrow" href="#section-4.3.1-1">¶</a></p>
<aside id="section-4.3.1-2">
            <p id="section-4.3.1-2.1">Note: This is not a firmware version field. It is a manifest sequence number. A firmware version may be rolled back by creating a new manifest for the old firmware version with a later sequence number.<a class="pilcrow" href="#section-4.3.1-2.1">¶</a></p>
</aside>
<span class="break"></span><dl class="dlParallel" id="section-4.3.1-3">
            <dt id="section-4.3.1-3.1">Mitigates:</dt>
            <dd id="section-4.3.1-3.2" style="margin-left: 1.5em">
              <span><a class="xref" href="#threat-expired">THREAT.IMG.EXPIRED</a> (<a class="xref" href="#threat-expired">Section 4.2.1</a>)</span><a class="pilcrow" href="#section-4.3.1-3.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.1-3.3">Implemented by:</dt>
            <dd id="section-4.3.1-3.4" style="margin-left: 1.5em">
              <span><a class="xref" href="#element-sequence-number">Monotonic Sequence Number</a> (<a class="xref" href="#element-sequence-number">Section 3.2</a>)</span><a class="pilcrow" href="#section-4.3.1-3.4">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="req-sec-compatible">
<section id="section-4.3.2">
          <h4 id="name-reqseccompatible-vendor-dev">
<a class="section-number selfRef" href="#section-4.3.2">4.3.2. </a><a class="section-name selfRef" href="#name-reqseccompatible-vendor-dev">REQ.SEC.COMPATIBLE: Vendor, Device-Type Identifiers</a>
          </h4>
<p id="section-4.3.2-1">Devices <span class="bcp14">MUST</span> only apply firmware that is intended for them. Devices must know that a given update applies to their vendor, model, hardware revision, and software revision. Human-readable identifiers are often prone to error in this regard, so unique identifiers should be used instead.<a class="pilcrow" href="#section-4.3.2-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.3.2-2">
            <dt id="section-4.3.2-2.1">Mitigates:</dt>
            <dd id="section-4.3.2-2.2" style="margin-left: 1.5em">
              <span><a class="xref" href="#threat-incompatible">THREAT.IMG.INCOMPATIBLE</a> (<a class="xref" href="#threat-incompatible">Section 4.2.3</a>)</span><a class="pilcrow" href="#section-4.3.2-2.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.2-2.3">Implemented by:</dt>
            <dd id="section-4.3.2-2.4" style="margin-left: 1.5em">
              <span><a class="xref" href="#element-vendor-id">Vendor ID Condition</a> (<a class="xref" href="#element-vendor-id">Section 3.3</a>)</span>, <span><a class="xref" href="#element-class-id">Class ID Condition</a> (<a class="xref" href="#element-class-id">Section 3.4</a>)</span><a class="pilcrow" href="#section-4.3.2-2.4">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="req-sec-exp">
<section id="section-4.3.3">
          <h4 id="name-reqsecexp-expiration-time">
<a class="section-number selfRef" href="#section-4.3.3">4.3.3. </a><a class="section-name selfRef" href="#name-reqsecexp-expiration-time">REQ.SEC.EXP: Expiration Time</a>
          </h4>
<p id="section-4.3.3-1">A firmware manifest <span class="bcp14">MAY</span> expire after a given time, and devices may have a secure clock (local or remote). If a secure clock is provided and the firmware manifest has an expiration timestamp, the device must reject the manifest if the current time is later than the expiration time.<a class="pilcrow" href="#section-4.3.3-1">¶</a></p>
<p id="section-4.3.3-2">Special consideration is required for end-of-life in cases where a device will not be updated again -- for example, if a business stops issuing updates for a device. The last valid firmware should not have an expiration time.<a class="pilcrow" href="#section-4.3.3-2">¶</a></p>
<p id="section-4.3.3-3">If a device has a flawed time source (either local or remote), an old update can be deployed as new.<a class="pilcrow" href="#section-4.3.3-3">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.3.3-4">
            <dt id="section-4.3.3-4.1">Mitigates:</dt>
            <dd id="section-4.3.3-4.2" style="margin-left: 1.5em">
              <span><a class="xref" href="#threat-expired-offline">THREAT.IMG.EXPIRED.OFFLINE</a> (<a class="xref" href="#threat-expired-offline">Section 4.2.2</a>)</span><a class="pilcrow" href="#section-4.3.3-4.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.3-4.3">Implemented by:</dt>
            <dd id="section-4.3.3-4.4" style="margin-left: 1.5em">
              <span><a class="xref" href="#manifest-element-expiration">Expiration Time</a> (<a class="xref" href="#manifest-element-expiration">Section 3.7</a>)</span><a class="pilcrow" href="#section-4.3.3-4.4">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="req-sec-authentic">
<section id="section-4.3.4">
          <h4 id="name-reqsecauthentic-cryptograph">
<a class="section-number selfRef" href="#section-4.3.4">4.3.4. </a><a class="section-name selfRef" href="#name-reqsecauthentic-cryptograph">REQ.SEC.AUTHENTIC: Cryptographic Authenticity</a>
          </h4>
<p id="section-4.3.4-1">The authenticity of an update <span class="bcp14">MUST</span> be demonstrable. Typically, this means that updates must be digitally signed. Because the manifest contains information about how to install the update, the manifest's authenticity must also be demonstrable. To reduce the overhead required for validation, the manifest contains the cryptographic digest of the firmware image, rather than a second digital signature. The authenticity of the manifest can be verified with a digital signature or Message Authentication Code. The authenticity of the firmware image is tied to the manifest by the use of a cryptographic digest of the firmware image.<a class="pilcrow" href="#section-4.3.4-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.3.4-2">
            <dt id="section-4.3.4-2.1">Mitigates:</dt>
            <dd id="section-4.3.4-2.2" style="margin-left: 1.5em">
              <span><a class="xref" href="#threat-img-unauthenticated">THREAT.IMG.NON_AUTH</a> (<a class="xref" href="#threat-img-unauthenticated">Section 4.2.9</a>)</span>, <span><a class="xref" href="#threat-net-onpath">THREAT.NET.ONPATH</a> (<a class="xref" href="#threat-net-onpath">Section 4.2.7</a>)</span><a class="pilcrow" href="#section-4.3.4-2.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.4-2.3">Implemented by:</dt>
            <dd id="section-4.3.4-2.4" style="margin-left: 1.5em">
              <span><a class="xref" href="#manifest-element-signature">Signature</a> (<a class="xref" href="#manifest-element-signature">Section 3.15</a>)</span>, <span><a class="xref" href="#manifest-element-payload-digest">Payload Digests</a> (<a class="xref" href="#manifest-element-payload-digest">Section 3.13</a>)</span><a class="pilcrow" href="#section-4.3.4-2.4">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="req-sec-authentic-image-type">
<section id="section-4.3.5">
          <h4 id="name-reqsecauthimg_type-authenti">
<a class="section-number selfRef" href="#section-4.3.5">4.3.5. </a><a class="section-name selfRef" href="#name-reqsecauthimg_type-authenti">REQ.SEC.AUTH.IMG_TYPE: Authenticated Payload Type</a>
          </h4>
<p id="section-4.3.5-1">The type of payload <span class="bcp14">MUST</span> be authenticated. For example, the target must know whether the payload is XIP firmware, a loadable module, or configuration data.<a class="pilcrow" href="#section-4.3.5-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.3.5-2">
            <dt id="section-4.3.5-2.1">Mitigates:</dt>
            <dd id="section-4.3.5-2.2" style="margin-left: 1.5em">
              <span><a class="xref" href="#threat-img-format">THREAT.IMG.FORMAT</a> (<a class="xref" href="#threat-img-format">Section 4.2.4</a>)</span><a class="pilcrow" href="#section-4.3.5-2.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.5-2.3">Implemented by:</dt>
            <dd id="section-4.3.5-2.4" style="margin-left: 1.5em">
              <span><a class="xref" href="#manifest-element-format">Payload Format</a> (<a class="xref" href="#manifest-element-format">Section 3.8</a>)</span>, <span><a class="xref" href="#manifest-element-signature">Signature</a> (<a class="xref" href="#manifest-element-signature">Section 3.15</a>)</span><a class="pilcrow" href="#section-4.3.5-2.4">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="req-sec-authentic-image-location">
<section id="section-4.3.6">
          <h4 id="name-reqsecauthimg_loc-authentic">
<a class="section-number selfRef" href="#section-4.3.6">4.3.6. </a><a class="section-name selfRef" href="#name-reqsecauthimg_loc-authentic">REQ.SEC.AUTH.IMG_LOC: Authenticated Storage Location</a>
          </h4>
<p id="section-4.3.6-1">The location on the target where the payload is to be stored <span class="bcp14">MUST</span> be authenticated.<a class="pilcrow" href="#section-4.3.6-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.3.6-2">
            <dt id="section-4.3.6-2.1">Mitigates:</dt>
            <dd id="section-4.3.6-2.2" style="margin-left: 1.5em">
              <span><a class="xref" href="#threat-img-location">THREAT.IMG.LOCATION</a> (<a class="xref" href="#threat-img-location">Section 4.2.5</a>)</span><a class="pilcrow" href="#section-4.3.6-2.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.6-2.3">Implemented by:</dt>
            <dd id="section-4.3.6-2.4" style="margin-left: 1.5em">
              <span><a class="xref" href="#maniest-element-storage-location">Storage Location</a> (<a class="xref" href="#maniest-element-storage-location">Section 3.10</a>)</span><a class="pilcrow" href="#section-4.3.6-2.4">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="req-sec-authenticated-remote-payload">
<section id="section-4.3.7">
          <h4 id="name-reqsecauthremote_loc-authen">
<a class="section-number selfRef" href="#section-4.3.7">4.3.7. </a><a class="section-name selfRef" href="#name-reqsecauthremote_loc-authen">REQ.SEC.AUTH.REMOTE_LOC: Authenticated Remote Payload</a>
          </h4>
<p id="section-4.3.7-1">The location where a target should find a payload <span class="bcp14">MUST</span> be authenticated. Remote resources need to receive an equal amount of cryptographic protection as the manifest itself, when dereferencing URIs. The security considerations of Uniform Resource Identifiers (URIs) are applicable <span>[<a class="xref" href="#RFC3986">RFC3986</a>]</span>.<a class="pilcrow" href="#section-4.3.7-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.3.7-2">
            <dt id="section-4.3.7-2.1">Mitigates:</dt>
            <dd id="section-4.3.7-2.2" style="margin-left: 1.5em">
              <span><a class="xref" href="#threat-net-redirect">THREAT.NET.REDIRECT</a> (<a class="xref" href="#threat-net-redirect">Section 4.2.6</a>)</span>, <span><a class="xref" href="#threat-net-onpath">THREAT.NET.ONPATH</a> (<a class="xref" href="#threat-net-onpath">Section 4.2.7</a>)</span><a class="pilcrow" href="#section-4.3.7-2.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.7-2.3">Implemented by:</dt>
            <dd id="section-4.3.7-2.4" style="margin-left: 1.5em">
              <span><a class="xref" href="#manifest-element-payload-indicator">Payload Indicator</a> (<a class="xref" href="#manifest-element-payload-indicator">Section 3.12</a>)</span><a class="pilcrow" href="#section-4.3.7-2.4">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="req-sec-authentic-execution">
<section id="section-4.3.8">
          <h4 id="name-reqsecauthexec-secure-execu">
<a class="section-number selfRef" href="#section-4.3.8">4.3.8. </a><a class="section-name selfRef" href="#name-reqsecauthexec-secure-execu">REQ.SEC.AUTH.EXEC: Secure Execution</a>
          </h4>
<p id="section-4.3.8-1">The target <span class="bcp14">SHOULD</span> verify firmware at the time of boot. This requires authenticated payload size and firmware digest.<a class="pilcrow" href="#section-4.3.8-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.3.8-2">
            <dt id="section-4.3.8-2.1">Mitigates:</dt>
            <dd id="section-4.3.8-2.2" style="margin-left: 1.5em">
              <span><a class="xref" href="#threat-image-replacement">THREAT.IMG.REPLACE</a> (<a class="xref" href="#threat-image-replacement">Section 4.2.8</a>)</span><a class="pilcrow" href="#section-4.3.8-2.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.8-2.3">Implemented by:</dt>
            <dd id="section-4.3.8-2.4" style="margin-left: 1.5em">
              <span><a class="xref" href="#manifest-element-payload-digest">Payload Digests</a> (<a class="xref" href="#manifest-element-payload-digest">Section 3.13</a>)</span>, <span><a class="xref" href="#manifest-element-size">Size</a> (<a class="xref" href="#manifest-element-size">Section 3.14</a>)</span><a class="pilcrow" href="#section-4.3.8-2.4">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="req-sec-authentic-precursor">
<section id="section-4.3.9">
          <h4 id="name-reqsecauthprecursor-authent">
<a class="section-number selfRef" href="#section-4.3.9">4.3.9. </a><a class="section-name selfRef" href="#name-reqsecauthprecursor-authent">REQ.SEC.AUTH.PRECURSOR: Authenticated Precursor Images</a>
          </h4>
<p id="section-4.3.9-1">If an update uses a differential compression method, it <span class="bcp14">MUST</span> specify the digest of the precursor image, and that digest <span class="bcp14">MUST</span> be authenticated.<a class="pilcrow" href="#section-4.3.9-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.3.9-2">
            <dt id="section-4.3.9-2.1">Mitigates:</dt>
            <dd id="section-4.3.9-2.2" style="margin-left: 1.5em">
              <span><a class="xref" href="#threat-upd-wrong-precursor">THREAT.UPD.WRONG_PRECURSOR</a> (<a class="xref" href="#threat-upd-wrong-precursor">Section 4.2.10</a>)</span><a class="pilcrow" href="#section-4.3.9-2.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.9-2.3">Implemented by:</dt>
            <dd id="section-4.3.9-2.4" style="margin-left: 1.5em">
              <span><a class="xref" href="#element-precursor-digest">Precursor Image Digest</a> (<a class="xref" href="#element-precursor-digest">Section 3.5</a>)</span><a class="pilcrow" href="#section-4.3.9-2.4">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="req-sec-authentic-compatibility">
<section id="section-4.3.10">
          <h4 id="name-reqsecauthcompatibility-aut">
<a class="section-number selfRef" href="#section-4.3.10">4.3.10. </a><a class="section-name selfRef" href="#name-reqsecauthcompatibility-aut">REQ.SEC.AUTH.COMPATIBILITY: Authenticated Vendor and Class IDs</a>
          </h4>
<p id="section-4.3.10-1">The identifiers that specify firmware compatibility <span class="bcp14">MUST</span> be authenticated to ensure that only compatible firmware is installed on a target device.<a class="pilcrow" href="#section-4.3.10-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.3.10-2">
            <dt id="section-4.3.10-2.1">Mitigates:</dt>
            <dd id="section-4.3.10-2.2" style="margin-left: 1.5em">
              <span><a class="xref" href="#threat-incompatible">THREAT.IMG.INCOMPATIBLE</a> (<a class="xref" href="#threat-incompatible">Section 4.2.3</a>)</span><a class="pilcrow" href="#section-4.3.10-2.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.10-2.3">Implemented by:</dt>
            <dd id="section-4.3.10-2.4" style="margin-left: 1.5em">
              <span><a class="xref" href="#element-vendor-id">Vendor ID Condition</a> (<a class="xref" href="#element-vendor-id">Section 3.3</a>)</span>, <span><a class="xref" href="#element-class-id">Class ID Condition</a> (<a class="xref" href="#element-class-id">Section 3.4</a>)</span><a class="pilcrow" href="#section-4.3.10-2.4">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="req-sec-rights">
<section id="section-4.3.11">
          <h4 id="name-reqsecrights-rights-require">
<a class="section-number selfRef" href="#section-4.3.11">4.3.11. </a><a class="section-name selfRef" href="#name-reqsecrights-rights-require">REQ.SEC.RIGHTS: Rights Require Authenticity</a>
          </h4>
<p id="section-4.3.11-1">If a device grants different rights to different actors, exercising those rights <span class="bcp14">MUST</span> be accompanied by proof of those rights, in the form of proof of authenticity. Authenticity mechanisms, such as those required in <span><a class="xref" href="#req-sec-authentic">REQ.SEC.AUTHENTIC</a> (<a class="xref" href="#req-sec-authentic">Section 4.3.4</a>)</span>, can be used to prove authenticity.<a class="pilcrow" href="#section-4.3.11-1">¶</a></p>
<p id="section-4.3.11-2">For example, if a device has a policy that requires that firmware have both an Authorship right and a Qualification right and if that device grants Authorship and Qualification rights to different parties, such as a device operator and a network operator, respectively, then the firmware cannot be installed without proof of rights from both the device operator and the network operator.<a class="pilcrow" href="#section-4.3.11-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.3.11-3">
            <dt id="section-4.3.11-3.1">Mitigates:</dt>
            <dd id="section-4.3.11-3.2" style="margin-left: 1.5em">
              <span><a class="xref" href="#threat-upd-unapproved">THREAT.UPD.UNAPPROVED</a> (<a class="xref" href="#threat-upd-unapproved">Section 4.2.11</a>)</span><a class="pilcrow" href="#section-4.3.11-3.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.11-3.3">Implemented by:</dt>
            <dd id="section-4.3.11-3.4" style="margin-left: 1.5em">
              <span><a class="xref" href="#manifest-element-signature">Signature</a> (<a class="xref" href="#manifest-element-signature">Section 3.15</a>)</span><a class="pilcrow" href="#section-4.3.11-3.4">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="req-sec-image-confidentiality">
<section id="section-4.3.12">
          <h4 id="name-reqsecimgconfidentiality-pa">
<a class="section-number selfRef" href="#section-4.3.12">4.3.12. </a><a class="section-name selfRef" href="#name-reqsecimgconfidentiality-pa">REQ.SEC.IMG.CONFIDENTIALITY: Payload Encryption</a>
          </h4>
<p id="section-4.3.12-1">The manifest information model <span class="bcp14">MUST</span> enable encrypted payloads. Encryption helps to prevent third parties, including attackers, from reading the content of the firmware image. This can protect against confidential information disclosures and discovery of vulnerabilities through reverse engineering. Therefore, the manifest must convey the information required to allow an intended recipient to decrypt an encrypted payload.<a class="pilcrow" href="#section-4.3.12-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.3.12-2">
            <dt id="section-4.3.12-2.1">Mitigates:</dt>
            <dd id="section-4.3.12-2.2" style="margin-left: 1.5em">
              <span><a class="xref" href="#threat-img-disclosure">THREAT.IMG.DISCLOSURE</a> (<a class="xref" href="#threat-img-disclosure">Section 4.2.12</a>)</span>, <span><a class="xref" href="#threat-net-onpath">THREAT.NET.ONPATH</a> (<a class="xref" href="#threat-net-onpath">Section 4.2.7</a>)</span><a class="pilcrow" href="#section-4.3.12-2.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.12-2.3">Implemented by:</dt>
            <dd id="section-4.3.12-2.4" style="margin-left: 1.5em">
              <span><a class="xref" href="#manifest-element-encryption-wrapper">Encryption Wrapper</a> (<a class="xref" href="#manifest-element-encryption-wrapper">Section 3.20</a>)</span><a class="pilcrow" href="#section-4.3.12-2.4">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="req-sec-access-control">
<section id="section-4.3.13">
          <h4 id="name-reqsecaccess_control-access">
<a class="section-number selfRef" href="#section-4.3.13">4.3.13. </a><a class="section-name selfRef" href="#name-reqsecaccess_control-access">REQ.SEC.ACCESS_CONTROL: Access Control</a>
          </h4>
<p id="section-4.3.13-1">If a device grants different rights to different actors, then an exercise of those rights <span class="bcp14">MUST</span> be validated against a list of rights for the actor. This typically takes the form of an Access Control List (ACL). ACLs are applied to two scenarios:<a class="pilcrow" href="#section-4.3.13-1">¶</a></p>
<ol class="normal type-1" id="section-4.3.13-2" start="1" type="1">
<li id="section-4.3.13-2.1">An ACL decides which elements of the manifest may be overridden and by which actors.<a class="pilcrow" href="#section-4.3.13-2.1">¶</a>
</li>
            <li id="section-4.3.13-2.2">An ACL decides which component identifier / storage identifier pairs can be written by which actors.<a class="pilcrow" href="#section-4.3.13-2.2">¶</a>
</li>
          </ol>
<span class="break"></span><dl class="dlParallel" id="section-4.3.13-3">
            <dt id="section-4.3.13-3.1">Mitigates:</dt>
            <dd id="section-4.3.13-3.2" style="margin-left: 1.5em">
              <span><a class="xref" href="#threat-mfst-override">THREAT.MFST.OVERRIDE</a> (<a class="xref" href="#threat-mfst-override">Section 4.2.13</a>)</span>, <span><a class="xref" href="#threat-upd-unapproved">THREAT.UPD.UNAPPROVED</a> (<a class="xref" href="#threat-upd-unapproved">Section 4.2.11</a>)</span><a class="pilcrow" href="#section-4.3.13-3.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.13-3.3">Implemented by:</dt>
            <dd id="section-4.3.13-3.4" style="margin-left: 1.5em">Client-side code, not specified in manifest<a class="pilcrow" href="#section-4.3.13-3.4">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="req-sec-mfst-confidentiality">
<section id="section-4.3.14">
          <h4 id="name-reqsecmfstconfidentiality-e">
<a class="section-number selfRef" href="#section-4.3.14">4.3.14. </a><a class="section-name selfRef" href="#name-reqsecmfstconfidentiality-e">REQ.SEC.MFST.CONFIDENTIALITY: Encrypted Manifests</a>
          </h4>
<p id="section-4.3.14-1">A manifest format <span class="bcp14">MUST</span> allow encryption of selected parts of the manifest or encryption of the entire manifest to prevent sensitive content of the firmware metadata from being leaked.<a class="pilcrow" href="#section-4.3.14-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.3.14-2">
            <dt id="section-4.3.14-2.1">Mitigates:</dt>
            <dd id="section-4.3.14-2.2" style="margin-left: 1.5em">
              <span><a class="xref" href="#threat-mfst-exposure">THREAT.MFST.EXPOSURE</a> (<a class="xref" href="#threat-mfst-exposure">Section 4.2.14</a>)</span>, <span><a class="xref" href="#threat-net-onpath">THREAT.NET.ONPATH</a> (<a class="xref" href="#threat-net-onpath">Section 4.2.7</a>)</span><a class="pilcrow" href="#section-4.3.14-2.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.14-2.3">Implemented by:</dt>
            <dd id="section-4.3.14-2.4" style="margin-left: 1.5em">Manifest Encryption Wrapper / Transport Security<a class="pilcrow" href="#section-4.3.14-2.4">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="req-sec-img-complete-digest">
<section id="section-4.3.15">
          <h4 id="name-reqsecimgcomplete_digest-wh">
<a class="section-number selfRef" href="#section-4.3.15">4.3.15. </a><a class="section-name selfRef" href="#name-reqsecimgcomplete_digest-wh">REQ.SEC.IMG.COMPLETE_DIGEST: Whole Image Digest</a>
          </h4>
<p id="section-4.3.15-1">The digest <span class="bcp14">SHOULD</span> cover all available space in a fixed-size storage location. Variable-size storage locations <span class="bcp14">MUST</span> be restricted to exactly the size of deployed payload. This prevents any data from being distributed without being covered by the digest. For example, XIP microcontrollers typically have fixed-size storage. These devices should deploy a digest that covers the deployed firmware image, concatenated with the default erased value of any remaining space.<a class="pilcrow" href="#section-4.3.15-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.3.15-2">
            <dt id="section-4.3.15-2.1">Mitigates:</dt>
            <dd id="section-4.3.15-2.2" style="margin-left: 1.5em">
              <span><a class="xref" href="#threat-img-extra">THREAT.IMG.EXTRA</a> (<a class="xref" href="#threat-img-extra">Section 4.2.15</a>)</span><a class="pilcrow" href="#section-4.3.15-2.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.15-2.3">Implemented by:</dt>
            <dd id="section-4.3.15-2.4" style="margin-left: 1.5em">
              <span><a class="xref" href="#manifest-element-payload-digest">Payload Digests</a> (<a class="xref" href="#manifest-element-payload-digest">Section 3.13</a>)</span><a class="pilcrow" href="#section-4.3.15-2.4">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="req-sec-reporting">
<section id="section-4.3.16">
          <h4 id="name-reqsecreporting-secure-repo">
<a class="section-number selfRef" href="#section-4.3.16">4.3.16. </a><a class="section-name selfRef" href="#name-reqsecreporting-secure-repo">REQ.SEC.REPORTING: Secure Reporting</a>
          </h4>
<p id="section-4.3.16-1">Status reports from the device to any remote system <span class="bcp14">MUST</span> be performed over an authenticated, confidential channel in order to prevent modification or spoofing of the reports.<a class="pilcrow" href="#section-4.3.16-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.3.16-2">
            <dt id="section-4.3.16-2.1">Mitigates:</dt>
            <dd id="section-4.3.16-2.2" style="margin-left: 1.5em">
              <span><a class="xref" href="#threat-net-onpath">THREAT.NET.ONPATH</a> (<a class="xref" href="#threat-net-onpath">Section 4.2.7</a>)</span><a class="pilcrow" href="#section-4.3.16-2.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.16-2.3">Implemented by:</dt>
            <dd id="section-4.3.16-2.4" style="margin-left: 1.5em">Transport Security / Manifest format triggering generation of reports<a class="pilcrow" href="#section-4.3.16-2.4">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="req-sec-key-protection">
<section id="section-4.3.17">
          <h4 id="name-reqseckeyprotection-protect">
<a class="section-number selfRef" href="#section-4.3.17">4.3.17. </a><a class="section-name selfRef" href="#name-reqseckeyprotection-protect">REQ.SEC.KEY.PROTECTION: Protected Storage of Signing Keys</a>
          </h4>
<p id="section-4.3.17-1">Cryptographic keys for signing/authenticating manifests <span class="bcp14">SHOULD</span> be stored in a manner that is inaccessible to networked devices -- for example, in an HSM or an air-gapped computer. This protects against an attacker obtaining the keys.<a class="pilcrow" href="#section-4.3.17-1">¶</a></p>
<p id="section-4.3.17-2">Keys <span class="bcp14">SHOULD</span> be stored in a way that limits the risk of a legitimate, but compromised, entity (such as a server or developer computer) issuing signing requests.<a class="pilcrow" href="#section-4.3.17-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.3.17-3">
            <dt id="section-4.3.17-3.1">Mitigates:</dt>
            <dd id="section-4.3.17-3.2" style="margin-left: 1.5em">
              <span><a class="xref" href="#threat-key-exposure">THREAT.KEY.EXPOSURE</a> (<a class="xref" href="#threat-key-exposure">Section 4.2.16</a>)</span><a class="pilcrow" href="#section-4.3.17-3.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.17-3.3">Implemented by:</dt>
            <dd id="section-4.3.17-3.4" style="margin-left: 1.5em">Hardware-assisted isolation technologies, which are outside the scope of the manifest format<a class="pilcrow" href="#section-4.3.17-3.4">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="req-sec-key-rotation">
<section id="section-4.3.18">
          <h4 id="name-reqseckeyrotation-protected">
<a class="section-number selfRef" href="#section-4.3.18">4.3.18. </a><a class="section-name selfRef" href="#name-reqseckeyrotation-protected">REQ.SEC.KEY.ROTATION: Protected Storage of Signing Keys</a>
          </h4>
<p id="section-4.3.18-1">Cryptographic keys for signing/authenticating manifests <span class="bcp14">SHOULD</span> be replaced from time to time. Because it is difficult and risky to replace a trust anchor, keys used for signing updates <span class="bcp14">SHOULD</span> be delegates of that trust anchor.<a class="pilcrow" href="#section-4.3.18-1">¶</a></p>
<p id="section-4.3.18-2">If key expiration is performed based on time, then a secure clock is needed. If the time source used by a recipient to check for expiration is flawed, an old signing key can be used as current, which compounds <span><a class="xref" href="#threat-key-exposure">THREAT.KEY.EXPOSURE</a> (<a class="xref" href="#threat-key-exposure">Section 4.2.16</a>)</span>.<a class="pilcrow" href="#section-4.3.18-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.3.18-3">
            <dt id="section-4.3.18-3.1">Mitigates:</dt>
            <dd id="section-4.3.18-3.2" style="margin-left: 1.5em">
              <span><a class="xref" href="#threat-key-exposure">THREAT.KEY.EXPOSURE</a> (<a class="xref" href="#threat-key-exposure">Section 4.2.16</a>)</span><a class="pilcrow" href="#section-4.3.18-3.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.18-3.3">Implemented by:</dt>
            <dd id="section-4.3.18-3.4" style="margin-left: 1.5em">Secure storage technology, which is a system design/implementation aspect outside the scope of the manifest format<a class="pilcrow" href="#section-4.3.18-3.4">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="req-sec-mfst-check">
<section id="section-4.3.19">
          <h4 id="name-reqsecmfstcheck-validate-ma">
<a class="section-number selfRef" href="#section-4.3.19">4.3.19. </a><a class="section-name selfRef" href="#name-reqsecmfstcheck-validate-ma">REQ.SEC.MFST.CHECK: Validate Manifests prior to Deployment</a>
          </h4>
<p id="section-4.3.19-1">Manifests <span class="bcp14">SHOULD</span> be verified prior to deployment. This reduces problems that may arise with devices installing firmware images that damage devices unintentionally.<a class="pilcrow" href="#section-4.3.19-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.3.19-2">
            <dt id="section-4.3.19-2.1">Mitigates:</dt>
            <dd id="section-4.3.19-2.2" style="margin-left: 1.5em">
              <span><a class="xref" href="#threat-mfst-modification">THREAT.MFST.MODIFICATION</a> (<a class="xref" href="#threat-mfst-modification">Section 4.2.17</a>)</span><a class="pilcrow" href="#section-4.3.19-2.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.19-2.3">Implemented by:</dt>
            <dd id="section-4.3.19-2.4" style="margin-left: 1.5em">Testing infrastructure. While outside the scope of the manifest format, proper testing of low-level software is essential for avoiding unnecessary downtime or worse situations.<a class="pilcrow" href="#section-4.3.19-2.4">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="req-sec-mfst-trusted">
<section id="section-4.3.20">
          <h4 id="name-reqsecmfsttrusted-construct">
<a class="section-number selfRef" href="#section-4.3.20">4.3.20. </a><a class="section-name selfRef" href="#name-reqsecmfsttrusted-construct">REQ.SEC.MFST.TRUSTED: Construct Manifests in a Trusted Environment</a>
          </h4>
<p id="section-4.3.20-1">For high-risk deployments, such as large numbers of devices or devices that provide critical functions, manifests <span class="bcp14">SHOULD</span> be constructed in an environment that is protected from interference, such as an air-gapped computer. Note that a networked computer connected to an HSM does not fulfill this requirement (see <span><a class="xref" href="#threat-mfst-modification">THREAT.MFST.MODIFICATION</a> (<a class="xref" href="#threat-mfst-modification">Section 4.2.17</a>)</span>).<a class="pilcrow" href="#section-4.3.20-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.3.20-2">
            <dt id="section-4.3.20-2.1">Mitigates:</dt>
            <dd id="section-4.3.20-2.2" style="margin-left: 1.5em">
              <span><a class="xref" href="#threat-mfst-modification">THREAT.MFST.MODIFICATION</a> (<a class="xref" href="#threat-mfst-modification">Section 4.2.17</a>)</span><a class="pilcrow" href="#section-4.3.20-2.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.20-2.3">Implemented by:</dt>
            <dd id="section-4.3.20-2.4" style="margin-left: 1.5em">Physical and network security for protecting the environment where firmware updates are prepared to avoid unauthorized access to this infrastructure<a class="pilcrow" href="#section-4.3.20-2.4">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="req-sec-mfst-const">
<section id="section-4.3.21">
          <h4 id="name-reqsecmfstconst-manifest-ke">
<a class="section-number selfRef" href="#section-4.3.21">4.3.21. </a><a class="section-name selfRef" href="#name-reqsecmfstconst-manifest-ke">REQ.SEC.MFST.CONST: Manifest Kept Immutable between Check and Use</a>
          </h4>
<p id="section-4.3.21-1">Both the manifest and any data extracted from it <span class="bcp14">MUST</span> be held immutable between its authenticity verification (time of check) and its use (time of use). To make this guarantee, the manifest <span class="bcp14">MUST</span> fit within internal memory or secure memory, such as encrypted memory. The recipient <span class="bcp14">SHOULD</span> defend the manifest from tampering by code or hardware resident in the recipient -- for example, other processes or debuggers.<a class="pilcrow" href="#section-4.3.21-1">¶</a></p>
<p id="section-4.3.21-2">If an application requires that the manifest be verified before storing it, then this means the manifest <span class="bcp14">MUST</span> fit in RAM.<a class="pilcrow" href="#section-4.3.21-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.3.21-3">
            <dt id="section-4.3.21-3.1">Mitigates:</dt>
            <dd id="section-4.3.21-3.2" style="margin-left: 1.5em">
              <span><a class="xref" href="#threat-mfst-toctou">THREAT.MFST.TOCTOU</a> (<a class="xref" href="#threat-mfst-toctou">Section 4.2.18</a>)</span><a class="pilcrow" href="#section-4.3.21-3.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.3.21-3.3">Implemented by:</dt>
            <dd id="section-4.3.21-3.4" style="margin-left: 1.5em">Proper system design with sufficient resources and implementation avoiding TOCTOU attacks<a class="pilcrow" href="#section-4.3.21-3.4">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="user-stories">
<section id="section-4.4">
        <h3 id="name-user-stories">
<a class="section-number selfRef" href="#section-4.4">4.4. </a><a class="section-name selfRef" href="#name-user-stories">User Stories</a>
        </h3>
<p id="section-4.4-1">User stories provide expected use cases. These are used to feed into usability requirements.<a class="pilcrow" href="#section-4.4-1">¶</a></p>
<div id="user-story-install-instructions">
<section id="section-4.4.1">
          <h4 id="name-user_storyinstallinstructio">
<a class="section-number selfRef" href="#section-4.4.1">4.4.1. </a><a class="section-name selfRef" href="#name-user_storyinstallinstructio">USER_STORY.INSTALL.INSTRUCTIONS: Installation Instructions</a>
          </h4>
<p id="section-4.4.1-1">As a device operator, I want to provide my devices with additional installation instructions so that I can keep process details out of my payload data.<a class="pilcrow" href="#section-4.4.1-1">¶</a></p>
<p id="section-4.4.1-2">Some installation instructions might be as follows:<a class="pilcrow" href="#section-4.4.1-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4.1-3.1">Use a table of hashes to ensure that each block of the payload is validated before writing.<a class="pilcrow" href="#section-4.4.1-3.1">¶</a>
</li>
            <li class="normal" id="section-4.4.1-3.2">Do not report progress.<a class="pilcrow" href="#section-4.4.1-3.2">¶</a>
</li>
            <li class="normal" id="section-4.4.1-3.3">Pre-cache the update, but do not install.<a class="pilcrow" href="#section-4.4.1-3.3">¶</a>
</li>
            <li class="normal" id="section-4.4.1-3.4">Install the pre-cached update matching this manifest.<a class="pilcrow" href="#section-4.4.1-3.4">¶</a>
</li>
            <li class="normal" id="section-4.4.1-3.5">Install this update immediately, overriding any long-running tasks.<a class="pilcrow" href="#section-4.4.1-3.5">¶</a>
</li>
          </ul>
<span class="break"></span><dl class="dlParallel" id="section-4.4.1-4">
            <dt id="section-4.4.1-4.1">Satisfied by:</dt>
            <dd id="section-4.4.1-4.2" style="margin-left: 1.5em">
              <span><a class="xref" href="#req-use-mfst-pre-check">REQ.USE.MFST.PRE_CHECK</a> (<a class="xref" href="#req-use-mfst-pre-check">Section 4.5.1</a>)</span><a class="pilcrow" href="#section-4.4.1-4.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="user-story-fail-early">
<section id="section-4.4.2">
          <h4 id="name-user_storymfstfail_early-fa">
<a class="section-number selfRef" href="#section-4.4.2">4.4.2. </a><a class="section-name selfRef" href="#name-user_storymfstfail_early-fa">USER_STORY.MFST.FAIL_EARLY: Fail Early</a>
          </h4>
<p id="section-4.4.2-1">As a designer of a resource-constrained IoT device, I want bad updates to fail as early as possible to preserve battery life and limit consumed bandwidth.<a class="pilcrow" href="#section-4.4.2-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.4.2-2">
            <dt id="section-4.4.2-2.1">Satisfied by:</dt>
            <dd id="section-4.4.2-2.2" style="margin-left: 1.5em">
              <span><a class="xref" href="#req-use-mfst-pre-check">REQ.USE.MFST.PRE_CHECK</a> (<a class="xref" href="#req-use-mfst-pre-check">Section 4.5.1</a>)</span><a class="pilcrow" href="#section-4.4.2-2.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="user-story-override">
<section id="section-4.4.3">
          <h4 id="name-user_storyoverride-override">
<a class="section-number selfRef" href="#section-4.4.3">4.4.3. </a><a class="section-name selfRef" href="#name-user_storyoverride-override">USER_STORY.OVERRIDE: Override Non-critical Manifest Elements</a>
          </h4>
<p id="section-4.4.3-1">As a device operator, I would like to be able to override the non-critical information in the manifest so that I can control my devices more precisely. The authority to override this information is provided via the installation of a limited trust anchor by another authority.<a class="pilcrow" href="#section-4.4.3-1">¶</a></p>
<p id="section-4.4.3-2">Some examples of potentially overridable information:<a class="pilcrow" href="#section-4.4.3-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.4.3-3">
            <dt id="section-4.4.3-3.1">
<span><a class="xref" href="#manifest-element-payload-indicator">URIs</a> (<a class="xref" href="#manifest-element-payload-indicator">Section 3.12</a>)</span>:</dt>
            <dd id="section-4.4.3-3.2" style="margin-left: 1.5em">This allows the device operator to direct devices to their own infrastructure in order to reduce network load.<a class="pilcrow" href="#section-4.4.3-3.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.4.3-3.3">Conditions:</dt>
            <dd id="section-4.4.3-3.4" style="margin-left: 1.5em">This allows the device operator to impose additional constraints on the installation of the manifest.<a class="pilcrow" href="#section-4.4.3-3.4">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.4.3-3.5">
<span><a class="xref" href="#manifest-element-additional-install-info">Directives</a> (<a class="xref" href="#manifest-element-additional-install-info">Section 3.16</a>)</span>:</dt>
            <dd id="section-4.4.3-3.6" style="margin-left: 1.5em">This allows the device operator to add more instructions, such as time of installation.<a class="pilcrow" href="#section-4.4.3-3.6">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.4.3-3.7">
<span><a class="xref" href="#manifest-element-processing-steps">Processing Steps</a> (<a class="xref" href="#manifest-element-processing-steps">Section 3.9</a>)</span>:</dt>
            <dd id="section-4.4.3-3.8" style="margin-left: 1.5em">If an intermediary performs an action on behalf of a device, it may need to override the processing steps. It is still possible for a device to verify the final content and the result of any processing step that specifies a digest. Some processing steps should be non-overridable.<a class="pilcrow" href="#section-4.4.3-3.8">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.4.3-3.9">Satisfied by:</dt>
            <dd id="section-4.4.3-3.10" style="margin-left: 1.5em">
              <span><a class="xref" href="#req-use-mfst-component">REQ.USE.MFST.COMPONENT</a> (<a class="xref" href="#req-use-mfst-component">Section 4.5.4</a>)</span><a class="pilcrow" href="#section-4.4.3-3.10">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="user-story-component">
<section id="section-4.4.4">
          <h4 id="name-user_storycomponent-compone">
<a class="section-number selfRef" href="#section-4.4.4">4.4.4. </a><a class="section-name selfRef" href="#name-user_storycomponent-compone">USER_STORY.COMPONENT: Component Update</a>
          </h4>
<p id="section-4.4.4-1">As a device operator, I want to divide my firmware into components, so that I can reduce the size of updates, make different parties responsible for different components, and divide my firmware into frequently updated and infrequently updated components.<a class="pilcrow" href="#section-4.4.4-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.4.4-2">
            <dt id="section-4.4.4-2.1">Satisfied by:</dt>
            <dd id="section-4.4.4-2.2" style="margin-left: 1.5em">
              <span><a class="xref" href="#req-use-mfst-component">REQ.USE.MFST.COMPONENT</a> (<a class="xref" href="#req-use-mfst-component">Section 4.5.4</a>)</span><a class="pilcrow" href="#section-4.4.4-2.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="user-story-multi-auth">
<section id="section-4.4.5">
          <h4 id="name-user_storymulti_auth-multip">
<a class="section-number selfRef" href="#section-4.4.5">4.4.5. </a><a class="section-name selfRef" href="#name-user_storymulti_auth-multip">USER_STORY.MULTI_AUTH: Multiple Authorizations</a>
          </h4>
<p id="section-4.4.5-1">As a device operator, I want to ensure the quality of a firmware update before installing it, so that I can ensure interoperability of all devices in my product family. I want to restrict the ability to make changes to my devices to require my express approval.<a class="pilcrow" href="#section-4.4.5-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.4.5-2">
            <dt id="section-4.4.5-2.1">Satisfied by:</dt>
            <dd id="section-4.4.5-2.2" style="margin-left: 1.5em">
              <span><a class="xref" href="#req-use-mfst-multi-auth">REQ.USE.MFST.MULTI_AUTH</a> (<a class="xref" href="#req-use-mfst-multi-auth">Section 4.5.5</a>)</span>, <span><a class="xref" href="#req-sec-access-control">REQ.SEC.ACCESS_CONTROL</a> (<a class="xref" href="#req-sec-access-control">Section 4.3.13</a>)</span><a class="pilcrow" href="#section-4.4.5-2.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="user-story-img-format">
<section id="section-4.4.6">
          <h4 id="name-user_storyimgformat-multipl">
<a class="section-number selfRef" href="#section-4.4.6">4.4.6. </a><a class="section-name selfRef" href="#name-user_storyimgformat-multipl">USER_STORY.IMG.FORMAT: Multiple Payload Formats</a>
          </h4>
<p id="section-4.4.6-1">As a device operator, I want to be able to send multiple payload formats to suit the needs of my update, so that I can optimize the bandwidth used by my devices.<a class="pilcrow" href="#section-4.4.6-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.4.6-2">
            <dt id="section-4.4.6-2.1">Satisfied by:</dt>
            <dd id="section-4.4.6-2.2" style="margin-left: 1.5em">
              <span><a class="xref" href="#req-use-img-format">REQ.USE.IMG.FORMAT</a> (<a class="xref" href="#req-use-img-format">Section 4.5.6</a>)</span><a class="pilcrow" href="#section-4.4.6-2.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="user-story-img-confidentiality">
<section id="section-4.4.7">
          <h4 id="name-user_storyimgconfidentialit">
<a class="section-number selfRef" href="#section-4.4.7">4.4.7. </a><a class="section-name selfRef" href="#name-user_storyimgconfidentialit">USER_STORY.IMG.CONFIDENTIALITY: Prevent Confidential Information Disclosures</a>
          </h4>
<p id="section-4.4.7-1">As a firmware author, I want to prevent confidential information in the manifest from being disclosed when distributing manifests and firmware images. Confidential information may include information about the device these updates are being applied to as well as information in the firmware image itself.<a class="pilcrow" href="#section-4.4.7-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.4.7-2">
            <dt id="section-4.4.7-2.1">Satisfied by:</dt>
            <dd id="section-4.4.7-2.2" style="margin-left: 1.5em">
              <span><a class="xref" href="#req-sec-image-confidentiality">REQ.SEC.IMG.CONFIDENTIALITY</a> (<a class="xref" href="#req-sec-image-confidentiality">Section 4.3.12</a>)</span><a class="pilcrow" href="#section-4.4.7-2.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="user-story-img-unknown-format">
<section id="section-4.4.8">
          <h4 id="name-user_storyimgunknown_format">
<a class="section-number selfRef" href="#section-4.4.8">4.4.8. </a><a class="section-name selfRef" href="#name-user_storyimgunknown_format">USER_STORY.IMG.UNKNOWN_FORMAT: Prevent Devices from Unpacking Unknown Formats</a>
          </h4>
<p id="section-4.4.8-1">As a device operator, I want devices to determine whether they can process a payload prior to downloading it.<a class="pilcrow" href="#section-4.4.8-1">¶</a></p>
<p id="section-4.4.8-2">In some cases, it may be desirable for a third party to perform some processing on behalf of a target. For this to occur, the third party <span class="bcp14">MUST</span> indicate what processing occurred and how to verify it against the Trust Provisioning Authority's intent.<a class="pilcrow" href="#section-4.4.8-2">¶</a></p>
<p id="section-4.4.8-3">This amounts to overriding <span><a class="xref" href="#manifest-element-processing-steps">Processing Steps</a> (<a class="xref" href="#manifest-element-processing-steps">Section 3.9</a>)</span> and <span><a class="xref" href="#manifest-element-payload-indicator">Payload Indicator</a> (<a class="xref" href="#manifest-element-payload-indicator">Section 3.12</a>)</span>.<a class="pilcrow" href="#section-4.4.8-3">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.4.8-4">
            <dt id="section-4.4.8-4.1">Satisfied by:</dt>
            <dd id="section-4.4.8-4.2" style="margin-left: 1.5em">
              <span><a class="xref" href="#req-use-img-format">REQ.USE.IMG.FORMAT</a> (<a class="xref" href="#req-use-img-format">Section 4.5.6</a>)</span>, <span><a class="xref" href="#req-use-img-nested">REQ.USE.IMG.NESTED</a> (<a class="xref" href="#req-use-img-nested">Section 4.5.7</a>)</span>, <span><a class="xref" href="#req-use-mfst-override">REQ.USE.MFST.OVERRIDE_REMOTE</a> (<a class="xref" href="#req-use-mfst-override">Section 4.5.3</a>)</span><a class="pilcrow" href="#section-4.4.8-4.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="user-story-img-current-version">
<section id="section-4.4.9">
          <h4 id="name-user_storyimgcurrent_versio">
<a class="section-number selfRef" href="#section-4.4.9">4.4.9. </a><a class="section-name selfRef" href="#name-user_storyimgcurrent_versio">USER_STORY.IMG.CURRENT_VERSION: Specify Version Numbers of Target Firmware</a>
          </h4>
<p id="section-4.4.9-1">As a device operator, I want to be able to target devices for updates based on their current firmware version, so that I can control which versions are replaced with a single manifest.<a class="pilcrow" href="#section-4.4.9-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.4.9-2">
            <dt id="section-4.4.9-2.1">Satisfied by:</dt>
            <dd id="section-4.4.9-2.2" style="margin-left: 1.5em">
              <span><a class="xref" href="#req-use-img-versions">REQ.USE.IMG.VERSIONS</a> (<a class="xref" href="#req-use-img-versions">Section 4.5.8</a>)</span><a class="pilcrow" href="#section-4.4.9-2.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="user-story-img-select">
<section id="section-4.4.10">
          <h4 id="name-user_storyimgselect-enable-">
<a class="section-number selfRef" href="#section-4.4.10">4.4.10. </a><a class="section-name selfRef" href="#name-user_storyimgselect-enable-">USER_STORY.IMG.SELECT: Enable Devices to Choose between Images</a>
          </h4>
<p id="section-4.4.10-1">As a developer, I want to be able to sign two or more versions of my firmware in a single manifest so that I can use a very simple bootloader that chooses between two or more images that are executed in place.<a class="pilcrow" href="#section-4.4.10-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.4.10-2">
            <dt id="section-4.4.10-2.1">Satisfied by:</dt>
            <dd id="section-4.4.10-2.2" style="margin-left: 1.5em">
              <span><a class="xref" href="#req-use-img-select">REQ.USE.IMG.SELECT</a> (<a class="xref" href="#req-use-img-select">Section 4.5.9</a>)</span><a class="pilcrow" href="#section-4.4.10-2.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="user-story-exec-mfst">
<section id="section-4.4.11">
          <h4 id="name-user_storyexecmfst-secure-e">
<a class="section-number selfRef" href="#section-4.4.11">4.4.11. </a><a class="section-name selfRef" href="#name-user_storyexecmfst-secure-e">USER_STORY.EXEC.MFST: Secure Execution Using Manifests</a>
          </h4>
<p id="section-4.4.11-1">As a signer for both secure execution/boot and firmware deployment, I would like to use the same signed document for both tasks so that my data size is smaller, I can share common code, and I can reduce signature verifications.<a class="pilcrow" href="#section-4.4.11-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.4.11-2">
            <dt id="section-4.4.11-2.1">Satisfied by:</dt>
            <dd id="section-4.4.11-2.2" style="margin-left: 1.5em">
              <span><a class="xref" href="#req-use-exec">REQ.USE.EXEC</a> (<a class="xref" href="#req-use-exec">Section 4.5.10</a>)</span><a class="pilcrow" href="#section-4.4.11-2.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="user-story-exec-decompress">
<section id="section-4.4.12">
          <h4 id="name-user_storyexecdecompress-de">
<a class="section-number selfRef" href="#section-4.4.12">4.4.12. </a><a class="section-name selfRef" href="#name-user_storyexecdecompress-de">USER_STORY.EXEC.DECOMPRESS: Decompress on Load</a>
          </h4>
<p id="section-4.4.12-1">As a developer of firmware for a run-from-RAM device, I would like to use compressed images and to indicate to the bootloader that I am using a compressed image in the manifest so that it can be used with secure execution/boot.<a class="pilcrow" href="#section-4.4.12-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.4.12-2">
            <dt id="section-4.4.12-2.1">Satisfied by:</dt>
            <dd id="section-4.4.12-2.2" style="margin-left: 1.5em">
              <span><a class="xref" href="#req-use-load">REQ.USE.LOAD</a> (<a class="xref" href="#req-use-load">Section 4.5.11</a>)</span><a class="pilcrow" href="#section-4.4.12-2.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="user-story-mfst-img">
<section id="section-4.4.13">
          <h4 id="name-user_storymfstimg-payload-i">
<a class="section-number selfRef" href="#section-4.4.13">4.4.13. </a><a class="section-name selfRef" href="#name-user_storymfstimg-payload-i">USER_STORY.MFST.IMG: Payload in Manifest</a>
          </h4>
<p id="section-4.4.13-1">As an Operator of devices on a constrained network, I would like the manifest to be able to include a small payload in the same packet so that I can reduce network traffic.<a class="pilcrow" href="#section-4.4.13-1">¶</a></p>
<p id="section-4.4.13-2">Small payloads may include, for example, wrapped content encryption keys, configuration information, public keys, authorization tokens, or X.509 certificates.<a class="pilcrow" href="#section-4.4.13-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.4.13-3">
            <dt id="section-4.4.13-3.1">Satisfied by:</dt>
            <dd id="section-4.4.13-3.2" style="margin-left: 1.5em">
              <span><a class="xref" href="#req-use-payload">REQ.USE.PAYLOAD</a> (<a class="xref" href="#req-use-payload">Section 4.5.12</a>)</span><a class="pilcrow" href="#section-4.4.13-3.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="user-story-mfst-parse">
<section id="section-4.4.14">
          <h4 id="name-user_storymfstparse-simple-">
<a class="section-number selfRef" href="#section-4.4.14">4.4.14. </a><a class="section-name selfRef" href="#name-user_storymfstparse-simple-">USER_STORY.MFST.PARSE: Simple Parsing</a>
          </h4>
<p id="section-4.4.14-1">As a developer for constrained devices, I want a low-complexity library for processing updates so that I can fit more application code on my device.<a class="pilcrow" href="#section-4.4.14-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.4.14-2">
            <dt id="section-4.4.14-2.1">Satisfied by:</dt>
            <dd id="section-4.4.14-2.2" style="margin-left: 1.5em">
              <span><a class="xref" href="#req-use-parse">REQ.USE.PARSE</a> (<a class="xref" href="#req-use-parse">Section 4.5.13</a>)</span><a class="pilcrow" href="#section-4.4.14-2.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="user-story-mfst-delegation">
<section id="section-4.4.15">
          <h4 id="name-user_storymfstdelegation-de">
<a class="section-number selfRef" href="#section-4.4.15">4.4.15. </a><a class="section-name selfRef" href="#name-user_storymfstdelegation-de">USER_STORY.MFST.DELEGATION: Delegated Authority in Manifest</a>
          </h4>
<p id="section-4.4.15-1">As a device operator that rotates delegated authority more often than delivering firmware updates, I would like to delegate a new authority when I deliver a firmware update so that I can accomplish both tasks in a single transmission.<a class="pilcrow" href="#section-4.4.15-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.4.15-2">
            <dt id="section-4.4.15-2.1">Satisfied by:</dt>
            <dd id="section-4.4.15-2.2" style="margin-left: 1.5em">
              <span><a class="xref" href="#req-use-delegation">REQ.USE.DELEGATION</a> (<a class="xref" href="#req-use-delegation">Section 4.5.14</a>)</span><a class="pilcrow" href="#section-4.4.15-2.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="user-story-mfst-pre-check">
<section id="section-4.4.16">
          <h4 id="name-user_storymfstpre_check-upd">
<a class="section-number selfRef" href="#section-4.4.16">4.4.16. </a><a class="section-name selfRef" href="#name-user_storymfstpre_check-upd">USER_STORY.MFST.PRE_CHECK: Update Evaluation</a>
          </h4>
<p id="section-4.4.16-1">As an Operator of a constrained network, I would like devices on my network to be able to evaluate the suitability of an update prior to initiating any large download so that I can prevent unnecessary consumption of bandwidth.<a class="pilcrow" href="#section-4.4.16-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.4.16-2">
            <dt id="section-4.4.16-2.1">Satisfied by:</dt>
            <dd id="section-4.4.16-2.2" style="margin-left: 1.5em">
              <span><a class="xref" href="#req-use-mfst-pre-check">REQ.USE.MFST.PRE_CHECK</a> (<a class="xref" href="#req-use-mfst-pre-check">Section 4.5.1</a>)</span><a class="pilcrow" href="#section-4.4.16-2.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="user-story-mfst-admin">
<section id="section-4.4.17">
          <h4 id="name-user_storymfstadministratio">
<a class="section-number selfRef" href="#section-4.4.17">4.4.17. </a><a class="section-name selfRef" href="#name-user_storymfstadministratio">USER_STORY.MFST.ADMINISTRATION: Administration of Manifests</a>
          </h4>
<p id="section-4.4.17-1">As a device operator, I want to understand what an update will do and to which devices it applies so that I can make informed choices about which updates to apply, when to apply them, and which devices should be updated.<a class="pilcrow" href="#section-4.4.17-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.4.17-2">
            <dt id="section-4.4.17-2.1">Satisfied by:</dt>
            <dd id="section-4.4.17-2.2" style="margin-left: 1.5em">
              <span><a class="xref" href="#req-use-mfst-text">REQ.USE.MFST.TEXT</a> (<a class="xref" href="#req-use-mfst-text">Section 4.5.2</a>)</span><a class="pilcrow" href="#section-4.4.17-2.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="usability-requirements">
<section id="section-4.5">
        <h3 id="name-usability-requirements">
<a class="section-number selfRef" href="#section-4.5">4.5. </a><a class="section-name selfRef" href="#name-usability-requirements">Usability Requirements</a>
        </h3>
<p id="section-4.5-1">The following usability requirements satisfy the user stories listed above.<a class="pilcrow" href="#section-4.5-1">¶</a></p>
<div id="req-use-mfst-pre-check">
<section id="section-4.5.1">
          <h4 id="name-requsemfstpre_check-pre-ins">
<a class="section-number selfRef" href="#section-4.5.1">4.5.1. </a><a class="section-name selfRef" href="#name-requsemfstpre_check-pre-ins">REQ.USE.MFST.PRE_CHECK: Pre-installation Checks</a>
          </h4>
<p id="section-4.5.1-1">A manifest format <span class="bcp14">MUST</span> be able to carry all information required to process an update.<a class="pilcrow" href="#section-4.5.1-1">¶</a></p>
<p id="section-4.5.1-2">For example, information about which precursor image is required for a differential update must be placed in the manifest.<a class="pilcrow" href="#section-4.5.1-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.5.1-3">
            <dt id="section-4.5.1-3.1">Satisfies:</dt>
            <dd id="section-4.5.1-3.2" style="margin-left: 1.5em">
              <span><a class="xref" href="#user-story-mfst-pre-check">USER_STORY.MFST.PRE_CHECK</a> (<a class="xref" href="#user-story-mfst-pre-check">Section 4.4.16</a>)</span>, 
 <span><a class="xref" href="#user-story-install-instructions">USER_STORY.INSTALL.INSTRUCTIONS</a> (<a class="xref" href="#user-story-install-instructions">Section 4.4.1</a>)</span><a class="pilcrow" href="#section-4.5.1-3.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.5.1-3.3">Implemented by:</dt>
            <dd id="section-4.5.1-3.4" style="margin-left: 1.5em">
              <span><a class="xref" href="#manifest-element-additional-install-info">Additional Installation Instructions</a> (<a class="xref" href="#manifest-element-additional-install-info">Section 3.16</a>)</span><a class="pilcrow" href="#section-4.5.1-3.4">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="req-use-mfst-text">
<section id="section-4.5.2">
          <h4 id="name-requsemfsttext-descriptive-">
<a class="section-number selfRef" href="#section-4.5.2">4.5.2. </a><a class="section-name selfRef" href="#name-requsemfsttext-descriptive-">REQ.USE.MFST.TEXT: Descriptive Manifest Information</a>
          </h4>
<p id="section-4.5.2-1">It <span class="bcp14">MUST</span> be possible for a device operator to determine what a manifest will do and which devices will accept it prior to distribution.<a class="pilcrow" href="#section-4.5.2-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.5.2-2">
            <dt id="section-4.5.2-2.1">Satisfies:</dt>
            <dd id="section-4.5.2-2.2" style="margin-left: 1.5em">
              <span><a class="xref" href="#user-story-mfst-admin">USER_STORY.MFST.ADMINISTRATION</a> (<a class="xref" href="#user-story-mfst-admin">Section 4.4.17</a>)</span><a class="pilcrow" href="#section-4.5.2-2.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.5.2-2.3">Implemented by:</dt>
            <dd id="section-4.5.2-2.4" style="margin-left: 1.5em">
              <span><a class="xref" href="#manifest-element-text">Manifest Text Information</a> (<a class="xref" href="#manifest-element-text">Section 3.17</a>)</span><a class="pilcrow" href="#section-4.5.2-2.4">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="req-use-mfst-override">
<section id="section-4.5.3">
          <h4 id="name-requsemfstoverride_remote-o">
<a class="section-number selfRef" href="#section-4.5.3">4.5.3. </a><a class="section-name selfRef" href="#name-requsemfstoverride_remote-o">REQ.USE.MFST.OVERRIDE_REMOTE: Override Remote Resource Location</a>
          </h4>
<p id="section-4.5.3-1">A manifest format <span class="bcp14">MUST</span> be able to redirect payload fetches. This applies where two manifests are used in conjunction. For example, a device operator creates a manifest specifying a payload and signs it, and provides a URI for that payload. A network operator creates a second manifest, with a dependency on the first. They use this second manifest to override the URIs provided by the device operator, directing them into their own infrastructure instead. Some devices may provide this capability, while others may only look at canonical sources of firmware. For this to be possible, the device must fetch the payload, whereas a device that accepts payload pushes will ignore this feature.<a class="pilcrow" href="#section-4.5.3-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.5.3-2">
            <dt id="section-4.5.3-2.1">Satisfies:</dt>
            <dd id="section-4.5.3-2.2" style="margin-left: 1.5em">
              <span><a class="xref" href="#user-story-override">USER_STORY.OVERRIDE</a> (<a class="xref" href="#user-story-override">Section 4.4.3</a>)</span><a class="pilcrow" href="#section-4.5.3-2.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.5.3-2.3">Implemented by:</dt>
            <dd id="section-4.5.3-2.4" style="margin-left: 1.5em">
              <span><a class="xref" href="#manifest-element-aliases">Aliases</a> (<a class="xref" href="#manifest-element-aliases">Section 3.18</a>)</span><a class="pilcrow" href="#section-4.5.3-2.4">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="req-use-mfst-component">
<section id="section-4.5.4">
          <h4 id="name-requsemfstcomponent-compone">
<a class="section-number selfRef" href="#section-4.5.4">4.5.4. </a><a class="section-name selfRef" href="#name-requsemfstcomponent-compone">REQ.USE.MFST.COMPONENT: Component Updates</a>
          </h4>
<p id="section-4.5.4-1">A manifest format <span class="bcp14">MUST</span> be able to express the requirement to install one or more payloads from one or more authorities so that a multi-payload update can be described. This allows multiple parties with different permissions to collaborate in creating a single update for the IoT device, across multiple components.<a class="pilcrow" href="#section-4.5.4-1">¶</a></p>
<p id="section-4.5.4-2">This requirement implies that it must be possible to construct a tree of manifests on a multi-image target.<a class="pilcrow" href="#section-4.5.4-2">¶</a></p>
<p id="section-4.5.4-3">In order to enable devices with a heterogeneous storage architecture, the manifest must enable specification of both a storage system and the storage location within that storage system.<a class="pilcrow" href="#section-4.5.4-3">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.5.4-4">
            <dt id="section-4.5.4-4.1">Satisfies:</dt>
            <dd id="section-4.5.4-4.2" style="margin-left: 1.5em">
              <span><a class="xref" href="#user-story-override">USER_STORY.OVERRIDE</a> (<a class="xref" href="#user-story-override">Section 4.4.3</a>)</span>, <span><a class="xref" href="#user-story-component">USER_STORY.COMPONENT</a> (<a class="xref" href="#user-story-component">Section 4.4.4</a>)</span><a class="pilcrow" href="#section-4.5.4-4.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.5.4-4.3">Implemented by:</dt>
            <dd id="section-4.5.4-4.4" style="margin-left: 1.5em">Dependencies, StorageIdentifier, ComponentIdentifier<a class="pilcrow" href="#section-4.5.4-4.4">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<div id="example-1-multiple-microcontrollers">
<section id="section-4.5.4.1">
            <h5 id="name-example-1-multiple-microcon">
<a class="section-number selfRef" href="#section-4.5.4.1">4.5.4.1. </a><a class="section-name selfRef" href="#name-example-1-multiple-microcon">Example 1: Multiple Microcontrollers</a>
            </h5>
<p id="section-4.5.4.1-1">An IoT device with multiple microcontrollers in the same physical device will likely require multiple payloads with different component identifiers.<a class="pilcrow" href="#section-4.5.4.1-1">¶</a></p>
</section>
</div>
<div id="example-2-code-and-configuration">
<section id="section-4.5.4.2">
            <h5 id="name-example-2-code-and-configur">
<a class="section-number selfRef" href="#section-4.5.4.2">4.5.4.2. </a><a class="section-name selfRef" href="#name-example-2-code-and-configur">Example 2: Code and Configuration</a>
            </h5>
<p id="section-4.5.4.2-1">A firmware image can be divided into two payloads: code and configuration. These payloads may require authorizations from different actors in order to install (see <span><a class="xref" href="#req-sec-rights">REQ.SEC.RIGHTS</a> (<a class="xref" href="#req-sec-rights">Section 4.3.11</a>)</span> and <span><a class="xref" href="#req-sec-access-control">REQ.SEC.ACCESS_CONTROL</a> (<a class="xref" href="#req-sec-access-control">Section 4.3.13</a>)</span>). This structure means that multiple manifests may be required, with a dependency structure between them.<a class="pilcrow" href="#section-4.5.4.2-1">¶</a></p>
</section>
</div>
<div id="example-3-multiple-software-modules">
<section id="section-4.5.4.3">
            <h5 id="name-example-3-multiple-software">
<a class="section-number selfRef" href="#section-4.5.4.3">4.5.4.3. </a><a class="section-name selfRef" href="#name-example-3-multiple-software">Example 3: Multiple Software Modules</a>
            </h5>
<p id="section-4.5.4.3-1">A firmware image can be divided into multiple functional blocks for separate testing and distribution. This means that code would need to be distributed in multiple payloads. For example, this might be desirable in order to ensure that common code between devices is identical in order to reduce distribution bandwidth.<a class="pilcrow" href="#section-4.5.4.3-1">¶</a></p>
</section>
</div>
</section>
</div>
<div id="req-use-mfst-multi-auth">
<section id="section-4.5.5">
          <h4 id="name-requsemfstmulti_auth-multip">
<a class="section-number selfRef" href="#section-4.5.5">4.5.5. </a><a class="section-name selfRef" href="#name-requsemfstmulti_auth-multip">REQ.USE.MFST.MULTI_AUTH: Multiple Authentications</a>
          </h4>
<p id="section-4.5.5-1">A manifest format <span class="bcp14">MUST</span> be able to carry multiple signatures so that authorizations from multiple parties with different permissions can be required in order to authorize installation of a manifest.<a class="pilcrow" href="#section-4.5.5-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.5.5-2">
            <dt id="section-4.5.5-2.1">Satisfies:</dt>
            <dd id="section-4.5.5-2.2" style="margin-left: 1.5em">
              <span><a class="xref" href="#user-story-multi-auth">USER_STORY.MULTI_AUTH</a> (<a class="xref" href="#user-story-multi-auth">Section 4.4.5</a>)</span><a class="pilcrow" href="#section-4.5.5-2.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.5.5-2.3">Implemented by:</dt>
            <dd id="section-4.5.5-2.4" style="margin-left: 1.5em">
              <span><a class="xref" href="#manifest-element-signature">Signature</a> (<a class="xref" href="#manifest-element-signature">Section 3.15</a>)</span><a class="pilcrow" href="#section-4.5.5-2.4">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="req-use-img-format">
<section id="section-4.5.6">
          <h4 id="name-requseimgformat-format-usab">
<a class="section-number selfRef" href="#section-4.5.6">4.5.6. </a><a class="section-name selfRef" href="#name-requseimgformat-format-usab">REQ.USE.IMG.FORMAT: Format Usability</a>
          </h4>
<p id="section-4.5.6-1">The manifest format <span class="bcp14">MUST</span> accommodate any payload format that an Operator wishes to use. This enables the recipient to detect which format the Operator has chosen. Some examples of payload format are as follows:<a class="pilcrow" href="#section-4.5.6-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.5.6-2.1">Binary<a class="pilcrow" href="#section-4.5.6-2.1">¶</a>
</li>
            <li class="normal" id="section-4.5.6-2.2">Executable and Linkable Format (ELF)<a class="pilcrow" href="#section-4.5.6-2.2">¶</a>
</li>
            <li class="normal" id="section-4.5.6-2.3">Differential<a class="pilcrow" href="#section-4.5.6-2.3">¶</a>
</li>
            <li class="normal" id="section-4.5.6-2.4">Compressed<a class="pilcrow" href="#section-4.5.6-2.4">¶</a>
</li>
            <li class="normal" id="section-4.5.6-2.5">Packed configuration<a class="pilcrow" href="#section-4.5.6-2.5">¶</a>
</li>
            <li class="normal" id="section-4.5.6-2.6">Intel HEX<a class="pilcrow" href="#section-4.5.6-2.6">¶</a>
</li>
            <li class="normal" id="section-4.5.6-2.7">Motorola S-Record<a class="pilcrow" href="#section-4.5.6-2.7">¶</a>
</li>
          </ul>
<span class="break"></span><dl class="dlParallel" id="section-4.5.6-3">
            <dt id="section-4.5.6-3.1">Satisfies:</dt>
            <dd id="section-4.5.6-3.2" style="margin-left: 1.5em">
              <span><a class="xref" href="#user-story-img-format">USER_STORY.IMG.FORMAT</a> (<a class="xref" href="#user-story-img-format">Section 4.4.6</a>)</span> <span><a class="xref" href="#user-story-img-unknown-format">USER_STORY.IMG.UNKNOWN_FORMAT</a> (<a class="xref" href="#user-story-img-unknown-format">Section 4.4.8</a>)</span><a class="pilcrow" href="#section-4.5.6-3.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.5.6-3.3">Implemented by:</dt>
            <dd id="section-4.5.6-3.4" style="margin-left: 1.5em">
              <span><a class="xref" href="#manifest-element-format">Payload Format</a> (<a class="xref" href="#manifest-element-format">Section 3.8</a>)</span><a class="pilcrow" href="#section-4.5.6-3.4">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="req-use-img-nested">
<section id="section-4.5.7">
          <h4 id="name-requseimgnested-nested-form">
<a class="section-number selfRef" href="#section-4.5.7">4.5.7. </a><a class="section-name selfRef" href="#name-requseimgnested-nested-form">REQ.USE.IMG.NESTED: Nested Formats</a>
          </h4>
<p id="section-4.5.7-1">The manifest format <span class="bcp14">MUST</span> accommodate nested formats, announcing to the target device all the nesting steps and any parameters used by those steps.<a class="pilcrow" href="#section-4.5.7-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.5.7-2">
            <dt id="section-4.5.7-2.1">Satisfies:</dt>
            <dd id="section-4.5.7-2.2" style="margin-left: 1.5em">
              <span><a class="xref" href="#user-story-img-confidentiality">USER_STORY.IMG.CONFIDENTIALITY</a> (<a class="xref" href="#user-story-img-confidentiality">Section 4.4.7</a>)</span><a class="pilcrow" href="#section-4.5.7-2.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.5.7-2.3">Implemented by:</dt>
            <dd id="section-4.5.7-2.4" style="margin-left: 1.5em">
              <span><a class="xref" href="#manifest-element-processing-steps">Processing Steps</a> (<a class="xref" href="#manifest-element-processing-steps">Section 3.9</a>)</span><a class="pilcrow" href="#section-4.5.7-2.4">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="req-use-img-versions">
<section id="section-4.5.8">
          <h4 id="name-requseimgversions-target-ve">
<a class="section-number selfRef" href="#section-4.5.8">4.5.8. </a><a class="section-name selfRef" href="#name-requseimgversions-target-ve">REQ.USE.IMG.VERSIONS: Target Version Matching</a>
          </h4>
<p id="section-4.5.8-1">The manifest format <span class="bcp14">MUST</span> provide a method to specify multiple version numbers of firmware to which the manifest applies, either with a list or with range matching.<a class="pilcrow" href="#section-4.5.8-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.5.8-2">
            <dt id="section-4.5.8-2.1">Satisfies:</dt>
            <dd id="section-4.5.8-2.2" style="margin-left: 1.5em">
              <span><a class="xref" href="#user-story-img-current-version">USER_STORY.IMG.CURRENT_VERSION</a> (<a class="xref" href="#user-story-img-current-version">Section 4.4.9</a>)</span><a class="pilcrow" href="#section-4.5.8-2.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.5.8-2.3">Implemented by:</dt>
            <dd id="section-4.5.8-2.4" style="margin-left: 1.5em">
              <span><a class="xref" href="#element-required-version">Required Image Version List</a> (<a class="xref" href="#element-required-version">Section 3.6</a>)</span><a class="pilcrow" href="#section-4.5.8-2.4">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="req-use-img-select">
<section id="section-4.5.9">
          <h4 id="name-requseimgselect-select-imag">
<a class="section-number selfRef" href="#section-4.5.9">4.5.9. </a><a class="section-name selfRef" href="#name-requseimgselect-select-imag">REQ.USE.IMG.SELECT: Select Image by Destination</a>
          </h4>
<p id="section-4.5.9-1">The manifest format <span class="bcp14">MUST</span> provide a mechanism to list multiple equivalent payloads by execute-in-place (XIP) installation address, including the payload digest and, optionally, payload URIs.<a class="pilcrow" href="#section-4.5.9-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.5.9-2">
            <dt id="section-4.5.9-2.1">Satisfies:</dt>
            <dd id="section-4.5.9-2.2" style="margin-left: 1.5em">
              <span><a class="xref" href="#user-story-img-select">USER_STORY.IMG.SELECT</a> (<a class="xref" href="#user-story-img-select">Section 4.4.10</a>)</span><a class="pilcrow" href="#section-4.5.9-2.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.5.9-2.3">Implemented by:</dt>
            <dd id="section-4.5.9-2.4" style="margin-left: 1.5em">
              <span><a class="xref" href="#manifest-element-xip-address">XIP Address</a> (<a class="xref" href="#manifest-element-xip-address">Section 3.21</a>)</span><a class="pilcrow" href="#section-4.5.9-2.4">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="req-use-exec">
<section id="section-4.5.10">
          <h4 id="name-requseexec-executable-manif">
<a class="section-number selfRef" href="#section-4.5.10">4.5.10. </a><a class="section-name selfRef" href="#name-requseexec-executable-manif">REQ.USE.EXEC: Executable Manifest</a>
          </h4>
<p id="section-4.5.10-1">The manifest format <span class="bcp14">MUST</span> allow the description of an executable system with a manifest on both XIP microcontrollers and complex operating systems. In addition, the manifest format <span class="bcp14">MUST</span> be able to express metadata, such as a kernel command line, used by any loader or bootloader.<a class="pilcrow" href="#section-4.5.10-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.5.10-2">
            <dt id="section-4.5.10-2.1">Satisfies:</dt>
            <dd id="section-4.5.10-2.2" style="margin-left: 1.5em">
              <span><a class="xref" href="#user-story-exec-mfst">USER_STORY.EXEC.MFST</a> (<a class="xref" href="#user-story-exec-mfst">Section 4.4.11</a>)</span><a class="pilcrow" href="#section-4.5.10-2.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.5.10-2.3">Implemented by:</dt>
            <dd id="section-4.5.10-2.4" style="margin-left: 1.5em">
              <span><a class="xref" href="#manifest-element-exec-metadata">Runtime Metadata</a> (<a class="xref" href="#manifest-element-exec-metadata">Section 3.23</a>)</span><a class="pilcrow" href="#section-4.5.10-2.4">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="req-use-load">
<section id="section-4.5.11">
          <h4 id="name-requseload-load-time-inform">
<a class="section-number selfRef" href="#section-4.5.11">4.5.11. </a><a class="section-name selfRef" href="#name-requseload-load-time-inform">REQ.USE.LOAD: Load-Time Information</a>
          </h4>
<p id="section-4.5.11-1">The manifest format <span class="bcp14">MUST</span> enable carrying additional metadata for load-time processing of a payload, such as cryptographic information, load address, and compression algorithm. Note that load comes before execution/boot.<a class="pilcrow" href="#section-4.5.11-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.5.11-2">
            <dt id="section-4.5.11-2.1">Satisfies:</dt>
            <dd id="section-4.5.11-2.2" style="margin-left: 1.5em">
              <span><a class="xref" href="#user-story-exec-decompress">USER_STORY.EXEC.DECOMPRESS</a> (<a class="xref" href="#user-story-exec-decompress">Section 4.4.12</a>)</span><a class="pilcrow" href="#section-4.5.11-2.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.5.11-2.3">Implemented by:</dt>
            <dd id="section-4.5.11-2.4" style="margin-left: 1.5em">
              <span><a class="xref" href="#manifest-element-load-metadata">Load-Time Metadata</a> (<a class="xref" href="#manifest-element-load-metadata">Section 3.22</a>)</span><a class="pilcrow" href="#section-4.5.11-2.4">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="req-use-payload">
<section id="section-4.5.12">
          <h4 id="name-requsepayload-payload-in-ma">
<a class="section-number selfRef" href="#section-4.5.12">4.5.12. </a><a class="section-name selfRef" href="#name-requsepayload-payload-in-ma">REQ.USE.PAYLOAD: Payload in Manifest Envelope</a>
          </h4>
<p id="section-4.5.12-1">The manifest format <span class="bcp14">MUST</span> allow placing a payload in the same structure as the manifest. This may place the payload in the same packet as the manifest.<a class="pilcrow" href="#section-4.5.12-1">¶</a></p>
<p id="section-4.5.12-2">Integrated payloads may include, for example, binaries as well as configuration information, and keying material.<a class="pilcrow" href="#section-4.5.12-2">¶</a></p>
<p id="section-4.5.12-3">When an integrated payload is provided, this increases the size of the manifest. Manifest size can cause several processing and storage concerns that require careful consideration. The payload can prevent the whole manifest from being contained in a single network packet, which can cause fragmentation and the loss of portions of the manifest in lossy networks. This causes the need for reassembly and retransmission logic. The manifest <span class="bcp14">MUST</span> be held immutable between verification and processing (see <span><a class="xref" href="#req-sec-mfst-const">REQ.SEC.MFST.CONST</a> (<a class="xref" href="#req-sec-mfst-const">Section 4.3.21</a>)</span>), so a larger manifest will consume more memory with immutability guarantees -- for example, internal RAM or NVRAM, or external secure memory. If the manifest exceeds the available immutable memory, then it <span class="bcp14">MUST</span> be processed modularly, evaluating each of the following: delegation chains; the security container; and the actual manifest, which includes verifying the integrated payload. If the security model calls for downloading the manifest and validating it before storing to NVRAM in order to prevent wear to NVRAM and energy expenditure in NVRAM, then either increasing memory allocated to manifest storage or modular processing of the received manifest may be required. While the manifest has been organized to enable this type of processing, it creates additional complexity in the parser. If the manifest is stored in NVRAM prior to processing, the integrated payload may cause the manifest to exceed the available storage. Because the manifest is received prior to validation of applicability, authority, or correctness, integrated payloads cause the recipient to expend network bandwidth and energy that may not be required if the manifest is discarded, and these costs vary with the size of the integrated payload.<a class="pilcrow" href="#section-4.5.12-3">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.5.12-4">
            <dt id="section-4.5.12-4.1">See also:</dt>
            <dd id="section-4.5.12-4.2" style="margin-left: 1.5em">
              <span><a class="xref" href="#req-sec-mfst-const">REQ.SEC.MFST.CONST</a> (<a class="xref" href="#req-sec-mfst-const">Section 4.3.21</a>)</span><a class="pilcrow" href="#section-4.5.12-4.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.5.12-4.3">Satisfies:</dt>
            <dd id="section-4.5.12-4.4" style="margin-left: 1.5em">
              <span><a class="xref" href="#user-story-mfst-img">USER_STORY.MFST.IMG</a> (<a class="xref" href="#user-story-mfst-img">Section 4.4.13</a>)</span><a class="pilcrow" href="#section-4.5.12-4.4">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.5.12-4.5">Implemented by:</dt>
            <dd id="section-4.5.12-4.6" style="margin-left: 1.5em">
              <span><a class="xref" href="#manifest-element-payload">Payload</a> (<a class="xref" href="#manifest-element-payload">Section 3.24</a>)</span><a class="pilcrow" href="#section-4.5.12-4.6">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="req-use-parse">
<section id="section-4.5.13">
          <h4 id="name-requseparse-simple-parsing">
<a class="section-number selfRef" href="#section-4.5.13">4.5.13. </a><a class="section-name selfRef" href="#name-requseparse-simple-parsing">REQ.USE.PARSE: Simple Parsing</a>
          </h4>
<p id="section-4.5.13-1">The structure of the manifest <span class="bcp14">MUST</span> be simple to parse to reduce the attack vectors against manifest parsers.<a class="pilcrow" href="#section-4.5.13-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.5.13-2">
            <dt id="section-4.5.13-2.1">Satisfies:</dt>
            <dd id="section-4.5.13-2.2" style="margin-left: 1.5em">
              <span><a class="xref" href="#user-story-mfst-parse">USER_STORY.MFST.PARSE</a> (<a class="xref" href="#user-story-mfst-parse">Section 4.4.14</a>)</span><a class="pilcrow" href="#section-4.5.13-2.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.5.13-2.3">Implemented by:</dt>
            <dd id="section-4.5.13-2.4" style="margin-left: 1.5em">N/A<a class="pilcrow" href="#section-4.5.13-2.4">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="req-use-delegation">
<section id="section-4.5.14">
          <h4 id="name-requsedelegation-delegation">
<a class="section-number selfRef" href="#section-4.5.14">4.5.14. </a><a class="section-name selfRef" href="#name-requsedelegation-delegation">REQ.USE.DELEGATION: Delegation of Authority in Manifest</a>
          </h4>
<p id="section-4.5.14-1">A manifest format <span class="bcp14">MUST</span> enable the delivery of delegation information. This information delivers a new key with which the recipient can verify the manifest.<a class="pilcrow" href="#section-4.5.14-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.5.14-2">
            <dt id="section-4.5.14-2.1">Satisfies:</dt>
            <dd id="section-4.5.14-2.2" style="margin-left: 1.5em">
              <span><a class="xref" href="#user-story-mfst-delegation">USER_STORY.MFST.DELEGATION</a> (<a class="xref" href="#user-story-mfst-delegation">Section 4.4.15</a>)</span><a class="pilcrow" href="#section-4.5.14-2.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.5.14-2.3">Implemented by:</dt>
            <dd id="section-4.5.14-2.4" style="margin-left: 1.5em">
              <span><a class="xref" href="#manifest-element-key-claims">Delegation Chain</a> (<a class="xref" href="#manifest-element-key-claims">Section 3.25</a>)</span><a class="pilcrow" href="#section-4.5.14-2.4">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-5">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<p id="section-5-1">This document has no IANA actions.<a class="pilcrow" href="#section-5-1">¶</a></p>
</section>
</div>
<section id="section-6">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-6.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-6.1">6.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time class="refDate" datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4122">[RFC4122]</dt>
        <dd>
<span class="refAuthor">Leach, P.</span>, <span class="refAuthor">Mealling, M.</span>, and <span class="refAuthor">R. Salz</span>, <span class="refTitle">"A Universally Unique IDentifier (UUID) URN Namespace"</span>, <span class="seriesInfo">RFC 4122</span>, <span class="seriesInfo">DOI 10.17487/RFC4122</span>, <time class="refDate" datetime="2005-07">July 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4122">https://www.rfc-editor.org/info/rfc4122</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time class="refDate" datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8392">[RFC8392]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Wahlstroem, E.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"CBOR Web Token (CWT)"</span>, <span class="seriesInfo">RFC 8392</span>, <span class="seriesInfo">DOI 10.17487/RFC8392</span>, <time class="refDate" datetime="2018-05">May 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8392">https://www.rfc-editor.org/info/rfc8392</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8747">[RFC8747]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Seitz, L.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Proof-of-Possession Key Semantics for CBOR Web Tokens (CWTs)"</span>, <span class="seriesInfo">RFC 8747</span>, <span class="seriesInfo">DOI 10.17487/RFC8747</span>, <time class="refDate" datetime="2020-03">March 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8747">https://www.rfc-editor.org/info/rfc8747</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9019">[RFC9019]</dt>
      <dd>
<span class="refAuthor">Moran, B.</span>, <span class="refAuthor">Tschofenig, H.</span>, <span class="refAuthor">Brown, D.</span>, and <span class="refAuthor">M. Meriac</span>, <span class="refTitle">"A Firmware Update Architecture for Internet of Things"</span>, <span class="seriesInfo">RFC 9019</span>, <span class="seriesInfo">DOI 10.17487/RFC9019</span>, <time class="refDate" datetime="2021-04">April 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9019">https://www.rfc-editor.org/info/rfc9019</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-6.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-6.2">6.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC3444">[RFC3444]</dt>
        <dd>
<span class="refAuthor">Pras, A.</span> and <span class="refAuthor">J. Schoenwaelder</span>, <span class="refTitle">"On the Difference between Information Models and Data Models"</span>, <span class="seriesInfo">RFC 3444</span>, <span class="seriesInfo">DOI 10.17487/RFC3444</span>, <time class="refDate" datetime="2003-01">January 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3444">https://www.rfc-editor.org/info/rfc3444</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3986">[RFC3986]</dt>
        <dd>
<span class="refAuthor">Berners-Lee, T.</span>, <span class="refAuthor">Fielding, R.</span>, and <span class="refAuthor">L. Masinter</span>, <span class="refTitle">"Uniform Resource Identifier (URI): Generic Syntax"</span>, <span class="seriesInfo">STD 66</span>, <span class="seriesInfo">RFC 3986</span>, <span class="seriesInfo">DOI 10.17487/RFC3986</span>, <time class="refDate" datetime="2005-01">January 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3986">https://www.rfc-editor.org/info/rfc3986</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="STRIDE">[STRIDE]</dt>
      <dd>
<span class="refAuthor">Microsoft</span>, <span class="refTitle">"The STRIDE Threat Model"</span>, <time class="refDate" datetime="2009-11">November 2009</time>, <span>&lt;<a href="https://docs.microsoft.com/en-us/previous-versions/commerce-server/ee823878(v=cs.20)">https://docs.microsoft.com/en-us/previous-versions/commerce-server/ee823878(v=cs.20)</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="acknowledgements">
<section id="appendix-A">
      <h2 id="name-acknowledgements">
<a class="section-name selfRef" href="#name-acknowledgements">Acknowledgements</a>
      </h2>
<p id="appendix-A-1">We would like to thank our working group chairs -- <span class="contact-name">Dave Thaler</span>, <span class="contact-name">Russ Housley</span>, and <span class="contact-name">David Waltermire</span> -- for their review comments and their support.<a class="pilcrow" href="#appendix-A-1">¶</a></p>
<p id="appendix-A-2">We would like to thank the participants of the 2018 Berlin Software Updates for Internet of Things (SUIT) Hackathon and the June 2018 virtual design team meetings for their discussion input.<a class="pilcrow" href="#appendix-A-2">¶</a></p>
<p id="appendix-A-3">In particular, we would like to thank <span class="contact-name">Koen Zandberg</span>, <span class="contact-name">Emmanuel Baccelli</span>, <span class="contact-name">Carsten Bormann</span>, <span class="contact-name">David Brown</span>, <span class="contact-name">Markus Gueller</span>, <span class="contact-name">Frank Audun Kvamtrø</span>, <span class="contact-name">Øyvind Rønningstad</span>, <span class="contact-name">Michael Richardson</span>, <span class="contact-name">Jan-Frederik Rieckers</span>, <span class="contact-name">Francisco Acosta</span>, <span class="contact-name">Anton Gerasimov</span>, 
<span class="contact-name">Matthias Wählisch</span>, <span class="contact-name">Max Gröning</span>, <span class="contact-name">Daniel Petry</span>, <span class="contact-name">Gaëtan Harter</span>, <span class="contact-name">Ralph Hamm</span>, <span class="contact-name">Steve Patrick</span>, <span class="contact-name">Fabio Utzig</span>, <span class="contact-name">Paul Lambert</span>, <span class="contact-name">Saïd Gharout</span>, and <span class="contact-name">Milen Stoychev</span>.<a class="pilcrow" href="#appendix-A-3">¶</a></p>
<p id="appendix-A-4">We would like to thank those who contributed to the development of this information model. In particular, we would like to thank <span class="contact-name">Milosch Meriac</span>, <span class="contact-name">Jean-Luc Giraud</span>, <span class="contact-name">Dan Ros</span>, <span class="contact-name">Amyas Phillips</span>, and <span class="contact-name">Gary Thomson</span>.<a class="pilcrow" href="#appendix-A-4">¶</a></p>
<p id="appendix-A-5">Finally, we would like to thank the following IESG members for their review feedback: <span class="contact-name">Erik Kline</span>, <span class="contact-name">Murray Kucherawy</span>, <span class="contact-name">Barry Leiba</span>, <span class="contact-name">Alissa Cooper</span>, <span class="contact-name">Stephen Farrell</span>, and <span class="contact-name">Benjamin Kaduk</span>.<a class="pilcrow" href="#appendix-A-5">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a class="section-name selfRef" href="#name-authors-addresses">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Brendan Moran</span></div>
<div class="left" dir="auto"><span class="org">Arm Limited</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:Brendan.Moran@arm.com">Brendan.Moran@arm.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Hannes Tschofenig</span></div>
<div class="left" dir="auto"><span class="org">Arm Limited</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:hannes.tschofenig@gmx.net">hannes.tschofenig@gmx.net</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Henk Birkholz</span></div>
<div class="left" dir="auto"><span class="org">Fraunhofer SIT</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:henk.birkholz@sit.fraunhofer.de">henk.birkholz@sit.fraunhofer.de</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>