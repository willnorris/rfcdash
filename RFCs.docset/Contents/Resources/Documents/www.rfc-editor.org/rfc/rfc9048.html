<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 9048: Improved Extensible Authentication Protocol Method for 3GPP Mobile Network Authentication and Key Agreement (EAP-AKA')</title>
<meta content="Jari Arkko" name="author"/>
<meta content="Vesa Lehtovirta" name="author"/>
<meta content="Vesa Torvinen" name="author"/>
<meta content="Pasi Eronen" name="author"/>
<meta content="
       The 3GPP mobile network Authentication and Key Agreement (AKA) 
  is an authentication mechanism for devices wishing to
  access mobile networks. RFC 4187 (EAP-AKA) made the use of this mechanism
  possible within the Extensible Authentication Protocol (EAP)
  framework. RFC 5448 (EAP-AKA') was an improved version of EAP-AKA. 
       This document is the most recent specification of EAP-AKA',
  including, for instance, details about and references related to 
  operating EAP-AKA' in 5G networks.  
       EAP-AKA' differs from EAP-AKA by providing a key derivation
  function that binds the keys derived within the method to the name
  of the access network. The key derivation function has been defined
  in the 3rd Generation Partnership Project (3GPP). EAP-AKA' allows
  its use in EAP in an interoperable manner. EAP-AKA' also
  updates the algorithm used in hash functions, as it employs SHA-256 / HMAC-SHA-256 instead of
  SHA-1 / HMAC-SHA-1, which is used in EAP-AKA. 
       This version of the EAP-AKA' specification defines the protocol
  behavior for both 4G and 5G deployments, whereas the previous
  version defined protocol behavior for 4G deployments only.
  While EAP-AKA' as defined in RFC 5448 is not obsolete, this document 
  defines the most recent and fully backwards-compatible specification 
  of EAP-AKA'. This document updates both RFCs 4187 and 5448. 
    " name="description"/>
<meta content="xml2rfc 3.10.0" name="generator"/>
<meta content="EAP" name="keyword"/>
<meta content="AKA" name="keyword"/>
<meta content="AKA'" name="keyword"/>
<meta content="3GPP" name="keyword"/>
<meta content="9048" name="rfc.number"/>
<!-- Generator version information:
  xml2rfc 3.10.0
    Python 3.6.13
    appdirs 1.4.4
    ConfigArgParse 1.4.1
    google-i18n-address 2.4.0
    html5lib 1.0.1
    intervaltree 3.0.2
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.4.2
    pycairo 1.15.1
    pycountry 19.8.18
    pyflakes 2.1.1
    PyYAML 5.4.1
    requests 2.24.0
    setuptools 40.5.0
    six 1.14.0
    WeasyPrint 52.5
-->
<link href="rfc9048.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://dx.doi.org/10.17487/rfc9048" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <link href="https://datatracker.ietf.org/doc/draft-ietf-emu-rfc5448bis-10" rel="prev"/>
  </head>
<body>
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9048</td>
<td class="center">EAP-AKA'</td>
<td class="right">October 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Arkko, et al.</td>
<td class="center">Informational</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc9048">9048</a></dd>
<dt class="label-updates">Updates:</dt>
<dd class="updates">
<a class="eref" href="https://www.rfc-editor.org/rfc/rfc4187">4187</a>, <a class="eref" href="https://www.rfc-editor.org/rfc/rfc5448">5448</a> </dd>
<dt class="label-category">Category:</dt>
<dd class="category">Informational</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2021-10">October 2021</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">J. Arkko</div>
<div class="org">Ericsson</div>
</div>
<div class="author">
      <div class="author-name">V. Lehtovirta</div>
<div class="org">Ericsson</div>
</div>
<div class="author">
      <div class="author-name">V. Torvinen</div>
<div class="org">Ericsson</div>
</div>
<div class="author">
      <div class="author-name">P. Eronen</div>
<div class="org">Independent</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9048</h1>
<h1 id="title">Improved Extensible Authentication Protocol Method for 3GPP Mobile Network Authentication and Key Agreement (EAP-AKA')</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">The 3GPP mobile network Authentication and Key Agreement (AKA) 
  is an authentication mechanism for devices wishing to
  access mobile networks. RFC 4187 (EAP-AKA) made the use of this mechanism
  possible within the Extensible Authentication Protocol (EAP)
  framework. RFC 5448 (EAP-AKA') was an improved version of EAP-AKA.<a class="pilcrow" href="#section-abstract-1">¶</a></p>
<p id="section-abstract-2">This document is the most recent specification of EAP-AKA',
  including, for instance, details about and references related to 
  operating EAP-AKA' in 5G networks.<a class="pilcrow" href="#section-abstract-2">¶</a></p>
<p id="section-abstract-3">EAP-AKA' differs from EAP-AKA by providing a key derivation
  function that binds the keys derived within the method to the name
  of the access network. The key derivation function has been defined
  in the 3rd Generation Partnership Project (3GPP). EAP-AKA' allows
  its use in EAP in an interoperable manner. EAP-AKA' also
  updates the algorithm used in hash functions, as it employs SHA-256 / HMAC-SHA-256 instead of
  SHA-1 / HMAC-SHA-1, which is used in EAP-AKA.<a class="pilcrow" href="#section-abstract-3">¶</a></p>
<p id="section-abstract-4">This version of the EAP-AKA' specification defines the protocol
  behavior for both 4G and 5G deployments, whereas the previous
  version defined protocol behavior for 4G deployments only.
  While EAP-AKA' as defined in RFC 5448 is not obsolete, this document 
  defines the most recent and fully backwards-compatible specification 
  of EAP-AKA'. This document updates both RFCs 4187 and 5448.<a class="pilcrow" href="#section-abstract-4">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This document is not an Internet Standards Track specification; it is
            published for informational purposes.<a class="pilcrow" href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by the
            Internet Engineering Steering Group (IESG).  Not all documents
            approved by the IESG are candidates for any level of Internet
            Standard; see Section 2 of RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9048">https://www.rfc-editor.org/info/rfc9048</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">▲</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p class="keepWithNext" id="section-toc.1-1.1.1"><a class="xref" href="#section-1">1</a>.  <a class="xref" href="#name-introduction">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p class="keepWithNext" id="section-toc.1-1.2.1"><a class="xref" href="#section-2">2</a>.  <a class="xref" href="#name-requirements-language">Requirements Language</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a class="xref" href="#section-3">3</a>.  <a class="xref" href="#name-eap-aka">EAP-AKA'</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p class="keepWithNext" id="section-toc.1-1.3.2.1.1"><a class="xref" href="#section-3.1">3.1</a>.  <a class="xref" href="#name-at_kdf_input">AT_KDF_INPUT</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a class="xref" href="#section-3.2">3.2</a>.  <a class="xref" href="#name-at_kdf">AT_KDF</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a class="xref" href="#section-3.3">3.3</a>.  <a class="xref" href="#name-key-derivation">Key Derivation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a class="xref" href="#section-3.4">3.4</a>.  <a class="xref" href="#name-hash-functions">Hash Functions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.1">
                    <p id="section-toc.1-1.3.2.4.2.1.1"><a class="xref" href="#section-3.4.1">3.4.1</a>.  <a class="xref" href="#name-prf">PRF'</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.2">
                    <p id="section-toc.1-1.3.2.4.2.2.1"><a class="xref" href="#section-3.4.2">3.4.2</a>.  <a class="xref" href="#name-at_mac">AT_MAC</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.3">
                    <p id="section-toc.1-1.3.2.4.2.3.1"><a class="xref" href="#section-3.4.3">3.4.3</a>.  <a class="xref" href="#name-at_checkcode">AT_CHECKCODE</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a class="xref" href="#section-3.5">3.5</a>.  <a class="xref" href="#name-summary-of-attributes-for-e">Summary of Attributes for EAP-AKA'</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="xref" href="#section-4">4</a>.  <a class="xref" href="#name-bidding-down-prevention-for">Bidding Down Prevention for EAP-AKA</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a class="xref" href="#section-4.1">4.1</a>.  <a class="xref" href="#name-summary-of-attributes-for-ea">Summary of Attributes for EAP-AKA</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="xref" href="#section-5">5</a>.  <a class="xref" href="#name-peer-identities">Peer Identities</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a class="xref" href="#section-5.1">5.1</a>.  <a class="xref" href="#name-username-types-in-eap-aka-i">Username Types in EAP-AKA' Identities</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a class="xref" href="#section-5.2">5.2</a>.  <a class="xref" href="#name-generating-pseudonyms-and-f">Generating Pseudonyms and Fast Re-Authentication Identities</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a class="xref" href="#section-5.3">5.3</a>.  <a class="xref" href="#name-identifier-usage-in-5g">Identifier Usage in 5G</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.1">
                    <p id="section-toc.1-1.5.2.3.2.1.1"><a class="xref" href="#section-5.3.1">5.3.1</a>.  <a class="xref" href="#name-key-derivation-2">Key Derivation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.2">
                    <p id="section-toc.1-1.5.2.3.2.2.1"><a class="xref" href="#section-5.3.2">5.3.2</a>.  <a class="xref" href="#name-eap-identity-response-and-e">EAP Identity Response and EAP-AKA' AT_IDENTITY Attribute</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="xref" href="#section-6">6</a>.  <a class="xref" href="#name-exported-parameters">Exported Parameters</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="xref" href="#section-7">7</a>.  <a class="xref" href="#name-security-considerations">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a class="xref" href="#section-7.1">7.1</a>.  <a class="xref" href="#name-privacy">Privacy</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a class="xref" href="#section-7.2">7.2</a>.  <a class="xref" href="#name-discovered-vulnerabilities">Discovered Vulnerabilities</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a class="xref" href="#section-7.3">7.3</a>.  <a class="xref" href="#name-pervasive-monitoring">Pervasive Monitoring</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a class="xref" href="#section-7.4">7.4</a>.  <a class="xref" href="#name-security-properties-of-bind">Security Properties of Binding Network Names</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="xref" href="#section-8">8</a>.  <a class="xref" href="#name-iana-considerations">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a class="xref" href="#section-8.1">8.1</a>.  <a class="xref" href="#name-type-value">Type Value</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a class="xref" href="#section-8.2">8.2</a>.  <a class="xref" href="#name-attribute-type-values">Attribute Type Values</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a class="xref" href="#section-8.3">8.3</a>.  <a class="xref" href="#name-key-derivation-function-nam">Key Derivation Function Namespace</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="xref" href="#section-9">9</a>.  <a class="xref" href="#name-references">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a class="xref" href="#section-9.1">9.1</a>.  <a class="xref" href="#name-normative-references">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a class="xref" href="#section-9.2">9.2</a>.  <a class="xref" href="#name-informative-references">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a class="xref" href="#appendix-A">Appendix A</a>.  <a class="xref" href="#name-changes-from-rfc-5448">Changes from RFC 5448</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a class="xref" href="#appendix-B">Appendix B</a>.  <a class="xref" href="#name-changes-to-rfc-4187">Changes to RFC 4187</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a class="xref" href="#appendix-C">Appendix C</a>.  <a class="xref" href="#name-importance-of-explicit-nego">Importance of Explicit Negotiation</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a class="xref" href="#appendix-D">Appendix D</a>.  <a class="xref" href="#name-test-vectors">Test Vectors</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a class="xref" href="#appendix-E"></a><a class="xref" href="#name-acknowledgments">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a class="xref" href="#appendix-F"></a><a class="xref" href="#name-contributors">Contributors</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a class="xref" href="#appendix-G"></a><a class="xref" href="#name-authors-addresses">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">The 3GPP mobile network Authentication and Key Agreement (AKA) is
  an authentication mechanism for devices wishing to access mobile
  networks. <span>[<a class="xref" href="#RFC4187">RFC4187</a>]</span> (EAP-AKA) made the use of this mechanism
  possible within the Extensible Authentication Protocol (EAP)
  framework <span>[<a class="xref" href="#RFC3748">RFC3748</a>]</span>.<a class="pilcrow" href="#section-1-1">¶</a></p>
<p id="section-1-2">EAP-AKA' is an improved version of
  EAP-AKA. EAP-AKA' was defined in RFC 5448 <span>[<a class="xref" href="#RFC5448">RFC5448</a>]</span>, and it updated EAP-AKA 
  <span>[<a class="xref" href="#RFC4187">RFC4187</a>]</span>.<a class="pilcrow" href="#section-1-2">¶</a></p>
<p id="section-1-3">This document is the most recent specification of EAP-AKA',
  including, for instance, details about and references related to 
  operating EAP-AKA' in 5G networks. This document does not obsolete RFC 5448; however, this document is the
  most recent and fully backwards-compatible specification.<a class="pilcrow" href="#section-1-3">¶</a></p>
<p id="section-1-4">EAP-AKA' is commonly implemented in mobile phones and network
  equipment. It can be used for authentication to gain network access via
  Wireless LAN networks and, with 5G, also directly to mobile
  networks.<a class="pilcrow" href="#section-1-4">¶</a></p>
<p id="section-1-5">EAP-AKA' differs from EAP-AKA by providing a different key
  derivation function. This function binds the keys derived within the
  method to the name of the access network. This limits the effects of
  compromised access network nodes and keys. EAP-AKA' also updates
  the algorithm used for hash functions.<a class="pilcrow" href="#section-1-5">¶</a></p>
<p id="section-1-6">The EAP-AKA' method employs the derived keys CK' and IK' from the
  3GPP specification <span>[<a class="xref" href="#TS-3GPP.33.402">TS-3GPP.33.402</a>]</span> and updates the
  hash function that is used to SHA-256 <span>[<a class="xref" href="#FIPS.180-4">FIPS.180-4</a>]</span> and HMAC
  to HMAC-SHA-256. Otherwise, EAP-AKA' is equivalent to EAP-AKA. Given
  that a different EAP method Type value is used for EAP-AKA and
  EAP-AKA', a mutually supported method may be negotiated using the
  standard mechanisms in EAP <span>[<a class="xref" href="#RFC3748">RFC3748</a>]</span>.<a class="pilcrow" href="#section-1-6">¶</a></p>
<p id="section-1-7" style="margin-left: 3.0em">Note that any change of the key derivation must be unambiguous
    to both sides in the protocol. That is, it must not be possible to
    accidentally connect old equipment to new equipment and get the
    key derivation wrong or to attempt to use incorrect keys without getting
    a proper error message. See <a class="xref" href="#baddesign">Appendix C</a> for further
    information.<a class="pilcrow" href="#section-1-7">¶</a></p>
<p id="section-1-8" style="margin-left: 3.0em">Note also that choices in authentication protocols should be
    secure against bidding down attacks that attempt to force the
    participants to use the least secure function. See <a class="xref" href="#bidding">Section 4</a> for further information.<a class="pilcrow" href="#section-1-8">¶</a></p>
<p id="section-1-9">This specification makes the following changes from RFC 5448:<a class="pilcrow" href="#section-1-9">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-10.1">Updates the reference that specifies how the Network Name field is
    constructed in the protocol. This update ensures that EAP-AKA' is
    compatible with 5G deployments. RFC 5448 referred to the Release 8
    version of <span>[<a class="xref" href="#TS-3GPP.24.302">TS-3GPP.24.302</a>]</span>. This document points
    to the first 5G version, Release 16.<a class="pilcrow" href="#section-1-10.1">¶</a>
</li>
        <li class="normal" id="section-1-10.2">Specifies how EAP and EAP-AKA' use identifiers in 5G. Additional
    identifiers are introduced in 5G, and for interoperability, it is
    necessary that the right identifiers are used as inputs in the key
    derivation.  In addition, for identity privacy it is important that
    when privacy-friendly identifiers in 5G are used, no trackable, permanent
    identifiers are passed in EAP-AKA', either.<a class="pilcrow" href="#section-1-10.2">¶</a>
</li>
        <li class="normal" id="section-1-10.3">Specifies session identifiers and other exported parameters, as
    those were not specified in <span>[<a class="xref" href="#RFC5448">RFC5448</a>]</span> despite
    requirements set forward in <span>[<a class="xref" href="#RFC5247">RFC5247</a>]</span> to do so.
    Also, while <span>[<a class="xref" href="#RFC5247">RFC5247</a>]</span> specified session identifiers
    for EAP-AKA, it only did so for the full authentication case, not
    for the case of fast re-authentication.<a class="pilcrow" href="#section-1-10.3">¶</a>
</li>
        <li class="normal" id="section-1-10.4">Updates the requirements on generating pseudonym usernames and
    fast re-authentication identities to ensure identity privacy.<a class="pilcrow" href="#section-1-10.4">¶</a>
</li>
        <li class="normal" id="section-1-10.5">Describes what has been learned about any vulnerabilities
    in AKA or EAP-AKA'.<a class="pilcrow" href="#section-1-10.5">¶</a>
</li>
        <li class="normal" id="section-1-10.6">Describes the privacy and pervasive monitoring considerations
    related to EAP-AKA'.<a class="pilcrow" href="#section-1-10.6">¶</a>
</li>
        <li class="normal" id="section-1-10.7">Adds summaries of the attributes.<a class="pilcrow" href="#section-1-10.7">¶</a>
</li>
      </ul>
<p id="section-1-11">Some of the updates are small. For instance, 
  the reference update to <span>[<a class="xref" href="#TS-3GPP.24.302">TS-3GPP.24.302</a>]</span> does not change the 3GPP specification number,
  only the version. But this reference is crucial for the correct calculation
  of the keys that result from running the EAP-AKA' method, so an
  RFC update pointing to the newest version was warranted.<a class="pilcrow" href="#section-1-11">¶</a></p>
<p id="section-1-12" style="margin-left: 3.0em">Note: Any further updates in 3GPP specifications that affect,
    for instance, key derivation is something that EAP-AKA'
    implementations need to take into account. Upon such updates, there
    will be a need to update both this specification and the
    implementations.<a class="pilcrow" href="#section-1-12">¶</a></p>
<p id="section-1-13">It is an explicit non-goal of this specification to include any other
  technical modifications, addition of new features, or other
  changes. The EAP-AKA' base protocol is stable and needs to stay that
  way. If there are any extensions or variants, those need to be
  proposed as standalone extensions or even as different authentication
  methods.<a class="pilcrow" href="#section-1-13">¶</a></p>
<p id="section-1-14">The rest of this specification is structured as follows. <a class="xref" href="#prime">Section 3</a> defines the EAP-AKA' method. <a class="xref" href="#bidding">Section 4</a> adds support to EAP-AKA to prevent bidding down
  attacks from EAP-AKA'. <a class="xref" href="#identities">Section 5</a> specifies
  requirements regarding the use of peer identities, including how
  5G identifiers are used in the EAP-AKA' context. <a class="xref" href="#exported-parameters">Section 6</a> specifies which parameters EAP-AKA'
  exports out of the method.
  <a class="xref" href="#security">Section 7</a>
  explains the security differences between EAP-AKA and EAP-AKA'. <a class="xref" href="#iana">Section 8</a> describes the IANA considerations, and <a class="xref" href="#diff2">Appendix A</a> and <a class="xref" href="#diff">Appendix B</a> explain the updates to
  RFC 5448 (EAP-AKA') and RFC 4187 (EAP-AKA) that have been made in this
  specification. <a class="xref" href="#baddesign">Appendix C</a> explains some of the design
  rationale for creating EAP-AKA'. Finally, <a class="xref" href="#testvectors">Appendix D</a>
  provides test vectors.<a class="pilcrow" href="#section-1-14">¶</a></p>
</section>
<section id="section-2">
      <h2 id="name-requirements-language">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-requirements-language">Requirements Language</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>",
"<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>", "<span class="bcp14">MAY</span>", and
"<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as described in BCP 14 <span>[<a class="xref" href="#RFC2119">RFC2119</a>]</span> <span>[<a class="xref" href="#RFC8174">RFC8174</a>]</span> when, and only
when, they appear in all capitals, as shown here.<a class="pilcrow" href="#section-2-1">¶</a></p>
</section>
<div id="prime">
<section id="section-3">
      <h2 id="name-eap-aka">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-eap-aka">EAP-AKA'</a>
      </h2>
<p id="section-3-1">EAP-AKA' is an EAP method that follows the EAP-AKA specification
<span>[<a class="xref" href="#RFC4187">RFC4187</a>]</span> in all respects except the following:<a class="pilcrow" href="#section-3-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-2.1">It uses the Type code 0x32, not 0x17 (which is used by
EAP-AKA).<a class="pilcrow" href="#section-3-2.1">¶</a>
</li>
        <li class="normal" id="section-3-2.2">It carries the AT_KDF_INPUT attribute, as defined in
<a class="xref" href="#netbind">Section 3.1</a>, to ensure that both the peer and server know
the name of the access network.<a class="pilcrow" href="#section-3-2.2">¶</a>
</li>
        <li class="normal" id="section-3-2.3">It supports key derivation function negotiation via the AT_KDF
attribute (<a class="xref" href="#keyderiv">Section 3.2</a>) to allow for future
extensions.<a class="pilcrow" href="#section-3-2.3">¶</a>
</li>
        <li class="normal" id="section-3-2.4">It calculates keys as defined in <a class="xref" href="#key">Section 3.3</a>, not as
defined in EAP-AKA.<a class="pilcrow" href="#section-3-2.4">¶</a>
</li>
        <li class="normal" id="section-3-2.5">It employs SHA-256 / HMAC-SHA-256 <span>[<a class="xref" href="#FIPS.180-4">FIPS.180-4</a>]</span>, not SHA-1 / HMAC-SHA-1 <span>[<a class="xref" href="#RFC2104">RFC2104</a>]</span> (see <a class="xref" href="#hashup">Section 3.4</a>).<a class="pilcrow" href="#section-3-2.5">¶</a>
</li>
      </ul>
<p id="section-3-3"><a class="xref" href="#EAP-fig">Figure 1</a> shows an example of the authentication process. Each
message AKA'-Challenge and so on represents the corresponding message
from EAP-AKA, but with the EAP-AKA' Type code. The definition of these
messages, along with the definition of attributes AT_RAND, AT_AUTN,
AT_MAC, and AT_RES can be found in <span>[<a class="xref" href="#RFC4187">RFC4187</a>]</span>.<a class="pilcrow" href="#section-3-3">¶</a></p>
<span id="name-eap-aka-authentication-proc"></span><div id="EAP-fig">
<figure id="figure-1">
        <div class="alignLeft art-text artwork" id="section-3-4.1">
<pre> Peer                                                    Server
    |                       EAP-Request/Identity             |
    |&lt;-------------------------------------------------------|
    |                                                        |
    |  EAP-Response/Identity                                 |
    |  (Includes user's Network Access Identifier, NAI)      |
    |-------------------------------------------------------&gt;|
    |         +--------------------------------------------------+
    |         | Server determines the network name and ensures   |
    |         | that the given access network is authorized to   |
    |         | use the claimed name.  The server then runs the  |
    |         | AKA' algorithms generating RAND and AUTN, and    |
    |         | derives session keys from CK' and IK'.  RAND and |
    |         | AUTN are sent as AT_RAND and AT_AUTN attributes, |
    |         | whereas the network name is transported in the   |
    |         | AT_KDF_INPUT attribute.  AT_KDF signals the used |
    |         | key derivation function.  The session keys are   |
    |         | used in creating the AT_MAC attribute.           |
    |         +--------------------------------------------------+
    |                         EAP-Request/AKA'-Challenge     |
    |        (AT_RAND, AT_AUTN, AT_KDF, AT_KDF_INPUT, AT_MAC)|
    |&lt;-------------------------------------------------------|
+------------------------------------------------------+     |
| The peer determines what the network name should be, |     |
| based on, e.g., what access technology it is using.  |     |
| The peer also retrieves the network name sent by     |     |
| the network from the AT_KDF_INPUT attribute.  The    |     |
| two names are compared for discrepancies, and if     |     |
| necessary, the authentication is aborted.  Otherwise,|     |
| the network name from AT_KDF_INPUT attribute is      |     |
| used in running the AKA' algorithms, verifying AUTN  |     |
| from AT_AUTN and MAC from AT_MAC attributes.  The    |     |
| peer then generates RES.  The peer also derives      |     |
| session keys from CK'/IK'.  The AT_RES and AT_MAC    |     |
| attributes are constructed.                          |     |
+------------------------------------------------------+     |
    | EAP-Response/AKA'-Challenge                            |
    | (AT_RES, AT_MAC)                                       |
    |-------------------------------------------------------&gt;|
    |         +--------------------------------------------------+
    |         | Server checks the RES and MAC values received    |
    |         | in AT_RES and AT_MAC, respectively.  Success     |
    |         | requires both to be found correct.               |
    |         +--------------------------------------------------+
    |                                           EAP-Success  |
    |&lt;-------------------------------------------------------|
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-1">Figure 1</a>:
<a class="selfRef" href="#name-eap-aka-authentication-proc">EAP-AKA' Authentication Process</a>
        </figcaption></figure>
</div>
<p id="section-3-5">EAP-AKA' can operate on the same credentials as EAP-AKA and
   employ the same identities.  However, EAP-AKA' employs different
   leading characters than EAP-AKA for the conventions given in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc4187#section-4.1.1">Section 4.1.1</a> of [<a class="xref" href="#RFC4187">RFC4187</a>]</span> for usernames based on International Mobile
   Subscriber Identifier (IMSI).  For 4G networks, EAP-AKA' <span class="bcp14">MUST</span> use
   the leading character "6" (ASCII 36 hexadecimal) instead of "0" for
   IMSI-based permanent usernames.
   For 5G networks, the leading character "6" is not used for IMSI-based permanent usernames.
   Identifier usage in 5G is specified in <a class="xref" href="#identifiersin5g">Section 5.3</a>. All
   other usage and processing of the leading characters, usernames,
   and identities is as defined by EAP-AKA <span>[<a class="xref" href="#RFC4187">RFC4187</a>]</span>.
   For instance, the pseudonym and fast re-authentication usernames
   need to be constructed so that the server can recognize them.  As
   an example, a pseudonym could begin with a leading "7" character
   (ASCII 37 hexadecimal) and a fast re-authentication username could
   begin with "8" (ASCII 38 hexadecimal).  Note that a server that
   implements only EAP-AKA may not recognize these leading characters.
   According to <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc4187#section-4.1.4">Section 4.1.4</a> of [<a class="xref" href="#RFC4187">RFC4187</a>]</span>, such a
   server will re-request the identity via the EAP-Request/AKA-Identity 
   message, making obvious to the peer that
   EAP-AKA and associated identity are expected.<a class="pilcrow" href="#section-3-5">¶</a></p>
<div id="netbind">
<section id="section-3.1">
        <h3 id="name-at_kdf_input">
<a class="section-number selfRef" href="#section-3.1">3.1. </a><a class="section-name selfRef" href="#name-at_kdf_input">AT_KDF_INPUT</a>
        </h3>
<p id="section-3.1-1">The format of the AT_KDF_INPUT attribute is shown below.<a class="pilcrow" href="#section-3.1-1">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.1-2">
<pre>    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   | AT_KDF_INPUT  | Length        | Actual Network Name Length    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   .                        Network Name                           .
   .                                                               .
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a class="pilcrow" href="#section-3.1-2">¶</a>
</div>
<p id="section-3.1-3">The fields are as follows:<a class="pilcrow" href="#section-3.1-3">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-3.1-4">
          <dt id="section-3.1-4.1">AT_KDF_INPUT</dt>
          <dd id="section-3.1-4.2" style="margin-left: 1.5em">This is set to 23.<a class="pilcrow" href="#section-3.1-4.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-4.3">Length</dt>
          <dd id="section-3.1-4.4" style="margin-left: 1.5em">The length of the
attribute, calculated as defined in <span>[<a class="xref" href="#RFC4187">RFC4187</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc4187#section-8.1">Section 8.1</a></span>.<a class="pilcrow" href="#section-3.1-4.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-4.5">Actual Network Name Length</dt>
          <dd id="section-3.1-4.6" style="margin-left: 1.5em">This is
a 2-byte actual length field, needed due to the requirement that
the previous field is expressed in multiples of 4 bytes per the usual
EAP-AKA rules. The Actual Network Name Length field
provides the length of the network name in bytes.<a class="pilcrow" href="#section-3.1-4.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-4.7">Network Name</dt>
          <dd id="section-3.1-4.8" style="margin-left: 1.5em">This field contains
the network name of the access network for which the authentication is
being performed. The name does not include any terminating null
characters. Because the length of the entire attribute must be a
multiple of 4 bytes, the sender pads the name with 1, 2, or 3
bytes of all zero bits when necessary.<a class="pilcrow" href="#section-3.1-4.8">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-3.1-5">Only the server sends the AT_KDF_INPUT attribute. The value is sent
as specified in <span>[<a class="xref" href="#TS-3GPP.24.302">TS-3GPP.24.302</a>]</span> for both non-3GPP access
networks and for 5G
access networks. Per <span>[<a class="xref" href="#TS-3GPP.33.402">TS-3GPP.33.402</a>]</span>, the server
always verifies the authorization of a given access network to use a
particular name before sending it to the peer over EAP-AKA'. The value
of the AT_KDF_INPUT attribute from the server <span class="bcp14">MUST</span> be non-empty, with
a greater than zero length in the Actual Network  Name Length
field. If the AT_KDF_INPUT attribute
is empty, the peer behaves as if AUTN had been incorrect and
authentication fails. See Section <a class="relref" href="https://www.rfc-editor.org/rfc/rfc4187#section-3">3</a> and Figure 3 of <span>[<a class="xref" href="#RFC4187">RFC4187</a>]</span> for an overview of how authentication failures are
handled.<a class="pilcrow" href="#section-3.1-5">¶</a></p>
<p id="section-3.1-6">In addition, the peer <span class="bcp14">MAY</span> check the received value against its own
understanding of the network name. Upon detecting a discrepancy, the
peer either warns the user and continues, or fails the authentication
process. More specifically, the peer <span class="bcp14">SHOULD</span> have a configurable policy
that it can follow under these circumstances. If the policy indicates
that it can continue, the peer <span class="bcp14">SHOULD</span> log a warning message or display
it to the user.  If the peer chooses to proceed, it <span class="bcp14">MUST</span> use the
network name as received in the AT_KDF_INPUT attribute.  If the policy
indicates that the authentication should fail, the peer behaves as if
AUTN had been incorrect and authentication fails.<a class="pilcrow" href="#section-3.1-6">¶</a></p>
<p id="section-3.1-7">The Network Name field contains a UTF-8 string. This string <span class="bcp14">MUST</span>
be constructed as specified in <span>[<a class="xref" href="#TS-3GPP.24.302">TS-3GPP.24.302</a>]</span> for
"Access Network Identity". The string is structured as fields
separated by colons (:). The algorithms and mechanisms to construct
the identity string depend on the used access technology.<a class="pilcrow" href="#section-3.1-7">¶</a></p>
<p id="section-3.1-8">On the network side, the network name construction is a
configuration issue in an access network and an authorization check in
the authentication server. On the peer, the network name is
constructed based on the local observations. For instance, the peer
knows which access technology it is using on the link, it can see
information in a link-layer beacon, and so on. The construction rules
specify how this information maps to an access network
name. Typically, the network name consists of the name of the access
technology or the name of the access technology followed by some operator
identifier that was advertised in a link-layer beacon.  In all cases,
<span>[<a class="xref" href="#TS-3GPP.24.302">TS-3GPP.24.302</a>]</span> is the normative specification for the
construction in both the network and peer side. If the peer policy
allows running EAP-AKA' over an access technology for which that
specification does not provide network name construction rules, the
peer <span class="bcp14">SHOULD</span> rely only on the information from the AT_KDF_INPUT
attribute and not perform a comparison.<a class="pilcrow" href="#section-3.1-8">¶</a></p>
<p id="section-3.1-9">If a comparison of the locally determined network name and the one
received over EAP-AKA' is performed on the peer, it <span class="bcp14">MUST</span> be done as
follows. First, each name is broken down to the fields separated by
colons. If one of the names has more colons and fields than the other
one, the additional fields are ignored. The remaining sequences of
fields are compared, and they match only if they are equal character
by character. This algorithm allows a prefix match where the peer
would be able to match "", "FOO", and "FOO:BAR" against the value
"FOO:BAR" received from the server. This capability is important in
order to allow possible updates to the specifications that dictate how
the network names are constructed. For instance, if a peer knows that
it is running on access technology "FOO", it can use the string "FOO"
even if the server uses an additional, more accurate description, e.g.,
"FOO:BAR", that contains more information.<a class="pilcrow" href="#section-3.1-9">¶</a></p>
<p id="section-3.1-10">The allocation procedures in <span>[<a class="xref" href="#TS-3GPP.24.302">TS-3GPP.24.302</a>]</span> ensure
that conflicts potentially arising from using the same name in
different types of networks are avoided. The specification also has
detailed rules about how a client can determine these based on
information available to the client, such as the type of protocol used
to attach to the network, beacons sent out by the network, and so
on. Information that the client cannot directly observe (such as the
type or version of the home network) is not used by this
algorithm.<a class="pilcrow" href="#section-3.1-10">¶</a></p>
<p id="section-3.1-11">The AT_KDF_INPUT attribute <span class="bcp14">MUST</span> be sent and processed as explained
above when AT_KDF attribute has the value 1. Future definitions of new
AT_KDF values <span class="bcp14">MUST</span> define how this attribute is sent and
processed.<a class="pilcrow" href="#section-3.1-11">¶</a></p>
</section>
</div>
<div id="keyderiv">
<section id="section-3.2">
        <h3 id="name-at_kdf">
<a class="section-number selfRef" href="#section-3.2">3.2. </a><a class="section-name selfRef" href="#name-at_kdf">AT_KDF</a>
        </h3>
<p id="section-3.2-1">AT_KDF is an attribute that the server uses to reference a specific
key derivation function. It offers a negotiation capability that can
be useful for future evolution of the key derivation functions.<a class="pilcrow" href="#section-3.2-1">¶</a></p>
<p id="section-3.2-2">The format of the AT_KDF attribute is shown below.<a class="pilcrow" href="#section-3.2-2">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2-3">
<pre>    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   | AT_KDF        | Length        |    Key Derivation Function    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a class="pilcrow" href="#section-3.2-3">¶</a>
</div>
<p id="section-3.2-4">The fields are as follows:<a class="pilcrow" href="#section-3.2-4">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-3.2-5">
          <dt id="section-3.2-5.1">AT_KDF</dt>
          <dd id="section-3.2-5.2" style="margin-left: 1.5em">This is set to 24.<a class="pilcrow" href="#section-3.2-5.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.2-5.3">Length</dt>
          <dd id="section-3.2-5.4" style="margin-left: 1.5em">The length of the
attribute, calculated as defined in <span>[<a class="xref" href="#RFC4187">RFC4187</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc4187#section-8.1">Section 8.1</a></span>. 
For AT_KDF, the Length field <span class="bcp14">MUST</span> be set to 1.<a class="pilcrow" href="#section-3.2-5.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.2-5.5">Key Derivation Function</dt>
          <dd id="section-3.2-5.6" style="margin-left: 1.5em">An
enumerated value representing the key derivation function that the
server (or peer) wishes to use. Value 1 represents the default key
derivation function for EAP-AKA', i.e., employing CK' and IK' as
defined in <a class="xref" href="#key">Section 3.3</a>.<a class="pilcrow" href="#section-3.2-5.6">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-3.2-6">Servers <span class="bcp14">MUST</span> send one or more AT_KDF attributes in the
EAP-Request/AKA'-Challenge message. These attributes represent the
desired functions ordered by preference, the most preferred function
being the first attribute.<a class="pilcrow" href="#section-3.2-6">¶</a></p>
<p id="section-3.2-7">Upon receiving a set of these attributes, if the peer supports and
is willing to use the key derivation function indicated by the first
attribute, the function is taken into use without any further
negotiation.  However, if the peer does not support this function or
is unwilling to use it, it does not process the received
EAP-Request/AKA'-Challenge in
any way except by responding with the EAP-Response/AKA'-Challenge
message that contains only one attribute,
AT_KDF with the value set to the selected alternative.  If there is no
suitable alternative, the peer behaves as if AUTN had been incorrect
and authentication fails (see Figure 3 of
<span>[<a class="xref" href="#RFC4187">RFC4187</a>]</span>). The peer fails the authentication also if
there are any duplicate values within the list of AT_KDF attributes
(except where the duplication is due to a request to change the key
derivation function; see below for further information).<a class="pilcrow" href="#section-3.2-7">¶</a></p>
<p id="section-3.2-8">Upon receiving an EAP-Response/AKA'-Challenge with AT_KDF from the
peer, the server checks that the suggested AT_KDF value was one of the
alternatives in its offer. The first AT_KDF value in the message from
the server is not a valid alternative since the peer should have accepted it without further negotiation. If the peer has replied with
the first AT_KDF value, the server behaves as if AT_MAC of the
response had been incorrect and fails the authentication. For an
overview of the failed authentication process in the server side, see
Section <a class="relref" href="https://www.rfc-editor.org/rfc/rfc4187#section-3">3</a> and Figure 2 of <span>[<a class="xref" href="#RFC4187">RFC4187</a>]</span>. Otherwise, the
server re-sends the EAP-Response/AKA'-Challenge message, but adds the
selected alternative to the beginning of the list of AT_KDF
attributes and retains the entire list following it. Note that this
means that the selected alternative appears twice in the set of AT_KDF
values. Responding to the peer's request to change the key derivation
function is the only legal situation where such duplication may
occur.<a class="pilcrow" href="#section-3.2-8">¶</a></p>
<p id="section-3.2-9">When the peer receives the new EAP-Request/AKA'-Challenge message,
it <span class="bcp14">MUST</span> check that the requested change, and only the requested
change, occurred in the list of AT_KDF attributes.  If so, it
continues with processing the received EAP-Request/AKA'-Challenge as
specified in <span>[<a class="xref" href="#RFC4187">RFC4187</a>]</span> and <a class="xref" href="#netbind">Section 3.1</a> of
this document.  If not, it behaves as if AT_MAC had been incorrect and
fails the authentication.  If the peer receives multiple
EAP-Request/AKA'-Challenge messages with differing AT_KDF attributes
without having requested negotiation, the peer <span class="bcp14">MUST</span> behave as if
AT_MAC had been incorrect and fail the authentication.<a class="pilcrow" href="#section-3.2-9">¶</a></p>
<p id="section-3.2-10">Note that the peer may also request sequence number
   resynchronization <span>[<a class="xref" href="#RFC4187">RFC4187</a>]</span>. This happens after
   AT_KDF negotiation has already completed.  That is, the
   EAP-Request/AKA'-Challenge and, possibly, the
   EAP-Response/AKA'-Challenge messages are exchanged first to determine 
   a mutually acceptable key derivation function, and only then
   is the possible AKA'-Synchronization-Failure message sent.  The
   AKA'-Synchronization-Failure message is sent as a response to the
   newly received EAP-Request/AKA'-Challenge, which is the last message
   of the AT_KDF negotiation. Note that if the first proposed KDF is
   acceptable, then the first
   EAP-Request/AKA'-Challenge message is also the last message. The
   AKA'-Synchronization-Failure message <span class="bcp14">MUST</span> contain the AUTS
   parameter as specified in <span>[<a class="xref" href="#RFC4187">RFC4187</a>]</span> and a copy the
   AT_KDF attributes as they appeared in the last message of the
   AT_KDF negotiation.  If the AT_KDF attributes are found to differ
   from their earlier values, the peer and server <span class="bcp14">MUST</span> behave as if
   AT_MAC had been incorrect and fail the authentication.<a class="pilcrow" href="#section-3.2-10">¶</a></p>
</section>
</div>
<div id="key">
<section id="section-3.3">
        <h3 id="name-key-derivation">
<a class="section-number selfRef" href="#section-3.3">3.3. </a><a class="section-name selfRef" href="#name-key-derivation">Key Derivation</a>
        </h3>
<p id="section-3.3-1">Both the peer and server <span class="bcp14">MUST</span> derive the keys as follows.<a class="pilcrow" href="#section-3.3-1">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-3.3-2">
          <dt id="section-3.3-2.1">AT_KDF parameter has the value 1</dt>
          <dd id="section-3.3-2.2" style="margin-left: 1.5em">
            <p id="section-3.3-2.2.1">

In this case, MK is derived and used as
follows:<a class="pilcrow" href="#section-3.3-2.2.1">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.3-2.2.2">
<pre>    MK = PRF'(IK'|CK',"EAP-AKA'"|Identity)
    K_encr = MK[0..127]
    K_aut  = MK[128..383]
    K_re   = MK[384..639]
    MSK    = MK[640..1151]
    EMSK   = MK[1152..1663]
</pre><a class="pilcrow" href="#section-3.3-2.2.2">¶</a>
</div>
<p id="section-3.3-2.2.3">Here [n..m] denotes the substring from bit n to m, including
   bits n and m. PRF' is a new
   pseudorandom function specified in <a class="xref" href="#hashup">Section 3.4</a>.  The first 1664 bits
   from its output are used for K_encr (encryption key, 128 bits), K_aut
   (authentication key, 256 bits), K_re (re-authentication key, 256
   bits), MSK (Master Session Key, 512 bits), and EMSK (Extended Master
   Session Key, 512 bits).  These keys are used by the subsequent
   EAP-AKA' process.  K_encr is used by the AT_ENCR_DATA attribute, and
   K_aut by the AT_MAC attribute.  K_re is used later in this section.
   MSK and EMSK are outputs from a successful EAP method run <span>[<a class="xref" href="#RFC3748">RFC3748</a>]</span>.<a class="pilcrow" href="#section-3.3-2.2.3">¶</a></p>
<p id="section-3.3-2.2.4">IK' and CK' are derived as specified in <span>[<a class="xref" href="#TS-3GPP.33.402">TS-3GPP.33.402</a>]</span>.  The functions
   that derive IK' and CK' take the following parameters:  CK and IK
   produced by the AKA algorithm, and value of the Network Name field
   comes from the AT_KDF_INPUT attribute (without length or padding).<a class="pilcrow" href="#section-3.3-2.2.4">¶</a></p>
<p id="section-3.3-2.2.5">The value "EAP-AKA'" is an eight-characters-long ASCII string.  It is
   used as is, without any trailing NUL characters.<a class="pilcrow" href="#section-3.3-2.2.5">¶</a></p>
<p id="section-3.3-2.2.6">Identity is the peer identity as specified in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc4187#section-7">Section 7</a> of [<a class="xref" href="#RFC4187">RFC4187</a>]</span>
   and in <a class="xref" href="#id5guse">Section 5.3.2</a> of in this document for
   the 5G cases.<a class="pilcrow" href="#section-3.3-2.2.6">¶</a></p>
<p id="section-3.3-2.2.7">When the server creates an AKA challenge and corresponding AUTN, CK,
   CK', IK, and IK' values, it <span class="bcp14">MUST</span> set the Authentication Management
   Field (AMF) separation bit to 1 in the AKA algorithm <span>[<a class="xref" href="#TS-3GPP.33.102">TS-3GPP.33.102</a>]</span>.
   Similarly, the peer <span class="bcp14">MUST</span> check that the AMF separation bit is set to
   1.  If the bit is not set to 1, the peer behaves as if the AUTN had
   been incorrect and fails the authentication.<a class="pilcrow" href="#section-3.3-2.2.7">¶</a></p>
<p id="section-3.3-2.2.8">On fast re-authentication, the following keys are calculated:<a class="pilcrow" href="#section-3.3-2.2.8">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.3-2.2.9">
<pre>    MK = PRF'(K_re,"EAP-AKA' re-auth"|Identity|counter|NONCE_S)
    MSK  = MK[0..511]
    EMSK = MK[512..1023]
</pre><a class="pilcrow" href="#section-3.3-2.2.9">¶</a>
</div>
<p id="section-3.3-2.2.10">MSK and EMSK are the resulting 512-bit keys, taking the first 1024
bits from the result of PRF'. Note that K_encr and K_aut are not
re-derived on fast re-authentication. K_re is the re-authentication
key from the preceding full authentication and stays unchanged over
any fast re-authentication(s) that may happen based on it. The value
"EAP-AKA' re-auth" is a sixteen-characters-long ASCII string, again
represented without any trailing NUL characters.  Identity is the fast
re-authentication identity, counter is the value from the AT_COUNTER
attribute, NONCE_S is the nonce value from the AT_NONCE_S attribute,
all as specified in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc4187#section-7">Section 7</a> of [<a class="xref" href="#RFC4187">RFC4187</a>]</span>. To prevent
the use of compromised keys in other places, it is forbidden to change
the network name when going from the full to the fast
re-authentication process. The peer <span class="bcp14">SHOULD NOT</span> attempt fast
re-authentication when it knows that the network name in the current
access network is different from the one in the initial, full
authentication. Upon seeing a re-authentication request with a changed
network name, the server <span class="bcp14">SHOULD</span> behave as if the re-authentication
identifier had been unrecognized, and fall back to full
authentication. The server observes the change in the name by
comparing where the fast re-authentication and full authentication EAP
transactions were received at the Authentication, Authorization,
and Accounting (AAA) protocol level.<a class="pilcrow" href="#section-3.3-2.2.10">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.3-2.3">AT_KDF has any other value</dt>
          <dd id="section-3.3-2.4" style="margin-left: 1.5em">

Future variations of key derivation functions may be defined, and they
will be represented by new values of AT_KDF. If the peer does not
recognize the value, it cannot calculate the keys and behaves as
explained in <a class="xref" href="#keyderiv">Section 3.2</a>.<a class="pilcrow" href="#section-3.3-2.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.3-2.5">AT_KDF is missing</dt>
          <dd id="section-3.3-2.6" style="margin-left: 1.5em">

The peer behaves as if the AUTN had been incorrect and <span class="bcp14">MUST</span> fail the
authentication.<a class="pilcrow" href="#section-3.3-2.6">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-3.3-3">If the peer supports a given key derivation function but is
unwilling to perform it for policy reasons, it refuses to calculate
the keys and behaves as explained in <a class="xref" href="#keyderiv">Section 3.2</a>.<a class="pilcrow" href="#section-3.3-3">¶</a></p>
</section>
</div>
<div id="hashup">
<section id="section-3.4">
        <h3 id="name-hash-functions">
<a class="section-number selfRef" href="#section-3.4">3.4. </a><a class="section-name selfRef" href="#name-hash-functions">Hash Functions</a>
        </h3>
<p id="section-3.4-1">EAP-AKA' uses SHA-256 / HMAC-SHA-256, not SHA-1 / HMAC-SHA-1 (see
<span>[<a class="xref" href="#FIPS.180-4">FIPS.180-4</a>]</span> and <span>[<a class="xref" href="#RFC2104">RFC2104</a>]</span>) as in
EAP-AKA. This requires a change to the pseudorandom function (PRF) as
well as the AT_MAC and AT_CHECKCODE attributes.<a class="pilcrow" href="#section-3.4-1">¶</a></p>
<section id="section-3.4.1">
          <h4 id="name-prf">
<a class="section-number selfRef" href="#section-3.4.1">3.4.1. </a><a class="section-name selfRef" href="#name-prf">PRF'</a>
          </h4>
<p id="section-3.4.1-1">The PRF' construction is the same one IKEv2 uses (see
          <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc7296#section-2.13">Section 2.13</a> of [<a class="xref" href="#RFC7296">RFC7296</a>]</span>;
          the definition of this function has not changed since <span>[<a class="xref" href="#RFC4306">RFC4306</a>]</span>, which was referenced by <span>[<a class="xref" href="#RFC5448">RFC5448</a>]</span>).
          The function takes two arguments. K is a 256-bit value
          and S is a byte string of arbitrary length. PRF' is defined
          as follows:<a class="pilcrow" href="#section-3.4.1-1">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.4.1-2">
<pre>PRF'(K,S) = T1 | T2 | T3 | T4 | ...

   where:
   T1 = HMAC-SHA-256 (K, S | 0x01)
   T2 = HMAC-SHA-256 (K, T1 | S | 0x02)
   T3 = HMAC-SHA-256 (K, T2 | S | 0x03)
   T4 = HMAC-SHA-256 (K, T3 | S | 0x04)
   ...
</pre><a class="pilcrow" href="#section-3.4.1-2">¶</a>
</div>
<p id="section-3.4.1-3">PRF' produces as many bits of output as is needed.  HMAC-SHA-256 is
the application of HMAC <span>[<a class="xref" href="#RFC2104">RFC2104</a>]</span> to SHA-256.<a class="pilcrow" href="#section-3.4.1-3">¶</a></p>
</section>
<section id="section-3.4.2">
          <h4 id="name-at_mac">
<a class="section-number selfRef" href="#section-3.4.2">3.4.2. </a><a class="section-name selfRef" href="#name-at_mac">AT_MAC</a>
          </h4>
<p id="section-3.4.2-1">When used within EAP-AKA', the AT_MAC attribute is changed as
follows. The MAC algorithm is HMAC-SHA-256-128, a keyed hash value.
The HMAC-SHA-256-128 value is obtained from the 32-byte HMAC-SHA-256
value by truncating the output to the first 16 bytes. Hence, the
length of the MAC is 16 bytes.<a class="pilcrow" href="#section-3.4.2-1">¶</a></p>
<p id="section-3.4.2-2">Otherwise, the use of AT_MAC in EAP-AKA' follows
<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc4187#section-10.15">Section 10.15</a> of [<a class="xref" href="#RFC4187">RFC4187</a>]</span>.<a class="pilcrow" href="#section-3.4.2-2">¶</a></p>
</section>
<section id="section-3.4.3">
          <h4 id="name-at_checkcode">
<a class="section-number selfRef" href="#section-3.4.3">3.4.3. </a><a class="section-name selfRef" href="#name-at_checkcode">AT_CHECKCODE</a>
          </h4>
<p id="section-3.4.3-1">When used within EAP-AKA', the AT_CHECKCODE attribute is changed as
follows. First, a 32-byte value is needed to accommodate a 256-bit
hash output:<a class="pilcrow" href="#section-3.4.3-1">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.4.3-2">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| AT_CHECKCODE  | Length        |           Reserved            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
|                     Checkcode (0 or 32 bytes)                 |
|                                                               |
|                                                               |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a class="pilcrow" href="#section-3.4.3-2">¶</a>
</div>
<p id="section-3.4.3-3">Second, the checkcode is a hash value, calculated with SHA-256
<span>[<a class="xref" href="#FIPS.180-4">FIPS.180-4</a>]</span>, over the data specified in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc4187#section-10.13">Section 10.13</a> of [<a class="xref" href="#RFC4187">RFC4187</a>]</span>.<a class="pilcrow" href="#section-3.4.3-3">¶</a></p>
</section>
</section>
</div>
<div id="attrtable">
<section id="section-3.5">
        <h3 id="name-summary-of-attributes-for-e">
<a class="section-number selfRef" href="#section-3.5">3.5. </a><a class="section-name selfRef" href="#name-summary-of-attributes-for-e">Summary of Attributes for EAP-AKA'</a>
        </h3>
<p id="section-3.5-1"><a class="xref" href="#attribute-table">Table 1</a> identifies which attributes may be found
   in which kinds of messages, and in what quantity.<a class="pilcrow" href="#section-3.5-1">¶</a></p>
<p id="section-3.5-2">Messages are denoted with numbers as follows:<a class="pilcrow" href="#section-3.5-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.5-3">
          <dt id="section-3.5-3.1">1</dt>
          <dd id="section-3.5-3.2" style="margin-left: 1.5em">EAP-Request/AKA-Identity<a class="pilcrow" href="#section-3.5-3.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.5-3.3">2</dt>
          <dd id="section-3.5-3.4" style="margin-left: 1.5em">EAP-Response/AKA-Identity<a class="pilcrow" href="#section-3.5-3.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.5-3.5">3</dt>
          <dd id="section-3.5-3.6" style="margin-left: 1.5em">EAP-Request/AKA-Challenge<a class="pilcrow" href="#section-3.5-3.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.5-3.7">4</dt>
          <dd id="section-3.5-3.8" style="margin-left: 1.5em">EAP-Response/AKA-Challenge<a class="pilcrow" href="#section-3.5-3.8">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.5-3.9">5</dt>
          <dd id="section-3.5-3.10" style="margin-left: 1.5em">EAP-Request/AKA-Notification<a class="pilcrow" href="#section-3.5-3.10">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.5-3.11">6</dt>
          <dd id="section-3.5-3.12" style="margin-left: 1.5em">EAP-Response/AKA-Notification<a class="pilcrow" href="#section-3.5-3.12">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.5-3.13">7</dt>
          <dd id="section-3.5-3.14" style="margin-left: 1.5em">EAP-Response/AKA-Client-Error<a class="pilcrow" href="#section-3.5-3.14">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.5-3.15">8</dt>
          <dd id="section-3.5-3.16" style="margin-left: 1.5em">EAP-Request/AKA-Reauthentication<a class="pilcrow" href="#section-3.5-3.16">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.5-3.17">9</dt>
          <dd id="section-3.5-3.18" style="margin-left: 1.5em">EAP-Response/AKA-Reauthentication<a class="pilcrow" href="#section-3.5-3.18">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.5-3.19">10</dt>
          <dd id="section-3.5-3.20" style="margin-left: 1.5em">EAP-Response/AKA-Authentication-Reject<a class="pilcrow" href="#section-3.5-3.20">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.5-3.21">11</dt>
          <dd id="section-3.5-3.22" style="margin-left: 1.5em">EAP-Response/AKA-Synchronization-Failure<a class="pilcrow" href="#section-3.5-3.22">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-3.5-4">The column denoted with "E" indicates whether the attribute is a nested attribute that <span class="bcp14">MUST</span> be included within AT_ENCR_DATA.<a class="pilcrow" href="#section-3.5-4">¶</a></p>
<p id="section-3.5-5">In addition, the numbered columns indicate the quantity of the attribute within the message as follows:<a class="pilcrow" href="#section-3.5-5">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.5-6">
          <dt id="section-3.5-6.1">"0"</dt>
          <dd id="section-3.5-6.2" style="margin-left: 4.0em">Indicates that the attribute <span class="bcp14">MUST NOT</span>
          be included in the message.<a class="pilcrow" href="#section-3.5-6.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.5-6.3">"1"</dt>
          <dd id="section-3.5-6.4" style="margin-left: 4.0em">Indicates that the attribute <span class="bcp14">MUST</span> be
          included in the message.<a class="pilcrow" href="#section-3.5-6.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.5-6.5">"0-1"</dt>
          <dd id="section-3.5-6.6" style="margin-left: 4.0em">Indicates that the attribute is sometimes included
          in the message<a class="pilcrow" href="#section-3.5-6.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.5-6.7">"0+"</dt>
          <dd id="section-3.5-6.8" style="margin-left: 4.0em">Indicates that zero or more copies of the attribute
   <span class="bcp14">MAY</span> be included in the message.<a class="pilcrow" href="#section-3.5-6.8">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.5-6.9">"1+"</dt>
          <dd id="section-3.5-6.10" style="margin-left: 4.0em">Indicates that there <span class="bcp14">MUST</span> be at least one attribute
   in the message but more than one <span class="bcp14">MAY</span> be included in the message.<a class="pilcrow" href="#section-3.5-6.10">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.5-6.11">"0*"</dt>
          <dd id="section-3.5-6.12" style="margin-left: 4.0em">Indicates that the attribute is not included in the
   message in cases specified in this document, but <span class="bcp14">MAY</span> be included in
   the future versions of the protocol.<a class="pilcrow" href="#section-3.5-6.12">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-3.5-7">The attribute table is shown below. The table is largely the
   same as in the EAP-AKA attribute table (<span>[<a class="xref" href="#RFC4187">RFC4187</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc4187#section-10.1">Section 10.1</a></span>),
   but changes how many times AT_MAC may appear in an
   EAP-Response/AKA'-Challenge message as it does not appear there
   when AT_KDF has to be sent from the peer to the server. The table
 also adds the AT_KDF and AT_KDF_INPUT attributes.<a class="pilcrow" href="#section-3.5-7">¶</a></p>
<span id="name-the-attribute-table"></span><div id="attribute-table">
<table class="center" id="table-1">
          <caption>
<a class="selfRef" href="#table-1">Table 1</a>:
<a class="selfRef" href="#name-the-attribute-table">The Attribute Table</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Attribute</th>
              <th class="text-left" colspan="1" rowspan="1">1</th>
              <th class="text-left" colspan="1" rowspan="1">2</th>
              <th class="text-left" colspan="1" rowspan="1">3</th>
              <th class="text-left" colspan="1" rowspan="1">4</th>
              <th class="text-left" colspan="1" rowspan="1">5</th>
              <th class="text-left" colspan="1" rowspan="1">6</th>
              <th class="text-left" colspan="1" rowspan="1">7</th>
              <th class="text-left" colspan="1" rowspan="1">8</th>
              <th class="text-left" colspan="1" rowspan="1">9</th>
              <th class="text-left" colspan="1" rowspan="1">10</th>
              <th class="text-left" colspan="1" rowspan="1">11</th>
              <th class="text-left" colspan="1" rowspan="1">E</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">AT_PERMANENT_ID_REQ</td>
              <td class="text-left" colspan="1" rowspan="1">0-1</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">N</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">AT_ANY_ID_REQ</td>
              <td class="text-left" colspan="1" rowspan="1">0-1</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">N</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">AT_FULLAUTH_ID_REQ</td>
              <td class="text-left" colspan="1" rowspan="1">0-1</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">N</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">AT_IDENTITY</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0-1</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">N</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">AT_RAND</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">1</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">N</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">AT_AUTN</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">1</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">N</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">AT_RES</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">1</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">N</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">AT_AUTS</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">1</td>
              <td class="text-left" colspan="1" rowspan="1">N</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">AT_NEXT_PSEUDONYM</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0-1</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">Y</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">AT_NEXT_REAUTH_ID</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0-1</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0-1</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">Y</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">AT_IV</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0-1</td>
              <td class="text-left" colspan="1" rowspan="1">0*</td>
              <td class="text-left" colspan="1" rowspan="1">0-1</td>
              <td class="text-left" colspan="1" rowspan="1">0-1</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">1</td>
              <td class="text-left" colspan="1" rowspan="1">1</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">N</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">AT_ENCR_DATA</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0-1</td>
              <td class="text-left" colspan="1" rowspan="1">0*</td>
              <td class="text-left" colspan="1" rowspan="1">0-1</td>
              <td class="text-left" colspan="1" rowspan="1">0-1</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">1</td>
              <td class="text-left" colspan="1" rowspan="1">1</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">N</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">AT_PADDING</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0-1</td>
              <td class="text-left" colspan="1" rowspan="1">0*</td>
              <td class="text-left" colspan="1" rowspan="1">0-1</td>
              <td class="text-left" colspan="1" rowspan="1">0-1</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0-1</td>
              <td class="text-left" colspan="1" rowspan="1">0-1</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">Y</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">AT_CHECKCODE</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0-1</td>
              <td class="text-left" colspan="1" rowspan="1">0-1</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0-1</td>
              <td class="text-left" colspan="1" rowspan="1">0-1</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">N</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">AT_RESULT_IND</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0-1</td>
              <td class="text-left" colspan="1" rowspan="1">0-1</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0-1</td>
              <td class="text-left" colspan="1" rowspan="1">0-1</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">N</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">AT_MAC</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">1</td>
              <td class="text-left" colspan="1" rowspan="1">0-1</td>
              <td class="text-left" colspan="1" rowspan="1">0-1</td>
              <td class="text-left" colspan="1" rowspan="1">0-1</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">1</td>
              <td class="text-left" colspan="1" rowspan="1">1</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">N</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">AT_COUNTER</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0-1</td>
              <td class="text-left" colspan="1" rowspan="1">0-1</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">1</td>
              <td class="text-left" colspan="1" rowspan="1">1</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">Y</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">AT_COUNTER_TOO_SMALL</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0-1</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">Y</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">AT_NONCE_S</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">1</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">Y</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">AT_NOTIFICATION</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">1</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">N</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">AT_CLIENT_ERROR_CODE</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">1</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">N</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">AT_KDF</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">1+</td>
              <td class="text-left" colspan="1" rowspan="1">0+</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">1+</td>
              <td class="text-left" colspan="1" rowspan="1">N</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">AT_KDF_INPUT</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">1</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">N</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
</section>
</div>
<div id="bidding">
<section id="section-4">
      <h2 id="name-bidding-down-prevention-for">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-bidding-down-prevention-for">Bidding Down Prevention for EAP-AKA</a>
      </h2>
<p id="section-4-1">As discussed in <span>[<a class="xref" href="#RFC3748">RFC3748</a>]</span>, negotiation of methods
within EAP is insecure. That is, a man-in-the-middle attacker may
force the endpoints to use a method that is not the strongest that they
both support. This is a problem, as we expect EAP-AKA and EAP-AKA' to
be negotiated via EAP.<a class="pilcrow" href="#section-4-1">¶</a></p>
<p id="section-4-2">In order to prevent such attacks, this RFC specifies a 
mechanism for EAP-AKA that allows the endpoints to securely discover
the capabilities of each other. This mechanism comes in the form of
the AT_BIDDING attribute. This allows both endpoints to communicate
their desire and support for EAP-AKA' when exchanging EAP-AKA
messages. This attribute is not included in EAP-AKA' messages. It is
only included in EAP-AKA messages, which are protected with
the AT_MAC attribute.  This approach is
based on the assumption that EAP-AKA' is always preferable (see
<a class="xref" href="#security">Section 7</a>). If during the EAP-AKA authentication
process it is discovered that both endpoints would have been able to
use EAP-AKA', the authentication process <span class="bcp14">SHOULD</span> be aborted, as a
bidding down attack may have happened.<a class="pilcrow" href="#section-4-2">¶</a></p>
<p id="section-4-3">The format of the AT_BIDDING attribute is shown below.<a class="pilcrow" href="#section-4-3">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4-4">
<pre>    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   | AT_BIDDING    | Length        |D|          Reserved           |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a class="pilcrow" href="#section-4-4">¶</a>
</div>
<p id="section-4-5">The fields are as follows:<a class="pilcrow" href="#section-4-5">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4-6">
        <dt id="section-4-6.1">AT_BIDDING</dt>
        <dd id="section-4-6.2" style="margin-left: 1.5em">This is set to 136.<a class="pilcrow" href="#section-4-6.2">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-4-6.3">Length</dt>
        <dd id="section-4-6.4" style="margin-left: 1.5em">The length of the
attribute, calculated as defined in <span>[<a class="xref" href="#RFC4187">RFC4187</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc4187#section-8.1">Section 8.1</a></span>.  For AT_BIDDING, the Length <span class="bcp14">MUST</span> be set to 1.<a class="pilcrow" href="#section-4-6.4">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-4-6.5">D</dt>
        <dd id="section-4-6.6" style="margin-left: 1.5em">This bit is set to 1 if the
sender supports EAP-AKA', is willing to use it, and prefers it
over EAP-AKA. Otherwise, it should be set to zero.<a class="pilcrow" href="#section-4-6.6">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-4-6.7">Reserved</dt>
        <dd id="section-4-6.8" style="margin-left: 1.5em">This field <span class="bcp14">MUST</span> be set
to zero when sent and ignored on receipt.<a class="pilcrow" href="#section-4-6.8">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-4-7">The server sends this attribute in the EAP-Request/AKA-Challenge
message. If the peer supports EAP-AKA', it compares the received value
to its own capabilities. If it turns out that both the server and peer
would have been able to use EAP-AKA' and preferred it over EAP-AKA,
the peer behaves as if AUTN had been incorrect and fails the
authentication (see Figure 3 of <span>[<a class="xref" href="#RFC4187">RFC4187</a>]</span>). A peer not
supporting EAP-AKA' will simply ignore this attribute.  In all cases,
the attribute is protected by the integrity mechanisms of EAP-AKA, so
it cannot be removed by a man-in-the-middle attacker.<a class="pilcrow" href="#section-4-7">¶</a></p>
<p id="section-4-8">Note that we assume (<a class="xref" href="#security">Section 7</a>) that EAP-AKA' is
always stronger than EAP-AKA. As a result, this specification does not provide protection against bidding "down" attacks in the other direction, i.e., attackers forcing
the endpoints to use EAP-AKA'.<a class="pilcrow" href="#section-4-8">¶</a></p>
<div id="attrtable2">
<section id="section-4.1">
        <h3 id="name-summary-of-attributes-for-ea">
<a class="section-number selfRef" href="#section-4.1">4.1. </a><a class="section-name selfRef" href="#name-summary-of-attributes-for-ea">Summary of Attributes for EAP-AKA</a>
        </h3>
<p id="section-4.1-1">The appearance of the AT_BIDDING attribute in EAP-AKA exchanges
  is shown below, using the notation from <a class="xref" href="#attrtable">Section 3.5</a>:<a class="pilcrow" href="#section-4.1-1">¶</a></p>
<span id="name-at_bidding-attribute-appear"></span><div id="att-table">
<table class="center" id="table-2">
          <caption>
<a class="selfRef" href="#table-2">Table 2</a>:
<a class="selfRef" href="#name-at_bidding-attribute-appear">AT_BIDDING Attribute Appearance</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Attribute</th>
              <th class="text-left" colspan="1" rowspan="1">1</th>
              <th class="text-left" colspan="1" rowspan="1">2</th>
              <th class="text-left" colspan="1" rowspan="1">3</th>
              <th class="text-left" colspan="1" rowspan="1">4</th>
              <th class="text-left" colspan="1" rowspan="1">5</th>
              <th class="text-left" colspan="1" rowspan="1">6</th>
              <th class="text-left" colspan="1" rowspan="1">7</th>
              <th class="text-left" colspan="1" rowspan="1">8</th>
              <th class="text-left" colspan="1" rowspan="1">9</th>
              <th class="text-left" colspan="1" rowspan="1">10</th>
              <th class="text-left" colspan="1" rowspan="1">11</th>
              <th class="text-left" colspan="1" rowspan="1">E</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">AT_BIDDING</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">1</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">N</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
</section>
</div>
<div id="identities">
<section id="section-5">
      <h2 id="name-peer-identities">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-peer-identities">Peer Identities</a>
      </h2>
<p id="section-5-1">EAP-AKA' peer identities are as specified in <span>[<a class="xref" href="#RFC4187">RFC4187</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc4187#section-4.1">Section 4.1</a></span>, with the addition of some
      requirements specified in this section.<a class="pilcrow" href="#section-5-1">¶</a></p>
<p id="section-5-2">EAP-AKA' includes optional identity privacy support
  that can be used to hide the cleartext permanent identity and
  thereby make the subscriber's EAP exchanges untraceable to
  eavesdroppers. EAP-AKA' can also use the privacy-friendly identifiers
  specified for 5G networks.<a class="pilcrow" href="#section-5-2">¶</a></p>
<p id="section-5-3">The permanent identity is usually based on the IMSI. Exposing the
  IMSI is undesirable because, as a permanent identity, it is easily
  trackable. In addition, since IMSIs may be used in other contexts as
  well, there would be additional opportunities for such tracking.<a class="pilcrow" href="#section-5-3">¶</a></p>
<p id="section-5-4">In EAP-AKA', identity privacy is based on temporary
  usernames or pseudonym usernames. These are similar to, but
  separate from, the Temporary Mobile Subscriber Identities (TMSI) that
  are used on cellular networks.<a class="pilcrow" href="#section-5-4">¶</a></p>
<div id="untypes">
<section id="section-5.1">
        <h3 id="name-username-types-in-eap-aka-i">
<a class="section-number selfRef" href="#section-5.1">5.1. </a><a class="section-name selfRef" href="#name-username-types-in-eap-aka-i">Username Types in EAP-AKA' Identities</a>
        </h3>
<p id="section-5.1-1"> <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc4187#section-4.1.1.3">Section 4.1.1.3</a> of [<a class="xref" href="#RFC4187">RFC4187</a>]</span> specifies that there
    are three types of usernames: permanent, pseudonym, and fast
    re-authentication usernames.  This specification extends this
    definition as follows. There are four types of usernames:<a class="pilcrow" href="#section-5.1-1">¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-5.1-2">
          <dt>(1)</dt>
<dd id="section-5.1-2.1">
            <p id="section-5.1-2.1.1">Regular usernames. These are external names given to
      EAP-AKA' peers.  The regular usernames are further subdivided into to
      categories:<a class="pilcrow" href="#section-5.1-2.1.1">¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-5.1-2.1.2">
              <dt>(a)</dt>
<dd id="section-5.1-2.1.2.1">Permanent usernames, for instance, IMSI-based
 usernames.<a class="pilcrow" href="#section-5.1-2.1.2.1">¶</a>
</dd>
              <dd class="break"></dd>
<dt>(b)</dt>
<dd id="section-5.1-2.1.2.2">Privacy-friendly temporary usernames, for instance, 5G
              GUTI (5G Globally Unique Temporary Identifier) or 5G privacy identifiers  (see <a class="xref" href="#id5guse">Section 5.3.2</a>) such as SUCI 
                (Subscription Concealed Identifier).<a class="pilcrow" href="#section-5.1-2.1.2.2">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</dd>
          <dd class="break"></dd>
<dt>(2)</dt>
<dd id="section-5.1-2.2"> EAP-AKA' pseudonym usernames.  For example,
      2s7ah6n9q@example.com might be a valid pseudonym identity.  In
      this example, 2s7ah6n9q is the pseudonym username.<a class="pilcrow" href="#section-5.1-2.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt>(3)</dt>
<dd id="section-5.1-2.3">EAP-AKA' fast re-authentication usernames.  For example,
      43953754@example.com might be a valid fast re-authentication
      identity and 43953754 the fast re-authentication
      username.<a class="pilcrow" href="#section-5.1-2.3">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-5.1-3">The permanent, privacy-friendly temporary, and pseudonym
    usernames are only used with full authentication, and fast
    re-authentication usernames only with fast re-authentication.
    Unlike permanent usernames and pseudonym usernames, privacy-friendly 
    temporary usernames and fast re-authentication usernames
    are one-time identifiers, which are not reused across EAP
    exchanges.<a class="pilcrow" href="#section-5.1-3">¶</a></p>
</section>
</div>
<div id="genpfr">
<section id="section-5.2">
        <h3 id="name-generating-pseudonyms-and-f">
<a class="section-number selfRef" href="#section-5.2">5.2. </a><a class="section-name selfRef" href="#name-generating-pseudonyms-and-f">Generating Pseudonyms and Fast Re-Authentication Identities</a>
        </h3>
<p id="section-5.2-1">This section provides some additional guidance to 
    implementations for producing secure pseudonyms and fast
    re-authentication identities. It does not impact backwards
    compatibility because each server consumes only the identities that it
    generates itself. However, adherence to the guidance will provide
    better security.<a class="pilcrow" href="#section-5.2-1">¶</a></p>
<p id="section-5.2-2">As specified by <span>[<a class="xref" href="#RFC4187">RFC4187</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc4187#section-4.1.1.7">Section 4.1.1.7</a></span>,
    pseudonym usernames and fast re-authentication identities are
    generated by the EAP server in an implementation-dependent
    manner. RFC 4187 provides some general requirements on how these
    identities are transported, how they map to the NAI syntax, how
    they are distinguished from each other, and so on.<a class="pilcrow" href="#section-5.2-2">¶</a></p>
<p id="section-5.2-3">However, to enhance privacy, some additional requirements need to
    be applied.<a class="pilcrow" href="#section-5.2-3">¶</a></p>
<p id="section-5.2-4">The pseudonym usernames and fast re-authentication identities
    <span class="bcp14">MUST</span> be generated in a cryptographically secure way so that
    it is computationally infeasible for an attacker to differentiate
    two identities belonging to the same user from two identities
    belonging to different users. This can be achieved, for instance,
    by using random or pseudorandom identifiers such as random byte
    strings or ciphertexts. See also <span>[<a class="xref" href="#RFC4086">RFC4086</a>]</span> for guidance
    on random number generation.<a class="pilcrow" href="#section-5.2-4">¶</a></p>
<p id="section-5.2-5">Note that the pseudonym and fast re-authentication usernames
    also <span class="bcp14">MUST NOT</span> include substrings that can be used to relate the
    username to a particular entity or a particular permanent
    identity. For instance, the usernames cannot include any
    subscriber-identifying part of an IMSI or other permanent
    identifier. Similarly, no part of the username can be formed by a
    fixed mapping that stays the same across multiple different
    pseudonyms or fast re-authentication identities for the same
    subscriber.<a class="pilcrow" href="#section-5.2-5">¶</a></p>
<p id="section-5.2-6">When the identifier used to identify a subscriber in an
    EAP-AKA' authentication exchange is a privacy-friendly identifier
    that is used only once, the EAP-AKA' peer <span class="bcp14">MUST NOT</span> use a pseudonym
    provided in that authentication exchange in subsequent exchanges
    more than once. To ensure that this does not happen, the EAP-AKA'
    server <span class="bcp14">MAY</span> decline to provide a pseudonym in such authentication
    exchanges. An important case where such privacy-friendly
    identifiers are used is in 5G networks (see <a class="xref" href="#identifiersin5g">Section 5.3</a>).<a class="pilcrow" href="#section-5.2-6">¶</a></p>
</section>
</div>
<div id="identifiersin5g">
<section id="section-5.3">
        <h3 id="name-identifier-usage-in-5g">
<a class="section-number selfRef" href="#section-5.3">5.3. </a><a class="section-name selfRef" href="#name-identifier-usage-in-5g">Identifier Usage in 5G</a>
        </h3>
<p id="section-5.3-1">In EAP-AKA', the peer identity may be communicated to the server
  in one of three ways:<a class="pilcrow" href="#section-5.3-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3-2.1">As a part of link-layer establishment procedures, externally to
    EAP.<a class="pilcrow" href="#section-5.3-2.1">¶</a>
</li>
          <li class="normal" id="section-5.3-2.2">With the EAP-Response/Identity message in the beginning of the
    EAP exchange, but before the selection of EAP-AKA'.<a class="pilcrow" href="#section-5.3-2.2">¶</a>
</li>
          <li class="normal" id="section-5.3-2.3">Transmitted from the peer to the server using EAP-AKA' messages
    instead of EAP-Response/Identity.  In this case, the server
    includes an identity-requesting attribute (AT_ANY_ID_REQ,
    AT_FULLAUTH_ID_REQ, or AT_PERMANENT_ID_REQ) in the
    EAP-Request/AKA-Identity message, and the peer includes the
    AT_IDENTITY attribute, which contains the peer's identity, in the
    EAP-Response/AKA-Identity message.<a class="pilcrow" href="#section-5.3-2.3">¶</a>
</li>
        </ul>
<p id="section-5.3-3">The identity carried above may be a permanent identity, privacy-friendly 
    identity, pseudonym identity, or fast re-authentication
  identity as defined in <a class="xref" href="#untypes">Section 5.1</a>.<a class="pilcrow" href="#section-5.3-3">¶</a></p>
<p id="section-5.3-4">5G supports the concept of privacy identifiers, and it is
  important for interoperability that the right type of identifier is
  used.<a class="pilcrow" href="#section-5.3-4">¶</a></p>
<p id="section-5.3-5">5G defines the SUbscription Permanent Identifier (SUPI) and
  SUbscription Concealed Identifier (SUCI) <span>[<a class="xref" href="#TS-3GPP.23.501">TS-3GPP.23.501</a>]</span> <span>[<a class="xref" href="#TS-3GPP.33.501">TS-3GPP.33.501</a>]</span> <span>[<a class="xref" href="#TS-3GPP.23.003">TS-3GPP.23.003</a>]</span>. SUPI is globally unique and allocated to
  each subscriber. However, it is only used internally in the 5G
  network and is privacy sensitive. The SUCI is a privacy-preserving
  identifier containing the concealed SUPI, using public key
  cryptography to encrypt the SUPI.<a class="pilcrow" href="#section-5.3-5">¶</a></p>
<p id="section-5.3-6">Given the choice between these two types of identifiers,
  EAP-AKA' ensures interoperability as follows:<a class="pilcrow" href="#section-5.3-6">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3-7.1">Where identifiers are used within EAP-AKA' (such as key
    derivation) determine the exact values of the identity to be used,
    to avoid ambiguity (see <a class="xref" href="#kd5g">Section 5.3.1</a>).<a class="pilcrow" href="#section-5.3-7.1">¶</a>
</li>
          <li class="normal" id="section-5.3-7.2">Where identifiers are carried within EAP-AKA' packets
    (such as in the AT_IDENTITY attribute) determine which identifiers
    should be filled in (see <a class="xref" href="#id5guse">Section 5.3.2</a>).<a class="pilcrow" href="#section-5.3-7.2">¶</a>
</li>
        </ul>
<p id="section-5.3-8">In 5G, the normal mode of operation is that identifiers are only
  transmitted outside EAP. However, in a system involving terminals
  from many generations and several connectivity options via 5G and
  other mechanisms, implementations and the EAP-AKA' specification
  need to prepare for many different situations, including sometimes
  having to communicate identities within EAP.<a class="pilcrow" href="#section-5.3-8">¶</a></p>
<p id="section-5.3-9">The following sections clarify which identifiers are used and
  how.<a class="pilcrow" href="#section-5.3-9">¶</a></p>
<div id="kd5g">
<section id="section-5.3.1">
          <h4 id="name-key-derivation-2">
<a class="section-number selfRef" href="#section-5.3.1">5.3.1. </a><a class="section-name selfRef" href="#name-key-derivation-2">Key Derivation</a>
          </h4>
<p id="section-5.3.1-1">In EAP-AKA', the peer identity is used in the key derivation formula found in <a class="xref" href="#key">Section 3.3</a>.<a class="pilcrow" href="#section-5.3.1-1">¶</a></p>
<p id="section-5.3.1-2">The identity needs  to be represented in exactly the correct format
    for the key derivation formula to produce correct results.<a class="pilcrow" href="#section-5.3.1-2">¶</a></p>
<p id="section-5.3.1-3">If the AT_KDF_INPUT parameter contains the prefix "5G:", the
    AT_KDF parameter has the value 1, and this authentication is not a
    fast re-authentication, then the peer identity used in the key
    derivation <span class="bcp14">MUST</span> be as specified in Annex F.3 of <span>[<a class="xref" href="#TS-3GPP.33.501">TS-3GPP.33.501</a>]</span> and Clause 2.2 of <span>[<a class="xref" href="#TS-3GPP.23.003">TS-3GPP.23.003</a>]</span>. This is in contrast to <span>[<a class="xref" href="#RFC5448">RFC5448</a>]</span>, which uses the identity as communicated in
    EAP and represented as a NAI. Also, in contrast to <span>[<a class="xref" href="#RFC5448">RFC5448</a>]</span>, in 5G EAP-AKA' does not use the "0" nor the "6"
    prefix in front of the identifier.<a class="pilcrow" href="#section-5.3.1-3">¶</a></p>
<p id="section-5.3.1-4">For an example of the format of the identity, see Clause 2.2 of <span>[<a class="xref" href="#TS-3GPP.23.003">TS-3GPP.23.003</a>]</span>.<a class="pilcrow" href="#section-5.3.1-4">¶</a></p>
<p id="section-5.3.1-5">In all other cases, the following applies:<a class="pilcrow" href="#section-5.3.1-5">¶</a></p>
<p id="section-5.3.1-6" style="margin-left: 3.0em">The identity used in the key derivation formula <span class="bcp14">MUST</span> be
      exactly the one sent in the EAP-AKA' AT_IDENTITY attribute, if one
      was sent, regardless of the kind of identity that it may have
      been. If no AT_IDENTITY was sent, the identity <span class="bcp14">MUST</span> be
      exactly the one sent in the generic EAP Identity exchange, if
      one was made.<a class="pilcrow" href="#section-5.3.1-6">¶</a></p>
<p id="section-5.3.1-7" style="margin-left: 3.0em">If no identity was communicated inside EAP, then the identity
      is the one communicated outside EAP in link-layer messaging.<a class="pilcrow" href="#section-5.3.1-7">¶</a></p>
<p id="section-5.3.1-8" style="margin-left: 3.0em">In this case, the used identity <span class="bcp14">MUST</span> be the identity most
      recently communicated by the peer to the network, again regardless
      of what type of identity it may have been.<a class="pilcrow" href="#section-5.3.1-8">¶</a></p>
</section>
</div>
<div id="id5guse">
<section id="section-5.3.2">
          <h4 id="name-eap-identity-response-and-e">
<a class="section-number selfRef" href="#section-5.3.2">5.3.2. </a><a class="section-name selfRef" href="#name-eap-identity-response-and-e">EAP Identity Response and EAP-AKA' AT_IDENTITY Attribute</a>
          </h4>
<p id="section-5.3.2-1">The EAP authentication option is only available in 5G when the
    new 5G core network is also in use. However, in other networks, an
    EAP-AKA' peer may be connecting to other types of networks and
    existing equipment.<a class="pilcrow" href="#section-5.3.2-1">¶</a></p>
<p id="section-5.3.2-2">When the EAP server is in a 5G network, the 5G procedures for
    EAP-AKA' apply. <span>[<a class="xref" href="#TS-3GPP.33.501">TS-3GPP.33.501</a>]</span> specifies when the EAP server is in a 5G network.<a class="pilcrow" href="#section-5.3.2-2">¶</a></p>
<p id="section-5.3.2-3" style="margin-left: 3.0em">Note: Currently, the following conditions are specified: when the
    EAP peer uses the 5G Non-Access Stratum (NAS) protocol <span>[<a class="xref" href="#TS-3GPP.24.501">TS-3GPP.24.501</a>]</span> or when the EAP peer attaches to a network
    that advertises 5G connectivity without NAS <span>[<a class="xref" href="#TS-3GPP.23.501">TS-3GPP.23.501</a>]</span>. Possible future conditions
    may also be specified by 3GPP.<a class="pilcrow" href="#section-5.3.2-3">¶</a></p>
<p id="section-5.3.2-4">When the 5G procedures for EAP-AKA' apply, EAP identity
    exchanges are generally not used as the identity is already made
    available on previous link-layer exchanges.<a class="pilcrow" href="#section-5.3.2-4">¶</a></p>
<p id="section-5.3.2-5">In this situation, the EAP Identity Response and EAP-AKA'
    AT_IDENTITY attribute are handled as specified in Annex F.2 of
    <span>[<a class="xref" href="#TS-3GPP.33.501">TS-3GPP.33.501</a>]</span>.<a class="pilcrow" href="#section-5.3.2-5">¶</a></p>
<p id="section-5.3.2-6">When used in EAP-AKA', the format of the SUCI <span class="bcp14">MUST</span> be as
    specified in <span>[<a class="xref" href="#TS-3GPP.23.003">TS-3GPP.23.003</a>]</span>, Section 28.7.3, with the semantics defined in
    <span>[<a class="xref" href="#TS-3GPP.23.003">TS-3GPP.23.003</a>]</span>, Section 2.2B. Also, in contrast to <span>[<a class="xref" href="#RFC5448">RFC5448</a>]</span>, in 5G EAP-AKA' does not use the "0" nor the "6"
    prefix in front of the identifier.<a class="pilcrow" href="#section-5.3.2-6">¶</a></p>
<p id="section-5.3.2-7">For an example of an IMSI in NAI format, see <span>[<a class="xref" href="#TS-3GPP.23.003">TS-3GPP.23.003</a>]</span>, Section 28.7.3.<a class="pilcrow" href="#section-5.3.2-7">¶</a></p>
<p id="section-5.3.2-8">Otherwise, the peer <span class="bcp14">SHOULD</span> employ an IMSI, SUPI, or NAI <span>[<a class="xref" href="#RFC7542">RFC7542</a>]</span> as it is
    configured to use.<a class="pilcrow" href="#section-5.3.2-8">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="exported-parameters">
<section id="section-6">
      <h2 id="name-exported-parameters">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-exported-parameters">Exported Parameters</a>
      </h2>
<p id="section-6-1">When not using fast re-authentication, the EAP-AKA' Session-Id is the concatenation of the EAP-AKA' Type value 
  (0x32, one byte) with the contents of the RAND field from the AT_RAND attribute
  followed by the contents of the AUTN field in the AT_AUTN attribute:<a class="pilcrow" href="#section-6-1">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6-2">
<pre>      Session-Id = 0x32 || RAND || AUTN
</pre><a class="pilcrow" href="#section-6-2">¶</a>
</div>
<p id="section-6-3">When using fast re-authentication, the EAP-AKA' Session-Id is the
  concatenation of the EAP-AKA' Type value (0x32) with the contents of the
  NONCE_S field from the AT_NONCE_S attribute followed by the
  contents of the MAC field from the AT_MAC attribute from the
  EAP-Request/AKA-Reauthentication:<a class="pilcrow" href="#section-6-3">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6-4">
<pre>      Session-Id = 0x32 || NONCE_S || MAC
</pre><a class="pilcrow" href="#section-6-4">¶</a>
</div>
<p id="section-6-5">The Peer-Id is the contents of the Identity field from the
  AT_IDENTITY attribute, using only the Actual Identity Length bytes
  from the beginning.  Note that the contents are used as they are
  transmitted, regardless of whether the transmitted identity was a
  permanent, pseudonym, or fast EAP re-authentication identity. If no
  AT_IDENTITY attribute was exchanged, the exported Peer-Id is the
  identity provided from the EAP Identity Response packet. If no EAP
  Identity Response was provided either, the exported Peer-Id is the null
  string (zero length).<a class="pilcrow" href="#section-6-5">¶</a></p>
<p id="section-6-6">The Server-Id is the null string (zero length).<a class="pilcrow" href="#section-6-6">¶</a></p>
</section>
</div>
<div id="security">
<section id="section-7">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<p id="section-7-1">A summary of the security properties of EAP-AKA' follows. These
properties are very similar to those in EAP-AKA. We assume that
HMAC SHA-256 is at least as secure as HMAC SHA-1 (see also <span>[<a class="xref" href="#RFC6194">RFC6194</a>]</span>). This is called the SHA-256
assumption in the remainder of this section.  Under this assumption,
EAP-AKA' is at least as secure as EAP-AKA.<a class="pilcrow" href="#section-7-1">¶</a></p>
<p id="section-7-2">If the AT_KDF attribute has value 1, then the security properties
of EAP-AKA' are as follows:<a class="pilcrow" href="#section-7-2">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-7-3">
        <dt id="section-7-3.1">Protected ciphersuite negotiation</dt>
        <dd id="section-7-3.2" style="margin-left: 1.5em">
          <p id="section-7-3.2.1"> EAP-AKA' has no ciphersuite
negotiation mechanisms. It does have a negotiation mechanism for
selecting the key derivation functions.  This mechanism is secure
against bidding down attacks from EAP-AKA' to EAP-AKA. The negotiation mechanism allows
changing the offered key derivation function, but the change is
visible in the final EAP-Request/AKA'-Challenge message that the
server sends to the peer. This message is authenticated via the AT_MAC
attribute, and carries both the chosen alternative and the initially
offered list. The peer refuses to accept a change it did not initiate.
As a result, both parties are aware that a change is being made and
what the original offer was.<a class="pilcrow" href="#section-7-3.2.1">¶</a></p>
<p id="section-7-3.2.2">

Per assumptions in <a class="xref" href="#bidding">Section 4</a>, there is no protection
against bidding down attacks from EAP-AKA to EAP-AKA' should EAP-AKA'
somehow be considered less secure some day than EAP-AKA. Such
protection was not provided in RFC 5448 implementations and
consequently neither does this specification provide it. If such
support is needed, it would have to be added as a separate new
feature.<a class="pilcrow" href="#section-7-3.2.2">¶</a></p>
<p id="section-7-3.2.3">
In general, it is expected that the current negotiation
capabilities in EAP-AKA' are sufficient for some types of
extensions, including adding Perfect Forward Secrecy
<span>[<a class="xref" href="#I-D.ietf-emu-aka-pfs">EMU-AKA-PFS</a>]</span> and perhaps others.  However, some larger changes may require a new EAP method type, which is how EAP-AKA' itself happened.  One example of such change would be the introduction of new algorithms.<a class="pilcrow" href="#section-7-3.2.3">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-7-3.3">Mutual authentication</dt>
        <dd id="section-7-3.4" style="margin-left: 1.5em"> Under the
SHA-256 assumption, the properties of EAP-AKA' are at least as good as
those of EAP-AKA in this respect. Refer to <span>[<a class="xref" href="#RFC4187">RFC4187</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc4187#section-12">Section 12</a></span>, for further details.<a class="pilcrow" href="#section-7-3.4">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-7-3.5">Integrity protection</dt>
        <dd id="section-7-3.6" style="margin-left: 1.5em"> Under the
SHA-256 assumption, the properties of EAP-AKA' are at least as good
(most likely better) as those of EAP-AKA in this respect.  Refer to
<span>[<a class="xref" href="#RFC4187">RFC4187</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc4187#section-12">Section 12</a></span>, for further details. The only
difference is that a stronger hash algorithm and keyed MAC, SHA-256 /
HMAC-SHA-256, is used instead of SHA-1 / HMAC-SHA-1.<a class="pilcrow" href="#section-7-3.6">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-7-3.7">Replay protection</dt>
        <dd id="section-7-3.8" style="margin-left: 1.5em"> Under the
SHA-256 assumption, the properties of EAP-AKA' are at least as good as
those of EAP-AKA in this respect. Refer to <span>[<a class="xref" href="#RFC4187">RFC4187</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc4187#section-12">Section 12</a></span>, for further details.<a class="pilcrow" href="#section-7-3.8">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-7-3.9">
<div id="confidentiality">Confidentiality</div>
        </dt>
<dd id="section-7-3.10" style="margin-left: 1.5em"> The properties
of EAP-AKA' are exactly the same as those of EAP-AKA in this
respect. Refer to <span>[<a class="xref" href="#RFC4187">RFC4187</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc4187#section-12">Section 12</a></span>, for further
details.<a class="pilcrow" href="#section-7-3.10">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-7-3.11">Key derivation</dt>
        <dd id="section-7-3.12" style="margin-left: 1.5em">
          <p id="section-7-3.12.1"> EAP-AKA' supports key derivation with an effective key strength
          against brute-force attacks equal to the minimum of the length of
          the derived keys and the length of the AKA base key, i.e., 128 bits
          or more.  The key hierarchy is specified in <a class="xref" href="#key">Section 3.3</a>.<a class="pilcrow" href="#section-7-3.12.1">¶</a></p>
<p id="section-7-3.12.2"> The Transient EAP Keys
used to protect EAP-AKA packets (K_encr, K_aut, K_re), the MSK, and
the EMSK are cryptographically separate. If we make the assumption
that SHA-256 behaves as a pseudorandom function, an attacker is
incapable of deriving any non-trivial information about any of these
keys based on the other keys.  An attacker also cannot calculate the
pre-shared secret from IK, CK, IK', CK', K_encr, K_aut, K_re, MSK, or
EMSK by any practically feasible means.<a class="pilcrow" href="#section-7-3.12.2">¶</a></p>
<p id="section-7-3.12.3">

EAP-AKA' adds an additional layer of key derivation functions within
itself to protect against the use of compromised keys. This is
discussed further in
<a class="xref" href="#bindprop">Section 7.4</a>.<a class="pilcrow" href="#section-7-3.12.3">¶</a></p>
<p id="section-7-3.12.4">

     EAP-AKA' uses a pseudorandom function modeled after the one used in
IKEv2 <span>[<a class="xref" href="#RFC7296">RFC7296</a>]</span> together with SHA-256.<a class="pilcrow" href="#section-7-3.12.4">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-7-3.13">Key strength</dt>
        <dd id="section-7-3.14" style="margin-left: 1.5em"> See above.<a class="pilcrow" href="#section-7-3.14">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-7-3.15">Dictionary attack resistance</dt>
        <dd id="section-7-3.16" style="margin-left: 1.5em">
Under the SHA-256 assumption, the properties of EAP-AKA' are at least
as good as those of EAP-AKA in this respect. Refer to
<span>[<a class="xref" href="#RFC4187">RFC4187</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc4187#section-12">Section 12</a></span>, for further details.<a class="pilcrow" href="#section-7-3.16">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-7-3.17">Fast reconnect</dt>
        <dd id="section-7-3.18" style="margin-left: 1.5em"> Under the SHA-256
assumption, the properties of EAP-AKA' are at least as good as those
of EAP-AKA in this respect. Refer to <span>[<a class="xref" href="#RFC4187">RFC4187</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc4187#section-12">Section 12</a></span>, for further details. Note that implementations <span class="bcp14">MUST</span> prevent
performing a fast reconnect across method types.<a class="pilcrow" href="#section-7-3.18">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-7-3.19">Cryptographic binding</dt>
        <dd id="section-7-3.20" style="margin-left: 1.5em"> Note that
this term refers to a very specific form of binding, something that is
performed between two layers of authentication. It is not the same as
the binding to a particular network name. The properties of EAP-AKA'
are exactly the same as those of EAP-AKA in this respect, i.e., as it is not a
tunnel method, this property is not applicable to it. Refer to
<span>[<a class="xref" href="#RFC4187">RFC4187</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc4187#section-12">Section 12</a></span>, for further details.<a class="pilcrow" href="#section-7-3.20">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-7-3.21">Session independence</dt>
        <dd id="section-7-3.22" style="margin-left: 1.5em"> The
properties of EAP-AKA' are exactly the same as those of EAP-AKA in
this respect. Refer to <span>[<a class="xref" href="#RFC4187">RFC4187</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc4187#section-12">Section 12</a></span>, for further
details.<a class="pilcrow" href="#section-7-3.22">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-7-3.23">Fragmentation</dt>
        <dd id="section-7-3.24" style="margin-left: 1.5em"> The properties of
EAP-AKA' are exactly the same as those of EAP-AKA in this
respect. Refer to <span>[<a class="xref" href="#RFC4187">RFC4187</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc4187#section-12">Section 12</a></span>, for further
details.<a class="pilcrow" href="#section-7-3.24">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-7-3.25">Channel binding</dt>
        <dd id="section-7-3.26" style="margin-left: 1.5em">
          <p id="section-7-3.26.1"> EAP-AKA', like
EAP-AKA, does not provide channel bindings as they're defined in
<span>[<a class="xref" href="#RFC3748">RFC3748</a>]</span> and <span>[<a class="xref" href="#RFC5247">RFC5247</a>]</span>. New skippable
attributes can be used to add channel binding support in the future,
if required.<a class="pilcrow" href="#section-7-3.26.1">¶</a></p>
<p id="section-7-3.26.2">

However, including the Network Name field in the AKA' algorithms
(which are also used for other purposes than EAP-AKA') provides a form
of cryptographic separation between different network names, which
resembles channel bindings. However, the network name does not
typically identify the EAP (pass-through) authenticator. See <a class="xref" href="#bindprop">Section 7.4</a> for more discussion.<a class="pilcrow" href="#section-7-3.26.2">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
<div id="priv">
<section id="section-7.1">
        <h3 id="name-privacy">
<a class="section-number selfRef" href="#section-7.1">7.1. </a><a class="section-name selfRef" href="#name-privacy">Privacy</a>
        </h3>
<p id="section-7.1-1"><span>[<a class="xref" href="#RFC6973">RFC6973</a>]</span> suggests that the privacy considerations
  of IETF protocols be documented.<a class="pilcrow" href="#section-7.1-1">¶</a></p>
<p id="section-7.1-2">The confidentiality properties of EAP-AKA' itself have been
  discussed above under <span><a class="xref" href="#confidentiality">"Confidentiality"</a> (<a class="xref" href="#confidentiality">Section 7</a>)</span>.<a class="pilcrow" href="#section-7.1-2">¶</a></p>
<p id="section-7.1-3">EAP-AKA' uses several different types of identifiers to identify
  the authenticating peer. It is strongly <span class="bcp14">RECOMMENDED</span> to use the
  privacy-friendly temporary or hidden identifiers, i.e., the 5G GUTI or SUCI,
  pseudonym usernames, and fast re-authentication usernames. The use
  of permanent identifiers such as the IMSI or SUPI may lead to an ability to
  track the peer and/or user associated with the peer. The use of
  permanent identifiers such as the IMSI or SUPI is strongly <span class="bcp14">NOT RECOMMENDED</span>.<a class="pilcrow" href="#section-7.1-3">¶</a></p>
<p id="section-7.1-4">As discussed in <a class="xref" href="#identifiersin5g">Section 5.3</a>, when
  authenticating to a 5G network, only the SUCI identifier is normally
  used. The use of EAP-AKA' pseudonyms in this situation is at best
  limited because the SUCI already provides a stronger mechanism.
  In fact, reusing the same pseudonym multiple times
  will result in a tracking opportunity for observers that see the
  pseudonym pass by. To avoid this, the peer and server need to follow
  the guidelines given in <a class="xref" href="#genpfr">Section 5.2</a>.<a class="pilcrow" href="#section-7.1-4">¶</a></p>
<p id="section-7.1-5">When authenticating to a 5G network, per <a class="xref" href="#kd5g">Section 5.3.1</a>,
  both the EAP-AKA' peer and server need to employ the permanent
  identifier SUPI as an input to key derivation. However, this use
  of the SUPI is only internal. As such, the SUPI need not be
  communicated in EAP messages. Therefore, SUPI <span class="bcp14">MUST NOT</span> be
  communicated in EAP-AKA' when authenticating to a 5G network.<a class="pilcrow" href="#section-7.1-5">¶</a></p>
<p id="section-7.1-6">While the use of SUCI in 5G networks generally provides identity
  privacy, this is not true if the null-scheme encryption is used to
  construct the SUCI (see <span>[<a class="xref" href="#TS-3GPP.33.501">TS-3GPP.33.501</a>]</span>, Annex C). The use
  of this scheme makes the use of SUCI equivalent to the use of SUPI
  or IMSI. The use of the null scheme is <span class="bcp14">NOT RECOMMENDED</span> where
  identity privacy is important.<a class="pilcrow" href="#section-7.1-6">¶</a></p>
<p id="section-7.1-7">The use of fast re-authentication identities when authenticating
  to a 5G network does not have the same problems as the use of
  pseudonyms, as long as the 5G authentication server generates the
  fast re-authentication identifiers in a proper manner specified in
  <a class="xref" href="#genpfr">Section 5.2</a>.<a class="pilcrow" href="#section-7.1-7">¶</a></p>
<p id="section-7.1-8">Outside 5G, the peer can freely choose between the use of permanent, pseudonym, or fast
  re-authentication identifiers:<a class="pilcrow" href="#section-7.1-8">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1-9.1">
            <p id="section-7.1-9.1.1">A peer that has not yet performed any EAP-AKA' exchanges does
    not typically have a pseudonym available. If the peer does not
    have a pseudonym available, then the privacy mechanism cannot be
    used, and the permanent identity will have to be sent in the
    clear.<a class="pilcrow" href="#section-7.1-9.1.1">¶</a></p>
<p id="section-7.1-9.1.2">

    The terminal <span class="bcp14">SHOULD</span> store the pseudonym in nonvolatile
    memory so that it can be maintained across reboots.  An active
    attacker that impersonates the network may use the
    AT_PERMANENT_ID_REQ attribute (<span>[<a class="xref" href="#RFC4187">RFC4187</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc4187#section-4.1.2">Section 4.1.2</a></span>) to learn the subscriber's IMSI. However, as discussed in
    <span>[<a class="xref" href="#RFC4187">RFC4187</a>], <a class="relref" href="https://www.rfc-editor.org/rfc/rfc4187#section-4.1.2">Section 4.1.2</a></span>, the terminal can refuse to
    send the cleartext permanent identity if it believes that the
    network should be able to recognize the pseudonym.<a class="pilcrow" href="#section-7.1-9.1.2">¶</a></p>
</li>
          <li class="normal" id="section-7.1-9.2">
            <p id="section-7.1-9.2.1">When pseudonyms and fast re-authentication identities are used,
    the peer relies on the properly created identifiers by the server.<a class="pilcrow" href="#section-7.1-9.2.1">¶</a></p>
<p id="section-7.1-9.2.2">

    It is essential that an attacker cannot link a
    privacy-friendly identifier to the user in any way or determine that
    two identifiers belong to the same user as outlined in <a class="xref" href="#genpfr">Section 5.2</a>. The pseudonym usernames and fast
    re-authentication identities <span class="bcp14">MUST NOT</span> be used for other
    purposes (e.g., in other protocols).<a class="pilcrow" href="#section-7.1-9.2.2">¶</a></p>
</li>
        </ul>
<p id="section-7.1-10">If the peer and server cannot guarantee that
  SUCI can be used or that pseudonyms will be available,
  generated properly, and maintained reliably, and identity privacy
  is required, then additional protection from an external security
  mechanism such as tunneled EAP methods like Tunneled Transport Layer Security (TTLS) <span>[<a class="xref" href="#RFC5281">RFC5281</a>]</span> or Tunnel Extensible Authentication Protocol (TEAP) <span>[<a class="xref" href="#RFC7170">RFC7170</a>]</span> 
  may be used.  The benefits and the security considerations of using an external security
  mechanism with EAP-AKA are beyond the scope of this document.<a class="pilcrow" href="#section-7.1-10">¶</a></p>
<p id="section-7.1-11">Finally, as with other EAP methods, even when privacy-friendly
  identifiers or EAP tunneling is used, typically the domain part of
  an identifier (e.g., the home operator) is visible to external
  parties.<a class="pilcrow" href="#section-7.1-11">¶</a></p>
</section>
</div>
<div id="vuln">
<section id="section-7.2">
        <h3 id="name-discovered-vulnerabilities">
<a class="section-number selfRef" href="#section-7.2">7.2. </a><a class="section-name selfRef" href="#name-discovered-vulnerabilities">Discovered Vulnerabilities</a>
        </h3>
<p id="section-7.2-1">There have been no published attacks that violate the primary
  secrecy or authentication properties defined for Authentication and
  Key Agreement (AKA) under the originally assumed trust model. The
  same is true of EAP-AKA'.<a class="pilcrow" href="#section-7.2-1">¶</a></p>
<p id="section-7.2-2">However, there have been attacks when a different trust model is
  in use, with characteristics not originally provided by the design,
  or when participants in the protocol leak information to outsiders
  on purpose, and there have been some privacy-related attacks.<a class="pilcrow" href="#section-7.2-2">¶</a></p>
<p id="section-7.2-3">For instance, the original AKA protocol does not prevent an insider
  supplying keys to a third party, e.g., as described by
  <span class="contact-name">Mjølsnes</span> and Tsay in <span>[<a class="xref" href="#MT2012">MT2012</a>]</span> where a serving network
  lets an authentication run succeed, but then it misuses the session
  keys to send traffic on the authenticated user's behalf. This
  particular attack is not different from any on-path entity (such as
  a router) pretending to send traffic, but the general issue of
  insider attacks can be a problem, particularly in a large group of
  collaborating operators.<a class="pilcrow" href="#section-7.2-3">¶</a></p>
<p id="section-7.2-4">Another class of attacks is the use of tunneling of traffic from
  one place to another, e.g., as done by Zhang and Fang in <span>[<a class="xref" href="#ZF2005">ZF2005</a>]</span> to leverage security policy differences between
  different operator networks, for instance. To gain something in such
  an attack, the attacker needs to trick the user into believing it is
  in another location. If policies between locations differ,
  for instance, if payload traffic is not required to be encrypted in some location,
  the attacker may trick the user into
  opening a vulnerability. As an authentication
  mechanism, EAP-AKA' is not directly affected by most of these 
  attacks. EAP-AKA' network name binding can also help alleviate some
  of the attacks.  In any case, it is recommended that EAP-AKA'
  configuration not be dependent on the location of request origin,
  unless the location information can be cryptographically
  confirmed, e.g., with the network name binding.<a class="pilcrow" href="#section-7.2-4">¶</a></p>
<p id="section-7.2-5">Zhang and Fang also looked at denial-of-service attacks <span>[<a class="xref" href="#ZF2005">ZF2005</a>]</span>. A serving network may request large numbers of
  authentication runs for a particular subscriber from a home
  network. While the resynchronization process can help recover from this,
  eventually it is possible to exhaust the sequence number space and
  render the subscriber's card unusable. This attack is possible for
  both original AKA and EAP-AKA'. However, it requires the collaboration
  of a serving network in an attack. It is recommended that EAP-AKA'
  implementations provide the means to track, detect, and limit excessive
  authentication attempts to combat this problem.<a class="pilcrow" href="#section-7.2-5">¶</a></p>
<p id="section-7.2-6">There have also been attacks related to the use of AKA without the
  generated session keys (e.g., <span>[<a class="xref" href="#BT2013">BT2013</a>]</span>). Some of
  those attacks relate to the use of 
  HTTP Digest AKAv1 <span>[<a class="xref" href="#RFC3310">RFC3310</a>]</span>, which was originally vulnerable to man-in-the-middle attacks. This has
  since been corrected in <span>[<a class="xref" href="#RFC4169">RFC4169</a>]</span>. The EAP-AKA'
  protocol uses session keys and provides channel binding, and as
  such, it is resistant to the above attacks except where the protocol
  participants leak information to outsiders.<a class="pilcrow" href="#section-7.2-6">¶</a></p>
<p id="section-7.2-7">Basin, et al. <span>[<a class="xref" href="#Basin2018">Basin2018</a>]</span> have performed formal
  analysis and concluded that the AKA protocol would have benefited
  from additional security requirements such as key confirmation.<a class="pilcrow" href="#section-7.2-7">¶</a></p>
<p id="section-7.2-8">In the context of pervasive monitoring revelations, there were
  also reports of compromised long-term pre-shared keys used in SIM
  and AKA <span>[<a class="xref" href="#Heist2015">Heist2015</a>]</span>. While no protocol can survive
  the theft of key material associated with its credentials, there
  are some things that alleviate the impacts in such situations.
  These are discussed further in <a class="xref" href="#pm">Section 7.3</a>.<a class="pilcrow" href="#section-7.2-8">¶</a></p>
<p id="section-7.2-9">Arapinis, et al. <span>[<a class="xref" href="#Arapinis2012">Arapinis2012</a>]</span> describe an attack
  that uses the AKA resynchronization protocol to attempt to detect
  whether a particular subscriber is in a given area. This attack
  depends on the attacker setting up a false base station
  in the given area and on the subscriber performing at least one
  authentication between the time the attack is set up and run.<a class="pilcrow" href="#section-7.2-9">¶</a></p>
<p id="section-7.2-10">Borgaonkar, et al. discovered that the AKA resynchronization
  protocol may also be used to predict the authentication frequency of
  a subscriber if a non-time-based sequence number (SQN) generation scheme is used <span>[<a class="xref" href="#Borgaonkar2018">Borgaonkar2018</a>]</span>. The attacker can force the reuse of the
  keystream that is used to protect the SQN in the AKA
  resynchronization protocol. The attacker then guesses the
  authentication frequency based on the lowest bits of two XORed
  SQNs. The researchers' concern was that the authentication frequency
  would reveal some information about the phone usage behavior, e.g.,
  number of phone calls made or number of SMS messages sent.
  There are a number of possible triggers for authentication, so
  such an information leak is not direct, but it can be a concern.
  The impact
  of the attack differs depending on whether the
  SQN generation scheme that is used is time-based or not.<a class="pilcrow" href="#section-7.2-10">¶</a></p>
<p id="section-7.2-11">Similar attacks are possible outside AKA in the cellular paging
  protocols where the attacker can simply send application-layer data, send 
  short messages, or make phone calls to the intended victim and
  observe the air interface (e.g., <span>[<a class="xref" href="#Kune2012">Kune2012</a>]</span> and <span>[<a class="xref" href="#Shaik2016">Shaik2016</a>]</span>). Hussain,
  et al. demonstrated a slightly more sophisticated version of the
  attack that exploits the fact that the 4G paging protocol uses the IMSI
  to calculate the paging timeslot <span>[<a class="xref" href="#Hussain2019">Hussain2019</a>]</span>. As this attack is
  outside AKA, it does not impact EAP-AKA'.<a class="pilcrow" href="#section-7.2-11">¶</a></p>
<p id="section-7.2-12">Finally, bad implementations of EAP-AKA' may not produce pseudonym
  usernames or fast re-authentication identities in a manner that is
  sufficiently secure. While it is not a problem with the protocol
  itself, following the recommendations in <a class="xref" href="#genpfr">Section 5.2</a> can mitigate this concern.<a class="pilcrow" href="#section-7.2-12">¶</a></p>
</section>
</div>
<div id="pm">
<section id="section-7.3">
        <h3 id="name-pervasive-monitoring">
<a class="section-number selfRef" href="#section-7.3">7.3. </a><a class="section-name selfRef" href="#name-pervasive-monitoring">Pervasive Monitoring</a>
        </h3>
<p id="section-7.3-1">As required by <span>[<a class="xref" href="#RFC7258">RFC7258</a>]</span>, work on IETF protocols
  needs to consider the effects of pervasive monitoring and mitigate
  them when possible.<a class="pilcrow" href="#section-7.3-1">¶</a></p>
<p id="section-7.3-2">As described in <a class="xref" href="#vuln">Section 7.2</a>, after the publication of RFC 5448, new
  information has come to light regarding the use of pervasive
  monitoring techniques against many security technologies, including
  AKA-based authentication.<a class="pilcrow" href="#section-7.3-2">¶</a></p>
<p id="section-7.3-3">For AKA, these attacks relate to theft of the long-term, shared-secret 
  key material stored on the cards. Such attacks are
  conceivable, for instance, during the manufacturing process of
  cards, through coercion of the card manufacturers, or during the
  transfer of cards and associated information to an operator. Since
  the publication of reports about such attacks, manufacturing and
  provisioning processes have gained much scrutiny and have
  improved.<a class="pilcrow" href="#section-7.3-3">¶</a></p>
<p id="section-7.3-4">In particular, it is crucial that manufacturers limit access to
  the secret information and the cards only to necessary systems and
  personnel. It is also crucial that secure mechanisms be used to store and
  communicate the secrets between the manufacturer and the operator
  that adopts those cards for their customers.<a class="pilcrow" href="#section-7.3-4">¶</a></p>
<p id="section-7.3-5">Beyond these operational considerations, there are also technical
  means to improve resistance to these attacks. One approach is to
  provide Perfect Forward Secrecy (PFS). This would prevent any
  passive attacks merely based on the long-term secrets and
  observation of traffic. Such a mechanism can be defined as a
  backwards-compatible extension of EAP-AKA' and is pursued
  separately from this specification <span>[<a class="xref" href="#I-D.ietf-emu-aka-pfs">EMU-AKA-PFS</a>]</span>. Alternatively, EAP-AKA'
  authentication can be run inside a PFS-capable, tunneled
  authentication method. In any case, the use of some PFS-capable
  mechanism is recommended.<a class="pilcrow" href="#section-7.3-5">¶</a></p>
</section>
</div>
<div id="bindprop">
<section id="section-7.4">
        <h3 id="name-security-properties-of-bind">
<a class="section-number selfRef" href="#section-7.4">7.4. </a><a class="section-name selfRef" href="#name-security-properties-of-bind">Security Properties of Binding Network Names</a>
        </h3>
<p id="section-7.4-1">The ability of EAP-AKA' to bind the network name into the used keys
provides some additional protection against key leakage to
inappropriate parties. The keys used in the protocol are specific to a
particular network name. If key leakage occurs due to an accident,
access node compromise, or another attack, the leaked keys are only
useful when providing access with that name. For instance, a malicious
access point cannot claim to be network Y if it has stolen keys from
network X.  Obviously, if an access point is compromised, the
malicious node can still represent the compromised node. As a result,
neither EAP-AKA' nor any other extension can prevent such attacks; however,
the binding to a particular name limits the attacker's choices, allows
better tracking of attacks, makes it possible to identify compromised
networks, and applies good cryptographic hygiene.<a class="pilcrow" href="#section-7.4-1">¶</a></p>
<p id="section-7.4-2">The server receives the EAP transaction from a given access
network, and verifies that the claim from the access network
corresponds to the name that this access network should be using. It
becomes impossible for an access network to claim over AAA that it is
another access network. In addition, if the peer checks that the
information it has received locally over the network-access link-layer
matches with the information the server has given it via EAP-AKA', it
becomes impossible for the access network to tell one story to the AAA
network and another one to the peer. These checks prevent some "lying
NAS" (Network Access Server) attacks. For instance, a roaming partner,
R, might claim that it is the home network H in an effort to lure
peers to connect to itself. Such an attack would be beneficial for the
roaming partner if it can attract more users, and damaging for the
users if their access costs in R are higher than those in other
alternative networks, such as H.<a class="pilcrow" href="#section-7.4-2">¶</a></p>
<p id="section-7.4-3">Any attacker who gets hold of the keys CK and IK, produced by the AKA
algorithm, can compute the keys CK' and IK' and, hence, the Master Key (MK)
according to the rules in <a class="xref" href="#key">Section 3.3</a>. The attacker could
then act as a lying NAS. In 3GPP systems in general, the keys CK and
IK have been distributed to, for instance, nodes in a visited access
network where they may be vulnerable. In order to reduce this risk,
the AKA algorithm <span class="bcp14">MUST</span> be computed
with the AMF separation bit set to 1, and the peer <span class="bcp14">MUST</span> check that
this is indeed the case whenever it runs EAP-AKA'. Furthermore,
<span>[<a class="xref" href="#TS-3GPP.33.402">TS-3GPP.33.402</a>]</span> requires that no CK or IK keys computed in this
way ever leave the home subscriber system.<a class="pilcrow" href="#section-7.4-3">¶</a></p>
<p id="section-7.4-4">The additional security benefits obtained from the binding depend
obviously on the way names are assigned to different access
networks. This is specified in <span>[<a class="xref" href="#TS-3GPP.24.302">TS-3GPP.24.302</a>]</span>. See also
<span>[<a class="xref" href="#TS-3GPP.23.003">TS-3GPP.23.003</a>]</span>. Ideally, the names allow separating each
different access technology, each different access network, and each
different NAS within a domain.  If this is not possible, the full
benefits may not be achieved. For instance, if the names identify just
an access technology, use of compromised keys in a different
technology can be prevented, but it is not possible to prevent their
use by other domains or devices using the same technology.<a class="pilcrow" href="#section-7.4-4">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana">
<section id="section-8">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-8">8. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<p id="section-8-1">IANA has updated the "Extensible Authentication Protocol (EAP)
  Registry" and the "EAP-AKA and EAP-SIM Parameters" registry so that entries
  that pointed to RFC 5448 now point to this RFC instead.<a class="pilcrow" href="#section-8-1">¶</a></p>
<div id="typev">
<section id="section-8.1">
        <h3 id="name-type-value">
<a class="section-number selfRef" href="#section-8.1">8.1. </a><a class="section-name selfRef" href="#name-type-value">Type Value</a>
        </h3>
<p id="section-8.1-1">IANA has updated the reference for EAP-AKA' (0x32) in the "Method Types"
  subregistry under the "Extensible Authentication Protocol (EAP) Registry" to point to this document.  
  Per 
  <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc3748#section-6.2">Section 6.2</a> of [<a class="xref" href="#RFC3748">RFC3748</a>]</span>, this allocation can be made with
  Specification Required <span>[<a class="xref" href="#RFC8126">RFC8126</a>]</span>.<a class="pilcrow" href="#section-8.1-1">¶</a></p>
</section>
</div>
<section id="section-8.2">
        <h3 id="name-attribute-type-values">
<a class="section-number selfRef" href="#section-8.2">8.2. </a><a class="section-name selfRef" href="#name-attribute-type-values">Attribute Type Values</a>
        </h3>
<p id="section-8.2-1">EAP-AKA' shares its attribute space and subtypes with EAP-SIM
<span>[<a class="xref" href="#RFC4186">RFC4186</a>]</span> and EAP-AKA <span>[<a class="xref" href="#RFC4187">RFC4187</a>]</span>. No new
registries are needed.<a class="pilcrow" href="#section-8.2-1">¶</a></p>
<p id="section-8.2-2">IANA has updated the reference for AT_KDF_INPUT (23) and AT_KDF (24)  
  in the "Attribute Types (Non-Skippable Attributes 0-127)" subregistry under the "EAP-AKA and
  EAP-SIM Parameters" registry to point to this document.
  AT_KDF_INPUT and AT_KDF are defined in Sections <a class="xref" href="#netbind">3.1</a> and <a class="xref" href="#keyderiv">3.2</a>, respectively, of this document.<a class="pilcrow" href="#section-8.2-2">¶</a></p>
<p id="section-8.2-3">IANA has also updated the reference for AT_BIDDING (136) in the  
  "Attribute Types (Skippable Attributes 128-255)" subregistry of the 
  "EAP-AKA and EAP-SIM Parameters" registry to point to this document.
  AT_BIDDING is defined in <a class="xref" href="#bidding">Section 4</a>.<a class="pilcrow" href="#section-8.2-3">¶</a></p>
</section>
<section id="section-8.3">
        <h3 id="name-key-derivation-function-nam">
<a class="section-number selfRef" href="#section-8.3">8.3. </a><a class="section-name selfRef" href="#name-key-derivation-function-nam">Key Derivation Function Namespace</a>
        </h3>
<p id="section-8.3-1">IANA has updated the reference for the "EAP-AKA' AT_KDF Key Derivation Function Values" 
  subregistry to point to this document.  This subregistry appears under the 
  "EAP-AKA and EAP-SIM Parameters" registry.  The references for following entries have 
  also been updated to point to this document. New values can be created through the 
  Specification Required policy <span>[<a class="xref" href="#RFC8126">RFC8126</a>]</span>.<a class="pilcrow" href="#section-8.3-1">¶</a></p>
<span id="name-eap-aka-at_kdf-key-derivati"></span><table class="center" id="table-3">
          <caption>
<a class="selfRef" href="#table-3">Table 3</a>:
<a class="selfRef" href="#name-eap-aka-at_kdf-key-derivati">EAP-AKA' AT_KDF Key Derivation Function Values</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Value</th>
              <th class="text-left" colspan="1" rowspan="1">Description</th>
              <th class="text-left" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">Reserved</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9048</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">1</td>
              <td class="text-left" colspan="1" rowspan="1">EAP-AKA' with CK'/IK'</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9048</td>
            </tr>
          </tbody>
        </table>
</section>
</section>
</div>
<section id="section-9">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-9">9. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-9.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-9.1">9.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="FIPS.180-4">[FIPS.180-4]</dt>
        <dd>
<span class="refAuthor">National Institute of Standards and Technology</span>, <span class="refTitle">"Secure Hash Standard"</span>, <span class="seriesInfo">FIPS PUB 180-4</span>, <span class="seriesInfo">DOI 10.6028/NIST.FIPS.180-4</span>, <time class="refDate" datetime="2015-08">August 2015</time>, <span>&lt;<a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf">https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2104">[RFC2104]</dt>
        <dd>
<span class="refAuthor">Krawczyk, H.</span>, <span class="refAuthor">Bellare, M.</span>, and <span class="refAuthor">R. Canetti</span>, <span class="refTitle">"HMAC: Keyed-Hashing for Message Authentication"</span>, <span class="seriesInfo">RFC 2104</span>, <span class="seriesInfo">DOI 10.17487/RFC2104</span>, <time class="refDate" datetime="1997-02">February 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2104">https://www.rfc-editor.org/info/rfc2104</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time class="refDate" datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3748">[RFC3748]</dt>
        <dd>
<span class="refAuthor">Aboba, B.</span>, <span class="refAuthor">Blunk, L.</span>, <span class="refAuthor">Vollbrecht, J.</span>, <span class="refAuthor">Carlson, J.</span>, and <span class="refAuthor">H. Levkowetz, Ed.</span>, <span class="refTitle">"Extensible Authentication Protocol (EAP)"</span>, <span class="seriesInfo">RFC 3748</span>, <span class="seriesInfo">DOI 10.17487/RFC3748</span>, <time class="refDate" datetime="2004-06">June 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3748">https://www.rfc-editor.org/info/rfc3748</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4187">[RFC4187]</dt>
        <dd>
<span class="refAuthor">Arkko, J.</span> and <span class="refAuthor">H. Haverinen</span>, <span class="refTitle">"Extensible Authentication Protocol Method for 3rd Generation Authentication and Key Agreement (EAP-AKA)"</span>, <span class="seriesInfo">RFC 4187</span>, <span class="seriesInfo">DOI 10.17487/RFC4187</span>, <time class="refDate" datetime="2006-01">January 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4187">https://www.rfc-editor.org/info/rfc4187</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7542">[RFC7542]</dt>
        <dd>
<span class="refAuthor">DeKok, A.</span>, <span class="refTitle">"The Network Access Identifier"</span>, <span class="seriesInfo">RFC 7542</span>, <span class="seriesInfo">DOI 10.17487/RFC7542</span>, <time class="refDate" datetime="2015-05">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7542">https://www.rfc-editor.org/info/rfc7542</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time class="refDate" datetime="2017-06">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time class="refDate" datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TS-3GPP.23.003">[TS-3GPP.23.003]</dt>
        <dd>
<span class="refAuthor">3GPP</span>, <span class="refTitle">"3rd Generation Partnership Project; Technical Specification Group Core Network and Terminals; Numbering, addressing and identification (Release 16)"</span>, <span class="refContent">Version 16.7.0</span>, <span class="seriesInfo">3GPP Technical Specification 23.003</span>, <time class="refDate" datetime="2021-06">June 2021</time>. </dd>
<dd class="break"></dd>
<dt id="TS-3GPP.23.501">[TS-3GPP.23.501]</dt>
        <dd>
<span class="refAuthor">3GPP</span>, <span class="refTitle">"3rd Generation Partnership Project; Technical Specification Group Services and System Aspects; System architecture for the 5G System (5GS); (Release 16)"</span>, <span class="refContent">Version 16.9.0</span>, <span class="seriesInfo">3GPP Technical Specification 23.501</span>, <time class="refDate" datetime="2021-06">June 2021</time>. </dd>
<dd class="break"></dd>
<dt id="TS-3GPP.24.302">[TS-3GPP.24.302]</dt>
        <dd>
<span class="refAuthor">3GPP</span>, <span class="refTitle">"3rd Generation Partnership Project; Technical Specification Group Core Network and Terminals; Access to the 3GPP Evolved Packet Core (EPC) via non-3GPP access networks; Stage 3; (Release 16)"</span>, <span class="refContent">Version 16.4.0</span>, <span class="seriesInfo">3GPP Technical Specification 24.302</span>, <time class="refDate" datetime="2020-07">July 2020</time>. </dd>
<dd class="break"></dd>
<dt id="TS-3GPP.24.501">[TS-3GPP.24.501]</dt>
        <dd>
<span class="refAuthor">3GPP</span>, <span class="refTitle">"3rd Generation Partnership Project; Technical Specification Group Core Network and Terminals; Non-Access-Stratum (NAS) protocol for 5G System (5GS); Stage 3; (Release 16)"</span>, <span class="refContent">Version 16.9.0</span>, <span class="seriesInfo">3GPP Draft Technical Specification 24.501</span>, <time class="refDate" datetime="2021-06">June 2021</time>. </dd>
<dd class="break"></dd>
<dt id="TS-3GPP.33.102">[TS-3GPP.33.102]</dt>
        <dd>
<span class="refAuthor">3GPP</span>, <span class="refTitle">"3rd Generation Partnership Project; Technical Specification Group Services and System Aspects; 3G Security; Security architecture (Release 16)"</span>, <span class="refContent">Version 16.0.0</span>, <span class="seriesInfo">3GPP Technical Specification 33.102</span>, <time class="refDate" datetime="2020-07">July 2020</time>. </dd>
<dd class="break"></dd>
<dt id="TS-3GPP.33.402">[TS-3GPP.33.402]</dt>
        <dd>
<span class="refAuthor">3GPP</span>, <span class="refTitle">"3GPP System Architecture Evolution (SAE); Security aspects of non-3GPP accesses (Release 16)"</span>, <span class="refContent">Version 16.0.0</span>, <span class="seriesInfo">3GPP Technical Specification 33.402</span>, <time class="refDate" datetime="2020-07">July 2020</time>. </dd>
<dd class="break"></dd>
<dt id="TS-3GPP.33.501">[TS-3GPP.33.501]</dt>
      <dd>
<span class="refAuthor">3GPP</span>, <span class="refTitle">"3rd Generation Partnership Project; Technical Specification Group Services and System Aspects; 3G Security; Security architecture and procedures for 5G System (Release 16)"</span>, <span class="refContent">Version 16.7.1</span>, <span class="seriesInfo">3GPP Technical Specification 33.501</span>, <time class="refDate" datetime="2021-07">July 2021</time>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-9.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-9.2">9.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="Arapinis2012">[Arapinis2012]</dt>
        <dd>
<span class="refAuthor">Arapinis, M.</span>, <span class="refAuthor">Mancini, L.</span>, <span class="refAuthor">Ritter, E.</span>, <span class="refAuthor">Ryan, M.</span>, <span class="refAuthor">Golde, N.</span>, <span class="refAuthor">Redon, R.</span>, and <span class="refAuthor">R. Borgaonkar</span>, <span class="refTitle">"New Privacy Issues in Mobile Telephony: Fix and Verification"</span>, <span class="refContent">in CCS '12: Proceedings of the 2012 ACM Conference on Computer and Communications Security, Raleigh, North Carolina, USA</span>, <span class="seriesInfo">DOI 10.1145/2382196.2382221</span>, <time class="refDate" datetime="2012-10">October 2012</time>, <span>&lt;<a href="https://doi.org/10.1145/2382196.2382221">https://doi.org/10.1145/2382196.2382221</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Basin2018">[Basin2018]</dt>
        <dd>
<span class="refAuthor">Basin, D.</span>, <span class="refAuthor">Dreier, J.</span>, <span class="refAuthor">Hirschi, L.</span>, <span class="refAuthor">Radomirović, S.</span>, <span class="refAuthor">Sasse, R.</span>, and <span class="refAuthor">V. Stettler</span>, <span class="refTitle">"A Formal Analysis of 5G Authentication"</span>, <span class="refContent">arXiv:1806.10360</span>, <span class="seriesInfo">DOI 10.1145/3243734.3243846</span>, <time class="refDate" datetime="2018-08">August 2018</time>, <span>&lt;<a href="https://doi.org/10.1145/3243734.3243846">https://doi.org/10.1145/3243734.3243846</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Borgaonkar2018">[Borgaonkar2018]</dt>
        <dd>
<span class="refAuthor">Borgaonkar, R.</span>, <span class="refAuthor">Hirschi, L.</span>, <span class="refAuthor">Park, S.</span>, and <span class="refAuthor">A. Shaik</span>, <span class="refTitle">"New Privacy Threat on 3G, 4G, and Upcoming 5G AKA Protocols"</span>, <span class="refContent">in IACR Cryptology ePrint Archive</span>, <time class="refDate" datetime="2018">2018</time>. </dd>
<dd class="break"></dd>
<dt id="BT2013">[BT2013]</dt>
        <dd>
<span class="refAuthor">Beekman, J. G.</span> and <span class="refAuthor">C. Thompson</span>, <span class="refTitle">"Breaking Cell Phone Authentication: Vulnerabilities in AKA, IMS and Android"</span>, <span class="refContent">in 7th USENIX Workshop on Offensive Technologies, WOOT '13</span>, <time class="refDate" datetime="2013-08">August 2013</time>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-emu-aka-pfs">[EMU-AKA-PFS]</dt>
        <dd>
<span class="refAuthor">Arkko, J.</span>, <span class="refAuthor">Norrman, K.</span>, and <span class="refAuthor">V. Torvinen</span>, <span class="refTitle">"Perfect-Forward Secrecy for the Extensible Authentication Protocol Method for Authentication and Key Agreement (EAP-AKA' PFS)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-emu-aka-pfs-05</span>, <time class="refDate" datetime="2020-10-30">30 October 2020</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-emu-aka-pfs-05">https://datatracker.ietf.org/doc/html/draft-ietf-emu-aka-pfs-05</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="FIPS.180-1">[FIPS.180-1]</dt>
        <dd>
<span class="refAuthor">National Institute of Standards and Technology</span>, <span class="refTitle">"Secure Hash Standard"</span>, <span class="seriesInfo">FIPS PUB 180-1</span>, <span class="seriesInfo">DOI 10.6028/NIST.FIPS.180-1</span>, <time class="refDate" datetime="1995-04">April 1995</time>, <span>&lt;<a href="https://csrc.nist.gov/publications/detail/fips/180/1/archive/1995-04-17">https://csrc.nist.gov/publications/detail/fips/180/1/archive/1995-04-17</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="FIPS.180-2">[FIPS.180-2]</dt>
        <dd>
<span class="refAuthor">National Institute of Standards and Technology</span>, <span class="refTitle">"Secure Hash Standard"</span>, <span class="seriesInfo">FIPS PUB 180-2</span>, <time class="refDate" datetime="2002-08">August 2002</time>, <span>&lt;<a href="https://csrc.nist.gov/publications/detail/fips/180/2/archive/2002-08-01">https://csrc.nist.gov/publications/detail/fips/180/2/archive/2002-08-01</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Heist2015">[Heist2015]</dt>
        <dd>
<span class="refAuthor">Scahill, J.</span> and <span class="refAuthor">J. Begley</span>, <span class="refTitle">"How Spies Stole the Keys to the Encryption Castle"</span>, <time class="refDate" datetime="2015-02">February 2015</time>, <span>&lt;<a href="https://firstlook.org/theintercept/2015/02/19/great-sim-heist/">https://firstlook.org/theintercept/2015/02/19/great-sim-heist/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Hussain2019">[Hussain2019]</dt>
        <dd>
<span class="refAuthor">Hussain, S.</span>, <span class="refAuthor">Echeverria, M.</span>, <span class="refAuthor">Chowdhury, O.</span>, <span class="refAuthor">Li, N.</span>, and <span class="refAuthor">E. Bertino</span>, <span class="refTitle">"Privacy Attacks to the 4G and 5G Cellular Paging Protocols Using Side Channel Information"</span>, <span class="refContent">in the proceedings of NDSS '19, held 24-27 February, 2019, San Diego, California</span>, <time class="refDate" datetime="2019">2019</time>. </dd>
<dd class="break"></dd>
<dt id="Kune2012">[Kune2012]</dt>
        <dd>
<span class="refAuthor">Kune, D.</span>, <span class="refAuthor">Koelndorfer, J.</span>, <span class="refAuthor">Hopper, N.</span>, and <span class="refAuthor">Y. Kim</span>, <span class="refTitle">"Location Leaks on the GSM Air Interface"</span>, <span class="refContent">in the proceedings of NDSS '12, held 5-8 February, 2012, San Diego, California</span>, <time class="refDate" datetime="2012">2012</time>. </dd>
<dd class="break"></dd>
<dt id="MT2012">[MT2012]</dt>
        <dd>
<span class="refAuthor">Mjølsnes, S. F.</span> and <span class="refAuthor">J-K. Tsay</span>, <span class="refTitle">"A Vulnerability in the UMTS and LTE Authentication and Key Agreement Protocols"</span>, <span class="refContent">in Computer Network Security, Proceedings of the 6th International Conference on Mathematical Methods, Models and Architectures for Computer Network Security, Lecture Notes in Computer Science, Vol. 7531, pp. 65-76</span>, <span class="seriesInfo">DOI 10.1007/978-3-642-33704-8_6</span>, <time class="refDate" datetime="2012-10">October 2012</time>, <span>&lt;<a href="https://doi.org/10.1007/978-3-642-33704-8_6">https://doi.org/10.1007/978-3-642-33704-8_6</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3310">[RFC3310]</dt>
        <dd>
<span class="refAuthor">Niemi, A.</span>, <span class="refAuthor">Arkko, J.</span>, and <span class="refAuthor">V. Torvinen</span>, <span class="refTitle">"Hypertext Transfer Protocol (HTTP) Digest Authentication Using Authentication and Key Agreement (AKA)"</span>, <span class="seriesInfo">RFC 3310</span>, <span class="seriesInfo">DOI 10.17487/RFC3310</span>, <time class="refDate" datetime="2002-09">September 2002</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3310">https://www.rfc-editor.org/info/rfc3310</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4086">[RFC4086]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refAuthor">Schiller, J.</span>, and <span class="refAuthor">S. Crocker</span>, <span class="refTitle">"Randomness Requirements for Security"</span>, <span class="seriesInfo">BCP 106</span>, <span class="seriesInfo">RFC 4086</span>, <span class="seriesInfo">DOI 10.17487/RFC4086</span>, <time class="refDate" datetime="2005-06">June 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4086">https://www.rfc-editor.org/info/rfc4086</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4169">[RFC4169]</dt>
        <dd>
<span class="refAuthor">Torvinen, V.</span>, <span class="refAuthor">Arkko, J.</span>, and <span class="refAuthor">M. Naslund</span>, <span class="refTitle">"Hypertext Transfer Protocol (HTTP) Digest Authentication Using Authentication and Key Agreement (AKA) Version-2"</span>, <span class="seriesInfo">RFC 4169</span>, <span class="seriesInfo">DOI 10.17487/RFC4169</span>, <time class="refDate" datetime="2005-11">November 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4169">https://www.rfc-editor.org/info/rfc4169</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4186">[RFC4186]</dt>
        <dd>
<span class="refAuthor">Haverinen, H., Ed.</span> and <span class="refAuthor">J. Salowey, Ed.</span>, <span class="refTitle">"Extensible Authentication Protocol Method for Global System for Mobile Communications (GSM) Subscriber Identity Modules (EAP-SIM)"</span>, <span class="seriesInfo">RFC 4186</span>, <span class="seriesInfo">DOI 10.17487/RFC4186</span>, <time class="refDate" datetime="2006-01">January 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4186">https://www.rfc-editor.org/info/rfc4186</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4284">[RFC4284]</dt>
        <dd>
<span class="refAuthor">Adrangi, F.</span>, <span class="refAuthor">Lortz, V.</span>, <span class="refAuthor">Bari, F.</span>, and <span class="refAuthor">P. Eronen</span>, <span class="refTitle">"Identity Selection Hints for the Extensible Authentication Protocol (EAP)"</span>, <span class="seriesInfo">RFC 4284</span>, <span class="seriesInfo">DOI 10.17487/RFC4284</span>, <time class="refDate" datetime="2006-01">January 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4284">https://www.rfc-editor.org/info/rfc4284</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4306">[RFC4306]</dt>
        <dd>
<span class="refAuthor">Kaufman, C., Ed.</span>, <span class="refTitle">"Internet Key Exchange (IKEv2) Protocol"</span>, <span class="seriesInfo">RFC 4306</span>, <span class="seriesInfo">DOI 10.17487/RFC4306</span>, <time class="refDate" datetime="2005-12">December 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4306">https://www.rfc-editor.org/info/rfc4306</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5113">[RFC5113]</dt>
        <dd>
<span class="refAuthor">Arkko, J.</span>, <span class="refAuthor">Aboba, B.</span>, <span class="refAuthor">Korhonen, J., Ed.</span>, and <span class="refAuthor">F. Bari</span>, <span class="refTitle">"Network Discovery and Selection Problem"</span>, <span class="seriesInfo">RFC 5113</span>, <span class="seriesInfo">DOI 10.17487/RFC5113</span>, <time class="refDate" datetime="2008-01">January 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5113">https://www.rfc-editor.org/info/rfc5113</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5247">[RFC5247]</dt>
        <dd>
<span class="refAuthor">Aboba, B.</span>, <span class="refAuthor">Simon, D.</span>, and <span class="refAuthor">P. Eronen</span>, <span class="refTitle">"Extensible Authentication Protocol (EAP) Key Management Framework"</span>, <span class="seriesInfo">RFC 5247</span>, <span class="seriesInfo">DOI 10.17487/RFC5247</span>, <time class="refDate" datetime="2008-08">August 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5247">https://www.rfc-editor.org/info/rfc5247</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5281">[RFC5281]</dt>
        <dd>
<span class="refAuthor">Funk, P.</span> and <span class="refAuthor">S. Blake-Wilson</span>, <span class="refTitle">"Extensible Authentication Protocol Tunneled Transport Layer Security Authenticated Protocol Version 0 (EAP-TTLSv0)"</span>, <span class="seriesInfo">RFC 5281</span>, <span class="seriesInfo">DOI 10.17487/RFC5281</span>, <time class="refDate" datetime="2008-08">August 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5281">https://www.rfc-editor.org/info/rfc5281</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5448">[RFC5448]</dt>
        <dd>
<span class="refAuthor">Arkko, J.</span>, <span class="refAuthor">Lehtovirta, V.</span>, and <span class="refAuthor">P. Eronen</span>, <span class="refTitle">"Improved Extensible Authentication Protocol Method for 3rd Generation Authentication and Key Agreement (EAP-AKA')"</span>, <span class="seriesInfo">RFC 5448</span>, <span class="seriesInfo">DOI 10.17487/RFC5448</span>, <time class="refDate" datetime="2009-05">May 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5448">https://www.rfc-editor.org/info/rfc5448</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6194">[RFC6194]</dt>
        <dd>
<span class="refAuthor">Polk, T.</span>, <span class="refAuthor">Chen, L.</span>, <span class="refAuthor">Turner, S.</span>, and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Security Considerations for the SHA-0 and SHA-1 Message-Digest Algorithms"</span>, <span class="seriesInfo">RFC 6194</span>, <span class="seriesInfo">DOI 10.17487/RFC6194</span>, <time class="refDate" datetime="2011-03">March 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6194">https://www.rfc-editor.org/info/rfc6194</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6973">[RFC6973]</dt>
        <dd>
<span class="refAuthor">Cooper, A.</span>, <span class="refAuthor">Tschofenig, H.</span>, <span class="refAuthor">Aboba, B.</span>, <span class="refAuthor">Peterson, J.</span>, <span class="refAuthor">Morris, J.</span>, <span class="refAuthor">Hansen, M.</span>, and <span class="refAuthor">R. Smith</span>, <span class="refTitle">"Privacy Considerations for Internet Protocols"</span>, <span class="seriesInfo">RFC 6973</span>, <span class="seriesInfo">DOI 10.17487/RFC6973</span>, <time class="refDate" datetime="2013-07">July 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6973">https://www.rfc-editor.org/info/rfc6973</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7170">[RFC7170]</dt>
        <dd>
<span class="refAuthor">Zhou, H.</span>, <span class="refAuthor">Cam-Winget, N.</span>, <span class="refAuthor">Salowey, J.</span>, and <span class="refAuthor">S. Hanna</span>, <span class="refTitle">"Tunnel Extensible Authentication Protocol (TEAP) Version 1"</span>, <span class="seriesInfo">RFC 7170</span>, <span class="seriesInfo">DOI 10.17487/RFC7170</span>, <time class="refDate" datetime="2014-05">May 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7170">https://www.rfc-editor.org/info/rfc7170</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7258">[RFC7258]</dt>
        <dd>
<span class="refAuthor">Farrell, S.</span> and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Pervasive Monitoring Is an Attack"</span>, <span class="seriesInfo">BCP 188</span>, <span class="seriesInfo">RFC 7258</span>, <span class="seriesInfo">DOI 10.17487/RFC7258</span>, <time class="refDate" datetime="2014-05">May 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7258">https://www.rfc-editor.org/info/rfc7258</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7296">[RFC7296]</dt>
        <dd>
<span class="refAuthor">Kaufman, C.</span>, <span class="refAuthor">Hoffman, P.</span>, <span class="refAuthor">Nir, Y.</span>, <span class="refAuthor">Eronen, P.</span>, and <span class="refAuthor">T. Kivinen</span>, <span class="refTitle">"Internet Key Exchange Protocol Version 2 (IKEv2)"</span>, <span class="seriesInfo">STD 79</span>, <span class="seriesInfo">RFC 7296</span>, <span class="seriesInfo">DOI 10.17487/RFC7296</span>, <time class="refDate" datetime="2014-10">October 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7296">https://www.rfc-editor.org/info/rfc7296</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Shaik2016">[Shaik2016]</dt>
        <dd>
<span class="refAuthor">Shaik, A.</span>, <span class="refAuthor">Seifert, J.</span>, <span class="refAuthor">Borgaonkar, R.</span>, <span class="refAuthor">Asokan, N.</span>, and <span class="refAuthor">V. Niemi</span>, <span class="refTitle">"Practical attacks against Privacy and Availability in 4G/LTE Mobile Communication Systems"</span>, <span class="refContent">in the proceedings of NDSS '16 held 21-24 February, 2016, San Diego, California</span>, <time class="refDate" datetime="2012">2012</time>. </dd>
<dd class="break"></dd>
<dt id="TS-3GPP.35.208">[TS-3GPP.35.208]</dt>
        <dd>
<span class="refAuthor">3GPP</span>, <span class="refTitle">"3rd Generation Partnership Project; Technical Specification Group Services and System Aspects; 3G Security; Specification of the MILENAGE Algorithm Set: An example algorithm set for the 3GPP authentication and key generation functions f1, f1*, f2, f3, f4, f5 and f5*; Document 4: Design Conformance Test Data (Release 14)"</span>, <span class="refContent">Version 16.0.0</span>, <span class="seriesInfo">3GPP Technical Specification 35.208</span>, <time class="refDate" datetime="2020-07">July 2020</time>. </dd>
<dd class="break"></dd>
<dt id="ZF2005">[ZF2005]</dt>
      <dd>
<span class="refAuthor">Zhang, M.</span> and <span class="refAuthor">Y. Fang</span>, <span class="refTitle">"Security analysis and enhancements of 3GPP authentication and key agreement protocol"</span>, <span class="refContent">IEEE Transactions on Wireless Communications, Vol. 4, No. 2</span>, <span class="seriesInfo">DOI 10.1109/TWC.2004.842941</span>, <time class="refDate" datetime="2005-03">March 2005</time>, <span>&lt;<a href="https://doi.org/10.1109/TWC.2004.842941">https://doi.org/10.1109/TWC.2004.842941</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="diff2">
<section id="appendix-A">
      <h2 id="name-changes-from-rfc-5448">
<a class="section-number selfRef" href="#appendix-A">Appendix A. </a><a class="section-name selfRef" href="#name-changes-from-rfc-5448">Changes from RFC 5448</a>
      </h2>
<p id="appendix-A-1">The change from RFC 5448 was to refer to a newer version
  of <span>[<a class="xref" href="#TS-3GPP.24.302">TS-3GPP.24.302</a>]</span>. This RFC
  includes an updated definition of the Network Name field to
  include 5G.<a class="pilcrow" href="#appendix-A-1">¶</a></p>
<p id="appendix-A-2">Identifier usage for 5G has been specified in <a class="xref" href="#identifiersin5g">Section 5.3</a>. Also, the requirements for generating
  pseudonym usernames and fast re-authentication identities have been
  updated from the original definition in RFC 5448, which referenced
  RFC 4187. See <a class="xref" href="#identities">Section 5</a>.<a class="pilcrow" href="#appendix-A-2">¶</a></p>
<p id="appendix-A-3">Exported parameters for EAP-AKA' have been defined in
  <a class="xref" href="#exported-parameters">Section 6</a>, as required by <span>[<a class="xref" href="#RFC5247">RFC5247</a>]</span>, including the definition of those parameters for
  both full authentication and fast re-authentication.<a class="pilcrow" href="#appendix-A-3">¶</a></p>
<p id="appendix-A-4">The security, privacy, and pervasive monitoring considerations
  have been updated or added. See <a class="xref" href="#security">Section 7</a>.<a class="pilcrow" href="#appendix-A-4">¶</a></p>
<p id="appendix-A-5">The references to <span>[<a class="xref" href="#RFC2119">RFC2119</a>]</span>, <span>[<a class="xref" href="#RFC4306">RFC4306</a>]</span>, <span>[<a class="xref" href="#RFC7296">RFC7296</a>]</span>, <span>[<a class="xref" href="#FIPS.180-1">FIPS.180-1</a>]</span> and <span>[<a class="xref" href="#FIPS.180-2">FIPS.180-2</a>]</span> have been updated to their most recent
  versions, and language in this document has been changed
  accordingly. However, these are merely reference updates to newer specifications;
  the actual protocol functions are the same as defined in the earlier RFCs.<a class="pilcrow" href="#appendix-A-5">¶</a></p>
<p id="appendix-A-6"> Similarly, references to all 3GPP technical specifications have been
updated to their 5G versions (Release 16) or otherwise most recent
version when there has not been a 5G-related update.<a class="pilcrow" href="#appendix-A-6">¶</a></p>
<p id="appendix-A-7">Finally, a number of clarifications have been made, including a
  summary of where attributes may appear.<a class="pilcrow" href="#appendix-A-7">¶</a></p>
</section>
</div>
<div id="diff">
<section id="appendix-B">
      <h2 id="name-changes-to-rfc-4187">
<a class="section-number selfRef" href="#appendix-B">Appendix B. </a><a class="section-name selfRef" href="#name-changes-to-rfc-4187">Changes to RFC 4187</a>
      </h2>
<p id="appendix-B-1">In addition to specifying EAP-AKA', this document also mandates a
  change to another EAP method -- EAP-AKA that was defined in RFC 4187.
  This change was already mandated in RFC 5448 but repeated here to
  ensure that the latest EAP-AKA' specification contains the instructions
  about the necessary bidding down prevention feature in EAP-AKA as well.<a class="pilcrow" href="#appendix-B-1">¶</a></p>
<p id="appendix-B-2">The changes to RFC 4187 relate only to the bidding down
  prevention support defined in <a class="xref" href="#bidding">Section 4</a>. In
  particular, this document does not change how the Master Key (MK) is
  calculated or any other aspect of EAP-AKA. The provisions in this
  specification for EAP-AKA' do not apply to EAP-AKA, outside of <a class="xref" href="#bidding">Section 4</a>.<a class="pilcrow" href="#appendix-B-2">¶</a></p>
</section>
</div>
<div id="baddesign">
<section id="appendix-C">
      <h2 id="name-importance-of-explicit-nego">
<a class="section-number selfRef" href="#appendix-C">Appendix C. </a><a class="section-name selfRef" href="#name-importance-of-explicit-nego">Importance of Explicit Negotiation</a>
      </h2>
<p id="appendix-C-1">Choosing between the traditional and revised AKA key derivation
functions is easy when their use is unambiguously tied to a particular
radio access network, e.g., Long Term Evolution (LTE) as defined by 3GPP
or evolved High Rate Packet Data (eHRPD) as defined by 3GPP2. There is
no possibility for interoperability problems if this radio access
network is always used in conjunction with new protocols that cannot
be mixed with the old ones; clients will always know whether they are
connecting to the old or new system.<a class="pilcrow" href="#appendix-C-1">¶</a></p>
<p id="appendix-C-2">However, using the new key derivation functions over EAP introduces
several degrees of separation, making the choice of the correct key
derivation functions much harder. Many different types of networks
employ EAP. Most of these networks have no means to carry any
information about what is expected from the authentication process.
EAP itself is severely limited in carrying any additional information,
as noted in <span>[<a class="xref" href="#RFC4284">RFC4284</a>]</span> and
<span>[<a class="xref" href="#RFC5113">RFC5113</a>]</span>. Even if these networks or EAP were extended
to carry additional information, it would not affect millions of
deployed access networks and clients attaching to them.<a class="pilcrow" href="#appendix-C-2">¶</a></p>
<p id="appendix-C-3">Simply changing the key derivation functions that EAP-AKA
<span>[<a class="xref" href="#RFC4187">RFC4187</a>]</span> uses would cause interoperability problems
with all of the existing implementations. Perhaps it would be possible
to employ strict separation into domain names that should be used by
the new clients and networks. Only these new devices would then employ
the new key derivation function. While this can be made to work for
specific cases, it would be an extremely brittle mechanism, ripe to
result in problems whenever client configuration, routing of
authentication requests, or server configuration does not match
expectations. It also does not help to assume that the EAP client and
server are running a particular release of 3GPP network
specifications. Network vendors often provide features from future
releases early or do not provide all features of the current
release. And obviously, there are many EAP and even some EAP-AKA
implementations that are not bundled with the 3GPP network
offerings. In general, these approaches are expected to lead to
hard-to-diagnose problems and increased support calls.<a class="pilcrow" href="#appendix-C-3">¶</a></p>
</section>
</div>
<div id="testvectors">
<section id="appendix-D">
      <h2 id="name-test-vectors">
<a class="section-number selfRef" href="#appendix-D">Appendix D. </a><a class="section-name selfRef" href="#name-test-vectors">Test Vectors</a>
      </h2>
<p id="appendix-D-1">Test vectors are provided below for four different cases.  The test
   vectors may be useful for testing implementations.  In the first two
   cases, we employ the MILENAGE algorithm and the algorithm
   configuration parameters (the subscriber key K and operator algorithm
   variant configuration value OP) from test set 19 in <span>[<a class="xref" href="#TS-3GPP.35.208">TS-3GPP.35.208</a>]</span>.<a class="pilcrow" href="#appendix-D-1">¶</a></p>
<p id="appendix-D-2">The last two cases use artificial values as the output of AKA, which are
   useful only for testing the computation of values within EAP-AKA',
      not AKA itself.<a class="pilcrow" href="#appendix-D-2">¶</a></p>
<p id="appendix-D-3">Case 1<a class="pilcrow" href="#appendix-D-3">¶</a></p>
<div id="appendix-D-4">
<pre class="lang-test-vectors sourcecode">   The parameters for the AKA run are as follows:

      Identity:     "0555444333222111"

      Network name: "WLAN"

      RAND:         81e9 2b6c 0ee0 e12e bceb a8d9 2a99 dfa5

      AUTN:         bb52 e91c 747a c3ab 2a5c 23d1 5ee3 51d5

      IK:           9744 871a d32b f9bb d1dd 5ce5 4e3e 2e5a

      CK:           5349 fbe0 9864 9f94 8f5d 2e97 3a81 c00f

      RES:          28d7 b0f2 a2ec 3de5

   Then the derived keys are generated as follows:

      CK':          0093 962d 0dd8 4aa5 684b 045c 9edf fa04

      IK':          ccfc 230c a74f cc96 c0a5 d611 64f5 a76c

      K_encr:       766f a0a6 c317 174b 812d 52fb cd11 a179

      K_aut:        0842 ea72 2ff6 835b fa20 3249 9fc3 ec23
                    c2f0 e388 b4f0 7543 ffc6 77f1 696d 71ea

      K_re:         cf83 aa8b c7e0 aced 892a cc98 e76a 9b20
                    95b5 58c7 795c 7094 715c b339 3aa7 d17a

      MSK:          67c4 2d9a a56c 1b79 e295 e345 9fc3 d187
                    d42b e0bf 818d 3070 e362 c5e9 67a4 d544
                    e8ec fe19 358a b303 9aff 03b7 c930 588c
                    055b abee 58a0 2650 b067 ec4e 9347 c75a

      EMSK:         f861 703c d775 590e 16c7 679e a387 4ada
                    8663 11de 2907 64d7 60cf 76df 647e a01c
                    313f 6992 4bdd 7650 ca9b ac14 1ea0 75c4
                    ef9e 8029 c0e2 90cd bad5 638b 63bc 23fb
</pre><a class="pilcrow" href="#appendix-D-4">¶</a>
</div>
<p id="appendix-D-5">Case 2<a class="pilcrow" href="#appendix-D-5">¶</a></p>
<div id="appendix-D-6">
<pre class="lang-test-vectors sourcecode">   The parameters for the AKA run are as follows:

      Identity:     "0555444333222111"

      Network name: "HRPD"

      RAND:         81e9 2b6c 0ee0 e12e bceb a8d9 2a99 dfa5

      AUTN:         bb52 e91c 747a c3ab 2a5c 23d1 5ee3 51d5

      IK:           9744 871a d32b f9bb d1dd 5ce5 4e3e 2e5a

      CK:           5349 fbe0 9864 9f94 8f5d 2e97 3a81 c00f

      RES:          28d7 b0f2 a2ec 3de5

   Then the derived keys are generated as follows:

      CK':          3820 f027 7fa5 f777 32b1 fb1d 90c1 a0da

      IK':          db94 a0ab 557e f6c9 ab48 619c a05b 9a9f

      K_encr:       05ad 73ac 915f ce89 ac77 e152 0d82 187b

      K_aut:        5b4a caef 62c6 ebb8 882b 2f3d 534c 4b35
                    2773 37a0 0184 f20f f25d 224c 04be 2afd

      K_re:         3f90 bf5c 6e5e f325 ff04 eb5e f653 9fa8
                    cca8 3981 94fb d00b e425 b3f4 0dba 10ac

      MSK:          87b3 2157 0117 cd6c 95ab 6c43 6fb5 073f
                    f15c f855 05d2 bc5b b735 5fc2 1ea8 a757
                    57e8 f86a 2b13 8002 e057 5291 3bb4 3b82
                    f868 a961 17e9 1a2d 95f5 2667 7d57 2900

      EMSK:         c891 d5f2 0f14 8a10 0755 3e2d ea55 5c9c
                    b672 e967 5f4a 66b4 bafa 0273 79f9 3aee
                    539a 5979 d0a0 042b 9d2a e28b ed3b 17a3
                    1dc8 ab75 072b 80bd 0c1d a612 466e 402c
</pre><a class="pilcrow" href="#appendix-D-6">¶</a>
</div>
<p id="appendix-D-7">Case 3<a class="pilcrow" href="#appendix-D-7">¶</a></p>
<div id="appendix-D-8">
<pre class="lang-test-vectors sourcecode">   The parameters for the AKA run are as follows:

      Identity:     "0555444333222111"

      Network name: "WLAN"

      RAND:         e0e0 e0e0 e0e0 e0e0 e0e0 e0e0 e0e0 e0e0

      AUTN:         a0a0 a0a0 a0a0 a0a0 a0a0 a0a0 a0a0 a0a0

      IK:           b0b0 b0b0 b0b0 b0b0 b0b0 b0b0 b0b0 b0b0

      CK:           c0c0 c0c0 c0c0 c0c0 c0c0 c0c0 c0c0 c0c0

      RES:          d0d0 d0d0 d0d0 d0d0 d0d0 d0d0 d0d0 d0d0

   Then the derived keys are generated as follows:

      CK':          cd4c 8e5c 68f5 7dd1 d7d7 dfd0 c538 e577

      IK':          3ece 6b70 5dbb f7df c459 a112 80c6 5524

      K_encr:       897d 302f a284 7416 488c 28e2 0dcb 7be4

      K_aut:        c407 00e7 7224 83ae 3dc7 139e b0b8 8bb5
                    58cb 3081 eccd 057f 9207 d128 6ee7 dd53

      K_re:         0a59 1a22 dd8b 5b1c f29e 3d50 8c91 dbbd
                    b4ae e230 5189 2c42 b6a2 de66 ea50 4473

      MSK:          9f7d ca9e 37bb 2202 9ed9 86e7 cd09 d4a7
                    0d1a c76d 9553 5c5c ac40 a750 4699 bb89
                    61a2 9ef6 f3e9 0f18 3de5 861a d1be dc81
                    ce99 1639 1b40 1aa0 06c9 8785 a575 6df7

      EMSK:         724d e00b db9e 5681 87be 3fe7 4611 4557
                    d501 8779 537e e37f 4d3c 6c73 8cb9 7b9d
                    c651 bc19 bfad c344 ffe2 b52c a78b d831
                    6b51 dacc 5f2b 1440 cb95 1552 1cc7 ba23
</pre><a class="pilcrow" href="#appendix-D-8">¶</a>
</div>
<p id="appendix-D-9">Case 4<a class="pilcrow" href="#appendix-D-9">¶</a></p>
<div id="appendix-D-10">
<pre class="lang-test-vectors sourcecode">   The parameters for the AKA run are as follows:

      Identity:     "0555444333222111"

      Network name: "HRPD"

      RAND:         e0e0 e0e0 e0e0 e0e0 e0e0 e0e0 e0e0 e0e0

      AUTN:         a0a0 a0a0 a0a0 a0a0 a0a0 a0a0 a0a0 a0a0

      IK:           b0b0 b0b0 b0b0 b0b0 b0b0 b0b0 b0b0 b0b0

      CK:           c0c0 c0c0 c0c0 c0c0 c0c0 c0c0 c0c0 c0c0

      RES:          d0d0 d0d0 d0d0 d0d0 d0d0 d0d0 d0d0 d0d0

   Then the derived keys are generated as follows:

      CK':          8310 a71c e6f7 5488 9613 da8f 64d5 fb46

      IK':          5adf 1436 0ae8 3819 2db2 3f6f cb7f 8c76

      K_encr:       745e 7439 ba23 8f50 fcac 4d15 d47c d1d9

      K_aut:        3e1d 2aa4 e677 025c fd86 2a4b e183 61a1
                    3a64 5765 5714 63df 833a 9759 e809 9879

      K_re:         99da 835e 2ae8 2462 576f e651 6fad 1f80
                    2f0f a119 1655 dd0a 273d a96d 04e0 fcd3

      MSK:          c6d3 a6e0 ceea 951e b20d 74f3 2c30 61d0
                    680a 04b0 b086 ee87 00ac e3e0 b95f a026
                    83c2 87be ee44 4322 94ff 98af 26d2 cc78
                    3bac e75c 4b0a f7fd feb5 511b a8e4 cbd0

      EMSK:         7fb5 6813 838a dafa 99d1 40c2 f198 f6da
                    cebf b6af ee44 4961 1054 02b5 08c7 f363
                    352c b291 9644 b504 63e6 a693 5415 0147
                    ae09 cbc5 4b8a 651d 8787 a689 3ed8 536d
</pre><a class="pilcrow" href="#appendix-D-10">¶</a>
</div>
</section>
</div>
<section id="appendix-E">
      <h2 id="name-acknowledgments">
<a class="section-name selfRef" href="#name-acknowledgments">Acknowledgments</a>
      </h2>
<p id="appendix-E-1">The authors would like to thank <span class="contact-name">Guenther       Horn</span>, <span class="contact-name">Joe Salowey</span>, <span class="contact-name">Mats Naslund</span>, <span class="contact-name">Adrian Escott</span>,
      <span class="contact-name">Brian Rosenberg</span>, <span class="contact-name">Laksminath Dondeti</span>, <span class="contact-name">Ahmad       Muhanna</span>, <span class="contact-name">Stefan Rommer</span>, <span class="contact-name">Miguel Garcia</span>, <span class="contact-name">Jan Kall</span>,
      <span class="contact-name">Ankur Agarwal</span>, <span class="contact-name">Jouni       Malinen</span>, <span class="contact-name">John Mattsson</span>, <span class="contact-name">Jesus De Gregorio</span>, <span class="contact-name">Brian       Weis</span>, <span class="contact-name">Russ Housley</span>, <span class="contact-name">Alfred Hoenes</span>, <span class="contact-name">Anand       Palanigounder</span>, <span class="contact-name">Michael Richardson</span>,
      <span class="contact-name">Roman Danyliw</span>, <span class="contact-name">Dan       Romascanu</span>, <span class="contact-name">Kyle Rose</span>, <span class="contact-name">Benjamin Kaduk</span>, <span class="contact-name">Alissa       Cooper</span>, <span class="contact-name">Erik Kline</span>, <span class="contact-name">Murray Kucherawy</span>, <span class="contact-name">Robert       Wilton</span>, <span class="contact-name">Warren Kumari</span>, <span class="contact-name">Andreas Kunz</span>, <span class="contact-name">Marcus Wong</span>,
      <span class="contact-name">Kalle Jarvinen</span>, <span class="contact-name">Daniel       Migault</span>, and <span class="contact-name">Mohit Sethi</span> for their
      in-depth reviews and interesting discussions in this problem
      space.<a class="pilcrow" href="#appendix-E-1">¶</a></p>
</section>
<section id="appendix-F">
      <h2 id="name-contributors">
<a class="section-name selfRef" href="#name-contributors">Contributors</a>
      </h2>
<p id="appendix-F-1">The test vectors in <a class="xref" href="#testvectors">Appendix D</a> were provided by <span class="contact-name">Yogendra Pal</span> and
   <span class="contact-name">Jouni Malinen</span>, based on two independent implementations of this
   specification.<a class="pilcrow" href="#appendix-F-1">¶</a></p>
<p id="appendix-F-2"><span class="contact-name">Jouni Malinen</span> provided suggested text for <a class="xref" href="#exported-parameters">Section 6</a>. <span class="contact-name">John Mattsson</span> provided much of the
   text for <a class="xref" href="#priv">Section 7.1</a>. Karl Norrman was the source of
   much of the information in <a class="xref" href="#vuln">Section 7.2</a>.<a class="pilcrow" href="#appendix-F-2">¶</a></p>
</section>
<div id="authors-addresses">
<section id="appendix-G">
      <h2 id="name-authors-addresses">
<a class="section-name selfRef" href="#name-authors-addresses">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Jari Arkko</span></div>
<div class="left" dir="auto"><span class="org">Ericsson</span></div>
<div class="left" dir="auto">FI-<span class="postal-code">02420</span> <span class="locality">Jorvas</span>
</div>
<div class="left" dir="auto"><span class="country-name">Finland</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:jari.arkko@piuha.net">jari.arkko@piuha.net</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Vesa Lehtovirta</span></div>
<div class="left" dir="auto"><span class="org">Ericsson</span></div>
<div class="left" dir="auto">FI-<span class="postal-code">02420</span> <span class="locality">Jorvas</span>
</div>
<div class="left" dir="auto"><span class="country-name">Finland</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:vesa.lehtovirta@ericsson.com">vesa.lehtovirta@ericsson.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Vesa Torvinen</span></div>
<div class="left" dir="auto"><span class="org">Ericsson</span></div>
<div class="left" dir="auto">FI-<span class="postal-code">02420</span> <span class="locality">Jorvas</span>
</div>
<div class="left" dir="auto"><span class="country-name">Finland</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:vesa.torvinen@ericsson.com">vesa.torvinen@ericsson.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Pasi Eronen</span></div>
<div class="left" dir="auto"><span class="org">Independent</span></div>
<div class="left" dir="auto"><span class="country-name">Finland</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:pe@iki.fi">pe@iki.fi</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>