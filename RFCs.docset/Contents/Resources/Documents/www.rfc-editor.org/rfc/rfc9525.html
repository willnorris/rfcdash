<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 9525: Service Identity in TLS</title>
<meta content="Peter Saint-Andre" name="author"/>
<meta content="Rich Salz" name="author"/>
<meta content="
       Many application technologies enable secure communication between two entities
by means of Transport Layer Security (TLS) with
Internet Public Key Infrastructure using X.509 (PKIX) certificates.
This document specifies
procedures for representing and verifying the identity of application services
in such interactions. 
       This document obsoletes RFC 6125. 
    " name="description"/>
<meta content="xml2rfc 3.18.2" name="generator"/>
<meta content="TLS" name="keyword"/>
<meta content="server" name="keyword"/>
<meta content="X509" name="keyword"/>
<meta content="identity" name="keyword"/>
<meta content="naming" name="keyword"/>
<meta content="verifying" name="keyword"/>
<meta content="representing" name="keyword"/>
<meta content="PKIX" name="keyword"/>
<meta content="certificates" name="keyword"/>
<meta content="validation" name="keyword"/>
<meta content="9525" name="rfc.number"/>
<!-- Generator version information:
  xml2rfc 3.18.2
    Python 3.9.15
    ConfigArgParse 1.5.3
    google-i18n-address 3.0.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.0
    platformdirs 3.8.0
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.28.0
    setuptools 44.1.1
    six 1.16.0
    wcwidth 0.2.5
    weasyprint 56.1
-->
<link href="rfc9525.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
  overflow-wrap: break-word;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef,
.iref + a[href].internal {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
blockquote > *:last-child {
  margin-bottom: 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://datatracker.ietf.org/doc/draft-ietf-uta-rfc6125bis-15" rel="prev"/>
  <link href="https://dx.doi.org/10.17487/rfc9525" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  </head>
<body class="xml2rfc">
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9525</td>
<td class="center">Service Identity in TLS</td>
<td class="right">November 2023</td>
</tr></thead>
<tfoot><tr>
<td class="left">Saint-Andre &amp; Salz</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc9525">9525</a></dd>
<dt class="label-obsoletes">Obsoletes:</dt>
<dd class="obsoletes">
<a class="eref" href="https://www.rfc-editor.org/rfc/rfc6125">6125</a> </dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2023-11">November 2023</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">P. Saint-Andre</div>
<div class="org">Independent</div>
</div>
<div class="author">
      <div class="author-name">R. Salz</div>
<div class="org">Akamai Technologies</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9525</h1>
<h1 id="title">Service Identity in TLS</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">Many application technologies enable secure communication between two entities
by means of Transport Layer Security (TLS) with
Internet Public Key Infrastructure using X.509 (PKIX) certificates.
This document specifies
procedures for representing and verifying the identity of application services
in such interactions.<a class="pilcrow" href="#section-abstract-1">¶</a></p>
<p id="section-abstract-2">This document obsoletes RFC 6125.<a class="pilcrow" href="#section-abstract-2">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a class="pilcrow" href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9525">https://www.rfc-editor.org/info/rfc9525</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2023 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">▲</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a class="auto internal xref" href="#section-1">1</a>.  <a class="internal xref" href="#name-introduction">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p class="keepWithNext" id="section-toc.1-1.1.2.1.1"><a class="auto internal xref" href="#section-1.1">1.1</a>.  <a class="internal xref" href="#name-motivation">Motivation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p class="keepWithNext" id="section-toc.1-1.1.2.2.1"><a class="auto internal xref" href="#section-1.2">1.2</a>.  <a class="internal xref" href="#name-applicability">Applicability</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3">
                <p class="keepWithNext" id="section-toc.1-1.1.2.3.1"><a class="auto internal xref" href="#section-1.3">1.3</a>.  <a class="internal xref" href="#name-overview-of-recommendations">Overview of Recommendations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.4">
                <p id="section-toc.1-1.1.2.4.1"><a class="auto internal xref" href="#section-1.4">1.4</a>.  <a class="internal xref" href="#name-scope">Scope</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.4.2.1">
                    <p id="section-toc.1-1.1.2.4.2.1.1"><a class="auto internal xref" href="#section-1.4.1">1.4.1</a>.  <a class="internal xref" href="#name-in-scope">In Scope</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.4.2.2">
                    <p id="section-toc.1-1.1.2.4.2.2.1"><a class="auto internal xref" href="#section-1.4.2">1.4.2</a>.  <a class="internal xref" href="#name-out-of-scope">Out of Scope</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.5">
                <p id="section-toc.1-1.1.2.5.1"><a class="auto internal xref" href="#section-1.5">1.5</a>.  <a class="internal xref" href="#name-terminology">Terminology</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a class="auto internal xref" href="#section-2">2</a>.  <a class="internal xref" href="#name-identifying-application-ser">Identifying Application Services</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a class="auto internal xref" href="#section-3">3</a>.  <a class="internal xref" href="#name-designing-application-proto">Designing Application Protocols</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="auto internal xref" href="#section-4">4</a>.  <a class="internal xref" href="#name-representing-server-identit">Representing Server Identity</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a class="auto internal xref" href="#section-4.1">4.1</a>.  <a class="internal xref" href="#name-rules">Rules</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a class="auto internal xref" href="#section-4.2">4.2</a>.  <a class="internal xref" href="#name-examples">Examples</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="auto internal xref" href="#section-5">5</a>.  <a class="internal xref" href="#name-requesting-server-certifica">Requesting Server Certificates</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="auto internal xref" href="#section-6">6</a>.  <a class="internal xref" href="#name-verifying-service-identity">Verifying Service Identity</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a class="auto internal xref" href="#section-6.1">6.1</a>.  <a class="internal xref" href="#name-constructing-a-list-of-refe">Constructing a List of Reference Identifiers</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.1">
                    <p id="section-toc.1-1.6.2.1.2.1.1"><a class="auto internal xref" href="#section-6.1.1">6.1.1</a>.  <a class="internal xref" href="#name-rules-2">Rules</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.2">
                    <p id="section-toc.1-1.6.2.1.2.2.1"><a class="auto internal xref" href="#section-6.1.2">6.1.2</a>.  <a class="internal xref" href="#name-examples-2">Examples</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a class="auto internal xref" href="#section-6.2">6.2</a>.  <a class="internal xref" href="#name-preparing-to-seek-a-match">Preparing to Seek a Match</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a class="auto internal xref" href="#section-6.3">6.3</a>.  <a class="internal xref" href="#name-matching-the-dns-domain-nam">Matching the DNS Domain Name Portion</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a class="auto internal xref" href="#section-6.4">6.4</a>.  <a class="internal xref" href="#name-matching-an-ip-address-port">Matching an IP Address Portion</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5">
                <p id="section-toc.1-1.6.2.5.1"><a class="auto internal xref" href="#section-6.5">6.5</a>.  <a class="internal xref" href="#name-matching-the-application-se">Matching the Application Service Type Portion</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.6">
                <p id="section-toc.1-1.6.2.6.1"><a class="auto internal xref" href="#section-6.6">6.6</a>.  <a class="internal xref" href="#name-outcome">Outcome</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="auto internal xref" href="#section-7">7</a>.  <a class="internal xref" href="#name-security-considerations">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a class="auto internal xref" href="#section-7.1">7.1</a>.  <a class="internal xref" href="#name-wildcard-certificates">Wildcard Certificates</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a class="auto internal xref" href="#section-7.2">7.2</a>.  <a class="internal xref" href="#name-uniform-resource-identifier">Uniform Resource Identifiers</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a class="auto internal xref" href="#section-7.3">7.3</a>.  <a class="internal xref" href="#name-internationalized-domain-na">Internationalized Domain Names</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a class="auto internal xref" href="#section-7.4">7.4</a>.  <a class="internal xref" href="#name-ip-addresses">IP Addresses</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5">
                <p id="section-toc.1-1.7.2.5.1"><a class="auto internal xref" href="#section-7.5">7.5</a>.  <a class="internal xref" href="#name-multiple-presented-identifi">Multiple Presented Identifiers</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.6">
                <p id="section-toc.1-1.7.2.6.1"><a class="auto internal xref" href="#section-7.6">7.6</a>.  <a class="internal xref" href="#name-multiple-reference-identifi">Multiple Reference Identifiers</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.7">
                <p id="section-toc.1-1.7.2.7.1"><a class="auto internal xref" href="#section-7.7">7.7</a>.  <a class="internal xref" href="#name-certificate-trust">Certificate Trust</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="auto internal xref" href="#section-8">8</a>.  <a class="internal xref" href="#name-iana-considerations">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="auto internal xref" href="#section-9">9</a>.  <a class="internal xref" href="#name-references">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a class="auto internal xref" href="#section-9.1">9.1</a>.  <a class="internal xref" href="#name-normative-references">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a class="auto internal xref" href="#section-9.2">9.2</a>.  <a class="internal xref" href="#name-informative-references">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a class="auto internal xref" href="#appendix-A">Appendix A</a>.  <a class="internal xref" href="#name-changes-from-rfc-6125">Changes from RFC 6125</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a class="auto internal xref" href="#appendix-B"></a><a class="internal xref" href="#name-acknowledgements">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a class="auto internal xref" href="#appendix-C"></a><a class="internal xref" href="#name-contributors">Contributors</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a class="auto internal xref" href="#appendix-D"></a><a class="internal xref" href="#name-authors-addresses">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="intro">
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<div id="motivation">
<section id="section-1.1">
        <h3 id="name-motivation">
<a class="section-number selfRef" href="#section-1.1">1.1. </a><a class="section-name selfRef" href="#name-motivation">Motivation</a>
        </h3>
<p id="section-1.1-1">The visible face of the Internet largely consists of services that employ a
client-server architecture in which a client
communicates with an application service.  When a client communicates with an
application service using <span>[<a class="cite xref" href="#RFC8446">TLS</a>]</span>, <span>[<a class="cite xref" href="#RFC9147">DTLS</a>]</span>, or a protocol built on those
(<span>[<a class="cite xref" href="#RFC9001">QUIC</a>]</span> being a notable example),
it has some notion of the server's
identity (e.g., "the website at bigcompany.example") while attempting to establish
secure communication.  Likewise, during TLS negotiation, the server presents
its notion of the service's identity in the form of a public key certificate
that was issued by a certification authority (CA) in the context of the
Internet Public Key Infrastructure using X.509 <span>[<a class="cite xref" href="#RFC5280">PKIX</a>]</span>.  Informally, we can
think of these identities as the client's "reference identity" and the
server's "presented identity"; more formal definitions are given later.  A
client needs to verify that the server's presented identity matches its
reference identity so it can deterministically and automatically authenticate the communication.<a class="pilcrow" href="#section-1.1-1">¶</a></p>
<p id="section-1.1-2">This document defines procedures for how clients perform this verification.
It therefore defines requirements on other parties, such as
the certification authorities that issue certificates, the service administrators requesting
 them, and the protocol designers defining interactions between clients and servers.<a class="pilcrow" href="#section-1.1-2">¶</a></p>
<p id="section-1.1-3">This document obsoletes RFC 6125 <span>[<a class="cite xref" href="#RFC6125">VERIFY</a>]</span>. Changes from RFC 6125 <span>[<a class="cite xref" href="#RFC6125">VERIFY</a>]</span> are described under <a class="auto internal xref" href="#changes">Appendix A</a>.<a class="pilcrow" href="#section-1.1-3">¶</a></p>
</section>
</div>
<div id="applicability">
<section id="section-1.2">
        <h3 id="name-applicability">
<a class="section-number selfRef" href="#section-1.2">1.2. </a><a class="section-name selfRef" href="#name-applicability">Applicability</a>
        </h3>
<p id="section-1.2-1">This document does not supersede the rules for certificate issuance or
validation specified by <span>[<a class="cite xref" href="#RFC5280">PKIX</a>]</span>.  That document also governs any
certificate-related topic on which this document is silent.  This includes
certificate syntax, extensions such as name constraints or
extended key usage, and handling of certification paths.<a class="pilcrow" href="#section-1.2-1">¶</a></p>
<p id="section-1.2-2">This document addresses only name forms in the leaf "end entity" server
certificate.  It does not address the name forms in the chain of certificates
used to validate a certificate, nor does it create or check the validity
of such a chain.  In order to ensure proper authentication, applications need
to verify the entire certification path.<a class="pilcrow" href="#section-1.2-2">¶</a></p>
</section>
</div>
<div id="overview">
<section id="section-1.3">
        <h3 id="name-overview-of-recommendations">
<a class="section-number selfRef" href="#section-1.3">1.3. </a><a class="section-name selfRef" href="#name-overview-of-recommendations">Overview of Recommendations</a>
        </h3>
<p id="section-1.3-1">The previous version of this specification, <span>[<a class="cite xref" href="#RFC6125">VERIFY</a>]</span>, surveyed the then-current
practice from many IETF standards and tried to generalize best practices
(see <span><a class="relref" href="https://rfc-editor.org/rfc/rfc6125#appendix-A">Appendix A</a> of [<a class="cite xref" href="#RFC6125">VERIFY</a>]</span> for details).<a class="pilcrow" href="#section-1.3-1">¶</a></p>
<p id="section-1.3-2">This document takes the lessons learned since then and codifies them.
The following is a summary of the rules, which are described at greater
length in the remainder of this document:<a class="pilcrow" href="#section-1.3-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.3-3.1">Only check DNS domain names via the subjectAltName
extension designed for that purpose: dNSName.<a class="pilcrow" href="#section-1.3-3.1">¶</a>
</li>
          <li class="normal" id="section-1.3-3.2">Allow use of even more specific
subjectAltName extensions where appropriate such as
uniformResourceIdentifier, iPAddress, and the otherName form SRVName.<a class="pilcrow" href="#section-1.3-3.2">¶</a>
</li>
          <li class="normal" id="section-1.3-3.3">Wildcard support is now the default in certificates.
Constrain wildcard certificates so that the wildcard can only
be the complete left-most label of a domain name.<a class="pilcrow" href="#section-1.3-3.3">¶</a>
</li>
          <li class="normal" id="section-1.3-3.4">Do not include or check strings that look like domain names
in the subject's Common Name.<a class="pilcrow" href="#section-1.3-3.4">¶</a>
</li>
        </ul>
</section>
</div>
<div id="scope">
<section id="section-1.4">
        <h3 id="name-scope">
<a class="section-number selfRef" href="#section-1.4">1.4. </a><a class="section-name selfRef" href="#name-scope">Scope</a>
        </h3>
<div id="in-scope">
<section id="section-1.4.1">
          <h4 id="name-in-scope">
<a class="section-number selfRef" href="#section-1.4.1">1.4.1. </a><a class="section-name selfRef" href="#name-in-scope">In Scope</a>
          </h4>
<p id="section-1.4.1-1">This document applies only to service identities that are used in TLS or DTLS
and that are included in PKIX certificates.<a class="pilcrow" href="#section-1.4.1-1">¶</a></p>
<p id="section-1.4.1-2">With regard to TLS and DTLS, these security protocols are used to
protect data exchanged over a wide variety of application protocols,
which use both the TLS or DTLS handshake protocol and the TLS or
DTLS record layer, either directly or through a profile as in Network
Time Security <span>[<a class="cite xref" href="#RFC8915">NTS</a>]</span>.  The TLS handshake protocol can also be used
with different record layers to define secure transport protocols;
at present, the most prominent example is QUIC <span>[<a class="cite xref" href="#RFC9000">RFC9000</a>]</span>.  The
rules specified here are intended to apply to all protocols in this
extended TLS "family".<a class="pilcrow" href="#section-1.4.1-2">¶</a></p>
<p id="section-1.4.1-3">With regard to PKIX certificates, the primary usage is in the
context of the public key infrastructure described in <span>[<a class="cite xref" href="#RFC5280">PKIX</a>]</span>.
In addition, technologies such as DNS-Based Authentication
of Named Entities (DANE) <span>[<a class="cite xref" href="#RFC6698">DANE</a>]</span> sometimes use certificates based
on PKIX (more precisely, certificates structured via <span>[<a class="cite xref" href="#X.509">X.509</a>]</span> or
specific encodings thereof such as <span>[<a class="cite xref" href="#X.690">X.690</a>]</span>), at least in certain
modes.  Alternatively, a TLS peer could issue delegated credentials
that are based on a CA-issued certificate, as in <span>[<a class="cite xref" href="#RFC9345">TLS-SUBCERTS</a>]</span>.
In both cases, a TLS client could learn of a service identity
through its inclusion in the relevant certificate.  The rules specified
here are intended to apply whenever service identities are included in
X.509 certificates or credentials that are derived from such certificates.<a class="pilcrow" href="#section-1.4.1-3">¶</a></p>
</section>
</div>
<div id="out-of-scope">
<section id="section-1.4.2">
          <h4 id="name-out-of-scope">
<a class="section-number selfRef" href="#section-1.4.2">1.4.2. </a><a class="section-name selfRef" href="#name-out-of-scope">Out of Scope</a>
          </h4>
<p id="section-1.4.2-1">The following topics are out of scope for this specification:<a class="pilcrow" href="#section-1.4.2-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.4.2-2.1">Security protocols other than those
described above.<a class="pilcrow" href="#section-1.4.2-2.1">¶</a>
</li>
            <li class="normal" id="section-1.4.2-2.2">Keys or certificates employed outside the context of PKIX-based systems.<a class="pilcrow" href="#section-1.4.2-2.2">¶</a>
</li>
            <li class="normal" id="section-1.4.2-2.3">Client or end-user identities.
Other than as described above, certificates representing client identities
     (e.g., rfc822Name) are beyond the scope of this document.<a class="pilcrow" href="#section-1.4.2-2.3">¶</a>
</li>
            <li class="normal" id="section-1.4.2-2.4">Identification of servers using other than a domain name, an IP address, or an SRV service name.
This document discusses Uniform Resource Identifiers <span>[<a class="cite xref" href="#RFC3986">URI</a>]</span> only to the
extent that they are expressed in certificates. Other aspects of a service
such as a specific resource (the URI "path" component) or parameters (the URI
"query" component) are the responsibility of specific protocols or URI
schemes.<a class="pilcrow" href="#section-1.4.2-2.4">¶</a>
</li>
            <li class="normal" id="section-1.4.2-2.5">
              <p id="section-1.4.2-2.5.1">Certification authority policies.
This includes items such as the following:<a class="pilcrow" href="#section-1.4.2-2.5.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.4.2-2.5.2.1">How to certify or validate fully qualified domain names (FQDNs) and application
service types (see <span>[<a class="cite xref" href="#RFC8555">ACME</a>]</span>).<a class="pilcrow" href="#section-1.4.2-2.5.2.1">¶</a>
</li>
                <li class="normal" id="section-1.4.2-2.5.2.2">What types or "classes" of certificates to issue and whether to apply different
policies for them.<a class="pilcrow" href="#section-1.4.2-2.5.2.2">¶</a>
</li>
                <li class="normal" id="section-1.4.2-2.5.2.3">How to certify or validate other kinds of information that might be
included in a certificate (e.g., organization name).<a class="pilcrow" href="#section-1.4.2-2.5.2.3">¶</a>
</li>
              </ul>
</li>
            <li class="normal" id="section-1.4.2-2.6">Resolution of DNS domain names.
Although the process whereby a client resolves the DNS domain name of an
application service can involve several steps, for the purposes of this
specification, the only relevant consideration is that the client needs to
verify the identity of the entity with which it will communicate once the
resolution process is complete.  Thus, the resolution process itself is
out of scope for this specification.<a class="pilcrow" href="#section-1.4.2-2.6">¶</a>
</li>
            <li class="normal" id="section-1.4.2-2.7">User interface issues.
In general, such issues are properly the responsibility of client
software developers and standards development organizations
dedicated to particular application technologies (for example, see
<span>[<a class="cite xref" href="#WSC-UI">WSC-UI</a>]</span>).<a class="pilcrow" href="#section-1.4.2-2.7">¶</a>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="terminology">
<section id="section-1.5">
        <h3 id="name-terminology">
<a class="section-number selfRef" href="#section-1.5">1.5. </a><a class="section-name selfRef" href="#name-terminology">Terminology</a>
        </h3>
<p id="section-1.5-1">Because many concepts related to "identity" are often too vague to be
actionable in application protocols, we define a set of more concrete terms
for use in this specification.<a class="pilcrow" href="#section-1.5-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-1.5-2">
          <dt id="section-1.5-2.1">application service:</dt>
          <dd id="section-1.5-2.2" style="margin-left: 1.5em">
            <p id="section-1.5-2.2.1">A service on the Internet that enables clients to connect for the
purpose of retrieving or uploading information, communicating with other
entities, or connecting to a broader network of services.<a class="pilcrow" href="#section-1.5-2.2.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.5-2.3">application service provider:</dt>
          <dd id="section-1.5-2.4" style="margin-left: 1.5em">
            <p id="section-1.5-2.4.1">An entity that hosts or deploys an application service.<a class="pilcrow" href="#section-1.5-2.4.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.5-2.5">application service type:</dt>
          <dd id="section-1.5-2.6" style="margin-left: 1.5em">
            <p id="section-1.5-2.6.1">A formal identifier for the application protocol used to provide a
particular kind of application service at a domain.  This often appears as
a URI scheme <span>[<a class="cite xref" href="#RFC3986">URI</a>]</span>, a DNS SRV Service <span>[<a class="cite xref" href="#RFC2782">DNS-SRV</a>]</span>, or an Application-Layer Protocol Negotiation (ALPN) <span>[<a class="cite xref" href="#RFC7301">ALPN</a>]</span>
identifier.<a class="pilcrow" href="#section-1.5-2.6.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.5-2.7">identifier:</dt>
          <dd id="section-1.5-2.8" style="margin-left: 1.5em">
            <p id="section-1.5-2.8.1">A particular instance of an identifier type that is either presented by a
server in a certificate or referenced by a client for matching purposes.<a class="pilcrow" href="#section-1.5-2.8.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.5-2.9">identifier type:</dt>
          <dd id="section-1.5-2.10" style="margin-left: 1.5em">
            <p id="section-1.5-2.10.1">A formally defined category of identifier that can be included in a
certificate and therefore be used for matching purposes. For
conciseness and convenience, we define the following identifier types of
interest:<a class="pilcrow" href="#section-1.5-2.10.1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-1.5-2.10.2">
              <dt id="section-1.5-2.10.2.1">DNS-ID:</dt>
              <dd id="section-1.5-2.10.2.2" style="margin-left: 1.5em"> A subjectAltName entry of type dNSName as defined in <span>[<a class="cite xref" href="#RFC5280">PKIX</a>]</span>.<a class="pilcrow" href="#section-1.5-2.10.2.2">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-1.5-2.10.2.3">IP-ID:</dt>
              <dd id="section-1.5-2.10.2.4" style="margin-left: 1.5em"> A subjectAltName entry of type iPAddress as defined in <span>[<a class="cite xref" href="#RFC5280">PKIX</a>]</span>.<a class="pilcrow" href="#section-1.5-2.10.2.4">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-1.5-2.10.2.5">SRV-ID:</dt>
              <dd id="section-1.5-2.10.2.6" style="margin-left: 1.5em"> A subjectAltName entry of type otherName whose name form is
SRVName as defined in <span>[<a class="cite xref" href="#RFC4985">SRVNAME</a>]</span>.<a class="pilcrow" href="#section-1.5-2.10.2.6">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-1.5-2.10.2.7">URI-ID:</dt>
              <dd id="section-1.5-2.10.2.8" style="margin-left: 1.5em"> A subjectAltName entry of type uniformResourceIdentifier
as defined in <span>[<a class="cite xref" href="#RFC5280">PKIX</a>]</span>. See further discussion in <a class="auto internal xref" href="#security-uri">Section 7.2</a>.<a class="pilcrow" href="#section-1.5-2.10.2.8">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</dd>
          <dd class="break"></dd>
<dt id="section-1.5-2.11">PKIX:</dt>
          <dd id="section-1.5-2.12" style="margin-left: 1.5em">
            <p id="section-1.5-2.12.1">The short name for the Internet Public Key Infrastructure using X.509
defined in <span>[<a class="cite xref" href="#RFC5280">PKIX</a>]</span>.  That document provides a profile of the X.509v3
certificate specifications and X.509v2 certificate revocation list (CRL)
specifications for use on the Internet.<a class="pilcrow" href="#section-1.5-2.12.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.5-2.13">presented identifier:</dt>
          <dd id="section-1.5-2.14" style="margin-left: 1.5em">
            <p id="section-1.5-2.14.1">An identifier presented by a server to a client within a PKIX certificate
when the client attempts to establish secure communication with the server.
The certificate can include one or more presented identifiers of different
types, and if the server hosts more than one domain, then the certificate
might present distinct identifiers for each domain.<a class="pilcrow" href="#section-1.5-2.14.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.5-2.15">reference identifier:</dt>
          <dd id="section-1.5-2.16" style="margin-left: 1.5em">
            <p id="section-1.5-2.16.1">An identifier expected by the client when examining presented identifiers.
It is constructed from the source domain and, optionally, an application
service type.<a class="pilcrow" href="#section-1.5-2.16.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.5-2.17">Relative Distinguished Name (RDN):</dt>
          <dd id="section-1.5-2.18" style="margin-left: 1.5em">
            <p id="section-1.5-2.18.1">An ASN.1-based construction that is itself a building-block component of
Distinguished Names. See <span>[<a class="cite xref" href="#RFC4514">LDAP-DN</a>], <a class="relref" href="https://rfc-editor.org/rfc/rfc4514#section-2">Section 2</a></span>.<a class="pilcrow" href="#section-1.5-2.18.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.5-2.19">source domain:</dt>
          <dd id="section-1.5-2.20" style="margin-left: 1.5em">
            <p id="section-1.5-2.20.1">The FQDN that a client expects an application
service to present in the certificate. This is typically input by
a human user, configured into a client, or provided by reference such as
a URL. The combination of a source domain and, optionally, an application
service type enables a client to construct one or more reference
identifiers. This specification covers FQDNs. Use of any names that
are not fully qualified is out of scope and may result in unexpected
or undefined behavior.<a class="pilcrow" href="#section-1.5-2.20.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.5-2.21">subjectAltName entry:</dt>
          <dd id="section-1.5-2.22" style="margin-left: 1.5em">
            <p id="section-1.5-2.22.1">An identifier placed in a subjectAltName extension.<a class="pilcrow" href="#section-1.5-2.22.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.5-2.23">subjectAltName extension:</dt>
          <dd id="section-1.5-2.24" style="margin-left: 1.5em">
            <p id="section-1.5-2.24.1">A standard PKIX extension enabling identifiers of various types to be
bound to the certificate subject.<a class="pilcrow" href="#section-1.5-2.24.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.5-2.25">subjectName:</dt>
          <dd id="section-1.5-2.26" style="margin-left: 1.5em">
            <p id="section-1.5-2.26.1">The name of a PKIX certificate's subject, encoded in a certificate's
subject field (see <span>[<a class="cite xref" href="#RFC5280">PKIX</a>], <a class="relref" href="https://rfc-editor.org/rfc/rfc5280#section-4.1.2.6">Section 4.1.2.6</a></span>).<a class="pilcrow" href="#section-1.5-2.26.1">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-1.5-3">TLS uses the words "client" and "server", where the client is the entity
that initiates the connection.  In many cases, this is consistent with common practice,
such as a browser connecting to a web origin.
For the sake of clarity, and to follow the usage in <span>[<a class="cite xref" href="#RFC8446">TLS</a>]</span> and related
specifications, we will continue
to use the terms client and server in this document.
However, these are TLS-layer roles, and the application protocol
could support the TLS server making requests to the TLS client after the
TLS handshake; there is no requirement that the roles at the application
layer match the TLS layer.<a class="pilcrow" href="#section-1.5-3">¶</a></p>
<p id="section-1.5-4">Security-related terms used in this document, but not defined here or in
<span>[<a class="cite xref" href="#RFC5280">PKIX</a>]</span>, should be understood in the sense defined in <span>[<a class="cite xref" href="#RFC4949">SECTERMS</a>]</span>. Such
terms include "attack", "authentication", "identity", "trust", "validate",
 and "verify".<a class="pilcrow" href="#section-1.5-4">¶</a></p>
<p id="section-1.5-5">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a class="cite xref" href="#RFC2119">RFC2119</a>]</span> <span>[<a class="cite xref" href="#RFC8174">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a class="pilcrow" href="#section-1.5-5">¶</a></p>
</section>
</div>
</section>
</div>
<div id="names">
<section id="section-2">
      <h2 id="name-identifying-application-ser">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-identifying-application-ser">Identifying Application Services</a>
      </h2>
<p id="section-2-1">This document assumes that an application service is identified by a DNS domain
name (e.g., <code>bigcompany.example</code>), an IP address (IPv4 or IPv6), or an identifier
that contains additional supplementary information.  Supplementary information
is limited to the application service type as expressed in a DNS SRV record
(e.g., "the IMAP server at isp.example" for "_imap.isp.example") or a URI.<a class="pilcrow" href="#section-2-1">¶</a></p>
<p id="section-2-2">In a DNS-ID -- and in the DNS domain name portion of an SRV-ID or URI-ID -- any
characters outside the range described in <span>[<a class="cite xref" href="#US-ASCII">US-ASCII</a>]</span> are prohibited, and internationalized
domain labels are represented as A-labels <span>[<a class="cite xref" href="#RFC5890">IDNA-DEFS</a>]</span>.<a class="pilcrow" href="#section-2-2">¶</a></p>
<p id="section-2-3">An IP address is either a 4-octet IPv4 address <span>[<a class="cite xref" href="#RFC0791">IPv4</a>]</span> or a 16-octet
IPv6 address <span>[<a class="cite xref" href="#RFC4291">IPv6</a>]</span>.  The identifier might need to be converted from a
textual representation to obtain this value.<a class="pilcrow" href="#section-2-3">¶</a></p>
<p id="section-2-4">From the perspective of the application client or user, some identifiers are
<em>direct</em> because they are provided directly by a human user.  This includes
runtime input, prior configuration, or explicit acceptance of a client
communication attempt.  Other names are <em>indirect</em> because they are
automatically resolved by the application based on user input, such as a
target name resolved from a source name using DNS SRV or the records described in <span>[<a class="cite xref" href="#RFC3403">NAPTR</a>]</span>.
The distinction matters most for certificate consumption, specifically
verification as discussed in this document.<a class="pilcrow" href="#section-2-4">¶</a></p>
<p id="section-2-5">From the perspective of the application service, some identifiers are
<em>unrestricted</em> because they can be used in any type of service, such as a
single certificate being used for both the HTTP and IMAP services at the host
"bigcompany.example".  Other identifiers are <em>restricted</em> because they can only be used for
one type of service, such as a special-purpose certificate that can only be
used for an IMAP service.  This distinction matters most for certificate
issuance.<a class="pilcrow" href="#section-2-5">¶</a></p>
<p id="section-2-6">The four identifier types can be categorized as follows:<a class="pilcrow" href="#section-2-6">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-7.1">A DNS-ID is direct and unrestricted.<a class="pilcrow" href="#section-2-7.1">¶</a>
</li>
        <li class="normal" id="section-2-7.2">An IP-ID is direct and unrestricted.<a class="pilcrow" href="#section-2-7.2">¶</a>
</li>
        <li class="normal" id="section-2-7.3">An SRV-ID is typically indirect but can be direct, and it is restricted.<a class="pilcrow" href="#section-2-7.3">¶</a>
</li>
        <li class="normal" id="section-2-7.4">A URI-ID is direct and restricted.<a class="pilcrow" href="#section-2-7.4">¶</a>
</li>
      </ul>
<p id="section-2-8">It is important to keep these distinctions in mind because best practices
for the deployment and use of the identifiers differ.
Note that cross-protocol attacks such as those described in <span>[<a class="cite xref" href="#ALPACA">ALPACA</a>]</span>
are possible when two
different protocol services use the same certificate.
This can be addressed by using restricted identifiers or deploying
services so that they do not share certificates.
Protocol specifications <span class="bcp14">MUST</span> specify which identifiers are
mandatory to implement and <span class="bcp14">SHOULD</span> provide operational guidance when necessary.<a class="pilcrow" href="#section-2-8">¶</a></p>
<p id="section-2-9">The Common Name RDN <span class="bcp14">MUST NOT</span> be used to identify a service because
it is not strongly typed (it is essentially free-form text) and therefore
suffers from ambiguities in interpretation.<a class="pilcrow" href="#section-2-9">¶</a></p>
<p id="section-2-10">For similar reasons, other RDNs within the subjectName <span class="bcp14">MUST NOT</span> be used to
identify a service.<a class="pilcrow" href="#section-2-10">¶</a></p>
<p id="section-2-11">An IP address that is the result of a DNS query is indirect. Use of IP-IDs
that are indirect is out of scope for this document.<a class="pilcrow" href="#section-2-11">¶</a></p>
<p id="section-2-12">The IETF continues to define methods for looking up information needed
to make connections to network services. One recent example is service
binding via the "SVCB" and "HTTPS" DNS resource record (RR) types. This
document does not define any identity representation or verification procedures
that are specific to SVCB-compatible records, because the use of such records during
connection establishment does not currently alter any of the PKIX validation
requirements specified herein or in any other relevant specification.
For example,
the PKIX validation rules for <span>[<a class="cite xref" href="#RFC9110">HTTP</a>]</span> and <span>[<a class="cite xref" href="#RFC7858">DNS-OVER-TLS</a>]</span> do not change
when the client uses the DNS resource records defined in <span>[<a class="cite xref" href="#RFC9460">SVCB-FOR-HTTPS</a>]</span> or <span>[<a class="cite xref" href="#RFC9461">SVCB-FOR-DNS</a>]</span> to look up connection information. However, it is possible
that future SVCB mapping documents could specify altered PKIX rules for new use cases.<a class="pilcrow" href="#section-2-12">¶</a></p>
</section>
</div>
<div id="design">
<section id="section-3">
      <h2 id="name-designing-application-proto">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-designing-application-proto">Designing Application Protocols</a>
      </h2>
<p id="section-3-1">This section defines how protocol designers should reference this document,
      which would typically be a normative reference in their specification.<a class="pilcrow" href="#section-3-1">¶</a></p>
<p id="section-3-2">A specification
<span class="bcp14">MAY</span> choose to allow only one of the identifier types defined here.<a class="pilcrow" href="#section-3-2">¶</a></p>
<p id="section-3-3">If the technology does not use DNS SRV records to resolve the DNS domain
names of application services, then the specification <span class="bcp14">MUST</span> state that SRV-ID
as defined in this document is not supported.  Note that many existing
application technologies use DNS SRV records to resolve the DNS domain names
of application services, but they do not rely on representations of those records
in PKIX certificates by means of SRV-IDs as defined in <span>[<a class="cite xref" href="#RFC4985">SRVNAME</a>]</span>.<a class="pilcrow" href="#section-3-3">¶</a></p>
<p id="section-3-4">If the technology does not use URIs to identify application services, then
the specification <span class="bcp14">MUST</span> state that URI-ID as defined in this document is not
supported.  Note that many existing application technologies use URIs to
identify application services, but they do not rely on representation of those
URIs in PKIX certificates by means of URI-IDs.<a class="pilcrow" href="#section-3-4">¶</a></p>
<p id="section-3-5">A technology <span class="bcp14">MAY</span> disallow the use of the wildcard character in presented identifiers. If
it does so, then the specification <span class="bcp14">MUST</span> state that wildcard certificates as
defined in this document are not supported.<a class="pilcrow" href="#section-3-5">¶</a></p>
<p id="section-3-6">A protocol can allow the use of an IP address in place of a DNS name.  This
might use the same field without distinguishing the type of identifier as, for
example, in the "host" components of a URI.  In this case, applications need to be aware that the textual
representation of an IPv4 address is a valid DNS name. The two
types can be distinguished by first testing if the identifier is a valid IPv4
address, as is done by the "first-match-wins" algorithm in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc3986#section-3.2.2">Section 3.2.2</a> of [<a class="cite xref" href="#RFC3986">URI</a>]</span>.<a class="pilcrow" href="#section-3-6">¶</a></p>
</section>
</div>
<div id="represent">
<section id="section-4">
      <h2 id="name-representing-server-identit">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-representing-server-identit">Representing Server Identity</a>
      </h2>
<p id="section-4-1">This section provides instructions for issuers of
certificates.<a class="pilcrow" href="#section-4-1">¶</a></p>
<div id="represent-rules">
<section id="section-4.1">
        <h3 id="name-rules">
<a class="section-number selfRef" href="#section-4.1">4.1. </a><a class="section-name selfRef" href="#name-rules">Rules</a>
        </h3>
<p id="section-4.1-1">When a certification authority issues a certificate based on the FQDN
at which the application service provider
will provide the relevant application, the following rules apply to
the representation of application service identities.
Note that some of these rules are cumulative
and can interact in important ways that are illustrated later in this
document.<a class="pilcrow" href="#section-4.1-1">¶</a></p>
<ol class="normal type-1" id="section-4.1-2" start="1" type="1">
<li id="section-4.1-2.1">The certificate <span class="bcp14">MUST</span> include at least one identifier.<a class="pilcrow" href="#section-4.1-2.1">¶</a>
</li>
          <li id="section-4.1-2.2">The certificate <span class="bcp14">SHOULD</span> include a DNS-ID as a baseline
for interoperability.  This is not mandatory because
it is legitimate for a certificate to include only an SRV-ID or
URI-ID so as to scope its use to a particular application type.<a class="pilcrow" href="#section-4.1-2.2">¶</a>
</li>
          <li id="section-4.1-2.3">If the service using the certificate deploys a technology for which
the relevant specification stipulates that certificates should
include identifiers of type SRV-ID (e.g., this is true of the Extensible Messaging and Presence Protocol (XMPP) as described in <span>[<a class="cite xref" href="#RFC6120">XMPP</a>]</span>),
then the certificate <span class="bcp14">SHOULD</span> include an SRV-ID.  This
identifier type could supplement the DNS-ID, unless the certificate
is meant to be scoped to only the protocol in question.<a class="pilcrow" href="#section-4.1-2.3">¶</a>
</li>
          <li id="section-4.1-2.4">If the service using the certificate deploys a technology for which
the relevant specification stipulates that certificates should include
identifiers of type URI-ID (e.g., this is true of the Session Initiation Protocol <span>[<a class="cite xref" href="#RFC3261">SIP</a>]</span> as specified by
<span>[<a class="cite xref" href="#RFC5922">SIP-CERTS</a>]</span>), then the certificate <span class="bcp14">SHOULD</span> include a URI-ID.  The scheme
<span class="bcp14">MUST</span> be that of the protocol associated with the application service type,
and the "host" component <span class="bcp14">MUST</span> be the FQDN
of the service.  The application protocol specification
<span class="bcp14">MUST</span> specify which URI schemes are acceptable in URI-IDs contained in PKIX
certificates used for the application protocol (e.g., <code>sip</code> but not <code>sips</code>
or <code>tel</code> for SIP as described in <span>[<a class="cite xref" href="#RFC5630">SIP-SIPS</a>]</span>). Typically, this
identifier type would supplement the DNS-ID, unless the certificate
is meant to be scoped to only the protocol in question.<a class="pilcrow" href="#section-4.1-2.4">¶</a>
</li>
          <li id="section-4.1-2.5">The certificate <span class="bcp14">MAY</span> contain more than one DNS-ID, SRV-ID, URI-ID, or IP-ID
as further explained in <a class="auto internal xref" href="#security-multi">Section 7.5</a>.<a class="pilcrow" href="#section-4.1-2.5">¶</a>
</li>
          <li id="section-4.1-2.6">The certificate <span class="bcp14">MAY</span> include other application-specific identifiers
for compatibility with a deployed base, especially identifiers for
types that were defined before publication of <span>[<a class="cite xref" href="#RFC4985">SRVNAME</a>]</span> or for which
SRV service names or URI schemes do not exist. Such identifiers are out
of scope for this specification.<a class="pilcrow" href="#section-4.1-2.6">¶</a>
</li>
        </ol>
</section>
</div>
<div id="represent-examples">
<section id="section-4.2">
        <h3 id="name-examples">
<a class="section-number selfRef" href="#section-4.2">4.2. </a><a class="section-name selfRef" href="#name-examples">Examples</a>
        </h3>
<p id="section-4.2-1">Consider a simple website at <code>&lt;www.bigcompany.example&gt;</code>, which is not discoverable via
DNS SRV lookups.  Because HTTP does not specify the use of URIs in server
certificates, a certificate for this service might include only a DNS-ID of
<code>&lt;www.bigcompany.example&gt;</code>.<a class="pilcrow" href="#section-4.2-1">¶</a></p>
<p id="section-4.2-2">Consider another website, which is reachable by a fixed IP address of
<code>2001:db8::5c</code>.  If the two sites refer to the same web service, then
the certificate might also include this value in an IP-ID to allow
clients to use the fixed IP address as a reference identity.<a class="pilcrow" href="#section-4.2-2">¶</a></p>
<p id="section-4.2-3">Consider an IMAP-accessible email server at the host <code>mail.isp.example</code>
servicing email addresses of the form <code>user@isp.example</code> and discoverable via
DNS SRV lookups on the application service name of <code>isp.example</code>. A
certificate for this service might include SRV-IDs of <code>_imap.isp.example</code> and
<code>_imaps.isp.example</code> (see <span>[<a class="cite xref" href="#RFC6186">EMAIL-SRV</a>]</span>) along with DNS-IDs of <code>isp.example</code>
 and <code>mail.isp.example</code>.<a class="pilcrow" href="#section-4.2-3">¶</a></p>
<p id="section-4.2-4">Consider a SIP-accessible voice-over-IP (VoIP) server at the host
<code>voice.college.example</code> servicing SIP addresses of the form
<code>user@voice.college.example</code> and identified by a URI of &lt;sip:voice.college.example&gt;.
A certificate for this service would include a URI-ID of
<code>&lt;sip:voice.college.example&gt;</code> (see <span>[<a class="cite xref" href="#RFC5922">SIP-CERTS</a>]</span>) along with a DNS-ID of
 <code>voice.college.example</code>.<a class="pilcrow" href="#section-4.2-4">¶</a></p>
<p id="section-4.2-5">Consider an XMPP-compatible instant messaging (IM) server at the host
<code>messenger.example</code> that services IM addresses of the form <code>user@messenger.example</code> and that is
discoverable via DNS SRV lookups on the <code>messenger.example</code> domain.  A
certificate for this service might include SRV-IDs of
<code>_xmpp-client.messenger.example</code> and <code>_xmpp-server.messenger.example</code> (see
<span>[<a class="cite xref" href="#RFC6120">XMPP</a>]</span>), as well as a DNS-ID of <code>messenger.example</code>.<a class="pilcrow" href="#section-4.2-5">¶</a></p>
</section>
</div>
</section>
</div>
<div id="request">
<section id="section-5">
      <h2 id="name-requesting-server-certifica">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-requesting-server-certifica">Requesting Server Certificates</a>
      </h2>
<p id="section-5-1">This section provides instructions for service providers regarding
the information to include in certificate signing requests (CSRs).
In general, service providers <span class="bcp14">SHOULD</span> request certificates that
include all the identifier types that are required or recommended for
the application service type that will be secured using the certificate to
be issued.<a class="pilcrow" href="#section-5-1">¶</a></p>
<p id="section-5-2">A service provider <span class="bcp14">SHOULD</span> request certificates with as few identifiers as
necessary to identify a single service; see <a class="auto internal xref" href="#security-multi">Section 7.5</a>.<a class="pilcrow" href="#section-5-2">¶</a></p>
<p id="section-5-3">If the certificate will be used for only a single type of application
service, the service provider <span class="bcp14">SHOULD</span> request a certificate that includes
DNS-ID or IP-ID values that identify that service or,
if appropriate for the application service type, SRV-ID or
URI-ID values that limit the deployment scope of the certificate to only the
defined application service type.<a class="pilcrow" href="#section-5-3">¶</a></p>
<p id="section-5-4">If the certificate might be used for any type of application service, 
the service provider <span class="bcp14">SHOULD</span> request a certificate that includes
only DNS-IDs or IP-IDs. Again, because of multiprotocol attacks, this practice is
discouraged; it can be mitigated by deploying only one service on
a host.<a class="pilcrow" href="#section-5-4">¶</a></p>
<p id="section-5-5">If a service provider offers multiple application service types and wishes to
limit the applicability of certificates using SRV-IDs or URI-IDs, it <span class="bcp14">SHOULD</span>
request that multiple certificates rather than a single certificate containing
multiple SRV-IDs or URI-IDs each identify a different application service
type. This rule does not apply to application service type "bundles" that
identify distinct access methods to the same underlying application such as
an email application with access methods denoted by the application service
types of <code>imap</code>, <code>imaps</code>, <code>pop3</code>, <code>pop3s</code>, and <code>submission</code> as described in
<span>[<a class="cite xref" href="#RFC6186">EMAIL-SRV</a>]</span>.<a class="pilcrow" href="#section-5-5">¶</a></p>
</section>
</div>
<div id="verify">
<section id="section-6">
      <h2 id="name-verifying-service-identity">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-verifying-service-identity">Verifying Service Identity</a>
      </h2>
<p id="section-6-1">At a high level, the client verifies the application service's
identity by performing the following actions:<a class="pilcrow" href="#section-6-1">¶</a></p>
<ol class="normal type-1" id="section-6-2" start="1" type="1">
<li id="section-6-2.1">The client constructs a list of reference identifiers it would find acceptable
based on the source domain and, if applicable, the type of service to
which the client is connecting.<a class="pilcrow" href="#section-6-2.1">¶</a>
</li>
        <li id="section-6-2.2">The server provides its presented identifiers in the form of a PKIX
certificate.<a class="pilcrow" href="#section-6-2.2">¶</a>
</li>
        <li id="section-6-2.3">The client checks each of its reference identifiers against the
server's presented identifiers for the purpose of finding a match. When checking a
reference identifier against a presented identifier, the client matches the
source domain of the identifiers and, optionally, their application service
type.<a class="pilcrow" href="#section-6-2.3">¶</a>
</li>
      </ol>
<p id="section-6-3">Naturally, in addition to checking identifiers, a client should perform
further checks, such as expiration and revocation, to ensure that the server
is authorized to provide the requested service.  Because such checking is not a
matter of verifying the application service identity presented in a
certificate, methods for doing so are out of scope for
this document.<a class="pilcrow" href="#section-6-3">¶</a></p>
<div id="verify-reference">
<section id="section-6.1">
        <h3 id="name-constructing-a-list-of-refe">
<a class="section-number selfRef" href="#section-6.1">6.1. </a><a class="section-name selfRef" href="#name-constructing-a-list-of-refe">Constructing a List of Reference Identifiers</a>
        </h3>
<div id="verify-reference-rules">
<section id="section-6.1.1">
          <h4 id="name-rules-2">
<a class="section-number selfRef" href="#section-6.1.1">6.1.1. </a><a class="section-name selfRef" href="#name-rules-2">Rules</a>
          </h4>
<p id="section-6.1.1-1">The client <span class="bcp14">MUST</span> construct a list of acceptable reference identifiers
and <span class="bcp14">MUST</span> do so independently of the identifiers presented by the
server.<a class="pilcrow" href="#section-6.1.1-1">¶</a></p>
<p id="section-6.1.1-2">The inputs used by the client to construct its list of reference identifiers
might be a URI that a user has typed into an interface (e.g., an HTTPS URL
for a website), configured account information (e.g., the domain name of a
host for retrieving email, which might be different from the DNS domain name
portion of a username), a hyperlink in a web page that triggers a browser to
retrieve a media object or script, or some other combination of information
that can yield a source domain and an application service type.<a class="pilcrow" href="#section-6.1.1-2">¶</a></p>
<p id="section-6.1.1-3">This document does not precisely define how reference identifiers are generated.
Defining reference identifiers is the responsibility of applications or protocols that use this
document. Because the security of a system that uses this document will depend
on how reference identifiers are generated, great care should be taken in this
process. For example, a protocol or application could specify that the application
service type is obtained through a one-to-one mapping of URI schemes to service
types or that the protocol or application supports only a restricted set of URI schemes.
Similarly, it could
specify that a domain name or an IP address taken as input to the reference
identifier must be obtained in a secure context such as a hyperlink embedded in
a web page that was delivered over an authenticated and encrypted channel
(for instance, see <span>[<a class="cite xref" href="#SECURE-CONTEXTS">SECURE-CONTEXTS</a>]</span> with regard to the web platform).<a class="pilcrow" href="#section-6.1.1-3">¶</a></p>
<p id="section-6.1.1-4">Naturally, if the inputs themselves are invalid or corrupt (e.g., a user has
clicked a hyperlink provided by a malicious entity in a phishing attack),
then the client might end up communicating with an unexpected application
service.<a class="pilcrow" href="#section-6.1.1-4">¶</a></p>
<p id="section-6.1.1-5">During the course of processing, a client might be exposed to identifiers that
look like, but are not, reference identifiers. For example, DNS resolution that
starts at a DNS-ID reference identifier might produce intermediate domain names
that need to be further resolved. Unless an application defines a process
for authenticating intermediate identifiers in a way that then allows
them to be used as a reference identifier (for example, see <span>[<a class="cite xref" href="#RFC8689">SMTP-TLS</a>]</span>),
any intermediate values are not reference
identifiers and <span class="bcp14">MUST NOT</span> be treated as such.
In the DNS case, not treating intermediate domain names as reference identifiers
removes DNS and DNS resolution from the attack surface.<a class="pilcrow" href="#section-6.1.1-5">¶</a></p>
<p id="section-6.1.1-6">As one example of the process of generating a reference identifier, from the user
input of the URI &lt;sip:alice@voice.college.example&gt;, a client could derive the application
service type <code>sip</code> from the URI scheme and parse the domain name <code>college.example</code>
   from the "host" component.<a class="pilcrow" href="#section-6.1.1-6">¶</a></p>
<p id="section-6.1.1-7">Using the combination of one or more FQDNs or IP addresses, plus optionally an application service type, the client
<span class="bcp14">MUST</span> construct its list of reference identifiers in accordance with the
following rules:<a class="pilcrow" href="#section-6.1.1-7">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.1-8.1">If a server for the application service type is typically associated
with a URI for security purposes (i.e., a formal protocol document
specifies the use of URIs in server certificates), the reference identifier
<span class="bcp14">SHOULD</span> be a URI-ID.<a class="pilcrow" href="#section-6.1.1-8.1">¶</a>
</li>
            <li class="normal" id="section-6.1.1-8.2">If a server for the application service type is typically discovered
by means of DNS SRV records, the reference identifier <span class="bcp14">SHOULD</span> be an SRV-ID.<a class="pilcrow" href="#section-6.1.1-8.2">¶</a>
</li>
            <li class="normal" id="section-6.1.1-8.3">If the reference identifier is an IP address, the reference identifier is an
IP-ID.<a class="pilcrow" href="#section-6.1.1-8.3">¶</a>
</li>
            <li class="normal" id="section-6.1.1-8.4">In the absence of more specific identifiers, the reference identifier is a DNS-ID.
A reference identifier of type DNS-ID can be directly constructed from an
FQDN that is (a) contained in or securely derived from the inputs or
(b) explicitly associated with the source domain by means of user
configuration.<a class="pilcrow" href="#section-6.1.1-8.4">¶</a>
</li>
          </ul>
<p id="section-6.1.1-9">Which identifier types a client includes in its list of reference
identifiers, and their priority, is a matter of local policy.  For example, a
client that is built to connect only to a particular kind of service might be
configured to accept as valid only certificates that include an SRV-ID for
that application service type.  By contrast, a more lenient client, even if
built to connect only to a particular kind of service, might include
SRV-IDs, DNS-IDs, and IP-IDs in its list of reference identifiers.<a class="pilcrow" href="#section-6.1.1-9">¶</a></p>
</section>
</div>
<div id="verify-reference-examples">
<section id="section-6.1.2">
          <h4 id="name-examples-2">
<a class="section-number selfRef" href="#section-6.1.2">6.1.2. </a><a class="section-name selfRef" href="#name-examples-2">Examples</a>
          </h4>
<p id="section-6.1.2-1">The following examples are for illustrative purposes only and are not
intended to be comprehensive.<a class="pilcrow" href="#section-6.1.2-1">¶</a></p>
<ol class="normal type-1" id="section-6.1.2-2" start="1" type="1">
<li id="section-6.1.2-2.1">A web browser that is connecting via HTTPS to the website at
<code>&lt;https://www.bigcompany.example/&gt;</code> would have a single reference identifier:
a DNS-ID of <code>www.bigcompany.example</code>.<a class="pilcrow" href="#section-6.1.2-2.1">¶</a>
</li>
            <li id="section-6.1.2-2.2">A web browser connecting to <code>&lt;https://192.0.2.107/&gt;</code> would have a single
IP-ID reference identifier of <code>192.0.2.107</code>. Likewise, if connecting
to <code>&lt;https://[2001:db8::abcd]&gt;</code>, it would have a single IP-ID
reference identifier of <code>2001:db8::abcd</code>.<a class="pilcrow" href="#section-6.1.2-2.2">¶</a>
</li>
            <li id="section-6.1.2-2.3">A mail user agent that is connecting via IMAPS to the email service at
<code>isp.example</code> (resolved as <code>mail.isp.example</code>) might have three reference
identifiers: an SRV-ID of <code>_imaps.isp.example</code> (see <span>[<a class="cite xref" href="#RFC6186">EMAIL-SRV</a>]</span>) and
DNS-IDs of <code>isp.example</code> and <code>mail.isp.example</code>.  An email user agent that
does not support <span>[<a class="cite xref" href="#RFC6186">EMAIL-SRV</a>]</span> would probably be explicitly configured to
connect to <code>mail.isp.example</code>, whereas an SRV-aware user agent would derive
<code>isp.example</code> from an email address of the form <code>user@isp.example</code> but might
also accept <code>mail.isp.example</code> as the DNS domain name portion of reference
identifiers for the service.<a class="pilcrow" href="#section-6.1.2-2.3">¶</a>
</li>
            <li id="section-6.1.2-2.4">A VoIP user agent that is connecting via SIP to the voice
service at <code>voice.college.example</code> might have only one reference identifier:
a URI-ID of <code>sip:voice.college.example</code> (see <span>[<a class="cite xref" href="#RFC5922">SIP-CERTS</a>]</span>).<a class="pilcrow" href="#section-6.1.2-2.4">¶</a>
</li>
            <li id="section-6.1.2-2.5">An IM client that is connecting via XMPP to the IM
service at <code>messenger.example</code> might have three reference identifiers: an
SRV-ID of <code>_xmpp-client.messenger.example</code> (see <span>[<a class="cite xref" href="#RFC6120">XMPP</a>]</span>), a DNS-ID of
<code>messenger.example</code>, and an XMPP-specific <code>XmppAddr</code> of <code>messenger.example</code>
(see <span>[<a class="cite xref" href="#RFC6120">XMPP</a>]</span>).<a class="pilcrow" href="#section-6.1.2-2.5">¶</a>
</li>
          </ol>
<p id="section-6.1.2-3">In all these cases, presented identifiers that do not match the reference
identifier(s) would be rejected; for instance:<a class="pilcrow" href="#section-6.1.2-3">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1.2-4.1">With regard to the first example, a DNS-ID of <code>web.bigcompany.example</code> would
be rejected because the DNS domain name portion does not match
<code>www.bigcompany.example</code>.<a class="pilcrow" href="#section-6.1.2-4.1">¶</a>
</li>
            <li class="normal" id="section-6.1.2-4.2">With regard to the third example, a URI-ID of &lt;sip:www.college.example&gt;
would be rejected because the DNS domain name portion does not match
"voice.college.example", and a DNS-ID of "voice.college.example" would be
rejected because it lacks the appropriate application service type
portion (i.e., it does not specify a "sip:" URI).<a class="pilcrow" href="#section-6.1.2-4.2">¶</a>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="verify-seek">
<section id="section-6.2">
        <h3 id="name-preparing-to-seek-a-match">
<a class="section-number selfRef" href="#section-6.2">6.2. </a><a class="section-name selfRef" href="#name-preparing-to-seek-a-match">Preparing to Seek a Match</a>
        </h3>
<p id="section-6.2-1">Once the client has constructed its list of reference identifiers and has
received the server's presented identifiers,
the client checks its reference identifiers against the presented identifiers
for the purpose of finding a match.
The search fails if the client exhausts
its list of reference identifiers without finding a match.  The search succeeds
if any presented identifier matches one of the reference identifiers, at
which point the client <span class="bcp14">SHOULD</span> stop the search.<a class="pilcrow" href="#section-6.2-1">¶</a></p>
<p id="section-6.2-2">Before applying the comparison rules provided in the following
sections, the client might need to split the reference identifier into
components.
Each reference identifier produces either a domain name or an IP address and
optionally an application service type as follows:<a class="pilcrow" href="#section-6.2-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2-3.1">A DNS-ID reference identifier <span class="bcp14">MUST</span> be used directly as the DNS domain
   name, and there is no application service type.<a class="pilcrow" href="#section-6.2-3.1">¶</a>
</li>
          <li class="normal" id="section-6.2-3.2">An IP-ID reference identifier <span class="bcp14">MUST</span> exactly match the value of an
iPAddress entry in subjectAltName, with no partial (e.g., network-level) matching. There is no application service type.<a class="pilcrow" href="#section-6.2-3.2">¶</a>
</li>
          <li class="normal" id="section-6.2-3.3">For an SRV-ID reference identifier, the DNS domain name portion is
the Name and the application service type portion is the Service.  For
example, an SRV-ID of <code>_imaps.isp.example</code> has a DNS domain name portion
of <code>isp.example</code> and an application service type portion of
<code>imaps</code>, which maps to the IMAP application protocol as explained in
<span>[<a class="cite xref" href="#RFC6186">EMAIL-SRV</a>]</span>.<a class="pilcrow" href="#section-6.2-3.3">¶</a>
</li>
          <li class="normal" id="section-6.2-3.4">For a reference identifier of type URI-ID, the DNS domain name
portion is the "reg-name" part of the "host" component and the application
service type portion is the scheme, as defined above.  Matching only the
"reg-name" rule from <span>[<a class="cite xref" href="#RFC3986">URI</a>]</span> limits the additional domain name validation
(<a class="auto internal xref" href="#verify-domain">Section 6.3</a>) to DNS domain names or non-IP hostnames.
A URI that contains an IP address might be matched against an IP-ID in place
of a URI-ID by some lenient clients.  This document does not describe how a
URI that contains no "host" component can be matched.  Note that extraction of the
"reg-name" might necessitate normalization of the URI (as explained in
<span><a class="relref" href="https://rfc-editor.org/rfc/rfc3986#section-6">Section 6</a> of [<a class="cite xref" href="#RFC3986">URI</a>]</span>).  For example, a URI-ID of <code>&lt;sip:voice.college.example&gt;</code> would be split
into a DNS domain name portion of <code>voice.college.example</code> and an application
service type of <code>sip</code> (associated with an application protocol of SIP as
explained in <span>[<a class="cite xref" href="#RFC5922">SIP-CERTS</a>]</span>).<a class="pilcrow" href="#section-6.2-3.4">¶</a>
</li>
        </ul>
<p id="section-6.2-4">If the reference identifier produces a domain name, the client <span class="bcp14">MUST</span> match the
DNS name; see <a class="auto internal xref" href="#verify-domain">Section 6.3</a>.
If the reference identifier produces an IP address, the client <span class="bcp14">MUST</span> match the IP
address; see <a class="auto internal xref" href="#verify-ip">Section 6.4</a>.
If an application service type is present, it <span class="bcp14">MUST</span> also match the
service type; see <a class="auto internal xref" href="#verify-app">Section 6.5</a>.<a class="pilcrow" href="#section-6.2-4">¶</a></p>
</section>
</div>
<div id="verify-domain">
<section id="section-6.3">
        <h3 id="name-matching-the-dns-domain-nam">
<a class="section-number selfRef" href="#section-6.3">6.3. </a><a class="section-name selfRef" href="#name-matching-the-dns-domain-nam">Matching the DNS Domain Name Portion</a>
        </h3>
<p id="section-6.3-1">This section describes how the client must determine if the presented DNS
name matches the reference DNS name.  The rules differ depending on whether
the domain to be checked is an
internationalized domain name, as defined in <a class="auto internal xref" href="#names">Section 2</a>, or not.
For clients
that support presented identifiers containing the wildcard character "*", this section
also specifies a supplemental rule for such "wildcard certificates".
This section uses the description of labels and domain names in
 <span>[<a class="cite xref" href="#RFC1034">DNS-CONCEPTS</a>]</span>.<a class="pilcrow" href="#section-6.3-1">¶</a></p>
<p id="section-6.3-2">If the DNS domain name portion of a reference identifier
 is not an internationalized domain name
 (i.e., an FQDN that conforms to "preferred name syntax" as
described in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc1034#section-3.5">Section 3.5</a> of [<a class="cite xref" href="#RFC1034">DNS-CONCEPTS</a>]</span>),
then the matching of the reference identifier against the presented
identifier <span class="bcp14">MUST</span> be performed by comparing the set of domain name labels using
a case-insensitive ASCII comparison, as clarified by <span>[<a class="cite xref" href="#RFC4343">DNS-CASE</a>]</span>.  For
example, <code>WWW.BigCompany.Example</code> would be lower-cased to <code>www.bigcompany.example</code> for
comparison purposes.  Each label <span class="bcp14">MUST</span> match in order for the names to be
considered a match, except as supplemented by the rule about checking
wildcard labels in presented identifiers given below.<a class="pilcrow" href="#section-6.3-2">¶</a></p>
<p id="section-6.3-3">If the DNS domain name portion of a reference identifier is an
internationalized domain name, then the client <span class="bcp14">MUST</span> convert any U-labels
<span>[<a class="cite xref" href="#RFC5890">IDNA-DEFS</a>]</span> in the domain name to A-labels before checking the domain name
or comparing it with others.  In accordance with <span>[<a class="cite xref" href="#RFC5891">IDNA-PROTO</a>]</span>, A-labels
<span class="bcp14">MUST</span> be compared as case-insensitive ASCII.  Each label <span class="bcp14">MUST</span> match in order
for the domain names to be considered to match, except as supplemented by
the rule about checking wildcard labels in presented identifiers given below.<a class="pilcrow" href="#section-6.3-3">¶</a></p>
<p id="section-6.3-4">If the technology specification supports wildcards in presented identifiers, then the client <span class="bcp14">MUST</span>
match the reference identifier against a presented identifier whose DNS
domain name portion contains the wildcard character "*" in a label, provided
these requirements are met:<a class="pilcrow" href="#section-6.3-4">¶</a></p>
<ol class="normal type-1" id="section-6.3-5" start="1" type="1">
<li id="section-6.3-5.1">There is only one wildcard character.<a class="pilcrow" href="#section-6.3-5.1">¶</a>
</li>
          <li id="section-6.3-5.2">The wildcard character appears only as the complete content of the left-most label.<a class="pilcrow" href="#section-6.3-5.2">¶</a>
</li>
        </ol>
<p id="section-6.3-6">If the requirements are not met, the presented identifier is invalid and <span class="bcp14">MUST</span>
be ignored.<a class="pilcrow" href="#section-6.3-6">¶</a></p>
<p id="section-6.3-7">A wildcard in a presented identifier can only match one label in a
reference identifier.  This specification covers only wildcard characters in
presented identifiers, not wildcard characters in reference identifiers or in
DNS domain names more generally.  Therefore, the use of wildcard characters
as described herein is not to be confused with DNS wildcard
matching, where the "*" label always matches at least one whole label and
sometimes more; see <span>[<a class="cite xref" href="#RFC1034">DNS-CONCEPTS</a>], <a class="relref" href="https://rfc-editor.org/rfc/rfc1034#section-4.3.3">Section 4.3.3</a></span> and <span>[<a class="cite xref" href="#RFC4592">DNS-WILDCARDS</a>]</span>.
In particular, it also deviates from <span>[<a class="cite xref" href="#RFC4592">DNS-WILDCARDS</a>], <a class="relref" href="https://rfc-editor.org/rfc/rfc4592#section-2.1.3">Section 2.1.3</a></span>.<a class="pilcrow" href="#section-6.3-7">¶</a></p>
<p id="section-6.3-8">For information regarding the security characteristics of wildcard
certificates, see <a class="auto internal xref" href="#security-wildcards">Section 7.1</a>.<a class="pilcrow" href="#section-6.3-8">¶</a></p>
</section>
</div>
<div id="verify-ip">
<section id="section-6.4">
        <h3 id="name-matching-an-ip-address-port">
<a class="section-number selfRef" href="#section-6.4">6.4. </a><a class="section-name selfRef" href="#name-matching-an-ip-address-port">Matching an IP Address Portion</a>
        </h3>
<p id="section-6.4-1">Matching of an IP-ID is based on an octet-for-octet comparison of the bytes of the
reference identity with the bytes contained in the iPAddress subjectAltName.<a class="pilcrow" href="#section-6.4-1">¶</a></p>
<p id="section-6.4-2">For an IP address that appears in a URI-ID, the "host" component of both the
reference identity and the presented identifier must match.  These are parsed as either
an "IPv6address" (following <span>[<a class="cite xref" href="#RFC3986">URI</a>], <a class="relref" href="https://rfc-editor.org/rfc/rfc3986#section-3.2.2">Section 3.2.2</a></span>) or an "IPv4address" (following <span>[<a class="cite xref" href="#RFC0791">IPv4</a>]</span>).
If the resulting octets are equal, the IP address matches.<a class="pilcrow" href="#section-6.4-2">¶</a></p>
<p id="section-6.4-3">This document does not specify how an SRV-ID reference identity can include an
IP address, as <span>[<a class="cite xref" href="#RFC4985">SRVNAME</a>]</span> only defines string names, not octet identifiers
such as an IP address.<a class="pilcrow" href="#section-6.4-3">¶</a></p>
</section>
</div>
<div id="verify-app">
<section id="section-6.5">
        <h3 id="name-matching-the-application-se">
<a class="section-number selfRef" href="#section-6.5">6.5. </a><a class="section-name selfRef" href="#name-matching-the-application-se">Matching the Application Service Type Portion</a>
        </h3>
<p id="section-6.5-1">The rules for matching the application service type depend on whether
the identifier is an SRV-ID or a URI-ID.<a class="pilcrow" href="#section-6.5-1">¶</a></p>
<p id="section-6.5-2">These identifiers provide an application service type portion to be checked,
but that portion is combined only with the DNS domain name portion of the
SRV-ID or URI-ID itself.  Consider the example of a messaging client that has two reference
identifiers: (1) an SRV-ID of <code>_xmpp-client.messenger.example</code> and (2) a DNS-ID
of <code>app.example</code>.  The client <span class="bcp14">MUST</span> check (1) the combination of (a) an
application service type of <code>xmpp-client</code> and (b) a DNS domain name of
<code>messenger.example</code> as well as (2)
a DNS domain name of <code>app.example</code>.  However, the
client <span class="bcp14">MUST NOT</span> check the combination of an application service type of
<code>xmpp-client</code> and a DNS domain name of <code>app.example</code> because it does not
have an SRV-ID of <code>_xmpp-client.app.example</code> in its list of reference
identifiers.<a class="pilcrow" href="#section-6.5-2">¶</a></p>
<p id="section-6.5-3">If the identifier is an SRV-ID, then the application service name <span class="bcp14">MUST</span>
be matched in a case-insensitive manner, in accordance with <span>[<a class="cite xref" href="#RFC2782">DNS-SRV</a>]</span>.
Note that per <span>[<a class="cite xref" href="#RFC4985">SRVNAME</a>]</span>, the underscore "_" is part of the service name in
DNS SRV records and in SRV-IDs.<a class="pilcrow" href="#section-6.5-3">¶</a></p>
<p id="section-6.5-4">If the identifier is a URI-ID, then the scheme name portion <span class="bcp14">MUST</span> be
matched in a case-insensitive manner, in accordance with <span>[<a class="cite xref" href="#RFC3986">URI</a>]</span>.
Note that the colon ":" is a separator between the scheme name
and the rest of the URI and thus does not need to be included in any
comparison.<a class="pilcrow" href="#section-6.5-4">¶</a></p>
</section>
</div>
<div id="outcome">
<section id="section-6.6">
        <h3 id="name-outcome">
<a class="section-number selfRef" href="#section-6.6">6.6. </a><a class="section-name selfRef" href="#name-outcome">Outcome</a>
        </h3>
<p id="section-6.6-1">If the client has found a presented identifier that matches a reference
identifier, then the service identity check has succeeded.  In this case, the
client <span class="bcp14">MUST</span> use the matched reference identifier as the validated identity of
the application service.<a class="pilcrow" href="#section-6.6-1">¶</a></p>
<p id="section-6.6-2">If the client does not find a presented identifier matching any of the
reference identifiers, then the client <span class="bcp14">MUST</span> proceed as follows.<a class="pilcrow" href="#section-6.6-2">¶</a></p>
<p id="section-6.6-3">If the client is an automated application,
then it <span class="bcp14">SHOULD</span> terminate the communication attempt with a bad
certificate error and log the error appropriately.  The application <span class="bcp14">MAY</span>
provide a configuration setting to disable this behavior, but it <span class="bcp14">MUST NOT</span>
disable this security control by default.<a class="pilcrow" href="#section-6.6-3">¶</a></p>
<p id="section-6.6-4">If the client is one that is directly controlled by a human
user, then it <span class="bcp14">SHOULD</span> inform the user of the identity mismatch and
automatically terminate the communication attempt with a bad certificate
error in order to prevent users from inadvertently bypassing security
protections in hostile situations.
Such clients <span class="bcp14">MAY</span> give advanced users the option of proceeding
with acceptance despite the identity mismatch.  Although this behavior can be
appropriate in certain specialized circumstances, it needs to be handled with
extreme caution, for example by first encouraging even an advanced user to
terminate the communication attempt and, if they choose to proceed anyway, by
forcing the user to view the entire certification path before proceeding.<a class="pilcrow" href="#section-6.6-4">¶</a></p>
<p id="section-6.6-5">The application <span class="bcp14">MAY</span> also present the user with the ability to accept the
presented certificate as valid for subsequent connections.  Such ad hoc
"pinning" <span class="bcp14">SHOULD NOT</span> restrict future connections to just the pinned
certificate. Local policy that statically enforces a given certificate for a
given peer <span class="bcp14">SHOULD</span> be made available only as prior configuration rather than a
just-in-time override for a failed connection.<a class="pilcrow" href="#section-6.6-5">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security">
<section id="section-7">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<div id="security-wildcards">
<section id="section-7.1">
        <h3 id="name-wildcard-certificates">
<a class="section-number selfRef" href="#section-7.1">7.1. </a><a class="section-name selfRef" href="#name-wildcard-certificates">Wildcard Certificates</a>
        </h3>
<p id="section-7.1-1">Wildcard certificates automatically vouch for any single-label hostnames
within their domain, but not multiple levels of domains.  This can be
convenient for administrators but also poses the risk of vouching for rogue
or buggy hosts. For example, see <span>[<a class="cite xref" href="#Defeating-SSL">Defeating-SSL</a>]</span> (beginning at slide 91) and
<span>[<a class="cite xref" href="#HTTPSbytes">HTTPSbytes</a>]</span> (slides 38-40).<a class="pilcrow" href="#section-7.1-1">¶</a></p>
<p id="section-7.1-2">As specified in <a class="auto internal xref" href="#verify-domain">Section 6.3</a>, restricting the presented identifiers in certificates to only one
wildcard character (e.g., "*.bigcompany.example" but not "*.*.bigcompany.example") and
restricting the use of wildcards to only the left-most domain label can
help to mitigate certain aspects of the attack described in <span>[<a class="cite xref" href="#Defeating-SSL">Defeating-SSL</a>]</span>.<a class="pilcrow" href="#section-7.1-2">¶</a></p>
<p id="section-7.1-3">That same attack also relies on the initial use of a cleartext HTTP connection,
which is hijacked by an active on-path attacker and subsequently upgraded to
HTTPS.  In order to mitigate such an attack, administrators and software
developers are advised to follow the strict TLS guidelines provided in
<span>[<a class="cite xref" href="#RFC9325">TLS-REC</a>], <a class="relref" href="https://rfc-editor.org/rfc/rfc9325#section-3.2">Section 3.2</a></span>.<a class="pilcrow" href="#section-7.1-3">¶</a></p>
<p id="section-7.1-4">Because the attack described in <span>[<a class="cite xref" href="#HTTPSbytes">HTTPSbytes</a>]</span> relies on an underlying
cross-site scripting (XSS) attack, web browsers and applications are advised
to follow best practices to prevent XSS attacks; for example, see <span>[<a class="cite xref" href="#XSS">XSS</a>]</span>, which was
published by the Open Web Application Security Project (OWASP).<a class="pilcrow" href="#section-7.1-4">¶</a></p>
<p id="section-7.1-5">Protection against a wildcard that identifies a public suffix
<span>[<a class="cite xref" href="#Public-Suffix">Public-Suffix</a>]</span>, such as <code>*.co.uk</code> or <code>*.com</code>, is beyond the scope of this
document.<a class="pilcrow" href="#section-7.1-5">¶</a></p>
<p id="section-7.1-6">As noted in <a class="auto internal xref" href="#design">Section 3</a>, application protocols can disallow the use of
wildcard certificates entirely as a more foolproof mitigation.<a class="pilcrow" href="#section-7.1-6">¶</a></p>
</section>
</div>
<div id="security-uri">
<section id="section-7.2">
        <h3 id="name-uniform-resource-identifier">
<a class="section-number selfRef" href="#section-7.2">7.2. </a><a class="section-name selfRef" href="#name-uniform-resource-identifier">Uniform Resource Identifiers</a>
        </h3>
<p id="section-7.2-1">The URI-ID type is a subjectAltName entry of type uniformResourceIdentifier
as defined in <span>[<a class="cite xref" href="#RFC5280">PKIX</a>]</span>.  For the purposes of this specification, the URI-ID
<span class="bcp14">MUST</span> include both a "scheme" and a "host" component that matches the "reg-name"
rule; if the entry does not include both, it is not a valid URI-ID and <span class="bcp14">MUST</span> be
ignored.  Any other components are ignored because only the "scheme" and "host"
components are used for certificate matching as specified under <a class="auto internal xref" href="#verify">Section 6</a>.<a class="pilcrow" href="#section-7.2-1">¶</a></p>
<p id="section-7.2-2">The quoted component names in the previous paragraph represent the associated
<span>[<a class="cite xref" href="#RFC5234">ABNF</a>]</span> productions from the IETF Proposed Standard for Uniform Resource Identifiers
<span>[<a class="cite xref" href="#RFC3986">URI</a>]</span>.  Although the reader should be aware that some applications (e.g.,
web browsers) might instead conform to the Uniform Resource Locator (URL)
specification maintained by the WHATWG <span>[<a class="cite xref" href="#URL">URL</a>]</span>, it is not expected that
differences between the URI and URL specifications would manifest themselves
in certificate matching.<a class="pilcrow" href="#section-7.2-2">¶</a></p>
</section>
</div>
<div id="security-idn">
<section id="section-7.3">
        <h3 id="name-internationalized-domain-na">
<a class="section-number selfRef" href="#section-7.3">7.3. </a><a class="section-name selfRef" href="#name-internationalized-domain-na">Internationalized Domain Names</a>
        </h3>
<p id="section-7.3-1">This document specifies only matching between reference identifiers and
presented identifiers, not the visual presentation of domain names. 
Specifically, the matching of internationalized domain names is performed on
A-labels only (<a class="auto internal xref" href="#verify-domain">Section 6.3</a>). The limited scope of this specification likely
mitigates potential confusion caused by the use of visually similar characters
in domain names (for example, as described in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc5890#section-4.4">Section 4.4</a> of [<a class="cite xref" href="#RFC5890">IDNA-DEFS</a>]</span>,
<span>[<a class="cite xref" href="#UTS-36">UTS-36</a>]</span>, and <span>[<a class="cite xref" href="#UTS-39">UTS-39</a>]</span>); in any case, such concerns are a matter for
application-level protocols and user interfaces, not the matching of certificates.<a class="pilcrow" href="#section-7.3-1">¶</a></p>
</section>
</div>
<div id="ip-addresses">
<section id="section-7.4">
        <h3 id="name-ip-addresses">
<a class="section-number selfRef" href="#section-7.4">7.4. </a><a class="section-name selfRef" href="#name-ip-addresses">IP Addresses</a>
        </h3>
<p id="section-7.4-1">The TLS Server Name Indication (SNI) extension only conveys domain names.
Therefore, a client with an IP-ID reference identity cannot present any
information about its reference identity when connecting to a server.  Servers
that wish to present an IP-ID therefore need to present this identity when a
connection is made without SNI.<a class="pilcrow" href="#section-7.4-1">¶</a></p>
<p id="section-7.4-2">The textual representation of an IPv4 address might be misinterpreted
as a valid FQDN in some contexts.  This can result in different
security treatment that might cause different components of a system
to classify the value differently, which might lead to
vulnerabilities.  Consider a system in which one component enforces a
security rule that is conditional on the type of identifier but 
misclassifies an IP address as an FQDN, whereas a second component 
correctly classifies the identifier but incorrectly assumes that 
rules regarding IP addresses have been enforced by the first 
component. As a result, the system as a whole might behave in an 
insecure manner.  Consistent classification of identifiers avoids 
this problem.<a class="pilcrow" href="#section-7.4-2">¶</a></p>
<p id="section-7.4-3">See also <a class="auto internal xref" href="#design">Section 3</a>, particularly the last paragraph.<a class="pilcrow" href="#section-7.4-3">¶</a></p>
</section>
</div>
<div id="security-multi">
<section id="section-7.5">
        <h3 id="name-multiple-presented-identifi">
<a class="section-number selfRef" href="#section-7.5">7.5. </a><a class="section-name selfRef" href="#name-multiple-presented-identifi">Multiple Presented Identifiers</a>
        </h3>
<p id="section-7.5-1">A given application service might be addressed by multiple DNS domain names
for a variety of reasons, and a given deployment might service multiple
domains or protocols.
TLS extensions such as the Server Name Indication (SNI), as discussed in <span>[<a class="cite xref" href="#RFC6066">TLS-EXT</a>], <a class="relref" href="https://rfc-editor.org/rfc/rfc6066#section-3">Section 3</a></span>, and ALPN, as discussed in <span>[<a class="cite xref" href="#RFC7301">ALPN</a>]</span>, provide a way for the application
to indicate the desired identifier and protocol to the server, which it
can then use to select the most appropriate certificate.<a class="pilcrow" href="#section-7.5-1">¶</a></p>
<p id="section-7.5-2">This specification allows multiple DNS-IDs, IP-IDs, SRV-IDs, or URI-IDs in a
certificate.  As a result, an application service can use the same
certificate for multiple hostnames, such as when a client does not support
the TLS SNI extension, or for multiple protocols, such as SMTP and HTTP, on a
single hostname.  Note that the set of names in a certificate is the set of
names that could be affected by a compromise of any other server named in
the set: the strength of any server in the set of names is determined by the
weakest of those servers that offer the names.<a class="pilcrow" href="#section-7.5-2">¶</a></p>
<p id="section-7.5-3">The way to mitigate this risk is to limit the number of names that
any server can speak for and to ensure that all servers in the set
have a strong minimum configuration as described in <span>[<a class="cite xref" href="#RFC9325">TLS-REC</a>], <a class="relref" href="https://rfc-editor.org/rfc/rfc9325#section-3.9">Section 3.9</a></span>.<a class="pilcrow" href="#section-7.5-3">¶</a></p>
</section>
</div>
<div id="multiple-reference-identifiers">
<section id="section-7.6">
        <h3 id="name-multiple-reference-identifi">
<a class="section-number selfRef" href="#section-7.6">7.6. </a><a class="section-name selfRef" href="#name-multiple-reference-identifi">Multiple Reference Identifiers</a>
        </h3>
<p id="section-7.6-1">This specification describes how a client may construct multiple acceptable
reference identifiers and may match any of those reference identifiers with
the set of presented identifiers. <span>[<a class="cite xref" href="#RFC5280">PKIX</a>], <a class="relref" href="https://rfc-editor.org/rfc/rfc5280#section-4.2.1.10">Section 4.2.1.10</a></span> describes a
mechanism to allow CA certificates to be constrained in the set of presented
identifiers that they may include within server certificates.  However, these
constraints only apply to the explicitly enumerated name forms. For example,
a CA that is only name-constrained for DNS-IDs is not constrained for SRV-IDs
and URI-IDs, unless those name forms are also explicitly included within the
name constraints extension.<a class="pilcrow" href="#section-7.6-1">¶</a></p>
<p id="section-7.6-2">A client that constructs multiple reference identifiers of different types,
such as both DNS-IDs and SRV-IDs as described in <a class="auto internal xref" href="#verify-reference-rules">Section 6.1.1</a>,
<span class="bcp14">SHOULD</span> take care to ensure that CAs issuing such certificates are
appropriately constrained. This <span class="bcp14">MAY</span> take the form of local policy through
agreement with the issuing CA or <span class="bcp14">MAY</span> be enforced by the client requiring
that if one form of presented identifier is constrained, such as a dNSName
name constraint for DNS-IDs, then all other forms of acceptable reference
identities are also constrained, such as requiring a uniformResourceIndicator
name constraint for URI-IDs.<a class="pilcrow" href="#section-7.6-2">¶</a></p>
</section>
</div>
<div id="certificate-trust">
<section id="section-7.7">
        <h3 id="name-certificate-trust">
<a class="section-number selfRef" href="#section-7.7">7.7. </a><a class="section-name selfRef" href="#name-certificate-trust">Certificate Trust</a>
        </h3>
<p id="section-7.7-1">This document assumes that if a client trusts a given CA, it trusts all
certificates issued by that CA.  The certificate checking process does not
include additional checks for bad behavior by the hosts identified with
such certificates, for instance, rogue servers or buggy applications.  Any
additional checks (e.g., checking the server name against trusted block
lists) are the responsibility of the application protocol or the client
itself.<a class="pilcrow" href="#section-7.7-1">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-8">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-8">8. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<p id="section-8-1">This document has no IANA actions.<a class="pilcrow" href="#section-8-1">¶</a></p>
</section>
</div>
<section id="section-9">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-9">9. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-9.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-9.1">9.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC1034">[DNS-CONCEPTS]</dt>
        <dd>
<span class="refAuthor">Mockapetris, P.</span>, <span class="refTitle">"Domain names - concepts and facilities"</span>, <span class="seriesInfo">STD 13</span>, <span class="seriesInfo">RFC 1034</span>, <span class="seriesInfo">DOI 10.17487/RFC1034</span>, <time class="refDate" datetime="1987-11">November 1987</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1034">https://www.rfc-editor.org/info/rfc1034</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2782">[DNS-SRV]</dt>
        <dd>
<span class="refAuthor">Gulbrandsen, A.</span>, <span class="refAuthor">Vixie, P.</span>, and <span class="refAuthor">L. Esibov</span>, <span class="refTitle">"A DNS RR for specifying the location of services (DNS SRV)"</span>, <span class="seriesInfo">RFC 2782</span>, <span class="seriesInfo">DOI 10.17487/RFC2782</span>, <time class="refDate" datetime="2000-02">February 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2782">https://www.rfc-editor.org/info/rfc2782</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4592">[DNS-WILDCARDS]</dt>
        <dd>
<span class="refAuthor">Lewis, E.</span>, <span class="refTitle">"The Role of Wildcards in the Domain Name System"</span>, <span class="seriesInfo">RFC 4592</span>, <span class="seriesInfo">DOI 10.17487/RFC4592</span>, <time class="refDate" datetime="2006-07">July 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4592">https://www.rfc-editor.org/info/rfc4592</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5890">[IDNA-DEFS]</dt>
        <dd>
<span class="refAuthor">Klensin, J.</span>, <span class="refTitle">"Internationalized Domain Names for Applications (IDNA): Definitions and Document Framework"</span>, <span class="seriesInfo">RFC 5890</span>, <span class="seriesInfo">DOI 10.17487/RFC5890</span>, <time class="refDate" datetime="2010-08">August 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5890">https://www.rfc-editor.org/info/rfc5890</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5891">[IDNA-PROTO]</dt>
        <dd>
<span class="refAuthor">Klensin, J.</span>, <span class="refTitle">"Internationalized Domain Names in Applications (IDNA): Protocol"</span>, <span class="seriesInfo">RFC 5891</span>, <span class="seriesInfo">DOI 10.17487/RFC5891</span>, <time class="refDate" datetime="2010-08">August 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5891">https://www.rfc-editor.org/info/rfc5891</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC0791">[IPv4]</dt>
        <dd>
<span class="refAuthor">Postel, J.</span>, <span class="refTitle">"Internet Protocol"</span>, <span class="seriesInfo">STD 5</span>, <span class="seriesInfo">RFC 791</span>, <span class="seriesInfo">DOI 10.17487/RFC0791</span>, <time class="refDate" datetime="1981-09">September 1981</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc791">https://www.rfc-editor.org/info/rfc791</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4291">[IPv6]</dt>
        <dd>
<span class="refAuthor">Hinden, R.</span> and <span class="refAuthor">S. Deering</span>, <span class="refTitle">"IP Version 6 Addressing Architecture"</span>, <span class="seriesInfo">RFC 4291</span>, <span class="seriesInfo">DOI 10.17487/RFC4291</span>, <time class="refDate" datetime="2006-02">February 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4291">https://www.rfc-editor.org/info/rfc4291</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4514">[LDAP-DN]</dt>
        <dd>
<span class="refAuthor">Zeilenga, K., Ed.</span>, <span class="refTitle">"Lightweight Directory Access Protocol (LDAP): String Representation of Distinguished Names"</span>, <span class="seriesInfo">RFC 4514</span>, <span class="seriesInfo">DOI 10.17487/RFC4514</span>, <time class="refDate" datetime="2006-06">June 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4514">https://www.rfc-editor.org/info/rfc4514</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[PKIX]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time class="refDate" datetime="2008-05">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5280">https://www.rfc-editor.org/info/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time class="refDate" datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time class="refDate" datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4985">[SRVNAME]</dt>
        <dd>
<span class="refAuthor">Santesson, S.</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Subject Alternative Name for Expression of Service Name"</span>, <span class="seriesInfo">RFC 4985</span>, <span class="seriesInfo">DOI 10.17487/RFC4985</span>, <time class="refDate" datetime="2007-08">August 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4985">https://www.rfc-editor.org/info/rfc4985</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9325">[TLS-REC]</dt>
        <dd>
<span class="refAuthor">Sheffer, Y.</span>, <span class="refAuthor">Saint-Andre, P.</span>, and <span class="refAuthor">T. Fossati</span>, <span class="refTitle">"Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"</span>, <span class="seriesInfo">BCP 195</span>, <span class="seriesInfo">RFC 9325</span>, <span class="seriesInfo">DOI 10.17487/RFC9325</span>, <time class="refDate" datetime="2022-11">November 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9325">https://www.rfc-editor.org/info/rfc9325</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3986">[URI]</dt>
      <dd>
<span class="refAuthor">Berners-Lee, T.</span>, <span class="refAuthor">Fielding, R.</span>, and <span class="refAuthor">L. Masinter</span>, <span class="refTitle">"Uniform Resource Identifier (URI): Generic Syntax"</span>, <span class="seriesInfo">STD 66</span>, <span class="seriesInfo">RFC 3986</span>, <span class="seriesInfo">DOI 10.17487/RFC3986</span>, <time class="refDate" datetime="2005-01">January 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3986">https://www.rfc-editor.org/info/rfc3986</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-9.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-9.2">9.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC5234">[ABNF]</dt>
        <dd>
<span class="refAuthor">Crocker, D., Ed.</span> and <span class="refAuthor">P. Overell</span>, <span class="refTitle">"Augmented BNF for Syntax Specifications: ABNF"</span>, <span class="seriesInfo">STD 68</span>, <span class="seriesInfo">RFC 5234</span>, <span class="seriesInfo">DOI 10.17487/RFC5234</span>, <time class="refDate" datetime="2008-01">January 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5234">https://www.rfc-editor.org/info/rfc5234</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8555">[ACME]</dt>
        <dd>
<span class="refAuthor">Barnes, R.</span>, <span class="refAuthor">Hoffman-Andrews, J.</span>, <span class="refAuthor">McCarney, D.</span>, and <span class="refAuthor">J. Kasten</span>, <span class="refTitle">"Automatic Certificate Management Environment (ACME)"</span>, <span class="seriesInfo">RFC 8555</span>, <span class="seriesInfo">DOI 10.17487/RFC8555</span>, <time class="refDate" datetime="2019-03">March 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8555">https://www.rfc-editor.org/info/rfc8555</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ALPACA">[ALPACA]</dt>
        <dd>
<span class="refAuthor">Brinkmann, M.</span>, <span class="refAuthor">Dresen, C.</span>, <span class="refAuthor">Merget, R.</span>, <span class="refAuthor">Poddebniak, D.</span>, <span class="refAuthor">Müller, J.</span>, <span class="refAuthor">Somorovsky, J.</span>, <span class="refAuthor">Schwenk, J.</span>, and <span class="refAuthor">S. Schinzel</span>, <span class="refTitle">"ALPACA: Application Layer Protocol Confusion - Analyzing and Mitigating Cracks in TLS Authentication"</span>, <span class="refContent">30th USENIX Security Symposium (USENIX Security 21)</span>, <time class="refDate" datetime="2021-09">September 2021</time>, <span>&lt;<a href="https://alpaca-attack.com/ALPACA.pdf">https://alpaca-attack.com/ALPACA.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7301">[ALPN]</dt>
        <dd>
<span class="refAuthor">Friedl, S.</span>, <span class="refAuthor">Popov, A.</span>, <span class="refAuthor">Langley, A.</span>, and <span class="refAuthor">E. Stephan</span>, <span class="refTitle">"Transport Layer Security (TLS) Application-Layer Protocol Negotiation Extension"</span>, <span class="seriesInfo">RFC 7301</span>, <span class="seriesInfo">DOI 10.17487/RFC7301</span>, <time class="refDate" datetime="2014-07">July 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7301">https://www.rfc-editor.org/info/rfc7301</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6698">[DANE]</dt>
        <dd>
<span class="refAuthor">Hoffman, P.</span> and <span class="refAuthor">J. Schlyter</span>, <span class="refTitle">"The DNS-Based Authentication of Named Entities (DANE) Transport Layer Security (TLS) Protocol: TLSA"</span>, <span class="seriesInfo">RFC 6698</span>, <span class="seriesInfo">DOI 10.17487/RFC6698</span>, <time class="refDate" datetime="2012-08">August 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6698">https://www.rfc-editor.org/info/rfc6698</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Defeating-SSL">[Defeating-SSL]</dt>
        <dd>
<span class="refAuthor">Marlinspike, M.</span>, <span class="refTitle">"New Tricks for Defeating SSL in Practice"</span>, <span class="refContent">Black Hat DC</span>, <time class="refDate" datetime="2009-02">February 2009</time>, <span>&lt;<a href="https://www.blackhat.com/presentations/bh-dc-09/Marlinspike/BlackHat-DC-09-Marlinspike-Defeating-SSL.pdf">https://www.blackhat.com/presentations/bh-dc-09/Marlinspike/BlackHat-DC-09-Marlinspike-Defeating-SSL.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4343">[DNS-CASE]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refTitle">"Domain Name System (DNS) Case Insensitivity Clarification"</span>, <span class="seriesInfo">RFC 4343</span>, <span class="seriesInfo">DOI 10.17487/RFC4343</span>, <time class="refDate" datetime="2006-01">January 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4343">https://www.rfc-editor.org/info/rfc4343</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7858">[DNS-OVER-TLS]</dt>
        <dd>
<span class="refAuthor">Hu, Z.</span>, <span class="refAuthor">Zhu, L.</span>, <span class="refAuthor">Heidemann, J.</span>, <span class="refAuthor">Mankin, A.</span>, <span class="refAuthor">Wessels, D.</span>, and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Specification for DNS over Transport Layer Security (TLS)"</span>, <span class="seriesInfo">RFC 7858</span>, <span class="seriesInfo">DOI 10.17487/RFC7858</span>, <time class="refDate" datetime="2016-05">May 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7858">https://www.rfc-editor.org/info/rfc7858</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9147">[DTLS]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refAuthor">Tschofenig, H.</span>, and <span class="refAuthor">N. Modadugu</span>, <span class="refTitle">"The Datagram Transport Layer Security (DTLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 9147</span>, <span class="seriesInfo">DOI 10.17487/RFC9147</span>, <time class="refDate" datetime="2022-04">April 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9147">https://www.rfc-editor.org/info/rfc9147</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6186">[EMAIL-SRV]</dt>
        <dd>
<span class="refAuthor">Daboo, C.</span>, <span class="refTitle">"Use of SRV Records for Locating Email Submission/Access Services"</span>, <span class="seriesInfo">RFC 6186</span>, <span class="seriesInfo">DOI 10.17487/RFC6186</span>, <time class="refDate" datetime="2011-03">March 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6186">https://www.rfc-editor.org/info/rfc6186</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9110">[HTTP]</dt>
        <dd>
<span class="refAuthor">Fielding, R., Ed.</span>, <span class="refAuthor">Nottingham, M., Ed.</span>, and <span class="refAuthor">J. Reschke, Ed.</span>, <span class="refTitle">"HTTP Semantics"</span>, <span class="seriesInfo">STD 97</span>, <span class="seriesInfo">RFC 9110</span>, <span class="seriesInfo">DOI 10.17487/RFC9110</span>, <time class="refDate" datetime="2022-06">June 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9110">https://www.rfc-editor.org/info/rfc9110</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="HTTPSbytes">[HTTPSbytes]</dt>
        <dd>
<span class="refAuthor">Sokol, J.</span> and <span class="refAuthor">R. Hansen</span>, <span class="refTitle">"HTTPS Can Byte Me"</span>, <span class="refContent">Black Hat Briefings</span>, <time class="refDate" datetime="2010-11">November 2010</time>, <span>&lt;<a href="https://media.blackhat.com/bh-ad-10/Hansen/Blackhat-AD-2010-Hansen-Sokol-HTTPS-Can-Byte-Me-slides.pdf">https://media.blackhat.com/bh-ad-10/Hansen/Blackhat-AD-2010-Hansen-Sokol-HTTPS-Can-Byte-Me-slides.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3403">[NAPTR]</dt>
        <dd>
<span class="refAuthor">Mealling, M.</span>, <span class="refTitle">"Dynamic Delegation Discovery System (DDDS) Part Three: The Domain Name System (DNS) Database"</span>, <span class="seriesInfo">RFC 3403</span>, <span class="seriesInfo">DOI 10.17487/RFC3403</span>, <time class="refDate" datetime="2002-10">October 2002</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3403">https://www.rfc-editor.org/info/rfc3403</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8915">[NTS]</dt>
        <dd>
<span class="refAuthor">Franke, D.</span>, <span class="refAuthor">Sibold, D.</span>, <span class="refAuthor">Teichel, K.</span>, <span class="refAuthor">Dansarie, M.</span>, and <span class="refAuthor">R. Sundblad</span>, <span class="refTitle">"Network Time Security for the Network Time Protocol"</span>, <span class="seriesInfo">RFC 8915</span>, <span class="seriesInfo">DOI 10.17487/RFC8915</span>, <time class="refDate" datetime="2020-09">September 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8915">https://www.rfc-editor.org/info/rfc8915</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Public-Suffix">[Public-Suffix]</dt>
        <dd>
<span class="refAuthor">Mozilla Foundation</span>, <span class="refTitle">"Public Suffix List"</span>, <span>&lt;<a href="https://publicsuffix.org">https://publicsuffix.org</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9001">[QUIC]</dt>
        <dd>
<span class="refAuthor">Thomson, M., Ed.</span> and <span class="refAuthor">S. Turner, Ed.</span>, <span class="refTitle">"Using TLS to Secure QUIC"</span>, <span class="seriesInfo">RFC 9001</span>, <span class="seriesInfo">DOI 10.17487/RFC9001</span>, <time class="refDate" datetime="2021-05">May 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9001">https://www.rfc-editor.org/info/rfc9001</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9000">[RFC9000]</dt>
        <dd>
<span class="refAuthor">Iyengar, J., Ed.</span> and <span class="refAuthor">M. Thomson, Ed.</span>, <span class="refTitle">"QUIC: A UDP-Based Multiplexed and Secure Transport"</span>, <span class="seriesInfo">RFC 9000</span>, <span class="seriesInfo">DOI 10.17487/RFC9000</span>, <time class="refDate" datetime="2021-05">May 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9000">https://www.rfc-editor.org/info/rfc9000</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4949">[SECTERMS]</dt>
        <dd>
<span class="refAuthor">Shirey, R.</span>, <span class="refTitle">"Internet Security Glossary, Version 2"</span>, <span class="seriesInfo">FYI 36</span>, <span class="seriesInfo">RFC 4949</span>, <span class="seriesInfo">DOI 10.17487/RFC4949</span>, <time class="refDate" datetime="2007-08">August 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4949">https://www.rfc-editor.org/info/rfc4949</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SECURE-CONTEXTS">[SECURE-CONTEXTS]</dt>
        <dd>
<span class="refAuthor">West, M.</span>, <span class="refTitle">"Secure Contexts"</span>, <span class="refContent">W3C Candidate Recommendation Draft</span>, <time class="refDate" datetime="2021-09">September 2021</time>, <span>&lt;<a href="https://www.w3.org/TR/secure-contexts/">https://www.w3.org/TR/secure-contexts/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3261">[SIP]</dt>
        <dd>
<span class="refAuthor">Rosenberg, J.</span>, <span class="refAuthor">Schulzrinne, H.</span>, <span class="refAuthor">Camarillo, G.</span>, <span class="refAuthor">Johnston, A.</span>, <span class="refAuthor">Peterson, J.</span>, <span class="refAuthor">Sparks, R.</span>, <span class="refAuthor">Handley, M.</span>, and <span class="refAuthor">E. Schooler</span>, <span class="refTitle">"SIP: Session Initiation Protocol"</span>, <span class="seriesInfo">RFC 3261</span>, <span class="seriesInfo">DOI 10.17487/RFC3261</span>, <time class="refDate" datetime="2002-06">June 2002</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3261">https://www.rfc-editor.org/info/rfc3261</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5922">[SIP-CERTS]</dt>
        <dd>
<span class="refAuthor">Gurbani, V.</span>, <span class="refAuthor">Lawrence, S.</span>, and <span class="refAuthor">A. Jeffrey</span>, <span class="refTitle">"Domain Certificates in the Session Initiation Protocol (SIP)"</span>, <span class="seriesInfo">RFC 5922</span>, <span class="seriesInfo">DOI 10.17487/RFC5922</span>, <time class="refDate" datetime="2010-06">June 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5922">https://www.rfc-editor.org/info/rfc5922</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5630">[SIP-SIPS]</dt>
        <dd>
<span class="refAuthor">Audet, F.</span>, <span class="refTitle">"The Use of the SIPS URI Scheme in the Session Initiation Protocol (SIP)"</span>, <span class="seriesInfo">RFC 5630</span>, <span class="seriesInfo">DOI 10.17487/RFC5630</span>, <time class="refDate" datetime="2009-10">October 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5630">https://www.rfc-editor.org/info/rfc5630</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8689">[SMTP-TLS]</dt>
        <dd>
<span class="refAuthor">Fenton, J.</span>, <span class="refTitle">"SMTP Require TLS Option"</span>, <span class="seriesInfo">RFC 8689</span>, <span class="seriesInfo">DOI 10.17487/RFC8689</span>, <time class="refDate" datetime="2019-11">November 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8689">https://www.rfc-editor.org/info/rfc8689</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9461">[SVCB-FOR-DNS]</dt>
        <dd>
<span class="refAuthor">Schwartz, B.</span>, <span class="refTitle">"Service Binding Mapping for DNS Servers"</span>, <span class="seriesInfo">RFC 9461</span>, <span class="seriesInfo">DOI 10.17487/RFC9461</span>, <time class="refDate" datetime="2023-11">November 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9461">https://www.rfc-editor.org/info/rfc9461</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9460">[SVCB-FOR-HTTPS]</dt>
        <dd>
<span class="refAuthor">Schwartz, B.</span>, <span class="refAuthor">Bishop, M.</span>, and <span class="refAuthor">E. Nygren</span>, <span class="refTitle">"Service Binding and Parameter Specification via the DNS (SVCB and HTTPS Resource Records)"</span>, <span class="seriesInfo">RFC 9460</span>, <span class="seriesInfo">DOI 10.17487/RFC9460</span>, <time class="refDate" datetime="2023-11">November 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9460">https://www.rfc-editor.org/info/rfc9460</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[TLS]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time class="refDate" datetime="2018-08">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6066">[TLS-EXT]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refTitle">"Transport Layer Security (TLS) Extensions: Extension Definitions"</span>, <span class="seriesInfo">RFC 6066</span>, <span class="seriesInfo">DOI 10.17487/RFC6066</span>, <time class="refDate" datetime="2011-01">January 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6066">https://www.rfc-editor.org/info/rfc6066</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9345">[TLS-SUBCERTS]</dt>
        <dd>
<span class="refAuthor">Barnes, R.</span>, <span class="refAuthor">Iyengar, S.</span>, <span class="refAuthor">Sullivan, N.</span>, and <span class="refAuthor">E. Rescorla</span>, <span class="refTitle">"Delegated Credentials for TLS and DTLS"</span>, <span class="seriesInfo">RFC 9345</span>, <span class="seriesInfo">DOI 10.17487/RFC9345</span>, <time class="refDate" datetime="2023-07">July 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9345">https://www.rfc-editor.org/info/rfc9345</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="URL">[URL]</dt>
        <dd>
<span class="refAuthor">van Kesteren, A.</span>, <span class="refTitle">"URL"</span>, <span class="refContent">WHATWG Living Standard</span>, <time class="refDate" datetime="2023-09">September 2023</time>, <span>&lt;<a href="https://url.spec.whatwg.org/">https://url.spec.whatwg.org/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="US-ASCII">[US-ASCII]</dt>
        <dd>
<span class="refAuthor">American National Standards Institute</span>, <span class="refTitle">"Coded Character Sets - 7-bit American Standard Code for Information Interchange (7-Bit ASCII)"</span>, <span class="seriesInfo">ANSI INCITS 4-1986 (R2007)</span>, <time class="refDate" datetime="2007-06">June 2007</time>. </dd>
<dd class="break"></dd>
<dt id="UTS-36">[UTS-36]</dt>
        <dd>
<span class="refAuthor">Davis, M.</span> and <span class="refAuthor">M. Suignard</span>, <span class="refTitle">"Unicode Security Considerations"</span>, <span class="refContent">Revision 15</span>, <span class="seriesInfo">Unicode Technical Report #36</span>, <time class="refDate" datetime="2014-09">September 2014</time>, <span>&lt;<a href="https://unicode.org/reports/tr36/">https://unicode.org/reports/tr36/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="UTS-39">[UTS-39]</dt>
        <dd>
<span class="refAuthor">Davis, M.</span> and <span class="refAuthor">M. Suignard</span>, <span class="refTitle">"Unicode Security Mechanisms"</span>, <span class="refContent">Version 15.1.0, Revision 28</span>, <span class="seriesInfo">Unicode Technical Standard #39</span>, <time class="refDate" datetime="2023-09">September 2023</time>, <span>&lt;<a href="https://unicode.org/reports/tr39/">https://unicode.org/reports/tr39/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6125">[VERIFY]</dt>
        <dd>
<span class="refAuthor">Saint-Andre, P.</span> and <span class="refAuthor">J. Hodges</span>, <span class="refTitle">"Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS)"</span>, <span class="seriesInfo">RFC 6125</span>, <span class="seriesInfo">DOI 10.17487/RFC6125</span>, <time class="refDate" datetime="2011-03">March 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6125">https://www.rfc-editor.org/info/rfc6125</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="WSC-UI">[WSC-UI]</dt>
        <dd>
<span class="refAuthor">Saldhana, A.</span> and <span class="refAuthor">T. Roessler</span>, <span class="refTitle">"Web Security Context: User Interface Guidelines"</span>, <span class="seriesInfo">W3C Recommendation REC-wsc-ui-20100812</span>, <time class="refDate" datetime="2010-08">August 2010</time>, <span>&lt;<a href="https://www.w3.org/TR/2010/REC-wsc-ui-20100812/">https://www.w3.org/TR/2010/REC-wsc-ui-20100812/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="X.509">[X.509]</dt>
        <dd>
<span class="refAuthor">ITU-T</span>, <span class="refTitle">"Information Technology - Open Systems Interconnection - The Directory: Public-key and attribute certificate frameworks"</span>, <span class="seriesInfo">ISO/IEC 9594-8</span>, <span class="seriesInfo">ITU-T Recommendation X.509</span>, <time class="refDate" datetime="2019-10">October 2019</time>. </dd>
<dd class="break"></dd>
<dt id="X.690">[X.690]</dt>
        <dd>
<span class="refAuthor">ITU-T</span>, <span class="refTitle">"Information Technology - ASN.1 encoding rules: Specification of Basic Encoding Rules (BER), Canonical Encoding Rules (CER) and Distinguished Encoding Rules (DER)"</span>, <span class="seriesInfo">ISO/IEC 8825-1:2021 (E)</span>, <span class="seriesInfo">ITU-T Recommendation X.690</span>, <time class="refDate" datetime="2021-02">February 2021</time>. </dd>
<dd class="break"></dd>
<dt id="RFC6120">[XMPP]</dt>
        <dd>
<span class="refAuthor">Saint-Andre, P.</span>, <span class="refTitle">"Extensible Messaging and Presence Protocol (XMPP): Core"</span>, <span class="seriesInfo">RFC 6120</span>, <span class="seriesInfo">DOI 10.17487/RFC6120</span>, <time class="refDate" datetime="2011-03">March 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6120">https://www.rfc-editor.org/info/rfc6120</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="XSS">[XSS]</dt>
      <dd>
<span class="refAuthor">Kirsten, S., et al.</span>, <span class="refTitle">"Cross Site Scripting (XSS)"</span>, <span class="refContent">OWASP Foundation</span>, <time class="refDate" datetime="2020">2020</time>, <span>&lt;<a href="https://owasp.org/www-community/attacks/xss/">https://owasp.org/www-community/attacks/xss/</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="changes">
<section id="appendix-A">
      <h2 id="name-changes-from-rfc-6125">
<a class="section-number selfRef" href="#appendix-A">Appendix A. </a><a class="section-name selfRef" href="#name-changes-from-rfc-6125">Changes from RFC 6125</a>
      </h2>
<p id="appendix-A-1">This document revises and obsoletes <span>[<a class="cite xref" href="#RFC6125">VERIFY</a>]</span> based
on the decade of experience and changes since it was published.
The major changes, in no particular order, include:<a class="pilcrow" href="#appendix-A-1">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-2.1">The only legal place for a certificate wildcard is as the complete left-most
label in a domain name.<a class="pilcrow" href="#appendix-A-2.1">¶</a>
</li>
        <li class="normal" id="appendix-A-2.2">The server identity can only be expressed in the subjectAltNames
extension; it is no longer valid to use the commonName RDN,
known as <code>CN-ID</code> in <span>[<a class="cite xref" href="#RFC6125">VERIFY</a>]</span>.<a class="pilcrow" href="#appendix-A-2.2">¶</a>
</li>
        <li class="normal" id="appendix-A-2.3">Detailed discussion of pinning (configuring use of a certificate that
doesn't match the criteria in this document) has been removed and replaced
with two paragraphs in <a class="auto internal xref" href="#outcome">Section 6.6</a>.<a class="pilcrow" href="#appendix-A-2.3">¶</a>
</li>
        <li class="normal" id="appendix-A-2.4">The sections detailing different target audiences and which sections
to read (first) have been removed.<a class="pilcrow" href="#appendix-A-2.4">¶</a>
</li>
        <li class="normal" id="appendix-A-2.5">References to the X.500 directory, the survey of prior art, and the
sample text in Appendix A have been removed.<a class="pilcrow" href="#appendix-A-2.5">¶</a>
</li>
        <li class="normal" id="appendix-A-2.6">All references have been updated to the latest versions.<a class="pilcrow" href="#appendix-A-2.6">¶</a>
</li>
        <li class="normal" id="appendix-A-2.7">The TLS SNI extension is no longer new; it is commonplace.<a class="pilcrow" href="#appendix-A-2.7">¶</a>
</li>
        <li class="normal" id="appendix-A-2.8">Additional text on multiple identifiers, and their security considerations,
has been added.<a class="pilcrow" href="#appendix-A-2.8">¶</a>
</li>
        <li class="normal" id="appendix-A-2.9">IP-ID reference identifiers have been added.  This builds on the definition in <span>[<a class="cite xref" href="#RFC9110">HTTP</a>], <a class="relref" href="https://rfc-editor.org/rfc/rfc9110#section-4.3.5">Section 4.3.5</a></span>.<a class="pilcrow" href="#appendix-A-2.9">¶</a>
</li>
        <li class="normal" id="appendix-A-2.10">The document title has been shortened because the previous title was difficult to cite.<a class="pilcrow" href="#appendix-A-2.10">¶</a>
</li>
      </ul>
</section>
</div>
<div id="acknowledgements">
<section id="appendix-B">
      <h2 id="name-acknowledgements">
<a class="section-name selfRef" href="#name-acknowledgements">Acknowledgements</a>
      </h2>
<p id="appendix-B-1">We gratefully acknowledge everyone who contributed to the previous
version of this specification <span>[<a class="cite xref" href="#RFC6125">VERIFY</a>]</span>.
Thanks also to <span class="contact-name">Carsten Bormann</span> for converting the previous version of this specification to Markdown so that we could more easily use <span class="contact-name">Martin Thomson's</span> <code>i-d-template</code>
software.<a class="pilcrow" href="#appendix-B-1">¶</a></p>
<p id="appendix-B-2">In addition to discussions within the UTA Working Group, the following people
provided official reviews or especially significant feedback:
<span class="contact-name">Corey Bonnell</span>,
<span class="contact-name">Roman Danyliw</span>,
<span class="contact-name">Viktor Dukhovni</span>,
<span class="contact-name">Lars Eggert</span>,
<span class="contact-name">Patrik Fältström</span>,
<span class="contact-name">Jim Fenton</span>,
<span class="contact-name">Olle Johansson</span>,
<span class="contact-name">John Klensin</span>,
<span class="contact-name">Murray Kucherawy</span>,
<span class="contact-name">Warren Kumari</span>,
<span class="contact-name">John Mattson</span>,
<span class="contact-name">Alexey Melnikov</span>,
<span class="contact-name">Derrell Piper</span>,
<span class="contact-name">Maria Ines Robles</span>,
<span class="contact-name">Rob Sayre</span>,
<span class="contact-name">Yaron Sheffer</span>,
<span class="contact-name">Ryan Sleevi</span>,
<span class="contact-name">Brian Smith</span>,
<span class="contact-name">Petr Špaček</span>,
<span class="contact-name">Orie Steele</span>,
<span class="contact-name">Martin Thomson</span>,
<span class="contact-name">Joe Touch</span>,
<span class="contact-name">Éric Vyncke</span>,
<span class="contact-name">Paul Wouters</span>,
and
<span class="contact-name">Qin Wu</span>.<a class="pilcrow" href="#appendix-B-2">¶</a></p>
<p id="appendix-B-3">A few descriptive sentences were borrowed from <span>[<a class="cite xref" href="#RFC9325">TLS-REC</a>]</span>.<a class="pilcrow" href="#appendix-B-3">¶</a></p>
</section>
</div>
<div id="contributors">
<section id="appendix-C">
      <h2 id="name-contributors">
<a class="section-name selfRef" href="#name-contributors">Contributors</a>
      </h2>
<p id="appendix-C-1"><span class="contact-name">Jeff Hodges</span> coauthored the previous version of this specification <span>[<a class="cite xref" href="#RFC6125">VERIFY</a>]</span>.
The authors gratefully acknowledge his essential contributions to this work.<a class="pilcrow" href="#appendix-C-1">¶</a></p>
<p id="appendix-C-2"><span class="contact-name">Martin Thomson</span> contributed the text on the handling of IP-IDs.<a class="pilcrow" href="#appendix-C-2">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-D">
      <h2 id="name-authors-addresses">
<a class="section-name selfRef" href="#name-authors-addresses">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Peter Saint-Andre</span></div>
<div class="left" dir="auto"><span class="org">Independent</span></div>
<div class="left" dir="auto"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:stpeter@stpeter.im">stpeter@stpeter.im</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Rich Salz</span></div>
<div class="left" dir="auto"><span class="org">Akamai Technologies</span></div>
<div class="left" dir="auto"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:rsalz@akamai.com">rsalz@akamai.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>