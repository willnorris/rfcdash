<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 9260: Stream Control Transmission Protocol</title>
<meta content="Randall R. Stewart" name="author"/>
<meta content="Michael TÃ¼xen" name="author"/>
<meta content="Karen E. E. Nielsen" name="author"/>
<meta content="
       This document describes the Stream Control Transmission Protocol (SCTP) and obsoletes RFC 4960.  It incorporates the specification of the chunk flags registry from RFC 6096 and the
specification of the I bit of DATA chunks from RFC 7053.
Therefore, RFCs 6096 and 7053 are also obsoleted by this document.
In addition, RFCs 4460 and 8540, which describe errata for SCTP, are obsoleted by this document.
 
       SCTP was originally designed to transport Public Switched Telephone
Network (PSTN) signaling messages over IP networks.
It is also suited to be used for other applications, for example, WebRTC. 
       SCTP is a reliable transport protocol operating on top of a
connectionless packet network, such as IP.
It offers the following services to its users: 
       
         
           acknowledged error-free, non-duplicated transfer of user data, 
         
         
           data fragmentation to conform to discovered Path Maximum Transmission Unit (PMTU) size, 
         
         
           sequenced delivery of user messages within multiple streams, with
an option for order-of-arrival delivery of individual user messages, 
         
         
           optional bundling of multiple user messages into a single SCTP packet, and 
         
         
           network-level fault tolerance through supporting of multi-homing
at either or both ends of an association. 
         
       
       The design of SCTP includes appropriate congestion avoidance behavior
and resistance to flooding and masquerade attacks. 
    " name="description"/>
<meta content="xml2rfc 3.12.10" name="generator"/>
<meta content="9260" name="rfc.number"/>
<!-- Generator version information:
  xml2rfc 3.12.10
    Python 3.6.15
    appdirs 1.4.4
    ConfigArgParse 1.4.1
    google-i18n-address 2.4.0
    html5lib 1.0.1
    intervaltree 3.0.2
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.7.1
    MarkupSafe 2.0.1
    pycairo 1.15.1
    pycountry 19.8.18
    pyflakes 2.1.1
    PyYAML 5.4.1
    requests 2.24.0
    setuptools 40.5.0
    six 1.14.0
    WeasyPrint 52.5
-->
<link href="rfc9260.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  pre.breakable {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://dx.doi.org/10.17487/rfc9260" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <link href="https://datatracker.ietf.org/doc/draft-ietf-tsvwg-rfc4960-bis-19" rel="prev"/>
  </head>
<body>
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9260</td>
<td class="center">Stream Control Transmission Protocol</td>
<td class="right">June 2022</td>
</tr></thead>
<tfoot><tr>
<td class="left">Stewart, et al.</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc9260">9260</a></dd>
<dt class="label-obsoletes">Obsoletes:</dt>
<dd class="obsoletes">
<a class="eref" href="https://www.rfc-editor.org/rfc/rfc4460">4460</a>, <a class="eref" href="https://www.rfc-editor.org/rfc/rfc4960">4960</a>, <a class="eref" href="https://www.rfc-editor.org/rfc/rfc6096">6096</a>, <a class="eref" href="https://www.rfc-editor.org/rfc/rfc7053">7053</a>, <a class="eref" href="https://www.rfc-editor.org/rfc/rfc8540">8540</a> </dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2022-06">June 2022</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">R. Stewart</div>
<div class="org">Netflix, Inc.</div>
</div>
<div class="author">
      <div class="author-name">M. TÃ¼xen</div>
<div class="org">MÃ¼nster Univ. of Appl. Sciences</div>
</div>
<div class="author">
      <div class="author-name">K. Nielsen</div>
<div class="org">Kamstrup A/S</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9260</h1>
<h1 id="title">Stream Control Transmission Protocol</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">This document describes the Stream Control Transmission Protocol (SCTP) and obsoletes RFC 4960.  It incorporates the specification of the chunk flags registry from RFC 6096 and the
specification of the I bit of DATA chunks from RFC 7053.
Therefore, RFCs 6096 and 7053 are also obsoleted by this document.
In addition, RFCs 4460 and 8540, which describe errata for SCTP, are obsoleted by this document.<a class="pilcrow" href="#section-abstract-1">Â¶</a></p>
<p id="section-abstract-2">SCTP was originally designed to transport Public Switched Telephone
Network (PSTN) signaling messages over IP networks.
It is also suited to be used for other applications, for example, WebRTC.<a class="pilcrow" href="#section-abstract-2">Â¶</a></p>
<p id="section-abstract-3">SCTP is a reliable transport protocol operating on top of a
connectionless packet network, such as IP.
It offers the following services to its users:<a class="pilcrow" href="#section-abstract-3">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-abstract-4.1">
          <p id="section-abstract-4.1.1">acknowledged error-free, non-duplicated transfer of user data,<a class="pilcrow" href="#section-abstract-4.1.1">Â¶</a></p>
</li>
        <li class="normal" id="section-abstract-4.2">
          <p id="section-abstract-4.2.1">data fragmentation to conform to discovered Path Maximum Transmission Unit (PMTU) size,<a class="pilcrow" href="#section-abstract-4.2.1">Â¶</a></p>
</li>
        <li class="normal" id="section-abstract-4.3">
          <p id="section-abstract-4.3.1">sequenced delivery of user messages within multiple streams, with
an option for order-of-arrival delivery of individual user messages,<a class="pilcrow" href="#section-abstract-4.3.1">Â¶</a></p>
</li>
        <li class="normal" id="section-abstract-4.4">
          <p id="section-abstract-4.4.1">optional bundling of multiple user messages into a single SCTP packet, and<a class="pilcrow" href="#section-abstract-4.4.1">Â¶</a></p>
</li>
        <li class="normal" id="section-abstract-4.5">
          <p id="section-abstract-4.5.1">network-level fault tolerance through supporting of multi-homing
at either or both ends of an association.<a class="pilcrow" href="#section-abstract-4.5.1">Â¶</a></p>
</li>
      </ul>
<p id="section-abstract-5">The design of SCTP includes appropriate congestion avoidance behavior
and resistance to flooding and masquerade attacks.<a class="pilcrow" href="#section-abstract-5">Â¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a class="pilcrow" href="#section-boilerplate.1-1">Â¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">Â¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9260">https://www.rfc-editor.org/info/rfc9260</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">Â¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">Â¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">Â¶</a></p>
<p id="section-boilerplate.2-3">
            This document may contain material from IETF Documents or IETF
            Contributions published or made publicly available before November
            10, 2008. The person(s) controlling the copyright in some of this
            material may not have granted the IETF Trust the right to allow
            modifications of such material outside the IETF Standards Process.
            Without obtaining an adequate license from the person(s)
            controlling the copyright in such materials, this document may not
            be modified outside the IETF Standards Process, and derivative
            works of it may not be created outside the IETF Standards Process,
            except to format it for publication as an RFC or to translate it
            into languages other than English.<a class="pilcrow" href="#section-boilerplate.2-3">Â¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">â²</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a class="xref" href="#section-1">1</a>.Â Â <a class="xref" href="#name-introduction">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p class="keepWithNext" id="section-toc.1-1.1.2.1.1"><a class="xref" href="#section-1.1">1.1</a>.Â Â <a class="xref" href="#name-motivation">Motivation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p class="keepWithNext" id="section-toc.1-1.1.2.2.1"><a class="xref" href="#section-1.2">1.2</a>.Â Â <a class="xref" href="#name-architectural-view-of-sctp">Architectural View of SCTP</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3">
                <p class="keepWithNext" id="section-toc.1-1.1.2.3.1"><a class="xref" href="#section-1.3">1.3</a>.Â Â <a class="xref" href="#name-key-terms">Key Terms</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.4">
                <p id="section-toc.1-1.1.2.4.1"><a class="xref" href="#section-1.4">1.4</a>.Â Â <a class="xref" href="#name-abbreviations">Abbreviations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.5">
                <p id="section-toc.1-1.1.2.5.1"><a class="xref" href="#section-1.5">1.5</a>.Â Â <a class="xref" href="#name-functional-view-of-sctp">Functional View of SCTP</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.5.2.1">
                    <p id="section-toc.1-1.1.2.5.2.1.1"><a class="xref" href="#section-1.5.1">1.5.1</a>.Â Â <a class="xref" href="#name-association-startup-and-tak">Association Startup and Takedown</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.5.2.2">
                    <p id="section-toc.1-1.1.2.5.2.2.1"><a class="xref" href="#section-1.5.2">1.5.2</a>.Â Â <a class="xref" href="#name-sequenced-delivery-within-s">Sequenced Delivery within Streams</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.5.2.3">
                    <p id="section-toc.1-1.1.2.5.2.3.1"><a class="xref" href="#section-1.5.3">1.5.3</a>.Â Â <a class="xref" href="#name-user-data-fragmentation">User Data Fragmentation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.5.2.4">
                    <p id="section-toc.1-1.1.2.5.2.4.1"><a class="xref" href="#section-1.5.4">1.5.4</a>.Â Â <a class="xref" href="#name-acknowledgement-and-congest">Acknowledgement and Congestion Avoidance</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.5.2.5">
                    <p id="section-toc.1-1.1.2.5.2.5.1"><a class="xref" href="#section-1.5.5">1.5.5</a>.Â Â <a class="xref" href="#name-chunk-bundling">Chunk Bundling</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.5.2.6">
                    <p id="section-toc.1-1.1.2.5.2.6.1"><a class="xref" href="#section-1.5.6">1.5.6</a>.Â Â <a class="xref" href="#name-packet-validation">Packet Validation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.5.2.7">
                    <p id="section-toc.1-1.1.2.5.2.7.1"><a class="xref" href="#section-1.5.7">1.5.7</a>.Â Â <a class="xref" href="#name-path-management">Path Management</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.6">
                <p id="section-toc.1-1.1.2.6.1"><a class="xref" href="#section-1.6">1.6</a>.Â Â <a class="xref" href="#name-serial-number-arithmetic">Serial Number Arithmetic</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.7">
                <p id="section-toc.1-1.1.2.7.1"><a class="xref" href="#section-1.7">1.7</a>.Â Â <a class="xref" href="#name-changes-from-rfc-4960">Changes from RFC 4960</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a class="xref" href="#section-2">2</a>.Â Â <a class="xref" href="#name-conventions">Conventions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a class="xref" href="#section-3">3</a>.Â Â <a class="xref" href="#name-sctp-packet-format">SCTP Packet Format</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a class="xref" href="#section-3.1">3.1</a>.Â Â <a class="xref" href="#name-sctp-common-header-field-de">SCTP Common Header Field Descriptions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a class="xref" href="#section-3.2">3.2</a>.Â Â <a class="xref" href="#name-chunk-field-descriptions">Chunk Field Descriptions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a class="xref" href="#section-3.2.1">3.2.1</a>.Â Â <a class="xref" href="#name-optional-variable-length-pa">Optional/Variable-Length Parameter Format</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.2">
                    <p id="section-toc.1-1.3.2.2.2.2.1"><a class="xref" href="#section-3.2.2">3.2.2</a>.Â Â <a class="xref" href="#name-reporting-of-unrecognized-p">Reporting of Unrecognized Parameters</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a class="xref" href="#section-3.3">3.3</a>.Â Â <a class="xref" href="#name-sctp-chunk-definitions">SCTP Chunk Definitions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.1">
                    <p id="section-toc.1-1.3.2.3.2.1.1"><a class="xref" href="#section-3.3.1">3.3.1</a>.Â Â <a class="xref" href="#name-payload-data-data-0">Payload Data (DATA) (0)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.2">
                    <p id="section-toc.1-1.3.2.3.2.2.1"><a class="xref" href="#section-3.3.2">3.3.2</a>.Â Â <a class="xref" href="#name-initiation-init-1">Initiation (INIT) (1)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.2.2.1">
                        <p id="section-toc.1-1.3.2.3.2.2.2.1.1"><a class="xref" href="#section-3.3.2.1">3.3.2.1</a>.Â Â <a class="xref" href="#name-optional-or-variable-length">Optional or Variable-Length Parameters in INIT chunks</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.3">
                    <p id="section-toc.1-1.3.2.3.2.3.1"><a class="xref" href="#section-3.3.3">3.3.3</a>.Â Â <a class="xref" href="#name-initiation-acknowledgement-">Initiation Acknowledgement (INIT ACK) (2)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.3.2.1">
                        <p id="section-toc.1-1.3.2.3.2.3.2.1.1"><a class="xref" href="#section-3.3.3.1">3.3.3.1</a>.Â Â <a class="xref" href="#name-optional-or-variable-length-">Optional or Variable-Length Parameters in INIT ACK Chunks</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.4">
                    <p id="section-toc.1-1.3.2.3.2.4.1"><a class="xref" href="#section-3.3.4">3.3.4</a>.Â Â <a class="xref" href="#name-selective-acknowledgement-s">Selective Acknowledgement (SACK) (3)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.5">
                    <p id="section-toc.1-1.3.2.3.2.5.1"><a class="xref" href="#section-3.3.5">3.3.5</a>.Â Â <a class="xref" href="#name-heartbeat-request-heartbeat">Heartbeat Request (HEARTBEAT) (4)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.6">
                    <p id="section-toc.1-1.3.2.3.2.6.1"><a class="xref" href="#section-3.3.6">3.3.6</a>.Â Â <a class="xref" href="#name-heartbeat-acknowledgement-h">Heartbeat Acknowledgement (HEARTBEAT ACK) (5)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.7">
                    <p id="section-toc.1-1.3.2.3.2.7.1"><a class="xref" href="#section-3.3.7">3.3.7</a>.Â Â <a class="xref" href="#name-abort-association-abort-6">Abort Association (ABORT) (6)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.8">
                    <p id="section-toc.1-1.3.2.3.2.8.1"><a class="xref" href="#section-3.3.8">3.3.8</a>.Â Â <a class="xref" href="#name-shutdown-association-shutdo">Shutdown Association (SHUTDOWN) (7)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.9">
                    <p id="section-toc.1-1.3.2.3.2.9.1"><a class="xref" href="#section-3.3.9">3.3.9</a>.Â Â <a class="xref" href="#name-shutdown-acknowledgement-sh">Shutdown Acknowledgement (SHUTDOWN ACK) (8)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.10">
                    <p id="section-toc.1-1.3.2.3.2.10.1"><a class="xref" href="#section-3.3.10">3.3.10</a>.Â <a class="xref" href="#name-operation-error-error-9">Operation Error (ERROR) (9)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.10.2.1">
                        <p id="section-toc.1-1.3.2.3.2.10.2.1.1"><a class="xref" href="#section-3.3.10.1">3.3.10.1</a>.Â Â <a class="xref" href="#name-invalid-stream-identifier-1">Invalid Stream Identifier (1)</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.10.2.2">
                        <p id="section-toc.1-1.3.2.3.2.10.2.2.1"><a class="xref" href="#section-3.3.10.2">3.3.10.2</a>.Â Â <a class="xref" href="#name-missing-mandatory-parameter">Missing Mandatory Parameter (2)</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.10.2.3">
                        <p id="section-toc.1-1.3.2.3.2.10.2.3.1"><a class="xref" href="#section-3.3.10.3">3.3.10.3</a>.Â Â <a class="xref" href="#name-stale-cookie-3">Stale Cookie (3)</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.10.2.4">
                        <p id="section-toc.1-1.3.2.3.2.10.2.4.1"><a class="xref" href="#section-3.3.10.4">3.3.10.4</a>.Â Â <a class="xref" href="#name-out-of-resource-4">Out of Resource (4)</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.10.2.5">
                        <p id="section-toc.1-1.3.2.3.2.10.2.5.1"><a class="xref" href="#section-3.3.10.5">3.3.10.5</a>.Â Â <a class="xref" href="#name-unresolvable-address-5">Unresolvable Address (5)</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.10.2.6">
                        <p id="section-toc.1-1.3.2.3.2.10.2.6.1"><a class="xref" href="#section-3.3.10.6">3.3.10.6</a>.Â Â <a class="xref" href="#name-unrecognized-chunk-type-6">Unrecognized Chunk Type (6)</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.10.2.7">
                        <p id="section-toc.1-1.3.2.3.2.10.2.7.1"><a class="xref" href="#section-3.3.10.7">3.3.10.7</a>.Â Â <a class="xref" href="#name-invalid-mandatory-parameter">Invalid Mandatory Parameter (7)</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.10.2.8">
                        <p id="section-toc.1-1.3.2.3.2.10.2.8.1"><a class="xref" href="#section-3.3.10.8">3.3.10.8</a>.Â Â <a class="xref" href="#name-unrecognized-parameters-8">Unrecognized Parameters (8)</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.10.2.9">
                        <p id="section-toc.1-1.3.2.3.2.10.2.9.1"><a class="xref" href="#section-3.3.10.9">3.3.10.9</a>.Â Â <a class="xref" href="#name-no-user-data-9">No User Data (9)</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.10.2.10">
                        <p id="section-toc.1-1.3.2.3.2.10.2.10.1"><a class="xref" href="#section-3.3.10.10">3.3.10.10</a>.Â <a class="xref" href="#name-cookie-received-while-shutt">Cookie Received While Shutting Down (10)</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.10.2.11">
                        <p id="section-toc.1-1.3.2.3.2.10.2.11.1"><a class="xref" href="#section-3.3.10.11">3.3.10.11</a>.Â <a class="xref" href="#name-restart-of-an-association-w">Restart of an Association with New Addresses (11)</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.10.2.12">
                        <p id="section-toc.1-1.3.2.3.2.10.2.12.1"><a class="xref" href="#section-3.3.10.12">3.3.10.12</a>.Â <a class="xref" href="#name-user-initiated-abort-12">User-Initiated Abort (12)</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.10.2.13">
                        <p id="section-toc.1-1.3.2.3.2.10.2.13.1"><a class="xref" href="#section-3.3.10.13">3.3.10.13</a>.Â <a class="xref" href="#name-protocol-violation-13">Protocol Violation (13)</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.11">
                    <p id="section-toc.1-1.3.2.3.2.11.1"><a class="xref" href="#section-3.3.11">3.3.11</a>.Â <a class="xref" href="#name-cookie-echo-cookie-echo-10">Cookie Echo (COOKIE ECHO) (10)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.12">
                    <p id="section-toc.1-1.3.2.3.2.12.1"><a class="xref" href="#section-3.3.12">3.3.12</a>.Â <a class="xref" href="#name-cookie-acknowledgement-cook">Cookie Acknowledgement (COOKIE ACK) (11)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.13">
                    <p id="section-toc.1-1.3.2.3.2.13.1"><a class="xref" href="#section-3.3.13">3.3.13</a>.Â <a class="xref" href="#name-shutdown-complete-shutdown-">Shutdown Complete (SHUTDOWN COMPLETE) (14)</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="xref" href="#section-4">4</a>.Â Â <a class="xref" href="#name-sctp-association-state-diag">SCTP Association State Diagram</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="xref" href="#section-5">5</a>.Â Â <a class="xref" href="#name-association-initialization">Association Initialization</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a class="xref" href="#section-5.1">5.1</a>.Â Â <a class="xref" href="#name-normal-establishment-of-an-">Normal Establishment of an Association</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.1">
                    <p id="section-toc.1-1.5.2.1.2.1.1"><a class="xref" href="#section-5.1.1">5.1.1</a>.Â Â <a class="xref" href="#name-handle-stream-parameters">Handle Stream Parameters</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.2">
                    <p id="section-toc.1-1.5.2.1.2.2.1"><a class="xref" href="#section-5.1.2">5.1.2</a>.Â Â <a class="xref" href="#name-handle-address-parameters">Handle Address Parameters</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.3">
                    <p id="section-toc.1-1.5.2.1.2.3.1"><a class="xref" href="#section-5.1.3">5.1.3</a>.Â Â <a class="xref" href="#name-generating-state-cookie">Generating State Cookie</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.4">
                    <p id="section-toc.1-1.5.2.1.2.4.1"><a class="xref" href="#section-5.1.4">5.1.4</a>.Â Â <a class="xref" href="#name-state-cookie-processing">State Cookie Processing</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.5">
                    <p id="section-toc.1-1.5.2.1.2.5.1"><a class="xref" href="#section-5.1.5">5.1.5</a>.Â Â <a class="xref" href="#name-state-cookie-authentication">State Cookie Authentication</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.6">
                    <p id="section-toc.1-1.5.2.1.2.6.1"><a class="xref" href="#section-5.1.6">5.1.6</a>.Â Â <a class="xref" href="#name-an-example-of-normal-associ">An Example of Normal Association Establishment</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a class="xref" href="#section-5.2">5.2</a>.Â Â <a class="xref" href="#name-handle-duplicate-or-unexpec">Handle Duplicate or Unexpected INIT, INIT ACK, COOKIE ECHO, and COOKIE ACK Chunks</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1">
                    <p id="section-toc.1-1.5.2.2.2.1.1"><a class="xref" href="#section-5.2.1">5.2.1</a>.Â Â <a class="xref" href="#name-init-chunk-received-in-cook">INIT Chunk Received in COOKIE-WAIT or COOKIE-ECHOED State (Item B)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.2">
                    <p id="section-toc.1-1.5.2.2.2.2.1"><a class="xref" href="#section-5.2.2">5.2.2</a>.Â Â <a class="xref" href="#name-unexpected-init-chunk-in-st">Unexpected INIT Chunk in States Other than CLOSED, COOKIE-ECHOED, COOKIE-WAIT, and SHUTDOWN-ACK-SENT</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3">
                    <p id="section-toc.1-1.5.2.2.2.3.1"><a class="xref" href="#section-5.2.3">5.2.3</a>.Â Â <a class="xref" href="#name-unexpected-init-ack-chunk">Unexpected INIT ACK Chunk</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.4">
                    <p id="section-toc.1-1.5.2.2.2.4.1"><a class="xref" href="#section-5.2.4">5.2.4</a>.Â Â <a class="xref" href="#name-handle-a-cookie-echo-chunk-">Handle a COOKIE ECHO Chunk When a TCB Exists</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.4.2.1">
                        <p id="section-toc.1-1.5.2.2.2.4.2.1.1"><a class="xref" href="#section-5.2.4.1">5.2.4.1</a>.Â Â <a class="xref" href="#name-an-example-of-an-associatio">An Example of an Association Restart</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.5">
                    <p id="section-toc.1-1.5.2.2.2.5.1"><a class="xref" href="#section-5.2.5">5.2.5</a>.Â Â <a class="xref" href="#name-handle-duplicate-cookie-ack">Handle Duplicate COOKIE ACK Chunk</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.6">
                    <p id="section-toc.1-1.5.2.2.2.6.1"><a class="xref" href="#section-5.2.6">5.2.6</a>.Â Â <a class="xref" href="#name-handle-stale-cookie-error">Handle Stale Cookie Error</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a class="xref" href="#section-5.3">5.3</a>.Â Â <a class="xref" href="#name-other-initialization-issues">Other Initialization Issues</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.1">
                    <p id="section-toc.1-1.5.2.3.2.1.1"><a class="xref" href="#section-5.3.1">5.3.1</a>.Â Â <a class="xref" href="#name-selection-of-tag-value">Selection of Tag Value</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a class="xref" href="#section-5.4">5.4</a>.Â Â <a class="xref" href="#name-path-verification">Path Verification</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="xref" href="#section-6">6</a>.Â Â <a class="xref" href="#name-user-data-transfer">User Data Transfer</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a class="xref" href="#section-6.1">6.1</a>.Â Â <a class="xref" href="#name-transmission-of-data-chunks">Transmission of DATA Chunks</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a class="xref" href="#section-6.2">6.2</a>.Â Â <a class="xref" href="#name-acknowledgement-on-receptio">Acknowledgement on Reception of DATA Chunks</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.1">
                    <p id="section-toc.1-1.6.2.2.2.1.1"><a class="xref" href="#section-6.2.1">6.2.1</a>.Â Â <a class="xref" href="#name-processing-a-received-sack-">Processing a Received SACK Chunk</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a class="xref" href="#section-6.3">6.3</a>.Â Â <a class="xref" href="#name-management-of-retransmissio">Management of Retransmission Timer</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3.2.1">
                    <p id="section-toc.1-1.6.2.3.2.1.1"><a class="xref" href="#section-6.3.1">6.3.1</a>.Â Â <a class="xref" href="#name-rto-calculation">RTO Calculation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3.2.2">
                    <p id="section-toc.1-1.6.2.3.2.2.1"><a class="xref" href="#section-6.3.2">6.3.2</a>.Â Â <a class="xref" href="#name-retransmission-timer-rules">Retransmission Timer Rules</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3.2.3">
                    <p id="section-toc.1-1.6.2.3.2.3.1"><a class="xref" href="#section-6.3.3">6.3.3</a>.Â Â <a class="xref" href="#name-handle-t3-rtx-expiration">Handle T3-rtx Expiration</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a class="xref" href="#section-6.4">6.4</a>.Â Â <a class="xref" href="#name-multi-homed-sctp-endpoints">Multi-Homed SCTP Endpoints</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4.2.1">
                    <p id="section-toc.1-1.6.2.4.2.1.1"><a class="xref" href="#section-6.4.1">6.4.1</a>.Â Â <a class="xref" href="#name-failover-from-an-inactive-d">Failover from an Inactive Destination Address</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5">
                <p id="section-toc.1-1.6.2.5.1"><a class="xref" href="#section-6.5">6.5</a>.Â Â <a class="xref" href="#name-stream-identifier-and-strea">Stream Identifier and Stream Sequence Number</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.6">
                <p id="section-toc.1-1.6.2.6.1"><a class="xref" href="#section-6.6">6.6</a>.Â Â <a class="xref" href="#name-ordered-and-unordered-deliv">Ordered and Unordered Delivery</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.7">
                <p id="section-toc.1-1.6.2.7.1"><a class="xref" href="#section-6.7">6.7</a>.Â Â <a class="xref" href="#name-report-gaps-in-received-dat">Report Gaps in Received DATA TSNs</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.8">
                <p id="section-toc.1-1.6.2.8.1"><a class="xref" href="#section-6.8">6.8</a>.Â Â <a class="xref" href="#name-crc32c-checksum-calculation">CRC32c Checksum Calculation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.9">
                <p id="section-toc.1-1.6.2.9.1"><a class="xref" href="#section-6.9">6.9</a>.Â Â <a class="xref" href="#name-fragmentation-and-reassembl">Fragmentation and Reassembly</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.10">
                <p id="section-toc.1-1.6.2.10.1"><a class="xref" href="#section-6.10">6.10</a>.Â <a class="xref" href="#name-bundling">Bundling</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="xref" href="#section-7">7</a>.Â Â <a class="xref" href="#name-congestion-control">Congestion Control</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a class="xref" href="#section-7.1">7.1</a>.Â Â <a class="xref" href="#name-sctp-differences-from-tcp-c">SCTP Differences from TCP Congestion Control</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a class="xref" href="#section-7.2">7.2</a>.Â Â <a class="xref" href="#name-sctp-slow-start-and-congest">SCTP Slow-Start and Congestion Avoidance</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.1">
                    <p id="section-toc.1-1.7.2.2.2.1.1"><a class="xref" href="#section-7.2.1">7.2.1</a>.Â Â <a class="xref" href="#name-slow-start">Slow-Start</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.2">
                    <p id="section-toc.1-1.7.2.2.2.2.1"><a class="xref" href="#section-7.2.2">7.2.2</a>.Â Â <a class="xref" href="#name-congestion-avoidance">Congestion Avoidance</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.3">
                    <p id="section-toc.1-1.7.2.2.2.3.1"><a class="xref" href="#section-7.2.3">7.2.3</a>.Â Â <a class="xref" href="#name-congestion-control-2">Congestion Control</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.4">
                    <p id="section-toc.1-1.7.2.2.2.4.1"><a class="xref" href="#section-7.2.4">7.2.4</a>.Â Â <a class="xref" href="#name-fast-retransmit-on-gap-repo">Fast Retransmit on Gap Reports</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.5">
                    <p id="section-toc.1-1.7.2.2.2.5.1"><a class="xref" href="#section-7.2.5">7.2.5</a>.Â Â <a class="xref" href="#name-reinitialization">Reinitialization</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.5.2.1">
                        <p id="section-toc.1-1.7.2.2.2.5.2.1.1"><a class="xref" href="#section-7.2.5.1">7.2.5.1</a>.Â Â <a class="xref" href="#name-change-of-differentiated-se">Change of Differentiated Services Code Points</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.5.2.2">
                        <p id="section-toc.1-1.7.2.2.2.5.2.2.1"><a class="xref" href="#section-7.2.5.2">7.2.5.2</a>.Â Â <a class="xref" href="#name-change-of-routes">Change of Routes</a></p>
</li>
                    </ul>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a class="xref" href="#section-7.3">7.3</a>.Â Â <a class="xref" href="#name-pmtu-discovery">PMTU Discovery</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="xref" href="#section-8">8</a>.Â Â <a class="xref" href="#name-fault-management">Fault Management</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a class="xref" href="#section-8.1">8.1</a>.Â Â <a class="xref" href="#name-endpoint-failure-detection">Endpoint Failure Detection</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a class="xref" href="#section-8.2">8.2</a>.Â Â <a class="xref" href="#name-path-failure-detection">Path Failure Detection</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a class="xref" href="#section-8.3">8.3</a>.Â Â <a class="xref" href="#name-path-heartbeat">Path Heartbeat</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4">
                <p id="section-toc.1-1.8.2.4.1"><a class="xref" href="#section-8.4">8.4</a>.Â Â <a class="xref" href="#name-handle-out-of-the-blue-pack">Handle "Out of the Blue" Packets</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.5">
                <p id="section-toc.1-1.8.2.5.1"><a class="xref" href="#section-8.5">8.5</a>.Â Â <a class="xref" href="#name-verification-tag">Verification Tag</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.5.2.1">
                    <p id="section-toc.1-1.8.2.5.2.1.1"><a class="xref" href="#section-8.5.1">8.5.1</a>.Â Â <a class="xref" href="#name-exceptions-in-verification-">Exceptions in Verification Tag Rules</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="xref" href="#section-9">9</a>.Â Â <a class="xref" href="#name-termination-of-association">Termination of Association</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a class="xref" href="#section-9.1">9.1</a>.Â Â <a class="xref" href="#name-abort-of-an-association">Abort of an Association</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a class="xref" href="#section-9.2">9.2</a>.Â Â <a class="xref" href="#name-shutdown-of-an-association">Shutdown of an Association</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a class="xref" href="#section-10">10</a>.Â <a class="xref" href="#name-icmp-handling">ICMP Handling</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a class="xref" href="#section-11">11</a>.Â <a class="xref" href="#name-interface-with-upper-layer">Interface with Upper Layer</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a class="xref" href="#section-11.1">11.1</a>.Â Â <a class="xref" href="#name-ulp-to-sctp">ULP-to-SCTP</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1.2.1">
                    <p id="section-toc.1-1.11.2.1.2.1.1"><a class="xref" href="#section-11.1.1">11.1.1</a>.Â Â <a class="xref" href="#name-initialize">Initialize</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1.2.2">
                    <p id="section-toc.1-1.11.2.1.2.2.1"><a class="xref" href="#section-11.1.2">11.1.2</a>.Â Â <a class="xref" href="#name-associate">Associate</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1.2.3">
                    <p id="section-toc.1-1.11.2.1.2.3.1"><a class="xref" href="#section-11.1.3">11.1.3</a>.Â Â <a class="xref" href="#name-shutdown">Shutdown</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1.2.4">
                    <p id="section-toc.1-1.11.2.1.2.4.1"><a class="xref" href="#section-11.1.4">11.1.4</a>.Â Â <a class="xref" href="#name-abort">Abort</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1.2.5">
                    <p id="section-toc.1-1.11.2.1.2.5.1"><a class="xref" href="#section-11.1.5">11.1.5</a>.Â Â <a class="xref" href="#name-send">Send</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1.2.6">
                    <p id="section-toc.1-1.11.2.1.2.6.1"><a class="xref" href="#section-11.1.6">11.1.6</a>.Â Â <a class="xref" href="#name-set-primary">Set Primary</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1.2.7">
                    <p id="section-toc.1-1.11.2.1.2.7.1"><a class="xref" href="#section-11.1.7">11.1.7</a>.Â Â <a class="xref" href="#name-receive">Receive</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1.2.8">
                    <p id="section-toc.1-1.11.2.1.2.8.1"><a class="xref" href="#section-11.1.8">11.1.8</a>.Â Â <a class="xref" href="#name-status">Status</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1.2.9">
                    <p id="section-toc.1-1.11.2.1.2.9.1"><a class="xref" href="#section-11.1.9">11.1.9</a>.Â Â <a class="xref" href="#name-change-heartbeat">Change Heartbeat</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1.2.10">
                    <p id="section-toc.1-1.11.2.1.2.10.1"><a class="xref" href="#section-11.1.10">11.1.10</a>.Â <a class="xref" href="#name-request-heartbeat">Request Heartbeat</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1.2.11">
                    <p id="section-toc.1-1.11.2.1.2.11.1"><a class="xref" href="#section-11.1.11">11.1.11</a>.Â <a class="xref" href="#name-get-srtt-report">Get SRTT Report</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1.2.12">
                    <p id="section-toc.1-1.11.2.1.2.12.1"><a class="xref" href="#section-11.1.12">11.1.12</a>.Â <a class="xref" href="#name-set-failure-threshold">Set Failure Threshold</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1.2.13">
                    <p id="section-toc.1-1.11.2.1.2.13.1"><a class="xref" href="#section-11.1.13">11.1.13</a>.Â <a class="xref" href="#name-set-protocol-parameters">Set Protocol Parameters</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1.2.14">
                    <p id="section-toc.1-1.11.2.1.2.14.1"><a class="xref" href="#section-11.1.14">11.1.14</a>.Â <a class="xref" href="#name-receive-unsent-message">Receive Unsent Message</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1.2.15">
                    <p id="section-toc.1-1.11.2.1.2.15.1"><a class="xref" href="#section-11.1.15">11.1.15</a>.Â <a class="xref" href="#name-receive-unacknowledged-mess">Receive Unacknowledged Message</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1.2.16">
                    <p id="section-toc.1-1.11.2.1.2.16.1"><a class="xref" href="#section-11.1.16">11.1.16</a>.Â <a class="xref" href="#name-destroy-sctp-instance">Destroy SCTP Instance</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a class="xref" href="#section-11.2">11.2</a>.Â Â <a class="xref" href="#name-sctp-to-ulp">SCTP-to-ULP</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2.2.1">
                    <p id="section-toc.1-1.11.2.2.2.1.1"><a class="xref" href="#section-11.2.1">11.2.1</a>.Â Â <a class="xref" href="#name-data-arrive-notification">DATA ARRIVE Notification</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2.2.2">
                    <p id="section-toc.1-1.11.2.2.2.2.1"><a class="xref" href="#section-11.2.2">11.2.2</a>.Â Â <a class="xref" href="#name-send-failure-notification">SEND FAILURE Notification</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2.2.3">
                    <p id="section-toc.1-1.11.2.2.2.3.1"><a class="xref" href="#section-11.2.3">11.2.3</a>.Â Â <a class="xref" href="#name-network-status-change-notif">NETWORK STATUS CHANGE Notification</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2.2.4">
                    <p id="section-toc.1-1.11.2.2.2.4.1"><a class="xref" href="#section-11.2.4">11.2.4</a>.Â Â <a class="xref" href="#name-communication-up-notificati">COMMUNICATION UP Notification</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2.2.5">
                    <p id="section-toc.1-1.11.2.2.2.5.1"><a class="xref" href="#section-11.2.5">11.2.5</a>.Â Â <a class="xref" href="#name-communication-lost-notifica">COMMUNICATION LOST Notification</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2.2.6">
                    <p id="section-toc.1-1.11.2.2.2.6.1"><a class="xref" href="#section-11.2.6">11.2.6</a>.Â Â <a class="xref" href="#name-communication-error-notific">COMMUNICATION ERROR Notification</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2.2.7">
                    <p id="section-toc.1-1.11.2.2.2.7.1"><a class="xref" href="#section-11.2.7">11.2.7</a>.Â Â <a class="xref" href="#name-restart-notification">RESTART Notification</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2.2.8">
                    <p id="section-toc.1-1.11.2.2.2.8.1"><a class="xref" href="#section-11.2.8">11.2.8</a>.Â Â <a class="xref" href="#name-shutdown-complete-notificat">SHUTDOWN COMPLETE Notification</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a class="xref" href="#section-12">12</a>.Â <a class="xref" href="#name-security-considerations">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a class="xref" href="#section-12.1">12.1</a>.Â Â <a class="xref" href="#name-security-objectives">Security Objectives</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a class="xref" href="#section-12.2">12.2</a>.Â Â <a class="xref" href="#name-sctp-responses-to-potential">SCTP Responses to Potential Threats</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2.2.1">
                    <p id="section-toc.1-1.12.2.2.2.1.1"><a class="xref" href="#section-12.2.1">12.2.1</a>.Â Â <a class="xref" href="#name-countering-insider-attacks">Countering Insider Attacks</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2.2.2">
                    <p id="section-toc.1-1.12.2.2.2.2.1"><a class="xref" href="#section-12.2.2">12.2.2</a>.Â Â <a class="xref" href="#name-protecting-against-data-cor">Protecting against Data Corruption in the Network</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2.2.3">
                    <p id="section-toc.1-1.12.2.2.2.3.1"><a class="xref" href="#section-12.2.3">12.2.3</a>.Â Â <a class="xref" href="#name-protecting-confidentiality">Protecting Confidentiality</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2.2.4">
                    <p id="section-toc.1-1.12.2.2.2.4.1"><a class="xref" href="#section-12.2.4">12.2.4</a>.Â Â <a class="xref" href="#name-protecting-against-blind-de">Protecting against Blind Denial-of-Service Attacks</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2.2.4.2.1">
                        <p id="section-toc.1-1.12.2.2.2.4.2.1.1"><a class="xref" href="#section-12.2.4.1">12.2.4.1</a>.Â Â <a class="xref" href="#name-flooding">Flooding</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2.2.4.2.2">
                        <p id="section-toc.1-1.12.2.2.2.4.2.2.1"><a class="xref" href="#section-12.2.4.2">12.2.4.2</a>.Â Â <a class="xref" href="#name-blind-masquerade">Blind Masquerade</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2.2.4.2.3">
                        <p id="section-toc.1-1.12.2.2.2.4.2.3.1"><a class="xref" href="#section-12.2.4.3">12.2.4.3</a>.Â Â <a class="xref" href="#name-improper-monopolization-of-">Improper Monopolization of Services</a></p>
</li>
                    </ul>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.3">
                <p id="section-toc.1-1.12.2.3.1"><a class="xref" href="#section-12.3">12.3</a>.Â Â <a class="xref" href="#name-sctp-interactions-with-fire">SCTP Interactions with Firewalls</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.4">
                <p id="section-toc.1-1.12.2.4.1"><a class="xref" href="#section-12.4">12.4</a>.Â Â <a class="xref" href="#name-protection-of-non-sctp-capa">Protection of Non-SCTP-capable Hosts</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a class="xref" href="#section-13">13</a>.Â <a class="xref" href="#name-network-management-consider">Network Management Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a class="xref" href="#section-14">14</a>.Â <a class="xref" href="#name-recommended-transmission-co">Recommended Transmission Control Block (TCB) Parameters</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.1">
                <p id="section-toc.1-1.14.2.1.1"><a class="xref" href="#section-14.1">14.1</a>.Â Â <a class="xref" href="#name-parameters-necessary-for-th">Parameters Necessary for the SCTP Instance</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.2">
                <p id="section-toc.1-1.14.2.2.1"><a class="xref" href="#section-14.2">14.2</a>.Â Â <a class="xref" href="#name-parameters-necessary-per-as">Parameters Necessary per Association (i.e., the TCB)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.3">
                <p id="section-toc.1-1.14.2.3.1"><a class="xref" href="#section-14.3">14.3</a>.Â Â <a class="xref" href="#name-per-transport-address-data">Per Transport Address Data</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.4">
                <p id="section-toc.1-1.14.2.4.1"><a class="xref" href="#section-14.4">14.4</a>.Â Â <a class="xref" href="#name-general-parameters-needed">General Parameters Needed</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a class="xref" href="#section-15">15</a>.Â <a class="xref" href="#name-iana-considerations">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.1">
                <p id="section-toc.1-1.15.2.1.1"><a class="xref" href="#section-15.1">15.1</a>.Â Â <a class="xref" href="#name-ietf-defined-chunk-extensio">IETF-Defined Chunk Extension</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.2">
                <p id="section-toc.1-1.15.2.2.1"><a class="xref" href="#section-15.2">15.2</a>.Â Â <a class="xref" href="#name-ietf-defined-chunk-flags-re">IETF-Defined Chunk Flags Registration</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.3">
                <p id="section-toc.1-1.15.2.3.1"><a class="xref" href="#section-15.3">15.3</a>.Â Â <a class="xref" href="#name-ietf-defined-chunk-paramete">IETF-Defined Chunk Parameter Extension</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.4">
                <p id="section-toc.1-1.15.2.4.1"><a class="xref" href="#section-15.4">15.4</a>.Â Â <a class="xref" href="#name-ietf-defined-additional-err">IETF-Defined Additional Error Causes</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.5">
                <p id="section-toc.1-1.15.2.5.1"><a class="xref" href="#section-15.5">15.5</a>.Â Â <a class="xref" href="#name-payload-protocol-identifier">Payload Protocol Identifiers</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.6">
                <p id="section-toc.1-1.15.2.6.1"><a class="xref" href="#section-15.6">15.6</a>.Â Â <a class="xref" href="#name-port-numbers-registry">Port Numbers Registry</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a class="xref" href="#section-16">16</a>.Â <a class="xref" href="#name-suggested-sctp-protocol-par">Suggested SCTP Protocol Parameter Values</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a class="xref" href="#section-17">17</a>.Â <a class="xref" href="#name-references">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.1">
                <p id="section-toc.1-1.17.2.1.1"><a class="xref" href="#section-17.1">17.1</a>.Â Â <a class="xref" href="#name-normative-references">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.2">
                <p id="section-toc.1-1.17.2.2.1"><a class="xref" href="#section-17.2">17.2</a>.Â Â <a class="xref" href="#name-informative-references">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18">
            <p id="section-toc.1-1.18.1"><a class="xref" href="#appendix-A">Appendix A</a>.Â Â <a class="xref" href="#name-crc32c-checksum-calculation-2">CRC32c Checksum Calculation</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19">
            <p id="section-toc.1-1.19.1"><a class="xref" href="#appendix-B"></a><a class="xref" href="#name-acknowledgements">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20">
            <p id="section-toc.1-1.20.1"><a class="xref" href="#appendix-C"></a><a class="xref" href="#name-authors-addresses">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">This section explains the reasoning behind the development of the
Stream Control Transmission Protocol (SCTP), the services it offers,
and the basic concepts needed to understand the detailed description
of the protocol.<a class="pilcrow" href="#section-1-1">Â¶</a></p>
<p id="section-1-2">This document obsoletes <span>[<a class="xref" href="#RFC4960">RFC4960</a>]</span>.
In addition to that, it incorporates the specification of the chunk flags
registry from <span>[<a class="xref" href="#RFC6096">RFC6096</a>]</span> and the specification of the I bit of
DATA chunks from <span>[<a class="xref" href="#RFC7053">RFC7053</a>]</span>.
Therefore, <span>[<a class="xref" href="#RFC6096">RFC6096</a>]</span> and <span>[<a class="xref" href="#RFC7053">RFC7053</a>]</span> are also
obsoleted by this document.<a class="pilcrow" href="#section-1-2">Â¶</a></p>
<section id="section-1.1">
        <h3 id="name-motivation">
<a class="section-number selfRef" href="#section-1.1">1.1. </a><a class="section-name selfRef" href="#name-motivation">Motivation</a>
        </h3>
<p id="section-1.1-1">TCP <span>[<a class="xref" href="#RFC0793">RFC0793</a>]</span> has performed immense service as the primary
means of reliable data transfer in IP networks.
However, an increasing number of recent applications have found TCP too
limiting and have incorporated their own reliable data transfer protocol
on top of UDP <span>[<a class="xref" href="#RFC0768">RFC0768</a>]</span>.
The limitations that users have wished to bypass include the following:<a class="pilcrow" href="#section-1.1-1">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-2.1">
            <p id="section-1.1-2.1.1">TCP provides both reliable data transfer and strict
order-of-transmission delivery of data.
Some applications need reliable transfer without sequence maintenance,
while others would be satisfied with partial ordering of the data.
In both of these cases, the head-of-line blocking offered by TCP causes
unnecessary delay.<a class="pilcrow" href="#section-1.1-2.1.1">Â¶</a></p>
</li>
          <li class="normal" id="section-1.1-2.2">
            <p id="section-1.1-2.2.1">The stream-oriented nature of TCP is often an inconvenience.
Applications add their own record marking to delineate their
messages and make explicit use of the push facility to
ensure that a complete message is transferred in a reasonable
time.<a class="pilcrow" href="#section-1.1-2.2.1">Â¶</a></p>
</li>
          <li class="normal" id="section-1.1-2.3">
            <p id="section-1.1-2.3.1">The limited scope of TCP sockets complicates the task of providing
highly available data transfer capability using multi-homed hosts.<a class="pilcrow" href="#section-1.1-2.3.1">Â¶</a></p>
</li>
          <li class="normal" id="section-1.1-2.4">
            <p id="section-1.1-2.4.1">TCP is relatively vulnerable to denial-of-service attacks, such
as SYN attacks.<a class="pilcrow" href="#section-1.1-2.4.1">Â¶</a></p>
</li>
        </ul>
<p id="section-1.1-3">Transport of PSTN signaling across the IP network is an application
for which all of these limitations of TCP are relevant.
While this application directly motivated the development of SCTP, other
applications might find SCTP a good match to their requirements.
One example of this is the use of data channels in the WebRTC infrastructure.<a class="pilcrow" href="#section-1.1-3">Â¶</a></p>
</section>
<section id="section-1.2">
        <h3 id="name-architectural-view-of-sctp">
<a class="section-number selfRef" href="#section-1.2">1.2. </a><a class="section-name selfRef" href="#name-architectural-view-of-sctp">Architectural View of SCTP</a>
        </h3>
<p id="section-1.2-1">SCTP is viewed as a layer between the SCTP user application ("SCTP
user" for short) and a connectionless packet network service, such as
IP.
The remainder of this document assumes SCTP runs on top of IP.
The basic service offered by SCTP is the reliable transfer of user
messages between peer SCTP users.
It performs this service within the context of an association between
two SCTP endpoints.
<a class="xref" href="#sec_api">Section 11</a> of this document sketches the API that exists
at the boundary between SCTP and the SCTP upper layers.<a class="pilcrow" href="#section-1.2-1">Â¶</a></p>
<p id="section-1.2-2">SCTP is connection oriented in nature, but the SCTP association is a
broader concept than the TCP connection.
SCTP provides the means for each SCTP endpoint (<a class="xref" href="#sec_key_terms">Section 1.3</a>)
to provide the other endpoint (during association startup) with a list of
transport addresses (i.e., multiple IP addresses in combination with an SCTP
port) through which that endpoint can be reached and from which it will
originate SCTP packets.
The association spans transfers over all of the possible source/destination
combinations that can be generated from each endpoint's lists.<a class="pilcrow" href="#section-1.2-2">Â¶</a></p>
<span id="name-an-sctp-association"></span><div id="fig_association">
<figure id="figure-1">
          <div class="alignCenter art-text artwork" id="section-1.2-3.1">
<pre> _____________                                      _____________
|  SCTP User  |                                    |  SCTP User  |
| Application |                                    | Application |
|-------------|                                    |-------------|
|    SCTP     |                                    |    SCTP     |
|  Transport  |                                    |  Transport  |
|   Service   |                                    |   Service   |
|-------------|                                    |-------------|
|             |One or more    ----      One or more|             |
| IP Network  |IP address      \/        IP address| IP Network  |
|   Service   |appearances     /\       appearances|   Service   |
|_____________|               ----                 |_____________|

  SCTP Node A |&lt;-------- Network transport -------&gt;| SCTP Node B

</pre>
</div>
<figcaption><a class="selfRef" href="#figure-1">Figure 1</a>:
<a class="selfRef" href="#name-an-sctp-association">An SCTP Association</a>
          </figcaption></figure>
</div>
<p id="section-1.2-4">In addition to encapsulating SCTP packets in IPv4 or IPv6, it is also possible
to encapsulate SCTP packets in UDP as specified in <span>[<a class="xref" href="#RFC6951">RFC6951</a>]</span>
or encapsulate them in DTLS as specified in <span>[<a class="xref" href="#RFC8261">RFC8261</a>]</span>.<a class="pilcrow" href="#section-1.2-4">Â¶</a></p>
</section>
<div id="sec_key_terms">
<section id="section-1.3">
        <h3 id="name-key-terms">
<a class="section-number selfRef" href="#section-1.3">1.3. </a><a class="section-name selfRef" href="#name-key-terms">Key Terms</a>
        </h3>
<p id="section-1.3-1">Some of the language used to describe SCTP has been introduced in the
previous sections. This section provides a consolidated list of the
key terms and their definitions.<a class="pilcrow" href="#section-1.3-1">Â¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-1.3-2">
          <dt id="section-1.3-2.1">Active Destination Transport Address:</dt>
          <dd id="section-1.3-2.2" style="margin-left: 1.5em">A transport address on a peer endpoint that a transmitting endpoint considers
available for receiving user messages.<a class="pilcrow" href="#section-1.3-2.2">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.3">Association Maximum DATA Chunk Size (AMDCS):</dt>
          <dd id="section-1.3-2.4" style="margin-left: 1.5em">The smallest Path Maximum DATA Chunk Size (PMDCS) of all destination
addresses.<a class="pilcrow" href="#section-1.3-2.4">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.5">Bundling of Chunks:</dt>
          <dd id="section-1.3-2.6" style="margin-left: 1.5em">An optional multiplexing operation, whereby more than one chunk can
be carried in the same SCTP packet.<a class="pilcrow" href="#section-1.3-2.6">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.7">Bundling of User Messages:</dt>
          <dd id="section-1.3-2.8" style="margin-left: 1.5em">An optional multiplexing operation, whereby more than one user message can
be carried in the same SCTP packet. Each user message occupies its own DATA chunk.<a class="pilcrow" href="#section-1.3-2.8">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.9">Chunk:</dt>
          <dd id="section-1.3-2.10" style="margin-left: 1.5em">A unit of information within an SCTP packet, consisting of a chunk header
and chunk-specific content.<a class="pilcrow" href="#section-1.3-2.10">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.11">Congestion Window (cwnd):</dt>
          <dd id="section-1.3-2.12" style="margin-left: 1.5em">An SCTP variable that limits outstanding data, in number of bytes,
that a sender can send to a particular destination transport address before
receiving an acknowledgement.<a class="pilcrow" href="#section-1.3-2.12">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.13">Control Chunk:</dt>
          <dd id="section-1.3-2.14" style="margin-left: 1.5em">A chunk not being used for transmitting user data, i.e., every chunk that
is not a DATA chunk.<a class="pilcrow" href="#section-1.3-2.14">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.15">Cumulative TSN Ack Point:</dt>
          <dd id="section-1.3-2.16" style="margin-left: 1.5em">The Transmission Sequence Number (TSN) of the last DATA chunk acknowledged via
the Cumulative TSN Ack field of a SACK chunk.<a class="pilcrow" href="#section-1.3-2.16">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.17">Flightsize:</dt>
          <dd id="section-1.3-2.18" style="margin-left: 1.5em">The number of bytes of outstanding data to a particular destination transport
address at any given time.<a class="pilcrow" href="#section-1.3-2.18">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.19">Idle Destination Address:</dt>
          <dd id="section-1.3-2.20" style="margin-left: 1.5em">An address that has not had user messages sent to it within some length
of time, normally the 'HB.interval' or greater.<a class="pilcrow" href="#section-1.3-2.20">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.21">Inactive Destination Transport Address:</dt>
          <dd id="section-1.3-2.22" style="margin-left: 1.5em">An address that is considered inactive due to errors and unavailable to
transport user messages.<a class="pilcrow" href="#section-1.3-2.22">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.23">Message (or User Message):</dt>
          <dd id="section-1.3-2.24" style="margin-left: 1.5em">Data submitted to SCTP by the Upper-Layer Protocol (ULP).<a class="pilcrow" href="#section-1.3-2.24">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.25">Network Byte Order:</dt>
          <dd id="section-1.3-2.26" style="margin-left: 1.5em">Most significant byte first, a.k.a., big endian.<a class="pilcrow" href="#section-1.3-2.26">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.27">Ordered Message:</dt>
          <dd id="section-1.3-2.28" style="margin-left: 1.5em">A user message that is delivered in order with respect to all previous user
messages sent within the stream on which the message was sent.<a class="pilcrow" href="#section-1.3-2.28">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.29">Outstanding Data (or Data Outstanding or Data In Flight):</dt>
          <dd id="section-1.3-2.30" style="margin-left: 1.5em">The total size of the DATA chunks associated with outstanding TSNs.
A retransmitted DATA chunk is counted once in outstanding data.
A DATA chunk that is classified as lost but that has not yet been
retransmitted is not in outstanding data.<a class="pilcrow" href="#section-1.3-2.30">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.31">Outstanding TSN (at an SCTP Endpoint):</dt>
          <dd id="section-1.3-2.32" style="margin-left: 1.5em">A TSN (and the associated DATA chunk) that has been sent by the endpoint
but for which it has not yet received an acknowledgement.<a class="pilcrow" href="#section-1.3-2.32">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.33">"Out of the Blue" (OOTB) Packet:</dt>
          <dd id="section-1.3-2.34" style="margin-left: 1.5em">A correctly formed packet, for which the receiver cannot identify the
association it belongs to. See <a class="xref" href="#sec_handle_out_of_the_blue_packets">Section 8.4</a>.<a class="pilcrow" href="#section-1.3-2.34">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.35">Path:</dt>
          <dd id="section-1.3-2.36" style="margin-left: 1.5em">The route taken by the SCTP packets sent by one SCTP endpoint to a specific
destination transport address of its peer SCTP endpoint.
Sending to different destination transport addresses does not necessarily
guarantee getting separate paths.
Within this specification, a path is identified by the destination transport
address, since the routing is assumed to be stable.
This includes, in particular, the source address being selected when sending
packets to the destination address.<a class="pilcrow" href="#section-1.3-2.36">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.37">Path Maximum DATA Chunk Size (PMDCS):</dt>
          <dd id="section-1.3-2.38" style="margin-left: 1.5em">The maximum size (including the DATA chunk header) of a DATA chunk that fits
into an SCTP packet not exceeding the PMTU of a particular destination address.<a class="pilcrow" href="#section-1.3-2.38">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.39">Path Maximum Transmission Unit (PMTU):</dt>
          <dd id="section-1.3-2.40" style="margin-left: 1.5em">The maximum size (including the SCTP common header and all chunks including
their paddings) of an SCTP packet that can be sent to a particular
destination address without using IP-level fragmentation.<a class="pilcrow" href="#section-1.3-2.40">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.41">Primary Path:</dt>
          <dd id="section-1.3-2.42" style="margin-left: 1.5em">The destination and source address that will be put into
a packet outbound to the peer endpoint by default.
The definition includes the source address since an implementation <span class="bcp14">MAY</span> wish
to specify both destination and source address to better control the return
path taken by reply chunks and on which interface the packet is transmitted
when the data sender is multi-homed.<a class="pilcrow" href="#section-1.3-2.42">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.43">Receiver Window (rwnd):</dt>
          <dd id="section-1.3-2.44" style="margin-left: 1.5em">An SCTP variable a data sender uses to store the most recently calculated
receiver window of its peer, in number of bytes.
This gives the sender an indication of the space available in the receiver's
inbound buffer.<a class="pilcrow" href="#section-1.3-2.44">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.45">SCTP Association:</dt>
          <dd id="section-1.3-2.46" style="margin-left: 1.5em">A protocol relationship between SCTP endpoints, composed of the two SCTP
endpoints and protocol state information, including Verification Tags and the
currently active set of Transmission Sequence Numbers (TSNs), etc.
An association can be uniquely identified by the transport addresses used by the
endpoints in the association.
Two SCTP endpoints <span class="bcp14">MUST NOT</span> have more than one SCTP association between
them at any given time.<a class="pilcrow" href="#section-1.3-2.46">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.47">SCTP Endpoint:</dt>
          <dd id="section-1.3-2.48" style="margin-left: 1.5em">The logical sender/receiver of SCTP packets.
On a multi-homed host, an SCTP endpoint is represented to its peers as
a combination of a set of eligible destination transport addresses
to which SCTP packets can be sent and a set of eligible source
transport addresses from which SCTP packets can be received.
All transport addresses used by an SCTP endpoint <span class="bcp14">MUST</span> use the same
port number but can use multiple IP addresses.
A transport address used by an SCTP endpoint <span class="bcp14">MUST NOT</span> be used by another SCTP
endpoint.
In other words, a transport address is unique to an SCTP endpoint.<a class="pilcrow" href="#section-1.3-2.48">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.49">SCTP Packet (or Packet):</dt>
          <dd id="section-1.3-2.50" style="margin-left: 1.5em">The unit of data delivery across the interface between SCTP and the
connectionless packet network (e.g., IP).
An SCTP packet includes the common SCTP header, possible SCTP control chunks,
and user data encapsulated within SCTP DATA chunks.<a class="pilcrow" href="#section-1.3-2.50">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.51">SCTP User Application (or SCTP User):</dt>
          <dd id="section-1.3-2.52" style="margin-left: 1.5em">The logical higher-layer application entity that uses the services of SCTP,
also called the Upper-Layer Protocol (ULP).<a class="pilcrow" href="#section-1.3-2.52">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.53">Slow-Start Threshold (ssthresh):</dt>
          <dd id="section-1.3-2.54" style="margin-left: 1.5em">An SCTP variable.
This is the threshold that the endpoint will use to determine whether to
perform slow-start or congestion avoidance on a particular destination
transport address. Ssthresh is in number of bytes.<a class="pilcrow" href="#section-1.3-2.54">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.55">State Cookie:</dt>
          <dd id="section-1.3-2.56" style="margin-left: 1.5em">A container of all information needed to establish an association.<a class="pilcrow" href="#section-1.3-2.56">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.57">Stream:</dt>
          <dd id="section-1.3-2.58" style="margin-left: 1.5em">
            <p id="section-1.3-2.58.1">A unidirectional logical channel established from one to
another associated SCTP endpoint, within which all user messages
are delivered in sequence, except for those submitted to the
unordered delivery service.<a class="pilcrow" href="#section-1.3-2.58.1">Â¶</a></p>
<p id="section-1.3-2.58.2">Note: The relationship between stream numbers in opposite directions
is strictly a matter of how the applications use them. It is the
responsibility of the SCTP user to create and manage these
correlations if they are so desired.<a class="pilcrow" href="#section-1.3-2.58.2">Â¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.59">Stream Sequence Number:</dt>
          <dd id="section-1.3-2.60" style="margin-left: 1.5em">A 16-bit sequence number used internally by SCTP to ensure sequenced delivery
of the user messages within a given stream.
One Stream Sequence Number is attached to each ordered user message.<a class="pilcrow" href="#section-1.3-2.60">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.61">Tie-Tags:</dt>
          <dd id="section-1.3-2.62" style="margin-left: 1.5em">Two 32-bit random numbers that together make a 64-bit nonce.
These tags are used within a State Cookie and TCB so that a newly restarting
association can be linked to the original association within the endpoint
that did not restart and yet not reveal the true Verification Tags of an
existing association.<a class="pilcrow" href="#section-1.3-2.62">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.63">Transmission Control Block (TCB):</dt>
          <dd id="section-1.3-2.64" style="margin-left: 1.5em">An internal data structure created by an SCTP endpoint for each of its
existing SCTP associations to other SCTP endpoints.
TCB contains all the status and operational information for the endpoint
to maintain and manage the corresponding association.<a class="pilcrow" href="#section-1.3-2.64">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.65">Transmission Sequence Number (TSN):</dt>
          <dd id="section-1.3-2.66" style="margin-left: 1.5em">A 32-bit sequence number used internally by SCTP.
One TSN is attached to each chunk containing user data to permit the
receiving SCTP endpoint to acknowledge its receipt and detect duplicate
deliveries.<a class="pilcrow" href="#section-1.3-2.66">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.67">Transport Address:</dt>
          <dd id="section-1.3-2.68" style="margin-left: 1.5em">A transport address is typically defined by a network-layer address,
a transport-layer protocol, and a transport-layer port number.
In the case of SCTP running over IP, a transport address is defined by
the combination of an IP address and an SCTP port number (where SCTP is the
transport protocol).<a class="pilcrow" href="#section-1.3-2.68">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.69">Unordered Message:</dt>
          <dd id="section-1.3-2.70" style="margin-left: 1.5em">Unordered messages are "unordered" with respect to any other message;
this includes both other unordered messages as well as other ordered messages.
An unordered message might be delivered prior to or later than ordered messages
sent on the same stream.<a class="pilcrow" href="#section-1.3-2.70">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.71">User Message:</dt>
          <dd id="section-1.3-2.72" style="margin-left: 1.5em">The unit of data delivery across the interface between SCTP and its user.<a class="pilcrow" href="#section-1.3-2.72">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.73">Verification Tag:</dt>
          <dd id="section-1.3-2.74" style="margin-left: 1.5em">A 32-bit unsigned integer that is randomly generated.
The Verification Tag provides a key that allows a receiver to verify that the
SCTP packet belongs to the current association and is not an old or stale
packet from a previous association.<a class="pilcrow" href="#section-1.3-2.74">Â¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<section id="section-1.4">
        <h3 id="name-abbreviations">
<a class="section-number selfRef" href="#section-1.4">1.4. </a><a class="section-name selfRef" href="#name-abbreviations">Abbreviations</a>
        </h3>
<span class="break"></span><dl class="dlParallel" id="section-1.4-1">
          <dt id="section-1.4-1.1">MAC</dt>
          <dd id="section-1.4-1.2" style="margin-left: 4.0em">Message Authentication Code <span>[<a class="xref" href="#RFC2104">RFC2104</a>]</span><a class="pilcrow" href="#section-1.4-1.2">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.4-1.3">RTO</dt>
          <dd id="section-1.4-1.4" style="margin-left: 4.0em">Retransmission Timeout<a class="pilcrow" href="#section-1.4-1.4">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.4-1.5">RTT</dt>
          <dd id="section-1.4-1.6" style="margin-left: 4.0em">Round-Trip Time<a class="pilcrow" href="#section-1.4-1.6">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.4-1.7">RTTVAR</dt>
          <dd id="section-1.4-1.8" style="margin-left: 4.0em">Round-Trip Time Variation<a class="pilcrow" href="#section-1.4-1.8">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.4-1.9">SCTP</dt>
          <dd id="section-1.4-1.10" style="margin-left: 4.0em">Stream Control Transmission Protocol<a class="pilcrow" href="#section-1.4-1.10">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.4-1.11">SRTT</dt>
          <dd id="section-1.4-1.12" style="margin-left: 4.0em">Smoothed RTT<a class="pilcrow" href="#section-1.4-1.12">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.4-1.13">TCB</dt>
          <dd id="section-1.4-1.14" style="margin-left: 4.0em">Transmission Control Block<a class="pilcrow" href="#section-1.4-1.14">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.4-1.15">TLV</dt>
          <dd id="section-1.4-1.16" style="margin-left: 4.0em">Type-Length-Value coding format<a class="pilcrow" href="#section-1.4-1.16">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.4-1.17">TSN</dt>
          <dd id="section-1.4-1.18" style="margin-left: 4.0em">Transmission Sequence Number<a class="pilcrow" href="#section-1.4-1.18">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.4-1.19">ULP</dt>
          <dd id="section-1.4-1.20" style="margin-left: 4.0em">Upper-Layer Protocol<a class="pilcrow" href="#section-1.4-1.20">Â¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
<section id="section-1.5">
        <h3 id="name-functional-view-of-sctp">
<a class="section-number selfRef" href="#section-1.5">1.5. </a><a class="section-name selfRef" href="#name-functional-view-of-sctp">Functional View of SCTP</a>
        </h3>
<p id="section-1.5-1">The SCTP transport service can be decomposed into a number of functions.
These are depicted in <a class="xref" href="#fig_functional_view">Figure 2</a> and explained
in the remainder of this section.<a class="pilcrow" href="#section-1.5-1">Â¶</a></p>
<span id="name-functional-view-of-the-sctp"></span><div id="fig_functional_view">
<figure id="figure-2">
          <div class="alignCenter art-text artwork" id="section-1.5-2.1">
<pre>                SCTP User Application

-----------------------------------------------------
 _____________                  ____________________
|             |                | Sequenced Delivery |
| Association |                |   within Streams   |
|             |                |____________________|
|   Startup   |
|             |         ____________________________
|     and     |        |  User Data Fragmentation   |
|             |        |____________________________|
|  Takedown   |
|             |         ____________________________
|             |        |      Acknowledgement       |
|             |        |            and             |
|             |        |    Congestion Avoidance    |
|             |        |____________________________|
|             |
|             |         ____________________________
|             |        |       Chunk Bundling       |
|             |        |____________________________|
|             |
|             |     ________________________________
|             |    |       Packet Validation        |
|             |    |________________________________|
|             |
|             |     ________________________________
|             |    |        Path Management         |
|_____________|    |________________________________|

</pre>
</div>
<figcaption><a class="selfRef" href="#figure-2">Figure 2</a>:
<a class="selfRef" href="#name-functional-view-of-the-sctp">Functional View of the SCTP Transport Service</a>
          </figcaption></figure>
</div>
<section id="section-1.5.1">
          <h4 id="name-association-startup-and-tak">
<a class="section-number selfRef" href="#section-1.5.1">1.5.1. </a><a class="section-name selfRef" href="#name-association-startup-and-tak">Association Startup and Takedown</a>
          </h4>
<p id="section-1.5.1-1">An association is initiated by a request from the SCTP user (see the
description of the ASSOCIATE (or SEND) primitive in <a class="xref" href="#sec_api">Section 11</a>).<a class="pilcrow" href="#section-1.5.1-1">Â¶</a></p>
<p id="section-1.5.1-2">A cookie mechanism, similar to one described by Karn and Simpson in
<span>[<a class="xref" href="#RFC2522">RFC2522</a>]</span>, is employed during the initialization to provide
protection against synchronization attacks.
The cookie mechanism uses a four-way handshake, the last two legs of which
are allowed to carry user data for fast setup.
The startup sequence is described in <a class="xref" href="#sec_assoc_initialization">Section 5</a>
of this document.<a class="pilcrow" href="#section-1.5.1-2">Â¶</a></p>
<p id="section-1.5.1-3">SCTP provides for graceful close (i.e., shutdown) of an active
association on request from the SCTP user.
See the description of the SHUTDOWN primitive in <a class="xref" href="#sec_api">Section 11</a>.
SCTP also allows ungraceful close (i.e., abort), either on request from the
user (ABORT primitive) or as a result of an error condition detected within
the SCTP layer.
<a class="xref" href="#sec_assoc_termination">Section 9</a> describes both the graceful and the
ungraceful close procedures.<a class="pilcrow" href="#section-1.5.1-3">Â¶</a></p>
<p id="section-1.5.1-4">SCTP does not support a half-open state (like TCP) wherein one side
continues sending data while the other end is closed.
When either endpoint performs a shutdown, the association on each peer will
stop accepting new data from its user and only deliver data in queue at
the time of the graceful close (see <a class="xref" href="#sec_assoc_termination">Section 9</a>).<a class="pilcrow" href="#section-1.5.1-4">Â¶</a></p>
</section>
<section id="section-1.5.2">
          <h4 id="name-sequenced-delivery-within-s">
<a class="section-number selfRef" href="#section-1.5.2">1.5.2. </a><a class="section-name selfRef" href="#name-sequenced-delivery-within-s">Sequenced Delivery within Streams</a>
          </h4>
<p id="section-1.5.2-1">The term "stream" is used in SCTP to refer to a sequence of user
messages that are to be delivered to the upper-layer protocol in
order with respect to other messages within the same stream.
This is in contrast to its usage in TCP, where it refers to a sequence of
bytes (in this document, a byte is assumed to be 8 bits).<a class="pilcrow" href="#section-1.5.2-1">Â¶</a></p>
<p id="section-1.5.2-2">At association startup time, the SCTP user can specify the number of
streams to be supported by the association.
This number is negotiated with the remote end
(see <a class="xref" href="#sec_handle_stream_parameters">Section 5.1.1</a>).
User messages are associated with stream numbers (SEND, RECEIVE primitives;
<a class="xref" href="#sec_api">Section 11</a>).
Internally, SCTP assigns a Stream Sequence Number to each message passed to
it by the SCTP user.
On the receiving side, SCTP ensures that messages are delivered to the SCTP
user in sequence within a given stream.
However, while one stream might be blocked waiting for the next in-sequence
user message, delivery from other streams might proceed.<a class="pilcrow" href="#section-1.5.2-2">Â¶</a></p>
<p id="section-1.5.2-3">SCTP provides a mechanism for bypassing the sequenced delivery
service.
User messages sent using this mechanism are delivered to the SCTP user as
soon as they are received.<a class="pilcrow" href="#section-1.5.2-3">Â¶</a></p>
</section>
<section id="section-1.5.3">
          <h4 id="name-user-data-fragmentation">
<a class="section-number selfRef" href="#section-1.5.3">1.5.3. </a><a class="section-name selfRef" href="#name-user-data-fragmentation">User Data Fragmentation</a>
          </h4>
<p id="section-1.5.3-1">When needed, SCTP fragments user messages to ensure that the size of the SCTP
packet passed to the lower layer does not exceed the PMTU.
Once a user message has been fragmented, this fragmentation cannot be changed
anymore.
On receipt, fragments are reassembled into complete messages before
being passed to the SCTP user.<a class="pilcrow" href="#section-1.5.3-1">Â¶</a></p>
</section>
<section id="section-1.5.4">
          <h4 id="name-acknowledgement-and-congest">
<a class="section-number selfRef" href="#section-1.5.4">1.5.4. </a><a class="section-name selfRef" href="#name-acknowledgement-and-congest">Acknowledgement and Congestion Avoidance</a>
          </h4>
<p id="section-1.5.4-1">SCTP assigns a Transmission Sequence Number (TSN) to each user data
fragment or unfragmented message.
The TSN is independent of any Stream Sequence Number assigned at the
stream level.
The receiving end acknowledges all TSNs received, even if there are gaps in the
sequence.
If a user data fragment or unfragmented message needs to be retransmitted,
the TSN assigned to it is used.
In this way, reliable delivery is kept functionally separate from sequenced
stream delivery.<a class="pilcrow" href="#section-1.5.4-1">Â¶</a></p>
<p id="section-1.5.4-2">The acknowledgement and congestion avoidance function is responsible
for packet retransmission when timely acknowledgement has not been
received.
Packet retransmission is conditioned by congestion avoidance procedures
similar to those used for TCP. See Sections <a class="xref" href="#sec_user_data_transfer">6</a> and
<a class="xref" href="#sec_congestion_control">7</a> for detailed descriptions of the
protocol procedures associated with this function.<a class="pilcrow" href="#section-1.5.4-2">Â¶</a></p>
</section>
<section id="section-1.5.5">
          <h4 id="name-chunk-bundling">
<a class="section-number selfRef" href="#section-1.5.5">1.5.5. </a><a class="section-name selfRef" href="#name-chunk-bundling">Chunk Bundling</a>
          </h4>
<p id="section-1.5.5-1">As described in <a class="xref" href="#sec_sctp_packet_format">Section 3</a>, the SCTP packet
as delivered to the lower layer consists of a common header followed by one
or more chunks.
Each chunk contains either user data or SCTP control information.
An SCTP implementation supporting bundling on the sender side might
delay the sending of user messages to allow the corresponding DATA
chunks to be bundled.<a class="pilcrow" href="#section-1.5.5-1">Â¶</a></p>
<p id="section-1.5.5-2">The SCTP user has the option to request that an SCTP implementation does not
delay the sending of a user message just for this purpose.
However, even if the SCTP user has chosen this option, the SCTP implementation
might delay the sending due to other reasons (for example, due to congestion
control or flow control) and might also bundle multiple DATA chunks, if
possible.<a class="pilcrow" href="#section-1.5.5-2">Â¶</a></p>
</section>
<section id="section-1.5.6">
          <h4 id="name-packet-validation">
<a class="section-number selfRef" href="#section-1.5.6">1.5.6. </a><a class="section-name selfRef" href="#name-packet-validation">Packet Validation</a>
          </h4>
<p id="section-1.5.6-1">A mandatory Verification Tag field and a 32-bit checksum field (see
<a class="xref" href="#sec_crc32c">Appendix A</a> for a description of the 32-bit Cyclic Redundancy Check (CRC32c) checksum)
are included in the SCTP common header.
The Verification Tag value is chosen by each end of the association during
association startup.
Packets received without the expected Verification Tag value are discarded,
as a protection against blind masquerade attacks and against stale SCTP
packets from a previous association.
The CRC32c checksum is set by the sender of each SCTP packet to
provide additional protection against data corruption in the network.
The receiver of an SCTP packet with an invalid CRC32c checksum silently
discards the packet.<a class="pilcrow" href="#section-1.5.6-1">Â¶</a></p>
</section>
<section id="section-1.5.7">
          <h4 id="name-path-management">
<a class="section-number selfRef" href="#section-1.5.7">1.5.7. </a><a class="section-name selfRef" href="#name-path-management">Path Management</a>
          </h4>
<p id="section-1.5.7-1">The sending SCTP user is able to manipulate the set of transport
addresses used as destinations for SCTP packets through the
primitives described in <a class="xref" href="#sec_api">Section 11</a>.
The SCTP path management function monitors reachability through heartbeats
when other packet traffic is inadequate to provide this information and advises
the SCTP user when reachability of any transport address of the peer endpoint
changes.
The path management function chooses the destination transport address
for each outgoing SCTP packet based on the SCTP user's instructions and the
currently perceived reachability status of the eligible destination set.
The path management function is also responsible for reporting the eligible
set of local transport addresses to the peer endpoint during association startup
and for reporting the transport addresses returned from the peer endpoint to the
SCTP user.<a class="pilcrow" href="#section-1.5.7-1">Â¶</a></p>
<p id="section-1.5.7-2">At association startup, a primary path is defined for each SCTP
endpoint and is used to send SCTP packets normally.<a class="pilcrow" href="#section-1.5.7-2">Â¶</a></p>
<p id="section-1.5.7-3">On the receiving end, the path management is responsible for
verifying the existence of a valid SCTP association to which the
inbound SCTP packet belongs before passing it for further processing.<a class="pilcrow" href="#section-1.5.7-3">Â¶</a></p>
<p id="section-1.5.7-4">Note: Path Management and Packet Validation are done at the same
time; although described separately above, in reality, they cannot
be performed as separate items.<a class="pilcrow" href="#section-1.5.7-4">Â¶</a></p>
</section>
</section>
<section id="section-1.6">
        <h3 id="name-serial-number-arithmetic">
<a class="section-number selfRef" href="#section-1.6">1.6. </a><a class="section-name selfRef" href="#name-serial-number-arithmetic">Serial Number Arithmetic</a>
        </h3>
<p id="section-1.6-1">It is essential to remember that the actual Transmission Sequence
Number space is finite, though very large.
This space ranges from 0 to 2<sup>32</sup> - 1.
Since the space is finite, all arithmetic dealing with Transmission Sequence
Numbers <span class="bcp14">MUST</span> be performed modulo 2<sup>32</sup>.
This unsigned arithmetic preserves the relationship of sequence numbers as
they cycle from 2<sup>32</sup> - 1 to 0 again.
There are some subtleties to computer modulo arithmetic, so great care has to
be taken in programming the comparison of such values.
When referring to TSNs, the symbol "&lt;=" means
"less than or equal" (modulo 2<sup>32</sup>).<a class="pilcrow" href="#section-1.6-1">Â¶</a></p>
<p id="section-1.6-2">Comparisons and arithmetic on TSNs in this document <span class="bcp14">SHOULD</span> use Serial
Number Arithmetic, as defined in <span>[<a class="xref" href="#RFC1982">RFC1982</a>]</span>,
where SERIAL_BITS = 32.<a class="pilcrow" href="#section-1.6-2">Â¶</a></p>
<p id="section-1.6-3">An endpoint <span class="bcp14">SHOULD NOT</span> transmit a DATA chunk with a TSN that is more
than 2<sup>31</sup> - 1 above the beginning TSN of its current send window.
Doing so will cause problems in comparing TSNs.<a class="pilcrow" href="#section-1.6-3">Â¶</a></p>
<p id="section-1.6-4">Transmission Sequence Numbers wrap around when they reach 2<sup>32</sup> - 1.
That is, the next TSN a DATA chunk <span class="bcp14">MUST</span> use after transmitting TSN =
2<sup>32</sup> - 1 is TSN = 0.<a class="pilcrow" href="#section-1.6-4">Â¶</a></p>
<p id="section-1.6-5">Any arithmetic done on Stream Sequence Numbers <span class="bcp14">SHOULD</span> use Serial
Number Arithmetic, as defined in <span>[<a class="xref" href="#RFC1982">RFC1982</a>]</span>, where SERIAL_BITS = 16.
All other arithmetic and comparisons in this document use normal
arithmetic.<a class="pilcrow" href="#section-1.6-5">Â¶</a></p>
</section>
<section id="section-1.7">
        <h3 id="name-changes-from-rfc-4960">
<a class="section-number selfRef" href="#section-1.7">1.7. </a><a class="section-name selfRef" href="#name-changes-from-rfc-4960">Changes from RFC 4960</a>
        </h3>
<p id="section-1.7-1">SCTP was originally defined in <span>[<a class="xref" href="#RFC4960">RFC4960</a>]</span>, which this document
obsoletes.
Readers interested in the details of the various changes that this document
incorporates are asked to consult <span>[<a class="xref" href="#RFC8540">RFC8540</a>]</span>.<a class="pilcrow" href="#section-1.7-1">Â¶</a></p>
<p id="section-1.7-2">In addition to these and further editorial changes, the following changes
have been incorporated in this document:<a class="pilcrow" href="#section-1.7-2">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.7-3.1">
            <p id="section-1.7-3.1.1">Update references.<a class="pilcrow" href="#section-1.7-3.1.1">Â¶</a></p>
</li>
          <li class="normal" id="section-1.7-3.2">
            <p id="section-1.7-3.2.1">Improve the language related to requirements levels.<a class="pilcrow" href="#section-1.7-3.2.1">Â¶</a></p>
</li>
          <li class="normal" id="section-1.7-3.3">
            <p id="section-1.7-3.3.1">Allow the ASSOCIATE primitive to take multiple remote addresses;
       also refer to the socket API specification.<a class="pilcrow" href="#section-1.7-3.3.1">Â¶</a></p>
</li>
          <li class="normal" id="section-1.7-3.4">
            <p id="section-1.7-3.4.1">Refer to the Packetization Layer Path MTU Discovery (PLPMTUD) specification for path MTU discovery.<a class="pilcrow" href="#section-1.7-3.4.1">Â¶</a></p>
</li>
          <li class="normal" id="section-1.7-3.5">
            <p id="section-1.7-3.5.1">Move the description of ICMP handling from the Appendix to the main
       text.<a class="pilcrow" href="#section-1.7-3.5.1">Â¶</a></p>
</li>
          <li class="normal" id="section-1.7-3.6">
            <p id="section-1.7-3.6.1">Remove the Appendix describing Explicit Congestion Notification (ECN) handling from the document.<a class="pilcrow" href="#section-1.7-3.6.1">Â¶</a></p>
</li>
          <li class="normal" id="section-1.7-3.7">
            <p id="section-1.7-3.7.1">Describe the packet size handling more precisely by introducing PMTU,
       PMDCS, and AMDCS.<a class="pilcrow" href="#section-1.7-3.7.1">Â¶</a></p>
</li>
          <li class="normal" id="section-1.7-3.8">
            <p id="section-1.7-3.8.1">Add the definition of control chunk.<a class="pilcrow" href="#section-1.7-3.8.1">Â¶</a></p>
</li>
          <li class="normal" id="section-1.7-3.9">
            <p id="section-1.7-3.9.1">Improve the description of the handling of INIT and INIT ACK chunks with
       invalid mandatory parameters.<a class="pilcrow" href="#section-1.7-3.9.1">Â¶</a></p>
</li>
          <li class="normal" id="section-1.7-3.10">
            <p id="section-1.7-3.10.1">Allow using L &gt; 1 for Appropriate Byte Counting (ABC) during
       slow start.<a class="pilcrow" href="#section-1.7-3.10.1">Â¶</a></p>
</li>
          <li class="normal" id="section-1.7-3.11">
            <p id="section-1.7-3.11.1">Explicitly describe the reinitialization of the congestion controller on
       route changes.<a class="pilcrow" href="#section-1.7-3.11.1">Â¶</a></p>
</li>
          <li class="normal" id="section-1.7-3.12">
            <p id="section-1.7-3.12.1">Improve the terminology to make it clear that this specification does not
       describe a full mesh architecture.<a class="pilcrow" href="#section-1.7-3.12.1">Â¶</a></p>
</li>
          <li class="normal" id="section-1.7-3.13">
            <p id="section-1.7-3.13.1">Improve the description of sequence number generation
       (Transmission Sequence Number and Stream Sequence Number).<a class="pilcrow" href="#section-1.7-3.13.1">Â¶</a></p>
</li>
          <li class="normal" id="section-1.7-3.14">
            <p id="section-1.7-3.14.1">Improve the description of reneging.<a class="pilcrow" href="#section-1.7-3.14.1">Â¶</a></p>
</li>
          <li class="normal" id="section-1.7-3.15">
            <p id="section-1.7-3.15.1">Don't require the change of the Cumulative TSN Ack anymore for increasing
       the congestion window.
       This improves the consistency with the handling in congestion
       avoidance.<a class="pilcrow" href="#section-1.7-3.15.1">Â¶</a></p>
</li>
          <li class="normal" id="section-1.7-3.16">
            <p id="section-1.7-3.16.1">Improve the description of the State Cookie.<a class="pilcrow" href="#section-1.7-3.16.1">Â¶</a></p>
</li>
          <li class="normal" id="section-1.7-3.17">
            <p id="section-1.7-3.17.1">Fix the API for retrieving messages in case of association failures.<a class="pilcrow" href="#section-1.7-3.17.1">Â¶</a></p>
</li>
        </ul>
</section>
</section>
<section id="section-2">
      <h2 id="name-conventions">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-conventions">Conventions</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>",
"<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>", "<span class="bcp14">MAY</span>", and
"<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as described in BCPÂ 14 <span>[<a class="xref" href="#RFC2119">RFC2119</a>]</span> <span>[<a class="xref" href="#RFC8174">RFC8174</a>]</span> when,
and only when, they appear in all capitals, as shown here.<a class="pilcrow" href="#section-2-1">Â¶</a></p>
</section>
<div id="sec_sctp_packet_format">
<section id="section-3">
      <h2 id="name-sctp-packet-format">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-sctp-packet-format">SCTP Packet Format</a>
      </h2>
<p id="section-3-1">An SCTP packet is composed of a common header and chunks.
A chunk contains either control information or user data.<a class="pilcrow" href="#section-3-1">Â¶</a></p>
<p id="section-3-2">The SCTP packet format is shown below:<a class="pilcrow" href="#section-3-2">Â¶</a></p>
<div class="alignCenter art-text artwork" id="section-3-3">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                         Common Header                         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           Chunk #1                            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                              ...                              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           Chunk #n                            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a class="pilcrow" href="#section-3-3">Â¶</a>
</div>
<p id="section-3-4">INIT, INIT ACK, and SHUTDOWN COMPLETE chunks <span class="bcp14">MUST NOT</span> be bundled
with any other chunk into an SCTP packet.
All other chunks <span class="bcp14">MAY</span> be bundled to form an SCTP packet that does not exceed
the PMTU.
See <a class="xref" href="#sec_bundling">Section 6.10</a> for more details on chunk bundling.<a class="pilcrow" href="#section-3-4">Â¶</a></p>
<p id="section-3-5">If a user data message does not fit into one SCTP packet, it can be
fragmented into multiple chunks using the procedure defined in
<a class="xref" href="#sec_frag_reass">Section 6.9</a>.<a class="pilcrow" href="#section-3-5">Â¶</a></p>
<p id="section-3-6">All integer fields in an SCTP packet <span class="bcp14">MUST</span> be transmitted in network
byte order, unless otherwise stated.<a class="pilcrow" href="#section-3-6">Â¶</a></p>
<div id="sec_sctp_common_header_field_desriptions">
<section id="section-3.1">
        <h3 id="name-sctp-common-header-field-de">
<a class="section-number selfRef" href="#section-3.1">3.1. </a><a class="section-name selfRef" href="#name-sctp-common-header-field-de">SCTP Common Header Field Descriptions</a>
        </h3>
<div class="alignCenter art-text artwork" id="section-3.1-1">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|      Source Port Number       |    Destination Port Number    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       Verification Tag                        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           Checksum                            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a class="pilcrow" href="#section-3.1-1">Â¶</a>
</div>
<span class="break"></span><dl class="dlNewline" id="section-3.1-2">
          <dt id="section-3.1-2.1">Source Port Number: 16 bits (unsigned integer)</dt>
          <dd id="section-3.1-2.2" style="margin-left: 1.5em">This is the SCTP sender's port number.
It can be used by the receiver in combination with the source IP address,
the SCTP Destination Port Number, and possibly the destination IP address to
identify the association to which this packet belongs.
The Source Port Number 0 <span class="bcp14">MUST NOT</span> be used.<a class="pilcrow" href="#section-3.1-2.2">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-2.3">Destination Port Number: 16 bits (unsigned integer)</dt>
          <dd id="section-3.1-2.4" style="margin-left: 1.5em">This is the SCTP port number to which this packet is destined.
The receiving host will use this port number to de-multiplex the
SCTP packet to the correct receiving endpoint/application.
The Destination Port Number 0 <span class="bcp14">MUST NOT</span> be used.<a class="pilcrow" href="#section-3.1-2.4">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-2.5">Verification Tag: 32 bits (unsigned integer)</dt>
          <dd id="section-3.1-2.6" style="margin-left: 1.5em">
            <p id="section-3.1-2.6.1">The receiver of an SCTP packet uses the Verification Tag to validate
the sender of this packet.
On transmit, the value of the Verification Tag <span class="bcp14">MUST</span> be set to the value of
the Initiate Tag received from the peer endpoint during the association
initialization, with the following exceptions:<a class="pilcrow" href="#section-3.1-2.6.1">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-2.6.2.1">A packet containing an INIT chunk <span class="bcp14">MUST</span> have a zero Verification Tag.<a class="pilcrow" href="#section-3.1-2.6.2.1">Â¶</a>
</li>
              <li class="normal" id="section-3.1-2.6.2.2">A packet containing a SHUTDOWN COMPLETE chunk with the T bit set <span class="bcp14">MUST</span> have
the Verification Tag copied from the packet with the SHUTDOWN ACK chunk.<a class="pilcrow" href="#section-3.1-2.6.2.2">Â¶</a>
</li>
              <li class="normal" id="section-3.1-2.6.2.3">A packet containing an ABORT chunk <span class="bcp14">MAY</span> have the Verification Tag copied
from the packet that caused the ABORT chunk to be sent.
For details, see Sections <a class="xref" href="#sec_handle_out_of_the_blue_packets">8.4</a> and
<a class="xref" href="#sec_verification_tag">8.5</a>.<a class="pilcrow" href="#section-3.1-2.6.2.3">Â¶</a>
</li>
            </ul>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-2.7">Checksum: 32 bits (unsigned integer)</dt>
          <dd id="section-3.1-2.8" style="margin-left: 1.5em">This field contains the checksum of the SCTP packet.
Its calculation is discussed in
<a class="xref" href="#sec_crc32c_checksum_calculation">Section 6.8</a>.
SCTP uses the CRC32c algorithm as described in <a class="xref" href="#sec_crc32c">Appendix A</a> for
calculating the checksum.<a class="pilcrow" href="#section-3.1-2.8">Â¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec_chunk_field_descriptions">
<section id="section-3.2">
        <h3 id="name-chunk-field-descriptions">
<a class="section-number selfRef" href="#section-3.2">3.2. </a><a class="section-name selfRef" href="#name-chunk-field-descriptions">Chunk Field Descriptions</a>
        </h3>
<p id="section-3.2-1">The figure below illustrates the field format for the chunks to be
transmitted in the SCTP packet.
Each chunk is formatted with a Chunk Type field, a Chunk Flags field,
a Chunk Length field, and a Chunk Value field.<a class="pilcrow" href="#section-3.2-1">Â¶</a></p>
<div class="alignCenter art-text artwork" id="section-3.2-2">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Chunk Type   |  Chunk Flags  |         Chunk Length          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
\                                                               \
/                          Chunk Value                          /
\                                                               \
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a class="pilcrow" href="#section-3.2-2">Â¶</a>
</div>
<span class="break"></span><dl class="dlNewline" id="section-3.2-3">
          <dt id="section-3.2-3.1">Chunk Type: 8 bits (unsigned integer)</dt>
          <dd id="section-3.2-3.2" style="margin-left: 1.5em">
            <p id="section-3.2-3.2.1">This field identifies the type of information contained in the Chunk Value
field. It takes a value from 0 to 254.
The value of 255 is reserved for future use as an extension field.<a class="pilcrow" href="#section-3.2-3.2.1">Â¶</a></p>
<p id="section-3.2-3.2.2">The values of Chunk Types defined in this document are as follows:<a class="pilcrow" href="#section-3.2-3.2.2">Â¶</a></p>
<span id="name-chunk-types"></span><table class="center" id="table-1">
              <caption>
<a class="selfRef" href="#table-1">Table 1</a>:
<a class="selfRef" href="#name-chunk-types">Chunk Types</a>
              </caption>
<thead>
                <tr>
                  <th class="text-left" colspan="1" rowspan="1">ID Value</th>
                  <th class="text-left" colspan="1" rowspan="1">Chunk Type</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">0         </td>
                  <td class="text-left" colspan="1" rowspan="1">Payload Data (DATA)                                      </td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">1         </td>
                  <td class="text-left" colspan="1" rowspan="1">Initiation (INIT)                                        </td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">2         </td>
                  <td class="text-left" colspan="1" rowspan="1">Initiation Acknowledgement (INIT ACK)                    </td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">3         </td>
                  <td class="text-left" colspan="1" rowspan="1">Selective Acknowledgement (SACK)                         </td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">4         </td>
                  <td class="text-left" colspan="1" rowspan="1">Heartbeat Request (HEARTBEAT)                            </td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">5         </td>
                  <td class="text-left" colspan="1" rowspan="1">Heartbeat Acknowledgement (HEARTBEAT ACK)                </td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">6         </td>
                  <td class="text-left" colspan="1" rowspan="1">Abort (ABORT)                                            </td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">7         </td>
                  <td class="text-left" colspan="1" rowspan="1">Shutdown (SHUTDOWN)                                      </td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">8         </td>
                  <td class="text-left" colspan="1" rowspan="1">Shutdown Acknowledgement (SHUTDOWN ACK)                  </td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">9         </td>
                  <td class="text-left" colspan="1" rowspan="1">Operation Error (ERROR)                                  </td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">10        </td>
                  <td class="text-left" colspan="1" rowspan="1">State Cookie (COOKIE ECHO)                               </td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">11        </td>
                  <td class="text-left" colspan="1" rowspan="1">Cookie Acknowledgement (COOKIE ACK)                      </td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">12        </td>
                  <td class="text-left" colspan="1" rowspan="1">Reserved for Explicit Congestion Notification Echo (ECNE)</td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">13        </td>
                  <td class="text-left" colspan="1" rowspan="1">Reserved for Congestion Window Reduced (CWR)             </td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">14        </td>
                  <td class="text-left" colspan="1" rowspan="1">Shutdown Complete (SHUTDOWN COMPLETE)                    </td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">15 to 62  </td>
                  <td class="text-left" colspan="1" rowspan="1">Unassigned                                                </td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">63        </td>
                  <td class="text-left" colspan="1" rowspan="1">Reserved for IETF-defined Chunk Extensions               </td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">64 to 126 </td>
                  <td class="text-left" colspan="1" rowspan="1">Unassigned                                                </td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">127       </td>
                  <td class="text-left" colspan="1" rowspan="1">Reserved for IETF-defined Chunk Extensions               </td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">128 to 190</td>
                  <td class="text-left" colspan="1" rowspan="1">Unassigned                                                </td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">191       </td>
                  <td class="text-left" colspan="1" rowspan="1">Reserved for IETF-defined Chunk Extensions               </td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">192 to 254</td>
                  <td class="text-left" colspan="1" rowspan="1">Unassigned                                                </td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">255       </td>
                  <td class="text-left" colspan="1" rowspan="1">Reserved for IETF-defined Chunk Extensions               </td>
                </tr>
              </tbody>
            </table>
<p id="section-3.2-3.2.4">Note: The ECNE and CWR chunk types are reserved for future use of Explicit
Congestion Notification (ECN).<a class="pilcrow" href="#section-3.2-3.2.4">Â¶</a></p>
<p id="section-3.2-3.2.5">Chunk Types are encoded such that the highest-order 2 bits specify the action
that is taken if the processing endpoint does not recognize the Chunk Type.<a class="pilcrow" href="#section-3.2-3.2.5">Â¶</a></p>
<span id="name-processing-of-unknown-chunk"></span><table class="center" id="table-2">
              <caption>
<a class="selfRef" href="#table-2">Table 2</a>:
<a class="selfRef" href="#name-processing-of-unknown-chunk">Processing of Unknown Chunks</a>
              </caption>
<tbody>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">00</td>
                  <td class="text-left" colspan="1" rowspan="1">
                    <p id="section-3.2-3.2.6.1.1.2.1">Stop processing this SCTP packet and
                   discard the unrecognized chunk and all further chunks.<a class="pilcrow" href="#section-3.2-3.2.6.1.1.2.1">Â¶</a></p>
</td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">01</td>
                  <td class="text-left" colspan="1" rowspan="1">
                    <p id="section-3.2-3.2.6.1.2.2.1">Stop processing this SCTP packet, discard the unrecognized
                   chunk and all further chunks, and report the unrecognized
                   chunk in an ERROR chunk using the 'Unrecognized Chunk Type'
                   error cause.<a class="pilcrow" href="#section-3.2-3.2.6.1.2.2.1">Â¶</a></p>
</td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">10</td>
                  <td class="text-left" colspan="1" rowspan="1">
                    <p id="section-3.2-3.2.6.1.3.2.1">Skip this chunk and continue processing.<a class="pilcrow" href="#section-3.2-3.2.6.1.3.2.1">Â¶</a></p>
</td>
                </tr>
                <tr>
                  <td class="text-left" colspan="1" rowspan="1">11</td>
                  <td class="text-left" colspan="1" rowspan="1">
                    <p id="section-3.2-3.2.6.1.4.2.1">Skip this chunk and continue processing, but report it in
                   an ERROR chunk using the 'Unrecognized Chunk Type' error
                   cause.<a class="pilcrow" href="#section-3.2-3.2.6.1.4.2.1">Â¶</a></p>
</td>
                </tr>
              </tbody>
            </table>
</dd>
          <dd class="break"></dd>
<dt id="section-3.2-3.3">Chunk Flags: 8 bits</dt>
          <dd id="section-3.2-3.4" style="margin-left: 1.5em">
            <p id="section-3.2-3.4.1">The usage of these bits depends on the Chunk Type, as given by the Chunk Type
field.
Unless otherwise specified, they are set to 0 on transmit and are ignored
on receipt.<a class="pilcrow" href="#section-3.2-3.4.1">Â¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.2-3.5">Chunk Length: 16 bits (unsigned integer)</dt>
          <dd id="section-3.2-3.6" style="margin-left: 1.5em">
            <p id="section-3.2-3.6.1">This value represents the size of the chunk in bytes, including the Chunk Type,
Chunk Flags, Chunk Length, and Chunk Value fields.
Therefore, if the Chunk Value field is zero-length, the Length field will be
set to 4.
The Chunk Length field does not count any chunk padding.
However, it does include any padding of variable-length parameters other than
the last parameter in the chunk.<a class="pilcrow" href="#section-3.2-3.6.1">Â¶</a></p>
<p id="section-3.2-3.6.2">Note: A robust implementation is expected to accept the chunk whether or not
the final padding has been included in the Chunk Length.<a class="pilcrow" href="#section-3.2-3.6.2">Â¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.2-3.7">Chunk Value: variable length</dt>
          <dd id="section-3.2-3.8" style="margin-left: 1.5em">
            <p id="section-3.2-3.8.1">The Chunk Value field contains the actual information to be transferred in the
chunk.
The usage and format of this field is dependent on the Chunk Type.<a class="pilcrow" href="#section-3.2-3.8.1">Â¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-3.2-4">The total length of a chunk (including Type, Length, and Value fields) <span class="bcp14">MUST</span>
be a multiple of 4 bytes.
If the length of the chunk is not a multiple of 4 bytes, the sender <span class="bcp14">MUST</span> pad
the chunk with all zero bytes, and this padding is not included in the
Chunk Length field.
The sender <span class="bcp14">MUST NOT</span> pad with more than 3 bytes.
The receiver <span class="bcp14">MUST</span> ignore the padding bytes.<a class="pilcrow" href="#section-3.2-4">Â¶</a></p>
<p id="section-3.2-5">SCTP-defined chunks are described in detail in
<a class="xref" href="#sec_sctp_chunk_definitions">Section 3.3</a>.
The guidelines for IETF-defined chunk extensions can be found in
<a class="xref" href="#sec_ietf_defined_chunks_extension">Section 15.1</a> of this document.<a class="pilcrow" href="#section-3.2-5">Â¶</a></p>
<div id="sec_parameter_format">
<section id="section-3.2.1">
          <h4 id="name-optional-variable-length-pa">
<a class="section-number selfRef" href="#section-3.2.1">3.2.1. </a><a class="section-name selfRef" href="#name-optional-variable-length-pa">Optional/Variable-Length Parameter Format</a>
          </h4>
<p id="section-3.2.1-1">Chunk values of SCTP control chunks consist of a chunk-type-specific
header of required fields, followed by zero or more parameters.
The optional and variable-length parameters contained in a chunk are
defined in a Type-Length-Value format, as shown below.<a class="pilcrow" href="#section-3.2.1-1">Â¶</a></p>
<div class="alignCenter art-text artwork" id="section-3.2.1-2">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        Parameter Type         |       Parameter Length        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
\                                                               \
/                        Parameter Value                        /
\                                                               \
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a class="pilcrow" href="#section-3.2.1-2">Â¶</a>
</div>
<span class="break"></span><dl class="dlNewline" id="section-3.2.1-3">
            <dt id="section-3.2.1-3.1">Parameter Type: 16 bits (unsigned integer)</dt>
            <dd id="section-3.2.1-3.2" style="margin-left: 1.5em">
              <p id="section-3.2.1-3.2.1">The Type field is a 16-bit identifier of the type of parameter.
It takes a value of 0 to 65534.<a class="pilcrow" href="#section-3.2.1-3.2.1">Â¶</a></p>
<p id="section-3.2.1-3.2.2">The value of 65535 is reserved for IETF-defined extensions.
Values other than those defined in specific SCTP chunk descriptions are
reserved for use by IETF.<a class="pilcrow" href="#section-3.2.1-3.2.2">Â¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.1-3.3">Parameter Length: 16 bits (unsigned integer)</dt>
            <dd id="section-3.2.1-3.4" style="margin-left: 1.5em">The Parameter Length field contains the size of the parameter in
bytes, including the Parameter Type, Parameter Length, and Parameter Value
fields. Thus, a parameter with a zero-length Parameter Value field would have a
Parameter Length field of 4.
The Parameter Length does not include any padding bytes.<a class="pilcrow" href="#section-3.2.1-3.4">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.1-3.5">Parameter Value: variable length</dt>
            <dd id="section-3.2.1-3.6" style="margin-left: 1.5em">
              <p id="section-3.2.1-3.6.1">The Parameter Value field contains the actual information to be transferred in
the parameter.<a class="pilcrow" href="#section-3.2.1-3.6.1">Â¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-3.2.1-4">The total length of a parameter (including Parameter Type, Parameter Length,
and Parameter Value fields) <span class="bcp14">MUST</span> be a multiple of 4 bytes.
If the length of the parameter is not a multiple of 4 bytes, the sender pads the
parameter at the end (i.e., after the Parameter Value field) with all zero
bytes.
The length of the padding is not included in the Parameter Length field.
A sender <span class="bcp14">MUST NOT</span> pad with more than 3 bytes.
The receiver <span class="bcp14">MUST</span> ignore the padding bytes.<a class="pilcrow" href="#section-3.2.1-4">Â¶</a></p>
<p id="section-3.2.1-5">The Parameter Types are encoded such that the highest-order 2 bits specify the
action that is taken if the processing endpoint does not recognize the
Parameter Type.<a class="pilcrow" href="#section-3.2.1-5">Â¶</a></p>
<span id="name-processing-of-unknown-param"></span><table class="center" id="table-3">
            <caption>
<a class="selfRef" href="#table-3">Table 3</a>:
<a class="selfRef" href="#name-processing-of-unknown-param">Processing of Unknown Parameters</a>
            </caption>
<tbody>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">00</td>
                <td class="text-left" colspan="1" rowspan="1">
                  <p id="section-3.2.1-6.1.1.2.1">Stop processing this parameter and do not process any
                   further parameters within this chunk.<a class="pilcrow" href="#section-3.2.1-6.1.1.2.1">Â¶</a></p>
</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">01</td>
                <td class="text-left" colspan="1" rowspan="1">
                  <p id="section-3.2.1-6.1.2.2.1">Stop processing this parameter, do not process any
                   further parameters within this chunk, and report the
                   unrecognized parameter, as described in
                   <a class="xref" href="#sec_reporting_of_unrecognized_parameters">Section 3.2.2</a>.<a class="pilcrow" href="#section-3.2.1-6.1.2.2.1">Â¶</a></p>
</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">10</td>
                <td class="text-left" colspan="1" rowspan="1">
                  <p id="section-3.2.1-6.1.3.2.1">Skip this parameter and continue processing.<a class="pilcrow" href="#section-3.2.1-6.1.3.2.1">Â¶</a></p>
</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">11</td>
                <td class="text-left" colspan="1" rowspan="1">
                  <p id="section-3.2.1-6.1.4.2.1">Skip this parameter and continue processing, but report
                   the unrecognized parameter, as described in
                   <a class="xref" href="#sec_reporting_of_unrecognized_parameters">Section 3.2.2</a>.<a class="pilcrow" href="#section-3.2.1-6.1.4.2.1">Â¶</a></p>
</td>
              </tr>
            </tbody>
          </table>
<p id="section-3.2.1-7">Please note that, when an INIT or INIT ACK chunk is received, in all
four cases, an INIT ACK or COOKIE ECHO chunk is sent in response, respectively.
In the 00 or 01 case, the processing of the parameters after the unknown
parameter is canceled, but no processing already done is rolled back.<a class="pilcrow" href="#section-3.2.1-7">Â¶</a></p>
<p id="section-3.2.1-8">The actual SCTP parameters are defined in the specific SCTP chunk sections.
The rules for IETF-defined parameter extensions are defined in
<a class="xref" href="#sec_ietf_defined_chunk_parameter_extension">Section 15.3</a>.
Parameter types <span class="bcp14">MUST</span> be unique across all chunks.
For example, the parameter type '5' is used to represent an IPv4 address
(see <a class="xref" href="#sec_ipv4_address_parameter">Section 3.3.2.1.1</a>).
The value '5' then is reserved across all chunks to represent an IPv4 address
and <span class="bcp14">MUST NOT</span> be reused with a different meaning in any other chunk.<a class="pilcrow" href="#section-3.2.1-8">Â¶</a></p>
</section>
</div>
<div id="sec_reporting_of_unrecognized_parameters">
<section id="section-3.2.2">
          <h4 id="name-reporting-of-unrecognized-p">
<a class="section-number selfRef" href="#section-3.2.2">3.2.2. </a><a class="section-name selfRef" href="#name-reporting-of-unrecognized-p">Reporting of Unrecognized Parameters</a>
          </h4>
<p id="section-3.2.2-1">If the receiver of an INIT chunk detects unrecognized parameters and
has to report them according to <a class="xref" href="#sec_parameter_format">Section 3.2.1</a>,
it <span class="bcp14">MUST</span> put the "Unrecognized Parameter" parameter(s) in the INIT ACK chunk
sent in response to the INIT chunk.
Note that, if the receiver of the INIT chunk is not going to establish an
association (e.g., due to lack of resources), an "Unrecognized Parameters"
error cause would not be included with any ABORT chunk being sent to the sender
of the INIT chunk.<a class="pilcrow" href="#section-3.2.2-1">Â¶</a></p>
<p id="section-3.2.2-2">If the receiver of any other chunk (e.g., INIT ACK) detects unrecognized
parameters and has to report them according to
<a class="xref" href="#sec_parameter_format">Section 3.2.1</a>, it <span class="bcp14">SHOULD</span> bundle the ERROR chunk
containing the "Unrecognized Parameters" error cause with the chunk sent
in response (e.g., COOKIE ECHO).
If the receiver of an INIT ACK chunk cannot bundle the COOKIE ECHO chunk with
the ERROR chunk, the ERROR chunk <span class="bcp14">MAY</span> be sent separately but not before the
COOKIE ACK chunk has been received.<a class="pilcrow" href="#section-3.2.2-2">Â¶</a></p>
<p id="section-3.2.2-3">Any time a COOKIE ECHO chunk is sent in a packet, it <span class="bcp14">MUST</span> be the first
chunk.<a class="pilcrow" href="#section-3.2.2-3">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec_sctp_chunk_definitions">
<section id="section-3.3">
        <h3 id="name-sctp-chunk-definitions">
<a class="section-number selfRef" href="#section-3.3">3.3. </a><a class="section-name selfRef" href="#name-sctp-chunk-definitions">SCTP Chunk Definitions</a>
        </h3>
<p id="section-3.3-1">This section defines the format of the different SCTP chunk types.<a class="pilcrow" href="#section-3.3-1">Â¶</a></p>
<div id="sec_data_chunk">
<section id="section-3.3.1">
          <h4 id="name-payload-data-data-0">
<a class="section-number selfRef" href="#section-3.3.1">3.3.1. </a><a class="section-name selfRef" href="#name-payload-data-data-0">Payload Data (DATA) (0)</a>
          </h4>
<p id="section-3.3.1-1">The following format <span class="bcp14">MUST</span> be used for the DATA chunk:<a class="pilcrow" href="#section-3.3.1-1">Â¶</a></p>
<div class="alignCenter art-text artwork" id="section-3.3.1-2">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Type = 0    |  Res  |I|U|B|E|            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                              TSN                              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|      Stream Identifier S      |   Stream Sequence Number n    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                  Payload Protocol Identifier                  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
\                                                               \
/                 User Data (seq n of Stream S)                 /
\                                                               \
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a class="pilcrow" href="#section-3.3.1-2">Â¶</a>
</div>
<span class="break"></span><dl class="dlNewline" id="section-3.3.1-3">
            <dt id="section-3.3.1-3.1">Res: 4 bits</dt>
            <dd id="section-3.3.1-3.2" style="margin-left: 1.5em">All set to 0 on transmit and ignored on receipt.<a class="pilcrow" href="#section-3.3.1-3.2">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.3.1-3.3">I bit: 1 bit</dt>
            <dd id="section-3.3.1-3.4" style="margin-left: 1.5em">The (I)mmediate bit <span class="bcp14">MAY</span> be set by the sender whenever the sender of a DATA
chunk can benefit from the corresponding SACK chunk being sent back without delay.
See <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc7053#section-4">Section 4</a> of [<a class="xref" href="#RFC7053">RFC7053</a>]</span> for a discussion of the benefits.<a class="pilcrow" href="#section-3.3.1-3.4">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.3.1-3.5">U bit: 1 bit</dt>
            <dd id="section-3.3.1-3.6" style="margin-left: 1.5em">
              <p id="section-3.3.1-3.6.1">The (U)nordered bit, if set to 1, indicates that this is an unordered
DATA chunk, and there is no Stream Sequence Number assigned to this DATA chunk.
Therefore, the receiver <span class="bcp14">MUST</span> ignore the Stream Sequence Number field.<a class="pilcrow" href="#section-3.3.1-3.6.1">Â¶</a></p>
<p id="section-3.3.1-3.6.2">After reassembly (if necessary), unordered DATA chunks <span class="bcp14">MUST</span> be dispatched to
the upper layer by the receiver without any attempt to reorder.<a class="pilcrow" href="#section-3.3.1-3.6.2">Â¶</a></p>
<p id="section-3.3.1-3.6.3">If an unordered user message is fragmented, each fragment of the message <span class="bcp14">MUST</span>
have its U bit set to 1.<a class="pilcrow" href="#section-3.3.1-3.6.3">Â¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.3.1-3.7">B bit: 1 bit</dt>
            <dd id="section-3.3.1-3.8" style="margin-left: 1.5em">The (B)eginning fragment bit, if set, indicates the first fragment of a
user message.<a class="pilcrow" href="#section-3.3.1-3.8">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.3.1-3.9">E bit: 1 bit</dt>
            <dd id="section-3.3.1-3.10" style="margin-left: 1.5em">The (E)nding fragment bit, if set, indicates the last fragment of
a user message.<a class="pilcrow" href="#section-3.3.1-3.10">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.3.1-3.11">Length: 16 bits (unsigned integer)</dt>
            <dd id="section-3.3.1-3.12" style="margin-left: 1.5em">
              <p id="section-3.3.1-3.12.1">This field indicates the length of the DATA chunk in bytes from
the beginning of the type field to the end of the User Data field
excluding any padding.
A DATA chunk with one byte of user data will have the Length field set to 17
(indicating 17 bytes).<a class="pilcrow" href="#section-3.3.1-3.12.1">Â¶</a></p>
<p id="section-3.3.1-3.12.2">A DATA chunk with a User Data field of length L will have the Length field set
to (16 + L) (indicating 16 + L bytes) where L <span class="bcp14">MUST</span> be greater than 0.<a class="pilcrow" href="#section-3.3.1-3.12.2">Â¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.3.1-3.13">TSN: 32 bits (unsigned integer)</dt>
            <dd id="section-3.3.1-3.14" style="margin-left: 1.5em">This value represents the TSN for this DATA chunk.
The valid range of TSN is from 0 to 4294967295 (2<sup>32</sup> - 1).
TSN wraps back to 0 after reaching 4294967295.<a class="pilcrow" href="#section-3.3.1-3.14">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.3.1-3.15">Stream Identifier S: 16 bits (unsigned integer)</dt>
            <dd id="section-3.3.1-3.16" style="margin-left: 1.5em">Identifies the stream to which the following user data belongs.<a class="pilcrow" href="#section-3.3.1-3.16">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.3.1-3.17">Stream Sequence Number n: 16 bits (unsigned integer)</dt>
            <dd id="section-3.3.1-3.18" style="margin-left: 1.5em">
              <p id="section-3.3.1-3.18.1">This value represents the Stream Sequence Number of the following user data
within the stream S.
Valid range is 0 to 65535.<a class="pilcrow" href="#section-3.3.1-3.18.1">Â¶</a></p>
<p id="section-3.3.1-3.18.2">When a user message is fragmented by SCTP for transport, the same
Stream Sequence Number <span class="bcp14">MUST</span> be carried in each of the fragments of the message.<a class="pilcrow" href="#section-3.3.1-3.18.2">Â¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.3.1-3.19">Payload Protocol Identifier: 32 bits (unsigned integer)</dt>
            <dd id="section-3.3.1-3.20" style="margin-left: 1.5em">
              <p id="section-3.3.1-3.20.1">This value represents an application (or upper layer) specified protocol
identifier.
This value is passed to SCTP by its upper layer and sent to its peer.
This identifier is not used by SCTP but can be used by certain network entities,
as well as by the peer application, to identify the type of information being
carried in this DATA chunk.
This field <span class="bcp14">MUST</span> be sent even in fragmented DATA chunks (to make sure it is
available for agents in the middle of the network).
Note that this field is not touched by an SCTP implementation;
the upper layer is responsible for the host to network byte order conversion of
this field.<a class="pilcrow" href="#section-3.3.1-3.20.1">Â¶</a></p>
<p id="section-3.3.1-3.20.2">The value 0 indicates that no application identifier is specified by the upper
layer for this payload data.<a class="pilcrow" href="#section-3.3.1-3.20.2">Â¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.3.1-3.21">User Data: variable length</dt>
            <dd id="section-3.3.1-3.22" style="margin-left: 1.5em">This is the payload user data.
The implementation <span class="bcp14">MUST</span> pad the end of the data to a 4-byte boundary with
all zero bytes.
Any padding <span class="bcp14">MUST NOT</span> be included in the Length field.
A sender <span class="bcp14">MUST</span> never add more than 3 bytes of padding.<a class="pilcrow" href="#section-3.3.1-3.22">Â¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-3.3.1-4">An unfragmented user message <span class="bcp14">MUST</span> have both the B and E bits set to 1.
Setting both B and E bits to 0 indicates a middle fragment of a multi-fragment
user message, as summarized in the following table:<a class="pilcrow" href="#section-3.3.1-4">Â¶</a></p>
<span id="name-fragment-description-flags"></span><div id="table_fragment_description_flags">
<table class="center" id="table-4">
            <caption>
<a class="selfRef" href="#table-4">Table 4</a>:
<a class="selfRef" href="#name-fragment-description-flags">Fragment Description Flags</a>
            </caption>
<thead>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">B</th>
                <th class="text-center" colspan="1" rowspan="1">E</th>
                <th class="text-center" colspan="1" rowspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-center" colspan="1" rowspan="1">1</td>
                <td class="text-center" colspan="1" rowspan="1">0</td>
                <td class="text-center" colspan="1" rowspan="1">First piece of a fragmented user message</td>
              </tr>
              <tr>
                <td class="text-center" colspan="1" rowspan="1">0</td>
                <td class="text-center" colspan="1" rowspan="1">0</td>
                <td class="text-center" colspan="1" rowspan="1">Middle piece of a fragmented user message</td>
              </tr>
              <tr>
                <td class="text-center" colspan="1" rowspan="1">0</td>
                <td class="text-center" colspan="1" rowspan="1">1</td>
                <td class="text-center" colspan="1" rowspan="1">Last piece of a fragmented user message</td>
              </tr>
              <tr>
                <td class="text-center" colspan="1" rowspan="1">1</td>
                <td class="text-center" colspan="1" rowspan="1">1</td>
                <td class="text-center" colspan="1" rowspan="1">Unfragmented message</td>
              </tr>
            </tbody>
          </table>
</div>
<p id="section-3.3.1-6">When a user message is fragmented into multiple chunks, the TSNs are
used by the receiver to reassemble the message. This means that the
TSNs for each fragment of a fragmented user message <span class="bcp14">MUST</span> be strictly
sequential.<a class="pilcrow" href="#section-3.3.1-6">Â¶</a></p>
<p id="section-3.3.1-7">The TSNs of DATA chunks sent <span class="bcp14">SHOULD</span> be strictly sequential.<a class="pilcrow" href="#section-3.3.1-7">Â¶</a></p>
<p id="section-3.3.1-8">Note: The extension described in <span>[<a class="xref" href="#RFC8260">RFC8260</a>]</span> can be used
to mitigate the head of line blocking when transferring large user messages.<a class="pilcrow" href="#section-3.3.1-8">Â¶</a></p>
</section>
</div>
<div id="sec_init_chunk">
<section id="section-3.3.2">
          <h4 id="name-initiation-init-1">
<a class="section-number selfRef" href="#section-3.3.2">3.3.2. </a><a class="section-name selfRef" href="#name-initiation-init-1">Initiation (INIT) (1)</a>
          </h4>
<p id="section-3.3.2-1">This chunk is used to initiate an SCTP association between two endpoints.
The format of the INIT chunk is shown below:<a class="pilcrow" href="#section-3.3.2-1">Â¶</a></p>
<div class="alignCenter art-text artwork" id="section-3.3.2-2">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Type = 1    |  Chunk Flags  |      Chunk Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                         Initiate Tag                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|          Advertised Receiver Window Credit (a_rwnd)           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Number of Outbound Streams   |   Number of Inbound Streams   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          Initial TSN                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
\                                                               \
/              Optional/Variable-Length Parameters              /
\                                                               \
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a class="pilcrow" href="#section-3.3.2-2">Â¶</a>
</div>
<p id="section-3.3.2-3">The following parameters are specified for the INIT chunk.
Unless otherwise noted, each parameter <span class="bcp14">MUST</span> only be included once in the
INIT chunk.<a class="pilcrow" href="#section-3.3.2-3">Â¶</a></p>
<span id="name-fixed-length-parameters-of-"></span><table class="center" id="table-5">
            <caption>
<a class="selfRef" href="#table-5">Table 5</a>:
<a class="selfRef" href="#name-fixed-length-parameters-of-">Fixed-Length Parameters of INIT Chunks</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" colspan="1" rowspan="1">Fixed-Length Parameter</th>
                <th class="text-left" colspan="1" rowspan="1">Status</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">Initiate Tag</td>
                <td class="text-left" colspan="1" rowspan="1">Mandatory</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">Advertised Receiver Window Credit</td>
                <td class="text-left" colspan="1" rowspan="1">Mandatory</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">Number of Outbound Streams</td>
                <td class="text-left" colspan="1" rowspan="1">Mandatory</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">Number of Inbound Streams</td>
                <td class="text-left" colspan="1" rowspan="1">Mandatory</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">Initial TSN</td>
                <td class="text-left" colspan="1" rowspan="1">Mandatory</td>
              </tr>
            </tbody>
          </table>
<span id="name-variable-length-parameters-"></span><table class="center" id="table-6">
            <caption>
<a class="selfRef" href="#table-6">Table 6</a>:
<a class="selfRef" href="#name-variable-length-parameters-">Variable-Length Parameters of INIT Chunks</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" colspan="1" rowspan="1">Variable-Length Parameter</th>
                <th class="text-left" colspan="1" rowspan="1">Status</th>
                <th class="text-left" colspan="1" rowspan="1">Type Value</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">IPv4 Address (Note 1)</td>
                <td class="text-left" colspan="1" rowspan="1">Optional</td>
                <td class="text-left" colspan="1" rowspan="1">5</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">IPv6 Address (Note 1)</td>
                <td class="text-left" colspan="1" rowspan="1">Optional</td>
                <td class="text-left" colspan="1" rowspan="1">6</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">Cookie Preservative</td>
                <td class="text-left" colspan="1" rowspan="1">Optional</td>
                <td class="text-left" colspan="1" rowspan="1">9</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">Reserved for ECN Capable (Note 2)</td>
                <td class="text-left" colspan="1" rowspan="1">Optional</td>
                <td class="text-left" colspan="1" rowspan="1">32768 (0x8000)</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">Host Name Address (Note 3)</td>
                <td class="text-left" colspan="1" rowspan="1">Deprecated</td>
                <td class="text-left" colspan="1" rowspan="1">11</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">Supported Address Types (Note 4)</td>
                <td class="text-left" colspan="1" rowspan="1">Optional</td>
                <td class="text-left" colspan="1" rowspan="1">12</td>
              </tr>
            </tbody>
          </table>
<p id="section-3.3.2-6">Note 1:
The INIT chunks can contain multiple addresses that can be IPv4 and/or IPv6
in any combination.<a class="pilcrow" href="#section-3.3.2-6">Â¶</a></p>
<p id="section-3.3.2-7">Note 2:
The ECN Capable field is reserved for future use of Explicit Congestion
Notification.<a class="pilcrow" href="#section-3.3.2-7">Â¶</a></p>
<p id="section-3.3.2-8">Note 3:
An INIT chunk <span class="bcp14">MUST NOT</span> contain the Host Name Address parameter.
The receiver of an INIT chunk containing a Host Name Address parameter <span class="bcp14">MUST</span>
send an ABORT chunk and <span class="bcp14">MAY</span> include an "Unresolvable Address" error cause.<a class="pilcrow" href="#section-3.3.2-8">Â¶</a></p>
<p id="section-3.3.2-9">Note 4:
This parameter, when present, specifies all the address types the sending
endpoint can support.
The absence of this parameter indicates that the sending endpoint can support
any address type.<a class="pilcrow" href="#section-3.3.2-9">Â¶</a></p>
<p id="section-3.3.2-10">If an INIT chunk is received with all mandatory parameters that are
specified for the INIT chunk, then the receiver <span class="bcp14">SHOULD</span> process the INIT chunk
and send back an INIT ACK.
The receiver of the INIT chunk <span class="bcp14">MAY</span> bundle an ERROR chunk with the COOKIE ACK
chunk later.
However, restrictive implementations <span class="bcp14">MAY</span> send back an ABORT chunk in response
to the INIT chunk.<a class="pilcrow" href="#section-3.3.2-10">Â¶</a></p>
<p id="section-3.3.2-11">The Chunk Flags field in INIT chunks is reserved, and all bits in it <span class="bcp14">SHOULD</span>
be set to 0 by the sender and ignored by the receiver.<a class="pilcrow" href="#section-3.3.2-11">Â¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-3.3.2-12">
            <dt id="section-3.3.2-12.1">Initiate Tag: 32 bits (unsigned integer)</dt>
            <dd id="section-3.3.2-12.2" style="margin-left: 1.5em">
              <p id="section-3.3.2-12.2.1">The receiver of the INIT chunk (the responding end) records the value of the
Initiate Tag parameter.
This value <span class="bcp14">MUST</span> be placed into the Verification Tag field of every SCTP packet
that the receiver of the INIT chunk transmits within this association.<a class="pilcrow" href="#section-3.3.2-12.2.1">Â¶</a></p>
<p id="section-3.3.2-12.2.2">The Initiate Tag is allowed to have any value except 0.
See <a class="xref" href="#sec_selection_of_tag_value">Section 5.3.1</a> for more on the selection of
the tag value.<a class="pilcrow" href="#section-3.3.2-12.2.2">Â¶</a></p>
<p id="section-3.3.2-12.2.3">If the value of the Initiate Tag in a received INIT chunk is found to be 0,
the receiver <span class="bcp14">MUST</span> silently discard the packet.<a class="pilcrow" href="#section-3.3.2-12.2.3">Â¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.3.2-12.3">Advertised Receiver Window Credit (a_rwnd): 32 bits (unsigned integer)</dt>
            <dd id="section-3.3.2-12.4" style="margin-left: 1.5em">
              <p id="section-3.3.2-12.4.1">This value represents the dedicated buffer space, in number of bytes,
the sender of the INIT chunk has reserved in association with this window.<a class="pilcrow" href="#section-3.3.2-12.4.1">Â¶</a></p>
<p id="section-3.3.2-12.4.2">The Advertised Receiver Window Credit <span class="bcp14">MUST NOT</span> be smaller than 1500.<a class="pilcrow" href="#section-3.3.2-12.4.2">Â¶</a></p>
<p id="section-3.3.2-12.4.3">A receiver of an INIT chunk with the a_rwnd value set to a value smaller than
1500 <span class="bcp14">MUST</span> discard the packet, <span class="bcp14">SHOULD</span> send a packet in response containing
an ABORT chunk and using the Initiate Tag as the Verification Tag, and <span class="bcp14">MUST NOT</span>
change the state of any existing association.<a class="pilcrow" href="#section-3.3.2-12.4.3">Â¶</a></p>
<p id="section-3.3.2-12.4.4">During the life of the association, this buffer space <span class="bcp14">SHOULD NOT</span> be reduced
(i.e., dedicated buffers ought not to be taken away from this association);
however, an endpoint <span class="bcp14">MAY</span> change the value of a_rwnd it sends in SACK chunks.<a class="pilcrow" href="#section-3.3.2-12.4.4">Â¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.3.2-12.5">Number of Outbound Streams (OS): 16 bits (unsigned integer)</dt>
            <dd id="section-3.3.2-12.6" style="margin-left: 1.5em">
              <p id="section-3.3.2-12.6.1">Defines the number of outbound streams the sender of this INIT chunk wishes
to create in this association.
The value of 0 <span class="bcp14">MUST NOT</span> be used.<a class="pilcrow" href="#section-3.3.2-12.6.1">Â¶</a></p>
<p id="section-3.3.2-12.6.2">A receiver of an INIT chunk with the OS value set to 0 <span class="bcp14">MUST</span> discard the
packet, <span class="bcp14">SHOULD</span> send a packet in response containing an ABORT chunk and using
the Initiate Tag as the Verification Tag, and <span class="bcp14">MUST NOT</span> change the state of any
existing association.<a class="pilcrow" href="#section-3.3.2-12.6.2">Â¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.3.2-12.7">Number of Inbound Streams (MIS): 16 bits (unsigned integer)</dt>
            <dd id="section-3.3.2-12.8" style="margin-left: 1.5em">
              <p id="section-3.3.2-12.8.1">Defines the maximum number of streams the sender of this INIT chunk allows
the peer end to create in this association.
The value 0 <span class="bcp14">MUST NOT</span> be used.<a class="pilcrow" href="#section-3.3.2-12.8.1">Â¶</a></p>
<p id="section-3.3.2-12.8.2">Note: There is no negotiation of the actual number of streams; instead, the
two endpoints will use the min(requested, offered).
See <a class="xref" href="#sec_handle_stream_parameters">Section 5.1.1</a> for details.<a class="pilcrow" href="#section-3.3.2-12.8.2">Â¶</a></p>
<p id="section-3.3.2-12.8.3">A receiver of an INIT chunk with the MIS value set to 0 <span class="bcp14">MUST</span> discard the
packet, <span class="bcp14">SHOULD</span> send a packet in response containing an ABORT chunk and using
the Initiate Tag as the Verification Tag, and <span class="bcp14">MUST NOT</span> change the state of any
existing association.<a class="pilcrow" href="#section-3.3.2-12.8.3">Â¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.3.2-12.9">Initial TSN (I-TSN): 32 bits (unsigned integer)</dt>
            <dd id="section-3.3.2-12.10" style="margin-left: 1.5em">Defines the TSN that the sender of the INIT chunk will use initially.
The valid range is from 0 to 4294967295 and the Initial TSN <span class="bcp14">SHOULD</span> be set to a
random value in that range.
The methods described in <span>[<a class="xref" href="#RFC4086">RFC4086</a>]</span> can be used for the
Initial TSN randomization.<a class="pilcrow" href="#section-3.3.2-12.10">Â¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<div id="sec_optional_variable_length_parameters_in_init">
<section id="section-3.3.2.1">
            <h5 id="name-optional-or-variable-length">
<a class="section-number selfRef" href="#section-3.3.2.1">3.3.2.1. </a><a class="section-name selfRef" href="#name-optional-or-variable-length">Optional or Variable-Length Parameters in INIT chunks</a>
            </h5>
<p id="section-3.3.2.1-1">The following parameters follow the Type-Length-Value format as defined in
<a class="xref" href="#sec_parameter_format">Section 3.2.1</a>.
Any Type-Length-Value fields <span class="bcp14">MUST</span> be placed after the fixed-length fields.
(The fixed-length fields are defined in the previous section.)<a class="pilcrow" href="#section-3.3.2.1-1">Â¶</a></p>
<div id="sec_ipv4_address_parameter">
<section id="section-3.3.2.1.1">
              <h6 id="name-ipv4-address-5">
<a class="section-number selfRef" href="#section-3.3.2.1.1">3.3.2.1.1. </a><a class="section-name selfRef" href="#name-ipv4-address-5">IPv4 Address (5)</a>
              </h6>
<div class="alignCenter art-text artwork" id="section-3.3.2.1.1-1">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|           Type = 5            |          Length = 8           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                         IPv4 Address                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a class="pilcrow" href="#section-3.3.2.1.1-1">Â¶</a>
</div>
<span class="break"></span><dl class="dlNewline" id="section-3.3.2.1.1-2">
                <dt id="section-3.3.2.1.1-2.1">IPv4 Address: 32 bits (unsigned integer)</dt>
                <dd id="section-3.3.2.1.1-2.2" style="margin-left: 1.5em">Contains an IPv4 address of the sending endpoint.
It is binary encoded.<a class="pilcrow" href="#section-3.3.2.1.1-2.2">Â¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec_ipv6_address_parameter">
<section id="section-3.3.2.1.2">
              <h6 id="name-ipv6-address-6">
<a class="section-number selfRef" href="#section-3.3.2.1.2">3.3.2.1.2. </a><a class="section-name selfRef" href="#name-ipv6-address-6">IPv6 Address (6)</a>
              </h6>
<div class="alignCenter art-text artwork" id="section-3.3.2.1.2-1">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|           Type = 6            |          Length = 20          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
|                         IPv6 Address                          |
|                                                               |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a class="pilcrow" href="#section-3.3.2.1.2-1">Â¶</a>
</div>
<span class="break"></span><dl class="dlNewline" id="section-3.3.2.1.2-2">
                <dt id="section-3.3.2.1.2-2.1">IPv6 Address: 128 bits (unsigned integer)</dt>
                <dd id="section-3.3.2.1.2-2.2" style="margin-left: 1.5em">
                  <p id="section-3.3.2.1.2-2.2.1">Contains an IPv6 <span>[<a class="xref" href="#RFC8200">RFC8200</a>]</span> address of the sending endpoint.
It is binary encoded.<a class="pilcrow" href="#section-3.3.2.1.2-2.2.1">Â¶</a></p>
<p id="section-3.3.2.1.2-2.2.2">A sender <span class="bcp14">MUST NOT</span> use an IPv4-mapped IPv6 address <span>[<a class="xref" href="#RFC4291">RFC4291</a>]</span>
but <span class="bcp14">SHOULD</span> instead use an IPv4 Address parameter for an IPv4 address.<a class="pilcrow" href="#section-3.3.2.1.2-2.2.2">Â¶</a></p>
</dd>
              <dd class="break"></dd>
</dl>
<p id="section-3.3.2.1.2-3">Combined with the Source Port Number in the SCTP common header, the value
passed in an IPv4 or IPv6 Address parameter indicates a transport address the
sender of the INIT chunk will support for the association being initiated.
That is, during the life time of this association, this IP address can appear
in the source address field of an IP datagram sent from the sender of the INIT
chunk and can be used as a destination address of an IP datagram sent from the
receiver of the INIT chunk.<a class="pilcrow" href="#section-3.3.2.1.2-3">Â¶</a></p>
<p id="section-3.3.2.1.2-4">More than one IP Address parameter can be included in an INIT chunk when the
sender of the INIT chunk is multi-homed.
Moreover, a multi-homed endpoint might have access to different types of network;
thus, more than one address type can be present in one INIT chunk, i.e.,
IPv4 and IPv6 addresses are allowed in the same INIT chunk.<a class="pilcrow" href="#section-3.3.2.1.2-4">Â¶</a></p>
<p id="section-3.3.2.1.2-5">If the INIT chunk contains at least one IP Address parameter, then the
source address of the IP datagram containing the INIT chunk and any additional
address(es) provided within the INIT can be used as destinations by the endpoint
receiving the INIT chunk.
If the INIT chunk does not contain any IP Address parameters, the endpoint
receiving the INIT chunk <span class="bcp14">MUST</span> use the source address associated with the
received IP datagram as its sole destination address for the association.<a class="pilcrow" href="#section-3.3.2.1.2-5">Â¶</a></p>
<p id="section-3.3.2.1.2-6">Note that not using any IP Address parameters in the INIT and INIT ACK chunk
is a way to make an association more likely to work in combination with Network
Address Translation (NAT).<a class="pilcrow" href="#section-3.3.2.1.2-6">Â¶</a></p>
</section>
</div>
<section id="section-3.3.2.1.3">
              <h6 id="name-cookie-preservative-9">
<a class="section-number selfRef" href="#section-3.3.2.1.3">3.3.2.1.3. </a><a class="section-name selfRef" href="#name-cookie-preservative-9">Cookie Preservative (9)</a>
              </h6>
<p id="section-3.3.2.1.3-1">The sender of the INIT chunk uses this parameter to suggest to the
receiver of the INIT chunk a longer life span for the State Cookie.<a class="pilcrow" href="#section-3.3.2.1.3-1">Â¶</a></p>
<div class="alignCenter art-text artwork" id="section-3.3.2.1.3-2">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|           Type = 9            |          Length = 8           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|         Suggested Cookie Life-Span Increment (msec.)          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a class="pilcrow" href="#section-3.3.2.1.3-2">Â¶</a>
</div>
<span class="break"></span><dl class="dlNewline" id="section-3.3.2.1.3-3">
                <dt id="section-3.3.2.1.3-3.1">Suggested Cookie Life-Span Increment: 32 bits (unsigned integer)</dt>
                <dd id="section-3.3.2.1.3-3.2" style="margin-left: 1.5em">
                  <p id="section-3.3.2.1.3-3.2.1">This parameter indicates to the receiver how much increment in milliseconds
the sender wishes the receiver to add to its default cookie life span.<a class="pilcrow" href="#section-3.3.2.1.3-3.2.1">Â¶</a></p>
<p id="section-3.3.2.1.3-3.2.2">This optional parameter <span class="bcp14">MAY</span> be added to the INIT chunk by the sender when
it reattempts establishing an association with a peer to which its previous
attempt of establishing the association failed due to a stale cookie operation
error.
The receiver <span class="bcp14">MAY</span> choose to ignore the suggested cookie life span increase for
its own security reasons.<a class="pilcrow" href="#section-3.3.2.1.3-3.2.2">Â¶</a></p>
</dd>
              <dd class="break"></dd>
</dl>
</section>
<div id="sec_host_name_address_parameter">
<section id="section-3.3.2.1.4">
              <h6 id="name-host-name-address-11">
<a class="section-number selfRef" href="#section-3.3.2.1.4">3.3.2.1.4. </a><a class="section-name selfRef" href="#name-host-name-address-11">Host Name Address (11)</a>
              </h6>
<p id="section-3.3.2.1.4-1">The sender of an INIT chunk or INIT ACK chunk <span class="bcp14">MUST NOT</span> include this parameter.
The usage of the Host Name Address parameter is deprecated.
The receiver of an INIT chunk or an INIT ACK containing a Host Name Address
parameter <span class="bcp14">MUST</span> send an ABORT chunk and <span class="bcp14">MAY</span> include an "Unresolvable Address"
error cause.<a class="pilcrow" href="#section-3.3.2.1.4-1">Â¶</a></p>
<div class="alignCenter art-text artwork" id="section-3.3.2.1.4-2">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|           Type = 11           |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
/                           Host Name                           /
\                                                               \
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a class="pilcrow" href="#section-3.3.2.1.4-2">Â¶</a>
</div>
<span class="break"></span><dl class="dlNewline" id="section-3.3.2.1.4-3">
                <dt id="section-3.3.2.1.4-3.1">Host Name: variable length</dt>
                <dd id="section-3.3.2.1.4-3.2" style="margin-left: 1.5em">
                  <p id="section-3.3.2.1.4-3.2.1">This field contains a host name in "host name syntax" per <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc1123#section-2.1">Section 2.1</a> of [<a class="xref" href="#RFC1123">RFC1123</a>]</span>.
The method for resolving the host name is out of scope of SCTP.<a class="pilcrow" href="#section-3.3.2.1.4-3.2.1">Â¶</a></p>
<p id="section-3.3.2.1.4-3.2.2">At least one null terminator is included in the Host Name string and <span class="bcp14">MUST</span> be
included in the length.<a class="pilcrow" href="#section-3.3.2.1.4-3.2.2">Â¶</a></p>
</dd>
              <dd class="break"></dd>
</dl>
</section>
</div>
<section id="section-3.3.2.1.5">
              <h6 id="name-supported-address-types-12">
<a class="section-number selfRef" href="#section-3.3.2.1.5">3.3.2.1.5. </a><a class="section-name selfRef" href="#name-supported-address-types-12">Supported Address Types (12)</a>
              </h6>
<p id="section-3.3.2.1.5-1">The sender of the INIT chunk uses this parameter to list all the address types
it can support.<a class="pilcrow" href="#section-3.3.2.1.5-1">Â¶</a></p>
<div class="alignCenter art-text artwork" id="section-3.3.2.1.5-2">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|           Type = 12           |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        Address Type #1        |        Address Type #2        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                            ......                             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-++-+-+-+-+-+-+-+-+-+-+-+-+-+-++-+-+-+
</pre><a class="pilcrow" href="#section-3.3.2.1.5-2">Â¶</a>
</div>
<span class="break"></span><dl class="dlNewline" id="section-3.3.2.1.5-3">
                <dt id="section-3.3.2.1.5-3.1">Address Type: 16 bits (unsigned integer)</dt>
                <dd id="section-3.3.2.1.5-3.2" style="margin-left: 1.5em">This is filled with the type value of the corresponding address
TLV (e.g., 5 for indicating IPv4, and 6 for indicating IPv6).
The value indicating the Host Name Address parameter <span class="bcp14">MUST NOT</span> be used
when sending this parameter and <span class="bcp14">MUST</span> be ignored when receiving this
parameter.<a class="pilcrow" href="#section-3.3.2.1.5-3.2">Â¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</section>
</section>
</div>
</section>
</div>
<div id="sec_init_ack_chunk">
<section id="section-3.3.3">
          <h4 id="name-initiation-acknowledgement-">
<a class="section-number selfRef" href="#section-3.3.3">3.3.3. </a><a class="section-name selfRef" href="#name-initiation-acknowledgement-">Initiation Acknowledgement (INIT ACK) (2)</a>
          </h4>
<p id="section-3.3.3-1">The INIT ACK chunk is used to acknowledge the initiation of an SCTP
association.
The format of the INIT ACK chunk is shown below:<a class="pilcrow" href="#section-3.3.3-1">Â¶</a></p>
<div class="alignCenter art-text artwork" id="section-3.3.3-2">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Type = 2    |  Chunk Flags  |         Chunk Length          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                         Initiate Tag                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|               Advertised Receiver Window Credit               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Number of Outbound Streams   |   Number of Inbound Streams   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          Initial TSN                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
\                                                               \
/              Optional/Variable-Length Parameters              /
\                                                               \
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a class="pilcrow" href="#section-3.3.3-2">Â¶</a>
</div>
<p id="section-3.3.3-3">The parameter part of INIT ACK is formatted similarly to the INIT chunk.
The following parameters are specified for the INIT ACK chunk:<a class="pilcrow" href="#section-3.3.3-3">Â¶</a></p>
<span id="name-fixed-length-parameters-of-i"></span><table class="center" id="table-7">
            <caption>
<a class="selfRef" href="#table-7">Table 7</a>:
<a class="selfRef" href="#name-fixed-length-parameters-of-i">Fixed-Length Parameters of INIT ACK Chunks</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" colspan="1" rowspan="1">Fixed-Length Parameter</th>
                <th class="text-left" colspan="1" rowspan="1">Status</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">Initiate Tag</td>
                <td class="text-left" colspan="1" rowspan="1">Mandatory</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">Advertised Receiver Window Credit</td>
                <td class="text-left" colspan="1" rowspan="1">Mandatory</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">Number of Outbound Streams</td>
                <td class="text-left" colspan="1" rowspan="1">Mandatory</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">Number of Inbound Streams</td>
                <td class="text-left" colspan="1" rowspan="1">Mandatory</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">Initial TSN</td>
                <td class="text-left" colspan="1" rowspan="1">Mandatory</td>
              </tr>
            </tbody>
          </table>
<p id="section-3.3.3-5">It uses two extra variable parameters: the State Cookie and the Unrecognized
Parameter.<a class="pilcrow" href="#section-3.3.3-5">Â¶</a></p>
<span id="name-variable-length-parameters-o"></span><table class="center" id="table-8">
            <caption>
<a class="selfRef" href="#table-8">Table 8</a>:
<a class="selfRef" href="#name-variable-length-parameters-o">Variable-Length Parameters of INIT ACK Chunks</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" colspan="1" rowspan="1">Variable-Length Parameter</th>
                <th class="text-left" colspan="1" rowspan="1">Status</th>
                <th class="text-left" colspan="1" rowspan="1">Type Value</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">State Cookie</td>
                <td class="text-left" colspan="1" rowspan="1">Mandatory</td>
                <td class="text-left" colspan="1" rowspan="1">7</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">IPv4 Address (Note 1)</td>
                <td class="text-left" colspan="1" rowspan="1">Optional</td>
                <td class="text-left" colspan="1" rowspan="1">5</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">IPv6 Address (Note 1)</td>
                <td class="text-left" colspan="1" rowspan="1">Optional</td>
                <td class="text-left" colspan="1" rowspan="1">6</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">Unrecognized Parameter</td>
                <td class="text-left" colspan="1" rowspan="1">Optional</td>
                <td class="text-left" colspan="1" rowspan="1">8</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">Reserved for ECN Capable (Note 2)</td>
                <td class="text-left" colspan="1" rowspan="1">Optional</td>
                <td class="text-left" colspan="1" rowspan="1">32768 (0x8000)</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">Host Name Address (Note 3)</td>
                <td class="text-left" colspan="1" rowspan="1">Deprecated</td>
                <td class="text-left" colspan="1" rowspan="1">11</td>
              </tr>
            </tbody>
          </table>
<p id="section-3.3.3-7">Note 1:
The INIT ACK chunks can contain any number of IP Address parameters that
can be IPv4 and/or IPv6 in any combination.<a class="pilcrow" href="#section-3.3.3-7">Â¶</a></p>
<p id="section-3.3.3-8">Note 2:
The ECN Capable field is reserved for future use of Explicit Congestion
Notification.<a class="pilcrow" href="#section-3.3.3-8">Â¶</a></p>
<p id="section-3.3.3-9">Note 3:
An INIT ACK chunk <span class="bcp14">MUST NOT</span> contain the Host Name Address parameter.
The receiver of INIT ACK chunks containing a Host Name Address parameter
<span class="bcp14">MUST</span> send an ABORT chunk and <span class="bcp14">MAY</span> include an "Unresolvable Address" error cause.<a class="pilcrow" href="#section-3.3.3-9">Â¶</a></p>
<p id="section-3.3.3-10">The Chunk Flags field in INIT ACK chunks is reserved, and all bits in it
<span class="bcp14">SHOULD</span> be set to 0 by the sender and ignored by the receiver.<a class="pilcrow" href="#section-3.3.3-10">Â¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-3.3.3-11">
            <dt id="section-3.3.3-11.1">Initiate Tag: 32 bits (unsigned integer)</dt>
            <dd id="section-3.3.3-11.2" style="margin-left: 1.5em">
              <p id="section-3.3.3-11.2.1">The receiver of the INIT ACK chunk records the value of the Initiate Tag
parameter.
This value <span class="bcp14">MUST</span> be placed into the Verification Tag field of every SCTP packet
that the receiver of the INIT ACK chunk transmits within this association.<a class="pilcrow" href="#section-3.3.3-11.2.1">Â¶</a></p>
<p id="section-3.3.3-11.2.2">The Initiate Tag <span class="bcp14">MUST NOT</span> take the value 0.
See <a class="xref" href="#sec_selection_of_tag_value">Section 5.3.1</a> for more on the selection of
the Initiate Tag value.<a class="pilcrow" href="#section-3.3.3-11.2.2">Â¶</a></p>
<p id="section-3.3.3-11.2.3">If an endpoint in the COOKIE-WAIT state receives an INIT ACK chunk with the
Initiate Tag set to 0, it <span class="bcp14">MUST</span> destroy the TCB and <span class="bcp14">SHOULD</span> send an ABORT chunk
with the T bit set.
If such an INIT ACK chunk is received in any state other than CLOSED or
COOKIE-WAIT, it <span class="bcp14">SHOULD</span> be discarded silently
(see <a class="xref" href="#sec_unexpected_init_ack">Section 5.2.3</a>).<a class="pilcrow" href="#section-3.3.3-11.2.3">Â¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.3.3-11.3">Advertised Receiver Window Credit (a_rwnd): 32 bits (unsigned integer)</dt>
            <dd id="section-3.3.3-11.4" style="margin-left: 1.5em">
              <p id="section-3.3.3-11.4.1">This value represents the dedicated buffer space, in number of bytes, the
sender of the INIT ACK chunk has reserved in association with this window.<a class="pilcrow" href="#section-3.3.3-11.4.1">Â¶</a></p>
<p id="section-3.3.3-11.4.2">The Advertised Receiver Window Credit <span class="bcp14">MUST NOT</span> be smaller than 1500.<a class="pilcrow" href="#section-3.3.3-11.4.2">Â¶</a></p>
<p id="section-3.3.3-11.4.3">A receiver of an INIT ACK chunk with the a_rwnd value set to a value smaller
than 1500 <span class="bcp14">MUST</span> discard the packet, <span class="bcp14">SHOULD</span> send a packet in response
containing an ABORT chunk and using the Initiate Tag as the Verification Tag,
and <span class="bcp14">MUST NOT</span> change the state of any existing association.<a class="pilcrow" href="#section-3.3.3-11.4.3">Â¶</a></p>
<p id="section-3.3.3-11.4.4">During the life of the association, this buffer space <span class="bcp14">SHOULD NOT</span> be reduced
(i.e., dedicated buffers ought not to be taken away from this association);
however, an endpoint <span class="bcp14">MAY</span> change the value of a_rwnd it sends in SACK chunks.<a class="pilcrow" href="#section-3.3.3-11.4.4">Â¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.3.3-11.5">Number of Outbound Streams (OS): 16 bits (unsigned integer)</dt>
            <dd id="section-3.3.3-11.6" style="margin-left: 1.5em">
              <p id="section-3.3.3-11.6.1">Defines the number of outbound streams the sender of this INIT ACK chunk
wishes to create in this association.
The value of 0 <span class="bcp14">MUST NOT</span> be used, and the value <span class="bcp14">MUST NOT</span> be greater than the
MIS value sent in the INIT chunk.<a class="pilcrow" href="#section-3.3.3-11.6.1">Â¶</a></p>
<p id="section-3.3.3-11.6.2">If an endpoint in the COOKIE-WAIT state receives an INIT ACK chunk with the
OS value set to 0, it <span class="bcp14">MUST</span> destroy the TCB and <span class="bcp14">SHOULD</span> send an ABORT chunk.
If such an INIT ACK chunk is received in any state other than CLOSED or
COOKIE-WAIT, it <span class="bcp14">SHOULD</span> be discarded silently
(see <a class="xref" href="#sec_unexpected_init_ack">Section 5.2.3</a>).<a class="pilcrow" href="#section-3.3.3-11.6.2">Â¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.3.3-11.7">Number of Inbound Streams (MIS): 16 bits (unsigned integer)</dt>
            <dd id="section-3.3.3-11.8" style="margin-left: 1.5em">
              <p id="section-3.3.3-11.8.1">Defines the maximum number of streams the sender of this INIT ACK chunk
allows the peer end to create in this association.
The value 0 <span class="bcp14">MUST NOT</span> be used.<a class="pilcrow" href="#section-3.3.3-11.8.1">Â¶</a></p>
<p id="section-3.3.3-11.8.2">Note:
There is no negotiation of the actual number of streams, but instead the two
endpoints will use the min(requested, offered).
See <a class="xref" href="#sec_handle_stream_parameters">Section 5.1.1</a> for details.<a class="pilcrow" href="#section-3.3.3-11.8.2">Â¶</a></p>
<p id="section-3.3.3-11.8.3">If an endpoint in the COOKIE-WAIT state receives an INIT ACK chunk with the
MIS value set to 0, it <span class="bcp14">MUST</span> destroy the TCB and <span class="bcp14">SHOULD</span> send an ABORT chunk.
If such an INIT ACK chunk is received in any state other than CLOSED or
COOKIE-WAIT, it <span class="bcp14">SHOULD</span> be discarded silently
(see <a class="xref" href="#sec_unexpected_init_ack">Section 5.2.3</a>).<a class="pilcrow" href="#section-3.3.3-11.8.3">Â¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.3.3-11.9">Initial TSN (I-TSN): 32 bits (unsigned integer)</dt>
            <dd id="section-3.3.3-11.10" style="margin-left: 1.5em">Defines the TSN that the sender of the INIT ACK chunk will use initially.
The valid range is from 0 to 4294967295 and the Initial TSN <span class="bcp14">SHOULD</span> be set to a
random value in that range.
The methods described in <span>[<a class="xref" href="#RFC4086">RFC4086</a>]</span> can be used for the
Initial TSN randomization.<a class="pilcrow" href="#section-3.3.3-11.10">Â¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-3.3.3-12">Implementation Note:
An implementation <span class="bcp14">MUST</span> be prepared to receive an INIT ACK chunk that is quite
large (more than 1500 bytes) due to the variable size of the State Cookie and
the variable address list.
For example, if a responder to the INIT chunk has 1000 IPv4 addresses it wishes
to send, it would need at least 8,000 bytes to encode this in the
INIT ACK chunk.<a class="pilcrow" href="#section-3.3.3-12">Â¶</a></p>
<p id="section-3.3.3-13">If an INIT ACK chunk is received with all mandatory parameters that are
specified for the INIT ACK chunk, then the receiver <span class="bcp14">SHOULD</span> process the
INIT ACK chunk and send back a COOKIE ECHO chunk.
The receiver of the INIT ACK chunk <span class="bcp14">MAY</span> bundle an ERROR chunk with the
COOKIE ECHO chunk.
However, restrictive implementations <span class="bcp14">MAY</span> send back an ABORT chunk in
response to the INIT ACK chunk.<a class="pilcrow" href="#section-3.3.3-13">Â¶</a></p>
<p id="section-3.3.3-14">In combination with the Source Port Number carried in the SCTP common header,
each IP Address parameter in the INIT ACK chunk indicates to the receiver of
the INIT ACK chunk a valid transport address supported by the sender of the
INIT ACK chunk for the life time of the association being initiated.<a class="pilcrow" href="#section-3.3.3-14">Â¶</a></p>
<p id="section-3.3.3-15">If the INIT ACK chunk contains at least one IP Address parameter, then the
source address of the IP datagram containing the INIT ACK chunk and any
additional address(es) provided within the INIT ACK chunk <span class="bcp14">MAY</span> be used as
destinations by the receiver of the INIT ACK chunk.
If the INIT ACK chunk does not contain any IP Address parameters, the receiver
of the INIT ACK chunk <span class="bcp14">MUST</span> use the source address associated with the received
IP datagram as its sole destination address for the association.<a class="pilcrow" href="#section-3.3.3-15">Â¶</a></p>
<p id="section-3.3.3-16">The State Cookie and Unrecognized Parameters use the Type-Length-Value format
as defined in <a class="xref" href="#sec_parameter_format">Section 3.2.1</a> and are described below.
The other fields are defined in the same way as their counterparts in the
INIT chunk.<a class="pilcrow" href="#section-3.3.3-16">Â¶</a></p>
<div id="sec_optional_variable_length_parameters_in_init_ack">
<section id="section-3.3.3.1">
            <h5 id="name-optional-or-variable-length-">
<a class="section-number selfRef" href="#section-3.3.3.1">3.3.3.1. </a><a class="section-name selfRef" href="#name-optional-or-variable-length-">Optional or Variable-Length Parameters in INIT ACK Chunks</a>
            </h5>
<p id="section-3.3.3.1-1">The State Cookie and Unrecognized Parameters use the Type-Length-Value format,
as defined in <a class="xref" href="#sec_parameter_format">Section 3.2.1</a>, and are described below.
The IPv4 Address parameter is described in <a class="xref" href="#sec_ipv4_address_parameter">Section 3.3.2.1.1</a>, and
the IPv6 Address parameter is described in <a class="xref" href="#sec_ipv6_address_parameter">Section 3.3.2.1.2</a>.
The Host Name Address parameter is described in <a class="xref" href="#sec_host_name_address_parameter">Section 3.3.2.1.4</a>
and <span class="bcp14">MUST NOT</span> be included in an INIT ACK chunk.
Any Type-Length-Value fields <span class="bcp14">MUST</span> be placed after the fixed-length fields.
(The fixed-length fields are defined in the previous section.)<a class="pilcrow" href="#section-3.3.3.1-1">Â¶</a></p>
<section id="section-3.3.3.1.1">
              <h6 id="name-state-cookie-7">
<a class="section-number selfRef" href="#section-3.3.3.1.1">3.3.3.1.1. </a><a class="section-name selfRef" href="#name-state-cookie-7">State Cookie (7)</a>
              </h6>
<div class="alignCenter art-text artwork" id="section-3.3.3.1.1-1">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|           Type = 7            |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
/                            Cookie                             /
\                                                               \
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a class="pilcrow" href="#section-3.3.3.1.1-1">Â¶</a>
</div>
<span class="break"></span><dl class="dlNewline" id="section-3.3.3.1.1-2">
                <dt id="section-3.3.3.1.1-2.1">Cookie: variable length</dt>
                <dd id="section-3.3.3.1.1-2.2" style="margin-left: 1.5em">This parameter value <span class="bcp14">MUST</span> contain all the necessary state and parameter
information required for the sender of this INIT ACK chunk to create the
association, along with a Message Authentication Code (MAC).
See <a class="xref" href="#sec_generating_state_cookie">Section 5.1.3</a> for details on
State Cookie definition.<a class="pilcrow" href="#section-3.3.3.1.1-2.2">Â¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</section>
<section id="section-3.3.3.1.2">
              <h6 id="name-unrecognized-parameter-8">
<a class="section-number selfRef" href="#section-3.3.3.1.2">3.3.3.1.2. </a><a class="section-name selfRef" href="#name-unrecognized-parameter-8">Unrecognized Parameter (8)</a>
              </h6>
<p id="section-3.3.3.1.2-1">This parameter is returned to the originator of the INIT chunk when the INIT
chunk contains an unrecognized parameter that has a type that indicates it
<span class="bcp14">SHOULD</span> be reported to the sender.<a class="pilcrow" href="#section-3.3.3.1.2-1">Â¶</a></p>
<div class="alignCenter art-text artwork" id="section-3.3.3.1.2-2">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|           Type = 8            |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
/                    Unrecognized Parameter                     /
\                                                               \
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a class="pilcrow" href="#section-3.3.3.1.2-2">Â¶</a>
</div>
<span class="break"></span><dl class="dlNewline" id="section-3.3.3.1.2-3">
                <dt id="section-3.3.3.1.2-3.1">Unrecognized Parameter: variable length</dt>
                <dd id="section-3.3.3.1.2-3.2" style="margin-left: 1.5em">The Parameter Value field will contain an unrecognized parameter copied from
the INIT chunk complete with Parameter Type, Length, and Value fields.<a class="pilcrow" href="#section-3.3.3.1.2-3.2">Â¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</section>
</section>
</div>
</section>
</div>
<div id="sec_sack_chunk">
<section id="section-3.3.4">
          <h4 id="name-selective-acknowledgement-s">
<a class="section-number selfRef" href="#section-3.3.4">3.3.4. </a><a class="section-name selfRef" href="#name-selective-acknowledgement-s">Selective Acknowledgement (SACK) (3)</a>
          </h4>
<p id="section-3.3.4-1">This chunk is sent to the peer endpoint to acknowledge received DATA chunks
and to inform the peer endpoint of gaps in the received subsequences of DATA
chunks as represented by their TSNs.<a class="pilcrow" href="#section-3.3.4-1">Â¶</a></p>
<p id="section-3.3.4-2">The SACK chunk <span class="bcp14">MUST</span> contain the Cumulative TSN Ack, Advertised Receiver
Window Credit (a_rwnd), Number of Gap Ack Blocks, and Number of Duplicate TSNs
fields.<a class="pilcrow" href="#section-3.3.4-2">Â¶</a></p>
<p id="section-3.3.4-3">By definition, the value of the Cumulative TSN Ack parameter is the
last TSN received before a break in the sequence of received TSNs
occurs;
the next TSN value following this one has not yet been received at the endpoint
sending the SACK chunk.
This parameter therefore acknowledges receipt of all TSNs less than or equal to
its value.<a class="pilcrow" href="#section-3.3.4-3">Â¶</a></p>
<p id="section-3.3.4-4">The handling of a_rwnd by the receiver of the SACK chunk is discussed in
detail in <a class="xref" href="#sec_processing_of_received_sack">Section 6.2.1</a>.<a class="pilcrow" href="#section-3.3.4-4">Â¶</a></p>
<p id="section-3.3.4-5">The SACK chunk also contains zero or more Gap Ack Blocks.
Each Gap Ack Block acknowledges a subsequence of TSNs received following a break
in the sequence of received TSNs.
The Gap Ack Blocks <span class="bcp14">SHOULD</span> be isolated.
This means that the TSN just before each Gap Ack Block and the TSN just after
each Gap Ack Block have not been received.
By definition, all TSNs acknowledged by Gap Ack Blocks are greater than the
value of the Cumulative TSN Ack.<a class="pilcrow" href="#section-3.3.4-5">Â¶</a></p>
<div class="alignCenter art-text artwork" id="section-3.3.4-6">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Type = 3    |  Chunk Flags  |         Chunk Length          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                      Cumulative TSN Ack                       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|          Advertised Receiver Window Credit (a_rwnd)           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Number of Gap Ack Blocks = N  |  Number of Duplicate TSNs = M |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|    Gap Ack Block #1 Start     |     Gap Ack Block #1 End      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
/                                                               /
\                              ...                              \
/                                                               /
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|    Gap Ack Block #N Start     |     Gap Ack Block #N End      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                        Duplicate TSN 1                        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
/                                                               /
\                              ...                              \
/                                                               /
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                        Duplicate TSN M                        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a class="pilcrow" href="#section-3.3.4-6">Â¶</a>
</div>
<span class="break"></span><dl class="dlNewline" id="section-3.3.4-7">
            <dt id="section-3.3.4-7.1">Chunk Flags: 8 bits</dt>
            <dd id="section-3.3.4-7.2" style="margin-left: 1.5em">All set to 0 on transmit and ignored on receipt.<a class="pilcrow" href="#section-3.3.4-7.2">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.3.4-7.3">Cumulative TSN Ack: 32 bits (unsigned integer)</dt>
            <dd id="section-3.3.4-7.4" style="margin-left: 1.5em">The largest TSN, such that all TSNs smaller than or equal to it have been
received and the next one has not been received.
In the case where no DATA chunk has been received, this value is set to the
peer's Initial TSN minus one.<a class="pilcrow" href="#section-3.3.4-7.4">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.3.4-7.5">Advertised Receiver Window Credit (a_rwnd): 32 bits (unsigned integer)</dt>
            <dd id="section-3.3.4-7.6" style="margin-left: 1.5em">This field indicates the updated receive buffer space in bytes of the sender
of this SACK chunk; see <a class="xref" href="#sec_processing_of_received_sack">Section 6.2.1</a> for details.<a class="pilcrow" href="#section-3.3.4-7.6">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.3.4-7.7">Number of Gap Ack Blocks: 16 bits (unsigned integer)</dt>
            <dd id="section-3.3.4-7.8" style="margin-left: 1.5em">Indicates the number of Gap Ack Blocks included in this SACK chunk.<a class="pilcrow" href="#section-3.3.4-7.8">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.3.4-7.9">Number of Duplicate TSNs: 16 bit</dt>
            <dd id="section-3.3.4-7.10" style="margin-left: 1.5em">This field contains the number of duplicate TSNs the endpoint has received.
Each duplicate TSN is listed following the Gap Ack Block list.<a class="pilcrow" href="#section-3.3.4-7.10">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.3.4-7.11">Gap Ack Blocks:</dt>
            <dd id="section-3.3.4-7.12" style="margin-left: 1.5em">These fields contain the Gap Ack Blocks.
They are repeated for each Gap Ack Block up to the number of Gap Ack Blocks
defined in the Number of Gap Ack Blocks field.
All DATA chunks with TSNs greater than or equal to (Cumulative TSN Ack +
Gap Ack Block Start) and less than or equal to (Cumulative TSN Ack +
Gap Ack Block End) of each Gap Ack Block are assumed to have been received
correctly.<a class="pilcrow" href="#section-3.3.4-7.12">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.3.4-7.13">Gap Ack Block Start: 16 bits (unsigned integer)</dt>
            <dd id="section-3.3.4-7.14" style="margin-left: 1.5em">Indicates the Start offset TSN for this Gap Ack Block.
To calculate the actual TSN number, the Cumulative TSN Ack is added to
this offset number.
This calculated TSN identifies the lowest TSN in this Gap Ack Block that has
been received.<a class="pilcrow" href="#section-3.3.4-7.14">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.3.4-7.15">Gap Ack Block End: 16 bits (unsigned integer)</dt>
            <dd id="section-3.3.4-7.16" style="margin-left: 1.5em">
              <p id="section-3.3.4-7.16.1">Indicates the End offset TSN for this Gap Ack Block.
To calculate the actual TSN number, the Cumulative TSN Ack is added to this
offset number.
This calculated TSN identifies the highest TSN in this Gap Ack Block that has
been received.<a class="pilcrow" href="#section-3.3.4-7.16.1">Â¶</a></p>
<p id="section-3.3.4-7.16.2">For example, assume that the receiver has the following DATA chunks newly
arrived at the time when it decides to send a Selective ACK:<a class="pilcrow" href="#section-3.3.4-7.16.2">Â¶</a></p>
<div class="alignCenter art-text artwork" id="section-3.3.4-7.16.3">
<pre>------------
| TSN = 17 |
------------
|          | &lt;- still missing
------------
| TSN = 15 |
------------
| TSN = 14 |
------------
|          | &lt;- still missing
------------
| TSN = 12 |
------------
| TSN = 11 |
------------
| TSN = 10 |
------------
</pre><a class="pilcrow" href="#section-3.3.4-7.16.3">Â¶</a>
</div>
<p id="section-3.3.4-7.16.4">Then, the parameter part of the SACK chunk <span class="bcp14">MUST</span> be constructed as follows
(assuming the new a_rwnd is set to 4660 by the sender):<a class="pilcrow" href="#section-3.3.4-7.16.4">Â¶</a></p>
<div class="alignCenter art-text artwork" id="section-3.3.4-7.16.5">
<pre>+-------------------+-------------------+
|        Cumulative TSN Ack = 12        |
+-------------------+-------------------+
|             a_rwnd = 4660             |
+-------------------+-------------------+
| num of block = 2  |  num of dup = 0   |
+-------------------+-------------------+
|block #1 start = 2 | block #1 end = 3  |
+-------------------+-------------------+
|block #2 start = 5 | block #2 end = 5  |
+-------------------+-------------------+
</pre><a class="pilcrow" href="#section-3.3.4-7.16.5">Â¶</a>
</div>
</dd>
            <dd class="break"></dd>
<dt id="section-3.3.4-7.17">Duplicate TSN: 32 bits (unsigned integer)</dt>
            <dd id="section-3.3.4-7.18" style="margin-left: 1.5em">
              <p id="section-3.3.4-7.18.1">Indicates the number of times a TSN was received in duplicate since the last
SACK chunk was sent.
Every time a receiver gets a duplicate TSN (before sending the SACK chunk), it
adds it to the list of duplicates.
The duplicate count is reinitialized to zero after sending each SACK chunk.<a class="pilcrow" href="#section-3.3.4-7.18.1">Â¶</a></p>
<p id="section-3.3.4-7.18.2">For example, if a receiver were to get the TSN 19 three times, it
would list 19 twice in the outbound SACK chunk.
After sending the SACK chunk, if it received yet one more TSN 19, it would list
19 as a duplicate once in the next outgoing SACK chunk.<a class="pilcrow" href="#section-3.3.4-7.18.2">Â¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec_heartbeat_chunk">
<section id="section-3.3.5">
          <h4 id="name-heartbeat-request-heartbeat">
<a class="section-number selfRef" href="#section-3.3.5">3.3.5. </a><a class="section-name selfRef" href="#name-heartbeat-request-heartbeat">Heartbeat Request (HEARTBEAT) (4)</a>
          </h4>
<p id="section-3.3.5-1">An endpoint <span class="bcp14">SHOULD</span> send a HEARTBEAT (HB) chunk to its peer endpoint to probe
the reachability of a particular destination transport address defined in the
present association.<a class="pilcrow" href="#section-3.3.5-1">Â¶</a></p>
<p id="section-3.3.5-2">The parameter field contains the Heartbeat Information, which is a
variable-length opaque data structure understood only by the sender.<a class="pilcrow" href="#section-3.3.5-2">Â¶</a></p>
<div class="alignCenter art-text artwork" id="section-3.3.5-3">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Type = 4    |  Chunk Flags  |       Heartbeat Length        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
\                                                               \
/          Heartbeat Information TLV (Variable-Length)          /
\                                                               \
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a class="pilcrow" href="#section-3.3.5-3">Â¶</a>
</div>
<span class="break"></span><dl class="dlNewline" id="section-3.3.5-4">
            <dt id="section-3.3.5-4.1">Chunk Flags: 8 bits</dt>
            <dd id="section-3.3.5-4.2" style="margin-left: 1.5em">Set to 0 on transmit and ignored on receipt.<a class="pilcrow" href="#section-3.3.5-4.2">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.3.5-4.3">Heartbeat Length: 16 bits (unsigned integer)</dt>
            <dd id="section-3.3.5-4.4" style="margin-left: 1.5em">Set to the size of the chunk in bytes, including the chunk header and the
Heartbeat Information field.<a class="pilcrow" href="#section-3.3.5-4.4">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.3.5-4.5">Heartbeat Information: variable length</dt>
            <dd id="section-3.3.5-4.6" style="margin-left: 1.5em">
              <p id="section-3.3.5-4.6.1">Defined as a variable-length parameter using the format described
in <a class="xref" href="#sec_parameter_format">Section 3.2.1</a>, that is:<a class="pilcrow" href="#section-3.3.5-4.6.1">Â¶</a></p>
<span id="name-variable-length-parameters-of"></span><table class="center" id="table-9">
                <caption>
<a class="selfRef" href="#table-9">Table 9</a>:
<a class="selfRef" href="#name-variable-length-parameters-of">Variable-Length Parameters of HEARTBEAT Chunks</a>
                </caption>
<thead>
                  <tr>
                    <th class="text-left" colspan="1" rowspan="1">Variable Parameters</th>
                    <th class="text-left" colspan="1" rowspan="1">Status</th>
                    <th class="text-left" colspan="1" rowspan="1">Type Value</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="text-left" colspan="1" rowspan="1">Heartbeat Info</td>
                    <td class="text-left" colspan="1" rowspan="1">Mandatory</td>
                    <td class="text-left" colspan="1" rowspan="1">1</td>
                  </tr>
                </tbody>
              </table>
<div class="alignCenter art-text artwork" id="section-3.3.5-4.6.3">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|    Heartbeat Info Type = 1    |        HB Info Length         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
/                Sender-Specific Heartbeat Info                 /
\                                                               \
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a class="pilcrow" href="#section-3.3.5-4.6.3">Â¶</a>
</div>
<p id="section-3.3.5-4.6.4">The Sender-Specific Heartbeat Info field <span class="bcp14">SHOULD</span> include
information about the sender's current time when this HEARTBEAT
chunk is sent and the destination transport address to which this
HEARTBEAT chunk is sent (see <a class="xref" href="#sec_path_heartbeat">Section 8.3</a>).
This information is simply reflected back by the receiver in the HEARTBEAT ACK
chunk (see <a class="xref" href="#sec_heartbeat_ack_chunk">Section 3.3.6</a>).
Note also that the HEARTBEAT chunk is both for reachability checking and for
path verification (see <a class="xref" href="#sec_path_verifiation">Section 5.4</a>).
When a HEARTBEAT chunk is being used for path verification purposes, it <span class="bcp14">MUST</span>
include a random nonce of length 64 bits or longer (<span>[<a class="xref" href="#RFC4086">RFC4086</a>]</span>
provides some information on randomness guidelines).<a class="pilcrow" href="#section-3.3.5-4.6.4">Â¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec_heartbeat_ack_chunk">
<section id="section-3.3.6">
          <h4 id="name-heartbeat-acknowledgement-h">
<a class="section-number selfRef" href="#section-3.3.6">3.3.6. </a><a class="section-name selfRef" href="#name-heartbeat-acknowledgement-h">Heartbeat Acknowledgement (HEARTBEAT ACK) (5)</a>
          </h4>
<p id="section-3.3.6-1">An endpoint <span class="bcp14">MUST</span> send this chunk to its peer endpoint as a response
to a HEARTBEAT chunk (see <a class="xref" href="#sec_path_heartbeat">Section 8.3</a>).
A packet containing the HEARTBEAT ACK chunk is always sent to the source
IP address of the IP datagram containing the HEARTBEAT chunk to which this
HEARTBEAT ACK chunk is responding.<a class="pilcrow" href="#section-3.3.6-1">Â¶</a></p>
<p id="section-3.3.6-2">The parameter field contains a variable-length opaque data structure.<a class="pilcrow" href="#section-3.3.6-2">Â¶</a></p>
<div class="alignCenter art-text artwork" id="section-3.3.6-3">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Type = 5    |  Chunk Flags  |     Heartbeat Ack Length      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
\                                                               \
/          Heartbeat Information TLV (Variable-Length)          /
\                                                               \
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a class="pilcrow" href="#section-3.3.6-3">Â¶</a>
</div>
<span class="break"></span><dl class="dlNewline" id="section-3.3.6-4">
            <dt id="section-3.3.6-4.1">Chunk Flags: 8 bits</dt>
            <dd id="section-3.3.6-4.2" style="margin-left: 1.5em">Set to 0 on transmit and ignored on receipt.<a class="pilcrow" href="#section-3.3.6-4.2">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.3.6-4.3">Heartbeat Ack Length: 16 bits (unsigned integer)</dt>
            <dd id="section-3.3.6-4.4" style="margin-left: 1.5em">Set to the size of the chunk in bytes, including the chunk header and the
Heartbeat Information field.<a class="pilcrow" href="#section-3.3.6-4.4">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.3.6-4.5">Heartbeat Information: variable length</dt>
            <dd id="section-3.3.6-4.6" style="margin-left: 1.5em">
              <p id="section-3.3.6-4.6.1">This field <span class="bcp14">MUST</span> contain the Heartbeat Info parameter (as defined in
<a class="xref" href="#sec_heartbeat_chunk">Section 3.3.5</a>) of the Heartbeat Request to which this
Heartbeat Acknowledgement is responding.<a class="pilcrow" href="#section-3.3.6-4.6.1">Â¶</a></p>
<span id="name-variable-length-parameters-of-"></span><table class="center" id="table-10">
                <caption>
<a class="selfRef" href="#table-10">Table 10</a>:
<a class="selfRef" href="#name-variable-length-parameters-of-">Variable-Length Parameters of HEARTBEAT ACK Chunks</a>
                </caption>
<thead>
                  <tr>
                    <th class="text-left" colspan="1" rowspan="1">Variable Parameters</th>
                    <th class="text-left" colspan="1" rowspan="1">Status</th>
                    <th class="text-left" colspan="1" rowspan="1">Type Value</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="text-left" colspan="1" rowspan="1">Heartbeat Info</td>
                    <td class="text-left" colspan="1" rowspan="1">Mandatory</td>
                    <td class="text-left" colspan="1" rowspan="1">1</td>
                  </tr>
                </tbody>
              </table>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec_abort_chunk">
<section id="section-3.3.7">
          <h4 id="name-abort-association-abort-6">
<a class="section-number selfRef" href="#section-3.3.7">3.3.7. </a><a class="section-name selfRef" href="#name-abort-association-abort-6">Abort Association (ABORT) (6)</a>
          </h4>
<p id="section-3.3.7-1">The ABORT chunk is sent to the peer of an association to close the
association.
The ABORT chunk <span class="bcp14">MAY</span> contain error causes to inform the receiver about the
reason of the abort.
DATA chunks <span class="bcp14">MUST NOT</span> be bundled with ABORT chunks.
Control chunks (except for INIT, INIT ACK, and SHUTDOWN COMPLETE) <span class="bcp14">MAY</span> be
bundled with an ABORT chunk, but they <span class="bcp14">MUST</span> be placed before the ABORT chunk
in the SCTP packet; otherwise, they will be ignored by the receiver.<a class="pilcrow" href="#section-3.3.7-1">Â¶</a></p>
<p id="section-3.3.7-2">If an endpoint receives an ABORT chunk with a format error or no TCB is
found, it <span class="bcp14">MUST</span> silently discard it.
Moreover, under any circumstances, an endpoint that receives an ABORT chunk
<span class="bcp14">MUST NOT</span> respond to that ABORT chunk by sending an ABORT chunk of its own.<a class="pilcrow" href="#section-3.3.7-2">Â¶</a></p>
<div class="alignCenter art-text artwork" id="section-3.3.7-3">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Type = 6    |  Reserved   |T|            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
\                                                               \
/                   zero or more Error Causes                   /
\                                                               \
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a class="pilcrow" href="#section-3.3.7-3">Â¶</a>
</div>
<span class="break"></span><dl class="dlNewline" id="section-3.3.7-4">
            <dt id="section-3.3.7-4.1">Chunk Flags: 8 bits</dt>
            <dd id="section-3.3.7-4.2" style="margin-left: 1.5em">
              <span class="break"></span><dl class="dlNewline" id="section-3.3.7-4.2.1">
                <dt id="section-3.3.7-4.2.1.1">Reserved: 7 bits</dt>
                <dd id="section-3.3.7-4.2.1.2" style="margin-left: 1.5em">Set to 0 on transmit and ignored on receipt.<a class="pilcrow" href="#section-3.3.7-4.2.1.2">Â¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-3.3.7-4.2.1.3">T bit: 1 bit</dt>
                <dd id="section-3.3.7-4.2.1.4" style="margin-left: 1.5em">The T bit is set to 0 if the sender filled in the Verification Tag
expected by the peer.
If the Verification Tag is reflected, the T bit <span class="bcp14">MUST</span> be set to 1.
Reflecting means that the sent Verification Tag is the same as the received one.<a class="pilcrow" href="#section-3.3.7-4.2.1.4">Â¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</dd>
            <dd class="break"></dd>
<dt id="section-3.3.7-4.3">Length: 16 bits (unsigned integer)</dt>
            <dd id="section-3.3.7-4.4" style="margin-left: 1.5em">Set to the size of the chunk in bytes, including the chunk header and all the
Error Cause fields present.<a class="pilcrow" href="#section-3.3.7-4.4">Â¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-3.3.7-5">See <a class="xref" href="#sec_error_chunk">Section 3.3.10</a> for Error Cause definitions.<a class="pilcrow" href="#section-3.3.7-5">Â¶</a></p>
<p id="section-3.3.7-6">Note: Special rules apply to this chunk for verification;
please see <a class="xref" href="#sec_exceptions_in_verification_tag_rules">Section 8.5.1</a> for
details.<a class="pilcrow" href="#section-3.3.7-6">Â¶</a></p>
</section>
</div>
<div id="sec_shutdown_chunk">
<section id="section-3.3.8">
          <h4 id="name-shutdown-association-shutdo">
<a class="section-number selfRef" href="#section-3.3.8">3.3.8. </a><a class="section-name selfRef" href="#name-shutdown-association-shutdo">Shutdown Association (SHUTDOWN) (7)</a>
          </h4>
<p id="section-3.3.8-1">An endpoint in an association <span class="bcp14">MUST</span> use this chunk to initiate a graceful
close of the association with its peer.
This chunk has the following format.<a class="pilcrow" href="#section-3.3.8-1">Â¶</a></p>
<div class="alignCenter art-text artwork" id="section-3.3.8-2">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Type = 7    |  Chunk Flags  |          Length = 8           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                      Cumulative TSN Ack                       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a class="pilcrow" href="#section-3.3.8-2">Â¶</a>
</div>
<span class="break"></span><dl class="dlNewline" id="section-3.3.8-3">
            <dt id="section-3.3.8-3.1">Chunk Flags: 8 bits</dt>
            <dd id="section-3.3.8-3.2" style="margin-left: 1.5em">Set to 0 on transmit and ignored on receipt.<a class="pilcrow" href="#section-3.3.8-3.2">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.3.8-3.3">Length: 16 bits (unsigned integer)</dt>
            <dd id="section-3.3.8-3.4" style="margin-left: 1.5em">Indicates the length of the parameter. Set to 8.<a class="pilcrow" href="#section-3.3.8-3.4">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.3.8-3.5">Cumulative TSN Ack: 32 bits (unsigned integer)</dt>
            <dd id="section-3.3.8-3.6" style="margin-left: 1.5em">The largest TSN, such that all TSNs smaller than or equal to it have been
received and the next one has not been received.<a class="pilcrow" href="#section-3.3.8-3.6">Â¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-3.3.8-4">Note: Since the SHUTDOWN chunk does not contain Gap Ack Blocks,
it cannot be used to acknowledge TSNs received out of order.
In a SACK chunk, lack of Gap Ack Blocks that were previously included indicates
that the data receiver reneged on the associated DATA chunks.<a class="pilcrow" href="#section-3.3.8-4">Â¶</a></p>
<p id="section-3.3.8-5">Since the SHUTDOWN chunk does not contain Gap Ack Blocks, the receiver of
the SHUTDOWN chunk <span class="bcp14">MUST NOT</span> interpret the lack of a Gap Ack Block as a renege.
(See <a class="xref" href="#sec_acknowledgements_of_reception_of_data_chunks">Section 6.2</a> for
information on reneging.)<a class="pilcrow" href="#section-3.3.8-5">Â¶</a></p>
<p id="section-3.3.8-6">The sender of the SHUTDOWN chunk <span class="bcp14">MAY</span> bundle a SACK chunk to indicate any
gaps in the received TSNs.<a class="pilcrow" href="#section-3.3.8-6">Â¶</a></p>
</section>
</div>
<div id="sec_shutdown_ack_chunk">
<section id="section-3.3.9">
          <h4 id="name-shutdown-acknowledgement-sh">
<a class="section-number selfRef" href="#section-3.3.9">3.3.9. </a><a class="section-name selfRef" href="#name-shutdown-acknowledgement-sh">Shutdown Acknowledgement (SHUTDOWN ACK) (8)</a>
          </h4>
<p id="section-3.3.9-1">This chunk <span class="bcp14">MUST</span> be used to acknowledge the receipt of the SHUTDOWN chunk at
the completion of the shutdown process;
see <a class="xref" href="#sec_shutdown_of_an_association">Section 9.2</a> for details.<a class="pilcrow" href="#section-3.3.9-1">Â¶</a></p>
<p id="section-3.3.9-2">The SHUTDOWN ACK chunk has no parameters.<a class="pilcrow" href="#section-3.3.9-2">Â¶</a></p>
<div class="alignCenter art-text artwork" id="section-3.3.9-3">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Type = 8    |  Chunk Flags  |          Length = 4           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a class="pilcrow" href="#section-3.3.9-3">Â¶</a>
</div>
<span class="break"></span><dl class="dlNewline" id="section-3.3.9-4">
            <dt id="section-3.3.9-4.1">Chunk Flags: 8 bits</dt>
            <dd id="section-3.3.9-4.2" style="margin-left: 1.5em">Set to 0 on transmit and ignored on receipt.<a class="pilcrow" href="#section-3.3.9-4.2">Â¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec_error_chunk">
<section id="section-3.3.10">
          <h4 id="name-operation-error-error-9">
<a class="section-number selfRef" href="#section-3.3.10">3.3.10. </a><a class="section-name selfRef" href="#name-operation-error-error-9">Operation Error (ERROR) (9)</a>
          </h4>
<p id="section-3.3.10-1">An endpoint sends this chunk to its peer endpoint to notify it of
certain error conditions.
It contains one or more error causes.
An Operation Error is not considered fatal in and of itself, but the
corresponding error cause <span class="bcp14">MAY</span> be used with an ABORT chunk to report a fatal
condition.
An ERROR chunk has the following format:<a class="pilcrow" href="#section-3.3.10-1">Â¶</a></p>
<div class="alignCenter art-text artwork" id="section-3.3.10-2">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Type = 9    |  Chunk Flags  |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
\                                                               \
/                   one or more Error Causes                    /
\                                                               \
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a class="pilcrow" href="#section-3.3.10-2">Â¶</a>
</div>
<span class="break"></span><dl class="dlNewline" id="section-3.3.10-3">
            <dt id="section-3.3.10-3.1">Chunk Flags: 8 bits</dt>
            <dd id="section-3.3.10-3.2" style="margin-left: 1.5em">Set to 0 on transmit and ignored on receipt.<a class="pilcrow" href="#section-3.3.10-3.2">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.3.10-3.3">Length: 16 bits (unsigned integer)</dt>
            <dd id="section-3.3.10-3.4" style="margin-left: 1.5em">Set to the size of the chunk in bytes, including the chunk header and all the
Error Cause fields present.<a class="pilcrow" href="#section-3.3.10-3.4">Â¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-3.3.10-4">Error causes are defined as variable-length parameters using the
format described in <a class="xref" href="#sec_parameter_format">Section 3.2.1</a>, that is:<a class="pilcrow" href="#section-3.3.10-4">Â¶</a></p>
<div class="alignCenter art-text artwork" id="section-3.3.10-5">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|          Cause Code           |         Cause Length          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
/                  Cause-Specific Information                   /
\                                                               \
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a class="pilcrow" href="#section-3.3.10-5">Â¶</a>
</div>
<span class="break"></span><dl class="dlNewline" id="section-3.3.10-6">
            <dt id="section-3.3.10-6.1">Cause Code: 16 bits (unsigned integer)</dt>
            <dd id="section-3.3.10-6.2" style="margin-left: 1.5em">
              <p id="section-3.3.10-6.2.1">Defines the type of error conditions being reported.<a class="pilcrow" href="#section-3.3.10-6.2.1">Â¶</a></p>
<span id="name-cause-code"></span><table class="center" id="table-11">
                <caption>
<a class="selfRef" href="#table-11">Table 11</a>:
<a class="selfRef" href="#name-cause-code">Cause Code</a>
                </caption>
<thead>
                  <tr>
                    <th class="text-left" colspan="1" rowspan="1">Value</th>
                    <th class="text-left" colspan="1" rowspan="1">Cause Code</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="text-left" colspan="1" rowspan="1"> 1</td>
                    <td class="text-left" colspan="1" rowspan="1">Invalid Stream Identifier</td>
                  </tr>
                  <tr>
                    <td class="text-left" colspan="1" rowspan="1"> 2</td>
                    <td class="text-left" colspan="1" rowspan="1">Missing Mandatory Parameter</td>
                  </tr>
                  <tr>
                    <td class="text-left" colspan="1" rowspan="1"> 3</td>
                    <td class="text-left" colspan="1" rowspan="1">Stale Cookie</td>
                  </tr>
                  <tr>
                    <td class="text-left" colspan="1" rowspan="1"> 4</td>
                    <td class="text-left" colspan="1" rowspan="1">Out of Resource</td>
                  </tr>
                  <tr>
                    <td class="text-left" colspan="1" rowspan="1"> 5</td>
                    <td class="text-left" colspan="1" rowspan="1">Unresolvable Address</td>
                  </tr>
                  <tr>
                    <td class="text-left" colspan="1" rowspan="1"> 6</td>
                    <td class="text-left" colspan="1" rowspan="1">Unrecognized Chunk Type</td>
                  </tr>
                  <tr>
                    <td class="text-left" colspan="1" rowspan="1"> 7</td>
                    <td class="text-left" colspan="1" rowspan="1">Invalid Mandatory Parameter</td>
                  </tr>
                  <tr>
                    <td class="text-left" colspan="1" rowspan="1"> 8</td>
                    <td class="text-left" colspan="1" rowspan="1">Unrecognized Parameters</td>
                  </tr>
                  <tr>
                    <td class="text-left" colspan="1" rowspan="1"> 9</td>
                    <td class="text-left" colspan="1" rowspan="1">No User Data</td>
                  </tr>
                  <tr>
                    <td class="text-left" colspan="1" rowspan="1">10</td>
                    <td class="text-left" colspan="1" rowspan="1">Cookie Received While Shutting Down</td>
                  </tr>
                  <tr>
                    <td class="text-left" colspan="1" rowspan="1">11</td>
                    <td class="text-left" colspan="1" rowspan="1">Restart of an Association with New Addresses</td>
                  </tr>
                  <tr>
                    <td class="text-left" colspan="1" rowspan="1">12</td>
                    <td class="text-left" colspan="1" rowspan="1">User-Initiated Abort</td>
                  </tr>
                  <tr>
                    <td class="text-left" colspan="1" rowspan="1">13</td>
                    <td class="text-left" colspan="1" rowspan="1">Protocol Violation</td>
                  </tr>
                </tbody>
              </table>
</dd>
            <dd class="break"></dd>
<dt id="section-3.3.10-6.3">Cause Length: 16 bits (unsigned integer)</dt>
            <dd id="section-3.3.10-6.4" style="margin-left: 1.5em">Set to the size of the parameter in bytes, including the Cause Code,
Cause Length, and Cause-Specific Information fields.<a class="pilcrow" href="#section-3.3.10-6.4">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.3.10-6.5">Cause-Specific Information: variable length</dt>
            <dd id="section-3.3.10-6.6" style="margin-left: 1.5em">This field carries the details of the error condition.<a class="pilcrow" href="#section-3.3.10-6.6">Â¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-3.3.10-7">Sections <a class="xref" href="#sec_invalid_stream_identifier_cause">3.3.10.1</a> -
<a class="xref" href="#sec_protocol_violation_cause">3.3.10.13</a> define error causes for SCTP.
Guidelines for the IETF to define new error cause values are discussed in
<a class="xref" href="#sec_ietf_defined_additional_error_causes">Section 15.4</a>.<a class="pilcrow" href="#section-3.3.10-7">Â¶</a></p>
<div id="sec_invalid_stream_identifier_cause">
<section id="section-3.3.10.1">
            <h5 id="name-invalid-stream-identifier-1">
<a class="section-number selfRef" href="#section-3.3.10.1">3.3.10.1. </a><a class="section-name selfRef" href="#name-invalid-stream-identifier-1">Invalid Stream Identifier (1)</a>
            </h5>
<p id="section-3.3.10.1-1">Indicates that the endpoint received a DATA chunk sent using a nonexistent
stream.<a class="pilcrow" href="#section-3.3.10.1-1">Â¶</a></p>
<div class="alignCenter art-text artwork" id="section-3.3.10.1-2">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        Cause Code = 1         |       Cause Length = 8        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|       Stream Identifier       |          (Reserved)           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a class="pilcrow" href="#section-3.3.10.1-2">Â¶</a>
</div>
<span class="break"></span><dl class="dlNewline" id="section-3.3.10.1-3">
              <dt id="section-3.3.10.1-3.1">Stream Identifier: 16 bits (unsigned integer)</dt>
              <dd id="section-3.3.10.1-3.2" style="margin-left: 1.5em">Contains the Stream Identifier of the DATA chunk received in error.<a class="pilcrow" href="#section-3.3.10.1-3.2">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-3.3.10.1-3.3">Reserved: 16 bits</dt>
              <dd id="section-3.3.10.1-3.4" style="margin-left: 1.5em">This field is reserved.
It is set to all 0's on transmit and ignored on receipt.<a class="pilcrow" href="#section-3.3.10.1-3.4">Â¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec_missing_mandatory_parameter_cause">
<section id="section-3.3.10.2">
            <h5 id="name-missing-mandatory-parameter">
<a class="section-number selfRef" href="#section-3.3.10.2">3.3.10.2. </a><a class="section-name selfRef" href="#name-missing-mandatory-parameter">Missing Mandatory Parameter (2)</a>
            </h5>
<p id="section-3.3.10.2-1">Indicates that one or more mandatory TLV
parameters are missing in a received INIT or INIT ACK chunk.<a class="pilcrow" href="#section-3.3.10.2-1">Â¶</a></p>
<div class="alignCenter art-text artwork" id="section-3.3.10.2-2">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        Cause Code = 2         |   Cause Length = 8 + N * 2    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                 Number of missing params = N                  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     Missing Param Type #1     |     Missing Param Type #2     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|    Missing Param Type #N-1    |     Missing Param Type #N     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a class="pilcrow" href="#section-3.3.10.2-2">Â¶</a>
</div>
<span class="break"></span><dl class="dlNewline" id="section-3.3.10.2-3">
              <dt id="section-3.3.10.2-3.1">Number of Missing params: 32 bits (unsigned integer)</dt>
              <dd id="section-3.3.10.2-3.2" style="margin-left: 1.5em">This field contains the number of parameters contained in the Cause-Specific
Information field.<a class="pilcrow" href="#section-3.3.10.2-3.2">Â¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-3.3.10.2-3.3">Missing Param Type: 16 bits (unsigned integer)</dt>
              <dd id="section-3.3.10.2-3.4" style="margin-left: 1.5em">Each field will contain the missing mandatory parameter number.<a class="pilcrow" href="#section-3.3.10.2-3.4">Â¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec_stale_cookie_error_cause">
<section id="section-3.3.10.3">
            <h5 id="name-stale-cookie-3">
<a class="section-number selfRef" href="#section-3.3.10.3">3.3.10.3. </a><a class="section-name selfRef" href="#name-stale-cookie-3">Stale Cookie (3)</a>
            </h5>
<p id="section-3.3.10.3-1">Indicates the receipt of a valid State Cookie that has expired.<a class="pilcrow" href="#section-3.3.10.3-1">Â¶</a></p>
<div class="alignCenter art-text artwork" id="section-3.3.10.3-2">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        Cause Code = 3         |       Cause Length = 8        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                 Measure of Staleness (usec.)                  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a class="pilcrow" href="#section-3.3.10.3-2">Â¶</a>
</div>
<span class="break"></span><dl class="dlNewline" id="section-3.3.10.3-3">
              <dt id="section-3.3.10.3-3.1">Measure of Staleness: 32 bits (unsigned integer)</dt>
              <dd id="section-3.3.10.3-3.2" style="margin-left: 1.5em">
                <p id="section-3.3.10.3-3.2.1">This field contains the difference, rounded up in microseconds, between the
current time and the time the State Cookie expired.<a class="pilcrow" href="#section-3.3.10.3-3.2.1">Â¶</a></p>
<p id="section-3.3.10.3-3.2.2">The sender of this error cause <span class="bcp14">MAY</span> choose to report how long past
expiration the State Cookie is by including a non-zero value in
the Measure of Staleness field.
If the sender does not wish to provide the Measure of Staleness, it <span class="bcp14">SHOULD</span> set
this field to the value of zero.<a class="pilcrow" href="#section-3.3.10.3-3.2.2">Â¶</a></p>
</dd>
            <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec_out_of_resource_cause">
<section id="section-3.3.10.4">
            <h5 id="name-out-of-resource-4">
<a class="section-number selfRef" href="#section-3.3.10.4">3.3.10.4. </a><a class="section-name selfRef" href="#name-out-of-resource-4">Out of Resource (4)</a>
            </h5>
<p id="section-3.3.10.4-1">Indicates that the sender is out of resource.
This is usually sent in combination with or within an ABORT chunk.<a class="pilcrow" href="#section-3.3.10.4-1">Â¶</a></p>
<div class="alignCenter art-text artwork" id="section-3.3.10.4-2">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        Cause Code = 4         |       Cause Length = 4        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a class="pilcrow" href="#section-3.3.10.4-2">Â¶</a>
</div>
</section>
</div>
<div id="sec_unresolvable_address_cause">
<section id="section-3.3.10.5">
            <h5 id="name-unresolvable-address-5">
<a class="section-number selfRef" href="#section-3.3.10.5">3.3.10.5. </a><a class="section-name selfRef" href="#name-unresolvable-address-5">Unresolvable Address (5)</a>
            </h5>
<p id="section-3.3.10.5-1">Indicates that the sender is not able to resolve the specified address
parameter (e.g., type of address is not supported by the sender).
This is usually sent in combination with or within an ABORT chunk.<a class="pilcrow" href="#section-3.3.10.5-1">Â¶</a></p>
<div class="alignCenter art-text artwork" id="section-3.3.10.5-2">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        Cause Code = 5         |         Cause Length          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
/                     Unresolvable Address                      /
\                                                               \
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a class="pilcrow" href="#section-3.3.10.5-2">Â¶</a>
</div>
<span class="break"></span><dl class="dlNewline" id="section-3.3.10.5-3">
              <dt id="section-3.3.10.5-3.1">Unresolvable Address: variable length</dt>
              <dd id="section-3.3.10.5-3.2" style="margin-left: 1.5em">The Unresolvable Address field contains the complete Type, Length, and Value
of the address parameter (or Host Name parameter) that contains the
unresolvable address or host name.<a class="pilcrow" href="#section-3.3.10.5-3.2">Â¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec_unrecognized_chunk_type_cause">
<section id="section-3.3.10.6">
            <h5 id="name-unrecognized-chunk-type-6">
<a class="section-number selfRef" href="#section-3.3.10.6">3.3.10.6. </a><a class="section-name selfRef" href="#name-unrecognized-chunk-type-6">Unrecognized Chunk Type (6)</a>
            </h5>
<p id="section-3.3.10.6-1">This error cause is returned to the originator of the chunk if the receiver
does not understand the chunk and the upper bits of the 'Chunk Type' are set
to 01 or 11.<a class="pilcrow" href="#section-3.3.10.6-1">Â¶</a></p>
<div class="alignCenter art-text artwork" id="section-3.3.10.6-2">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        Cause Code = 6         |         Cause Length          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
/                      Unrecognized Chunk                       /
\                                                               \
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a class="pilcrow" href="#section-3.3.10.6-2">Â¶</a>
</div>
<span class="break"></span><dl class="dlNewline" id="section-3.3.10.6-3">
              <dt id="section-3.3.10.6-3.1">Unrecognized Chunk: variable length</dt>
              <dd id="section-3.3.10.6-3.2" style="margin-left: 1.5em">The Unrecognized Chunk field contains the unrecognized chunk from the
SCTP packet complete with Chunk Type, Chunk Flags, and Chunk Length.<a class="pilcrow" href="#section-3.3.10.6-3.2">Â¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec_invalid_mandatory_parameter_cause">
<section id="section-3.3.10.7">
            <h5 id="name-invalid-mandatory-parameter">
<a class="section-number selfRef" href="#section-3.3.10.7">3.3.10.7. </a><a class="section-name selfRef" href="#name-invalid-mandatory-parameter">Invalid Mandatory Parameter (7)</a>
            </h5>
<p id="section-3.3.10.7-1">This error cause is returned to the originator of an INIT or INIT ACK chunk
when one of the mandatory parameters is set to an invalid value.<a class="pilcrow" href="#section-3.3.10.7-1">Â¶</a></p>
<div class="alignCenter art-text artwork" id="section-3.3.10.7-2">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        Cause Code = 7         |       Cause Length = 4        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a class="pilcrow" href="#section-3.3.10.7-2">Â¶</a>
</div>
</section>
</div>
<div id="sec_unrecongnized_parameters">
<section id="section-3.3.10.8">
            <h5 id="name-unrecognized-parameters-8">
<a class="section-number selfRef" href="#section-3.3.10.8">3.3.10.8. </a><a class="section-name selfRef" href="#name-unrecognized-parameters-8">Unrecognized Parameters (8)</a>
            </h5>
<p id="section-3.3.10.8-1">This error cause is returned to the originator of the INIT ACK chunk if the
receiver does not recognize one or more Optional TLV parameters in the
INIT ACK chunk.<a class="pilcrow" href="#section-3.3.10.8-1">Â¶</a></p>
<div class="alignCenter art-text artwork" id="section-3.3.10.8-2">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        Cause Code = 8         |         Cause Length          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
/                    Unrecognized Parameters                    /
\                                                               \
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a class="pilcrow" href="#section-3.3.10.8-2">Â¶</a>
</div>
<span class="break"></span><dl class="dlNewline" id="section-3.3.10.8-3">
              <dt id="section-3.3.10.8-3.1">Unrecognized Parameters: variable length</dt>
              <dd id="section-3.3.10.8-3.2" style="margin-left: 1.5em">The Unrecognized Parameters field contains the unrecognized parameters copied
from the INIT ACK chunk complete with TLV.
This error cause is normally contained in an ERROR chunk bundled with
the COOKIE ECHO chunk when responding to the INIT ACK chunk, when the
sender of the COOKIE ECHO chunk wishes to report unrecognized parameters.<a class="pilcrow" href="#section-3.3.10.8-3.2">Â¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec_no_user_data_cause">
<section id="section-3.3.10.9">
            <h5 id="name-no-user-data-9">
<a class="section-number selfRef" href="#section-3.3.10.9">3.3.10.9. </a><a class="section-name selfRef" href="#name-no-user-data-9">No User Data (9)</a>
            </h5>
<p id="section-3.3.10.9-1">This error cause is returned to the originator of a DATA chunk if a
received DATA chunk has no user data.<a class="pilcrow" href="#section-3.3.10.9-1">Â¶</a></p>
<div class="alignCenter art-text artwork" id="section-3.3.10.9-2">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        Cause Code = 9         |       Cause Length = 8        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                              TSN                              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a class="pilcrow" href="#section-3.3.10.9-2">Â¶</a>
</div>
<span class="break"></span><dl class="dlNewline" id="section-3.3.10.9-3">
              <dt id="section-3.3.10.9-3.1">TSN: 32 bits (unsigned integer)</dt>
              <dd id="section-3.3.10.9-3.2" style="margin-left: 1.5em">This parameter contains the TSN of the DATA chunk received with no User
Data field.<a class="pilcrow" href="#section-3.3.10.9-3.2">Â¶</a>
</dd>
            <dd class="break"></dd>
</dl>
<p id="section-3.3.10.9-4">This cause code is normally returned in an ABORT chunk
(see <a class="xref" href="#sec_acknowledgements_of_reception_of_data_chunks">Section 6.2</a>).<a class="pilcrow" href="#section-3.3.10.9-4">Â¶</a></p>
</section>
</div>
<div id="sec_cookie_received_while_shutting_down_cause">
<section id="section-3.3.10.10">
            <h5 id="name-cookie-received-while-shutt">
<a class="section-number selfRef" href="#section-3.3.10.10">3.3.10.10. </a><a class="section-name selfRef" href="#name-cookie-received-while-shutt">Cookie Received While Shutting Down (10)</a>
            </h5>
<p id="section-3.3.10.10-1">A COOKIE ECHO chunk was received while the endpoint was in the
SHUTDOWN-ACK-SENT state.
This error is usually returned in an ERROR chunk bundled with the
retransmitted SHUTDOWN ACK chunk.<a class="pilcrow" href="#section-3.3.10.10-1">Â¶</a></p>
<div class="alignCenter art-text artwork" id="section-3.3.10.10-2">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        Cause Code = 10        |       Cause Length = 4        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a class="pilcrow" href="#section-3.3.10.10-2">Â¶</a>
</div>
</section>
</div>
<div id="sec_restart_with_new_addresses_cause">
<section id="section-3.3.10.11">
            <h5 id="name-restart-of-an-association-w">
<a class="section-number selfRef" href="#section-3.3.10.11">3.3.10.11. </a><a class="section-name selfRef" href="#name-restart-of-an-association-w">Restart of an Association with New Addresses (11)</a>
            </h5>
<p id="section-3.3.10.11-1">An INIT chunk was received on an existing association.
But the INIT chunk added addresses to the association that were previously
not part of the association.
The new addresses are listed in the error cause.
This error cause is normally sent as part of an ABORT chunk refusing the
INIT chunk
(see <a class="xref" href="#sec_handle_duplicate_or_unexpected_chunks">Section 5.2</a>).<a class="pilcrow" href="#section-3.3.10.11-1">Â¶</a></p>
<div class="alignCenter art-text artwork" id="section-3.3.10.11-2">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        Cause Code = 11        |         Cause Length          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
/                       New Address TLVs                        /
\                                                               \
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a class="pilcrow" href="#section-3.3.10.11-2">Â¶</a>
</div>
<p id="section-3.3.10.11-3">Note: Each New Address TLV is an exact copy of the TLV that was found
in the INIT chunk that was new, including the Parameter Type and the
Parameter Length.<a class="pilcrow" href="#section-3.3.10.11-3">Â¶</a></p>
</section>
</div>
<div id="sec_user_initiated_abort_cause">
<section id="section-3.3.10.12">
            <h5 id="name-user-initiated-abort-12">
<a class="section-number selfRef" href="#section-3.3.10.12">3.3.10.12. </a><a class="section-name selfRef" href="#name-user-initiated-abort-12">User-Initiated Abort (12)</a>
            </h5>
<p id="section-3.3.10.12-1">This error cause <span class="bcp14">MAY</span> be included in ABORT chunks that are sent
because of an upper-layer request.
The upper layer can specify an Upper Layer Abort Reason that is transported by
SCTP transparently and <span class="bcp14">MAY</span> be delivered to the upper-layer protocol at the peer.<a class="pilcrow" href="#section-3.3.10.12-1">Â¶</a></p>
<div class="alignCenter art-text artwork" id="section-3.3.10.12-2">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        Cause Code = 12        |         Cause Length          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
/                   Upper Layer Abort Reason                    /
\                                                               \
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a class="pilcrow" href="#section-3.3.10.12-2">Â¶</a>
</div>
</section>
</div>
<div id="sec_protocol_violation_cause">
<section id="section-3.3.10.13">
            <h5 id="name-protocol-violation-13">
<a class="section-number selfRef" href="#section-3.3.10.13">3.3.10.13. </a><a class="section-name selfRef" href="#name-protocol-violation-13">Protocol Violation (13)</a>
            </h5>
<p id="section-3.3.10.13-1">This error cause <span class="bcp14">MAY</span> be included in ABORT chunks that are sent
because an SCTP endpoint detects a protocol violation of the peer
that is not covered by the error causes described in Sections
<a class="xref" href="#sec_invalid_stream_identifier_cause">3.3.10.1</a> -
<a class="xref" href="#sec_user_initiated_abort_cause">3.3.10.12</a>.
An implementation <span class="bcp14">MAY</span> provide additional information specifying what kind of
protocol violation has been detected.<a class="pilcrow" href="#section-3.3.10.13-1">Â¶</a></p>
<div class="alignCenter art-text artwork" id="section-3.3.10.13-2">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|         Cause Code = 13         |        Cause Length         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
/                    Additional Information                     /
\                                                               \
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a class="pilcrow" href="#section-3.3.10.13-2">Â¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="sec_cookie_echo_chunk">
<section id="section-3.3.11">
          <h4 id="name-cookie-echo-cookie-echo-10">
<a class="section-number selfRef" href="#section-3.3.11">3.3.11. </a><a class="section-name selfRef" href="#name-cookie-echo-cookie-echo-10">Cookie Echo (COOKIE ECHO) (10)</a>
          </h4>
<p id="section-3.3.11-1">This chunk is used only during the initialization of an association.
It is sent by the initiator of an association to its peer to complete
the initialization process.
This chunk <span class="bcp14">MUST</span> precede any DATA chunk sent within the association but <span class="bcp14">MAY</span> be
bundled with one or more DATA chunks in the same packet.<a class="pilcrow" href="#section-3.3.11-1">Â¶</a></p>
<div class="alignCenter art-text artwork" id="section-3.3.11-2">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Type = 10   |  Chunk Flags  |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
/                            Cookie                             /
\                                                               \
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a class="pilcrow" href="#section-3.3.11-2">Â¶</a>
</div>
<span class="break"></span><dl class="dlNewline" id="section-3.3.11-3">
            <dt id="section-3.3.11-3.1">Chunk Flags: 8 bits</dt>
            <dd id="section-3.3.11-3.2" style="margin-left: 1.5em">Set to 0 on transmit and ignored on receipt.<a class="pilcrow" href="#section-3.3.11-3.2">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.3.11-3.3">Length: 16 bits (unsigned integer)</dt>
            <dd id="section-3.3.11-3.4" style="margin-left: 1.5em">Set to the size of the chunk in bytes, including the 4 bytes of the
chunk header and the size of the cookie.<a class="pilcrow" href="#section-3.3.11-3.4">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.3.11-3.5">Cookie: variable size</dt>
            <dd id="section-3.3.11-3.6" style="margin-left: 1.5em">
              <p id="section-3.3.11-3.6.1">This field <span class="bcp14">MUST</span> contain the exact cookie received in the State Cookie parameter
from the previous INIT ACK chunk.<a class="pilcrow" href="#section-3.3.11-3.6.1">Â¶</a></p>
<p id="section-3.3.11-3.6.2">An implementation <span class="bcp14">SHOULD</span> make the cookie as small as possible to ensure
interoperability.<a class="pilcrow" href="#section-3.3.11-3.6.2">Â¶</a></p>
<p id="section-3.3.11-3.6.3">Note: A Cookie Echo does not contain a State Cookie parameter;
instead, the data within the State Cookie's Parameter Value becomes the data
within the Cookie Echo's Chunk Value.
This allows an implementation to change only the first 2 bytes of the
State Cookie parameter to become a COOKIE ECHO chunk.<a class="pilcrow" href="#section-3.3.11-3.6.3">Â¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec_cookie_ack_chunk">
<section id="section-3.3.12">
          <h4 id="name-cookie-acknowledgement-cook">
<a class="section-number selfRef" href="#section-3.3.12">3.3.12. </a><a class="section-name selfRef" href="#name-cookie-acknowledgement-cook">Cookie Acknowledgement (COOKIE ACK) (11)</a>
          </h4>
<p id="section-3.3.12-1">This chunk is used only during the initialization of an association.
It is used to acknowledge the receipt of a COOKIE ECHO chunk.
This chunk <span class="bcp14">MUST</span> precede any DATA or SACK chunk sent within the
association but <span class="bcp14">MAY</span> be bundled with one or more DATA chunks or SACK
chunk's in the same SCTP packet.<a class="pilcrow" href="#section-3.3.12-1">Â¶</a></p>
<div class="alignCenter art-text artwork" id="section-3.3.12-2">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Type = 11   |  Chunk Flags  |          Length = 4           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a class="pilcrow" href="#section-3.3.12-2">Â¶</a>
</div>
<span class="break"></span><dl class="dlNewline" id="section-3.3.12-3">
            <dt id="section-3.3.12-3.1">Chunk Flags: 8 bits</dt>
            <dd id="section-3.3.12-3.2" style="margin-left: 1.5em">Set to 0 on transmit and ignored on receipt.<a class="pilcrow" href="#section-3.3.12-3.2">Â¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec_shutdown_complete_chunk">
<section id="section-3.3.13">
          <h4 id="name-shutdown-complete-shutdown-">
<a class="section-number selfRef" href="#section-3.3.13">3.3.13. </a><a class="section-name selfRef" href="#name-shutdown-complete-shutdown-">Shutdown Complete (SHUTDOWN COMPLETE) (14)</a>
          </h4>
<p id="section-3.3.13-1">This chunk <span class="bcp14">MUST</span> be used to acknowledge the receipt of the SHUTDOWN ACK chunk
at the completion of the shutdown process;
see <a class="xref" href="#sec_shutdown_of_an_association">Section 9.2</a> for details.<a class="pilcrow" href="#section-3.3.13-1">Â¶</a></p>
<p id="section-3.3.13-2">The SHUTDOWN COMPLETE chunk has no parameters.<a class="pilcrow" href="#section-3.3.13-2">Â¶</a></p>
<div class="alignCenter art-text artwork" id="section-3.3.13-3">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Type = 14   |  Reserved   |T|          Length = 4           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a class="pilcrow" href="#section-3.3.13-3">Â¶</a>
</div>
<span class="break"></span><dl class="dlNewline" id="section-3.3.13-4">
            <dt id="section-3.3.13-4.1">Chunk Flags: 8 bits</dt>
            <dd id="section-3.3.13-4.2" style="margin-left: 1.5em">
              <span class="break"></span><dl class="dlNewline" id="section-3.3.13-4.2.1">
                <dt id="section-3.3.13-4.2.1.1">Reserved: 7 bits</dt>
                <dd id="section-3.3.13-4.2.1.2" style="margin-left: 1.5em">Set to 0 on transmit and ignored on receipt.<a class="pilcrow" href="#section-3.3.13-4.2.1.2">Â¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-3.3.13-4.2.1.3">T bit: 1 bit</dt>
                <dd id="section-3.3.13-4.2.1.4" style="margin-left: 1.5em">The T bit is set to 0 if the sender filled in the Verification Tag
expected by the peer.
If the Verification Tag is reflected, the T bit <span class="bcp14">MUST</span> be set to 1.
Reflecting means that the sent Verification Tag is the same as the
received one.<a class="pilcrow" href="#section-3.3.13-4.2.1.4">Â¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-3.3.13-5">Note: Special rules apply to this chunk for verification; please see
<a class="xref" href="#sec_exceptions_in_verification_tag_rules">Section 8.5.1</a> for details.<a class="pilcrow" href="#section-3.3.13-5">Â¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="sec_sctp_assoc_diagram">
<section id="section-4">
      <h2 id="name-sctp-association-state-diag">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-sctp-association-state-diag">SCTP Association State Diagram</a>
      </h2>
<p id="section-4-1">During the life time of an SCTP association, the SCTP endpoint's
association progresses from one state to another in response to
various events.
The events that might potentially advance an association's state include:<a class="pilcrow" href="#section-4-1">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-2.1">
          <p id="section-4-2.1.1">SCTP user primitive calls, e.g., [ASSOCIATE], [SHUTDOWN], or [ABORT],<a class="pilcrow" href="#section-4-2.1.1">Â¶</a></p>
</li>
        <li class="normal" id="section-4-2.2">
          <p id="section-4-2.2.1">reception of INIT, COOKIE ECHO, ABORT, SHUTDOWN, etc., and control chunks, or<a class="pilcrow" href="#section-4-2.2.1">Â¶</a></p>
</li>
        <li class="normal" id="section-4-2.3">
          <p id="section-4-2.3.1">some timeout events.<a class="pilcrow" href="#section-4-2.3.1">Â¶</a></p>
</li>
      </ul>
<p id="section-4-3">The state diagram in the figures below illustrates state changes, together
with the causing events and resulting actions.
Note that some of the error conditions are not shown in the state diagram.
Full descriptions of all special cases are found in the text.<a class="pilcrow" href="#section-4-3">Â¶</a></p>
<p id="section-4-4">Note: Chunk names are given in all capital letters, while parameter
names have the first letter capitalized, e.g., COOKIE ECHO chunk type
vs. State Cookie parameter.
If more than one event/message can occur that causes a state transition, it
is labeled (A) or (B).<a class="pilcrow" href="#section-4-4">Â¶</a></p>
<span id="name-state-transition-diagram-of"></span><div id="fig_state_diagram">
<figure id="figure-3">
        <div class="alignCenter art-text artwork" id="section-4-5.1">
<pre>                        -----          -------- (from any state)
                      /       \      /receive ABORT      [ABORT]
        receive INIT |         |    |--------------  or ----------
---------------------|         v    v    delete TCB     send ABORT
generate State Cookie \    +---------+                  delete TCB
        send INIT ACK   ---|  CLOSED |
                           +---------+
                             /      \
                            /        \  [ASSOCIATE]
                           |          |-----------------
                           |          | create TCB
                           |          | send INIT
          receive valid    |          | start T1-init timer
          COOKIE  ECHO     |          v
      (1) -----------------|    +-----------+
          create TCB       |    |COOKIE-WAIT| (2)
          send COOKIE ACK  |    +-----------+
                           |          |
                           |          | receive INIT ACK
                           |          |-------------------
                           |          | send COOKIE ECHO
                           |          | stop T1-init timer
                           |          | start T1-cookie timer
                           |          v
                           |   +-------------+
                           |   |COOKIE-ECHOED| (3)
                           |   +-------------+
                           |          |
                           |          | receive COOKIE ACK
                           |          |-------------------
                           |          | stop T1-cookie timer
                           v          v
                         +---------------+
                         |  ESTABLISHED  |
                         +---------------+
                                 |
                                 |
                        /--------+--------\
    [SHUTDOWN]         /                   \
    -------------------|                   |
    check outstanding  |                   |
    DATA chunks        |                   |
                       v                   |
              +----------------+           |
              |SHUTDOWN-PENDING|           | receive SHUTDOWN
              +----------------+           |------------------
                                           | check outstanding
                       |                   | DATA chunks
No more outstanding    |                   |
-----------------------|                   |
send SHUTDOWN          |                   |
start T2-shutdown timer|                   |
                       v                   v
                +-------------+   +-----------------+
            (4) |SHUTDOWN-SENT|   |SHUTDOWN-RECEIVED| (5,6)
                +-------------+   +-----------------+
                       |  \                |
receive SHUTDOWN ACK   |   \               |
-----------------------|    \              |
stop T2-shutdown timer |     \             |
send SHUTDOWN COMPLETE |      \            |
delete TCB             |       \           |
                       |        \          | No more outstanding
                       |         \         |--------------------
                       |          \        | send SHUTDOWN ACK
receive SHUTDOWN      -|-          \       | start T2-shutdown timer
--------------------/  | \----------\      |
send SHUTDOWN ACK      |             \     |
start T2-shutdown timer|              \    |
                       |               \   |
                       |                |  |
                       |                v  v
                       |          +-----------------+
                       |          |SHUTDOWN-ACK-SENT| (7)
                       |          +-----------------+
                       |                   | (A)
                       |                   |receive SHUTDOWN COMPLETE
                       |                   |-------------------------
                       |                   | stop T2-shutdown timer
                       |                   | delete TCB
                       |                   |
                       |                   | (B)
                       |                   | receive SHUTDOWN ACK
                       |                   |-----------------------
                       |                   | stop T2-shutdown timer
                       |                   | send SHUTDOWN COMPLETE
                       |                   | delete TCB
                       |                   |
                       \    +---------+    /
                        \--&gt;| CLOSED  |&lt;--/
                            +---------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-3">Figure 3</a>:
<a class="selfRef" href="#name-state-transition-diagram-of">State Transition Diagram of SCTP</a>
        </figcaption></figure>
</div>
<p id="section-4-6">The following applies:<a class="pilcrow" href="#section-4-6">Â¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-4-7">
<dt>1)</dt>
<dd id="section-4-7.1">
          <p id="section-4-7.1.1">If the State Cookie in the received COOKIE ECHO chunk is invalid (i.e.,
failed to pass the integrity check), the receiver <span class="bcp14">MUST</span> silently discard
the packet.
Or, if the received State Cookie is expired (see
<a class="xref" href="#sec_state_coockie_authentication">Section 5.1.5</a>), the receiver <span class="bcp14">MUST</span> send back
an ERROR chunk.
In either case, the receiver stays in the CLOSED state.<a class="pilcrow" href="#section-4-7.1.1">Â¶</a></p>
</dd>
        <dd class="break"></dd>
<dt>2)</dt>
<dd id="section-4-7.2">
          <p id="section-4-7.2.1">If the T1-init timer expires, the endpoint <span class="bcp14">MUST</span>
retransmit the INIT chunk and restart the T1-init timer.
The endpoint stays in the COOKIE-WAIT state.
This <span class="bcp14">MUST</span> be repeated up to 'Max.Init.Retransmits' times.
After that, the endpoint <span class="bcp14">MUST</span> abort the initialization process and report the
error to the SCTP user.<a class="pilcrow" href="#section-4-7.2.1">Â¶</a></p>
</dd>
        <dd class="break"></dd>
<dt>3)</dt>
<dd id="section-4-7.3">
          <p id="section-4-7.3.1">If the T1-cookie timer expires, the endpoint <span class="bcp14">MUST</span>
retransmit COOKIE ECHO chunk and restart the T1-cookie timer.
The endpoint stays in the COOKIE-ECHOED state.
This <span class="bcp14">MUST</span> be repeated up to 'Max.Init.Retransmits' times.
After that, the endpoint <span class="bcp14">MUST</span> abort the initialization process and report the
error to the SCTP user.<a class="pilcrow" href="#section-4-7.3.1">Â¶</a></p>
</dd>
        <dd class="break"></dd>
<dt>4)</dt>
<dd id="section-4-7.4">
          <p id="section-4-7.4.1">In the SHUTDOWN-SENT state, the endpoint <span class="bcp14">MUST</span> acknowledge any
received DATA chunks without delay.<a class="pilcrow" href="#section-4-7.4.1">Â¶</a></p>
</dd>
        <dd class="break"></dd>
<dt>5)</dt>
<dd id="section-4-7.5">
          <p id="section-4-7.5.1">In the SHUTDOWN-RECEIVED state, the endpoint <span class="bcp14">MUST NOT</span> accept any
new send requests from its SCTP user.<a class="pilcrow" href="#section-4-7.5.1">Â¶</a></p>
</dd>
        <dd class="break"></dd>
<dt>6)</dt>
<dd id="section-4-7.6">
          <p id="section-4-7.6.1">In the SHUTDOWN-RECEIVED state, the endpoint <span class="bcp14">MUST</span> transmit or retransmit
data and leave this state when all data in queue is transmitted.<a class="pilcrow" href="#section-4-7.6.1">Â¶</a></p>
</dd>
        <dd class="break"></dd>
<dt>7)</dt>
<dd id="section-4-7.7">
          <p id="section-4-7.7.1">In the SHUTDOWN-ACK-SENT state, the endpoint <span class="bcp14">MUST NOT</span> accept any new send
requests from its SCTP user.<a class="pilcrow" href="#section-4-7.7.1">Â¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-4-8">The CLOSED state is used to indicate that an association is not created
(i.e., does not exist).<a class="pilcrow" href="#section-4-8">Â¶</a></p>
</section>
</div>
<div id="sec_assoc_initialization">
<section id="section-5">
      <h2 id="name-association-initialization">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-association-initialization">Association Initialization</a>
      </h2>
<p id="section-5-1">Before the first data transmission can take place from one SCTP
endpoint ("A") to another SCTP endpoint ("Z"), the two endpoints <span class="bcp14">MUST</span>
complete an initialization process in order to set up an SCTP
association between them.<a class="pilcrow" href="#section-5-1">Â¶</a></p>
<p id="section-5-2">The SCTP user at an endpoint can use the ASSOCIATE primitive to
initialize an SCTP association to another SCTP endpoint.<a class="pilcrow" href="#section-5-2">Â¶</a></p>
<p id="section-5-3">Implementation Note: From an SCTP user's point of view, an
association might be implicitly opened, without an ASSOCIATE primitive
(see <a class="xref" href="#sec_associate">Section 11.1.2</a>) being invoked, by the initiating
endpoint's sending of the first user data to the destination endpoint.
The initiating SCTP will assume default values for all mandatory and
optional parameters for the INIT/INIT ACK chunk.<a class="pilcrow" href="#section-5-3">Â¶</a></p>
<p id="section-5-4">Once the association is established, unidirectional streams are open
for data transfer on both ends
(see <a class="xref" href="#sec_handle_stream_parameters">Section 5.1.1</a>).<a class="pilcrow" href="#section-5-4">Â¶</a></p>
<div id="sec_normal_establishment">
<section id="section-5.1">
        <h3 id="name-normal-establishment-of-an-">
<a class="section-number selfRef" href="#section-5.1">5.1. </a><a class="section-name selfRef" href="#name-normal-establishment-of-an-">Normal Establishment of an Association</a>
        </h3>
<p id="section-5.1-1">The initialization process consists of the following steps (assuming that
SCTP endpoint "A" tries to set up an association with SCTP endpoint "Z" and
"Z" accepts the new association):<a class="pilcrow" href="#section-5.1-1">Â¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-5.1-2">
<dt>A)</dt>
<dd id="section-5.1-2.1">
            <p id="section-5.1-2.1.1">"A" first builds a TCB and sends an INIT chunk to "Z".
In the INIT chunk, "A" <span class="bcp14">MUST</span> provide its Verification Tag (Tag_A) in the
Initiate Tag field.
Tag_A <span class="bcp14">SHOULD</span> be a random number in the range of 1 to 4294967295
(see <a class="xref" href="#sec_selection_of_tag_value">Section 5.3.1</a> for Tag value selection).
After sending the INIT chunk, "A" starts the T1-init timer and enters the
COOKIE-WAIT state.<a class="pilcrow" href="#section-5.1-2.1.1">Â¶</a></p>
</dd>
          <dd class="break"></dd>
<dt>B)</dt>
<dd id="section-5.1-2.2">
            <p id="section-5.1-2.2.1">"Z" responds immediately with an INIT ACK chunk.
The destination IP address of the INIT ACK chunk <span class="bcp14">MUST</span> be set to the source
IP address of the INIT chunk to which this INIT ACK chunk is responding.
In the response, besides filling in other parameters, "Z" <span class="bcp14">MUST</span> set the
Verification Tag field to Tag_A and also provide its own
Verification Tag (Tag_Z) in the Initiate Tag field.<a class="pilcrow" href="#section-5.1-2.2.1">Â¶</a></p>
<p id="section-5.1-2.2.2">Moreover, "Z" <span class="bcp14">MUST</span> generate and send along with the INIT ACK chunk a 
State Cookie.
See <a class="xref" href="#sec_generating_state_cookie">Section 5.1.3</a> for State Cookie generation.<a class="pilcrow" href="#section-5.1-2.2.2">Â¶</a></p>
<p id="section-5.1-2.2.3">After sending an INIT ACK chunk with the State Cookie parameter,
"Z" <span class="bcp14">MUST NOT</span> allocate any resources or keep any states for the new
association.
Otherwise, "Z" will be vulnerable to resource attacks.<a class="pilcrow" href="#section-5.1-2.2.3">Â¶</a></p>
</dd>
          <dd class="break"></dd>
<dt>C)</dt>
<dd id="section-5.1-2.3">
            <p id="section-5.1-2.3.1">Upon reception of the INIT ACK chunk from "Z", "A" stops the T1-init
timer and leaves the COOKIE-WAIT state.
"A" then sends the State Cookie received in the INIT ACK chunk in a
COOKIE ECHO chunk, starts the T1-cookie timer, and enters the COOKIE-ECHOED
state.<a class="pilcrow" href="#section-5.1-2.3.1">Â¶</a></p>
<p id="section-5.1-2.3.2">The COOKIE ECHO chunk <span class="bcp14">MAY</span> be bundled with any pending outbound DATA
chunks, but it <span class="bcp14">MUST</span> be the first chunk in the packet and, until the COOKIE ACK
chunk is returned, the sender <span class="bcp14">MUST NOT</span> send any other packets to the peer.<a class="pilcrow" href="#section-5.1-2.3.2">Â¶</a></p>
</dd>
          <dd class="break"></dd>
<dt>D)</dt>
<dd id="section-5.1-2.4">
            <p id="section-5.1-2.4.1">Upon reception of the COOKIE ECHO chunk, endpoint "Z" replies
with a COOKIE ACK chunk after building a TCB and moving to the
ESTABLISHED state.
A COOKIE ACK chunk <span class="bcp14">MAY</span> be bundled with any pending DATA chunks
(and/or SACK chunks), but the COOKIE ACK chunk <span class="bcp14">MUST</span> be the first chunk in
the packet.<a class="pilcrow" href="#section-5.1-2.4.1">Â¶</a></p>
<p id="section-5.1-2.4.2">Implementation Note: An implementation can choose to send the
COMMUNICATION UP notification to the SCTP user upon reception of a
valid COOKIE ECHO chunk.<a class="pilcrow" href="#section-5.1-2.4.2">Â¶</a></p>
</dd>
          <dd class="break"></dd>
<dt>E)</dt>
<dd id="section-5.1-2.5">
            <p id="section-5.1-2.5.1">Upon reception of the COOKIE ACK chunk, endpoint "A" moves from the
COOKIE-ECHOED state to the ESTABLISHED state, stopping the T1-cookie timer.
It can also notify its ULP about the successful establishment of the
association with a COMMUNICATION UP notification
(see <a class="xref" href="#sec_api">Section 11</a>).<a class="pilcrow" href="#section-5.1-2.5.1">Â¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-5.1-3">An INIT or INIT ACK chunk <span class="bcp14">MUST NOT</span> be bundled with any other chunk.
They <span class="bcp14">MUST</span> be the only chunks present in the SCTP packets that carry them.<a class="pilcrow" href="#section-5.1-3">Â¶</a></p>
<p id="section-5.1-4">An endpoint <span class="bcp14">MUST</span> send the INIT ACK chunk to the IP address from which it
received the INIT chunk.<a class="pilcrow" href="#section-5.1-4">Â¶</a></p>
<p id="section-5.1-5">The T1-init timer and T1-cookie timer <span class="bcp14">SHOULD</span> follow the same rules
given in <a class="xref" href="#sec_management_of_retransission_timer">Section 6.3</a>.
If the application provided multiple IP addresses of the peer, there <span class="bcp14">SHOULD</span>
be a T1-init and T1-cookie timer for each address of the peer. Retransmissions
of INIT chunks and COOKIE ECHO chunks <span class="bcp14">SHOULD</span> use all addresses of the peer
similar to retransmissions of DATA chunks.<a class="pilcrow" href="#section-5.1-5">Â¶</a></p>
<p id="section-5.1-6">If an endpoint receives an INIT, INIT ACK, or COOKIE ECHO chunk but decides
not to establish the new association due to missing mandatory parameters in the
received INIT or INIT ACK chunk, invalid parameter values, or lack of local
resources, it <span class="bcp14">SHOULD</span> respond with an ABORT chunk.
It <span class="bcp14">SHOULD</span> also specify the cause of abort, such as the type of the missing
mandatory parameters, etc., by including an error cause in the ABORT chunk.
The Verification Tag field in the common header of the outbound SCTP packet
containing the ABORT chunk <span class="bcp14">MUST</span> be set to the Initiate Tag value of the
received INIT or INIT ACK chunk this ABORT chunk is responding to.<a class="pilcrow" href="#section-5.1-6">Â¶</a></p>
<p id="section-5.1-7">Note that a COOKIE ECHO chunk that does not pass the integrity check
is not considered an 'invalid mandatory parameter' and requires special
handling; see <a class="xref" href="#sec_state_coockie_authentication">Section 5.1.5</a>.<a class="pilcrow" href="#section-5.1-7">Â¶</a></p>
<p id="section-5.1-8">After the reception of the first DATA chunk in an association, the
endpoint <span class="bcp14">MUST</span> immediately respond with a SACK chunk to acknowledge the DATA
chunk.
Subsequent acknowledgements <span class="bcp14">SHOULD</span> be done as described in
<a class="xref" href="#sec_acknowledgements_of_reception_of_data_chunks">Section 6.2</a>.<a class="pilcrow" href="#section-5.1-8">Â¶</a></p>
<p id="section-5.1-9">When the TCB is created, each endpoint <span class="bcp14">MUST</span> set its internal
Cumulative TSN Ack Point to the value of its transmitted Initial TSN
minus one.<a class="pilcrow" href="#section-5.1-9">Â¶</a></p>
<p id="section-5.1-10">Implementation Note: The IP addresses and SCTP port are generally
used as the key to find the TCB within an SCTP instance.<a class="pilcrow" href="#section-5.1-10">Â¶</a></p>
<div id="sec_handle_stream_parameters">
<section id="section-5.1.1">
          <h4 id="name-handle-stream-parameters">
<a class="section-number selfRef" href="#section-5.1.1">5.1.1. </a><a class="section-name selfRef" href="#name-handle-stream-parameters">Handle Stream Parameters</a>
          </h4>
<p id="section-5.1.1-1">In the INIT and INIT ACK chunks, the sender of the chunk <span class="bcp14">MUST</span>
indicate the number of outbound streams (OS) it wishes to have in
the association, as well as the maximum inbound streams (MIS) it
will accept from the other endpoint.<a class="pilcrow" href="#section-5.1.1-1">Â¶</a></p>
<p id="section-5.1.1-2">After receiving the stream configuration information from the other
side, each endpoint <span class="bcp14">MUST</span> perform the following check:
If the peer's MIS is less than the endpoint's OS, meaning that the peer is
incapable of supporting all the outbound streams the endpoint wants
to configure, the endpoint <span class="bcp14">MUST</span> use MIS outbound streams and <span class="bcp14">MAY</span>
report any shortage to the upper layer.
The upper layer can then choose to abort the association if the resource
shortage is unacceptable.<a class="pilcrow" href="#section-5.1.1-2">Â¶</a></p>
<p id="section-5.1.1-3">After the association is initialized, the valid outbound stream identifier
range for either endpoint <span class="bcp14">MUST</span> be 0 to min(local OS, remote MIS) - 1.<a class="pilcrow" href="#section-5.1.1-3">Â¶</a></p>
</section>
</div>
<div id="sec_handle_address_parameters">
<section id="section-5.1.2">
          <h4 id="name-handle-address-parameters">
<a class="section-number selfRef" href="#section-5.1.2">5.1.2. </a><a class="section-name selfRef" href="#name-handle-address-parameters">Handle Address Parameters</a>
          </h4>
<p id="section-5.1.2-1">During the association initialization, an endpoint uses the
following rules to discover and collect the destination transport address(es)
of its peer.<a class="pilcrow" href="#section-5.1.2-1">Â¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-5.1.2-2">
<dt>A)</dt>
<dd id="section-5.1.2-2.1">
              <p id="section-5.1.2-2.1.1">If there are no address parameters present in the received INIT or
INIT ACK chunk, the endpoint <span class="bcp14">MUST</span> take the source IP address from
which the chunk arrives and record it, in combination with the
SCTP Source Port Number, as the only destination transport address
for this peer.<a class="pilcrow" href="#section-5.1.2-2.1.1">Â¶</a></p>
</dd>
            <dd class="break"></dd>
<dt>B)</dt>
<dd id="section-5.1.2-2.2">
              <p id="section-5.1.2-2.2.1">If there is a Host Name Address parameter present in the received INIT or
INIT ACK chunk, the endpoint <span class="bcp14">MUST</span> immediately send an ABORT chunk and <span class="bcp14">MAY</span>
include an "Unresolvable Address" error cause to its peer.
The ABORT chunk <span class="bcp14">SHOULD</span> be sent to the source IP address from which the last peer
packet was received.<a class="pilcrow" href="#section-5.1.2-2.2.1">Â¶</a></p>
</dd>
            <dd class="break"></dd>
<dt>C)</dt>
<dd id="section-5.1.2-2.3">
              <p id="section-5.1.2-2.3.1">If there are only IPv4/IPv6 addresses present in the received INIT or
INIT ACK chunk, the receiver <span class="bcp14">MUST</span> derive and record all the transport addresses
from the received chunk AND the source IP address that sent the INIT or
INIT ACK chunk.
The transport addresses are derived by the combination of SCTP Source Port Number
(from the common header) and the IP Address parameter(s) carried in the INIT
or INIT ACK chunk and the source IP address of the IP datagram.
The receiver <span class="bcp14">SHOULD</span> use only these transport addresses as destination
transport addresses when sending subsequent packets to its peer.<a class="pilcrow" href="#section-5.1.2-2.3.1">Â¶</a></p>
</dd>
            <dd class="break"></dd>
<dt>D)</dt>
<dd id="section-5.1.2-2.4">
              <p id="section-5.1.2-2.4.1">An INIT or INIT ACK chunk <span class="bcp14">MUST</span> be treated as belonging to an already
established association (or one in the process of being established) if the
use of any of the valid address parameters contained within the chunk would
identify an existing TCB.<a class="pilcrow" href="#section-5.1.2-2.4.1">Â¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-5.1.2-3">Implementation Note: In some cases (e.g., when the implementation does not
control the source IP address that is used for transmitting), an endpoint
might need to include in its INIT or INIT ACK chunk all possible IP addresses
from which packets to the peer could be transmitted.<a class="pilcrow" href="#section-5.1.2-3">Â¶</a></p>
<p id="section-5.1.2-4">After all transport addresses are derived from the INIT or INIT ACK chunk
using the above rules, the endpoint selects one of the transport addresses
as the initial primary path.<a class="pilcrow" href="#section-5.1.2-4">Â¶</a></p>
<p id="section-5.1.2-5">The packet containing the INIT ACK chunk <span class="bcp14">MUST</span> be sent to the source address
of the packet containing the INIT chunk.<a class="pilcrow" href="#section-5.1.2-5">Â¶</a></p>
<p id="section-5.1.2-6">The sender of INIT chunks <span class="bcp14">MAY</span> include a 'Supported Address Types' parameter
in the INIT chunk to indicate what types of addresses are acceptable.<a class="pilcrow" href="#section-5.1.2-6">Â¶</a></p>
<p id="section-5.1.2-7">Implementation Note: In the case that the receiver of an INIT ACK chunk
fails to resolve the address parameter due to an unsupported type, it
can abort the initiation process and then attempt a reinitiation by
using a 'Supported Address Types' parameter in the new INIT chunk to indicate
what types of address it prefers.<a class="pilcrow" href="#section-5.1.2-7">Â¶</a></p>
<p id="section-5.1.2-8">If an SCTP endpoint that only supports either IPv4 or
IPv6 receives IPv4 and IPv6 addresses in an INIT or INIT ACK chunk from its
peer, it <span class="bcp14">MUST</span> use all the addresses belonging to the supported address family.
The other addresses <span class="bcp14">MAY</span> be ignored.
The endpoint <span class="bcp14">SHOULD NOT</span> respond with any kind of error indication.<a class="pilcrow" href="#section-5.1.2-8">Â¶</a></p>
<p id="section-5.1.2-9">If an SCTP endpoint lists in the 'Supported Address
Types' parameter either IPv4 or IPv6 but uses the other family for sending
the packet containing the INIT chunk, or if it also lists addresses of the
other family in the INIT chunk, then the address family that is not listed
in the 'Supported Address Types' parameter <span class="bcp14">SHOULD</span> also be considered as
supported by the receiver of the INIT chunk.
The receiver of the INIT chunk <span class="bcp14">SHOULD NOT</span> respond with any kind of error
indication.<a class="pilcrow" href="#section-5.1.2-9">Â¶</a></p>
</section>
</div>
<div id="sec_generating_state_cookie">
<section id="section-5.1.3">
          <h4 id="name-generating-state-cookie">
<a class="section-number selfRef" href="#section-5.1.3">5.1.3. </a><a class="section-name selfRef" href="#name-generating-state-cookie">Generating State Cookie</a>
          </h4>
<p id="section-5.1.3-1">When sending an INIT ACK chunk as a response to an INIT chunk, the sender
of the INIT ACK chunk creates a State Cookie and sends it in the State Cookie
parameter of the INIT ACK chunk.
Inside this State Cookie, the sender <span class="bcp14">MUST</span> include a MAC
(see <span>[<a class="xref" href="#RFC2104">RFC2104</a>]</span> for an example) to provide integrity protection
on the State Cookie.
The State Cookie <span class="bcp14">SHOULD</span> also contain a timestamp on when the
State Cookie is created and the lifespan of the State Cookie, along with all
the information necessary for it to establish the association, including
the port numbers and the Verification Tags.<a class="pilcrow" href="#section-5.1.3-1">Â¶</a></p>
<p id="section-5.1.3-2">The method used to generate the MAC is strictly a private matter for the
receiver of the INIT chunk.
The use of a MAC is mandatory to prevent denial-of-service attacks.
MAC algorithms can have different performances depending on the platform.
Choosing a high-performance MAC algorithm increases the resistance against
cookie flooding attacks.
A MAC with acceptable security properties <span class="bcp14">SHOULD</span> be used.
The secret key <span class="bcp14">SHOULD</span> be random (<span>[<a class="xref" href="#RFC4086">RFC4086</a>]</span> provides some
information on randomness guidelines).
The secret keys need to have an appropriate size.
The secret key <span class="bcp14">SHOULD</span> be changed reasonably frequently (e.g., hourly), and the
timestamp in the State Cookie <span class="bcp14">MAY</span> be used to determine which key is used to
verify the MAC.<a class="pilcrow" href="#section-5.1.3-2">Â¶</a></p>
<p id="section-5.1.3-3">If the State Cookie is not encrypted, it <span class="bcp14">MUST NOT</span> contain information
that is not being envisioned to be shared.<a class="pilcrow" href="#section-5.1.3-3">Â¶</a></p>
<p id="section-5.1.3-4">An implementation <span class="bcp14">SHOULD</span> make the cookie as small as possible to
ensure interoperability.<a class="pilcrow" href="#section-5.1.3-4">Â¶</a></p>
</section>
</div>
<div id="sec_state_coockie_processing">
<section id="section-5.1.4">
          <h4 id="name-state-cookie-processing">
<a class="section-number selfRef" href="#section-5.1.4">5.1.4. </a><a class="section-name selfRef" href="#name-state-cookie-processing">State Cookie Processing</a>
          </h4>
<p id="section-5.1.4-1">When an endpoint (in the COOKIE-WAIT state) receives an INIT ACK
chunk with a State Cookie parameter, it <span class="bcp14">MUST</span> immediately send a
COOKIE ECHO chunk to its peer with the received State Cookie.
The sender <span class="bcp14">MAY</span> also add any pending DATA chunks to the packet after the
COOKIE ECHO chunk.<a class="pilcrow" href="#section-5.1.4-1">Â¶</a></p>
<p id="section-5.1.4-2">The endpoint <span class="bcp14">MUST</span> also start the T1-cookie timer after sending the
COOKIE ECHO chunk.
If the timer expires, the endpoint <span class="bcp14">MUST</span> retransmit the COOKIE ECHO chunk and
restart the T1-cookie timer.
This is repeated until either a COOKIE ACK chunk is received or
'Max.Init.Retransmits' (see <a class="xref" href="#sec_parameter_values">Section 16</a>) is reached,
causing the peer endpoint to be marked unreachable (and thus the association
enters the CLOSED state).<a class="pilcrow" href="#section-5.1.4-2">Â¶</a></p>
</section>
</div>
<div id="sec_state_coockie_authentication">
<section id="section-5.1.5">
          <h4 id="name-state-cookie-authentication">
<a class="section-number selfRef" href="#section-5.1.5">5.1.5. </a><a class="section-name selfRef" href="#name-state-cookie-authentication">State Cookie Authentication</a>
          </h4>
<p id="section-5.1.5-1">When an endpoint receives a COOKIE ECHO chunk from another endpoint
with which it has no association, it takes the following actions:<a class="pilcrow" href="#section-5.1.5-1">Â¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-5.1.5-2">
<dt>1)</dt>
<dd id="section-5.1.5-2.1">
              <p id="section-5.1.5-2.1.1">Compute a MAC using the information carried in the State Cookie and
the secret key.
The timestamp in the State Cookie <span class="bcp14">MAY</span> be used to determine which secret key to
use.
If secrets are kept only for a limited amount of time and the secret key to use
is not available anymore, the packet containing the COOKIE ECHO chunk <span class="bcp14">MUST</span> be
silently discarded.
<span>[<a class="xref" href="#RFC2104">RFC2104</a>]</span> can be used as a guideline for generating the MAC.<a class="pilcrow" href="#section-5.1.5-2.1.1">Â¶</a></p>
</dd>
            <dd class="break"></dd>
<dt>2)</dt>
<dd id="section-5.1.5-2.2">
              <p id="section-5.1.5-2.2.1">Authenticate the State Cookie as one that it previously generated
by comparing the computed MAC against the one carried in the State Cookie.
If this comparison fails, the SCTP packet, including the COOKIE ECHO chunk and
any DATA chunks, <span class="bcp14">MUST</span> be silently discarded.<a class="pilcrow" href="#section-5.1.5-2.2.1">Â¶</a></p>
</dd>
            <dd class="break"></dd>
<dt>3)</dt>
<dd id="section-5.1.5-2.3">
              <p id="section-5.1.5-2.3.1">Compare the port numbers and the Verification Tag contained within the
COOKIE ECHO chunk to the actual port numbers and the Verification Tag within
the SCTP common header of the received packet.
If these values do not match, the packet <span class="bcp14">MUST</span> be silently discarded.<a class="pilcrow" href="#section-5.1.5-2.3.1">Â¶</a></p>
</dd>
            <dd class="break"></dd>
<dt>4)</dt>
<dd id="section-5.1.5-2.4">
              <p id="section-5.1.5-2.4.1">Compare the creation timestamp in the State Cookie to the current local
time.
If the elapsed time is longer than the lifespan carried in the State Cookie,
then the packet, including the COOKIE ECHO chunk and any attached DATA chunks,
<span class="bcp14">SHOULD</span> be discarded, and the endpoint <span class="bcp14">MUST</span> transmit an ERROR chunk with a
"Stale Cookie" error cause to the peer endpoint.<a class="pilcrow" href="#section-5.1.5-2.4.1">Â¶</a></p>
</dd>
            <dd class="break"></dd>
<dt>5)</dt>
<dd id="section-5.1.5-2.5">
              <p id="section-5.1.5-2.5.1">If the State Cookie is valid, create an association to the sender
of the COOKIE ECHO chunk with the information in the State Cookie
carried in the COOKIE ECHO chunk and enter the ESTABLISHED state.<a class="pilcrow" href="#section-5.1.5-2.5.1">Â¶</a></p>
</dd>
            <dd class="break"></dd>
<dt>6)</dt>
<dd id="section-5.1.5-2.6">
              <p id="section-5.1.5-2.6.1">Send a COOKIE ACK chunk to the peer acknowledging receipt of the
COOKIE ECHO chunk.
The COOKIE ACK chunk <span class="bcp14">MAY</span> be bundled with an outbound DATA chunk or SACK chunk;
however, the COOKIE ACK chunk <span class="bcp14">MUST</span> be the first chunk in the SCTP packet.<a class="pilcrow" href="#section-5.1.5-2.6.1">Â¶</a></p>
</dd>
            <dd class="break"></dd>
<dt>7)</dt>
<dd id="section-5.1.5-2.7">
              <p id="section-5.1.5-2.7.1">Immediately acknowledge any DATA chunk bundled with the COOKIE ECHO chunk
with a SACK chunk (subsequent DATA chunk acknowledgement <span class="bcp14">SHOULD</span> follow the rules
defined in <a class="xref" href="#sec_acknowledgements_of_reception_of_data_chunks">Section 6.2</a>).
As mentioned in step 6, if the SACK chunk is bundled with the COOKIE ACK chunk,
the COOKIE ACK chunk <span class="bcp14">MUST</span> appear first in the SCTP packet.<a class="pilcrow" href="#section-5.1.5-2.7.1">Â¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-5.1.5-3">If a COOKIE ECHO chunk is received from an endpoint with which the receiver
of the COOKIE ECHO chunk has an existing association, the procedures in
<a class="xref" href="#sec_handle_duplicate_or_unexpected_chunks">Section 5.2</a> <span class="bcp14">SHOULD</span> be
followed.<a class="pilcrow" href="#section-5.1.5-3">Â¶</a></p>
</section>
</div>
<div id="sec_example_of_normal_association_establishment">
<section id="section-5.1.6">
          <h4 id="name-an-example-of-normal-associ">
<a class="section-number selfRef" href="#section-5.1.6">5.1.6. </a><a class="section-name selfRef" href="#name-an-example-of-normal-associ">An Example of Normal Association Establishment</a>
          </h4>
<p id="section-5.1.6-1">In the following example, "A" initiates the association and then sends a
user message to "Z"; then, "Z" sends two user messages to "A" later
(assuming no bundling or fragmentation occurs):<a class="pilcrow" href="#section-5.1.6-1">Â¶</a></p>
<span id="name-a-setup-example"></span><div id="fig_initiation_example">
<figure id="figure-4">
            <div class="alignCenter art-text artwork" id="section-5.1.6-2.1">
<pre>Endpoint A                                          Endpoint Z
{app sets association with Z}
(build TCB)
INIT [I-Tag=Tag_A
      &amp; other info]  ------\
(Start T1-init timer)       \
(Enter COOKIE-WAIT state)    \---&gt; (compose Cookie_Z)
                                /-- INIT ACK [Veri Tag=Tag_A,
                               /             I-Tag=Tag_Z,
(Cancel T1-init timer) &lt;------/              Cookie_Z, &amp; other info]

COOKIE ECHO [Cookie_Z] ------\
(Start T1-cookie timer)       \
(Enter COOKIE-ECHOED state)    \---&gt; (build TCB, enter ESTABLISHED
                                      state)
                               /---- COOKIE ACK
                              /
(Cancel T1-cookie timer, &lt;---/
 enter ESTABLISHED state)
{app sends 1st user data; strm 0}
DATA [TSN=init TSN_A
    Strm=0,Seq=0 &amp; user data]--\
(Start T3-rtx timer)            \
                                 \-&gt;
                               /----- SACK [TSN Ack=init TSN_A,
                                            Block=0]
(Cancel T3-rtx timer) &lt;------/
                                      ...
                                     {app sends 2 messages;strm 0}
                               /---- DATA
                              /        [TSN=init TSN_Z,
                          &lt;--/          Strm=0,Seq=0 &amp; user data 1]
SACK [TSN Ack=init TSN_Z,      /---- DATA
      Block=0]     --------\  /        [TSN=init TSN_Z +1,
                            \/          Strm=0,Seq=1 &amp; user data 2]
                     &lt;------/\
                              \
                               \------&gt;
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-4">Figure 4</a>:
<a class="selfRef" href="#name-a-setup-example">A Setup Example</a>
            </figcaption></figure>
</div>
<p id="section-5.1.6-3">If the T1-init timer expires at "A" after the INIT or COOKIE ECHO chunks
are sent, the same INIT or COOKIE ECHO chunk with the same Initiate Tag
(i.e., Tag_A) or State Cookie is retransmitted and the timer is restarted.
This is repeated 'Max.Init.Retransmits' times before "A" considers "Z"
unreachable and reports the failure to its upper layer (and thus the
association enters the CLOSED state).<a class="pilcrow" href="#section-5.1.6-3">Â¶</a></p>
<p id="section-5.1.6-4">When retransmitting the INIT chunk, the endpoint <span class="bcp14">MUST</span> follow the rules
defined in <a class="xref" href="#sec_management_of_retransission_timer">Section 6.3</a> to determine
the proper timer value.<a class="pilcrow" href="#section-5.1.6-4">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec_handle_duplicate_or_unexpected_chunks">
<section id="section-5.2">
        <h3 id="name-handle-duplicate-or-unexpec">
<a class="section-number selfRef" href="#section-5.2">5.2. </a><a class="section-name selfRef" href="#name-handle-duplicate-or-unexpec">Handle Duplicate or Unexpected INIT, INIT ACK, COOKIE ECHO, and COOKIE ACK Chunks</a>
        </h3>
<p id="section-5.2-1">During the life time of an association (in one of the possible states),
an endpoint can receive from its peer endpoint one of the setup chunks (INIT,
INIT ACK, COOKIE ECHO, or COOKIE ACK).
The receiver treats such a setup chunk as a duplicate and process it
as described in this section.<a class="pilcrow" href="#section-5.2-1">Â¶</a></p>
<p id="section-5.2-2">Note: An endpoint will not receive the chunk unless the chunk was sent to
an SCTP transport address and is from an SCTP transport address associated
with this endpoint.
Therefore, the endpoint processes such a chunk as part of its current
association.<a class="pilcrow" href="#section-5.2-2">Â¶</a></p>
<p id="section-5.2-3">The following scenarios can cause duplicated or unexpected chunks:<a class="pilcrow" href="#section-5.2-3">Â¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-5.2-4">
<dt>A)</dt>
<dd id="section-5.2-4.1">
            <p id="section-5.2-4.1.1">the peer has crashed without being detected, restarted itself, and
sent a new INIT chunk trying to restore the association,<a class="pilcrow" href="#section-5.2-4.1.1">Â¶</a></p>
</dd>
          <dd class="break"></dd>
<dt>B)</dt>
<dd id="section-5.2-4.2">
            <p id="section-5.2-4.2.1">both sides are trying to initialize the association at about the same
time,<a class="pilcrow" href="#section-5.2-4.2.1">Â¶</a></p>
</dd>
          <dd class="break"></dd>
<dt>C)</dt>
<dd id="section-5.2-4.3">
            <p id="section-5.2-4.3.1">the chunk is from a stale packet that was used to establish the present
association or a past association that is no longer in existence,<a class="pilcrow" href="#section-5.2-4.3.1">Â¶</a></p>
</dd>
          <dd class="break"></dd>
<dt>D)</dt>
<dd id="section-5.2-4.4">
            <p id="section-5.2-4.4.1">the chunk is a false packet generated by an attacker, or<a class="pilcrow" href="#section-5.2-4.4.1">Â¶</a></p>
</dd>
          <dd class="break"></dd>
<dt>E)</dt>
<dd id="section-5.2-4.5">
            <p id="section-5.2-4.5.1">the peer never received the COOKIE ACK chunk and is retransmitting its
COOKIE ECHO chunk.<a class="pilcrow" href="#section-5.2-4.5.1">Â¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-5.2-5">The rules in the following sections are applied in order to identify
and correctly handle these cases.<a class="pilcrow" href="#section-5.2-5">Â¶</a></p>
<section id="section-5.2.1">
          <h4 id="name-init-chunk-received-in-cook">
<a class="section-number selfRef" href="#section-5.2.1">5.2.1. </a><a class="section-name selfRef" href="#name-init-chunk-received-in-cook">INIT Chunk Received in COOKIE-WAIT or COOKIE-ECHOED State (Item B)</a>
          </h4>
<p id="section-5.2.1-1">This usually indicates an initialization collision, i.e., each endpoint
is attempting, at about the same time, to establish an association with the
other endpoint.<a class="pilcrow" href="#section-5.2.1-1">Â¶</a></p>
<p id="section-5.2.1-2">Upon receipt of an INIT chunk in the COOKIE-WAIT state, an endpoint <span class="bcp14">MUST</span>
respond with an INIT ACK chunk using the same parameters it sent in its
original INIT chunk (including its Initiate Tag, unchanged).
When responding, the following rules <span class="bcp14">MUST</span> be applied:<a class="pilcrow" href="#section-5.2.1-2">Â¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-5.2.1-3">
<dt>1)</dt>
<dd id="section-5.2.1-3.1">
              <p id="section-5.2.1-3.1.1">The packet containing the INIT ACK chunk <span class="bcp14">MUST</span> only be sent to an address
passed by the upper layer in the request to initialize the association.<a class="pilcrow" href="#section-5.2.1-3.1.1">Â¶</a></p>
</dd>
            <dd class="break"></dd>
<dt>2)</dt>
<dd id="section-5.2.1-3.2">
              <p id="section-5.2.1-3.2.1">The packet containing the INIT ACK chunk <span class="bcp14">MUST</span> only be sent to an address
reported in the incoming INIT chunk.<a class="pilcrow" href="#section-5.2.1-3.2.1">Â¶</a></p>
</dd>
            <dd class="break"></dd>
<dt>3)</dt>
<dd id="section-5.2.1-3.3">
              <p id="section-5.2.1-3.3.1">The packet containing the INIT ACK chunk <span class="bcp14">SHOULD</span> be sent to the source
address of the received packet containing the INIT chunk.<a class="pilcrow" href="#section-5.2.1-3.3.1">Â¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-5.2.1-4">Upon receipt of an INIT chunk in the COOKIE-ECHOED state, an endpoint <span class="bcp14">MUST</span>
respond with an INIT ACK chunk using the same parameters it sent in its
original INIT chunk (including its Initiate Tag, unchanged), provided
that no new address has been added to the forming association.
If the INIT chunk indicates that a new address has been added to the
association, then the entire INIT chunk <span class="bcp14">MUST</span> be discarded, and the state of
the existing association <span class="bcp14">SHOULD NOT</span> be changed.
An ABORT chunk <span class="bcp14">SHOULD</span> be sent in a response that <span class="bcp14">MAY</span> include the
"Restart of an Association with New Addresses" error cause.
The error <span class="bcp14">SHOULD</span> list the addresses that were added to the restarting
association.<a class="pilcrow" href="#section-5.2.1-4">Â¶</a></p>
<p id="section-5.2.1-5">When responding in either state (COOKIE-WAIT or COOKIE-ECHOED) with
an INIT ACK chunk, the original parameters are combined with those from the
newly received INIT chunk.
The endpoint <span class="bcp14">MUST</span> also generate a State Cookie with the INIT ACK chunk.
The endpoint uses the parameters sent in its INIT chunk to calculate the
State Cookie.<a class="pilcrow" href="#section-5.2.1-5">Â¶</a></p>
<p id="section-5.2.1-6">After that, the endpoint <span class="bcp14">MUST NOT</span> change its state, the T1-init timer
<span class="bcp14">MUST</span> be left running, and the corresponding TCB <span class="bcp14">MUST NOT</span> be destroyed.
The normal procedures for handling State Cookies when a
TCB exists will resolve the duplicate INIT chunks to a single association.<a class="pilcrow" href="#section-5.2.1-6">Â¶</a></p>
<p id="section-5.2.1-7">For an endpoint that is in the COOKIE-ECHOED state, it <span class="bcp14">MUST</span> populate
its Tie-Tags within both the association TCB and inside the State Cookie (see
<a class="xref" href="#sec_unexpected_init_in_states_other_than_closed_cookie_echoed">Section 5.2.2</a>
for a description of the Tie-Tags).<a class="pilcrow" href="#section-5.2.1-7">Â¶</a></p>
</section>
<div id="sec_unexpected_init_in_states_other_than_closed_cookie_echoed">
<section id="section-5.2.2">
          <h4 id="name-unexpected-init-chunk-in-st">
<a class="section-number selfRef" href="#section-5.2.2">5.2.2. </a><a class="section-name selfRef" href="#name-unexpected-init-chunk-in-st">Unexpected INIT Chunk in States Other than CLOSED, COOKIE-ECHOED, COOKIE-WAIT, and SHUTDOWN-ACK-SENT</a>
          </h4>
<p id="section-5.2.2-1">Unless otherwise stated, upon receipt of an unexpected INIT chunk for this
association, the endpoint <span class="bcp14">MUST</span> generate an INIT ACK chunk with a State Cookie.
Before responding, the endpoint <span class="bcp14">MUST</span> check to see if the unexpected INIT chunk
adds new addresses to the association.
If new addresses are added to the association, the endpoint <span class="bcp14">MUST</span> respond with
an ABORT chunk, copying the 'Initiate Tag' of the unexpected INIT chunk into the
'Verification Tag' of the outbound packet carrying the ABORT chunk.
In the ABORT chunk, the error cause <span class="bcp14">MAY</span> be set to "Restart of an
Association with New Addresses".
The error <span class="bcp14">SHOULD</span> list the addresses that were added to the restarting
association.
If no new addresses are added, when responding to the INIT chunk in the outbound
INIT ACK chunk, the endpoint <span class="bcp14">MUST</span> copy its current Tie-Tags to a reserved place
within the State Cookie and the association's TCB.
We refer to these locations inside the cookie as the Peer's-Tie-Tag and
the Local-Tie-Tag.
We will refer to the copy within an association's TCB as the Local Tag and
Peer's Tag.
The outbound SCTP packet containing this INIT ACK chunk <span class="bcp14">MUST</span> carry a
Verification Tag value equal to the Initiate Tag found in the unexpected
INIT chunk.
And the INIT ACK chunk <span class="bcp14">MUST</span> contain a new Initiate Tag
(randomly generated; see <a class="xref" href="#sec_selection_of_tag_value">Section 5.3.1</a>).
Other parameters for the endpoint <span class="bcp14">SHOULD</span> be copied from the existing
parameters of the association (e.g., number of outbound streams) into the
INIT ACK chunk and cookie.<a class="pilcrow" href="#section-5.2.2-1">Â¶</a></p>
<p id="section-5.2.2-2">After sending the INIT ACK or ABORT chunk, the endpoint <span class="bcp14">MUST</span> take no
further actions,
i.e., the existing association, including its current state, and the
corresponding TCB <span class="bcp14">MUST NOT</span> be changed.<a class="pilcrow" href="#section-5.2.2-2">Â¶</a></p>
<p id="section-5.2.2-3">Only when a TCB exists and the association is not in a COOKIE-WAIT
or SHUTDOWN-ACK-SENT state are the Tie-Tags populated with a random value
other than 0.
For a normal association INIT chunk (i.e., the endpoint is in the CLOSED state),
the Tie-Tags <span class="bcp14">MUST</span> be set to 0 (indicating that no previous TCB existed).<a class="pilcrow" href="#section-5.2.2-3">Â¶</a></p>
</section>
</div>
<div id="sec_unexpected_init_ack">
<section id="section-5.2.3">
          <h4 id="name-unexpected-init-ack-chunk">
<a class="section-number selfRef" href="#section-5.2.3">5.2.3. </a><a class="section-name selfRef" href="#name-unexpected-init-ack-chunk">Unexpected INIT ACK Chunk</a>
          </h4>
<p id="section-5.2.3-1">If an INIT ACK chunk is received by an endpoint in any state other than the
COOKIE-WAIT or CLOSED state, the endpoint <span class="bcp14">SHOULD</span> discard the INIT ACK chunk.
An unexpected INIT ACK chunk usually indicates the processing of an old or
duplicated INIT chunk.<a class="pilcrow" href="#section-5.2.3-1">Â¶</a></p>
</section>
</div>
<div id="sec_handle_a_cookie_echo_when_a_tcp_exists">
<section id="section-5.2.4">
          <h4 id="name-handle-a-cookie-echo-chunk-">
<a class="section-number selfRef" href="#section-5.2.4">5.2.4. </a><a class="section-name selfRef" href="#name-handle-a-cookie-echo-chunk-">Handle a COOKIE ECHO Chunk When a TCB Exists</a>
          </h4>
<p id="section-5.2.4-1">When a COOKIE ECHO chunk is received by an endpoint in any state for an
existing association (i.e., not in the CLOSED state), the following rules
are applied:<a class="pilcrow" href="#section-5.2.4-1">Â¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-5.2.4-2">
<dt>1)</dt>
<dd id="section-5.2.4-2.1">
              <p id="section-5.2.4-2.1.1">Compute a MAC as described in step 1 of
<a class="xref" href="#sec_state_coockie_authentication">Section 5.1.5</a>.<a class="pilcrow" href="#section-5.2.4-2.1.1">Â¶</a></p>
</dd>
            <dd class="break"></dd>
<dt>2)</dt>
<dd id="section-5.2.4-2.2">
              <p id="section-5.2.4-2.2.1">Authenticate the State Cookie as described in step 2 of
<a class="xref" href="#sec_state_coockie_authentication">Section 5.1.5</a>
(this is case C or D above).<a class="pilcrow" href="#section-5.2.4-2.2.1">Â¶</a></p>
</dd>
            <dd class="break"></dd>
<dt>3)</dt>
<dd id="section-5.2.4-2.3">
              <p id="section-5.2.4-2.3.1">Compare the timestamp in the State Cookie to the current time.
If the State Cookie is older than the lifespan carried in the State Cookie
and the Verification Tags contained in the State Cookie do not match the
current association's Verification Tags, the packet, including the COOKIE ECHO
chunk and any DATA chunks, <span class="bcp14">SHOULD</span> be discarded.
The endpoint also <span class="bcp14">MUST</span> transmit an ERROR chunk with a "Stale Cookie" error cause
to the peer endpoint (this is case C or D in
<a class="xref" href="#sec_handle_duplicate_or_unexpected_chunks">Section 5.2</a>).<a class="pilcrow" href="#section-5.2.4-2.3.1">Â¶</a></p>
<p id="section-5.2.4-2.3.2">If both Verification Tags in the State Cookie match the Verification Tags of
the current association, consider the State Cookie valid (this is case E in
<a class="xref" href="#sec_handle_duplicate_or_unexpected_chunks">Section 5.2</a>), even if the
lifespan is exceeded.<a class="pilcrow" href="#section-5.2.4-2.3.2">Â¶</a></p>
</dd>
            <dd class="break"></dd>
<dt>4)</dt>
<dd id="section-5.2.4-2.4">
              <p id="section-5.2.4-2.4.1">If the State Cookie proves to be valid, unpack the TCB into a
temporary TCB.<a class="pilcrow" href="#section-5.2.4-2.4.1">Â¶</a></p>
</dd>
            <dd class="break"></dd>
<dt>5)</dt>
<dd id="section-5.2.4-2.5">
              <p id="section-5.2.4-2.5.1">Refer to <a class="xref" href="#table_handling_of_cookie_echo">Table 12</a> to determine the
correct action to be taken.<a class="pilcrow" href="#section-5.2.4-2.5.1">Â¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<span id="name-handling-of-a-cookie-echo-c"></span><div id="table_handling_of_cookie_echo">
<table class="center" id="table-12">
            <caption>
<a class="selfRef" href="#table-12">Table 12</a>:
<a class="selfRef" href="#name-handling-of-a-cookie-echo-c">Handling of a COOKIE ECHO Chunk When a TCB Exists</a>
            </caption>
<thead>
              <tr>
                <th class="text-center" colspan="1" rowspan="1">Local Tag</th>
                <th class="text-center" colspan="1" rowspan="1">Peer's Tag</th>
                <th class="text-center" colspan="1" rowspan="1">Local-Tie-Tag</th>
                <th class="text-center" colspan="1" rowspan="1">Peer's-Tie-Tag</th>
                <th class="text-center" colspan="1" rowspan="1">Action</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-center" colspan="1" rowspan="1">X</td>
                <td class="text-center" colspan="1" rowspan="1">X</td>
                <td class="text-center" colspan="1" rowspan="1">M</td>
                <td class="text-center" colspan="1" rowspan="1">M</td>
                <td class="text-center" colspan="1" rowspan="1">(A)</td>
              </tr>
              <tr>
                <td class="text-center" colspan="1" rowspan="1">M</td>
                <td class="text-center" colspan="1" rowspan="1">X</td>
                <td class="text-center" colspan="1" rowspan="1">A</td>
                <td class="text-center" colspan="1" rowspan="1">A</td>
                <td class="text-center" colspan="1" rowspan="1">(B)</td>
              </tr>
              <tr>
                <td class="text-center" colspan="1" rowspan="1">M</td>
                <td class="text-center" colspan="1" rowspan="1">0</td>
                <td class="text-center" colspan="1" rowspan="1">A</td>
                <td class="text-center" colspan="1" rowspan="1">A</td>
                <td class="text-center" colspan="1" rowspan="1">(B)</td>
              </tr>
              <tr>
                <td class="text-center" colspan="1" rowspan="1">X</td>
                <td class="text-center" colspan="1" rowspan="1">M</td>
                <td class="text-center" colspan="1" rowspan="1">0</td>
                <td class="text-center" colspan="1" rowspan="1">0</td>
                <td class="text-center" colspan="1" rowspan="1">(C)</td>
              </tr>
              <tr>
                <td class="text-center" colspan="1" rowspan="1">M</td>
                <td class="text-center" colspan="1" rowspan="1">M</td>
                <td class="text-center" colspan="1" rowspan="1">A</td>
                <td class="text-center" colspan="1" rowspan="1">A</td>
                <td class="text-center" colspan="1" rowspan="1">(D)</td>
              </tr>
            </tbody>
          </table>
</div>
<p id="section-5.2.4-4">Legend:<a class="pilcrow" href="#section-5.2.4-4">Â¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-5.2.4-5">
            <dt id="section-5.2.4-5.1">X -</dt>
            <dd id="section-5.2.4-5.2" style="margin-left: 1.5em">Tag does not match the existing TCB.<a class="pilcrow" href="#section-5.2.4-5.2">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.4-5.3">M -</dt>
            <dd id="section-5.2.4-5.4" style="margin-left: 1.5em">Tag matches the existing TCB.<a class="pilcrow" href="#section-5.2.4-5.4">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.4-5.5">0 -</dt>
            <dd id="section-5.2.4-5.6" style="margin-left: 1.5em">Tag unknown (Peer's Tag not known yet / No Tie-Tag in cookie).<a class="pilcrow" href="#section-5.2.4-5.6">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.4-5.7">A -</dt>
            <dd id="section-5.2.4-5.8" style="margin-left: 1.5em">All cases, i.e., M, X, or 0.<a class="pilcrow" href="#section-5.2.4-5.8">Â¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-5.2.4-6">For any case not shown in <a class="xref" href="#table_handling_of_cookie_echo">Table 12</a>,
the cookie <span class="bcp14">SHOULD</span> be silently discarded.<a class="pilcrow" href="#section-5.2.4-6">Â¶</a></p>
<p id="section-5.2.4-7">Action:<a class="pilcrow" href="#section-5.2.4-7">Â¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-5.2.4-8">
<dt>A)</dt>
<dd id="section-5.2.4-8.1">
              <p id="section-5.2.4-8.1.1">In this case, the peer might have restarted. When the endpoint
recognizes this potential 'restart', the existing session is
treated the same as if it received an ABORT chunk followed by a new
COOKIE ECHO chunk with the following exceptions:<a class="pilcrow" href="#section-5.2.4-8.1.1">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.4-8.1.2.1">
                  <p id="section-5.2.4-8.1.2.1.1">Any SCTP DATA chunks <span class="bcp14">MAY</span> be retained (this is an implementation-specific
option).<a class="pilcrow" href="#section-5.2.4-8.1.2.1.1">Â¶</a></p>
</li>
                <li class="normal" id="section-5.2.4-8.1.2.2">
                  <p id="section-5.2.4-8.1.2.2.1">A RESTART notification <span class="bcp14">SHOULD</span> be sent to the ULP instead of a
COMMUNICATION LOST notification.<a class="pilcrow" href="#section-5.2.4-8.1.2.2.1">Â¶</a></p>
</li>
              </ul>
<p id="section-5.2.4-8.1.3">All the congestion control parameters (e.g., cwnd, ssthresh)
related to this peer <span class="bcp14">MUST</span> be reset to their initial values
(see <a class="xref" href="#sec_processing_of_received_sack">Section 6.2.1</a>).<a class="pilcrow" href="#section-5.2.4-8.1.3">Â¶</a></p>
<p id="section-5.2.4-8.1.4">After this, the endpoint enters the ESTABLISHED state.<a class="pilcrow" href="#section-5.2.4-8.1.4">Â¶</a></p>
<p id="section-5.2.4-8.1.5">If the endpoint is in the SHUTDOWN-ACK-SENT state and recognizes that the peer
has restarted (Action A), it <span class="bcp14">MUST NOT</span> set up a new association but instead
resend the SHUTDOWN ACK chunk and send an ERROR chunk with a
"Cookie Received While Shutting Down" error cause to its peer.<a class="pilcrow" href="#section-5.2.4-8.1.5">Â¶</a></p>
</dd>
            <dd class="break"></dd>
<dt>B)</dt>
<dd id="section-5.2.4-8.2">
              <p id="section-5.2.4-8.2.1">In this case, both sides might be attempting to start an association
at about the same time, but the peer endpoint sent its INIT chunk
after responding to the local endpoint's INIT chunk.
Thus, it might have picked a new Verification Tag, not being aware of the
previous tag it had sent this endpoint.
The endpoint <span class="bcp14">SHOULD</span> stay in or enter the ESTABLISHED state, but it <span class="bcp14">MUST</span> update
its peer's Verification Tag from the State Cookie, stop any T1-init or
T1-cookie timers that might be running, and send a COOKIE ACK chunk.<a class="pilcrow" href="#section-5.2.4-8.2.1">Â¶</a></p>
</dd>
            <dd class="break"></dd>
<dt>C)</dt>
<dd id="section-5.2.4-8.3">
              <p id="section-5.2.4-8.3.1">In this case, the local endpoint's cookie has arrived late.
Before it arrived, the local endpoint sent an INIT chunk and received an
INIT ACK chunk and finally sent a COOKIE ECHO chunk with the peer's same tag
but a new tag of its own.
The cookie <span class="bcp14">SHOULD</span> be silently discarded.
The endpoint <span class="bcp14">SHOULD NOT</span> change states and <span class="bcp14">SHOULD</span> leave any timers running.<a class="pilcrow" href="#section-5.2.4-8.3.1">Â¶</a></p>
</dd>
            <dd class="break"></dd>
<dt>D)</dt>
<dd id="section-5.2.4-8.4">
              <p id="section-5.2.4-8.4.1">When both local and remote tags match, the endpoint <span class="bcp14">SHOULD</span> enter the
ESTABLISHED state if it is in the COOKIE-ECHOED state.
It <span class="bcp14">SHOULD</span> stop any T1-cookie timer that is running and send a COOKIE ACK chunk.<a class="pilcrow" href="#section-5.2.4-8.4.1">Â¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-5.2.4-9">Note: The "peer's Verification Tag" is the tag received in the Initiate Tag
field of the INIT or INIT ACK chunk.<a class="pilcrow" href="#section-5.2.4-9">Â¶</a></p>
<section id="section-5.2.4.1">
            <h5 id="name-an-example-of-an-associatio">
<a class="section-number selfRef" href="#section-5.2.4.1">5.2.4.1. </a><a class="section-name selfRef" href="#name-an-example-of-an-associatio">An Example of an Association Restart</a>
            </h5>
<p id="section-5.2.4.1-1">In the following example, "A" initiates the association after a restart
has occurred.
Endpoint "Z" had no knowledge of the restart until the exchange (i.e.,
Heartbeats had not yet detected the failure of "A")
(assuming no bundling or fragmentation occurs):<a class="pilcrow" href="#section-5.2.4.1-1">Â¶</a></p>
<span id="name-a-restart-example"></span><div id="fig_restart_example">
<figure id="figure-5">
              <div class="alignCenter art-text artwork" id="section-5.2.4.1-2.1">
<pre>Endpoint A                                          Endpoint Z
&lt;-------------- Association is established----------------------&gt;
Tag=Tag_A                                             Tag=Tag_Z
&lt;---------------------------------------------------------------&gt;
{A crashes and restarts}
{app sets up an association with Z}
(build TCB)
INIT [I-Tag=Tag_A'
      &amp; other info]  --------\
(Start T1-init timer)         \
(Enter COOKIE-WAIT state)      \---&gt; (find an existing TCB,
                                      populate TieTags if needed,
                                      compose Cookie_Z with Tie-Tags
                                      and other info)
                                /--- INIT ACK [Veri Tag=Tag_A',
                               /               I-Tag=Tag_Z',
(Cancel T1-init timer) &lt;------/                Cookie_Z]
                                     (leave original TCB in place)
COOKIE ECHO [Veri=Tag_Z',
             Cookie_Z]-------\
(Start T1-init timer)         \
(Enter COOKIE-ECHOED state)    \---&gt; (Find existing association,
                                      Tie-Tags in Cookie_Z match
                                      Tie-Tags in TCB,
                                      Tags do not match, i.e.,
                                      case X X M M above,
                                      Announce Restart to ULP
                                      and reset association).
                               /---- COOKIE ACK
(Cancel T1-init timer, &lt;------/
 Enter ESTABLISHED state)
{app sends 1st user data; strm 0}
DATA [TSN=Initial TSN_A
    Strm=0,Seq=0 &amp; user data]--\
(Start T3-rtx timer)            \
                                 \-&gt;
                              /--- SACK [TSN Ack=init TSN_A,Block=0]
(Cancel T3-rtx timer) &lt;------/
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-5">Figure 5</a>:
<a class="selfRef" href="#name-a-restart-example">A Restart Example</a>
              </figcaption></figure>
</div>
</section>
</section>
</div>
<div id="sec_handle_duplicate_cookie_ack">
<section id="section-5.2.5">
          <h4 id="name-handle-duplicate-cookie-ack">
<a class="section-number selfRef" href="#section-5.2.5">5.2.5. </a><a class="section-name selfRef" href="#name-handle-duplicate-cookie-ack">Handle Duplicate COOKIE ACK Chunk</a>
          </h4>
<p id="section-5.2.5-1">At any state other than COOKIE-ECHOED, an endpoint <span class="bcp14">SHOULD</span> silently
discard a received COOKIE ACK chunk.<a class="pilcrow" href="#section-5.2.5-1">Â¶</a></p>
</section>
</div>
<div id="sec_handle_stale_cookie_error">
<section id="section-5.2.6">
          <h4 id="name-handle-stale-cookie-error">
<a class="section-number selfRef" href="#section-5.2.6">5.2.6. </a><a class="section-name selfRef" href="#name-handle-stale-cookie-error">Handle Stale Cookie Error</a>
          </h4>
<p id="section-5.2.6-1">Receipt of an ERROR chunk with a "Stale Cookie" error cause indicates
one of a number of possible events:<a class="pilcrow" href="#section-5.2.6-1">Â¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-5.2.6-2">
<dt>A)</dt>
<dd id="section-5.2.6-2.1">
              <p id="section-5.2.6-2.1.1">The association failed to completely set up before the State Cookie issued by
the sender was processed.<a class="pilcrow" href="#section-5.2.6-2.1.1">Â¶</a></p>
</dd>
            <dd class="break"></dd>
<dt>B)</dt>
<dd id="section-5.2.6-2.2">
              <p id="section-5.2.6-2.2.1">An old State Cookie was processed after setup completed.<a class="pilcrow" href="#section-5.2.6-2.2.1">Â¶</a></p>
</dd>
            <dd class="break"></dd>
<dt>C)</dt>
<dd id="section-5.2.6-2.3">
              <p id="section-5.2.6-2.3.1">An old State Cookie is received from someone that the receiver is not
interested in having an association with and the ABORT chunk was lost.<a class="pilcrow" href="#section-5.2.6-2.3.1">Â¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-5.2.6-3">When processing an ERROR chunk with a "Stale Cookie" error cause, an endpoint
<span class="bcp14">SHOULD</span> first examine if an association is in the process of being set up, i.e.,
the association is in the COOKIE-ECHOED state.
In all cases, if the association is not in the COOKIE-ECHOED state, the
ERROR chunk <span class="bcp14">SHOULD</span> be silently discarded.<a class="pilcrow" href="#section-5.2.6-3">Â¶</a></p>
<p id="section-5.2.6-4">If the association is in the COOKIE-ECHOED state, the endpoint <span class="bcp14">MAY</span> elect
one of the following three alternatives.<a class="pilcrow" href="#section-5.2.6-4">Â¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-5.2.6-5">
<dt>1)</dt>
<dd id="section-5.2.6-5.1">
              <p id="section-5.2.6-5.1.1">Send a new INIT chunk to the endpoint to generate a new State Cookie and
reattempt the setup procedure.<a class="pilcrow" href="#section-5.2.6-5.1.1">Â¶</a></p>
</dd>
            <dd class="break"></dd>
<dt>2)</dt>
<dd id="section-5.2.6-5.2">
              <p id="section-5.2.6-5.2.1">Discard the TCB and report to the upper layer the inability to set up
the association.<a class="pilcrow" href="#section-5.2.6-5.2.1">Â¶</a></p>
</dd>
            <dd class="break"></dd>
<dt>3)</dt>
<dd id="section-5.2.6-5.3">
              <p id="section-5.2.6-5.3.1">Send a new INIT chunk to the endpoint, adding a Cookie Preservative
parameter requesting an extension to the life time of the State Cookie.
When calculating the time extension, an implementation <span class="bcp14">SHOULD</span> use the RTT
information measured based on the previous COOKIE ECHO/ERROR chunk exchange
and <span class="bcp14">SHOULD</span> add no more than 1 second beyond the measured RTT, due to long
State Cookie life times making the endpoint more subject to a replay attack.<a class="pilcrow" href="#section-5.2.6-5.3.1">Â¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="sec_other_initialization_issues">
<section id="section-5.3">
        <h3 id="name-other-initialization-issues">
<a class="section-number selfRef" href="#section-5.3">5.3. </a><a class="section-name selfRef" href="#name-other-initialization-issues">Other Initialization Issues</a>
        </h3>
<div id="sec_selection_of_tag_value">
<section id="section-5.3.1">
          <h4 id="name-selection-of-tag-value">
<a class="section-number selfRef" href="#section-5.3.1">5.3.1. </a><a class="section-name selfRef" href="#name-selection-of-tag-value">Selection of Tag Value</a>
          </h4>
<p id="section-5.3.1-1">Initiate Tag values <span class="bcp14">SHOULD</span> be selected from the range of 1 to 2<sup>32</sup> - 1.
It is very important that the Initiate Tag value be randomized to
help protect against off-path attacks.
The methods described in <span>[<a class="xref" href="#RFC4086">RFC4086</a>]</span> can be used for the
Initiate Tag randomization.
Careful selection of Initiate Tags is also necessary to prevent old duplicate
packets from previous associations being mistakenly processed as belonging
to the current association.<a class="pilcrow" href="#section-5.3.1-1">Â¶</a></p>
<p id="section-5.3.1-2">Moreover, the Verification Tag value used by either endpoint in a
given association <span class="bcp14">MUST NOT</span> change during the life time of an association.
A new Verification Tag value <span class="bcp14">MUST</span> be used each time the endpoint tears down
and then reestablishes an association to the same peer.<a class="pilcrow" href="#section-5.3.1-2">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec_path_verifiation">
<section id="section-5.4">
        <h3 id="name-path-verification">
<a class="section-number selfRef" href="#section-5.4">5.4. </a><a class="section-name selfRef" href="#name-path-verification">Path Verification</a>
        </h3>
<p id="section-5.4-1">During association establishment, the two peers exchange a list of
addresses.
In the predominant case, these lists accurately represent the addresses
owned by each peer.
However, a misbehaving peer might supply addresses that it does not own.
To prevent this, the following rules are applied to all addresses of the
new association:<a class="pilcrow" href="#section-5.4-1">Â¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-5.4-2">
<dt>1)</dt>
<dd id="section-5.4-2.1">
            <p id="section-5.4-2.1.1">Any addresses passed to the sender of the INIT chunk by its upper layer
in the request to initialize an association are automatically considered to be
CONFIRMED.<a class="pilcrow" href="#section-5.4-2.1.1">Â¶</a></p>
</dd>
          <dd class="break"></dd>
<dt>2)</dt>
<dd id="section-5.4-2.2">
            <p id="section-5.4-2.2.1">For the receiver of the COOKIE ECHO chunk, the only CONFIRMED address
is the address to which the packet containing the INIT ACK chunk was sent.<a class="pilcrow" href="#section-5.4-2.2.1">Â¶</a></p>
</dd>
          <dd class="break"></dd>
<dt>3)</dt>
<dd id="section-5.4-2.3">
            <p id="section-5.4-2.3.1">All other addresses not covered by rules 1 and 2 are considered
UNCONFIRMED and are subject to probing for verification.<a class="pilcrow" href="#section-5.4-2.3.1">Â¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-5.4-3">To probe an address for verification, an endpoint will send
HEARTBEAT chunks including a 64-bit random nonce and a path indicator (to
identify the address that the HEARTBEAT chunk is sent to) within the Heartbeat
Info parameter.<a class="pilcrow" href="#section-5.4-3">Â¶</a></p>
<p id="section-5.4-4">Upon receipt of the HEARTBEAT ACK chunk, a verification is made that the
nonce included in the Heartbeat Info parameter is the one sent to the
address indicated inside the Heartbeat Info parameter.
When this match occurs, the address that the original HEARTBEAT was sent to
is now considered CONFIRMED and available for normal data transfer.<a class="pilcrow" href="#section-5.4-4">Â¶</a></p>
<p id="section-5.4-5">These probing procedures are started when an association moves to the
ESTABLISHED state and are ended when all paths are confirmed.<a class="pilcrow" href="#section-5.4-5">Â¶</a></p>
<p id="section-5.4-6">In each RTO, a probe <span class="bcp14">MAY</span> be sent on an active UNCONFIRMED path in an
attempt to move it to the CONFIRMED state.
If during this probing the path becomes inactive, this rate is lowered to the
normal HEARTBEAT rate.
At the expiration of the RTO timer, the error counter of any path that was
probed but not CONFIRMED is incremented by one and subjected to path failure
detection, as defined in <a class="xref" href="#sec_path_failure_detection">Section 8.2</a>.
When probing UNCONFIRMED addresses, however, the association overall error
count is not incremented.<a class="pilcrow" href="#section-5.4-6">Â¶</a></p>
<p id="section-5.4-7">The number of packets containing HEARTBEAT chunks sent at each RTO <span class="bcp14">SHOULD</span>
be limited by the 'HB.Max.Burst' parameter.
It is an implementation decision as to how to distribute packets containing
HEARTBEAT chunks to the peer's addresses for path verification.<a class="pilcrow" href="#section-5.4-7">Â¶</a></p>
<p id="section-5.4-8">Whenever a path is confirmed, an indication <span class="bcp14">MAY</span> be given to the upper
layer.<a class="pilcrow" href="#section-5.4-8">Â¶</a></p>
<p id="section-5.4-9">An endpoint <span class="bcp14">MUST NOT</span> send any chunks to an UNCONFIRMED address, with
the following exceptions:<a class="pilcrow" href="#section-5.4-9">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.4-10.1">
            <p id="section-5.4-10.1.1">A HEARTBEAT chunk including a nonce <span class="bcp14">MAY</span> be sent to an UNCONFIRMED address.<a class="pilcrow" href="#section-5.4-10.1.1">Â¶</a></p>
</li>
          <li class="normal" id="section-5.4-10.2">
            <p id="section-5.4-10.2.1">A HEARTBEAT ACK chunk <span class="bcp14">MAY</span> be sent to an UNCONFIRMED address.<a class="pilcrow" href="#section-5.4-10.2.1">Â¶</a></p>
</li>
          <li class="normal" id="section-5.4-10.3">
            <p id="section-5.4-10.3.1">A COOKIE ACK chunk <span class="bcp14">MAY</span> be sent to an UNCONFIRMED address, but it <span class="bcp14">MUST</span> be
bundled with a HEARTBEAT chunk including a nonce.
An implementation that does not support bundling <span class="bcp14">MUST NOT</span> send a COOKIE ACK
chunk to an UNCONFIRMED address.<a class="pilcrow" href="#section-5.4-10.3.1">Â¶</a></p>
</li>
          <li class="normal" id="section-5.4-10.4">
            <p id="section-5.4-10.4.1">A COOKIE ECHO chunk <span class="bcp14">MAY</span> be sent to an UNCONFIRMED address, but it <span class="bcp14">MUST</span>
be bundled with a HEARTBEAT chunk including a nonce, and the size of the
SCTP packet <span class="bcp14">MUST NOT</span> exceed the PMTU.
If the implementation does not support bundling or if the bundled COOKIE ECHO
chunk plus HEARTBEAT chunk (including nonce) would result in an SCTP packet
larger than the PMTU, then the implementation <span class="bcp14">MUST NOT</span> send a COOKIE ECHO chunk
to an UNCONFIRMED address.<a class="pilcrow" href="#section-5.4-10.4.1">Â¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="sec_user_data_transfer">
<section id="section-6">
      <h2 id="name-user-data-transfer">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-user-data-transfer">User Data Transfer</a>
      </h2>
<p id="section-6-1">Data transmission <span class="bcp14">MUST</span> only happen in the ESTABLISHED, SHUTDOWN-PENDING,
and SHUTDOWN-RECEIVED states.
The only exception to this is that DATA chunks are allowed to be bundled with
an outbound COOKIE ECHO chunk when in the COOKIE-WAIT state.<a class="pilcrow" href="#section-6-1">Â¶</a></p>
<p id="section-6-2">DATA chunks <span class="bcp14">MUST</span> only be received according to the rules below in
ESTABLISHED, SHUTDOWN-PENDING, and SHUTDOWN-SENT states.
A DATA chunk received in CLOSED is out of the blue and <span class="bcp14">SHOULD</span> be handled per
<a class="xref" href="#sec_handle_out_of_the_blue_packets">Section 8.4</a>.
A DATA chunk received in any other state <span class="bcp14">SHOULD</span> be discarded.<a class="pilcrow" href="#section-6-2">Â¶</a></p>
<p id="section-6-3">A SACK chunk <span class="bcp14">MUST</span> be processed in ESTABLISHED, SHUTDOWN-PENDING, and
SHUTDOWN-RECEIVED states.
An incoming SACK chunk <span class="bcp14">MAY</span> be processed in COOKIE-ECHOED.
A SACK chunk in the CLOSED state is out of the blue and <span class="bcp14">SHOULD</span> be processed
according to the rules in <a class="xref" href="#sec_handle_out_of_the_blue_packets">Section 8.4</a>.
A SACK chunk received in any other state <span class="bcp14">SHOULD</span> be discarded.<a class="pilcrow" href="#section-6-3">Â¶</a></p>
<p id="section-6-4">For transmission efficiency, SCTP defines mechanisms for bundling of
small user messages and fragmentation of large user messages.
The following diagram depicts the flow of user messages through SCTP.<a class="pilcrow" href="#section-6-4">Â¶</a></p>
<p id="section-6-5">In this section, the term "data sender" refers to the endpoint that
transmits a DATA chunk, and the term "data receiver" refers to the
endpoint that receives a DATA chunk.
A data receiver will transmit SACK chunks.<a class="pilcrow" href="#section-6-5">Â¶</a></p>
<span id="name-illustration-of-user-data-t"></span><div id="fig_user_data_transfer">
<figure id="figure-6">
        <div class="alignCenter art-text artwork" id="section-6-6.1">
<pre>           +-------------------------+
           |      User Messages      |
           +-------------------------+
 SCTP user        ^  |
==================|==|=======================================
                  |  v (1)
       +------------------+    +---------------------+
       | SCTP DATA Chunks |    | SCTP Control Chunks |
       +------------------+    +---------------------+
                  ^  |             ^  |
                  |  v (2)         |  v (2)
               +--------------------------+
               |       SCTP packets       |
               +--------------------------+
 SCTP                      ^  |
===========================|==|===========================
                           |  v
       Connectionless Packet Transfer Service (e.g., IP)
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-6">Figure 6</a>:
<a class="selfRef" href="#name-illustration-of-user-data-t">Illustration of User Data Transfer</a>
        </figcaption></figure>
</div>
<p id="section-6-7">The following applies:<a class="pilcrow" href="#section-6-7">Â¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-6-8">
<dt>1)</dt>
<dd id="section-6-8.1">
          <p id="section-6-8.1.1">When converting user messages into DATA chunks, an endpoint
<span class="bcp14">MUST</span> fragment large user messages into multiple DATA chunks.
The size of each DATA chunk <span class="bcp14">SHOULD</span> be smaller than or equal to the
Association Maximum DATA Chunk Size (AMDCS).
The data receiver will normally reassemble the fragmented message from DATA
chunks before delivery to the user (see <a class="xref" href="#sec_frag_reass">Section 6.9</a>
for details).<a class="pilcrow" href="#section-6-8.1.1">Â¶</a></p>
</dd>
        <dd class="break"></dd>
<dt>2)</dt>
<dd id="section-6-8.2">
          <p id="section-6-8.2.1">Multiple DATA and control chunks <span class="bcp14">MAY</span> be bundled by the sender into a single
SCTP packet for transmission, as long as the final size of the SCTP packet does
not exceed the current PMTU.
The receiver will unbundle the packet back into the original chunks.
Control chunks <span class="bcp14">MUST</span> come before DATA chunks in the packet.<a class="pilcrow" href="#section-6-8.2.1">Â¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-6-9">The fragmentation and bundling mechanisms, as detailed in Sections
<a class="xref" href="#sec_frag_reass">6.9</a> and <a class="xref" href="#sec_bundling">6.10</a>, are <span class="bcp14">OPTIONAL</span>
to implement by the data sender, but they <span class="bcp14">MUST</span> be implemented by the data
receiver, i.e., an endpoint <span class="bcp14">MUST</span> properly receive and process bundled or
fragmented data.<a class="pilcrow" href="#section-6-9">Â¶</a></p>
<div id="sec_transmission_of_data_chunks">
<section id="section-6.1">
        <h3 id="name-transmission-of-data-chunks">
<a class="section-number selfRef" href="#section-6.1">6.1. </a><a class="section-name selfRef" href="#name-transmission-of-data-chunks">Transmission of DATA Chunks</a>
        </h3>
<p id="section-6.1-1">This section specifies the rules for sending DATA chunks.
In particular, it defines zero window probing, which is required to
avoid the indefinite stalling of an association in case of a loss of
packets containing SACK chunks performing window updates.<a class="pilcrow" href="#section-6.1-1">Â¶</a></p>
<p id="section-6.1-2">This document is specified as if there is a single retransmission timer
per destination transport address, but implementations <span class="bcp14">MAY</span> have a
retransmission timer for each DATA chunk.<a class="pilcrow" href="#section-6.1-2">Â¶</a></p>
<p id="section-6.1-3">The following general rules <span class="bcp14">MUST</span> be applied by the data sender for
transmission and/or retransmission of outbound DATA chunks:<a class="pilcrow" href="#section-6.1-3">Â¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-6.1-4">
<dt>A)</dt>
<dd id="section-6.1-4.1">
            <p id="section-6.1-4.1.1">At any given time, the data sender <span class="bcp14">MUST NOT</span> transmit new data to
any destination transport address if its peer's rwnd indicates
that the peer has no buffer space (i.e., rwnd is smaller than the size of the
next DATA chunk; see <a class="xref" href="#sec_processing_of_received_sack">Section 6.2.1</a>),
except for zero window probes.<a class="pilcrow" href="#section-6.1-4.1.1">Â¶</a></p>
<p id="section-6.1-4.1.2">A zero window probe is a DATA chunk sent when the receiver has no buffer
space.
This rule allows the sender to probe for a change in rwnd that the sender
missed due to the SACK chunks having been lost in transit from the data
receiver to the data sender.
A zero window probe <span class="bcp14">MUST</span> only be sent when the cwnd allows (see rule B below).
A zero window probe <span class="bcp14">SHOULD</span> only be sent when all outstanding DATA chunks have
been cumulatively acknowledged and no DATA chunks are in flight.
Senders <span class="bcp14">MUST</span> support zero window probing.<a class="pilcrow" href="#section-6.1-4.1.2">Â¶</a></p>
<p id="section-6.1-4.1.3">If the sender continues to receive SACK chunks from the peer while doing 
zero window probing, the unacknowledged window probes <span class="bcp14">SHOULD NOT</span> increment the
error counter for the association or any destination transport address.
This is because the receiver could keep its window closed for an indefinite 
time.
<a class="xref" href="#sec_acknowledgements_of_reception_of_data_chunks">Section 6.2</a> describes the
receiver behavior when it advertises a zero window.
The sender <span class="bcp14">SHOULD</span> send the first zero window probe after 1 RTO when it detects
that the receiver has closed its window and <span class="bcp14">SHOULD</span> increase the probe interval
exponentially afterwards.
Also note that the cwnd <span class="bcp14">SHOULD</span> be adjusted according to
<a class="xref" href="#sec_slow_start">Section 7.2.1</a>.
Zero window probing does not affect the calculation of cwnd.<a class="pilcrow" href="#section-6.1-4.1.3">Â¶</a></p>
<p id="section-6.1-4.1.4">The sender <span class="bcp14">MUST</span> also have an algorithm for sending new DATA chunks to avoid
silly window syndrome (SWS) as described in <span>[<a class="xref" href="#RFC1122">RFC1122</a>]</span>.
The algorithm can be similar to the one described in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc1122#section-4.2.3.4">Section 4.2.3.4</a> of [<a class="xref" href="#RFC1122">RFC1122</a>]</span>.<a class="pilcrow" href="#section-6.1-4.1.4">Â¶</a></p>
</dd>
          <dd class="break"></dd>
<dt>B)</dt>
<dd id="section-6.1-4.2">
            <p id="section-6.1-4.2.1">At any given time, the sender <span class="bcp14">MUST NOT</span> transmit new data to a given
transport address if it has cwnd + (PMDCS - 1) or more bytes of data outstanding
to that transport address.
If data is available, the sender <span class="bcp14">SHOULD</span> exceed cwnd by up to (PMDCS - 1) bytes
on a new data transmission if the flightsize does not currently reach cwnd.
The breach of cwnd <span class="bcp14">MUST</span> constitute one packet only.<a class="pilcrow" href="#section-6.1-4.2.1">Â¶</a></p>
</dd>
          <dd class="break"></dd>
<dt>C)</dt>
<dd id="section-6.1-4.3">
            <p id="section-6.1-4.3.1">When the time comes for the sender to transmit, before sending new
DATA chunks, the sender <span class="bcp14">MUST</span> first transmit any DATA chunks that are marked
for retransmission (limited by the current cwnd).<a class="pilcrow" href="#section-6.1-4.3.1">Â¶</a></p>
</dd>
          <dd class="break"></dd>
<dt>D)</dt>
<dd id="section-6.1-4.4">
            <p id="section-6.1-4.4.1">When the time comes for the sender to transmit new DATA chunks, the
protocol parameter 'Max.Burst' <span class="bcp14">SHOULD</span> be used to limit the number of packets sent.
The limit <span class="bcp14">MAY</span> be applied by adjusting cwnd temporarily, as follows:<a class="pilcrow" href="#section-6.1-4.4.1">Â¶</a></p>
<div id="section-6.1-4.4.2">
<pre class="lang-pseudocode sourcecode">if ((flightsize + Max.Burst * PMDCS) &lt; cwnd)
    cwnd = flightsize + Max.Burst * PMDCS
</pre><a class="pilcrow" href="#section-6.1-4.4.2">Â¶</a>
</div>
<p id="section-6.1-4.4.3">Or, it <span class="bcp14">MAY</span> be applied by strictly limiting the number of packets emitted by
the output routine.
When calculating the number of packets to transmit, and particularly when
using the formula above, cwnd <span class="bcp14">SHOULD NOT</span> be changed permanently.<a class="pilcrow" href="#section-6.1-4.4.3">Â¶</a></p>
</dd>
          <dd class="break"></dd>
<dt>E)</dt>
<dd id="section-6.1-4.5">
            <p id="section-6.1-4.5.1">Then, the sender can send as many new DATA chunks as rule A and rule B
allow.<a class="pilcrow" href="#section-6.1-4.5.1">Â¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-6.1-5">Multiple DATA chunks committed for transmission <span class="bcp14">MAY</span> be bundled in a
single packet.
Furthermore, DATA chunks being retransmitted <span class="bcp14">MAY</span> be bundled with new
DATA chunks, as long as the resulting SCTP packet size does not exceed the PMTU.
A ULP can request that no bundling is performed, but this only turns off
any delays that an SCTP implementation might be using to increase bundling
efficiency.
It does not in itself stop all bundling from occurring (i.e., in case of
congestion or retransmission).<a class="pilcrow" href="#section-6.1-5">Â¶</a></p>
<p id="section-6.1-6">Before an endpoint transmits a DATA chunk, if any received DATA
chunks have not been acknowledged (e.g., due to delayed ack), the
sender <span class="bcp14">SHOULD</span> create a SACK chunk and bundle it with the outbound DATA
chunk, as long as the size of the final SCTP packet does not exceed
the current PMTU.
See <a class="xref" href="#sec_acknowledgements_of_reception_of_data_chunks">Section 6.2</a>.<a class="pilcrow" href="#section-6.1-6">Â¶</a></p>
<p id="section-6.1-7">When the window is full (i.e., transmission is
disallowed by rule A and/or rule B), the sender <span class="bcp14">MAY</span> still accept send
requests from its upper layer but <span class="bcp14">MUST</span> transmit no more DATA chunks
until some or all of the outstanding DATA chunks are acknowledged and
transmission is allowed by rule A and rule B again.<a class="pilcrow" href="#section-6.1-7">Â¶</a></p>
<p id="section-6.1-8">Whenever a transmission or retransmission is made to any address, if
the T3-rtx timer of that address is not currently running, the sender
<span class="bcp14">MUST</span> start that timer.
If the timer for that address is already running, the sender <span class="bcp14">MUST</span> restart
the timer if the earliest (i.e., lowest TSN) outstanding DATA chunk sent to
that address is being retransmitted.
Otherwise, the data sender <span class="bcp14">MUST NOT</span> restart the timer.<a class="pilcrow" href="#section-6.1-8">Â¶</a></p>
<p id="section-6.1-9">When starting or restarting the T3-rtx timer, the timer value <span class="bcp14">SHOULD</span> be
adjusted according to the timer rules defined in Sections
<a class="xref" href="#sec_retransmission_timer_rules">6.3.2</a> and
<a class="xref" href="#sec_handle_t3_rtx_expiration">6.3.3</a>.<a class="pilcrow" href="#section-6.1-9">Â¶</a></p>
<p id="section-6.1-10">The data sender <span class="bcp14">MUST NOT</span> use a TSN that is more than 2<sup>31</sup> - 1 above
the beginning TSN of the current send window.<a class="pilcrow" href="#section-6.1-10">Â¶</a></p>
<p id="section-6.1-11">For each stream, the data sender <span class="bcp14">MUST NOT</span> have more than 2<sup>16</sup> - 1
ordered user messages in the current send window.<a class="pilcrow" href="#section-6.1-11">Â¶</a></p>
<p id="section-6.1-12">Whenever the sender of a DATA chunk can benefit from the corresponding
SACK chunk being sent back without delay, the sender <span class="bcp14">MAY</span> set the I bit in the
DATA chunk header.
Please note that why the sender has set the I bit is irrelevant to the
receiver.<a class="pilcrow" href="#section-6.1-12">Â¶</a></p>
<p id="section-6.1-13">Reasons for setting the I bit include, but are not limited to, the
following (see <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc7053#section-4">Section 4</a> of [<a class="xref" href="#RFC7053">RFC7053</a>]</span> for a discussion of the
benefits):<a class="pilcrow" href="#section-6.1-13">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-14.1">
            <p id="section-6.1-14.1.1">The application requests that the I bit of the last DATA chunk of
a user message be set when providing the user message to the SCTP
implementation (see <a class="xref" href="#sec_ulp_to_sctp">Section 11.1</a>).<a class="pilcrow" href="#section-6.1-14.1.1">Â¶</a></p>
</li>
          <li class="normal" id="section-6.1-14.2">
            <p id="section-6.1-14.2.1">The sender is in the SHUTDOWN-PENDING state.<a class="pilcrow" href="#section-6.1-14.2.1">Â¶</a></p>
</li>
          <li class="normal" id="section-6.1-14.3">
            <p id="section-6.1-14.3.1">The sending of a DATA chunk fills the congestion or receiver window.<a class="pilcrow" href="#section-6.1-14.3.1">Â¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec_acknowledgements_of_reception_of_data_chunks">
<section id="section-6.2">
        <h3 id="name-acknowledgement-on-receptio">
<a class="section-number selfRef" href="#section-6.2">6.2. </a><a class="section-name selfRef" href="#name-acknowledgement-on-receptio">Acknowledgement on Reception of DATA Chunks</a>
        </h3>
<p id="section-6.2-1">The SCTP endpoint <span class="bcp14">MUST</span> always acknowledge the reception of each valid
DATA chunk when the DATA chunk received is inside its receive window.<a class="pilcrow" href="#section-6.2-1">Â¶</a></p>
<p id="section-6.2-2">When the receiver's advertised window is 0, the receiver <span class="bcp14">MUST</span> drop
any new incoming DATA chunk with a TSN larger than the largest TSN
received so far.
Also, if the new incoming DATA chunk holds a TSN value less than the largest
TSN received so far, then the receiver <span class="bcp14">SHOULD</span> drop the largest TSN held for
reordering and accept the new incoming DATA chunk.
In either case, if such a DATA chunk is dropped, the receiver <span class="bcp14">MUST</span> immediately
send back a SACK chunk with the current receive window showing only DATA chunks
received and accepted so far.
The dropped DATA chunk(s) <span class="bcp14">MUST NOT</span> be included in the SACK chunk, as they were
not accepted.
The receiver <span class="bcp14">MUST</span> also have an algorithm for advertising its receive window
to avoid receiver silly window syndrome (SWS), as described in
<span>[<a class="xref" href="#RFC1122">RFC1122</a>]</span>.
The algorithm can be similar to the one described in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc1122#section-4.2.3.3">Section 4.2.3.3</a> of [<a class="xref" href="#RFC1122">RFC1122</a>]</span>.<a class="pilcrow" href="#section-6.2-2">Â¶</a></p>
<p id="section-6.2-3">The guidelines on the delayed acknowledgement algorithm specified in
<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc5681#section-4.2">Section 4.2</a> of [<a class="xref" href="#RFC5681">RFC5681</a>]</span> <span class="bcp14">SHOULD</span> be followed.
Specifically, an acknowledgement <span class="bcp14">SHOULD</span> be generated for at least every
second packet (not every second DATA chunk) received and <span class="bcp14">SHOULD</span> be generated
within 200 ms of the arrival of any unacknowledged DATA chunk.
In some situations, it might be beneficial for an SCTP transmitter to be
more conservative than the algorithms detailed in this document allow.
However, an SCTP transmitter <span class="bcp14">MUST NOT</span> be more aggressive in sending SACK chunks
than the following algorithms allow.<a class="pilcrow" href="#section-6.2-3">Â¶</a></p>
<p id="section-6.2-4">An SCTP receiver <span class="bcp14">MUST NOT</span> generate more than one SACK chunk for every
incoming packet, other than to update the offered window as the
receiving application consumes new data.
When the window opens up, an SCTP receiver <span class="bcp14">SHOULD</span> send additional SACK chunks
to update the window even if no new data is received.
The receiver <span class="bcp14">MUST</span> avoid sending a large number of window updates -- in
particular, large bursts of them.
One way to achieve this is to send a window update only if the window can be
increased by at least a quarter of the receive buffer size of the
association.<a class="pilcrow" href="#section-6.2-4">Â¶</a></p>
<p id="section-6.2-5">Implementation Note: The maximum delay for generating an acknowledgement
<span class="bcp14">MAY</span> be configured by the SCTP administrator, either statically or dynamically,
in order to meet the specific timing requirement of the protocol being
carried.<a class="pilcrow" href="#section-6.2-5">Â¶</a></p>
<p id="section-6.2-6">An implementation <span class="bcp14">MUST NOT</span> allow the maximum delay (protocol parameter
'SACK.Delay') to be configured to be more than 500 ms.
In other words, an implementation <span class="bcp14">MAY</span> lower the value of 'SACK.Delay'
below 500 ms but <span class="bcp14">MUST NOT</span> raise it above 500 ms.<a class="pilcrow" href="#section-6.2-6">Â¶</a></p>
<p id="section-6.2-7">Acknowledgements <span class="bcp14">MUST</span> be sent in SACK chunks unless shutdown was
requested by the ULP, in which case an endpoint <span class="bcp14">MAY</span> send an
acknowledgement in the SHUTDOWN chunk.
A SACK chunk can acknowledge the reception of multiple DATA chunks.
See <a class="xref" href="#sec_sack_chunk">Section 3.3.4</a> for SACK chunk format.
In particular, the SCTP endpoint <span class="bcp14">MUST</span> fill in the Cumulative TSN Ack field to
indicate the latest sequential TSN (of a valid DATA chunk) it has received.
Any received DATA chunks with TSN greater than the value in the
Cumulative TSN Ack field are reported in the Gap Ack Block fields.
The SCTP endpoint <span class="bcp14">MUST</span> report as many Gap Ack Blocks as can fit in a single SACK
chunk such that the size of the SCTP packet does not exceed the current PMTU.<a class="pilcrow" href="#section-6.2-7">Â¶</a></p>
<p id="section-6.2-8">The SHUTDOWN chunk does not contain Gap Ack Block fields.
Therefore, the endpoint <span class="bcp14">SHOULD</span> use a SACK chunk instead of the SHUTDOWN
chunk to acknowledge DATA chunks received out of order.<a class="pilcrow" href="#section-6.2-8">Â¶</a></p>
<p id="section-6.2-9">Upon receipt of an SCTP packet containing a DATA chunk with the I bit set,
the receiver <span class="bcp14">SHOULD NOT</span> delay the sending of the corresponding SACK chunk, i.e.,
the receiver <span class="bcp14">SHOULD</span> immediately respond with the corresponding SACK chunk.<a class="pilcrow" href="#section-6.2-9">Â¶</a></p>
<p id="section-6.2-10">When a packet arrives with duplicate DATA chunk(s) and with no new
DATA chunk(s), the endpoint <span class="bcp14">MUST</span> immediately send a SACK chunk with no
delay.
If a packet arrives with duplicate DATA chunk(s) bundled with
new DATA chunks, the endpoint <span class="bcp14">MAY</span> immediately send a SACK chunk.
Normally, receipt of duplicate DATA chunks will occur when the original SACK
chunk was lost and the peer's RTO has expired.
The duplicate TSN number(s) <span class="bcp14">SHOULD</span> be reported in the SACK chunk as duplicate.<a class="pilcrow" href="#section-6.2-10">Â¶</a></p>
<p id="section-6.2-11">When an endpoint receives a SACK chunk, it <span class="bcp14">MAY</span> use the duplicate TSN
information to determine if SACK chunk loss is occurring.
Further use of this data is for future study.<a class="pilcrow" href="#section-6.2-11">Â¶</a></p>
<p id="section-6.2-12">The data receiver is responsible for maintaining its receive buffers.
The data receiver <span class="bcp14">SHOULD</span> notify the data sender in a timely manner of
changes in its ability to receive data.
How an implementation manages its receive buffers is dependent on many
factors (e.g., operating system, memory management system, amount of memory,
etc.).
However, the data sender strategy defined in
<a class="xref" href="#sec_processing_of_received_sack">Section 6.2.1</a> is based on the assumption of
receiver operation similar to the following:<a class="pilcrow" href="#section-6.2-12">Â¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-6.2-13">
<dt>A)</dt>
<dd id="section-6.2-13.1">
            <p id="section-6.2-13.1.1">At initialization of the association, the endpoint tells the peer
how much receive buffer space it has allocated to the association
in the INIT or INIT ACK chunk.
The endpoint sets a_rwnd to this value.<a class="pilcrow" href="#section-6.2-13.1.1">Â¶</a></p>
</dd>
          <dd class="break"></dd>
<dt>B)</dt>
<dd id="section-6.2-13.2">
            <p id="section-6.2-13.2.1">As DATA chunks are received and buffered, decrement a_rwnd by the
number of bytes received and buffered.
This is, in effect, closing rwnd at the data sender and restricting the amount
of data it can transmit.<a class="pilcrow" href="#section-6.2-13.2.1">Â¶</a></p>
</dd>
          <dd class="break"></dd>
<dt>C)</dt>
<dd id="section-6.2-13.3">
            <p id="section-6.2-13.3.1">As DATA chunks are delivered to the ULP and released from the
receive buffers, increment a_rwnd by the number of bytes delivered
to the upper layer.
This is, in effect, opening up rwnd on the data sender and allowing it to
send more data.
The data receiver <span class="bcp14">SHOULD NOT</span> increment a_rwnd unless it has released bytes
from its receive buffer.
For example, if the receiver is holding fragmented DATA chunks in a reassembly
queue, it <span class="bcp14">SHOULD NOT</span> increment a_rwnd.<a class="pilcrow" href="#section-6.2-13.3.1">Â¶</a></p>
</dd>
          <dd class="break"></dd>
<dt>D)</dt>
<dd id="section-6.2-13.4">
            <p id="section-6.2-13.4.1">When sending a SACK chunk, the data receiver <span class="bcp14">SHOULD</span> place the current
value of a_rwnd into the a_rwnd field.
The data receiver <span class="bcp14">SHOULD</span> take into account that the data sender will not
retransmit DATA chunks that are acked via the Cumulative TSN Ack (i.e., will
drop from its retransmit queue).<a class="pilcrow" href="#section-6.2-13.4.1">Â¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-6.2-14">Under certain circumstances, the data receiver <span class="bcp14">MAY</span> drop DATA
chunks that it has received but has not released from its receive
buffers (i.e., delivered to the ULP).
These DATA chunks might have been acked in Gap Ack Blocks.
For example, the data receiver might be holding data in its receive buffers
while reassembling a fragmented user message from its peer when it runs out of
receive buffer space.
It <span class="bcp14">MAY</span> drop these DATA chunks even though it has acknowledged them in
Gap Ack Blocks.
If a data receiver drops DATA chunks, it <span class="bcp14">MUST NOT</span> include them in Gap Ack Blocks
in subsequent SACK chunks until they are received again via retransmission.
In addition, the endpoint <span class="bcp14">SHOULD</span> take into account the dropped data when
calculating its a_rwnd.<a class="pilcrow" href="#section-6.2-14">Â¶</a></p>
<p id="section-6.2-15">An endpoint <span class="bcp14">SHOULD NOT</span> revoke a SACK chunk and discard data.
Only in extreme circumstances might an endpoint use this procedure (such as
out of buffer space).
The data receiver <span class="bcp14">SHOULD</span> take into account that dropping data that has been
acked in Gap Ack Blocks can result in suboptimal retransmission strategies in
the data sender and thus in suboptimal performance.<a class="pilcrow" href="#section-6.2-15">Â¶</a></p>
<p id="section-6.2-16">The following example illustrates the use of delayed acknowledgements:<a class="pilcrow" href="#section-6.2-16">Â¶</a></p>
<span id="name-delayed-acknowledgement-exa"></span><div id="fig_delayed_ack_example">
<figure id="figure-7">
          <div class="alignCenter art-text artwork" id="section-6.2-17.1">
<pre>Endpoint A                                      Endpoint Z

{App sends 3 messages; strm 0}
DATA [TSN=7,Strm=0,Seq=3] ------------&gt; (ack delayed)
(Start T3-rtx timer)

DATA [TSN=8,Strm=0,Seq=4] ------------&gt; (send ack)
                              /------- SACK [TSN Ack=8,block=0]
(cancel T3-rtx timer)  &lt;-----/

DATA [TSN=9,Strm=0,Seq=5] ------------&gt; (ack delayed)
(Start T3-rtx timer)
                                       ...
                                       {App sends 1 message; strm 1}
                                       (bundle SACK with DATA)
                                /----- SACK [TSN Ack=9,block=0] \
                               /         DATA [TSN=6,Strm=1,Seq=2]
(cancel T3-rtx timer)  &lt;------/        (Start T3-rtx timer)

(ack delayed)
(send ack)
SACK [TSN Ack=6,block=0] -------------&gt; (cancel T3-rtx timer)
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-7">Figure 7</a>:
<a class="selfRef" href="#name-delayed-acknowledgement-exa">Delayed Acknowledgement Example</a>
          </figcaption></figure>
</div>
<p id="section-6.2-18">If an endpoint receives a DATA chunk with no user data (i.e., the
Length field is set to 16), it <span class="bcp14">SHOULD</span> send an ABORT chunk with a "No User Data"
error cause.<a class="pilcrow" href="#section-6.2-18">Â¶</a></p>
<p id="section-6.2-19">An endpoint <span class="bcp14">SHOULD NOT</span> send a DATA chunk with no user data part.
This avoids the need to be able to return a zero-length user
message in the API, especially in the socket API as specified in
<span>[<a class="xref" href="#RFC6458">RFC6458</a>]</span> for details.<a class="pilcrow" href="#section-6.2-19">Â¶</a></p>
<div id="sec_processing_of_received_sack">
<section id="section-6.2.1">
          <h4 id="name-processing-a-received-sack-">
<a class="section-number selfRef" href="#section-6.2.1">6.2.1. </a><a class="section-name selfRef" href="#name-processing-a-received-sack-">Processing a Received SACK Chunk</a>
          </h4>
<p id="section-6.2.1-1">Each SACK chunk an endpoint receives contains an a_rwnd value.
This value represents the amount of buffer space the data receiver, at the time
of transmitting the SACK chunk, has left of its total receive buffer space
(as specified in the INIT/INIT ACK chunk).
Using a_rwnd, Cumulative TSN Ack, and Gap Ack Blocks, the data sender can
develop a representation of the peer's receive buffer space.<a class="pilcrow" href="#section-6.2.1-1">Â¶</a></p>
<p id="section-6.2.1-2">One of the problems the data sender takes into account when
processing a SACK chunk is that a SACK chunk can be received out of order.
That is, a SACK chunk sent by the data receiver can pass an earlier SACK chunk
and be received first by the data sender.
If a SACK chunk is received out of order, the data sender can develop an
incorrect view of the peer's receive buffer space.<a class="pilcrow" href="#section-6.2.1-2">Â¶</a></p>
<p id="section-6.2.1-3">Since there is no explicit identifier that can be used to detect out-of-order
SACK chunks, the data sender uses heuristics to determine if a SACK chunk is
new.<a class="pilcrow" href="#section-6.2.1-3">Â¶</a></p>
<p id="section-6.2.1-4">An endpoint <span class="bcp14">SHOULD</span> use the following rules to calculate the rwnd,
using the a_rwnd value, the Cumulative TSN Ack, and Gap Ack Blocks in
a received SACK chunk.<a class="pilcrow" href="#section-6.2.1-4">Â¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-6.2.1-5">
<dt>A)</dt>
<dd id="section-6.2.1-5.1">
              <p id="section-6.2.1-5.1.1">At the establishment of the association, the endpoint initializes
the rwnd to the Advertised Receiver Window Credit (a_rwnd) the peer specified
in the INIT or INIT ACK chunk.<a class="pilcrow" href="#section-6.2.1-5.1.1">Â¶</a></p>
</dd>
            <dd class="break"></dd>
<dt>B)</dt>
<dd id="section-6.2.1-5.2">
              <p id="section-6.2.1-5.2.1">Any time a DATA chunk is transmitted (or retransmitted) to a peer, the
endpoint subtracts the data size of the chunk from the rwnd of that peer.<a class="pilcrow" href="#section-6.2.1-5.2.1">Â¶</a></p>
</dd>
            <dd class="break"></dd>
<dt>C)</dt>
<dd id="section-6.2.1-5.3">
              <p id="section-6.2.1-5.3.1">Any time a DATA chunk is marked for retransmission, either via T3-rtx timer
expiration (<a class="xref" href="#sec_handle_t3_rtx_expiration">Section 6.3.3</a>) or
via Fast Retransmit (<a class="xref" href="#sec_fast_retransmit_on_gap_reports">Section 7.2.4</a>),
add the data size of those chunks to the rwnd.<a class="pilcrow" href="#section-6.2.1-5.3.1">Â¶</a></p>
</dd>
            <dd class="break"></dd>
<dt>D)</dt>
<dd id="section-6.2.1-5.4">
              <p id="section-6.2.1-5.4.1">Any time a SACK chunk arrives, the endpoint performs the following:<a class="pilcrow" href="#section-6.2.1-5.4.1">Â¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-6.2.1-5.4.2">
<dt>i)</dt>
<dd id="section-6.2.1-5.4.2.1">
                  <p id="section-6.2.1-5.4.2.1.1">If Cumulative TSN Ack is less than the Cumulative TSN Ack Point,
then drop the SACK chunk.
Since Cumulative TSN Ack is monotonically increasing, a SACK chunk whose
Cumulative TSN Ack is less than the Cumulative TSN Ack Point indicates an
out-of-order SACK chunk.<a class="pilcrow" href="#section-6.2.1-5.4.2.1.1">Â¶</a></p>
</dd>
                <dd class="break"></dd>
<dt>ii)</dt>
<dd id="section-6.2.1-5.4.2.2">
                  <p id="section-6.2.1-5.4.2.2.1">Set rwnd equal to the newly received a_rwnd minus the number of bytes still
outstanding after processing the Cumulative TSN Ack and the Gap Ack Blocks.<a class="pilcrow" href="#section-6.2.1-5.4.2.2.1">Â¶</a></p>
</dd>
                <dd class="break"></dd>
<dt>iii)</dt>
<dd id="section-6.2.1-5.4.2.3">
                  <p id="section-6.2.1-5.4.2.3.1">If the SACK chunk is missing a TSN that was previously acknowledged via
a Gap Ack Block (e.g., the data receiver reneged on the data), then consider
the corresponding DATA that might be possibly missing:
Count one miss indication towards Fast Retransmit as described in
<a class="xref" href="#sec_fast_retransmit_on_gap_reports">Section 7.2.4</a>,
and if no retransmit timer is running for the destination address to which the
DATA chunk was originally transmitted, then T3-rtx is started for that
destination address.<a class="pilcrow" href="#section-6.2.1-5.4.2.3.1">Â¶</a></p>
</dd>
                <dd class="break"></dd>
<dt>iv)</dt>
<dd id="section-6.2.1-5.4.2.4">
                  <p id="section-6.2.1-5.4.2.4.1">If the Cumulative TSN Ack matches or exceeds the Fast Recovery exit point
(<a class="xref" href="#sec_fast_retransmit_on_gap_reports">Section 7.2.4</a>),
Fast Recovery is exited.<a class="pilcrow" href="#section-6.2.1-5.4.2.4.1">Â¶</a></p>
</dd>
              <dd class="break"></dd>
</dl>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="sec_management_of_retransission_timer">
<section id="section-6.3">
        <h3 id="name-management-of-retransmissio">
<a class="section-number selfRef" href="#section-6.3">6.3. </a><a class="section-name selfRef" href="#name-management-of-retransmissio">Management of Retransmission Timer</a>
        </h3>
<p id="section-6.3-1">An SCTP endpoint uses a retransmission timer T3-rtx to ensure data
delivery in the absence of any feedback from its peer.
The duration of this timer is referred to as RTO (retransmission timeout).<a class="pilcrow" href="#section-6.3-1">Â¶</a></p>
<p id="section-6.3-2">When an endpoint's peer is multi-homed, the endpoint will calculate a
separate RTO for each different destination transport address of its
peer endpoint.<a class="pilcrow" href="#section-6.3-2">Â¶</a></p>
<p id="section-6.3-3">The computation and management of RTO in SCTP follow closely how TCP
manages its retransmission timer.
To compute the current RTO, an endpoint maintains two state variables per
destination transport address: SRTT (smoothed round-trip time) and
RTTVAR (round-trip time variation).<a class="pilcrow" href="#section-6.3-3">Â¶</a></p>
<div id="sec_rto_calculation">
<section id="section-6.3.1">
          <h4 id="name-rto-calculation">
<a class="section-number selfRef" href="#section-6.3.1">6.3.1. </a><a class="section-name selfRef" href="#name-rto-calculation">RTO Calculation</a>
          </h4>
<p id="section-6.3.1-1">The rules governing the computation of SRTT, RTTVAR, and RTO are as follows:<a class="pilcrow" href="#section-6.3.1-1">Â¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-6.3.1-2">
<dt>C1)</dt>
<dd id="section-6.3.1-2.1">
              <p id="section-6.3.1-2.1.1">Until an RTT measurement has been made for a packet sent to the given
destination transport address, set RTO to the protocol parameter
'RTO.Initial'.<a class="pilcrow" href="#section-6.3.1-2.1.1">Â¶</a></p>
</dd>
            <dd class="break"></dd>
<dt>C2)</dt>
<dd id="section-6.3.1-2.2">
              <p id="section-6.3.1-2.2.1">When the first RTT measurement R is made, perform:<a class="pilcrow" href="#section-6.3.1-2.2.1">Â¶</a></p>
<div id="section-6.3.1-2.2.2">
<pre class="lang-pseudocode sourcecode">SRTT = R
RTTVAR = R/2
RTO = SRTT + 4 * RTTVAR
</pre><a class="pilcrow" href="#section-6.3.1-2.2.2">Â¶</a>
</div>
</dd>
            <dd class="break"></dd>
<dt>C3)</dt>
<dd id="section-6.3.1-2.3">
              <p id="section-6.3.1-2.3.1">When a new RTT measurement R' is made, perform:<a class="pilcrow" href="#section-6.3.1-2.3.1">Â¶</a></p>
<div id="section-6.3.1-2.3.2">
<pre class="lang-pseudocode sourcecode">RTTVAR = (1 - RTO.Beta) * RTTVAR + RTO.Beta * |SRTT - R'|
SRTT = (1 - RTO.Alpha) * SRTT + RTO.Alpha * R'
</pre><a class="pilcrow" href="#section-6.3.1-2.3.2">Â¶</a>
</div>
<p id="section-6.3.1-2.3.3">Note: The value of SRTT used in the update to RTTVAR is its
value before updating SRTT itself using the second assignment.<a class="pilcrow" href="#section-6.3.1-2.3.3">Â¶</a></p>
<p id="section-6.3.1-2.3.4">After the computation, update:<a class="pilcrow" href="#section-6.3.1-2.3.4">Â¶</a></p>
<div id="section-6.3.1-2.3.5">
<pre class="lang-pseudocode sourcecode">RTO = SRTT + 4 * RTTVAR
</pre><a class="pilcrow" href="#section-6.3.1-2.3.5">Â¶</a>
</div>
</dd>
            <dd class="break"></dd>
<dt>C4)</dt>
<dd id="section-6.3.1-2.4">
              <p id="section-6.3.1-2.4.1">When data is in flight and when allowed by rule C5 below, a new
RTT measurement <span class="bcp14">MUST</span> be made each round trip.
Furthermore, new RTT measurements <span class="bcp14">SHOULD</span> be made no more than once per
round trip for a given destination transport address.
There are two reasons for this recommendation:
First, it appears that measuring more frequently often does not in practice
yield any significant benefit <span>[<a class="xref" href="#ALLMAN99">ALLMAN99</a>]</span>;
second, if measurements are made more often, then the values of 'RTO.Alpha' and
'RTO.Beta' in rule C3 above <span class="bcp14">SHOULD</span> be adjusted so that SRTT and RTTVAR still
adjust to changes at roughly the same rate (in terms of how many round
trips it takes them to reflect new values) as they would if making only one
measurement per round trip and using 'RTO.Alpha' and 'RTO.Beta' as given in rule C3.
However, the exact nature of these adjustments remains a research issue.<a class="pilcrow" href="#section-6.3.1-2.4.1">Â¶</a></p>
</dd>
            <dd class="break"></dd>
<dt>C5)</dt>
<dd id="section-6.3.1-2.5">
              <p id="section-6.3.1-2.5.1">Karn's algorithm: RTT measurements <span class="bcp14">MUST NOT</span> be made using chunks that
were retransmitted (and thus for which it is ambiguous whether the reply was
for the first instance of the chunk or for a later instance).<a class="pilcrow" href="#section-6.3.1-2.5.1">Â¶</a></p>
<p id="section-6.3.1-2.5.2">RTT measurements <span class="bcp14">SHOULD</span> only be made using a DATA chunk with TSN r if no
DATA chunk with TSN less than or equal to r was retransmitted since the DATA
chunk with TSN r was sent first.<a class="pilcrow" href="#section-6.3.1-2.5.2">Â¶</a></p>
</dd>
            <dd class="break"></dd>
<dt>C6)</dt>
<dd id="section-6.3.1-2.6">
              <p id="section-6.3.1-2.6.1">Whenever RTO is computed, if it is less than 'RTO.Min' seconds, then it is
rounded up to 'RTO.Min' seconds.
The reason for this rule is that RTOs that do not have a high minimum value are
susceptible to unnecessary timeouts <span>[<a class="xref" href="#ALLMAN99">ALLMAN99</a>]</span>.<a class="pilcrow" href="#section-6.3.1-2.6.1">Â¶</a></p>
</dd>
            <dd class="break"></dd>
<dt>C7)</dt>
<dd id="section-6.3.1-2.7">
              <p id="section-6.3.1-2.7.1">A maximum value <span class="bcp14">MAY</span> be placed on RTO, provided it is at least
'RTO.Max' seconds.<a class="pilcrow" href="#section-6.3.1-2.7.1">Â¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-6.3.1-3">There is no requirement for the clock granularity G used for computing
RTT measurements and the different state variables, other than:<a class="pilcrow" href="#section-6.3.1-3">Â¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-6.3.1-4">
<dt>G1)</dt>
<dd id="section-6.3.1-4.1">
              <p id="section-6.3.1-4.1.1">Whenever RTTVAR is computed, if RTTVAR == 0, then adjust RTTVAR = G.<a class="pilcrow" href="#section-6.3.1-4.1.1">Â¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-6.3.1-5">Experience <span>[<a class="xref" href="#ALLMAN99">ALLMAN99</a>]</span> has shown that finer clock granularities
(less than 100 msec) perform somewhat better than more coarse granularities.<a class="pilcrow" href="#section-6.3.1-5">Â¶</a></p>
<p id="section-6.3.1-6">See <a class="xref" href="#sec_parameter_values">Section 16</a> for suggested parameter values.<a class="pilcrow" href="#section-6.3.1-6">Â¶</a></p>
</section>
</div>
<div id="sec_retransmission_timer_rules">
<section id="section-6.3.2">
          <h4 id="name-retransmission-timer-rules">
<a class="section-number selfRef" href="#section-6.3.2">6.3.2. </a><a class="section-name selfRef" href="#name-retransmission-timer-rules">Retransmission Timer Rules</a>
          </h4>
<p id="section-6.3.2-1">The rules for managing the retransmission timer are as follows:<a class="pilcrow" href="#section-6.3.2-1">Â¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-6.3.2-2">
<dt>R1)</dt>
<dd id="section-6.3.2-2.1">
              <p id="section-6.3.2-2.1.1">Every time a DATA chunk is sent to any address (including a retransmission),
if the T3-rtx timer of that address is not running, start it running so that
it will expire after the RTO of that address.
 The RTO used here is that obtained after any doubling due to previous
T3-rtx timer expirations on the corresponding destination address as discussed
in rule E2 below.<a class="pilcrow" href="#section-6.3.2-2.1.1">Â¶</a></p>
</dd>
            <dd class="break"></dd>
<dt>R2)</dt>
<dd id="section-6.3.2-2.2">
              <p id="section-6.3.2-2.2.1">Whenever all outstanding data sent to an address have been acknowledged,
turn off the T3-rtx timer of that address.<a class="pilcrow" href="#section-6.3.2-2.2.1">Â¶</a></p>
</dd>
            <dd class="break"></dd>
<dt>R3)</dt>
<dd id="section-6.3.2-2.3">
              <p id="section-6.3.2-2.3.1">Whenever a SACK chunk is received that acknowledges the DATA chunk with
the earliest outstanding TSN for that address, restart the T3-rtx timer for that
address with its current RTO (if there is still outstanding data on that
address).<a class="pilcrow" href="#section-6.3.2-2.3.1">Â¶</a></p>
</dd>
            <dd class="break"></dd>
<dt>R4)</dt>
<dd id="section-6.3.2-2.4">
              <p id="section-6.3.2-2.4.1">Whenever a SACK chunk is received missing a TSN that was previously
acknowledged via a Gap Ack Block, start the T3-rtx for the destination address
to which the DATA chunk was originally transmitted if it is not already
running.<a class="pilcrow" href="#section-6.3.2-2.4.1">Â¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-6.3.2-3">The following example shows the use of various timer rules (assuming
that the receiver uses delayed acks).<a class="pilcrow" href="#section-6.3.2-3">Â¶</a></p>
<span id="name-timer-rule-examples"></span><div id="fig_timer_rule_examples">
<figure id="figure-8">
            <div class="alignCenter art-text artwork" id="section-6.3.2-4.1">
<pre>Endpoint A                                         Endpoint Z
{App begins to send}
Data [TSN=7,Strm=0,Seq=3] ------------&gt; (ack delayed)
(Start T3-rtx timer)
                                        {App sends 1 message; strm 1}
                                        (bundle ack with data)
DATA [TSN=8,Strm=0,Seq=4] ----\     /-- SACK [TSN Ack=7,Block=0]
                               \   /      DATA [TSN=6,Strm=1,Seq=2]
                                \ /     (Start T3-rtx timer)
                                 \
                                / \
(Restart T3-rtx timer)  &lt;------/   \--&gt; (ack delayed)
(ack delayed)
{send ack}
SACK [TSN Ack=6,Block=0] --------------&gt; (Cancel T3-rtx timer)
                                        ..
                                        (send ack)
(Cancel T3-rtx timer)  &lt;-------------- SACK [TSN Ack=8,Block=0]
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-8">Figure 8</a>:
<a class="selfRef" href="#name-timer-rule-examples">Timer Rule Examples</a>
            </figcaption></figure>
</div>
</section>
</div>
<div id="sec_handle_t3_rtx_expiration">
<section id="section-6.3.3">
          <h4 id="name-handle-t3-rtx-expiration">
<a class="section-number selfRef" href="#section-6.3.3">6.3.3. </a><a class="section-name selfRef" href="#name-handle-t3-rtx-expiration">Handle T3-rtx Expiration</a>
          </h4>
<p id="section-6.3.3-1">Whenever the retransmission timer T3-rtx expires for a destination address,
do the following:<a class="pilcrow" href="#section-6.3.3-1">Â¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-6.3.3-2">
<dt>E1)</dt>
<dd id="section-6.3.3-2.1">
              <p id="section-6.3.3-2.1.1">For the destination address for which the timer expires, adjust its ssthresh
with rules defined in <a class="xref" href="#sec_congestion_control_sub">Section 7.2.3</a> and set
cwnd = PMDCS.<a class="pilcrow" href="#section-6.3.3-2.1.1">Â¶</a></p>
</dd>
            <dd class="break"></dd>
<dt>E2)</dt>
<dd id="section-6.3.3-2.2">
              <p id="section-6.3.3-2.2.1">For the destination address for which the timer expires, set
RTO = RTO * 2 ("back off the timer").
The maximum value discussed in rule C7 above ('RTO.Max') <span class="bcp14">MAY</span> be used to provide
an upper bound to this doubling operation.<a class="pilcrow" href="#section-6.3.3-2.2.1">Â¶</a></p>
</dd>
            <dd class="break"></dd>
<dt>E3)</dt>
<dd id="section-6.3.3-2.3">
              <p id="section-6.3.3-2.3.1">Determine how many of the earliest (i.e., lowest TSN) outstanding
DATA chunks for the address for which the T3-rtx has expired will fit into a
single SCTP packet, subject to the PMTU corresponding to the
destination transport address to which the retransmission is being sent
(this might be different from the address for which the timer expires;
see <a class="xref" href="#sec_multi_homed_sctp_endpoints">Section 6.4</a>).
Call this value K.
Bundle and retransmit those K DATA chunks in a single packet to the destination
endpoint.<a class="pilcrow" href="#section-6.3.3-2.3.1">Â¶</a></p>
</dd>
            <dd class="break"></dd>
<dt>E4)</dt>
<dd id="section-6.3.3-2.4">
              <p id="section-6.3.3-2.4.1">Start the retransmission timer T3-rtx on the destination address to which
the retransmission is sent if rule R1 above indicates to do so.
The RTO to be used for starting T3-rtx <span class="bcp14">SHOULD</span> be the one for the destination
address to which the retransmission is sent, which, when the receiver is
multi-homed, might be different from the destination address for which the
timer expired (see <a class="xref" href="#sec_multi_homed_sctp_endpoints">Section 6.4</a> below).<a class="pilcrow" href="#section-6.3.3-2.4.1">Â¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-6.3.3-3">After retransmitting, once a new RTT measurement is obtained (which can
happen only when new data has been sent and acknowledged, per rule C5,
or for a measurement made from a HEARTBEAT chunk;
see <a class="xref" href="#sec_path_heartbeat">Section 8.3</a>), the computation in rule C3 is
performed, including the computation of RTO, which might result in "collapsing"
RTO back down after it has been subject to doubling (rule E2).<a class="pilcrow" href="#section-6.3.3-3">Â¶</a></p>
<p id="section-6.3.3-4">Any DATA chunks that were sent to the address for which the
T3-rtx timer expired but did not fit in an SCTP packet of size smaller than or
equal to the PMTU (rule E3 above) <span class="bcp14">SHOULD</span> be marked for retransmission and sent
as soon as cwnd allows (normally, when a SACK chunk arrives).<a class="pilcrow" href="#section-6.3.3-4">Â¶</a></p>
<p id="section-6.3.3-5">The final rule for managing the retransmission timer concerns failover
(see <a class="xref" href="#sec_failover_from_an_inavtive_destination_address">Section 6.4.1</a>):<a class="pilcrow" href="#section-6.3.3-5">Â¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-6.3.3-6">
<dt>F1)</dt>
<dd id="section-6.3.3-6.1">
              <p id="section-6.3.3-6.1.1">Whenever an endpoint switches from the current destination
transport address to a different one, the current retransmission
timers are left running.
As soon as the endpoint transmits a packet containing DATA chunk(s) to the
new transport address, start the timer on that transport address, using the
RTO value of the destination address to which the data is being sent, if
rule R1 indicates to do so.<a class="pilcrow" href="#section-6.3.3-6.1.1">Â¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="sec_multi_homed_sctp_endpoints">
<section id="section-6.4">
        <h3 id="name-multi-homed-sctp-endpoints">
<a class="section-number selfRef" href="#section-6.4">6.4. </a><a class="section-name selfRef" href="#name-multi-homed-sctp-endpoints">Multi-Homed SCTP Endpoints</a>
        </h3>
<p id="section-6.4-1">An SCTP endpoint is considered multi-homed if there is more than one
transport address that can be used as a destination address to reach that
endpoint.<a class="pilcrow" href="#section-6.4-1">Â¶</a></p>
<p id="section-6.4-2">Moreover, the ULP of an endpoint selects one of the multiple
destination addresses of a multi-homed peer endpoint as the primary
path (see Sections <a class="xref" href="#sec_handle_address_parameters">5.1.2</a> and
<a class="xref" href="#sec_ulp_to_sctp">11.1</a> for details).<a class="pilcrow" href="#section-6.4-2">Â¶</a></p>
<p id="section-6.4-3">By default, an endpoint <span class="bcp14">SHOULD</span> always transmit to the primary path,
unless the SCTP user explicitly specifies the destination transport
address (and possibly source transport address) to use.<a class="pilcrow" href="#section-6.4-3">Â¶</a></p>
<p id="section-6.4-4">An endpoint <span class="bcp14">SHOULD</span> transmit reply chunks (e.g., INIT ACK, COOKIE ACK, and
HEARTBEAT ACK) in response to control chunks to the same destination
transport address from which it received the control chunk to which
it is replying.<a class="pilcrow" href="#section-6.4-4">Â¶</a></p>
<p id="section-6.4-5">The selection of the destination transport address for packets
containing SACK chunks is implementation dependent.
However, an endpoint <span class="bcp14">SHOULD NOT</span> vary the destination transport address of
a SACK chunk when it receives DATA chunks coming from the same source
address.<a class="pilcrow" href="#section-6.4-5">Â¶</a></p>
<p id="section-6.4-6">When acknowledging multiple DATA chunks received in packets
from different source addresses in a single SACK chunk, the SACK chunk <span class="bcp14">MAY</span>
be transmitted to one of the destination transport addresses from
which the DATA or control chunks being acknowledged were received.<a class="pilcrow" href="#section-6.4-6">Â¶</a></p>
<p id="section-6.4-7">When a receiver of a duplicate DATA chunk sends a SACK chunk to a multi-homed
endpoint, it <span class="bcp14">MAY</span> be beneficial to vary the destination address
and not use the source address of the DATA chunk.
The reason is that receiving a duplicate from a multi-homed endpoint might
indicate that the return path (as specified in the source address of the DATA
chunk) for the SACK chunk is broken.<a class="pilcrow" href="#section-6.4-7">Â¶</a></p>
<p id="section-6.4-8">Furthermore, when its peer is multi-homed, an endpoint <span class="bcp14">SHOULD</span> try to
retransmit a chunk that timed out to an active destination transport
address that is different from the last destination address to which
the chunk was sent.<a class="pilcrow" href="#section-6.4-8">Â¶</a></p>
<p id="section-6.4-9">When its peer is multi-homed, an endpoint <span class="bcp14">SHOULD</span> send fast retransmissions
to the same destination transport address to which the original data was sent.
If the primary path has been changed and the original data was sent to the
old primary path before the Fast Retransmit, the implementation <span class="bcp14">MAY</span> send it to
the new primary path.<a class="pilcrow" href="#section-6.4-9">Â¶</a></p>
<p id="section-6.4-10">Retransmissions do not affect the total outstanding data count.
However, if the DATA chunk is retransmitted onto a different destination
address, both the outstanding data counts on the new destination address and
the old destination address to which the data chunk was last sent is
adjusted accordingly.<a class="pilcrow" href="#section-6.4-10">Â¶</a></p>
<div id="sec_failover_from_an_inavtive_destination_address">
<section id="section-6.4.1">
          <h4 id="name-failover-from-an-inactive-d">
<a class="section-number selfRef" href="#section-6.4.1">6.4.1. </a><a class="section-name selfRef" href="#name-failover-from-an-inactive-d">Failover from an Inactive Destination Address</a>
          </h4>
<p id="section-6.4.1-1">Some of the transport addresses of a multi-homed SCTP endpoint might become
inactive due to either the occurrence of certain error conditions
(see <a class="xref" href="#sec_path_failure_detection">Section 8.2</a>) or adjustments from the
SCTP user.<a class="pilcrow" href="#section-6.4.1-1">Â¶</a></p>
<p id="section-6.4.1-2">When there is outbound data to send and the primary path becomes inactive
(e.g., due to failures) or where the SCTP user explicitly requests to send data
to an inactive destination transport address before reporting an error to its
ULP, the SCTP endpoint <span class="bcp14">SHOULD</span> try to send the data to an alternate active
destination transport address if one exists.<a class="pilcrow" href="#section-6.4.1-2">Â¶</a></p>
<p id="section-6.4.1-3">When retransmitting data that timed out, if the endpoint is multi-homed,
it needs to consider each source-destination address pair in its
retransmission selection policy.
When retransmitting timed-out data, the endpoint <span class="bcp14">SHOULD</span> attempt to pick the
most divergent source-destination pair from the original source-destination
pair to which the packet was transmitted.<a class="pilcrow" href="#section-6.4.1-3">Â¶</a></p>
<p id="section-6.4.1-4">Note: Rules for picking the most divergent source-destination pair
are an implementation decision and are not specified within this document.<a class="pilcrow" href="#section-6.4.1-4">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec_stream_identifier_and_stream_sequence_number">
<section id="section-6.5">
        <h3 id="name-stream-identifier-and-strea">
<a class="section-number selfRef" href="#section-6.5">6.5. </a><a class="section-name selfRef" href="#name-stream-identifier-and-strea">Stream Identifier and Stream Sequence Number</a>
        </h3>
<p id="section-6.5-1">Every DATA chunk <span class="bcp14">MUST</span> carry a valid stream identifier.
If an endpoint receives a DATA chunk with an invalid stream identifier, it
<span class="bcp14">SHOULD</span> acknowledge the reception of the DATA chunk following the
normal procedure, immediately send an ERROR chunk with cause set to
"Invalid Stream Identifier" (see <a class="xref" href="#sec_error_chunk">Section 3.3.10</a>),
and discard the DATA chunk.
The endpoint <span class="bcp14">MAY</span> bundle the ERROR chunk and the SACK chunk in the same
packet.<a class="pilcrow" href="#section-6.5-1">Â¶</a></p>
<p id="section-6.5-2">The Stream Sequence Number in all the outgoing streams <span class="bcp14">MUST</span> start from 0 when
the association is established.
The Stream Sequence Number of an outgoing stream <span class="bcp14">MUST</span> be incremented by 1 for
each ordered user message sent on that outgoing stream.
In particular, when the Stream Sequence Number reaches the value 65535, the
next Stream Sequence Number <span class="bcp14">MUST</span> be set to 0.
For unordered user messages, the Stream Sequence Number <span class="bcp14">MUST NOT</span> be changed.<a class="pilcrow" href="#section-6.5-2">Â¶</a></p>
</section>
</div>
<div id="sec_ordered_and_unordered_delivery">
<section id="section-6.6">
        <h3 id="name-ordered-and-unordered-deliv">
<a class="section-number selfRef" href="#section-6.6">6.6. </a><a class="section-name selfRef" href="#name-ordered-and-unordered-deliv">Ordered and Unordered Delivery</a>
        </h3>
<p id="section-6.6-1">Within a stream, an endpoint <span class="bcp14">MUST</span> deliver DATA chunks received with
the U flag set to 0 to the upper layer according to the order of
their Stream Sequence Number.
If DATA chunks arrive out of order of their Stream Sequence Number,
the endpoint <span class="bcp14">MUST</span> hold the received DATA chunks from delivery to the ULP until
they are reordered.<a class="pilcrow" href="#section-6.6-1">Â¶</a></p>
<p id="section-6.6-2">However, an SCTP endpoint can indicate that no ordered delivery is
required for a particular DATA chunk transmitted within the stream by
setting the U flag of the DATA chunk to 1.<a class="pilcrow" href="#section-6.6-2">Â¶</a></p>
<p id="section-6.6-3">When an endpoint receives a DATA chunk with the U flag set to 1, it
bypasses the ordering mechanism and immediately deliver the data
to the upper layer (after reassembly if the user data is fragmented
by the data sender).<a class="pilcrow" href="#section-6.6-3">Â¶</a></p>
<p id="section-6.6-4">This provides an effective way of transmitting "out-of-band" data in
a given stream.
Also, a stream can be used as an "unordered" stream by simply setting the
U flag to 1 in all DATA chunks sent through that stream.<a class="pilcrow" href="#section-6.6-4">Â¶</a></p>
<p id="section-6.6-5">Implementation Note: When sending an unordered DATA chunk, an implementation
<span class="bcp14">MAY</span> choose to place the DATA chunk in an outbound packet that is at the head of
the outbound transmission queue if possible.<a class="pilcrow" href="#section-6.6-5">Â¶</a></p>
<p id="section-6.6-6">The 'Stream Sequence Number' field in a DATA chunk with U flag set to
1 has no significance.
The sender can fill the 'Stream Sequence Number' with arbitrary value, but
the receiver <span class="bcp14">MUST</span> ignore the field.<a class="pilcrow" href="#section-6.6-6">Â¶</a></p>
<p id="section-6.6-7">Note: When transmitting ordered and unordered data, an endpoint does
not increment its Stream Sequence Number when transmitting a DATA chunk with
U flag set to 1.<a class="pilcrow" href="#section-6.6-7">Â¶</a></p>
</section>
</div>
<div id="sec_report_gaps_in_received_data_tsns">
<section id="section-6.7">
        <h3 id="name-report-gaps-in-received-dat">
<a class="section-number selfRef" href="#section-6.7">6.7. </a><a class="section-name selfRef" href="#name-report-gaps-in-received-dat">Report Gaps in Received DATA TSNs</a>
        </h3>
<p id="section-6.7-1">Upon the reception of a new DATA chunk, an endpoint examines the
continuity of the TSNs received.
If the endpoint detects a gap in the received DATA chunk sequence, it <span class="bcp14">SHOULD</span>
send a SACK chunk with Gap Ack Blocks immediately.
The data receiver continues sending a SACK chunk after receipt of each
SCTP packet that does not fill the gap.<a class="pilcrow" href="#section-6.7-1">Â¶</a></p>
<p id="section-6.7-2">Based on the Gap Ack Block from the received SACK chunk, the endpoint can
calculate the missing DATA chunks and make decisions on whether to
retransmit them (see <a class="xref" href="#sec_processing_of_received_sack">Section 6.2.1</a>
for details).<a class="pilcrow" href="#section-6.7-2">Â¶</a></p>
<p id="section-6.7-3">Multiple gaps can be reported in one single SACK chunk
(see <a class="xref" href="#sec_sack_chunk">Section 3.3.4</a>).<a class="pilcrow" href="#section-6.7-3">Â¶</a></p>
<p id="section-6.7-4">When its peer is multi-homed, the SCTP endpoint <span class="bcp14">SHOULD</span> always try to
send the SACK chunk to the same destination address from which the last
DATA chunk was received.<a class="pilcrow" href="#section-6.7-4">Â¶</a></p>
<p id="section-6.7-5">Upon the reception of a SACK chunk, the endpoint <span class="bcp14">MUST</span> remove all DATA chunks
that have been acknowledged by the SACK chunk's Cumulative TSN Ack from its
transmit queue.
All DATA chunks with TSNs not included in the Gap Ack Blocks that are smaller
than the highest-acknowledged TSN reported in the SACK chunk <span class="bcp14">MUST</span> be treated as
"missing" by the sending endpoint.
The number of "missing" reports for each outstanding DATA chunk <span class="bcp14">MUST</span> be
recorded by the data sender to make retransmission decisions.
See <a class="xref" href="#sec_fast_retransmit_on_gap_reports">Section 7.2.4</a> for details.<a class="pilcrow" href="#section-6.7-5">Â¶</a></p>
<p id="section-6.7-6">The following example shows the use of SACK chunk to report a gap.<a class="pilcrow" href="#section-6.7-6">Â¶</a></p>
<span id="name-reporting-a-gap-using-sack-"></span><div id="fig_report_gap_using_sack">
<figure id="figure-9">
          <div class="alignCenter art-text artwork" id="section-6.7-7.1">
<pre>Endpoint A                                    Endpoint Z
{App sends 3 messages; strm 0}
DATA [TSN=6,Strm=0,Seq=2] ---------------&gt; (ack delayed)
(Start T3-rtx timer)

DATA [TSN=7,Strm=0,Seq=3] --------&gt; X (lost)

DATA [TSN=8,Strm=0,Seq=4] ---------------&gt; (gap detected,
                                            immediately send ack)
                                /----- SACK [TSN Ack=6,Block=1,
                               /             Start=2,End=2]
                        &lt;-----/
(remove 6 from out-queue,
 and mark 7 as "1" missing report)
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-9">Figure 9</a>:
<a class="selfRef" href="#name-reporting-a-gap-using-sack-">Reporting a Gap Using SACK Chunk</a>
          </figcaption></figure>
</div>
<p id="section-6.7-8">The maximum number of Gap Ack Blocks that can be reported within a
single SACK chunk is limited by the current PMTU.
When a single SACK chunk cannot cover all the Gap Ack Blocks needed to be
reported due to the PMTU limitation, the endpoint <span class="bcp14">MUST</span> send only one SACK chunk.
This single SACK chunk <span class="bcp14">MUST</span> report the Gap Ack Blocks from the lowest to
highest TSNs, within the size limit set by the PMTU, and leave the remaining
highest TSN numbers unacknowledged.<a class="pilcrow" href="#section-6.7-8">Â¶</a></p>
</section>
</div>
<div id="sec_crc32c_checksum_calculation">
<section id="section-6.8">
        <h3 id="name-crc32c-checksum-calculation">
<a class="section-number selfRef" href="#section-6.8">6.8. </a><a class="section-name selfRef" href="#name-crc32c-checksum-calculation">CRC32c Checksum Calculation</a>
        </h3>
<p id="section-6.8-1">When sending an SCTP packet, the endpoint <span class="bcp14">MUST</span> strengthen the data integrity
of the transmission by including the CRC32c checksum value calculated on the
packet, as described below.<a class="pilcrow" href="#section-6.8-1">Â¶</a></p>
<p id="section-6.8-2">After the packet is constructed (containing the SCTP common header
and one or more control or DATA chunks), the transmitter <span class="bcp14">MUST</span>:<a class="pilcrow" href="#section-6.8-2">Â¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-6.8-3">
<dt>1)</dt>
<dd id="section-6.8-3.1">
            <p id="section-6.8-3.1.1">fill in the proper Verification Tag in the SCTP common header and initialize
the checksum field to 0,<a class="pilcrow" href="#section-6.8-3.1.1">Â¶</a></p>
</dd>
          <dd class="break"></dd>
<dt>2)</dt>
<dd id="section-6.8-3.2">
            <p id="section-6.8-3.2.1">calculate the CRC32c checksum of the whole packet, including the SCTP common
header and all the chunks (refer to <a class="xref" href="#sec_crc32c">Appendix A</a> for details of
the CRC32c algorithm), and<a class="pilcrow" href="#section-6.8-3.2.1">Â¶</a></p>
</dd>
          <dd class="break"></dd>
<dt>3)</dt>
<dd id="section-6.8-3.3">
            <p id="section-6.8-3.3.1">put the resultant value into the checksum field in the common header and
leave the rest of the bits unchanged.<a class="pilcrow" href="#section-6.8-3.3.1">Â¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-6.8-4">When an SCTP packet is received, the receiver <span class="bcp14">MUST</span> first check the CRC32c
checksum as follows:<a class="pilcrow" href="#section-6.8-4">Â¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-6.8-5">
<dt>1)</dt>
<dd id="section-6.8-5.1">
            <p id="section-6.8-5.1.1">Store the received CRC32c checksum value aside.<a class="pilcrow" href="#section-6.8-5.1.1">Â¶</a></p>
</dd>
          <dd class="break"></dd>
<dt>2)</dt>
<dd id="section-6.8-5.2">
            <p id="section-6.8-5.2.1">Replace the 32 bits of the checksum field in the received SCTP packet with
0 and calculate a CRC32c checksum value of the whole received packet.<a class="pilcrow" href="#section-6.8-5.2.1">Â¶</a></p>
</dd>
          <dd class="break"></dd>
<dt>3)</dt>
<dd id="section-6.8-5.3">
            <p id="section-6.8-5.3.1">Verify that the calculated CRC32c checksum is the same as the received
CRC32c checksum.
If it is not, the receiver <span class="bcp14">MUST</span> treat the packet as an invalid SCTP packet.<a class="pilcrow" href="#section-6.8-5.3.1">Â¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-6.8-6">The default procedure for handling invalid SCTP packets is to silently
discard them.<a class="pilcrow" href="#section-6.8-6">Â¶</a></p>
<p id="section-6.8-7">Any hardware implementation <span class="bcp14">SHOULD</span> permit alternative verification of the
CRC in software.<a class="pilcrow" href="#section-6.8-7">Â¶</a></p>
</section>
</div>
<div id="sec_frag_reass">
<section id="section-6.9">
        <h3 id="name-fragmentation-and-reassembl">
<a class="section-number selfRef" href="#section-6.9">6.9. </a><a class="section-name selfRef" href="#name-fragmentation-and-reassembl">Fragmentation and Reassembly</a>
        </h3>
<p id="section-6.9-1">An endpoint <span class="bcp14">MAY</span> support fragmentation when sending DATA chunks, but
it <span class="bcp14">MUST</span> support reassembly when receiving DATA chunks.
If an endpoint supports fragmentation, it <span class="bcp14">MUST</span> fragment a user message if
the size of the user message to be sent causes the outbound SCTP
packet size to exceed the current PMTU.
An endpoint that does not support fragmentation and is requested to send a
user message such that the outbound SCTP packet size would exceed the
current PMTU <span class="bcp14">MUST</span> return an error to its upper layer and <span class="bcp14">MUST NOT</span> attempt to
send the user message.<a class="pilcrow" href="#section-6.9-1">Â¶</a></p>
<p id="section-6.9-2">An SCTP implementation <span class="bcp14">MAY</span> provide a mechanism to the upper layer that
disables fragmentation when sending DATA chunks.
When fragmentation of DATA chunks is disabled, the SCTP implementation <span class="bcp14">MUST</span>
behave in the same way an implementation that does not support fragmentation,
i.e., it  rejects calls that would result in sending SCTP packets that exceed
the current PMTU.<a class="pilcrow" href="#section-6.9-2">Â¶</a></p>
<p id="section-6.9-3">Implementation Note: In this error case, the SEND primitive discussed
in <a class="xref" href="#sec_send">Section 11.1.5</a> would need to return an error to the
upper layer.<a class="pilcrow" href="#section-6.9-3">Â¶</a></p>
<p id="section-6.9-4">If its peer is multi-homed, the endpoint <span class="bcp14">SHOULD</span> choose a DATA chunk size
smaller than or equal to the AMDCS.<a class="pilcrow" href="#section-6.9-4">Â¶</a></p>
<p id="section-6.9-5">Once a user message is fragmented, it cannot be re-fragmented.
Instead, if the PMTU has been reduced, then IP fragmentation <span class="bcp14">MUST</span> be used.
Therefore, an SCTP association can fail if IP fragmentation is not working on
any path.
Please see <a class="xref" href="#sec_path_mtu_discovery">Section 7.3</a> for details of
PMTU discovery.<a class="pilcrow" href="#section-6.9-5">Â¶</a></p>
<p id="section-6.9-6">When determining when to fragment, the SCTP implementation <span class="bcp14">MUST</span> take
into account the SCTP packet header as well as the DATA chunk header(s).
The implementation <span class="bcp14">MUST</span> also take into account the space required for a SACK
chunk if bundling a SACK chunk with the DATA chunk.<a class="pilcrow" href="#section-6.9-6">Â¶</a></p>
<p id="section-6.9-7">Fragmentation takes the following steps:<a class="pilcrow" href="#section-6.9-7">Â¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-6.9-8">
<dt>1)</dt>
<dd id="section-6.9-8.1">
            <p id="section-6.9-8.1.1">The data sender <span class="bcp14">MUST</span> break the user message into a series of DATA chunks.
The sender <span class="bcp14">SHOULD</span> choose a size of DATA chunks that is smaller than or equal
to the AMDCS.<a class="pilcrow" href="#section-6.9-8.1.1">Â¶</a></p>
</dd>
          <dd class="break"></dd>
<dt>2)</dt>
<dd id="section-6.9-8.2">
            <p id="section-6.9-8.2.1">The transmitter <span class="bcp14">MUST</span> then assign, in sequence, a separate TSN to each of the
DATA chunks in the series.
The transmitter assigns the same Stream Sequence Number to each of the
DATA chunks.
If the user indicates that the user message is to be delivered using unordered
delivery, then the U flag of each DATA chunk of the user message <span class="bcp14">MUST</span> be set
to 1.<a class="pilcrow" href="#section-6.9-8.2.1">Â¶</a></p>
</dd>
          <dd class="break"></dd>
<dt>3)</dt>
<dd id="section-6.9-8.3">
            <p id="section-6.9-8.3.1">The transmitter <span class="bcp14">MUST</span> also set the B/E bits of the first DATA chunk in the
series to 10, the B/E bits of the last DATA chunk in the series to 01,
and the B/E bits of all other DATA chunks in the series to 00.<a class="pilcrow" href="#section-6.9-8.3.1">Â¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-6.9-9">An endpoint <span class="bcp14">MUST</span> recognize fragmented DATA chunks by examining the B/E bits
in each of the received DATA chunks and queue the fragmented DATA chunks for
reassembly.
Once the user message is reassembled, SCTP passes the reassembled user
message to the specific stream for possible reordering and final
dispatching.<a class="pilcrow" href="#section-6.9-9">Â¶</a></p>
<p id="section-6.9-10">If the data receiver runs out of buffer space while still waiting for
more fragments to complete the reassembly of the message, it <span class="bcp14">SHOULD</span> dispatch
part of its inbound message through a partial delivery API
(see <a class="xref" href="#sec_api">Section 11</a>), freeing some of its receive buffer space so
that the rest of the message can be received.<a class="pilcrow" href="#section-6.9-10">Â¶</a></p>
</section>
</div>
<div id="sec_bundling">
<section id="section-6.10">
        <h3 id="name-bundling">
<a class="section-number selfRef" href="#section-6.10">6.10. </a><a class="section-name selfRef" href="#name-bundling">Bundling</a>
        </h3>
<p id="section-6.10-1">An endpoint bundles chunks by simply including multiple chunks in one
outbound SCTP packet.
The total size of the resultant SCTP packet <span class="bcp14">MUST</span> be less that or equal to the
current PMTU.<a class="pilcrow" href="#section-6.10-1">Â¶</a></p>
<p id="section-6.10-2">If its peer endpoint is multi-homed, the sending endpoint <span class="bcp14">SHOULD</span> choose a
size no larger than the PMTU of the current primary path.<a class="pilcrow" href="#section-6.10-2">Â¶</a></p>
<p id="section-6.10-3">When bundling control chunks with DATA chunks, an endpoint <span class="bcp14">MUST</span> place
control chunks first in the outbound SCTP packet.
The transmitter <span class="bcp14">MUST</span> transmit DATA chunks within an SCTP packet in increasing
order of TSN.<a class="pilcrow" href="#section-6.10-3">Â¶</a></p>
<p id="section-6.10-4">Note: Since control chunks are placed first in a packet and since
DATA chunks are transmitted before SHUTDOWN or SHUTDOWN ACK
chunks, DATA chunks cannot be bundled with SHUTDOWN or SHUTDOWN ACK
chunks.<a class="pilcrow" href="#section-6.10-4">Â¶</a></p>
<p id="section-6.10-5">Partial chunks <span class="bcp14">MUST NOT</span> be placed in an SCTP packet.
A partial chunk is a chunk that is not completely contained in the SCTP packet;
i.e., the SCTP packet is too short to contain all the bytes of the chunk as
indicated by the chunk length.<a class="pilcrow" href="#section-6.10-5">Â¶</a></p>
<p id="section-6.10-6">An endpoint <span class="bcp14">MUST</span> process received chunks in their order in the packet.
The receiver uses the Chunk Length field to determine the end of a chunk
and beginning of the next chunk, taking account of the
fact that all chunks end on a 4-byte boundary.
If the receiver detects a partial chunk, it <span class="bcp14">MUST</span> drop the chunk.<a class="pilcrow" href="#section-6.10-6">Â¶</a></p>
<p id="section-6.10-7">An endpoint <span class="bcp14">MUST NOT</span> bundle INIT, INIT ACK, or SHUTDOWN COMPLETE chunks
with any other chunks.<a class="pilcrow" href="#section-6.10-7">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec_congestion_control">
<section id="section-7">
      <h2 id="name-congestion-control">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-congestion-control">Congestion Control</a>
      </h2>
<p id="section-7-1">Congestion control is one of the basic functions in SCTP.
To manage congestion, the mechanisms and algorithms in this section are to be
employed.<a class="pilcrow" href="#section-7-1">Â¶</a></p>
<p id="section-7-2">Implementation Note: As far as its specific performance requirements
are met, an implementation is always allowed to adopt a more conservative
congestion control algorithm than the one defined below.<a class="pilcrow" href="#section-7-2">Â¶</a></p>
<p id="section-7-3">The congestion control algorithms used by SCTP are based on
<span>[<a class="xref" href="#RFC5681">RFC5681</a>]</span>.
This section describes how the algorithms defined in <span>[<a class="xref" href="#RFC5681">RFC5681</a>]</span>
are adapted for use in SCTP.
We first list differences in protocol designs between TCP and SCTP and then
describe SCTP's congestion control scheme.
The description will use the same terminology as in TCP congestion control
whenever appropriate.<a class="pilcrow" href="#section-7-3">Â¶</a></p>
<p id="section-7-4">SCTP congestion control is always applied to the entire association
and not to individual streams.<a class="pilcrow" href="#section-7-4">Â¶</a></p>
<div id="sec_sctp_differences_from_tcp_congestion_control">
<section id="section-7.1">
        <h3 id="name-sctp-differences-from-tcp-c">
<a class="section-number selfRef" href="#section-7.1">7.1. </a><a class="section-name selfRef" href="#name-sctp-differences-from-tcp-c">SCTP Differences from TCP Congestion Control</a>
        </h3>
<p id="section-7.1-1">Gap Ack Blocks in the SCTP SACK chunk carry the same semantic meaning as the
TCP SACK.
TCP considers the information carried in the SACK as advisory information only.
SCTP considers the information carried in the Gap Ack Blocks in the SACK chunk
as advisory.
In SCTP, any DATA chunk that has been acknowledged by a SACK chunk, including
DATA that arrived at the receiving end out of order, is not considered fully
delivered until the Cumulative TSN Ack Point passes the TSN of the DATA chunk
(i.e., the DATA chunk has been acknowledged by the Cumulative TSN Ack
field in the SACK chunk).
Consequently, the value of cwnd controls the amount of outstanding data,
rather than (as in the case of non-SACK TCP) the upper bound between the
highest acknowledged sequence number and the latest DATA chunk that can be
sent within the congestion window.
SCTP SACK leads to different implementations of Fast Retransmit and Fast
Recovery than non-SACK TCP.
As an example, see <span>[<a class="xref" href="#FALL96">FALL96</a>]</span>.<a class="pilcrow" href="#section-7.1-1">Â¶</a></p>
<p id="section-7.1-2">The biggest difference between SCTP and TCP, however, is multi-homing.
SCTP is designed to establish robust communication associations between
two endpoints, each of which might be reachable by more than one transport address.
Potentially different addresses might lead to different data paths between the
two endpoints;
thus, ideally, one needs a separate set of congestion control parameters for
each of the paths.
The treatment here of congestion control for multi-homed receivers is new with
SCTP and might require refinement in the future.
The current algorithms make the following assumptions:<a class="pilcrow" href="#section-7.1-2">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1-3.1">
            <p id="section-7.1-3.1.1">The sender usually uses the same destination address until being instructed
by the upper layer to do otherwise; however, SCTP <span class="bcp14">MAY</span> change to an alternate
destination in the event an address is marked inactive
(see <a class="xref" href="#sec_path_failure_detection">Section 8.2</a>).
Also, SCTP <span class="bcp14">MAY</span> retransmit to a different transport address than the original
transmission.<a class="pilcrow" href="#section-7.1-3.1.1">Â¶</a></p>
</li>
          <li class="normal" id="section-7.1-3.2">
            <p id="section-7.1-3.2.1">The sender keeps a separate congestion control parameter set for each of
the destination addresses it can send to (not each source-destination pair but
for each destination).
The parameters <span class="bcp14">SHOULD</span> decay if the address is not used for a long enough time
period.
<span>[<a class="xref" href="#RFC5681">RFC5681</a>]</span> specifies this period of time as a retransmission
timeout.<a class="pilcrow" href="#section-7.1-3.2.1">Â¶</a></p>
</li>
          <li class="normal" id="section-7.1-3.3">
            <p id="section-7.1-3.3.1">For each of the destination addresses, an endpoint does slow start upon
the first transmission to that address.<a class="pilcrow" href="#section-7.1-3.3.1">Â¶</a></p>
</li>
        </ul>
<p id="section-7.1-4">Note: TCP guarantees in-sequence delivery of data to its upper-layer
protocol within a single TCP session.
This means that when TCP notices a gap in the received sequence number, it
waits until the gap is filled before delivering the data that was received
with sequence numbers higher than that of the missing data.
On the other hand, SCTP can deliver data to its upper-layer protocol, even if
there is a gap in TSN if the Stream Sequence Numbers are in sequence for a
particular stream (i.e., the missing DATA chunks are for a different stream)
or if unordered delivery is indicated.
Although this does not affect cwnd, it might affect rwnd calculation.<a class="pilcrow" href="#section-7.1-4">Â¶</a></p>
</section>
</div>
<div id="sec_sctp_slow_start_and_congestion_avoidance">
<section id="section-7.2">
        <h3 id="name-sctp-slow-start-and-congest">
<a class="section-number selfRef" href="#section-7.2">7.2. </a><a class="section-name selfRef" href="#name-sctp-slow-start-and-congest">SCTP Slow-Start and Congestion Avoidance</a>
        </h3>
<p id="section-7.2-1">The slow-start and congestion avoidance algorithms <span class="bcp14">MUST</span> be used by an
endpoint to control the amount of data being injected into the network.
The congestion control in SCTP is employed in regard to the association, not
to an individual stream.
In some situations, it might be beneficial for an SCTP sender to be more
conservative than the algorithms allow;
however, an SCTP sender <span class="bcp14">MUST NOT</span> be more aggressive than the following
algorithms allow.<a class="pilcrow" href="#section-7.2-1">Â¶</a></p>
<p id="section-7.2-2">Like TCP, an SCTP endpoint uses the following three control variables
to regulate its transmission rate.<a class="pilcrow" href="#section-7.2-2">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.2-3.1">
            <p id="section-7.2-3.1.1">Receiver advertised window size (rwnd, in bytes), which is set by the
receiver based on its available buffer space for incoming packets.<a class="pilcrow" href="#section-7.2-3.1.1">Â¶</a></p>
<p id="section-7.2-3.1.2">Note: This variable is kept on the entire association.<a class="pilcrow" href="#section-7.2-3.1.2">Â¶</a></p>
</li>
          <li class="normal" id="section-7.2-3.2">
            <p id="section-7.2-3.2.1">Congestion control window (cwnd, in bytes), which is adjusted by the sender
based on observed network conditions.<a class="pilcrow" href="#section-7.2-3.2.1">Â¶</a></p>
<p id="section-7.2-3.2.2">Note: This variable is maintained on a per-destination-address basis.<a class="pilcrow" href="#section-7.2-3.2.2">Â¶</a></p>
</li>
          <li class="normal" id="section-7.2-3.3">
            <p id="section-7.2-3.3.1">Slow-start threshold (ssthresh, in bytes), which is used by the
sender to distinguish slow-start and congestion avoidance phases.<a class="pilcrow" href="#section-7.2-3.3.1">Â¶</a></p>
<p id="section-7.2-3.3.2">Note: This variable is maintained on a per-destination-address basis.<a class="pilcrow" href="#section-7.2-3.3.2">Â¶</a></p>
</li>
        </ul>
<p id="section-7.2-4">SCTP also requires one additional control variable, partial_bytes_acked,
which is used during the congestion avoidance phase to facilitate cwnd
adjustment.<a class="pilcrow" href="#section-7.2-4">Â¶</a></p>
<p id="section-7.2-5">Unlike TCP, an SCTP sender <span class="bcp14">MUST</span> keep a set of the control variables
cwnd, ssthresh, and partial_bytes_acked for EACH destination address
of its peer (when its peer is multi-homed).
When calculating one of these variables, the length of the DATA chunk, including
the padding, <span class="bcp14">SHOULD</span> be used.<a class="pilcrow" href="#section-7.2-5">Â¶</a></p>
<p id="section-7.2-6">Only one rwnd is kept for the whole association (no matter if the peer is
multi-homed or has a single address).<a class="pilcrow" href="#section-7.2-6">Â¶</a></p>
<div id="sec_slow_start">
<section id="section-7.2.1">
          <h4 id="name-slow-start">
<a class="section-number selfRef" href="#section-7.2.1">7.2.1. </a><a class="section-name selfRef" href="#name-slow-start">Slow-Start</a>
          </h4>
<p id="section-7.2.1-1">Beginning data transmission into a network with unknown conditions or
after a sufficiently long idle period requires SCTP to probe the
network to determine the available capacity.
The slow-start algorithm is used for this purpose at the beginning of a
transfer or after repairing loss detected by the retransmission timer.<a class="pilcrow" href="#section-7.2.1-1">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.2.1-2.1">
              <p id="section-7.2.1-2.1.1">The initial cwnd before data transmission <span class="bcp14">MUST</span> be set to
min(4 * PMDCS, max(2 * PMDCS, 4404)) bytes if the peer address is an IPv4 address
and to min(4 * PMDCS, max(2 * PMDCS, 4344)) bytes if the peer address is an
IPv6 address.<a class="pilcrow" href="#section-7.2.1-2.1.1">Â¶</a></p>
</li>
            <li class="normal" id="section-7.2.1-2.2">
              <p id="section-7.2.1-2.2.1">The initial cwnd after a retransmission timeout <span class="bcp14">MUST</span> be no more than
PMDCS, and only one packet is allowed to be in flight until successful
acknowledgement.<a class="pilcrow" href="#section-7.2.1-2.2.1">Â¶</a></p>
</li>
            <li class="normal" id="section-7.2.1-2.3">
              <p id="section-7.2.1-2.3.1">The initial value of ssthresh <span class="bcp14">SHOULD</span> be arbitrarily high (e.g.,
the size of the largest-possible advertised window).<a class="pilcrow" href="#section-7.2.1-2.3.1">Â¶</a></p>
</li>
            <li class="normal" id="section-7.2.1-2.4">
              <p id="section-7.2.1-2.4.1">Whenever cwnd is greater than zero, the endpoint is allowed to have cwnd
bytes of data outstanding on that transport address.
A limited overbooking as described in rule B in 
<a class="xref" href="#sec_transmission_of_data_chunks">Section 6.1</a> <span class="bcp14">SHOULD</span> be supported.<a class="pilcrow" href="#section-7.2.1-2.4.1">Â¶</a></p>
</li>
            <li class="normal" id="section-7.2.1-2.5">
              <p id="section-7.2.1-2.5.1">When cwnd is less than or equal to ssthresh, an SCTP endpoint <span class="bcp14">MUST</span>
use the slow-start algorithm to increase cwnd only if the current
congestion window is being fully utilized and the data sender is not in
Fast Recovery.
Only when these two conditions are met can the cwnd be increased;
otherwise, the cwnd <span class="bcp14">MUST NOT</span> be increased.
If these conditions are met, then cwnd <span class="bcp14">MUST</span> be increased by, at most, the
lesser of<a class="pilcrow" href="#section-7.2.1-2.5.1">Â¶</a></p>
<ol class="normal type-1" id="section-7.2.1-2.5.2" start="1" type="1">
<li id="section-7.2.1-2.5.2.1">
                  <p id="section-7.2.1-2.5.2.1.1">the total size of the previously outstanding DATA chunk(s) acknowledged and<a class="pilcrow" href="#section-7.2.1-2.5.2.1.1">Â¶</a></p>
</li>
                <li id="section-7.2.1-2.5.2.2">
                  <p id="section-7.2.1-2.5.2.2.1">L times the destination's PMDCS.<a class="pilcrow" href="#section-7.2.1-2.5.2.2.1">Â¶</a></p>
</li>
              </ol>
<p id="section-7.2.1-2.5.3">The first upper bound protects against the ACK-Splitting attack outlined in
<span>[<a class="xref" href="#SAVAGE99">SAVAGE99</a>]</span>.
The positive integer L <span class="bcp14">SHOULD</span> be 1 and <span class="bcp14">MAY</span> be larger than 1.
See <span>[<a class="xref" href="#RFC3465">RFC3465</a>]</span> for details of choosing L.<a class="pilcrow" href="#section-7.2.1-2.5.3">Â¶</a></p>
<p id="section-7.2.1-2.5.4">In instances where its peer endpoint is multi-homed, if an endpoint
receives a SACK chunk that results in updating the cwnd, then it <span class="bcp14">SHOULD</span> update
its cwnd (or cwnds) apportioned to the destination addresses to which it
transmitted the acknowledged data.<a class="pilcrow" href="#section-7.2.1-2.5.4">Â¶</a></p>
</li>
            <li class="normal" id="section-7.2.1-2.6">
              <p id="section-7.2.1-2.6.1">While the endpoint does not transmit data on a given transport address,
the cwnd of the transport address <span class="bcp14">SHOULD</span> be adjusted to max(cwnd / 2, 4 * PMDCS)
once per RTO.
Before the first cwnd adjustment, the ssthresh of the transport address <span class="bcp14">SHOULD</span>
be set to the cwnd.<a class="pilcrow" href="#section-7.2.1-2.6.1">Â¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="sec_congestion_avoidance">
<section id="section-7.2.2">
          <h4 id="name-congestion-avoidance">
<a class="section-number selfRef" href="#section-7.2.2">7.2.2. </a><a class="section-name selfRef" href="#name-congestion-avoidance">Congestion Avoidance</a>
          </h4>
<p id="section-7.2.2-1">When cwnd is greater than ssthresh, cwnd <span class="bcp14">SHOULD</span> be incremented by PMDCS per
RTT if the sender has cwnd or more bytes of data outstanding for the
corresponding transport address.
The basic recommendations for incrementing cwnd during congestion avoidance
are as follows:<a class="pilcrow" href="#section-7.2.2-1">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.2.2-2.1">
              <p id="section-7.2.2-2.1.1">SCTP <span class="bcp14">MAY</span> increment cwnd by PMDCS.<a class="pilcrow" href="#section-7.2.2-2.1.1">Â¶</a></p>
</li>
            <li class="normal" id="section-7.2.2-2.2">
              <p id="section-7.2.2-2.2.1">SCTP <span class="bcp14">SHOULD</span> increment cwnd by PMDCS once per RTT when the sender has cwnd
or more bytes of data outstanding for the corresponding transport address.<a class="pilcrow" href="#section-7.2.2-2.2.1">Â¶</a></p>
</li>
            <li class="normal" id="section-7.2.2-2.3">
              <p id="section-7.2.2-2.3.1">SCTP <span class="bcp14">MUST NOT</span> increment cwnd by more than PMDCS per RTT.<a class="pilcrow" href="#section-7.2.2-2.3.1">Â¶</a></p>
</li>
          </ul>
<p id="section-7.2.2-3">In practice, an implementation can achieve this goal in the following way:<a class="pilcrow" href="#section-7.2.2-3">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.2.2-4.1">
              <p id="section-7.2.2-4.1.1">partial_bytes_acked is initialized to 0.<a class="pilcrow" href="#section-7.2.2-4.1.1">Â¶</a></p>
</li>
            <li class="normal" id="section-7.2.2-4.2">
              <p id="section-7.2.2-4.2.1">Whenever cwnd is greater than ssthresh, upon each SACK chunk arrival,
increase partial_bytes_acked by the total number of bytes (including the chunk
header and the padding) of all new DATA chunks acknowledged in that SACK chunk,
including chunks acknowledged by the new Cumulative TSN Ack, by Gap Ack Blocks,
and by the number of bytes of duplicated chunks reported in
Duplicate TSNs.<a class="pilcrow" href="#section-7.2.2-4.2.1">Â¶</a></p>
</li>
            <li class="normal" id="section-7.2.2-4.3">
              <p id="section-7.2.2-4.3.1">When (1) partial_bytes_acked is greater than cwnd and (2) before the arrival
of the SACK chunk the sender had less than cwnd bytes of data outstanding (i.e.,
before the arrival of the SACK chunk, flightsize was less than cwnd), reset
partial_bytes_acked to cwnd.<a class="pilcrow" href="#section-7.2.2-4.3.1">Â¶</a></p>
</li>
            <li class="normal" id="section-7.2.2-4.4">
              <p id="section-7.2.2-4.4.1">When (1) partial_bytes_acked is equal to or greater than cwnd and (2) before
the arrival of the SACK chunk the sender had cwnd or more bytes of data outstanding
(i.e., before the arrival of the SACK chunk, flightsize was greater than or equal to
cwnd), partial_bytes_acked is reset to (partial_bytes_acked - cwnd).
Next, cwnd is increased by PMDCS.<a class="pilcrow" href="#section-7.2.2-4.4.1">Â¶</a></p>
</li>
            <li class="normal" id="section-7.2.2-4.5">
              <p id="section-7.2.2-4.5.1">Same as in the slow start, when the sender does not transmit DATA chunks
on a given transport address, the cwnd of the transport address <span class="bcp14">SHOULD</span> be
adjusted to max(cwnd / 2, 4 * PMDCS) per RTO.<a class="pilcrow" href="#section-7.2.2-4.5.1">Â¶</a></p>
</li>
            <li class="normal" id="section-7.2.2-4.6">
              <p id="section-7.2.2-4.6.1">When all of the data transmitted by the sender has been acknowledged by the
receiver, partial_bytes_acked is initialized to 0.<a class="pilcrow" href="#section-7.2.2-4.6.1">Â¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="sec_congestion_control_sub">
<section id="section-7.2.3">
          <h4 id="name-congestion-control-2">
<a class="section-number selfRef" href="#section-7.2.3">7.2.3. </a><a class="section-name selfRef" href="#name-congestion-control-2">Congestion Control</a>
          </h4>
<p id="section-7.2.3-1">Upon detection of packet losses from SACK chunks
(see <a class="xref" href="#sec_fast_retransmit_on_gap_reports">Section 7.2.4</a>), an endpoint <span class="bcp14">SHOULD</span>
do the following:<a class="pilcrow" href="#section-7.2.3-1">Â¶</a></p>
<div id="section-7.2.3-2">
<pre class="lang-pseudocode sourcecode">ssthresh = max(cwnd / 2, 4 * PMDCS)
cwnd = ssthresh
partial_bytes_acked = 0
</pre><a class="pilcrow" href="#section-7.2.3-2">Â¶</a>
</div>
<p id="section-7.2.3-3">Basically, a packet loss causes cwnd to be cut in half.<a class="pilcrow" href="#section-7.2.3-3">Â¶</a></p>
<p id="section-7.2.3-4">When the T3-rtx timer expires on an address, SCTP <span class="bcp14">SHOULD</span> perform slow start
by:<a class="pilcrow" href="#section-7.2.3-4">Â¶</a></p>
<div id="section-7.2.3-5">
<pre class="lang-pseudocode sourcecode">ssthresh = max(cwnd / 2, 4 * PMDCS)
cwnd = PMDCS
partial_bytes_acked = 0
</pre><a class="pilcrow" href="#section-7.2.3-5">Â¶</a>
</div>
<p id="section-7.2.3-6">and ensure that no more than one SCTP packet will be in flight for that address
until the endpoint receives acknowledgement for successful delivery of data to
that address.<a class="pilcrow" href="#section-7.2.3-6">Â¶</a></p>
</section>
</div>
<div id="sec_fast_retransmit_on_gap_reports">
<section id="section-7.2.4">
          <h4 id="name-fast-retransmit-on-gap-repo">
<a class="section-number selfRef" href="#section-7.2.4">7.2.4. </a><a class="section-name selfRef" href="#name-fast-retransmit-on-gap-repo">Fast Retransmit on Gap Reports</a>
          </h4>
<p id="section-7.2.4-1">In the absence of data loss, an endpoint performs delayed acknowledgement.
However, whenever an endpoint notices a hole in the arriving TSN sequence, it
<span class="bcp14">SHOULD</span> start sending a SACK chunk back every time a packet arrives carrying data
until the hole is filled.<a class="pilcrow" href="#section-7.2.4-1">Â¶</a></p>
<p id="section-7.2.4-2">Whenever an endpoint receives a SACK chunk that indicates that some TSNs are
missing, it <span class="bcp14">SHOULD</span> wait for two further miss indications (via subsequent SACK
chunks for a total of three missing reports) on the same TSNs before taking 
action with regard to Fast Retransmit.<a class="pilcrow" href="#section-7.2.4-2">Â¶</a></p>
<p id="section-7.2.4-3">Miss indications <span class="bcp14">SHOULD</span> follow the Highest TSN Newly Acknowledged (HTNA)
algorithm.
For each incoming SACK chunk, miss indications are incremented only for
missing TSNs prior to the HTNA in the SACK chunk.
A newly acknowledged DATA chunk is one not previously acknowledged in a
SACK chunk.
If an endpoint is in Fast Recovery and a SACK chunks arrives that advances the
Cumulative TSN Ack Point, the miss indications are incremented for all TSNs
reported missing in the SACK chunk.<a class="pilcrow" href="#section-7.2.4-3">Â¶</a></p>
<p id="section-7.2.4-4">When the third consecutive miss indication is received for one or more TSNs,
the data sender does the following:<a class="pilcrow" href="#section-7.2.4-4">Â¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-7.2.4-5">
<dt>1)</dt>
<dd id="section-7.2.4-5.1">
              <p id="section-7.2.4-5.1.1">Mark the DATA chunk(s) with three miss indications for retransmission.<a class="pilcrow" href="#section-7.2.4-5.1.1">Â¶</a></p>
</dd>
            <dd class="break"></dd>
<dt>2)</dt>
<dd id="section-7.2.4-5.2">
              <p id="section-7.2.4-5.2.1">If not in Fast Recovery, adjust the ssthresh and cwnd of the destination
address(es) to which the missing DATA chunks were last sent, according to the
formula described in <a class="xref" href="#sec_congestion_control_sub">Section 7.2.3</a>.<a class="pilcrow" href="#section-7.2.4-5.2.1">Â¶</a></p>
</dd>
            <dd class="break"></dd>
<dt>3)</dt>
<dd id="section-7.2.4-5.3">
              <p id="section-7.2.4-5.3.1">If not in Fast Recovery, determine how many of the earliest
(i.e., lowest TSN) DATA chunks marked for retransmission will fit
into a single packet, subject to constraint of the PMTU of
the destination transport address to which the packet is being sent.
Call this value K.
Retransmit those K DATA chunks in a single packet.
When a Fast Retransmit is being performed, the sender <span class="bcp14">SHOULD</span> ignore the value
of cwnd and <span class="bcp14">SHOULD NOT</span> delay retransmission for this single packet.<a class="pilcrow" href="#section-7.2.4-5.3.1">Â¶</a></p>
</dd>
            <dd class="break"></dd>
<dt>4)</dt>
<dd id="section-7.2.4-5.4">
              <p id="section-7.2.4-5.4.1">Restart the T3-rtx timer only if the last SACK chunk acknowledged the
lowest outstanding TSN number sent to that address or the endpoint is
retransmitting the first outstanding DATA chunk sent to that address.<a class="pilcrow" href="#section-7.2.4-5.4.1">Â¶</a></p>
</dd>
            <dd class="break"></dd>
<dt>5)</dt>
<dd id="section-7.2.4-5.5">
              <p id="section-7.2.4-5.5.1">Mark the DATA chunk(s) as being fast retransmitted and thus ineligible for a
subsequent Fast Retransmit.  Those TSNs marked for retransmission due to the Fast-Retransmit algorithm that
did not fit in the sent datagram carrying K other TSNs are also marked as
ineligible for a subsequent Fast Retransmit.
However, as they are marked for retransmission, they will be retransmitted
later on as soon as cwnd allows.<a class="pilcrow" href="#section-7.2.4-5.5.1">Â¶</a></p>
</dd>
            <dd class="break"></dd>
<dt>6)</dt>
<dd id="section-7.2.4-5.6">
              <p id="section-7.2.4-5.6.1">If not in Fast Recovery, enter Fast Recovery and mark the highest
outstanding TSN as the Fast Recovery exit point.
When a SACK chunk acknowledges all TSNs up to and including this exit point,
Fast Recovery is exited.
While in Fast Recovery, the ssthresh and cwnd <span class="bcp14">SHOULD NOT</span> change for any
destinations due to a subsequent Fast Recovery event (i.e., one <span class="bcp14">SHOULD NOT</span>
reduce the cwnd further due to a subsequent Fast Retransmit).<a class="pilcrow" href="#section-7.2.4-5.6.1">Â¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-7.2.4-6">Note: Before the above adjustments, if the received SACK chunk also
acknowledges new DATA chunks and advances the Cumulative TSN Ack Point,
the cwnd adjustment rules defined in Sections <a class="xref" href="#sec_slow_start">7.2.1</a> and
<a class="xref" href="#sec_congestion_avoidance">7.2.2</a> <span class="bcp14">MUST</span> be applied first.<a class="pilcrow" href="#section-7.2.4-6">Â¶</a></p>
</section>
</div>
<section id="section-7.2.5">
          <h4 id="name-reinitialization">
<a class="section-number selfRef" href="#section-7.2.5">7.2.5. </a><a class="section-name selfRef" href="#name-reinitialization">Reinitialization</a>
          </h4>
<p id="section-7.2.5-1">During the lifetime of an SCTP association, events can happen that result
in using the network under unknown new conditions.
When detected by an SCTP implementation, the congestion control <span class="bcp14">MUST</span> be
reinitialized.<a class="pilcrow" href="#section-7.2.5-1">Â¶</a></p>
<section id="section-7.2.5.1">
            <h5 id="name-change-of-differentiated-se">
<a class="section-number selfRef" href="#section-7.2.5.1">7.2.5.1. </a><a class="section-name selfRef" href="#name-change-of-differentiated-se">Change of Differentiated Services Code Points</a>
            </h5>
<p id="section-7.2.5.1-1">SCTP implementations <span class="bcp14">MAY</span> allow an application to configure the
Differentiated Services Code Point (DSCP) used for sending packets.
If a DSCP change might result in outgoing packets being queued in
different queues, the congestion control parameters for all affected
destination addresses <span class="bcp14">MUST</span> be reset to their initial values.<a class="pilcrow" href="#section-7.2.5.1-1">Â¶</a></p>
</section>
<section id="section-7.2.5.2">
            <h5 id="name-change-of-routes">
<a class="section-number selfRef" href="#section-7.2.5.2">7.2.5.2. </a><a class="section-name selfRef" href="#name-change-of-routes">Change of Routes</a>
            </h5>
<p id="section-7.2.5.2-1">SCTP implementations <span class="bcp14">MAY</span> be aware of routing changes affecting packets
sent to a destination address.
In particular, this includes the selection of a different source address used
for sending packets to a destination address.
If such a routing change happens, the congestion control parameters for the
affected destination addresses <span class="bcp14">MUST</span> be reset to their initial values.<a class="pilcrow" href="#section-7.2.5.2-1">Â¶</a></p>
</section>
</section>
</section>
</div>
<div id="sec_path_mtu_discovery">
<section id="section-7.3">
        <h3 id="name-pmtu-discovery">
<a class="section-number selfRef" href="#section-7.3">7.3. </a><a class="section-name selfRef" href="#name-pmtu-discovery">PMTU Discovery</a>
        </h3>
<p id="section-7.3-1"><span>[<a class="xref" href="#RFC8899">RFC8899</a>]</span>,
<span>[<a class="xref" href="#RFC8201">RFC8201</a>]</span>, and <span>[<a class="xref" href="#RFC1191">RFC1191</a>]</span> specify
"Packetization Layer Path MTU Discovery",
whereby an endpoint maintains an estimate of PMTU along a given Internet path
and refrains from sending packets along that path that exceed the PMTU, other
than occasional attempts to probe for a change in the PMTU.
<span>[<a class="xref" href="#RFC8899">RFC8899</a>]</span> is thorough in its
discussion of the PMTU discovery mechanism and strategies for determining the
current end-to-end PMTU setting as well as detecting changes in this value.<a class="pilcrow" href="#section-7.3-1">Â¶</a></p>
<p id="section-7.3-2">An endpoint <span class="bcp14">SHOULD</span> apply these techniques and <span class="bcp14">SHOULD</span> do so on a
per-destination-address basis.<a class="pilcrow" href="#section-7.3-2">Â¶</a></p>
<p id="section-7.3-3">There are two important SCTP-specific points regarding PMTU discovery:<a class="pilcrow" href="#section-7.3-3">Â¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-7.3-4">
<dt>1)</dt>
<dd id="section-7.3-4.1">
            <p id="section-7.3-4.1.1">SCTP associations can span multiple addresses.
An endpoint <span class="bcp14">MUST</span> maintain separate PMTU estimates for each destination address
of its peer.<a class="pilcrow" href="#section-7.3-4.1.1">Â¶</a></p>
</dd>
          <dd class="break"></dd>
<dt>2)</dt>
<dd id="section-7.3-4.2">
            <p id="section-7.3-4.2.1">The sender <span class="bcp14">SHOULD</span> track an AMDCS that will be the
smallest PMDCS discovered for all of the peer's destination addresses.
When fragmenting messages into multiple parts, this AMDCS <span class="bcp14">SHOULD</span>
be used to calculate the size of each DATA chunk.
This will allow retransmissions to be seamlessly sent to an alternate address
without encountering IP fragmentation.<a class="pilcrow" href="#section-7.3-4.2.1">Â¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="sec_fault_management">
<section id="section-8">
      <h2 id="name-fault-management">
<a class="section-number selfRef" href="#section-8">8. </a><a class="section-name selfRef" href="#name-fault-management">Fault Management</a>
      </h2>
<div id="sec_endpoint_failure_detection">
<section id="section-8.1">
        <h3 id="name-endpoint-failure-detection">
<a class="section-number selfRef" href="#section-8.1">8.1. </a><a class="section-name selfRef" href="#name-endpoint-failure-detection">Endpoint Failure Detection</a>
        </h3>
<p id="section-8.1-1">An endpoint <span class="bcp14">SHOULD</span> keep a counter on the total number of consecutive
retransmissions to its peer (this includes data retransmissions to all the
destination transport addresses of the peer if it is multi-homed), including
the number of unacknowledged HEARTBEAT chunks observed on the path that is
currently used for data transfer.
Unacknowledged HEARTBEAT chunks observed on paths different from the
path currently used for data transfer <span class="bcp14">SHOULD NOT</span> increment the association
error counter, as this could lead to association closure even if the path
that is currently used for data transfer is available (but idle).
If the value of this counter exceeds the limit indicated in the protocol
parameter 'Association.Max.Retrans', the endpoint <span class="bcp14">SHOULD</span> consider the peer
endpoint unreachable and <span class="bcp14">SHALL</span> stop transmitting any more data to it
(and thus the association enters the CLOSED state).
In addition, the endpoint <span class="bcp14">SHOULD</span> report the failure to the upper layer and
optionally report back all outstanding user data remaining in its outbound
queue.
The association is automatically closed when the peer endpoint becomes
unreachable.<a class="pilcrow" href="#section-8.1-1">Â¶</a></p>
<p id="section-8.1-2">The counter used for endpoint failure detection <span class="bcp14">MUST</span> be reset each time a
DATA chunk sent to that peer endpoint is acknowledged (by the reception of
a SACK chunk).
When a HEARTBEAT ACK chunk is received from the peer endpoint, the counter
<span class="bcp14">SHOULD</span> also be reset.
The receiver of the HEARTBEAT ACK chunk <span class="bcp14">MAY</span> choose not to clear the counter
if there is outstanding data on the association.
This allows for handling the possible difference in reachability based on
DATA chunks and HEARTBEAT chunks.<a class="pilcrow" href="#section-8.1-2">Â¶</a></p>
</section>
</div>
<div id="sec_path_failure_detection">
<section id="section-8.2">
        <h3 id="name-path-failure-detection">
<a class="section-number selfRef" href="#section-8.2">8.2. </a><a class="section-name selfRef" href="#name-path-failure-detection">Path Failure Detection</a>
        </h3>
<p id="section-8.2-1">When its peer endpoint is multi-homed, an endpoint <span class="bcp14">SHOULD</span> keep an
error counter for each of the destination transport addresses of the
peer endpoint.<a class="pilcrow" href="#section-8.2-1">Â¶</a></p>
<p id="section-8.2-2">Each time the T3-rtx timer expires on any address, or when a
HEARTBEAT chunk sent to an idle address is not acknowledged within an RTO,
the error counter of that destination address will be incremented.
When the value in the error counter exceeds the protocol parameter
'Path.Max.Retrans' of that destination address, the endpoint <span class="bcp14">SHOULD</span>
mark the destination transport address as inactive, and a
notification <span class="bcp14">SHOULD</span> be sent to the upper layer.<a class="pilcrow" href="#section-8.2-2">Â¶</a></p>
<p id="section-8.2-3">When an outstanding TSN is acknowledged or a HEARTBEAT chunk sent to that
address is acknowledged with a HEARTBEAT ACK chunk, the endpoint <span class="bcp14">SHOULD</span>
clear the error counter of the destination transport address to which
the DATA chunk was last sent (or HEARTBEAT chunk was sent) and <span class="bcp14">SHOULD</span> also
report to the upper layer when an inactive destination address is
marked as active.
When the peer endpoint is multi-homed and the last chunk sent to it was a
retransmission to an alternate address, there exists an ambiguity as
 to whether or not the acknowledgement could be credited to the
address of the last chunk sent.
However, this ambiguity does not seem to have significant consequences for
SCTP behavior.
If this ambiguity is undesirable, the transmitter <span class="bcp14">MAY</span> choose not to clear the
error counter if the last chunk sent was a retransmission.<a class="pilcrow" href="#section-8.2-3">Â¶</a></p>
<p id="section-8.2-4">Note: When configuring the SCTP endpoint, the user ought to avoid having the
value of 'Association.Max.Retrans' larger than the summation of the
'Path.Max.Retrans' of all the destination addresses for the remote endpoint.
Otherwise, all the destination addresses might become inactive while the endpoint
still considers the peer endpoint reachable.
When this condition occurs, how SCTP chooses to function is implementation
specific.<a class="pilcrow" href="#section-8.2-4">Â¶</a></p>
<p id="section-8.2-5">When the primary path is marked inactive (due to excessive retransmissions,
for instance), the sender <span class="bcp14">MAY</span> automatically transmit new packets to an
alternate destination address if one exists and is active.
If more than one alternate address is active when the primary path is marked
inactive, only ONE transport address <span class="bcp14">SHOULD</span> be chosen and used as the new
destination transport address.<a class="pilcrow" href="#section-8.2-5">Â¶</a></p>
</section>
</div>
<div id="sec_path_heartbeat">
<section id="section-8.3">
        <h3 id="name-path-heartbeat">
<a class="section-number selfRef" href="#section-8.3">8.3. </a><a class="section-name selfRef" href="#name-path-heartbeat">Path Heartbeat</a>
        </h3>
<p id="section-8.3-1">By default, an SCTP endpoint <span class="bcp14">SHOULD</span> monitor the reachability of the
idle destination transport address(es) of its peer by sending a
HEARTBEAT chunk periodically to the destination transport address(es).
The sending of HEARTBEAT chunks <span class="bcp14">MAY</span> begin upon reaching the ESTABLISHED state
and is discontinued after sending either a SHUTDOWN chunk or SHUTDOWN ACK chunk.
A receiver of a HEARTBEAT chunk <span class="bcp14">MUST</span> respond to a HEARTBEAT chunk with a
HEARTBEAT ACK chunk after entering the COOKIE-ECHOED state (sender of the
INIT chunk) or the ESTABLISHED state (receiver of the INIT chunk), up until
reaching the SHUTDOWN-SENT state (sender of the SHUTDOWN chunk)
or the SHUTDOWN-ACK-SENT state (receiver of the SHUTDOWN chunk).<a class="pilcrow" href="#section-8.3-1">Â¶</a></p>
<p id="section-8.3-2">A destination transport address is considered "idle" if no new chunk
that can be used for updating path RTT (usually including first transmission
DATA, INIT, COOKIE ECHO, or HEARTBEAT chunks, etc.) and no HEARTBEAT chunk
has been sent to it within the current heartbeat period of that address.
This applies to both active and inactive destination addresses.<a class="pilcrow" href="#section-8.3-2">Â¶</a></p>
<p id="section-8.3-3">The upper layer can optionally initiate the following functions:<a class="pilcrow" href="#section-8.3-3">Â¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-8.3-4">
<dt>A)</dt>
<dd id="section-8.3-4.1">
            <p id="section-8.3-4.1.1">Disable heartbeat on a specific destination transport address of a
given association,<a class="pilcrow" href="#section-8.3-4.1.1">Â¶</a></p>
</dd>
          <dd class="break"></dd>
<dt>B)</dt>
<dd id="section-8.3-4.2">
            <p id="section-8.3-4.2.1">Change the 'HB.interval',<a class="pilcrow" href="#section-8.3-4.2.1">Â¶</a></p>
</dd>
          <dd class="break"></dd>
<dt>C)</dt>
<dd id="section-8.3-4.3">
            <p id="section-8.3-4.3.1">Re-enable heartbeat on a specific destination transport address of a given
association, and<a class="pilcrow" href="#section-8.3-4.3.1">Â¶</a></p>
</dd>
          <dd class="break"></dd>
<dt>D)</dt>
<dd id="section-8.3-4.4">
            <p id="section-8.3-4.4.1">Request the sending of an on-demand HEARTBEAT chunk on a specific
destination transport address of a given association.<a class="pilcrow" href="#section-8.3-4.4.1">Â¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-8.3-5">The endpoint <span class="bcp14">SHOULD</span> increment the respective error counter of the destination
transport address each time a HEARTBEAT chunk is sent to that address and not
acknowledged within one RTO.<a class="pilcrow" href="#section-8.3-5">Â¶</a></p>
<p id="section-8.3-6">When the value of this counter exceeds the protocol parameter
'Path.Max.Retrans', the endpoint <span class="bcp14">SHOULD</span> mark the corresponding destination
address as inactive if it is not so marked and <span class="bcp14">SHOULD</span> also report to
the upper layer the change in reachability of this destination address.
After this, the endpoint <span class="bcp14">SHOULD</span> continue sending HEARTBEAT chunks on this
destination address but <span class="bcp14">SHOULD</span> stop increasing the counter.<a class="pilcrow" href="#section-8.3-6">Â¶</a></p>
<p id="section-8.3-7">The sender of the HEARTBEAT chunk <span class="bcp14">SHOULD</span> include in the Heartbeat Information
field of the chunk the current time when the packet is sent and the
destination address to which the packet is sent.<a class="pilcrow" href="#section-8.3-7">Â¶</a></p>
<p id="section-8.3-8">Implementation Note: An alternative implementation of the heartbeat
mechanism that can be used is to increment the error counter variable every time
a HEARTBEAT chunk is sent to a destination.
Whenever a HEARTBEAT ACK chunk arrives, the sender <span class="bcp14">SHOULD</span> clear the error
counter of the destination that the HEARTBEAT chunk was sent to.
This, in effect, would clear the previously stroked error (and any other error
counts as well).<a class="pilcrow" href="#section-8.3-8">Â¶</a></p>
<p id="section-8.3-9">The receiver of the HEARTBEAT chunk <span class="bcp14">SHOULD</span> immediately respond with a
HEARTBEAT ACK chunk that contains the Heartbeat Information TLV, together with
any other received TLVs, copied unchanged from the received HEARTBEAT chunk.<a class="pilcrow" href="#section-8.3-9">Â¶</a></p>
<p id="section-8.3-10">Upon the receipt of the HEARTBEAT ACK chunk, the sender of the HEARTBEAT
chunk <span class="bcp14">SHOULD</span> clear the error counter of the destination transport address
to which the HEARTBEAT chunk was sent and mark the destination transport
address as active if it is not so marked.
The endpoint <span class="bcp14">SHOULD</span> report to the upper layer when an inactive
destination address is marked as active due to the reception of the latest
HEARTBEAT ACK chunk.
The receiver of the HEARTBEAT ACK chunk <span class="bcp14">SHOULD</span> also clear the association
overall error count (as defined in
<a class="xref" href="#sec_endpoint_failure_detection">Section 8.1</a>).<a class="pilcrow" href="#section-8.3-10">Â¶</a></p>
<p id="section-8.3-11">The receiver of the HEARTBEAT ACK chunk <span class="bcp14">SHOULD</span> also perform an RTT
measurement for that destination transport address using the time value carried
in the HEARTBEAT ACK chunk.<a class="pilcrow" href="#section-8.3-11">Â¶</a></p>
<p id="section-8.3-12">On an idle destination address that is allowed to heartbeat, it is
<span class="bcp14">RECOMMENDED</span> that a HEARTBEAT chunk is sent once per RTO of that destination
address plus the protocol parameter 'HB.interval', with jittering of +/- 50% of
the RTO value and exponential backoff of the RTO if the previous HEARTBEAT
chunk is unanswered.<a class="pilcrow" href="#section-8.3-12">Â¶</a></p>
<p id="section-8.3-13">A primitive is provided for the SCTP user to change the 'HB.interval' and turn
on or off the heartbeat on a given destination address.
The 'HB.interval' set by the SCTP user is added to the RTO of that
destination (including any exponential backoff).
Only one heartbeat <span class="bcp14">SHOULD</span> be sent each time the heartbeat timer expires (if
multiple destinations are idle).
It is an implementation decision on how to choose which of the candidate idle
destinations to heartbeat to (if more than one destination is idle).<a class="pilcrow" href="#section-8.3-13">Â¶</a></p>
<p id="section-8.3-14">When tuning the 'HB.interval', there is a side effect that
<span class="bcp14">SHOULD</span> be taken into account.
When this value is increased, i.e., the time between the sending of HEARTBEAT
chunks is longer, the detection of lost ABORT chunks takes longer as well.
If a peer endpoint sends an ABORT chunk for any reason and the ABORT chunk is
lost, the local endpoint will only discover the lost ABORT chunk by sending a
DATA chunk or HEARTBEAT chunk (thus causing the peer to send another ABORT chunk).
This is to be considered when tuning the heartbeat timer.
If the sending of HEARTBEAT chunks is disabled, only sending DATA chunks to the
association will discover a lost ABORT chunk from the peer.<a class="pilcrow" href="#section-8.3-14">Â¶</a></p>
</section>
</div>
<div id="sec_handle_out_of_the_blue_packets">
<section id="section-8.4">
        <h3 id="name-handle-out-of-the-blue-pack">
<a class="section-number selfRef" href="#section-8.4">8.4. </a><a class="section-name selfRef" href="#name-handle-out-of-the-blue-pack">Handle "Out of the Blue" Packets</a>
        </h3>
<p id="section-8.4-1">An SCTP packet is called an "Out of the Blue" (OOTB) packet if it is
correctly formed (i.e., passed the receiver's CRC32c check;
see <a class="xref" href="#sec_crc32c_checksum_calculation">Section 6.8</a>),
but the receiver is not able to identify the association to which this
packet belongs.<a class="pilcrow" href="#section-8.4-1">Â¶</a></p>
<p id="section-8.4-2">The receiver of an OOTB packet does the following:<a class="pilcrow" href="#section-8.4-2">Â¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-8.4-3">
<dt>1)</dt>
<dd id="section-8.4-3.1">
            <p id="section-8.4-3.1.1">If the OOTB packet is to or from a non-unicast address, a receiver <span class="bcp14">SHOULD</span>
silently discard the packet.
Otherwise,<a class="pilcrow" href="#section-8.4-3.1.1">Â¶</a></p>
</dd>
          <dd class="break"></dd>
<dt>2)</dt>
<dd id="section-8.4-3.2">
            <p id="section-8.4-3.2.1">If the OOTB packet contains an ABORT chunk, the receiver <span class="bcp14">MUST</span> silently
discard the OOTB packet and take no further action.
Otherwise,<a class="pilcrow" href="#section-8.4-3.2.1">Â¶</a></p>
</dd>
          <dd class="break"></dd>
<dt>3)</dt>
<dd id="section-8.4-3.3">
            <p id="section-8.4-3.3.1">If the packet contains an INIT chunk with a Verification Tag set
to 0, it <span class="bcp14">SHOULD</span> be processed as described in
<a class="xref" href="#sec_normal_establishment">Section 5.1</a>.
If, for whatever reason, the INIT chunk cannot be processed normally and an
ABORT chunk has to be sent in response, the Verification Tag of the packet
containing the ABORT chunk <span class="bcp14">MUST</span> be the Initiate Tag of the received INIT chunk,
and the T bit of the ABORT chunk has to be set to 0, indicating that the
Verification Tag is not reflected.
Otherwise,<a class="pilcrow" href="#section-8.4-3.3.1">Â¶</a></p>
</dd>
          <dd class="break"></dd>
<dt>4)</dt>
<dd id="section-8.4-3.4">
            <p id="section-8.4-3.4.1">If the packet contains a COOKIE ECHO chunk as the first chunk, it <span class="bcp14">MUST</span> be
processed as described in <a class="xref" href="#sec_normal_establishment">Section 5.1</a>.
Otherwise,<a class="pilcrow" href="#section-8.4-3.4.1">Â¶</a></p>
</dd>
          <dd class="break"></dd>
<dt>5)</dt>
<dd id="section-8.4-3.5">
            <p id="section-8.4-3.5.1">If the packet contains a SHUTDOWN ACK chunk, the receiver <span class="bcp14">SHOULD</span> respond to
the sender of the OOTB packet with a SHUTDOWN COMPLETE chunk.
When sending the SHUTDOWN COMPLETE chunk, the receiver of the OOTB packet <span class="bcp14">MUST</span>
fill in the Verification Tag field of the outbound packet with the
Verification Tag received in the SHUTDOWN ACK chunk and set the T bit in the
Chunk Flags to indicate that the Verification Tag is reflected.
Otherwise,<a class="pilcrow" href="#section-8.4-3.5.1">Â¶</a></p>
</dd>
          <dd class="break"></dd>
<dt>6)</dt>
<dd id="section-8.4-3.6">
            <p id="section-8.4-3.6.1">If the packet contains a SHUTDOWN COMPLETE chunk, the receiver <span class="bcp14">SHOULD</span>
silently discard the packet and take no further action.
Otherwise,<a class="pilcrow" href="#section-8.4-3.6.1">Â¶</a></p>
</dd>
          <dd class="break"></dd>
<dt>7)</dt>
<dd id="section-8.4-3.7">
            <p id="section-8.4-3.7.1">If the packet contains an ERROR chunk with the "Stale Cookie" error cause
or a COOKIE ACK chunk, the SCTP packet <span class="bcp14">SHOULD</span> be silently discarded.
Otherwise,<a class="pilcrow" href="#section-8.4-3.7.1">Â¶</a></p>
</dd>
          <dd class="break"></dd>
<dt>8)</dt>
<dd id="section-8.4-3.8">
            <p id="section-8.4-3.8.1">The receiver <span class="bcp14">SHOULD</span> respond to the sender of the OOTB packet with an
ABORT chunk.
When sending the ABORT chunk, the receiver of the OOTB packet <span class="bcp14">MUST</span> fill in the
Verification Tag field of the outbound packet with the value found in the
Verification Tag field of the OOTB packet and set the T bit in the Chunk Flags
to indicate that the Verification Tag is reflected.
After sending this ABORT chunk, the receiver of the OOTB packet <span class="bcp14">MUST</span> discard the
OOTB packet and <span class="bcp14">MUST NOT</span> take any further action.<a class="pilcrow" href="#section-8.4-3.8.1">Â¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec_verification_tag">
<section id="section-8.5">
        <h3 id="name-verification-tag">
<a class="section-number selfRef" href="#section-8.5">8.5. </a><a class="section-name selfRef" href="#name-verification-tag">Verification Tag</a>
        </h3>
<p id="section-8.5-1">The Verification Tag rules defined in this section apply when sending or
receiving SCTP packets that do not contain an INIT, SHUTDOWN COMPLETE,
COOKIE ECHO (see <a class="xref" href="#sec_normal_establishment">Section 5.1</a>),
ABORT, or SHUTDOWN ACK chunk.
The rules for sending and receiving SCTP packets containing one of these chunk
types are discussed separately in
<a class="xref" href="#sec_exceptions_in_verification_tag_rules">Section 8.5.1</a>.<a class="pilcrow" href="#section-8.5-1">Â¶</a></p>
<p id="section-8.5-2">When sending an SCTP packet, the endpoint <span class="bcp14">MUST</span> fill in the Verification Tag
field of the outbound packet with the tag value in the Initiate Tag parameter
of the INIT or INIT ACK chunk received from its peer.<a class="pilcrow" href="#section-8.5-2">Â¶</a></p>
<p id="section-8.5-3">When receiving an SCTP packet, the endpoint <span class="bcp14">MUST</span> ensure that the value in
the Verification Tag field of the received SCTP packet matches its own tag.
If the received Verification Tag value does not match the receiver's own tag
value, the receiver <span class="bcp14">MUST</span> silently discard the packet and <span class="bcp14">MUST NOT</span> process it
any further, except for those cases listed in
<a class="xref" href="#sec_exceptions_in_verification_tag_rules">Section 8.5.1</a> below.<a class="pilcrow" href="#section-8.5-3">Â¶</a></p>
<div id="sec_exceptions_in_verification_tag_rules">
<section id="section-8.5.1">
          <h4 id="name-exceptions-in-verification-">
<a class="section-number selfRef" href="#section-8.5.1">8.5.1. </a><a class="section-name selfRef" href="#name-exceptions-in-verification-">Exceptions in Verification Tag Rules</a>
          </h4>
<span class="break"></span><dl class="dlNewline" id="section-8.5.1-1">
            <dt id="section-8.5.1-1.1">A) Rules for packets carrying an INIT chunk:</dt>
            <dd id="section-8.5.1-1.2" style="margin-left: 1.5em">
              <ul class="normal">
<li class="normal" id="section-8.5.1-1.2.1.1">The sender <span class="bcp14">MUST</span> set the Verification Tag of the packet to 0.<a class="pilcrow" href="#section-8.5.1-1.2.1.1">Â¶</a>
</li>
                <li class="normal" id="section-8.5.1-1.2.1.2">When an endpoint receives an SCTP packet with the Verification Tag set to 0,
it <span class="bcp14">SHOULD</span> verify that the packet contains only an INIT chunk.
Otherwise, the receiver <span class="bcp14">MUST</span> silently discard the packet.<a class="pilcrow" href="#section-8.5.1-1.2.1.2">Â¶</a>
</li>
              </ul>
</dd>
            <dd class="break"></dd>
<dt id="section-8.5.1-1.3">B) Rules for packets carrying an ABORT chunk:</dt>
            <dd id="section-8.5.1-1.4" style="margin-left: 1.5em">
              <ul class="normal">
<li class="normal" id="section-8.5.1-1.4.1.1">The endpoint <span class="bcp14">MUST</span> always fill in the Verification Tag field of the outbound
packet with the destination endpoint's tag value if it is known.<a class="pilcrow" href="#section-8.5.1-1.4.1.1">Â¶</a>
</li>
                <li class="normal" id="section-8.5.1-1.4.1.2">If the ABORT chunk is sent in response to an OOTB packet, the endpoint
<span class="bcp14">MUST</span> follow the procedure described in
<a class="xref" href="#sec_handle_out_of_the_blue_packets">Section 8.4</a>.<a class="pilcrow" href="#section-8.5.1-1.4.1.2">Â¶</a>
</li>
                <li class="normal" id="section-8.5.1-1.4.1.3">The receiver of an ABORT chunk <span class="bcp14">MUST</span> accept the packet if the
Verification Tag field of the packet matches its own tag and the T bit is not
set OR if it is set to its Peer's Tag and the T bit is set in the Chunk Flags.
Otherwise, the receiver <span class="bcp14">MUST</span> silently discard the packet and take no further
action.<a class="pilcrow" href="#section-8.5.1-1.4.1.3">Â¶</a>
</li>
              </ul>
</dd>
            <dd class="break"></dd>
<dt id="section-8.5.1-1.5">C) Rules for packets carrying a SHUTDOWN COMPLETE chunk:</dt>
            <dd id="section-8.5.1-1.6" style="margin-left: 1.5em">
              <ul class="normal">
<li class="normal" id="section-8.5.1-1.6.1.1">When sending a SHUTDOWN COMPLETE chunk, if the receiver of the
SHUTDOWN ACK chunk has a TCB, then the destination endpoint's tag <span class="bcp14">MUST</span> be used
and the T bit <span class="bcp14">MUST NOT</span> be set.
Only where no TCB exists <span class="bcp14">SHOULD</span> the sender use the Verification Tag from the
SHUTDOWN ACK chunk and <span class="bcp14">MUST</span> set the T bit.<a class="pilcrow" href="#section-8.5.1-1.6.1.1">Â¶</a>
</li>
                <li class="normal" id="section-8.5.1-1.6.1.2">The receiver of a SHUTDOWN COMPLETE chunk accepts the packet if the
Verification Tag field of the packet matches its own tag and the T bit is not
set OR if it is set to its Peer's Tag and the T bit is set in the Chunk Flags.
Otherwise, the receiver <span class="bcp14">MUST</span> silently discard the packet and take no further
action.
An endpoint <span class="bcp14">MUST</span> ignore the SHUTDOWN COMPLETE chunk if it is not in the
SHUTDOWN-ACK-SENT state.<a class="pilcrow" href="#section-8.5.1-1.6.1.2">Â¶</a>
</li>
              </ul>
</dd>
            <dd class="break"></dd>
<dt id="section-8.5.1-1.7">D) Rules for packets carrying a COOKIE ECHO chunk:</dt>
            <dd id="section-8.5.1-1.8" style="margin-left: 1.5em">
              <ul class="normal">
<li class="normal" id="section-8.5.1-1.8.1.1">When sending a COOKIE ECHO chunk, the endpoint <span class="bcp14">MUST</span> use the value of the
Initiate Tag received in the INIT ACK chunk.<a class="pilcrow" href="#section-8.5.1-1.8.1.1">Â¶</a>
</li>
                <li class="normal" id="section-8.5.1-1.8.1.2">The receiver of a COOKIE ECHO chunk follows the procedures in
<a class="xref" href="#sec_assoc_initialization">Section 5</a>.<a class="pilcrow" href="#section-8.5.1-1.8.1.2">Â¶</a>
</li>
              </ul>
</dd>
            <dd class="break"></dd>
<dt id="section-8.5.1-1.9">E) Rules for packets carrying a SHUTDOWN ACK chunk:</dt>
            <dd id="section-8.5.1-1.10" style="margin-left: 1.5em">
              <ul class="normal">
<li class="normal" id="section-8.5.1-1.10.1.1">If the receiver is in COOKIE-ECHOED or COOKIE-WAIT state, the procedures
in <a class="xref" href="#sec_handle_out_of_the_blue_packets">Section 8.4</a> <span class="bcp14">SHOULD</span> be followed;
in other words, it is treated as an OOTB packet.<a class="pilcrow" href="#section-8.5.1-1.10.1.1">Â¶</a>
</li>
              </ul>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="sec_assoc_termination">
<section id="section-9">
      <h2 id="name-termination-of-association">
<a class="section-number selfRef" href="#section-9">9. </a><a class="section-name selfRef" href="#name-termination-of-association">Termination of Association</a>
      </h2>
<p id="section-9-1">An endpoint <span class="bcp14">SHOULD</span> terminate its association when it exits from service.
An association can be terminated by either abort or shutdown.
An abort of an association is abortive by definition in that any data pending
on either end of the association is discarded and not delivered to the peer.
A shutdown of an association is considered a graceful close where all data in
queue by either endpoint is delivered to the respective peers.
However, in the case of a shutdown, SCTP does not support a half-open state
(like TCP), wherein one side might continue sending data while the other end is
closed.
When either endpoint performs a shutdown, the association on each peer will
stop accepting new data from its user and only deliver data in queue at the time
of sending or receiving the SHUTDOWN chunk.<a class="pilcrow" href="#section-9-1">Â¶</a></p>
<div id="sec_abort_of_an_association">
<section id="section-9.1">
        <h3 id="name-abort-of-an-association">
<a class="section-number selfRef" href="#section-9.1">9.1. </a><a class="section-name selfRef" href="#name-abort-of-an-association">Abort of an Association</a>
        </h3>
<p id="section-9.1-1">When an endpoint decides to abort an existing association, it <span class="bcp14">MUST</span> send an
ABORT chunk to its peer endpoint.
The sender <span class="bcp14">MUST</span> fill in the peer's Verification Tag in the outbound packet and
<span class="bcp14">MUST NOT</span> bundle any DATA chunk with the ABORT chunk.
If the association is aborted on request of the upper layer, a
"User-Initiated Abort" error cause
(see <a class="xref" href="#sec_user_initiated_abort_cause">Section 3.3.10.12</a>) <span class="bcp14">SHOULD</span> be present in
the ABORT chunk.<a class="pilcrow" href="#section-9.1-1">Â¶</a></p>
<p id="section-9.1-2">An endpoint <span class="bcp14">MUST NOT</span> respond to any received packet that contains an ABORT
chunk (also see <a class="xref" href="#sec_handle_out_of_the_blue_packets">Section 8.4</a>).<a class="pilcrow" href="#section-9.1-2">Â¶</a></p>
<p id="section-9.1-3">An endpoint receiving an ABORT chunk <span class="bcp14">MUST</span> apply the special Verification Tag check
rules described in <a class="xref" href="#sec_exceptions_in_verification_tag_rules">Section 8.5.1</a>.<a class="pilcrow" href="#section-9.1-3">Â¶</a></p>
<p id="section-9.1-4">After checking the Verification Tag, the receiving endpoint <span class="bcp14">MUST</span> remove the
association from its record and <span class="bcp14">SHOULD</span> report the termination to its upper
layer.
If a "User-Initiated Abort" error cause is present in the ABORT chunk, the Upper
Layer Abort Reason <span class="bcp14">SHOULD</span> be made available to the upper layer.<a class="pilcrow" href="#section-9.1-4">Â¶</a></p>
</section>
</div>
<div id="sec_shutdown_of_an_association">
<section id="section-9.2">
        <h3 id="name-shutdown-of-an-association">
<a class="section-number selfRef" href="#section-9.2">9.2. </a><a class="section-name selfRef" href="#name-shutdown-of-an-association">Shutdown of an Association</a>
        </h3>
<p id="section-9.2-1">Using the SHUTDOWN primitive (see <a class="xref" href="#sec_ulp_to_sctp">Section 11.1</a>), the
upper layer of an endpoint in an association can gracefully close the
association.
This will allow all outstanding DATA chunks from the peer of the
shutdown initiator to be delivered before the association terminates.<a class="pilcrow" href="#section-9.2-1">Â¶</a></p>
<p id="section-9.2-2">Upon receipt of the SHUTDOWN primitive from its upper layer, the endpoint
enters the SHUTDOWN-PENDING state and remains there until all outstanding data
has been acknowledged by its peer.
The endpoint accepts no new data from its upper layer but retransmits data to
the peer endpoint if necessary to fill gaps.<a class="pilcrow" href="#section-9.2-2">Â¶</a></p>
<p id="section-9.2-3">Once all its outstanding data has been acknowledged, the endpoint sends
a SHUTDOWN chunk to its peer, including in the Cumulative TSN Ack field the last
sequential TSN it has received from the peer.
It <span class="bcp14">SHOULD</span> then start the T2-shutdown timer and enter the SHUTDOWN-SENT state.
If the timer expires, the endpoint <span class="bcp14">MUST</span> resend the SHUTDOWN chunk with the
updated last sequential TSN received from its peer.<a class="pilcrow" href="#section-9.2-3">Â¶</a></p>
<p id="section-9.2-4">The rules in <a class="xref" href="#sec_management_of_retransission_timer">Section 6.3</a> <span class="bcp14">MUST</span> be
followed to determine the proper timer value for T2-shutdown.
To indicate any gaps in TSN, the endpoint <span class="bcp14">MAY</span> also bundle a SACK chunk with the
SHUTDOWN chunk in the same SCTP packet.<a class="pilcrow" href="#section-9.2-4">Â¶</a></p>
<p id="section-9.2-5">An endpoint <span class="bcp14">SHOULD</span> limit the number of retransmissions of the SHUTDOWN chunk
to the protocol parameter 'Association.Max.Retrans'.
If this threshold is exceeded, the endpoint <span class="bcp14">SHOULD</span> destroy the TCB and <span class="bcp14">SHOULD</span>
report the peer endpoint unreachable to the upper layer (and thus the
association enters the CLOSED state).
The reception of any packet from its peer (i.e., as the peer sends all of its
queued DATA chunks) <span class="bcp14">SHOULD</span> clear the endpoint's retransmission count and restart
the T2-shutdown timer, giving its peer ample opportunity to transmit all of its
queued DATA chunks that have not yet been sent.<a class="pilcrow" href="#section-9.2-5">Â¶</a></p>
<p id="section-9.2-6">Upon reception of the SHUTDOWN chunk, the peer endpoint does the following:<a class="pilcrow" href="#section-9.2-6">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.2-7.1">
            <p id="section-9.2-7.1.1">enter the SHUTDOWN-RECEIVED state,<a class="pilcrow" href="#section-9.2-7.1.1">Â¶</a></p>
</li>
          <li class="normal" id="section-9.2-7.2">
            <p id="section-9.2-7.2.1">stop accepting new data from its SCTP user, and<a class="pilcrow" href="#section-9.2-7.2.1">Â¶</a></p>
</li>
          <li class="normal" id="section-9.2-7.3">
            <p id="section-9.2-7.3.1">verify, by checking the Cumulative TSN Ack field of the chunk, that all its
outstanding DATA chunks have been received by the SHUTDOWN chunk sender.<a class="pilcrow" href="#section-9.2-7.3.1">Â¶</a></p>
</li>
        </ul>
<p id="section-9.2-8">Once an endpoint has reached the SHUTDOWN-RECEIVED state, it <span class="bcp14">MUST</span> ignore
ULP shutdown requests but <span class="bcp14">MUST</span> continue responding to SHUTDOWN chunks from its
peer.<a class="pilcrow" href="#section-9.2-8">Â¶</a></p>
<p id="section-9.2-9">If there are still outstanding DATA chunks left, the SHUTDOWN chunk receiver
<span class="bcp14">MUST</span> continue to follow normal data transmission procedures defined in
<a class="xref" href="#sec_user_data_transfer">Section 6</a>, until all outstanding DATA chunks are
acknowledged; however, the SHUTDOWN chunk receiver <span class="bcp14">MUST NOT</span> accept new data
from its SCTP user.<a class="pilcrow" href="#section-9.2-9">Â¶</a></p>
<p id="section-9.2-10">While in the SHUTDOWN-SENT state, the SHUTDOWN chunk sender <span class="bcp14">MUST</span> immediately
respond to each received packet containing one or more DATA chunks with a
SHUTDOWN chunk and restart the T2-shutdown timer.
If a SHUTDOWN chunk by itself cannot acknowledge all of the received DATA chunks
(i.e., there are TSNs that can be acknowledged that are larger than the
cumulative TSN and thus gaps exist in the TSN sequence) or  if duplicate TSNs
have been received, then a SACK chunk <span class="bcp14">MUST</span> also be sent.<a class="pilcrow" href="#section-9.2-10">Â¶</a></p>
<p id="section-9.2-11">The sender of the SHUTDOWN chunk <span class="bcp14">MAY</span> also start an overall guard timer
T5-shutdown-guard to bound the overall time for the shutdown sequence.
At the expiration of this timer, the sender <span class="bcp14">SHOULD</span> abort the association by
sending an ABORT chunk. If the T5-shutdown-guard timer is used, it <span class="bcp14">SHOULD</span>
be set to the <span class="bcp14">RECOMMENDED</span> value of 5 times 'RTO.Max'.<a class="pilcrow" href="#section-9.2-11">Â¶</a></p>
<p id="section-9.2-12">If the receiver of the SHUTDOWN chunk has no more outstanding DATA chunks,
the SHUTDOWN chunk receiver <span class="bcp14">MUST</span> send a SHUTDOWN ACK chunk and start a
T2-shutdown timer of its own, entering the SHUTDOWN-ACK-SENT state.
If the timer expires, the endpoint <span class="bcp14">MUST</span> resend the SHUTDOWN ACK chunk.<a class="pilcrow" href="#section-9.2-12">Â¶</a></p>
<p id="section-9.2-13">The sender of the SHUTDOWN ACK chunk <span class="bcp14">SHOULD</span> limit the number of
retransmissions of the SHUTDOWN ACK chunk to the protocol parameter
'Association.Max.Retrans'.
If this threshold is exceeded, the endpoint <span class="bcp14">SHOULD</span> destroy the TCB and <span class="bcp14">SHOULD</span>
report the peer endpoint unreachable to the upper layer (and thus the
association enters the CLOSED state).<a class="pilcrow" href="#section-9.2-13">Â¶</a></p>
<p id="section-9.2-14">Upon the receipt of the SHUTDOWN ACK chunk, the sender of the SHUTDOWN chunk
<span class="bcp14">MUST</span> stop the T2-shutdown timer, send a SHUTDOWN COMPLETE chunk to its peer, and
remove all record of the association.<a class="pilcrow" href="#section-9.2-14">Â¶</a></p>
<p id="section-9.2-15">Upon reception of the SHUTDOWN COMPLETE chunk, the endpoint verifies that
it is in the SHUTDOWN-ACK-SENT state;
if it is not, the chunk <span class="bcp14">SHOULD</span> be discarded.
If the endpoint is in the SHUTDOWN-ACK-SENT state, the endpoint <span class="bcp14">SHOULD</span> stop
the T2-shutdown timer and remove all knowledge of the association (and thus the
association enters the CLOSED state).<a class="pilcrow" href="#section-9.2-15">Â¶</a></p>
<p id="section-9.2-16">An endpoint <span class="bcp14">SHOULD</span> ensure that all its outstanding DATA chunks have been
acknowledged before initiating the shutdown procedure.<a class="pilcrow" href="#section-9.2-16">Â¶</a></p>
<p id="section-9.2-17">An endpoint <span class="bcp14">SHOULD</span> reject any new data request from its upper layer if it is
in the SHUTDOWN-PENDING, SHUTDOWN-SENT, SHUTDOWN-RECEIVED, or SHUTDOWN-ACK-SENT
state.<a class="pilcrow" href="#section-9.2-17">Â¶</a></p>
<p id="section-9.2-18">If an endpoint is in the SHUTDOWN-ACK-SENT state and receives an INIT
chunk (e.g., if the SHUTDOWN COMPLETE chunk was lost) with source and destination
transport addresses (either in the IP addresses or in the INIT chunk) that
belong to this association, it <span class="bcp14">SHOULD</span> discard the INIT chunk and retransmit
the SHUTDOWN ACK chunk.<a class="pilcrow" href="#section-9.2-18">Â¶</a></p>
<p id="section-9.2-19">Note: Receipt of a packet containing an INIT chunk with the same source and
destination IP addresses as used in transport addresses assigned to an endpoint
but with a different port number indicates the initialization of a separate
association.<a class="pilcrow" href="#section-9.2-19">Â¶</a></p>
<p id="section-9.2-20">The sender of the INIT or COOKIE ECHO chunk <span class="bcp14">SHOULD</span> respond to the receipt of
a SHUTDOWN ACK chunk with a stand-alone SHUTDOWN COMPLETE chunk in an
SCTP packet with the Verification Tag field of its common header set to the
same tag that was received in the packet containing the SHUTDOWN ACK chunk.
This is considered an OOTB packet as defined in
<a class="xref" href="#sec_handle_out_of_the_blue_packets">Section 8.4</a>.
The sender of the INIT chunk lets T1-init continue running and remains in the
COOKIE-WAIT or COOKIE-ECHOED state.
Normal T1-init timer expiration will cause the INIT or COOKIE chunk to be
retransmitted and thus start a new association.<a class="pilcrow" href="#section-9.2-20">Â¶</a></p>
<p id="section-9.2-21">If a SHUTDOWN chunk is received in the COOKIE-WAIT or COOKIE ECHOED state,
the SHUTDOWN chunk <span class="bcp14">SHOULD</span> be silently discarded.<a class="pilcrow" href="#section-9.2-21">Â¶</a></p>
<p id="section-9.2-22">If an endpoint is in the SHUTDOWN-SENT state and receives a SHUTDOWN chunk
from its peer, the endpoint <span class="bcp14">SHOULD</span> respond immediately with a SHUTDOWN ACK chunk
to its peer and move into the SHUTDOWN-ACK-SENT state, restarting its
T2-shutdown timer.<a class="pilcrow" href="#section-9.2-22">Â¶</a></p>
<p id="section-9.2-23">If an endpoint is in the SHUTDOWN-ACK-SENT state and receives a SHUTDOWN ACK,
it <span class="bcp14">MUST</span> stop the T2-shutdown timer, send a SHUTDOWN COMPLETE chunk to its peer,
and remove all record of the association.<a class="pilcrow" href="#section-9.2-23">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec_icmp">
<section id="section-10">
      <h2 id="name-icmp-handling">
<a class="section-number selfRef" href="#section-10">10. </a><a class="section-name selfRef" href="#name-icmp-handling">ICMP Handling</a>
      </h2>
<p id="section-10-1">Whenever an ICMP message is received by an SCTP endpoint, the following
procedures <span class="bcp14">MUST</span> be followed to ensure proper utilization of the information
being provided by layer 3.<a class="pilcrow" href="#section-10-1">Â¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-10-2">
<dt>ICMP1)</dt>
<dd id="section-10-2.1">
          <p id="section-10-2.1.1">An implementation <span class="bcp14">MAY</span> ignore all ICMPv4 messages where the type field is not
set to "Destination Unreachable".<a class="pilcrow" href="#section-10-2.1.1">Â¶</a></p>
</dd>
        <dd class="break"></dd>
<dt>ICMP2)</dt>
<dd id="section-10-2.2">
          <p id="section-10-2.2.1">An implementation <span class="bcp14">MAY</span> ignore all ICMPv6 messages where the type field is
not "Destination Unreachable", "Parameter Problem", or "Packet Too Big".<a class="pilcrow" href="#section-10-2.2.1">Â¶</a></p>
</dd>
        <dd class="break"></dd>
<dt>ICMP3)</dt>
<dd id="section-10-2.3">
          <p id="section-10-2.3.1">An implementation <span class="bcp14">SHOULD</span> ignore any ICMP messages where the code indicates
"Port Unreachable".<a class="pilcrow" href="#section-10-2.3.1">Â¶</a></p>
</dd>
        <dd class="break"></dd>
<dt>ICMP4)</dt>
<dd id="section-10-2.4">
          <p id="section-10-2.4.1">An implementation <span class="bcp14">MAY</span> ignore all ICMPv6 messages of type "Parameter Problem"
if the code is not "Unrecognized Next Header Type Encountered".<a class="pilcrow" href="#section-10-2.4.1">Â¶</a></p>
</dd>
        <dd class="break"></dd>
<dt>ICMP5)</dt>
<dd id="section-10-2.5">
          <p id="section-10-2.5.1">An implementation <span class="bcp14">MUST</span> use the payload of the ICMP message (v4 or v6) to
locate the association that sent the message to which ICMP is responding.
If the association cannot be found, an implementation <span class="bcp14">SHOULD</span> ignore the
ICMP message.<a class="pilcrow" href="#section-10-2.5.1">Â¶</a></p>
</dd>
        <dd class="break"></dd>
<dt>ICMP6)</dt>
<dd id="section-10-2.6">
          <p id="section-10-2.6.1">An implementation <span class="bcp14">MUST</span> validate that the Verification Tag contained in the
ICMP message matches the Verification Tag of the peer.
If the Verification Tag is not 0 and does not match, discard the ICMP message.
If it is 0 and the ICMP message contains enough bytes to verify that the
chunk type is an INIT chunk and that the Initiate Tag matches the tag of the
peer, continue with ICMP7.
If the ICMP message is too short or the chunk type or the Initiate Tag does
not match, silently discard the packet.<a class="pilcrow" href="#section-10-2.6.1">Â¶</a></p>
</dd>
        <dd class="break"></dd>
<dt>ICMP7)</dt>
<dd id="section-10-2.7">
          <p id="section-10-2.7.1">If the ICMP message is either an ICMPv6 message of type "Packet Too Big"
or an ICMPv4 message of type "Destination Unreachable" and code
"Fragmentation Needed", an implementation <span class="bcp14">SHOULD</span> process this information as
defined for PMTU discovery.<a class="pilcrow" href="#section-10-2.7.1">Â¶</a></p>
</dd>
        <dd class="break"></dd>
<dt>ICMP8)</dt>
<dd id="section-10-2.8">
          <p id="section-10-2.8.1">If the ICMP code is "Unrecognized Next Header Type Encountered" or
"Protocol Unreachable", an implementation <span class="bcp14">MUST</span> treat this message as an abort
with the T bit set if it does not contain an INIT chunk.
If it does contain an INIT chunk and the association is in the
COOKIE-WAIT state, handle the ICMP message like an ABORT chunk.<a class="pilcrow" href="#section-10-2.8.1">Â¶</a></p>
</dd>
        <dd class="break"></dd>
<dt>ICMP9)</dt>
<dd id="section-10-2.9">
          <p id="section-10-2.9.1">If the ICMP type is "Destination Unreachable", the implementation <span class="bcp14">MAY</span> move
the destination to the unreachable state or, alternatively, increment the
path error counter.
SCTP <span class="bcp14">MAY</span> provide information to the upper layer indicating the reception of
ICMP messages when reporting a network status change.<a class="pilcrow" href="#section-10-2.9.1">Â¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-10-3">These procedures differ from <span>[<a class="xref" href="#RFC1122">RFC1122</a>]</span> and from its
requirements for processing of port-unreachable messages and the requirements
that an implementation <span class="bcp14">MUST</span> abort associations in response to a
protocol unreachable message.

Port-unreachable messages are not processed, since an implementation will send
an ABORT chunk, not a port-unreachable message. The stricter handling of the
protocol unreachable message is due to security concerns for hosts that do
not support SCTP.<a class="pilcrow" href="#section-10-3">Â¶</a></p>
</section>
</div>
<div id="sec_api">
<section id="section-11">
      <h2 id="name-interface-with-upper-layer">
<a class="section-number selfRef" href="#section-11">11. </a><a class="section-name selfRef" href="#name-interface-with-upper-layer">Interface with Upper Layer</a>
      </h2>
<p id="section-11-1">The Upper Layer Protocols (ULPs) request services by passing primitives
to SCTP and receive notifications from SCTP for various events.<a class="pilcrow" href="#section-11-1">Â¶</a></p>
<p id="section-11-2">The primitives and notifications described in this section can be
used as a guideline for implementing SCTP.
The following functional description of ULP interface primitives is shown for
illustrative purposes.
Different SCTP implementations can have different ULP interfaces.
However, all SCTP implementations are expected to provide a certain minimum set
of services to guarantee that all SCTP implementations can support the same
protocol hierarchy.<a class="pilcrow" href="#section-11-2">Â¶</a></p>
<p id="section-11-3">Please note that this section is informational only.<a class="pilcrow" href="#section-11-3">Â¶</a></p>
<p id="section-11-4"><span>[<a class="xref" href="#RFC6458">RFC6458</a>]</span> and Section <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc7053#section-7">7</a> (<a class="relref" href="https://www.rfc-editor.org/rfc/rfc7053#section-7">"Socket API Considerations"</a>)</span> of <span>[<a class="xref" href="#RFC7053">RFC7053</a>]</span> define an extension of the socket API for SCTP as
described in this document.<a class="pilcrow" href="#section-11-4">Â¶</a></p>
<div id="sec_ulp_to_sctp">
<section id="section-11.1">
        <h3 id="name-ulp-to-sctp">
<a class="section-number selfRef" href="#section-11.1">11.1. </a><a class="section-name selfRef" href="#name-ulp-to-sctp">ULP-to-SCTP</a>
        </h3>
<p id="section-11.1-1">The following sections functionally characterize a ULP/SCTP interface.
The notation used is similar to most procedure or function calls in high-level
languages.<a class="pilcrow" href="#section-11.1-1">Â¶</a></p>
<p id="section-11.1-2">The ULP primitives described below specify the basic functions that
SCTP performs to support inter-process communication.
Individual implementations define their own exact format and provide
combinations or subsets of the basic functions in single calls.<a class="pilcrow" href="#section-11.1-2">Â¶</a></p>
<section id="section-11.1.1">
          <h4 id="name-initialize">
<a class="section-number selfRef" href="#section-11.1.1">11.1.1. </a><a class="section-name selfRef" href="#name-initialize">Initialize</a>
          </h4>
<div id="section-11.1.1-1">
<pre class="lang-pseudocode sourcecode">INITIALIZE ([local port],[local eligible address list])
-&gt; local SCTP instance name
</pre><a class="pilcrow" href="#section-11.1.1-1">Â¶</a>
</div>
<p id="section-11.1.1-2">This primitive allows SCTP to initialize its internal data structures
and allocate necessary resources for setting up its operation
environment.
Once SCTP is initialized, ULP can communicate directly with other endpoints
without re-invoking this primitive.<a class="pilcrow" href="#section-11.1.1-2">Â¶</a></p>
<p id="section-11.1.1-3">SCTP will return a local SCTP instance name to the ULP.<a class="pilcrow" href="#section-11.1.1-3">Â¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-11.1.1-4">
            <dt id="section-11.1.1-4.1">Mandatory attributes:</dt>
            <dd id="section-11.1.1-4.2" style="margin-left: 1.5em">None.<a class="pilcrow" href="#section-11.1.1-4.2">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-11.1.1-4.3">Optional attributes:</dt>
            <dd id="section-11.1.1-4.4" style="margin-left: 1.5em">
              <span class="break"></span><dl class="dlParallel" id="section-11.1.1-4.4.1">
                <dt id="section-11.1.1-4.4.1.1">local port:</dt>
                <dd id="section-11.1.1-4.4.1.2" style="margin-left: 1.5em">SCTP port number, if ULP wants it to be specified.<a class="pilcrow" href="#section-11.1.1-4.4.1.2">Â¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-11.1.1-4.4.1.3">local eligible address list:</dt>
                <dd id="section-11.1.1-4.4.1.4" style="margin-left: 1.5em">an address list that the local SCTP endpoint binds.
By default, if an address list is not included, all IP addresses assigned to
the host are used by the local endpoint.<a class="pilcrow" href="#section-11.1.1-4.4.1.4">Â¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-11.1.1-5">Implementation Note: If this optional attribute is supported by an
implementation, it will be the responsibility of the implementation
to enforce that the IP source address field of any SCTP packets sent
by this endpoint contains one of the IP addresses indicated in the local
eligible address list.<a class="pilcrow" href="#section-11.1.1-5">Â¶</a></p>
</section>
<div id="sec_associate">
<section id="section-11.1.2">
          <h4 id="name-associate">
<a class="section-number selfRef" href="#section-11.1.2">11.1.2. </a><a class="section-name selfRef" href="#name-associate">Associate</a>
          </h4>
<div id="section-11.1.2-1">
<pre class="lang-pseudocode sourcecode">ASSOCIATE(local SCTP instance name,
initial destination transport addr list, outbound stream count)
-&gt; association id [,destination transport addr list]
[,outbound stream count]
</pre><a class="pilcrow" href="#section-11.1.2-1">Â¶</a>
</div>
<p id="section-11.1.2-2">This primitive allows the upper layer to initiate an association to a specific
peer endpoint.<a class="pilcrow" href="#section-11.1.2-2">Â¶</a></p>
<p id="section-11.1.2-3">The peer endpoint is specified by one or more of the transport
addresses that defines the endpoint (see <a class="xref" href="#sec_key_terms">Section 1.3</a>).
If the local SCTP instance has not been initialized, the ASSOCIATE is considered
an error.<a class="pilcrow" href="#section-11.1.2-3">Â¶</a></p>
<p id="section-11.1.2-4">An association id, which is a local handle to the SCTP association,
will be returned on successful establishment of the association.
If SCTP is not able to open an SCTP association with the peer endpoint,
an error is returned.<a class="pilcrow" href="#section-11.1.2-4">Â¶</a></p>
<p id="section-11.1.2-5">Other association parameters can be returned, including the complete
destination transport addresses of the peer as well as the outbound
stream count of the local endpoint.
One of the transport addresses from the returned destination addresses will
be selected by the local endpoint as the default primary path for sending
SCTP packets to this peer.
The returned "destination transport addr list" can be used by the ULP to change
the default primary path or to force sending a packet to a specific
transport address.<a class="pilcrow" href="#section-11.1.2-5">Â¶</a></p>
<p id="section-11.1.2-6">Implementation Note: If the ASSOCIATE primitive is implemented as a
blocking function call, the ASSOCIATE primitive can return
association parameters in addition to the association id upon
successful establishment.
If ASSOCIATE primitive is implemented as a non-blocking call, only the
association id is returned and association parameters are passed
using the COMMUNICATION UP notification.<a class="pilcrow" href="#section-11.1.2-6">Â¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-11.1.2-7">
            <dt id="section-11.1.2-7.1">Mandatory attributes:</dt>
            <dd id="section-11.1.2-7.2" style="margin-left: 1.5em">
              <span class="break"></span><dl class="dlParallel" id="section-11.1.2-7.2.1">
                <dt id="section-11.1.2-7.2.1.1">local SCTP instance name:</dt>
                <dd id="section-11.1.2-7.2.1.2" style="margin-left: 1.5em">obtained from the INITIALIZE operation.<a class="pilcrow" href="#section-11.1.2-7.2.1.2">Â¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-11.1.2-7.2.1.3">initial destination transport addr list:</dt>
                <dd id="section-11.1.2-7.2.1.4" style="margin-left: 1.5em">a non-empty list of transport addresses of the peer endpoint with which
the association is to be established.<a class="pilcrow" href="#section-11.1.2-7.2.1.4">Â¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-11.1.2-7.2.1.5">outbound stream count:</dt>
                <dd id="section-11.1.2-7.2.1.6" style="margin-left: 1.5em">the number of outbound streams the ULP would like to open towards this
peer endpoint.<a class="pilcrow" href="#section-11.1.2-7.2.1.6">Â¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</dd>
            <dd class="break"></dd>
<dt id="section-11.1.2-7.3">Optional attributes:</dt>
            <dd id="section-11.1.2-7.4" style="margin-left: 1.5em">None.<a class="pilcrow" href="#section-11.1.2-7.4">Â¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec_shutdown">
<section id="section-11.1.3">
          <h4 id="name-shutdown">
<a class="section-number selfRef" href="#section-11.1.3">11.1.3. </a><a class="section-name selfRef" href="#name-shutdown">Shutdown</a>
          </h4>
<div id="section-11.1.3-1">
<pre class="lang-pseudocode sourcecode">SHUTDOWN(association id) -&gt; result
</pre><a class="pilcrow" href="#section-11.1.3-1">Â¶</a>
</div>
<p id="section-11.1.3-2">Gracefully closes an association.
Any locally queued user data will be delivered to the peer.
The association will be terminated only after the peer acknowledges all the
SCTP packets sent.
A success code will be returned on successful termination of the association.
If attempting to terminate the association results in a failure, an error code
is returned.<a class="pilcrow" href="#section-11.1.3-2">Â¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-11.1.3-3">
            <dt id="section-11.1.3-3.1">Mandatory attributes:</dt>
            <dd id="section-11.1.3-3.2" style="margin-left: 1.5em">
              <span class="break"></span><dl class="dlParallel" id="section-11.1.3-3.2.1">
                <dt id="section-11.1.3-3.2.1.1">association id:</dt>
                <dd id="section-11.1.3-3.2.1.2" style="margin-left: 1.5em">local handle to the SCTP association.<a class="pilcrow" href="#section-11.1.3-3.2.1.2">Â¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</dd>
            <dd class="break"></dd>
<dt id="section-11.1.3-3.3">Optional attributes:</dt>
            <dd id="section-11.1.3-3.4" style="margin-left: 1.5em">None.<a class="pilcrow" href="#section-11.1.3-3.4">Â¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<section id="section-11.1.4">
          <h4 id="name-abort">
<a class="section-number selfRef" href="#section-11.1.4">11.1.4. </a><a class="section-name selfRef" href="#name-abort">Abort</a>
          </h4>
<div id="section-11.1.4-1">
<pre class="lang-pseudocode sourcecode">ABORT(association id [, Upper Layer Abort Reason]) -&gt; result
</pre><a class="pilcrow" href="#section-11.1.4-1">Â¶</a>
</div>
<p id="section-11.1.4-2">Ungracefully closes an association.
Any locally queued user data will be discarded, and an ABORT chunk is sent to
the peer.
A success code will be returned on successful abort of the association.
If attempting to abort the association results in a failure, an error code
is returned.<a class="pilcrow" href="#section-11.1.4-2">Â¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-11.1.4-3">
            <dt id="section-11.1.4-3.1">Mandatory attributes:</dt>
            <dd id="section-11.1.4-3.2" style="margin-left: 1.5em">
              <span class="break"></span><dl class="dlParallel" id="section-11.1.4-3.2.1">
                <dt id="section-11.1.4-3.2.1.1">association id:</dt>
                <dd id="section-11.1.4-3.2.1.2" style="margin-left: 1.5em">local handle to the SCTP association.<a class="pilcrow" href="#section-11.1.4-3.2.1.2">Â¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</dd>
            <dd class="break"></dd>
<dt id="section-11.1.4-3.3">Optional attributes:</dt>
            <dd id="section-11.1.4-3.4" style="margin-left: 1.5em">
              <span class="break"></span><dl class="dlParallel" id="section-11.1.4-3.4.1">
                <dt id="section-11.1.4-3.4.1.1">Upper Layer Abort Reason:</dt>
                <dd id="section-11.1.4-3.4.1.2" style="margin-left: 1.5em">reason of the abort to be passed to the peer.<a class="pilcrow" href="#section-11.1.4-3.4.1.2">Â¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</dd>
          <dd class="break"></dd>
</dl>
</section>
<div id="sec_send">
<section id="section-11.1.5">
          <h4 id="name-send">
<a class="section-number selfRef" href="#section-11.1.5">11.1.5. </a><a class="section-name selfRef" href="#name-send">Send</a>
          </h4>
<div id="section-11.1.5-1">
<pre class="lang-pseudocode sourcecode">SEND(association id, buffer address, byte count [,context]
[,stream id] [,life time] [,destination transport address]
[,unordered flag] [,no-bundle flag] [,payload protocol-id]
[,sack-immediately flag]) -&gt; result
</pre><a class="pilcrow" href="#section-11.1.5-1">Â¶</a>
</div>
<p id="section-11.1.5-2">This is the main method to send user data via SCTP.<a class="pilcrow" href="#section-11.1.5-2">Â¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-11.1.5-3">
            <dt id="section-11.1.5-3.1">Mandatory attributes:</dt>
            <dd id="section-11.1.5-3.2" style="margin-left: 1.5em">
              <span class="break"></span><dl class="dlParallel" id="section-11.1.5-3.2.1">
                <dt id="section-11.1.5-3.2.1.1">association id:</dt>
                <dd id="section-11.1.5-3.2.1.2" style="margin-left: 1.5em">local handle to the SCTP association.<a class="pilcrow" href="#section-11.1.5-3.2.1.2">Â¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-11.1.5-3.2.1.3">buffer address:</dt>
                <dd id="section-11.1.5-3.2.1.4" style="margin-left: 1.5em">the location where the user message to be transmitted is stored.<a class="pilcrow" href="#section-11.1.5-3.2.1.4">Â¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-11.1.5-3.2.1.5">byte count:</dt>
                <dd id="section-11.1.5-3.2.1.6" style="margin-left: 1.5em">the size of the user data in number of bytes.<a class="pilcrow" href="#section-11.1.5-3.2.1.6">Â¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</dd>
            <dd class="break"></dd>
<dt id="section-11.1.5-3.3">Optional attributes:</dt>
            <dd id="section-11.1.5-3.4" style="margin-left: 1.5em">
              <span class="break"></span><dl class="dlParallel" id="section-11.1.5-3.4.1">
                <dt id="section-11.1.5-3.4.1.1">context:</dt>
                <dd id="section-11.1.5-3.4.1.2" style="margin-left: 1.5em">optional information provided that will be carried in the SEND FAILURE
notification to the ULP if the transportation of this user message fails.<a class="pilcrow" href="#section-11.1.5-3.4.1.2">Â¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-11.1.5-3.4.1.3">stream id:</dt>
                <dd id="section-11.1.5-3.4.1.4" style="margin-left: 1.5em">indicates which stream to send the data on.
If not specified, stream 0 will be used.<a class="pilcrow" href="#section-11.1.5-3.4.1.4">Â¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-11.1.5-3.4.1.5">life time:</dt>
                <dd id="section-11.1.5-3.4.1.6" style="margin-left: 1.5em">
                  <p id="section-11.1.5-3.4.1.6.1">specifies the life time of the user data.
The user data will not be sent by SCTP after the life time expires.
This parameter can be used to avoid efforts to transmit stale user messages.
SCTP notifies the ULP if the data cannot be initiated to transport (i.e., sent
to the destination via SCTP's SEND primitive) within the life time variable.
However, the user data will be transmitted if SCTP has attempted to transmit
a chunk before the life time expired.<a class="pilcrow" href="#section-11.1.5-3.4.1.6.1">Â¶</a></p>
<p id="section-11.1.5-3.4.1.6.2">Implementation Note: In order to better support the data life time
option, the transmitter can hold back the assigning of the TSN number
to an outbound DATA chunk to the last moment.
And, for implementation simplicity, once a TSN number has been assigned, the
sender considers the send of this DATA chunk as committed,
overriding any life time option attached to the DATA chunk.<a class="pilcrow" href="#section-11.1.5-3.4.1.6.2">Â¶</a></p>
</dd>
                <dd class="break"></dd>
<dt id="section-11.1.5-3.4.1.7">destination transport address:</dt>
                <dd id="section-11.1.5-3.4.1.8" style="margin-left: 1.5em">specified as one of the destination transport addresses of the peer endpoint
to which this packet is sent.
Whenever possible, SCTP uses this destination transport address for
sending the packets, instead of the current primary path.<a class="pilcrow" href="#section-11.1.5-3.4.1.8">Â¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-11.1.5-3.4.1.9">unordered flag:</dt>
                <dd id="section-11.1.5-3.4.1.10" style="margin-left: 1.5em">this flag, if present, indicates that the user would like the data delivered
in an unordered fashion to the peer (i.e., the U flag is set to 1 on all DATA
chunks carrying this message).<a class="pilcrow" href="#section-11.1.5-3.4.1.10">Â¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-11.1.5-3.4.1.11">no-bundle flag:</dt>
                <dd id="section-11.1.5-3.4.1.12" style="margin-left: 1.5em">instructs SCTP not to delay the sending of DATA chunks for this user data
just to allow it to be bundled with other outbound DATA chunks.
When faced with network congestion, SCTP might still bundle the data, even when
this flag is present.<a class="pilcrow" href="#section-11.1.5-3.4.1.12">Â¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-11.1.5-3.4.1.13">payload protocol-id:</dt>
                <dd id="section-11.1.5-3.4.1.14" style="margin-left: 1.5em">a 32-bit unsigned integer that is to be passed to the peer, indicating the type
of payload protocol data being transmitted.
Note that the upper layer is responsible for the host to network byte order
conversion of this field, which is passed by SCTP as 4 bytes of opaque
data.<a class="pilcrow" href="#section-11.1.5-3.4.1.14">Â¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-11.1.5-3.4.1.15">sack-immediately flag:</dt>
                <dd id="section-11.1.5-3.4.1.16" style="margin-left: 1.5em">set the I bit on the last DATA chunk used for the user message to be
transmitted.<a class="pilcrow" href="#section-11.1.5-3.4.1.16">Â¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<section id="section-11.1.6">
          <h4 id="name-set-primary">
<a class="section-number selfRef" href="#section-11.1.6">11.1.6. </a><a class="section-name selfRef" href="#name-set-primary">Set Primary</a>
          </h4>
<div id="section-11.1.6-1">
<pre class="lang-pseudocode sourcecode">SETPRIMARY(association id, destination transport address,
[source transport address]) -&gt; result
</pre><a class="pilcrow" href="#section-11.1.6-1">Â¶</a>
</div>
<p id="section-11.1.6-2">Instructs the local SCTP to use the specified destination transport address as
the primary path for sending packets.<a class="pilcrow" href="#section-11.1.6-2">Â¶</a></p>
<p id="section-11.1.6-3">The result of attempting this operation is returned.
If the specified destination transport address is not present in the
"destination transport address list" returned earlier in an ASSOCIATE
primitive or COMMUNICATION UP notification, an error is returned.<a class="pilcrow" href="#section-11.1.6-3">Â¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-11.1.6-4">
            <dt id="section-11.1.6-4.1">Mandatory attributes:</dt>
            <dd id="section-11.1.6-4.2" style="margin-left: 1.5em">
              <span class="break"></span><dl class="dlParallel" id="section-11.1.6-4.2.1">
                <dt id="section-11.1.6-4.2.1.1">association id:</dt>
                <dd id="section-11.1.6-4.2.1.2" style="margin-left: 1.5em">local handle to the SCTP association.<a class="pilcrow" href="#section-11.1.6-4.2.1.2">Â¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-11.1.6-4.2.1.3">destination transport address:</dt>
                <dd id="section-11.1.6-4.2.1.4" style="margin-left: 1.5em">specified as one of the transport addresses of the peer endpoint, which is
used as the primary address for sending packets.
This overrides the current primary address information maintained by the
local SCTP endpoint.<a class="pilcrow" href="#section-11.1.6-4.2.1.4">Â¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</dd>
            <dd class="break"></dd>
<dt id="section-11.1.6-4.3">Optional attributes:</dt>
            <dd id="section-11.1.6-4.4" style="margin-left: 1.5em">
              <span class="break"></span><dl class="dlParallel" id="section-11.1.6-4.4.1">
                <dt id="section-11.1.6-4.4.1.1">source transport address:</dt>
                <dd id="section-11.1.6-4.4.1.2" style="margin-left: 1.5em">optionally, some implementations can allow you to set the default source address
placed in all outgoing IP datagrams.<a class="pilcrow" href="#section-11.1.6-4.4.1.2">Â¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</dd>
          <dd class="break"></dd>
</dl>
</section>
<section id="section-11.1.7">
          <h4 id="name-receive">
<a class="section-number selfRef" href="#section-11.1.7">11.1.7. </a><a class="section-name selfRef" href="#name-receive">Receive</a>
          </h4>
<div id="section-11.1.7-1">
<pre class="lang-pseudocode sourcecode">RECEIVE(association id, buffer address, buffer size [,stream id])
-&gt; byte count [,transport address] [,stream id]
[,stream sequence number] [,partial flag] [,payload protocol-id]
</pre><a class="pilcrow" href="#section-11.1.7-1">Â¶</a>
</div>
<p id="section-11.1.7-2">This primitive reads the first user message in the SCTP in-queue
into the buffer specified by ULP, if there is one available.
The size of the message read, in bytes, will be returned.
It might, depending on the specific implementation, also return other
information, such as the sender's address, the stream id on which it
is received, whether there are more messages available for retrieval,
etc.
For ordered messages, their Stream Sequence Number might also be returned.<a class="pilcrow" href="#section-11.1.7-2">Â¶</a></p>
<p id="section-11.1.7-3">Depending upon the implementation, if this primitive is invoked when no
message is available, the implementation returns an indication of this condition
or blocks the invoking process until data does become available.<a class="pilcrow" href="#section-11.1.7-3">Â¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-11.1.7-4">
            <dt id="section-11.1.7-4.1">Mandatory attributes:</dt>
            <dd id="section-11.1.7-4.2" style="margin-left: 1.5em">
              <span class="break"></span><dl class="dlParallel" id="section-11.1.7-4.2.1">
                <dt id="section-11.1.7-4.2.1.1">association id:</dt>
                <dd id="section-11.1.7-4.2.1.2" style="margin-left: 1.5em">local handle to the SCTP association.<a class="pilcrow" href="#section-11.1.7-4.2.1.2">Â¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-11.1.7-4.2.1.3">buffer address:</dt>
                <dd id="section-11.1.7-4.2.1.4" style="margin-left: 1.5em">the memory location indicated by the ULP to store the received message.<a class="pilcrow" href="#section-11.1.7-4.2.1.4">Â¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-11.1.7-4.2.1.5">buffer size:</dt>
                <dd id="section-11.1.7-4.2.1.6" style="margin-left: 1.5em">the maximum size of data to be received, in bytes.<a class="pilcrow" href="#section-11.1.7-4.2.1.6">Â¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</dd>
            <dd class="break"></dd>
<dt id="section-11.1.7-4.3">Optional attributes:</dt>
            <dd id="section-11.1.7-4.4" style="margin-left: 1.5em">
              <span class="break"></span><dl class="dlParallel" id="section-11.1.7-4.4.1">
                <dt id="section-11.1.7-4.4.1.1">stream id:</dt>
                <dd id="section-11.1.7-4.4.1.2" style="margin-left: 1.5em">to indicate which stream to receive the data on.<a class="pilcrow" href="#section-11.1.7-4.4.1.2">Â¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-11.1.7-4.4.1.3">stream sequence number:</dt>
                <dd id="section-11.1.7-4.4.1.4" style="margin-left: 1.5em">the Stream Sequence Number assigned by the sending SCTP peer.<a class="pilcrow" href="#section-11.1.7-4.4.1.4">Â¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-11.1.7-4.4.1.5">partial flag:</dt>
                <dd id="section-11.1.7-4.4.1.6" style="margin-left: 1.5em">if this returned flag is set to 1, then this primitive contains a partial
delivery of the whole message.
When this flag is set, the stream id and stream sequence number
accompanies this primitive.
When this flag is set to 0, it indicates that no more deliveries will be
received for this stream sequence number.<a class="pilcrow" href="#section-11.1.7-4.4.1.6">Â¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-11.1.7-4.4.1.7">payload protocol-id:</dt>
                <dd id="section-11.1.7-4.4.1.8" style="margin-left: 1.5em">a 32-bit unsigned integer that is received from the peer indicating the type
of payload protocol of the received data.
Note that the upper layer is responsible for the host to network byte order
conversion of this field, which is passed by SCTP as 4 bytes of opaque
data.<a class="pilcrow" href="#section-11.1.7-4.4.1.8">Â¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</dd>
          <dd class="break"></dd>
</dl>
</section>
<section id="section-11.1.8">
          <h4 id="name-status">
<a class="section-number selfRef" href="#section-11.1.8">11.1.8. </a><a class="section-name selfRef" href="#name-status">Status</a>
          </h4>
<div id="section-11.1.8-1">
<pre class="lang-pseudocode sourcecode">STATUS(association id) -&gt; status data
</pre><a class="pilcrow" href="#section-11.1.8-1">Â¶</a>
</div>
<p id="section-11.1.8-2">This primitive returns a data block containing the following information:<a class="pilcrow" href="#section-11.1.8-2">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.1.8-3.1">
              <p id="section-11.1.8-3.1.1">association connection state,<a class="pilcrow" href="#section-11.1.8-3.1.1">Â¶</a></p>
</li>
            <li class="normal" id="section-11.1.8-3.2">
              <p id="section-11.1.8-3.2.1">destination transport address list,<a class="pilcrow" href="#section-11.1.8-3.2.1">Â¶</a></p>
</li>
            <li class="normal" id="section-11.1.8-3.3">
              <p id="section-11.1.8-3.3.1">destination transport address reachability states,<a class="pilcrow" href="#section-11.1.8-3.3.1">Â¶</a></p>
</li>
            <li class="normal" id="section-11.1.8-3.4">
              <p id="section-11.1.8-3.4.1">current receiver window size,<a class="pilcrow" href="#section-11.1.8-3.4.1">Â¶</a></p>
</li>
            <li class="normal" id="section-11.1.8-3.5">
              <p id="section-11.1.8-3.5.1">current congestion window sizes,<a class="pilcrow" href="#section-11.1.8-3.5.1">Â¶</a></p>
</li>
            <li class="normal" id="section-11.1.8-3.6">
              <p id="section-11.1.8-3.6.1">number of unacknowledged DATA chunks,<a class="pilcrow" href="#section-11.1.8-3.6.1">Â¶</a></p>
</li>
            <li class="normal" id="section-11.1.8-3.7">
              <p id="section-11.1.8-3.7.1">number of DATA chunks pending receipt,<a class="pilcrow" href="#section-11.1.8-3.7.1">Â¶</a></p>
</li>
            <li class="normal" id="section-11.1.8-3.8">
              <p id="section-11.1.8-3.8.1">primary path,<a class="pilcrow" href="#section-11.1.8-3.8.1">Â¶</a></p>
</li>
            <li class="normal" id="section-11.1.8-3.9">
              <p id="section-11.1.8-3.9.1">most recent SRTT on primary path,<a class="pilcrow" href="#section-11.1.8-3.9.1">Â¶</a></p>
</li>
            <li class="normal" id="section-11.1.8-3.10">
              <p id="section-11.1.8-3.10.1">RTO on primary path,<a class="pilcrow" href="#section-11.1.8-3.10.1">Â¶</a></p>
</li>
            <li class="normal" id="section-11.1.8-3.11">
              <p id="section-11.1.8-3.11.1">SRTT and RTO on other destination addresses, etc.<a class="pilcrow" href="#section-11.1.8-3.11.1">Â¶</a></p>
</li>
          </ul>
<span class="break"></span><dl class="dlNewline" id="section-11.1.8-4">
            <dt id="section-11.1.8-4.1">Mandatory attributes:</dt>
            <dd id="section-11.1.8-4.2" style="margin-left: 1.5em">
              <span class="break"></span><dl class="dlParallel" id="section-11.1.8-4.2.1">
                <dt id="section-11.1.8-4.2.1.1">association id:</dt>
                <dd id="section-11.1.8-4.2.1.2" style="margin-left: 1.5em">local handle to the SCTP association.<a class="pilcrow" href="#section-11.1.8-4.2.1.2">Â¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</dd>
            <dd class="break"></dd>
<dt id="section-11.1.8-4.3">Optional attributes:</dt>
            <dd id="section-11.1.8-4.4" style="margin-left: 1.5em">None.<a class="pilcrow" href="#section-11.1.8-4.4">Â¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
<section id="section-11.1.9">
          <h4 id="name-change-heartbeat">
<a class="section-number selfRef" href="#section-11.1.9">11.1.9. </a><a class="section-name selfRef" href="#name-change-heartbeat">Change Heartbeat</a>
          </h4>
<div id="section-11.1.9-1">
<pre class="lang-pseudocode sourcecode">CHANGE HEARTBEAT(association id, destination transport address,
new state [,interval]) -&gt; result
</pre><a class="pilcrow" href="#section-11.1.9-1">Â¶</a>
</div>
<p id="section-11.1.9-2">Instructs the local endpoint to enable or disable heartbeat on the
specified destination transport address.<a class="pilcrow" href="#section-11.1.9-2">Â¶</a></p>
<p id="section-11.1.9-3">The result of attempting this operation is returned.<a class="pilcrow" href="#section-11.1.9-3">Â¶</a></p>
<p id="section-11.1.9-4">Note: Even when enabled, heartbeat will not take place if the destination
transport address is not idle.<a class="pilcrow" href="#section-11.1.9-4">Â¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-11.1.9-5">
            <dt id="section-11.1.9-5.1">Mandatory attributes:</dt>
            <dd id="section-11.1.9-5.2" style="margin-left: 1.5em">
              <span class="break"></span><dl class="dlParallel" id="section-11.1.9-5.2.1">
                <dt id="section-11.1.9-5.2.1.1">association id:</dt>
                <dd id="section-11.1.9-5.2.1.2" style="margin-left: 1.5em">local handle to the SCTP association.<a class="pilcrow" href="#section-11.1.9-5.2.1.2">Â¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-11.1.9-5.2.1.3">destination transport address:</dt>
                <dd id="section-11.1.9-5.2.1.4" style="margin-left: 1.5em">specified as one of the transport addresses of the peer endpoint.<a class="pilcrow" href="#section-11.1.9-5.2.1.4">Â¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-11.1.9-5.2.1.5">new state:</dt>
                <dd id="section-11.1.9-5.2.1.6" style="margin-left: 1.5em">the new state of heartbeat for this destination transport address
(either enabled or disabled).<a class="pilcrow" href="#section-11.1.9-5.2.1.6">Â¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</dd>
            <dd class="break"></dd>
<dt id="section-11.1.9-5.3">Optional attributes:</dt>
            <dd id="section-11.1.9-5.4" style="margin-left: 1.5em">
              <span class="break"></span><dl class="dlParallel" id="section-11.1.9-5.4.1">
                <dt id="section-11.1.9-5.4.1.1">interval:</dt>
                <dd id="section-11.1.9-5.4.1.2" style="margin-left: 1.5em">if present, indicates the frequency of the heartbeat if this is to enable
heartbeat on a destination transport address.
This value is added to the RTO of the destination transport address.
This value, if present, affects all destinations.<a class="pilcrow" href="#section-11.1.9-5.4.1.2">Â¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</dd>
          <dd class="break"></dd>
</dl>
</section>
<section id="section-11.1.10">
          <h4 id="name-request-heartbeat">
<a class="section-number selfRef" href="#section-11.1.10">11.1.10. </a><a class="section-name selfRef" href="#name-request-heartbeat">Request Heartbeat</a>
          </h4>
<div id="section-11.1.10-1">
<pre class="lang-pseudocode sourcecode">REQUESTHEARTBEAT(association id, destination transport address)
-&gt; result
</pre><a class="pilcrow" href="#section-11.1.10-1">Â¶</a>
</div>
<p id="section-11.1.10-2">Instructs the local endpoint to perform a heartbeat on the specified
destination transport address of the given association.
The returned result indicates whether the transmission of the HEARTBEAT
chunk to the destination address is successful.<a class="pilcrow" href="#section-11.1.10-2">Â¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-11.1.10-3">
            <dt id="section-11.1.10-3.1">Mandatory attributes:</dt>
            <dd id="section-11.1.10-3.2" style="margin-left: 1.5em">
              <span class="break"></span><dl class="dlParallel" id="section-11.1.10-3.2.1">
                <dt id="section-11.1.10-3.2.1.1">association id:</dt>
                <dd id="section-11.1.10-3.2.1.2" style="margin-left: 1.5em">local handle to the SCTP association.<a class="pilcrow" href="#section-11.1.10-3.2.1.2">Â¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-11.1.10-3.2.1.3">destination transport address:</dt>
                <dd id="section-11.1.10-3.2.1.4" style="margin-left: 1.5em">the transport address of the association on which a heartbeat is issued.<a class="pilcrow" href="#section-11.1.10-3.2.1.4">Â¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</dd>
            <dd class="break"></dd>
<dt id="section-11.1.10-3.3">Optional attributes:</dt>
            <dd id="section-11.1.10-3.4" style="margin-left: 1.5em">None.<a class="pilcrow" href="#section-11.1.10-3.4">Â¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
<section id="section-11.1.11">
          <h4 id="name-get-srtt-report">
<a class="section-number selfRef" href="#section-11.1.11">11.1.11. </a><a class="section-name selfRef" href="#name-get-srtt-report">Get SRTT Report</a>
          </h4>
<div id="section-11.1.11-1">
<pre class="lang-pseudocode sourcecode">GETSRTTREPORT(association id, destination transport address)
-&gt; srtt result
</pre><a class="pilcrow" href="#section-11.1.11-1">Â¶</a>
</div>
<p id="section-11.1.11-2">Instructs the local SCTP to report the current SRTT measurement on the
specified destination transport address of the given association.
The returned result can be an integer containing the most recent SRTT in
milliseconds.<a class="pilcrow" href="#section-11.1.11-2">Â¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-11.1.11-3">
            <dt id="section-11.1.11-3.1">Mandatory attributes:</dt>
            <dd id="section-11.1.11-3.2" style="margin-left: 1.5em">
              <span class="break"></span><dl class="dlParallel" id="section-11.1.11-3.2.1">
                <dt id="section-11.1.11-3.2.1.1">association id:</dt>
                <dd id="section-11.1.11-3.2.1.2" style="margin-left: 1.5em">local handle to the SCTP association.<a class="pilcrow" href="#section-11.1.11-3.2.1.2">Â¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-11.1.11-3.2.1.3">destination transport address:</dt>
                <dd id="section-11.1.11-3.2.1.4" style="margin-left: 1.5em">the transport address of the association on which the SRTT measurement is to
be reported.<a class="pilcrow" href="#section-11.1.11-3.2.1.4">Â¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</dd>
            <dd class="break"></dd>
<dt id="section-11.1.11-3.3">Optional attributes:</dt>
            <dd id="section-11.1.11-3.4" style="margin-left: 1.5em">None.<a class="pilcrow" href="#section-11.1.11-3.4">Â¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
<section id="section-11.1.12">
          <h4 id="name-set-failure-threshold">
<a class="section-number selfRef" href="#section-11.1.12">11.1.12. </a><a class="section-name selfRef" href="#name-set-failure-threshold">Set Failure Threshold</a>
          </h4>
<div id="section-11.1.12-1">
<pre class="lang-pseudocode sourcecode">SETFAILURETHRESHOLD(association id, destination transport address,
failure threshold) -&gt; result
</pre><a class="pilcrow" href="#section-11.1.12-1">Â¶</a>
</div>
<p id="section-11.1.12-2">This primitive allows the local SCTP to customize the reachability failure
detection threshold 'Path.Max.Retrans' for the specified destination address.
Note that this can also be done using the SETPROTOCOLPARAMETERS primitive
(<a class="xref" href="#sec_set_protocol_parameters">Section 11.1.13</a>).<a class="pilcrow" href="#section-11.1.12-2">Â¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-11.1.12-3">
            <dt id="section-11.1.12-3.1">Mandatory attributes:</dt>
            <dd id="section-11.1.12-3.2" style="margin-left: 1.5em">
              <span class="break"></span><dl class="dlParallel" id="section-11.1.12-3.2.1">
                <dt id="section-11.1.12-3.2.1.1">association id:</dt>
                <dd id="section-11.1.12-3.2.1.2" style="margin-left: 1.5em">local handle to the SCTP association.<a class="pilcrow" href="#section-11.1.12-3.2.1.2">Â¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-11.1.12-3.2.1.3">destination transport address:</dt>
                <dd id="section-11.1.12-3.2.1.4" style="margin-left: 1.5em">the transport address of the association on which the failure detection
threshold is to be set.<a class="pilcrow" href="#section-11.1.12-3.2.1.4">Â¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-11.1.12-3.2.1.5">failure threshold:</dt>
                <dd id="section-11.1.12-3.2.1.6" style="margin-left: 1.5em">the new value of 'Path.Max.Retrans' for the destination address.<a class="pilcrow" href="#section-11.1.12-3.2.1.6">Â¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</dd>
            <dd class="break"></dd>
<dt id="section-11.1.12-3.3">Optional attributes:</dt>
            <dd id="section-11.1.12-3.4" style="margin-left: 1.5em">
              <p id="section-11.1.12-3.4.1">None.<a class="pilcrow" href="#section-11.1.12-3.4.1">Â¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
</section>
<div id="sec_set_protocol_parameters">
<section id="section-11.1.13">
          <h4 id="name-set-protocol-parameters">
<a class="section-number selfRef" href="#section-11.1.13">11.1.13. </a><a class="section-name selfRef" href="#name-set-protocol-parameters">Set Protocol Parameters</a>
          </h4>
<div id="section-11.1.13-1">
<pre class="lang-pseudocode sourcecode">SETPROTOCOLPARAMETERS(association id,
[destination transport address,] protocol parameter list)
-&gt; result
</pre><a class="pilcrow" href="#section-11.1.13-1">Â¶</a>
</div>
<p id="section-11.1.13-2">This primitive allows the local SCTP to customize the protocol parameters.<a class="pilcrow" href="#section-11.1.13-2">Â¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-11.1.13-3">
            <dt id="section-11.1.13-3.1">Mandatory attributes:</dt>
            <dd id="section-11.1.13-3.2" style="margin-left: 1.5em">
              <span class="break"></span><dl class="dlParallel" id="section-11.1.13-3.2.1">
                <dt id="section-11.1.13-3.2.1.1">association id:</dt>
                <dd id="section-11.1.13-3.2.1.2" style="margin-left: 1.5em">local handle to the SCTP association.<a class="pilcrow" href="#section-11.1.13-3.2.1.2">Â¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-11.1.13-3.2.1.3">protocol parameter list:</dt>
                <dd id="section-11.1.13-3.2.1.4" style="margin-left: 1.5em">the specific names and values of the protocol parameters
(e.g., 'Association.Max.Retrans' (see <a class="xref" href="#sec_parameter_values">Section 16</a>)
or other parameters like the DSCP) that the SCTP user wishes to customize.<a class="pilcrow" href="#section-11.1.13-3.2.1.4">Â¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</dd>
            <dd class="break"></dd>
<dt id="section-11.1.13-3.3">Optional attributes:</dt>
            <dd id="section-11.1.13-3.4" style="margin-left: 1.5em">
              <span class="break"></span><dl class="dlParallel" id="section-11.1.13-3.4.1">
                <dt id="section-11.1.13-3.4.1.1">destination transport address:</dt>
                <dd id="section-11.1.13-3.4.1.2" style="margin-left: 1.5em">some of the protocol parameters might be set on a per-destination-transport-address basis.<a class="pilcrow" href="#section-11.1.13-3.4.1.2">Â¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<section id="section-11.1.14">
          <h4 id="name-receive-unsent-message">
<a class="section-number selfRef" href="#section-11.1.14">11.1.14. </a><a class="section-name selfRef" href="#name-receive-unsent-message">Receive Unsent Message</a>
          </h4>
<div id="section-11.1.14-1">
<pre class="lang-pseudocode sourcecode">RECEIVE_UNSENT(data retrieval id, buffer address, buffer size
[,stream id] [, stream sequence number] [,partial flag]
[,payload protocol-id])
</pre><a class="pilcrow" href="#section-11.1.14-1">Â¶</a>
</div>
<p id="section-11.1.14-2">This primitive reads a user message that has never been sent
into the buffer specified by ULP.<a class="pilcrow" href="#section-11.1.14-2">Â¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-11.1.14-3">
            <dt id="section-11.1.14-3.1">Mandatory attributes:</dt>
            <dd id="section-11.1.14-3.2" style="margin-left: 1.5em">
              <span class="break"></span><dl class="dlParallel" id="section-11.1.14-3.2.1">
                <dt id="section-11.1.14-3.2.1.1">data retrieval id:</dt>
                <dd id="section-11.1.14-3.2.1.2" style="margin-left: 1.5em">the identification passed to the ULP in the SEND FAILURE notification.<a class="pilcrow" href="#section-11.1.14-3.2.1.2">Â¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-11.1.14-3.2.1.3">buffer address:</dt>
                <dd id="section-11.1.14-3.2.1.4" style="margin-left: 1.5em">the memory location indicated by the ULP to store the received message.<a class="pilcrow" href="#section-11.1.14-3.2.1.4">Â¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-11.1.14-3.2.1.5">buffer size:</dt>
                <dd id="section-11.1.14-3.2.1.6" style="margin-left: 1.5em">the maximum size of data to be received, in bytes.<a class="pilcrow" href="#section-11.1.14-3.2.1.6">Â¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</dd>
            <dd class="break"></dd>
<dt id="section-11.1.14-3.3">Optional attributes:</dt>
            <dd id="section-11.1.14-3.4" style="margin-left: 1.5em">
              <span class="break"></span><dl class="dlParallel" id="section-11.1.14-3.4.1">
                <dt id="section-11.1.14-3.4.1.1">stream id:</dt>
                <dd id="section-11.1.14-3.4.1.2" style="margin-left: 1.5em">this is a return value that is set to indicate which stream the data was
sent to.<a class="pilcrow" href="#section-11.1.14-3.4.1.2">Â¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-11.1.14-3.4.1.3">stream sequence number:</dt>
                <dd id="section-11.1.14-3.4.1.4" style="margin-left: 1.5em">this value is returned, indicating the Stream Sequence Number that was
associated with the message.<a class="pilcrow" href="#section-11.1.14-3.4.1.4">Â¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-11.1.14-3.4.1.5">partial flag:</dt>
                <dd id="section-11.1.14-3.4.1.6" style="margin-left: 1.5em">if this returned flag is set to 1, then this message is a partial delivery of
the whole message.
When this flag is set, the stream id and stream sequence number
accompanies this primitive.
When this flag is set to 0, it indicates that no more deliveries will be
received for this stream sequence number.<a class="pilcrow" href="#section-11.1.14-3.4.1.6">Â¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-11.1.14-3.4.1.7">payload protocol-id:</dt>
                <dd id="section-11.1.14-3.4.1.8" style="margin-left: 1.5em">The 32-bit unsigned integer that was set to be sent to the peer, indicating
the type of payload protocol of the received data.<a class="pilcrow" href="#section-11.1.14-3.4.1.8">Â¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</dd>
          <dd class="break"></dd>
</dl>
</section>
<section id="section-11.1.15">
          <h4 id="name-receive-unacknowledged-mess">
<a class="section-number selfRef" href="#section-11.1.15">11.1.15. </a><a class="section-name selfRef" href="#name-receive-unacknowledged-mess">Receive Unacknowledged Message</a>
          </h4>
<div id="section-11.1.15-1">
<pre class="lang-pseudocode sourcecode">RECEIVE_UNACKED(data retrieval id, buffer address, buffer size,
[,stream id] [,stream sequence number] [,partial flag]
[,payload protocol-id])
</pre><a class="pilcrow" href="#section-11.1.15-1">Â¶</a>
</div>
<p id="section-11.1.15-2">This primitive reads a user message that has been sent and has not been
acknowledged by the peer into the buffer specified by ULP.<a class="pilcrow" href="#section-11.1.15-2">Â¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-11.1.15-3">
            <dt id="section-11.1.15-3.1">Mandatory attributes:</dt>
            <dd id="section-11.1.15-3.2" style="margin-left: 1.5em">
              <span class="break"></span><dl class="dlParallel" id="section-11.1.15-3.2.1">
                <dt id="section-11.1.15-3.2.1.1">data retrieval id:</dt>
                <dd id="section-11.1.15-3.2.1.2" style="margin-left: 1.5em">the identification passed to the ULP in the SEND FAILURE notification.<a class="pilcrow" href="#section-11.1.15-3.2.1.2">Â¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-11.1.15-3.2.1.3">buffer address:</dt>
                <dd id="section-11.1.15-3.2.1.4" style="margin-left: 1.5em">the memory location indicated by the ULP to store the received message.<a class="pilcrow" href="#section-11.1.15-3.2.1.4">Â¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-11.1.15-3.2.1.5">buffer size:</dt>
                <dd id="section-11.1.15-3.2.1.6" style="margin-left: 1.5em">the maximum size of data to be received, in bytes.<a class="pilcrow" href="#section-11.1.15-3.2.1.6">Â¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</dd>
            <dd class="break"></dd>
<dt id="section-11.1.15-3.3">Optional attributes:</dt>
            <dd id="section-11.1.15-3.4" style="margin-left: 1.5em">
              <span class="break"></span><dl class="dlParallel" id="section-11.1.15-3.4.1">
                <dt id="section-11.1.15-3.4.1.1">stream id:</dt>
                <dd id="section-11.1.15-3.4.1.2" style="margin-left: 1.5em">this is a return value that is set to indicate which stream the data was sent
to.<a class="pilcrow" href="#section-11.1.15-3.4.1.2">Â¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-11.1.15-3.4.1.3">stream sequence number:</dt>
                <dd id="section-11.1.15-3.4.1.4" style="margin-left: 1.5em">this value is returned, indicating the Stream Sequence Number that was
associated with the message.<a class="pilcrow" href="#section-11.1.15-3.4.1.4">Â¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-11.1.15-3.4.1.5">partial flag:</dt>
                <dd id="section-11.1.15-3.4.1.6" style="margin-left: 1.5em">if this returned flag is set to 1, then this message is a partial delivery of
the whole message.
When this flag is set, the stream id and stream sequence number
accompanies this primitive.
When this flag is set to 0, it indicates that no more deliveries will be
received for this stream sequence number.<a class="pilcrow" href="#section-11.1.15-3.4.1.6">Â¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-11.1.15-3.4.1.7">payload protocol-id:</dt>
                <dd id="section-11.1.15-3.4.1.8" style="margin-left: 1.5em">the 32-bit unsigned integer that was sent to the peer indicating the type of
payload protocol of the received data.<a class="pilcrow" href="#section-11.1.15-3.4.1.8">Â¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</dd>
          <dd class="break"></dd>
</dl>
</section>
<section id="section-11.1.16">
          <h4 id="name-destroy-sctp-instance">
<a class="section-number selfRef" href="#section-11.1.16">11.1.16. </a><a class="section-name selfRef" href="#name-destroy-sctp-instance">Destroy SCTP Instance</a>
          </h4>
<div id="section-11.1.16-1">
<pre class="lang-pseudocode sourcecode">DESTROY(local SCTP instance name)
</pre><a class="pilcrow" href="#section-11.1.16-1">Â¶</a>
</div>
<span class="break"></span><dl class="dlNewline" id="section-11.1.16-2">
            <dt id="section-11.1.16-2.1">Mandatory attributes:</dt>
            <dd id="section-11.1.16-2.2" style="margin-left: 1.5em">
              <span class="break"></span><dl class="dlParallel" id="section-11.1.16-2.2.1">
                <dt id="section-11.1.16-2.2.1.1">local SCTP instance name:</dt>
                <dd id="section-11.1.16-2.2.1.2" style="margin-left: 1.5em">this is the value that was passed to
the application in the initialize primitive and it indicates which
SCTP instance is to be destroyed.<a class="pilcrow" href="#section-11.1.16-2.2.1.2">Â¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</dd>
            <dd class="break"></dd>
<dt id="section-11.1.16-2.3">Optional attributes:</dt>
            <dd id="section-11.1.16-2.4" style="margin-left: 1.5em">None.<a class="pilcrow" href="#section-11.1.16-2.4">Â¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</section>
</div>
<div id="sec_sctp_to_ulp">
<section id="section-11.2">
        <h3 id="name-sctp-to-ulp">
<a class="section-number selfRef" href="#section-11.2">11.2. </a><a class="section-name selfRef" href="#name-sctp-to-ulp">SCTP-to-ULP</a>
        </h3>
<p id="section-11.2-1">It is assumed that the operating system or application environment
provides a means for the SCTP to asynchronously signal the ULP process.
When SCTP does signal a ULP process, certain information is passed to
the ULP.<a class="pilcrow" href="#section-11.2-1">Â¶</a></p>
<p id="section-11.2-2">Implementation Note: In some cases, this might be done through a separate
socket or error channel.<a class="pilcrow" href="#section-11.2-2">Â¶</a></p>
<section id="section-11.2.1">
          <h4 id="name-data-arrive-notification">
<a class="section-number selfRef" href="#section-11.2.1">11.2.1. </a><a class="section-name selfRef" href="#name-data-arrive-notification">DATA ARRIVE Notification</a>
          </h4>
<p id="section-11.2.1-1">SCTP invokes this notification on the ULP when a user message is
successfully received and ready for retrieval.<a class="pilcrow" href="#section-11.2.1-1">Â¶</a></p>
<p id="section-11.2.1-2">The following might optionally be passed with the notification:<a class="pilcrow" href="#section-11.2.1-2">Â¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-11.2.1-3">
            <dt id="section-11.2.1-3.1">association id:</dt>
            <dd id="section-11.2.1-3.2" style="margin-left: 1.5em">local handle to the SCTP association.<a class="pilcrow" href="#section-11.2.1-3.2">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-11.2.1-3.3">stream id:</dt>
            <dd id="section-11.2.1-3.4" style="margin-left: 1.5em">to indicate which stream the data is received on.<a class="pilcrow" href="#section-11.2.1-3.4">Â¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
<section id="section-11.2.2">
          <h4 id="name-send-failure-notification">
<a class="section-number selfRef" href="#section-11.2.2">11.2.2. </a><a class="section-name selfRef" href="#name-send-failure-notification">SEND FAILURE Notification</a>
          </h4>
<p id="section-11.2.2-1">If a message cannot be delivered, SCTP invokes this notification
on the ULP.<a class="pilcrow" href="#section-11.2.2-1">Â¶</a></p>
<p id="section-11.2.2-2">The following might optionally be passed with the notification:<a class="pilcrow" href="#section-11.2.2-2">Â¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-11.2.2-3">
            <dt id="section-11.2.2-3.1">association id:</dt>
            <dd id="section-11.2.2-3.2" style="margin-left: 1.5em">local handle to the SCTP association.<a class="pilcrow" href="#section-11.2.2-3.2">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-11.2.2-3.3">data retrieval id:</dt>
            <dd id="section-11.2.2-3.4" style="margin-left: 1.5em">an identification used to retrieve unsent and unacknowledged data.<a class="pilcrow" href="#section-11.2.2-3.4">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-11.2.2-3.5">mode:</dt>
            <dd id="section-11.2.2-3.6" style="margin-left: 1.5em">indicates whether no part of the message never has been sent or if at
least part of it has been sent but it is not completely acknowledged.<a class="pilcrow" href="#section-11.2.2-3.6">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-11.2.2-3.7">cause code:</dt>
            <dd id="section-11.2.2-3.8" style="margin-left: 1.5em">indicating the reason of the failure, e.g., size too
large, message life time expiration, etc.<a class="pilcrow" href="#section-11.2.2-3.8">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-11.2.2-3.9">context:</dt>
            <dd id="section-11.2.2-3.10" style="margin-left: 1.5em">optional information associated with this message
(see <a class="xref" href="#sec_send">Section 11.1.5</a>).<a class="pilcrow" href="#section-11.2.2-3.10">Â¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
<section id="section-11.2.3">
          <h4 id="name-network-status-change-notif">
<a class="section-number selfRef" href="#section-11.2.3">11.2.3. </a><a class="section-name selfRef" href="#name-network-status-change-notif">NETWORK STATUS CHANGE Notification</a>
          </h4>
<p id="section-11.2.3-1">When a destination transport address is marked inactive (e.g., when SCTP
detects a failure) or marked active (e.g., when SCTP detects a recovery),
SCTP invokes this notification on the ULP.<a class="pilcrow" href="#section-11.2.3-1">Â¶</a></p>
<p id="section-11.2.3-2">The following is passed with the notification:<a class="pilcrow" href="#section-11.2.3-2">Â¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-11.2.3-3">
            <dt id="section-11.2.3-3.1">association id:</dt>
            <dd id="section-11.2.3-3.2" style="margin-left: 1.5em">local handle to the SCTP association.<a class="pilcrow" href="#section-11.2.3-3.2">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-11.2.3-3.3">destination transport address:</dt>
            <dd id="section-11.2.3-3.4" style="margin-left: 1.5em">this indicates the destination
transport address of the peer endpoint affected by the change.<a class="pilcrow" href="#section-11.2.3-3.4">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-11.2.3-3.5">new-status:</dt>
            <dd id="section-11.2.3-3.6" style="margin-left: 1.5em">this indicates the new status.<a class="pilcrow" href="#section-11.2.3-3.6">Â¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
<section id="section-11.2.4">
          <h4 id="name-communication-up-notificati">
<a class="section-number selfRef" href="#section-11.2.4">11.2.4. </a><a class="section-name selfRef" href="#name-communication-up-notificati">COMMUNICATION UP Notification</a>
          </h4>
<p id="section-11.2.4-1">This notification is used when SCTP becomes ready to send or receive
user messages or when a lost communication to an endpoint is restored.<a class="pilcrow" href="#section-11.2.4-1">Â¶</a></p>
<p id="section-11.2.4-2">Implementation Note: If the ASSOCIATE primitive is implemented as a
blocking function call, the association parameters are returned as a
result of the ASSOCIATE primitive itself.
In that case, the COMMUNICATION UP notification is optional at the association
initiator's side.<a class="pilcrow" href="#section-11.2.4-2">Â¶</a></p>
<p id="section-11.2.4-3">The following is passed with the notification:<a class="pilcrow" href="#section-11.2.4-3">Â¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-11.2.4-4">
            <dt id="section-11.2.4-4.1">association id:</dt>
            <dd id="section-11.2.4-4.2" style="margin-left: 1.5em">local handle to the SCTP association.<a class="pilcrow" href="#section-11.2.4-4.2">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-11.2.4-4.3">status:</dt>
            <dd id="section-11.2.4-4.4" style="margin-left: 1.5em">this indicates what type of event has occurred.<a class="pilcrow" href="#section-11.2.4-4.4">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-11.2.4-4.5">destination transport address list:</dt>
            <dd id="section-11.2.4-4.6" style="margin-left: 1.5em">the complete set of transport addresses of the peer.<a class="pilcrow" href="#section-11.2.4-4.6">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-11.2.4-4.7">outbound stream count:</dt>
            <dd id="section-11.2.4-4.8" style="margin-left: 1.5em">the maximum number of streams allowed to be used in this association by the ULP.<a class="pilcrow" href="#section-11.2.4-4.8">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-11.2.4-4.9">inbound stream count:</dt>
            <dd id="section-11.2.4-4.10" style="margin-left: 1.5em">the number of streams the peer endpoint has requested
with this association (this might not be the same number as
'outbound stream count').<a class="pilcrow" href="#section-11.2.4-4.10">Â¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
<section id="section-11.2.5">
          <h4 id="name-communication-lost-notifica">
<a class="section-number selfRef" href="#section-11.2.5">11.2.5. </a><a class="section-name selfRef" href="#name-communication-lost-notifica">COMMUNICATION LOST Notification</a>
          </h4>
<p id="section-11.2.5-1">When SCTP loses communication to an endpoint completely (e.g., via Heartbeats)
or detects that the endpoint has performed an abort operation, it invokes
this notification on the ULP.<a class="pilcrow" href="#section-11.2.5-1">Â¶</a></p>
<p id="section-11.2.5-2">The following is passed with the notification:<a class="pilcrow" href="#section-11.2.5-2">Â¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-11.2.5-3">
            <dt id="section-11.2.5-3.1">association id:</dt>
            <dd id="section-11.2.5-3.2" style="margin-left: 1.5em">local handle to the SCTP association.<a class="pilcrow" href="#section-11.2.5-3.2">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-11.2.5-3.3">status:</dt>
            <dd id="section-11.2.5-3.4" style="margin-left: 1.5em">this indicates what type of event has occurred;
the status might indicate that a failure OR a normal termination event occurred
in response to a shutdown or abort request.<a class="pilcrow" href="#section-11.2.5-3.4">Â¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-11.2.5-4">The following might be passed with the notification:<a class="pilcrow" href="#section-11.2.5-4">Â¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-11.2.5-5">
            <dt id="section-11.2.5-5.1">last-acked:</dt>
            <dd id="section-11.2.5-5.2" style="margin-left: 1.5em">the TSN last acked by that peer endpoint.<a class="pilcrow" href="#section-11.2.5-5.2">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-11.2.5-5.3">last-sent:</dt>
            <dd id="section-11.2.5-5.4" style="margin-left: 1.5em">the TSN last sent to that peer endpoint.<a class="pilcrow" href="#section-11.2.5-5.4">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-11.2.5-5.5">Upper Layer Abort Reason:</dt>
            <dd id="section-11.2.5-5.6" style="margin-left: 1.5em">the abort reason specified in case of a
user-initiated abort.<a class="pilcrow" href="#section-11.2.5-5.6">Â¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
<section id="section-11.2.6">
          <h4 id="name-communication-error-notific">
<a class="section-number selfRef" href="#section-11.2.6">11.2.6. </a><a class="section-name selfRef" href="#name-communication-error-notific">COMMUNICATION ERROR Notification</a>
          </h4>
<p id="section-11.2.6-1">When SCTP receives an ERROR chunk from its peer and decides to notify its ULP,
it can invoke this notification on the ULP.<a class="pilcrow" href="#section-11.2.6-1">Â¶</a></p>
<p id="section-11.2.6-2">The following can be passed with the notification:<a class="pilcrow" href="#section-11.2.6-2">Â¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-11.2.6-3">
            <dt id="section-11.2.6-3.1">association id:</dt>
            <dd id="section-11.2.6-3.2" style="margin-left: 1.5em">local handle to the SCTP association.<a class="pilcrow" href="#section-11.2.6-3.2">Â¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-11.2.6-3.3">error info:</dt>
            <dd id="section-11.2.6-3.4" style="margin-left: 1.5em">this indicates the type of error and optionally some additional
information received through the ERROR chunk.<a class="pilcrow" href="#section-11.2.6-3.4">Â¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
<section id="section-11.2.7">
          <h4 id="name-restart-notification">
<a class="section-number selfRef" href="#section-11.2.7">11.2.7. </a><a class="section-name selfRef" href="#name-restart-notification">RESTART Notification</a>
          </h4>
<p id="section-11.2.7-1">When SCTP detects that the peer has restarted, it might send this notification
to its ULP.<a class="pilcrow" href="#section-11.2.7-1">Â¶</a></p>
<p id="section-11.2.7-2">The following can be passed with the notification:<a class="pilcrow" href="#section-11.2.7-2">Â¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-11.2.7-3">
            <dt id="section-11.2.7-3.1">association id:</dt>
            <dd id="section-11.2.7-3.2" style="margin-left: 1.5em">local handle to the SCTP association.<a class="pilcrow" href="#section-11.2.7-3.2">Â¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
<section id="section-11.2.8">
          <h4 id="name-shutdown-complete-notificat">
<a class="section-number selfRef" href="#section-11.2.8">11.2.8. </a><a class="section-name selfRef" href="#name-shutdown-complete-notificat">SHUTDOWN COMPLETE Notification</a>
          </h4>
<p id="section-11.2.8-1">When SCTP completes the shutdown procedures
(<a class="xref" href="#sec_shutdown_of_an_association">Section 9.2</a>), this notification is passed
to the upper layer.<a class="pilcrow" href="#section-11.2.8-1">Â¶</a></p>
<p id="section-11.2.8-2">The following can be passed with the notification:<a class="pilcrow" href="#section-11.2.8-2">Â¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-11.2.8-3">
            <dt id="section-11.2.8-3.1">association id:</dt>
            <dd id="section-11.2.8-3.2" style="margin-left: 1.5em">local handle to the SCTP association.<a class="pilcrow" href="#section-11.2.8-3.2">Â¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</section>
</div>
</section>
</div>
<div id="sec_security">
<section id="section-12">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-12">12. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<div id="sec_security_objectives">
<section id="section-12.1">
        <h3 id="name-security-objectives">
<a class="section-number selfRef" href="#section-12.1">12.1. </a><a class="section-name selfRef" href="#name-security-objectives">Security Objectives</a>
        </h3>
<p id="section-12.1-1">As a common transport protocol designed to reliably carry time-sensitive
user messages, such as billing or signaling messages for telephony services,
between two networked endpoints, SCTP has the following security objectives:<a class="pilcrow" href="#section-12.1-1">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-12.1-2.1">availability of reliable and timely data transport services<a class="pilcrow" href="#section-12.1-2.1">Â¶</a>
</li>
          <li class="normal" id="section-12.1-2.2">integrity of the user-to-user information carried by SCTP<a class="pilcrow" href="#section-12.1-2.2">Â¶</a>
</li>
        </ul>
</section>
</div>
<div id="sctp_responses_to_potential_threats">
<section id="section-12.2">
        <h3 id="name-sctp-responses-to-potential">
<a class="section-number selfRef" href="#section-12.2">12.2. </a><a class="section-name selfRef" href="#name-sctp-responses-to-potential">SCTP Responses to Potential Threats</a>
        </h3>
<p id="section-12.2-1">SCTP could potentially be used in a wide variety of risk situations.
It is important for operators of systems running SCTP to analyze
their particular situations and decide on the appropriate counter-measures.<a class="pilcrow" href="#section-12.2-1">Â¶</a></p>
<p id="section-12.2-2">Operators of systems running SCTP might consult <span>[<a class="xref" href="#RFC2196">RFC2196</a>]</span> for
guidance in securing their site.<a class="pilcrow" href="#section-12.2-2">Â¶</a></p>
<section id="section-12.2.1">
          <h4 id="name-countering-insider-attacks">
<a class="section-number selfRef" href="#section-12.2.1">12.2.1. </a><a class="section-name selfRef" href="#name-countering-insider-attacks">Countering Insider Attacks</a>
          </h4>
<p id="section-12.2.1-1">The principles of <span>[<a class="xref" href="#RFC2196">RFC2196</a>]</span> might be applied to minimize the
risk of theft of information or sabotage by insiders.
Such procedures include publication of security policies, control of access at
the physical, software, and network levels, and separation of services.<a class="pilcrow" href="#section-12.2.1-1">Â¶</a></p>
</section>
<section id="section-12.2.2">
          <h4 id="name-protecting-against-data-cor">
<a class="section-number selfRef" href="#section-12.2.2">12.2.2. </a><a class="section-name selfRef" href="#name-protecting-against-data-cor">Protecting against Data Corruption in the Network</a>
          </h4>
<p id="section-12.2.2-1">Where the risk of undetected errors in datagrams delivered by the lower-layer
transport services is considered to be too great, additional integrity
protection is required.
If this additional protection were provided in the application layer, the
SCTP header would remain vulnerable to deliberate integrity attacks.
While the existing SCTP mechanisms for detection of packet replays are
considered sufficient for normal operation, stronger protections are needed to
protect SCTP when the operating environment contains significant risk of
deliberate attacks from a sophisticated adversary.<a class="pilcrow" href="#section-12.2.2-1">Â¶</a></p>
<p id="section-12.2.2-2">The SCTP Authentication extension SCTP-AUTH <span>[<a class="xref" href="#RFC4895">RFC4895</a>]</span> <span class="bcp14">MAY</span> be
used when the threat environment requires stronger integrity protections
but does not require confidentiality.<a class="pilcrow" href="#section-12.2.2-2">Â¶</a></p>
</section>
<section id="section-12.2.3">
          <h4 id="name-protecting-confidentiality">
<a class="section-number selfRef" href="#section-12.2.3">12.2.3. </a><a class="section-name selfRef" href="#name-protecting-confidentiality">Protecting Confidentiality</a>
          </h4>
<p id="section-12.2.3-1">In most cases, the risk of breach of confidentiality applies to the
signaling data payload, not to the SCTP or lower-layer protocol overheads.
If that is true, encryption of the SCTP user data only might be considered.
As with the supplementary checksum service, user data encryption <span class="bcp14">MAY</span> be
performed by the SCTP user application.
<span>[<a class="xref" href="#RFC6083">RFC6083</a>]</span> <span class="bcp14">MAY</span> be used for this.
Alternately, the user application <span class="bcp14">MAY</span> use an implementation-specific API to
request that the IP Encapsulating Security Payload (ESP)
<span>[<a class="xref" href="#RFC4303">RFC4303</a>]</span> be used to provide confidentiality and integrity.<a class="pilcrow" href="#section-12.2.3-1">Â¶</a></p>
<p id="section-12.2.3-2">Particularly for mobile users, the requirement for confidentiality might
include the masking of IP addresses and ports.
In this case, ESP <span class="bcp14">SHOULD</span> be used instead of application-level confidentiality.
If ESP is used to protect confidentiality of SCTP traffic, an ESP cryptographic
transform that includes cryptographic integrity protection <span class="bcp14">MUST</span> be used, because,
if there is a confidentiality threat, there will also be a strong integrity
threat.<a class="pilcrow" href="#section-12.2.3-2">Â¶</a></p>
<p id="section-12.2.3-3">Regardless of where confidentiality is provided, the Internet Key
Exchange Protocol version 2 (IKEv2) <span>[<a class="xref" href="#RFC7296">RFC7296</a>]</span> <span class="bcp14">SHOULD</span> be used for
key management of ESP.<a class="pilcrow" href="#section-12.2.3-3">Â¶</a></p>
<p id="section-12.2.3-4">Operators might consult <span>[<a class="xref" href="#RFC4301">RFC4301</a>]</span> for more information on the
security services available at and immediately above the Internet Protocol
layer.<a class="pilcrow" href="#section-12.2.3-4">Â¶</a></p>
</section>
<section id="section-12.2.4">
          <h4 id="name-protecting-against-blind-de">
<a class="section-number selfRef" href="#section-12.2.4">12.2.4. </a><a class="section-name selfRef" href="#name-protecting-against-blind-de">Protecting against Blind Denial-of-Service Attacks</a>
          </h4>
<p id="section-12.2.4-1">A blind attack is one where the attacker is unable to intercept or otherwise
see the content of data flows passing to and from the target SCTP node.
Blind denial-of-service attacks can take the form of flooding, masquerade,
or improper monopolization of services.<a class="pilcrow" href="#section-12.2.4-1">Â¶</a></p>
<section id="section-12.2.4.1">
            <h5 id="name-flooding">
<a class="section-number selfRef" href="#section-12.2.4.1">12.2.4.1. </a><a class="section-name selfRef" href="#name-flooding">Flooding</a>
            </h5>
<p id="section-12.2.4.1-1">The objective of flooding is to cause loss of service and incorrect
behavior at target systems through resource exhaustion, interference
with legitimate transactions, and exploitation of buffer-related
software bugs.
Flooding can be directed either at the SCTP node or at resources in the
intervening IP Access Links or the Internet.
Where the latter entities are the target, flooding will manifest itself as loss
of network services, including potentially the breach of any firewalls in
place.<a class="pilcrow" href="#section-12.2.4.1-1">Â¶</a></p>
<p id="section-12.2.4.1-2">In general, protection against flooding begins at the equipment
design level, where it includes measures such as:<a class="pilcrow" href="#section-12.2.4.1-2">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-12.2.4.1-3.1">
                <p id="section-12.2.4.1-3.1.1">avoiding commitment of limited resources before determining that the request
for service is legitimate.<a class="pilcrow" href="#section-12.2.4.1-3.1.1">Â¶</a></p>
</li>
              <li class="normal" id="section-12.2.4.1-3.2">
                <p id="section-12.2.4.1-3.2.1">giving priority to completion of processing in progress over the acceptance
of new work.<a class="pilcrow" href="#section-12.2.4.1-3.2.1">Â¶</a></p>
</li>
              <li class="normal" id="section-12.2.4.1-3.3">
                <p id="section-12.2.4.1-3.3.1">identification and removal of duplicate or stale queued requests for
service.<a class="pilcrow" href="#section-12.2.4.1-3.3.1">Â¶</a></p>
</li>
              <li class="normal" id="section-12.2.4.1-3.4">
                <p id="section-12.2.4.1-3.4.1">not responding to unexpected packets sent to non-unicast addresses.<a class="pilcrow" href="#section-12.2.4.1-3.4.1">Â¶</a></p>
</li>
            </ul>
<p id="section-12.2.4.1-4">Network equipment is expected to be capable of generating an alarm and log if a
suspicious increase in traffic occurs.
The log provides information, such as the identity of the incoming link
and source address(es) used, which will help the network or SCTP system operator
to take protective measures.
Procedures are expected to be in place for the operator to act on such alarms if a clear
pattern of abuse emerges.<a class="pilcrow" href="#section-12.2.4.1-4">Â¶</a></p>
<p id="section-12.2.4.1-5">The design of SCTP is resistant to flooding attacks, particularly in its use
of a four-way startup handshake, its use of a cookie to defer commitment of
resources at the responding SCTP node until the handshake is completed, and its
use of a Verification Tag to prevent insertion of extraneous packets into the
flow of an established association.<a class="pilcrow" href="#section-12.2.4.1-5">Â¶</a></p>
<p id="section-12.2.4.1-6">ESP might be useful in reducing the risk of certain kinds of
denial-of-service attacks.<a class="pilcrow" href="#section-12.2.4.1-6">Â¶</a></p>
<p id="section-12.2.4.1-7">Support for the Host Name Address parameter has been removed from the
protocol.
Endpoints receiving INIT or INIT ACK chunks containing the Host Name Address
parameter <span class="bcp14">MUST</span> send an ABORT chunk in response and <span class="bcp14">MAY</span> include an
"Unresolvable Address" error cause.<a class="pilcrow" href="#section-12.2.4.1-7">Â¶</a></p>
</section>
<section id="section-12.2.4.2">
            <h5 id="name-blind-masquerade">
<a class="section-number selfRef" href="#section-12.2.4.2">12.2.4.2. </a><a class="section-name selfRef" href="#name-blind-masquerade">Blind Masquerade</a>
            </h5>
<p id="section-12.2.4.2-1">Masquerade can be used to deny service in several ways:<a class="pilcrow" href="#section-12.2.4.2-1">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-12.2.4.2-2.1">
                <p id="section-12.2.4.2-2.1.1">by tying up resources at the target SCTP node to which the impersonated node
has limited access.
For example, the target node can by policy permit a maximum of one
SCTP association with the impersonated SCTP node.
The masquerading attacker can attempt to establish an association purporting to
come from the impersonated node so that the latter cannot do so when it requires
it.<a class="pilcrow" href="#section-12.2.4.2-2.1.1">Â¶</a></p>
</li>
              <li class="normal" id="section-12.2.4.2-2.2">
                <p id="section-12.2.4.2-2.2.1">by deliberately allowing the impersonation to be detected, thereby
provoking counter-measures that cause the impersonated node to be locked out of
the target SCTP node.<a class="pilcrow" href="#section-12.2.4.2-2.2.1">Â¶</a></p>
</li>
              <li class="normal" id="section-12.2.4.2-2.3">
                <p id="section-12.2.4.2-2.3.1">by interfering with an established association by inserting extraneous
content such as a SHUTDOWN chunk.<a class="pilcrow" href="#section-12.2.4.2-2.3.1">Â¶</a></p>
</li>
            </ul>
<p id="section-12.2.4.2-3">SCTP reduces the risk of blind masquerade attacks through IP spoofing
by use of the four-way startup handshake.
Because the initial exchange is memoryless, no lockout mechanism is triggered
by blind masquerade attacks.
In addition, the packet containing the INIT ACK chunk with the State Cookie
is transmitted back to the IP address from which it received the packet
containing the INIT chunk.
Thus, the attacker would not receive the INIT ACK chunk containing the
State Cookie.
SCTP protects against insertion of extraneous packets into the flow of an
established association by use of the Verification Tag.<a class="pilcrow" href="#section-12.2.4.2-3">Â¶</a></p>
<p id="section-12.2.4.2-4">Logging of received INIT chunks and abnormalities, such as unexpected
INIT ACK chunks, might be considered as a way to detect patterns of hostile
activity.
However, the potential usefulness of such logging has to be weighed against the
increased SCTP startup processing it implies, rendering the SCTP node more
vulnerable to flooding attacks.
Logging is pointless without the establishment of operating procedures to
review and analyze the logs on a routine basis.<a class="pilcrow" href="#section-12.2.4.2-4">Â¶</a></p>
</section>
<section id="section-12.2.4.3">
            <h5 id="name-improper-monopolization-of-">
<a class="section-number selfRef" href="#section-12.2.4.3">12.2.4.3. </a><a class="section-name selfRef" href="#name-improper-monopolization-of-">Improper Monopolization of Services</a>
            </h5>
<p id="section-12.2.4.3-1">Attacks under this heading are performed openly and legitimately by the
attacker.
They are directed against fellow users of the target SCTP node or of the shared
resources between the attacker and the target node.
Possible attacks include the opening of a large number of associations between
the attacker's node and the target or transfer of large volumes of information
within a legitimately established association.<a class="pilcrow" href="#section-12.2.4.3-1">Â¶</a></p>
<p id="section-12.2.4.3-2">Policy limits are expected to be placed on the number of associations per
adjoining SCTP node.
SCTP user applications are expected to be capable of detecting large volumes of
illegitimate or "no-op" messages within a given association and either logging
or terminating the association as a result, based on local policy.<a class="pilcrow" href="#section-12.2.4.3-2">Â¶</a></p>
</section>
</section>
</section>
</div>
<div id="sec_sctp_interaction_with_firewalls">
<section id="section-12.3">
        <h3 id="name-sctp-interactions-with-fire">
<a class="section-number selfRef" href="#section-12.3">12.3. </a><a class="section-name selfRef" href="#name-sctp-interactions-with-fire">SCTP Interactions with Firewalls</a>
        </h3>
<p id="section-12.3-1">It is helpful for some firewalls if they can inspect just the first
fragment of a fragmented SCTP packet and unambiguously determine whether it
corresponds to an INIT chunk (for further information, please refer to
<span>[<a class="xref" href="#RFC1858">RFC1858</a>]</span>).
Accordingly, we stress the requirements, as stated in
<a class="xref" href="#sec_sctp_common_header_field_desriptions">Section 3.1</a>, that
(1) an INIT chunk <span class="bcp14">MUST NOT</span> be bundled with any other chunk in a packet and
(2) a packet containing an INIT chunk <span class="bcp14">MUST</span> have a zero Verification Tag.
The receiver of an INIT chunk <span class="bcp14">MUST</span> silently discard the INIT chunk and all
further chunks if the INIT chunk is bundled with other chunks or the packet
has a non-zero Verification Tag.<a class="pilcrow" href="#section-12.3-1">Â¶</a></p>
</section>
</div>
<div id="sec_protection_of_non_sctp_capable_hosts">
<section id="section-12.4">
        <h3 id="name-protection-of-non-sctp-capa">
<a class="section-number selfRef" href="#section-12.4">12.4. </a><a class="section-name selfRef" href="#name-protection-of-non-sctp-capa">Protection of Non-SCTP-capable Hosts</a>
        </h3>
<p id="section-12.4-1">To provide a non-SCTP-capable host with the same level of protection
against attacks as for SCTP-capable ones, all SCTP implementations <span class="bcp14">MUST</span>
implement the ICMP handling described in <a class="xref" href="#sec_icmp">Section 10</a>.<a class="pilcrow" href="#section-12.4-1">Â¶</a></p>
<p id="section-12.4-2">When an SCTP implementation receives a packet containing multiple control or
DATA chunks and the processing of the packet would result in sending multiple
chunks in response, the sender of the response chunk(s) <span class="bcp14">MUST NOT</span> send more than
one packet containing chunks other than DATA chunks.
This requirement protects the network for triggering a packet burst in response
to a single packet.
If bundling is supported, multiple response chunks that fit into a single
packet <span class="bcp14">MAY</span> be bundled together into one single response packet.
If bundling is not supported, then the sender <span class="bcp14">MUST NOT</span> send more than one
response chunk and <span class="bcp14">MUST</span> discard all other responses.
Note that this rule does not apply to a SACK chunk, since a SACK chunk is,
in itself, a response to DATA chunks, and a SACK chunk does not require a
response of more DATA chunks.<a class="pilcrow" href="#section-12.4-2">Â¶</a></p>
<p id="section-12.4-3">An SCTP implementation <span class="bcp14">MUST</span> abort the association if it receives a SACK
chunk acknowledging a TSN that has not been sent.<a class="pilcrow" href="#section-12.4-3">Â¶</a></p>
<p id="section-12.4-4">An SCTP implementation that receives an INIT chunk that would require a large
packet in response, due to the inclusion of multiple "Unrecognized Parameter"
parameters, <span class="bcp14">MAY</span> (at its discretion) elect to omit some or all of the
"Unrecognized Parameter" parameters to reduce the size of the INIT ACK chunk.
Due to a combination of the size of the State Cookie parameter and the number of
addresses a receiver of an INIT chunk indicates to a peer, it is always
possible that the INIT ACK chunk will be larger than the original INIT chunk.
An SCTP implementation <span class="bcp14">SHOULD</span> attempt to make the INIT ACK chunk as small as
possible to reduce the possibility of byte amplification attacks.<a class="pilcrow" href="#section-12.4-4">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec_network_management">
<section id="section-13">
      <h2 id="name-network-management-consider">
<a class="section-number selfRef" href="#section-13">13. </a><a class="section-name selfRef" href="#name-network-management-consider">Network Management Considerations</a>
      </h2>
<p id="section-13-1">The MIB module for SCTP defined in <span>[<a class="xref" href="#RFC3873">RFC3873</a>]</span> applies for the
version of the protocol specified in this document.<a class="pilcrow" href="#section-13-1">Â¶</a></p>
</section>
</div>
<div id="sec_tcb_parameter">
<section id="section-14">
      <h2 id="name-recommended-transmission-co">
<a class="section-number selfRef" href="#section-14">14. </a><a class="section-name selfRef" href="#name-recommended-transmission-co">Recommended Transmission Control Block (TCB) Parameters</a>
      </h2>
<p id="section-14-1">This section details a set of parameters that are expected to be contained
within the TCB for an implementation.
This section is for illustrative purposes and is not considered to be
requirements on an implementation or as an exhaustive list of all parameters
inside an SCTP TCB.
Each implementation might need its own additional parameters for optimization.<a class="pilcrow" href="#section-14-1">Â¶</a></p>
<div id="sec_parameters_necessary_for_the_sctp_instance">
<section id="section-14.1">
        <h3 id="name-parameters-necessary-for-th">
<a class="section-number selfRef" href="#section-14.1">14.1. </a><a class="section-name selfRef" href="#name-parameters-necessary-for-th">Parameters Necessary for the SCTP Instance</a>
        </h3>
<span class="break"></span><dl class="dlParallel" id="section-14.1-1">
          <dt id="section-14.1-1.1">Associations:</dt>
          <dd id="section-14.1-1.2" style="margin-left: 7.5em">A list of current associations and mappings to the data consumers for each
association.
This might be in the form of a hash table or other implementation-dependent
structure.
The data consumers might be process identification information, such as file
descriptors, named pipe pointer, or table pointers dependent on how SCTP is
implemented.<a class="pilcrow" href="#section-14.1-1.2">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-14.1-1.3">Secret Key:</dt>
          <dd id="section-14.1-1.4" style="margin-left: 7.5em">A secret key used by this endpoint to compute the MAC.
This <span class="bcp14">SHOULD</span> be a cryptographic quality random number with a sufficient length.
Discussion in <span>[<a class="xref" href="#RFC4086">RFC4086</a>]</span> can be helpful in selection of the
key.<a class="pilcrow" href="#section-14.1-1.4">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-14.1-1.5">Address List:</dt>
          <dd id="section-14.1-1.6" style="margin-left: 7.5em">The list of IP addresses that this instance has bound.
This information is passed to one's peer(s) in INIT and INIT ACK chunks.<a class="pilcrow" href="#section-14.1-1.6">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-14.1-1.7">SCTP Port:</dt>
          <dd id="section-14.1-1.8" style="margin-left: 7.5em">The local SCTP port number to which the endpoint is bound.<a class="pilcrow" href="#section-14.1-1.8">Â¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec_parameters_necessary_per_association">
<section id="section-14.2">
        <h3 id="name-parameters-necessary-per-as">
<a class="section-number selfRef" href="#section-14.2">14.2. </a><a class="section-name selfRef" href="#name-parameters-necessary-per-as">Parameters Necessary per Association (i.e., the TCB)</a>
        </h3>
<span class="break"></span><dl class="dlParallel" id="section-14.2-1">
          <dt id="section-14.2-1.1">Peer Verification Tag:</dt>
          <dd id="section-14.2-1.2" style="margin-left: 7.5em">Tag value to be sent in every packet and is received in the INIT or
INIT ACK chunk.<a class="pilcrow" href="#section-14.2-1.2">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-14.2-1.3">My Verification Tag:</dt>
          <dd id="section-14.2-1.4" style="margin-left: 7.5em">Tag expected in every inbound packet and sent in the INIT or INIT ACK chunk.<a class="pilcrow" href="#section-14.2-1.4">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-14.2-1.5">State:</dt>
          <dd id="section-14.2-1.6" style="margin-left: 7.5em">
            <p id="section-14.2-1.6.1">COOKIE-WAIT, COOKIE-ECHOED, ESTABLISHED, SHUTDOWN-PENDING, SHUTDOWN-SENT,
SHUTDOWN-RECEIVED, SHUTDOWN-ACK-SENT.<a class="pilcrow" href="#section-14.2-1.6.1">Â¶</a></p>
<p id="section-14.2-1.6.2">Note: No "CLOSED" state is illustrated, since, if an association is "CLOSED",
its TCB <span class="bcp14">SHOULD</span> be removed.<a class="pilcrow" href="#section-14.2-1.6.2">Â¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-14.2-1.7">Peer Transport Address List:</dt>
          <dd id="section-14.2-1.8" style="margin-left: 7.5em">A list of SCTP transport addresses to which the peer is bound.
This information is derived from the INIT or INIT ACK chunk and is used to
associate an inbound packet with a given association.
Normally, this information is hashed or keyed for quick lookup and access
of the TCB.<a class="pilcrow" href="#section-14.2-1.8">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-14.2-1.9">Primary Path:</dt>
          <dd id="section-14.2-1.10" style="margin-left: 7.5em">This is the current primary destination transport address of the peer endpoint.
It might also specify a source transport address on this endpoint.<a class="pilcrow" href="#section-14.2-1.10">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-14.2-1.11">Overall Error Count:</dt>
          <dd id="section-14.2-1.12" style="margin-left: 7.5em">The overall association error count.<a class="pilcrow" href="#section-14.2-1.12">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-14.2-1.13">Overall Error Threshold:</dt>
          <dd id="section-14.2-1.14" style="margin-left: 7.5em">The threshold for this association that, if the Overall Error Count reaches, will
cause this association to be torn down.<a class="pilcrow" href="#section-14.2-1.14">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-14.2-1.15">Peer Rwnd:</dt>
          <dd id="section-14.2-1.16" style="margin-left: 7.5em">Current calculated value of the peer's rwnd.<a class="pilcrow" href="#section-14.2-1.16">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-14.2-1.17">Next TSN:</dt>
          <dd id="section-14.2-1.18" style="margin-left: 7.5em">The next TSN number to be assigned to a new DATA chunk.
This is sent in the INIT or INIT ACK chunk to the peer and incremented each
time a DATA chunk is assigned a TSN (normally, just prior to transmit or during
fragmentation).<a class="pilcrow" href="#section-14.2-1.18">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-14.2-1.19">Last Rcvd TSN:</dt>
          <dd id="section-14.2-1.20" style="margin-left: 7.5em">This is the last TSN received in sequence.
This value is set initially by taking the peer's Initial TSN, received in the
INIT or INIT ACK chunk, and subtracting one from it.<a class="pilcrow" href="#section-14.2-1.20">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-14.2-1.21">Mapping Array:</dt>
          <dd id="section-14.2-1.22" style="margin-left: 7.5em">An array of bits or bytes indicating which out-of-order TSNs have been
received (relative to the Last Rcvd TSN).
If no gaps exist, i.e., no out-of-order packets have been received, this
array will be set to all zero.
This structure might be in the form of a circular buffer or bit array.<a class="pilcrow" href="#section-14.2-1.22">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-14.2-1.23">Ack State:</dt>
          <dd id="section-14.2-1.24" style="margin-left: 7.5em">This flag indicates if the next received packet is to be responded to with
a SACK chunk.
This is initialized to 0.
When a packet is received, it is incremented.
If this value reaches 2 or more, a SACK chunk is sent and the value is reset
to 0.
Note: This is used only when no DATA chunks are received out of order.
When DATA chunks are out of order, SACK chunks are not delayed
(see <a class="xref" href="#sec_user_data_transfer">Section 6</a>).<a class="pilcrow" href="#section-14.2-1.24">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-14.2-1.25">Inbound Streams:</dt>
          <dd id="section-14.2-1.26" style="margin-left: 7.5em">An array of structures to track the inbound streams, normally including the
next sequence number expected and possibly the stream number.<a class="pilcrow" href="#section-14.2-1.26">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-14.2-1.27">Outbound Streams:</dt>
          <dd id="section-14.2-1.28" style="margin-left: 7.5em">An array of structures to track the outbound streams, normally including the
next sequence number to be sent on the stream.<a class="pilcrow" href="#section-14.2-1.28">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-14.2-1.29">Reasm Queue:</dt>
          <dd id="section-14.2-1.30" style="margin-left: 7.5em">A reassembly queue.<a class="pilcrow" href="#section-14.2-1.30">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-14.2-1.31">Receive Buffer:</dt>
          <dd id="section-14.2-1.32" style="margin-left: 7.5em">A buffer to store received user data that has not been delivered to the
upper layer.<a class="pilcrow" href="#section-14.2-1.32">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-14.2-1.33">Local Transport Address List:</dt>
          <dd id="section-14.2-1.34" style="margin-left: 7.5em">The list of local IP addresses bound in to this association.<a class="pilcrow" href="#section-14.2-1.34">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-14.2-1.35">Association Maximum DATA Chunk Size:</dt>
          <dd id="section-14.2-1.36" style="margin-left: 7.5em">The smallest Path Maximum DATA Chunk Size of all destination addresses.<a class="pilcrow" href="#section-14.2-1.36">Â¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec_per_transport_address_data">
<section id="section-14.3">
        <h3 id="name-per-transport-address-data">
<a class="section-number selfRef" href="#section-14.3">14.3. </a><a class="section-name selfRef" href="#name-per-transport-address-data">Per Transport Address Data</a>
        </h3>
<p id="section-14.3-1">For each destination transport address in the peer's address list
derived from the INIT or INIT ACK chunk, a number of data elements need to be
maintained, including:<a class="pilcrow" href="#section-14.3-1">Â¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-14.3-2">
          <dt id="section-14.3-2.1">Error Count:</dt>
          <dd id="section-14.3-2.2" style="margin-left: 7.5em">The current error count for this destination.<a class="pilcrow" href="#section-14.3-2.2">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-14.3-2.3">Error Threshold:</dt>
          <dd id="section-14.3-2.4" style="margin-left: 7.5em">Current error threshold for this destination, i.e., what value marks the
destination down if error count reaches this value.<a class="pilcrow" href="#section-14.3-2.4">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-14.3-2.5">cwnd:</dt>
          <dd id="section-14.3-2.6" style="margin-left: 7.5em">The current congestion window.<a class="pilcrow" href="#section-14.3-2.6">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-14.3-2.7">ssthresh:</dt>
          <dd id="section-14.3-2.8" style="margin-left: 7.5em">The current ssthresh value.<a class="pilcrow" href="#section-14.3-2.8">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-14.3-2.9">RTO:</dt>
          <dd id="section-14.3-2.10" style="margin-left: 7.5em">The current retransmission timeout value.<a class="pilcrow" href="#section-14.3-2.10">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-14.3-2.11">SRTT:</dt>
          <dd id="section-14.3-2.12" style="margin-left: 7.5em">The current smoothed round-trip time.<a class="pilcrow" href="#section-14.3-2.12">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-14.3-2.13">RTTVAR:</dt>
          <dd id="section-14.3-2.14" style="margin-left: 7.5em">The current RTT variation.<a class="pilcrow" href="#section-14.3-2.14">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-14.3-2.15">partial bytes acked:</dt>
          <dd id="section-14.3-2.16" style="margin-left: 7.5em">The tracking method for increase of cwnd when in congestion avoidance mode
(see <a class="xref" href="#sec_congestion_avoidance">Section 7.2.2</a>).<a class="pilcrow" href="#section-14.3-2.16">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-14.3-2.17">state:</dt>
          <dd id="section-14.3-2.18" style="margin-left: 7.5em">The current state of this destination, i.e., DOWN, UP, ALLOW-HEARTBEAT,
NO-HEARTBEAT, etc.<a class="pilcrow" href="#section-14.3-2.18">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-14.3-2.19">PMTU:</dt>
          <dd id="section-14.3-2.20" style="margin-left: 7.5em">The current known PMTU.<a class="pilcrow" href="#section-14.3-2.20">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-14.3-2.21">PMDCS:</dt>
          <dd id="section-14.3-2.22" style="margin-left: 7.5em">The current known PMDCS.<a class="pilcrow" href="#section-14.3-2.22">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-14.3-2.23">Per Destination Timer:</dt>
          <dd id="section-14.3-2.24" style="margin-left: 7.5em">A timer used by each destination.<a class="pilcrow" href="#section-14.3-2.24">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-14.3-2.25">RTO-Pending:</dt>
          <dd id="section-14.3-2.26" style="margin-left: 7.5em">A flag used to track if one of the DATA chunks sent to this address is
currently being used to compute an RTT.
If this flag is 0, the next DATA chunk sent to this destination is expected to
be used to compute an RTT and this flag is expected to be set.
Every time the RTT calculation completes (i.e., the DATA chunk is acknowledged),
clear this flag.<a class="pilcrow" href="#section-14.3-2.26">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-14.3-2.27">last-time:</dt>
          <dd id="section-14.3-2.28" style="margin-left: 7.5em">The time to which this destination was last sent.
This can be used to determine if the sending of a HEARTBEAT chunk is needed.<a class="pilcrow" href="#section-14.3-2.28">Â¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec_general_parameters_needed">
<section id="section-14.4">
        <h3 id="name-general-parameters-needed">
<a class="section-number selfRef" href="#section-14.4">14.4. </a><a class="section-name selfRef" href="#name-general-parameters-needed">General Parameters Needed</a>
        </h3>
<span class="break"></span><dl class="dlParallel" id="section-14.4-1">
          <dt id="section-14.4-1.1">Out Queue:</dt>
          <dd id="section-14.4-1.2" style="margin-left: 1.5em">A queue of outbound DATA chunks.<a class="pilcrow" href="#section-14.4-1.2">Â¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-14.4-1.3">In Queue:</dt>
          <dd id="section-14.4-1.4" style="margin-left: 1.5em">A queue of inbound DATA chunks.<a class="pilcrow" href="#section-14.4-1.4">Â¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="sec_iana">
<section id="section-15">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-15">15. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<p id="section-15-1">This document defines five registries that IANA maintains:<a class="pilcrow" href="#section-15-1">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-15-2.1">
          <p id="section-15-2.1.1">through definition of additional chunk types,<a class="pilcrow" href="#section-15-2.1.1">Â¶</a></p>
</li>
        <li class="normal" id="section-15-2.2">
          <p id="section-15-2.2.1">through definition of additional chunk flags,<a class="pilcrow" href="#section-15-2.2.1">Â¶</a></p>
</li>
        <li class="normal" id="section-15-2.3">
          <p id="section-15-2.3.1">through definition of additional parameter types,<a class="pilcrow" href="#section-15-2.3.1">Â¶</a></p>
</li>
        <li class="normal" id="section-15-2.4">
          <p id="section-15-2.4.1">through definition of additional cause codes within ERROR chunks, or<a class="pilcrow" href="#section-15-2.4.1">Â¶</a></p>
</li>
        <li class="normal" id="section-15-2.5">
          <p id="section-15-2.5.1">through definition of additional payload protocol identifiers.<a class="pilcrow" href="#section-15-2.5.1">Â¶</a></p>
</li>
      </ul>
<p id="section-15-3">IANA has performed the following updates for the above five
registries:<a class="pilcrow" href="#section-15-3">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-15-4.1">
          <p id="section-15-4.1.1">In the "Chunk Types" registry, IANA has replaced the registry
reference to <span>[<a class="xref" href="#RFC4960">RFC4960</a>]</span> and <span>[<a class="xref" href="#RFC6096">RFC6096</a>]</span> with a
reference to this document.<a class="pilcrow" href="#section-15-4.1.1">Â¶</a></p>
<p id="section-15-4.1.2">In addition, in the Notes section, the reference to <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6096#section-3.2">Section 3.2</a> of [<a class="xref" href="#RFC6096">RFC6096</a>]</span> has been updated with a reference to
<a class="xref" href="#sec_ietf_chunk_flags_registration">Section 15.2</a> of this document.<a class="pilcrow" href="#section-15-4.1.2">Â¶</a></p>
<p id="section-15-4.1.3">Finally, each reference to <span>[<a class="xref" href="#RFC4960">RFC4960</a>]</span> has been replaced with a reference to
this document for the following chunk types:<a class="pilcrow" href="#section-15-4.1.3">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-15-4.1.4.1">
              <p id="section-15-4.1.4.1.1">Payload Data (DATA)<a class="pilcrow" href="#section-15-4.1.4.1.1">Â¶</a></p>
</li>
            <li class="normal" id="section-15-4.1.4.2">
              <p id="section-15-4.1.4.2.1">Initiation (INIT)<a class="pilcrow" href="#section-15-4.1.4.2.1">Â¶</a></p>
</li>
            <li class="normal" id="section-15-4.1.4.3">
              <p id="section-15-4.1.4.3.1">Initiation Acknowledgement (INIT ACK)<a class="pilcrow" href="#section-15-4.1.4.3.1">Â¶</a></p>
</li>
            <li class="normal" id="section-15-4.1.4.4">
              <p id="section-15-4.1.4.4.1">Selective Acknowledgement (SACK)<a class="pilcrow" href="#section-15-4.1.4.4.1">Â¶</a></p>
</li>
            <li class="normal" id="section-15-4.1.4.5">
              <p id="section-15-4.1.4.5.1">Heartbeat Request (HEARTBEAT)<a class="pilcrow" href="#section-15-4.1.4.5.1">Â¶</a></p>
</li>
            <li class="normal" id="section-15-4.1.4.6">
              <p id="section-15-4.1.4.6.1">Heartbeat Acknowledgement (HEARTBEAT ACK)<a class="pilcrow" href="#section-15-4.1.4.6.1">Â¶</a></p>
</li>
            <li class="normal" id="section-15-4.1.4.7">
              <p id="section-15-4.1.4.7.1">Abort (ABORT)<a class="pilcrow" href="#section-15-4.1.4.7.1">Â¶</a></p>
</li>
            <li class="normal" id="section-15-4.1.4.8">
              <p id="section-15-4.1.4.8.1">Shutdown (SHUTDOWN)<a class="pilcrow" href="#section-15-4.1.4.8.1">Â¶</a></p>
</li>
            <li class="normal" id="section-15-4.1.4.9">
              <p id="section-15-4.1.4.9.1">Shutdown Acknowledgement (SHUTDOWN ACK)<a class="pilcrow" href="#section-15-4.1.4.9.1">Â¶</a></p>
</li>
            <li class="normal" id="section-15-4.1.4.10">
              <p id="section-15-4.1.4.10.1">Operation Error (ERROR)<a class="pilcrow" href="#section-15-4.1.4.10.1">Â¶</a></p>
</li>
            <li class="normal" id="section-15-4.1.4.11">
              <p id="section-15-4.1.4.11.1">State Cookie (COOKIE ECHO)<a class="pilcrow" href="#section-15-4.1.4.11.1">Â¶</a></p>
</li>
            <li class="normal" id="section-15-4.1.4.12">
              <p id="section-15-4.1.4.12.1">Cookie Acknowledgement (COOKIE ACK)<a class="pilcrow" href="#section-15-4.1.4.12.1">Â¶</a></p>
</li>
            <li class="normal" id="section-15-4.1.4.13">
              <p id="section-15-4.1.4.13.1">Reserved for Explicit Congestion Notification Echo (ECNE)<a class="pilcrow" href="#section-15-4.1.4.13.1">Â¶</a></p>
</li>
            <li class="normal" id="section-15-4.1.4.14">
              <p id="section-15-4.1.4.14.1">Reserved for Congestion Window Reduced (CWR)<a class="pilcrow" href="#section-15-4.1.4.14.1">Â¶</a></p>
</li>
            <li class="normal" id="section-15-4.1.4.15">
              <p id="section-15-4.1.4.15.1">Shutdown Complete (SHUTDOWN COMPLETE)<a class="pilcrow" href="#section-15-4.1.4.15.1">Â¶</a></p>
</li>
            <li class="normal" id="section-15-4.1.4.16">
              <p id="section-15-4.1.4.16.1">Reserved for IETF-defined Chunk Extensions<a class="pilcrow" href="#section-15-4.1.4.16.1">Â¶</a></p>
</li>
          </ul>
</li>
        <li class="normal" id="section-15-4.2">
          <p id="section-15-4.2.1">In the "Chunk Parameter Types" registry, IANA has replaced
the registry reference to <span>[<a class="xref" href="#RFC4960">RFC4960</a>]</span> with a reference to this document.<a class="pilcrow" href="#section-15-4.2.1">Â¶</a></p>
<p id="section-15-4.2.2">IANA has changed the name of the "Unrecognized Parameters" chunk parameter type to
"Unrecognized Parameter" in the "Chunk Parameter Types" registry.<a class="pilcrow" href="#section-15-4.2.2">Â¶</a></p>
<p id="section-15-4.2.3">In addition, each reference to <span>[<a class="xref" href="#RFC4960">RFC4960</a>]</span> has been replaced with a reference to
this document for the following chunk parameter types:<a class="pilcrow" href="#section-15-4.2.3">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-15-4.2.4.1">
              <p id="section-15-4.2.4.1.1">Heartbeat Info<a class="pilcrow" href="#section-15-4.2.4.1.1">Â¶</a></p>
</li>
            <li class="normal" id="section-15-4.2.4.2">
              <p id="section-15-4.2.4.2.1">IPv4 Address<a class="pilcrow" href="#section-15-4.2.4.2.1">Â¶</a></p>
</li>
            <li class="normal" id="section-15-4.2.4.3">
              <p id="section-15-4.2.4.3.1">IPv6 Address<a class="pilcrow" href="#section-15-4.2.4.3.1">Â¶</a></p>
</li>
            <li class="normal" id="section-15-4.2.4.4">
              <p id="section-15-4.2.4.4.1">State Cookie<a class="pilcrow" href="#section-15-4.2.4.4.1">Â¶</a></p>
</li>
            <li class="normal" id="section-15-4.2.4.5">
              <p id="section-15-4.2.4.5.1">Unrecognized Parameter<a class="pilcrow" href="#section-15-4.2.4.5.1">Â¶</a></p>
</li>
            <li class="normal" id="section-15-4.2.4.6">
              <p id="section-15-4.2.4.6.1">Cookie Preservative<a class="pilcrow" href="#section-15-4.2.4.6.1">Â¶</a></p>
</li>
            <li class="normal" id="section-15-4.2.4.7">
              <p id="section-15-4.2.4.7.1">Host Name Address<a class="pilcrow" href="#section-15-4.2.4.7.1">Â¶</a></p>
</li>
            <li class="normal" id="section-15-4.2.4.8">
              <p id="section-15-4.2.4.8.1">Supported Address Types<a class="pilcrow" href="#section-15-4.2.4.8.1">Â¶</a></p>
</li>
          </ul>
<p id="section-15-4.2.5">IANA has added a reference to this document for the following chunk parameter type:<a class="pilcrow" href="#section-15-4.2.5">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-15-4.2.6.1">
              <p id="section-15-4.2.6.1.1">Reserved for ECN Capable (0x8000)<a class="pilcrow" href="#section-15-4.2.6.1.1">Â¶</a></p>
</li>
          </ul>
<p id="section-15-4.2.7">Also, IANA has added the value 65535 to be reserved for IETF-defined extensions.<a class="pilcrow" href="#section-15-4.2.7">Â¶</a></p>
</li>
        <li class="normal" id="section-15-4.3">
          <p id="section-15-4.3.1">In the "Chunk Flags" registry, IANA replaced
the registry reference to <span>[<a class="xref" href="#RFC6096">RFC6096</a>]</span> with a reference to this document.<a class="pilcrow" href="#section-15-4.3.1">Â¶</a></p>
<p id="section-15-4.3.2">In addition, each reference to <span>[<a class="xref" href="#RFC4960">RFC4960</a>]</span> has been replaced with a reference to
this document for the following DATA chunk flags:<a class="pilcrow" href="#section-15-4.3.2">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-15-4.3.3.1">
              <p id="section-15-4.3.3.1.1">E bit<a class="pilcrow" href="#section-15-4.3.3.1.1">Â¶</a></p>
</li>
            <li class="normal" id="section-15-4.3.3.2">
              <p id="section-15-4.3.3.2.1">B bit<a class="pilcrow" href="#section-15-4.3.3.2.1">Â¶</a></p>
</li>
            <li class="normal" id="section-15-4.3.3.3">
              <p id="section-15-4.3.3.3.1">U bit<a class="pilcrow" href="#section-15-4.3.3.3.1">Â¶</a></p>
</li>
          </ul>
<p id="section-15-4.3.4">IANA has also replaced the reference to <span>[<a class="xref" href="#RFC7053">RFC7053</a>]</span> with a reference to
this document for the following DATA chunk flag:<a class="pilcrow" href="#section-15-4.3.4">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-15-4.3.5.1">
              <p id="section-15-4.3.5.1.1">I bit<a class="pilcrow" href="#section-15-4.3.5.1.1">Â¶</a></p>
</li>
          </ul>
<p id="section-15-4.3.6">IANA has replaced the reference to <span>[<a class="xref" href="#RFC4960">RFC4960</a>]</span> with a reference to
this document for the following ABORT chunk flag:<a class="pilcrow" href="#section-15-4.3.6">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-15-4.3.7.1">
              <p id="section-15-4.3.7.1.1">T bit<a class="pilcrow" href="#section-15-4.3.7.1.1">Â¶</a></p>
</li>
          </ul>
<p id="section-15-4.3.8">IANA has replaced the reference to <span>[<a class="xref" href="#RFC4960">RFC4960</a>]</span> with a reference to
this document for the following SHUTDOWN COMPLETE chunk flag:<a class="pilcrow" href="#section-15-4.3.8">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-15-4.3.9.1">
              <p id="section-15-4.3.9.1.1">T bit<a class="pilcrow" href="#section-15-4.3.9.1.1">Â¶</a></p>
</li>
          </ul>
</li>
        <li class="normal" id="section-15-4.4">
          <p id="section-15-4.4.1">In the "Error Cause Codes" registry, IANA has replaced
the registry reference to <span>[<a class="xref" href="#RFC4960">RFC4960</a>]</span> with a reference to this document.<a class="pilcrow" href="#section-15-4.4.1">Â¶</a></p>
<p id="section-15-4.4.2">IANA has changed the name of the "User Initiated Abort" error cause to
"User-Initiated Abort" and the name of the "Stale Cookie Error" error cause
to "Stale Cookie" in the "Error Cause Codes" registry.<a class="pilcrow" href="#section-15-4.4.2">Â¶</a></p>
<p id="section-15-4.4.3">In addition, each reference to <span>[<a class="xref" href="#RFC4960">RFC4960</a>]</span> has been replaced with a reference to
this document for the following cause codes:<a class="pilcrow" href="#section-15-4.4.3">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-15-4.4.4.1">
              <p id="section-15-4.4.4.1.1">Invalid Stream Identifier<a class="pilcrow" href="#section-15-4.4.4.1.1">Â¶</a></p>
</li>
            <li class="normal" id="section-15-4.4.4.2">
              <p id="section-15-4.4.4.2.1">Missing Mandatory Parameter<a class="pilcrow" href="#section-15-4.4.4.2.1">Â¶</a></p>
</li>
            <li class="normal" id="section-15-4.4.4.3">
              <p id="section-15-4.4.4.3.1">Stale Cookie<a class="pilcrow" href="#section-15-4.4.4.3.1">Â¶</a></p>
</li>
            <li class="normal" id="section-15-4.4.4.4">
              <p id="section-15-4.4.4.4.1">Out of Resource<a class="pilcrow" href="#section-15-4.4.4.4.1">Â¶</a></p>
</li>
            <li class="normal" id="section-15-4.4.4.5">
              <p id="section-15-4.4.4.5.1">Unresolvable Address<a class="pilcrow" href="#section-15-4.4.4.5.1">Â¶</a></p>
</li>
            <li class="normal" id="section-15-4.4.4.6">
              <p id="section-15-4.4.4.6.1">Unrecognized Chunk Type<a class="pilcrow" href="#section-15-4.4.4.6.1">Â¶</a></p>
</li>
            <li class="normal" id="section-15-4.4.4.7">
              <p id="section-15-4.4.4.7.1">Invalid Mandatory Parameter<a class="pilcrow" href="#section-15-4.4.4.7.1">Â¶</a></p>
</li>
            <li class="normal" id="section-15-4.4.4.8">
              <p id="section-15-4.4.4.8.1">Unrecognized Parameters<a class="pilcrow" href="#section-15-4.4.4.8.1">Â¶</a></p>
</li>
            <li class="normal" id="section-15-4.4.4.9">
              <p id="section-15-4.4.4.9.1">No User Data<a class="pilcrow" href="#section-15-4.4.4.9.1">Â¶</a></p>
</li>
            <li class="normal" id="section-15-4.4.4.10">
              <p id="section-15-4.4.4.10.1">Cookie Received While Shutting Down<a class="pilcrow" href="#section-15-4.4.4.10.1">Â¶</a></p>
</li>
            <li class="normal" id="section-15-4.4.4.11">
              <p id="section-15-4.4.4.11.1">Restart of an Association with New Addresses<a class="pilcrow" href="#section-15-4.4.4.11.1">Â¶</a></p>
</li>
          </ul>
<p id="section-15-4.4.5">IANA has also replaced each reference to <span>[<a class="xref" href="#RFC4460">RFC4460</a>]</span> with a reference to
this document for the following cause codes:<a class="pilcrow" href="#section-15-4.4.5">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-15-4.4.6.1">
              <p id="section-15-4.4.6.1.1">User-Initiated Abort<a class="pilcrow" href="#section-15-4.4.6.1.1">Â¶</a></p>
</li>
            <li class="normal" id="section-15-4.4.6.2">
              <p id="section-15-4.4.6.2.1">Protocol Violation<a class="pilcrow" href="#section-15-4.4.6.2.1">Â¶</a></p>
</li>
          </ul>
</li>
        <li class="normal" id="section-15-4.5">
          <p id="section-15-4.5.1">In the "SCTP Payload Protocol Identifiers" registry, IANA has
replaced the registry reference to <span>[<a class="xref" href="#RFC4960">RFC4960</a>]</span> with a reference
to this document.<a class="pilcrow" href="#section-15-4.5.1">Â¶</a></p>
<p id="section-15-4.5.2">IANA has replaced the reference to <span>[<a class="xref" href="#RFC4960">RFC4960</a>]</span> with a reference to
this document for the following SCTP payload protocol identifier:<a class="pilcrow" href="#section-15-4.5.2">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-15-4.5.3.1">
              <p id="section-15-4.5.3.1.1">Reserved by SCTP<a class="pilcrow" href="#section-15-4.5.3.1.1">Â¶</a></p>
</li>
          </ul>
</li>
      </ul>
<p id="section-15-5">SCTP requires that the IANA "Port Numbers" registry be opened for SCTP port
registrations; <a class="xref" href="#sec_port_number_registry">Section 15.6</a> describes how.
An IESG-appointed Expert Reviewer supports IANA in evaluating SCTP port
allocation requests.<a class="pilcrow" href="#section-15-5">Â¶</a></p>
<p id="section-15-6">In the "Service Name and Transport Protocol Port Number Registry", IANA has replaced each reference to <span>[<a class="xref" href="#RFC4960">RFC4960</a>]</span> with a reference to
this document for the following SCTP port numbers:<a class="pilcrow" href="#section-15-6">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-15-7.1">
          <p id="section-15-7.1.1">9 (discard)<a class="pilcrow" href="#section-15-7.1.1">Â¶</a></p>
</li>
        <li class="normal" id="section-15-7.2">
          <p id="section-15-7.2.1">20 (ftp-data)<a class="pilcrow" href="#section-15-7.2.1">Â¶</a></p>
</li>
        <li class="normal" id="section-15-7.3">
          <p id="section-15-7.3.1">21 (ftp)<a class="pilcrow" href="#section-15-7.3.1">Â¶</a></p>
</li>
        <li class="normal" id="section-15-7.4">
          <p id="section-15-7.4.1">22 (ssh)<a class="pilcrow" href="#section-15-7.4.1">Â¶</a></p>
</li>
        <li class="normal" id="section-15-7.5">
          <p id="section-15-7.5.1">80 (http)<a class="pilcrow" href="#section-15-7.5.1">Â¶</a></p>
</li>
        <li class="normal" id="section-15-7.6">
          <p id="section-15-7.6.1">179 (bgp)<a class="pilcrow" href="#section-15-7.6.1">Â¶</a></p>
</li>
        <li class="normal" id="section-15-7.7">
          <p id="section-15-7.7.1">443 (https)<a class="pilcrow" href="#section-15-7.7.1">Â¶</a></p>
</li>
      </ul>
<p id="section-15-8">Furthermore, in the "Hypertext Transfer Protocol (HTTP) Digest Algorithm Values"
registry, IANA has replaced the reference to <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc4960#appendix-B">Appendix B</a> of [<a class="xref" href="#RFC4960">RFC4960</a>]</span> with a reference to
<a class="xref" href="#sec_crc32c">Appendix A</a> of this document.<a class="pilcrow" href="#section-15-8">Â¶</a></p>
<p id="section-15-9">In addition, in the "ONC RPC Netids (Standards Action)" registry, IANA has replaced each
reference to <span>[<a class="xref" href="#RFC4960">RFC4960</a>]</span> with a reference to
this document for the following netids:<a class="pilcrow" href="#section-15-9">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-15-10.1">
          <p id="section-15-10.1.1">sctp<a class="pilcrow" href="#section-15-10.1.1">Â¶</a></p>
</li>
        <li class="normal" id="section-15-10.2">
          <p id="section-15-10.2.1">sctp6<a class="pilcrow" href="#section-15-10.2.1">Â¶</a></p>
</li>
      </ul>
<p id="section-15-11">In the "IPFIX Information Elements" registry, IANA has replaced each reference to <span>[<a class="xref" href="#RFC4960">RFC4960</a>]</span> with a reference to
this document for the following elements with the name:<a class="pilcrow" href="#section-15-11">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-15-12.1">
          <p id="section-15-12.1.1">sourceTransportPort<a class="pilcrow" href="#section-15-12.1.1">Â¶</a></p>
</li>
        <li class="normal" id="section-15-12.2">
          <p id="section-15-12.2.1">destinationTransportPort<a class="pilcrow" href="#section-15-12.2.1">Â¶</a></p>
</li>
        <li class="normal" id="section-15-12.3">
          <p id="section-15-12.3.1">collectorTransportPort<a class="pilcrow" href="#section-15-12.3.1">Â¶</a></p>
</li>
        <li class="normal" id="section-15-12.4">
          <p id="section-15-12.4.1">exporterTransportPort<a class="pilcrow" href="#section-15-12.4.1">Â¶</a></p>
</li>
        <li class="normal" id="section-15-12.5">
          <p id="section-15-12.5.1">postNAPTSourceTransportPort<a class="pilcrow" href="#section-15-12.5.1">Â¶</a></p>
</li>
        <li class="normal" id="section-15-12.6">
          <p id="section-15-12.6.1">postNAPTDestinationTransportPort<a class="pilcrow" href="#section-15-12.6.1">Â¶</a></p>
</li>
      </ul>
<div id="sec_ietf_defined_chunks_extension">
<section id="section-15.1">
        <h3 id="name-ietf-defined-chunk-extensio">
<a class="section-number selfRef" href="#section-15.1">15.1. </a><a class="section-name selfRef" href="#name-ietf-defined-chunk-extensio">IETF-Defined Chunk Extension</a>
        </h3>
<p id="section-15.1-1">The assignment of new chunk type codes is done through an IETF
Review action, as defined in <span>[<a class="xref" href="#RFC8126">RFC8126</a>]</span>.
Documentation for a new chunk <span class="bcp14">MUST</span> contain the following information:<a class="pilcrow" href="#section-15.1-1">Â¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-15.1-2">
<dt>a)</dt>
<dd id="section-15.1-2.1">
            <p id="section-15.1-2.1.1">A long and short name for the new chunk type.<a class="pilcrow" href="#section-15.1-2.1.1">Â¶</a></p>
</dd>
          <dd class="break"></dd>
<dt>b)</dt>
<dd id="section-15.1-2.2">
            <p id="section-15.1-2.2.1">A detailed description of the structure of the chunk, which <span class="bcp14">MUST</span> conform to
the basic structure defined in <a class="xref" href="#sec_chunk_field_descriptions">Section 3.2</a>.<a class="pilcrow" href="#section-15.1-2.2.1">Â¶</a></p>
</dd>
          <dd class="break"></dd>
<dt>c)</dt>
<dd id="section-15.1-2.3">
            <p id="section-15.1-2.3.1">A detailed definition and description of intended use of each field within
the chunk, including the chunk flags if any.
Defined chunk flags will be used as initial entries in the chunk flags table
for the new chunk type.<a class="pilcrow" href="#section-15.1-2.3.1">Â¶</a></p>
</dd>
          <dd class="break"></dd>
<dt>d)</dt>
<dd id="section-15.1-2.4">
            <p id="section-15.1-2.4.1">A detailed procedural description of the use of the new chunk type within
the operation of the protocol.<a class="pilcrow" href="#section-15.1-2.4.1">Â¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-15.1-3">The last chunk type (255) is reserved for future extension if necessary.<a class="pilcrow" href="#section-15.1-3">Â¶</a></p>
<p id="section-15.1-4">For each new chunk type, IANA creates a registration table for the
chunk flags of that type.
The procedure for registering particular chunk flags is described in
<a class="xref" href="#sec_ietf_chunk_flags_registration">Section 15.2</a>.<a class="pilcrow" href="#section-15.1-4">Â¶</a></p>
</section>
</div>
<div id="sec_ietf_chunk_flags_registration">
<section id="section-15.2">
        <h3 id="name-ietf-defined-chunk-flags-re">
<a class="section-number selfRef" href="#section-15.2">15.2. </a><a class="section-name selfRef" href="#name-ietf-defined-chunk-flags-re">IETF-Defined Chunk Flags Registration</a>
        </h3>
<p id="section-15.2-1">The assignment of new chunk flags is done through an RFC Required action,
as defined in <span>[<a class="xref" href="#RFC8126">RFC8126</a>]</span>.
Documentation for the chunk flags <span class="bcp14">MUST</span> contain the following information:<a class="pilcrow" href="#section-15.2-1">Â¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-15.2-2">
<dt>a)</dt>
<dd id="section-15.2-2.1">
            <p id="section-15.2-2.1.1">A name for the new chunk flag.<a class="pilcrow" href="#section-15.2-2.1.1">Â¶</a></p>
</dd>
          <dd class="break"></dd>
<dt>b)</dt>
<dd id="section-15.2-2.2">
            <p id="section-15.2-2.2.1">A detailed procedural description of the use of the new chunk flag within
the operation of the protocol.
It <span class="bcp14">MUST</span> be considered that implementations not supporting the flag will send 0
on transmit and just ignore it on receipt.<a class="pilcrow" href="#section-15.2-2.2.1">Â¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-15.2-3">IANA selects a chunk flags value.
This <span class="bcp14">MUST</span> be one of 0x01, 0x02, 0x04, 0x08, 0x10, 0x20, 0x40, or 0x80, which
<span class="bcp14">MUST</span> be unique within the chunk flag values for the specific chunk type.<a class="pilcrow" href="#section-15.2-3">Â¶</a></p>
</section>
</div>
<div id="sec_ietf_defined_chunk_parameter_extension">
<section id="section-15.3">
        <h3 id="name-ietf-defined-chunk-paramete">
<a class="section-number selfRef" href="#section-15.3">15.3. </a><a class="section-name selfRef" href="#name-ietf-defined-chunk-paramete">IETF-Defined Chunk Parameter Extension</a>
        </h3>
<p id="section-15.3-1">The assignment of new chunk parameter type codes is done through an IETF
Review action, as defined in <span>[<a class="xref" href="#RFC8126">RFC8126</a>]</span>.
Documentation of the chunk parameter <span class="bcp14">MUST</span> contain the following information:<a class="pilcrow" href="#section-15.3-1">Â¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-15.3-2">
<dt>a)</dt>
<dd id="section-15.3-2.1">
            <p id="section-15.3-2.1.1">Name of the parameter type.<a class="pilcrow" href="#section-15.3-2.1.1">Â¶</a></p>
</dd>
          <dd class="break"></dd>
<dt>b)</dt>
<dd id="section-15.3-2.2">
            <p id="section-15.3-2.2.1">Detailed description of the structure of the parameter field.
This structure <span class="bcp14">MUST</span> conform to the general Type-Length-Value format described
in <a class="xref" href="#sec_parameter_format">Section 3.2.1</a>.<a class="pilcrow" href="#section-15.3-2.2.1">Â¶</a></p>
</dd>
          <dd class="break"></dd>
<dt>c)</dt>
<dd id="section-15.3-2.3">
            <p id="section-15.3-2.3.1">Detailed definition of each component of the parameter value.<a class="pilcrow" href="#section-15.3-2.3.1">Â¶</a></p>
</dd>
          <dd class="break"></dd>
<dt>d)</dt>
<dd id="section-15.3-2.4">
            <p id="section-15.3-2.4.1">Detailed description of the intended use of this parameter type and an
indication of whether and under what circumstances multiple instances of this
parameter type can be found within the same chunk.<a class="pilcrow" href="#section-15.3-2.4.1">Â¶</a></p>
</dd>
          <dd class="break"></dd>
<dt>e)</dt>
<dd id="section-15.3-2.5">
            <p id="section-15.3-2.5.1">Each parameter type <span class="bcp14">MUST</span> be unique across all chunks.<a class="pilcrow" href="#section-15.3-2.5.1">Â¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec_ietf_defined_additional_error_causes">
<section id="section-15.4">
        <h3 id="name-ietf-defined-additional-err">
<a class="section-number selfRef" href="#section-15.4">15.4. </a><a class="section-name selfRef" href="#name-ietf-defined-additional-err">IETF-Defined Additional Error Causes</a>
        </h3>
<p id="section-15.4-1">Additional cause codes can be allocated through a Specification Required action as defined in <span>[<a class="xref" href="#RFC8126">RFC8126</a>]</span>.
Provided documentation <span class="bcp14">MUST</span> include the following information:<a class="pilcrow" href="#section-15.4-1">Â¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-15.4-2">
<dt>a)</dt>
<dd id="section-15.4-2.1">
            <p id="section-15.4-2.1.1">Name of the error condition.<a class="pilcrow" href="#section-15.4-2.1.1">Â¶</a></p>
</dd>
          <dd class="break"></dd>
<dt>b)</dt>
<dd id="section-15.4-2.2">
            <p id="section-15.4-2.2.1">Detailed description of the conditions under which an SCTP endpoint
issues an ERROR (or ABORT) chunk with this cause code.<a class="pilcrow" href="#section-15.4-2.2.1">Â¶</a></p>
</dd>
          <dd class="break"></dd>
<dt>c)</dt>
<dd id="section-15.4-2.3">
            <p id="section-15.4-2.3.1">Expected action by the SCTP endpoint that receives an ERROR (or ABORT) chunk
containing this cause code.<a class="pilcrow" href="#section-15.4-2.3.1">Â¶</a></p>
</dd>
          <dd class="break"></dd>
<dt>d)</dt>
<dd id="section-15.4-2.4">
            <p id="section-15.4-2.4.1">Detailed description of the structure and content of data fields that
accompany this cause code.<a class="pilcrow" href="#section-15.4-2.4.1">Â¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-15.4-3">The initial word (32 bits) of a cause code parameter <span class="bcp14">MUST</span> conform to the
format shown in <a class="xref" href="#sec_error_chunk">Section 3.3.10</a>, that is:<a class="pilcrow" href="#section-15.4-3">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-15.4-4.1">
            <p id="section-15.4-4.1.1">first 2 bytes contain the cause code value<a class="pilcrow" href="#section-15.4-4.1.1">Â¶</a></p>
</li>
          <li class="normal" id="section-15.4-4.2">
            <p id="section-15.4-4.2.1">last 2 bytes contain the length of the error cause.<a class="pilcrow" href="#section-15.4-4.2.1">Â¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec_payload_prototol_identifiers">
<section id="section-15.5">
        <h3 id="name-payload-protocol-identifier">
<a class="section-number selfRef" href="#section-15.5">15.5. </a><a class="section-name selfRef" href="#name-payload-protocol-identifier">Payload Protocol Identifiers</a>
        </h3>
<p id="section-15.5-1">The assignment of payload protocol identifiers is done using the First Come
First Served policy, as defined in <span>[<a class="xref" href="#RFC8126">RFC8126</a>]</span>.<a class="pilcrow" href="#section-15.5-1">Â¶</a></p>
<p id="section-15.5-2">Except for value 0, which is reserved to indicate an unspecified payload
protocol identifier in a DATA chunk, an SCTP implementation will not be
responsible for standardizing or verifying any payload protocol identifiers.
An SCTP implementation simply receives the identifier from the upper layer
and carries it with the corresponding payload data.<a class="pilcrow" href="#section-15.5-2">Â¶</a></p>
<p id="section-15.5-3">The upper layer, i.e., the SCTP user, <span class="bcp14">SHOULD</span> standardize any specific
protocol identifier with IANA if it is so desired.
The use of any specific payload protocol identifier is out of the scope of
this specification.<a class="pilcrow" href="#section-15.5-3">Â¶</a></p>
</section>
</div>
<div id="sec_port_number_registry">
<section id="section-15.6">
        <h3 id="name-port-numbers-registry">
<a class="section-number selfRef" href="#section-15.6">15.6. </a><a class="section-name selfRef" href="#name-port-numbers-registry">Port Numbers Registry</a>
        </h3>
<p id="section-15.6-1">SCTP services can use contact port numbers to provide service to unknown
callers, as in TCP and UDP.
An IESG-appointed Expert Reviewer supports IANA in evaluating SCTP port
allocation requests, according to the procedure defined in
<span>[<a class="xref" href="#RFC8126">RFC8126</a>]</span>.
The details of this process are defined in <span>[<a class="xref" href="#RFC6335">RFC6335</a>]</span>.<a class="pilcrow" href="#section-15.6-1">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec_parameter_values">
<section id="section-16">
      <h2 id="name-suggested-sctp-protocol-par">
<a class="section-number selfRef" href="#section-16">16. </a><a class="section-name selfRef" href="#name-suggested-sctp-protocol-par">Suggested SCTP Protocol Parameter Values</a>
      </h2>
<p id="section-16-1">The following protocol parameters are <span class="bcp14">RECOMMENDED</span>:<a class="pilcrow" href="#section-16-1">Â¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-16-2">
        <dt id="section-16-2.1">RTO.Initial:</dt>
        <dd id="section-16-2.2" style="margin-left: 1.5em">
          <p id="section-16-2.2.1">1 second<a class="pilcrow" href="#section-16-2.2.1">Â¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-16-2.3">RTO.Min:</dt>
        <dd id="section-16-2.4" style="margin-left: 1.5em">
          <p id="section-16-2.4.1">1 second<a class="pilcrow" href="#section-16-2.4.1">Â¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-16-2.5">RTO.Max:</dt>
        <dd id="section-16-2.6" style="margin-left: 1.5em">
          <p id="section-16-2.6.1">60 seconds<a class="pilcrow" href="#section-16-2.6.1">Â¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-16-2.7">Max.Burst:</dt>
        <dd id="section-16-2.8" style="margin-left: 1.5em">
          <p id="section-16-2.8.1">4<a class="pilcrow" href="#section-16-2.8.1">Â¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-16-2.9">RTO.Alpha:</dt>
        <dd id="section-16-2.10" style="margin-left: 1.5em">
          <p id="section-16-2.10.1">1/8<a class="pilcrow" href="#section-16-2.10.1">Â¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-16-2.11">RTO.Beta:</dt>
        <dd id="section-16-2.12" style="margin-left: 1.5em">
          <p id="section-16-2.12.1">1/4<a class="pilcrow" href="#section-16-2.12.1">Â¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-16-2.13">Valid.Cookie.Life:</dt>
        <dd id="section-16-2.14" style="margin-left: 1.5em">
          <p id="section-16-2.14.1">60 seconds<a class="pilcrow" href="#section-16-2.14.1">Â¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-16-2.15">Association.Max.Retrans:</dt>
        <dd id="section-16-2.16" style="margin-left: 1.5em">
          <p id="section-16-2.16.1">10 attempts<a class="pilcrow" href="#section-16-2.16.1">Â¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-16-2.17">Path.Max.Retrans:</dt>
        <dd id="section-16-2.18" style="margin-left: 1.5em">
          <p id="section-16-2.18.1">5 attempts (per destination address)<a class="pilcrow" href="#section-16-2.18.1">Â¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-16-2.19">Max.Init.Retransmits:</dt>
        <dd id="section-16-2.20" style="margin-left: 1.5em">
          <p id="section-16-2.20.1">8 attempts<a class="pilcrow" href="#section-16-2.20.1">Â¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-16-2.21">HB.interval:</dt>
        <dd id="section-16-2.22" style="margin-left: 1.5em">
          <p id="section-16-2.22.1">30 seconds<a class="pilcrow" href="#section-16-2.22.1">Â¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-16-2.23">HB.Max.Burst:</dt>
        <dd id="section-16-2.24" style="margin-left: 1.5em">
          <p id="section-16-2.24.1">1<a class="pilcrow" href="#section-16-2.24.1">Â¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-16-2.25">SACK.Delay:</dt>
        <dd id="section-16-2.26" style="margin-left: 1.5em">
          <p id="section-16-2.26.1">200 milliseconds<a class="pilcrow" href="#section-16-2.26.1">Â¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-16-3">Implementation Note: The SCTP implementation can allow ULP to customize some
of these protocol parameters (see <a class="xref" href="#sec_api">Section 11</a>).<a class="pilcrow" href="#section-16-3">Â¶</a></p>
<p id="section-16-4">'RTO.Min' <span class="bcp14">SHOULD</span> be set as described above in this section.<a class="pilcrow" href="#section-16-4">Â¶</a></p>
</section>
</div>
<section id="section-17">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-17">17. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-17.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-17.1">17.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="ITU.V42.1994">[ITU.V42.1994]</dt>
        <dd>
<span class="refAuthor">International Telecommunications Union</span>, <span class="refTitle">"Error-correcting Procedures for DCEs Using Asynchronous-to-Synchronous Conversion"</span>, <span class="seriesInfo">ITU-T Recommendation V.42</span>, <time class="refDate" datetime="1994">1994</time>. </dd>
<dd class="break"></dd>
<dt id="RFC1122">[RFC1122]</dt>
        <dd>
<span class="refAuthor">Braden, R., Ed.</span>, <span class="refTitle">"Requirements for Internet Hosts - Communication Layers"</span>, <span class="seriesInfo">STD 3</span>, <span class="seriesInfo">RFC 1122</span>, <span class="seriesInfo">DOI 10.17487/RFC1122</span>, <time class="refDate" datetime="1989-10">October 1989</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1122">https://www.rfc-editor.org/info/rfc1122</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1123">[RFC1123]</dt>
        <dd>
<span class="refAuthor">Braden, R., Ed.</span>, <span class="refTitle">"Requirements for Internet Hosts - Application and Support"</span>, <span class="seriesInfo">STD 3</span>, <span class="seriesInfo">RFC 1123</span>, <span class="seriesInfo">DOI 10.17487/RFC1123</span>, <time class="refDate" datetime="1989-10">October 1989</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1123">https://www.rfc-editor.org/info/rfc1123</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1191">[RFC1191]</dt>
        <dd>
<span class="refAuthor">Mogul, J.</span> and <span class="refAuthor">S. Deering</span>, <span class="refTitle">"Path MTU discovery"</span>, <span class="seriesInfo">RFC 1191</span>, <span class="seriesInfo">DOI 10.17487/RFC1191</span>, <time class="refDate" datetime="1990-11">November 1990</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1191">https://www.rfc-editor.org/info/rfc1191</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1982">[RFC1982]</dt>
        <dd>
<span class="refAuthor">Elz, R.</span> and <span class="refAuthor">R. Bush</span>, <span class="refTitle">"Serial Number Arithmetic"</span>, <span class="seriesInfo">RFC 1982</span>, <span class="seriesInfo">DOI 10.17487/RFC1982</span>, <time class="refDate" datetime="1996-08">August 1996</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1982">https://www.rfc-editor.org/info/rfc1982</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time class="refDate" datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4291">[RFC4291]</dt>
        <dd>
<span class="refAuthor">Hinden, R.</span> and <span class="refAuthor">S. Deering</span>, <span class="refTitle">"IP Version 6 Addressing Architecture"</span>, <span class="seriesInfo">RFC 4291</span>, <span class="seriesInfo">DOI 10.17487/RFC4291</span>, <time class="refDate" datetime="2006-02">February 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4291">https://www.rfc-editor.org/info/rfc4291</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4303">[RFC4303]</dt>
        <dd>
<span class="refAuthor">Kent, S.</span>, <span class="refTitle">"IP Encapsulating Security Payload (ESP)"</span>, <span class="seriesInfo">RFC 4303</span>, <span class="seriesInfo">DOI 10.17487/RFC4303</span>, <time class="refDate" datetime="2005-12">December 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4303">https://www.rfc-editor.org/info/rfc4303</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4895">[RFC4895]</dt>
        <dd>
<span class="refAuthor">Tuexen, M.</span>, <span class="refAuthor">Stewart, R.</span>, <span class="refAuthor">Lei, P.</span>, and <span class="refAuthor">E. Rescorla</span>, <span class="refTitle">"Authenticated Chunks for the Stream Control Transmission Protocol (SCTP)"</span>, <span class="seriesInfo">RFC 4895</span>, <span class="seriesInfo">DOI 10.17487/RFC4895</span>, <time class="refDate" datetime="2007-08">August 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4895">https://www.rfc-editor.org/info/rfc4895</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5681">[RFC5681]</dt>
        <dd>
<span class="refAuthor">Allman, M.</span>, <span class="refAuthor">Paxson, V.</span>, and <span class="refAuthor">E. Blanton</span>, <span class="refTitle">"TCP Congestion Control"</span>, <span class="seriesInfo">RFC 5681</span>, <span class="seriesInfo">DOI 10.17487/RFC5681</span>, <time class="refDate" datetime="2009-09">September 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5681">https://www.rfc-editor.org/info/rfc5681</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6335">[RFC6335]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Eggert, L.</span>, <span class="refAuthor">Touch, J.</span>, <span class="refAuthor">Westerlund, M.</span>, and <span class="refAuthor">S. Cheshire</span>, <span class="refTitle">"Internet Assigned Numbers Authority (IANA) Procedures for the Management of the Service Name and Transport Protocol Port Number Registry"</span>, <span class="seriesInfo">BCP 165</span>, <span class="seriesInfo">RFC 6335</span>, <span class="seriesInfo">DOI 10.17487/RFC6335</span>, <time class="refDate" datetime="2011-08">August 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6335">https://www.rfc-editor.org/info/rfc6335</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6083">[RFC6083]</dt>
        <dd>
<span class="refAuthor">Tuexen, M.</span>, <span class="refAuthor">Seggelmann, R.</span>, and <span class="refAuthor">E. Rescorla</span>, <span class="refTitle">"Datagram Transport Layer Security (DTLS) for Stream Control Transmission Protocol (SCTP)"</span>, <span class="seriesInfo">RFC 6083</span>, <span class="seriesInfo">DOI 10.17487/RFC6083</span>, <time class="refDate" datetime="2011-01">January 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6083">https://www.rfc-editor.org/info/rfc6083</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7296">[RFC7296]</dt>
        <dd>
<span class="refAuthor">Kaufman, C.</span>, <span class="refAuthor">Hoffman, P.</span>, <span class="refAuthor">Nir, Y.</span>, <span class="refAuthor">Eronen, P.</span>, and <span class="refAuthor">T. Kivinen</span>, <span class="refTitle">"Internet Key Exchange Protocol Version 2 (IKEv2)"</span>, <span class="seriesInfo">STD 79</span>, <span class="seriesInfo">RFC 7296</span>, <span class="seriesInfo">DOI 10.17487/RFC7296</span>, <time class="refDate" datetime="2014-10">October 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7296">https://www.rfc-editor.org/info/rfc7296</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time class="refDate" datetime="2017-06">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time class="refDate" datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8200">[RFC8200]</dt>
        <dd>
<span class="refAuthor">Deering, S.</span> and <span class="refAuthor">R. Hinden</span>, <span class="refTitle">"Internet Protocol, Version 6 (IPv6) Specification"</span>, <span class="seriesInfo">STD 86</span>, <span class="seriesInfo">RFC 8200</span>, <span class="seriesInfo">DOI 10.17487/RFC8200</span>, <time class="refDate" datetime="2017-07">July 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8200">https://www.rfc-editor.org/info/rfc8200</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8201">[RFC8201]</dt>
        <dd>
<span class="refAuthor">McCann, J.</span>, <span class="refAuthor">Deering, S.</span>, <span class="refAuthor">Mogul, J.</span>, and <span class="refAuthor">R. Hinden, Ed.</span>, <span class="refTitle">"Path MTU Discovery for IP version 6"</span>, <span class="seriesInfo">STD 87</span>, <span class="seriesInfo">RFC 8201</span>, <span class="seriesInfo">DOI 10.17487/RFC8201</span>, <time class="refDate" datetime="2017-07">July 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8201">https://www.rfc-editor.org/info/rfc8201</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8899">[RFC8899]</dt>
      <dd>
<span class="refAuthor">Fairhurst, G.</span>, <span class="refAuthor">Jones, T.</span>, <span class="refAuthor">TÃ¼xen, M.</span>, <span class="refAuthor">RÃ¼ngeler, I.</span>, and <span class="refAuthor">T. VÃ¶lker</span>, <span class="refTitle">"Packetization Layer Path MTU Discovery for Datagram Transports"</span>, <span class="seriesInfo">RFC 8899</span>, <span class="seriesInfo">DOI 10.17487/RFC8899</span>, <time class="refDate" datetime="2020-09">September 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8899">https://www.rfc-editor.org/info/rfc8899</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-17.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-17.2">17.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="FALL96">[FALL96]</dt>
        <dd>
<span class="refAuthor">Fall, K.</span> and <span class="refAuthor">S. Floyd</span>, <span class="refTitle">"Simulation-based Comparisons of Tahoe, Reno, and SACK TCP"</span>, <span class="refContent">SIGCOM 99, V. 26, N. 3, pp 5-21</span>, <time class="refDate" datetime="1996-07">July 1996</time>. </dd>
<dd class="break"></dd>
<dt id="SAVAGE99">[SAVAGE99]</dt>
        <dd>
<span class="refAuthor">Savage, S.</span>, <span class="refAuthor">Cardwell, N.</span>, <span class="refAuthor">Wetherall, D.</span>, and <span class="refAuthor">T. Anderson</span>, <span class="refTitle">"TCP Congestion Control with a Misbehaving Receiver"</span>, <span class="refContent">ACM Computer Communications Review 29(5)</span>, <time class="refDate" datetime="1999-10">October 1999</time>. </dd>
<dd class="break"></dd>
<dt id="ALLMAN99">[ALLMAN99]</dt>
        <dd>
<span class="refAuthor">Allman, M.</span> and <span class="refAuthor">V. Paxson</span>, <span class="refTitle">"On Estimating End-to-End Network Path Properties"</span>, <span class="refContent">SIGCOM 99</span>, <time class="refDate" datetime="1999-10">October 1999</time>. </dd>
<dd class="break"></dd>
<dt id="WILLIAMS93">[WILLIAMS93]</dt>
        <dd>
<span class="refAuthor">Williams, R.</span>, <span class="refTitle">"A PAINLESS GUIDE TO CRC ERROR DETECTION ALGORITHMS"</span>, <span class="refContent">SIGCOM 99</span>, <time class="refDate" datetime="1993-08">August 1993</time>, <span>&lt;<a href="https://archive.org/stream/PainlessCRC/crc_v3.txt">https://archive.org/stream/PainlessCRC/crc_v3.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC0768">[RFC0768]</dt>
        <dd>
<span class="refAuthor">Postel, J.</span>, <span class="refTitle">"User Datagram Protocol"</span>, <span class="seriesInfo">STD 6</span>, <span class="seriesInfo">RFC 768</span>, <span class="seriesInfo">DOI 10.17487/RFC0768</span>, <time class="refDate" datetime="1980-08">August 1980</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc768">https://www.rfc-editor.org/info/rfc768</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC0793">[RFC0793]</dt>
        <dd>
<span class="refAuthor">Postel, J.</span>, <span class="refTitle">"Transmission Control Protocol"</span>, <span class="seriesInfo">STD 7</span>, <span class="seriesInfo">RFC 793</span>, <span class="seriesInfo">DOI 10.17487/RFC0793</span>, <time class="refDate" datetime="1981-09">September 1981</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc793">https://www.rfc-editor.org/info/rfc793</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1858">[RFC1858]</dt>
        <dd>
<span class="refAuthor">Ziemba, G.</span>, <span class="refAuthor">Reed, D.</span>, and <span class="refAuthor">P. Traina</span>, <span class="refTitle">"Security Considerations for IP Fragment Filtering"</span>, <span class="seriesInfo">RFC 1858</span>, <span class="seriesInfo">DOI 10.17487/RFC1858</span>, <time class="refDate" datetime="1995-10">October 1995</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1858">https://www.rfc-editor.org/info/rfc1858</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2104">[RFC2104]</dt>
        <dd>
<span class="refAuthor">Krawczyk, H.</span>, <span class="refAuthor">Bellare, M.</span>, and <span class="refAuthor">R. Canetti</span>, <span class="refTitle">"HMAC: Keyed-Hashing for Message Authentication"</span>, <span class="seriesInfo">RFC 2104</span>, <span class="seriesInfo">DOI 10.17487/RFC2104</span>, <time class="refDate" datetime="1997-02">February 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2104">https://www.rfc-editor.org/info/rfc2104</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2196">[RFC2196]</dt>
        <dd>
<span class="refAuthor">Fraser, B.</span>, <span class="refTitle">"Site Security Handbook"</span>, <span class="seriesInfo">FYI 8</span>, <span class="seriesInfo">RFC 2196</span>, <span class="seriesInfo">DOI 10.17487/RFC2196</span>, <time class="refDate" datetime="1997-09">September 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2196">https://www.rfc-editor.org/info/rfc2196</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2522">[RFC2522]</dt>
        <dd>
<span class="refAuthor">Karn, P.</span> and <span class="refAuthor">W. Simpson</span>, <span class="refTitle">"Photuris: Session-Key Management Protocol"</span>, <span class="seriesInfo">RFC 2522</span>, <span class="seriesInfo">DOI 10.17487/RFC2522</span>, <time class="refDate" datetime="1999-03">March 1999</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2522">https://www.rfc-editor.org/info/rfc2522</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2960">[RFC2960]</dt>
        <dd>
<span class="refAuthor">Stewart, R.</span>, <span class="refAuthor">Xie, Q.</span>, <span class="refAuthor">Morneault, K.</span>, <span class="refAuthor">Sharp, C.</span>, <span class="refAuthor">Schwarzbauer, H.</span>, <span class="refAuthor">Taylor, T.</span>, <span class="refAuthor">Rytina, I.</span>, <span class="refAuthor">Kalla, M.</span>, <span class="refAuthor">Zhang, L.</span>, and <span class="refAuthor">V. Paxson</span>, <span class="refTitle">"Stream Control Transmission Protocol"</span>, <span class="seriesInfo">RFC 2960</span>, <span class="seriesInfo">DOI 10.17487/RFC2960</span>, <time class="refDate" datetime="2000-10">October 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2960">https://www.rfc-editor.org/info/rfc2960</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3465">[RFC3465]</dt>
        <dd>
<span class="refAuthor">Allman, M.</span>, <span class="refTitle">"TCP Congestion Control with Appropriate Byte Counting (ABC)"</span>, <span class="seriesInfo">RFC 3465</span>, <span class="seriesInfo">DOI 10.17487/RFC3465</span>, <time class="refDate" datetime="2003-02">February 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3465">https://www.rfc-editor.org/info/rfc3465</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3873">[RFC3873]</dt>
        <dd>
<span class="refAuthor">Pastor, J.</span> and <span class="refAuthor">M. Belinchon</span>, <span class="refTitle">"Stream Control Transmission Protocol (SCTP) Management Information Base (MIB)"</span>, <span class="seriesInfo">RFC 3873</span>, <span class="seriesInfo">DOI 10.17487/RFC3873</span>, <time class="refDate" datetime="2004-09">September 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3873">https://www.rfc-editor.org/info/rfc3873</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4086">[RFC4086]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refAuthor">Schiller, J.</span>, and <span class="refAuthor">S. Crocker</span>, <span class="refTitle">"Randomness Requirements for Security"</span>, <span class="seriesInfo">BCP 106</span>, <span class="seriesInfo">RFC 4086</span>, <span class="seriesInfo">DOI 10.17487/RFC4086</span>, <time class="refDate" datetime="2005-06">June 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4086">https://www.rfc-editor.org/info/rfc4086</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4301">[RFC4301]</dt>
        <dd>
<span class="refAuthor">Kent, S.</span> and <span class="refAuthor">K. Seo</span>, <span class="refTitle">"Security Architecture for the Internet Protocol"</span>, <span class="seriesInfo">RFC 4301</span>, <span class="seriesInfo">DOI 10.17487/RFC4301</span>, <time class="refDate" datetime="2005-12">December 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4301">https://www.rfc-editor.org/info/rfc4301</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4460">[RFC4460]</dt>
        <dd>
<span class="refAuthor">Stewart, R.</span>, <span class="refAuthor">Arias-Rodriguez, I.</span>, <span class="refAuthor">Poon, K.</span>, <span class="refAuthor">Caro, A.</span>, and <span class="refAuthor">M. Tuexen</span>, <span class="refTitle">"Stream Control Transmission Protocol (SCTP) Specification Errata and Issues"</span>, <span class="seriesInfo">RFC 4460</span>, <span class="seriesInfo">DOI 10.17487/RFC4460</span>, <time class="refDate" datetime="2006-04">April 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4460">https://www.rfc-editor.org/info/rfc4460</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4960">[RFC4960]</dt>
        <dd>
<span class="refAuthor">Stewart, R., Ed.</span>, <span class="refTitle">"Stream Control Transmission Protocol"</span>, <span class="seriesInfo">RFC 4960</span>, <span class="seriesInfo">DOI 10.17487/RFC4960</span>, <time class="refDate" datetime="2007-09">September 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4960">https://www.rfc-editor.org/info/rfc4960</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6096">[RFC6096]</dt>
        <dd>
<span class="refAuthor">Tuexen, M.</span> and <span class="refAuthor">R. Stewart</span>, <span class="refTitle">"Stream Control Transmission Protocol (SCTP) Chunk Flags Registration"</span>, <span class="seriesInfo">RFC 6096</span>, <span class="seriesInfo">DOI 10.17487/RFC6096</span>, <time class="refDate" datetime="2011-01">January 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6096">https://www.rfc-editor.org/info/rfc6096</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6458">[RFC6458]</dt>
        <dd>
<span class="refAuthor">Stewart, R.</span>, <span class="refAuthor">Tuexen, M.</span>, <span class="refAuthor">Poon, K.</span>, <span class="refAuthor">Lei, P.</span>, and <span class="refAuthor">V. Yasevich</span>, <span class="refTitle">"Sockets API Extensions for the Stream Control Transmission Protocol (SCTP)"</span>, <span class="seriesInfo">RFC 6458</span>, <span class="seriesInfo">DOI 10.17487/RFC6458</span>, <time class="refDate" datetime="2011-12">December 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6458">https://www.rfc-editor.org/info/rfc6458</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6951">[RFC6951]</dt>
        <dd>
<span class="refAuthor">Tuexen, M.</span> and <span class="refAuthor">R. Stewart</span>, <span class="refTitle">"UDP Encapsulation of Stream Control Transmission Protocol (SCTP) Packets for End-Host to End-Host Communication"</span>, <span class="seriesInfo">RFC 6951</span>, <span class="seriesInfo">DOI 10.17487/RFC6951</span>, <time class="refDate" datetime="2013-05">May 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6951">https://www.rfc-editor.org/info/rfc6951</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7053">[RFC7053]</dt>
        <dd>
<span class="refAuthor">Tuexen, M.</span>, <span class="refAuthor">Ruengeler, I.</span>, and <span class="refAuthor">R. Stewart</span>, <span class="refTitle">"SACK-IMMEDIATELY Extension for the Stream Control Transmission Protocol"</span>, <span class="seriesInfo">RFC 7053</span>, <span class="seriesInfo">DOI 10.17487/RFC7053</span>, <time class="refDate" datetime="2013-11">November 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7053">https://www.rfc-editor.org/info/rfc7053</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8260">[RFC8260]</dt>
        <dd>
<span class="refAuthor">Stewart, R.</span>, <span class="refAuthor">Tuexen, M.</span>, <span class="refAuthor">Loreto, S.</span>, and <span class="refAuthor">R. Seggelmann</span>, <span class="refTitle">"Stream Schedulers and User Message Interleaving for the Stream Control Transmission Protocol"</span>, <span class="seriesInfo">RFC 8260</span>, <span class="seriesInfo">DOI 10.17487/RFC8260</span>, <time class="refDate" datetime="2017-11">November 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8260">https://www.rfc-editor.org/info/rfc8260</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8261">[RFC8261]</dt>
        <dd>
<span class="refAuthor">Tuexen, M.</span>, <span class="refAuthor">Stewart, R.</span>, <span class="refAuthor">Jesup, R.</span>, and <span class="refAuthor">S. Loreto</span>, <span class="refTitle">"Datagram Transport Layer Security (DTLS) Encapsulation of SCTP Packets"</span>, <span class="seriesInfo">RFC 8261</span>, <span class="seriesInfo">DOI 10.17487/RFC8261</span>, <time class="refDate" datetime="2017-11">November 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8261">https://www.rfc-editor.org/info/rfc8261</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8540">[RFC8540]</dt>
      <dd>
<span class="refAuthor">Stewart, R.</span>, <span class="refAuthor">Tuexen, M.</span>, and <span class="refAuthor">M. Proshin</span>, <span class="refTitle">"Stream Control Transmission Protocol: Errata and Issues in RFC 4960"</span>, <span class="seriesInfo">RFC 8540</span>, <span class="seriesInfo">DOI 10.17487/RFC8540</span>, <time class="refDate" datetime="2019-02">February 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8540">https://www.rfc-editor.org/info/rfc8540</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="sec_crc32c">
<section id="appendix-A">
      <h2 id="name-crc32c-checksum-calculation-2">
<a class="section-number selfRef" href="#appendix-A">Appendix A. </a><a class="section-name selfRef" href="#name-crc32c-checksum-calculation-2">CRC32c Checksum Calculation</a>
      </h2>
<p id="appendix-A-1">We define a 'reflected value' as one that is the opposite of the normal
bit order of the machine.
The 32-bit CRC (Cyclic Redundancy Check) is calculated, as described for CRC32c
and uses the polynomial code 0x11EDC6F41 (Castagnoli93) or
x<sup>32</sup>+x<sup>28</sup>+x<sup>27</sup>+x<sup>26</sup>+x<sup>25</sup>+x<sup>23</sup>+x<sup>22</sup>+x<sup>20</sup>+x<sup>19</sup>+x<sup>18</sup>+x<sup>14</sup>+x<sup>13</sup>+x<sup>11</sup>+x<sup>10</sup>+x<sup>9</sup>+x<sup>8</sup>+x<sup>6</sup>+x<sup>0</sup>.
The CRC is computed using a procedure similar to
ETHERNET CRC <span>[<a class="xref" href="#ITU.V42.1994">ITU.V42.1994</a>]</span>, modified to reflect
transport-level usage.<a class="pilcrow" href="#appendix-A-1">Â¶</a></p>
<p id="appendix-A-2">CRC computation uses polynomial division. A message bit-string M is
transformed to a polynomial, M(X), and the CRC is calculated from M(X) using
polynomial arithmetic.<a class="pilcrow" href="#appendix-A-2">Â¶</a></p>
<p id="appendix-A-3">When CRCs are used at the link layer, the polynomial is derived from
on-the-wire bit ordering: the first bit 'on the wire' is the high-order
coefficient.
Since SCTP is a transport-level protocol, it cannot know the actual
serial-media bit ordering.
Moreover, different links in the path between SCTP endpoints can use different
link-level bit orders.<a class="pilcrow" href="#appendix-A-3">Â¶</a></p>
<p id="appendix-A-4">A convention therefore is established for mapping SCTP transport
messages to polynomials for purposes of CRC computation.
The bit-ordering for mapping SCTP messages to polynomials is that bytes are
taken most-significant first, but, within each byte, bits are taken
least-significant first.
The first byte of the message provides the eight highest coefficients.
Within each byte, the least-significant SCTP bit gives the most-significant
polynomial coefficient within that byte, and the most-significant SCTP bit is
the least-significant polynomial coefficient in that byte.
(This bit ordering is sometimes called 'mirrored' or 'reflected'
<span>[<a class="xref" href="#WILLIAMS93">WILLIAMS93</a>]</span>.)
CRC polynomials are to be transformed back into SCTP transport-level
byte values, using a consistent mapping.<a class="pilcrow" href="#appendix-A-4">Â¶</a></p>
<p id="appendix-A-5">The SCTP transport-level CRC value can be calculated as follows:<a class="pilcrow" href="#appendix-A-5">Â¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-6.1">
          <p id="appendix-A-6.1.1">CRC input data is assigned to a byte stream, numbered from 0 to N-1.<a class="pilcrow" href="#appendix-A-6.1.1">Â¶</a></p>
</li>
        <li class="normal" id="appendix-A-6.2">
          <p id="appendix-A-6.2.1">The transport-level byte stream is mapped to a polynomial value.
An N-byte PDU with j bytes numbered 0 to N-1 is considered as
coefficients of a polynomial M(x) of order 8*N-1, with bit 0 of
byte j being coefficient x<sup>8*(N-j)-8</sup> and bit 7 of byte j being
coefficient x<sup>8*(N-j)-1</sup>.<a class="pilcrow" href="#appendix-A-6.2.1">Â¶</a></p>
</li>
        <li class="normal" id="appendix-A-6.3">
          <p id="appendix-A-6.3.1">The CRC remainder register is initialized with all 1s and the CRC is computed
with an algorithm that simultaneously multiplies by x<sup>32</sup> and divides by the
CRC polynomial.<a class="pilcrow" href="#appendix-A-6.3.1">Â¶</a></p>
</li>
        <li class="normal" id="appendix-A-6.4">
          <p id="appendix-A-6.4.1">The polynomial is multiplied by x<sup>32</sup> and divided by G(x), the generator
polynomial, producing a remainder R(x) of degree less than or equal to 31.<a class="pilcrow" href="#appendix-A-6.4.1">Â¶</a></p>
</li>
        <li class="normal" id="appendix-A-6.5">
          <p id="appendix-A-6.5.1">The coefficients of R(x) are considered a 32-bit sequence.<a class="pilcrow" href="#appendix-A-6.5.1">Â¶</a></p>
</li>
        <li class="normal" id="appendix-A-6.6">
          <p id="appendix-A-6.6.1">The bit sequence is complemented.
The result is the CRC polynomial.<a class="pilcrow" href="#appendix-A-6.6.1">Â¶</a></p>
</li>
        <li class="normal" id="appendix-A-6.7">
          <p id="appendix-A-6.7.1">The CRC polynomial is mapped back into SCTP transport-level bytes.
The coefficient of x<sup>31</sup> gives the value of bit 7 of SCTP byte 0,
and the coefficient of x<sup>24</sup> gives the value of bit 0 of byte 0.
The coefficient of x<sup>7</sup> gives bit 7 of byte 3, and the coefficient
of x<sup>0</sup> gives bit 0 of byte 3.
The resulting 4-byte transport-level sequence is the 32-bit SCTP checksum
value.<a class="pilcrow" href="#appendix-A-6.7.1">Â¶</a></p>
</li>
      </ul>
<p id="appendix-A-7">Implementation Note: Standards documents, textbooks, and vendor
literature on CRCs often follow an alternative formulation, in which the
register used to hold the remainder of the long-division algorithm is
initialized to zero rather than all ones, and instead the first 32 bits of the
message are complemented.
The long-division algorithm used in our formulation is specified such that the
initial multiplication by 2<sup>32</sup> and the long-division are combined into one
simultaneous operation.
For such algorithms, and for messages longer than 64 bits, the two
specifications are precisely equivalent.
That equivalence is the intent of this document.<a class="pilcrow" href="#appendix-A-7">Â¶</a></p>
<p id="appendix-A-8">Implementors of SCTP are warned that both specifications are to be
found in the literature, sometimes with no restriction on the long-division
algorithm.
The choice of formulation in this document is to permit non-SCTP usage, where
the same CRC algorithm can be used to protect messages shorter than 64 bits.<a class="pilcrow" href="#appendix-A-8">Â¶</a></p>
<p id="appendix-A-9">There can be a computational advantage in validating the association
against the Verification Tag, prior to performing a checksum, as invalid tags
will result in the same action as a bad checksum in most cases.
The exceptions for this technique would be packets containing INIT chunks and
some SHUTDOWN-COMPLETE chunks, as well as a stale COOKIE ECHO chunks.
These special-case exchanges represent small packets and will minimize
the effect of the checksum calculation.<a class="pilcrow" href="#appendix-A-9">Â¶</a></p>
<p id="appendix-A-10">The following non-normative sample code is taken from an open-source
CRC generator <span>[<a class="xref" href="#WILLIAMS93">WILLIAMS93</a>]</span>, using the "mirroring" technique and
yielding a lookup table for SCTP CRC32c with 256 entries, each 32 bits wide.
While neither especially slow nor especially fast, as software table-lookup
CRCs go, it has the advantage of working on both big-endian and little-endian
CPUs, using the same (host-order) lookup tables, and using only the
predefined ntohl() and htonl() operations.
The code is somewhat modified from <span>[<a class="xref" href="#WILLIAMS93">WILLIAMS93</a>]</span> to ensure
portability between big-endian and little-endian architectures, use fixed-sized
types to allow portability between 32-bit and 64-bit platforms, and use
general C code improvements.
(Note that, if the byte endian-ness of the target architecture is known to be
little endian, the final bit-reversal and byte-reversal steps can be folded
into a single operation.)<a class="pilcrow" href="#appendix-A-10">Â¶</a></p>
<div id="appendix-A-11">
<pre class="breakable lang-c sourcecode">&lt;CODE BEGINS&gt;
/****************************************************************/
/* Note: The definitions for Ross Williams's table generator    */
/* would be TB_WIDTH=4, TB_POLY=0x1EDC6F41, TB_REVER=TRUE.      */
/* For Mr. Williams's direct calculation code, use the settings */
/* cm_width=32, cm_poly=0x1EDC6F41, cm_init=0xFFFFFFFF,         */
/* cm_refin=TRUE, cm_refot=TRUE, cm_xorot=0x00000000.           */
/****************************************************************/

/* Example of the crc table file */
#ifndef __crc32cr_h__
#define __crc32cr_h__

#define CRC32C_POLY 0x1EDC6F41UL
#define CRC32C(c,d) (c=(c&gt;&gt;8)^crc_c[(c^(d))&amp;0xFF])

uint32_t crc_c[256] = {
  0x00000000UL, 0xF26B8303UL, 0xE13B70F7UL, 0x1350F3F4UL,
  0xC79A971FUL, 0x35F1141CUL, 0x26A1E7E8UL, 0xD4CA64EBUL,
  0x8AD958CFUL, 0x78B2DBCCUL, 0x6BE22838UL, 0x9989AB3BUL,
  0x4D43CFD0UL, 0xBF284CD3UL, 0xAC78BF27UL, 0x5E133C24UL,
  0x105EC76FUL, 0xE235446CUL, 0xF165B798UL, 0x030E349BUL,
  0xD7C45070UL, 0x25AFD373UL, 0x36FF2087UL, 0xC494A384UL,
  0x9A879FA0UL, 0x68EC1CA3UL, 0x7BBCEF57UL, 0x89D76C54UL,
  0x5D1D08BFUL, 0xAF768BBCUL, 0xBC267848UL, 0x4E4DFB4BUL,
  0x20BD8EDEUL, 0xD2D60DDDUL, 0xC186FE29UL, 0x33ED7D2AUL,
  0xE72719C1UL, 0x154C9AC2UL, 0x061C6936UL, 0xF477EA35UL,
  0xAA64D611UL, 0x580F5512UL, 0x4B5FA6E6UL, 0xB93425E5UL,
  0x6DFE410EUL, 0x9F95C20DUL, 0x8CC531F9UL, 0x7EAEB2FAUL,
  0x30E349B1UL, 0xC288CAB2UL, 0xD1D83946UL, 0x23B3BA45UL,
  0xF779DEAEUL, 0x05125DADUL, 0x1642AE59UL, 0xE4292D5AUL,
  0xBA3A117EUL, 0x4851927DUL, 0x5B016189UL, 0xA96AE28AUL,
  0x7DA08661UL, 0x8FCB0562UL, 0x9C9BF696UL, 0x6EF07595UL,
  0x417B1DBCUL, 0xB3109EBFUL, 0xA0406D4BUL, 0x522BEE48UL,
  0x86E18AA3UL, 0x748A09A0UL, 0x67DAFA54UL, 0x95B17957UL,
  0xCBA24573UL, 0x39C9C670UL, 0x2A993584UL, 0xD8F2B687UL,
  0x0C38D26CUL, 0xFE53516FUL, 0xED03A29BUL, 0x1F682198UL,
  0x5125DAD3UL, 0xA34E59D0UL, 0xB01EAA24UL, 0x42752927UL,
  0x96BF4DCCUL, 0x64D4CECFUL, 0x77843D3BUL, 0x85EFBE38UL,
  0xDBFC821CUL, 0x2997011FUL, 0x3AC7F2EBUL, 0xC8AC71E8UL,
  0x1C661503UL, 0xEE0D9600UL, 0xFD5D65F4UL, 0x0F36E6F7UL,
  0x61C69362UL, 0x93AD1061UL, 0x80FDE395UL, 0x72966096UL,
  0xA65C047DUL, 0x5437877EUL, 0x4767748AUL, 0xB50CF789UL,
  0xEB1FCBADUL, 0x197448AEUL, 0x0A24BB5AUL, 0xF84F3859UL,
  0x2C855CB2UL, 0xDEEEDFB1UL, 0xCDBE2C45UL, 0x3FD5AF46UL,
  0x7198540DUL, 0x83F3D70EUL, 0x90A324FAUL, 0x62C8A7F9UL,
  0xB602C312UL, 0x44694011UL, 0x5739B3E5UL, 0xA55230E6UL,
  0xFB410CC2UL, 0x092A8FC1UL, 0x1A7A7C35UL, 0xE811FF36UL,
  0x3CDB9BDDUL, 0xCEB018DEUL, 0xDDE0EB2AUL, 0x2F8B6829UL,
  0x82F63B78UL, 0x709DB87BUL, 0x63CD4B8FUL, 0x91A6C88CUL,
  0x456CAC67UL, 0xB7072F64UL, 0xA457DC90UL, 0x563C5F93UL,
  0x082F63B7UL, 0xFA44E0B4UL, 0xE9141340UL, 0x1B7F9043UL,
  0xCFB5F4A8UL, 0x3DDE77ABUL, 0x2E8E845FUL, 0xDCE5075CUL,
  0x92A8FC17UL, 0x60C37F14UL, 0x73938CE0UL, 0x81F80FE3UL,
  0x55326B08UL, 0xA759E80BUL, 0xB4091BFFUL, 0x466298FCUL,
  0x1871A4D8UL, 0xEA1A27DBUL, 0xF94AD42FUL, 0x0B21572CUL,
  0xDFEB33C7UL, 0x2D80B0C4UL, 0x3ED04330UL, 0xCCBBC033UL,
  0xA24BB5A6UL, 0x502036A5UL, 0x4370C551UL, 0xB11B4652UL,
  0x65D122B9UL, 0x97BAA1BAUL, 0x84EA524EUL, 0x7681D14DUL,
  0x2892ED69UL, 0xDAF96E6AUL, 0xC9A99D9EUL, 0x3BC21E9DUL,
  0xEF087A76UL, 0x1D63F975UL, 0x0E330A81UL, 0xFC588982UL,
  0xB21572C9UL, 0x407EF1CAUL, 0x532E023EUL, 0xA145813DUL,
  0x758FE5D6UL, 0x87E466D5UL, 0x94B49521UL, 0x66DF1622UL,
  0x38CC2A06UL, 0xCAA7A905UL, 0xD9F75AF1UL, 0x2B9CD9F2UL,
  0xFF56BD19UL, 0x0D3D3E1AUL, 0x1E6DCDEEUL, 0xEC064EEDUL,
  0xC38D26C4UL, 0x31E6A5C7UL, 0x22B65633UL, 0xD0DDD530UL,
  0x0417B1DBUL, 0xF67C32D8UL, 0xE52CC12CUL, 0x1747422FUL,
  0x49547E0BUL, 0xBB3FFD08UL, 0xA86F0EFCUL, 0x5A048DFFUL,
  0x8ECEE914UL, 0x7CA56A17UL, 0x6FF599E3UL, 0x9D9E1AE0UL,
  0xD3D3E1ABUL, 0x21B862A8UL, 0x32E8915CUL, 0xC083125FUL,
  0x144976B4UL, 0xE622F5B7UL, 0xF5720643UL, 0x07198540UL,
  0x590AB964UL, 0xAB613A67UL, 0xB831C993UL, 0x4A5A4A90UL,
  0x9E902E7BUL, 0x6CFBAD78UL, 0x7FAB5E8CUL, 0x8DC0DD8FUL,
  0xE330A81AUL, 0x115B2B19UL, 0x020BD8EDUL, 0xF0605BEEUL,
  0x24AA3F05UL, 0xD6C1BC06UL, 0xC5914FF2UL, 0x37FACCF1UL,
  0x69E9F0D5UL, 0x9B8273D6UL, 0x88D28022UL, 0x7AB90321UL,
  0xAE7367CAUL, 0x5C18E4C9UL, 0x4F48173DUL, 0xBD23943EUL,
  0xF36E6F75UL, 0x0105EC76UL, 0x12551F82UL, 0xE03E9C81UL,
  0x34F4F86AUL, 0xC69F7B69UL, 0xD5CF889DUL, 0x27A40B9EUL,
  0x79B737BAUL, 0x8BDCB4B9UL, 0x988C474DUL, 0x6AE7C44EUL,
  0xBE2DA0A5UL, 0x4C4623A6UL, 0x5F16D052UL, 0xAD7D5351UL,
};

#endif


/* Example of table build routine */

#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;

#define OUTPUT_FILE   "crc32cr.h"
#define CRC32C_POLY    0x1EDC6F41UL

static FILE *tf;

static uint32_t
reflect_32(uint32_t b)
{
  int i;
  uint32_t rw = 0UL;

  for (i = 0; i &lt; 32; i++) {
    if (b &amp; 1)
      rw |= 1UL &lt;&lt; (31 - i);
    b &gt;&gt;= 1;
  }
  return (rw);
}

static uint32_t
build_crc_table (int index)
{
  int i;
  uint32_t rb;

  rb = reflect_32(index);

  for (i = 0; i &lt; 8; i++) {
    if (rb &amp; 0x80000000UL)
      rb = (rb &lt;&lt; 1) ^ (uint32_t)CRC32C_POLY;
    else
      rb &lt;&lt;= 1;
  }
  return (reflect_32(rb));
}

int
main (void)
{
  int i;

  printf("\nGenerating CRC32c table file &lt;%s&gt;.\n",
  OUTPUT_FILE);
  if ((tf = fopen(OUTPUT_FILE, "w")) == NULL) {
    printf("Unable to open %s.\n", OUTPUT_FILE);
    exit (1);
  }
  fprintf(tf, "#ifndef __crc32cr_h__\n");
  fprintf(tf, "#define __crc32cr_h__\n\n");
  fprintf(tf, "#define CRC32C_POLY 0x%08XUL\n",
    (uint32_t)CRC32C_POLY);
  fprintf(tf,
    "#define CRC32C(c,d) (c=(c&gt;&gt;8)^crc_c[(c^(d))&amp;0xFF])\n");
  fprintf(tf, "\nuint32_t crc_c[256] =\n{\n");
  for (i = 0; i &lt; 256; i++) {
    fprintf(tf, "0x%08XUL,", build_crc_table (i));
    if ((i &amp; 3) == 3)
      fprintf(tf, "\n");
    else
      fprintf(tf, " ");
  }
  fprintf(tf, "};\n\n#endif\n");

  if (fclose(tf) != 0)
    printf("Unable to close &lt;%s&gt;.\n", OUTPUT_FILE);
  else
    printf("\nThe CRC32c table has been written to &lt;%s&gt;.\n",
      OUTPUT_FILE);
  return (0);
}

/* Example of crc insertion */

#include "crc32cr.h"

uint32_t
generate_crc32c(unsigned char *buffer, unsigned int length)
{
  unsigned int i;
  uint32_t crc32 = 0xffffffffUL;
  uint32_t result;
  uint32_t byte0, byte1, byte2, byte3;

  for (i = 0; i &lt; length; i++) {
    CRC32C(crc32, buffer[i]);
  }

  result = ~crc32;

  /*  result now holds the negated polynomial remainder,
   *  since the table and algorithm are "reflected" [williams95].
   *  That is, result has the same value as if we mapped the message
   *  to a polynomial, computed the host-bit-order polynomial
   *  remainder, performed final negation, and then did an
   *  end-for-end bit-reversal.
   *  Note that a 32-bit bit-reversal is identical to four in-place
   *  8-bit bit-reversals followed by an end-for-end byteswap.
   *  In other words, the bits of each byte are in the right order,
   *  but the bytes have been byteswapped.  So, we now do an explicit
   *  byteswap.  On a little-endian machine, this byteswap and
   *  the final ntohl cancel out and could be elided.
   */

  byte0 = result &amp; 0xff;
  byte1 = (result&gt;&gt;8) &amp; 0xff;
  byte2 = (result&gt;&gt;16) &amp; 0xff;
  byte3 = (result&gt;&gt;24) &amp; 0xff;
  crc32 = ((byte0 &lt;&lt; 24) |
           (byte1 &lt;&lt; 16) |
           (byte2 &lt;&lt; 8)  |
           byte3);
  return (crc32);
}

int
insert_crc32(unsigned char *buffer, unsigned int length)
{
  SCTP_message *message;
  uint32_t crc32;

  message = (SCTP_message *)buffer;
  message-&gt;common_header.checksum = 0UL;
  crc32 = generate_crc32c(buffer,length);
  /* and insert it into the message */
  message-&gt;common_header.checksum = htonl(crc32);
  return (1);
}

int
validate_crc32(unsigned char *buffer, unsigned int length)
{
  SCTP_message *message;
  unsigned int i;
  uint32_t original_crc32;
  uint32_t crc32;

  /* save and zero checksum */
  message = (SCTP_message *)buffer;
  original_crc32 = ntohl(message-&gt;common_header.checksum);
  message-&gt;common_header.checksum = 0L;
  crc32 = generate_crc32c(buffer, length);
  return ((original_crc32 == crc32) ? 1 : -1);
}
&lt;CODE ENDS&gt;
</pre><a class="pilcrow" href="#appendix-A-11">Â¶</a>
</div>
</section>
</div>
<div id="sec_acknowledgements">
<section id="appendix-B">
      <h2 id="name-acknowledgements">
<a class="section-name selfRef" href="#name-acknowledgements">Acknowledgements</a>
      </h2>
<p id="appendix-B-1">An undertaking represented by this updated document is not a small
feat and represents the summation of the initial coauthors of
<span>[<a class="xref" href="#RFC2960">RFC2960</a>]</span>:
<span class="contact-name">Q. Xie</span>,
<span class="contact-name">K. Morneault</span>,
<span class="contact-name">C. Sharp</span>,
<span class="contact-name">H. Schwarzbauer</span>,
<span class="contact-name">T. Taylor</span>,
<span class="contact-name">I. Rytina</span>,
<span class="contact-name">M. Kalla</span>,
<span class="contact-name">L. Zhang</span>,
and <span class="contact-name">V.Â Paxson</span>.<a class="pilcrow" href="#appendix-B-1">Â¶</a></p>
<p id="appendix-B-2">Add to that, the comments from everyone who contributed to
<span>[<a class="xref" href="#RFC2960">RFC2960</a>]</span>:
<span class="contact-name">Mark Allman</span>,
<span class="contact-name">R. J. Atkinson</span>,
<span class="contact-name">Richard Band</span>,
<span class="contact-name">Scott Bradner</span>,
<span class="contact-name">Steve Bellovin</span>,
<span class="contact-name">Peter Butler</span>,
<span class="contact-name">Ram Dantu</span>,
<span class="contact-name">R. Ezhirpavai</span>,
<span class="contact-name">Mike Fisk</span>,
<span class="contact-name">Sally Floyd</span>,
<span class="contact-name">Atsushi Fukumoto</span>,
<span class="contact-name">Matt Holdrege</span>,
<span class="contact-name">Henry Houh</span>,
<span class="contact-name">Christian Huitema</span>,
<span class="contact-name">Gary Lehecka</span>,
<span class="contact-name">Jonathan Lee</span>,
<span class="contact-name">David Lehmann</span>,
<span class="contact-name">John Loughney</span>,
<span class="contact-name">Daniel Luan</span>,
<span class="contact-name">Barry Nagelberg</span>,
<span class="contact-name">Thomas Narten</span>,
<span class="contact-name">Erik Nordmark</span>,
<span class="contact-name">Lyndon Ong</span>,
<span class="contact-name">Shyamal Prasad</span>,
<span class="contact-name">Kelvin Porter</span>,
<span class="contact-name">Heinz Prantner</span>,
<span class="contact-name">Jarno Rajahalme</span>,
<span class="contact-name">Raymond E. Reeves</span>,
<span class="contact-name">Renee Revis</span>,
<span class="contact-name">Ivan Arias Rodriguez</span>,
<span class="contact-name">A. Sankar</span>,
<span class="contact-name">Greg Sidebottom</span>,
<span class="contact-name">Brian Wyld</span>,
<span class="contact-name">La Monte Yarroll</span>,
and many others for their invaluable comments.<a class="pilcrow" href="#appendix-B-2">Â¶</a></p>
<p id="appendix-B-3">Then, add the coauthors of <span>[<a class="xref" href="#RFC4460">RFC4460</a>]</span>:
<span class="contact-name">I. Arias-Rodriguez</span>,
<span class="contact-name">K. Poon</span>,
and
<span class="contact-name">A. Caro.</span><a class="pilcrow" href="#appendix-B-3">Â¶</a></p>
<p id="appendix-B-4">Then, add to these the efforts of all the subsequent seven
SCTP interoperability tests and those who commented on <span>[<a class="xref" href="#RFC4460">RFC4460</a>]</span>,
as shown in its acknowledgements:
<span class="contact-name">Barry Zuckerman</span>,
<span class="contact-name">La Monte Yarroll</span>,
<span class="contact-name">Qiaobing Xie</span>,
<span class="contact-name">Wang Xiaopeng</span>,
<span class="contact-name">Jonathan Wood</span>,
<span class="contact-name">Jeff Waskow</span>,
<span class="contact-name">Mike Turner</span>,
<span class="contact-name">John Townsend</span>,
<span class="contact-name">Sabina Torrente</span>,
<span class="contact-name">Cliff Thomas</span>,
<span class="contact-name">Yuji Suzuki</span>,
<span class="contact-name">Manoj Solanki</span>,
<span class="contact-name">Sverre Slotte</span>,
<span class="contact-name">Keyur Shah</span>,
<span class="contact-name">Jan Rovins</span>,
<span class="contact-name">Ben Robinson</span>,
<span class="contact-name">Renee Revis</span>,
<span class="contact-name">Ian Periam</span>,
<span class="contact-name">RC Monee</span>,
<span class="contact-name">Sanjay Rao</span>,
<span class="contact-name">Sujith Radhakrishnan</span>,
<span class="contact-name">Heinz Prantner</span>,
<span class="contact-name">Biren Patel</span>,
<span class="contact-name">Nathalie Mouellic</span>,
<span class="contact-name">Mitch Miers</span>,
<span class="contact-name">Bernward Meyknecht</span>,
<span class="contact-name">Stan McClellan</span>,
<span class="contact-name">Oliver Mayor</span>,
<span class="contact-name">Tomas Orti Martin</span>,
<span class="contact-name">Sandeep Mahajan</span>,
<span class="contact-name">David Lehmann</span>,
<span class="contact-name">Jonathan Lee</span>,
<span class="contact-name">Philippe Langlois</span>,
<span class="contact-name">Karl Knutson</span>,
<span class="contact-name">Joe Keller</span>,
<span class="contact-name">Gareth Keily</span>,
<span class="contact-name">Andreas Jungmaier</span>,
<span class="contact-name">Janardhan Iyengar</span>,
<span class="contact-name">Mutsuya Irie</span>,
<span class="contact-name">John Hebert</span>,
<span class="contact-name">Kausar Hassan</span>,
<span class="contact-name">Fred Hasle</span>,
<span class="contact-name">Dan Harrison</span>,
<span class="contact-name">Jon Grim</span>,
<span class="contact-name">Laurent Glaude</span>,
<span class="contact-name">Steven Furniss</span>,
<span class="contact-name">Atsushi Fukumoto</span>,
<span class="contact-name">Ken Fujita</span>,
<span class="contact-name">Steve Dimig</span>,
<span class="contact-name">Thomas Curran</span>,
<span class="contact-name">Serkan Cil</span>,
<span class="contact-name">Melissa Campbell</span>,
<span class="contact-name">Peter Butler</span>,
<span class="contact-name">Rob Brennan</span>,
<span class="contact-name">Harsh Bhondwe</span>,
<span class="contact-name">Brian Bidulock</span>,
<span class="contact-name">Caitlin Bestler</span>,
<span class="contact-name">Jon Berger</span>,
<span class="contact-name">Robby Benedyk</span>,
<span class="contact-name">Stephen Baucke</span>,
<span class="contact-name">Sandeep Balani</span>,
and
<span class="contact-name">Ronnie Sellar</span>.<a class="pilcrow" href="#appendix-B-4">Â¶</a></p>
<p id="appendix-B-5">A special thanks to <span class="contact-name">Mark Allman</span>, who actually should
have been a coauthor of <span>[<a class="xref" href="#RFC4460">RFC4460</a>]</span> for his work on the max-burst but managed to wiggle out due to a
technicality.<a class="pilcrow" href="#appendix-B-5">Â¶</a></p>
<p id="appendix-B-6">Also, we would like to acknowledge <span class="contact-name">Lyndon Ong</span> and
<span class="contact-name">Phil Conrad</span> for their valuable input and many
contributions.<a class="pilcrow" href="#appendix-B-6">Â¶</a></p>
<p id="appendix-B-7">Furthermore, you have <span>[<a class="xref" href="#RFC4960">RFC4960</a>]</span> and those who have commented
upon that, including <span class="contact-name">Alfred HÃ¶nes</span> and
<span class="contact-name">Ronnie Sellars</span>.<a class="pilcrow" href="#appendix-B-7">Â¶</a></p>
<p id="appendix-B-8">Then, add the coauthor of <span>[<a class="xref" href="#RFC8540">RFC8540</a>]</span>:
<span class="contact-name">Maksim Proshin</span>.<a class="pilcrow" href="#appendix-B-8">Â¶</a></p>
<p id="appendix-B-9">And people who have commented on <span>[<a class="xref" href="#RFC8540">RFC8540</a>]</span>:
<span class="contact-name">Pontus Andersson</span>,
<span class="contact-name">Eric W. Biederman</span>,
<span class="contact-name">Cedric Bonnet</span>,
<span class="contact-name">Spencer Dawkins</span>,
<span class="contact-name">Gorry Fairhurst</span>,
<span class="contact-name">Benjamin Kaduk</span>,
<span class="contact-name">Mirja KÃ¼hlewind</span>,
<span class="contact-name">Peter Lei</span>,
<span class="contact-name">Gyula Marosi</span>,
<span class="contact-name">Lionel Morand</span>,
<span class="contact-name">Jeff Morriss</span>,
<span class="contact-name">Tom Petch</span>,
<span class="contact-name">Kacheong Poon</span>,
<span class="contact-name">Julien Pourtet</span>,
<span class="contact-name">Irene RÃ¼ngeler</span>,
<span class="contact-name">Michael Welzl</span>,
and
<span class="contact-name">Qiaobing Xie</span>.<a class="pilcrow" href="#appendix-B-9">Â¶</a></p>
<p id="appendix-B-10">And, finally, the people who have provided comments for this document, including
<span class="contact-name">Gorry Fairhurst</span>,
<span class="contact-name">Martin Duke</span>,
<span class="contact-name">Benjamin Kaduk</span>,
<span class="contact-name">Tero Kivinen</span>,
<span class="contact-name">Eliot Lear</span>,
<span class="contact-name">Marcelo Ricardo Leitner</span>,
<span class="contact-name">David Mandelberg</span>,
<span class="contact-name">John PreuÃ Mattsson</span>,
<span class="contact-name">Claudio Porfiri</span>,
<span class="contact-name">Maksim Proshin</span>,
<span class="contact-name">Ines Robles</span>,
<span class="contact-name">Timo VÃ¶lker</span>,
<span class="contact-name">Magnus Westerlund</span>,
and
<span class="contact-name">Zhouming</span>.<a class="pilcrow" href="#appendix-B-10">Â¶</a></p>
<p id="appendix-B-11">Our thanks cannot be adequately expressed to all of you who have participated
in the coding, testing, and updating process of this document.
All we can say is, Thank You!<a class="pilcrow" href="#appendix-B-11">Â¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-addresses">
<a class="section-name selfRef" href="#name-authors-addresses">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Randall R. Stewart</span></div>
<div class="left" dir="auto"><span class="org">Netflix, Inc.</span></div>
<div class="left" dir="auto"><span class="street-address">2455 Heritage Green Ave</span></div>
<div class="left" dir="auto">
<span class="locality">Davenport</span>, <span class="region">FL</span> <span class="postal-code">33837</span>
</div>
<div class="left" dir="auto"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:randall@lakerest.net">randall@lakerest.net</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Michael TÃ¼xen</span></div>
<div class="left" dir="auto"><span class="org">MÃ¼nster University of Applied Sciences</span></div>
<div class="left" dir="auto"><span class="street-address">Stegerwaldstrasse 39</span></div>
<div class="left" dir="auto">
<span class="postal-code">48565</span> <span class="locality">Steinfurt</span>
</div>
<div class="left" dir="auto"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:tuexen@fh-muenster.de">tuexen@fh-muenster.de</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Karen E. E. Nielsen</span></div>
<div class="left" dir="auto"><span class="org">Kamstrup A/S</span></div>
<div class="left" dir="auto"><span class="street-address">Industrivej 28</span></div>
<div class="left" dir="auto">
<span class="postal-code">DK-8660</span> <span class="locality">Skanderborg</span>
</div>
<div class="left" dir="auto"><span class="country-name">Denmark</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:kee@kamstrup.com">kee@kamstrup.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>