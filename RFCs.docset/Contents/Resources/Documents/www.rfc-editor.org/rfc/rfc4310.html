<html><head></head><body><pre>Network Working Group                                      S. Hollenbeck
Request for Comments: 4310                                VeriSign, Inc.
Category: Standards Track                                  November 2005


          <span class="h1">Domain Name System (DNS) Security Extensions Mapping</span>
             <span class="h1">for the Extensible Provisioning Protocol (EPP)</span>

Status of this Memo

   This document specifies an Internet standards track protocol for the
   Internet community, and requests discussion and suggestions for
   improvements.  Please refer to the current edition of the "Internet
   Official Protocol Standards" (STD 1) for the standardization state
   and status of this protocol.  Distribution of this memo is unlimited.

Copyright Notice

   Copyright (C) The Internet Society (2005).

Abstract

   This document describes an Extensible Provisioning Protocol (EPP)
   extension mapping for the provisioning and management of Domain Name
   System security extensions (DNSSEC) for domain names stored in a
   shared central repository.  Specified in XML, this mapping extends
   the EPP domain name mapping to provide additional features required
   for the provisioning of DNS security extensions.

Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-2">2</a>
      <a href="#section-1.1">1.1</a>. Conventions Used in This Document ..........................<a href="#page-2">2</a>
   <a href="#section-2">2</a>. Object Attributes ...............................................<a href="#page-3">3</a>
      <a href="#section-2.1">2.1</a>. Delegation Signer Information ..............................<a href="#page-3">3</a>
           <a href="#section-2.1.1">2.1.1</a>. Public Key Information ..............................<a href="#page-3">3</a>
      <a href="#section-2.2">2.2</a>. Booleans ...................................................<a href="#page-3">3</a>
      <a href="#section-2.3">2.3</a>. Maximum Signature Lifetime Values ..........................<a href="#page-4">4</a>
   <a href="#section-3">3</a>. EPP Command Mapping .............................................<a href="#page-4">4</a>
      <a href="#section-3.1">3.1</a>. EPP Query Commands .........................................<a href="#page-4">4</a>
           <a href="#section-3.1.1">3.1.1</a>. EPP &lt;check&gt; Command .................................<a href="#page-4">4</a>
           <a href="#section-3.1.2">3.1.2</a>. EPP &lt;info&gt; Command ..................................<a href="#page-4">4</a>
           <a href="#section-3.1.3">3.1.3</a>. EPP &lt;transfer&gt; Command ..............................<a href="#page-8">8</a>
      <a href="#section-3.2">3.2</a>. EPP Transform Commands .....................................<a href="#page-8">8</a>
           <a href="#section-3.2.1">3.2.1</a>. EPP &lt;create&gt; Command ................................<a href="#page-8">8</a>
           <a href="#section-3.2.2">3.2.2</a>. EPP &lt;delete&gt; Command ...............................<a href="#page-11">11</a>
           <a href="#section-3.2.3">3.2.3</a>. EPP &lt;renew&gt; Command ................................<a href="#page-11">11</a>
           <a href="#section-3.2.4">3.2.4</a>. EPP &lt;transfer&gt; Command .............................<a href="#page-11">11</a>



<span class="grey">Hollenbeck                  Standards Track                     [Page 1]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-2"></span>
<span class="grey"><a href="./rfc4310">RFC 4310</a>          EPP DNS Security Extensions Mapping      November 2005</span>


           <a href="#section-3.2.5">3.2.5</a>. EPP &lt;update&gt; Command ...............................<a href="#page-11">11</a>
   <a href="#section-4">4</a>. Formal Syntax ..................................................<a href="#page-15">15</a>
   <a href="#section-5">5</a>. Internationalization Considerations ............................<a href="#page-18">18</a>
   <a href="#section-6">6</a>. IANA Considerations ............................................<a href="#page-18">18</a>
   <a href="#section-7">7</a>. Security Considerations ........................................<a href="#page-18">18</a>
   <a href="#section-8">8</a>. Acknowledgements ...............................................<a href="#page-20">20</a>
   <a href="#section-9">9</a>. References .....................................................<a href="#page-20">20</a>
      <a href="#section-9.1">9.1</a>. Normative References ......................................<a href="#page-20">20</a>
      <a href="#section-9.2">9.2</a>. Informative References ....................................<a href="#page-21">21</a>

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" id="section-1">1</a>.  Introduction</span>

   This document describes an extension mapping for version 1.0 of the
   Extensible Provisioning Protocol (EPP) described in <a href="./rfc3730">RFC 3730</a> [<a href="#ref-1" title='"Extensible Provisioning Protocol (EPP)"'>1</a>].
   This mapping, an extension of the domain name mapping described in
   <a href="./rfc3731">RFC 3731</a> [<a href="#ref-2" title='"Extensible Provisioning Protocol (EPP) Domain Name Mapping"'>2</a>], is specified using the Extensible Markup Language (XML)
   1.0 [<a href="#ref-3" title='"Extensible Markup Language (XML) 1.0 (Second Edition)"'>3</a>] and XML Schema notation ([<a href="#ref-4" title='"XML Schema Part 1: Structures"'>4</a>], [<a href="#ref-5" title='"XML Schema Part 2: Datatypes"'>5</a>]).

   The EPP core protocol specification [<a href="#ref-1" title='"Extensible Provisioning Protocol (EPP)"'>1</a>] provides a complete
   description of EPP command and response structures.  A thorough
   understanding of the base protocol specification is necessary to
   understand the mapping described in this document.  Familiarity with
   the Domain Name System (DNS) described in <a href="./rfc1034">RFC 1034</a> [<a href="#ref-11" title='"Domain names - concepts and facilities"'>11</a>] and <a href="./rfc1035">RFC 1035</a>
   [<a href="#ref-12" title='"Domain names - implementation and specification"'>12</a>] and with DNS security extensions described in <a href="./rfc4033">RFC 4033</a> [<a href="#ref-13" title='"DNS Security Introduction and Requirements"'>13</a>], <a href="./rfc4034">RFC</a>
   <a href="./rfc4034">4034</a> [<a href="#ref-6" title='"Resource Records for the DNS Security Extensions"'>6</a>], and <a href="./rfc4035">RFC 4035</a> [<a href="#ref-7" title='"Protocol Modifications for the DNS Security Extensions"'>7</a>] is required to understand the DNS security
   concepts described in this document.

   The EPP mapping described in this document specifies a mechanism for
   the provisioning and management of DNS security extensions in a
   shared central repository.  Information exchanged via this mapping
   can be extracted from the repository and used to publish DNSSEC
   delegation signer (DS) resource records as described in <a href="./rfc4034">RFC 4034</a> [<a href="#ref-6" title='"Resource Records for the DNS Security Extensions"'>6</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/1.1.%20%20Conventions%20Used%20in%20This%20Document"></a><a class="selflink" href="#section-1.1" id="section-1.1">1.1</a>.  Conventions Used in This Document</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in <a href="https://www.rfc-editor.org/bcp/bcp14">BCP 14</a>, <a href="./rfc2119">RFC 2119</a> [<a href="#ref-8" title='"Key words for use in RFCs to Indicate Requirement Levels"'>8</a>].

   In examples, "C:" represents lines sent by a protocol client, and
   "S:" represents lines returned by a protocol server. "////" is used
   to note element values that have been shortened to better fit page
   boundaries.  Indentation and white space in examples is provided only
   to illustrate element relationships and is not a mandatory feature of
   this protocol.






<span class="grey">Hollenbeck                  Standards Track                     [Page 2]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-3"></span>
<span class="grey"><a href="./rfc4310">RFC 4310</a>          EPP DNS Security Extensions Mapping      November 2005</span>


   XML is case sensitive.  Unless stated otherwise, XML specifications
   and examples provided in this document MUST be interpreted in the
   character case presented in order to develop a conforming
   implementation.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.%20%20Object%20Attributes"></a><a class="selflink" href="#section-2" id="section-2">2</a>.  Object Attributes</span>

   This extension adds additional elements to the EPP domain name
   mapping [<a href="#ref-2" title='"Extensible Provisioning Protocol (EPP) Domain Name Mapping"'>2</a>].  Only new element descriptions are described here.

   This document describes operational scenarios in which a client can
   create, add, remove, and replace delegation signer (DS) information.
   Key data associated with the DS information MAY be provided by the
   client, but the server is not obligated to use the key data.  The
   server operator MAY also issue out-of-band DNS queries to retrieve
   the key data from the registered domain's apex in order to evaluate
   the received DS information.  It is RECOMMENDED that the child zone
   operator have this key data online in the DNS tree to allow the
   parent zone administrator to validate the data as necessary.  The key
   data SHOULD have the Secure Entry Point (SEP) bit set as described in
   <a href="./rfc3757">RFC 3757</a> [<a href="#ref-9" title='"Domain Name System KEY (DNSKEY) Resource Record (RR) Secure Entry Point (SEP) Flag"'>9</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.1.%20%20Delegation%20Signer%20Information"></a><a class="selflink" href="#section-2.1" id="section-2.1">2.1</a>.  Delegation Signer Information</span>

   Delegation signer (DS) information is published by a DNS server to
   indicate that a child zone is digitally signed and that the parent
   zone recognizes the indicated key as a valid zone key for the child
   zone.  A DS RR contains four fields: a key tag field, a key algorithm
   number octet, an octet identifying the digest algorithm used, and a
   digest field.  See <a href="./rfc4034">RFC 4034</a> [<a href="#ref-6" title='"Resource Records for the DNS Security Extensions"'>6</a>] for specific field formats.

<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.1.1.%20%20Public%20Key%20Information"></a><a class="selflink" href="#section-2.1.1" id="section-2.1.1">2.1.1</a>.  Public Key Information</span>

   Public key information provided by a client maps to the DNSKEY RR
   presentation field formats described in <a href="./rfc4034#section-2.2">section 2.2 of RFC 4034</a> [<a href="#ref-6" title='"Resource Records for the DNS Security Extensions"'>6</a>].
   A DNSKEY RR contains four fields: flags, a protocol octet, an
   algorithm number octet, and a public key.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.2.%20%20Booleans"></a><a class="selflink" href="#section-2.2" id="section-2.2">2.2</a>.  Booleans</span>

   Boolean values MUST be represented in the XML Schema format described
   in Part 2 of the W3C XML Schema recommendation [<a href="#ref-5" title='"XML Schema Part 2: Datatypes"'>5</a>].









<span class="grey">Hollenbeck                  Standards Track                     [Page 3]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-4"></span>
<span class="grey"><a href="./rfc4310">RFC 4310</a>          EPP DNS Security Extensions Mapping      November 2005</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.3.%20%20Maximum%20Signature%20Lifetime%20Values"></a><a class="selflink" href="#section-2.3" id="section-2.3">2.3</a>.  Maximum Signature Lifetime Values</span>

   Maximum signature lifetime values MUST be represented in seconds
   using an extended XML Schema "int" format.  The base "int" format,
   which allows negative numbers, is described in Part 2 of the W3C XML
   Schema recommendation [<a href="#ref-5" title='"XML Schema Part 2: Datatypes"'>5</a>].  This format is further restricted to
   enforce a minimum value of one.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.%20%20EPP%20Command%20Mapping"></a><a class="selflink" href="#section-3" id="section-3">3</a>.  EPP Command Mapping</span>

   A detailed description of the EPP syntax and semantics can be found
   in the EPP core protocol specification [<a href="#ref-1" title='"Extensible Provisioning Protocol (EPP)"'>1</a>].  The command mappings
   described here are specifically for use in provisioning and managing
   DNS security extensions via EPP.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.1.%20%20EPP%20Query%20Commands"></a><a class="selflink" href="#section-3.1" id="section-3.1">3.1</a>.  EPP Query Commands</span>

   EPP provides three commands to retrieve object information: &lt;check&gt;
   to determine if an object is known to the server, &lt;info&gt; to retrieve
   detailed information associated with an object, and &lt;transfer&gt; to
   retrieve object transfer status information.

<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.1.1.%20%20EPP%20%3Ccheck%3E%20Command"></a><a class="selflink" href="#section-3.1.1" id="section-3.1.1">3.1.1</a>.  EPP &lt;check&gt; Command</span>

   This extension does not add any elements to the EPP &lt;check&gt; command
   or &lt;check&gt; response described in the EPP domain mapping [<a href="#ref-2" title='"Extensible Provisioning Protocol (EPP) Domain Name Mapping"'>2</a>].

<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.1.2.%20%20EPP%20%3Cinfo%3E%20Command"></a><a class="selflink" href="#section-3.1.2" id="section-3.1.2">3.1.2</a>.  EPP &lt;info&gt; Command</span>

   This extension does not add any elements to the EPP &lt;info&gt; command
   described in the EPP domain mapping [<a href="#ref-2" title='"Extensible Provisioning Protocol (EPP) Domain Name Mapping"'>2</a>].  Additional elements are
   defined for the &lt;info&gt; response.

   When an &lt;info&gt; command has been processed successfully, the EPP
   &lt;resData&gt; element MUST contain child elements as described in the EPP
   domain mapping [<a href="#ref-2" title='"Extensible Provisioning Protocol (EPP) Domain Name Mapping"'>2</a>].  In addition, the EPP &lt;extension&gt; element MUST
   contain a child &lt;secDNS:infData&gt; element that identifies the
   extension namespace and the location of the extension schema.  The
   &lt;secDNS:infData&gt; element contains the following child elements:

      One or more &lt;secDNS:dsData&gt; elements that describe the delegation
      signer data provided by the client for the domain.  The &lt;secDNS:
      dsData&gt; element contains the following child elements:

         A &lt;secDNS:keyTag&gt; element that contains a key tag value as
         described in <a href="./rfc4034#section-5.1.1">section 5.1.1 of RFC 4034</a> [<a href="#ref-6" title='"Resource Records for the DNS Security Extensions"'>6</a>].





<span class="grey">Hollenbeck                  Standards Track                     [Page 4]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-5"></span>
<span class="grey"><a href="./rfc4310">RFC 4310</a>          EPP DNS Security Extensions Mapping      November 2005</span>


         A &lt;secDNS:alg&gt; element that contains an algorithm value as
         described in <a href="./rfc4034#section-5.1.2">section 5.1.2 of RFC 4034</a> [<a href="#ref-6" title='"Resource Records for the DNS Security Extensions"'>6</a>].

         A &lt;secDNS:digestType&gt; element that contains a digest type value
         as described in <a href="./rfc4034#section-5.1.3">section 5.1.3 of RFC 4034</a> [<a href="#ref-6" title='"Resource Records for the DNS Security Extensions"'>6</a>].

         A &lt;secDNS:digest&gt; element that contains a digest value as
         described in <a href="./rfc4034#section-5.1.4">section 5.1.4 of RFC 4034</a> [<a href="#ref-6" title='"Resource Records for the DNS Security Extensions"'>6</a>].

         An OPTIONAL &lt;secDNS:maxSigLife&gt; element that indicates a
         child's preference for the number of seconds after signature
         generation when the parent's signature on the DS information
         provided by the child will expire.  A client SHOULD specify the
         same &lt;secDNS:maxSigLife&gt; value for all &lt;secDNS:dsData&gt; elements
         associated with a domain.  If the &lt;secDNS:maxSigLife&gt; is not
         present, or if multiple &lt;secDNS:maxSigLife&gt; values are
         requested, the default signature expiration policy of the
         server operator (as determined using an out-of-band mechanism)
         applies.

         An OPTIONAL &lt;secDNS:keyData&gt; element that describes the key
         data used as input in the DS hash calculation.  The &lt;secDNS:
         keyData&gt; element contains the following child elements:

            A &lt;secDNS:flags&gt; element that contains a flags field value
            as described in <a href="./rfc4034#section-2.1.1">section 2.1.1 of RFC 4034</a> [<a href="#ref-6" title='"Resource Records for the DNS Security Extensions"'>6</a>].

            A &lt;secDNS:protocol&gt; element that contains a protocol field
            value as described in <a href="./rfc4034#section-2.1.2">section 2.1.2 of RFC 4034</a> [<a href="#ref-6" title='"Resource Records for the DNS Security Extensions"'>6</a>].

            A &lt;secDNS:alg&gt; element that contains an algorithm number
            field value as described in sections <a href="#section-2.1.3">2.1.3</a> of <a href="./rfc4034">RFC 4034</a> [<a href="#ref-6" title='"Resource Records for the DNS Security Extensions"'>6</a>].

            A &lt;secDNS:pubKey&gt; element that contains an encoded public
            key field value as described in sections <a href="#section-2.1.4">2.1.4</a> of <a href="./rfc4034">RFC 4034</a>
            [<a href="#ref-6" title='"Resource Records for the DNS Security Extensions"'>6</a>].

   Example &lt;info&gt; Response for a Secure Delegation:

   S:&lt;?xml version="1.0" encoding="UTF-8" standalone="no"?&gt;
   S:&lt;epp xmlns="urn:ietf:params:xml:ns:epp-1.0"
   S:     xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   S:     xsi:schemaLocation="urn:ietf:params:xml:ns:epp-1.0
   S:     epp-1.0.xsd"&gt;
   S:  &lt;response&gt;
   S:    &lt;result code="1000"&gt;
   S:      &lt;msg&gt;Command completed successfully&lt;/msg&gt;
   S:    &lt;/result&gt;



<span class="grey">Hollenbeck                  Standards Track                     [Page 5]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-6"></span>
<span class="grey"><a href="./rfc4310">RFC 4310</a>          EPP DNS Security Extensions Mapping      November 2005</span>


   S:    &lt;resData&gt;
   S:      &lt;domain:infData
   S:       xmlns:domain="urn:ietf:params:xml:ns:domain-1.0"
   S:       xsi:schemaLocation="urn:ietf:params:xml:ns:domain-1.0
   S:       domain-1.0.xsd"&gt;
   S:        &lt;domain:name&gt;example.com&lt;/domain:name&gt;
   S:        &lt;domain:roid&gt;EXAMPLE1-REP&lt;/domain:roid&gt;
   S:        &lt;domain:status s="ok"/&gt;
   S:        &lt;domain:registrant&gt;jd1234&lt;/domain:registrant&gt;
   S:        &lt;domain:contact type="admin"&gt;sh8013&lt;/domain:contact&gt;
   S:        &lt;domain:contact type="tech"&gt;sh8013&lt;/domain:contact&gt;
   S:        &lt;domain:ns&gt;
   S:          &lt;domain:hostObj&gt;ns1.example.com&lt;/domain:hostObj&gt;
   S:          &lt;domain:hostObj&gt;ns2.example.com&lt;/domain:hostObj&gt;
   S:        &lt;/domain:ns&gt;
   S:        &lt;domain:host&gt;ns1.example.com&lt;/domain:host&gt;
   S:        &lt;domain:host&gt;ns2.example.com&lt;/domain:host&gt;
   S:        &lt;domain:clID&gt;ClientX&lt;/domain:clID&gt;
   S:        &lt;domain:crID&gt;ClientY&lt;/domain:crID&gt;
   S:        &lt;domain:crDate&gt;1999-04-03T22:00:00.0Z&lt;/domain:crDate&gt;
   S:        &lt;domain:upID&gt;ClientX&lt;/domain:upID&gt;
   S:        &lt;domain:upDate&gt;1999-12-03T09:00:00.0Z&lt;/domain:upDate&gt;
   S:        &lt;domain:exDate&gt;2005-04-03T22:00:00.0Z&lt;/domain:exDate&gt;
   S:        &lt;domain:trDate&gt;2000-04-08T09:00:00.0Z&lt;/domain:trDate&gt;
   S:        &lt;domain:authInfo&gt;
   S:          &lt;domain:pw&gt;2fooBAR&lt;/domain:pw&gt;
   S:        &lt;/domain:authInfo&gt;
   S:      &lt;/domain:infData&gt;
   S:    &lt;/resData&gt;
   S:    &lt;extension&gt;
   S:      &lt;secDNS:infData
   S:       xmlns:secDNS="urn:ietf:params:xml:ns:secDNS-1.0"
   S:       xsi:schemaLocation="urn:ietf:params:xml:ns:secDNS-1.0
   S:       secDNS-1.0.xsd"&gt;
   S:        &lt;secDNS:dsData&gt;
   S:          &lt;secDNS:keyTag&gt;12345&lt;/secDNS:keyTag&gt;
   S:          &lt;secDNS:alg&gt;3&lt;/secDNS:alg&gt;
   S:          &lt;secDNS:digestType&gt;1&lt;/secDNS:digestType&gt;
   S:          &lt;secDNS:digest&gt;49FD46E6C4B45C55D4AC&lt;/secDNS:digest&gt;
   S:        &lt;/secDNS:dsData&gt;
   S:      &lt;/secDNS:infData&gt;
   S:    &lt;/extension&gt;
   S:    &lt;trID&gt;
   S:      &lt;clTRID&gt;ABC-12345&lt;/clTRID&gt;
   S:      &lt;svTRID&gt;54322-XYZ&lt;/svTRID&gt;
   S:    &lt;/trID&gt;
   S:  &lt;/response&gt;
   S:&lt;/epp&gt;



<span class="grey">Hollenbeck                  Standards Track                     [Page 6]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-7"></span>
<span class="grey"><a href="./rfc4310">RFC 4310</a>          EPP DNS Security Extensions Mapping      November 2005</span>


   Example &lt;info&gt; Response for a Secure Delegation with OPTIONAL Data:

   S:&lt;?xml version="1.0" encoding="UTF-8" standalone="no"?&gt;
   S:&lt;epp xmlns="urn:ietf:params:xml:ns:epp-1.0"
   S:     xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   S:     xsi:schemaLocation="urn:ietf:params:xml:ns:epp-1.0
   S:     epp-1.0.xsd"&gt;
   S:  &lt;response&gt;
   S:    &lt;result code="1000"&gt;
   S:      &lt;msg&gt;Command completed successfully&lt;/msg&gt;
   S:    &lt;/result&gt;
   S:    &lt;resData&gt;
   S:      &lt;domain:infData
   S:       xmlns:domain="urn:ietf:params:xml:ns:domain-1.0"
   S:       xsi:schemaLocation="urn:ietf:params:xml:ns:domain-1.0
   S:       domain-1.0.xsd"&gt;
   S:        &lt;domain:name&gt;example.com&lt;/domain:name&gt;
   S:        &lt;domain:roid&gt;EXAMPLE1-REP&lt;/domain:roid&gt;
   S:        &lt;domain:status s="ok"/&gt;
   S:        &lt;domain:registrant&gt;jd1234&lt;/domain:registrant&gt;
   S:        &lt;domain:contact type="admin"&gt;sh8013&lt;/domain:contact&gt;
   S:        &lt;domain:contact type="tech"&gt;sh8013&lt;/domain:contact&gt;
   S:        &lt;domain:ns&gt;
   S:          &lt;domain:hostObj&gt;ns1.example.com&lt;/domain:hostObj&gt;
   S:          &lt;domain:hostObj&gt;ns2.example.com&lt;/domain:hostObj&gt;
   S:        &lt;/domain:ns&gt;
   S:        &lt;domain:host&gt;ns1.example.com&lt;/domain:host&gt;
   S:        &lt;domain:host&gt;ns2.example.com&lt;/domain:host&gt;
   S:        &lt;domain:clID&gt;ClientX&lt;/domain:clID&gt;
   S:        &lt;domain:crID&gt;ClientY&lt;/domain:crID&gt;
   S:        &lt;domain:crDate&gt;1999-04-03T22:00:00.0Z&lt;/domain:crDate&gt;
   S:        &lt;domain:upID&gt;ClientX&lt;/domain:upID&gt;
   S:        &lt;domain:upDate&gt;1999-12-03T09:00:00.0Z&lt;/domain:upDate&gt;
   S:        &lt;domain:exDate&gt;2005-04-03T22:00:00.0Z&lt;/domain:exDate&gt;
   S:        &lt;domain:trDate&gt;2000-04-08T09:00:00.0Z&lt;/domain:trDate&gt;
   S:        &lt;domain:authInfo&gt;
   S:          &lt;domain:pw&gt;2fooBAR&lt;/domain:pw&gt;
   S:        &lt;/domain:authInfo&gt;
   S:      &lt;/domain:infData&gt;
   S:    &lt;/resData&gt;
   S:    &lt;extension&gt;
   S:      &lt;secDNS:infData
   S:       xmlns:secDNS="urn:ietf:params:xml:ns:secDNS-1.0"
   S:       xsi:schemaLocation="urn:ietf:params:xml:ns:secDNS-1.0
   S:       secDNS-1.0.xsd"&gt;
   S:        &lt;secDNS:dsData&gt;
   S:          &lt;secDNS:keyTag&gt;12345&lt;/secDNS:keyTag&gt;
   S:          &lt;secDNS:alg&gt;3&lt;/secDNS:alg&gt;



<span class="grey">Hollenbeck                  Standards Track                     [Page 7]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-8"></span>
<span class="grey"><a href="./rfc4310">RFC 4310</a>          EPP DNS Security Extensions Mapping      November 2005</span>


   S:          &lt;secDNS:digestType&gt;1&lt;/secDNS:digestType&gt;
   S:          &lt;secDNS:digest&gt;49FD46E6C4B45C55D4AC&lt;/secDNS:digest&gt;
   S:          &lt;secDNS:maxSigLife&gt;604800&lt;/secDNS:maxSigLife&gt;
   S:          &lt;secDNS:keyData&gt;
   S:            &lt;secDNS:flags&gt;256&lt;/secDNS:flags&gt;
   S:            &lt;secDNS:protocol&gt;3&lt;/secDNS:protocol&gt;
   S:            &lt;secDNS:alg&gt;1&lt;/secDNS:alg&gt;
   S:            &lt;secDNS:pubKey&gt;AQPJ////4Q==&lt;/secDNS:pubKey&gt;
   S:          &lt;/secDNS:keyData&gt;
   S:        &lt;/secDNS:dsData&gt;
   S:      &lt;/secDNS:infData&gt;
   S:    &lt;/extension&gt;
   S:    &lt;trID&gt;
   S:      &lt;clTRID&gt;ABC-12345&lt;/clTRID&gt;
   S:      &lt;svTRID&gt;54322-XYZ&lt;/svTRID&gt;
   S:    &lt;/trID&gt;
   S:  &lt;/response&gt;
   S:&lt;/epp&gt;

   An EPP error response MUST be returned if an &lt;info&gt; command can not
   be processed for any reason.

<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.1.3.%20%20EPP%20%3Ctransfer%3E%20Command"></a><a class="selflink" href="#section-3.1.3" id="section-3.1.3">3.1.3</a>.  EPP &lt;transfer&gt; Command</span>

   This extension does not add any elements to the EPP &lt;transfer&gt;
   command or &lt;transfer&gt; response described in the EPP domain mapping
   [<a href="#ref-2" title='"Extensible Provisioning Protocol (EPP) Domain Name Mapping"'>2</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.2.%20%20EPP%20Transform%20Commands"></a><a class="selflink" href="#section-3.2" id="section-3.2">3.2</a>.  EPP Transform Commands</span>

   EPP provides five commands to transform objects: &lt;create&gt; to create
   an instance of an object, &lt;delete&gt; to delete an instance of an
   object, &lt;renew&gt; to extend the validity period of an object,
   &lt;transfer&gt; to manage object sponsorship changes, and &lt;update&gt; to
   change information associated with an object.

<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.2.1.%20%20EPP%20%3Ccreate%3E%20Command"></a><a class="selflink" href="#section-3.2.1" id="section-3.2.1">3.2.1</a>.  EPP &lt;create&gt; Command</span>

   This extension defines additional elements for the EPP &lt;create&gt;
   command described in the EPP domain mapping [<a href="#ref-2" title='"Extensible Provisioning Protocol (EPP) Domain Name Mapping"'>2</a>].  No additional
   elements are defined for the EPP &lt;create&gt; response.

   The EPP &lt;create&gt; command provides a transform operation that allows a
   client to create a domain object.  In addition to the EPP command
   elements described in the EPP domain mapping [<a href="#ref-2" title='"Extensible Provisioning Protocol (EPP) Domain Name Mapping"'>2</a>], the command MUST
   contain an &lt;extension&gt; element.  The &lt;extension&gt; element MUST contain
   a child &lt;secDNS:create&gt; element that identifies the extension
   namespace and the location of the extension schema.  The &lt;secDNS:



<span class="grey">Hollenbeck                  Standards Track                     [Page 8]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-9"></span>
<span class="grey"><a href="./rfc4310">RFC 4310</a>          EPP DNS Security Extensions Mapping      November 2005</span>


   create&gt; element MUST contain one or more &lt;secDNS:dsData&gt; elements.
   Child elements of the &lt;secDNS:dsData&gt; element are described in
   <a href="#section-3.1.2">Section 3.1.2</a>.

   The &lt;secDNS:dsData&gt; element contains OPTIONAL &lt;secDNS:maxSigLife&gt; and
   &lt;secDNS:keyData&gt; elements.  The server MUST abort command processing
   and respond with an appropriate EPP error if the values provided by
   the client can not be accepted for syntax or policy reasons.

   Example &lt;create&gt; Command for a Secure Delegation:

   C:&lt;?xml version="1.0" encoding="UTF-8" standalone="no"?&gt;
   C:&lt;epp xmlns="urn:ietf:params:xml:ns:epp-1.0"
   C:     xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   C:     xsi:schemaLocation="urn:ietf:params:xml:ns:epp-1.0
   C:     epp-1.0.xsd"&gt;
   C:  &lt;command&gt;
   C:    &lt;create&gt;
   C:      &lt;domain:create
   C:       xmlns:domain="urn:ietf:params:xml:ns:domain-1.0"
   C:       xsi:schemaLocation="urn:ietf:params:xml:ns:domain-1.0
   C:       domain-1.0.xsd"&gt;
   C:        &lt;domain:name&gt;example.com&lt;/domain:name&gt;
   C:        &lt;domain:period unit="y"&gt;2&lt;/domain:period&gt;
   C:        &lt;domain:ns&gt;
   C:          &lt;domain:hostObj&gt;ns1.example.com&lt;/domain:hostObj&gt;
   C:          &lt;domain:hostObj&gt;ns2.example.com&lt;/domain:hostObj&gt;
   C:        &lt;/domain:ns&gt;
   C:        &lt;domain:registrant&gt;jd1234&lt;/domain:registrant&gt;
   C:        &lt;domain:contact type="admin"&gt;sh8013&lt;/domain:contact&gt;
   C:        &lt;domain:contact type="tech"&gt;sh8013&lt;/domain:contact&gt;
   C:        &lt;domain:authInfo&gt;
   C:          &lt;domain:pw&gt;2fooBAR&lt;/domain:pw&gt;
   C:        &lt;/domain:authInfo&gt;
   C:      &lt;/domain:create&gt;
   C:    &lt;/create&gt;
   C:    &lt;extension&gt;
   C:      &lt;secDNS:create
   C:       xmlns:secDNS="urn:ietf:params:xml:ns:secDNS-1.0"
   C:       xsi:schemaLocation="urn:ietf:params:xml:ns:secDNS-1.0
   C:       secDNS-1.0.xsd"&gt;
   C:        &lt;secDNS:dsData&gt;
   C:          &lt;secDNS:keyTag&gt;12345&lt;/secDNS:keyTag&gt;
   C:          &lt;secDNS:alg&gt;3&lt;/secDNS:alg&gt;
   C:          &lt;secDNS:digestType&gt;1&lt;/secDNS:digestType&gt;
   C:          &lt;secDNS:digest&gt;49FD46E6C4B45C55D4AC&lt;/secDNS:digest&gt;
   C:        &lt;/secDNS:dsData&gt;
   C:      &lt;/secDNS:create&gt;



<span class="grey">Hollenbeck                  Standards Track                     [Page 9]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-10"></span>
<span class="grey"><a href="./rfc4310">RFC 4310</a>          EPP DNS Security Extensions Mapping      November 2005</span>


   C:    &lt;/extension&gt;
   C:    &lt;clTRID&gt;ABC-12345&lt;/clTRID&gt;
   C:  &lt;/command&gt;
   C:&lt;/epp&gt;


   Example &lt;create&gt; Command for a Secure Delegation with OPTIONAL data:

   C:&lt;?xml version="1.0" encoding="UTF-8" standalone="no"?&gt;
   C:&lt;epp xmlns="urn:ietf:params:xml:ns:epp-1.0"
   C:     xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   C:     xsi:schemaLocation="urn:ietf:params:xml:ns:epp-1.0
   C:     epp-1.0.xsd"&gt;
   C:  &lt;command&gt;
   C:    &lt;create&gt;
   C:      &lt;domain:create
   C:       xmlns:domain="urn:ietf:params:xml:ns:domain-1.0"
   C:       xsi:schemaLocation="urn:ietf:params:xml:ns:domain-1.0
   C:       domain-1.0.xsd"&gt;
   C:        &lt;domain:name&gt;example.com&lt;/domain:name&gt;
   C:        &lt;domain:period unit="y"&gt;2&lt;/domain:period&gt;
   C:        &lt;domain:ns&gt;
   C:          &lt;domain:hostObj&gt;ns1.example.com&lt;/domain:hostObj&gt;
   C:          &lt;domain:hostObj&gt;ns2.example.com&lt;/domain:hostObj&gt;
   C:        &lt;/domain:ns&gt;
   C:        &lt;domain:registrant&gt;jd1234&lt;/domain:registrant&gt;
   C:        &lt;domain:contact type="admin"&gt;sh8013&lt;/domain:contact&gt;
   C:        &lt;domain:contact type="tech"&gt;sh8013&lt;/domain:contact&gt;
   C:        &lt;domain:authInfo&gt;
   C:          &lt;domain:pw&gt;2fooBAR&lt;/domain:pw&gt;
   C:        &lt;/domain:authInfo&gt;
   C:      &lt;/domain:create&gt;
   C:    &lt;/create&gt;
   C:    &lt;extension&gt;
   C:      &lt;secDNS:create
   C:       xmlns:secDNS="urn:ietf:params:xml:ns:secDNS-1.0"
   C:       xsi:schemaLocation="urn:ietf:params:xml:ns:secDNS-1.0
   C:       secDNS-1.0.xsd"&gt;
   C:        &lt;secDNS:dsData&gt;
   C:          &lt;secDNS:keyTag&gt;12345&lt;/secDNS:keyTag&gt;
   C:          &lt;secDNS:alg&gt;3&lt;/secDNS:alg&gt;
   C:          &lt;secDNS:digestType&gt;1&lt;/secDNS:digestType&gt;
   C:          &lt;secDNS:digest&gt;49FD46E6C4B45C55D4AC&lt;/secDNS:digest&gt;
   C:          &lt;secDNS:maxSigLife&gt;604800&lt;/secDNS:maxSigLife&gt;
   C:          &lt;secDNS:keyData&gt;
   C:            &lt;secDNS:flags&gt;256&lt;/secDNS:flags&gt;
   C:            &lt;secDNS:protocol&gt;3&lt;/secDNS:protocol&gt;
   C:            &lt;secDNS:alg&gt;1&lt;/secDNS:alg&gt;



<span class="grey">Hollenbeck                  Standards Track                    [Page 10]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-11"></span>
<span class="grey"><a href="./rfc4310">RFC 4310</a>          EPP DNS Security Extensions Mapping      November 2005</span>


   C:            &lt;secDNS:pubKey&gt;AQPJ////4Q==&lt;/secDNS:pubKey&gt;
   C:          &lt;/secDNS:keyData&gt;
   C:        &lt;/secDNS:dsData&gt;
   C:      &lt;/secDNS:create&gt;
   C:    &lt;/extension&gt;
   C:    &lt;clTRID&gt;ABC-12345&lt;/clTRID&gt;
   C:  &lt;/command&gt;
   C:&lt;/epp&gt;

   When a &lt;create&gt; command has been processed successfully, the EPP
   response is as described in the EPP domain mapping [<a href="#ref-2" title='"Extensible Provisioning Protocol (EPP) Domain Name Mapping"'>2</a>].

<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.2.2.%20%20EPP%20%3Cdelete%3E%20Command"></a><a class="selflink" href="#section-3.2.2" id="section-3.2.2">3.2.2</a>.  EPP &lt;delete&gt; Command</span>

   This extension does not add any elements to the EPP &lt;delete&gt; command
   or &lt;delete&gt; response described in the EPP domain mapping [<a href="#ref-2" title='"Extensible Provisioning Protocol (EPP) Domain Name Mapping"'>2</a>].

<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.2.3.%20%20EPP%20%3Crenew%3E%20Command"></a><a class="selflink" href="#section-3.2.3" id="section-3.2.3">3.2.3</a>.  EPP &lt;renew&gt; Command</span>

   This extension does not add any elements to the EPP &lt;renew&gt; command
   or &lt;renew&gt; response described in the EPP domain mapping [<a href="#ref-2" title='"Extensible Provisioning Protocol (EPP) Domain Name Mapping"'>2</a>].

<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.2.4.%20%20EPP%20%3Ctransfer%3E%20Command"></a><a class="selflink" href="#section-3.2.4" id="section-3.2.4">3.2.4</a>.  EPP &lt;transfer&gt; Command</span>

   This extension does not add any elements to the EPP &lt;transfer&gt;
   command or &lt;transfer&gt; response described in the EPP domain mapping
   [<a href="#ref-2" title='"Extensible Provisioning Protocol (EPP) Domain Name Mapping"'>2</a>].

<span class="h4"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.2.5.%20%20EPP%20%3Cupdate%3E%20Command"></a><a class="selflink" href="#section-3.2.5" id="section-3.2.5">3.2.5</a>.  EPP &lt;update&gt; Command</span>

   This extension defines additional elements for the EPP &lt;update&gt;
   command described in the EPP domain mapping [<a href="#ref-2" title='"Extensible Provisioning Protocol (EPP) Domain Name Mapping"'>2</a>].  No additional
   elements are defined for the EPP &lt;update&gt; response.

   The EPP &lt;update&gt; command provides a transform operation that allows a
   client to modify the attributes of a domain object.  In addition to
   the EPP command elements described in the EPP domain mapping, the
   command MUST contain an &lt;extension&gt; element.  The &lt;extension&gt; element
   MUST contain a child &lt;secDNS:update&gt; element that identifies the
   extension namespace and the location of the extension schema.  The
   &lt;secDNS:update&gt; element contains a &lt;secDNS:add&gt; element to add
   security information to a delegation, a &lt;secDNS:rem&gt; element to
   remove security information from a delegation, or a &lt;secDNS:chg&gt;
   element to replace security information with new security
   information.

   The &lt;secDNS:update&gt; element also contains an OPTIONAL "urgent"
   attribute that a client can use to ask the server operator to



<span class="grey">Hollenbeck                  Standards Track                    [Page 11]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-12"></span>
<span class="grey"><a href="./rfc4310">RFC 4310</a>          EPP DNS Security Extensions Mapping      November 2005</span>


   complete and implement the update request with high priority.  This
   attribute accepts boolean values as described in <a href="#section-2.2">Section 2.2</a>; the
   default value is boolean false.  "High priority" is relative to
   standard server operator policies that are determined using an
   out-of-band mechanism.

   The &lt;secDNS:add&gt; element is used to add DS information to an existing
   set.  The &lt;secDNS:add&gt; element MUST contain one or more &lt;secDNS:
   dsData&gt; elements as described in <a href="#section-3.1.2">Section 3.1.2</a>.

   The &lt;secDNS:rem&gt; element contains one or more &lt;secDNS:keyTag&gt;
   elements that are used to remove DS data from a delegation.  The
   &lt;secDNS:keyTag&gt; element MUST contain a key tag value as described in
   <a href="./rfc4034#section-5.1.1">section 5.1.1 of RFC 4034</a> [<a href="#ref-6" title='"Resource Records for the DNS Security Extensions"'>6</a>].  Removing all DS information can
   remove the ability of the parent to secure the delegation to the
   child zone.

   The &lt;secDNS:chg&gt; element is used to replace existing DS information
   with new DS information.  The &lt;secDNS:chg&gt; element MUST contain one
   or more &lt;secDNS:dsData&gt; elements as described in <a href="#section-3.1.2">Section 3.1.2</a>.  The
   data in these elements is used to replace whatever other data is
   currently archived for the delegation.

   The &lt;secDNS:update&gt; element contains an OPTIONAL "urgent" attribute.
   In addition, the &lt;secDNS:dsData&gt; element contains OPTIONAL &lt;secDNS:
   maxSigLife&gt; and &lt;secDNS:keyData&gt; elements.  The server MUST abort
   command processing and respond with an appropriate EPP error if the
   values provided by the client can not be accepted for syntax or
   policy reasons.

   Example &lt;update&gt; Command, Adding DS Data:

   C:&lt;?xml version="1.0" encoding="UTF-8" standalone="no"?&gt;
   C:&lt;epp xmlns="urn:ietf:params:xml:ns:epp-1.0"
   C:     xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   C:     xsi:schemaLocation="urn:ietf:params:xml:ns:epp-1.0
   C:     epp-1.0.xsd"&gt;
   C:  &lt;command&gt;
   C:    &lt;update&gt;
   C:      &lt;domain:update
   C:       xmlns:domain="urn:ietf:params:xml:ns:domain-1.0"
   C:       xsi:schemaLocation="urn:ietf:params:xml:ns:domain-1.0
   C:       domain-1.0.xsd"&gt;
   C:        &lt;domain:name&gt;example.com&lt;/domain:name&gt;
   C:      &lt;/domain:update&gt;
   C:    &lt;/update&gt;
   C:    &lt;extension&gt;
   C:      &lt;secDNS:update



<span class="grey">Hollenbeck                  Standards Track                    [Page 12]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-13"></span>
<span class="grey"><a href="./rfc4310">RFC 4310</a>          EPP DNS Security Extensions Mapping      November 2005</span>


   C:       xmlns:secDNS="urn:ietf:params:xml:ns:secDNS-1.0"
   C:       xsi:schemaLocation="urn:ietf:params:xml:ns:secDNS-1.0
   C:       secDNS-1.0.xsd"&gt;
   C:        &lt;secDNS:add&gt;
   C:          &lt;secDNS:dsData&gt;
   C:            &lt;secDNS:keyTag&gt;12346&lt;/secDNS:keyTag&gt;
   C:            &lt;secDNS:alg&gt;3&lt;/secDNS:alg&gt;
   C:            &lt;secDNS:digestType&gt;1&lt;/secDNS:digestType&gt;
   C:            &lt;secDNS:digest&gt;38EC35D5B3A34B44C39B&lt;/secDNS:digest&gt;
   C:          &lt;/secDNS:dsData&gt;
   C:        &lt;/secDNS:add&gt;
   C:      &lt;/secDNS:update&gt;
   C:    &lt;/extension&gt;
   C:    &lt;clTRID&gt;ABC-12345&lt;/clTRID&gt;
   C:  &lt;/command&gt;
   C:&lt;/epp&gt;

   Example &lt;update&gt; Command, Removing DS Data:

   C:&lt;?xml version="1.0" encoding="UTF-8" standalone="no"?&gt;
   C:&lt;epp xmlns="urn:ietf:params:xml:ns:epp-1.0"
   C:     xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   C:     xsi:schemaLocation="urn:ietf:params:xml:ns:epp-1.0
   C:     epp-1.0.xsd"&gt;
   C:  &lt;command&gt;
   C:    &lt;update&gt;
   C:      &lt;domain:update
   C:       xmlns:domain="urn:ietf:params:xml:ns:domain-1.0"
   C:       xsi:schemaLocation="urn:ietf:params:xml:ns:domain-1.0
   C:       domain-1.0.xsd"&gt;
   C:        &lt;domain:name&gt;example.com&lt;/domain:name&gt;
   C:      &lt;/domain:update&gt;
   C:    &lt;/update&gt;
   C:    &lt;extension&gt;
   C:      &lt;secDNS:update
   C:       xmlns:secDNS="urn:ietf:params:xml:ns:secDNS-1.0"
   C:       xsi:schemaLocation="urn:ietf:params:xml:ns:secDNS-1.0
   C:       secDNS-1.0.xsd"&gt;
   C:        &lt;secDNS:rem&gt;
   C:          &lt;secDNS:keyTag&gt;12345&lt;/secDNS:keyTag&gt;
   C:        &lt;/secDNS:rem&gt;
   C:      &lt;/secDNS:update&gt;
   C:    &lt;/extension&gt;
   C:    &lt;clTRID&gt;ABC-12345&lt;/clTRID&gt;
   C:  &lt;/command&gt;
   C:&lt;/epp&gt;





<span class="grey">Hollenbeck                  Standards Track                    [Page 13]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-14"></span>
<span class="grey"><a href="./rfc4310">RFC 4310</a>          EPP DNS Security Extensions Mapping      November 2005</span>


   Example Urgent &lt;update&gt; Command, Changing DS Data:

   C:&lt;?xml version="1.0" encoding="UTF-8" standalone="no"?&gt;
   C:&lt;epp xmlns="urn:ietf:params:xml:ns:epp-1.0"
   C:     xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   C:     xsi:schemaLocation="urn:ietf:params:xml:ns:epp-1.0
   C:     epp-1.0.xsd"&gt;
   C:  &lt;command&gt;
   C:    &lt;update&gt;
   C:      &lt;domain:update
   C:       xmlns:domain="urn:ietf:params:xml:ns:domain-1.0"
   C:       xsi:schemaLocation="urn:ietf:params:xml:ns:domain-1.0
   C:       domain-1.0.xsd"&gt;
   C:        &lt;domain:name&gt;example.com&lt;/domain:name&gt;
   C:      &lt;/domain:update&gt;
   C:    &lt;/update&gt;
   C:    &lt;extension&gt;
   C:      &lt;secDNS:update urgent="1"
   C:       xmlns:secDNS="urn:ietf:params:xml:ns:secDNS-1.0"
   C:       xsi:schemaLocation="urn:ietf:params:xml:ns:secDNS-1.0
   C:       secDNS-1.0.xsd"&gt;
   C:        &lt;secDNS:chg&gt;
   C:          &lt;secDNS:dsData&gt;
   C:            &lt;secDNS:keyTag&gt;12345&lt;/secDNS:keyTag&gt;
   C:            &lt;secDNS:alg&gt;3&lt;/secDNS:alg&gt;
   C:            &lt;secDNS:digestType&gt;1&lt;/secDNS:digestType&gt;
   C:            &lt;secDNS:digest&gt;49FD46E6C4B45C55D4AC&lt;/secDNS:digest&gt;
   C:          &lt;/secDNS:dsData&gt;
   C:        &lt;/secDNS:chg&gt;
   C:      &lt;/secDNS:update&gt;
   C:    &lt;/extension&gt;
   C:    &lt;clTRID&gt;ABC-12345&lt;/clTRID&gt;
   C:  &lt;/command&gt;
   C:&lt;/epp&gt;

   Example &lt;update&gt; Command, Changing Data to Include OPTIONAL Data:

   C:&lt;?xml version="1.0" encoding="UTF-8" standalone="no"?&gt;
   C:&lt;epp xmlns="urn:ietf:params:xml:ns:epp-1.0"
   C:     xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   C:     xsi:schemaLocation="urn:ietf:params:xml:ns:epp-1.0
   C:     epp-1.0.xsd"&gt;
   C:  &lt;command&gt;
   C:    &lt;update&gt;
   C:      &lt;domain:update
   C:       xmlns:domain="urn:ietf:params:xml:ns:domain-1.0"
   C:       xsi:schemaLocation="urn:ietf:params:xml:ns:domain-1.0
   C:       domain-1.0.xsd"&gt;



<span class="grey">Hollenbeck                  Standards Track                    [Page 14]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-15"></span>
<span class="grey"><a href="./rfc4310">RFC 4310</a>          EPP DNS Security Extensions Mapping      November 2005</span>


   C:        &lt;domain:name&gt;example.com&lt;/domain:name&gt;
   C:      &lt;/domain:update&gt;
   C:    &lt;/update&gt;
   C:    &lt;extension&gt;
   C:      &lt;secDNS:update
   C:       xmlns:secDNS="urn:ietf:params:xml:ns:secDNS-1.0"
   C:       xsi:schemaLocation="urn:ietf:params:xml:ns:secDNS-1.0
   C:       secDNS-1.0.xsd"&gt;
   C:        &lt;secDNS:chg&gt;
   C:          &lt;secDNS:dsData&gt;
   C:            &lt;secDNS:keyTag&gt;12345&lt;/secDNS:keyTag&gt;
   C:            &lt;secDNS:alg&gt;3&lt;/secDNS:alg&gt;
   C:            &lt;secDNS:digestType&gt;1&lt;/secDNS:digestType&gt;
   C:            &lt;secDNS:digest&gt;49FD46E6C4B45C55D4AC&lt;/secDNS:digest&gt;
   C:            &lt;secDNS:maxSigLife&gt;604800&lt;/secDNS:maxSigLife&gt;
   C:            &lt;secDNS:keyData&gt;
   C:              &lt;secDNS:flags&gt;256&lt;/secDNS:flags&gt;
   C:              &lt;secDNS:protocol&gt;3&lt;/secDNS:protocol&gt;
   C:              &lt;secDNS:alg&gt;1&lt;/secDNS:alg&gt;
   C:              &lt;secDNS:pubKey&gt;AQPJ////4Q==&lt;/secDNS:pubKey&gt;
   C:            &lt;/secDNS:keyData&gt;
   C:          &lt;/secDNS:dsData&gt;
   C:        &lt;/secDNS:chg&gt;
   C:      &lt;/secDNS:update&gt;
   C:    &lt;/extension&gt;
   C:    &lt;clTRID&gt;ABC-12345&lt;/clTRID&gt;
   C:  &lt;/command&gt;
   C:&lt;/epp&gt;

   When an extended &lt;update&gt; command has been processed successfully,
   the EPP response is as described in the EPP domain mapping [<a href="#ref-2" title='"Extensible Provisioning Protocol (EPP) Domain Name Mapping"'>2</a>].  A
   server operator MUST return an EPP error result code of 2306 if an
   urgent update (noted with an "urgent" attribute value of boolean
   true) can not be completed with high priority.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/4.%20%20Formal%20Syntax"></a><a class="selflink" href="#section-4" id="section-4">4</a>.  Formal Syntax</span>

   An EPP object mapping is specified in XML Schema notation.  The
   formal syntax presented here is a complete schema representation of
   the object mapping suitable for automated validation of EPP XML
   instances.  The BEGIN and END tags are not part of the schema; they
   are used to note the beginning and ending of the schema for URI
   registration purposes.








<span class="grey">Hollenbeck                  Standards Track                    [Page 15]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-16"></span>
<span class="grey"><a href="./rfc4310">RFC 4310</a>          EPP DNS Security Extensions Mapping      November 2005</span>


   BEGIN
   &lt;?xml version="1.0" encoding="UTF-8"?&gt;

   &lt;schema targetNamespace="urn:ietf:params:xml:ns:secDNS-1.0"
           xmlns:secDNS="urn:ietf:params:xml:ns:secDNS-1.0"
           xmlns="http://www.w3.org/2001/XMLSchema"
           elementFormDefault="qualified"&gt;

     &lt;annotation&gt;
       &lt;documentation&gt;
         Extensible Provisioning Protocol v1.0
         domain name extension schema for provisioning
         DNS security (DNSSEC) extensions.
       &lt;/documentation&gt;
     &lt;/annotation&gt;

   &lt;!--
   Child elements found in EPP commands.
   --&gt;
     &lt;element name="create" type="secDNS:dsType"/&gt;
     &lt;element name="update" type="secDNS:updateType"/&gt;

   &lt;!--
   Child elements of the &lt;create&gt; command.
   --&gt;
     &lt;complexType name="dsType"&gt;
       &lt;sequence&gt;
         &lt;element name="dsData" type="secDNS:dsDataType"
          maxOccurs="unbounded"/&gt;
       &lt;/sequence&gt;
     &lt;/complexType&gt;

     &lt;complexType name="dsDataType"&gt;
       &lt;sequence&gt;
         &lt;element name="keyTag" type="unsignedShort"/&gt;
         &lt;element name="alg" type="unsignedByte"/&gt;
         &lt;element name="digestType" type="unsignedByte"/&gt;
         &lt;element name="digest" type="hexBinary"/&gt;
         &lt;element name="maxSigLife" type="secDNS:maxSigLifeType"
          minOccurs="0"/&gt;
         &lt;element name="keyData" type="secDNS:keyDataType"
          minOccurs="0"/&gt;
       &lt;/sequence&gt;
     &lt;/complexType&gt;

     &lt;simpleType name="maxSigLifeType"&gt;
       &lt;restriction base="int"&gt;
         &lt;minInclusive value="1"/&gt;



<span class="grey">Hollenbeck                  Standards Track                    [Page 16]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-17"></span>
<span class="grey"><a href="./rfc4310">RFC 4310</a>          EPP DNS Security Extensions Mapping      November 2005</span>


       &lt;/restriction&gt;
     &lt;/simpleType&gt;

     &lt;complexType name="keyDataType"&gt;
       &lt;sequence&gt;
         &lt;element name="flags" type="unsignedShort"/&gt;
         &lt;element name="protocol" type="unsignedByte"/&gt;
         &lt;element name="alg" type="unsignedByte"/&gt;
         &lt;element name="pubKey" type="secDNS:keyType"/&gt;
       &lt;/sequence&gt;
     &lt;/complexType&gt;

     &lt;simpleType name="keyType"&gt;
       &lt;restriction base="base64Binary"&gt;
         &lt;minLength value="1"/&gt;
       &lt;/restriction&gt;
     &lt;/simpleType&gt;

   &lt;!--
   Child elements of the &lt;update&gt; command.
   --&gt;
     &lt;complexType name="updateType"&gt;
       &lt;choice&gt;
         &lt;element name="add" type="secDNS:dsType"/&gt;
         &lt;element name="chg" type="secDNS:dsType"/&gt;
         &lt;element name="rem" type="secDNS:remType"/&gt;
       &lt;/choice&gt;
       &lt;attribute name="urgent" type="boolean" default="false"/&gt;
     &lt;/complexType&gt;

     &lt;complexType name="remType"&gt;
       &lt;sequence&gt;
         &lt;element name="keyTag" type="unsignedShort"
          maxOccurs="unbounded"/&gt;
       &lt;/sequence&gt;
     &lt;/complexType&gt;

   &lt;!--
   Child response elements.
   --&gt;
     &lt;element name="infData" type="secDNS:dsType"/&gt;

   &lt;!--
   End of schema.
   --&gt;
   &lt;/schema&gt;
   END




<span class="grey">Hollenbeck                  Standards Track                    [Page 17]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-18"></span>
<span class="grey"><a href="./rfc4310">RFC 4310</a>          EPP DNS Security Extensions Mapping      November 2005</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.%20%20Internationalization%20Considerations"></a><a class="selflink" href="#section-5" id="section-5">5</a>.  Internationalization Considerations</span>

   EPP is represented in XML, which provides native support for encoding
   information using the Unicode character set and its more compact
   representations including UTF-8 [<a href="#ref-14" title='"UTF-8, a transformation format of ISO 10646"'>14</a>].  Conformant XML processors
   recognize both UTF-8 and UTF-16 [<a href="#ref-15" title='"UTF-16, an encoding of ISO 10646"'>15</a>].  Though XML includes provisions
   to identify and use other character encodings through use of an
   "encoding" attribute in an &lt;?xml?&gt; declaration, use of UTF-8 is
   RECOMMENDED in environments where parser encoding support
   incompatibility exists.

   As an extension of the EPP domain mapping [<a href="#ref-2" title='"Extensible Provisioning Protocol (EPP) Domain Name Mapping"'>2</a>], the elements, element
   content, attributes, and attribute values described in this document
   MUST inherit the internationalization conventions used to represent
   higher-layer domain and core protocol structures present in an XML
   instance that includes this extension.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/6.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-6" id="section-6">6</a>.  IANA Considerations</span>

   This document uses URNs to describe XML namespaces and XML schemas
   conforming to a registry mechanism described in <a href="./rfc3688">RFC 3688</a> [<a href="#ref-10" title='"The IETF XML Registry"'>10</a>].  Two
   URI assignments have been completed by the IANA.

   Registration request for the extension namespace:

   URI: urn:ietf:params:xml:ns:secDNS-1.0

   Registrant Contact: IESG

   XML: None.  Namespace URIs do not represent an XML specification.

   Registration request for the extension XML schema:

   URI: urn:ietf:params:xml:schema:secDNS-1.0

   Registrant Contact: IESG

   XML: See the "Formal Syntax" section of this document.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/7.%20%20Security%20Considerations"></a><a class="selflink" href="#section-7" id="section-7">7</a>.  Security Considerations</span>

   The mapping extensions described in this document do not provide any
   security services beyond those described by EPP [<a href="#ref-1" title='"Extensible Provisioning Protocol (EPP)"'>1</a>], the EPP domain
   name mapping [<a href="#ref-2" title='"Extensible Provisioning Protocol (EPP) Domain Name Mapping"'>2</a>], and protocol layers used by EPP.  The security
   considerations described in these other specifications apply to this
   specification as well.





<span class="grey">Hollenbeck                  Standards Track                    [Page 18]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-19"></span>
<span class="grey"><a href="./rfc4310">RFC 4310</a>          EPP DNS Security Extensions Mapping      November 2005</span>


   As with other domain object transforms, the EPP transform operations
   described in this document MUST be restricted to the sponsoring
   client as authenticated using the mechanisms described in sections
   2.9.1.1 and 7 of <a href="./rfc3730">RFC 3730</a> [<a href="#ref-1" title='"Extensible Provisioning Protocol (EPP)"'>1</a>].  Any attempt to perform a transform
   operation on a domain object by any client other than the sponsoring
   client MUST be rejected with an appropriate EPP authorization error.

   The provisioning service described in this document involves the
   exchange of information that can have an operational impact on the
   DNS.  A trust relationship MUST exist between the EPP client and
   server, and provisioning of public key information MUST only be done
   after the identities of both parties have been confirmed using a
   strong authentication mechanism.

   An EPP client might be acting as an agent for a zone administrator
   who wants to send delegation information to be signed and published
   by the server operator.  Man-in-the-middle attacks are thus possible
   as a result of direct client activity or inadvertent client data
   manipulation.

   Acceptance of a false key by a server operator can produce
   significant operational consequences.  The child and parent zones
   MUST be consistent to secure the delegation properly.  In the absence
   of consistent signatures, the delegation will not appear in the
   secure name space, yielding untrustworthy query responses.  If a key
   is compromised, a client can either remove the compromised
   information or update the delegation information via EPP commands
   using the "urgent" attribute.

   Operational scenarios requiring quick removal of a secure domain
   delegation can be implemented using a two-step process.  First,
   security credentials can be removed using an "urgent" update as just
   described.  The domain can then be removed from the parent zone by
   changing the status of the domain to either of the EPP "clientHold"
   or "serverHold" domain status values.  The domain can also be removed
   from the zone using the EPP &lt;delete&gt; command, but this is a more
   drastic step that needs to be considered carefully before use.

   Data validity checking at the server requires computational
   resources.  A purposeful or inadvertent denial-of-service attack is
   possible if a client requests some number of update operations that
   exceed a server's processing capabilities.  Server operators SHOULD
   take steps to manage command load and command processing requirements
   to minimize the risk of a denial-of-service attack.

   The signature lifetime values provided by clients are requests that
   can be rejected.  Blind acceptance by a server operator can have an
   adverse impact on a server's processing capabilities.  Server



<span class="grey">Hollenbeck                  Standards Track                    [Page 19]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-20"></span>
<span class="grey"><a href="./rfc4310">RFC 4310</a>          EPP DNS Security Extensions Mapping      November 2005</span>


   operators SHOULD seriously consider adopting implementation rules to
   limit the range of acceptable signature lifetime values to counter
   potential adverse situations.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/8.%20%20Acknowledgements"></a><a class="selflink" href="#section-8" id="section-8">8</a>.  Acknowledgements</span>

   The author would like to thank the following people who have provided
   significant contributions to the development of this document:

   David Blacka, Olafur Gudmundsson, Mark Kosters, Ed Lewis, Dan Massey,
   Marcos Sanz, Sam Weiler, and Ning Zhang.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/9.%20%20References"></a><a class="selflink" href="#section-9" id="section-9">9</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/9.1.%20%20Normative%20References"></a><a class="selflink" href="#section-9.1" id="section-9.1">9.1</a>.  Normative References</span>

   [<a id="ref-1">1</a>]   Hollenbeck, S., "Extensible Provisioning Protocol (EPP)",
         <a href="./rfc3730">RFC 3730</a>, March 2004.

   [<a id="ref-2">2</a>]   Hollenbeck, S., "Extensible Provisioning Protocol (EPP) Domain
         Name Mapping", <a href="./rfc3731">RFC 3731</a>, March 2004.

   [<a id="ref-3">3</a>]   Paoli, J., Sperberg-McQueen, C., Bray, T., and E. Maler,
         "Extensible Markup Language (XML) 1.0 (Second Edition)", W3C
         FirstEdition REC-xml-20001006, October 2000.

   [<a id="ref-4">4</a>]   Maloney, M., Beech, D., Mendelsohn, N., and H. Thompson, "XML
         Schema Part 1: Structures", W3C REC REC-xmlschema-1-20010502,
         May 2001.

   [<a id="ref-5">5</a>]   Malhotra, A. and P. Biron, "XML Schema Part 2: Datatypes", W3C
         REC REC-xmlschema-2-20010502, May 2001.

   [<a id="ref-6">6</a>]   Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose,
         "Resource Records for the DNS Security Extensions", <a href="./rfc4034">RFC 4034</a>,
         March 2005.

   [<a id="ref-7">7</a>]   Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose,
         "Protocol Modifications for the DNS Security Extensions",
         <a href="./rfc4035">RFC 4035</a>, March 2005.

   [<a id="ref-8">8</a>]   Bradner, S., "Key words for use in RFCs to Indicate Requirement
         Levels", <a href="https://www.rfc-editor.org/bcp/bcp14">BCP 14</a>, <a href="./rfc2119">RFC 2119</a>, March 1997.

   [<a id="ref-9">9</a>]   Kolkman, O., Schlyter, J., and E. Lewis, "Domain Name System
         KEY (DNSKEY) Resource Record (RR) Secure Entry Point (SEP)
         Flag", <a href="./rfc3757">RFC 3757</a>, April 2004.




<span class="grey">Hollenbeck                  Standards Track                    [Page 20]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-21"></span>
<span class="grey"><a href="./rfc4310">RFC 4310</a>          EPP DNS Security Extensions Mapping      November 2005</span>


   [<a id="ref-10">10</a>]  Mealling, M., "The IETF XML Registry", <a href="https://www.rfc-editor.org/bcp/bcp81">BCP 81</a>, <a href="./rfc3688">RFC 3688</a>,
         January 2004.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/9.2.%20%20Informative%20References"></a><a class="selflink" href="#section-9.2" id="section-9.2">9.2</a>.  Informative References</span>

   [<a id="ref-11">11</a>]  Mockapetris, P., "Domain names - concepts and facilities",
         STD 13, <a href="./rfc1034">RFC 1034</a>, November 1987.

   [<a id="ref-12">12</a>]  Mockapetris, P., "Domain names - implementation and
         specification", STD 13, <a href="./rfc1035">RFC 1035</a>, November 1987.

   [<a id="ref-13">13</a>]  Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose,
         "DNS Security Introduction and Requirements", <a href="./rfc4033">RFC 4033</a>,
         March 2005.

   [<a id="ref-14">14</a>]  Yergeau, F., "UTF-8, a transformation format of ISO 10646",
         STD 63, <a href="./rfc3629">RFC 3629</a>, November 2003.

   [<a id="ref-15">15</a>]  Hoffman, P. and F. Yergeau, "UTF-16, an encoding of ISO 10646",
         <a href="./rfc2781">RFC 2781</a>, February 2000.

Author's Address

   Scott Hollenbeck
   VeriSign, Inc.
   21345 Ridgetop Circle
   Dulles, VA  20166-6503
   US

   EMail: shollenbeck@verisign.com





















<span class="grey">Hollenbeck                  Standards Track                    [Page 21]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-22"></span>
<span class="grey"><a href="./rfc4310">RFC 4310</a>          EPP DNS Security Extensions Mapping      November 2005</span>


Full Copyright Statement

   Copyright (C) The Internet Society (2005).

   This document is subject to the rights, licenses and restrictions
   contained in <a href="https://www.rfc-editor.org/bcp/bcp78">BCP 78</a>, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY AND THE INTERNET
   ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR IMPLIED,
   INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE
   INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in <a href="https://www.rfc-editor.org/bcp/bcp78">BCP 78</a> and <a href="https://www.rfc-editor.org/bcp/bcp79">BCP 79</a>.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   <a href="http://www.ietf.org/ipr">http://www.ietf.org/ipr</a>.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at ietf-
   ipr@ietf.org.

Acknowledgement

   Funding for the RFC Editor function is currently provided by the
   Internet Society.







Hollenbeck                  Standards Track                    [Page 22]
</pre>
</body></html>