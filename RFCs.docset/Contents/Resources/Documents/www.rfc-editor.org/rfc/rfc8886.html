<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 8886: Secure Device Install</title>
<meta content="Warren Kumari" name="author"/>
<meta content="Colin Doyle" name="author"/>
<meta content='
       Deploying a new network device in a location where the operator has
      no staff of its own often requires that an employee physically travel to
      the location to perform the initial install and configuration, even in
      shared facilities with "remote-hands" (or similar) support. In many
      cases, this could be avoided if there were an easy way to transfer the
      initial configuration to a new device while still maintaining
      confidentiality of the configuration. 
       This document extends existing vendor proprietary auto-install
     to provide limited confidentiality to initial configuration during
     bootstrapping of the device. 
    ' name="description"/>
<meta content="xml2rfc 3.1.1" name="generator"/>
<meta content="autoboot" name="keyword"/>
<meta content="auto-boot" name="keyword"/>
<meta content="autoinstall" name="keyword"/>
<meta content="tftp" name="keyword"/>
<meta content="install" name="keyword"/>
<meta content="bunny" name="keyword"/>
<meta content="8886" name="rfc.number"/>
<link href="rfc8886.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://dx.doi.org/10.17487/rfc8886" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <link href="https://datatracker.ietf.org/doc/draft-ietf-opsawg-sdi-13" rel="prev"/>
  </head>
<body>
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 8886</td>
<td class="center">Secure Device Install</td>
<td class="right">September 2020</td>
</tr></thead>
<tfoot><tr>
<td class="left">Kumari &amp; Doyle</td>
<td class="center">Informational</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc8886">8886</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Informational</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2020-09">September 2020</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">W. Kumari</div>
<div class="org">Google</div>
</div>
<div class="author">
      <div class="author-name">C. Doyle</div>
<div class="org">Juniper Networks</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 8886</h1>
<h1 id="title">Secure Device Install</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">Deploying a new network device in a location where the operator has
      no staff of its own often requires that an employee physically travel to
      the location to perform the initial install and configuration, even in
      shared facilities with "remote-hands" (or similar) support. In many
      cases, this could be avoided if there were an easy way to transfer the
      initial configuration to a new device while still maintaining
      confidentiality of the configuration.<a class="pilcrow" href="#section-abstract-1">¶</a></p>
<p id="section-abstract-2">This document extends existing vendor proprietary auto-install
     to provide limited confidentiality to initial configuration during
     bootstrapping of the device.<a class="pilcrow" href="#section-abstract-2">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This document is not an Internet Standards Track specification; it is
            published for informational purposes.<a class="pilcrow" href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by the
            Internet Engineering Steering Group (IESG).  Not all documents
            approved by the IESG are candidates for any level of Internet
            Standard; see Section 2 of RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc8886">https://www.rfc-editor.org/info/rfc8886</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2020 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">▲</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.1">
            <p class="keepWithNext" id="section-toc.1-1.1.1"><a class="xref" href="#section-1">1</a>.  <a class="xref" href="#name-introduction">Introduction</a><a class="pilcrow" href="#section-toc.1-1.1.1">¶</a></p>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.2">
            <p class="keepWithNext" id="section-toc.1-1.2.1"><a class="xref" href="#section-2">2</a>.  <a class="xref" href="#name-overview">Overview</a><a class="pilcrow" href="#section-toc.1-1.2.1">¶</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.2.2.1">
                <p class="keepWithNext" id="section-toc.1-1.2.2.1.1"><a class="xref" href="#section-2.1">2.1</a>.  <a class="xref" href="#name-example-scenario">Example Scenario</a><a class="pilcrow" href="#section-toc.1-1.2.2.1.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a class="xref" href="#section-3">3</a>.  <a class="xref" href="#name-vendor-role">Vendor Role</a><a class="pilcrow" href="#section-toc.1-1.3.1">¶</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a class="xref" href="#section-3.1">3.1</a>.  <a class="xref" href="#name-device-key-generation">Device Key Generation</a><a class="pilcrow" href="#section-toc.1-1.3.2.1.1">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a class="xref" href="#section-3.2">3.2</a>.  <a class="xref" href="#name-directory-server">Directory Server</a><a class="pilcrow" href="#section-toc.1-1.3.2.2.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="xref" href="#section-4">4</a>.  <a class="xref" href="#name-operator-role">Operator Role</a><a class="pilcrow" href="#section-toc.1-1.4.1">¶</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a class="xref" href="#section-4.1">4.1</a>.  <a class="xref" href="#name-administrative">Administrative</a><a class="pilcrow" href="#section-toc.1-1.4.2.1.1">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a class="xref" href="#section-4.2">4.2</a>.  <a class="xref" href="#name-technical">Technical</a><a class="pilcrow" href="#section-toc.1-1.4.2.2.1">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a class="xref" href="#section-4.3">4.3</a>.  <a class="xref" href="#name-example-initial-customer-bo">Example Initial Customer Boot</a><a class="pilcrow" href="#section-toc.1-1.4.2.3.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="xref" href="#section-5">5</a>.  <a class="xref" href="#name-additional-considerations">Additional Considerations</a><a class="pilcrow" href="#section-toc.1-1.5.1">¶</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a class="xref" href="#section-5.1">5.1</a>.  <a class="xref" href="#name-key-storage">Key Storage</a><a class="pilcrow" href="#section-toc.1-1.5.2.1.1">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a class="xref" href="#section-5.2">5.2</a>.  <a class="xref" href="#name-key-replacement">Key Replacement</a><a class="pilcrow" href="#section-toc.1-1.5.2.2.1">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a class="xref" href="#section-5.3">5.3</a>.  <a class="xref" href="#name-device-reinstall">Device Reinstall</a><a class="pilcrow" href="#section-toc.1-1.5.2.3.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="xref" href="#section-6">6</a>.  <a class="xref" href="#name-iana-considerations">IANA Considerations</a><a class="pilcrow" href="#section-toc.1-1.6.1">¶</a></p>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="xref" href="#section-7">7</a>.  <a class="xref" href="#name-security-considerations">Security Considerations</a><a class="pilcrow" href="#section-toc.1-1.7.1">¶</a></p>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="xref" href="#section-8">8</a>.  <a class="xref" href="#name-informative-references">Informative References</a><a class="pilcrow" href="#section-toc.1-1.8.1">¶</a></p>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="xref" href="#section-appendix.a">Appendix A</a>.  <a class="xref" href="#name-proof-of-concept">Proof of Concept</a><a class="pilcrow" href="#section-toc.1-1.9.1">¶</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a class="xref" href="#section-a.1">A.1</a>.  <a class="xref" href="#name-step-1-generating-the-certi">Step 1: Generating the Certificate</a><a class="pilcrow" href="#section-toc.1-1.9.2.1.1">¶</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.9.2.1.2.1">
                    <p id="section-toc.1-1.9.2.1.2.1.1"><a class="xref" href="#section-a.1.1">A.1.1</a>.  <a class="xref" href="#name-step-11-generate-the-privat">Step 1.1: Generate the Private Key</a><a class="pilcrow" href="#section-toc.1-1.9.2.1.2.1.1">¶</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.9.2.1.2.2">
                    <p id="section-toc.1-1.9.2.1.2.2.1"><a class="xref" href="#section-a.1.2">A.1.2</a>.  <a class="xref" href="#name-step-12-generate-the-certif">Step 1.2: Generate the Certificate Signing Request</a><a class="pilcrow" href="#section-toc.1-1.9.2.1.2.2.1">¶</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.9.2.1.2.3">
                    <p id="section-toc.1-1.9.2.1.2.3.1"><a class="xref" href="#section-a.1.3">A.1.3</a>.  <a class="xref" href="#name-step-13-generate-the-self-s">Step 1.3: Generate the (Self-Signed) Certificate Itself</a><a class="pilcrow" href="#section-toc.1-1.9.2.1.2.3.1">¶</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a class="xref" href="#section-a.2">A.2</a>.  <a class="xref" href="#name-step-2-generating-the-encry">Step 2: Generating the Encrypted Configuration</a><a class="pilcrow" href="#section-toc.1-1.9.2.2.1">¶</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.9.2.2.2.1">
                    <p id="section-toc.1-1.9.2.2.2.1.1"><a class="xref" href="#section-a.2.1">A.2.1</a>.  <a class="xref" href="#name-step-21-fetch-the-certifica">Step 2.1: Fetch the Certificate</a><a class="pilcrow" href="#section-toc.1-1.9.2.2.2.1.1">¶</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.9.2.2.2.2">
                    <p id="section-toc.1-1.9.2.2.2.2.1"><a class="xref" href="#section-a.2.2">A.2.2</a>.  <a class="xref" href="#name-step-22-encrypt-the-configu">Step 2.2: Encrypt the Configuration File</a><a class="pilcrow" href="#section-toc.1-1.9.2.2.2.2.1">¶</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.9.2.2.2.3">
                    <p id="section-toc.1-1.9.2.2.2.3.1"><a class="xref" href="#section-a.2.3">A.2.3</a>.  <a class="xref" href="#name-step-23-copy-configuration-">Step 2.3: Copy Configuration to the Configuration Server</a><a class="pilcrow" href="#section-toc.1-1.9.2.2.2.3.1">¶</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a class="xref" href="#section-a.3">A.3</a>.  <a class="xref" href="#name-step-3-decrypting-and-using">Step 3: Decrypting and Using the Configuration</a><a class="pilcrow" href="#section-toc.1-1.9.2.3.1">¶</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.9.2.3.2.1">
                    <p id="section-toc.1-1.9.2.3.2.1.1"><a class="xref" href="#section-a.3.1">A.3.1</a>.  <a class="xref" href="#name-step-31-fetch-encrypted-con">Step 3.1: Fetch Encrypted Configuration File from Configuration Server</a><a class="pilcrow" href="#section-toc.1-1.9.2.3.2.1.1">¶</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.9.2.3.2.2">
                    <p id="section-toc.1-1.9.2.3.2.2.1"><a class="xref" href="#section-a.3.2">A.3.2</a>.  <a class="xref" href="#name-step-32-decrypt-and-use-the">Step 3.2: Decrypt and Use the Configuration</a><a class="pilcrow" href="#section-toc.1-1.9.2.3.2.2.1">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a class="xref" href="#section-appendix.b"></a><a class="xref" href="#name-acknowledgments">Acknowledgments</a><a class="pilcrow" href="#section-toc.1-1.10.1">¶</a></p>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a class="xref" href="#section-appendix.c"></a><a class="xref" href="#name-authors-addresses">Authors' Addresses</a><a class="pilcrow" href="#section-toc.1-1.11.1">¶</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">In a growing, global network, significant amounts of time and money
      are spent deploying new devices and "forklift" upgrading
      existing devices. In many cases, these devices are in shared
      facilities (for example, Internet Exchange Points (IXP) or
      "carrier-neutral data centers"), which have staff on hand that can be
      contracted to perform tasks including physical installs, device
      reboots, loading initial configurations, etc. There are also a
      number of (often proprietary) protocols to perform initial
      device installs and configurations. For example, many network
      devices will attempt to use DHCP <span>[<a class="xref" href="#RFC2131">RFC2131</a>]</span> or
      DHCPv6 <span>[<a class="xref" href="#RFC8415">RFC8415</a>]</span> to get
      an IP address and configuration server and then fetch and install
      a configuration when they are first powered on.<a class="pilcrow" href="#section-1-1">¶</a></p>
<p id="section-1-2">The configurations of network devices contain a significant amount of
      security-related and proprietary information (for example, RADIUS
      <span>[<a class="xref" href="#RFC2865">RFC2865</a>]</span> or TACACS+ <span>[<a class="xref" href="#I-D.ietf-opsawg-tacacs">TACACS</a>]</span>
      secrets). Exposing these to a third party to load onto a new device (or using
      an auto-install technique that fetches an unencrypted configuration file via
      TFTP <span>[<a class="xref" href="#RFC1350">RFC1350</a>]</span>) or something similar is an unacceptable
      security risk for many operators, and so they send employees to remote locations to
      perform the initial configuration work; this costs time and money.<a class="pilcrow" href="#section-1-2">¶</a></p>
<p id="section-1-3">There are some workarounds to this, such as asking the vendor to
      preconfigure the device before shipping it; asking the remote support to 
      install a terminal server; providing a minimal, unsecured
      configuration and using that to bootstrap to a complete
      configuration; etc. However, these are often clumsy and have security
      issues. As an example, in the terminal server case, the console port
      connection could be easily snooped.<a class="pilcrow" href="#section-1-3">¶</a></p>
<p id="section-1-4">An ideal solution in this space would protect both the
      confidentiality of device configuration in transit and the authenticity
      (and authorization status) of configuration to be used by the
      device. The mechanism described in this document only addresses the
      former and makes no effort to do the latter, with the device accepting
      any configuration file that comes its way and is encrypted to the
      device's key (or not encrypted, as the case may be).  Other solutions
      (such as <span><a class="xref" href="#RFC8572">Secure Zero Touch
      Provisioning (SZTP)</a> [<a class="xref" href="#RFC8572">RFC8572</a>]</span>, <span><a class="xref" href="#I-D.ietf-anima-bootstrapping-keyinfra">Bootstrapping Remote Secure Key Infrastructures (BRSKI)</a> [<a class="xref" href="#I-D.ietf-anima-bootstrapping-keyinfra">BRSKI</a>]</span>, and
      other voucher-based methods) are more fully featured but also require
      more complicated machinery.

      This document describes something much
      simpler, at the cost of only providing limited protection.<a class="pilcrow" href="#section-1-4">¶</a></p>
<p id="section-1-5">This document layers security onto existing auto-install solutions
      (one example of which is <span>[<a class="xref" href="#Cisco_AutoInstall">Cisco_AutoInstall</a>]</span>) to provide a method to initially configure new
      devices while maintaining (limited) confidentiality of the initial
      configuration. It is optimized for simplicity, for both the implementor
      and the operator. It is explicitly not intended to be a fully featured
      system for managing installed devices nor is it intended to solve all
      use cases; rather, it is a simple targeted solution to solve a common
      operational issue where the network device has been delivered, fiber has
      been laid (as appropriate), and there is no trusted member of the
      operator's staff to perform the initial configuration. This solution is
      only intended to increase confidentiality of the information in the
      configuration file and does not protect the device itself from loading a
      malicious configuration.<a class="pilcrow" href="#section-1-5">¶</a></p>
<p id="section-1-6">This document describes a concept and some example ways of implementing
      this concept. As devices have different capabilities and use different
      configuration paradigms, one method will not suit all, and so it is
      expected that vendors will differ in exactly how they implement this.<a class="pilcrow" href="#section-1-6">¶</a></p>
<p id="section-1-7">This solution is specifically designed to be a simple method on top
      of exiting device functionality. If devices do not support this new
      method, they can continue to use the existing functionality. In
      addition, operators can choose to use this to protect their
      configuration information or can continue to use the existing
      functionality.<a class="pilcrow" href="#section-1-7">¶</a></p>
<p id="section-1-8">The issue of securely installing devices is in no way a new issue
      nor is it limited to network devices; it occurs when deploying
      servers, PCs, Internet of Things (IoT) devices, and in many other situations. While the
      solution described in this document is obvious (encrypt the config,
      then decrypt it with a device key), this document only discusses the
      use for network devices, such as routers and switches.<a class="pilcrow" href="#section-1-8">¶</a></p>
</section>
<section id="section-2">
      <h2 id="name-overview">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-overview">Overview</a>
      </h2>
<p id="section-2-1">Most network devices already include some sort of initial
      bootstrapping logic (sometimes called 'autoboot' or 'autoinstall'). This
      generally works by having a newly installed, unconfigured device obtain
      an IP address for itself and discover the address of a configuration
      server (often called 'next-server', 'siaddr', or 'tftp-server-name')
      using DHCP or DHCPv6 (see <span>[<a class="xref" href="#RFC2131">RFC2131</a>]</span> and
      <span>[<a class="xref" href="#RFC8415">RFC8415</a>]</span>). The device then contacts
      this configuration server to download its initial configuration, which
      is often identified using the device's serial number, Media Access
      Control (MAC) address, or similar. This document extends this
      (vendor-specific) paradigm by allowing the configuration file to be
      encrypted.<a class="pilcrow" href="#section-2-1">¶</a></p>
<p id="section-2-2">This document uses the serial number of the device as a unique device
      identifier for simplicity; some vendors may not want to implement the
      system using the serial number as the identifier for business reasons (a
      competitor or similar could enumerate the serial numbers and determine
      how many devices have been manufactured). Implementors are free to
      choose some other way of generating identifiers (e.g., a Universally
      Unique Identifier (UUID) <span>[<a class="xref" href="#RFC4122">RFC4122</a>]</span>), but
      this will likely make it somewhat harder for 
      operators to use (the serial number is usually easy to find on a device).<a class="pilcrow" href="#section-2-2">¶</a></p>
<section id="section-2.1">
        <h3 id="name-example-scenario">
<a class="section-number selfRef" href="#section-2.1">2.1. </a><a class="section-name selfRef" href="#name-example-scenario">Example Scenario</a>
        </h3>
<p id="section-2.1-1">Operator_A needs another peering router, and so they
      order another router from Vendor_B to be drop-shipped to
      the facility. Vendor_B begins assembling the new
      device and tells Operator_A what the new device's serial number will be
      (SN:17894321). When Vendor_B first installs the firmware on the device and
      boots it, the device generates a public-private key pair, and Vendor_B
      publishes the public key on its key server (in a public key certificate, for
      ease of use).<a class="pilcrow" href="#section-2.1-1">¶</a></p>
<p id="section-2.1-2">While the device is being shipped, Operator_A generates the initial
      device configuration and fetches the certificate from Vendor_B key servers by
      providing the serial number of the new device. Operator_A then encrypts the
      device configuration and puts this encrypted configuration on a (local) TFTP
      server.<a class="pilcrow" href="#section-2.1-2">¶</a></p>
<p id="section-2.1-3">When the device arrives at the Point of Presence (POP), it gets
 installed in Operator_A's rack and cabled as instructed. The new
 device powers up and discovers that it has not yet been configured. It
 enters its autoboot state and begins the DHCP process. Operator_A's
 DHCP server provides it with an IP address and the address of the
 configuration server. The router uses TFTP to fetch its configuration
 file. Note that all of this is existing functionality. The device
 attempts to load the configuration file. As an added step, if the
 configuration file cannot be parsed, the device tries to use its
 private key to decrypt the file and, assuming it validates, proceeds
 to install the new, decrypted configuration.<a class="pilcrow" href="#section-2.1-3">¶</a></p>
<p id="section-2.1-4">Only the "correct" device will have the required private key and be
      able to decrypt and use the configuration file (see
      <span><a class="xref" href="#security">Security Considerations</a> (<a class="xref" href="#security">Section 7</a>)</span>).
      An attacker would be able to connect to the network and get an IP
      address. They would also be able to retrieve (encrypted) configuration files by
      guessing serial numbers (or perhaps the server would allow directory
      listing), but without the private keys, an attacker will not be able to
      decrypt the files.<a class="pilcrow" href="#section-2.1-4">¶</a></p>
</section>
</section>
<section id="section-3">
      <h2 id="name-vendor-role">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-vendor-role">Vendor Role</a>
      </h2>
<p id="section-3-1">This section describes the vendor's roles and
      provides an overview of what the device needs to do.<a class="pilcrow" href="#section-3-1">¶</a></p>
<section id="section-3.1">
        <h3 id="name-device-key-generation">
<a class="section-number selfRef" href="#section-3.1">3.1. </a><a class="section-name selfRef" href="#name-device-key-generation">Device Key Generation</a>
        </h3>
<p id="section-3.1-1">Each device requires a public-private key pair and for the
        public part to be published and retrievable by the operator. The
        cryptographic algorithm and key lengths to be used are out of the scope
        of this document. This section illustrates one method, but, as with
        much of this document, the exact mechanism may vary by vendor.


        Enrollment over Secure Transport <span>[<a class="xref" href="#RFC7030">RFC7030</a>]</span> and possibly the Simple Certificate Enrollment
        Protocol <span>[<a class="xref" href="#RFC8894">RFC8894</a>]</span> are
        methods that vendors may want to consider.<a class="pilcrow" href="#section-3.1-1">¶</a></p>
<p id="section-3.1-2">During the manufacturing stage, when the device is initially powered
        on, it will generate a public-private key pair. It will send its unique device
        identifier and the public key to the vendor's directory server
        <span>[<a class="xref" href="#RFC5280">RFC5280</a>]</span> to be published. The vendor's directory server
        should only accept certificates that are from the manufacturing
 facility and that match vendor-defined policies (for example, extended
 key usage and extensions).

 Note that some devices may be constrained and so may send
        the raw public key and unique device identifier to the certificate
        publication server, while more capable devices may generate and send
        self-signed certificates. 


This communication with the directory server should be integrity protected and
should occur in a controlled environment.<a class="pilcrow" href="#section-3.1-2">¶</a></p>
<p id="section-3.1-3">This reference architecture needs a serialization format for the
        key material.  Due to the prevalence of tooling support for it on
        network devices, X.509 certificates are a convenient format to
        exchange public keys. 

However, most of the metadata that would be used for revocation and aging will
not be used and should be ignored by both the client and server. In such
cases, the signature on the certificate conveys no value, and the consumer of
the certificate is expected to pin the end-entity key fingerprint (versus
using a PKI and signature chain).<a class="pilcrow" href="#section-3.1-3">¶</a></p>
</section>
<section id="section-3.2">
        <h3 id="name-directory-server">
<a class="section-number selfRef" href="#section-3.2">3.2. </a><a class="section-name selfRef" href="#name-directory-server">Directory Server</a>
        </h3>
<p id="section-3.2-1">The directory server contains a database of
        certificates. If newly manufactured devices upload certificates, the
        directory server can simply publish these; if the
        devices provide the raw public keys and unique device identifier,
        the directory server will need to wrap these in a
        certificate.<a class="pilcrow" href="#section-3.2-1">¶</a></p>
<p id="section-3.2-2">The customers (e.g., Operator_A) query this server with
        the serial number (or other provided unique identifier) of a device
        and retrieve the associated certificate. It is expected that operators
        will receive the unique device identifier (serial number) of devices when
        they purchase them and will download and store the
        certificate. This means that there is not a hard requirement on the
        reachability of the directory server.<a class="pilcrow" href="#section-3.2-2">¶</a></p>
<span id="name-initial-certificate-generat"></span><figure id="figure-1">
          <div class="artwork art-text alignLeft" id="section-3.2-3.1">
<pre>                      +------------+
     +------+         |            |
     |Device|         | Directory  |
     +------+         |   Server   |
                      +------------+
+----------------+   +--------------+
|   +---------+  |   |              |
|   | Initial |  |   |              |
|   |  boot?  |  |   |              |
|   +----+----+  |   |              |
|        |       |   |              |
| +------v-----+ |   |              |
| |  Generate  | |   |              |
| |Self-signed | |   |              |
| |Certificate | |   |              |
| +------------+ |   |              |
|        |       |   |   +-------+  |
|        +-------|---|--&gt;|Receive|  |
|                |   |   +---+---+  |
|                |   |       |      |
|                |   |   +---v---+  |
|                |   |   |Publish|  |
|                |   |   +-------+  |
|                |   |              |
+----------------+   +--------------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-1">Figure 1</a>:
<a class="selfRef" href="#name-initial-certificate-generat">Initial Certificate Generation and Publication</a>
          </figcaption></figure>
</section>
</section>
<section id="section-4">
      <h2 id="name-operator-role">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-operator-role">Operator Role</a>
      </h2>
<section id="section-4.1">
        <h3 id="name-administrative">
<a class="section-number selfRef" href="#section-4.1">4.1. </a><a class="section-name selfRef" href="#name-administrative">Administrative</a>
        </h3>
<p id="section-4.1-1">When purchasing a new device, the accounting department will need
        to get the unique device identifier (e.g., serial number) of the new
        device and communicate it to the operations group.<a class="pilcrow" href="#section-4.1-1">¶</a></p>
</section>
<section id="section-4.2">
        <h3 id="name-technical">
<a class="section-number selfRef" href="#section-4.2">4.2. </a><a class="section-name selfRef" href="#name-technical">Technical</a>
        </h3>
<p id="section-4.2-1">The operator will contact the vendor's publication server and
        download the certificate (by providing the unique device identifier of
        the device). The operator fetches the certificate using a secure
        transport that authenticates the source of the certificate,
        such as HTTPS (confidentiality protection can provide some privacy
        and metadata-leakage benefit but is not key to the primary
        mechanism of this document). The operator will then encrypt the initial
        configuration (for example, using S/MIME <span>[<a class="xref" href="#RFC8551">RFC8551</a>]</span>)
        using the key in the certificate and place it on their
        configuration server.<a class="pilcrow" href="#section-4.2-1">¶</a></p>
<p id="section-4.2-2">See <a class="xref" href="#proof">Appendix A</a> for examples.<a class="pilcrow" href="#section-4.2-2">¶</a></p>
<span id="name-fetching-the-certificate-en"></span><figure id="figure-2">
          <div class="artwork art-text alignLeft" id="section-4.2-3.1">
<pre>                      +------------+
   +--------+         |            |
   |Operator|         | Directory  |
   +--------+         |   Server   |
                      +------------+
+----------------+  +----------------+
| +-----------+  |  |  +-----------+ |
| |   Fetch   |  |  |  |           | |
| |  Device   |&lt;------&gt;|Certificate| |
| |Certificate|  |  |  |           | |
| +-----+-----+  |  |  +-----------+ |
|       |        |  |                |
| +-----v------+ |  |                |
| |  Encrypt   | |  |                |
| |   Device   | |  |                |
| |   Config   | |  |                |
| +-----+------+ |  |                |
|       |        |  |                |
| +-----v------+ |  |                |
| |  Publish   | |  |                |
| |    TFTP    | |  |                |
| |   Server   | |  |                |
| +------------+ |  |                |
|                |  |                |
+----------------+  +----------------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-2">Figure 2</a>:
<a class="selfRef" href="#name-fetching-the-certificate-en">Fetching the Certificate, Encrypting the Configuration, and Publishing
the Encrypted Configuration</a>
          </figcaption></figure>
</section>
<div id="initial_cust_boot">
<section id="section-4.3">
        <h3 id="name-example-initial-customer-bo">
<a class="section-number selfRef" href="#section-4.3">4.3. </a><a class="section-name selfRef" href="#name-example-initial-customer-bo">Example Initial Customer Boot</a>
        </h3>
<p id="section-4.3-1">When the device is first booted by the customer (and on subsequent
        boots), if the device does not have a valid configuration, it will use
        existing auto-install functionality. As an example, it performs DHCP
        Discovery until it gets a DHCP offer including DHCP option 66
        (Server-Name) or 150 (TFTP server address), contacts the server
        listed in these DHCP options, and downloads its configuration file. Note that this
        is existing functionality (for example, Cisco devices fetch the config
        file named by the Bootfile-Name DHCP option (67)).<a class="pilcrow" href="#section-4.3-1">¶</a></p>
<p id="section-4.3-2">After retrieving the configuration file, the device needs to determine if it is
        encrypted or not. If it is not encrypted, the existing behavior is used.
        If the configuration is encrypted, the process continues as described in this
        document. If the device has been configured to only support encrypted configuration
        and determines that the configuration file is not encrypted, it should abort.
        The method used to determine if the configuration is encrypted or not is
        implementation dependent; there are a number of (obvious) options, including
        having a magic string in the file header, using a file name extension
        (e.g., config.enc), or using specific DHCP options.<a class="pilcrow" href="#section-4.3-2">¶</a></p>
<p id="section-4.3-3">If the file is encrypted, the device will attempt to
        decrypt and parse the file. If able, it will install the configuration and
        start using it. If it cannot decrypt the file or if parsing the configuration fails,
        the device will either abort the auto-install process or repeat this
        process until it succeeds. When retrying, care should be taken to not
        overwhelm the server hosting the encrypted configuration files. It is suggested
        that the device retry every 5 minutes for the first hour and then every hour after
        that. As it is expected that devices may be installed well before the
        configuration file is ready, a maximum number of retries is not specified.<a class="pilcrow" href="#section-4.3-3">¶</a></p>
<p id="section-4.3-4">Note that the device only needs to be able to download the
        configuration file; after the initial power on in the factory, it never needs
        to access the Internet, vendor, or directory server. The device
        (and only the device) has the private key and so has the ability to decrypt
        the configuration file.<a class="pilcrow" href="#section-4.3-4">¶</a></p>
<span id="name-device-boot-fetch-and-insta"></span><figure id="figure-3">
          <div class="artwork art-text alignLeft" id="section-4.3-5.1">
<pre>          +--------+                +--------------+
          | Device |                |Config server |
          +--------+                |(e.g., TFTP)  |
                                    +--------------+
+---------------------------+    +------------------+
| +-----------+             |    |                  |
| |           |             |    |                  |
| |   DHCP    |             |    |                  |
| |           |             |    |                  |
| +-----+-----+             |    |                  |
|       |                   |    |                  |
| +-----v------+            |    |  +-----------+   |
| |            |            |    |  | Encrypted |   |
| |Fetch config|&lt;------------------&gt;|  config   |   |
| |            |            |    |  |   file    |   |
| +-----+------+            |    |  +-----------+   |
|       |                   |    |                  |
|       X                   |    |                  |
|      / \                  |    |                  |
|     /   \ N    +--------+ |    |                  |
|    | Enc?|----&gt;|Install,| |    |                  |
|     \   /      |  Boot  | |    |                  |
|      \ /       +--------+ |    |                  |
|       V                   |    |                  |
|       |Y                  |    |                  |
|       |                   |    |                  |
| +-----v------+            |    |                  |
| |Decrypt with|            |    |                  |
| |private key |            |    |                  |
| +-----+------+            |    |                  |
|       |                   |    |                  |
|       v                   |    |                  |
|      / \                  |    |                  |
|     /   \ Y    +--------+ |    |                  |
|    |Sane?|----&gt;|Install,| |    |                  |
|     \   /      |  Boot  | |    |                  |
|      \ /       +--------+ |    |                  |
|       V                   |    |                  |
|       |N                  |    |                  |
|       |                   |    |                  |
|  +----v---+               |    |                  |
|  |Retry or|               |    |                  |
|  | abort  |               |    |                  |
|  +--------+               |    |                  |
|                           |    |                  |
+---------------------------+    +------------------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-3">Figure 3</a>:
<a class="selfRef" href="#name-device-boot-fetch-and-insta">Device Boot, Fetch, and Install Configuration File</a>
          </figcaption></figure>
</section>
</div>
</section>
<section id="section-5">
      <h2 id="name-additional-considerations">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-additional-considerations">Additional Considerations</a>
      </h2>
<section id="section-5.1">
        <h3 id="name-key-storage">
<a class="section-number selfRef" href="#section-5.1">5.1. </a><a class="section-name selfRef" href="#name-key-storage">Key Storage</a>
        </h3>
<p id="section-5.1-1">Ideally, the key pair would be stored in a Trusted Platform Module
        (TPM) on something that is identified as the "router"
        -- for example, the chassis/backplane. This is so that a key pair
        is bound to what humans think of as the "device" and
        not, for example, (redundant) routing engines. Devices that
        implement IEEE 802.1AR <span>[<a class="xref" href="#IEEE802-1AR">IEEE802-1AR</a>]</span>
        could choose to use the Initial Device Identifier (IDevID) for this
        purpose.<a class="pilcrow" href="#section-5.1-1">¶</a></p>
</section>
<section id="section-5.2">
        <h3 id="name-key-replacement">
<a class="section-number selfRef" href="#section-5.2">5.2. </a><a class="section-name selfRef" href="#name-key-replacement">Key Replacement</a>
        </h3>
<p id="section-5.2-1">It is anticipated that some operator may want to replace the
        (vendor-provided) keys after installing the device. There are two
        options when implementing this: a vendor could allow the operator's
        key to completely replace the initial device-generated key (which
        means that, if the device is ever sold, the new owner couldn't use
        this technique to install the device), or the device could prefer the
        operator's installed key. This is an implementation decision left to
        the vendor.<a class="pilcrow" href="#section-5.2-1">¶</a></p>
</section>
<section id="section-5.3">
        <h3 id="name-device-reinstall">
<a class="section-number selfRef" href="#section-5.3">5.3. </a><a class="section-name selfRef" href="#name-device-reinstall">Device Reinstall</a>
        </h3>
<p id="section-5.3-1">Increasingly, operations are moving towards an automated model of
        device management, whereby portions of the configuration (or the entire configuration) are
        programmatically generated. This means that operators may want to
        generate an entire configuration after the device has been initially
        installed and ask the device to load and use this new configuration.


        It is expected (but not defined in this document, as it is vendor
        specific) that vendors will allow the operator to copy a new,
        encrypted configuration (or part of a configuration) onto a device and
        then request that the device decrypt and install it (e.g., 'load
        replace &lt;filename&gt; encrypted'). The operator could also choose to
        reset the device to factory defaults and allow the device to act as
        though it were the initial boot (see <a class="xref" href="#initial_cust_boot">Section 4.3</a>).<a class="pilcrow" href="#section-5.3-1">¶</a></p>
</section>
</section>
<section id="section-6">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<p id="section-6-1">This document has no IANA actions.<a class="pilcrow" href="#section-6-1">¶</a></p>
</section>
<div id="security">
<section id="section-7">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<p id="section-7-1">This reference architecture is intended to incrementally improve
      upon commonly accepted "auto-install" practices used today that may
      transmit configurations unencrypted (e.g., unencrypted configuration files
      that can be downloaded connecting to unprotected ports in data centers,
      mailing initial configuration files on flash drives, or emailing configuration files
      and asking a third party to copy and paste them over a serial terminal)
      or allow unrestricted access to these configurations.<a class="pilcrow" href="#section-7-1">¶</a></p>
<p id="section-7-2">This document describes an object-level security design to provide
      confidentiality assurances for the configuration stored at rest on the
      configuration server and for configuration while it is in transit
      between the configuration server and the unprovisioned device, even if
      the underlying transport does not provide this security service.<a class="pilcrow" href="#section-7-2">¶</a></p>
<p id="section-7-3">The architecture provides no assurances about the source of
      the encrypted configuration or protect against theft and
      reuse of devices.<a class="pilcrow" href="#section-7-3">¶</a></p>
<p id="section-7-4">An attacker (e.g., a malicious data center employee, person in the
      supply chain, etc.) who has physical
      access to the device before it is connected to the network or who
      manages to exploit it once installed
      may be able to extract the device private key (especially if it is not
      stored in a TPM), pretend to be the device when connecting to the
      network, and download and extract the (encrypted) configuration file.<a class="pilcrow" href="#section-7-4">¶</a></p>
<p id="section-7-5">An attacker with access to the configuration server (or the
      ability to route traffic to configuration server under their control)
      and the device's public key could return a configuration of the
      attacker's choosing to the unprovisioned device.<a class="pilcrow" href="#section-7-5">¶</a></p>
<p id="section-7-6">This mechanism does not protect against a malicious vendor. While
      the key pair should be generated on the device and the private key
      should be securely stored, the mechanism cannot detect or protect
      against a vendor who claims to do this but instead generates the
      key pair off device and keeps a copy of the private key. It is largely
      understood in the operator community that a malicious vendor or attacker
      with physical access to the device is largely a "Game Over"
      situation.<a class="pilcrow" href="#section-7-6">¶</a></p>
<p id="section-7-7">Even when using a secure bootstrap mechanism, security-conscious
      operators may wish to bootstrap devices with a minimal or less-sensitive
      configuration and then replace this with a more complete one after
      install.<a class="pilcrow" href="#section-7-7">¶</a></p>
</section>
</div>
<section id="section-8">
      <h2 id="name-informative-references">
<a class="section-number selfRef" href="#section-8">8. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
      </h2>
<dl class="references">
<dt id="I-D.ietf-anima-bootstrapping-keyinfra">[BRSKI]</dt>
      <dd>
<span class="refAuthor">Pritikin, M.</span><span class="refAuthor">, Richardson, M.</span><span class="refAuthor">, Eckert, T.</span><span class="refAuthor">, Behringer, M.</span><span class="refAuthor">, and K. Watsen</span>, <span class="refTitle">"Bootstrapping Remote Secure Key Infrastructures (BRSKI)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-anima-bootstrapping-keyinfra-44</span>, <time class="refDate" datetime="2020-09-21">21 September 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-anima-bootstrapping-keyinfra-44">https://tools.ietf.org/html/draft-ietf-anima-bootstrapping-keyinfra-44</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Cisco_AutoInstall">[Cisco_AutoInstall]</dt>
      <dd>
<span class="refAuthor">Cisco Systems, Inc.</span>, <span class="refTitle">"Using AutoInstall to Remotely Configure Cisco Networking Devices"</span>, <span class="refContent">Configuration Fundamentals Configuration Guide, Cisco IOS
 Release 15M&amp;T</span>, <time class="refDate" datetime="2018-01">January 2018</time>, <span>&lt;<a href="https://www.cisco.com/c/en/us/td/docs/ios-xml/ios/fundamentals/configuration/15mt/fundamentals-15-mt-book/cf-autoinstall.html">https://www.cisco.com/c/en/us/td/docs/ios-xml/ios/fundamentals/configuration/15mt/fundamentals-15-mt-book/cf-autoinstall.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IEEE802-1AR">[IEEE802-1AR]</dt>
      <dd>
<span class="refAuthor">IEEE</span>, <span class="refTitle">"IEEE Standard for Local and Metropolitan Area Networks - Secure Device Identity"</span>, <span class="seriesInfo">IEEE Std 802-1AR</span>, <time class="refDate" datetime="2018-06">June 2018</time>, <span>&lt;<a href="https://standards.ieee.org/standard/802_1AR-2018.html">https://standards.ieee.org/standard/802_1AR-2018.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1350">[RFC1350]</dt>
      <dd>
<span class="refAuthor">Sollins, K.</span>, <span class="refTitle">"The TFTP Protocol (Revision 2)"</span>, <span class="seriesInfo">STD 33</span>, <span class="seriesInfo">RFC 1350</span>, <span class="seriesInfo">DOI 10.17487/RFC1350</span>, <time class="refDate" datetime="1992-07">July 1992</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1350">https://www.rfc-editor.org/info/rfc1350</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2131">[RFC2131]</dt>
      <dd>
<span class="refAuthor">Droms, R.</span>, <span class="refTitle">"Dynamic Host Configuration Protocol"</span>, <span class="seriesInfo">RFC 2131</span>, <span class="seriesInfo">DOI 10.17487/RFC2131</span>, <time class="refDate" datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2131">https://www.rfc-editor.org/info/rfc2131</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2865">[RFC2865]</dt>
      <dd>
<span class="refAuthor">Rigney, C.</span><span class="refAuthor">, Willens, S.</span><span class="refAuthor">, Rubens, A.</span><span class="refAuthor">, and W. Simpson</span>, <span class="refTitle">"Remote Authentication Dial In User Service (RADIUS)"</span>, <span class="seriesInfo">RFC 2865</span>, <span class="seriesInfo">DOI 10.17487/RFC2865</span>, <time class="refDate" datetime="2000-06">June 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2865">https://www.rfc-editor.org/info/rfc2865</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4122">[RFC4122]</dt>
      <dd>
<span class="refAuthor">Leach, P.</span><span class="refAuthor">, Mealling, M.</span><span class="refAuthor">, and R. Salz</span>, <span class="refTitle">"A Universally Unique IDentifier (UUID) URN Namespace"</span>, <span class="seriesInfo">RFC 4122</span>, <span class="seriesInfo">DOI 10.17487/RFC4122</span>, <time class="refDate" datetime="2005-07">July 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4122">https://www.rfc-editor.org/info/rfc4122</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
      <dd>
<span class="refAuthor">Cooper, D.</span><span class="refAuthor">, Santesson, S.</span><span class="refAuthor">, Farrell, S.</span><span class="refAuthor">, Boeyen, S.</span><span class="refAuthor">, Housley, R.</span><span class="refAuthor">, and W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time class="refDate" datetime="2008-05">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5280">https://www.rfc-editor.org/info/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7030">[RFC7030]</dt>
      <dd>
<span class="refAuthor">Pritikin, M., Ed.</span><span class="refAuthor">, Yee, P., Ed.</span><span class="refAuthor">, and D. Harkins, Ed.</span>, <span class="refTitle">"Enrollment over Secure Transport"</span>, <span class="seriesInfo">RFC 7030</span>, <span class="seriesInfo">DOI 10.17487/RFC7030</span>, <time class="refDate" datetime="2013-10">October 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7030">https://www.rfc-editor.org/info/rfc7030</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8415">[RFC8415]</dt>
      <dd>
<span class="refAuthor">Mrugalski, T.</span><span class="refAuthor">, Siodelski, M.</span><span class="refAuthor">, Volz, B.</span><span class="refAuthor">, Yourtchenko, A.</span><span class="refAuthor">, Richardson, M.</span><span class="refAuthor">, Jiang, S.</span><span class="refAuthor">, Lemon, T.</span><span class="refAuthor">, and T. Winters</span>, <span class="refTitle">"Dynamic Host Configuration Protocol for IPv6 (DHCPv6)"</span>, <span class="seriesInfo">RFC 8415</span>, <span class="seriesInfo">DOI 10.17487/RFC8415</span>, <time class="refDate" datetime="2018-11">November 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8415">https://www.rfc-editor.org/info/rfc8415</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8551">[RFC8551]</dt>
      <dd>
<span class="refAuthor">Schaad, J.</span><span class="refAuthor">, Ramsdell, B.</span><span class="refAuthor">, and S. Turner</span>, <span class="refTitle">"Secure/Multipurpose Internet Mail Extensions (S/MIME) Version 4.0 Message Specification"</span>, <span class="seriesInfo">RFC 8551</span>, <span class="seriesInfo">DOI 10.17487/RFC8551</span>, <time class="refDate" datetime="2019-04">April 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8551">https://www.rfc-editor.org/info/rfc8551</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8572">[RFC8572]</dt>
      <dd>
<span class="refAuthor">Watsen, K.</span><span class="refAuthor">, Farrer, I.</span><span class="refAuthor">, and M. Abrahamsson</span>, <span class="refTitle">"Secure Zero Touch Provisioning (SZTP)"</span>, <span class="seriesInfo">RFC 8572</span>, <span class="seriesInfo">DOI 10.17487/RFC8572</span>, <time class="refDate" datetime="2019-04">April 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8572">https://www.rfc-editor.org/info/rfc8572</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8894">[RFC8894]</dt>
      <dd>
<span class="refAuthor">Gutmann, P.</span>, <span class="refTitle">"Simple Certificate Enrolment Protocol"</span>, <span class="seriesInfo">RFC 8894</span>, <span class="seriesInfo">DOI 10.17487/RFC8894</span>, <time class="refDate" datetime="2020-09">September 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8894">https://www.rfc-editor.org/info/rfc8894</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-opsawg-tacacs">[TACACS]</dt>
    <dd>
<span class="refAuthor">Dahm, T.</span><span class="refAuthor">, Ota, A.</span><span class="refAuthor">, Medway Gash, D.</span><span class="refAuthor">, Carrel, D.</span><span class="refAuthor">, and L. Grant</span>, <span class="refTitle">"The TACACS+ Protocol"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-opsawg-tacacs-18</span>, <time class="refDate" datetime="2020-03-20">20 March 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-opsawg-tacacs-18">https://tools.ietf.org/html/draft-ietf-opsawg-tacacs-18</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<div id="proof">
<section id="section-appendix.a">
      <h2 id="name-proof-of-concept">
<a class="section-number selfRef" href="#section-appendix.a">Appendix A. </a><a class="section-name selfRef" href="#name-proof-of-concept">Proof of Concept</a>
      </h2>
<p id="section-appendix.a-1">This section contains a proof of concept of the system.
      It is only intended for illustration and is not intended to be used
      in production.<a class="pilcrow" href="#section-appendix.a-1">¶</a></p>
<p id="section-appendix.a-2">It uses OpenSSL from the command line. In production, something more
      automated would be used. In this example, the unique device identifier is the
      serial number of the router, SN19842256.<a class="pilcrow" href="#section-appendix.a-2">¶</a></p>
<section id="section-a.1">
        <h2 id="name-step-1-generating-the-certi">
<a class="section-number selfRef" href="#section-a.1">A.1. </a><a class="section-name selfRef" href="#name-step-1-generating-the-certi">Step 1: Generating the Certificate</a>
        </h2>
<p id="section-a.1-1">This step is performed by the router. It generates a key, then a
        Certificate Signing Request (CSR), and then a self-signed certificate.<a class="pilcrow" href="#section-a.1-1">¶</a></p>
<section id="section-a.1.1">
          <h3 id="name-step-11-generate-the-privat">
<a class="section-number selfRef" href="#section-a.1.1">A.1.1. </a><a class="section-name selfRef" href="#name-step-11-generate-the-privat">Step 1.1: Generate the Private Key</a>
          </h3>
<div id="section-a.1.1-1">
<pre class="sourcecode">$ openssl ecparam -out privatekey.key -name prime256v1 -genkey
$
</pre><a class="pilcrow" href="#section-a.1.1-1">¶</a>
</div>
</section>
<section id="section-a.1.2">
          <h3 id="name-step-12-generate-the-certif">
<a class="section-number selfRef" href="#section-a.1.2">A.1.2. </a><a class="section-name selfRef" href="#name-step-12-generate-the-certif">Step 1.2: Generate the Certificate Signing Request</a>
          </h3>
<div id="section-a.1.2-1">
<pre class="sourcecode">$ openssl req -new -key key.pem -out SN19842256.csr
Common Name (e.g., server FQDN or YOUR name) []:SN19842256
</pre><a class="pilcrow" href="#section-a.1.2-1">¶</a>
</div>
</section>
<section id="section-a.1.3">
          <h3 id="name-step-13-generate-the-self-s">
<a class="section-number selfRef" href="#section-a.1.3">A.1.3. </a><a class="section-name selfRef" href="#name-step-13-generate-the-self-s">Step 1.3: Generate the (Self-Signed) Certificate Itself</a>
          </h3>
<div id="section-a.1.3-1">
<pre class="sourcecode">$ openssl req -x509 -days 36500 -key key.pem -in SN19842256.csr
-out SN19842256.crt
</pre><a class="pilcrow" href="#section-a.1.3-1">¶</a>
</div>
<p id="section-a.1.3-2">The router then sends the key to the vendor's key server for
          publication (not shown).<a class="pilcrow" href="#section-a.1.3-2">¶</a></p>
</section>
</section>
<section id="section-a.2">
        <h2 id="name-step-2-generating-the-encry">
<a class="section-number selfRef" href="#section-a.2">A.2. </a><a class="section-name selfRef" href="#name-step-2-generating-the-encry">Step 2: Generating the Encrypted Configuration</a>
        </h2>
<p id="section-a.2-1">The operator now wants to deploy the new router.<a class="pilcrow" href="#section-a.2-1">¶</a></p>
<p id="section-a.2-2">They generate the initial configuration (using whatever magic tool
        generates router configs!), fetch the router's certificate, and
        encrypt the configuration file to that key. This is done by the operator.<a class="pilcrow" href="#section-a.2-2">¶</a></p>
<section id="section-a.2.1">
          <h3 id="name-step-21-fetch-the-certifica">
<a class="section-number selfRef" href="#section-a.2.1">A.2.1. </a><a class="section-name selfRef" href="#name-step-21-fetch-the-certifica">Step 2.1: Fetch the Certificate</a>
          </h3>
<div id="section-a.2.1-1">
<pre class="sourcecode">$ wget http://keyserv.example.net/certificates/SN19842256.crt
</pre><a class="pilcrow" href="#section-a.2.1-1">¶</a>
</div>
</section>
<section id="section-a.2.2">
          <h3 id="name-step-22-encrypt-the-configu">
<a class="section-number selfRef" href="#section-a.2.2">A.2.2. </a><a class="section-name selfRef" href="#name-step-22-encrypt-the-configu">Step 2.2: Encrypt the Configuration File</a>
          </h3>
<p id="section-a.2.2-1">S/MIME is used here because it is simple to demonstrate. This is
          almost definitely not the best way to do this.<a class="pilcrow" href="#section-a.2.2-1">¶</a></p>
<div id="section-a.2.2-2">
<pre class="sourcecode">$ openssl smime -encrypt -aes-256-cbc -in SN19842256.cfg\
   -out SN19842256.enc -outform PEM SN19842256.crt
$ more SN19842256.enc
-----BEGIN PKCS7-----
MIICigYJKoZIhvcNAQcDoIICezCCAncCAQAxggE+MIIBOgIBADAiMBUxEzARBgNV
BAMMClNOMTk4NDIyNTYCCQDJVuBlaTOb1DANBgkqhkiG9w0BAQEFAASCAQBABvM3
...
LZoq08jqlWhZZWhTKs4XPGHUdmnZRYIP8KXyEtHt
-----END PKCS7-----
</pre><a class="pilcrow" href="#section-a.2.2-2">¶</a>
</div>
</section>
<section id="section-a.2.3">
          <h3 id="name-step-23-copy-configuration-">
<a class="section-number selfRef" href="#section-a.2.3">A.2.3. </a><a class="section-name selfRef" href="#name-step-23-copy-configuration-">Step 2.3: Copy Configuration to the Configuration Server</a>
          </h3>
<div id="section-a.2.3-1">
<pre class="sourcecode">$ scp SN19842256.enc config.example.com:/tftpboot
</pre><a class="pilcrow" href="#section-a.2.3-1">¶</a>
</div>
</section>
</section>
<section id="section-a.3">
        <h2 id="name-step-3-decrypting-and-using">
<a class="section-number selfRef" href="#section-a.3">A.3. </a><a class="section-name selfRef" href="#name-step-3-decrypting-and-using">Step 3: Decrypting and Using the Configuration</a>
        </h2>
<p id="section-a.3-1">When the router connects to the operator's network, it will detect
        that it does not have a valid configuration file and will start the
        "autoboot" process. This is a well-documented process, but
        the high-level overview is that it will use DHCP to obtain an IP
        address and configuration server. It will then use TFTP to download a
        configuration file, based upon its serial number (this document
        modifies the solution to fetch an encrypted configuration file (ending in
        .enc)). It will then decrypt the configuration file and install it.<a class="pilcrow" href="#section-a.3-1">¶</a></p>
<section id="section-a.3.1">
          <h3 id="name-step-31-fetch-encrypted-con">
<a class="section-number selfRef" href="#section-a.3.1">A.3.1. </a><a class="section-name selfRef" href="#name-step-31-fetch-encrypted-con">Step 3.1: Fetch Encrypted Configuration File from Configuration Server</a>
          </h3>
<div id="section-a.3.1-1">
<pre class="sourcecode">$ tftp 2001:0db8::23 -c get SN19842256.enc
</pre><a class="pilcrow" href="#section-a.3.1-1">¶</a>
</div>
</section>
<section id="section-a.3.2">
          <h3 id="name-step-32-decrypt-and-use-the">
<a class="section-number selfRef" href="#section-a.3.2">A.3.2. </a><a class="section-name selfRef" href="#name-step-32-decrypt-and-use-the">Step 3.2: Decrypt and Use the Configuration</a>
          </h3>
<div id="section-a.3.2-1">
<pre class="sourcecode">$ openssl smime -decrypt -in SN19842256.enc -inform pkcs7\
   -out config.cfg -inkey key.pem
</pre><a class="pilcrow" href="#section-a.3.2-1">¶</a>
</div>
<p id="section-a.3.2-2">If an attacker does not have the correct key, they will not be
          able to decrypt the configuration file:<a class="pilcrow" href="#section-a.3.2-2">¶</a></p>
<div id="section-a.3.2-3">
<pre class="sourcecode">$ openssl smime -decrypt -in SN19842256.enc -inform pkcs7\
   -out config.cfg -inkey wrongkey.pem
Error decrypting PKCS#7 structure
140352450692760:error:06065064:digital envelope
 routines:EVP_DecryptFinal_ex:bad decrypt:evp_enc.c:592:
$ echo $?
4</pre><a class="pilcrow" href="#section-a.3.2-3">¶</a>
</div>
</section>
</section>
</section>
</div>
<section id="section-appendix.b">
      <h2 id="name-acknowledgments">
<a class="section-name selfRef" href="#name-acknowledgments">Acknowledgments</a>
      </h2>
<p id="section-appendix.b-1">The authors wish to thank everyone who contributed, including
      <span class="contact-name">Benoit Claise</span>, <span class="contact-name">Francis       Dupont</span>, <span class="contact-name">Mirja Kuehlewind</span>, <span class="contact-name">Sam Ribeiro</span>, <span class="contact-name">Michael Richardson</span>,
      <span class="contact-name">Sean Turner</span>, and <span class="contact-name">Kent       Watsen</span>. <span class="contact-name">Joe Clarke</span> also provided significant
      comments and review, and <span class="contact-name">Tom Petch</span> provided
      significant editorial contributions to better describe the use cases
      and clarify the scope.<a class="pilcrow" href="#section-appendix.b-1">¶</a></p>
<p id="section-appendix.b-2"><span class="contact-name">Roman Danyliw</span> and <span class="contact-name">Benjamin       Kaduk</span> also provided helpful text, especially around the certificate
      usage and security considerations.<a class="pilcrow" href="#section-appendix.b-2">¶</a></p>
</section>
<div id="authors-addresses">
<section id="section-appendix.c">
      <h2 id="name-authors-addresses">
<a class="section-name selfRef" href="#name-authors-addresses">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Warren Kumari</span></div>
<div class="left" dir="auto"><span class="org">Google</span></div>
<div class="left" dir="auto"><span class="street-address">1600 Amphitheatre Parkway</span></div>
<div class="left" dir="auto">
<span class="locality">Mountain View</span>, <span class="region">CA</span> <span class="postal-code">94043</span>
</div>
<div class="left" dir="auto"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:warren@kumari.net">warren@kumari.net</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Colin Doyle</span></div>
<div class="left" dir="auto"><span class="org">Juniper Networks</span></div>
<div class="left" dir="auto"><span class="street-address">1133 Innovation Way</span></div>
<div class="left" dir="auto">
<span class="locality">Sunnyvale</span>, <span class="region">CA</span> <span class="postal-code">94089</span>
</div>
<div class="left" dir="auto"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:cdoyle@juniper.net">cdoyle@juniper.net</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>