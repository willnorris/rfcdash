<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 9133: Controlling Filtering Rules Using Distributed Denial-of-Service Open Threat Signaling (DOTS) Signal Channel</title>
<meta content="Kaname Nishizuka" name="author"/>
<meta content="Mohamed Boucadair" name="author"/>
<meta content="Tirumaleswar Reddy.K" name="author"/>
<meta content="Takahiko Nagata" name="author"/>
<meta content="
       This document specifies an extension to the Distributed
      Denial-of-Service Open Threat Signaling (DOTS) signal channel protocol
      so that DOTS clients can control their filtering rules when an attack
      mitigation is active. 
       Particularly, this extension allows a DOTS client to activate or
      deactivate existing filtering rules during a Distributed
      Denial-of-Service (DDoS) attack. The
      characterization of these filtering rules is conveyed by a DOTS client
      during an 'idle' time (i.e., no mitigation is active) by means of the DOTS
      data channel protocol. 
    " name="description"/>
<meta content="xml2rfc 3.9.1" name="generator"/>
<meta content="Mitigation" name="keyword"/>
<meta content="Automation" name="keyword"/>
<meta content="Filtering" name="keyword"/>
<meta content="Protective Networking" name="keyword"/>
<meta content="Protected Networks" name="keyword"/>
<meta content="Security" name="keyword"/>
<meta content="Anti-DDoS" name="keyword"/>
<meta content="Reactive" name="keyword"/>
<meta content="Collaborative Networking" name="keyword"/>
<meta content="Collaborative Security" name="keyword"/>
<meta content="9133" name="rfc.number"/>
<!-- Generator version information:
  xml2rfc 3.9.1
    Python 3.6.10
    appdirs 1.4.4
    ConfigArgParse 1.2.3
    google-i18n-address 2.3.5
    html5lib 1.0.1
    intervaltree 3.0.2
    Jinja2 2.11.2
    kitchen 1.2.6
    lxml 4.4.2
    pycairo 1.19.0
    pycountry 19.8.18
    pyflakes 2.1.1
    PyYAML 5.3.1
    requests 2.22.0
    setuptools 40.6.2
    six 1.14.0
    WeasyPrint 51
-->
<link href="rfc9133.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://dx.doi.org/10.17487/rfc9133" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <link href="https://datatracker.ietf.org/doc/draft-ietf-dots-signal-filter-control-07" rel="prev"/>
  </head>
<body>
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9133</td>
<td class="center">DOTS Signal Filter Control</td>
<td class="right">September 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Nishizuka, et al.</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc9133">9133</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2021-09">September 2021</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">K. Nishizuka</div>
<div class="org">NTT Communications</div>
</div>
<div class="author">
      <div class="author-name">M. Boucadair</div>
<div class="org">Orange</div>
</div>
<div class="author">
      <div class="author-name">T. Reddy.K</div>
<div class="org">Akamai</div>
</div>
<div class="author">
      <div class="author-name">T. Nagata</div>
<div class="org">Lepidum</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9133</h1>
<h1 id="title">Controlling Filtering Rules Using Distributed Denial-of-Service Open Threat Signaling (DOTS) Signal Channel</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">This document specifies an extension to the Distributed
      Denial-of-Service Open Threat Signaling (DOTS) signal channel protocol
      so that DOTS clients can control their filtering rules when an attack
      mitigation is active.<a class="pilcrow" href="#section-abstract-1">¶</a></p>
<p id="section-abstract-2">Particularly, this extension allows a DOTS client to activate or
      deactivate existing filtering rules during a Distributed
      Denial-of-Service (DDoS) attack. The
      characterization of these filtering rules is conveyed by a DOTS client
      during an 'idle' time (i.e., no mitigation is active) by means of the DOTS
      data channel protocol.<a class="pilcrow" href="#section-abstract-2">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a class="pilcrow" href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9133">https://www.rfc-editor.org/info/rfc9133</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">▲</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact ulEmpty toc ulBare">
<li class="compact ulEmpty toc ulBare" id="section-toc.1-1.1">
            <p class="keepWithNext" id="section-toc.1-1.1.1"><a class="xref" href="#section-1">1</a>.  <a class="xref" href="#name-introduction">Introduction</a></p>
<ul class="toc ulEmpty ulBare compact">
<li class="toc ulEmpty ulBare compact" id="section-toc.1-1.1.2.1">
                <p class="keepWithNext" id="section-toc.1-1.1.2.1.1"><a class="xref" href="#section-1.1">1.1</a>.  <a class="xref" href="#name-the-problem">The Problem</a></p>
</li>
              <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.1.2.2">
                <p class="keepWithNext" id="section-toc.1-1.1.2.2.1"><a class="xref" href="#section-1.2">1.2</a>.  <a class="xref" href="#name-controlling-filtering-rules">Controlling Filtering Rules Using DOTS Signal Channel</a></p>
</li>
            </ul>
</li>
          <li class="compact ulEmpty toc ulBare" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a class="xref" href="#section-2">2</a>.  <a class="xref" href="#name-terminology">Terminology</a></p>
</li>
          <li class="compact ulEmpty toc ulBare" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a class="xref" href="#section-3">3</a>.  <a class="xref" href="#name-controlling-filtering-rules-">Controlling Filtering Rules of a DOTS Client</a></p>
<ul class="toc ulEmpty ulBare compact">
<li class="toc ulEmpty ulBare compact" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a class="xref" href="#section-3.1">3.1</a>.  <a class="xref" href="#name-binding-dots-data-and-signa">Binding DOTS Data and Signal Channels</a></p>
</li>
              <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a class="xref" href="#section-3.2">3.2</a>.  <a class="xref" href="#name-dots-signal-channel-extensi">DOTS Signal Channel Extension</a></p>
<ul class="toc ulEmpty ulBare compact">
<li class="toc ulEmpty ulBare compact" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a class="xref" href="#section-3.2.1">3.2.1</a>.  <a class="xref" href="#name-parameters-and-behaviors">Parameters and Behaviors</a></p>
</li>
                  <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.3.2.2.2.2">
                    <p id="section-toc.1-1.3.2.2.2.2.1"><a class="xref" href="#section-3.2.2">3.2.2</a>.  <a class="xref" href="#name-dots-signal-filtering-contr">DOTS Signal Filtering Control Module</a></p>
<ul class="toc ulEmpty ulBare compact">
<li class="toc ulEmpty ulBare compact" id="section-toc.1-1.3.2.2.2.2.2.1">
                        <p id="section-toc.1-1.3.2.2.2.2.2.1.1"><a class="xref" href="#section-3.2.2.1">3.2.2.1</a>.  <a class="xref" href="#name-tree-structure">Tree Structure</a></p>
</li>
                      <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.3.2.2.2.2.2.2">
                        <p id="section-toc.1-1.3.2.2.2.2.2.2.1"><a class="xref" href="#section-3.2.2.2">3.2.2.2</a>.  <a class="xref" href="#name-yang-module">YANG Module</a></p>
</li>
                    </ul>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact ulEmpty toc ulBare" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="xref" href="#section-4">4</a>.  <a class="xref" href="#name-some-examples">Some Examples</a></p>
<ul class="toc ulEmpty ulBare compact">
<li class="toc ulEmpty ulBare compact" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a class="xref" href="#section-4.1">4.1</a>.  <a class="xref" href="#name-conflict-handling">Conflict Handling</a></p>
</li>
              <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a class="xref" href="#section-4.2">4.2</a>.  <a class="xref" href="#name-on-demand-activation-of-an-">On-Demand Activation of an Accept-List Filter</a></p>
</li>
              <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a class="xref" href="#section-4.3">4.3</a>.  <a class="xref" href="#name-dots-servers-mitigators-lac">DOTS Servers/Mitigators Lacking Capacity</a></p>
</li>
            </ul>
</li>
          <li class="compact ulEmpty toc ulBare" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="xref" href="#section-5">5</a>.  <a class="xref" href="#name-iana-considerations">IANA Considerations</a></p>
<ul class="toc ulEmpty ulBare compact">
<li class="toc ulEmpty ulBare compact" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a class="xref" href="#section-5.1">5.1</a>.  <a class="xref" href="#name-dots-signal-channel-cbor-ke">DOTS Signal Channel CBOR Key Values Subregistry</a></p>
</li>
              <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a class="xref" href="#section-5.2">5.2</a>.  <a class="xref" href="#name-a-new-yang-module">A New YANG Module</a></p>
</li>
            </ul>
</li>
          <li class="compact ulEmpty toc ulBare" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="xref" href="#section-6">6</a>.  <a class="xref" href="#name-security-considerations">Security Considerations</a></p>
</li>
          <li class="compact ulEmpty toc ulBare" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="xref" href="#section-7">7</a>.  <a class="xref" href="#name-references">References</a></p>
<ul class="toc ulEmpty ulBare compact">
<li class="toc ulEmpty ulBare compact" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a class="xref" href="#section-7.1">7.1</a>.  <a class="xref" href="#name-normative-references">Normative References</a></p>
</li>
              <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a class="xref" href="#section-7.2">7.2</a>.  <a class="xref" href="#name-informative-references">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact ulEmpty toc ulBare" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="xref" href="#appendix-A"></a><a class="xref" href="#name-acknowledgements">Acknowledgements</a></p>
</li>
          <li class="compact ulEmpty toc ulBare" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="xref" href="#appendix-B"></a><a class="xref" href="#name-authors-addresses">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<div id="problem">
<section id="section-1.1">
        <h3 id="name-the-problem">
<a class="section-number selfRef" href="#section-1.1">1.1. </a><a class="section-name selfRef" href="#name-the-problem">The Problem</a>
        </h3>
<p id="section-1.1-1">In the Distributed Denial-of-Service Open Threat Signaling (DOTS)
        architecture <span>[<a class="xref" href="#RFC8811">RFC8811</a>]</span>, DOTS
        clients and servers communicate using both a signal channel protocol
        <span>[<a class="xref" href="#RFC9132">RFC9132</a>]</span> and a data channel protocol <span>[<a class="xref" href="#RFC8783">RFC8783</a>]</span>.<a class="pilcrow" href="#section-1.1-1">¶</a></p>
<p id="section-1.1-2">The DOTS data channel protocol <span>[<a class="xref" href="#RFC8783">RFC8783</a>]</span> is used for bulk data exchange between DOTS agents
        to improve the coordination of parties involved in the response to a
        Distributed Denial-of-Service (DDoS) attack. Filter management, which
        is one of the tasks of the DOTS data channel protocol, enables a DOTS
        client to retrieve the filtering capabilities of a DOTS server and to
        manage filtering rules. Typically, these filtering rules are used for
        dropping or rate-limiting unwanted traffic, and permitting
        accept-listed traffic.<a class="pilcrow" href="#section-1.1-2">¶</a></p>
<p id="section-1.1-3">The DOTS signal channel protocol <span>[<a class="xref" href="#RFC9132">RFC9132</a>]</span> is
        designed to be resilient under extremely hostile network conditions
        and provides continued contact between DOTS agents even as DDoS attack
        traffic saturates the link. The DOTS signal channel can be established
        between two DOTS agents prior to or during an attack. At any time, the
        DOTS client may send mitigation requests (as per <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9132#section-4.4">Section 4.4</a> of [<a class="xref" href="#RFC9132">RFC9132</a>]</span>) to a DOTS server over the active signal
        channel. While mitigation is active, the DOTS server periodically
        sends status messages to the DOTS client, including basic mitigation
        feedback details. In case of a massive DDoS attack that saturates the
        incoming link(s) to the DOTS client, all traffic from the DOTS server
        to the DOTS client will likely be dropped. However, the DOTS server
        may still receive DOTS messages sent from the DOTS client over the
        signaling channel thanks to the heartbeat requests keeping the
        channel active (as described in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9132#section-4.7">Section 4.7</a> of [<a class="xref" href="#RFC9132">RFC9132</a>]</span>).<a class="pilcrow" href="#section-1.1-3">¶</a></p>
<p id="section-1.1-4">Unlike the DOTS signal channel protocol, the DOTS data channel
        protocol is not expected to deal with attack conditions. As such, an
        issue that might be encountered in some deployments is when filters
        installed by means of the DOTS data channel protocol may not function
        as expected during DDoS attacks or, worse, exacerbate an ongoing DDoS
        attack. In such conditions, the DOTS data channel protocol cannot be
        used to change these filters, which may complicate DDoS mitigation
        operations <span>[<a class="xref" href="#INTEROP">INTEROP</a>]</span>.<a class="pilcrow" href="#section-1.1-4">¶</a></p>
<p id="section-1.1-5">A typical case is a conflict between filtering rules installed by a
        DOTS client and the mitigation actions of a DDoS mitigator. Consider,
        for instance, a DOTS client that configures during 'idle' time (i.e.,
        no mitigation is active) some filtering rules using the DOTS data
        channel protocol to permit traffic from accept-listed sources.
        However, during a volumetric DDoS attack, the DDoS mitigator identifies
        the source addresses/prefixes in the accept-listed filtering rules are
        attacking the target. For example, an attacker can spoof the IP
        addresses of accept-listed sources to generate attack traffic, or the
        attacker can compromise the accept-listed sources and program them to
        launch a DDoS attack.<a class="pilcrow" href="#section-1.1-5">¶</a></p>
<p id="section-1.1-6"><span>[<a class="xref" href="#RFC9132">RFC9132</a>]</span> is designed so that the
        DDoS server notifies the above conflict to the DOTS client (that is,
        the 'conflict-cause' parameter is set to 2 (conflict-with-acceptlist)),
        but the DOTS client may not be able to withdraw the accept-list rules
        during the attack period due to the high-volume attack traffic
        saturating the inbound link to the DOTS client domain.  In other
        words, the DOTS client cannot use the DOTS data channel protocol to
        withdraw the accept-list filters when a DDoS attack is in
        progress.<a class="pilcrow" href="#section-1.1-6">¶</a></p>
</section>
</div>
<div id="sol">
<section id="section-1.2">
        <h3 id="name-controlling-filtering-rules">
<a class="section-number selfRef" href="#section-1.2">1.2. </a><a class="section-name selfRef" href="#name-controlling-filtering-rules">Controlling Filtering Rules Using DOTS Signal Channel</a>
        </h3>
<p id="section-1.2-1">This specification addresses the problems discussed in <a class="xref" href="#problem">Section 1.1</a> by adding a capability for managing filtering
        rules using the DOTS signal channel protocol, which enables a DOTS
        client to request the activation (or deactivation) of filtering rules
        during a DDoS attack. Note that creating these filtering rules is
        still the responsibility of the DOTS data channel <span>[<a class="xref" href="#RFC8783">RFC8783</a>]</span>.<a class="pilcrow" href="#section-1.2-1">¶</a></p>
<p id="section-1.2-2">The DOTS signal channel protocol is designed to enable a DOTS
        client to contact a DOTS server for help even under severe network
        congestion conditions. Therefore, extending the DOTS signal channel
        protocol to manage the filtering rules during an attack will enhance
        the protection capability offered by DOTS protocols.<a class="pilcrow" href="#section-1.2-2">¶</a></p>
<aside id="section-1.2-3">
          <p id="section-1.2-3.1">Note: The experiment at the IETF 103 hackathon <span>[<a class="xref" href="#INTEROP">INTEROP</a>]</span> showed that even when the
          inbound link is saturated by DDoS attack traffic, the DOTS client
          can signal mitigation requests using the DOTS signal channel over
          the saturated link.<a class="pilcrow" href="#section-1.2-3.1">¶</a></p>
</aside>
<p id="section-1.2-4">Conflicts that are induced by filters installed by other DOTS
        clients of the same domain are not discussed in this
        specification.<a class="pilcrow" href="#section-1.2-4">¶</a></p>
<p id="section-1.2-5">An augmentation to the DOTS signal channel YANG module is defined
        in <a class="xref" href="#YANG">Section 3.2.2</a>.<a class="pilcrow" href="#section-1.2-5">¶</a></p>
<p id="section-1.2-6">Sample examples are provided in <a class="xref" href="#sample">Section 4</a>, in
        particular:<a class="pilcrow" href="#section-1.2-6">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.2-7.1">
            <a class="xref" href="#sample1">Section 4.1</a> illustrates how the filter
            control extension is used when conflicts with Access Control Lists
            (ACLs) are detected and reported by a DOTS server.<a class="pilcrow" href="#section-1.2-7.1">¶</a>
</li>
          <li class="normal" id="section-1.2-7.2">
            <a class="xref" href="#sample2">Section 4.2</a> shows how a DOTS client can
            instruct a DOTS server to safely forward some specific traffic in
            'attack' time.<a class="pilcrow" href="#section-1.2-7.2">¶</a>
</li>
          <li class="normal" id="section-1.2-7.3">
            <a class="xref" href="#sample3">Section 4.3</a> shows how a DOTS client can
            react if the DDoS traffic is still being forwarded to the DOTS
            client domain even if mitigation requests were sent to a DOTS
            server.<a class="pilcrow" href="#section-1.2-7.3">¶</a>
</li>
        </ul>
<p id="section-1.2-8">The JavaScript Object Notation (JSON) encoding of YANG-modeled data
        <span>[<a class="xref" href="#RFC7951">RFC7951</a>]</span> is used to illustrate the examples.<a class="pilcrow" href="#section-1.2-8">¶</a></p>
</section>
</div>
</section>
</div>
<div id="notation">
<section id="section-2">
      <h2 id="name-terminology">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-terminology">Terminology</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>",
      "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>",
      "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
      "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are
      to be interpreted as described in BCP 14 <span>[<a class="xref" href="#RFC2119">RFC2119</a>]</span> <span>[<a class="xref" href="#RFC8174">RFC8174</a>]</span> when, and
      only when, they appear in all capitals, as shown here.<a class="pilcrow" href="#section-2-1">¶</a></p>
<p id="section-2-2">The reader should be familiar with the terms defined in <span>[<a class="xref" href="#RFC8612">RFC8612</a>]</span>.<a class="pilcrow" href="#section-2-2">¶</a></p>
<p id="section-2-3">The terminology for describing YANG modules is defined in <span>[<a class="xref" href="#RFC7950">RFC7950</a>]</span>. The meaning of the symbols in the
      tree diagram is defined in <span>[<a class="xref" href="#RFC8340">RFC8340</a>]</span> and <span>[<a class="xref" href="#RFC8791">RFC8791</a>]</span>.<a class="pilcrow" href="#section-2-3">¶</a></p>
</section>
</div>
<section id="section-3">
      <h2 id="name-controlling-filtering-rules-">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-controlling-filtering-rules-">Controlling Filtering Rules of a DOTS Client</a>
      </h2>
<div id="bind">
<section id="section-3.1">
        <h3 id="name-binding-dots-data-and-signa">
<a class="section-number selfRef" href="#section-3.1">3.1. </a><a class="section-name selfRef" href="#name-binding-dots-data-and-signa">Binding DOTS Data and Signal Channels</a>
        </h3>
<p id="section-3.1-1">The filtering rules eventually managed using the DOTS signal
        channel protocol are created a priori by the same DOTS client using
        the DOTS data channel protocol. Managing conflicts with filters
        installed by other DOTS clients of the same domain is out of
        scope.<a class="pilcrow" href="#section-3.1-1">¶</a></p>
<p id="section-3.1-2">As discussed in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9132#section-4.4.1">Section 4.4.1</a> of [<a class="xref" href="#RFC9132">RFC9132</a>]</span>, a DOTS client must use the same 'cuid' for both the
        DOTS signal and data channels. This requirement is meant to facilitate
        binding DOTS channels used by the same DOTS client.<a class="pilcrow" href="#section-3.1-2">¶</a></p>
<p id="section-3.1-3">The DOTS signal and data channels from a DOTS client may or may not
        use the same DOTS server. Nevertheless, the scope of the mitigation
        request, alias, and filtering rules are not restricted to the DOTS
        server but to the DOTS server domain. To that aim, DOTS servers within
        a domain are assumed to have a mechanism to coordinate the mitigation
        requests, aliases, and filtering rules to coordinate their decisions
        for better mitigation operation efficiency. The exact details about
        such a mechanism is out of the scope of this document.<a class="pilcrow" href="#section-3.1-3">¶</a></p>
<p id="section-3.1-4">A filtering rule controlled by the DOTS signal channel is
        identified by its ACL name (<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8783#section-4.3">Section 4.3</a> of [<a class="xref" href="#RFC8783">RFC8783</a>]</span>). Note that an ACL name unambiguously
        identifies an ACL bound to a DOTS client, but the same name may be
        used by distinct DOTS clients.<a class="pilcrow" href="#section-3.1-4">¶</a></p>
<p id="section-3.1-5">The activation or deactivation of an ACL by the DOTS signal channel
        overrides the 'activation-type' (defined in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8783#section-4.3">Section 4.3</a> of [<a class="xref" href="#RFC8783">RFC8783</a>]</span>) a priori conveyed with the
        filtering rules using the DOTS data channel protocol.<a class="pilcrow" href="#section-3.1-5">¶</a></p>
<p id="section-3.1-6">Once the attack is mitigated, the DOTS client may use the data
        channel to control the 'activation-type' (e.g., revert to a default
        value) of some of the filtering rules controlled by the DOTS signal
        channel or delete some of these filters. This behavior is deployment
        specific.<a class="pilcrow" href="#section-3.1-6">¶</a></p>
</section>
</div>
<section id="section-3.2">
        <h3 id="name-dots-signal-channel-extensi">
<a class="section-number selfRef" href="#section-3.2">3.2. </a><a class="section-name selfRef" href="#name-dots-signal-channel-extensi">DOTS Signal Channel Extension</a>
        </h3>
<div id="filtering">
<section id="section-3.2.1">
          <h4 id="name-parameters-and-behaviors">
<a class="section-number selfRef" href="#section-3.2.1">3.2.1. </a><a class="section-name selfRef" href="#name-parameters-and-behaviors">Parameters and Behaviors</a>
          </h4>
<p id="section-3.2.1-1">This specification extends the mitigation request defined in
          <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9132#section-4.4.1">Section 4.4.1</a> of [<a class="xref" href="#RFC9132">RFC9132</a>]</span> to
          convey the intended control of configured filtering
          rules. Concretely, the DOTS client conveys the 'acl-list' attribute with
          the following sub-attributes in the Concise Binary Object
   Representation (CBOR) body of a mitigation
          request (see the YANG structure in <a class="xref" href="#tree">Section 3.2.2.1</a>):<a class="pilcrow" href="#section-3.2.1-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.2.1-2">
            <dt id="section-3.2.1-2.1">acl-name:</dt>
            <dd id="section-3.2.1-2.2" style="margin-left: 1.5em">
              <p id="section-3.2.1-2.2.1">A name of an access list defined using
              the DOTS data channel (<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8783#section-4.3">Section 4.3</a> of [<a class="xref" href="#RFC8783">RFC8783</a>]</span>) that is associated with the DOTS
              client.<a class="pilcrow" href="#section-3.2.1-2.2.1">¶</a></p>
<p id="section-3.2.1-2.2.2">As a reminder, an ACL is an ordered list of Access Control
              Entries (ACEs). Each ACE has a list of match criteria and a list
              of actions <span>[<a class="xref" href="#RFC8783">RFC8783</a>]</span>. The list
              of configured ACLs can be retrieved using the DOTS data channel
              during 'idle' time.<a class="pilcrow" href="#section-3.2.1-2.2.2">¶</a></p>
<p id="section-3.2.1-2.2.3">This is a mandatory attribute when 'acl-list'
              is included.<a class="pilcrow" href="#section-3.2.1-2.2.3">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.1-2.3">activation-type:</dt>
            <dd id="section-3.2.1-2.4" style="margin-left: 1.5em">
              <p id="section-3.2.1-2.4.1">An attribute indicating the activation type of
              an ACL overriding the existing 'activation-type' installed by
              the DOTS client using the DOTS data channel.<a class="pilcrow" href="#section-3.2.1-2.4.1">¶</a></p>
<p id="section-3.2.1-2.4.2">As a reminder, this attribute can be set to
              'deactivate', 'immediate', or 'activate-when-mitigating' as
              defined in <span>[<a class="xref" href="#RFC8783">RFC8783</a>]</span>.<a class="pilcrow" href="#section-3.2.1-2.4.2">¶</a></p>
<p id="section-3.2.1-2.4.3">Note that both 'immediate' and
              'activate-when-mitigating' have an immediate effect when a
              mitigation request is being processed by the DOTS server.<a class="pilcrow" href="#section-3.2.1-2.4.3">¶</a></p>
<p id="section-3.2.1-2.4.4">This is an optional attribute.<a class="pilcrow" href="#section-3.2.1-2.4.4">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-3.2.1-3">By default, ACL-related operations are achieved using the DOTS
          data channel protocol when no attack is ongoing. DOTS clients <span class="bcp14">MUST NOT</span> use the filtering control over the DOTS signal channel in 'idle'
          time; such requests <span class="bcp14">MUST</span> be discarded by DOTS servers with 4.00 (Bad
          Request).<a class="pilcrow" href="#section-3.2.1-3">¶</a></p>
<p id="section-3.2.1-4">During an attack time, DOTS clients may include 'acl-list',
          'acl-name', and 'activation-type' attributes in a mitigation
          request. This request may be the initial mitigation request for a
          given mitigation scope or a new one overriding an existing request.
          In both cases, a new 'mid' <span class="bcp14">MUST</span> be used. Nevertheless, it is <span class="bcp14">NOT RECOMMENDED</span> to include ACL attributes in an initial mitigation
          request for a given mitigation scope or in a mitigation request
          adjusting the mitigation scope. This recommendation is meant to
          avoid delaying attack mitigations because of failures to process ACL
          attributes.<a class="pilcrow" href="#section-3.2.1-4">¶</a></p>
<p id="section-3.2.1-5">As the attack evolves, DOTS clients can adjust the
          'activation-type' of an ACL conveyed in a mitigation request or
          control other filters as necessary. This can be achieved by sending
          a PUT request with a new 'mid' value.<a class="pilcrow" href="#section-3.2.1-5">¶</a></p>
<p id="section-3.2.1-6">It is <span class="bcp14">RECOMMENDED</span> for a DOTS client to subscribe
          to asynchronous notifications of the attack mitigation, as detailed
          in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9132#section-4.4.2.1">Section 4.4.2.1</a> of [<a class="xref" href="#RFC9132">RFC9132</a>]</span>. If
          not, the polling mechanism in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9132#section-4.4.2.2">Section 4.4.2.2</a> of [<a class="xref" href="#RFC9132">RFC9132</a>]</span> has to be followed by the
          DOTS client.<a class="pilcrow" href="#section-3.2.1-6">¶</a></p>
<p id="section-3.2.1-7">A DOTS client relies on the information received from the DOTS
          server and/or local information to the DOTS client domain to trigger
          a filter control request. Only filters that are pertinent for an
          ongoing mitigation should be controlled by a DOTS client using the
          DOTS signal channel.<a class="pilcrow" href="#section-3.2.1-7">¶</a></p>
<p id="section-3.2.1-8">'acl-list', 'acl-name', and 'activation-type' are defined as
          comprehension-required parameters. Following the rules in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9132#section-6">Section 6</a> of [<a class="xref" href="#RFC9132">RFC9132</a>]</span>, if the DOTS
          server does not understand the 'acl-list', 'acl-name', or
          'activation-type' attributes, it responds with a 4.00 (Bad
          Request) error response code.<a class="pilcrow" href="#section-3.2.1-8">¶</a></p>
<p id="section-3.2.1-9">If the DOTS server does not find the ACL name ('acl-name')
          conveyed in the mitigation request for this DOTS client, it <span class="bcp14">MUST</span>
          respond with a 4.04 (Not Found) error response code.<a class="pilcrow" href="#section-3.2.1-9">¶</a></p>
<p id="section-3.2.1-10">If the DOTS server finds the ACL name for this DOTS client, and
          assuming the request passed the validation checks in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9132#section-4.4.1">Section 4.4.1</a> of [<a class="xref" href="#RFC9132">RFC9132</a>]</span>, the DOTS
          server <span class="bcp14">MUST</span> proceed with the 'activation-type'
          update. The update is immediately enforced by the DOTS server and
          will be maintained as the new activation type for the ACL name even
          after the termination of the mitigation request. In addition, the
          DOTS server <span class="bcp14">MUST</span> update the lifetime of the
          corresponding ACL similar to the update when a refresh request is
          received using the DOTS data channel (<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8783#section-7.2">Section 7.2</a> of [<a class="xref" href="#RFC8783">RFC8783</a>]</span>). If, for some reason, the DOTS
          server fails to apply the filter update, it <span class="bcp14">MUST</span>
          respond with a 5.03 (Service Unavailable) error response code and
          include the failed ACL update in the diagnostic payload of the
          response (an example is shown in <a class="xref" href="#diag">Figure 1</a>). Else, the DOTS server replies with the
          appropriate response code defined in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9132#section-4.4.1">Section 4.4.1</a> of [<a class="xref" href="#RFC9132">RFC9132</a>]</span>.<a class="pilcrow" href="#section-3.2.1-10">¶</a></p>
<span id="name-example-of-a-diagnostic-pay"></span><div id="diag">
<figure id="figure-1">
            <div id="section-3.2.1-11.1">
<pre class="sourcecode">{
  "ietf-dots-signal-channel:mitigation-scope": {
    "scope": [
      {
        "mid": 123,
        "ietf-dots-signal-control:acl-list": [
          {
            "acl-name": "an-accept-list",
            "activation-type": "deactivate"
          }
        ]
      }
    ]
  }
}
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-1">Figure 1</a>:
<a class="selfRef" href="#name-example-of-a-diagnostic-pay">Example of a Diagnostic Payload Including Failed ACL Update</a>
            </figcaption></figure>
</div>
<p id="section-3.2.1-12">The JSON/YANG mappings for DOTS filter control attributes are
          shown in <a class="xref" href="#table1">Table 1</a>. As a reminder, the mapping for 'acl-name' is
          defined in Table 5 of <span>[<a class="xref" href="#RFC9132">RFC9132</a>]</span>.<a class="pilcrow" href="#section-3.2.1-12">¶</a></p>
<span id="name-json-yang-mapping-to-cbor-f"></span><div id="table1">
<table class="center" id="table-1">
            <caption>
<a class="selfRef" href="#table-1">Table 1</a>:
<a class="selfRef" href="#name-json-yang-mapping-to-cbor-f">JSON/YANG Mapping to CBOR for Filter Control Attributes</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" colspan="1" rowspan="1">Parameter Name</th>
                <th class="text-left" colspan="1" rowspan="1">YANG Type</th>
                <th class="text-left" colspan="1" rowspan="1">CBOR Key</th>
                <th class="text-left" colspan="1" rowspan="1">CBOR Major Type &amp; Information</th>
                <th class="text-left" colspan="1" rowspan="1">JSON Type</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">activation-type</td>
                <td class="text-left" colspan="1" rowspan="1">enumeration</td>
                <td class="text-left" colspan="1" rowspan="1">52</td>
                <td class="text-left" colspan="1" rowspan="1">0 unsigned</td>
                <td class="text-left" colspan="1" rowspan="1">String</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">ietf-dots-signal-control:acl-list</td>
                <td class="text-left" colspan="1" rowspan="1">list</td>
                <td class="text-left" colspan="1" rowspan="1">53</td>
                <td class="text-left" colspan="1" rowspan="1">4 array</td>
                <td class="text-left" colspan="1" rowspan="1">Array</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">acl-name</td>
                <td class="text-left" colspan="1" rowspan="1">leafref</td>
                <td class="text-left" colspan="1" rowspan="1">23</td>
                <td class="text-left" colspan="1" rowspan="1">3 text string</td>
                <td class="text-left" colspan="1" rowspan="1">String</td>
              </tr>
            </tbody>
          </table>
</div>
<p id="section-3.2.1-14">If the DOTS client receives a 5.03 (Service Unavailable) with a
          diagnostic payload indicating a failed ACL update as a response to
          an initial mitigation or a mitigation with adjusted scope, the DOTS
          client <span class="bcp14">MUST</span> immediately send a new request that
          repeats all the parameters as sent in the failed mitigation request
          but without including the ACL attributes. After the expiry of
          Max-Age returned in the 5.03 (Service Unavailable) response, the
          DOTS client retries with a new mitigation request (i.e., a new
          'mid') that repeats all the parameters as sent in the failed
          mitigation request (i.e., the one including the ACL attributes).<a class="pilcrow" href="#section-3.2.1-14">¶</a></p>
<p id="section-3.2.1-15">If, during an active mitigation, the 'activation-type' is changed
          at the DOTS server (e.g., as a result of an external action) for an
          ACL bound to a DOTS client, the DOTS server notifies that DOTS
          client of the change by including the corresponding ACL parameters
          in an asynchronous notification (the DOTS client is observing the
          active mitigation) or in a response to a polling request (<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9132#section-4.4.2.2">Section 4.4.2.2</a> of [<a class="xref" href="#RFC9132">RFC9132</a>]</span>).<a class="pilcrow" href="#section-3.2.1-15">¶</a></p>
<p id="section-3.2.1-16">If the DOTS signal and data channels of a DOTS client are not
          established with the same DOTS server of a DOTS server domain, the
          above request processing operations are undertaken using the
          coordination mechanism discussed in <a class="xref" href="#bind">Section 3.1</a>.<a class="pilcrow" href="#section-3.2.1-16">¶</a></p>
<p id="section-3.2.1-17">This specification does not require any modification to the
          efficacy update and the withdrawal procedures defined in <span>[<a class="xref" href="#RFC9132">RFC9132</a>]</span>. In particular, ACL-related clauses are not
          included in a PUT request used to send an efficacy update and DELETE
          requests.<a class="pilcrow" href="#section-3.2.1-17">¶</a></p>
</section>
</div>
<div id="YANG">
<section id="section-3.2.2">
          <h4 id="name-dots-signal-filtering-contr">
<a class="section-number selfRef" href="#section-3.2.2">3.2.2. </a><a class="section-name selfRef" href="#name-dots-signal-filtering-contr">DOTS Signal Filtering Control Module</a>
          </h4>
<div id="tree">
<section id="section-3.2.2.1">
            <h5 id="name-tree-structure">
<a class="section-number selfRef" href="#section-3.2.2.1">3.2.2.1. </a><a class="section-name selfRef" href="#name-tree-structure">Tree Structure</a>
            </h5>
<p id="section-3.2.2.1-1">This document augments the "ietf-dots-signal-channel" YANG
            module defined in <span>[<a class="xref" href="#RFC9132">RFC9132</a>]</span> for managing
            filtering rules.<a class="pilcrow" href="#section-3.2.2.1-1">¶</a></p>
<p id="section-3.2.2.1-2">This document defines the YANG module
            "ietf-dots-signal-control", which has the following tree
            structure:<a class="pilcrow" href="#section-3.2.2.1-2">¶</a></p>
<div id="section-3.2.2.1-3">
<pre class="sourcecode lang-yangtree">module: ietf-dots-signal-control
 augment-structure /dots-signal:dots-signal/dots-signal:message-type
                   /dots-signal:mitigation-scope/dots-signal:scope:
   +-- acl-list* [acl-name]
      +-- acl-name
      |       -&gt; /data-channel:dots-data/dots-client/acls/acl/name
      +-- activation-type?   data-channel:activation-type
</pre><a class="pilcrow" href="#section-3.2.2.1-3">¶</a>
</div>
</section>
</div>
<section id="section-3.2.2.2">
            <h5 id="name-yang-module">
<a class="section-number selfRef" href="#section-3.2.2.2">3.2.2.2. </a><a class="section-name selfRef" href="#name-yang-module">YANG Module</a>
            </h5>
<p id="section-3.2.2.2-1">This YANG module is not intended to be used via
            NETCONF/RESTCONF for DOTS server management purposes; such a module
            is out of the scope of this document. It serves only to provide a
            data model and encoding, but not a management data model.<a class="pilcrow" href="#section-3.2.2.2-1">¶</a></p>
<p id="section-3.2.2.2-2">This module uses types defined in <span>[<a class="xref" href="#RFC8783">RFC8783</a>]</span>.<a class="pilcrow" href="#section-3.2.2.2-2">¶</a></p>
<div id="section-3.2.2.2-3">
<pre class="sourcecode lang-yang">&lt;CODE BEGINS&gt; file "ietf-dots-signal-control@2021-09-02.yang"

module ietf-dots-signal-control {
  yang-version 1.1;
  namespace "urn:ietf:params:xml:ns:yang:ietf-dots-signal-control";
  prefix dots-control;

  import ietf-dots-signal-channel {
    prefix dots-signal;
    reference
      "RFC 9132: Distributed Denial-of-Service Open Threat
                 Signaling (DOTS) Signal Channel Specification";
  }


  import ietf-yang-structure-ext {
    prefix sx;
    reference
      "RFC 8791: YANG Data Structure Extensions";
  }

  import ietf-dots-data-channel {
    prefix data-channel;
    reference
      "RFC 8783: Distributed Denial-of-Service Open Threat
                 Signaling (DOTS) Data Channel Specification";
  }

  organization
    "IETF DDoS Open Threat Signaling (DOTS) Working Group";
  contact
    "WG Web:   &lt;https://datatracker.ietf.org/wg/dots/&gt;
     WG List:  &lt;mailto:dots@ietf.org&gt;

     Author:  Kaname Nishizuka
              &lt;mailto:kaname@nttv6.jp&gt;

     Author:  Mohamed Boucadair
              &lt;mailto:mohamed.boucadair@orange.com&gt;

     Author:  Tirumaleswar Reddy.K
              &lt;mailto:kondtir@gmail.com&gt;

     Author:  Takahiko Nagata
              &lt;mailto:nagata@lepidum.co.jp&gt;";

  description
    "This module contains YANG definition for the signaling
     messages exchanged between a DOTS client and a DOTS server
     to control, by means of the DOTS signal channel, filtering
     rules configured using the DOTS data channel.

     Copyright (c) 2021 IETF Trust and the persons identified as
     authors of the code.  All rights reserved.

     Redistribution and use in source and binary forms, with or
     without modification, is permitted pursuant to, and subject
     to the license terms contained in, the Simplified BSD License
     set forth in Section 4.c of the IETF Trust's Legal Provisions
     Relating to IETF Documents
     (https://trustee.ietf.org/license-info).

     This version of this YANG module is part of RFC 9133; see
     the RFC itself for full legal notices.";

  revision 2021-09-02 {
    description
      "Initial revision.";
    reference
      "RFC 9133: Controlling Filtering Rules Using Distributed
                 Denial-of-Service Open Threat Signaling (DOTS)
                 Signal Channel";
  }

  sx:augment-structure "/dots-signal:dots-signal"
                     + "/dots-signal:message-type"
                     + "/dots-signal:mitigation-scope"
                     + "/dots-signal:scope" {

    description
      "ACL name and activation type.";

    list acl-list {
      key "acl-name";
      description
        "List of ACLs as defined using the DOTS data
         channel. ACLs bound to a DOTS client are uniquely
         identified by a name.";
      leaf acl-name {
        type leafref {
          path "/data-channel:dots-data/data-channel:dots-client"
             + "/data-channel:acls/data-channel:acl"
             + "/data-channel:name";
        }
        description
          "Reference to the ACL name bound to a DOTS client.";
      }
      leaf activation-type {
        type data-channel:activation-type;
        default "activate-when-mitigating";
        description
          "Sets the activation type of an ACL.";
      }
    }
  }
}

&lt;CODE ENDS&gt;</pre><a class="pilcrow" href="#section-3.2.2.2-3">¶</a>
</div>
</section>
</section>
</div>
</section>
</section>
<div id="sample">
<section id="section-4">
      <h2 id="name-some-examples">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-some-examples">Some Examples</a>
      </h2>
<p id="section-4-1">This section provides some examples to illustrate the behavior
      specified in <a class="xref" href="#filtering">Section 3.2.1</a>. These examples are
      provided for illustration purposes; they should not be considered as
      deployment recommendations.<a class="pilcrow" href="#section-4-1">¶</a></p>
<div id="sample1">
<section id="section-4.1">
        <h3 id="name-conflict-handling">
<a class="section-number selfRef" href="#section-4.1">4.1. </a><a class="section-name selfRef" href="#name-conflict-handling">Conflict Handling</a>
        </h3>
<p id="section-4.1-1">Let's consider a DOTS client that contacts its DOTS server during
        'idle' time to install an accept-list allowing for UDP traffic issued
        from 2001:db8:1234::/48 with a destination port number 443 to be
        forwarded to 2001:db8:6401::2/127. It does so by sending, for example,
        a PUT request as shown in <a class="xref" href="#PUT">Figure 2</a>.<a class="pilcrow" href="#section-4.1-1">¶</a></p>
<span id="name-dots-data-channel-request-t"></span><div id="PUT">
<figure id="figure-2">
          <div id="section-4.1-2.1">
<pre class="sourcecode">PUT /restconf/data/ietf-dots-data-channel:dots-data\
    /dots-client=paL8p4Zqo4SLv64TLPXrxA/acls\
    /acl=an-accept-list HTTP/1.1
Host: example.com
Content-Type: application/yang-data+json

{
  "ietf-dots-data-channel:acls": {
    "acl": [
      {
        "name": "an-accept-list",
        "type": "ipv6-acl-type",
        "activation-type": "activate-when-mitigating",
        "aces": {
          "ace": [
            {
              "name": "test-ace-ipv6-udp",
              "matches": {
                "ipv6": {
                  "destination-ipv6-network": "2001:db8:6401::2/127",
                  "source-ipv6-network": "2001:db8:1234::/48"
                },
                "udp": {
                  "destination-port-range-or-operator": {
                    "operator": "eq",
                    "port": 443
                  }
                }
              },
              "actions": {
                "forwarding": "accept"
              }
            }
          ]
        }
      }
    ]
  }
}
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-2">Figure 2</a>:
<a class="selfRef" href="#name-dots-data-channel-request-t">DOTS Data Channel Request to Create a Filter</a>
          </figcaption></figure>
</div>
<p id="section-4.1-3">Sometime later, consider that a DDoS attack is detected by the DOTS
        client on 2001:db8:6401::2/127. Consequently, the DOTS client sends a
        mitigation request to its DOTS server as shown in <a class="xref" href="#mitigate">Figure 3</a>.<a class="pilcrow" href="#section-4.1-3">¶</a></p>
<span id="name-dots-signal-channel-mitigat"></span><div id="mitigate">
<figure id="figure-3">
          <div id="section-4.1-4.1">
<pre class="sourcecode">Header: PUT (Code=0.03)
Uri-Path: ".well-known"
Uri-Path: "dots"
Uri-Path: "mitigate"
Uri-Path: "cuid=paL8p4Zqo4SLv64TLPXrxA"
Uri-Path: "mid=123"
Content-Format: "application/dots+cbor"

{
  "ietf-dots-signal-channel:mitigation-scope": {
    "scope": [
      {
        "target-prefix": [
          "2001:db8:6401::2/127"
        ],
        "target-protocol": [
          17
        ],
        "lifetime": 3600
      }
    ]
  }
}
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-3">Figure 3</a>:
<a class="selfRef" href="#name-dots-signal-channel-mitigat">DOTS Signal Channel Mitigation Request</a>
          </figcaption></figure>
</div>
<p id="section-4.1-5">The DOTS server immediately accepts the request by replying with
        2.01 (Created) (<a class="xref" href="#response">Figure 4</a> depicts the message
        body of the response).<a class="pilcrow" href="#section-4.1-5">¶</a></p>
<span id="name-status-response-message-bod"></span><div id="response">
<figure id="figure-4">
          <div id="section-4.1-6.1">
<pre class="sourcecode">{
  "ietf-dots-signal-channel:mitigation-scope": {
    "scope": [
      {
        "mid": 123,
        "lifetime": 3600
      }
    ]
  }
}
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-4">Figure 4</a>:
<a class="selfRef" href="#name-status-response-message-bod">Status Response (Message Body)</a>
          </figcaption></figure>
</div>
<p id="section-4.1-7">Assuming the DOTS client subscribed to asynchronous notifications,
        when the DOTS server concludes that some of the attack sources belong
        to 2001:db8:1234::/48, it sends a notification message with 'status'
        code set to 1 (attack-mitigation-in-progress) and 'conflict-cause' set
        to 2 (conflict-with-acceptlist) to the DOTS client to indicate that
        this mitigation request is in progress, but a conflict is
        detected.<a class="pilcrow" href="#section-4.1-7">¶</a></p>
<p id="section-4.1-8">Upon receipt of the notification message from the DOTS server, the
        DOTS client sends a PUT request to deactivate the "an-accept-list" ACL
        as shown in <a class="xref" href="#control">Figure 5</a>.<a class="pilcrow" href="#section-4.1-8">¶</a></p>
<p id="section-4.1-9">The DOTS client can also decide to send a PUT request to deactivate
        the "an-accept-list" ACL if suspect traffic is received from an
        accept-listed source (2001:db8:1234::/48). The structure of that PUT
        is the same as the one shown in <a class="xref" href="#control">Figure 5</a>.<a class="pilcrow" href="#section-4.1-9">¶</a></p>
<span id="name-put-for-deactivating-a-conf"></span><div id="control">
<figure id="figure-5">
          <div id="section-4.1-10.1">
<pre class="sourcecode">Header: PUT (Code=0.03)
Uri-Path: ".well-known"
Uri-Path: "dots"
Uri-Path: "mitigate"
Uri-Path: "cuid=paL8p4Zqo4SLv64TLPXrxA"
Uri-Path: "mid=124"
Content-Format: "application/dots+cbor"

{
  "ietf-dots-signal-channel:mitigation-scope": {
    "scope": [
      {
        "target-prefix": [
          "2001:db8:6401::2/127"
        ],
        "target-protocol": [
          17
        ],
        "ietf-dots-signal-control:acl-list": [
          {
            "acl-name": "an-accept-list",
            "activation-type": "deactivate"
          }
        ],
        "lifetime": 3600
      }
    ]
  }
}
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-5">Figure 5</a>:
<a class="selfRef" href="#name-put-for-deactivating-a-conf">PUT for Deactivating a Conflicting Filter</a>
          </figcaption></figure>
</div>
<p id="section-4.1-11">Then, the DOTS server deactivates the "an-accept-list" ACL and replies
        with a 2.04 (Changed) response to the DOTS client to confirm the
        successful operation. The message body is similar to the one depicted
        in <a class="xref" href="#response">Figure 4</a>.<a class="pilcrow" href="#section-4.1-11">¶</a></p>
<p id="section-4.1-12">Once the attack is mitigated, the DOTS client may use the data
        channel to retrieve its ACLs maintained by the DOTS server. As shown
        in <a class="xref" href="#GET-2">Figure 6</a>, the activation type is set to
        'deactivate' as set by the DOTS signal channel (<a class="xref" href="#control">Figure 5</a>) instead of the type initially set using the
        DOTS data channel (<a class="xref" href="#PUT">Figure 2</a>).<a class="pilcrow" href="#section-4.1-12">¶</a></p>
<span id="name-dots-data-channel-get-respo"></span><div id="GET-2">
<figure id="figure-6">
          <div id="section-4.1-13.1">
<pre class="sourcecode">{
  "ietf-dots-data-channel:acls": {
    "acl": [
      {
        "name": "an-accept-list",
        "type": "ipv6-acl-type",
        "activation-type": "deactivate",
        "pending-lifetime": 10021,
        "aces": {
          "ace": [
            {
              "name": "test-ace-ipv6-udp",
              "matches": {
                "ipv6": {
                  "destination-ipv6-network": "2001:db8:6401::2/127",
                  "source-ipv6-network": "2001:db8:1234::/48"
                },
                "udp": {
                  "destination-port-range-or-operator": {
                    "operator": "eq",
                    "port": 443
                  }
                }
              },
              "actions": {
                "forwarding": "accept"
              }
            }
          ]
        }
      }
    ]
  }
}
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-6">Figure 6</a>:
<a class="selfRef" href="#name-dots-data-channel-get-respo">DOTS Data Channel GET Response after Mitigation (Message Body)</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="sample2">
<section id="section-4.2">
        <h3 id="name-on-demand-activation-of-an-">
<a class="section-number selfRef" href="#section-4.2">4.2. </a><a class="section-name selfRef" href="#name-on-demand-activation-of-an-">On-Demand Activation of an Accept-List Filter</a>
        </h3>
<p id="section-4.2-1">Let's consider a DOTS client that contacts its DOTS server during
        'idle' time to install an accept-list allowing for UDP traffic issued
        from 2001:db8:1234::/48 to be forwarded to 2001:db8:6401::2/127. It
        does so by sending, for example, a PUT request shown in <a class="xref" href="#PUT1">Figure 7</a>. The DOTS server installs this filter
        with a "deactivated" state.<a class="pilcrow" href="#section-4.2-1">¶</a></p>
<span id="name-dots-data-channel-request-to"></span><div id="PUT1">
<figure id="figure-7">
          <div id="section-4.2-2.1">
<pre class="sourcecode">PUT /restconf/data/ietf-dots-data-channel:dots-data\
    /dots-client=ioiuLoZqo4SLv64TLPXrxA/acls\
    /acl=my-accept-list HTTP/1.1
Host: example.com
Content-Type: application/yang-data+json

{
  "ietf-dots-data-channel:acls": {
    "acl": [
      {
        "name": "my-accept-list",
        "type": "ipv6-acl-type",
        "activation-type": "deactivate",
        "aces": {
          "ace": [
            {
              "name": "an-ace",
              "matches": {
                "ipv6": {
                  "destination-ipv6-network": "2001:db8:6401::2/127",
                  "source-ipv6-network": "2001:db8:1234::/48",
                  "protocol": 17
                }
              },
              "actions": {
                "forwarding": "accept"
              }
            }
          ]
        }
      }
    ]
  }
}
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-7">Figure 7</a>:
<a class="selfRef" href="#name-dots-data-channel-request-to">DOTS Data Channel Request to Create an Accept-List Filter</a>
          </figcaption></figure>
</div>
<p id="section-4.2-3">Sometime later, consider that a UDP DDoS attack is detected by the
        DOTS client on 2001:db8:6401::2/127 but the DOTS client wants to let
        the traffic from 2001:db8:1234::/48 be accept-listed to the DOTS
        client domain. Consequently, the DOTS client sends a mitigation
        request to its DOTS server as shown in <a class="xref" href="#mitigate1">Figure 8</a>.<a class="pilcrow" href="#section-4.2-3">¶</a></p>
<span id="name-dots-signal-channel-mitigati"></span><div id="mitigate1">
<figure id="figure-8">
          <div id="section-4.2-4.1">
<pre class="sourcecode">Header: PUT (Code=0.03)
Uri-Path: ".well-known"
Uri-Path: "dots"
Uri-Path: "mitigate"
Uri-Path: "cuid=ioiuLoZqo4SLv64TLPXrxA"
Uri-Path: "mid=4879"
Content-Format: "application/dots+cbor"

{
  "ietf-dots-signal-channel:mitigation-scope": {
    "scope": [
      {
        "target-prefix": [
          "2001:db8:6401::2/127"
        ],
        "target-protocol": [
          17
        ],
        "ietf-dots-signal-control:acl-list": [
          {
            "acl-name": "my-accept-list",
            "activation-type": "immediate"
          }
        ],
        "lifetime": 3600
      }
    ]
  }
}
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-8">Figure 8</a>:
<a class="selfRef" href="#name-dots-signal-channel-mitigati">DOTS Signal Channel Mitigation Request with a Filter Control</a>
          </figcaption></figure>
</div>
<p id="section-4.2-5">The DOTS server activates the "my-accept-list" ACL and replies with
        a 2.01 (Created) response to the DOTS client to confirm the successful
        operation.<a class="pilcrow" href="#section-4.2-5">¶</a></p>
</section>
</div>
<div id="sample3">
<section id="section-4.3">
        <h3 id="name-dots-servers-mitigators-lac">
<a class="section-number selfRef" href="#section-4.3">4.3. </a><a class="section-name selfRef" href="#name-dots-servers-mitigators-lac">DOTS Servers/Mitigators Lacking Capacity</a>
        </h3>
<p id="section-4.3-1">This section describes a scenario in which a DOTS client activates
        a drop-list or a rate-limit filter during an attack.<a class="pilcrow" href="#section-4.3-1">¶</a></p>
<p id="section-4.3-2">Consider a DOTS client that contacts its DOTS server during 'idle'
        time to install an accept-list that rate-limits all (or a part
        thereof) traffic to be forwarded to 2001:db8:123::/48 as a last resort
        countermeasure whenever required. Installing the accept-list can be
        done by sending, for example, the PUT request shown in <a class="xref" href="#rate">Figure 9</a>. The DOTS server installs this filter
        with a "deactivated" state.<a class="pilcrow" href="#section-4.3-2">¶</a></p>
<span id="name-dots-data-channel-request-to-"></span><div id="rate">
<figure id="figure-9">
          <div id="section-4.3-3.1">
<pre class="sourcecode">PUT /restconf/data/ietf-dots-data-channel:dots-data\
    /dots-client=OopPisZqo4SLv64TLPXrxA/acls\
    /acl=my-ratelimit-list HTTP/1.1
Host: example.com
Content-Type: application/yang-data+json

{
  "ietf-dots-data-channel:acls": {
    "acl": [
      {
        "name": "my-ratelimit-list",
        "type": "ipv6-acl-type",
        "activation-type": "deactivate",
        "aces": {
          "ace": [
            {
              "name": "my-ace",
              "matches": {
                "ipv6": {
                  "destination-ipv6-network": "2001:db8:123::/48"
                }
              },
              "actions": {
                "forwarding": "accept",
                "rate-limit": "20000.00"
              }
            }
          ]
        }
      }
    ]
  }
}
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-9">Figure 9</a>:
<a class="selfRef" href="#name-dots-data-channel-request-to-">DOTS Data Channel Request to Create a Rate-Limit Filter</a>
          </figcaption></figure>
</div>
<p id="section-4.3-4">Consider now that a DDoS attack is detected by the DOTS client on
        2001:db8:123::/48. Consequently, the DOTS client sends a mitigation
        request to its DOTS server (<a class="xref" href="#ratel">Figure 10</a>).<a class="pilcrow" href="#section-4.3-4">¶</a></p>
<span id="name-dots-signal-channel-mitigatio"></span><div id="ratel">
<figure id="figure-10">
          <div id="section-4.3-5.1">
<pre class="sourcecode">Header: PUT (Code=0.03)
Uri-Path: ".well-known"
Uri-Path: "dots"
Uri-Path: "mitigate"
Uri-Path: "cuid=OopPisZqo4SLv64TLPXrxA"
Uri-Path: "mid=85"
Content-Format: "application/dots+cbor"

{
  "ietf-dots-signal-channel:mitigation-scope": {
    "scope": [
      {
        "target-prefix": [
          "2001:db8:123::/48"
        ],
        "lifetime": 3600
      }
    ]
  }
}
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-10">Figure 10</a>:
<a class="selfRef" href="#name-dots-signal-channel-mitigatio">DOTS Signal Channel Mitigation Request</a>
          </figcaption></figure>
</div>
<p id="section-4.3-6">For some reason (e.g., the DOTS server, or the mitigator, is
        lacking a capability or capacity), the DOTS client is still receiving
        attack traffic, which saturates available links. To soften the
        problem, the DOTS client decides to activate the filter that
        rate-limits the traffic destined to the DOTS client domain. To that
        aim, the DOTS client sends the mitigation request to its DOTS server
        shown in <a class="xref" href="#rateres">Figure 11</a>.<a class="pilcrow" href="#section-4.3-6">¶</a></p>
<span id="name-dots-signal-channel-mitigation"></span><div id="rateres">
<figure id="figure-11">
          <div id="section-4.3-7.1">
<pre class="sourcecode">Header: PUT (Code=0.03)
Uri-Path: ".well-known"
Uri-Path: "dots"
Uri-Path: "mitigate"
Uri-Path: "cuid=OopPisZqo4SLv64TLPXrxA"
Uri-Path: "mid=86"
Content-Format: "application/dots+cbor"

{
  "ietf-dots-signal-channel:mitigation-scope": {
    "scope": [
      {
        "target-prefix": [
          "2001:db8:123::/48"
        ],
        "ietf-dots-signal-control:acl-list": [
          {
            "acl-name": "my-ratelimit-list",
            "activation-type": "immediate"
          }
        ],
        "lifetime": 3600
      }
    ]
  }
}
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-11">Figure 11</a>:
<a class="selfRef" href="#name-dots-signal-channel-mitigation">DOTS Signal Channel Mitigation Request to Activate a Rate-Limit Filter</a>
          </figcaption></figure>
</div>
<p id="section-4.3-8">Then, the DOTS server activates the "my-ratelimit-list" ACL and replies
        with a 2.04 (Changed) response to the DOTS client to confirm the
        successful operation.<a class="pilcrow" href="#section-4.3-8">¶</a></p>
<p id="section-4.3-9">As the attack mitigation evolves, the DOTS client may decide to
        deactivate the rate-limit policy (e.g., upon receipt of a notification
        status change from 'attack-exceeded-capability' to
        'attack-mitigation-in-progress'). Based on the mitigation status
        conveyed by the DOTS server, the DOTS client can deactivate the
        rate-limit action. It does so by sending the request shown in <a class="xref" href="#rateres2">Figure 12</a>.<a class="pilcrow" href="#section-4.3-9">¶</a></p>
<span id="name-dots-signal-channel-mitigation-"></span><div id="rateres2">
<figure id="figure-12">
          <div id="section-4.3-10.1">
<pre class="sourcecode lang-cbor">Header: PUT (Code=0.03)
Uri-Path: ".well-known"
Uri-Path: "dots"
Uri-Path: "mitigate"
Uri-Path: "cuid=OopPisZqo4SLv64TLPXrxA"
Uri-Path: "mid=87"
Content-Format: "application/dots+cbor"

{
  "ietf-dots-signal-channel:mitigation-scope": {
    "scope": [
      {
        "target-prefix": [
          "2001:db8:123::/48"
        ],
        "ietf-dots-signal-control:acl-list": [
          {
            "acl-name": "my-ratelimit-list",
            "activation-type": "deactivate"
          }
        ],
        "lifetime": 3600
      }
    ]
  }
}
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-12">Figure 12</a>:
<a class="selfRef" href="#name-dots-signal-channel-mitigation-">DOTS Signal Channel Mitigation Request to Deactivate a Rate-Limit Filter</a>
          </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="IANA">
<section id="section-5">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<div id="map">
<section id="section-5.1">
        <h3 id="name-dots-signal-channel-cbor-ke">
<a class="section-number selfRef" href="#section-5.1">5.1. </a><a class="section-name selfRef" href="#name-dots-signal-channel-cbor-ke">DOTS Signal Channel CBOR Key Values Subregistry</a>
        </h3>
<p id="section-5.1-1">Per this specification, IANA has registered the following parameters in the
        "DOTS Signal Channel CBOR Key Values" subregistry within the
 "Distributed Denial-of-Service Open Threat Signaling (DOTS) Signal
 Channel" registry <span>[<a class="xref" href="#Key-Map">Key-Map</a>]</span>.<a class="pilcrow" href="#section-5.1-1">¶</a></p>
<div id="table2">
<table class="center" id="table-2">
          <caption><a class="selfRef" href="#table-2">Table 2</a></caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Parameter Name</th>
              <th class="text-left" colspan="1" rowspan="1">CBOR Key Value</th>
              <th class="text-left" colspan="1" rowspan="1">CBOR Major Type</th>
              <th class="text-left" colspan="1" rowspan="1">Change Controller</th>
              <th class="text-left" colspan="1" rowspan="1">Specification Document(s)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">activation-type</td>
              <td class="text-left" colspan="1" rowspan="1">52</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">IESG</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9133</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">ietf-dots-signal-control:acl-list</td>
              <td class="text-left" colspan="1" rowspan="1">53</td>
              <td class="text-left" colspan="1" rowspan="1">4</td>
              <td class="text-left" colspan="1" rowspan="1">IESG</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9133</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="yang-iana">
<section id="section-5.2">
        <h3 id="name-a-new-yang-module">
<a class="section-number selfRef" href="#section-5.2">5.2. </a><a class="section-name selfRef" href="#name-a-new-yang-module">A New YANG Module</a>
        </h3>
<p id="section-5.2-1">IANA has registered the following URI in the
        "ns" subregistry within the "IETF XML Registry" <span>[<a class="xref" href="#RFC3688">RFC3688</a>]</span>:<a class="pilcrow" href="#section-5.2-1">¶</a></p>
<span class="break"></span><dl class="dlParallel dlCompact" id="section-5.2-2">
          <dt id="section-5.2-2.1">URI:</dt>
          <dd id="section-5.2-2.2" style="margin-left: 1.5em">urn:ietf:params:xml:ns:yang:ietf-dots-signal-control<a class="pilcrow" href="#section-5.2-2.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.2-2.3">Registrant Contact:</dt>
          <dd id="section-5.2-2.4" style="margin-left: 1.5em">The IESG.<a class="pilcrow" href="#section-5.2-2.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.2-2.5">XML:</dt>
          <dd id="section-5.2-2.6" style="margin-left: 1.5em">N/A; the requested URI is an XML namespace.<a class="pilcrow" href="#section-5.2-2.6">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-5.2-3">IANA has registered the following YANG module
        in the "YANG Module Names" subregistry <span>[<a class="xref" href="#RFC6020">RFC6020</a>]</span>
        within the "YANG Parameters" registry.<a class="pilcrow" href="#section-5.2-3">¶</a></p>
<span class="break"></span><dl class="dlParallel dlCompact" id="section-5.2-4">
          <dt id="section-5.2-4.1">Name:</dt>
          <dd id="section-5.2-4.2" style="margin-left: 1.5em">ietf-dots-signal-control<a class="pilcrow" href="#section-5.2-4.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.2-4.3">Namespace:</dt>
          <dd id="section-5.2-4.4" style="margin-left: 1.5em">urn:ietf:params:xml:ns:yang:ietf-dots-signal-control<a class="pilcrow" href="#section-5.2-4.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.2-4.5">Maintained by IANA:</dt>
          <dd id="section-5.2-4.6" style="margin-left: 1.5em">N<a class="pilcrow" href="#section-5.2-4.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.2-4.7">Prefix:</dt>
          <dd id="section-5.2-4.8" style="margin-left: 1.5em">dots-control<a class="pilcrow" href="#section-5.2-4.8">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.2-4.9">Reference:</dt>
          <dd id="section-5.2-4.10" style="margin-left: 1.5em">RFC 9133<a class="pilcrow" href="#section-5.2-4.10">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="security">
<section id="section-6">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<p id="section-6-1">The security considerations for the DOTS signal channel protocol are
      discussed in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9132#section-11">Section 11</a> of [<a class="xref" href="#RFC9132">RFC9132</a>]</span>,
      while those for the DOTS data channel protocol are discussed in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8783#section-10">Section 10</a> of [<a class="xref" href="#RFC8783">RFC8783</a>]</span>. The following
      discusses the security considerations that are specific to the DOTS
      signal channel extension defined in this document.<a class="pilcrow" href="#section-6-1">¶</a></p>
<p id="section-6-2">This specification does not allow the creation of new filtering rules,
      which is the responsibility of the DOTS data channel. DOTS client
      domains should be adequately prepared prior to an attack, e.g., by
      creating filters that will be activated on demand when an attack is
      detected.<a class="pilcrow" href="#section-6-2">¶</a></p>
<p id="section-6-3">A DOTS client is entitled to access only the resources it creates. In
      particular, a DOTS client can not tweak filtering rules created by other
      DOTS clients of the same DOTS client domain. As a reminder, DOTS servers
      must associate filtering rules with the DOTS client that created these
      resources. Failure to ensure such association by a DOTS server will have
      severe impact on DOTS client domains.<a class="pilcrow" href="#section-6-3">¶</a></p>
<p id="section-6-4">A compromised DOTS client can use the filtering control capability to
      exacerbate an ongoing attack. Likewise, such a compromised DOTS client
      may abstain from reacting to an ACL conflict notification received from
      the DOTS server during attacks. These are not new attack vectors, but
      variations of threats discussed in <span>[<a class="xref" href="#RFC9132">RFC9132</a>]</span> and <span>[<a class="xref" href="#RFC8783">RFC8783</a>]</span>. DOTS
      operators should carefully monitor and audit DOTS agents to detect
      misbehaviors and deter misuses.<a class="pilcrow" href="#section-6-4">¶</a></p>
</section>
</div>
<section id="section-7">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-7.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-7.1">7.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time class="refDate" datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3688">[RFC3688]</dt>
        <dd>
<span class="refAuthor">Mealling, M.</span>, <span class="refTitle">"The IETF XML Registry"</span>, <span class="seriesInfo">BCP 81</span>, <span class="seriesInfo">RFC 3688</span>, <span class="seriesInfo">DOI 10.17487/RFC3688</span>, <time class="refDate" datetime="2004-01">January 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3688">https://www.rfc-editor.org/info/rfc3688</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6020">[RFC6020]</dt>
        <dd>
<span class="refAuthor">Bjorklund, M., Ed.</span>, <span class="refTitle">"YANG - A Data Modeling Language for the Network Configuration Protocol (NETCONF)"</span>, <span class="seriesInfo">RFC 6020</span>, <span class="seriesInfo">DOI 10.17487/RFC6020</span>, <time class="refDate" datetime="2010-10">October 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6020">https://www.rfc-editor.org/info/rfc6020</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7950">[RFC7950]</dt>
        <dd>
<span class="refAuthor">Bjorklund, M., Ed.</span>, <span class="refTitle">"The YANG 1.1 Data Modeling Language"</span>, <span class="seriesInfo">RFC 7950</span>, <span class="seriesInfo">DOI 10.17487/RFC7950</span>, <time class="refDate" datetime="2016-08">August 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7950">https://www.rfc-editor.org/info/rfc7950</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time class="refDate" datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8783">[RFC8783]</dt>
        <dd>
<span class="refAuthor">Boucadair, M., Ed.</span> and <span class="refAuthor">T. Reddy.K, Ed.</span>, <span class="refTitle">"Distributed Denial-of-Service Open Threat Signaling (DOTS) Data Channel Specification"</span>, <span class="seriesInfo">RFC 8783</span>, <span class="seriesInfo">DOI 10.17487/RFC8783</span>, <time class="refDate" datetime="2020-05">May 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8783">https://www.rfc-editor.org/info/rfc8783</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8791">[RFC8791]</dt>
        <dd>
<span class="refAuthor">Bierman, A.</span>, <span class="refAuthor">Björklund, M.</span>, and <span class="refAuthor">K. Watsen</span>, <span class="refTitle">"YANG Data Structure Extensions"</span>, <span class="seriesInfo">RFC 8791</span>, <span class="seriesInfo">DOI 10.17487/RFC8791</span>, <time class="refDate" datetime="2020-06">June 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8791">https://www.rfc-editor.org/info/rfc8791</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9132">[RFC9132]</dt>
      <dd>
<span class="refAuthor">Boucadair, M., Ed.</span>, <span class="refAuthor">Shallow, J.</span>, and <span class="refAuthor">T. Reddy.K</span>, <span class="refTitle">"Distributed Denial-of-Service Open Threat Signaling (DOTS) Signal Channel Specification"</span>, <span class="seriesInfo">RFC 9132</span>, <span class="seriesInfo">DOI 10.17487/RFC9132</span>, <time class="refDate" datetime="2021-09">September 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9132">https://www.rfc-editor.org/info/rfc9132</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-7.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-7.2">7.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="INTEROP">[INTEROP]</dt>
        <dd>
<span class="refAuthor">Nishizuka, K.</span>, <span class="refAuthor">Shallow, J.</span>, and <span class="refAuthor">L. Xia</span>, <span class="refTitle">"DOTS Interop test report, IETF 103 Hackathon"</span>, <time class="refDate" datetime="2018-11">November 2018</time>, <span>&lt;<a href="https://datatracker.ietf.org/meeting/103/materials/slides-103-dots-interop-report-from-ietf-103-hackathon-00">https://datatracker.ietf.org/meeting/103/materials/slides-103-dots-interop-report-from-ietf-103-hackathon-00</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Key-Map">[Key-Map]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Distributed Denial-of-Service Open Threat Signaling (DOTS) Signal Channel"</span>, <span>&lt;<a href="https://www.iana.org/assignments/dots">https://www.iana.org/assignments/dots</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7951">[RFC7951]</dt>
        <dd>
<span class="refAuthor">Lhotka, L.</span>, <span class="refTitle">"JSON Encoding of Data Modeled with YANG"</span>, <span class="seriesInfo">RFC 7951</span>, <span class="seriesInfo">DOI 10.17487/RFC7951</span>, <time class="refDate" datetime="2016-08">August 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7951">https://www.rfc-editor.org/info/rfc7951</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8340">[RFC8340]</dt>
        <dd>
<span class="refAuthor">Bjorklund, M.</span> and <span class="refAuthor">L. Berger, Ed.</span>, <span class="refTitle">"YANG Tree Diagrams"</span>, <span class="seriesInfo">BCP 215</span>, <span class="seriesInfo">RFC 8340</span>, <span class="seriesInfo">DOI 10.17487/RFC8340</span>, <time class="refDate" datetime="2018-03">March 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8340">https://www.rfc-editor.org/info/rfc8340</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8612">[RFC8612]</dt>
        <dd>
<span class="refAuthor">Mortensen, A.</span>, <span class="refAuthor">Reddy, T.</span>, and <span class="refAuthor">R. Moskowitz</span>, <span class="refTitle">"DDoS Open Threat Signaling (DOTS) Requirements"</span>, <span class="seriesInfo">RFC 8612</span>, <span class="seriesInfo">DOI 10.17487/RFC8612</span>, <time class="refDate" datetime="2019-05">May 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8612">https://www.rfc-editor.org/info/rfc8612</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8811">[RFC8811]</dt>
      <dd>
<span class="refAuthor">Mortensen, A., Ed.</span>, <span class="refAuthor">Reddy.K, T., Ed.</span>, <span class="refAuthor">Andreasen, F.</span>, <span class="refAuthor">Teague, N.</span>, and <span class="refAuthor">R. Compton</span>, <span class="refTitle">"DDoS Open Threat Signaling (DOTS) Architecture"</span>, <span class="seriesInfo">RFC 8811</span>, <span class="seriesInfo">DOI 10.17487/RFC8811</span>, <time class="refDate" datetime="2020-08">August 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8811">https://www.rfc-editor.org/info/rfc8811</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="ack">
<section id="appendix-A">
      <h2 id="name-acknowledgements">
<a class="section-name selfRef" href="#name-acknowledgements">Acknowledgements</a>
      </h2>
<p id="appendix-A-1">Many thanks to <span class="contact-name">Wei Pan</span>, <span class="contact-name">Xia       Liang</span>, <span class="contact-name">Jon Shallow</span>, <span class="contact-name">Dan       Wing</span>, <span class="contact-name">Christer       Holmberg</span>, <span class="contact-name">Shawn Emery</span>, <span class="contact-name">Tim       Chown</span>, <span class="contact-name">Murray Kucherawy</span>, <span class="contact-name">Roman Danyliw</span>, <span class="contact-name">Erik       Kline</span>, and <span class="contact-name">Éric Vyncke</span> for the comments.<a class="pilcrow" href="#appendix-A-1">¶</a></p>
<p id="appendix-A-2">Thanks to <span class="contact-name">Benjamin Kaduk</span> for the AD review.<a class="pilcrow" href="#appendix-A-2">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a class="section-name selfRef" href="#name-authors-addresses">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Kaname Nishizuka</span></div>
<div class="left" dir="auto"><span class="org">NTT Communications</span></div>
<div class="left" dir="auto">
<span class="street-address">GranPark 16F 3-4-1 Shibaura, Minato-ku</span>, <span class="region">Tokyo</span>
</div>
<div class="left" dir="auto"><span class="postal-code">108-8118</span></div>
<div class="left" dir="auto"><span class="country-name">Japan</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:kaname@nttv6.jp">kaname@nttv6.jp</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Mohamed Boucadair</span></div>
<div class="left" dir="auto"><span class="org">Orange</span></div>
<div class="left" dir="auto">
<span class="postal-code">35000</span> <span class="locality">Rennes</span>
</div>
<div class="left" dir="auto"><span class="country-name">France</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:mohamed.boucadair@orange.com">mohamed.boucadair@orange.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Tirumaleswar Reddy.K</span></div>
<div class="left" dir="auto"><span class="org">Akamai</span></div>
<div class="left" dir="auto"><span class="street-address">Embassy Golf Link Business Park</span></div>
<div class="left" dir="auto">
<span class="locality">Bangalore</span> <span class="postal-code">560071</span>
</div>
<div class="left" dir="auto"><span class="region">Karnataka</span></div>
<div class="left" dir="auto"><span class="country-name">India</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:kondtir@gmail.com">kondtir@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Takahiko Nagata</span></div>
<div class="left" dir="auto"><span class="org">Lepidum</span></div>
<div class="left" dir="auto"><span class="country-name">Japan</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:nagata@lepidum.co.jp">nagata@lepidum.co.jp</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>