<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 9593: Announcing Supported Authentication Methods in the Internet Key Exchange Protocol Version 2 (IKEv2)</title>
<meta content="Valery Smyslov" name="author"/>
<meta content="
        This specification defines a mechanism that allows implementations
      of the Internet Key Exchange Protocol Version 2 (IKEv2) to indicate the list of
      supported authentication methods to their peers while establishing IKEv2
      Security Associations (SAs).  This mechanism improves
   interoperability when IKEv2 partners are configured with multiple
   credentials of different types for authenticating each other.
       
    " name="description"/>
<meta content="xml2rfc 3.22.0" name="generator"/>
<meta content="signature" name="keyword"/>
<meta content="digital signature" name="keyword"/>
<meta content="credentials" name="keyword"/>
<meta content="intermediate exchange" name="keyword"/>
<meta content="9593" name="rfc.number"/>
<!-- Generator version information:
  xml2rfc 3.22.0
    Python 3.9.15
    ConfigArgParse 1.5.3
    google-i18n-address 3.0.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.0
    platformdirs 3.8.0
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.28.0
    setuptools 44.1.1
    wcwidth 0.2.5
    weasyprint 62.3
-->
<link href="rfc9593.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
  overflow-wrap: break-word;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
blockquote > *:last-child {
  margin-bottom: 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}
.xref {
  overflow-wrap: normal;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.refSubseries {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: upper-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://datatracker.ietf.org/doc/draft-ietf-ipsecme-ikev2-auth-announce-10" rel="prev"/>
  <link href="https://dx.doi.org/10.17487/rfc9593" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  </head>
<body class="xml2rfc">
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9593</td>
<td class="center">Announcing Supported Auth Methods</td>
<td class="right">July 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Smyslov</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc9593">9593</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2024-07">July 2024</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">V. Smyslov</div>
<div class="org">ELVIS-PLUS</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9593</h1>
<h1 id="title">Announcing Supported Authentication Methods in the Internet Key Exchange Protocol Version 2 (IKEv2)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1"> This specification defines a mechanism that allows implementations
      of the Internet Key Exchange Protocol Version 2 (IKEv2) to indicate the list of
      supported authentication methods to their peers while establishing IKEv2
      Security Associations (SAs).  This mechanism improves
   interoperability when IKEv2 partners are configured with multiple
   credentials of different types for authenticating each other.<a class="pilcrow" href="#section-abstract-1">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a class="pilcrow" href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9593">https://www.rfc-editor.org/info/rfc9593</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">▲</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p class="keepWithNext" id="section-toc.1-1.1.1"><a class="auto internal xref" href="#section-1">1</a>.  <a class="internal xref" href="#name-introduction">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p class="keepWithNext" id="section-toc.1-1.2.1"><a class="auto internal xref" href="#section-2">2</a>.  <a class="internal xref" href="#name-terminology-and-notation">Terminology and Notation</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a class="auto internal xref" href="#section-3">3</a>.  <a class="internal xref" href="#name-protocol-details">Protocol Details</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p class="keepWithNext" id="section-toc.1-1.3.2.1.1"><a class="auto internal xref" href="#section-3.1">3.1</a>.  <a class="internal xref" href="#name-exchanges">Exchanges</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a class="auto internal xref" href="#section-3.2">3.2</a>.  <a class="internal xref" href="#name-supported_auth_methods-noti">SUPPORTED_AUTH_METHODS Notify Message Type</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a class="auto internal xref" href="#section-3.2.1">3.2.1</a>.  <a class="internal xref" href="#name-2-octet-announcement">2-Octet Announcement</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.2">
                    <p id="section-toc.1-1.3.2.2.2.2.1"><a class="auto internal xref" href="#section-3.2.2">3.2.2</a>.  <a class="internal xref" href="#name-3-octet-announcement">3-Octet Announcement</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.3">
                    <p id="section-toc.1-1.3.2.2.2.3.1"><a class="auto internal xref" href="#section-3.2.3">3.2.3</a>.  <a class="internal xref" href="#name-multi-octet-announcement">Multi-octet Announcement</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="auto internal xref" href="#section-4">4</a>.  <a class="internal xref" href="#name-interaction-with-ikev2-exte">Interaction with IKEv2 Extensions concerning Authentication</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="auto internal xref" href="#section-5">5</a>.  <a class="internal xref" href="#name-iana-considerations">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="auto internal xref" href="#section-6">6</a>.  <a class="internal xref" href="#name-security-considerations">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="auto internal xref" href="#section-7">7</a>.  <a class="internal xref" href="#name-references">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a class="auto internal xref" href="#section-7.1">7.1</a>.  <a class="internal xref" href="#name-normative-references">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a class="auto internal xref" href="#section-7.2">7.2</a>.  <a class="internal xref" href="#name-informative-references">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="auto internal xref" href="#appendix-A">Appendix A</a>.  <a class="internal xref" href="#name-examples-of-announcing-supp">Examples of Announcing Supported Authentication Methods</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a class="auto internal xref" href="#appendix-A.1">A.1</a>.  <a class="internal xref" href="#name-no-need-to-use-the-ike_inte">No Need to Use the IKE_INTERMEDIATE Exchange</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a class="auto internal xref" href="#appendix-A.2">A.2</a>.  <a class="internal xref" href="#name-with-use-of-the-ike_interme">With Use of the IKE_INTERMEDIATE Exchange</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="auto internal xref" href="#appendix-B"></a><a class="internal xref" href="#name-acknowledgments">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a class="auto internal xref" href="#appendix-C"></a><a class="internal xref" href="#name-authors-address">Author's Address</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="intro">
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1"> The Internet Key Exchange Protocol Version 2 (IKEv2), defined in <span>[<a class="cite xref" href="#RFC7296">RFC7296</a>]</span>, 
            performs authenticated key exchange in IPsec. IKEv2, unlike its predecessor IKEv1, 
            defined in <span>[<a class="cite xref" href="#RFC2409">RFC2409</a>]</span>, doesn't include a mechanism to negotiate an authentication
            method that the peers would use to authenticate each other. It is assumed that each peer selects whichever 
            authentication method it thinks is appropriate, depending on authentication credentials it has.<a class="pilcrow" href="#section-1-1">¶</a></p>
<p id="section-1-2"> This approach generally works well when there is no ambiguity in selecting authentication credentials.
            SA establishment failure between peers may occur when there are several credentials of different types configured on one peer, 
            while only some of them are supported on the other peer. Another problem situation is when a single 
            credential may be used to produce different types of authentication tokens (e.g., signatures of different formats).

   Since IKEv2 requires that each peer use exactly one authentication method,
   and it doesn't provide means for peers to indicate to the other side
   which authentication methods they support, the peer that supports a
   wider range of authentication methods (or authentication token
   formats) could improperly select a method (or format) that is not
   supported by the other side.<a class="pilcrow" href="#section-1-2">¶</a></p>
<p id="section-1-3"> Emerging post-quantum signature algorithms may bring additional challenges for implementations,
            especially if so-called hybrid schemes are used (e.g., see <span>[<a class="cite xref" href="#I-D.ietf-lamps-pq-composite-sigs">COMPOSITE-SIGS</a>]</span>).<a class="pilcrow" href="#section-1-3">¶</a></p>
<p id="section-1-4">
            This specification defines an extension to the IKEv2 protocol that allows peers to 
            announce their supported authentication methods, thus decreasing risks of SA establishment
            failure in situations when there are several ways for the peers to authenticate themselves.<a class="pilcrow" href="#section-1-4">¶</a></p>
</section>
</div>
<div id="mustshouldmay">
<section id="section-2">
      <h2 id="name-terminology-and-notation">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-terminology-and-notation">Terminology and Notation</a>
      </h2>
<p id="section-2-1">
    The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>",
    "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>",
    "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>",
    "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
    "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be
    interpreted as described in BCP 14 <span>[<a class="cite xref" href="#RFC2119">RFC2119</a>]</span> <span>[<a class="cite xref" href="#RFC8174">RFC8174</a>]</span> when, and only when, they appear in all capitals, as
    shown here.<a class="pilcrow" href="#section-2-1">¶</a></p>
</section>
</div>
<div id="protocol">
<section id="section-3">
      <h2 id="name-protocol-details">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-protocol-details">Protocol Details</a>
      </h2>
<p id="section-3-1">When establishing an IKE SA, each party may send to its peer a list of the authentication methods it supports and is configured to use.
            For this purpose, this specification introduces a new Notify Message Type SUPPORTED_AUTH_METHODS.
            The Notify payload with this Notify Message Type is utilized to convey the supported
            authentication methods of the party sending it. The sending party may 
            additionally specify that some of the authentication methods are only for use with 
            the particular trust anchors. The receiving party may take this information into consideration 
            when selecting an algorithm for its authentication (i.e., the algorithm used for calculation of the AUTH payload) 
            if several alternatives are available.
            To simplify the receiver's task of linking the announced authentication methods with the trust anchors,
            the protocol ensures that the SUPPORTED_AUTH_METHODS notification is always co-located
            with the CERTREQ payload in the same message.<a class="pilcrow" href="#section-3-1">¶</a></p>
<div id="exchange">
<section id="section-3.1">
        <h3 id="name-exchanges">
<a class="section-number selfRef" href="#section-3.1">3.1. </a><a class="section-name selfRef" href="#name-exchanges">Exchanges</a>
        </h3>
<p id="section-3.1-1"> The initiator starts the IKE_SA_INIT exchange as usual. If the responder is willing to use this extension, it includes a new notification SUPPORTED_AUTH_METHODS
                in the IKE_SA_INIT response message. This notification contains a list of authentication methods supported by the responder, ordered by their preference.<a class="pilcrow" href="#section-3.1-1">¶</a></p>
<span id="name-the-ike_sa_init-exchange"></span><div id="ikesainit">
<figure id="figure-1">
          <div class="alignLeft art-text artwork" id="section-3.1-2.1">
<pre>Initiator                              Responder
-----------                            -----------
HDR, SAi1, KEi, Ni --&gt;
                                   &lt;-- HDR, SAr1, KEr, Nr, [CERTREQ,]
                                     [N(SUPPORTED_AUTH_METHODS)(...)]
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-1">Figure 1</a>:
<a class="selfRef" href="#name-the-ike_sa_init-exchange">The IKE_SA_INIT Exchange</a>
          </figcaption></figure>
</div>
<p id="section-3.1-3"> If the initiator doesn't support this extension, it ignores the received notification as an unknown status notify.<a class="pilcrow" href="#section-3.1-3">¶</a></p>
<p id="section-3.1-4"> Regardless of whether the notification is received, if the initiator supports and  is willing to use this extension, 
                it includes the SUPPORTED_AUTH_METHODS notification in the IKE_AUTH request message, 
                with a list of authentication methods supported by the initiator, ordered by their preference.<a class="pilcrow" href="#section-3.1-4">¶</a></p>
<span id="name-the-ike_auth-exchange"></span><div id="ikeauth">
<figure id="figure-2">
          <div class="alignLeft art-text artwork" id="section-3.1-5.1">
<pre>Initiator                              Responder
-----------                            -----------
HDR, SK {IDi, [CERT,] [CERTREQ,]
[IDr,] AUTH, SAi2, TSi, TSr,
[N(SUPPORTED_AUTH_METHODS)(...)] }  --&gt;
                                   &lt;-- HDR, SK {IDr, [CERT,]
                                            AUTH, SAr2, TSi, TSr }
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-2">Figure 2</a>:
<a class="selfRef" href="#name-the-ike_auth-exchange">The IKE_AUTH Exchange</a>
          </figcaption></figure>
</div>
<p id="section-3.1-6">
  Because the responder sends the SUPPORTED_AUTH_METHODS notification in
  the IKE_SA_INIT exchange, it must take into account that the 
  response message could grow so much that the IP fragmentation might take place.<a class="pilcrow" href="#section-3.1-6">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-7.1">
            <p id="section-3.1-7.1.1">the SUPPORTED_AUTH_METHODS notification to be included is so large, that the responder suspects
                    that IP fragmentation of the resulting IKE_SA_INIT response message may happen;<a class="pilcrow" href="#section-3.1-7.1.1">¶</a></p>
</li>
          <li class="normal" id="section-3.1-7.2">
            <p id="section-3.1-7.2.1">both peers support the IKE_INTERMEDIATE exchange, defined in <span>[<a class="cite xref" href="#RFC9242">RFC9242</a>]</span> (i.e.,
                    the responder has received and is going to send the INTERMEDIATE_EXCHANGE_SUPPORTED notification);<a class="pilcrow" href="#section-3.1-7.2.1">¶</a></p>
</li>
        </ul>
<p id="section-3.1-8">

                then the responder <span class="bcp14">MAY</span> choose not to send an actual list of the supported authentication
                methods in the IKE_SA_INIT exchange and instead ask the initiator to start the IKE_INTERMEDIATE
                exchange for the list to be sent in. This would allow using IKE fragmentation <span>[<a class="cite xref" href="#RFC7383">RFC7383</a>]</span> for long messages 
                (which cannot be used in the IKE_SA_INIT exchange), thus avoiding IP fragmentation. 
                In this case, the responder includes a SUPPORTED_AUTH_METHODS notification containing no data in the IKE_SA_INIT response.<a class="pilcrow" href="#section-3.1-8">¶</a></p>
<p id="section-3.1-9"> If the initiator receives the empty SUPPORTED_AUTH_METHODS notification in the IKE_SA_INIT exchange,
                it means that the responder is going to send the list of the supported authentication methods in the 
                IKE_INTERMEDIATE exchange. If this exchange is to be initiated anyway for some other reason, then 
                the responder <span class="bcp14">MAY</span> use it to send the SUPPORTED_AUTH_METHODS notification. Otherwise, the initiator 
                <span class="bcp14">MAY</span> start the IKE_INTERMEDIATE exchange for this sole purpose by sending an empty IKE_INTERMEDIATE request.
                The initiator <span class="bcp14">MAY</span> also indicate its identity (and possibly the perceived responder's identity too)
                by including the IDi payload (possibly along with the IDr payload) in the IKE_INTERMEDIATE request. 
                This information could help the responder to send back only those authentication methods 
                that are configured to be used for authentication of this particular initiator. 
                If these payloads are sent, they <span class="bcp14">MUST</span> be identical to the IDi/IDr payloads sent later in the IKE_AUTH request.<a class="pilcrow" href="#section-3.1-9">¶</a></p>
<p id="section-3.1-10">If the responder has sent any CERTREQ payload in the IKE_SA_INIT, then it <span class="bcp14">SHOULD</span> resend the same 
                payload(s) in the IKE_INTERMEDIATE response containing the SUPPORTED_AUTH_METHODS notification
                if any of the included Announcements has a non-zero Cert Link field (see Sections <a class="auto internal xref" href="#ann-3">3.2.2</a> and <a class="auto internal xref" href="#ann-m">3.2.3</a>).
                This requirement allows peers to have a list of Announcements and a list of CAs in the same message,
                which simplifies their linking. Note that this requirement is always fulfilled for the IKE_SA_INIT and IKE_AUTH exchanges.
                However, if for any reason the responder doesn't resend CERTREQ payload(s) in the IKE_INTERMEDIATE exchange, then
                the initiator <span class="bcp14">MUST NOT</span> abort negotiation. Instead, the initiator <span class="bcp14">MAY</span> either link the Announcements to the CAs received in the IKE_SA_INIT response,
                or it <span class="bcp14">MAY</span> ignore the Announcements containing links to CAs.<a class="pilcrow" href="#section-3.1-10">¶</a></p>
<p id="section-3.1-11">If multiple IKE_INTERMEDIATE exchanges take place during IKE SA establishments, it is <span class="bcp14">RECOMMENDED</span> that the responder
                use the last IKE_INTERMEDIATE exchange (the one just before IKE_AUTH) to send the list of supported authentication methods.
                However, it is not always possible for the responder to know how many IKE_INTERMEDIATE exchanges
                the initiator will use. In this case the responder <span class="bcp14">MAY</span> send the list in any IKE_INTERMEDIATE exchange.
                If the initiator sends IDi/IDr in an IKE_INTERMEDIATE request, then it is <span class="bcp14">RECOMMENDED</span> that the responder
                sends back the list of authentication methods in the response.<a class="pilcrow" href="#section-3.1-11">¶</a></p>
<span id="name-using-the-ike_intermediate-"></span><div id="ikeint">
<figure id="figure-3">
          <div class="alignLeft art-text artwork" id="section-3.1-12.1">
<pre>Initiator                              Responder
-----------                            -----------
HDR, SAi1, KEi, Ni --&gt;
                                   &lt;-- HDR, SAr1, KEr, Nr, [CERTREQ,]
                                       [N(SUPPORTED_AUTH_METHODS)()]

HDR, SK {..., [IDi, [IDr,]]}  --&gt;
                                   &lt;-- HDR, SK {..., [CERTREQ,]
                                   [N(SUPPORTED_AUTH_METHODS)(...)] }

HDR, SK {IDi, [CERT,] [CERTREQ,]
[IDr,] AUTH, SAi2, TSi, TSr,
[N(SUPPORTED_AUTH_METHODS)(...)] }  --&gt;
                                   &lt;-- HDR, SK {IDr, [CERT,]
                                            AUTH, SAr2, TSi, TSr }
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-3">Figure 3</a>:
<a class="selfRef" href="#name-using-the-ike_intermediate-">Using the IKE_INTERMEDIATE Exchange for Sending Authentication Methods</a>
          </figcaption></figure>
</div>
<p id="section-3.1-13"> Note that sending the SUPPORTED_AUTH_METHODS notification and using information obtained from it 
                are optional for both the initiator and the responder. If multiple SUPPORTED_AUTH_METHODS notifications are included 
                in a message, all their announcements form a single ordered list, unless overridden by other extension 
                (see <a class="auto internal xref" href="#interaction">Section 4</a>).<a class="pilcrow" href="#section-3.1-13">¶</a></p>
</section>
</div>
<div id="format">
<section id="section-3.2">
        <h3 id="name-supported_auth_methods-noti">
<a class="section-number selfRef" href="#section-3.2">3.2. </a><a class="section-name selfRef" href="#name-supported_auth_methods-noti">SUPPORTED_AUTH_METHODS Notify Message Type</a>
        </h3>
<p id="section-3.2-1"> The format of the SUPPORTED_AUTH_METHODS Notify payload is shown below.<a class="pilcrow" href="#section-3.2-1">¶</a></p>
<span id="name-supported_auth_methods-notif"></span><div id="notify">
<figure id="figure-4">
          <div class="alignLeft art-text artwork" id="section-3.2-2.1">
<pre>                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Next Payload  |C|  RESERVED   |         Payload Length        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Protocol ID  |   SPI Size    |      Notify Message Type      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
~          List of Supported Auth Methods Announcements         ~
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-4">Figure 4</a>:
<a class="selfRef" href="#name-supported_auth_methods-notif">SUPPORTED_AUTH_METHODS Notify Payload Format</a>
          </figcaption></figure>
</div>
<p id="section-3.2-3">

               The Notify payload format is defined in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc7296#section-3.10">Section 3.10</a> of [<a class="cite xref" href="#RFC7296">RFC7296</a>]</span>.
               When a Notify payload of type SUPPORTED_AUTH_METHODS is sent, the
               Protocol ID field is set to 0, the SPI Size is set to 0 (meaning there is no SPI field), 
               and the Notify Message Type is set to 16443.<a class="pilcrow" href="#section-3.2-3">¶</a></p>
<p id="section-3.2-4"> Notification data contains the list of supported authentication methods announcements. 
               Each individual announcement is a variable-size data blob whose format depends
               on the announced authentication method. The blob always starts with an octet containing the length of the blob
               followed by an octet containing the authentication method. Authentication methods are represented
               as values from the "IKEv2 Authentication Method" registry defined in <span>[<a class="cite xref" href="#IKEV2-IANA">IKEV2-IANA</a>]</span>.
               The meaning of the remaining octets of the blob, if any, depends on the authentication method. 
               Note that, for the currently defined authentication methods, the length octet
               fully defines both the format and the semantics of the blob.<a class="pilcrow" href="#section-3.2-4">¶</a></p>
<p id="section-3.2-5"> If more authentication methods are defined in the future, the corresponding documents
               must describe the semantics of the announcements for these methods. Implementations
               <span class="bcp14">MUST</span> ignore announcements whose semantics they don't understand.<a class="pilcrow" href="#section-3.2-5">¶</a></p>
<div id="ann-2">
<section id="section-3.2.1">
          <h4 id="name-2-octet-announcement">
<a class="section-number selfRef" href="#section-3.2.1">3.2.1. </a><a class="section-name selfRef" href="#name-2-octet-announcement">2-Octet Announcement</a>
          </h4>
<p id="section-3.2.1-1"> If the announcement contains an authentication method that is not concerned
                   with public key cryptography, then the following format is used.<a class="pilcrow" href="#section-3.2.1-1">¶</a></p>
<span id="name-2-octet-announcement-format"></span><div id="authmethod1">
<figure id="figure-5">
            <div class="alignLeft art-text artwork" id="section-3.2.1-2.1">
<pre>                     1
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Length (=2)  |  Auth Method  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-5">Figure 5</a>:
<a class="selfRef" href="#name-2-octet-announcement-format">2-Octet Announcement Format</a>
            </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-3.2.1-3">
            <dt id="section-3.2.1-3.1">Length:</dt>
            <dd id="section-3.2.1-3.2" style="margin-left: 1.5em">Length of the blob in octets; must be 2 for this case.<a class="pilcrow" href="#section-3.2.1-3.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.1-3.3">Auth Method:</dt>
            <dd id="section-3.2.1-3.4" style="margin-left: 1.5em">Announced authentication method.<a class="pilcrow" href="#section-3.2.1-3.4">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-3.2.1-4">

                    This format is applicable for the authentication methods "Shared Key Message Integrity Code" (2) and "NULL Authentication" (13).
                    Note that the authentication method "Generic Secure Password Authentication Method" (12) would also
                    fall in this category; however, it is negotiated separately (see <span>[<a class="cite xref" href="#RFC6467">RFC6467</a>]</span>), and
                    for this reason there is no point to announce it via this mechanism. See also <a class="auto internal xref" href="#interaction">Section 4</a>.<a class="pilcrow" href="#section-3.2.1-4">¶</a></p>
</section>
</div>
<div id="ann-3">
<section id="section-3.2.2">
          <h4 id="name-3-octet-announcement">
<a class="section-number selfRef" href="#section-3.2.2">3.2.2. </a><a class="section-name selfRef" href="#name-3-octet-announcement">3-Octet Announcement</a>
          </h4>
<p id="section-3.2.2-1"> If the announcement contains an authentication method that is concerned
                    with public key cryptography, then the following format is used. This format 
                    allows linking the announcement with a particular trust anchor from the 
                    Certificate Request payload.<a class="pilcrow" href="#section-3.2.2-1">¶</a></p>
<span id="name-3-octet-announcement-format"></span><div id="authmethod2">
<figure id="figure-6">
            <div class="alignLeft art-text artwork" id="section-3.2.2-2.1">
<pre>                     1                   2
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Length (=3)  |  Auth Method  |   Cert Link   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-6">Figure 6</a>:
<a class="selfRef" href="#name-3-octet-announcement-format">3-Octet Announcement Format</a>
            </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-3.2.2-3">
            <dt id="section-3.2.2-3.1">Length:</dt>
            <dd id="section-3.2.2-3.2" style="margin-left: 1.5em">Length of the blob in octets; must be 3 for this case.<a class="pilcrow" href="#section-3.2.2-3.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.2-3.3">Auth Method:</dt>
            <dd id="section-3.2.2-3.4" style="margin-left: 1.5em">Announced authentication method.<a class="pilcrow" href="#section-3.2.2-3.4">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.2-3.5">Cert Link:</dt>
            <dd id="section-3.2.2-3.6" style="margin-left: 1.5em">Links this announcement with a particular CA.<a class="pilcrow" href="#section-3.2.2-3.6">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-3.2.2-4">

                    If the Cert Link field contains a non-zero value N, it means that the announced authentication method is intended to be used 
                    only with the N-th trust anchor (CA certificate) from the Certificate Request payload(s) sent by this peer. If it is zero,
                    then this authentication method may be used with any CA.
                    If multiple CERTREQ payloads were sent, the CAs from all of them are treated as a single list for the purpose of the linking.
                    If no Certificate Request payload were received, the content of this field <span class="bcp14">MUST</span> be ignored and treated as zero.<a class="pilcrow" href="#section-3.2.2-4">¶</a></p>
<p id="section-3.2.2-5"> This format is applicable for the authentication methods "RSA Digital Signature" (1),
                    "DSS Digital Signature" (3), "ECDSA with SHA-256 on the P-256 curve" (9), 
                    "ECDSA with SHA-384 on the P-384 curve" (10) and "ECDSA with SHA-512 on the P-521 curve" (11).
                    Note, however, that these authentication methods are currently superseded by 
                    the "Digital Signature" (14) authentication method, which has a different announcement format,
                    described below.<a class="pilcrow" href="#section-3.2.2-5">¶</a></p>
</section>
</div>
<div id="ann-m">
<section id="section-3.2.3">
          <h4 id="name-multi-octet-announcement">
<a class="section-number selfRef" href="#section-3.2.3">3.2.3. </a><a class="section-name selfRef" href="#name-multi-octet-announcement">Multi-octet Announcement</a>
          </h4>
<p id="section-3.2.3-1"> The following format is currently used only with the "Digital Signature" (14) authentication method.<a class="pilcrow" href="#section-3.2.3-1">¶</a></p>
<span id="name-multi-octet-announcement-fo"></span><div id="authmethod3">
<figure id="figure-7">
            <div class="alignLeft art-text artwork" id="section-3.2.3-2.1">
<pre>                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Length (&gt;3)  |  Auth Method  |   Cert Link   |               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+               +
|                                                               |
~                      AlgorithmIdentifier                      ~
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-7">Figure 7</a>:
<a class="selfRef" href="#name-multi-octet-announcement-fo">Multi-octet Announcement Format</a>
            </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-3.2.3-3">
            <dt id="section-3.2.3-3.1">Length:</dt>
            <dd id="section-3.2.3-3.2" style="margin-left: 1.5em">Length of the blob in octets; must be greater than 3 for this case.<a class="pilcrow" href="#section-3.2.3-3.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.3-3.3">Auth Method:</dt>
            <dd id="section-3.2.3-3.4" style="margin-left: 1.5em">Announced authentication method. At the time of writing this document, only value 14 ("Digital Signature") is allowed.<a class="pilcrow" href="#section-3.2.3-3.4">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.3-3.5">Cert Link:</dt>
            <dd id="section-3.2.3-3.6" style="margin-left: 1.5em">Links this announcement with a particular CA; see <a class="auto internal xref" href="#ann-3">Section 3.2.2</a> for details.<a class="pilcrow" href="#section-3.2.3-3.6">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.3-3.7">AlgorithmIdentifier:</dt>
            <dd id="section-3.2.3-3.8" style="margin-left: 1.5em">The variable-length ASN.1 object that is encoded using Distinguished Encoding Rules (DER) <span>[<a class="cite xref" href="#X.690">X.690</a>]</span> and identifies the signature algorithm (see <span><a class="relref" href="https://rfc-editor.org/rfc/rfc5280#section-4.1.1.2">Section 4.1.1.2</a> of [<a class="cite xref" href="#RFC5280">RFC5280</a>]</span>).<a class="pilcrow" href="#section-3.2.3-3.8">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-3.2.3-4">
                    The "Digital Signature" authentication method, defined in <span>[<a class="cite xref" href="#RFC7427">RFC7427</a>]</span>, 
                    supersedes previously defined signature authentication methods. In this case,
                    the real authentication algorithm is identified via AlgorithmIdentifier ASN.1 object.
                    <span><a class="relref" href="https://rfc-editor.org/rfc/rfc7427#appendix-A">Appendix A</a> of [<a class="cite xref" href="#RFC7427">RFC7427</a>]</span> contains examples of commonly used ASN.1 objects.<a class="pilcrow" href="#section-3.2.3-4">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="interaction">
<section id="section-4">
      <h2 id="name-interaction-with-ikev2-exte">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-interaction-with-ikev2-exte">Interaction with IKEv2 Extensions concerning Authentication</a>
      </h2>
<p id="section-4-1"> Generally in IKEv2 each party independently determines the way it authenticates itself to the peer.
          In other words, authentication methods selected by the peers need not be the same.
          However, some IKEv2 extensions break this rule.<a class="pilcrow" href="#section-4-1">¶</a></p>
<p id="section-4-2"> The prominent example is "Secure Password Framework for Internet Key Exchange Version 2" <span>[<a class="cite xref" href="#RFC6467">RFC6467</a>]</span>, 
          which defines a framework for using secure password authentication in IKEv2. 
          With this framework, peers negotiate using one of the secure password methods in the IKE_SA_INIT exchange -- 
          the initiator sends a list of supported methods in the request, and the responder picks one of them and sends it back 
          in the response.<a class="pilcrow" href="#section-4-2">¶</a></p>
<p id="section-4-3"> If peers negotiate secure password authentication, then the selected method is used by both initiator and responder,
          and no other authentication methods are involved. For this reason, there is no point to announce 
          supported authentication methods in this case. Thus, if the peers choose to go with secure password authentication,
          they <span class="bcp14">MUST NOT</span> send the SUPPORTED_AUTH_METHODS notification.<a class="pilcrow" href="#section-4-3">¶</a></p>
<p id="section-4-4">In the situation when peers are going to use Multiple Authentication Exchanges <span>[<a class="cite xref" href="#RFC4739">RFC4739</a>]</span>,
          they <span class="bcp14">MAY</span> include multiple SUPPORTED_AUTH_METHODS notifications (instead of one), each containing authentication methods
          appropriate for each authentication round. The notifications are included in the order 
          of the preference of performing authentication rounds.<a class="pilcrow" href="#section-4-4">¶</a></p>
</section>
</div>
<div id="iana">
<section id="section-5">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<p id="section-5-1">This document defines a new type in the "IKEv2 Notify Message Status Types" registry:<a class="pilcrow" href="#section-5-1">¶</a></p>
<div id="notify_msg_status_type">
<table class="center" id="table-1">
        <caption><a class="selfRef" href="#table-1">Table 1</a></caption>
<thead>
          <tr>
            <th class="text-left" colspan="1" rowspan="1">Value</th>
            <th class="text-left" colspan="1" rowspan="1">Notify Message Status Type</th>
            <th class="text-left" colspan="1" rowspan="1">Reference</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">16443</td>
            <td class="text-left" colspan="1" rowspan="1">SUPPORTED_AUTH_METHODS</td>
            <td class="text-left" colspan="1" rowspan="1">RFC 9593</td>
          </tr>
        </tbody>
      </table>
</div>
</section>
</div>
<div id="sec">
<section id="section-6">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<p id="section-6-1"> Security considerations for the IKEv2 protocol are discussed in <span>[<a class="cite xref" href="#RFC7296">RFC7296</a>]</span>. 
            Security properties of different authentication methods vary.
            Refer to corresponding documents, listed in the "IKEv2 Authentication Method" registry on <span>[<a class="cite xref" href="#IKEV2-IANA">IKEV2-IANA</a>]</span> for discussion 
            of security properties of each authentication method.<a class="pilcrow" href="#section-6-1">¶</a></p>
<p id="section-6-2"> Announcing authentication methods gives an eavesdropper additional information about peers' capabilities. 
            If a peer advertises "NULL Authentication" along with other methods, then an active on-path attacker can encourage peers 
            to use NULL authentication by removing all other announcements. Note that this is not a real "downgrade" attack, 
            since authentication methods in IKEv2 are not negotiated, and in this case NULL authentication should be allowed by local security policy.<a class="pilcrow" href="#section-6-2">¶</a></p>
<p id="section-6-3"> Similarly, if an on-path attacker can break some of the announced authentication methods online, 
            then the attacker can encourage peers to use one of these weaker methods 
            by removing all other announcements, and if this succeeds, then perform a person-in-the-middle attack.<a class="pilcrow" href="#section-6-3">¶</a></p>
</section>
</div>
<section id="section-7">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-7.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-7.1">7.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="IKEV2-IANA">[IKEV2-IANA]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Internet Key Exchange Version 2 (IKEv2) Parameters"</span>, <span>&lt;<a href="https://www.iana.org/assignments/ikev2-parameters/">https://www.iana.org/assignments/ikev2-parameters/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time class="refDate" datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time class="refDate" datetime="2008-05">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5280">https://www.rfc-editor.org/info/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7296">[RFC7296]</dt>
        <dd>
<span class="refAuthor">Kaufman, C.</span>, <span class="refAuthor">Hoffman, P.</span>, <span class="refAuthor">Nir, Y.</span>, <span class="refAuthor">Eronen, P.</span>, and <span class="refAuthor">T. Kivinen</span>, <span class="refTitle">"Internet Key Exchange Protocol Version 2 (IKEv2)"</span>, <span class="seriesInfo">STD 79</span>, <span class="seriesInfo">RFC 7296</span>, <span class="seriesInfo">DOI 10.17487/RFC7296</span>, <time class="refDate" datetime="2014-10">October 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7296">https://www.rfc-editor.org/info/rfc7296</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7427">[RFC7427]</dt>
        <dd>
<span class="refAuthor">Kivinen, T.</span> and <span class="refAuthor">J. Snyder</span>, <span class="refTitle">"Signature Authentication in the Internet Key Exchange Version 2 (IKEv2)"</span>, <span class="seriesInfo">RFC 7427</span>, <span class="seriesInfo">DOI 10.17487/RFC7427</span>, <time class="refDate" datetime="2015-01">January 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7427">https://www.rfc-editor.org/info/rfc7427</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time class="refDate" datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9242">[RFC9242]</dt>
        <dd>
<span class="refAuthor">Smyslov, V.</span>, <span class="refTitle">"Intermediate Exchange in the Internet Key Exchange Protocol Version 2 (IKEv2)"</span>, <span class="seriesInfo">RFC 9242</span>, <span class="seriesInfo">DOI 10.17487/RFC9242</span>, <time class="refDate" datetime="2022-05">May 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9242">https://www.rfc-editor.org/info/rfc9242</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="X.690">[X.690]</dt>
      <dd>
<span class="refAuthor">ITU-T</span>, <span class="refTitle">"Information Technology - ASN.1 encoding rules: Specification of Basic Encoding Rules (BER), Canonical Encoding Rules (CER) and Distinguished Encoding Rules (DER)"</span>, <span class="seriesInfo">ISO/IEC 8825-1:2021 (E)</span>, <span class="seriesInfo">ITU-T Recommendation X.690</span>, <time class="refDate" datetime="2021-02">February 2021</time>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-7.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-7.2">7.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-lamps-pq-composite-sigs">[COMPOSITE-SIGS]</dt>
        <dd>
<span class="refAuthor">Ounsworth, M.</span>, <span class="refAuthor">Gray, J.</span>, <span class="refAuthor">Pala, M.</span>, and <span class="refAuthor">J. Klaussner</span>, <span class="refTitle">"Composite Signatures For Use In Internet PKI"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-lamps-pq-composite-sigs-01</span>, <time class="refDate" datetime="2024-05-24">24 May 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-lamps-pq-composite-sigs-01">https://datatracker.ietf.org/doc/html/draft-ietf-lamps-pq-composite-sigs-01</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2409">[RFC2409]</dt>
        <dd>
<span class="refAuthor">Harkins, D.</span> and <span class="refAuthor">D. Carrel</span>, <span class="refTitle">"The Internet Key Exchange (IKE)"</span>, <span class="seriesInfo">RFC 2409</span>, <span class="seriesInfo">DOI 10.17487/RFC2409</span>, <time class="refDate" datetime="1998-11">November 1998</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2409">https://www.rfc-editor.org/info/rfc2409</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4739">[RFC4739]</dt>
        <dd>
<span class="refAuthor">Eronen, P.</span> and <span class="refAuthor">J. Korhonen</span>, <span class="refTitle">"Multiple Authentication Exchanges in the Internet Key Exchange (IKEv2) Protocol"</span>, <span class="seriesInfo">RFC 4739</span>, <span class="seriesInfo">DOI 10.17487/RFC4739</span>, <time class="refDate" datetime="2006-11">November 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4739">https://www.rfc-editor.org/info/rfc4739</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6467">[RFC6467]</dt>
        <dd>
<span class="refAuthor">Kivinen, T.</span>, <span class="refTitle">"Secure Password Framework for Internet Key Exchange Version 2 (IKEv2)"</span>, <span class="seriesInfo">RFC 6467</span>, <span class="seriesInfo">DOI 10.17487/RFC6467</span>, <time class="refDate" datetime="2011-12">December 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6467">https://www.rfc-editor.org/info/rfc6467</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7383">[RFC7383]</dt>
      <dd>
<span class="refAuthor">Smyslov, V.</span>, <span class="refTitle">"Internet Key Exchange Protocol Version 2 (IKEv2) Message Fragmentation"</span>, <span class="seriesInfo">RFC 7383</span>, <span class="seriesInfo">DOI 10.17487/RFC7383</span>, <time class="refDate" datetime="2014-11">November 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7383">https://www.rfc-editor.org/info/rfc7383</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="examples">
<section id="appendix-A">
      <h2 id="name-examples-of-announcing-supp">
<a class="section-number selfRef" href="#appendix-A">Appendix A. </a><a class="section-name selfRef" href="#name-examples-of-announcing-supp">Examples of Announcing Supported Authentication Methods</a>
      </h2>
<p id="appendix-A-1"> This appendix shows some examples of announcing authentication methods. 
          This appendix is purely informative; if it disagrees with the body of this document, the other text is considered correct.
          Note that some payloads that are not relevant to this specification may be omitted for brevity.<a class="pilcrow" href="#appendix-A-1">¶</a></p>
<div id="no_intermediate_example">
<section id="appendix-A.1">
        <h3 id="name-no-need-to-use-the-ike_inte">
<a class="section-number selfRef" href="#appendix-A.1">A.1. </a><a class="section-name selfRef" href="#name-no-need-to-use-the-ike_inte">No Need to Use the IKE_INTERMEDIATE Exchange</a>
        </h3>
<p id="appendix-A.1-1"> This example illustrates the situation when the SUPPORTED_AUTH_METHODS Notify payload fits into the IKE_SA_INIT 
            message, and thus the IKE_INTERMEDIATE exchange is not needed. In this scenario, the responder 
            announces that it supports the "Shared Key Message Integrity Code" and the "NULL Authentication"
            authentication methods. The initiator informs the responder that it supports 
            only the "Shared Key Message Integrity Code" authentication method.<a class="pilcrow" href="#appendix-A.1-1">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.1-2">
<pre>Initiator                              Responder
-----------                            -----------
                     IKE_SA_INIT
HDR, SAi1, KEi, Ni --&gt;
                                   &lt;-- HDR, SAr1, KEr, Nr,
                                       N(SUPPORTED_AUTH_METHODS(
                                       PSK, NULL))

                      IKE_AUTH
HDR, SK {IDi,
AUTH, SAi2, TSi, TSr,
N(SUPPORTED_AUTH_METHODS(PSK))}  --&gt;
                                   &lt;-- HDR, SK {IDr,
                                       AUTH, SAr2, TSi, TSr}
</pre><a class="pilcrow" href="#appendix-A.1-2">¶</a>
</div>
</section>
</div>
<div id="intermediate_example">
<section id="appendix-A.2">
        <h3 id="name-with-use-of-the-ike_interme">
<a class="section-number selfRef" href="#appendix-A.2">A.2. </a><a class="section-name selfRef" href="#name-with-use-of-the-ike_interme">With Use of the IKE_INTERMEDIATE Exchange</a>
        </h3>
<p id="appendix-A.2-1">This example illustrates the situation when the IKE_INTERMEDIATE
            exchange is used. In this scenario, the responder announces that 
            it supports the "Digital signature" authentication method using the RSASSA-PSS algorithm
            with CA1 and CA2 and the same method using the ECDSA algorithm with CA3.
            The initiator supports only the "Digital signature" authentication method using the RSASSA-PSS algorithm
            with no link to a particular CA.<a class="pilcrow" href="#appendix-A.2-1">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2-2">
<pre>Initiator                              Responder
-----------                            -----------
                     IKE_SA_INIT
HDR, SAi1, KEi, Ni,
N(SIGNATURE_HASH_ALGORITHMS) --&gt;
                                   &lt;-- HDR, SAr1, KEr, Nr,
                                       CERTREQ(CA1, CA2, CA3),
                                       N(SIGNATURE_HASH_ALGORITHMS),
                                       N(SUPPORTED_AUTH_METHODS())

                   IKE_INTERMEDIATE
HDR, SK {..., IDi]}  --&gt;
                                   &lt;-- HDR, SK {...,
                                       CERTREQ(CA1, CA2, CA3),
                                       N(SUPPORTED_AUTH_METHODS(
                                       SIGNATURE(RSASSA-PSS:1),
                                       SIGNATURE(RSASSA-PSS:2),
                                       SIGNATURE(ECDSA:3)))}

                      IKE_AUTH
HDR, SK {IDi, CERT, CERTREQ(CA2),
AUTH, SAi2, TSi, TSr,
N(SUPPORTED_AUTH_METHODS(
SIGNATURE(RSASSA-PSS:0)))}  --&gt;
                                   &lt;-- HDR, SK {IDr, CERT,
                                       AUTH, SAr2, TSi, TSr}
</pre><a class="pilcrow" href="#appendix-A.2-2">¶</a>
</div>
</section>
</div>
</section>
</div>
<section id="appendix-B">
      <h2 id="name-acknowledgments">
<a class="section-name selfRef" href="#name-acknowledgments">Acknowledgments</a>
      </h2>
<p id="appendix-B-1">The author would like to thank <span class="contact-name">Paul Wouters</span> for his valuable comments and proposals.
            The author is also grateful to  <span class="contact-name">Daniel Van Geest</span>, who made proposals for protocol improvement.
             <span class="contact-name">Reese Enghardt</span> and  <span class="contact-name">Rifaat Shekh-Yusef</span> contributed to the clarity of the document.<a class="pilcrow" href="#appendix-B-1">¶</a></p>
</section>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-address">
<a class="section-name selfRef" href="#name-authors-address">Author's Address</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Valery Smyslov</span></div>
<div class="left" dir="auto"><span class="org">ELVIS-PLUS</span></div>
<div class="left" dir="auto"><span class="street-address">PO Box 81</span></div>
<div class="left" dir="auto"><span class="locality">Moscow (Zelenograd)</span></div>
<div class="left" dir="auto"><span class="postal-code">124460</span></div>
<div class="left" dir="auto"><span class="country-name">Russian Federation</span></div>
<div class="tel">
<span>Phone:</span>
<a class="tel" href="tel:+7%20495%20276%200211">+7 495 276 0211</a>
</div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:svan@elvis.ru">svan@elvis.ru</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>