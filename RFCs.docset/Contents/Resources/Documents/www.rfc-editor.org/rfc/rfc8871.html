<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 8871: A Solution Framework for Private Media in Privacy-Enhanced RTP Conferencing (PERC)</title>
<meta content="Paul E. Jones" name="author"/>
<meta content="David Benham" name="author"/>
<meta content="Christian Groves" name="author"/>
<meta content="
       This document describes a solution framework for ensuring that media
confidentiality and integrity are maintained end to end within the
context of a switched conferencing environment where Media
Distributors are not trusted with the end-to-end media
encryption keys.  The solution builds upon existing security
mechanisms defined for the Real-time Transport Protocol (RTP). 
    " name="description"/>
<meta content="xml2rfc 3.5.0" name="generator"/>
<meta content="PERC" name="keyword"/>
<meta content="Private Media Framework" name="keyword"/>
<meta content="conferencing" name="keyword"/>
<meta content="8871" name="rfc.number"/>
<!-- Generator version information:
  xml2rfc 3.5.0
    Python 3.6.10
    appdirs 1.4.4
    ConfigArgParse 1.2.3
    google-i18n-address 2.3.5
    html5lib 1.0.1
    intervaltree 3.0.2
    Jinja2 2.11.2
    kitchen 1.2.6
    lxml 4.4.2
    pycairo 1.19.0
    pycountry 19.8.18
    pyflakes 2.1.1
    PyYAML 5.3.1
    requests 2.22.0
    setuptools 40.6.2
    six 1.14.0
    WeasyPrint 51
-->
<link href="rfc8871.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://dx.doi.org/10.17487/rfc8871" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <link href="https://datatracker.ietf.org/doc/draft-ietf-perc-private-media-framework-12" rel="prev"/>
  </head>
<body>
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 8871</td>
<td class="center">Private Media Framework</td>
<td class="right">January 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Jones, et al.</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc8871">8871</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2021-01">January 2021</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">P. Jones</div>
<div class="org">Cisco</div>
</div>
<div class="author">
      <div class="author-name">D. Benham</div>
<div class="org">Independent</div>
</div>
<div class="author">
      <div class="author-name">C. Groves</div>
<div class="org">Independent</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 8871</h1>
<h1 id="title">A Solution Framework for Private Media in Privacy-Enhanced RTP Conferencing (PERC)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">This document describes a solution framework for ensuring that media
confidentiality and integrity are maintained end to end within the
context of a switched conferencing environment where Media
Distributors are not trusted with the end-to-end media
encryption keys.  The solution builds upon existing security
mechanisms defined for the Real-time Transport Protocol (RTP).<a class="pilcrow" href="#section-abstract-1">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a class="pilcrow" href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc8871">https://www.rfc-editor.org/info/rfc8871</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">▲</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.1">
            <p class="keepWithNext" id="section-toc.1-1.1.1"><a class="xref" href="#section-1">1</a>.  <a class="xref" href="#name-introduction">Introduction</a><a class="pilcrow" href="#section-toc.1-1.1.1">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.2">
            <p class="keepWithNext" id="section-toc.1-1.2.1"><a class="xref" href="#section-2">2</a>.  <a class="xref" href="#name-conventions-used-in-this-do">Conventions Used in This Document</a><a class="pilcrow" href="#section-toc.1-1.2.1">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a class="xref" href="#section-3">3</a>.  <a class="xref" href="#name-perc-entities-and-trust-mod">PERC Entities and Trust Model</a><a class="pilcrow" href="#section-toc.1-1.3.1">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a class="xref" href="#section-3.1">3.1</a>.  <a class="xref" href="#name-untrusted-entities">Untrusted Entities</a><a class="pilcrow" href="#section-toc.1-1.3.2.1.1">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.3.2.1.2.1">
                    <p class="keepWithNext" id="section-toc.1-1.3.2.1.2.1.1"><a class="xref" href="#section-3.1.1">3.1.1</a>.  <a class="xref" href="#name-media-distributor">Media Distributor</a><a class="pilcrow" href="#section-toc.1-1.3.2.1.2.1.1">¶</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.3.2.1.2.2">
                    <p id="section-toc.1-1.3.2.1.2.2.1"><a class="xref" href="#section-3.1.2">3.1.2</a>.  <a class="xref" href="#name-call-processing">Call Processing</a><a class="pilcrow" href="#section-toc.1-1.3.2.1.2.2.1">¶</a></p>
</li>
                </ul>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a class="xref" href="#section-3.2">3.2</a>.  <a class="xref" href="#name-trusted-entities">Trusted Entities</a><a class="pilcrow" href="#section-toc.1-1.3.2.2.1">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a class="xref" href="#section-3.2.1">3.2.1</a>.  <a class="xref" href="#name-endpoint">Endpoint</a><a class="pilcrow" href="#section-toc.1-1.3.2.2.2.1.1">¶</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.3.2.2.2.2">
                    <p id="section-toc.1-1.3.2.2.2.2.1"><a class="xref" href="#section-3.2.2">3.2.2</a>.  <a class="xref" href="#name-key-distributor">Key Distributor</a><a class="pilcrow" href="#section-toc.1-1.3.2.2.2.2.1">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="xref" href="#section-4">4</a>.  <a class="xref" href="#name-framework-for-perc">Framework for PERC</a><a class="pilcrow" href="#section-toc.1-1.4.1">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a class="xref" href="#section-4.1">4.1</a>.  <a class="xref" href="#name-e2e-authenticated-and-hbh-a">E2E-Authenticated and HBH-Authenticated Encryption</a><a class="pilcrow" href="#section-toc.1-1.4.2.1.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a class="xref" href="#section-4.2">4.2</a>.  <a class="xref" href="#name-e2e-key-confidentiality">E2E Key Confidentiality</a><a class="pilcrow" href="#section-toc.1-1.4.2.2.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a class="xref" href="#section-4.3">4.3</a>.  <a class="xref" href="#name-e2e-keys-and-endpoint-opera">E2E Keys and Endpoint Operations</a><a class="pilcrow" href="#section-toc.1-1.4.2.3.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a class="xref" href="#section-4.4">4.4</a>.  <a class="xref" href="#name-hbh-keys-and-per-hop-operat">HBH Keys and Per-Hop Operations</a><a class="pilcrow" href="#section-toc.1-1.4.2.4.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a class="xref" href="#section-4.5">4.5</a>.  <a class="xref" href="#name-key-exchange">Key Exchange</a><a class="pilcrow" href="#section-toc.1-1.4.2.5.1">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.4.2.5.2.1">
                    <p id="section-toc.1-1.4.2.5.2.1.1"><a class="xref" href="#section-4.5.1">4.5.1</a>.  <a class="xref" href="#name-initial-key-exchange-and-ke">Initial Key Exchange and Key Distributor</a><a class="pilcrow" href="#section-toc.1-1.4.2.5.2.1.1">¶</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.5.2.2">
                    <p id="section-toc.1-1.4.2.5.2.2.1"><a class="xref" href="#section-4.5.2">4.5.2</a>.  <a class="xref" href="#name-key-exchange-during-a-confe">Key Exchange during a Conference</a><a class="pilcrow" href="#section-toc.1-1.4.2.5.2.2.1">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="xref" href="#section-5">5</a>.  <a class="xref" href="#name-authentication">Authentication</a><a class="pilcrow" href="#section-toc.1-1.5.1">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a class="xref" href="#section-5.1">5.1</a>.  <a class="xref" href="#name-identity-assertions">Identity Assertions</a><a class="pilcrow" href="#section-toc.1-1.5.2.1.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a class="xref" href="#section-5.2">5.2</a>.  <a class="xref" href="#name-certificate-fingerprints-in">Certificate Fingerprints in Session Signaling</a><a class="pilcrow" href="#section-toc.1-1.5.2.2.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a class="xref" href="#section-5.3">5.3</a>.  <a class="xref" href="#name-conference-identification">Conference Identification</a><a class="pilcrow" href="#section-toc.1-1.5.2.3.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="xref" href="#section-6">6</a>.  <a class="xref" href="#name-perc-keys">PERC Keys</a><a class="pilcrow" href="#section-toc.1-1.6.1">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a class="xref" href="#section-6.1">6.1</a>.  <a class="xref" href="#name-key-inventory-and-managemen">Key Inventory and Management Considerations</a><a class="pilcrow" href="#section-toc.1-1.6.2.1.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a class="xref" href="#section-6.2">6.2</a>.  <a class="xref" href="#name-dtls-srtp-exchange-yields-h">DTLS-SRTP Exchange Yields HBH Keys</a><a class="pilcrow" href="#section-toc.1-1.6.2.2.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a class="xref" href="#section-6.3">6.3</a>.  <a class="xref" href="#name-the-key-distributor-transmi">The Key Distributor Transmits the KEK (EKT Key)</a><a class="pilcrow" href="#section-toc.1-1.6.2.3.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a class="xref" href="#section-6.4">6.4</a>.  <a class="xref" href="#name-endpoints-fabricate-an-srtp">Endpoints Fabricate an SRTP Master Key</a><a class="pilcrow" href="#section-toc.1-1.6.2.4.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.6.2.5">
                <p id="section-toc.1-1.6.2.5.1"><a class="xref" href="#section-6.5">6.5</a>.  <a class="xref" href="#name-summary-of-key-types-and-en">Summary of Key Types and Entity Possession</a><a class="pilcrow" href="#section-toc.1-1.6.2.5.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="xref" href="#section-7">7</a>.  <a class="xref" href="#name-encrypted-media-packet-form">Encrypted Media Packet Format</a><a class="pilcrow" href="#section-toc.1-1.7.1">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="xref" href="#section-8">8</a>.  <a class="xref" href="#name-security-considerations">Security Considerations</a><a class="pilcrow" href="#section-toc.1-1.8.1">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a class="xref" href="#section-8.1">8.1</a>.  <a class="xref" href="#name-third-party-attacks">Third-Party Attacks</a><a class="pilcrow" href="#section-toc.1-1.8.2.1.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a class="xref" href="#section-8.2">8.2</a>.  <a class="xref" href="#name-media-distributor-attacks">Media Distributor Attacks</a><a class="pilcrow" href="#section-toc.1-1.8.2.2.1">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.8.2.2.2.1">
                    <p id="section-toc.1-1.8.2.2.2.1.1"><a class="xref" href="#section-8.2.1">8.2.1</a>.  <a class="xref" href="#name-denial-of-service">Denial of Service</a><a class="pilcrow" href="#section-toc.1-1.8.2.2.2.1.1">¶</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.8.2.2.2.2">
                    <p id="section-toc.1-1.8.2.2.2.2.1"><a class="xref" href="#section-8.2.2">8.2.2</a>.  <a class="xref" href="#name-replay-attacks">Replay Attacks</a><a class="pilcrow" href="#section-toc.1-1.8.2.2.2.2.1">¶</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.8.2.2.2.3">
                    <p id="section-toc.1-1.8.2.2.2.3.1"><a class="xref" href="#section-8.2.3">8.2.3</a>.  <a class="xref" href="#name-delayed-playout-attacks">Delayed Playout Attacks</a><a class="pilcrow" href="#section-toc.1-1.8.2.2.2.3.1">¶</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.8.2.2.2.4">
                    <p id="section-toc.1-1.8.2.2.2.4.1"><a class="xref" href="#section-8.2.4">8.2.4</a>.  <a class="xref" href="#name-splicing-attacks">Splicing Attacks</a><a class="pilcrow" href="#section-toc.1-1.8.2.2.2.4.1">¶</a></p>
</li>
                  <li class="toc ulEmpty compact" id="section-toc.1-1.8.2.2.2.5">
                    <p id="section-toc.1-1.8.2.2.2.5.1"><a class="xref" href="#section-8.2.5">8.2.5</a>.  <a class="xref" href="#name-rtcp-attacks">RTCP Attacks</a><a class="pilcrow" href="#section-toc.1-1.8.2.2.2.5.1">¶</a></p>
</li>
                </ul>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a class="xref" href="#section-8.3">8.3</a>.  <a class="xref" href="#name-key-distributor-attacks">Key Distributor Attacks</a><a class="pilcrow" href="#section-toc.1-1.8.2.3.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.8.2.4">
                <p id="section-toc.1-1.8.2.4.1"><a class="xref" href="#section-8.4">8.4</a>.  <a class="xref" href="#name-endpoint-attacks">Endpoint Attacks</a><a class="pilcrow" href="#section-toc.1-1.8.2.4.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="xref" href="#section-9">9</a>.  <a class="xref" href="#name-iana-considerations">IANA Considerations</a><a class="pilcrow" href="#section-toc.1-1.9.1">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a class="xref" href="#section-10">10</a>. <a class="xref" href="#name-references">References</a><a class="pilcrow" href="#section-toc.1-1.10.1">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a class="xref" href="#section-10.1">10.1</a>.  <a class="xref" href="#name-normative-references">Normative References</a><a class="pilcrow" href="#section-toc.1-1.10.2.1.1">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a class="xref" href="#section-10.2">10.2</a>.  <a class="xref" href="#name-informative-references">Informative References</a><a class="pilcrow" href="#section-toc.1-1.10.2.2.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a class="xref" href="#section-appendix.a"></a><a class="xref" href="#name-acknowledgments">Acknowledgments</a><a class="pilcrow" href="#section-toc.1-1.11.1">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a class="xref" href="#section-appendix.b"></a><a class="xref" href="#name-authors-addresses">Authors' Addresses</a><a class="pilcrow" href="#section-toc.1-1.12.1">¶</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">Switched conferencing is an increasingly popular model for multimedia
conferences with multiple participants using a combination of audio,
video, text, and other media types.  With this model, real-time media
flows from conference participants are not mixed, transcoded,
translated, recomposed, or otherwise manipulated by a Media
Distributor, as might be the case with a traditional media server or
Multipoint Control Unit (MCU).  Instead, media flows transmitted by
conference participants are simply forwarded by Media Distributors
to each of the other participants.  Media Distributors often forward only a subset of
flows based on voice activity detection or other criteria.  In some
instances, Media Distributors may make limited modifications to
RTP headers <span>[<a class="xref" href="#RFC3550">RFC3550</a>]</span>, for example, but the actual media content
(e.g., voice or video data) is unaltered.<a class="pilcrow" href="#section-1-1">¶</a></p>
<p id="section-1-2">An advantage of switched conferencing is that Media Distributors can
be more easily deployed on general-purpose computing hardware,
including virtualized environments in private and public clouds.
Virtualized public cloud environments have been viewed as less
secure, since resources are not always physically controlled by
those who use them.  This document defines improved security so as to
lower the barrier to taking advantage of those environments.<a class="pilcrow" href="#section-1-2">¶</a></p>
<p id="section-1-3">This document defines a solution framework wherein media privacy is
ensured by making it impossible for a Media Distributor to
gain access to keys needed to decrypt or authenticate the actual media
content sent between conference participants.  At the same time, the
framework allows for the Media Distributors to modify certain RTP
headers; add, remove, encrypt, or decrypt RTP header extensions; and
encrypt and decrypt RTP Control Protocol (RTCP) packets <span>[<a class="xref" href="#RFC3550">RFC3550</a>]</span>.
The framework also prevents replay
attacks by authenticating each packet transmitted between a given
participant and the Media Distributor using a unique key per
endpoint that is independent from the key for media encryption and
authentication.<a class="pilcrow" href="#section-1-3">¶</a></p>
<p id="section-1-4">This solution framework provides for enhanced privacy
in RTP-based conferencing environments while utilizing existing
security procedures defined for RTP with minimal enhancements.<a class="pilcrow" href="#section-1-4">¶</a></p>
</section>
</div>
<div id="conventions-used-in-this-document">
<section id="section-2">
      <h2 id="name-conventions-used-in-this-do">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-conventions-used-in-this-do">Conventions Used in This Document</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>",
       "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>",
       "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>",
       "<span class="bcp14">SHOULD NOT</span>",
       "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
       "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document
       are to be interpreted as described in BCP 14
       <span>[<a class="xref" href="#RFC2119">RFC2119</a>]</span> <span>[<a class="xref" href="#RFC8174">RFC8174</a>]</span> when, and only
       when, they appear in all capitals, as shown here.<a class="pilcrow" href="#section-2-1">¶</a></p>
<p id="section-2-2">Additionally, this solution framework uses the following
terms and abbreviations:<a class="pilcrow" href="#section-2-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2-3">
        <dt id="section-2-3.1">End-to-End (E2E):</dt>
        <dd id="section-2-3.2" style="margin-left: 1.5em">Communications from one endpoint through one or more
Media Distributors to the endpoint at the other end.<a class="pilcrow" href="#section-2-3.2">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.3">Hop-by-Hop (HBH):</dt>
        <dd id="section-2-3.4" style="margin-left: 1.5em">Communications between an endpoint and a Media
Distributor or between Media Distributors.<a class="pilcrow" href="#section-2-3.4">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.5">Trusted Endpoint (or simply endpoint):</dt>
        <dd id="section-2-3.6" style="margin-left: 1.5em">An RTP flow-terminating entity that has possession
of E2E media encryption keys and terminates E2E encryption.  This may
include embedded user conferencing equipment or browsers on computers,
media gateways, MCUs, media recording devices, and more, that are in the
trusted domain for a given deployment. In the context of WebRTC
<span>[<a class="xref" href="#W3C.CR-webrtc">W3C.CR-webrtc</a>]</span>, where
control of a session is divided between a JavaScript application and a
browser, the browser acts as the Trusted Endpoint for purposes of this
framework (just as it acts as the endpoint for DTLS-SRTP <span>[<a class="xref" href="#RFC5764">RFC5764</a>]</span> in
one-to-one calls).<a class="pilcrow" href="#section-2-3.6">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.7">Media Distributor (MD):</dt>
        <dd id="section-2-3.8" style="margin-left: 1.5em">An RTP middlebox that forwards endpoint media
content (e.g., voice or video data) unaltered -- either a subset or all
of the flows at any given time -- and is never allowed to have access
to E2E encryption keys.  It operates according to the
Selective Forwarding Middlebox RTP topologies <span>[<a class="xref" href="#RFC7667">RFC7667</a>]</span> per the
constraints defined by the Private Media in Privacy-Enhanced RTP
Conferencing (PERC) system, which includes, but is not limited
to, having no access to RTP media plaintext and having limits on what
RTP header fields it can alter.  The header fields that may be
modified by a Media Distributor are enumerated in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8723#section-4">Section 4</a> of the double cryptographic transform
specification [<a class="xref" href="#RFC8723">RFC8723</a>]</span> and chosen
with respect to utility and the security considerations outlined in this
document.<a class="pilcrow" href="#section-2-3.8">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.9">Key Distributor:</dt>
        <dd id="section-2-3.10" style="margin-left: 1.5em">An entity that is a logical function that
distributes keying material and related information to Trusted
Endpoints and Media Distributor(s) -- only what is appropriate for
each.  The Key Distributor might be co-resident with another entity
trusted with E2E keying material.<a class="pilcrow" href="#section-2-3.10">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.11">Conference:</dt>
        <dd id="section-2-3.12" style="margin-left: 1.5em">Two or more participants communicating via Trusted
Endpoints to exchange RTP flows through one or more Media Distributors.<a class="pilcrow" href="#section-2-3.12">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.13">Call Processing:</dt>
        <dd id="section-2-3.14" style="margin-left: 1.5em">All Trusted Endpoints connect to a 
conference via a call processing dialog, e.g., with the "focus" as defined in 
<span><a class="xref" href="#RFC4353">"A Framework for Conferencing with the
Session Initiation Protocol (SIP)"</a> [<a class="xref" href="#RFC4353">RFC4353</a>]</span>.<a class="pilcrow" href="#section-2-3.14">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-3.15">Third Party:</dt>
        <dd id="section-2-3.16" style="margin-left: 1.5em">Any entity that is not an endpoint, Media Distributor,
Key Distributor, or call processing entity as described in this
document.<a class="pilcrow" href="#section-2-3.16">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<div id="perc-entities-and-trust-model">
<section id="section-3">
      <h2 id="name-perc-entities-and-trust-mod">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-perc-entities-and-trust-mod">PERC Entities and Trust Model</a>
      </h2>
<p id="section-3-1"><a class="xref" href="#fig-trust-model">Figure 1</a> depicts the trust relationships, direct or
indirect, between entities described in the subsequent subsections.
Note that these entities may be co-located or further divided into
multiple, separate physical devices.<a class="pilcrow" href="#section-3-1">¶</a></p>
<p id="section-3-2">Please note that some entities classified as untrusted in the simple,
general deployment scenario used most commonly in this document might
be considered trusted in other deployments.  This document does not
preclude such scenarios, but it keeps the definitions and examples
focused by only using the simple, most general deployment
scenario.<a class="pilcrow" href="#section-3-2">¶</a></p>
<span id="name-trusted-and-untrusted-entit"></span><div id="fig-trust-model">
<figure id="figure-1">
        <div class="artwork art-text alignCenter" id="section-3-3.1">
<pre>                       |
   +----------+        |        +-----------------+
   | Endpoint |        |        | Call Processing |
   +----------+        |        +-----------------+
                       |
                       |
+----------------+     |       +--------------------+
| Key Distributor|     |       | Media Distributor  |
+----------------+     |       +--------------------+
                       |
     Trusted           |             Untrusted
     Entities          |             Entities
                       |</pre>
</div>
<figcaption><a class="selfRef" href="#figure-1">Figure 1</a>:
<a class="selfRef" href="#name-trusted-and-untrusted-entit">Trusted and Untrusted Entities in PERC</a>
        </figcaption></figure>
</div>
<div id="untrusted-entities">
<section id="section-3.1">
        <h3 id="name-untrusted-entities">
<a class="section-number selfRef" href="#section-3.1">3.1. </a><a class="section-name selfRef" href="#name-untrusted-entities">Untrusted Entities</a>
        </h3>
<p id="section-3.1-1">The architecture described in this framework document enables
conferencing infrastructure to be hosted in domains, such as in a
cloud conferencing provider's facilities, where the trustworthiness is
below the level needed to assume that the privacy of the participant's media
is not compromised.  The conferencing infrastructure in such a
domain is still trusted with reliably connecting the participants
together in a conference but is not trusted with keying material needed
to decrypt any of the participant's media.  Entities in such
less-trustworthy domains are referred to as untrusted
entities from this point forward.<a class="pilcrow" href="#section-3.1-1">¶</a></p>
<p id="section-3.1-2">It is important to understand that "untrusted" in this document does not
mean that an entity is not expected to function properly.  Rather, it means
only that the entity does not have access to the E2E media encryption
keys.<a class="pilcrow" href="#section-3.1-2">¶</a></p>
<div id="media-distributor">
<section id="section-3.1.1">
          <h4 id="name-media-distributor">
<a class="section-number selfRef" href="#section-3.1.1">3.1.1. </a><a class="section-name selfRef" href="#name-media-distributor">Media Distributor</a>
          </h4>
<p id="section-3.1.1-1">A Media Distributor forwards RTP flows between endpoints in the
conference while performing per-hop authentication of each RTP packet.
The Media Distributor may need access to one or more RTP headers or
header extensions, potentially adding or modifying a certain subset.
The Media Distributor also relays secured messaging between the
endpoints and the Key Distributor and acquires per-hop key
information from the Key Distributor.  The actual media content
must not be decryptable by a Media Distributor, as it is not trusted to
have access to the E2E media encryption keys.  The key exchange
mechanisms specified in this framework prevent the Media Distributor
from gaining access to the E2E media encryption keys.<a class="pilcrow" href="#section-3.1.1-1">¶</a></p>
<p id="section-3.1.1-2">An endpoint's ability to connect to a conference serviced by a Media
Distributor implies that the endpoint is authorized to
have access to the E2E media encryption keys, although the Media Distributor
does not have the ability to determine whether an endpoint is
authorized.  Instead, the Key Distributor is responsible for
authenticating the endpoint (e.g., using WebRTC identity assertions
<span>[<a class="xref" href="#RFC8827">RFC8827</a>]</span>) and determining its
authorization to receive E2E and HBH media encryption keys.<a class="pilcrow" href="#section-3.1.1-2">¶</a></p>
<p id="section-3.1.1-3">A Media Distributor must perform its role in properly forwarding
media packets while taking measures to mitigate the adverse effects of
denial-of-service attacks (refer to <a class="xref" href="#attacks">Section 8</a>) to a level equal
to or better than traditional conferencing (non-PERC)
deployments.<a class="pilcrow" href="#section-3.1.1-3">¶</a></p>
<p id="section-3.1.1-4">A Media Distributor or associated conferencing infrastructure may also
initiate or terminate various messaging techniques related to conference
control. This topic is outside the scope of this framework document.<a class="pilcrow" href="#section-3.1.1-4">¶</a></p>
</section>
</div>
<div id="call-processing">
<section id="section-3.1.2">
          <h4 id="name-call-processing">
<a class="section-number selfRef" href="#section-3.1.2">3.1.2. </a><a class="section-name selfRef" href="#name-call-processing">Call Processing</a>
          </h4>
<p id="section-3.1.2-1">Call processing is untrusted in the simple, general
deployment scenario.  When a physical subset of call processing
resides in facilities outside the trusted domain, it should
not be trusted to have access to E2E key information.<a class="pilcrow" href="#section-3.1.2-1">¶</a></p>
<p id="section-3.1.2-2">Call processing may include the processing of call
signaling messages, as well as the signing of those messages.  It may
also authenticate the endpoints for the purpose of call signaling and of
subsequently joining a conference hosted through one or more Media
Distributors.  Call processing may optionally ensure the privacy of
call signaling messages between itself (call processing), the endpoint, and other
entities.<a class="pilcrow" href="#section-3.1.2-2">¶</a></p>
</section>
</div>
</section>
</div>
<div id="trusted-entities">
<section id="section-3.2">
        <h3 id="name-trusted-entities">
<a class="section-number selfRef" href="#section-3.2">3.2. </a><a class="section-name selfRef" href="#name-trusted-entities">Trusted Entities</a>
        </h3>
<p id="section-3.2-1">From the PERC model system's perspective, entities considered trusted
(refer to <a class="xref" href="#fig-trust-model">Figure 1</a>) can be in possession of the E2E media
encryption keys for one or more conferences.<a class="pilcrow" href="#section-3.2-1">¶</a></p>
<div id="endpoint">
<section id="section-3.2.1">
          <h4 id="name-endpoint">
<a class="section-number selfRef" href="#section-3.2.1">3.2.1. </a><a class="section-name selfRef" href="#name-endpoint">Endpoint</a>
          </h4>
<p id="section-3.2.1-1">An endpoint is considered trusted and has access to E2E key
information.  While it is possible for an endpoint to be compromised,
subsequently performing in undesired ways, defining endpoint
resistance to compromise is outside the scope of this document.
Endpoints take measures to mitigate the adverse effects of denial-of-service attacks (refer to <a class="xref" href="#attacks">Section 8</a>) from other entities,
including from other endpoints, to a level equal to or better than
traditional conference (non-PERC) deployments.<a class="pilcrow" href="#section-3.2.1-1">¶</a></p>
</section>
</div>
<div id="key_distributor">
<section id="section-3.2.2">
          <h4 id="name-key-distributor">
<a class="section-number selfRef" href="#section-3.2.2">3.2.2. </a><a class="section-name selfRef" href="#name-key-distributor">Key Distributor</a>
          </h4>
<p id="section-3.2.2-1">The Key Distributor, which may be co-located with an endpoint or exist
standalone, is responsible for providing key information to endpoints
for both E2E and HBH security and for providing key
information to Media Distributors for HBH security.<a class="pilcrow" href="#section-3.2.2-1">¶</a></p>
<p id="section-3.2.2-2">Interaction between the Key Distributor and call processing
is necessary for proper conference-to-endpoint
mappings. This is described in <a class="xref" href="#conf-id">Section 5.3</a>.<a class="pilcrow" href="#section-3.2.2-2">¶</a></p>
<p id="section-3.2.2-3">The Key Distributor needs to be secured and managed in a way that
prevents exploitation by an adversary, as any kind of compromise of the
Key Distributor puts the security of the conference at risk.<a class="pilcrow" href="#section-3.2.2-3">¶</a></p>
<p id="section-3.2.2-4">The Key Distributor needs to know which endpoints and which Media
Distributors are authorized to participate in the conference.  How the
Key Distributor obtains this information is outside the scope of this
document.  However, Key Distributors <span class="bcp14">MUST</span> reject DTLS associations
with any unauthorized endpoint or Media Distributor.<a class="pilcrow" href="#section-3.2.2-4">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="framework-for-perc">
<section id="section-4">
      <h2 id="name-framework-for-perc">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-framework-for-perc">Framework for PERC</a>
      </h2>
<p id="section-4-1">The purpose of this framework is to define a means through which
media privacy is ensured when communicating within a conferencing
environment consisting of one or more Media Distributors that only
switch, and hence do not terminate, media.  It does not otherwise attempt to
hide the fact that a conference between endpoints is taking place.<a class="pilcrow" href="#section-4-1">¶</a></p>
<p id="section-4-2">This framework reuses several specified RTP security technologies,
including the Secure Real-time Transport Protocol (SRTP) <span>[<a class="xref" href="#RFC3711">RFC3711</a>]</span>,
Encrypted Key Transport (EKT) <span>[<a class="xref" href="#RFC8870">RFC8870</a>]</span>,
and DTLS-SRTP.<a class="pilcrow" href="#section-4-2">¶</a></p>
<div id="end-to-end-and-hop-by-hop-authenticated-encryption">
<section id="section-4.1">
        <h3 id="name-e2e-authenticated-and-hbh-a">
<a class="section-number selfRef" href="#section-4.1">4.1. </a><a class="section-name selfRef" href="#name-e2e-authenticated-and-hbh-a">E2E-Authenticated and HBH-Authenticated Encryption</a>
        </h3>
<p id="section-4.1-1">This solution framework focuses on the E2E privacy and
integrity of the participant's media by limiting access to only trusted
entities to the E2E key used for authenticated E2E encryption.
However, this framework does give a Media Distributor access to RTP header
fields and header extensions, as well as the ability to modify a certain
subset of the header fields and to add or change header extensions.  Packets
received by a Media Distributor or an endpoint are authenticated
hop by hop.<a class="pilcrow" href="#section-4.1-1">¶</a></p>
<p id="section-4.1-2">To enable all of the above, this framework defines the use of two
security contexts and two associated encryption keys: an "inner" key
(a distinct E2E key for each transmitted media flow) for authenticated
encryption of RTP media between endpoints and an "outer" key (a HBH key)
known only to a Media Distributor or the adjacent endpoint
for the hop between an endpoint and a Media Distributor or peer endpoint.
An endpoint will receive one or more E2E keys from
every other endpoint in the conference that correspond to the media flows
transmitted by those other endpoints, while HBH keys are derived from
the DTLS-SRTP association with the Key Distributor.  Two communicating
Media Distributors use DTLS-SRTP associations directly with each other to
obtain the HBH keys they will use.  See <a class="xref" href="#key_exchange">Section 4.5</a> for more details
on key exchange.<a class="pilcrow" href="#section-4.1-2">¶</a></p>
<span id="name-e2e-and-hbh-keys-used-for-a"></span><div id="fig-e2e-and-hbh-keys-used">
<figure id="figure-2">
          <div class="artwork art-text alignCenter" id="section-4.1-3.1">
<pre>+-------------+                                +-------------+
|             |################################|             |
|    Media    |------------------------ *-----&gt;|    Media    |
| Distributor |&lt;----------------------*-|------| Distributor |
|      X      |#####################*#|#|######|      Y      |
|             |                     | | |      |             |
+-------------+                     | | |      +-------------+
   #  ^ |  #          HBH Key (XY) -+ | |         #  ^ |  #
   #  | |  #           E2E Key (B) ---+ |         #  | |  #
   #  | |  #           E2E Key (A) -----+         #  | |  #
   #  | |  #                                      #  | |  #
   #  | |  #                                      #  | |  #
   #  | |  *---- HBH Key (AX)    HBH Key (YB) ----*  | |  #
   #  | |  #                                      #  | |  #
   #  *--------- E2E Key (A)      E2E Key (A) ---------*  #
   #  | *------- E2E Key (B)      E2E Key (B) -------* |  #
   #  | |  #                                      #  | |  #
   #  | v  #                                      #  | v  #
+-------------+                                +-------------+
| Endpoint A  |                                | Endpoint B  |
+-------------+                                +-------------+</pre>
</div>
<figcaption><a class="selfRef" href="#figure-2">Figure 2</a>:
<a class="selfRef" href="#name-e2e-and-hbh-keys-used-for-a">E2E and HBH Keys Used for Authenticated Encryption of SRTP Packets</a>
          </figcaption></figure>
</div>
<p id="section-4.1-4">The double transform <span>[<a class="xref" href="#RFC8723">RFC8723</a>]</span> enables endpoints
to perform encryption using both the E2E and HBH contexts while
still preserving the same overall interface as other SRTP
transforms.  The Media Distributor simply uses the corresponding
normal (single) AES-GCM transform, keyed with the appropriate HBH
keys.  See <a class="xref" href="#keyinventory">Section 6.1</a> for a description of the keys used in PERC
and <a class="xref" href="#packetformat">Section 7</a> for a diagram of how encrypted RTP packets appear on the
wire.<a class="pilcrow" href="#section-4.1-4">¶</a></p>
<p id="section-4.1-5">RTCP is only encrypted hop by hop -- not end to end. This framework
does not provide an additional step for RTCP-authenticated
encryption.  Rather, implementations utilize the existing procedures
specified in <span>[<a class="xref" href="#RFC3711">RFC3711</a>]</span>; those procedures use
the same outer, HBH cryptographic context chosen in the double transform operation
described above. For this reason, endpoints <span class="bcp14">MUST NOT</span> send
confidential information via RTCP.<a class="pilcrow" href="#section-4.1-5">¶</a></p>
</section>
</div>
<div id="e2e-key-confidentiality">
<section id="section-4.2">
        <h3 id="name-e2e-key-confidentiality">
<a class="section-number selfRef" href="#section-4.2">4.2. </a><a class="section-name selfRef" href="#name-e2e-key-confidentiality">E2E Key Confidentiality</a>
        </h3>
<p id="section-4.2-1">To ensure the confidentiality of E2E keys shared between endpoints,
endpoints use a common Key Encryption Key (KEK) that is
known only by the trusted entities in a conference.  That KEK, defined
in the EKT specification <span>[<a class="xref" href="#RFC8870">RFC8870</a>]</span> as the EKT Key, is
used to subsequently encrypt the SRTP master key used for E2E-authenticated encryption of media sent by a given endpoint.
Each endpoint in the conference creates an SRTP master
key for E2E-authenticated encryption and
keeps track of the E2E keys received via the Full EKT Tag for
each distinct synchronization source (SSRC) in the conference so that it
can properly decrypt received media.  An endpoint may change its E2E key at any
time and advertise that new key to the conference as specified in
<span>[<a class="xref" href="#RFC8870">RFC8870</a>]</span>.<a class="pilcrow" href="#section-4.2-1">¶</a></p>
</section>
</div>
<div id="e2e_keys_ops">
<section id="section-4.3">
        <h3 id="name-e2e-keys-and-endpoint-opera">
<a class="section-number selfRef" href="#section-4.3">4.3. </a><a class="section-name selfRef" href="#name-e2e-keys-and-endpoint-opera">E2E Keys and Endpoint Operations</a>
        </h3>
<p id="section-4.3-1">Any given RTP media flow is identified by its SSRC, and an endpoint
might send more than one at a time and change the mix of media flows
transmitted during the lifetime of a conference.<a class="pilcrow" href="#section-4.3-1">¶</a></p>
<p id="section-4.3-2">Thus, an endpoint <span class="bcp14">MUST</span> maintain a list of SSRCs from received RTP
flows and each SSRC's associated E2E key information.  An endpoint <span class="bcp14">MUST</span>
discard old E2E keys no later than when it leaves the conference.<a class="pilcrow" href="#section-4.3-2">¶</a></p>
<p id="section-4.3-3">If the packet is to contain RTP header extensions, it should be noted
that those extensions are only encrypted hop by hop per <span>[<a class="xref" href="#RFC8723">RFC8723</a>]</span>.  For
this reason, endpoints <span class="bcp14">MUST NOT</span> transmit confidential information
via RTP header extensions.<a class="pilcrow" href="#section-4.3-3">¶</a></p>
</section>
</div>
<div id="hbh-keys-and-per-hop-operations">
<section id="section-4.4">
        <h3 id="name-hbh-keys-and-per-hop-operat">
<a class="section-number selfRef" href="#section-4.4">4.4. </a><a class="section-name selfRef" href="#name-hbh-keys-and-per-hop-operat">HBH Keys and Per-Hop Operations</a>
        </h3>
<p id="section-4.4-1">To ensure the integrity of transmitted media packets, it is
<span class="bcp14">REQUIRED</span> that every packet be authenticated hop by hop between
an endpoint and a Media Distributor, as well as between Media
Distributors.  The authentication key used for HBH
authentication is derived from an SRTP master key shared only on the
respective hop.  Each HBH key is distinct per hop, and no two hops ever
use the same SRTP master key.<a class="pilcrow" href="#section-4.4-1">¶</a></p>
<p id="section-4.4-2">While endpoints also perform HBH authentication, the ability of the endpoints
to reconstruct the original RTP header also enables the endpoints to
authenticate RTP packets end to end.  This design yields flexibility to the Media
Distributor to change certain RTP header values as packets are
forwarded.  Values that the Media Distributor can change in the RTP header
are defined in
<span>[<a class="xref" href="#RFC8723">RFC8723</a>]</span>.  RTCP can only be encrypted hop by
hop, giving the Media Distributor the flexibility to (1) forward RTCP
content unchanged, (2) transmit compound RTCP packets, (3) initiate
RTCP packets for reporting statistics, or (4) convey other information.
Performing HBH authentication for all RTP and RTCP packets also helps
provide replay protection (see <a class="xref" href="#attacks">Section 8</a>).  The use of the replay
protection mechanism specified in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc3711#section-3.3.2">Section 3.3.2</a> of [<a class="xref" href="#RFC3711">RFC3711</a>]</span> is <span class="bcp14">REQUIRED</span> at each hop.<a class="pilcrow" href="#section-4.4-2">¶</a></p>
<p id="section-4.4-3">If there is a need to encrypt one or more RTP header extensions
hop by hop, the endpoint derives an encryption key from the HBH SRTP
master key to encrypt header extensions as per <span>[<a class="xref" href="#RFC6904">RFC6904</a>]</span>.  This
still gives the Media Distributor visibility into header extensions,
such as the one used to determine the audio level <span>[<a class="xref" href="#RFC6464">RFC6464</a>]</span> of conference
participants.  Note that when RTP header extensions are encrypted, all
hops need to decrypt and
re-encrypt these encrypted header extensions.  Please refer to
Sections <a class="relref" href="https://www.rfc-editor.org/rfc/rfc8723#section-5.1">5.1</a>, <a class="relref" href="https://www.rfc-editor.org/rfc/rfc8723#section-5.2">5.2</a>, and <a class="relref" href="https://www.rfc-editor.org/rfc/rfc8723#section-5.3">5.3</a> of <span>[<a class="xref" href="#RFC8723">RFC8723</a>]</span> for procedures
to perform RTP header extension encryption and decryption.<a class="pilcrow" href="#section-4.4-3">¶</a></p>
</section>
</div>
<div id="key_exchange">
<section id="section-4.5">
        <h3 id="name-key-exchange">
<a class="section-number selfRef" href="#section-4.5">4.5. </a><a class="section-name selfRef" href="#name-key-exchange">Key Exchange</a>
        </h3>
<p id="section-4.5-1">In brief, the keys used by any given endpoints are determined as
follows:<a class="pilcrow" href="#section-4.5-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.5-2.1">The HBH keys that the endpoint uses to send and receive SRTP media
are derived from a DTLS handshake that the endpoint performs with
the Key Distributor (following normal DTLS-SRTP procedures).<a class="pilcrow" href="#section-4.5-2.1">¶</a>
</li>
          <li class="normal" id="section-4.5-2.2">The E2E key that an endpoint uses to send SRTP media can be
either set from the DTLS-SRTP association with the Key Distributor or chosen
by the endpoint.  It is then distributed to other endpoints in a
Full EKT Tag, encrypted under an EKT Key provided to the client by the
Key Distributor within the DTLS channel they negotiated.  Note that
an endpoint <span class="bcp14">MAY</span> create a different E2E key per media flow, where a
media flow is identified by its SSRC value.<a class="pilcrow" href="#section-4.5-2.2">¶</a>
</li>
          <li class="normal" id="section-4.5-2.3">Each E2E key that an endpoint uses to receive SRTP media is set
by receiving a Full EKT Tag from another endpoint.<a class="pilcrow" href="#section-4.5-2.3">¶</a>
</li>
          <li class="normal" id="section-4.5-2.4">The HBH keys used between two Media Distributors are derived via
DTLS-SRTP procedures employed directly between them.<a class="pilcrow" href="#section-4.5-2.4">¶</a>
</li>
        </ul>
<div id="initial-key-exchange-and-key-distributor">
<section id="section-4.5.1">
          <h4 id="name-initial-key-exchange-and-ke">
<a class="section-number selfRef" href="#section-4.5.1">4.5.1. </a><a class="section-name selfRef" href="#name-initial-key-exchange-and-ke">Initial Key Exchange and Key Distributor</a>
          </h4>
<p id="section-4.5.1-1">The Media Distributor maintains a tunnel with the Key Distributor
(e.g., using the tunnel protocol defined in <span>[<a class="xref" href="#I-D.ietf-perc-dtls-tunnel">PERC-DTLS</a>]</span>), making it
possible for the Media Distributor to facilitate the establishment of
a secure DTLS association between each endpoint and the Key
Distributor as shown in <a class="xref" href="#fig-initial-key-exchange">Figure 3</a>.  The DTLS association
between endpoints and the Key Distributor enables each endpoint to
generate E2E and HBH keys and receive the KEK.
At the same time, the Key Distributor securely
provides the HBH key information to the Media Distributor.  The key
information summarized here may include the SRTP master key, the SRTP
master salt, and the negotiated cryptographic transform.<a class="pilcrow" href="#section-4.5.1-1">¶</a></p>
<span id="name-exchanging-key-information-"></span><div id="fig-initial-key-exchange">
<figure id="figure-3">
            <div class="artwork art-text alignCenter" id="section-4.5.1-2.1">
<pre>                          +-----------+
                 KEK info |    Key    | HBH Key info to
             to Endpoints |Distributor| Endpoints &amp; Media Distributor
                          +-----------+
                             # ^ ^ #
                             # | | #--- Tunnel
                             # | | #
+-----------+             +-----------+             +-----------+
| Endpoint  |   DTLS      |   Media   |   DTLS      | Endpoint  |
|    KEK    |&lt;------------|Distributor|------------&gt;|    KEK    |
|  HBH Key  | to Key Dist | HBH Keys  | to Key Dist |  HBH Key  |
+-----------+             +-----------+             +-----------+</pre>
</div>
<figcaption><a class="selfRef" href="#figure-3">Figure 3</a>:
<a class="selfRef" href="#name-exchanging-key-information-">Exchanging Key Information between Entities</a>
            </figcaption></figure>
</div>
<p id="section-4.5.1-3">In addition to the secure tunnel between the Media Distributor and the
Key Distributor, there are two additional types of security associations
utilized as a part of the key exchange, as discussed in the following
paragraphs.  One is a DTLS-SRTP association between an endpoint and the Key
Distributor (with packets passing through the Media Distributor), and the
other is a DTLS-SRTP association between peer Media Distributors.<a class="pilcrow" href="#section-4.5.1-3">¶</a></p>
<p id="section-4.5.1-4">Endpoints establish a DTLS-SRTP association over the RTP session with the
Media Distributor and its media ports for the purposes of key information
exchange with the Key Distributor.  The Media Distributor does not terminate
the DTLS signaling but instead forwards DTLS packets received
from an endpoint on to the Key Distributor (and vice versa) via a
tunnel established between the Media Distributor and the Key Distributor.<a class="pilcrow" href="#section-4.5.1-4">¶</a></p>
<p id="section-4.5.1-5">When establishing the DTLS association between endpoints and the
Key Distributor, the endpoint <span class="bcp14">MUST</span> act as the DTLS client, and the
Key Distributor <span class="bcp14">MUST</span> act as the DTLS server.  The KEK
is conveyed by the Key Distributor over the DTLS
association to endpoints via procedures defined in EKT
<span>[<a class="xref" href="#RFC8870">RFC8870</a>]</span> via the EKTKey message.<a class="pilcrow" href="#section-4.5.1-5">¶</a></p>
<p id="section-4.5.1-6">The Key Distributor <span class="bcp14">MUST NOT</span> establish DTLS-SRTP associations with
endpoints without first authenticating the Media Distributor tunneling the
DTLS-SRTP packets from the endpoint.<a class="pilcrow" href="#section-4.5.1-6">¶</a></p>
<p id="section-4.5.1-7">Note that following DTLS-SRTP procedures for the cipher defined
in <span>[<a class="xref" href="#RFC8723">RFC8723</a>]</span>, the endpoint generates both E2E and HBH encryption keys
and salt values.  Endpoints <span class="bcp14">MUST</span> either use the DTLS-SRTP-generated E2E key
for transmission or generate a fresh E2E key.  In either case, the generated
SRTP master salt for E2E encryption <span class="bcp14">MUST</span> be replaced with the salt value
provided by the Key Distributor via the EKTKey message.  That is because
every endpoint in the conference uses the same SRTP master salt.  The
endpoint only transmits the SRTP master key (not the salt) used for E2E
encryption to other endpoints in RTP/RTCP packets per
<span>[<a class="xref" href="#RFC8870">RFC8870</a>]</span>.<a class="pilcrow" href="#section-4.5.1-7">¶</a></p>
<p id="section-4.5.1-8">Media Distributors use DTLS-SRTP directly with a peer
Media Distributor to establish the HBH key for transmitting RTP and RTCP
packets to that peer Media Distributor.  The Key Distributor does not
facilitate establishing a HBH key for use between Media Distributors.<a class="pilcrow" href="#section-4.5.1-8">¶</a></p>
</section>
</div>
<div id="keyexchange">
<section id="section-4.5.2">
          <h4 id="name-key-exchange-during-a-confe">
<a class="section-number selfRef" href="#section-4.5.2">4.5.2. </a><a class="section-name selfRef" href="#name-key-exchange-during-a-confe">Key Exchange during a Conference</a>
          </h4>
<p id="section-4.5.2-1">Following the initial key information exchange with the Key
Distributor, an endpoint is able to encrypt media end to end with
an E2E key, sending that E2E key to other endpoints encrypted with the
KEK, and is able to encrypt and authenticate RTP packets
using a HBH key.  This framework does not allow the Media Distributor
to gain access to the KEK information, preventing it from
gaining access to any endpoint's E2E key and subsequently decrypting
media.<a class="pilcrow" href="#section-4.5.2-1">¶</a></p>
<p id="section-4.5.2-2">The KEK may need to change from time to time during the
lifetime of a conference, such as when a new participant joins or leaves a
conference.  Dictating if, when, or how often a conference is to be
rekeyed is outside the scope of this document, but this framework
does accommodate rekeying during the lifetime of a conference.<a class="pilcrow" href="#section-4.5.2-2">¶</a></p>
<p id="section-4.5.2-3">When a Key Distributor decides to rekey a conference, it transmits a
new EKTKey message containing the new EKT Key
to each of the conference participants.
Upon receipt of the new EKT Key, the endpoint <span class="bcp14">MUST</span> create a
new SRTP master key and prepare to send that key inside a FullEKTField using
the new EKT Key as per <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8870#section-4.5">Section 4.5</a> of [<a class="xref" href="#RFC8870">RFC8870</a>]</span>. In order to allow time for all endpoints in the conference to receive the new
keys, the sender should follow the recommendations in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8870#section-4.6">Section 4.6</a> of [<a class="xref" href="#RFC8870">RFC8870</a>]</span>. On receiving a new EKT Key, endpoints <span class="bcp14">MUST</span>
be prepared to decrypt EKT Tags using the new key.  The EKT Security Parameter
Index (SPI) field is
used to differentiate between EKT Tags encrypted with the old and new keys.<a class="pilcrow" href="#section-4.5.2-3">¶</a></p>
<p id="section-4.5.2-4">After rekeying, an endpoint <span class="bcp14">SHOULD</span> retain prior SRTP master keys and
EKT Keys for a period of time sufficient for the purpose of ensuring that it can
decrypt late-arriving or out-of-order packets or packets sent by other
endpoints that used the prior keys for a period of time after rekeying began.
An endpoint <span class="bcp14">MAY</span> retain old keys until the end of the conference.<a class="pilcrow" href="#section-4.5.2-4">¶</a></p>
<p id="section-4.5.2-5">Endpoints <span class="bcp14">MAY</span> follow the procedures in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc5764#section-5.2">Section 5.2</a> of [<a class="xref" href="#RFC5764">RFC5764</a>]</span>
to renegotiate HBH keys as desired.  If new HBH keys are generated,
the new keys are also delivered to the Media Distributor following
the procedures defined in <span>[<a class="xref" href="#I-D.ietf-perc-dtls-tunnel">PERC-DTLS</a>]</span> as one possible method.<a class="pilcrow" href="#section-4.5.2-5">¶</a></p>
<p id="section-4.5.2-6">At any time, endpoints <span class="bcp14">MAY</span> change the E2E
encryption key being used.  An endpoint <span class="bcp14">MUST</span> generate a new E2E encryption key
whenever it receives a new EKT Key.  After switching to a new key,
the new key is conveyed to other endpoints in the conference
in RTP/RTCP packets per <span>[<a class="xref" href="#RFC8870">RFC8870</a>]</span>.<a class="pilcrow" href="#section-4.5.2-6">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="authentication">
<section id="section-5">
      <h2 id="name-authentication">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-authentication">Authentication</a>
      </h2>
<p id="section-5-1">It is important that entities can
validate the authenticity of other entities, especially the Key
Distributor and endpoints. Details on this topic are outside the scope
of this specification, but a few possibilities are discussed in the
following sections.  The critical requirements are that (1) an endpoint
can verify that it is connected to the correct Key Distributor for the
conference and (2) the Key Distributor can verify that the endpoint is
the correct endpoint for the conference.<a class="pilcrow" href="#section-5-1">¶</a></p>
<p id="section-5-2">Two possible approaches to resolve this situation are identity assertions and
certificate fingerprints.<a class="pilcrow" href="#section-5-2">¶</a></p>
<div id="identity-assertions">
<section id="section-5.1">
        <h3 id="name-identity-assertions">
<a class="section-number selfRef" href="#section-5.1">5.1. </a><a class="section-name selfRef" href="#name-identity-assertions">Identity Assertions</a>
        </h3>
<p id="section-5.1-1">A WebRTC identity assertion <span>[<a class="xref" href="#RFC8827">RFC8827</a>]</span> is used
to bind the identity of the user of the endpoint to the fingerprint of
the DTLS-SRTP certificate used for the call.  This certificate is
unique for a given call and a conference.  
This certificate is unique for a given call and a conference, allowing the
Key Distributor to ensure that only authorized users participate in the
conference. Similarly, the Key Distributor can create a WebRTC identity
assertion to bind the fingerprint of the unique certificate used by
the Key Distributor for this conference so that the endpoint can
verify that it is talking to the correct Key Distributor. Such a setup
requires an Identity Provider (IdP) trusted by the endpoints and the
Key Distributor.<a class="pilcrow" href="#section-5.1-1">¶</a></p>
</section>
</div>
<div id="certificate-fingerprints-in-session-signaling">
<section id="section-5.2">
        <h3 id="name-certificate-fingerprints-in">
<a class="section-number selfRef" href="#section-5.2">5.2. </a><a class="section-name selfRef" href="#name-certificate-fingerprints-in">Certificate Fingerprints in Session Signaling</a>
        </h3>
<p id="section-5.2-1">Entities managing session signaling are generally assumed to be
untrusted in the PERC framework.  However, there are some deployment
scenarios where parts of the session signaling may be assumed
trustworthy for the purposes of exchanging, in a manner that can be
authenticated, the fingerprint of an entity's certificate.<a class="pilcrow" href="#section-5.2-1">¶</a></p>
<p id="section-5.2-2">As a concrete example, SIP <span>[<a class="xref" href="#RFC3261">RFC3261</a>]</span> and
the Session Description Protocol (SDP) <span>[<a class="xref" href="#RFC4566">RFC4566</a>]</span> can be used
to convey the fingerprint information per <span>[<a class="xref" href="#RFC5763">RFC5763</a>]</span>.  An endpoint's
SIP User Agent would send an INVITE message containing SDP for the
media session along with the endpoint's certificate fingerprint, which
can be signed using the procedures described in <span>[<a class="xref" href="#RFC8224">RFC8224</a>]</span> for the
benefit of forwarding the message to other entities by the focus
<span>[<a class="xref" href="#RFC4353">RFC4353</a>]</span>.  Other entities can verify that the fingerprints match the
certificates found in the DTLS-SRTP connections to find the identity
of the far end of the DTLS-SRTP connection and verify that it is the
authorized entity.<a class="pilcrow" href="#section-5.2-2">¶</a></p>
<p id="section-5.2-3">Ultimately, if using session signaling, an endpoint's certificate
fingerprint would need to be securely mapped to a user and conveyed to
the Key Distributor so that it can check that the user in question is authorized.
Similarly, the Key Distributor's certificate fingerprint can be
conveyed to an endpoint in a manner that can be authenticated as being an
authorized Key Distributor for this conference.<a class="pilcrow" href="#section-5.2-3">¶</a></p>
</section>
</div>
<div id="conf-id">
<section id="section-5.3">
        <h3 id="name-conference-identification">
<a class="section-number selfRef" href="#section-5.3">5.3. </a><a class="section-name selfRef" href="#name-conference-identification">Conference Identification</a>
        </h3>
<p id="section-5.3-1">The Key Distributor needs to know what endpoints are being added to a
given conference. Thus, the Key Distributor and the Media Distributor
need to know endpoint-to-conference mappings, which are enabled by
exchanging a conference-specific unique identifier as described in
<span>[<a class="xref" href="#I-D.ietf-perc-dtls-tunnel">PERC-DTLS</a>]</span>.  How this unique
identifier is assigned is outside the scope of this document.<a class="pilcrow" href="#section-5.3-1">¶</a></p>
</section>
</div>
</section>
</div>
<div id="perc-keys">
<section id="section-6">
      <h2 id="name-perc-keys">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-perc-keys">PERC Keys</a>
      </h2>
<p id="section-6-1">This section describes the various keys employed by PERC.<a class="pilcrow" href="#section-6-1">¶</a></p>
<div id="keyinventory">
<section id="section-6.1">
        <h3 id="name-key-inventory-and-managemen">
<a class="section-number selfRef" href="#section-6.1">6.1. </a><a class="section-name selfRef" href="#name-key-inventory-and-managemen">Key Inventory and Management Considerations</a>
        </h3>
<p id="section-6.1-1">This section summarizes the several different keys used in the PERC framework,
how they are generated, and what purpose they serve.<a class="pilcrow" href="#section-6.1-1">¶</a></p>
<p id="section-6.1-2">The keys are described in the order in which they would typically be
acquired.<a class="pilcrow" href="#section-6.1-2">¶</a></p>
<p id="section-6.1-3">The various keys used in PERC are shown in
<a class="xref" href="#key-inventory-table">Table 1</a> below.<a class="pilcrow" href="#section-6.1-3">¶</a></p>
<span id="name-key-inventory"></span><div id="key-inventory-table">
<table class="center" id="table-1">
          <caption>
<a class="selfRef" href="#table-1">Table 1</a>:
<a class="selfRef" href="#name-key-inventory">Key Inventory</a>
          </caption>
<thead>
            <tr>
              <th class="text-center" colspan="1" rowspan="1">Key</th>
              <th class="text-center" colspan="1" rowspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">HBH Key</td>
              <td class="text-left" colspan="1" rowspan="1">SRTP master key used to encrypt media hop by hop.</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">KEK (EKT Key)</td>
              <td class="text-left" colspan="1" rowspan="1">Key shared by all endpoints and used to encrypt each endpoint's E2E
      SRTP master key so receiving endpoints can decrypt media.</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">E2E Key</td>
              <td class="text-left" colspan="1" rowspan="1">SRTP master key used to encrypt media end to end.</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-6.1-5">While the number of key types is very small, it should be understood that
the actual number of distinct keys can be large as the conference
grows in size.<a class="pilcrow" href="#section-6.1-5">¶</a></p>
<p id="section-6.1-6">As an example, with 1,000 participants in a conference, there would be at
least 1,000 distinct SRTP master keys, all of which share the same master salt.
Each of those keys is passed through the Key Derivation Function (KDF) as defined in <span>[<a class="xref" href="#RFC3711">RFC3711</a>]</span> to produce
the actual encryption and authentication keys.<a class="pilcrow" href="#section-6.1-6">¶</a></p>
<p id="section-6.1-7">Complicating key management is the fact that the KEK can change and, when
it does, the endpoints generate new SRTP master keys that are associated with
a new EKT SPI.  Endpoints might retain old keys for a period of time to
ensure that they can properly decrypt late-arriving or out-of-order packets, which
means that the number of keys held during that period of time might be
substantially higher.<a class="pilcrow" href="#section-6.1-7">¶</a></p>
<p id="section-6.1-8">A more detailed explanation of each of the keys follows.<a class="pilcrow" href="#section-6.1-8">¶</a></p>
</section>
</div>
<div id="dtls-srtp-exchange-yields-hbh-keys">
<section id="section-6.2">
        <h3 id="name-dtls-srtp-exchange-yields-h">
<a class="section-number selfRef" href="#section-6.2">6.2. </a><a class="section-name selfRef" href="#name-dtls-srtp-exchange-yields-h">DTLS-SRTP Exchange Yields HBH Keys</a>
        </h3>
<p id="section-6.2-1">The first set of keys acquired are for HBH encryption and
decryption.  Per the double transform procedures <span>[<a class="xref" href="#RFC8723">RFC8723</a>]</span>, the
endpoint performs a DTLS-SRTP exchange with the Key Distributor
and receives a key that is, in fact, "double" the size that is needed.
The E2E part is the first half of the key, so the endpoint discards
that information when generating its own key.  The second half of the keying
material is for HBH operations, so that half of the key
(corresponding to the least significant bits) is assigned internally as
the HBH key.<a class="pilcrow" href="#section-6.2-1">¶</a></p>
<p id="section-6.2-2">The Key Distributor informs the Media Distributor of the HBH key.  Specifically,
the Key Distributor sends the least significant bits corresponding to the
half of the keying material determined through DTLS-SRTP with the endpoint
to the Media Distributor.  A salt value is
generated along with the HBH key.  The salt is also longer than needed
for HBH operations; thus, only the least significant bits of the
required length (half of the generated salt material) are sent to the
Media Distributor.  One way to transmit this key and salt information
is via the tunnel protocol defined in <span>[<a class="xref" href="#I-D.ietf-perc-dtls-tunnel">PERC-DTLS</a>]</span>.<a class="pilcrow" href="#section-6.2-2">¶</a></p>
<p id="section-6.2-3">No two endpoints have the same HBH key; thus, the Media Distributor
<span class="bcp14">MUST</span> keep track of each distinct HBH key (and the corresponding salt) and
use it only for the specified hop.<a class="pilcrow" href="#section-6.2-3">¶</a></p>
<p id="section-6.2-4">The HBH key is also used for HBH encryption of RTCP.  RTCP is not
E2E-encrypted in PERC.<a class="pilcrow" href="#section-6.2-4">¶</a></p>
</section>
</div>
<div id="the-key-distributor-transmits-the-kek-ekt-key">
<section id="section-6.3">
        <h3 id="name-the-key-distributor-transmi">
<a class="section-number selfRef" href="#section-6.3">6.3. </a><a class="section-name selfRef" href="#name-the-key-distributor-transmi">The Key Distributor Transmits the KEK (EKT Key)</a>
        </h3>
<p id="section-6.3-1">The Key Distributor sends the KEK (the EKT Key per      
<span>[<a class="xref" href="#RFC8870">RFC8870</a>]</span>) to the endpoint via the aforementioned DTLS-SRTP association.  This key is known only to
the Key Distributor and endpoints; it is the most important entity to
protect, since having knowledge of this key (and the SRTP master salt
transmitted as a part of the same message) allows an entity to
decrypt any media packet in the conference.<a class="pilcrow" href="#section-6.3-1">¶</a></p>
<p id="section-6.3-2">Note that the Key Distributor can send any number of EKT Keys to
endpoints.  This information is used to rekey the entire conference.  Each
key is identified by an SPI value.
Endpoints <span class="bcp14">MUST</span> expect that a conference might be rekeyed
when a new participant joins a conference or when a participant
leaves a conference, in order to protect the confidentiality of
the conversation before and after such events.<a class="pilcrow" href="#section-6.3-2">¶</a></p>
<p id="section-6.3-3">The SRTP master salt to be used by the endpoint is transmitted along
with the EKT Key.  All endpoints in the conference utilize
the same SRTP master salt that corresponds with a given EKT Key.<a class="pilcrow" href="#section-6.3-3">¶</a></p>
<p id="section-6.3-4">The Full EKT Tag in media packets is encrypted using a cipher specified
via the EKTKey message (e.g., AES Key Wrap with a 128-bit key).  This
cipher is different than the cipher used to protect media and is only
used to encrypt the endpoint's SRTP master key (and other EKT Tag data
as per <span>[<a class="xref" href="#RFC8870">RFC8870</a>]</span>).<a class="pilcrow" href="#section-6.3-4">¶</a></p>
<p id="section-6.3-5">The KEK is not given to the Media Distributor.<a class="pilcrow" href="#section-6.3-5">¶</a></p>
</section>
</div>
<div id="endpoints-fabricate-an-srtp-master-key">
<section id="section-6.4">
        <h3 id="name-endpoints-fabricate-an-srtp">
<a class="section-number selfRef" href="#section-6.4">6.4. </a><a class="section-name selfRef" href="#name-endpoints-fabricate-an-srtp">Endpoints Fabricate an SRTP Master Key</a>
        </h3>
<p id="section-6.4-1">As stated earlier, the E2E key determined via DTLS-SRTP <span class="bcp14">MAY</span> be
discarded in favor of a locally generated E2E SRTP master key.  While the
DTLS-SRTP-derived SRTP master key can be used initially, the endpoint might
choose to change the SRTP master key periodically and <span class="bcp14">MUST</span> change the
SRTP master key as a result of the EKT Key changing.<a class="pilcrow" href="#section-6.4-1">¶</a></p>
<p id="section-6.4-2">A locally generated SRTP master key is used along with the master salt
transmitted to the endpoint from the Key Distributor via the EKTKey
message to encrypt media end to end.<a class="pilcrow" href="#section-6.4-2">¶</a></p>
<p id="section-6.4-3">Since the Media Distributor is not involved in E2E functions, it does not
create this key, nor does it have access to any endpoint's E2E key.  Note, too,
that even the Key Distributor is unaware of the locally generated E2E keys
used by each endpoint.<a class="pilcrow" href="#section-6.4-3">¶</a></p>
<p id="section-6.4-4">The endpoint transmits its E2E key to other endpoints in the conference
by periodically including it in SRTP packets in a Full EKT Tag.  When
placed in the Full EKT Tag, it is encrypted using the EKT Key provided
by the Key Distributor.  The master salt is not transmitted, though,
since all endpoints receive the same master salt via the EKTKey
message from the Key Distributor.  The recommended frequency with which an
endpoint transmits its SRTP master key is specified in
<span>[<a class="xref" href="#RFC8870">RFC8870</a>]</span>.<a class="pilcrow" href="#section-6.4-4">¶</a></p>
</section>
</div>
<div id="summary-of-key-types-and-entity-possession">
<section id="section-6.5">
        <h3 id="name-summary-of-key-types-and-en">
<a class="section-number selfRef" href="#section-6.5">6.5. </a><a class="section-name selfRef" href="#name-summary-of-key-types-and-en">Summary of Key Types and Entity Possession</a>
        </h3>
<p id="section-6.5-1">All endpoints have knowledge of the KEK.<a class="pilcrow" href="#section-6.5-1">¶</a></p>
<p id="section-6.5-2">Every HBH key is distinct for a given endpoint; thus, Endpoint A and
Endpoint B do not have knowledge of the other's HBH key.  Since HBH keys
are derived from a DTLS-SRTP association, there is at most one HBH key
per endpoint.  (The only exception is where the DTLS-SRTP association might
be rekeyed per <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc5764#section-5.2">Section 5.2</a> of [<a class="xref" href="#RFC5764">RFC5764</a>]</span> and a new key is created to
replace the former key.)<a class="pilcrow" href="#section-6.5-2">¶</a></p>
<p id="section-6.5-3">Each endpoint generates its own E2E key (SRTP master key); thus,
there is a distinct E2E key per endpoint.  This key is transmitted (encrypted) via
the Full EKT Tag to other endpoints.  Endpoints that receive media from
a given transmitting endpoint gain knowledge of the
transmitter's E2E key via the Full EKT Tag.<a class="pilcrow" href="#section-6.5-3">¶</a></p>
<p id="section-6.5-4"><a class="xref" href="#who-has-what-key-table">Table 2</a> summarizes
        the various keys and which entity is in possession of a given key.<a class="pilcrow" href="#section-6.5-4">¶</a></p>
<span id="name-key-types-and-entity-posses"></span><div id="who-has-what-key-table">
<table class="center" id="table-2">
          <caption>
<a class="selfRef" href="#table-2">Table 2</a>:
<a class="selfRef" href="#name-key-types-and-entity-posses">Key Types and Entity Possession</a>
          </caption>
<thead>
            <tr>
              <th class="text-center" colspan="1" rowspan="1">Key/Entity</th>
              <th class="text-center" colspan="1" rowspan="1">Endpoint A</th>
              <th class="text-center" colspan="1" rowspan="1">MD X</th>
              <th class="text-center" colspan="1" rowspan="1">MD Y</th>
              <th class="text-center" colspan="1" rowspan="1">Endpoint B</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">KEK (EKT Key)</td>
              <td class="text-center" colspan="1" rowspan="1">Yes</td>
              <td class="text-center" colspan="1" rowspan="1">No</td>
              <td class="text-center" colspan="1" rowspan="1">No</td>
              <td class="text-center" colspan="1" rowspan="1">Yes</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">E2E Key (A and B)</td>
              <td class="text-center" colspan="1" rowspan="1">Yes</td>
              <td class="text-center" colspan="1" rowspan="1">No</td>
              <td class="text-center" colspan="1" rowspan="1">No</td>
              <td class="text-center" colspan="1" rowspan="1">Yes</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">HBH Key (A&lt;=&gt;MD X)</td>
              <td class="text-center" colspan="1" rowspan="1">Yes</td>
              <td class="text-center" colspan="1" rowspan="1">Yes</td>
              <td class="text-center" colspan="1" rowspan="1">No</td>
              <td class="text-center" colspan="1" rowspan="1">No</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">HBH Key (B&lt;=&gt;MD Y)</td>
              <td class="text-center" colspan="1" rowspan="1">No</td>
              <td class="text-center" colspan="1" rowspan="1">No</td>
              <td class="text-center" colspan="1" rowspan="1">Yes</td>
              <td class="text-center" colspan="1" rowspan="1">Yes</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">HBH Key (MD X&lt;=&gt;MD Y)</td>
              <td class="text-center" colspan="1" rowspan="1">No</td>
              <td class="text-center" colspan="1" rowspan="1">Yes</td>
              <td class="text-center" colspan="1" rowspan="1">Yes</td>
              <td class="text-center" colspan="1" rowspan="1">No</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
</section>
</div>
<div id="packetformat">
<section id="section-7">
      <h2 id="name-encrypted-media-packet-form">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-encrypted-media-packet-form">Encrypted Media Packet Format</a>
      </h2>
<p id="section-7-1"><a class="xref" href="#fig-perc-packet-format">Figure 4</a> presents a complete picture of what an encrypted
media packet per this framework looks like when transmitted over the wire.
The packet format shown in the figure is encrypted using the double cryptographic transform
with an EKT Tag appended to the end.<a class="pilcrow" href="#section-7-1">¶</a></p>
<span id="name-encrypted-media-packet-forma"></span><div id="fig-perc-packet-format">
<figure id="figure-4">
        <div class="artwork art-text alignCenter" id="section-7-2.1">
<pre>     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+&lt;++
    |V=2|P|X|  CC   |M|     PT      |       sequence number         | IO
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ IO
    |                           timestamp                           | IO
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ IO
    |           synchronization source (SSRC) identifier            | IO
    +=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+ IO
    |            contributing source (CSRC) identifiers             | IO
    |                               ....                            | IO
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+&lt;+O
    |                    RTP extension (OPTIONAL) ...               | |O
+&gt;+&gt;+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+&lt;+O
O I |                          payload  ...                         | IO
O I |                               +-------------------------------+ IO
O I |                               | RTP padding   | RTP pad count | IO
O +&gt;+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+&lt;+O
O | |                    E2E authentication tag                     | |O
O | +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ |O
O | |                            OHB ...                            | |O
+&gt;| +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ |+
| | |                    HBH authentication tag                     | ||
| | +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ||
| | |   EKT Tag ...   | R                                             ||
| | +-+-+-+-+-+-+-+-+-+ |                                             ||
| |                     +- Neither encrypted nor authenticated;       ||
| |                        appended after the double transform        ||
| |                        is performed                               ||
| |                                                                   ||
| +- E2E-Encrypted Portion               E2E-Authenticated Portion ---+|
|                                                                      |
+--- HBH-Encrypted Portion               HBH-Authenticated Portion ----+

    I = Inner (E2E) encryption/authentication
    O = Outer (HBH) encryption/authentication</pre>
</div>
<figcaption><a class="selfRef" href="#figure-4">Figure 4</a>:
<a class="selfRef" href="#name-encrypted-media-packet-forma">Encrypted Media Packet Format</a>
        </figcaption></figure>
</div>
</section>
</div>
<div id="attacks">
<section id="section-8">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-8">8. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<div id="third-party-attacks">
<section id="section-8.1">
        <h3 id="name-third-party-attacks">
<a class="section-number selfRef" href="#section-8.1">8.1. </a><a class="section-name selfRef" href="#name-third-party-attacks">Third-Party Attacks</a>
        </h3>
<p id="section-8.1-1">Third-party attacks are attacks attempted by an adversary that is not
supposed to have access to keying material or is otherwise not an
authorized participant in the conference.<a class="pilcrow" href="#section-8.1-1">¶</a></p>
<p id="section-8.1-2">On-path attacks are mitigated by HBH integrity protection and
encryption.  The integrity protection mitigates packet modification.
Encryption makes selective blocking of packets harder, but not
impossible.<a class="pilcrow" href="#section-8.1-2">¶</a></p>
<p id="section-8.1-3">Off-path attackers could try connecting to different PERC entities to
send specifically crafted packets with an aim of forcing the receiver to
forward or render bogus media packets.  Endpoints and Media Distributors mitigate
such an attack by performing HBH authentication and discarding packets
that fail authentication.<a class="pilcrow" href="#section-8.1-3">¶</a></p>
<p id="section-8.1-4">Another attack vector is a third party claiming to be a Media
Distributor, fooling endpoints into sending packets to the false
Media Distributor instead of the correct one.  The deceived sending
endpoints could incorrectly assume that their packets have been delivered
to endpoints when they in fact have not.  While this attack is possible,
the result is a simple denial of service with no leakage of confidential
information, since the false Media Distributor would not have access
to either HBH or E2E encryption keys.<a class="pilcrow" href="#section-8.1-4">¶</a></p>
<p id="section-8.1-5">A third party could cause a denial of service by transmitting many bogus
or replayed packets toward receiving devices and ultimately degrading
conference or device performance.  Therefore, implementations might wish to
devise mechanisms to safeguard against such illegitimate packets, such as
utilizing rate-limiting or performing basic sanity checks on packets
(e.g., looking at packet length or expected sequence number ranges), before
performing decryption operations that are more expensive.<a class="pilcrow" href="#section-8.1-5">¶</a></p>
<p id="section-8.1-6">The use of mutual DTLS authentication (as required by DTLS-SRTP) also helps to
prevent a denial-of-service attack by preventing a false endpoint or false
Media Distributor from successfully participating as a perceived valid media
sender that could otherwise carry out an on-path attack.  When mutual
authentication fails, a receiving endpoint would know that it could safely
discard media packets received from the endpoint without inspection.<a class="pilcrow" href="#section-8.1-6">¶</a></p>
</section>
</div>
<div id="media-distributor-attacks">
<section id="section-8.2">
        <h3 id="name-media-distributor-attacks">
<a class="section-number selfRef" href="#section-8.2">8.2. </a><a class="section-name selfRef" href="#name-media-distributor-attacks">Media Distributor Attacks</a>
        </h3>
<p id="section-8.2-1">A malicious or compromised Media Distributor can attack the session in a
number of possible ways, as discussed below.<a class="pilcrow" href="#section-8.2-1">¶</a></p>
<div id="denial-of-service">
<section id="section-8.2.1">
          <h4 id="name-denial-of-service">
<a class="section-number selfRef" href="#section-8.2.1">8.2.1. </a><a class="section-name selfRef" href="#name-denial-of-service">Denial of Service</a>
          </h4>
<p id="section-8.2.1-1">A simple form of attack is discarding received packets that should be
forwarded.  This solution framework does not provide any mitigation
mechanisms for Media Distributors that fail to forward media packets.<a class="pilcrow" href="#section-8.2.1-1">¶</a></p>
<p id="section-8.2.1-2">Another form of attack is modifying received packets before forwarding.
With this solution framework, any modification of the E2E-authenticated data
results in the receiving endpoint getting an integrity failure when performing authentication on the received packet.<a class="pilcrow" href="#section-8.2.1-2">¶</a></p>
<p id="section-8.2.1-3">The Media Distributor can also attempt to perform resource consumption
attacks on the receiving endpoint.  One such attack would be to insert
random SSRC/CSRC values in any RTP packet along with a Full EKT Tag.  Since such a message would trigger the receiver to form a new cryptographic
context, the Media Distributor can attempt to consume the receiving
endpoint's resources.  While E2E authentication would fail and the
cryptographic context would be destroyed, the key derivation operation
would nonetheless consume some computational resources.  While resource
consumption attacks cannot be mitigated entirely, rate-limiting packets
might help reduce the impact of such attacks.<a class="pilcrow" href="#section-8.2.1-3">¶</a></p>
</section>
</div>
<div id="replay-attack">
<section id="section-8.2.2">
          <h4 id="name-replay-attacks">
<a class="section-number selfRef" href="#section-8.2.2">8.2.2. </a><a class="section-name selfRef" href="#name-replay-attacks">Replay Attacks</a>
          </h4>
<p id="section-8.2.2-1">A replay attack is an attack where an already-received packet from a previous
point in the RTP stream is replayed as a new packet.  This could, for
example, allow a Media Distributor to transmit a sequence of packets
identified as a user saying "yes", instead of the "no" the user
actually said.<a class="pilcrow" href="#section-8.2.2-1">¶</a></p>
<p id="section-8.2.2-2">A replay attack is mitigated by the requirement to implement
replay protection as
described in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc3711#section-3.3.2">Section 3.3.2</a> of [<a class="xref" href="#RFC3711">RFC3711</a>]</span>.
E2E replay protection <span class="bcp14">MUST</span> be provided for the
duration of the conference.<a class="pilcrow" href="#section-8.2.2-2">¶</a></p>
</section>
</div>
<div id="delayed-playout-attack">
<section id="section-8.2.3">
          <h4 id="name-delayed-playout-attacks">
<a class="section-number selfRef" href="#section-8.2.3">8.2.3. </a><a class="section-name selfRef" href="#name-delayed-playout-attacks">Delayed Playout Attacks</a>
          </h4>
<p id="section-8.2.3-1">A delayed playout attack is an attack where media is received and held by
a Media Distributor and then forwarded to endpoints at a later point
in time.<a class="pilcrow" href="#section-8.2.3-1">¶</a></p>
<p id="section-8.2.3-2">This attack is possible even if E2E replay protection is in place.
Because the Media Distributor is allowed to select a
subset of streams and not forward the rest to a receiver, such as in
forwarding only the most active speakers, the receiver has to accept
gaps in the E2E packet sequence.  The problem here is that a Media
Distributor can choose to not deliver a particular stream for a while.<a class="pilcrow" href="#section-8.2.3-2">¶</a></p>
<p id="section-8.2.3-3">While the Media Distributor can purposely stop forwarding media flows, it
can also select an arbitrary starting point to resume forwarding those
media flows, perhaps forwarding old packets rather than current packets.
As a consequence, what the media source sent can be substantially delayed
at the receiver with the receiver believing that newly arriving packets
are delayed only by transport delay when the packets may actually be
minutes or hours old.<a class="pilcrow" href="#section-8.2.3-3">¶</a></p>
<p id="section-8.2.3-4">While this attack cannot be eliminated entirely, its effectiveness
can be reduced by rekeying the conference periodically, since
significantly delayed media encrypted with expired keys would not be
decrypted by endpoints.<a class="pilcrow" href="#section-8.2.3-4">¶</a></p>
</section>
</div>
<div id="splicing-attack">
<section id="section-8.2.4">
          <h4 id="name-splicing-attacks">
<a class="section-number selfRef" href="#section-8.2.4">8.2.4. </a><a class="section-name selfRef" href="#name-splicing-attacks">Splicing Attacks</a>
          </h4>
<p id="section-8.2.4-1">A splicing attack is an attack where a Media Distributor receiving
multiple media sources splices one media stream into the other.  If
the Media Distributor were able to change the SSRC without the receiver
having any method for verifying the original source ID, then the Media
Distributor could first deliver stream A and then later forward stream
B under the same SSRC that stream A was previously using.  By including
the SSRC in the integrity check for each packet -- both HBH and E2E -- PERC
prevents splicing attacks.<a class="pilcrow" href="#section-8.2.4-1">¶</a></p>
</section>
</div>
<div id="rtcp-attacks">
<section id="section-8.2.5">
          <h4 id="name-rtcp-attacks">
<a class="section-number selfRef" href="#section-8.2.5">8.2.5. </a><a class="section-name selfRef" href="#name-rtcp-attacks">RTCP Attacks</a>
          </h4>
<p id="section-8.2.5-1">PERC does not provide E2E protection of RTCP messages.  This allows
a compromised Media Distributor to impact any message that might be
transmitted via RTCP, including media statistics, picture requests, or loss
indication.  It is also possible for a compromised Media Distributor to forge
requests, such as requests to the endpoint to send a new picture.  Such
requests can consume significant bandwidth and impair conference performance.<a class="pilcrow" href="#section-8.2.5-1">¶</a></p>
</section>
</div>
</section>
</div>
<div id="key-distributor-attacks">
<section id="section-8.3">
        <h3 id="name-key-distributor-attacks">
<a class="section-number selfRef" href="#section-8.3">8.3. </a><a class="section-name selfRef" href="#name-key-distributor-attacks">Key Distributor Attacks</a>
        </h3>
<p id="section-8.3-1">As stated in <a class="xref" href="#key_distributor">Section 3.2.2</a>, the Key Distributor needs to be secured,
since exploiting the Key Server can allow an adversary to gain access to
the keying material for one or more conferences.  Having access to that
keying material would then allow the adversary to decrypt media sent from
any endpoint in the conference.<a class="pilcrow" href="#section-8.3-1">¶</a></p>
<p id="section-8.3-2">As a first line of defense, the Key Distributor authenticates every
security association -- associations with both endpoints and Media
Distributors.  The Key Distributor knows which entities are authorized to
have access to which keys, and inspection of certificates will substantially
reduce the risk of providing keys to an adversary.<a class="pilcrow" href="#section-8.3-2">¶</a></p>
<p id="section-8.3-3">Both physical and network access to the Key Distributor should be severely
restricted.  This may be more difficult to achieve when the Key Distributor
is embedded within, for example, an endpoint.  Nonetheless, consideration
should be given to shielding the Key Distributor from unauthorized access
or any access that is not strictly necessary for the support of an
ongoing conference.<a class="pilcrow" href="#section-8.3-3">¶</a></p>
<p id="section-8.3-4">Consideration should be given to whether access to the keying material
will be needed beyond the conclusion of a conference.  If not needed,
the Key Distributor's policy should be to destroy the keying material
once the conference concludes or when keying material changes during
the course of the conference.  If keying material is needed beyond the
lifetime of the conference, further consideration should be given to
protecting keying material from future exposure.  While it might seem
obvious, it is worth making this point, to avoid any doubt that if an adversary were
to record the media packets transmitted during a conference and then
gain unauthorized access to the keying material left unsecured on the
Key Distributor even years later, the adversary could decrypt the
content of every packet transmitted during the conference.<a class="pilcrow" href="#section-8.3-4">¶</a></p>
</section>
</div>
<div id="endpoint-attacks">
<section id="section-8.4">
        <h3 id="name-endpoint-attacks">
<a class="section-number selfRef" href="#section-8.4">8.4. </a><a class="section-name selfRef" href="#name-endpoint-attacks">Endpoint Attacks</a>
        </h3>
<p id="section-8.4-1">A Trusted Endpoint is so named because conference confidentiality relies
heavily on the security and integrity of the endpoint.  If an adversary
successfully exploits a vulnerability in an endpoint, it might be possible
for the adversary to obtain all of the keying material used in the
conference.  With that keying material, an adversary could decrypt any
of the media flows received from any other endpoint, either in real time
or at a later point in time (assuming that the adversary makes a copy of the
media packets).<a class="pilcrow" href="#section-8.4-1">¶</a></p>
<p id="section-8.4-2">Additionally, if an adversary successfully exploits an endpoint, the
adversary could inject media into the conference. For example, an adversary
could manipulate the RTP or SRTP software to transmit
whatever media the adversary wishes to send. 
This could involve the reuse of the compromised endpoint's SSRC or,
since all conference participants share the same KEK,
the use of a new SSRC or the SSRC value of another endpoint.
Only a single SRTP cipher suite defined provides source
authentication properties that allow an endpoint to cryptographically
assert that it sent a particular E2E-protected packet (namely, Timed Efficient
Stream Loss-Tolerant Authentication (TESLA)
<span>[<a class="xref" href="#RFC4383">RFC4383</a>]</span>), and its usage is presently not
defined for PERC.  The suite
defined in PERC only allows an endpoint to determine that whoever sent a
packet had received the KEK.<a class="pilcrow" href="#section-8.4-2">¶</a></p>
<p id="section-8.4-3">However, attacks on the endpoint are not limited to the PERC-specific
software within the endpoint.  An attacker could inject media or record
media by manipulating the software that sits between the PERC-enabled
application and the hardware microphone of a video camera, for example.
Likewise, an attacker could potentially access confidential media by
accessing memory, cache, disk storage, etc. if the endpoint is not secured.<a class="pilcrow" href="#section-8.4-3">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-9">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-9">9. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<p id="section-9-1">This document has no IANA actions.<a class="pilcrow" href="#section-9-1">¶</a></p>
</section>
</div>
<section id="section-10">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-10">10. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-10.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-10.1">10.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time class="refDate" datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3550">[RFC3550]</dt>
        <dd>
<span class="refAuthor">Schulzrinne, H.</span><span class="refAuthor">, Casner, S.</span><span class="refAuthor">, Frederick, R.</span><span class="refAuthor">, and V. Jacobson</span>, <span class="refTitle">"RTP: A Transport Protocol for Real-Time Applications"</span>, <span class="seriesInfo">STD 64</span>, <span class="seriesInfo">RFC 3550</span>, <span class="seriesInfo">DOI 10.17487/RFC3550</span>, <time class="refDate" datetime="2003-07">July 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3550">https://www.rfc-editor.org/info/rfc3550</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3711">[RFC3711]</dt>
        <dd>
<span class="refAuthor">Baugher, M.</span><span class="refAuthor">, McGrew, D.</span><span class="refAuthor">, Naslund, M.</span><span class="refAuthor">, Carrara, E.</span><span class="refAuthor">, and K. Norrman</span>, <span class="refTitle">"The Secure Real-time Transport Protocol (SRTP)"</span>, <span class="seriesInfo">RFC 3711</span>, <span class="seriesInfo">DOI 10.17487/RFC3711</span>, <time class="refDate" datetime="2004-03">March 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3711">https://www.rfc-editor.org/info/rfc3711</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6904">[RFC6904]</dt>
        <dd>
<span class="refAuthor">Lennox, J.</span>, <span class="refTitle">"Encryption of Header Extensions in the Secure Real-time Transport Protocol (SRTP)"</span>, <span class="seriesInfo">RFC 6904</span>, <span class="seriesInfo">DOI 10.17487/RFC6904</span>, <time class="refDate" datetime="2013-04">April 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6904">https://www.rfc-editor.org/info/rfc6904</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time class="refDate" datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8723">[RFC8723]</dt>
        <dd>
<span class="refAuthor">Jennings, C.</span><span class="refAuthor">, Jones, P.</span><span class="refAuthor">, Barnes, R.</span><span class="refAuthor">, and A.B. Roach</span>, <span class="refTitle">"Double Encryption Procedures for the Secure Real-Time Transport Protocol (SRTP)"</span>, <span class="seriesInfo">RFC 8723</span>, <span class="seriesInfo">DOI 10.17487/RFC8723</span>, <time class="refDate" datetime="2020-04">April 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8723">https://www.rfc-editor.org/info/rfc8723</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8870">[RFC8870]</dt>
      <dd>
<span class="refAuthor">Jennings, C.</span><span class="refAuthor">, Mattsson, J.</span><span class="refAuthor">, McGrew, D.</span><span class="refAuthor">, Wing, D.</span><span class="refAuthor">, and F. Andreasen</span>, <span class="refTitle">"Encrypted Key Transport for DTLS and Secure RTP"</span>, <span class="seriesInfo">RFC 8870</span>, <span class="seriesInfo">DOI 10.17487/RFC8870</span>, <time class="refDate" datetime="2021-01">January 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8870">https://www.rfc-editor.org/info/rfc8870</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-10.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-10.2">10.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-perc-dtls-tunnel">[PERC-DTLS]</dt>
        <dd>
<span class="refAuthor">Jones, P. E.</span><span class="refAuthor">, Ellenbogen, P. M.</span><span class="refAuthor">, and N. H. Ohlmeier</span>, <span class="refTitle">"DTLS Tunnel between a Media Distributor and Key Distributor to Facilitate Key Exchange"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-perc-dtls-tunnel-06</span>, <time class="refDate" datetime="2019-10-16">16 October 2019</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-perc-dtls-tunnel-06">https://tools.ietf.org/html/draft-ietf-perc-dtls-tunnel-06</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3261">[RFC3261]</dt>
        <dd>
<span class="refAuthor">Rosenberg, J.</span><span class="refAuthor">, Schulzrinne, H.</span><span class="refAuthor">, Camarillo, G.</span><span class="refAuthor">, Johnston, A.</span><span class="refAuthor">, Peterson, J.</span><span class="refAuthor">, Sparks, R.</span><span class="refAuthor">, Handley, M.</span><span class="refAuthor">, and E. Schooler</span>, <span class="refTitle">"SIP: Session Initiation Protocol"</span>, <span class="seriesInfo">RFC 3261</span>, <span class="seriesInfo">DOI 10.17487/RFC3261</span>, <time class="refDate" datetime="2002-06">June 2002</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3261">https://www.rfc-editor.org/info/rfc3261</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4353">[RFC4353]</dt>
        <dd>
<span class="refAuthor">Rosenberg, J.</span>, <span class="refTitle">"A Framework for Conferencing with the Session Initiation Protocol (SIP)"</span>, <span class="seriesInfo">RFC 4353</span>, <span class="seriesInfo">DOI 10.17487/RFC4353</span>, <time class="refDate" datetime="2006-02">February 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4353">https://www.rfc-editor.org/info/rfc4353</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4383">[RFC4383]</dt>
        <dd>
<span class="refAuthor">Baugher, M.</span><span class="refAuthor"> and E. Carrara</span>, <span class="refTitle">"The Use of Timed Efficient Stream Loss-Tolerant Authentication (TESLA) in the Secure Real-time Transport Protocol (SRTP)"</span>, <span class="seriesInfo">RFC 4383</span>, <span class="seriesInfo">DOI 10.17487/RFC4383</span>, <time class="refDate" datetime="2006-02">February 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4383">https://www.rfc-editor.org/info/rfc4383</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4566">[RFC4566]</dt>
        <dd>
<span class="refAuthor">Handley, M.</span><span class="refAuthor">, Jacobson, V.</span><span class="refAuthor">, and C. Perkins</span>, <span class="refTitle">"SDP: Session Description Protocol"</span>, <span class="seriesInfo">RFC 4566</span>, <span class="seriesInfo">DOI 10.17487/RFC4566</span>, <time class="refDate" datetime="2006-07">July 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4566">https://www.rfc-editor.org/info/rfc4566</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5763">[RFC5763]</dt>
        <dd>
<span class="refAuthor">Fischl, J.</span><span class="refAuthor">, Tschofenig, H.</span><span class="refAuthor">, and E. Rescorla</span>, <span class="refTitle">"Framework for Establishing a Secure Real-time Transport Protocol (SRTP) Security Context Using Datagram Transport Layer Security (DTLS)"</span>, <span class="seriesInfo">RFC 5763</span>, <span class="seriesInfo">DOI 10.17487/RFC5763</span>, <time class="refDate" datetime="2010-05">May 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5763">https://www.rfc-editor.org/info/rfc5763</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5764">[RFC5764]</dt>
        <dd>
<span class="refAuthor">McGrew, D.</span><span class="refAuthor"> and E. Rescorla</span>, <span class="refTitle">"Datagram Transport Layer Security (DTLS) Extension to Establish Keys for the Secure Real-time Transport Protocol (SRTP)"</span>, <span class="seriesInfo">RFC 5764</span>, <span class="seriesInfo">DOI 10.17487/RFC5764</span>, <time class="refDate" datetime="2010-05">May 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5764">https://www.rfc-editor.org/info/rfc5764</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6464">[RFC6464]</dt>
        <dd>
<span class="refAuthor">Lennox, J., Ed.</span><span class="refAuthor">, Ivov, E.</span><span class="refAuthor">, and E. Marocco</span>, <span class="refTitle">"A Real-time Transport Protocol (RTP) Header Extension for Client-to-Mixer Audio Level Indication"</span>, <span class="seriesInfo">RFC 6464</span>, <span class="seriesInfo">DOI 10.17487/RFC6464</span>, <time class="refDate" datetime="2011-12">December 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6464">https://www.rfc-editor.org/info/rfc6464</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7667">[RFC7667]</dt>
        <dd>
<span class="refAuthor">Westerlund, M.</span><span class="refAuthor"> and S. Wenger</span>, <span class="refTitle">"RTP Topologies"</span>, <span class="seriesInfo">RFC 7667</span>, <span class="seriesInfo">DOI 10.17487/RFC7667</span>, <time class="refDate" datetime="2015-11">November 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7667">https://www.rfc-editor.org/info/rfc7667</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8224">[RFC8224]</dt>
        <dd>
<span class="refAuthor">Peterson, J.</span><span class="refAuthor">, Jennings, C.</span><span class="refAuthor">, Rescorla, E.</span><span class="refAuthor">, and C. Wendt</span>, <span class="refTitle">"Authenticated Identity Management in the Session Initiation Protocol (SIP)"</span>, <span class="seriesInfo">RFC 8224</span>, <span class="seriesInfo">DOI 10.17487/RFC8224</span>, <time class="refDate" datetime="2018-02">February 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8224">https://www.rfc-editor.org/info/rfc8224</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8827">[RFC8827]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"WebRTC Security Architecture"</span>, <span class="seriesInfo">RFC 8827</span>, <span class="seriesInfo">DOI 10.17487/RFC8827</span>, <time class="refDate" datetime="2021-01">January 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8827">https://www.rfc-editor.org/info/rfc8827</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="W3C.CR-webrtc">[W3C.CR-webrtc]</dt>
      <dd>
<span class="refAuthor">Jennings, C.</span><span class="refAuthor">, Boström, H.</span><span class="refAuthor">, and J-I. Bruaroey</span>, <span class="refTitle">"WebRTC 1.0: Real-time Communication Between Browsers"</span>, <span class="refContent">W3C Proposed Recommendation</span>, <span>&lt;<a href="https://www.w3.org/TR/webrtc/">https://www.w3.org/TR/webrtc/</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="acknowledgments">
<section id="section-appendix.a">
      <h2 id="name-acknowledgments">
<a class="section-name selfRef" href="#name-acknowledgments">Acknowledgments</a>
      </h2>
<p id="section-appendix.a-1">The authors would like to thank <span class="contact-name">Mo Zanaty</span>,
      <span class="contact-name">Christian Oien</span>, and <span class="contact-name">Richard       Barnes</span> for invaluable input on this document.  Also, we would like to
      acknowledge <span class="contact-name">Nermeen Ismail</span> for serving on the
      initial draft versions of this document as a coauthor.  We would also
      like to acknowledge <span class="contact-name">John Mattsson</span>, <span class="contact-name">Mats Naslund</span>, and <span class="contact-name">Magnus Westerlund</span>
      for providing some of the text in the document, including much of the
      original text in the Security Considerations section (<a class="xref" href="#attacks">Section 8</a>).<a class="pilcrow" href="#section-appendix.a-1">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="section-appendix.b">
      <h2 id="name-authors-addresses">
<a class="section-name selfRef" href="#name-authors-addresses">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Paul E. Jones</span></div>
<div class="left" dir="auto"><span class="org">Cisco</span></div>
<div class="left" dir="auto"><span class="street-address">7025 Kit Creek Rd.</span></div>
<div class="left" dir="auto">
<span class="locality">Research Triangle Park</span>, <span class="region">North Carolina</span> <span class="postal-code">27709</span>
</div>
<div class="left" dir="auto"><span class="country-name">United States of America</span></div>
<div class="tel">
<span>Phone:</span>
<a class="tel" href="tel:+1%20919%20476%202048">+1 919 476 2048</a>
</div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:paulej@packetizer.com">paulej@packetizer.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">David Benham</span></div>
<div class="left" dir="auto"><span class="org">Independent</span></div>
<div class="left" dir="auto">
<span class="region">California</span> </div>
<div class="left" dir="auto"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:dabenham@gmail.com">dabenham@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Christian Groves</span></div>
<div class="left" dir="auto"><span class="org">Independent</span></div>
<div class="left" dir="auto">
<span class="locality">Melbourne</span>  </div>
<div class="left" dir="auto"><span class="country-name">Australia</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:cngroves.std@gmail.com">cngroves.std@gmail.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>