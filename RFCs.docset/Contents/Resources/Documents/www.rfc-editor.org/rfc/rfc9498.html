<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 9498: The GNU Name System</title>
<meta content="Martin Schanzenbach" name="author"/>
<meta content="Christian Grothoff" name="author"/>
<meta content="Bernd Fix" name="author"/>
<meta content="
       
      This document provides the GNU Name System (GNS) technical
      specification.
      GNS is a decentralized and censorship-resistant domain name
      resolution protocol that provides a privacy-enhancing alternative to the
      Domain Name System (DNS) protocols.
       
       
      This document defines the normative wire format of resource records,
      resolution processes, cryptographic routines, and security and privacy
      considerations for use by implementers.
       
       
      This specification was developed outside the IETF and does not have
      IETF consensus.  It is published here to inform readers about the
      function of GNS, guide future GNS implementations, and ensure
      interoperability among implementations (for example, pre-existing
      GNUnet implementations).
       
    " name="description"/>
<meta content="xml2rfc 3.18.2" name="generator"/>
<meta content="name systems" name="keyword"/>
<meta content="9498" name="rfc.number"/>
<!-- Generator version information:
  xml2rfc 3.18.2
    Python 3.9.15
    ConfigArgParse 1.5.3
    google-i18n-address 3.0.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.0
    platformdirs 3.8.0
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.28.0
    setuptools 44.1.1
    six 1.16.0
    wcwidth 0.2.5
    weasyprint 56.1
-->
<link href="rfc9498.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
  overflow-wrap: break-word;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef,
.iref + a[href].internal {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
blockquote > *:last-child {
  margin-bottom: 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://datatracker.ietf.org/doc/draft-schanzen-gns-28" rel="prev"/>
  <link href="https://dx.doi.org/10.17487/rfc9498" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  </head>
<body class="xml2rfc">
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9498</td>
<td class="center">The GNU Name System</td>
<td class="right">November 2023</td>
</tr></thead>
<tfoot><tr>
<td class="left">Schanzenbach, et al.</td>
<td class="center">Informational</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Independent Submission</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc9498">9498</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Informational</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2023-11">November 2023</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">M. Schanzenbach</div>
<div class="org">Fraunhofer AISEC</div>
</div>
<div class="author">
      <div class="author-name">C. Grothoff</div>
<div class="org">Berner Fachhochschule</div>
</div>
<div class="author">
      <div class="author-name">B. Fix</div>
<div class="org">GNUnet e.V.</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9498</h1>
<h1 id="title">The GNU Name System</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">
      This document provides the GNU Name System (GNS) technical
      specification.
      GNS is a decentralized and censorship-resistant domain name
      resolution protocol that provides a privacy-enhancing alternative to the
      Domain Name System (DNS) protocols.<a class="pilcrow" href="#section-abstract-1">¶</a></p>
<p id="section-abstract-2">
      This document defines the normative wire format of resource records,
      resolution processes, cryptographic routines, and security and privacy
      considerations for use by implementers.<a class="pilcrow" href="#section-abstract-2">¶</a></p>
<p id="section-abstract-3">
      This specification was developed outside the IETF and does not have
      IETF consensus.  It is published here to inform readers about the
      function of GNS, guide future GNS implementations, and ensure
      interoperability among implementations (for example, pre-existing
      GNUnet implementations).<a class="pilcrow" href="#section-abstract-3">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This document is not an Internet Standards Track specification; it is
            published for informational purposes.<a class="pilcrow" href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
            This is a contribution to the RFC Series, independently of any
            other RFC stream.  The RFC Editor has chosen to publish this
            document at its discretion and makes no statement about its value
            for implementation or deployment.  Documents approved for
            publication by the RFC Editor are not candidates for any level of
            Internet Standard; see Section 2 of RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9498">https://www.rfc-editor.org/info/rfc9498</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2023 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document.<a class="pilcrow" href="#section-boilerplate.2-2">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">▲</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p class="keepWithNext" id="section-toc.1-1.1.1"><a class="auto internal xref" href="#section-1">1</a>.  <a class="internal xref" href="#name-introduction">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p class="keepWithNext" id="section-toc.1-1.1.2.1.1"><a class="auto internal xref" href="#section-1.1">1.1</a>.  <a class="internal xref" href="#name-requirements-notation">Requirements Notation</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p class="keepWithNext" id="section-toc.1-1.2.1"><a class="auto internal xref" href="#section-2">2</a>.  <a class="internal xref" href="#name-terminology">Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a class="auto internal xref" href="#section-3">3</a>.  <a class="internal xref" href="#name-overview">Overview</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a class="auto internal xref" href="#section-3.1">3.1</a>.  <a class="internal xref" href="#name-names-and-zones">Names and Zones</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a class="auto internal xref" href="#section-3.2">3.2</a>.  <a class="internal xref" href="#name-publishing-binding-informat">Publishing Binding Information</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a class="auto internal xref" href="#section-3.3">3.3</a>.  <a class="internal xref" href="#name-resolving-names">Resolving Names</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="auto internal xref" href="#section-4">4</a>.  <a class="internal xref" href="#name-zones">Zones</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a class="auto internal xref" href="#section-4.1">4.1</a>.  <a class="internal xref" href="#name-zone-top-level-domain-ztld">Zone Top-Level Domain (zTLD)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a class="auto internal xref" href="#section-4.2">4.2</a>.  <a class="internal xref" href="#name-zone-revocation">Zone Revocation</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="auto internal xref" href="#section-5">5</a>.  <a class="internal xref" href="#name-resource-records">Resource Records</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a class="auto internal xref" href="#section-5.1">5.1</a>.  <a class="internal xref" href="#name-zone-delegation-records">Zone Delegation Records</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.1">
                    <p id="section-toc.1-1.5.2.1.2.1.1"><a class="auto internal xref" href="#section-5.1.1">5.1.1</a>.  <a class="internal xref" href="#name-pkey">PKEY</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.2">
                    <p id="section-toc.1-1.5.2.1.2.2.1"><a class="auto internal xref" href="#section-5.1.2">5.1.2</a>.  <a class="internal xref" href="#name-edkey">EDKEY</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a class="auto internal xref" href="#section-5.2">5.2</a>.  <a class="internal xref" href="#name-redirection-records">Redirection Records</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1">
                    <p id="section-toc.1-1.5.2.2.2.1.1"><a class="auto internal xref" href="#section-5.2.1">5.2.1</a>.  <a class="internal xref" href="#name-redirect">REDIRECT</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.2">
                    <p id="section-toc.1-1.5.2.2.2.2.1"><a class="auto internal xref" href="#section-5.2.2">5.2.2</a>.  <a class="internal xref" href="#name-gns2dns">GNS2DNS</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a class="auto internal xref" href="#section-5.3">5.3</a>.  <a class="internal xref" href="#name-auxiliary-records">Auxiliary Records</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.1">
                    <p id="section-toc.1-1.5.2.3.2.1.1"><a class="auto internal xref" href="#section-5.3.1">5.3.1</a>.  <a class="internal xref" href="#name-leho">LEHO</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.2">
                    <p id="section-toc.1-1.5.2.3.2.2.1"><a class="auto internal xref" href="#section-5.3.2">5.3.2</a>.  <a class="internal xref" href="#name-nick">NICK</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.3">
                    <p id="section-toc.1-1.5.2.3.2.3.1"><a class="auto internal xref" href="#section-5.3.3">5.3.3</a>.  <a class="internal xref" href="#name-box">BOX</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="auto internal xref" href="#section-6">6</a>.  <a class="internal xref" href="#name-record-encoding-for-remote-">Record Encoding for Remote Storage</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a class="auto internal xref" href="#section-6.1">6.1</a>.  <a class="internal xref" href="#name-the-storage-key">The Storage Key</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a class="auto internal xref" href="#section-6.2">6.2</a>.  <a class="internal xref" href="#name-plaintext-record-data-rdata">Plaintext Record Data (RDATA)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a class="auto internal xref" href="#section-6.3">6.3</a>.  <a class="internal xref" href="#name-the-resource-record-block">The Resource Record Block</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="auto internal xref" href="#section-7">7</a>.  <a class="internal xref" href="#name-name-resolution">Name Resolution</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a class="auto internal xref" href="#section-7.1">7.1</a>.  <a class="internal xref" href="#name-start-zones">Start Zones</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a class="auto internal xref" href="#section-7.2">7.2</a>.  <a class="internal xref" href="#name-recursion">Recursion</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a class="auto internal xref" href="#section-7.3">7.3</a>.  <a class="internal xref" href="#name-record-processing">Record Processing</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.1">
                    <p id="section-toc.1-1.7.2.3.2.1.1"><a class="auto internal xref" href="#section-7.3.1">7.3.1</a>.  <a class="internal xref" href="#name-redirect-2">REDIRECT</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.2">
                    <p id="section-toc.1-1.7.2.3.2.2.1"><a class="auto internal xref" href="#section-7.3.2">7.3.2</a>.  <a class="internal xref" href="#name-gns2dns-2">GNS2DNS</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.3">
                    <p id="section-toc.1-1.7.2.3.2.3.1"><a class="auto internal xref" href="#section-7.3.3">7.3.3</a>.  <a class="internal xref" href="#name-box-2">BOX</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.4">
                    <p id="section-toc.1-1.7.2.3.2.4.1"><a class="auto internal xref" href="#section-7.3.4">7.3.4</a>.  <a class="internal xref" href="#name-zone-delegation-records-2">Zone Delegation Records</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.5">
                    <p id="section-toc.1-1.7.2.3.2.5.1"><a class="auto internal xref" href="#section-7.3.5">7.3.5</a>.  <a class="internal xref" href="#name-nick-2">NICK</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="auto internal xref" href="#section-8">8</a>.  <a class="internal xref" href="#name-internationalization-and-ch">Internationalization and Character Encoding</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="auto internal xref" href="#section-9">9</a>.  <a class="internal xref" href="#name-security-and-privacy-consid">Security and Privacy Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a class="auto internal xref" href="#section-9.1">9.1</a>.  <a class="internal xref" href="#name-availability">Availability</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a class="auto internal xref" href="#section-9.2">9.2</a>.  <a class="internal xref" href="#name-agility">Agility</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a class="auto internal xref" href="#section-9.3">9.3</a>.  <a class="internal xref" href="#name-cryptography">Cryptography</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4">
                <p id="section-toc.1-1.9.2.4.1"><a class="auto internal xref" href="#section-9.4">9.4</a>.  <a class="internal xref" href="#name-abuse-mitigation">Abuse Mitigation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.5">
                <p id="section-toc.1-1.9.2.5.1"><a class="auto internal xref" href="#section-9.5">9.5</a>.  <a class="internal xref" href="#name-zone-management">Zone Management</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.6">
                <p id="section-toc.1-1.9.2.6.1"><a class="auto internal xref" href="#section-9.6">9.6</a>.  <a class="internal xref" href="#name-dhts-as-remote-storage">DHTs as Remote Storage</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.7">
                <p id="section-toc.1-1.9.2.7.1"><a class="auto internal xref" href="#section-9.7">9.7</a>.  <a class="internal xref" href="#name-revocations">Revocations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.8">
                <p id="section-toc.1-1.9.2.8.1"><a class="auto internal xref" href="#section-9.8">9.8</a>.  <a class="internal xref" href="#name-zone-privacy">Zone Privacy</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.9">
                <p id="section-toc.1-1.9.2.9.1"><a class="auto internal xref" href="#section-9.9">9.9</a>.  <a class="internal xref" href="#name-zone-governance">Zone Governance</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.10">
                <p id="section-toc.1-1.9.2.10.1"><a class="auto internal xref" href="#section-9.10">9.10</a>. <a class="internal xref" href="#name-namespace-ambiguity">Namespace Ambiguity</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a class="auto internal xref" href="#section-10">10</a>. <a class="internal xref" href="#name-gana-considerations">GANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a class="auto internal xref" href="#section-10.1">10.1</a>.  <a class="internal xref" href="#name-gnunet-signature-purposes-r">GNUnet Signature Purposes Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a class="auto internal xref" href="#section-10.2">10.2</a>.  <a class="internal xref" href="#name-gns-record-types-registry">GNS Record Types Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3">
                <p id="section-toc.1-1.10.2.3.1"><a class="auto internal xref" href="#section-10.3">10.3</a>.  <a class="internal xref" href="#name-alt-subdomains-registry">.alt Subdomains Registry</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a class="auto internal xref" href="#section-11">11</a>. <a class="internal xref" href="#name-iana-considerations">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a class="auto internal xref" href="#section-12">12</a>. <a class="internal xref" href="#name-implementation-and-deployme">Implementation and Deployment Status</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a class="auto internal xref" href="#section-13">13</a>. <a class="internal xref" href="#name-references">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a class="auto internal xref" href="#section-13.1">13.1</a>.  <a class="internal xref" href="#name-normative-references">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a class="auto internal xref" href="#section-13.2">13.2</a>.  <a class="internal xref" href="#name-informative-references">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a class="auto internal xref" href="#appendix-A">Appendix A</a>.  <a class="internal xref" href="#name-usage-and-migration">Usage and Migration</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.1">
                <p id="section-toc.1-1.14.2.1.1"><a class="auto internal xref" href="#appendix-A.1">A.1</a>.  <a class="internal xref" href="#name-zone-dissemination">Zone Dissemination</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.2">
                <p id="section-toc.1-1.14.2.2.1"><a class="auto internal xref" href="#appendix-A.2">A.2</a>.  <a class="internal xref" href="#name-start-zone-configuration">Start Zone Configuration</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.3">
                <p id="section-toc.1-1.14.2.3.1"><a class="auto internal xref" href="#appendix-A.3">A.3</a>.  <a class="internal xref" href="#name-globally-unique-names-and-t">Globally Unique Names and the Web</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.4">
                <p id="section-toc.1-1.14.2.4.1"><a class="auto internal xref" href="#appendix-A.4">A.4</a>.  <a class="internal xref" href="#name-migration-paths">Migration Paths</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a class="auto internal xref" href="#appendix-B">Appendix B</a>.  <a class="internal xref" href="#name-example-flows">Example Flows</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.1">
                <p id="section-toc.1-1.15.2.1.1"><a class="auto internal xref" href="#appendix-B.1">B.1</a>.  <a class="internal xref" href="#name-aaaa-example-resolution">AAAA Example Resolution</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.2">
                <p id="section-toc.1-1.15.2.2.1"><a class="auto internal xref" href="#appendix-B.2">B.2</a>.  <a class="internal xref" href="#name-redirect-example-resolution">REDIRECT Example Resolution</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.3">
                <p id="section-toc.1-1.15.2.3.1"><a class="auto internal xref" href="#appendix-B.3">B.3</a>.  <a class="internal xref" href="#name-gns2dns-example-resolution">GNS2DNS Example Resolution</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a class="auto internal xref" href="#appendix-C">Appendix C</a>.  <a class="internal xref" href="#name-base32gns">Base32GNS</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a class="auto internal xref" href="#appendix-D">Appendix D</a>.  <a class="internal xref" href="#name-test-vectors">Test Vectors</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.1">
                <p id="section-toc.1-1.17.2.1.1"><a class="auto internal xref" href="#appendix-D.1">D.1</a>.  <a class="internal xref" href="#name-base32gns-encoding-decoding">Base32GNS Encoding/Decoding</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.2">
                <p id="section-toc.1-1.17.2.2.1"><a class="auto internal xref" href="#appendix-D.2">D.2</a>.  <a class="internal xref" href="#name-record-sets">Record Sets</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.3">
                <p id="section-toc.1-1.17.2.3.1"><a class="auto internal xref" href="#appendix-D.3">D.3</a>.  <a class="internal xref" href="#name-zone-revocation-2">Zone Revocation</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18">
            <p id="section-toc.1-1.18.1"><a class="auto internal xref" href="#appendix-E"></a><a class="internal xref" href="#name-acknowledgements">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19">
            <p id="section-toc.1-1.19.1"><a class="auto internal xref" href="#appendix-F"></a><a class="internal xref" href="#name-authors-addresses">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">
       This specification describes the GNU Name System (GNS), a
       censorship-resistant, privacy-preserving, and decentralized
       domain name resolution protocol.  GNS cryptographically secures
       the binding of names to arbitrary tokens, enabling it to double
       in some respects as an alternative to some of today's public
       key infrastructures.<a class="pilcrow" href="#section-1-1">¶</a></p>
<p id="section-1-2">
       Per Domain Name System (DNS) terminology <span>[<a class="cite xref" href="#RFC1035">RFC1035</a>]</span>, GNS roughly follows the idea of a local
       root zone deployment (see <span>[<a class="cite xref" href="#RFC8806">RFC8806</a>]</span>), with the
       difference that the design encourages alternative roots and
       does not expect all deployments to use the same or any specific
       root zone.  In the GNS reference implementation, users can
       autonomously and freely delegate control of names to zones
       through their local configurations.
       GNS expects each user to be in control of their setup.
       By following the guidelines in <a class="auto internal xref" href="#namespace_ambiguity">Section 9.10</a>,
       users should manage to avoid any confusion as to how names are
       resolved.<a class="pilcrow" href="#section-1-2">¶</a></p>
<p id="section-1-3">
       Name resolution and zone dissemination are based on the
       principle of a petname system where users can assign local
       names to zones.  The GNS has its roots in ideas from the Simple
       Distributed Security Infrastructure <span>[<a class="cite xref" href="#SDSI">SDSI</a>]</span>,
       enabling the decentralized mapping of secure identifiers to
       memorable names.  One of the first academic descriptions of the
       cryptographic ideas behind GNS can be found in <span>[<a class="cite xref" href="#GNS">GNS</a>]</span>.<a class="pilcrow" href="#section-1-3">¶</a></p>
<p id="section-1-4">
       This document defines the normative wire format of resource
       records, resolution processes, cryptographic routines, and
       security and privacy considerations for use by implementers.<a class="pilcrow" href="#section-1-4">¶</a></p>
<section id="section-1.1">
        <h3 id="name-requirements-notation">
<a class="section-number selfRef" href="#section-1.1">1.1. </a><a class="section-name selfRef" href="#name-requirements-notation">Requirements Notation</a>
        </h3>
<p id="section-1.1-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>",
         "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>",
         "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>",
         "<span class="bcp14">SHOULD NOT</span>",
         "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
         "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document
         are to be interpreted as described in BCP 14
         <span>[<a class="cite xref" href="#RFC2119">RFC2119</a>]</span> <span>[<a class="cite xref" href="#RFC8174">RFC8174</a>]</span> when, and only
         when, they appear in all capitals, as shown here.<a class="pilcrow" href="#section-1.1-1">¶</a></p>
</section>
</section>
</div>
<section id="section-2">
      <h2 id="name-terminology">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-terminology">Terminology</a>
      </h2>
<span class="break"></span><dl class="dlParallel" id="section-2-1">
        <dt id="section-2-1.1">Apex Label:</dt>
        <dd id="section-2-1.2" style="margin-left: 1.5em">
         This type of label is used to publish resource
         records in a zone that can be resolved without providing a specific
         label. It is the GNS method for providing what is called the "zone apex" in DNS
         <span>[<a class="cite xref" href="#RFC4033">RFC4033</a>]</span>.
         The apex label is represented using the character U+0040 ("@" without the quotes).<a class="pilcrow" href="#section-2-1.2">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.3">Application:</dt>
        <dd id="section-2-1.4" style="margin-left: 1.5em">
         An application is a component that uses a GNS implementation
         to resolve names into records and processes its contents.<a class="pilcrow" href="#section-2-1.4">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.5">Blinded Zone Key:</dt>
        <dd id="section-2-1.6" style="margin-left: 1.5em">
         A blinded zone key is a key derived from a zone key and a label.
         The zone key and any blinded zone key derived from it are unlinkable
         without knowledge of the specific label used for the derivation.<a class="pilcrow" href="#section-2-1.6">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.7">Extension Label:</dt>
        <dd id="section-2-1.8" style="margin-left: 1.5em">
         This type of label is used to refer to the authoritative zone that the record is in.
         The primary use for the extension label is in redirections where the redirection
         target is defined relative to the authoritative zone of the redirection
         record (see <a class="auto internal xref" href="#gnsrecords_redirect">Section 5.2</a>).
         The extension label is represented using the character U+002B ("+" without the quotes).<a class="pilcrow" href="#section-2-1.8">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.9">Label Separator:</dt>
        <dd id="section-2-1.10" style="margin-left: 1.5em">
         Labels in a name are separated using the label separator U+002E
         ("." without the quotes).
         In GNS, except for zone Top-Level Domains (zTLDs)
         (see below) and boxed records (see <a class="auto internal xref" href="#gnsrecords_box">Section 5.3.3</a>),
         every label separator in a name indicates delegation to another zone.<a class="pilcrow" href="#section-2-1.10">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.11">Label:</dt>
        <dd id="section-2-1.12" style="margin-left: 1.5em">
         A GNS label is a label as defined in <span>[<a class="cite xref" href="#RFC8499">RFC8499</a>]</span>.
         Labels are UTF-8 strings in Unicode
         Normalization Form C (NFC) <span>[<a class="cite xref" href="#Unicode-UAX15">Unicode-UAX15</a>]</span>.
         The apex label and the extension label have
         special purposes in the resolution protocol that are defined
         in the rest of this document.
         Zone administrators <span class="bcp14">MAY</span> disallow certain labels that
         might be easily confused with other labels through registration policies
         (see also <a class="auto internal xref" href="#security_abuse">Section 9.4</a>).<a class="pilcrow" href="#section-2-1.12">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.13">Name:</dt>
        <dd id="section-2-1.14" style="margin-left: 1.5em">
         A name in GNS is a domain name as defined in  <span>[<a class="cite xref" href="#RFC8499">RFC8499</a>]</span>:
         names are UTF-8 strings <span>[<a class="cite xref" href="#RFC3629">RFC3629</a>]</span> consisting of an
         ordered list of labels concatenated with a label separator.
         Names are resolved starting from the rightmost label.
         GNS does not impose length restrictions on names or labels.
         However, applications <span class="bcp14">MAY</span> ensure that name and label lengths are
         compatible with DNS and, in particular, Internationalized Domain Names for
         Applications (IDNA) <span>[<a class="cite xref" href="#RFC5890">RFC5890</a>]</span>.
         In the spirit of <span>[<a class="cite xref" href="#RFC5895">RFC5895</a>]</span>, applications <span class="bcp14">MAY</span> preprocess
         names and labels to ensure compatibility with DNS or support
         specific user expectations -- for example, according to
         <span>[<a class="cite xref" href="#Unicode-UTS46">Unicode-UTS46</a>]</span>.
         A GNS name may be indistinguishable from a DNS name, and care must
         be taken by applications and implementers when handling GNS names
         (see <a class="auto internal xref" href="#namespace_ambiguity">Section 9.10</a>).
         In order to avoid misinterpretation of example domains with (reserved)
         DNS domains, this document uses the suffix ".gns.alt" in compliance with
         <span>[<a class="cite xref" href="#RFC9476">RFC9476</a>]</span>.  ".gns.alt" is also registered in the GANA ".alt Subdomains" registry
         <span>[<a class="cite xref" href="#GANA">GANA</a>]</span>.<a class="pilcrow" href="#section-2-1.14">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.15">Resolver:</dt>
        <dd id="section-2-1.16" style="margin-left: 1.5em">
         In this document, a resolver is the component of a GNS implementation that provides
         the recursive name resolution logic defined in
         <a class="auto internal xref" href="#resolution">Section 7</a>.<a class="pilcrow" href="#section-2-1.16">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.17">Resource Record:</dt>
        <dd id="section-2-1.18" style="margin-left: 1.5em">
         A GNS resource record is the information associated with a label in a
         GNS zone.
         A GNS resource record contains information as defined by its
         resource record type.<a class="pilcrow" href="#section-2-1.18">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.19">Start Zone:</dt>
        <dd id="section-2-1.20" style="margin-left: 1.5em">
         In order to resolve any given GNS name, an initial Start Zone must be
         determined for this name.
         The Start Zone can be explicitly defined as part of the name using a
         zTLD.
         Otherwise, it is determined through a local suffix-to-zone mapping
         (see <a class="auto internal xref" href="#governance">Section 7.1</a>).<a class="pilcrow" href="#section-2-1.20">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.21">Top-Level Domain (TLD):</dt>
        <dd id="section-2-1.22" style="margin-left: 1.5em">
        The rightmost part of a GNS name is a GNS TLD.
         A GNS TLD can consist of one or more labels.
  Unlike DNS TLDs (defined in <span>[<a class="cite xref" href="#RFC8499">RFC8499</a>]</span>),
  GNS does not expect all users to use the same global root zone. Instead,
         with the exception of zTLDs (see <a class="auto internal xref" href="#zTLD">Section 4.1</a>),
         GNS TLDs are typically part of the configuration of the local resolver
         (see <a class="auto internal xref" href="#governance">Section 7.1</a>) and thus might not be globally unique.<a class="pilcrow" href="#section-2-1.22">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.23">Zone:</dt>
        <dd id="section-2-1.24" style="margin-left: 1.5em">
         A GNS zone contains authoritative information (resource records).
         A zone is uniquely identified by its zone key.  Unlike DNS zones,
         a GNS zone does not need to have an SOA record under the apex label.<a class="pilcrow" href="#section-2-1.24">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.25">Zone Key:</dt>
        <dd id="section-2-1.26" style="margin-left: 1.5em">
         The zone key is a key that uniquely identifies a zone.
         It is usually a public key of an asymmetric key pair.
         However, the established technical term "public key" is misleading,
         as in GNS a zone key may be a shared secret
         that should not be disclosed to unauthorized parties.<a class="pilcrow" href="#section-2-1.26">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.27">Zone Key Derivation Function:</dt>
        <dd id="section-2-1.28" style="margin-left: 1.5em">
         The zone key derivation function (ZKDF) blinds a zone key using a label.<a class="pilcrow" href="#section-2-1.28">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.29">Zone Publisher:</dt>
        <dd id="section-2-1.30" style="margin-left: 1.5em">
         The zone publisher is the component of a GNS implementation that provides
         local zone management and publication as defined in
         <a class="auto internal xref" href="#publish">Section 6</a>.<a class="pilcrow" href="#section-2-1.30">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.31">Zone Owner:</dt>
        <dd id="section-2-1.32" style="margin-left: 1.5em">
         The zone owner is the holder of the secret (typically a private key),
  which (together with a label and a value to sign) allows the creation of zone
  signatures that can be validated against the respective blinded zone key.<a class="pilcrow" href="#section-2-1.32">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.33">Zone Top-Level Domain (zTLD):</dt>
        <dd id="section-2-1.34" style="margin-left: 1.5em">
         A GNS zTLD is a sequence of GNS labels at
         the end of a GNS name. The zTLD encodes a zone type and
         zone key of a zone (see <a class="auto internal xref" href="#zTLD">Section 4.1</a>).
         Due to the statistical uniqueness of zone keys, zTLDs are also globally unique.
  A zTLD label sequence can only be distinguished from ordinary TLD label sequences
         by attempting to decode the labels into a zone type and zone key.<a class="pilcrow" href="#section-2-1.34">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.35">Zone Type:</dt>
        <dd id="section-2-1.36" style="margin-left: 1.5em">
         The type of a GNS zone determines the cipher system and binary encoding
  format of the zone key, blinded zone keys, and cryptographic signatures.<a class="pilcrow" href="#section-2-1.36">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
</section>
<div id="overview">
<section id="section-3">
      <h2 id="name-overview">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-overview">Overview</a>
      </h2>
<p id="section-3-1">
         GNS exhibits the three properties that are commonly used to describe
         a petname system:<a class="pilcrow" href="#section-3-1">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-3-2">
        <dt id="section-3-2.1">
           Global names through the concept of zTLDs:</dt>
        <dd id="section-3-2.2" style="margin-left: 1.5em">As zones can be uniquely identified by their zone keys
           and are statistically unique, zTLDs are globally unique mappings to zones.
           Consequently, GNS domain names with a zTLD suffix are also globally unique.
           Names with zTLD suffixes are not memorable.<a class="pilcrow" href="#section-3-2.2">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-2.3">
           Memorable petnames for zones:</dt>
        <dd id="section-3-2.4" style="margin-left: 1.5em">Users can configure local, memorable references to zones.
           Such petnames serve as zTLD monikers that provide
           convenient names for zones to the local operator.
           The petnames may also be published as suggestions for other
           users searching for a good label to use when referencing the
           respective zone.<a class="pilcrow" href="#section-3-2.4">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-2.5">
           A secure mapping from names to records:</dt>
        <dd id="section-3-2.6" style="margin-left: 1.5em">GNS allows zone owners to map labels to resource records or to
           delegate authority of names in the subdomain induced by a label to other zones.
           Zone owners may choose to publish this information to make it
           available to other users.
           Mappings are encrypted and signed
           using keys derived from the respective label before being published in remote storage.
           When names are resolved, signatures on resource records,
           including delegations, are verified by the recursive resolver.<a class="pilcrow" href="#section-3-2.6">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-3-3">
         In the remainder of this document, the "implementer" refers to the developer building
         a GNS implementation that includes the resolver, zone publisher, and
         supporting configuration such as Start Zones (see <a class="auto internal xref" href="#governance">Section 7.1</a>).<a class="pilcrow" href="#section-3-3">¶</a></p>
<div id="names">
<section id="section-3.1">
        <h3 id="name-names-and-zones">
<a class="section-number selfRef" href="#section-3.1">3.1. </a><a class="section-name selfRef" href="#name-names-and-zones">Names and Zones</a>
        </h3>
<p id="section-3.1-1">
         It follows from the above that GNS does not support names that are
         simultaneously global, secure, and memorable.
         Instead, names are either global and not memorable or not globally
         unique and memorable.
         An example for a global name pointing to the record "example" in
         a zone is as follows:<a class="pilcrow" href="#section-3.1-1">¶</a></p>
<div class="sourcecode" id="section-3.1-2">
<pre>example.000G006K2TJNMD9VTCYRX7BRVV3HAEPS15E6NHDXKPJA1KAJJEG9AFF884
</pre><a class="pilcrow" href="#section-3.1-2">¶</a>
</div>
<p id="section-3.1-3">
         Now consider the case where a user locally configured the petname
         "pet.gns.alt" for the zone with the "example" record of the name
         above.
         The name "example.pet.gns.alt" would then point to the same record as the
         globally unique name above, but name resolution would only
         work on the local system where the "pet.gns.alt" petname is
         configured.<a class="pilcrow" href="#section-3.1-3">¶</a></p>
<p id="section-3.1-4">
         The delegation of petnames and subsequent resolution of delegation
         build on ideas from the Simple Distributed Security Infrastructure
         <span>[<a class="cite xref" href="#SDSI">SDSI</a>]</span>.
         In GNS, any user can create and manage any number of zones
         (see <a class="auto internal xref" href="#zones">Section 4</a>) if their system provides a zone publisher implementation.
         For each zone, the zone type determines the respective set of cryptographic operations
         and the wire formats for encrypted data, public keys, and signatures.
         A zone can be populated with mappings from labels to resource records
         (see <a class="auto internal xref" href="#rrecords">Section 5</a>) by its owner.
         A label can be mapped to a delegation record; this results in the
         corresponding subdomain being delegated to another zone. Circular
         delegations are explicitly allowed, including delegating a subdomain
         to its immediate parent zone.  In
         order to support (legacy) applications as well as to facilitate the use
         of petnames, GNS defines auxiliary record types in addition to
         supporting existing DNS records.<a class="pilcrow" href="#section-3.1-4">¶</a></p>
</section>
</div>
<div id="publishing">
<section id="section-3.2">
        <h3 id="name-publishing-binding-informat">
<a class="section-number selfRef" href="#section-3.2">3.2. </a><a class="section-name selfRef" href="#name-publishing-binding-informat">Publishing Binding Information</a>
        </h3>
<p id="section-3.2-1">
         Zone contents are encrypted and signed
         before being published in remote key-value storage (see <a class="auto internal xref" href="#publish">Section 6</a>),
         as illustrated in <a class="auto internal xref" href="#figure_arch_publish">Figure 1</a>.
         In this process, unique zone identification is hidden from the network
         through the use of key blinding.
         Key blinding allows the creation of signatures for zone contents
         using a blinded public/private key pair.
         This blinding is realized using a deterministic key
         derivation from
         the original zone key and corresponding private key using record label values
         as inputs from which blinding factors are derived.
         Specifically, the zone owner can derive blinded private keys for each record
         set published under a label, and a
         resolver can derive the corresponding blinded public keys.
         It is expected that GNS implementations use decentralized remote
         storage entities, such as distributed hash tables (DHTs), in order to facilitate
         availability within a network without the need for dedicated infrastructure.
         The specification of such a distributed or decentralized storage entity is out of
         scope for this document, but possible existing implementations include those
         based on <span>[<a class="cite xref" href="#RFC7363">RFC7363</a>]</span>, <span>[<a class="cite xref" href="#Kademlia">Kademlia</a>]</span>, or
         <span>[<a class="cite xref" href="#R5N">R5N</a>]</span>.<a class="pilcrow" href="#section-3.2-1">¶</a></p>
<span id="name-an-example-diagram-of-two-h"></span><div id="figure_arch_publish">
<figure id="figure-1">
          <div class="alignLeft art-text artwork" id="section-3.2-2.1">
<pre>       Host A           |     Remote      |      Host B
                        |     Storage     |
                        |                 |
                        |    +---------+  |
                        |   /         /|  |
               Publish  |  +---------+ |  |  Publish
 +-----------+ Records  |  |         | |  |  Records +-----------+
 |   Zone    |----------|-&gt;| Record  | |&lt;-|----------|   Zone    |
 | Publisher |          |  | Storage | |  |          | Publisher |
 +-----------+          |  |         |/   |          +-----------+
      A                 |  +---------+    |               A
      |                 |                 |               |
   +---------+          |                 |           +---------+
  /   |     /|          |                 |          /    |    /|
 +---------+ |          |                 |         +---------+ |
 |         | |          |                 |         |         | |
 |  Local  | |          |                 |         |  Local  | |
 |  Zones  | |          |                 |         |  Zones  | |
 |         |/           |                 |         |         |/
 +---------+            |                 |         +---------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-1">Figure 1</a>:
<a class="selfRef" href="#name-an-example-diagram-of-two-h">An Example Diagram of Two Hosts Publishing GNS Zones</a>
          </figcaption></figure>
</div>
<p id="section-3.2-3">
         A zone publisher implementation <span class="bcp14">SHOULD</span> be provided as
         part of a GNS implementation to enable users to create and manage zones.
         If this functionality is not implemented, names can still be resolved
         if zone keys for the initial step in the name resolution have been
         configured (see <a class="auto internal xref" href="#resolution">Section 7</a>) or if the names end with a
         zTLD suffix.<a class="pilcrow" href="#section-3.2-3">¶</a></p>
</section>
</div>
<div id="resolving">
<section id="section-3.3">
        <h3 id="name-resolving-names">
<a class="section-number selfRef" href="#section-3.3">3.3. </a><a class="section-name selfRef" href="#name-resolving-names">Resolving Names</a>
        </h3>
<p id="section-3.3-1">
         Applications use the resolver to look up GNS names.
         Starting from a configurable Start Zone, names are resolved by following zone
         delegations recursively, as illustrated in <a class="auto internal xref" href="#figure_arch_resolv">Figure 2</a>.
         For each label in a name, the recursive GNS resolver
         fetches the respective record set from the storage layer (see <a class="auto internal xref" href="#resolution">Section 7</a>).
         Without knowledge of the label values and the zone keys, the
         different derived keys are unlinkable to both the original zone key and each
         other.
         This prevents zone enumeration (except via expensive online
         brute-force attacks): to confirm the affiliation of a
         query or the corresponding encrypted record set with a
         specific zone requires knowledge of both the zone key and the label,
         neither of which is disclosed to remote storage by the protocol.
         At the same time, the blinded zone key and digital signatures
         associated with each encrypted record set allow resolvers and oblivious remote
         storage to verify the integrity of the published information
         without disclosing anything about the originating zone or the record sets.<a class="pilcrow" href="#section-3.3-1">¶</a></p>
<span id="name-high-level-view-of-the-gns-"></span><div id="figure_arch_resolv">
<figure id="figure-2">
          <div class="alignLeft art-text artwork" id="section-3.3-2.1">
<pre>                           Local Host           |   Remote
                                                |   Storage
                                                |
                                                |    +---------+
                                                |   /         /|
                                                |  +---------+ |
+-----------+ Name     +----------+ Recursive   |  |         | |
|           | Lookup   |          | Resolution  |  | Record  | |
|Application|---------&gt;| Resolver |-------------|-&gt;| Storage | |
|           |&lt;---------|          |&lt;------------|--|         |/
+-----------+ Results  +----------+ Intermediate|  +---------+
                          A         Results     |
                          |                     |
                       +---------+              |
                      /   |     /|              |
                     +---------+ |              |
                     |         | |              |
                     |  Start  | |              |
                     |  Zones  | |              |
                     |         |/               |
                     +---------+                |
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-2">Figure 2</a>:
<a class="selfRef" href="#name-high-level-view-of-the-gns-">High-Level View of the GNS Resolution Process</a>
          </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="zones">
<section id="section-4">
      <h2 id="name-zones">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-zones">Zones</a>
      </h2>
<p id="section-4-1">
       A zone in GNS is uniquely identified by its zone type (ztype) and zone key.
       Each zone can be referenced by its zTLD
       (see <a class="auto internal xref" href="#zTLD">Section 4.1</a>), which is a string that encodes the zone type and zone key.
       The ztype is a unique 32-bit number that corresponds to
       a resource record type number identifying a delegation record type
       in the GANA "GNS Record Types" registry <span>[<a class="cite xref" href="#GANA">GANA</a>]</span>.
       The ztype is a unique identifier for the set cryptographic functions
       of the zone and the format of the delegation record type.
       Any ztype registration <span class="bcp14">MUST</span> define the following set of cryptographic functions:<a class="pilcrow" href="#section-4-1">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4-2">
        <dt id="section-4-2.1">KeyGen() -&gt; d, zkey</dt>
        <dd id="section-4-2.2" style="margin-left: 1.5em">
         A function for generating a new private key d and
  the corresponding public zone key zkey.<a class="pilcrow" href="#section-4-2.2">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-4-2.3">ZKDF(zkey, label) -&gt; zkey'</dt>
        <dd id="section-4-2.4" style="margin-left: 1.5em">
         A ZKDF that blinds a zone key zkey
         using a label.  zkey and zkey' must be unlinkable. Furthermore,
         blinding zkey with different values for the label must result
         in different, unlinkable zkey' values.<a class="pilcrow" href="#section-4-2.4">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-4-2.5">S-Encrypt(zkey, label, expiration, plaintext) -&gt; ciphertext</dt>
        <dd id="section-4-2.6" style="margin-left: 1.5em">
         A symmetric encryption function that encrypts the plaintext
         to derive ciphertext based on key material derived from the zone key zkey,
         a label, and an expiration timestamp.
         In order to leverage performance-enhancing caching features of certain
         underlying storage entities -- in particular, DHTs -- a deterministic encryption
         scheme is recommended.<a class="pilcrow" href="#section-4-2.6">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-4-2.7">S-Decrypt(zkey, label, expiration, ciphertext) -&gt; plaintext</dt>
        <dd id="section-4-2.8" style="margin-left: 1.5em">
         A symmetric decryption function that decrypts the ciphertext
         into plaintext based on key material derived from the zone key,
         a label, and an expiration timestamp.<a class="pilcrow" href="#section-4-2.8">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-4-2.9">Sign(d, message) -&gt; signature</dt>
        <dd id="section-4-2.10" style="margin-left: 1.5em">
         A function for signing a message using the private
         key d, yielding an unforgeable cryptographic signature.
         In order to leverage performance-enhancing caching features of certain
         underlying storage entities -- in particular, DHTs -- a deterministic signature
         scheme is recommended.<a class="pilcrow" href="#section-4-2.10">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-4-2.11">Verify(zkey, message, signature) -&gt; boolean</dt>
        <dd id="section-4-2.12" style="margin-left: 1.5em">
         A function for verifying that the signature was created using
         the private key d corresponding to the zone key zkey
         where d,zkey := KeyGen().
         The function returns a boolean value of "TRUE" if the signature is valid
         and "FALSE" otherwise.<a class="pilcrow" href="#section-4-2.12">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-4-2.13">SignDerived(d, label, message) -&gt; signature</dt>
        <dd id="section-4-2.14" style="margin-left: 1.5em">
         A function for signing a message (typically encrypted record data) that
         can be verified using the derived zone key zkey' := ZKDF(zkey, label).
         In order to leverage performance-enhancing caching features of certain
         underlying storage entities -- in particular, DHTs -- a deterministic signature
         scheme is recommended.<a class="pilcrow" href="#section-4-2.14">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-4-2.15">VerifyDerived(zkey', message, signature) -&gt; boolean</dt>
        <dd id="section-4-2.16" style="margin-left: 1.5em">
         A function for verifying the signature using the derived zone key
         zkey' := ZKDF(zkey, label).  The function returns a boolean value
         of "TRUE" if the signature is valid and "FALSE" otherwise. Depending
         on the signature scheme used, this function can be identical to
         the Verify() function.<a class="pilcrow" href="#section-4-2.16">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-4-3">
       The cryptographic functions of the default ztypes are specified with
       their corresponding delegation records as discussed in <a class="auto internal xref" href="#gnsrecords_delegation">Section 5.1</a>.
       In order to support cryptographic agility, additional ztypes <span class="bcp14">MAY</span>
       be defined in the future that replace or update the default ztypes defined in this
       document.
       All ztypes <span class="bcp14">MUST</span> be registered as dedicated zone delegation
       record types in the GANA "GNS Record Types" registry (see <span>[<a class="cite xref" href="#GANA">GANA</a>]</span>).
       When defining new record types, the cryptographic security considerations
       of this document -- in particular, <a class="auto internal xref" href="#security_cryptography">Section 9.3</a> -- apply.<a class="pilcrow" href="#section-4-3">¶</a></p>
<div id="zTLD">
<section id="section-4.1">
        <h3 id="name-zone-top-level-domain-ztld">
<a class="section-number selfRef" href="#section-4.1">4.1. </a><a class="section-name selfRef" href="#name-zone-top-level-domain-ztld">Zone Top-Level Domain (zTLD)</a>
        </h3>
<p id="section-4.1-1">
         A zTLD is a string that encodes the
         zone type and zone key into a domain name suffix.
         A zTLD is used as a globally unique reference to a
         zone in the process of name resolution.
         It is created by encoding a binary concatenation of the zone type and
         zone key (see <a class="auto internal xref" href="#figure_zid">Figure 3</a>).
         The used encoding is a variation of the Crockford Base32 encoding
         <span>[<a class="cite xref" href="#CrockfordB32">CrockfordB32</a>]</span> called Base32GNS.
         The encoding and decoding symbols for Base32GNS, including this
         variation, are defined in <a class="auto internal xref" href="#CrockfordB32Encode">Table 4</a>, found in <a class="auto internal xref" href="#app-c">Appendix C</a>.
         The functions for encoding and decoding based on <a class="auto internal xref" href="#CrockfordB32Encode">Table 4</a> are called
         Base32GNS-Encode and Base32GNS-Decode, respectively.<a class="pilcrow" href="#section-4.1-1">¶</a></p>
<span id="name-the-binary-representation-o"></span><div id="figure_zid">
<figure id="figure-3">
          <div class="alignLeft art-text artwork" id="section-4.1-2.1">
<pre>0     8     16    24    32    40    48    56
+-----+-----+-----+-----+-----+-----+-----+-----+
|       ZONE TYPE       |      ZONE KEY         /
+-----+-----+-----+-----+                       /
/                                               /
/                                               /
+-----+-----+-----+-----+-----+-----+-----+-----+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-3">Figure 3</a>:
<a class="selfRef" href="#name-the-binary-representation-o">The Binary Representation of the zTLD</a>
          </figcaption></figure>
</div>
<p id="section-4.1-3">
         The ZONE TYPE <span class="bcp14">MUST</span> be encoded in network byte order.  The format
         of the ZONE KEY depends entirely on the ZONE TYPE.<a class="pilcrow" href="#section-4.1-3">¶</a></p>
<p id="section-4.1-4">
         Consequently, a zTLD is encoded and decoded as follows:<a class="pilcrow" href="#section-4.1-4">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1-5">
<pre>zTLD := Base32GNS-Encode(ztype||zkey)
ztype||zkey := Base32GNS-Decode(zTLD)
</pre><a class="pilcrow" href="#section-4.1-5">¶</a>
</div>
<p id="section-4.1-6">
         where "||" is the concatenation operator.<a class="pilcrow" href="#section-4.1-6">¶</a></p>
<p id="section-4.1-7">
         The zTLD can be used "as is" as a rightmost label in a GNS name.
         If an application wants to ensure DNS compatibility of the name,
         it <span class="bcp14">MAY</span> also represent the zTLD as follows:
         if the zTLD is less than or equal to 63 characters, it can
         be used as a zTLD as is.
         If the zTLD is longer than 63 characters, the
         zTLD is divided into smaller labels separated by the label separator.
         Here, the most significant bytes of the "ztype||zkey" concatenation
         must be contained in the rightmost label of the resulting string and
         the least significant bytes in the leftmost label of the resulting string. This allows the
         resolver to determine the ztype and zTLD length from the rightmost
         label and to subsequently determine how many labels the zTLD should span.
         A GNS implementation <span class="bcp14">MUST</span> support the division of zTLDs
         in DNS-compatible label lengths.
         For example, assuming a zTLD of 130 characters, the division is as follows:<a class="pilcrow" href="#section-4.1-7">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1-8">
<pre>zTLD[126..129].zTLD[63..125].zTLD[0..62]
</pre><a class="pilcrow" href="#section-4.1-8">¶</a>
</div>
</section>
</div>
<div id="revocation">
<section id="section-4.2">
        <h3 id="name-zone-revocation">
<a class="section-number selfRef" href="#section-4.2">4.2. </a><a class="section-name selfRef" href="#name-zone-revocation">Zone Revocation</a>
        </h3>
<p id="section-4.2-1">
         In order to revoke a zone key, a signed revocation message <span class="bcp14">MUST</span> be
         published.
         This message <span class="bcp14">MUST</span> be signed using the private key of the zone.
         The revocation message is broadcast to the network.
         The specification of the broadcast mechanism is out of scope for this
         document.
         A possible broadcast mechanism for efficient flooding in a distributed
         network is implemented in <span>[<a class="cite xref" href="#GNUnet">GNUnet</a>]</span>.
         Alternatively, revocation messages could also be distributed via a
         distributed ledger or a trusted central server.
         To prevent
         flooding attacks, the revocation message <span class="bcp14">MUST</span> contain a proof of work
         (PoW).
         The revocation message, including the PoW, <span class="bcp14">MAY</span> be calculated
         ahead of time to support timely revocation.<a class="pilcrow" href="#section-4.2-1">¶</a></p>
<p id="section-4.2-2">
         For all occurrences below, "Argon2id" is the password-based key
         derivation function as defined in <span>[<a class="cite xref" href="#RFC9106">RFC9106</a>]</span>. For the
         PoW calculations, the algorithm is instantiated with the
         following parameters:<a class="pilcrow" href="#section-4.2-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.2-3">
          <dt id="section-4.2-3.1">S:</dt>
          <dd id="section-4.2-3.2" style="margin-left: 1.5em">The salt. Fixed 16-byte string: "GnsRevocationPow"<a class="pilcrow" href="#section-4.2-3.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-3.3">t:</dt>
          <dd id="section-4.2-3.4" style="margin-left: 1.5em">Number of iterations: 3<a class="pilcrow" href="#section-4.2-3.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-3.5">m:</dt>
          <dd id="section-4.2-3.6" style="margin-left: 1.5em">Memory size in KiB: 1024<a class="pilcrow" href="#section-4.2-3.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-3.7">T:</dt>
          <dd id="section-4.2-3.8" style="margin-left: 1.5em">Output length of hash in bytes: 64<a class="pilcrow" href="#section-4.2-3.8">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-3.9">p:</dt>
          <dd id="section-4.2-3.10" style="margin-left: 1.5em">Parallelization parameter: 1<a class="pilcrow" href="#section-4.2-3.10">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-3.11">v:</dt>
          <dd id="section-4.2-3.12" style="margin-left: 1.5em">Algorithm version: 0x13<a class="pilcrow" href="#section-4.2-3.12">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-3.13">y:</dt>
          <dd id="section-4.2-3.14" style="margin-left: 1.5em">Algorithm type (Argon2id): 2<a class="pilcrow" href="#section-4.2-3.14">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-3.15">X:</dt>
          <dd id="section-4.2-3.16" style="margin-left: 1.5em">Unused<a class="pilcrow" href="#section-4.2-3.16">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-3.17">K:</dt>
          <dd id="section-4.2-3.18" style="margin-left: 1.5em">Unused<a class="pilcrow" href="#section-4.2-3.18">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.2-4">
         <a class="auto internal xref" href="#figure_revocation">Figure 4</a> illustrates the format
         of the data "P" on which the PoW is calculated.<a class="pilcrow" href="#section-4.2-4">¶</a></p>
<span id="name-the-format-of-the-pow-data"></span><div id="figure_revocation">
<figure id="figure-4">
          <div class="alignLeft art-text artwork" id="section-4.2-5.1">
<pre>0     8     16    24    32    40    48    56
+-----+-----+-----+-----+-----+-----+-----+-----+
|                      POW                      |
+-----------------------------------------------+
|                   TIMESTAMP                   |
+-----------------------------------------------+
|       ZONE TYPE       |    ZONE KEY           /
+-----+-----+-----+-----+                       /
/                                               /
/                                               /
+-----+-----+-----+-----+-----+-----+-----+-----+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-4">Figure 4</a>:
<a class="selfRef" href="#name-the-format-of-the-pow-data">The Format of the PoW Data</a>
          </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.2-6">
          <dt id="section-4.2-6.1">POW:</dt>
          <dd id="section-4.2-6.2" style="margin-left: 1.5em">
           A 64-bit value that is a solution to the PoW. In network byte order.<a class="pilcrow" href="#section-4.2-6.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-6.3">TIMESTAMP:</dt>
          <dd id="section-4.2-6.4" style="margin-left: 1.5em">
           Denotes the absolute 64-bit date when the revocation was computed.
           In microseconds since midnight (0 hour), January 1, 1970 UTC in network
           byte order.<a class="pilcrow" href="#section-4.2-6.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-6.5">ZONE TYPE:</dt>
          <dd id="section-4.2-6.6" style="margin-left: 1.5em">
           The 32-bit zone type in network byte order.<a class="pilcrow" href="#section-4.2-6.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-6.7">ZONE KEY:</dt>
          <dd id="section-4.2-6.8" style="margin-left: 1.5em">
           The 256-bit public key zkey of the zone that is being revoked.
           The wire format of this value is defined by the ZONE TYPE.<a class="pilcrow" href="#section-4.2-6.8">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.2-7">
         Usually, PoW schemes require that one POW value be found, such that
         a specific number of leading zeroes are found in the hash result.
         This number is then referred to as the difficulty of the PoW.
         In order to reduce the variance in time it takes to calculate the
         PoW, a valid GNS revocation requires that a number of different PoWs (Z, as defined below)
         must be found that on average have at least D leading zeroes.<a class="pilcrow" href="#section-4.2-7">¶</a></p>
<p id="section-4.2-8">
         Given an average difficulty of D, the proofs have an
         expiration time of EPOCH.  Applications <span class="bcp14">MAY</span> calculate proofs
         with a difficulty that is higher than D by providing POW
         values where there are (on average) more than D bits of leading zeroes.
         With each additional bit of difficulty, the
         lifetime of the proof is prolonged by another EPOCH.
         Consequently, by calculating a more difficult PoW, the lifetime of the
         proof -- and thus the persistence of the revocation message --
         can be increased on demand by the zone owner.<a class="pilcrow" href="#section-4.2-8">¶</a></p>
<p id="section-4.2-9">
         The parameters are defined as follows:<a class="pilcrow" href="#section-4.2-9">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.2-10">
          <dt id="section-4.2-10.1">Z:</dt>
          <dd id="section-4.2-10.2" style="margin-left: 1.5em">The number of PoWs that are required. Its value is fixed at 32.<a class="pilcrow" href="#section-4.2-10.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-10.3">D:</dt>
          <dd id="section-4.2-10.4" style="margin-left: 1.5em">The lower limit of the average difficulty. Its value is fixed at 22.<a class="pilcrow" href="#section-4.2-10.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-10.5">EPOCH:</dt>
          <dd id="section-4.2-10.6" style="margin-left: 1.5em">A single epoch. Its value is fixed at 365 days in microseconds.<a class="pilcrow" href="#section-4.2-10.6">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.2-11">
         The revocation message wire format is illustrated in
         <a class="auto internal xref" href="#figure_revocationdata">Figure 5</a>.<a class="pilcrow" href="#section-4.2-11">¶</a></p>
<span id="name-the-revocation-message-wire"></span><div id="figure_revocationdata">
<figure id="figure-5">
          <div class="alignLeft art-text artwork" id="section-4.2-12.1">
<pre>0     8     16    24    32    40    48    56
+-----+-----+-----+-----+-----+-----+-----+-----+
|                   TIMESTAMP                   |
+-----+-----+-----+-----+-----+-----+-----+-----+
|                      TTL                      |
+-----+-----+-----+-----+-----+-----+-----+-----+
|                     POW_0                     |
+-----+-----+-----+-----+-----+-----+-----+-----+
|                       ...                     |
+-----+-----+-----+-----+-----+-----+-----+-----+
|                    POW_(Z-1)                  |
+-----------------------------------------------+
|       ZONE TYPE       |    ZONE KEY           /
+-----+-----+-----+-----+                       /
/                                               /
/                                               /
+-----+-----+-----+-----+-----+-----+-----+-----+
/                   SIGNATURE                   /
/                                               /
/                                               /
/                                               /
+-----+-----+-----+-----+-----+-----+-----+-----+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-5">Figure 5</a>:
<a class="selfRef" href="#name-the-revocation-message-wire">The Revocation Message Wire Format</a>
          </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.2-13">
          <dt id="section-4.2-13.1">TIMESTAMP:</dt>
          <dd id="section-4.2-13.2" style="margin-left: 1.5em">
           Denotes the absolute 64-bit date when the revocation was computed.
           In microseconds since midnight (0 hour), January 1, 1970 UTC in network
           byte order. This is the same value as the timestamp used in the
           individual PoW calculations.<a class="pilcrow" href="#section-4.2-13.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-13.3">TTL:</dt>
          <dd id="section-4.2-13.4" style="margin-left: 1.5em">
           Denotes the relative 64-bit time to live of the record in
           microseconds in network byte order.
           The field <span class="bcp14">SHOULD</span> be set to EPOCH * 1.1.
           Given an average number of leading zeroes D', then the field value
           <span class="bcp14">MAY</span> be increased up to (D'-D+1) * EPOCH * 1.1.
           Validators <span class="bcp14">MAY</span> reject messages with lower or higher
           values when received.<a class="pilcrow" href="#section-4.2-13.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-13.5">POW_i:</dt>
          <dd id="section-4.2-13.6" style="margin-left: 1.5em">
           The values calculated as part of the PoW, in network byte order.
           Each POW_i <span class="bcp14">MUST</span> be unique in the set of POW values.
           To facilitate fast verification
           of uniqueness, the POW values <span class="bcp14">MUST</span> be given in strictly
           monotonically increasing order in the message.<a class="pilcrow" href="#section-4.2-13.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-13.7">ZONE TYPE:</dt>
          <dd id="section-4.2-13.8" style="margin-left: 1.5em">
           The 32-bit zone type corresponding to the zone key in network byte order.<a class="pilcrow" href="#section-4.2-13.8">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-13.9">ZONE KEY:</dt>
          <dd id="section-4.2-13.10" style="margin-left: 1.5em">
           The public key zkey of the zone that is being revoked and
           the key to be used to verify SIGNATURE.<a class="pilcrow" href="#section-4.2-13.10">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-13.11">SIGNATURE:</dt>
          <dd id="section-4.2-13.12" style="margin-left: 1.5em">
           A signature over a timestamp and the zone zkey of the zone
           that is revoked and corresponds to the key used in the PoW.
           The signature is created using the Sign() function of
           the cryptosystem of the zone and the private key
           (see <a class="auto internal xref" href="#zones">Section 4</a>).<a class="pilcrow" href="#section-4.2-13.12">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.2-14">
        The signature in the revocation message covers a 32-bit header
        prefixed to the TIMESTAMP, ZONE TYPE, and ZONE KEY fields.
        The header includes the key length and signature purpose.
        The wire format is illustrated
        in <a class="auto internal xref" href="#figure_revsigwithpseudo">Figure 6</a>.<a class="pilcrow" href="#section-4.2-14">¶</a></p>
<span id="name-the-wire-format-of-the-revo"></span><div id="figure_revsigwithpseudo">
<figure id="figure-6">
          <div class="alignLeft art-text artwork" id="section-4.2-15.1">
<pre>0     8     16    24    32    40    48    56
+-----+-----+-----+-----+-----+-----+-----+-----+
|         SIZE          |       PURPOSE (0x03)  |
+-----+-----+-----+-----+-----+-----+-----+-----+
|                   TIMESTAMP                   |
+-----+-----+-----+-----+-----+-----+-----+-----+
|       ZONE TYPE       |     ZONE KEY          /
+-----+-----+-----+-----+                       /
/                                               /
/                                               /
+-----+-----+-----+-----+-----+-----+-----+-----+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-6">Figure 6</a>:
<a class="selfRef" href="#name-the-wire-format-of-the-revo">The Wire Format of the Revocation Data for Signing</a>
          </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.2-16">
          <dt id="section-4.2-16.1">SIZE:</dt>
          <dd id="section-4.2-16.2" style="margin-left: 1.5em">
           A 32-bit value containing the length of the signed data in bytes
           in network byte order.<a class="pilcrow" href="#section-4.2-16.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-16.3">PURPOSE:</dt>
          <dd id="section-4.2-16.4" style="margin-left: 1.5em">
           A 32-bit signature purpose flag.
           The value of this field <span class="bcp14">MUST</span> be 3.
           The value is encoded in network byte order.
           It defines the context in which
           the signature is created so that it cannot be reused in other parts
           of the protocol that might include possible future extensions.
           The value of this field corresponds to an entry in the
           GANA "GNUnet Signature Purposes" registry <span>[<a class="cite xref" href="#GANA">GANA</a>]</span>.<a class="pilcrow" href="#section-4.2-16.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-16.5">TIMESTAMP:</dt>
          <dd id="section-4.2-16.6" style="margin-left: 1.5em">
           Field as defined in the revocation message above.<a class="pilcrow" href="#section-4.2-16.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-16.7">ZONE TYPE:</dt>
          <dd id="section-4.2-16.8" style="margin-left: 1.5em">
           Field as defined in the revocation message above.<a class="pilcrow" href="#section-4.2-16.8">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-16.9">ZONE KEY:</dt>
          <dd id="section-4.2-16.10" style="margin-left: 1.5em">Field as defined in the revocation message above.<a class="pilcrow" href="#section-4.2-16.10">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.2-17">
         In order to validate a revocation, the following steps <span class="bcp14">MUST</span> be taken:<a class="pilcrow" href="#section-4.2-17">¶</a></p>
<ol class="normal type-1" id="section-4.2-18" start="1" type="1">
         <li id="section-4.2-18.1">The signature <span class="bcp14">MUST</span> be verified against the zone key.<a class="pilcrow" href="#section-4.2-18.1">¶</a>
</li>
          <li id="section-4.2-18.2">The set of POW values <span class="bcp14">MUST NOT</span> contain duplicates; this <span class="bcp14">MUST</span> be checked by verifying that the values are strictly monotonically increasing.<a class="pilcrow" href="#section-4.2-18.2">¶</a>
</li>
          <li id="section-4.2-18.3">The average number of leading zeroes D' resulting from the provided
         POW values <span class="bcp14">MUST</span> be greater than or equal to D.  Implementers
         <span class="bcp14">MUST NOT</span> use an integer data type to calculate or represent D'.<a class="pilcrow" href="#section-4.2-18.3">¶</a>
</li>
        </ol>
<p id="section-4.2-19">
         The TTL field in the revocation message is informational.
         A revocation <span class="bcp14">MAY</span> be discarded without checking the POW
         values or the signature if the TTL (in combination with TIMESTAMP)
         indicates that the revocation has already expired.
         The actual validity period of the
         revocation <span class="bcp14">MUST</span> be determined by examining the leading
         zeroes in the POW values.<a class="pilcrow" href="#section-4.2-19">¶</a></p>
<p id="section-4.2-20">
         The validity period of the revocation is calculated as
         (D'-D+1) * EPOCH * 1.1. The EPOCH is extended by
         10% in order to deal with poorly synchronized clocks.
         The validity period added on top of the TIMESTAMP yields the
         expiration date.
         If the current time is after the expiration date, the
         revocation is considered stale.<a class="pilcrow" href="#section-4.2-20">¶</a></p>
<p id="section-4.2-21">
         Verified revocations <span class="bcp14">MUST</span> be stored locally.
         The implementation <span class="bcp14">MAY</span> discard stale revocations and
         evict them from the local store at any time.<a class="pilcrow" href="#section-4.2-21">¶</a></p>
<p id="section-4.2-22">
         It is important that implementations broadcast received revocations
         if they are valid and not stale.
         Should the calculated validity period differ from the TTL field value,
         the calculated value <span class="bcp14">MUST</span> be used as the TTL field value
         when forwarding the revocation message.
         Systems might disagree on the current time, so implementations
         <span class="bcp14">MAY</span> use stale but otherwise valid
         revocations but <span class="bcp14">SHOULD NOT</span> broadcast them.
         Forwarded stale revocations <span class="bcp14">MAY</span> be discarded by the receiver.<a class="pilcrow" href="#section-4.2-22">¶</a></p>
<p id="section-4.2-23">
         Any locally stored revocation <span class="bcp14">MUST</span> be considered during
         delegation record processing (see <a class="auto internal xref" href="#delegation_processing">Section 7.3.4</a>).<a class="pilcrow" href="#section-4.2-23">¶</a></p>
</section>
</div>
</section>
</div>
<div id="rrecords">
<section id="section-5">
      <h2 id="name-resource-records">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-resource-records">Resource Records</a>
      </h2>
<p id="section-5-1">
       A GNS implementation <span class="bcp14">SHOULD</span> provide a mechanism for creating and managing local
       zones as well as a persistence mechanism (such as a local database) for resource
       records.
       A new local zone is established by selecting a zone type and creating a
       zone key pair.
       If this mechanism is not implemented,
       no zones can be published in storage (see <a class="auto internal xref" href="#publish">Section 6</a>)
       and name resolution is limited to non-local Start Zones
       (see <a class="auto internal xref" href="#governance">Section 7.1</a>).<a class="pilcrow" href="#section-5-1">¶</a></p>
<p id="section-5-2">
       A GNS resource record holds the data of a specific record in a zone.
       The resource record format is illustrated in
       <a class="auto internal xref" href="#figure_gnsrecord">Figure 7</a>.<a class="pilcrow" href="#section-5-2">¶</a></p>
<span id="name-the-resource-record-wire-fo"></span><div id="figure_gnsrecord">
<figure id="figure-7">
        <div class="alignLeft art-text artwork" id="section-5-3.1">
<pre>0     8     16    24    32    40    48    56
+-----+-----+-----+-----+-----+-----+-----+-----+
|                   EXPIRATION                  |
+-----+-----+-----+-----+-----+-----+-----+-----+
|    SIZE   |   FLAGS   |          TYPE         |
+-----+-----+-----+-----+-----+-----+-----+-----+
|                      DATA                     /
/                                               /
/                                               /
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-7">Figure 7</a>:
<a class="selfRef" href="#name-the-resource-record-wire-fo">The Resource Record Wire Format</a>
        </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-5-4">
        <dt id="section-5-4.1">EXPIRATION:</dt>
        <dd id="section-5-4.2" style="margin-left: 1.5em">
         Denotes the absolute 64-bit expiration date of the record.
         In microseconds since midnight (0 hour), January 1, 1970 UTC in network
         byte order.<a class="pilcrow" href="#section-5-4.2">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-5-4.3">SIZE:</dt>
        <dd id="section-5-4.4" style="margin-left: 1.5em">
         Denotes the 16-bit size of the DATA field in bytes in network byte
         order.<a class="pilcrow" href="#section-5-4.4">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-5-4.5">FLAGS:</dt>
        <dd id="section-5-4.6" style="margin-left: 1.5em">
         A 16-bit field indicating special properties of the resource record.
         The semantics of the different bits are defined below.<a class="pilcrow" href="#section-5-4.6">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-5-4.7">TYPE:</dt>
        <dd id="section-5-4.8" style="margin-left: 1.5em">
         The 32-bit resource record type in
         network byte order. This type can be one of the GNS resource
         records as defined in <a class="auto internal xref" href="#rrecords">Section 5</a>, a DNS record
         type as defined in <span>[<a class="cite xref" href="#RFC1035">RFC1035</a>]</span>, or any of the
         complementary standardized DNS resource record types.
         Note that values
         below 2<sup>16</sup> are reserved for 16-bit DNS resource record types allocated by IANA <span>[<a class="cite xref" href="#RFC6895">RFC6895</a>]</span>.
         Values above 2<sup>16</sup> are allocated by the
         GANA "GNS Record Types" registry <span>[<a class="cite xref" href="#GANA">GANA</a>]</span>.<a class="pilcrow" href="#section-5-4.8">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-5-4.9">DATA:</dt>
        <dd id="section-5-4.10" style="margin-left: 1.5em">
         The variable-length resource record data payload. The content is defined
         by the
         respective type of the resource record.<a class="pilcrow" href="#section-5-4.10">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-5-5">
       The FLAGS field is used to indicate special properties of the resource record.
       An application creating resource records <span class="bcp14">MUST</span> set all bits
       in FLAGS to 0 unless it specifically understands and
       wants to set the respective flag.
       As additional flags can be defined in future protocol versions,
       if an application or implementation encounters a flag that it does not
       recognize, the flag <span class="bcp14">MUST</span> be ignored.  However, all implementations
       <span class="bcp14">MUST</span> understand the SHADOW and CRITICAL flags defined below.
       Any combination of the flags specified below is valid.
       <a class="auto internal xref" href="#figure_flag">Figure 8</a>
       illustrates the flag distribution in the 16-bit FLAGS field of a
       resource record:<a class="pilcrow" href="#section-5-5">¶</a></p>
<span id="name-the-resource-record-flag-wi"></span><div id="figure_flag">
<figure id="figure-8">
        <div class="alignLeft art-text artwork" id="section-5-6.1">
<pre>0           13            14      15
+--------...+-------------+-------+---------+
| Reserved  |SUPPLEMENTAL |SHADOW |CRITICAL |
+--------...+-------------+-------+---------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-8">Figure 8</a>:
<a class="selfRef" href="#name-the-resource-record-flag-wi">The Resource Record Flag Wire Format</a>
        </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-5-7">
        <dt id="section-5-7.1">CRITICAL:</dt>
        <dd id="section-5-7.2" style="margin-left: 1.5em">
         If this flag is set, it indicates that processing is critical.
         Implementations that do not support the record type or are otherwise
         unable to process the record <span class="bcp14">MUST</span> abort resolution upon encountering
         the record in the resolution process.<a class="pilcrow" href="#section-5-7.2">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-5-7.3">SHADOW:</dt>
        <dd id="section-5-7.4" style="margin-left: 1.5em">
         If this flag is set, this record <span class="bcp14">MUST</span> be ignored by resolvers unless all (other)
         records of the same record type have expired.  Used to allow zone publishers to
         facilitate good performance when records change by allowing them to put future
         values of records into storage.
         This way, future values can propagate and can be
         cached before the transition becomes active.<a class="pilcrow" href="#section-5-7.4">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-5-7.5">SUPPLEMENTAL:</dt>
        <dd id="section-5-7.6" style="margin-left: 1.5em">
         This is a supplemental record. It is provided in addition to the
         other records. This flag indicates that this record is not explicitly
         managed alongside the other records under the respective name but
         might be useful for the application.<a class="pilcrow" href="#section-5-7.6">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<div id="gnsrecords_delegation">
<section id="section-5.1">
        <h3 id="name-zone-delegation-records">
<a class="section-number selfRef" href="#section-5.1">5.1. </a><a class="section-name selfRef" href="#name-zone-delegation-records">Zone Delegation Records</a>
        </h3>
<p id="section-5.1-1">
       This section defines the initial set of zone delegation record types.
       Any implementation <span class="bcp14">SHOULD</span> support all zone types defined here and
       <span class="bcp14">MAY</span> support any number of additional delegation records defined in
       the GANA "GNS Record Types" registry (see <span>[<a class="cite xref" href="#GANA">GANA</a>]</span>).
       Not supporting some zone types will result in resolution failures if
       the respective zone type is encountered.
       This can be a valid choice if some zone delegation record types have been
       determined to be cryptographically insecure.
       Zone delegation records <span class="bcp14">MUST NOT</span> be stored or published
       under the apex label.
       A zone delegation record type value is the same as the respective ztype
       value.
       The ztype defines the cryptographic primitives for the zone that is
       being delegated to.
       A zone delegation record payload contains the public key of
       the zone to delegate to.
       A zone delegation record <span class="bcp14">MUST</span> have the CRITICAL flag set
       and <span class="bcp14">MUST</span> be the only non-supplemental record under a label.
       There <span class="bcp14">MAY</span> be inactive records of the same type that have
       the SHADOW flag set in order to facilitate smooth key rollovers.<a class="pilcrow" href="#section-5.1-1">¶</a></p>
<p id="section-5.1-2">
       In the following, "||" is the concatenation operator of two byte strings.
       The algorithm specification uses character strings such as GNS labels or
       constant values.
       When used in concatenations or as input to functions, the
       zero terminator of the character strings <span class="bcp14">MUST NOT</span> be
       included.<a class="pilcrow" href="#section-5.1-2">¶</a></p>
<div id="gnsrecords_pkey">
<section id="section-5.1.1">
          <h4 id="name-pkey">
<a class="section-number selfRef" href="#section-5.1.1">5.1.1. </a><a class="section-name selfRef" href="#name-pkey">PKEY</a>
          </h4>
<p id="section-5.1.1-1">
         In GNS, a delegation of a label to a zone of type "PKEY" is
         represented through a PKEY record.  The PKEY DATA entry wire format is illustrated in <a class="auto internal xref" href="#figure_pkeyrecord">Figure 9</a>.<a class="pilcrow" href="#section-5.1.1-1">¶</a></p>
<span id="name-the-pkey-wire-format"></span><div id="figure_pkeyrecord">
<figure id="figure-9">
            <div class="alignLeft art-text artwork" id="section-5.1.1-2.1">
<pre>0     8     16    24    32    40    48    56
+-----+-----+-----+-----+-----+-----+-----+-----+
|                   PUBLIC KEY                  |
|                                               |
|                                               |
|                                               |
+-----+-----+-----+-----+-----+-----+-----+-----+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-9">Figure 9</a>:
<a class="selfRef" href="#name-the-pkey-wire-format">The PKEY Wire Format</a>
            </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-5.1.1-3">
            <dt id="section-5.1.1-3.1">PUBLIC KEY:</dt>
            <dd id="section-5.1.1-3.2" style="margin-left: 1.5em">
           A 256-bit Ed25519 public key.<a class="pilcrow" href="#section-5.1.1-3.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-5.1.1-4">
         For PKEY zones, the zone key material is derived using the
         curve parameters of the twisted Edwards representation
         of Curve25519 <span>[<a class="cite xref" href="#RFC7748">RFC7748</a>]</span> (the reasoning behind choosing
         this curve can be found in <a class="auto internal xref" href="#security_cryptography">Section 9.3</a>)
         with the ECDSA scheme <span>[<a class="cite xref" href="#RFC6979">RFC6979</a>]</span>.
         The following naming convention is used for the cryptographic primitives of PKEY zones:<a class="pilcrow" href="#section-5.1.1-4">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.1.1-5">
            <dt id="section-5.1.1-5.1">d:</dt>
            <dd id="section-5.1.1-5.2" style="margin-left: 1.5em">
           A 256-bit Ed25519 private key (clamped private scalar).<a class="pilcrow" href="#section-5.1.1-5.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.1.1-5.3">zkey:</dt>
            <dd id="section-5.1.1-5.4" style="margin-left: 1.5em">
           The Ed25519 public zone key corresponding to d.<a class="pilcrow" href="#section-5.1.1-5.4">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.1.1-5.5">p:</dt>
            <dd id="section-5.1.1-5.6" style="margin-left: 1.5em">
           The prime of edwards25519 as defined in <span>[<a class="cite xref" href="#RFC7748">RFC7748</a>]</span>, i.e.,
           2<sup>255</sup> - 19.<a class="pilcrow" href="#section-5.1.1-5.6">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.1.1-5.7">G:</dt>
            <dd id="section-5.1.1-5.8" style="margin-left: 1.5em">
           The group generator (X(P),Y(P)). With X(P),Y(P) of edwards25519 as defined in
           <span>[<a class="cite xref" href="#RFC7748">RFC7748</a>]</span>.<a class="pilcrow" href="#section-5.1.1-5.8">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.1.1-5.9">L:</dt>
            <dd id="section-5.1.1-5.10" style="margin-left: 1.5em">
           The order of the prime-order subgroup of edwards25519 as defined in <span>[<a class="cite xref" href="#RFC7748">RFC7748</a>]</span>.<a class="pilcrow" href="#section-5.1.1-5.10">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.1.1-5.11">KeyGen():</dt>
            <dd id="section-5.1.1-5.12" style="margin-left: 1.5em">The generation of the private
           scalar d and the curve point zkey := d*G (where G is the group generator
           of the elliptic curve) as defined in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc6979#section-2.2">Section 2.2</a> of [<a class="cite xref" href="#RFC6979">RFC6979</a>]</span> represents the KeyGen() function.<a class="pilcrow" href="#section-5.1.1-5.12">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-5.1.1-6">
         The zone type and zone key of a PKEY are 4 + 32 bytes in length. This means that
         a zTLD will always fit into a single label and does
         not need any further conversion.
         Given a label, the output zkey' of the ZKDF(zkey, label) function is
         calculated as follows for PKEY zones:<a class="pilcrow" href="#section-5.1.1-6">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1.1-7">
<pre>ZKDF(zkey, label):
  PRK_h := HKDF-Extract("key-derivation", zkey)
  h := HKDF-Expand(PRK_h, label || "gns", 512 / 8)
  zkey' := (h mod L) * zkey
  return zkey'
</pre><a class="pilcrow" href="#section-5.1.1-7">¶</a>
</div>
<p id="section-5.1.1-8">
         The PKEY cryptosystem uses an HMAC-based key derivation function (HKDF) as defined in
         <span>[<a class="cite xref" href="#RFC5869">RFC5869</a>]</span>, using SHA-512 <span>[<a class="cite xref" href="#RFC6234">RFC6234</a>]</span> for the extraction
         phase and SHA-256 <span>[<a class="cite xref" href="#RFC6234">RFC6234</a>]</span> for the expansion phase.
         PRK_h is key material retrieved using an HKDF that uses the string
         "key-derivation" as the salt and the zone key as the initial
         keying material.
         h is the 512-bit HKDF expansion result and must be interpreted in
         network byte order. The expansion information input is
         a concatenation of the label and the string "gns".
         The multiplication of zkey with h in ZKDF() is a point multiplication,
         while the multiplication of d with h in SignDerived() below is a scalar multiplication.<a class="pilcrow" href="#section-5.1.1-8">¶</a></p>
<p id="section-5.1.1-9">
         The Sign() and Verify() functions
         for PKEY zones are implemented using 512-bit ECDSA deterministic
         signatures as specified in <span>[<a class="cite xref" href="#RFC6979">RFC6979</a>]</span>.
         The same functions can be used for derived keys:<a class="pilcrow" href="#section-5.1.1-9">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1.1-10">
<pre>SignDerived(d, label, message):
  zkey := d * G
  PRK_h := HKDF-Extract("key-derivation", zkey)
  h := HKDF-Expand(PRK_h, label || "gns", 512 / 8)
  d' := (h * d) mod L
  return Sign(d', message)
</pre><a class="pilcrow" href="#section-5.1.1-10">¶</a>
</div>
<p id="section-5.1.1-11">
           A signature is valid for the derived public key zkey' := ZKDF(zkey, label) if the following holds:<a class="pilcrow" href="#section-5.1.1-11">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1.1-12">
<pre>VerifyDerived(zkey', message, signature):
  return Verify(zkey', message, signature)
</pre><a class="pilcrow" href="#section-5.1.1-12">¶</a>
</div>
<p id="section-5.1.1-13">
         The S-Encrypt() and S-Decrypt() functions use AES in counter mode
         as defined in <span>[<a class="cite xref" href="#MODES">MODES</a>]</span> (CTR-AES256):<a class="pilcrow" href="#section-5.1.1-13">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1.1-14">
<pre>S-Encrypt(zkey, label, expiration, plaintext):
  PRK_k := HKDF-Extract("gns-aes-ctx-key", zkey)
  PRK_n := HKDF-Extract("gns-aes-ctx-iv", zkey)
  K := HKDF-Expand(PRK_k, label, 256 / 8)
  NONCE := HKDF-Expand(PRK_n, label, 32 / 8)
  BLOCK_COUNTER := 0x0000000000000001
  IV := NONCE || expiration || BLOCK_COUNTER
  return CTR-AES256(K, IV, plaintext)

S-Decrypt(zkey, label, expiration, ciphertext):
  PRK_k := HKDF-Extract("gns-aes-ctx-key", zkey)
  PRK_n := HKDF-Extract("gns-aes-ctx-iv", zkey)
  K := HKDF-Expand(PRK_k, label, 256 / 8)
  NONCE := HKDF-Expand(PRK_n, label, 32 / 8)
  BLOCK_COUNTER := 0x0000000000000001
  IV := NONCE || expiration || BLOCK_COUNTER
  return CTR-AES256(K, IV, ciphertext)
</pre><a class="pilcrow" href="#section-5.1.1-14">¶</a>
</div>
<p id="section-5.1.1-15">
         The key K and counter Initialization Vector (IV) are derived from
         the record label and the zone key zkey, using an HKDF as defined in <span>[<a class="cite xref" href="#RFC5869">RFC5869</a>]</span>.
         SHA-512 <span>[<a class="cite xref" href="#RFC6234">RFC6234</a>]</span> is used for the
         extraction phase and SHA-256 <span>[<a class="cite xref" href="#RFC6234">RFC6234</a>]</span> for the expansion phase.
         The output keying material is 32 bytes (256 bits) for the symmetric
         key and 4 bytes (32 bits) for the NONCE.
         The symmetric key K is a 256-bit AES key <span>[<a class="cite xref" href="#RFC3826">RFC3826</a>]</span>.<a class="pilcrow" href="#section-5.1.1-15">¶</a></p>
<p id="section-5.1.1-16">
         The nonce is combined with a 64-bit IV and a
         32-bit block counter as defined in <span>[<a class="cite xref" href="#RFC3686">RFC3686</a>]</span>.
         The block counter begins with a value of 1, and it is incremented
         to generate subsequent portions of the key stream.
         The block counter is a 32-bit integer value in network byte order.
         The format of the counter IV used by the S-Encrypt() and S-Decrypt()
         functions is illustrated in
         <a class="auto internal xref" href="#figure_hkdf_ivs_pkey">Figure 10</a>.<a class="pilcrow" href="#section-5.1.1-16">¶</a></p>
<span id="name-structure-of-the-counter-iv"></span><div id="figure_hkdf_ivs_pkey">
<figure id="figure-10">
            <div class="alignLeft art-text artwork" id="section-5.1.1-17.1">
<pre>0     8     16    24    32
+-----+-----+-----+-----+
|         NONCE         |
+-----+-----+-----+-----+
|       EXPIRATION      |
|                       |
+-----+-----+-----+-----+
|      BLOCK COUNTER    |
+-----+-----+-----+-----+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-10">Figure 10</a>:
<a class="selfRef" href="#name-structure-of-the-counter-iv">Structure of the Counter IV as Used in S-Encrypt() and
            S-Decrypt()</a>
            </figcaption></figure>
</div>
</section>
</div>
<div id="gnsrecords_edkey">
<section id="section-5.1.2">
          <h4 id="name-edkey">
<a class="section-number selfRef" href="#section-5.1.2">5.1.2. </a><a class="section-name selfRef" href="#name-edkey">EDKEY</a>
          </h4>
<p id="section-5.1.2-1">
         In GNS, a delegation of a label to a zone of type "EDKEY" is
         represented through an EDKEY record.
         The EDKEY DATA entry wire format
         is illustrated in <a class="auto internal xref" href="#figure_edkeyrecord">Figure 11</a>.<a class="pilcrow" href="#section-5.1.2-1">¶</a></p>
<span id="name-the-edkey-data-wire-format"></span><div id="figure_edkeyrecord">
<figure id="figure-11">
            <div class="alignLeft art-text artwork" id="section-5.1.2-2.1">
<pre>0     8     16    24    32    40    48    56
+-----+-----+-----+-----+-----+-----+-----+-----+
|                   PUBLIC KEY                  |
|                                               |
|                                               |
|                                               |
+-----+-----+-----+-----+-----+-----+-----+-----+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-11">Figure 11</a>:
<a class="selfRef" href="#name-the-edkey-data-wire-format">The EDKEY DATA Wire Format</a>
            </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-5.1.2-3">
            <dt id="section-5.1.2-3.1">PUBLIC KEY:</dt>
            <dd id="section-5.1.2-3.2" style="margin-left: 1.5em">
           A 256-bit EdDSA zone key.<a class="pilcrow" href="#section-5.1.2-3.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-5.1.2-4">
           For EDKEY zones, the zone key material is derived using the
           curve parameters of the twisted Edwards representation
           of Curve25519 <span>[<a class="cite xref" href="#RFC7748">RFC7748</a>]</span> (a.k.a. Ed25519)
           with the Ed25519 scheme <span>[<a class="cite xref" href="#ed25519">ed25519</a>]</span> as specified in
           <span>[<a class="cite xref" href="#RFC8032">RFC8032</a>]</span>.
           The following naming convention is used for the
           cryptographic primitives of EDKEY zones:<a class="pilcrow" href="#section-5.1.2-4">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.1.2-5">
            <dt id="section-5.1.2-5.1">d:</dt>
            <dd id="section-5.1.2-5.2" style="margin-left: 1.5em">
             A 256-bit EdDSA private key.<a class="pilcrow" href="#section-5.1.2-5.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.1.2-5.3">a:</dt>
            <dd id="section-5.1.2-5.4" style="margin-left: 1.5em">
             An integer derived from d using the SHA-512 hash function
             as defined in <span>[<a class="cite xref" href="#RFC8032">RFC8032</a>]</span>.<a class="pilcrow" href="#section-5.1.2-5.4">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.1.2-5.5">zkey:</dt>
            <dd id="section-5.1.2-5.6" style="margin-left: 1.5em">
             The EdDSA public key corresponding to d. It is defined
             as the curve point a*G where G is the
             group generator of the elliptic curve
             as defined in <span>[<a class="cite xref" href="#RFC8032">RFC8032</a>]</span>.<a class="pilcrow" href="#section-5.1.2-5.6">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.1.2-5.7">p:</dt>
            <dd id="section-5.1.2-5.8" style="margin-left: 1.5em">
             The prime of edwards25519 as defined in <span>[<a class="cite xref" href="#RFC8032">RFC8032</a>]</span>, i.e.,
             2<sup>255</sup> - 19.<a class="pilcrow" href="#section-5.1.2-5.8">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.1.2-5.9">G:</dt>
            <dd id="section-5.1.2-5.10" style="margin-left: 1.5em">
             The group generator (X(P),Y(P)). With X(P),Y(P) of edwards25519 as defined in
              <span>[<a class="cite xref" href="#RFC8032">RFC8032</a>]</span>.<a class="pilcrow" href="#section-5.1.2-5.10">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.1.2-5.11">L:</dt>
            <dd id="section-5.1.2-5.12" style="margin-left: 1.5em">
             The order of the prime-order subgroup of edwards25519 as defined in <span>[<a class="cite xref" href="#RFC8032">RFC8032</a>]</span>.<a class="pilcrow" href="#section-5.1.2-5.12">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.1.2-5.13">KeyGen():</dt>
            <dd id="section-5.1.2-5.14" style="margin-left: 1.5em">
             The generation of the private key d and the associated public
             key zkey := a*G (where G is the
             group generator of the elliptic curve and a is an integer
             derived from d using the SHA-512 hash function)
             as defined
             in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8032#section-5.1.5">Section 5.1.5</a> of [<a class="cite xref" href="#RFC8032">RFC8032</a>]</span>
 represents the KeyGen()
             function.<a class="pilcrow" href="#section-5.1.2-5.14">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-5.1.2-6">
           The zone type and zone key of an EDKEY are 4 + 32 bytes in length. This means that
           a zTLD will always fit into a single label and does
           not need any further conversion.<a class="pilcrow" href="#section-5.1.2-6">¶</a></p>
<p id="section-5.1.2-7">
           The "EDKEY" ZKDF instantiation is based on <span>[<a class="cite xref" href="#Tor224">Tor224</a>]</span>.
           As noted above for KeyGen(), a is calculated from d using the
           SHA-512 hash function as defined in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8032#section-5.1.5">Section 5.1.5</a> of [<a class="cite xref" href="#RFC8032">RFC8032</a>]</span>.
           Given a label, the output of the ZKDF function is
           calculated as follows:<a class="pilcrow" href="#section-5.1.2-7">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1.2-8">
<pre>ZKDF(zkey, label):
  /* Calculate the blinding factor */
  PRK_h := HKDF-Extract("key-derivation", zkey)
  h := HKDF-Expand(PRK_h, label || "gns", 512 / 8)
  /* Ensure that h == h mod L */
  h := h mod L

  zkey' := h * zkey
  return zkey'
</pre><a class="pilcrow" href="#section-5.1.2-8">¶</a>
</div>
<p id="section-5.1.2-9">
           Implementers <span class="bcp14">SHOULD</span> employ a constant-time scalar
           multiplication for the constructions above to protect against
           timing attacks. Otherwise, timing attacks could leak private key
           material if an attacker can predict when a system starts the
           publication process.<a class="pilcrow" href="#section-5.1.2-9">¶</a></p>
<p id="section-5.1.2-10">
           The EDKEY cryptosystem uses an HKDF as defined in
           <span>[<a class="cite xref" href="#RFC5869">RFC5869</a>]</span>, using SHA-512 <span>[<a class="cite xref" href="#RFC6234">RFC6234</a>]</span> for the extraction
           phase and HMAC-SHA-256 <span>[<a class="cite xref" href="#RFC6234">RFC6234</a>]</span> for the expansion phase.
           PRK_h is key material retrieved using an HKDF that uses the string
           "key-derivation" as the salt and the zone key as the initial
           keying material.
           The blinding factor h is the 512-bit HKDF expansion result.
           The expansion information input is
           a concatenation of the label and the string "gns".
           The result of the HKDF must be clamped and interpreted in network
           byte order.
           a is the 256-bit integer corresponding to the 256-bit private
           key d.
           The multiplication of zkey with h is a point multiplication.<a class="pilcrow" href="#section-5.1.2-10">¶</a></p>
<p id="section-5.1.2-11">
           The Sign(d, message) and Verify(zkey, message, signature) procedures <span class="bcp14">MUST</span>
           be implemented as defined in <span>[<a class="cite xref" href="#RFC8032">RFC8032</a>]</span>.<a class="pilcrow" href="#section-5.1.2-11">¶</a></p>
<p id="section-5.1.2-12">
           Signatures for EDKEY zones use a derived private scalar d';
           this is not compliant with <span>[<a class="cite xref" href="#RFC8032">RFC8032</a>]</span>.
           As the private key that corresponds to the derived private scalar
           is not known, it is not possible to deterministically derive the
           signature part R according to <span>[<a class="cite xref" href="#RFC8032">RFC8032</a>]</span>.
           Instead, signatures <span class="bcp14">MUST</span> be generated as follows for any given
           message and private zone key:
           a nonce is calculated from the highest 32 bytes of the
           expansion of the private key d and the blinding factor h.
           The nonce is then hashed with the message to r.
           This way, the full derivation path is included in the calculation
           of the R value of the signature, ensuring that it is never reused
           for two different derivation paths or messages.<a class="pilcrow" href="#section-5.1.2-12">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1.2-13">
<pre>SignDerived(d, label, message):
  /* Key expansion */
  dh := SHA-512(d)
  /* EdDSA clamping */
  a := dh[0..31]
  a[0] := a[0] &amp; 248
  a[31] := a[31] &amp; 127
  a[31] := a[31] | 64
  /* Calculate zkey corresponding to d */
  zkey := a * G

  /* Calculate blinding factor */
  PRK_h := HKDF-Extract("key-derivation", zkey)
  h := HKDF-Expand(PRK_h, label || "gns", 512 / 8)
  /* Ensure that h == h mod L */
  h := h mod L

  d' := (h * a) mod L
  nonce := SHA-256(dh[32..63] || h)
  r := SHA-512(nonce || message)
  R := r * G
  S := r + SHA-512(R || zkey' || message) * d' mod L
  return (R,S)
</pre><a class="pilcrow" href="#section-5.1.2-13">¶</a>
</div>
<p id="section-5.1.2-14">
           A signature (R,S) is valid for the derived public key zkey' :=
           ZKDF(zkey, label) if the following holds:<a class="pilcrow" href="#section-5.1.2-14">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1.2-15">
<pre>VerifyDerived(zkey', message, signature):
  (R,S) := signature
  return S * G == R + SHA-512(R, zkey', message) * zkey'
</pre><a class="pilcrow" href="#section-5.1.2-15">¶</a>
</div>
<p id="section-5.1.2-16">
           The S-Encrypt() and S-Decrypt() functions use XSalsa20
           as defined in <span>[<a class="cite xref" href="#XSalsa20">XSalsa20</a>]</span>
           and use the XSalsa20-Poly1305 encryption function:<a class="pilcrow" href="#section-5.1.2-16">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1.2-17">
<pre>S-Encrypt(zkey, label, expiration, plaintext):
  PRK_k := HKDF-Extract("gns-xsalsa-ctx-key", zkey)
  PRK_n := HKDF-Extract("gns-xsalsa-ctx-iv", zkey)
  K := HKDF-Expand(PRK_k, label, 256 / 8)
  NONCE := HKDF-Expand(PRK_n, label, 128 / 8)
  IV := NONCE || expiration
  return XSalsa20-Poly1305(K, IV, plaintext)

S-Decrypt(zkey, label, expiration, ciphertext):
  PRK_k := HKDF-Extract("gns-xsalsa-ctx-key", zkey)
  PRK_n := HKDF-Extract("gns-xsalsa-ctx-iv", zkey)
  K := HKDF-Expand(PRK_k, label, 256 / 8)
  NONCE := HKDF-Expand(PRK_n, label, 128 / 8)
  IV := NONCE || expiration
  return XSalsa20-Poly1305(K, IV, ciphertext)
</pre><a class="pilcrow" href="#section-5.1.2-17">¶</a>
</div>
<p id="section-5.1.2-18">
           The result of the XSalsa20-Poly1305 encryption function is the encrypted
           ciphertext followed by the 128-bit authentication
           tag.
           Accordingly, the length of encrypted data equals the length of the
           data plus the 16 bytes of the authentication tag.<a class="pilcrow" href="#section-5.1.2-18">¶</a></p>
<p id="section-5.1.2-19">
           The key K and counter IV are derived from
           the record label and the zone key zkey using an HKDF as defined in
           <span>[<a class="cite xref" href="#RFC5869">RFC5869</a>]</span>.
           SHA-512 <span>[<a class="cite xref" href="#RFC6234">RFC6234</a>]</span> is used for the
           extraction phase and SHA-256 <span>[<a class="cite xref" href="#RFC6234">RFC6234</a>]</span> for the expansion phase.
           The output keying material is 32 bytes (256 bits) for the symmetric
           key and 16 bytes (128 bits) for the NONCE.
           The symmetric key K is a 256-bit XSalsa20 key
           <span>[<a class="cite xref" href="#XSalsa20">XSalsa20</a>]</span>.
           No additional authenticated data (AAD) is used.<a class="pilcrow" href="#section-5.1.2-19">¶</a></p>
<p id="section-5.1.2-20">
           The nonce is combined with an 8-byte IV.
           The IV is the expiration time of the
           resource record block in network byte order.
           The resulting counter (IV) wire format is illustrated in
           <a class="auto internal xref" href="#figure_hkdf_ivs_edkey">Figure 12</a>.<a class="pilcrow" href="#section-5.1.2-20">¶</a></p>
<span id="name-the-counter-block-initializ"></span><div id="figure_hkdf_ivs_edkey">
<figure id="figure-12">
            <div class="alignLeft art-text artwork" id="section-5.1.2-21.1">
<pre>0     8     16    24    32    40    48    56
+-----+-----+-----+-----+-----+-----+-----+-----+
|                     NONCE                     |
|                                               |
+-----+-----+-----+-----+-----+-----+-----+-----+
|                   EXPIRATION                  |
+-----+-----+-----+-----+-----+-----+-----+-----+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-12">Figure 12</a>:
<a class="selfRef" href="#name-the-counter-block-initializ">The Counter Block Initialization Vector</a>
            </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="gnsrecords_redirect">
<section id="section-5.2">
        <h3 id="name-redirection-records">
<a class="section-number selfRef" href="#section-5.2">5.2. </a><a class="section-name selfRef" href="#name-redirection-records">Redirection Records</a>
        </h3>
<p id="section-5.2-1">
       Redirection records are used to redirect resolution.
       Any implementation <span class="bcp14">SHOULD</span> support all redirection record types defined here
       and <span class="bcp14">MAY</span> support any number of additional redirection records defined in
       the GANA "GNS Record Types" registry <span>[<a class="cite xref" href="#GANA">GANA</a>]</span>.
       Redirection records <span class="bcp14">MUST</span> have the CRITICAL flag set.
       Not supporting some record types can result in resolution failures.
       This can be a valid choice if some redirection record types have been
       determined to be insecure, or if an application has reasons to not
       support redirection to DNS for reasons such as complexity or security.
       Redirection records <span class="bcp14">MUST NOT</span> be stored or published under the apex label.<a class="pilcrow" href="#section-5.2-1">¶</a></p>
<div id="gnsrecords_rdr">
<section id="section-5.2.1">
          <h4 id="name-redirect">
<a class="section-number selfRef" href="#section-5.2.1">5.2.1. </a><a class="section-name selfRef" href="#name-redirect">REDIRECT</a>
          </h4>
<p id="section-5.2.1-1">
         A REDIRECT record is the GNS equivalent of a CNAME record in DNS.
         A REDIRECT record <span class="bcp14">MUST</span> be the only non-supplemental
         record under a label.
         There <span class="bcp14">MAY</span> be inactive records of the same type that have
         the SHADOW flag set in order to facilitate smooth changes of redirection
         targets.
         No other records are allowed.
         Details on the processing of this record are provided in <a class="auto internal xref" href="#redirect_processing">Section 7.3.1</a>.

         A REDIRECT DATA entry is illustrated in <a class="auto internal xref" href="#figure_redirectrecord">Figure 13</a>.<a class="pilcrow" href="#section-5.2.1-1">¶</a></p>
<span id="name-the-redirect-data-wire-form"></span><div id="figure_redirectrecord">
<figure id="figure-13">
            <div class="alignLeft art-text artwork" id="section-5.2.1-2.1">
<pre>0     8     16    24    32    40    48    56
+-----+-----+-----+-----+-----+-----+-----+-----+
|                   REDIRECT NAME               |
/                                               /
/                                               /
|                                               |
+-----+-----+-----+-----+-----+-----+-----+-----+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-13">Figure 13</a>:
<a class="selfRef" href="#name-the-redirect-data-wire-form">The REDIRECT DATA Wire Format</a>
            </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-5.2.1-3">
            <dt id="section-5.2.1-3.1">REDIRECT NAME:</dt>
            <dd id="section-5.2.1-3.2" style="margin-left: 1.5em">
           The name to continue with.
           This value can be a regular name or a relative
           name.
           Relative GNS names are indicated by an extension label (U+002B ("+"))
           as the rightmost label.
           The string is UTF-8 encoded and zero terminated.<a class="pilcrow" href="#section-5.2.1-3.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="gnsrecords_gns2dns">
<section id="section-5.2.2">
          <h4 id="name-gns2dns">
<a class="section-number selfRef" href="#section-5.2.2">5.2.2. </a><a class="section-name selfRef" href="#name-gns2dns">GNS2DNS</a>
          </h4>
<p id="section-5.2.2-1">
         A GNS2DNS record delegates resolution to DNS.
         The resource record contains a DNS name for the resolver to continue with
         in DNS followed by a DNS server. Both names are in the format defined in
         <span>[<a class="cite xref" href="#RFC1034">RFC1034</a>]</span> for DNS names.
         There <span class="bcp14">MAY</span> be multiple GNS2DNS records under a label.
         There <span class="bcp14">MAY</span> also be DNSSEC DS records or any other records used to
         secure the connection with the DNS servers under the same label.
         There <span class="bcp14">MAY</span> be inactive records of the same type or types that have
         the SHADOW flag set in order to facilitate smooth changes of redirection
         targets.
         No other non-supplemental record types are allowed in the same record set.
         A GNS2DNS DATA entry is illustrated in <a class="auto internal xref" href="#figure_gns2dnsrecord">Figure 14</a>.<a class="pilcrow" href="#section-5.2.2-1">¶</a></p>
<span id="name-the-gns2dns-data-wire-forma"></span><div id="figure_gns2dnsrecord">
<figure id="figure-14">
            <div class="alignLeft art-text artwork" id="section-5.2.2-2.1">
<pre>0     8     16    24    32    40    48    56
+-----+-----+-----+-----+-----+-----+-----+-----+
|                      NAME                     |
/                                               /
/                                               /
|                                               |
+-----+-----+-----+-----+-----+-----+-----+-----+
|                 DNS SERVER NAME               |
/                                               /
/                                               /
|                                               |
+-----------------------------------------------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-14">Figure 14</a>:
<a class="selfRef" href="#name-the-gns2dns-data-wire-forma">The GNS2DNS DATA Wire Format</a>
            </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-5.2.2-3">
            <dt id="section-5.2.2-3.1">NAME:</dt>
            <dd id="section-5.2.2-3.2" style="margin-left: 1.5em">
           The name to continue with in DNS. The value is UTF-8 encoded and
           zero terminated.<a class="pilcrow" href="#section-5.2.2-3.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.2-3.3">DNS SERVER NAME:</dt>
            <dd id="section-5.2.2-3.4" style="margin-left: 1.5em">
           The DNS server to use. This value can be an IPv4 address in dotted-decimal
           form, an IPv6 address in colon-hexadecimal form, or a DNS name.
           It can also be a relative GNS name ending with a
           "+" as the rightmost label.
           The implementation <span class="bcp14">MUST</span> check the string syntactically for
           an IP address in the respective notation before checking for a
           relative GNS name.
           If all three checks fail, the name <span class="bcp14">MUST</span> be treated as a DNS name.
           The value is UTF-8 encoded and zero terminated.<a class="pilcrow" href="#section-5.2.2-3.4">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-5.2.2-4">
         NOTE: If an application uses DNS names obtained from GNS2DNS records
         in a DNS request, they <span class="bcp14">MUST</span> first be converted to an IDNA-compliant
         representation <span>[<a class="cite xref" href="#RFC5890">RFC5890</a>]</span>.<a class="pilcrow" href="#section-5.2.2-4">¶</a></p>
</section>
</div>
</section>
</div>
<div id="gnsrecords_other">
<section id="section-5.3">
        <h3 id="name-auxiliary-records">
<a class="section-number selfRef" href="#section-5.3">5.3. </a><a class="section-name selfRef" href="#name-auxiliary-records">Auxiliary Records</a>
        </h3>
<p id="section-5.3-1">
         This section defines the initial set of auxiliary GNS record types. Any
         implementation <span class="bcp14">SHOULD</span> be able to process the specified record types
         according to <a class="auto internal xref" href="#record_processing">Section 7.3</a>.<a class="pilcrow" href="#section-5.3-1">¶</a></p>
<div id="gnsrecords_leho">
<section id="section-5.3.1">
          <h4 id="name-leho">
<a class="section-number selfRef" href="#section-5.3.1">5.3.1. </a><a class="section-name selfRef" href="#name-leho">LEHO</a>
          </h4>
<p id="section-5.3.1-1">
         The LEHO (LEgacy HOstname) record is used to provide a hint for legacy hostnames:
         applications can use the GNS to look up IPv4 or IPv6 addresses of
         Internet services.
         However, connecting to such services sometimes not only requires
         the knowledge of an IP address and port but also requires the canonical
         DNS name of the service to be transmitted over the transport protocol.
         In GNS, legacy hostname records provide applications the DNS name that
         is required to establish a connection to such a service.
         The most common use case is HTTP virtual hosting and TLS Server Name
         Indication <span>[<a class="cite xref" href="#RFC6066">RFC6066</a>]</span>, where a DNS name must
         be supplied in the HTTP "Host"-header and the TLS handshake,
         respectively.
         Using a GNS name in those cases might not work, as
         it might not be globally unique. Furthermore, even if uniqueness is
         not an issue, the legacy service might not even be aware of GNS.<a class="pilcrow" href="#section-5.3.1-1">¶</a></p>
<p id="section-5.3.1-2">
         A LEHO resource record is expected to be found together with A or AAAA
         resource records with IPv4 or IPv6 addresses.
           A LEHO DATA entry is illustrated in <a class="auto internal xref" href="#figure_lehorecord">Figure 15</a>.<a class="pilcrow" href="#section-5.3.1-2">¶</a></p>
<span id="name-the-leho-data-wire-format"></span><div id="figure_lehorecord">
<figure id="figure-15">
            <div class="alignLeft art-text artwork" id="section-5.3.1-3.1">
<pre>0     8     16    24    32    40    48    56
+-----+-----+-----+-----+-----+-----+-----+-----+
|                 LEGACY HOSTNAME               |
/                                               /
/                                               /
|                                               |
+-----+-----+-----+-----+-----+-----+-----+-----+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-15">Figure 15</a>:
<a class="selfRef" href="#name-the-leho-data-wire-format">The LEHO DATA Wire Format</a>
            </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-5.3.1-4">
            <dt id="section-5.3.1-4.1">LEGACY HOSTNAME:</dt>
            <dd id="section-5.3.1-4.2" style="margin-left: 1.5em">
           A UTF-8 string (which is not zero terminated) representing the legacy hostname.<a class="pilcrow" href="#section-5.3.1-4.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-5.3.1-5">
         NOTE: If an application uses a LEHO value in an HTTP request header
         (e.g., a "Host"-header), it <span class="bcp14">MUST</span> be converted to an IDNA-compliant representation
         <span>[<a class="cite xref" href="#RFC5890">RFC5890</a>]</span>.<a class="pilcrow" href="#section-5.3.1-5">¶</a></p>
</section>
</div>
<div id="gnsrecords_nick">
<section id="section-5.3.2">
          <h4 id="name-nick">
<a class="section-number selfRef" href="#section-5.3.2">5.3.2. </a><a class="section-name selfRef" href="#name-nick">NICK</a>
          </h4>
<p id="section-5.3.2-1">
         Nickname records can be used by zone administrators to publish a
         label that a zone prefers to have used when it is referred to.
         This is a suggestion for other zones regarding what label to use when creating a
         delegation record (<a class="auto internal xref" href="#gnsrecords_delegation">Section 5.1</a>) containing
         this zone key.
         This record <span class="bcp14">SHOULD</span> only be stored locally
         under the apex label "@" but <span class="bcp14">MAY</span> be
         returned with record sets under any label as a supplemental record.
         <a class="auto internal xref" href="#nick_processing">Section 7.3.5</a> details how a resolver must process
         supplemental and non-supplemental NICK records.
         A NICK DATA entry is illustrated in <a class="auto internal xref" href="#figure_nickrecord">Figure 16</a>.<a class="pilcrow" href="#section-5.3.2-1">¶</a></p>
<span id="name-the-nick-data-wire-format"></span><div id="figure_nickrecord">
<figure id="figure-16">
            <div class="alignLeft art-text artwork" id="section-5.3.2-2.1">
<pre>0     8     16    24    32    40    48    56
+-----+-----+-----+-----+-----+-----+-----+-----+
|                  NICKNAME                     |
/                                               /
/                                               /
|                                               |
+-----+-----+-----+-----+-----+-----+-----+-----+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-16">Figure 16</a>:
<a class="selfRef" href="#name-the-nick-data-wire-format">The NICK DATA Wire Format</a>
            </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-5.3.2-3">
            <dt id="section-5.3.2-3.1">NICKNAME:</dt>
            <dd id="section-5.3.2-3.2" style="margin-left: 1.5em">
           A UTF-8 string (which is not zero terminated) representing the preferred
           label of the zone. This string <span class="bcp14">MUST</span> be a valid GNS label.<a class="pilcrow" href="#section-5.3.2-3.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="gnsrecords_box">
<section id="section-5.3.3">
          <h4 id="name-box">
<a class="section-number selfRef" href="#section-5.3.3">5.3.3. </a><a class="section-name selfRef" href="#name-box">BOX</a>
          </h4>
<p id="section-5.3.3-1">
         GNS lookups are expected to return all of the required useful
         information in one record set. This avoids unnecessary additional
         lookups and cryptographically ties together information that belongs
         together, making it impossible for an adversarial storage entity to provide
         partial answers that might omit information critical for security.<a class="pilcrow" href="#section-5.3.3-1">¶</a></p>
<p id="section-5.3.3-2">
         This general strategy is incompatible with the
         special labels used by DNS for SRV and TLSA records.  Thus, GNS
         defines the BOX record format to box up SRV and TLSA records and
         include them in the record set of the label they are associated
         with.  For example, a
         TLSA record for "_https._tcp.example.org" will be stored in the record set of
         "example.org" as a BOX record with service (SVC) 443 (https), protocol (PROTO) 6
         (tcp), and record TYPE "TLSA".
         For reference, see also <span>[<a class="cite xref" href="#RFC2782">RFC2782</a>]</span>.
           A BOX DATA entry is illustrated in <a class="auto internal xref" href="#figure_boxrecord">Figure 17</a>.<a class="pilcrow" href="#section-5.3.3-2">¶</a></p>
<span id="name-the-box-data-wire-format"></span><div id="figure_boxrecord">
<figure id="figure-17">
            <div class="alignLeft art-text artwork" id="section-5.3.3-3.1">
<pre>0     8     16    24    32    40    48    56
+-----+-----+-----+-----+-----+-----+-----+-----+
|   PROTO   |    SVC    |       TYPE            |
+-----------+-----------------------------------+
|                 RECORD DATA                   |
/                                               /
/                                               /
|                                               |
+-----+-----+-----+-----+-----+-----+-----+-----+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-17">Figure 17</a>:
<a class="selfRef" href="#name-the-box-data-wire-format">The BOX DATA Wire Format</a>
            </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-5.3.3-4">
            <dt id="section-5.3.3-4.1">PROTO:</dt>
            <dd id="section-5.3.3-4.2" style="margin-left: 1.5em">
           The 16-bit protocol number in network byte order.
           Values
           below 2<sup>8</sup> are reserved for 8-bit Internet Protocol numbers allocated by IANA <span>[<a class="cite xref" href="#RFC5237">RFC5237</a>]</span>
           (e.g., 6 for TCP).
           Values above 2<sup>8</sup> are allocated by the
           GANA "GNUnet Overlay Protocols" registry <span>[<a class="cite xref" href="#GANA">GANA</a>]</span>.<a class="pilcrow" href="#section-5.3.3-4.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.3.3-4.3">SVC:</dt>
            <dd id="section-5.3.3-4.4" style="margin-left: 1.5em">
           The 16-bit service value of the boxed record in network byte order. In the case of
           TCP and UDP, it is the port number.<a class="pilcrow" href="#section-5.3.3-4.4">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.3.3-4.5">TYPE:</dt>
            <dd id="section-5.3.3-4.6" style="margin-left: 1.5em">
           The 32-bit record type of the boxed record in network byte order.<a class="pilcrow" href="#section-5.3.3-4.6">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.3.3-4.7">RECORD DATA:</dt>
            <dd id="section-5.3.3-4.8" style="margin-left: 1.5em">
           A variable-length field containing the "DATA" format of TYPE as
           defined for the respective TYPE.  Thus, for TYPE values below 2<sup>16</sup>, the
           format is the same as the respective record type's binary format in DNS.<a class="pilcrow" href="#section-5.3.3-4.8">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="publish">
<section id="section-6">
      <h2 id="name-record-encoding-for-remote-">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-record-encoding-for-remote-">Record Encoding for Remote Storage</a>
      </h2>
<p id="section-6-1">
       Any API that allows storing a block under a 512-bit key and retrieving
       one or more blocks from a key can be used by an implementation for remote storage.
       To be useful, and to be able to support the defined zone delegation
       record encodings, the API <span class="bcp14">MUST</span> permit storing blocks of size
       176 bytes or more and <span class="bcp14">SHOULD</span> allow blocks of size 1024 bytes
       or more.
       In the following, it is assumed that an implementation realizes two
       procedures on top of storage:<a class="pilcrow" href="#section-6-1">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6-2">
<pre>PUT(key, block)
GET(key) -&gt; block
</pre><a class="pilcrow" href="#section-6-2">¶</a>
</div>
<p id="section-6-3">
       A GNS implementation publishes blocks
       in accordance with the properties and recommendations of the underlying
       remote storage. This can include a periodic refresh operation to preserve the
       availability of published blocks.<a class="pilcrow" href="#section-6-3">¶</a></p>
<p id="section-6-4">
       There is no mechanism for explicitly deleting individual blocks from remote storage.
       However, blocks include an EXPIRATION field, which guides remote
       storage implementations to decide when to delete blocks.  Given multiple blocks
       for the same key, remote storage implementations <span class="bcp14">SHOULD</span> try
       to preserve and return the block with the largest EXPIRATION value.<a class="pilcrow" href="#section-6-4">¶</a></p>
<p id="section-6-5">
       All resource records from the same zone sharing the same label are
       encrypted and published together in a single resource record block
       (RRBLOCK) in the remote storage under a key q, as illustrated
       in <a class="auto internal xref" href="#figure_storage_publish">Figure 18</a>.
       A GNS implementation <span class="bcp14">MUST NOT</span> include expired resource
       records in blocks.
       An implementation <span class="bcp14">MUST</span> use the PUT storage procedure
       when record sets change to update the zone contents.  Implementations
       <span class="bcp14">MUST</span> ensure that the EXPIRATION fields of RRBLOCKs
       increase strictly monotonically for every change, even if the smallest
       expiration time of records in the block does not increase.<a class="pilcrow" href="#section-6-5">¶</a></p>
<span id="name-management-and-publication-"></span><div id="figure_storage_publish">
<figure id="figure-18">
        <div class="alignLeft art-text artwork" id="section-6-6.1">
<pre>                            Local Host           |   Remote
                                                 |   Storage
                                                 |
                                                 |    +---------+
                                                 |   /         /|
                                                 |  +---------+ |
+-----------+                                    |  |         | |
|           |       +-----------+PUT(q, RRBLOCK) |  | Record  | |
|    User   |       |   Zone    |----------------|-&gt;| Storage | |
|           |       | Publisher |                |  |         |/
+-----------+       +-----------+                |  +---------+
     |                     A                     |
     |                     | Zone records        |
     |                     | grouped by label    |
     |                     |                     |
     |                 +---------+               |
     |Create / Delete /    |    /|               |
     |and Update     +---------+ |               |
     |Local Zones    |         | |               |
     |               |  Local  | |               |
     +--------------&gt;|  Zones  | |               |
                     |         |/                |
                     +---------+                 |
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-18">Figure 18</a>:
<a class="selfRef" href="#name-management-and-publication-">Management and Publication of Local Zones in Distributed Storage</a>
        </figcaption></figure>
</div>
<p id="section-6-7">
       Storage key derivation and record
       block creation are specified in the following sections and
       illustrated in <a class="auto internal xref" href="#figure_storage_derivations">Figure 19</a>.<a class="pilcrow" href="#section-6-7">¶</a></p>
<span id="name-storage-key-and-record-bloc"></span><div id="figure_storage_derivations">
<figure id="figure-19">
        <div class="alignLeft art-text artwork" id="section-6-8.1">
<pre>+----------+ +-------+ +------------+ +-------------+
| Zone Key | | Label | | Record Set | | Private Key |
+----------+ +-------+ +------------+ +-------------+
    |          |            |               |
    |          |            v               |
    |          |           +-----------+    |
    |          +----------&gt;| S-Encrypt |    |
    +----------|----------&gt;+-----------+    |
    |          |               |    |       |
    |          |               |    v       v
    |          |               |   +-------------+
    |          +---------------|--&gt;| SignDerived |
    |          |               |   +-------------+
    |          |               |        |
    |          v               v        v
    |      +------+        +--------------+
    +-----&gt;| ZKDF |-------&gt;| Record Block |
           +------+        +--------------+
              |
              v
           +------+        +-------------+
           | Hash |-------&gt;| Storage Key |
           +------+        +-------------+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-19">Figure 19</a>:
<a class="selfRef" href="#name-storage-key-and-record-bloc">Storage Key and Record Block Creation Overview</a>
        </figcaption></figure>
</div>
<div id="blinding">
<section id="section-6.1">
        <h3 id="name-the-storage-key">
<a class="section-number selfRef" href="#section-6.1">6.1. </a><a class="section-name selfRef" href="#name-the-storage-key">The Storage Key</a>
        </h3>
<p id="section-6.1-1">
         The storage key is derived from the zone key and the respective
         label of the contained records.
         The required knowledge of both the zone key and the label in combination
         with the similarly derived symmetric secret keys and blinded zone keys
         ensures query privacy (see <span>[<a class="cite xref" href="#RFC8324">RFC8324</a>], <a class="relref" href="https://rfc-editor.org/rfc/rfc8324#section-3.5">Section 3.5</a></span>).<a class="pilcrow" href="#section-6.1-1">¶</a></p>
<p id="section-6.1-2">
         Given a label, the storage key q is derived as follows:<a class="pilcrow" href="#section-6.1-2">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.1-3">
<pre>q := SHA-512(ZKDF(zkey, label))
</pre><a class="pilcrow" href="#section-6.1-3">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-6.1-4">
          <dt id="section-6.1-4.1">label:</dt>
          <dd id="section-6.1-4.2" style="margin-left: 1.5em">A UTF-8 string under which the resource records are published.<a class="pilcrow" href="#section-6.1-4.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-4.3">zkey:</dt>
          <dd id="section-6.1-4.4" style="margin-left: 1.5em">
           The zone key.<a class="pilcrow" href="#section-6.1-4.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-4.5">q:</dt>
          <dd id="section-6.1-4.6" style="margin-left: 1.5em">
           The 512-bit storage key under which the resource record block is
           published.
           It is the SHA-512 hash <span>[<a class="cite xref" href="#RFC6234">RFC6234</a>]</span> over the derived zone key.<a class="pilcrow" href="#section-6.1-4.6">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="rdata">
<section id="section-6.2">
        <h3 id="name-plaintext-record-data-rdata">
<a class="section-number selfRef" href="#section-6.2">6.2. </a><a class="section-name selfRef" href="#name-plaintext-record-data-rdata">Plaintext Record Data (RDATA)</a>
        </h3>
<p id="section-6.2-1">
         GNS records from a zone are grouped by their labels such that all
         records under the same label are published together as a single
         block in storage. Such grouped record sets <span class="bcp14">MAY</span> be paired with
         supplemental records.<a class="pilcrow" href="#section-6.2-1">¶</a></p>
<p id="section-6.2-2">
         Record data (RDATA) is the format used to encode such a group of GNS records.
         The binary format of RDATA is illustrated in
         <a class="auto internal xref" href="#figure_rdata">Figure 20</a>.<a class="pilcrow" href="#section-6.2-2">¶</a></p>
<span id="name-the-rdata-wire-format"></span><div id="figure_rdata">
<figure id="figure-20">
          <div class="alignLeft art-text artwork" id="section-6.2-3.1">
<pre>0     8     16    24    32    40    48    56
+-----+-----+-----+-----+-----+-----+-----+-----+
|                 EXPIRATION                    |
+-----+-----+-----+-----+-----+-----+-----+-----+
|    SIZE   |    FLAGS  |        TYPE           |
+-----+-----+-----+-----+-----+-----+-----+-----+
|                      DATA                     /
/                                               /
/                                               /
+-----+-----+-----+-----+-----+-----+-----+-----+
|                   EXPIRATION                  |
+-----+-----+-----+-----+-----+-----+-----+-----+
|    SIZE   |    FLAGS  |        TYPE           |
+-----+-----+-----+-----+-----+-----+-----+-----+
|                     DATA                      /
/                                               /
+-----+-----+-----+-----+-----+-----+-----+-----+
|                     PADDING                   /
/                                               /
+-----+-----+-----+-----+-----+-----+-----+-----+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-20">Figure 20</a>:
<a class="selfRef" href="#name-the-rdata-wire-format">The RDATA Wire Format</a>
          </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-6.2-4">
          <dt id="section-6.2-4.1">EXPIRATION, SIZE, TYPE, FLAGS, and DATA:</dt>
          <dd id="section-6.2-4.2" style="margin-left: 1.5em">
           Definitions for these fields are provided below <a class="auto internal xref" href="#figure_gnsrecord">Figure 7</a>
           in <a class="auto internal xref" href="#rrecords">Section 5</a>.<a class="pilcrow" href="#section-6.2-4.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-4.3">PADDING:</dt>
          <dd id="section-6.2-4.4" style="margin-left: 1.5em">
           When serializing records into RDATA, a GNS implementation <span class="bcp14">MUST</span> ensure that
           the size of the RDATA is a power of two
           using this field. The field <span class="bcp14">MUST</span> be set to zero and <span class="bcp14">MUST</span> be
           ignored on receipt.
           As a special exception, record sets with (only) a zone delegation
           record type are never padded.<a class="pilcrow" href="#section-6.2-4.4">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="records_block">
<section id="section-6.3">
        <h3 id="name-the-resource-record-block">
<a class="section-number selfRef" href="#section-6.3">6.3. </a><a class="section-name selfRef" href="#name-the-resource-record-block">The Resource Record Block</a>
        </h3>
<p id="section-6.3-1">
         The resource records grouped in an RDATA are encrypted using the S-Encrypt()
         function defined by the zone type of the zone to which the resource records belong
         and prefixed with metadata into a resource record block (RRBLOCK) for remote storage.
         The GNS RRBLOCK wire format is illustrated in
         <a class="auto internal xref" href="#figure_record_block">Figure 21</a>.<a class="pilcrow" href="#section-6.3-1">¶</a></p>
<span id="name-the-rrblock-wire-format"></span><div id="figure_record_block">
<figure id="figure-21">
          <div class="alignLeft art-text artwork" id="section-6.3-2.1">
<pre>0     8     16    24    32    40    48    56
+-----+-----+-----+-----+-----+-----+-----+-----+
|          SIZE         |    ZONE TYPE          |
+-----+-----+-----+-----+-----+-----+-----+-----+
|                  ZONE KEY                     /
/                  (BLINDED)                    /
|                                               |
+-----+-----+-----+-----+-----+-----+-----+-----+
|                   SIGNATURE                   |
/                                               /
/                                               /
|                                               |
+-----+-----+-----+-----+-----+-----+-----+-----+
|                   EXPIRATION                  |
+-----+-----+-----+-----+-----+-----+-----+-----+
|                    BDATA                      |
/                                               /
/                                               /
+-----+-----+-----+-----+-----+-----+-----+-----+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-21">Figure 21</a>:
<a class="selfRef" href="#name-the-rrblock-wire-format">The RRBLOCK Wire Format</a>
          </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-6.3-3">
          <dt id="section-6.3-3.1">SIZE:</dt>
          <dd id="section-6.3-3.2" style="margin-left: 1.5em">
           A 32-bit value containing the length of the block in bytes in network byte order.
           Despite the message format's use of a 32-bit value,
           implementations <span class="bcp14">MAY</span> refuse to publish blocks beyond a certain
           size significantly below the theoretical block size limit of 4 GB.<a class="pilcrow" href="#section-6.3-3.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.3-3.3">ZONE TYPE:</dt>
          <dd id="section-6.3-3.4" style="margin-left: 1.5em">
           The 32-bit ztype in network byte order.<a class="pilcrow" href="#section-6.3-3.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.3-3.5">ZONE KEY (BLINDED):</dt>
          <dd id="section-6.3-3.6" style="margin-left: 1.5em">
           The blinded zone key "ZKDF(zkey, label)"
           to be used to verify SIGNATURE.
           The length and format of the blinded public key depend on the ztype.<a class="pilcrow" href="#section-6.3-3.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.3-3.7">SIGNATURE:</dt>
          <dd id="section-6.3-3.8" style="margin-left: 1.5em">
           The signature is computed over the EXPIRATION and BDATA fields
           as shown in <a class="auto internal xref" href="#figure_rrsigwithpseudo">Figure 22</a>.
           The length and format of the signature depend on the ztype.
           The signature is created using the SignDerived() function of
           the cryptosystem of the zone (see <a class="auto internal xref" href="#zones">Section 4</a>).<a class="pilcrow" href="#section-6.3-3.8">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.3-3.9">EXPIRATION:</dt>
          <dd id="section-6.3-3.10" style="margin-left: 1.5em">
           Specifies when the RRBLOCK expires and the encrypted block
           <span class="bcp14">SHOULD</span> be removed from storage and caches, as it is likely stale.
           However, applications <span class="bcp14">MAY</span> continue to use non-expired individual
           records until they expire.  The RRBLOCK expiration value <span class="bcp14">MUST</span> be computed by first determining for each record type present in the RRBLOCK the maximum expiration time of all records of that type, including shadow
records. Then, the minimum of all of these expiration times is taken. The final expiration time is then the larger value of (1) the previous EXPIRATION value of a previous RRBLOCK for the same storage key plus one (if any) and (2) the computed minimum expiration time across the contained record types. This ensures strict monotonicity (see <a class="auto internal xref" href="#security_cryptography">Section 9.3</a>).
           This is a 64-bit absolute date in microseconds since midnight
           (0 hour), January 1, 1970 UTC in network byte order.<a class="pilcrow" href="#section-6.3-3.10">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.3-3.11">BDATA:</dt>
          <dd id="section-6.3-3.12" style="margin-left: 1.5em">
           The encrypted RDATA computed using S-Encrypt() with the
           zone key, label, and expiration time as additional inputs.
           Its ultimate size and content are determined by
           the S-Encrypt() function of the ztype.<a class="pilcrow" href="#section-6.3-3.12">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-6.3-4">
         The signature over the public key covers a 32-bit pseudo header
         conceptually prefixed to the EXPIRATION and BDATA fields.
         The wire format is illustrated
         in <a class="auto internal xref" href="#figure_rrsigwithpseudo">Figure 22</a>.<a class="pilcrow" href="#section-6.3-4">¶</a></p>
<span id="name-the-wire-format-used-for-cr"></span><div id="figure_rrsigwithpseudo">
<figure id="figure-22">
          <div class="alignLeft art-text artwork" id="section-6.3-5.1">
<pre>0     8     16    24    32    40    48    56
+-----+-----+-----+-----+-----+-----+-----+-----+
|         SIZE          |       PURPOSE (0x0F)  |
+-----+-----+-----+-----+-----+-----+-----+-----+
|                   EXPIRATION                  |
+-----+-----+-----+-----+-----+-----+-----+-----+
|                    BDATA                      |
/                                               /
/                                               /
+-----+-----+-----+-----+-----+-----+-----+-----+
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-22">Figure 22</a>:
<a class="selfRef" href="#name-the-wire-format-used-for-cr">The Wire Format Used for Creating the Signature of the RRBLOCK</a>
          </figcaption></figure>
</div>
<span class="break"></span><dl class="dlParallel" id="section-6.3-6">
          <dt id="section-6.3-6.1">SIZE:</dt>
          <dd id="section-6.3-6.2" style="margin-left: 1.5em">
           A 32-bit value containing the length of the signed data in bytes
           in network byte order.<a class="pilcrow" href="#section-6.3-6.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.3-6.3">PURPOSE:</dt>
          <dd id="section-6.3-6.4" style="margin-left: 1.5em">
           A 32-bit signature purpose flag in network byte order. The value of this
           field <span class="bcp14">MUST</span> be 15.  It defines the context in which
           the signature is created so that it cannot be reused in other parts
           of the protocol that might include possible future extensions.
           The value of this field corresponds to an entry in the
           GANA "GNUnet Signature Purposes" registry <span>[<a class="cite xref" href="#GANA">GANA</a>]</span>.<a class="pilcrow" href="#section-6.3-6.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.3-6.5">EXPIRATION:</dt>
          <dd id="section-6.3-6.6" style="margin-left: 1.5em">
           Field as defined in the RRBLOCK message above.<a class="pilcrow" href="#section-6.3-6.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.3-6.7">BDATA:</dt>
          <dd id="section-6.3-6.8" style="margin-left: 1.5em">Field as defined in the RRBLOCK message above.<a class="pilcrow" href="#section-6.3-6.8">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="resolution">
<section id="section-7">
      <h2 id="name-name-resolution">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-name-resolution">Name Resolution</a>
      </h2>
<p id="section-7-1">
       Names in GNS are resolved by recursively querying the record storage.
       Recursive in this context means that a resolver does not provide
       intermediate results for a query to the application.
       Instead, it <span class="bcp14">MUST</span> respond to a resolution request with either the
       requested resource record or an error message if resolution
       fails.
       <a class="auto internal xref" href="#figure_resolution">Figure 23</a> illustrates how an application
       requests the lookup of a GNS name (1).
       The application <span class="bcp14">MAY</span> provide a desired record type to the resolver.
       Subsequently, a Start Zone is determined (2) and the recursive
       resolution process started.
       This is where the desired record type is used to guide processing.
       For example, if a zone delegation record type is requested, the
       resolution of the apex label in that zone must be skipped, as
       the desired record is already found.
       Details on how the resolution process is initiated and each iterative
       result (3a,3b) in the resolution is processed are provided in the sections below.
       The results of the lookup are eventually returned to the application (4).
       The implementation <span class="bcp14">MUST NOT</span> filter the returned resource
       record sets according to the desired record type.
       Filtering of record sets is typically done by the application.<a class="pilcrow" href="#section-7-1">¶</a></p>
<span id="name-the-recursive-gns-resolutio"></span><div id="figure_resolution">
<figure id="figure-23">
        <div class="alignLeft art-text artwork" id="section-7-2.1">
<pre>                           Local Host             |   Remote
                                                  |   Storage
                                                  |
                                                  |    +---------+
                                                  |   /         /|
                                                  |  +---------+ |
+-----------+ (1) Name +----------+               |  |         | |
|           | Lookup   |          | (3a) GET(q)   |  | Record  | |
|Application|----------| Resolver |---------------|-&gt;| Storage | |
|           |&lt;---------|          |&lt;--------------|--|         |/
+-----------+ (4)      +----------+ (3b) RRBLOCK  |  +---------+
              Records     A                       |
                          |                       |
     (2) Determination of |                       |
         Start Zone       |                       |
                          |                       |
                       +---------+                |
                      /   |     /|                |
                     +---------+ |                |
                     |         | |                |
                     |  Start  | |                |
                     |  Zones  | |                |
                     |         |/                 |
                     +---------+                  |
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-23">Figure 23</a>:
<a class="selfRef" href="#name-the-recursive-gns-resolutio">The Recursive GNS Resolution Process</a>
        </figcaption></figure>
</div>
<div id="governance">
<section id="section-7.1">
        <h3 id="name-start-zones">
<a class="section-number selfRef" href="#section-7.1">7.1. </a><a class="section-name selfRef" href="#name-start-zones">Start Zones</a>
        </h3>
<p id="section-7.1-1">
         The resolution of a GNS name starts by identifying the Start Zone
         suffix. Once the Start Zone suffix is identified, recursive resolution
         of the remainder of the name is initiated (see <a class="auto internal xref" href="#recursion">Section 7.2</a>).
         There are two types of Start Zone suffixes: zTLDs and local
         suffix-to-zone mappings.
         The choice of available suffix-to-zone mappings is at the sole
         discretion of the local system administrator or user.
         This property addresses the issue of a single hierarchy with a
         centrally controlled root and the related issue of distribution and
         management of root servers in DNS (see Sections <a class="relref" href="https://rfc-editor.org/rfc/rfc8324#section-3.12">3.12</a> and <a class="relref" href="https://rfc-editor.org/rfc/rfc8324#section-3.10">3.10</a> of <span>[<a class="cite xref" href="#RFC8324">RFC8324</a>]</span>, respectively).<a class="pilcrow" href="#section-7.1-1">¶</a></p>
<p id="section-7.1-2">
         For names ending with a zTLD, the Start Zone is explicitly given in the
         suffix of the name to resolve.
         In order to ensure uniqueness of names with zTLDs, any
         implementation <span class="bcp14">MUST</span> use the given zone as the Start Zone.
         An implementation <span class="bcp14">MUST</span> first try to interpret the rightmost label of
         the given name as the beginning of a zTLD (see <a class="auto internal xref" href="#zTLD">Section 4.1</a>).
         If the rightmost label cannot be (partially) decoded or if it does not
         indicate a supported ztype, the name is treated as a normal name and
         Start Zone discovery <span class="bcp14">MUST</span> continue with finding a local suffix-to-zone
         mapping.
         If a valid ztype can be found in the rightmost label, the
         implementation <span class="bcp14">MUST</span> try to synthesize and decode the zTLD to retrieve
         the Start Zone key according to <a class="auto internal xref" href="#zTLD">Section 4.1</a>.
         If the zTLD cannot be synthesized or decoded, the resolution of
         the name fails and an error is returned to the application.
         Otherwise, the zone key <span class="bcp14">MUST</span> be used as the Start Zone:<a class="pilcrow" href="#section-7.1-2">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.1-3">
<pre>Example name: www.example.&lt;zTLD&gt;
=&gt; Start Zone: zkey of type ztype
=&gt; Name to resolve from Start Zone: www.example
</pre><a class="pilcrow" href="#section-7.1-3">¶</a>
</div>
<p id="section-7.1-4">
         For names not ending with a zTLD, the resolver <span class="bcp14">MUST</span> determine the Start
         Zone through a local suffix-to-zone mapping.
         Suffix-to-zone mappings <span class="bcp14">MUST</span> be configurable through a local
         configuration file or database by the user or system administrator.
         A suffix <span class="bcp14">MAY</span> consist of multiple GNS labels concatenated with a
         label separator.
         If multiple suffixes match the name to resolve, the longest
         matching suffix <span class="bcp14">MUST</span> be used. The suffix length of two results
         <span class="bcp14">MUST NOT</span> be equal. This indicates a misconfiguration, and the
         implementation <span class="bcp14">MUST</span> return an error.
         The following is a non-normative example mapping of Start Zones:<a class="pilcrow" href="#section-7.1-4">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.1-5">
<pre>Example name: www.example.xyz.gns.alt
Local suffix mappings:
xyz.gns.alt = zTLD0 := Base32GNS(ztype0||zkey0)
example.xyz.gns.alt = zTLD1 := Base32GNS(ztype1||zkey1)
example.com.gns.alt = zTLD2 := Base32GNS(ztype2||zkey2)
...
=&gt; Start Zone: zkey1
=&gt; Name to resolve from Start Zone: www
</pre><a class="pilcrow" href="#section-7.1-5">¶</a>
</div>
<p id="section-7.1-6">
         The process given above <span class="bcp14">MAY</span> be supplemented with other mechanisms if
         the particular application requires a different process.
         If no Start Zone can be identified, resolution <span class="bcp14">MUST</span> fail and an
         error <span class="bcp14">MUST</span> be returned to the application.<a class="pilcrow" href="#section-7.1-6">¶</a></p>
</section>
</div>
<div id="recursion">
<section id="section-7.2">
        <h3 id="name-recursion">
<a class="section-number selfRef" href="#section-7.2">7.2. </a><a class="section-name selfRef" href="#name-recursion">Recursion</a>
        </h3>
<p id="section-7.2-1">
           In each step of the recursive name resolution, there is an
           authoritative zone zkey and a name to resolve.
           The name <span class="bcp14">MAY</span> be empty.
           If the name is empty, it is interpreted as the apex label "@".
           Initially, the authoritative zone is the Start Zone.<a class="pilcrow" href="#section-7.2-1">¶</a></p>
<p id="section-7.2-2">
           From here, the following steps are recursively executed, in order:<a class="pilcrow" href="#section-7.2-2">¶</a></p>
<ol class="normal type-1" id="section-7.2-3" start="1" type="1">
           <li id="section-7.2-3.1">Extract the rightmost label from the name to look up.<a class="pilcrow" href="#section-7.2-3.1">¶</a>
</li>
          <li id="section-7.2-3.2">Calculate q using the label and zkey as defined in
           <a class="auto internal xref" href="#blinding">Section 6.1</a>.<a class="pilcrow" href="#section-7.2-3.2">¶</a>
</li>
          <li id="section-7.2-3.3">Perform a storage query GET(q) to retrieve the RRBLOCK.<a class="pilcrow" href="#section-7.2-3.3">¶</a>
</li>
          <li id="section-7.2-3.4">Check that (a) the block is not expired, (b) the SHA-512 hash
             of the derived authoritative zone key zkey' from the RRBLOCK matches
             the query q, and (c) the signature is valid. If any of these
             tests fail, the RRBLOCK <span class="bcp14">MUST</span>
             be ignored and, if applicable, the storage lookup GET(q)
             <span class="bcp14">MUST</span> continue to look for other RRBLOCKs.<a class="pilcrow" href="#section-7.2-3.4">¶</a>
</li>
          <li id="section-7.2-3.5">Obtain the RDATA by decrypting the BDATA contained in the
              RRBLOCK using S-Decrypt() as defined by the zone type, effectively
              inverting the process described in <a class="auto internal xref" href="#records_block">Section 6.3</a>.<a class="pilcrow" href="#section-7.2-3.5">¶</a>
</li>
        </ol>
<p id="section-7.2-4">
           Once a well-formed block has been decrypted, the records from
           RDATA are subjected to record processing.<a class="pilcrow" href="#section-7.2-4">¶</a></p>
</section>
</div>
<div id="record_processing">
<section id="section-7.3">
        <h3 id="name-record-processing">
<a class="section-number selfRef" href="#section-7.3">7.3. </a><a class="section-name selfRef" href="#name-record-processing">Record Processing</a>
        </h3>
<p id="section-7.3-1">
           In record processing, only the valid records obtained are considered.
           To filter records by validity, the resolver
           <span class="bcp14">MUST</span> at least check the expiration time and the FLAGS field of the
           respective record.
           Specifically, the resolver <span class="bcp14">MUST</span> disregard expired records.
           Furthermore, SHADOW and
           SUPPLEMENTAL flags can also exclude records from being considered.
           If the resolver encounters a record with the CRITICAL flag set and
           does not support the record type, the resolution <span class="bcp14">MUST</span> be aborted
           and an error <span class="bcp14">MUST</span> be returned. Information indicating that the critical
           record could not be processed <span class="bcp14">SHOULD</span> be returned in the error
           description. The implementation <span class="bcp14">MAY</span> choose not to return the reason for the failure,
           merely complicating troubleshooting for the user.<a class="pilcrow" href="#section-7.3-1">¶</a></p>
<p id="section-7.3-2">
           The next steps depend on the context of the name that is being
           resolved:<a class="pilcrow" href="#section-7.3-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-7.3-3">
          <dt id="section-7.3-3.1">Case 1:</dt>
          <dd id="section-7.3-3.2" style="margin-left: 1.5em">If the filtered record set consists of a single REDIRECT record,
           the remainder of the name is prepended to the REDIRECT DATA and the
           recursion is started again from the resulting name.
           Details are provided in <a class="auto internal xref" href="#redirect_processing">Section 7.3.1</a>.<a class="pilcrow" href="#section-7.3-3.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.3-3.3">Case 2:</dt>
          <dd id="section-7.3-3.4" style="margin-left: 1.5em">If the filtered record set consists exclusively of one or more GNS2DNS records,
           resolution continues with DNS.
           Details are provided in <a class="auto internal xref" href="#gns2dns_processing">Section 7.3.2</a>.<a class="pilcrow" href="#section-7.3-3.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.3-3.5">Case 3:</dt>
          <dd id="section-7.3-3.6" style="margin-left: 1.5em">If the remainder of the name to be resolved is of the format
           "_SERVICE._PROTO" and the record set contains one or more matching BOX
           records, the records in the BOX records are the final result and the recursion
           is concluded as described in <a class="auto internal xref" href="#box_processing">Section 7.3.3</a>.<a class="pilcrow" href="#section-7.3-3.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.3-3.7">Case 4:</dt>
          <dd id="section-7.3-3.8" style="margin-left: 1.5em">If the current record set
           consists of a single delegation record,
           resolution of the remainder of the name is delegated to
           the target zone as described in <a class="auto internal xref" href="#delegation_processing">Section 7.3.4</a>.<a class="pilcrow" href="#section-7.3-3.8">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.3-3.9">Case 5:</dt>
          <dd id="section-7.3-3.10" style="margin-left: 1.5em">If the remainder of the name to resolve is empty,
           the record set is the final result.
           If any NICK records are in the final result set, they <span class="bcp14">MUST</span>
           first be processed according to <a class="auto internal xref" href="#nick_processing">Section 7.3.5</a>.
           Otherwise, the record result set is directly returned as the final result.<a class="pilcrow" href="#section-7.3-3.10">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-7.3-4">Finally, if none of the above cases are applicable, resolution fails and the
           resolver <span class="bcp14">MUST</span> return an empty record set.<a class="pilcrow" href="#section-7.3-4">¶</a></p>
<div id="redirect_processing">
<section id="section-7.3.1">
          <h4 id="name-redirect-2">
<a class="section-number selfRef" href="#section-7.3.1">7.3.1. </a><a class="section-name selfRef" href="#name-redirect-2">REDIRECT</a>
          </h4>
<p id="section-7.3.1-1">
             If the remaining name is empty and the desired record type is
             REDIRECT, the resolution concludes with the REDIRECT record.
             If the rightmost label of the REDIRECT NAME is the extension label
             (U+002B ("+")),
             resolution continues in GNS with the new name in the
             current zone.
             Otherwise, the resulting name is resolved via the
             default operating system name resolution process.
             This can in turn trigger a GNS name resolution process, depending
             on the system configuration.
             If resolution continues in DNS, the name <span class="bcp14">MUST</span> first be
             converted to an IDNA-compliant representation <span>[<a class="cite xref" href="#RFC5890">RFC5890</a>]</span>.<a class="pilcrow" href="#section-7.3.1-1">¶</a></p>
<p id="section-7.3.1-2">
             In order to prevent infinite loops, the resolver <span class="bcp14">MUST</span>
             implement loop detection or limit the number of recursive
             resolution steps.
             The loop detection <span class="bcp14">MUST</span> be effective even
             if a REDIRECT found in GNS triggers subsequent GNS lookups via
             the default operating system name resolution process.<a class="pilcrow" href="#section-7.3.1-2">¶</a></p>
</section>
</div>
<div id="gns2dns_processing">
<section id="section-7.3.2">
          <h4 id="name-gns2dns-2">
<a class="section-number selfRef" href="#section-7.3.2">7.3.2. </a><a class="section-name selfRef" href="#name-gns2dns-2">GNS2DNS</a>
          </h4>
<p id="section-7.3.2-1">
             A resolver returns GNS2DNS records when all of the following
             conditions are met:<a class="pilcrow" href="#section-7.3.2-1">¶</a></p>
<ol class="normal type-1" id="section-7.3.2-2" start="1" type="1">
           <li id="section-7.3.2-2.1">The resolver encounters one or more GNS2DNS records;<a class="pilcrow" href="#section-7.3.2-2.1">¶</a>
</li>
            <li id="section-7.3.2-2.2">The remaining name is empty; and<a class="pilcrow" href="#section-7.3.2-2.2">¶</a>
</li>
            <li id="section-7.3.2-2.3">The desired record type is GNS2DNS.<a class="pilcrow" href="#section-7.3.2-2.3">¶</a>
</li>
          </ol>
<p id="section-7.3.2-3">
             Otherwise, it is expected that the resolver first resolves the
             IP addresses of the specified DNS name servers.
             The DNS name <span class="bcp14">MUST</span> be converted to an IDNA-compliant
             representation <span>[<a class="cite xref" href="#RFC5890">RFC5890</a>]</span> for resolution in DNS.
             GNS2DNS records <span class="bcp14">MAY</span>
             contain numeric IPv4 or IPv6 addresses, allowing the resolver to
             skip this step.
             The DNS server names might themselves be names in GNS or DNS.
             If the rightmost label of the DNS server name is the extension label
             (U+002B ("+")), the rest of the name is to be
             interpreted relative to the zone of the GNS2DNS record.
             If the DNS server name ends in a label representation of a
             zone key, the DNS server name is to be resolved against
             the GNS zone zkey.<a class="pilcrow" href="#section-7.3.2-3">¶</a></p>
<p id="section-7.3.2-4">
             Multiple GNS2DNS records can be stored under the same label,
             in which case the resolver <span class="bcp14">MUST</span> try all of them.
             The resolver <span class="bcp14">MAY</span> try them in any order or even in parallel.
             If multiple GNS2DNS records are present, the DNS name <span class="bcp14">MUST</span> be
             identical for all of them. Otherwise, it is not clear which name
             the resolver is supposed to follow. If different DNS names are
             present, the resolution fails and an
             appropriate error <span class="bcp14">SHOULD</span> be returned to the application.<a class="pilcrow" href="#section-7.3.2-4">¶</a></p>
<p id="section-7.3.2-5">
             If there are DNSSEC DS records or any other records used to
             secure the connection with the DNS servers stored under the label,
             the DNS resolver <span class="bcp14">SHOULD</span> use them to secure the connection with
             the DNS server.<a class="pilcrow" href="#section-7.3.2-5">¶</a></p>
<p id="section-7.3.2-6">
             Once the IP addresses of the DNS servers have been determined,
             the DNS name from the GNS2DNS record is appended
             to the remainder of the name to be resolved and is
             resolved by querying the DNS name server(s).
             The synthesized name has to be converted to an IDNA-compliant
             representation <span>[<a class="cite xref" href="#RFC5890">RFC5890</a>]</span> for resolution in DNS.
             If such a conversion is not possible, the resolution <span class="bcp14">MUST</span> be aborted
             and an error <span class="bcp14">MUST</span> be returned. Information indicating that the critical
             record could not be processed <span class="bcp14">SHOULD</span> be returned in the error
             description. The implementation <span class="bcp14">MAY</span> choose not to return the reason for the failure,
             merely complicating troubleshooting for the user.<a class="pilcrow" href="#section-7.3.2-6">¶</a></p>
<p id="section-7.3.2-7">
             As the DNS servers
             specified are possibly authoritative DNS servers, the GNS resolver <span class="bcp14">MUST</span>
             support recursive DNS resolution and <span class="bcp14">MUST NOT</span> delegate this to the
             authoritative DNS servers.
             The first successful recursive name resolution result
             is returned to the application.
             In addition, the resolver <span class="bcp14">SHOULD</span> return the queried DNS name as a
             supplemental LEHO record (see <a class="auto internal xref" href="#gnsrecords_leho">Section 5.3.1</a>) with a
             relative expiration time of one hour.<a class="pilcrow" href="#section-7.3.2-7">¶</a></p>
<p id="section-7.3.2-8">
             Once the transition from GNS to DNS is made through a
             GNS2DNS record, there is no "going back".
             The (possibly recursive) resolution of the DNS name <span class="bcp14">MUST NOT</span>
             delegate back into GNS and should only follow the DNS specifications.
             For example, names contained in DNS CNAME records <span class="bcp14">MUST NOT</span> be
             interpreted by resolvers that support both DNS and GNS as GNS names.<a class="pilcrow" href="#section-7.3.2-8">¶</a></p>
<p id="section-7.3.2-9">
             GNS resolvers <span class="bcp14">SHOULD</span> offer a configuration
             option to disable DNS processing to avoid information leakage
             and provide a consistent security profile for all name resolutions.
             Such resolvers would return an empty record set upon encountering
             a GNS2DNS record during the recursion. However, if GNS2DNS records
             are encountered in the record set for the apex label and a GNS2DNS record
             is explicitly requested by the application, such records <span class="bcp14">MUST</span>
             still be returned, even if DNS support is disabled by the
             GNS resolver configuration.<a class="pilcrow" href="#section-7.3.2-9">¶</a></p>
</section>
</div>
<div id="box_processing">
<section id="section-7.3.3">
          <h4 id="name-box-2">
<a class="section-number selfRef" href="#section-7.3.3">7.3.3. </a><a class="section-name selfRef" href="#name-box-2">BOX</a>
          </h4>
<p id="section-7.3.3-1">
             When a BOX record is received, a GNS resolver must unbox it if the
             name to be resolved continues with "_SERVICE._PROTO".
             Otherwise, the BOX record is to be left untouched. This way, TLSA
             (and SRV) records do not require a separate network request, and
             TLSA records become inseparable from the corresponding address
             records.<a class="pilcrow" href="#section-7.3.3-1">¶</a></p>
</section>
</div>
<div id="delegation_processing">
<section id="section-7.3.4">
          <h4 id="name-zone-delegation-records-2">
<a class="section-number selfRef" href="#section-7.3.4">7.3.4. </a><a class="section-name selfRef" href="#name-zone-delegation-records-2">Zone Delegation Records</a>
          </h4>
<p id="section-7.3.4-1">
             When the resolver encounters a record of a supported
             zone delegation record type (such as PKEY or EDKEY)
             and the remainder of the name is not empty, resolution continues
             recursively with the remainder of the name in the
             GNS zone specified in the delegation record.<a class="pilcrow" href="#section-7.3.4-1">¶</a></p>
<p id="section-7.3.4-2">
             Whenever a resolver encounters a new GNS zone, it <span class="bcp14">MUST</span>
             check against the local revocation list (see <a class="auto internal xref" href="#revocation">Section 4.2</a>) to see
             whether the respective
             zone key has been revoked. If the zone key was revoked, the
             resolution <span class="bcp14">MUST</span> fail with an empty result set.<a class="pilcrow" href="#section-7.3.4-2">¶</a></p>
<p id="section-7.3.4-3">
             Implementations <span class="bcp14">MUST NOT</span> allow multiple different zone
             delegations under a single label (except if some are shadow records).
             Implementations <span class="bcp14">MAY</span> support any subset of ztypes.
             Implementations <span class="bcp14">MUST NOT</span> process zone delegation records
             stored under the apex label ("@").  If a zone delegation record is encountered under
             the apex label, resolution fails and an error <span class="bcp14">MUST</span> be returned. The
             implementation <span class="bcp14">MAY</span> choose not to return the reason for the failure,
             merely impacting troubleshooting information for the user.<a class="pilcrow" href="#section-7.3.4-3">¶</a></p>
<p id="section-7.3.4-4">
 If the remainder of the name to resolve is empty and a record set was
 received containing only a single delegation record, the recursion is
 continued with the record value as the authoritative zone and the
 apex label "@" as the remaining name.  The exception is the case
 where the desired record type as specified by the application is
 equal to the ztype, in which case the delegation record is returned.<a class="pilcrow" href="#section-7.3.4-4">¶</a></p>
</section>
</div>
<div id="nick_processing">
<section id="section-7.3.5">
          <h4 id="name-nick-2">
<a class="section-number selfRef" href="#section-7.3.5">7.3.5. </a><a class="section-name selfRef" href="#name-nick-2">NICK</a>
          </h4>
<p id="section-7.3.5-1">
             NICK records are only relevant to the recursive resolver
             if the record set in question is the final result, which is to
             be returned to the application. The encountered NICK records can be either
             supplemental (see <a class="auto internal xref" href="#rrecords">Section 5</a>) or
             non-supplemental.
             If the NICK record is supplemental, the resolver only returns the
             record set if one of the non-supplemental records matches the
             queried record type.
             It is possible that one record set contains both supplemental
             and non-supplemental NICK records.<a class="pilcrow" href="#section-7.3.5-1">¶</a></p>
<p id="section-7.3.5-2">
             The differentiation between a supplemental and non-supplemental
             NICK record allows the application to match the record to the
             authoritative zone. Consider the following example:<a class="pilcrow" href="#section-7.3.5-2">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.3.5-3">
<pre>Query: alice.example.gns.alt (type=A)
Result:
A: 192.0.2.1
NICK: eve (non-supplemental)
</pre><a class="pilcrow" href="#section-7.3.5-3">¶</a>
</div>
<p id="section-7.3.5-4">
          In this example, the returned NICK record is non-supplemental.
          For the application, this means that the NICK belongs to the zone
          "alice.example.gns.alt" and is published under the apex label along with an A
          record. The NICK record is interpreted as follows: the zone defined by
          "alice.example.gns.alt" wants to be referred to as "eve".
          In contrast, consider the following:<a class="pilcrow" href="#section-7.3.5-4">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.3.5-5">
<pre>Query: alice.example.gns.alt (type=AAAA)
Result:
AAAA: 2001:db8::1
NICK: john (supplemental)
</pre><a class="pilcrow" href="#section-7.3.5-5">¶</a>
</div>
<p id="section-7.3.5-6">
       In this case, the NICK record is marked as supplemental. This means that
       the NICK record belongs to the zone "example.gns.alt" and is published under the
       label "alice" along with a AAAA record.  Here, the NICK record should be
       interpreted as follows: the zone defined by "example.gns.alt" wants to be referred to as
       "john". This distinction is likely useful for other records published as
       supplemental.<a class="pilcrow" href="#section-7.3.5-6">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="encoding">
<section id="section-8">
      <h2 id="name-internationalization-and-ch">
<a class="section-number selfRef" href="#section-8">8. </a><a class="section-name selfRef" href="#name-internationalization-and-ch">Internationalization and Character Encoding</a>
      </h2>
<p id="section-8-1">
         All names in GNS are encoded in UTF-8 <span>[<a class="cite xref" href="#RFC3629">RFC3629</a>]</span>.
         Labels <span class="bcp14">MUST</span> be canonicalized using
         Normalization Form C (NFC) <span>[<a class="cite xref" href="#Unicode-UAX15">Unicode-UAX15</a>]</span>.
         This does not include any DNS names found in DNS records, such as CNAME
         record data, which is internationalized through the IDNA specifications;
         see <span>[<a class="cite xref" href="#RFC5890">RFC5890</a>]</span>.<a class="pilcrow" href="#section-8-1">¶</a></p>
</section>
</div>
<div id="security">
<section id="section-9">
      <h2 id="name-security-and-privacy-consid">
<a class="section-number selfRef" href="#section-9">9. </a><a class="section-name selfRef" href="#name-security-and-privacy-consid">Security and Privacy Considerations</a>
      </h2>
<div id="security_availability">
<section id="section-9.1">
        <h3 id="name-availability">
<a class="section-number selfRef" href="#section-9.1">9.1. </a><a class="section-name selfRef" href="#name-availability">Availability</a>
        </h3>
<p id="section-9.1-1">
           In order to ensure availability of records beyond their
           absolute expiration times, implementations <span class="bcp14">MAY</span> allow 
           relative expiration time values of records to be locally defined.
           Records can then be published recurringly with updated
           absolute expiration times by the implementation.<a class="pilcrow" href="#section-9.1-1">¶</a></p>
<p id="section-9.1-2">
           Implementations <span class="bcp14">MAY</span> allow users to manage private records in
           their zones that are not published in storage.
           Private records are treated just like
           regular records when resolving labels in local zones,
           but their data is completely unavailable to non-local users.<a class="pilcrow" href="#section-9.1-2">¶</a></p>
</section>
</div>
<div id="security_agility">
<section id="section-9.2">
        <h3 id="name-agility">
<a class="section-number selfRef" href="#section-9.2">9.2. </a><a class="section-name selfRef" href="#name-agility">Agility</a>
        </h3>
<p id="section-9.2-1">
           The security of cryptographic systems depends on both the strength of
           the cryptographic algorithms chosen and the strength of the keys used
           with those algorithms.  This security also depends on the engineering
           of the protocol used by the system to ensure that there are no
           non-cryptographic ways to bypass the security of the overall system.
           This is why developers of applications managing GNS zones <span class="bcp14">SHOULD</span>
           select a default ztype considered secure at the time of
           releasing the software.
           For applications targeting end users that are not expected to
           understand cryptography, the application developer <span class="bcp14">MUST NOT</span> leave
           the ztype selection of new zones to end users.<a class="pilcrow" href="#section-9.2-1">¶</a></p>
<p id="section-9.2-2">
           This document concerns itself with the selection of cryptographic
           algorithms used in GNS.
           The algorithms identified in this document are not known to be
           broken (in the cryptographic sense) at the current time, and
           cryptographic research so far leads us to believe that they are
           likely to remain secure into the foreseeable future.  However, this
           is not necessarily forever, and it is expected that new revisions of
           this document will be issued from time to time to reflect the current
           best practices in this area.<a class="pilcrow" href="#section-9.2-2">¶</a></p>
<p id="section-9.2-3">
           In terms of crypto-agility, whenever the need for an updated cryptographic
           scheme arises to, for example, replace ECDSA over Ed25519 for
           PKEY records, it can simply be introduced
           through a new record type.
           Zone administrators can then replace
           the delegation record type for future records.
           The old record type remains,
           and zones can iteratively migrate to the updated zone keys.
           To ensure that implementations correctly generate an error message
           when encountering a ztype that they do not support,
           current and future delegation records must always have the
           CRITICAL flag set.<a class="pilcrow" href="#section-9.2-3">¶</a></p>
</section>
</div>
<div id="security_cryptography">
<section id="section-9.3">
        <h3 id="name-cryptography">
<a class="section-number selfRef" href="#section-9.3">9.3. </a><a class="section-name selfRef" href="#name-cryptography">Cryptography</a>
        </h3>
<p id="section-9.3-1">
           The following considerations provide background on the design choices
           of the ztypes specified in this document.
           When specifying new ztypes as per <a class="auto internal xref" href="#zones">Section 4</a>, the same
           considerations apply.<a class="pilcrow" href="#section-9.3-1">¶</a></p>
<p id="section-9.3-2">
           GNS PKEY zone keys use ECDSA over Ed25519.
           This is an unconventional choice,
           as ECDSA is usually used with other curves.  However, standardized
           ECDSA curves are problematic for a range of reasons, as described in
           the Curve25519 and EdDSA papers <span>[<a class="cite xref" href="#RFC7748">RFC7748</a>]</span> <span>[<a class="cite xref" href="#ed25519">ed25519</a>]</span>.
           Using EdDSA directly is also
           not possible, as a hash function is used on the private key and
           will destroy the linearity that the key blinding in GNS depends upon.
           We are not aware of anyone suggesting that using Ed25519 instead
           of another common curve of similar size would lower the security of
           ECDSA.  GNS uses 256-bit curves; that way, the encoded (public)
           keys fit into a single DNS label, which is good for usability.<a class="pilcrow" href="#section-9.3-2">¶</a></p>
<p id="section-9.3-3">
           In order to ensure ciphertext indistinguishability, care must be
           taken with respect to the IV in the counter
           block. In our design, the IV always includes the expiration time of the
           record block.
           When applications store records with relative expiration times,
           monotonicity is implicitly
           ensured because each time a block is published in storage, its IV is
           unique, as the expiration time is calculated dynamically and increases
           monotonically with the system time. Still,
           an implementation <span class="bcp14">MUST</span> ensure that when relative expiration times
           are decreased, the expiration time of the next record block <span class="bcp14">MUST</span>
           be after the last published block.
           For records where an absolute expiration time is used, the implementation
           <span class="bcp14">MUST</span> ensure that the expiration time is always increased when the record
           data changes. For example, the expiration time on the wire could be increased
           by a single microsecond even if the user did not request a change.
           In the case of deletion of all resource records under a label, the
           implementation <span class="bcp14">MUST</span> keep track of the last absolute expiration time
           of the last published resource block.  Implementations <span class="bcp14">MAY</span> define
           and use a special record type as a tombstone that preserves the last
           absolute expiration time but then <span class="bcp14">MUST</span> take care to not publish a
           block with such a tombstone record.
           When new records are added under this label later, the implementation
           <span class="bcp14">MUST</span> ensure that the expiration times are after the last published
           block.
           Finally, in order to ensure monotonically increasing expiration times,
           the implementation <span class="bcp14">MUST</span> keep a local record of the last time obtained
           from the system clock, so as to construct a monotonic clock if
           the system clock jumps backwards.<a class="pilcrow" href="#section-9.3-3">¶</a></p>
</section>
</div>
<div id="security_abuse">
<section id="section-9.4">
        <h3 id="name-abuse-mitigation">
<a class="section-number selfRef" href="#section-9.4">9.4. </a><a class="section-name selfRef" href="#name-abuse-mitigation">Abuse Mitigation</a>
        </h3>
<p id="section-9.4-1">
           GNS names are UTF-8 strings. Consequently, GNS faces issues
           with respect to name spoofing similar to those for DNS with respect to internationalized
           domain names.
           In DNS, attackers can register similar-sounding or similar-looking
           names (see above) in order to execute phishing attacks.
           GNS zone administrators must take into account this attack vector and
           incorporate rules in order to mitigate it.<a class="pilcrow" href="#section-9.4-1">¶</a></p>
<p id="section-9.4-2">
           Further, DNS can be used to combat illegal content on the Internet
           by having the respective domains seized by authorities.
           However, the same mechanisms can also be abused in order to impose
           state censorship.
           Avoiding that possibility is one of the motivations behind GNS.
           In GNS, TLDs are not enumerable. By design, the Start Zone of
           the resolver is defined locally, and hence such a seizure is
           difficult and ineffective in GNS.<a class="pilcrow" href="#section-9.4-2">¶</a></p>
</section>
</div>
<div id="security_keymanagement">
<section id="section-9.5">
        <h3 id="name-zone-management">
<a class="section-number selfRef" href="#section-9.5">9.5. </a><a class="section-name selfRef" href="#name-zone-management">Zone Management</a>
        </h3>
<p id="section-9.5-1">
           In GNS, zone administrators need to manage and protect their zone
           keys. Once a private zone key is lost, it cannot be recovered, and
           the zone revocation message cannot be computed anymore.
           Revocation messages can be precalculated if revocation is
           required in cases where a private zone key is lost.
           Zone administrators, and for GNS this includes end users, are
           required to responsibly and diligently protect their cryptographic
           keys.
           GNS supports signing records in advance ("offline") in order to
           support processes (such as air gaps) that aim to protect private keys.<a class="pilcrow" href="#section-9.5-1">¶</a></p>
<p id="section-9.5-2">
           Similarly, users are required to manage their local Start Zone configuration.
           In order to ensure the integrity and availability of names, users must
           ensure that their local Start Zone information is not compromised or
           outdated.
           It can be expected that the processing of zone revocations and an
           initial Start Zone are provided with a GNS implementation
           ("drop shipping").
           Shipping an initial Start Zone configuration effectively establishes
           a root zone.
           Extension and customization of the zone are at the full discretion of
           the user.<a class="pilcrow" href="#section-9.5-2">¶</a></p>
<p id="section-9.5-3">
           While implementations following this specification will be
           interoperable, if two implementations connect to different remote storage entities,
           they are mutually unreachable.
           This can lead to a state where a record exists in the global
           namespace for a particular name, but the implementation is not
           communicating with the remote storage entity that contains the respective
           block and is hence unable to resolve it.
           This situation is similar to a split-horizon DNS configuration.
           The remote storage entity used will most likely depend on the specific application
           context using GNS resolution.
           For example, one application is the resolution of hidden services
           within the Tor network <span>[<a class="cite xref" href="#TorRendSpec">TorRendSpec</a>]</span>, which would suggest using Tor routers for remote storage.
           Implementations of "aggregated" remote storage entities are conceivable but
           are expected to be the exception.<a class="pilcrow" href="#section-9.5-3">¶</a></p>
</section>
</div>
<div id="security_dht">
<section id="section-9.6">
        <h3 id="name-dhts-as-remote-storage">
<a class="section-number selfRef" href="#section-9.6">9.6. </a><a class="section-name selfRef" href="#name-dhts-as-remote-storage">DHTs as Remote Storage</a>
        </h3>
<p id="section-9.6-1">
           This document does not specify the properties of the underlying
           remote storage, which is required by any GNS implementation.
           It is important to note that the properties of the underlying
           remote storage are directly inherited by the
           GNS implementation. This includes both security and
           other non-functional properties such as scalability and performance.
           Implementers should take great care when selecting or implementing
           a DHT for use as remote storage in a GNS implementation.
           DHTs with reasonable security and performance properties exist
           <span>[<a class="cite xref" href="#R5N">R5N</a>]</span>.
           It should also be taken into consideration that GNS implementations
           that build upon different DHT overlays are unlikely to be
           mutually reachable.<a class="pilcrow" href="#section-9.6-1">¶</a></p>
</section>
</div>
<div id="security_rev">
<section id="section-9.7">
        <h3 id="name-revocations">
<a class="section-number selfRef" href="#section-9.7">9.7. </a><a class="section-name selfRef" href="#name-revocations">Revocations</a>
        </h3>
<p id="section-9.7-1">
           Zone administrators are advised to pregenerate zone revocations
           and to securely store the revocation information if the zone
           key is lost, compromised, or replaced in the future.
           Precalculated revocations can cease to be valid due to expirations
           or protocol changes such as epoch adjustments.
           Consequently, implementers and users must take precautions in order
           to manage revocations accordingly.<a class="pilcrow" href="#section-9.7-1">¶</a></p>
<p id="section-9.7-2">
           Revocation payloads do not include a "new" key for key replacement.
           Inclusion of such a key would have two major disadvantages:<a class="pilcrow" href="#section-9.7-2">¶</a></p>
<ol class="normal type-1" id="section-9.7-3" start="1" type="1">
           <li id="section-9.7-3.1">
           If a revocation is published after a private key was compromised,
           allowing key replacement would be dangerous: if an
           adversary took over the private key, the adversary could then
           broadcast a revocation with a key replacement. For the replacement,
           the compromised owner would have no chance to issue a
           revocation. Thus, allowing a revocation message to replace a private
           key makes dealing with key compromise situations worse.<a class="pilcrow" href="#section-9.7-3.1">¶</a>
</li>
          <li id="section-9.7-3.2">
           Sometimes, key revocations are used with the objective of changing
           cryptosystems. Migration to another cryptosystem by replacing keys
           via a revocation message would only be secure as long as both
           cryptosystems are still secure against forgery. Such a planned,
           non-emergency migration to another cryptosystem should be done by
           running zones for both cipher systems in parallel for a while. The
           migration would conclude by revoking the legacy zone key only when
           it is deemed no longer secure and, hopefully, after most users have
           migrated to the replacement.<a class="pilcrow" href="#section-9.7-3.2">¶</a>
</li>
        </ol>
</section>
</div>
<div id="privacy_labels">
<section id="section-9.8">
        <h3 id="name-zone-privacy">
<a class="section-number selfRef" href="#section-9.8">9.8. </a><a class="section-name selfRef" href="#name-zone-privacy">Zone Privacy</a>
        </h3>
<p id="section-9.8-1">
           GNS does not support authenticated denial of existence of names
           within a zone.
           Record data is published in encrypted form using keys derived from the
           zone key and record label. Zone administrators should
           carefully consider whether (1) a label and zone key are public or 
           (2) one or both of these should be used as a shared secret to restrict access
           to the corresponding record data.
           Unlike public zone keys, low-entropy labels can be guessed by an attacker. If an attacker
           knows the public zone key, the use of well-known or guessable
           labels effectively threatens the disclosure of the corresponding records.<a class="pilcrow" href="#section-9.8-1">¶</a></p>
<p id="section-9.8-2">
           It should be noted that the guessing attack on labels only applies if the
           zone key is somehow disclosed to the adversary. GNS itself
           does not disclose it during a lookup or when resource records are
           published (as only the blinded zone keys are used on the network).
           However, zone keys do become public during revocation.<a class="pilcrow" href="#section-9.8-2">¶</a></p>
<p id="section-9.8-3">
           It is thus <span class="bcp14">RECOMMENDED</span> to use a
           label with sufficient entropy to prevent guessing attacks
           if any data in a resource record set is sensitive.<a class="pilcrow" href="#section-9.8-3">¶</a></p>
</section>
</div>
<div id="sec_governance">
<section id="section-9.9">
        <h3 id="name-zone-governance">
<a class="section-number selfRef" href="#section-9.9">9.9. </a><a class="section-name selfRef" href="#name-zone-governance">Zone Governance</a>
        </h3>
<p id="section-9.9-1">
           While DNS is distributed, in practice it
           relies on centralized, trusted registrars to provide globally unique
           names. As awareness of the central role DNS plays on the Internet
           increases, various institutions are using their power (including legal means)
           to engage in attacks on the DNS, thus threatening the global availability
           and integrity of information on the Internet.
           While a wider discussion of this issue is out of scope for this document,
           analyses and investigations can be found in recent academic research
           works, including <span>[<a class="cite xref" href="#SecureNS">SecureNS</a>]</span>.<a class="pilcrow" href="#section-9.9-1">¶</a></p>
<p id="section-9.9-2">
           GNS is designed to provide a secure, privacy-enhancing alternative to the
           DNS name resolution protocol, especially when censorship or manipulation
           is encountered.
           In particular, it directly addresses concerns in DNS with respect to
           query privacy.
           However, depending on the governance of the root zone, any deployment
           will likely suffer from the issue of a
           single hierarchy with a centrally controlled root and the
           related issue of distribution and management of root servers in DNS, as
           raised in Sections <a class="relref" href="https://rfc-editor.org/rfc/rfc8324#section-3.12">3.12</a> and <a class="relref" href="https://rfc-editor.org/rfc/rfc8324#section-3.10">3.10</a> of <span>[<a class="cite xref" href="#RFC8324">RFC8324</a>]</span>, respectively.
           In DNS, those issues directly result from the centralized root
           zone governance at the Internet Corporation for Assigned Names and
           Numbers (ICANN), which allows it to provide globally unique names.<a class="pilcrow" href="#section-9.9-2">¶</a></p>
<p id="section-9.9-3">
           In GNS, Start Zones give users local authority over their preferred
           root zone governance.
           It enables users to replace or enhance a trusted root zone
           configuration provided by a third party (e.g., the implementer or a
           multi-stakeholder governance body like ICANN) with secure delegation of
           authority using local petnames while operating under a
           very strong adversary model.
           In combination with zTLDs, this provides users of GNS with a global,
           secure, and memorable mapping without a trusted authority.<a class="pilcrow" href="#section-9.9-3">¶</a></p>
<p id="section-9.9-4">
           Any GNS implementation <span class="bcp14">MAY</span> provide a default
           governance model in the form of an initial Start Zone mapping.<a class="pilcrow" href="#section-9.9-4">¶</a></p>
</section>
</div>
<div id="namespace_ambiguity">
<section id="section-9.10">
        <h3 id="name-namespace-ambiguity">
<a class="section-number selfRef" href="#section-9.10">9.10. </a><a class="section-name selfRef" href="#name-namespace-ambiguity">Namespace Ambiguity</a>
        </h3>
<p id="section-9.10-1">
           Technically, the GNS protocol can be used to resolve names in the
           namespace of the global DNS.
           However, this would require the respective governance bodies and
           stakeholders (e.g., the IETF and ICANN) to standardize the use of GNS for this particular use
           case.<a class="pilcrow" href="#section-9.10-1">¶</a></p>
<p id="section-9.10-2">
           This capability implies that GNS names may be
           indistinguishable from DNS names in their
           respective common display format <span>[<a class="cite xref" href="#RFC8499">RFC8499</a>]</span> or
           other special-use domain names <span>[<a class="cite xref" href="#RFC6761">RFC6761</a>]</span> if
           a local Start Zone configuration maps suffixes from the
           global DNS to GNS zones.
           For applications, which name system should be
           used in order to resolve a given name will then be ambiguous.
           This poses a risk when trying to resolve a name through DNS when
           it is actually a GNS name, as discussed in <span>[<a class="cite xref" href="#RFC8244">RFC8244</a>]</span>.
           In such a case, the GNS name is likely to be leaked as part of the DNS
           resolution.<a class="pilcrow" href="#section-9.10-2">¶</a></p>
<p id="section-9.10-3">
           In order to prevent disclosure of queried GNS names, it is
           <span class="bcp14">RECOMMENDED</span> that GNS-aware applications try to resolve
           a given name in GNS before any other method, taking into account
           potential suffix-to-zone mappings and zTLDs.
           Suffix-to-zone mappings are expected to be configured by the user or
           local administrator, and as such the resolution in GNS is
           in line with user expectations even if the name could also be resolved
           through DNS.
           If no suffix-to-zone mapping for the name exists and no zTLD is found,
           resolution <span class="bcp14">MAY</span> continue with other methods such as DNS.
           If a suffix-to-zone mapping for the name exists or the name ends with
           a zTLD, it <span class="bcp14">MUST</span> be resolved using GNS, and
           resolution <span class="bcp14">MUST NOT</span> continue by any other means
           independent of the GNS resolution result.<a class="pilcrow" href="#section-9.10-3">¶</a></p>
<p id="section-9.10-4">
           Mechanisms such as the Name Service Switch (NSS) of UNIX-like
           operating systems are an example of how such a resolution process
           can be implemented and used.
           The NSS allows system administrators to configure hostname resolution
           precedence and is integrated with the system resolver implementation.<a class="pilcrow" href="#section-9.10-4">¶</a></p>
<p id="section-9.10-5">
           For use cases where GNS names may be confused with names
           of other name resolution mechanisms (in particular, DNS), the
           ".gns.alt" domain <span class="bcp14">SHOULD</span> be used.
           For use cases like implementing sinkholes to block
           malware sites or serving DNS domains via GNS to bypass censorship,
           GNS <span class="bcp14">MAY</span> be deliberately used in ways that interfere
           with resolution of another name system.<a class="pilcrow" href="#section-9.10-5">¶</a></p>
</section>
</div>
</section>
</div>
<div id="gana">
<section id="section-10">
      <h2 id="name-gana-considerations">
<a class="section-number selfRef" href="#section-10">10. </a><a class="section-name selfRef" href="#name-gana-considerations">GANA Considerations</a>
      </h2>
<div id="gana_gnunet-sig-purposes">
<section id="section-10.1">
        <h3 id="name-gnunet-signature-purposes-r">
<a class="section-number selfRef" href="#section-10.1">10.1. </a><a class="section-name selfRef" href="#name-gnunet-signature-purposes-r">GNUnet Signature Purposes Registry</a>
        </h3>
<p id="section-10.1-1">
         GANA <span>[<a class="cite xref" href="#GANA">GANA</a>]</span> has assigned signature purposes in its
         "GNUnet Signature Purposes" registry as listed in
         <a class="auto internal xref" href="#tab_purposenums">Table 1</a>.<a class="pilcrow" href="#section-10.1-1">¶</a></p>
<span id="name-the-gana-gnunet-signature-p"></span><div id="tab_purposenums">
<table class="center" id="table-1">
          <caption>
<a class="selfRef" href="#table-1">Table 1</a>:
<a class="selfRef" href="#name-the-gana-gnunet-signature-p">The GANA GNUnet Signature Purposes Registry</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Purpose</th>
              <th class="text-left" colspan="1" rowspan="1">Name</th>
              <th class="text-left" colspan="1" rowspan="1">References</th>
              <th class="text-left" colspan="1" rowspan="1">Comment</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">3</td>
              <td class="text-left" colspan="1" rowspan="1">GNS_REVOCATION</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9498</td>
              <td class="text-left" colspan="1" rowspan="1">GNS zone key revocation</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">15</td>
              <td class="text-left" colspan="1" rowspan="1">GNS_RECORD_SIGN</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9498</td>
              <td class="text-left" colspan="1" rowspan="1">GNS record set signature</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="gana_gnsrr">
<section id="section-10.2">
        <h3 id="name-gns-record-types-registry">
<a class="section-number selfRef" href="#section-10.2">10.2. </a><a class="section-name selfRef" href="#name-gns-record-types-registry">GNS Record Types Registry</a>
        </h3>
<p id="section-10.2-1">
         GANA <span>[<a class="cite xref" href="#GANA">GANA</a>]</span>
         manages the "GNS Record Types" registry.<a class="pilcrow" href="#section-10.2-1">¶</a></p>
<p id="section-10.2-2">Each entry has the following format:<a class="pilcrow" href="#section-10.2-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-10.2-3">
          <dt id="section-10.2-3.1">Name:</dt>
          <dd id="section-10.2-3.2" style="margin-left: 1.5em">The name of the record type (case-insensitive ASCII
           string, restricted to alphanumeric characters). For zone delegation
       records, the assigned number represents the ztype value of the zone.<a class="pilcrow" href="#section-10.2-3.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-10.2-3.3">Number:</dt>
          <dd id="section-10.2-3.4" style="margin-left: 1.5em">A 32-bit number above 65535.<a class="pilcrow" href="#section-10.2-3.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-10.2-3.5">Comment:</dt>
          <dd id="section-10.2-3.6" style="margin-left: 1.5em">Optionally, brief English text describing the purpose of
           the record type (in UTF-8).<a class="pilcrow" href="#section-10.2-3.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-10.2-3.7">Contact:</dt>
          <dd id="section-10.2-3.8" style="margin-left: 1.5em">Optionally, the contact information for a person to contact for
           further information.<a class="pilcrow" href="#section-10.2-3.8">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-10.2-3.9">References:</dt>
          <dd id="section-10.2-3.10" style="margin-left: 1.5em">Optionally, references (such as an RFC) describing the record type.<a class="pilcrow" href="#section-10.2-3.10">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-10.2-4">
         The registration policy for this registry is "First Come First
         Served". This policy is modeled on that described in <span>[<a class="cite xref" href="#RFC8126">RFC8126</a>]</span>
         and describes the actions taken by GANA:<a class="pilcrow" href="#section-10.2-4">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.2-5.1">
         Adding new entries is possible after review by any authorized
         GANA contributor, using a
         first-come-first-served policy for unique name allocation.
         Reviewers are responsible for ensuring that the chosen "Name" is
         appropriate for the record type.
         The registry will define a unique number for the entry.<a class="pilcrow" href="#section-10.2-5.1">¶</a>
</li>
          <li class="normal" id="section-10.2-5.2">
         Authorized GANA contributors for review of new entries are reachable at
         &lt;gns-registry@gnunet.org&gt;.<a class="pilcrow" href="#section-10.2-5.2">¶</a>
</li>
          <li class="normal" id="section-10.2-5.3">
         Any request <span class="bcp14">MUST</span> contain a unique name and a point of contact.
         The contact information <span class="bcp14">MAY</span> be added to the registry, with the consent
         of the requester.
         The request <span class="bcp14">MAY</span> optionally also contain relevant references as well
         as a descriptive comment, as defined above.<a class="pilcrow" href="#section-10.2-5.3">¶</a>
</li>
        </ul>
<p id="section-10.2-6">
         GANA has assigned numbers for the record types defined in this
         specification in the "GNS Record Types" registry as listed in
         <a class="auto internal xref" href="#tab_rrtypenums">Table 2</a>.<a class="pilcrow" href="#section-10.2-6">¶</a></p>
<span id="name-the-gana-gns-record-types-r"></span><div id="tab_rrtypenums">
<table class="center" id="table-2">
          <caption>
<a class="selfRef" href="#table-2">Table 2</a>:
<a class="selfRef" href="#name-the-gana-gns-record-types-r">The GANA GNS Record Types Registry</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Number</th>
              <th class="text-left" colspan="1" rowspan="1">Name</th>
              <th class="text-left" colspan="1" rowspan="1">Contact</th>
              <th class="text-left" colspan="1" rowspan="1">References</th>
              <th class="text-left" colspan="1" rowspan="1">Comment</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">65536</td>
              <td class="text-left" colspan="1" rowspan="1">PKEY</td>
              <td class="text-left" colspan="1" rowspan="1">(*)</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9498</td>
              <td class="text-left" colspan="1" rowspan="1">GNS zone delegation (PKEY)</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">65537</td>
              <td class="text-left" colspan="1" rowspan="1">NICK</td>
              <td class="text-left" colspan="1" rowspan="1">(*)</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9498</td>
              <td class="text-left" colspan="1" rowspan="1">GNS zone nickname</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">65538</td>
              <td class="text-left" colspan="1" rowspan="1">LEHO</td>
              <td class="text-left" colspan="1" rowspan="1">(*)</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9498</td>
              <td class="text-left" colspan="1" rowspan="1">GNS legacy hostname</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">65540</td>
              <td class="text-left" colspan="1" rowspan="1">GNS2DNS</td>
              <td class="text-left" colspan="1" rowspan="1">(*)</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9498</td>
              <td class="text-left" colspan="1" rowspan="1">Delegation to DNS</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">65541</td>
              <td class="text-left" colspan="1" rowspan="1">BOX</td>
              <td class="text-left" colspan="1" rowspan="1">(*)</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9498</td>
              <td class="text-left" colspan="1" rowspan="1">Box records</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">65551</td>
              <td class="text-left" colspan="1" rowspan="1">REDIRECT</td>
              <td class="text-left" colspan="1" rowspan="1">(*)</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9498</td>
              <td class="text-left" colspan="1" rowspan="1">Redirection record</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">65556</td>
              <td class="text-left" colspan="1" rowspan="1">EDKEY</td>
              <td class="text-left" colspan="1" rowspan="1">(*)</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9498</td>
              <td class="text-left" colspan="1" rowspan="1">GNS zone delegation (EDKEY)</td>
            </tr>
          </tbody>
          <tfoot>
            <tr>
              <td class="text-left" colspan="5" rowspan="1">(*): gns-registry@gnunet.org</td>
            </tr>
          </tfoot>
        </table>
</div>
</section>
</div>
<div id="gana_alt">
<section id="section-10.3">
        <h3 id="name-alt-subdomains-registry">
<a class="section-number selfRef" href="#section-10.3">10.3. </a><a class="section-name selfRef" href="#name-alt-subdomains-registry">.alt Subdomains Registry</a>
        </h3>
<p id="section-10.3-1">
         GANA <span>[<a class="cite xref" href="#GANA">GANA</a>]</span>
         manages the ".alt Subdomains" registry. This GANA-operated .alt registry
         may or may not be taken into account by any particular implementer, and
         it is not in any way associated with or sanctioned by the IETF or ICANN.<a class="pilcrow" href="#section-10.3-1">¶</a></p>
<p id="section-10.3-2">Each entry has the following format:<a class="pilcrow" href="#section-10.3-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-10.3-3">
          <dt id="section-10.3-3.1">Label:</dt>
          <dd id="section-10.3-3.2" style="margin-left: 1.5em">The label of the subdomain (in DNS "letters, digits, hyphen" (LDH) format as defined in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc5890#section-2.3.1">Section 2.3.1</a> of [<a class="cite xref" href="#RFC5890">RFC5890</a>]</span>).<a class="pilcrow" href="#section-10.3-3.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-10.3-3.3">Description:</dt>
          <dd id="section-10.3-3.4" style="margin-left: 1.5em">Optionally, brief English text describing the purpose of
           the subdomain (in UTF-8).<a class="pilcrow" href="#section-10.3-3.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-10.3-3.5">Contact:</dt>
          <dd id="section-10.3-3.6" style="margin-left: 1.5em">Optionally, the contact information for a person to contact for
           further information.<a class="pilcrow" href="#section-10.3-3.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-10.3-3.7">References:</dt>
          <dd id="section-10.3-3.8" style="margin-left: 1.5em">Optionally, references (such as an RFC) describing the record type.<a class="pilcrow" href="#section-10.3-3.8">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-10.3-4">
         The registration policy for this registry is "First Come First
         Served". This policy is modeled on that described in <span>[<a class="cite xref" href="#RFC8126">RFC8126</a>]</span>
         and describes the actions taken by GANA:<a class="pilcrow" href="#section-10.3-4">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.3-5.1">
         Adding new entries is possible after review by any authorized
         GANA contributor, using a
         first-come-first-served policy for unique subdomain allocation.
         Reviewers are responsible for ensuring that the chosen "Subdomain" is
         appropriate for the purpose.<a class="pilcrow" href="#section-10.3-5.1">¶</a>
</li>
          <li class="normal" id="section-10.3-5.2">
         Authorized GANA contributors for review of new entries are reachable at
         &lt;alt-registry@gnunet.org&gt;.<a class="pilcrow" href="#section-10.3-5.2">¶</a>
</li>
          <li class="normal" id="section-10.3-5.3">
         Any request <span class="bcp14">MUST</span> contain a unique subdomain and a point of contact.
         The contact information <span class="bcp14">MAY</span> be added to the registry, with the consent
         of the requester.
         The request <span class="bcp14">MAY</span> optionally also contain relevant references as well
         as a descriptive comment, as defined above.<a class="pilcrow" href="#section-10.3-5.3">¶</a>
</li>
        </ul>
<p id="section-10.3-6">
         GANA has assigned the subdomain defined in this
         specification in the ".alt Subdomains" registry
         as listed in <a class="auto internal xref" href="#tab_altsubdomains">Table 3</a>.<a class="pilcrow" href="#section-10.3-6">¶</a></p>
<span id="name-the-gana-alt-subdomains-reg"></span><div id="tab_altsubdomains">
<table class="center" id="table-3">
          <caption>
<a class="selfRef" href="#table-3">Table 3</a>:
<a class="selfRef" href="#name-the-gana-alt-subdomains-reg">The GANA .alt Subdomains Registry</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Label</th>
              <th class="text-left" colspan="1" rowspan="1">Contact</th>
              <th class="text-left" colspan="1" rowspan="1">References</th>
              <th class="text-left" colspan="1" rowspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">gns</td>
              <td class="text-left" colspan="1" rowspan="1">(*)</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9498</td>
              <td class="text-left" colspan="1" rowspan="1">The .alt subdomain for GNS</td>
            </tr>
          </tbody>
          <tfoot>
            <tr>
              <td class="text-left" colspan="4" rowspan="1">(*): alt-registry@gnunet.org</td>
            </tr>
          </tfoot>
        </table>
</div>
</section>
</div>
</section>
</div>
<section id="section-11">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-11">11. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<p id="section-11-1">
       This document has no IANA actions.<a class="pilcrow" href="#section-11-1">¶</a></p>
</section>
<section id="section-12">
      <h2 id="name-implementation-and-deployme">
<a class="section-number selfRef" href="#section-12">12. </a><a class="section-name selfRef" href="#name-implementation-and-deployme">Implementation and Deployment Status</a>
      </h2>
<p id="section-12-1">
         There are two implementations conforming to this specification, written
         in C and Go, respectively. The C implementation as part of GNUnet
         <span>[<a class="cite xref" href="#GNUnetGNS">GNUnetGNS</a>]</span> represents the original
         and reference implementation. The Go implementation
         <span>[<a class="cite xref" href="#GoGNS">GoGNS</a>]</span> demonstrates how two implementations of GNS are
         interoperable if they are built on top of the same underlying
         DHT storage.<a class="pilcrow" href="#section-12-1">¶</a></p>
<p id="section-12-2">
         Currently, the GNUnet peer-to-peer network <span>[<a class="cite xref" href="#GNUnet">GNUnet</a>]</span>
         is an active deployment of GNS on top of its DHT <span>[<a class="cite xref" href="#R5N">R5N</a>]</span>. The Go implementation <span>[<a class="cite xref" href="#GoGNS">GoGNS</a>]</span> uses this deployment
         by building on top of the GNUnet DHT services available on any
         GNUnet peer. It shows how GNS implementations
         can attach to this existing deployment and participate in name
         resolution as well as zone publication.<a class="pilcrow" href="#section-12-2">¶</a></p>
<p id="section-12-3">
         The self-sovereign identity system re:claimID <span>[<a class="cite xref" href="#reclaim">reclaim</a>]</span>
         is using GNS in order to selectively share identity attributes and
         attestations with third parties.<a class="pilcrow" href="#section-12-3">¶</a></p>
<p id="section-12-4">
         The Ascension tool <span>[<a class="cite xref" href="#Ascension">Ascension</a>]</span> facilitates the migration of DNS zones to
         GNS zones by translating information retrieved from a DNS zone
         transfer into a GNS zone.<a class="pilcrow" href="#section-12-4">¶</a></p>
</section>
<section id="section-13">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-13">13. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-13.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-13.1">13.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC1034">[RFC1034]</dt>
        <dd>
<span class="refAuthor">Mockapetris, P.</span>, <span class="refTitle">"Domain names - concepts and facilities"</span>, <span class="seriesInfo">STD 13</span>, <span class="seriesInfo">RFC 1034</span>, <span class="seriesInfo">DOI 10.17487/RFC1034</span>, <time class="refDate" datetime="1987-11">November 1987</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1034">https://www.rfc-editor.org/info/rfc1034</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1035">[RFC1035]</dt>
        <dd>
<span class="refAuthor">Mockapetris, P.</span>, <span class="refTitle">"Domain names - implementation and specification"</span>, <span class="seriesInfo">STD 13</span>, <span class="seriesInfo">RFC 1035</span>, <span class="seriesInfo">DOI 10.17487/RFC1035</span>, <time class="refDate" datetime="1987-11">November 1987</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1035">https://www.rfc-editor.org/info/rfc1035</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2782">[RFC2782]</dt>
        <dd>
<span class="refAuthor">Gulbrandsen, A.</span>, <span class="refAuthor">Vixie, P.</span>, and <span class="refAuthor">L. Esibov</span>, <span class="refTitle">"A DNS RR for specifying the location of services (DNS SRV)"</span>, <span class="seriesInfo">RFC 2782</span>, <span class="seriesInfo">DOI 10.17487/RFC2782</span>, <time class="refDate" datetime="2000-02">February 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2782">https://www.rfc-editor.org/info/rfc2782</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time class="refDate" datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3629">[RFC3629]</dt>
        <dd>
<span class="refAuthor">Yergeau, F.</span>, <span class="refTitle">"UTF-8, a transformation format of ISO 10646"</span>, <span class="seriesInfo">STD 63</span>, <span class="seriesInfo">RFC 3629</span>, <span class="seriesInfo">DOI 10.17487/RFC3629</span>, <time class="refDate" datetime="2003-11">November 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3629">https://www.rfc-editor.org/info/rfc3629</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3686">[RFC3686]</dt>
        <dd>
<span class="refAuthor">Housley, R.</span>, <span class="refTitle">"Using Advanced Encryption Standard (AES) Counter Mode With IPsec Encapsulating Security Payload (ESP)"</span>, <span class="seriesInfo">RFC 3686</span>, <span class="seriesInfo">DOI 10.17487/RFC3686</span>, <time class="refDate" datetime="2004-01">January 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3686">https://www.rfc-editor.org/info/rfc3686</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3826">[RFC3826]</dt>
        <dd>
<span class="refAuthor">Blumenthal, U.</span>, <span class="refAuthor">Maino, F.</span>, and <span class="refAuthor">K. McCloghrie</span>, <span class="refTitle">"The Advanced Encryption Standard (AES) Cipher Algorithm in the SNMP User-based Security Model"</span>, <span class="seriesInfo">RFC 3826</span>, <span class="seriesInfo">DOI 10.17487/RFC3826</span>, <time class="refDate" datetime="2004-06">June 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3826">https://www.rfc-editor.org/info/rfc3826</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5237">[RFC5237]</dt>
        <dd>
<span class="refAuthor">Arkko, J.</span> and <span class="refAuthor">S. Bradner</span>, <span class="refTitle">"IANA Allocation Guidelines for the Protocol Field"</span>, <span class="seriesInfo">BCP 37</span>, <span class="seriesInfo">RFC 5237</span>, <span class="seriesInfo">DOI 10.17487/RFC5237</span>, <time class="refDate" datetime="2008-02">February 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5237">https://www.rfc-editor.org/info/rfc5237</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5869">[RFC5869]</dt>
        <dd>
<span class="refAuthor">Krawczyk, H.</span> and <span class="refAuthor">P. Eronen</span>, <span class="refTitle">"HMAC-based Extract-and-Expand Key Derivation Function (HKDF)"</span>, <span class="seriesInfo">RFC 5869</span>, <span class="seriesInfo">DOI 10.17487/RFC5869</span>, <time class="refDate" datetime="2010-05">May 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5869">https://www.rfc-editor.org/info/rfc5869</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5890">[RFC5890]</dt>
        <dd>
<span class="refAuthor">Klensin, J.</span>, <span class="refTitle">"Internationalized Domain Names for Applications (IDNA): Definitions and Document Framework"</span>, <span class="seriesInfo">RFC 5890</span>, <span class="seriesInfo">DOI 10.17487/RFC5890</span>, <time class="refDate" datetime="2010-08">August 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5890">https://www.rfc-editor.org/info/rfc5890</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5895">[RFC5895]</dt>
        <dd>
<span class="refAuthor">Resnick, P.</span> and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Mapping Characters for Internationalized Domain Names in Applications (IDNA) 2008"</span>, <span class="seriesInfo">RFC 5895</span>, <span class="seriesInfo">DOI 10.17487/RFC5895</span>, <time class="refDate" datetime="2010-09">September 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5895">https://www.rfc-editor.org/info/rfc5895</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6234">[RFC6234]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span> and <span class="refAuthor">T. Hansen</span>, <span class="refTitle">"US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)"</span>, <span class="seriesInfo">RFC 6234</span>, <span class="seriesInfo">DOI 10.17487/RFC6234</span>, <time class="refDate" datetime="2011-05">May 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6234">https://www.rfc-editor.org/info/rfc6234</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6895">[RFC6895]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refTitle">"Domain Name System (DNS) IANA Considerations"</span>, <span class="seriesInfo">BCP 42</span>, <span class="seriesInfo">RFC 6895</span>, <span class="seriesInfo">DOI 10.17487/RFC6895</span>, <time class="refDate" datetime="2013-04">April 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6895">https://www.rfc-editor.org/info/rfc6895</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6979">[RFC6979]</dt>
        <dd>
<span class="refAuthor">Pornin, T.</span>, <span class="refTitle">"Deterministic Usage of the Digital Signature Algorithm (DSA) and Elliptic Curve Digital Signature Algorithm (ECDSA)"</span>, <span class="seriesInfo">RFC 6979</span>, <span class="seriesInfo">DOI 10.17487/RFC6979</span>, <time class="refDate" datetime="2013-08">August 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6979">https://www.rfc-editor.org/info/rfc6979</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7748">[RFC7748]</dt>
        <dd>
<span class="refAuthor">Langley, A.</span>, <span class="refAuthor">Hamburg, M.</span>, and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"Elliptic Curves for Security"</span>, <span class="seriesInfo">RFC 7748</span>, <span class="seriesInfo">DOI 10.17487/RFC7748</span>, <time class="refDate" datetime="2016-01">January 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7748">https://www.rfc-editor.org/info/rfc7748</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8032">[RFC8032]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span> and <span class="refAuthor">I. Liusvaara</span>, <span class="refTitle">"Edwards-Curve Digital Signature Algorithm (EdDSA)"</span>, <span class="seriesInfo">RFC 8032</span>, <span class="seriesInfo">DOI 10.17487/RFC8032</span>, <time class="refDate" datetime="2017-01">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8032">https://www.rfc-editor.org/info/rfc8032</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time class="refDate" datetime="2017-06">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time class="refDate" datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8499">[RFC8499]</dt>
        <dd>
<span class="refAuthor">Hoffman, P.</span>, <span class="refAuthor">Sullivan, A.</span>, and <span class="refAuthor">K. Fujiwara</span>, <span class="refTitle">"DNS Terminology"</span>, <span class="seriesInfo">BCP 219</span>, <span class="seriesInfo">RFC 8499</span>, <span class="seriesInfo">DOI 10.17487/RFC8499</span>, <time class="refDate" datetime="2019-01">January 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8499">https://www.rfc-editor.org/info/rfc8499</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9106">[RFC9106]</dt>
        <dd>
<span class="refAuthor">Biryukov, A.</span>, <span class="refAuthor">Dinu, D.</span>, <span class="refAuthor">Khovratovich, D.</span>, and <span class="refAuthor">S. Josefsson</span>, <span class="refTitle">"Argon2 Memory-Hard Function for Password Hashing and Proof-of-Work Applications"</span>, <span class="seriesInfo">RFC 9106</span>, <span class="seriesInfo">DOI 10.17487/RFC9106</span>, <time class="refDate" datetime="2021-09">September 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9106">https://www.rfc-editor.org/info/rfc9106</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="GANA">[GANA]</dt>
        <dd>
<span class="refAuthor">GNUnet e.V.</span>, <span class="refTitle">"GNUnet Assigned Numbers Authority (GANA)"</span>, <time class="refDate" datetime="2023">2023</time>, <span>&lt;<a href="https://gana.gnunet.org/">https://gana.gnunet.org/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="MODES">[MODES]</dt>
        <dd>
<span class="refAuthor">Dworkin, M.</span>, <span class="refTitle">"Recommendation for Block Cipher Modes of Operation: Methods and Techniques"</span>, <span class="refContent">NIST Special Publication 800-38A</span>, <span class="seriesInfo">DOI 10.6028/NIST.SP.800-38A</span>, <time class="refDate" datetime="2001-12">December 2001</time>, <span>&lt;<a href="https://doi.org/10.6028/NIST.SP.800-38A">https://doi.org/10.6028/NIST.SP.800-38A</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="CrockfordB32">[CrockfordB32]</dt>
        <dd>
<span class="refAuthor">Crockford, D.</span>, <span class="refTitle">"Base 32"</span>, <time class="refDate" datetime="2019-03">March 2019</time>, <span>&lt;<a href="https://www.crockford.com/base32.html">https://www.crockford.com/base32.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="XSalsa20">[XSalsa20]</dt>
        <dd>
<span class="refAuthor">Bernstein, D. J.</span>, <span class="refTitle">"Extending the Salsa20 nonce"</span>, <time class="refDate" datetime="2011">2011</time>, <span>&lt;<a href="https://cr.yp.to/papers.html#xsalsa">https://cr.yp.to/papers.html#xsalsa</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Unicode-UAX15">[Unicode-UAX15]</dt>
        <dd>
<span class="refAuthor">Davis, M.</span>, <span class="refAuthor">Whistler, K.</span>, and <span class="refAuthor">M. Dürst</span>, <span class="refTitle">"Unicode Standard Annex #15: Unicode Normalization Forms"</span>, <span class="refContent">Revision 31, The Unicode Consortium, Mountain View</span>, <time class="refDate" datetime="2009-09">September 2009</time>, <span>&lt;<a href="https://www.unicode.org/reports/tr15/tr15-31.html">https://www.unicode.org/reports/tr15/tr15-31.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Unicode-UTS46">[Unicode-UTS46]</dt>
      <dd>
<span class="refAuthor">Davis, M.</span> and <span class="refAuthor">M. Suignard</span>, <span class="refTitle">"Unicode Technical Standard #46: Unicode IDNA Compatibility Processing"</span>, <span class="refContent">Revision 31, The Unicode Consortium, Mountain View</span>, <time class="refDate" datetime="2023-09">September 2023</time>, <span>&lt;<a href="https://www.unicode.org/reports/tr46">https://www.unicode.org/reports/tr46</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-13.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-13.2">13.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC1928">[RFC1928]</dt>
        <dd>
<span class="refAuthor">Leech, M.</span>, <span class="refAuthor">Ganis, M.</span>, <span class="refAuthor">Lee, Y.</span>, <span class="refAuthor">Kuris, R.</span>, <span class="refAuthor">Koblas, D.</span>, and <span class="refAuthor">L. Jones</span>, <span class="refTitle">"SOCKS Protocol Version 5"</span>, <span class="seriesInfo">RFC 1928</span>, <span class="seriesInfo">DOI 10.17487/RFC1928</span>, <time class="refDate" datetime="1996-03">March 1996</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1928">https://www.rfc-editor.org/info/rfc1928</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4033">[RFC4033]</dt>
        <dd>
<span class="refAuthor">Arends, R.</span>, <span class="refAuthor">Austein, R.</span>, <span class="refAuthor">Larson, M.</span>, <span class="refAuthor">Massey, D.</span>, and <span class="refAuthor">S. Rose</span>, <span class="refTitle">"DNS Security Introduction and Requirements"</span>, <span class="seriesInfo">RFC 4033</span>, <span class="seriesInfo">DOI 10.17487/RFC4033</span>, <time class="refDate" datetime="2005-03">March 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4033">https://www.rfc-editor.org/info/rfc4033</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6066">[RFC6066]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refTitle">"Transport Layer Security (TLS) Extensions: Extension Definitions"</span>, <span class="seriesInfo">RFC 6066</span>, <span class="seriesInfo">DOI 10.17487/RFC6066</span>, <time class="refDate" datetime="2011-01">January 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6066">https://www.rfc-editor.org/info/rfc6066</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7363">[RFC7363]</dt>
        <dd>
<span class="refAuthor">Maenpaa, J.</span> and <span class="refAuthor">G. Camarillo</span>, <span class="refTitle">"Self-Tuning Distributed Hash Table (DHT) for REsource LOcation And Discovery (RELOAD)"</span>, <span class="seriesInfo">RFC 7363</span>, <span class="seriesInfo">DOI 10.17487/RFC7363</span>, <time class="refDate" datetime="2014-09">September 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7363">https://www.rfc-editor.org/info/rfc7363</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8324">[RFC8324]</dt>
        <dd>
<span class="refAuthor">Klensin, J.</span>, <span class="refTitle">"DNS Privacy, Authorization, Special Uses, Encoding, Characters, Matching, and Root Structure: Time for Another Look?"</span>, <span class="seriesInfo">RFC 8324</span>, <span class="seriesInfo">DOI 10.17487/RFC8324</span>, <time class="refDate" datetime="2018-02">February 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8324">https://www.rfc-editor.org/info/rfc8324</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8806">[RFC8806]</dt>
        <dd>
<span class="refAuthor">Kumari, W.</span> and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Running a Root Server Local to a Resolver"</span>, <span class="seriesInfo">RFC 8806</span>, <span class="seriesInfo">DOI 10.17487/RFC8806</span>, <time class="refDate" datetime="2020-06">June 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8806">https://www.rfc-editor.org/info/rfc8806</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6761">[RFC6761]</dt>
        <dd>
<span class="refAuthor">Cheshire, S.</span> and <span class="refAuthor">M. Krochmal</span>, <span class="refTitle">"Special-Use Domain Names"</span>, <span class="seriesInfo">RFC 6761</span>, <span class="seriesInfo">DOI 10.17487/RFC6761</span>, <time class="refDate" datetime="2013-02">February 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6761">https://www.rfc-editor.org/info/rfc6761</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8244">[RFC8244]</dt>
        <dd>
<span class="refAuthor">Lemon, T.</span>, <span class="refAuthor">Droms, R.</span>, and <span class="refAuthor">W. Kumari</span>, <span class="refTitle">"Special-Use Domain Names Problem Statement"</span>, <span class="seriesInfo">RFC 8244</span>, <span class="seriesInfo">DOI 10.17487/RFC8244</span>, <time class="refDate" datetime="2017-10">October 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8244">https://www.rfc-editor.org/info/rfc8244</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9476">[RFC9476]</dt>
        <dd>
<span class="refAuthor">Kumari, W.</span> and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"The .alt Special-Use Top-Level Domain"</span>, <span class="seriesInfo">RFC 9476</span>, <span class="seriesInfo">DOI 10.17487/RFC9476</span>, <time class="refDate" datetime="2023-09">September 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9476">https://www.rfc-editor.org/info/rfc9476</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TorRendSpec">[TorRendSpec]</dt>
        <dd>
<span class="refAuthor">Tor Project</span>, <span class="refTitle">"Tor Rendezvous Specification - Version 3"</span>, <span class="refContent">commit b345ca0</span>, <time class="refDate" datetime="2023-06">June 2023</time>, <span>&lt;<a href="https://github.com/torproject/torspec/blob/main/rend-spec-v3.txt">https://github.com/torproject/torspec/blob/main/rend-spec-v3.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Tor224">[Tor224]</dt>
        <dd>
<span class="refAuthor">Goulet, D.</span>, <span class="refAuthor">Kadianakis, G.</span>, and <span class="refAuthor">N. Mathewson</span>, <span class="refTitle">"Next-Generation Hidden Services in Tor"</span>, <span class="refContent">Appendix A.2 ("Tor's key derivation scheme")</span>, <time class="refDate" datetime="2013-11">November 2013</time>, <span>&lt;<a href="https://gitweb.torproject.org/torspec.git/tree/proposals/224-rend-spec-ng.txt#n2135">https://gitweb.torproject.org/torspec.git/tree/proposals/224-rend-spec-ng.txt#n2135</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SDSI">[SDSI]</dt>
        <dd>
<span class="refAuthor">Rivest, R. L.</span> and <span class="refAuthor">B. Lampson</span>, <span class="refTitle">"SDSI - A Simple Distributed Security Infrastructure"</span>, <time class="refDate" datetime="1996-10">October 1996</time>, <span>&lt;<a href="https://citeseerx.ist.psu.edu/document?repid=rep1&amp;type=pdf&amp;doi=3837e0206bf73e5e8f0ba6db767a2f714ea7c367">https://citeseerx.ist.psu.edu/document?repid=rep1&amp;type=pdf&amp;doi=3837e0206bf73e5e8f0ba6db767a2f714ea7c367</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Kademlia">[Kademlia]</dt>
        <dd>
<span class="refAuthor">Maymounkov, P.</span> and <span class="refAuthor">D. Mazières</span>, <span class="refTitle">"Kademlia: A Peer-to-peer Information System Based on the XOR Metric"</span>, <span class="seriesInfo">DOI 10.1007/3-540-45748-8_5</span>, <time class="refDate" datetime="2002">2002</time>, <span>&lt;<a href="https://css.csail.mit.edu/6.824/2014/papers/kademlia.pdf">https://css.csail.mit.edu/6.824/2014/papers/kademlia.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ed25519">[ed25519]</dt>
        <dd>
<span class="refAuthor">Bernstein, D. J.</span>, <span class="refAuthor">Duif, N.</span>, <span class="refAuthor">Lange, T.</span>, <span class="refAuthor">Schwabe, P.</span>, and <span class="refAuthor">B-Y. Yang</span>, <span class="refTitle">"High-speed high-security signatures"</span>, <span class="seriesInfo">DOI 10.1007/s13389-012-0027-1</span>, <time class="refDate" datetime="2011">2011</time>, <span>&lt;<a href="https://ed25519.cr.yp.to/ed25519-20110926.pdf">https://ed25519.cr.yp.to/ed25519-20110926.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="GNS">[GNS]</dt>
        <dd>
<span class="refAuthor">Wachs, M.</span>, <span class="refAuthor">Schanzenbach, M.</span>, and <span class="refAuthor">C. Grothoff</span>, <span class="refTitle">"A Censorship-Resistant, Privacy-Enhancing and Fully Decentralized Name System"</span>, <span class="refContent">13th International Conference on Cryptology and Network Security (CANS)</span>, <span class="seriesInfo">DOI 10.13140/2.1.4642.3044</span>, <time class="refDate" datetime="2014-10">October 2014</time>, <span>&lt;<a href="https://sci-hub.st/10.1007/978-3-319-12280-9_9">https://sci-hub.st/10.1007/978-3-319-12280-9_9</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="R5N">[R5N]</dt>
        <dd>
<span class="refAuthor">Evans, N. S.</span> and <span class="refAuthor">C. Grothoff</span>, <span class="refTitle">"R5N: Randomized Recursive Routing for Restricted-Route Networks"</span>, <span class="refContent">5th International Conference on Network and System Security (NSS)</span>, <span class="seriesInfo">DOI 10.1109/ICNSS.2011.6060022</span>, <time class="refDate" datetime="2011-09">September 2011</time>, <span>&lt;<a href="https://sci-hub.st/10.1109/ICNSS.2011.6060022">https://sci-hub.st/10.1109/ICNSS.2011.6060022</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SecureNS">[SecureNS]</dt>
        <dd>
<span class="refAuthor">Grothoff, C.</span>, <span class="refAuthor">Wachs, M.</span>, <span class="refAuthor">Ermert, M.</span>, and <span class="refAuthor">J. Appelbaum</span>, <span class="refTitle">"Toward secure name resolution on the Internet"</span>, <span class="refContent">Computers and Security, Volume 77, Issue C, pp. 694-708</span>, <span class="seriesInfo">DOI 10.1016/j.cose.2018.01.018</span>, <time class="refDate" datetime="2018-08">August 2018</time>, <span>&lt;<a href="https://sci-hub.st/https://doi.org/10.1016/j.cose.2018.01.018">https://sci-hub.st/https://doi.org/10.1016/j.cose.2018.01.018</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="GNUnetGNS">[GNUnetGNS]</dt>
        <dd>
<span class="refAuthor">GNUnet e.V.</span>, <span class="refTitle">"gnunet.git - GNUnet core repository"</span>, <time class="refDate" datetime="2023">2023</time>, <span>&lt;<a href="https://git.gnunet.org/gnunet.git">https://git.gnunet.org/gnunet.git</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Ascension">[Ascension]</dt>
        <dd>
<span class="refAuthor">GNUnet e.V.</span>, <span class="refTitle">"ascension.git - DNS zones to GNS migrating using incremental zone transfer (AXFR/IXFR)"</span>, <time class="refDate" datetime="2023">2023</time>, <span>&lt;<a href="https://git.gnunet.org/ascension.git">https://git.gnunet.org/ascension.git</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="GNUnet">[GNUnet]</dt>
        <dd>
<span class="refAuthor">GNUnet e.V.</span>, <span class="refTitle">"The GNUnet Project (Home Page)"</span>, <time class="refDate" datetime="2023">2023</time>, <span>&lt;<a href="https://gnunet.org">https://gnunet.org</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="reclaim">[reclaim]</dt>
        <dd>
<span class="refAuthor">GNUnet e.V.</span>, <span class="refTitle">"re:claimID - Self-sovereign, Decentralised Identity Management and Personal Data Sharing"</span>, <time class="refDate" datetime="2023">2023</time>, <span>&lt;<a href="https://reclaim.gnunet.org">https://reclaim.gnunet.org</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="GoGNS">[GoGNS]</dt>
        <dd>
<span class="refAuthor">Fix, B.</span>, <span class="refTitle">"gnunet-go (Go GNS)"</span>, <span class="refContent">commit 5c815ba</span>, <time class="refDate" datetime="2023-07">July 2023</time>, <span>&lt;<a href="https://github.com/bfix/gnunet-go/tree/master/src/gnunet/service/gns">https://github.com/bfix/gnunet-go/tree/master/src/gnunet/service/gns</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="nsswitch">[nsswitch]</dt>
      <dd>
<span class="refAuthor">GNU Project</span>, <span class="refTitle">"System Databases and Name Service Switch (Section 29)"</span>, <span>&lt;<a href="https://www.gnu.org/software/libc/manual/html_node/Name-Service-Switch.html">https://www.gnu.org/software/libc/manual/html_node/Name-Service-Switch.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<section id="appendix-A">
      <h2 id="name-usage-and-migration">
<a class="section-number selfRef" href="#appendix-A">Appendix A. </a><a class="section-name selfRef" href="#name-usage-and-migration">Usage and Migration</a>
      </h2>
<p id="appendix-A-1">
         This section outlines a number of specific use cases that may
         help readers of this technical specification better understand the protocol.
         The considerations below are not meant to be normative for the
         GNS protocol in any way.
         Instead, they are provided in order to give context and to provide
         some background on what the intended use of the protocol is
         by its designers.
         Further, this section provides pointers to migration paths.<a class="pilcrow" href="#appendix-A-1">¶</a></p>
<div id="day_in_zoneowner">
<section id="appendix-A.1">
        <h3 id="name-zone-dissemination">
<a class="section-number selfRef" href="#appendix-A.1">A.1. </a><a class="section-name selfRef" href="#name-zone-dissemination">Zone Dissemination</a>
        </h3>
<p id="appendix-A.1-1">
           In order to become a zone owner, it is sufficient to generate
           a zone key and a corresponding secret key using a GNS implementation.
           At this point, the zone owner can manage GNS resource records in a
           local zone database.
           The resource records can then be published by a GNS implementation
           as defined in <a class="auto internal xref" href="#publish">Section 6</a>.
           For other users to resolve the resource records, the respective
           zone information must be disseminated first.
           The zone owner may decide to make the zone key and labels known
           to a selected set of users only or to make this information available
           to the general public.<a class="pilcrow" href="#appendix-A.1-1">¶</a></p>
<p id="appendix-A.1-2">
           Sharing zone information directly with specific users not only allows
           an implementation to potentially preserve zone and record privacy but also allows
           the zone owner and the user to establish strong trust relationships.
           For example, a bank may send a customer letter with a QR code that
           contains the GNS zone of the bank.
           This allows the user to scan the QR code and establish a strong
           link to the zone of the bank and with it, for example, the IP address
           of the online banking web site.<a class="pilcrow" href="#appendix-A.1-2">¶</a></p>
<p id="appendix-A.1-3">
           Most Internet services likely want to make their zones available
           to the general public in the most efficient way possible.
           First, it is reasonable to assume that zones that are commanding
           high levels of reputation and trust are likely included in the
           default suffix-to-zone mappings of implementations.
           Hence, dissemination of a zone through delegation under such zones
           can be a viable path in order to disseminate a zone publicly.
           For example, it is conceivable that organizations such as ICANN
           or country-code TLD registrars also manage GNS zones
           and offer registration or delegation services.<a class="pilcrow" href="#appendix-A.1-3">¶</a></p>
<p id="appendix-A.1-4">
           Following best practices, particularly those related to
           security and abuse mitigation, are methods that allow zone owners
           and aspiring registrars to gain a good reputation and, eventually,
           trust.
           This includes, of course, diligent protection of private zone key
           material.
           Formalizing such best practices is out of scope for this
           specification and should be addressed in a separate document that takes
           <a class="auto internal xref" href="#security">Section 9</a> of this document into account.<a class="pilcrow" href="#appendix-A.1-4">¶</a></p>
</section>
</div>
<section id="appendix-A.2">
        <h3 id="name-start-zone-configuration">
<a class="section-number selfRef" href="#appendix-A.2">A.2. </a><a class="section-name selfRef" href="#name-start-zone-configuration">Start Zone Configuration</a>
        </h3>
<p id="appendix-A.2-1">
           A user is expected to install a GNS implementation if it is not already
           provided through other means such as the operating system
           or the browser.
           It is likely that the implementation ships with a
           default Start Zone configuration.
           This means that the user is able to resolve GNS names ending on a
           zTLD or ending on any suffix-to-name mapping that is part of the
           default Start Zone configuration.
           At this point, the user may delete or otherwise modify the
           implementation's default configuration:<a class="pilcrow" href="#appendix-A.2-1">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.2-2.1">
            Deletion of suffix-to-zone mappings may become necessary if the
            zone owner referenced by the mapping has lost the trust of the user.
            For example, this could be due to lax registration policies resulting
            in phishing activities.
            Modification and addition of new mappings are means to heal the
            namespace perforation that would occur in the case of a deletion
            or to simply establish a strong direct trust relationship.
            However, this requires the user's knowledge of the respective zone
            keys.
            This information must be retrieved out of band, as illustrated in
            <a class="auto internal xref" href="#day_in_zoneowner">Appendix A.1</a>:
            a bank may send the user a letter with a QR code that contains the
            GNS zone of the bank.
            The user scans the QR code and adds a new suffix-to-name mapping
            using a chosen local name for their bank.
            Other examples include scanning zone information off the device of
            a friend, from a storefront, or from an advertisement.
            The level of trust in the respective zone is contextual and likely
            varies from user to user.
            Trust in a zone provided through a letter from a bank that
            may also include a credit card is certainly different from a zone
            found on a random advertisement on the street.
            However, this trust is immediately tangible to the user and can
            be reflected in the local naming as well.<a class="pilcrow" href="#appendix-A.2-2.1">¶</a>
</li>
          <li class="normal" id="appendix-A.2-2.2">
            Users that are also clients should facilitate the modification of the Start Zone
            configuration -- for example, by providing a QR code reader or other
            import mechanisms.
            Implementations are ideally implemented
            according to best practices and addressing applicable points
            from <a class="auto internal xref" href="#security">Section 9</a>.
            Formalizing such best practices is out of scope for this
            specification.<a class="pilcrow" href="#appendix-A.2-2.2">¶</a>
</li>
        </ul>
</section>
<div id="uc_virthost">
<section id="appendix-A.3">
        <h3 id="name-globally-unique-names-and-t">
<a class="section-number selfRef" href="#appendix-A.3">A.3. </a><a class="section-name selfRef" href="#name-globally-unique-names-and-t">Globally Unique Names and the Web</a>
        </h3>
<p id="appendix-A.3-1">
           HTTP virtual hosting and TLS Server Name Indication (SNI) are common
           use cases on the Web.
           HTTP clients supply a DNS name in the HTTP
           "Host"-header or as part of the TLS handshake, respectively.
           This allows the HTTP server to serve the indicated virtual host
           with a matching TLS certificate.
           The global uniqueness of DNS names is a prerequisite of those use cases.<a class="pilcrow" href="#appendix-A.3-1">¶</a></p>
<p id="appendix-A.3-2">
           Not all GNS names are globally unique.
           However, any resource record in GNS can be represented as a
           concatenation of a GNS label and the zTLD of the zone.
           While not memorable, this globally unique GNS name can be
           leveraged in order to facilitate the same use cases.
           Consider the GNS name "www.example.gns.alt" entered in a GNS-aware
           HTTP client.
           At first, "www.example.gns.alt" is resolved using GNS, yielding a record
           set.
           Then, the HTTP client determines the virtual host as follows:<a class="pilcrow" href="#appendix-A.3-2">¶</a></p>
<p id="appendix-A.3-3">
            If there is a LEHO record (<a class="auto internal xref" href="#gnsrecords_leho">Section 5.3.1</a>)
            containing "www.example.com" in the record set, then the HTTP
            client uses this as the value of the
            "Host"-header field of the HTTP request:<a class="pilcrow" href="#appendix-A.3-3">¶</a></p>
<div class="lang-http-message sourcecode" id="appendix-A.3-4">
<pre>GET / HTTP/1.1
Host: www.example.com
</pre><a class="pilcrow" href="#appendix-A.3-4">¶</a>
</div>
<p id="appendix-A.3-5">
In the absence of a LEHO record, an additional GNS resolution is
required to check whether "www.example.gns.alt" itself points to a
zone delegation record, which implies that the record set that was
originally resolved is published under the apex label.<a class="pilcrow" href="#appendix-A.3-5">¶</a></p>
<p id="appendix-A.3-6">
If it does, the unique GNS name is simply the zTLD representation of
the delegated zone:<a class="pilcrow" href="#appendix-A.3-6">¶</a></p>
<div class="lang-http-message sourcecode" id="appendix-A.3-7">
<pre>GET / HTTP/1.1
Host: 000G0037FH3QTBCK15Y8BCCNRVWPV17ZC7TSGB1C9ZG2TPGHZVFV1GMG3W
</pre><a class="pilcrow" href="#appendix-A.3-7">¶</a>
</div>
<p id="appendix-A.3-8">
On the other hand, if there is no zone delegation record for
"www.example.gns.alt", then the unique GNS name is the concatenation of
the leftmost label (e.g., "www") and the zTLD representation of the zone:<a class="pilcrow" href="#appendix-A.3-8">¶</a></p>
<div class="lang-http-message sourcecode" id="appendix-A.3-9">
<pre>GET / HTTP/1.1
Host: www.000G0037FH3QTBCK15Y8BCCNRVWPV17ZC7TSGB1C9ZG2TPGHZVFV1GMG3W
</pre><a class="pilcrow" href="#appendix-A.3-9">¶</a>
</div>
<p id="appendix-A.3-10">
Note that this second GNS resolution does not require any additional
network operation, as only the local record processing differs as per
the exception mentioned in the last sentence of <a class="auto internal xref" href="#delegation_processing">Section 7.3.4</a>.<a class="pilcrow" href="#appendix-A.3-10">¶</a></p>
<p id="appendix-A.3-11">
            If the HTTP client is a browser, the use of a unique GNS name
            for virtual hosting or TLS SNI does not necessarily have to be
            shown to the user.
            For example, the name in the URL bar may remain as "www.example.gns.alt"
            even if the used unique name in the "Host"-header differs.<a class="pilcrow" href="#appendix-A.3-11">¶</a></p>
</section>
</div>
<section id="appendix-A.4">
        <h3 id="name-migration-paths">
<a class="section-number selfRef" href="#appendix-A.4">A.4. </a><a class="section-name selfRef" href="#name-migration-paths">Migration Paths</a>
        </h3>
<p id="appendix-A.4-1">
            DNS resolution is built into a variety of existing software
            components -- most significantly, operating systems and HTTP clients.
            This section illustrates possible migration paths for both in order
            to enable legacy applications to resolve GNS names.<a class="pilcrow" href="#appendix-A.4-1">¶</a></p>
<p id="appendix-A.4-2">
            One way to efficiently facilitate the resolution of GNS names
            is via GNS-enabled DNS server implementations.
            Local DNS queries are thereby either rerouted or explicitly configured
            to be resolved by a "DNS-to-GNS" server that runs locally.
            This DNS server tries to interpret any incoming query for a name
            as a GNS resolution request.
            If no Start Zone can be found for the name and it does not end in
            a zTLD, the server tries to resolve the name in DNS.
            Otherwise, the name is resolved in GNS.
            In the latter case, the resulting record set is converted to a DNS
            answer packet and is returned accordingly.
            An implementation of a DNS-to-GNS server can be found in
            <span>[<a class="cite xref" href="#GNUnet">GNUnet</a>]</span>.<a class="pilcrow" href="#appendix-A.4-2">¶</a></p>
<p id="appendix-A.4-3">
            A similar approach is to use operating system extensions such as
            the NSS <span>[<a class="cite xref" href="#nsswitch">nsswitch</a>]</span>.
            It allows the system administrator to configure plugins
            that are used for hostname resolution.
            A GNS nsswitch plugin can be used in a fashion similar to
            that used for the DNS-to-GNS server.
            An implementation of a glibc-compatible nsswitch plugin for GNS
            can be found in <span>[<a class="cite xref" href="#GNUnet">GNUnet</a>]</span>.<a class="pilcrow" href="#appendix-A.4-3">¶</a></p>
<p id="appendix-A.4-4">
            The methods above are usually also effective for HTTP client
            software.
            However, HTTP clients are commonly used in combination with
            TLS.
            TLS certificate validation, and SNI in particular, require additional logic in HTTP clients when GNS names are
            in play (<a class="auto internal xref" href="#uc_virthost">Appendix A.3</a>).
            In order to transparently enable this functionality for migration
            purposes, a local GNS-aware SOCKS5 proxy <span>[<a class="cite xref" href="#RFC1928">RFC1928</a>]</span>
            can be configured to resolve domain names.
            The SOCKS5 proxy, similar to the DNS-to-GNS server, is capable
            of resolving both GNS and DNS names.
            In the event of a TLS connection request with a GNS name, the SOCKS5
            proxy can terminate the TLS connection
            and establish a secure connection against the requested host.
            In order to establish a secure connection, the proxy may use LEHO
            and TLSA records stored in the record set under the GNS name.
            The proxy must provide a locally trusted certificate for the GNS
            name to the HTTP client; this usually requires the generation and
            configuration of a local trust anchor in the browser.
            An implementation of this SOCKS5 proxy can be found in
            <span>[<a class="cite xref" href="#GNUnet">GNUnet</a>]</span>.<a class="pilcrow" href="#appendix-A.4-4">¶</a></p>
</section>
</section>
<section id="appendix-B">
      <h2 id="name-example-flows">
<a class="section-number selfRef" href="#appendix-B">Appendix B. </a><a class="section-name selfRef" href="#name-example-flows">Example Flows</a>
      </h2>
<section id="appendix-B.1">
        <h3 id="name-aaaa-example-resolution">
<a class="section-number selfRef" href="#appendix-B.1">B.1. </a><a class="section-name selfRef" href="#name-aaaa-example-resolution">AAAA Example Resolution</a>
        </h3>
<span id="name-example-resolution-of-an-ip"></span><div id="figure_resolution_ex_aaaa">
<figure id="figure-24">
          <div class="alignLeft art-text artwork" id="appendix-B.1-1.1">
<pre>                           Local Host             |   Remote
                                                  |   Storage
                                                  |
                                                  |    +---------+
                                                  |   /         /|
                                                  |  +---------+ |
+-----------+ (1)      +----------+               |  |         | |
|           |          |          |      (4,6)    |  | Record  | |
|Application|----------| Resolver |---------------|-&gt;| Storage | |
|           |&lt;---------|          |&lt;--------------|--|         |/
+-----------+ (8)      +----------+      (5,7)    |  +---------+
                          A                       |
                          |                       |
                    (2,3) |                       |
                          |                       |
                          |                       |
                       +---------+                |
                      /   v     /|                |
                     +---------+ |                |
                     |         | |                |
                     |  Start  | |                |
                     |  Zones  | |                |
                     |         |/                 |
                     +---------+                  |
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-24">Figure 24</a>:
<a class="selfRef" href="#name-example-resolution-of-an-ip">Example Resolution of an IPv6 Address</a>
          </figcaption></figure>
</div>
<ol class="normal type-1" id="appendix-B.1-2" start="1" type="1">
           <li id="appendix-B.1-2.1">Look up AAAA record for name: "www.example.gnu.gns.alt".<a class="pilcrow" href="#appendix-B.1-2.1">¶</a>
</li>
          <li id="appendix-B.1-2.2">Determine Start Zone for "www.example.gnu.gns.alt".<a class="pilcrow" href="#appendix-B.1-2.2">¶</a>
</li>
          <li id="appendix-B.1-2.3">Start Zone: zkey0 - Remainder: "www.example".<a class="pilcrow" href="#appendix-B.1-2.3">¶</a>
</li>
          <li id="appendix-B.1-2.4">Calculate q0=SHA512(ZKDF(zkey0, "example")) and initiate GET(q0).<a class="pilcrow" href="#appendix-B.1-2.4">¶</a>
</li>
          <li id="appendix-B.1-2.5">Retrieve and decrypt RRBLOCK consisting of a single PKEY record containing zkey1.<a class="pilcrow" href="#appendix-B.1-2.5">¶</a>
</li>
          <li id="appendix-B.1-2.6">Calculate q1=SHA512(ZKDF(zkey1, "www")) and initiate GET(q1).<a class="pilcrow" href="#appendix-B.1-2.6">¶</a>
</li>
          <li id="appendix-B.1-2.7">Retrieve RRBLOCK consisting of a single AAAA record containing the IPv6 address 2001:db8::1.<a class="pilcrow" href="#appendix-B.1-2.7">¶</a>
</li>
          <li id="appendix-B.1-2.8">Return record set to application.<a class="pilcrow" href="#appendix-B.1-2.8">¶</a>
</li>
        </ol>
</section>
<section id="appendix-B.2">
        <h3 id="name-redirect-example-resolution">
<a class="section-number selfRef" href="#appendix-B.2">B.2. </a><a class="section-name selfRef" href="#name-redirect-example-resolution">REDIRECT Example Resolution</a>
        </h3>
<span id="name-example-resolution-of-an-ipv"></span><div id="figure_resolution_ex_redir">
<figure id="figure-25">
          <div class="alignLeft art-text artwork" id="appendix-B.2-1.1">
<pre>                           Local Host              |   Remote
                                                   |   Storage
                                                   |
                                                   |    +---------+
                                                   |   /         /|
                                                   |  +---------+ |
+-----------+ (1)      +----------+                |  |         | |
|           |          |          |      (4,6,8)   |  | Record  | |
|Application|----------| Resolver |----------------|-&gt;| Storage | |
|           |&lt;---------|          |&lt;---------------|--|         |/
+-----------+ (10)     +----------+      (5,7,9)   |  +---------+
                          A                        |
                          |                        |
                    (2,3) |                        |
                          |                        |
                          |                        |
                       +---------+                 |
                      /   v     /|                 |
                     +---------+ |                 |
                     |         | |                 |
                     |  Start  | |                 |
                     |  Zones  | |                 |
                     |         |/                  |
                     +---------+                   |
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-25">Figure 25</a>:
<a class="selfRef" href="#name-example-resolution-of-an-ipv">Example Resolution of an IPv6 Address with Redirect</a>
          </figcaption></figure>
</div>
<ol class="normal type-1" id="appendix-B.2-2" start="1" type="1">
           <li id="appendix-B.2-2.1">Look up AAAA record for name: "www.example.tld.gns.alt".<a class="pilcrow" href="#appendix-B.2-2.1">¶</a>
</li>
          <li id="appendix-B.2-2.2">Determine Start Zone for "www.example.tld.gns.alt".<a class="pilcrow" href="#appendix-B.2-2.2">¶</a>
</li>
          <li id="appendix-B.2-2.3">Start Zone: zkey0 - Remainder: "www.example".<a class="pilcrow" href="#appendix-B.2-2.3">¶</a>
</li>
          <li id="appendix-B.2-2.4">Calculate q0=SHA512(ZKDF(zkey0, "example")) and initiate GET(q0).<a class="pilcrow" href="#appendix-B.2-2.4">¶</a>
</li>
          <li id="appendix-B.2-2.5">Retrieve and decrypt RRBLOCK consisting of a single PKEY record containing zkey1.<a class="pilcrow" href="#appendix-B.2-2.5">¶</a>
</li>
          <li id="appendix-B.2-2.6">Calculate q1=SHA512(ZKDF(zkey1, "www")) and initiate GET(q1).<a class="pilcrow" href="#appendix-B.2-2.6">¶</a>
</li>
          <li id="appendix-B.2-2.7">Retrieve and decrypt RRBLOCK consisting of a single REDIRECT record containing "www2.+".<a class="pilcrow" href="#appendix-B.2-2.7">¶</a>
</li>
          <li id="appendix-B.2-2.8">Calculate q2=SHA512(ZKDF(zkey1, "www2")) and initiate GET(q2).<a class="pilcrow" href="#appendix-B.2-2.8">¶</a>
</li>
          <li id="appendix-B.2-2.9">Retrieve and decrypt RRBLOCK consisting of a single AAAA record containing the IPv6 address 2001:db8::1.<a class="pilcrow" href="#appendix-B.2-2.9">¶</a>
</li>
          <li id="appendix-B.2-2.10">Return record set to application.<a class="pilcrow" href="#appendix-B.2-2.10">¶</a>
</li>
        </ol>
</section>
<section id="appendix-B.3">
        <h3 id="name-gns2dns-example-resolution">
<a class="section-number selfRef" href="#appendix-B.3">B.3. </a><a class="section-name selfRef" href="#name-gns2dns-example-resolution">GNS2DNS Example Resolution</a>
        </h3>
<span id="name-example-resolution-of-an-ipv6"></span><div id="figure_resolution_ex_gnsdns">
<figure id="figure-26">
          <div class="alignLeft art-text artwork" id="appendix-B.3-1.1">
<pre>                           Local Host                |   Remote
                                                     |   Storage
                                                     |
                                                     |    +---------+
                                                     |   /         /|
                                                     |  +---------+ |
+-----------+ (1)      +----------+                  |  |         | |
|           |          |          |      (4)         |  | Record  | |
|Application|----------| Resolver |------------------|-&gt;| Storage | |
|           |&lt;---------|          |&lt;-----------------|--|         |/
+-----------+ (8)      +----------+      (5)         |  +---------+
                          A    A                     |
                          |    |    (6,7)            |
                    (2,3) |    +----------+          |
                          |               |          |
                          |               v          |
                       +---------+    +------------+ |
                      /   v     /|    | System DNS | |
                     +---------+ |    | Resolver   | |
                     |         | |    +------------+ |
                     |  Start  | |                   |
                     |  Zones  | |                   |
                     |         |/                    |
                     +---------+                     |
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-26">Figure 26</a>:
<a class="selfRef" href="#name-example-resolution-of-an-ipv6">Example Resolution of an IPv6 Address with DNS Handover</a>
          </figcaption></figure>
</div>
<ol class="normal type-1" id="appendix-B.3-2" start="1" type="1">
           <li id="appendix-B.3-2.1">Look up AAAA record for name: "www.example.gnu.gns.alt".<a class="pilcrow" href="#appendix-B.3-2.1">¶</a>
</li>
          <li id="appendix-B.3-2.2">Determine Start Zone for "www.example.gnu.gns.alt".<a class="pilcrow" href="#appendix-B.3-2.2">¶</a>
</li>
          <li id="appendix-B.3-2.3">Start Zone: zkey0 - Remainder: "www.example".<a class="pilcrow" href="#appendix-B.3-2.3">¶</a>
</li>
          <li id="appendix-B.3-2.4">Calculate q0=SHA512(ZKDF(zkey0, "example")) and initiate GET(q0).<a class="pilcrow" href="#appendix-B.3-2.4">¶</a>
</li>
          <li id="appendix-B.3-2.5">Retrieve and decrypt RRBLOCK consisting of a single GNS2DNS record containing the name "example.com" and the DNS server IPv4 address 192.0.2.1.<a class="pilcrow" href="#appendix-B.3-2.5">¶</a>
</li>
          <li id="appendix-B.3-2.6">Use system resolver to look up a AAAA record for the DNS name "www.example.com".<a class="pilcrow" href="#appendix-B.3-2.6">¶</a>
</li>
          <li id="appendix-B.3-2.7">Retrieve a DNS reply consisting of a single AAAA record containing the IPv6 address 2001:db8::1.<a class="pilcrow" href="#appendix-B.3-2.7">¶</a>
</li>
          <li id="appendix-B.3-2.8">Return record set to application.<a class="pilcrow" href="#appendix-B.3-2.8">¶</a>
</li>
        </ol>
</section>
</section>
<div id="app-c">
<section id="appendix-C">
      <h2 id="name-base32gns">
<a class="section-number selfRef" href="#appendix-C">Appendix C. </a><a class="section-name selfRef" href="#name-base32gns">Base32GNS</a>
      </h2>
<p id="appendix-C-1">
         Encoding converts a byte array into a string of symbols.
         Decoding converts a string of symbols into a byte array.
         Decoding fails if the input string has symbols outside the defined set.<a class="pilcrow" href="#appendix-C-1">¶</a></p>
<p id="appendix-C-2">
         <a class="auto internal xref" href="#CrockfordB32Encode">Table 4</a> defines the encoding and decoding symbols for a given
         symbol value.
         Each symbol value encodes 5 bits.
         It can be used to implement the encoding by reading it as follows:
         a symbol "A" or "a" is decoded to a 5-bit value 10 when decoding.
         A 5-bit block with a value of 18 is encoded to the character "J" when encoding.
         If the bit length of the byte string to encode is not a multiple of 5,
         it is padded to the next multiple with zeroes.
         In order to further increase tolerance for failures in character
         recognition, the letter "U" <span class="bcp14">MUST</span> be decoded to the same value as the
         letter "V" in Base32GNS.<a class="pilcrow" href="#appendix-C-2">¶</a></p>
<span id="name-the-base32gns-alphabet-incl"></span><div id="CrockfordB32Encode">
<table class="center" id="table-4">
        <caption>
<a class="selfRef" href="#table-4">Table 4</a>:
<a class="selfRef" href="#name-the-base32gns-alphabet-incl">The Base32GNS Alphabet, Including the Additional Encoding Symbol "U"</a>
        </caption>
<thead>
          <tr>
            <th class="text-left" colspan="1" rowspan="1">Symbol Value</th>
            <th class="text-left" colspan="1" rowspan="1">Decoding Symbol</th>
            <th class="text-left" colspan="1" rowspan="1">Encoding Symbol</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">0</td>
            <td class="text-left" colspan="1" rowspan="1">0 O o</td>
            <td class="text-left" colspan="1" rowspan="1">0</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">1</td>
            <td class="text-left" colspan="1" rowspan="1">1 I i L l</td>
            <td class="text-left" colspan="1" rowspan="1">1</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">2</td>
            <td class="text-left" colspan="1" rowspan="1">2</td>
            <td class="text-left" colspan="1" rowspan="1">2</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">3</td>
            <td class="text-left" colspan="1" rowspan="1">3</td>
            <td class="text-left" colspan="1" rowspan="1">3</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">4</td>
            <td class="text-left" colspan="1" rowspan="1">4</td>
            <td class="text-left" colspan="1" rowspan="1">4</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">5</td>
            <td class="text-left" colspan="1" rowspan="1">5</td>
            <td class="text-left" colspan="1" rowspan="1">5</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">6</td>
            <td class="text-left" colspan="1" rowspan="1">6</td>
            <td class="text-left" colspan="1" rowspan="1">6</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">7</td>
            <td class="text-left" colspan="1" rowspan="1">7</td>
            <td class="text-left" colspan="1" rowspan="1">7</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">8</td>
            <td class="text-left" colspan="1" rowspan="1">8</td>
            <td class="text-left" colspan="1" rowspan="1">8</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">9</td>
            <td class="text-left" colspan="1" rowspan="1">9</td>
            <td class="text-left" colspan="1" rowspan="1">9</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">10</td>
            <td class="text-left" colspan="1" rowspan="1">A a</td>
            <td class="text-left" colspan="1" rowspan="1">A</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">11</td>
            <td class="text-left" colspan="1" rowspan="1">B b</td>
            <td class="text-left" colspan="1" rowspan="1">B</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">12</td>
            <td class="text-left" colspan="1" rowspan="1">C c</td>
            <td class="text-left" colspan="1" rowspan="1">C</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">13</td>
            <td class="text-left" colspan="1" rowspan="1">D d</td>
            <td class="text-left" colspan="1" rowspan="1">D</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">14</td>
            <td class="text-left" colspan="1" rowspan="1">E e</td>
            <td class="text-left" colspan="1" rowspan="1">E</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">15</td>
            <td class="text-left" colspan="1" rowspan="1">F f</td>
            <td class="text-left" colspan="1" rowspan="1">F</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">16</td>
            <td class="text-left" colspan="1" rowspan="1">G g</td>
            <td class="text-left" colspan="1" rowspan="1">G</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">17</td>
            <td class="text-left" colspan="1" rowspan="1">H h</td>
            <td class="text-left" colspan="1" rowspan="1">H</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">18</td>
            <td class="text-left" colspan="1" rowspan="1">J j</td>
            <td class="text-left" colspan="1" rowspan="1">J</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">19</td>
            <td class="text-left" colspan="1" rowspan="1">K k</td>
            <td class="text-left" colspan="1" rowspan="1">K</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">20</td>
            <td class="text-left" colspan="1" rowspan="1">M m</td>
            <td class="text-left" colspan="1" rowspan="1">M</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">21</td>
            <td class="text-left" colspan="1" rowspan="1">N n</td>
            <td class="text-left" colspan="1" rowspan="1">N</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">22</td>
            <td class="text-left" colspan="1" rowspan="1">P p</td>
            <td class="text-left" colspan="1" rowspan="1">P</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">23</td>
            <td class="text-left" colspan="1" rowspan="1">Q q</td>
            <td class="text-left" colspan="1" rowspan="1">Q</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">24</td>
            <td class="text-left" colspan="1" rowspan="1">R r</td>
            <td class="text-left" colspan="1" rowspan="1">R</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">25</td>
            <td class="text-left" colspan="1" rowspan="1">S s</td>
            <td class="text-left" colspan="1" rowspan="1">S</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">26</td>
            <td class="text-left" colspan="1" rowspan="1">T t</td>
            <td class="text-left" colspan="1" rowspan="1">T</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">27</td>
            <td class="text-left" colspan="1" rowspan="1">V v U u</td>
            <td class="text-left" colspan="1" rowspan="1">V</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">28</td>
            <td class="text-left" colspan="1" rowspan="1">W w</td>
            <td class="text-left" colspan="1" rowspan="1">W</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">29</td>
            <td class="text-left" colspan="1" rowspan="1">X x</td>
            <td class="text-left" colspan="1" rowspan="1">X</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">30</td>
            <td class="text-left" colspan="1" rowspan="1">Y y</td>
            <td class="text-left" colspan="1" rowspan="1">Y</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">31</td>
            <td class="text-left" colspan="1" rowspan="1">Z z</td>
            <td class="text-left" colspan="1" rowspan="1">Z</td>
          </tr>
        </tbody>
      </table>
</div>
</section>
</div>
<section id="appendix-D">
      <h2 id="name-test-vectors">
<a class="section-number selfRef" href="#appendix-D">Appendix D. </a><a class="section-name selfRef" href="#name-test-vectors">Test Vectors</a>
      </h2>
<p id="appendix-D-1">
         The following test vectors can be used by implementations to test
         for conformance with this specification. Unless indicated otherwise,
         the test vectors are provided as hexadecimal byte arrays.<a class="pilcrow" href="#appendix-D-1">¶</a></p>
<section id="appendix-D.1">
        <h3 id="name-base32gns-encoding-decoding">
<a class="section-number selfRef" href="#appendix-D.1">D.1. </a><a class="section-name selfRef" href="#name-base32gns-encoding-decoding">Base32GNS Encoding/Decoding</a>
        </h3>
<p id="appendix-D.1-1">
           The following are test vectors for the Base32GNS encoding used for zTLDs. The input strings are encoded without the zero terminator.<a class="pilcrow" href="#appendix-D.1-1">¶</a></p>
<div class="lang-test-vectors sourcecode" id="appendix-D.1-2">
<pre>Base32GNS-Encode:
  Input string: "Hello World"
  Output string: "91JPRV3F41BPYWKCCG"

  Input bytes: 474e55204e616d652053797374656d
  Output string: "8X75A82EC5PPA82KF5SQ8SBD"

Base32GNS-Decode:
  Input string: "91JPRV3F41BPYWKCCG"
  Output string: "Hello World"

  Input string: "91JPRU3F41BPYWKCCG"
  Output string: "Hello World"
</pre><a class="pilcrow" href="#appendix-D.1-2">¶</a>
</div>
</section>
<section id="appendix-D.2">
        <h3 id="name-record-sets">
<a class="section-number selfRef" href="#appendix-D.2">D.2. </a><a class="section-name selfRef" href="#name-record-sets">Record Sets</a>
        </h3>
<p id="appendix-D.2-1">
           The test vectors include record sets with a variety
           of record types and flags for both PKEY and EDKEY zones.
           This includes labels with UTF-8 characters to demonstrate
           internationalized labels.<a class="pilcrow" href="#appendix-D.2-1">¶</a></p>
<p id="appendix-D.2-2"><strong>(1) PKEY zone with ASCII label and one delegation record</strong><a class="pilcrow" href="#appendix-D.2-2">¶</a></p>
<div class="breakable lang-test-vectors sourcecode" id="appendix-D.2-3">
<pre>Zone private key (d, big-endian):
  50 d7 b6 52 a4 ef ea df
  f3 73 96 90 97 85 e5 95
  21 71 a0 21 78 c8 e7 d4
  50 fa 90 79 25 fa fd 98

Zone identifier (ztype|zkey):
  00 01 00 00 67 7c 47 7d
  2d 93 09 7c 85 b1 95 c6
  f9 6d 84 ff 61 f5 98 2c
  2c 4f e0 2d 5a 11 fe df
  b0 c2 90 1f

zTLD:
000G0037FH3QTBCK15Y8BCCNRVWPV17ZC7TSGB1C9ZG2TPGHZVFV1GMG3W

Label:
  74 65 73 74 64 65 6c 65
  67 61 74 69 6f 6e

Number of records (integer): 1

Record #0 := (
  EXPIRATION: 8143584694000000 us
  00 1c ee 8c 10 e2 59 80

  DATA_SIZE:
  00 20

  TYPE:
  00 01 00 00

  FLAGS:   00 01

  DATA:
  21 e3 b3 0f f9 3b c6 d3
  5a c8 c6 e0 e1 3a fd ff
  79 4c b7 b4 4b bb c7 48
  d2 59 d0 a0 28 4d be 84

)

RDATA:
  00 1c ee 8c 10 e2 59 80
  00 20 00 01 00 01 00 00
  21 e3 b3 0f f9 3b c6 d3
  5a c8 c6 e0 e1 3a fd ff
  79 4c b7 b4 4b bb c7 48
  d2 59 d0 a0 28 4d be 84

Encryption NONCE|EXPIRATION|BLOCK COUNTER:
  e9 0a 00 61 00 1c ee 8c
  10 e2 59 80 00 00 00 01

Encryption key (K):
  86 4e 71 38 ea e7 fd 91
  a3 01 36 89 9c 13 2b 23
  ac eb db 2c ef 43 cb 19
  f6 bf 55 b6 7d b9 b3 b3

Storage key (q):
  4a dc 67 c5 ec ee 9f 76
  98 6a bd 71 c2 22 4a 3d
  ce 2e 91 70 26 c9 a0 9d
  fd 44 ce f3 d2 0f 55 a2
  73 32 72 5a 6c 8a fb bb
  b0 f7 ec 9a f1 cc 42 64
  12 99 40 6b 04 fd 9b 5b
  57 91 f8 6c 4b 08 d5 f4

ZKDF(zkey, label):
  18 2b b6 36 ed a7 9f 79
  57 11 bc 27 08 ad bb 24
  2a 60 44 6a d3 c3 08 03
  12 1d 03 d3 48 b7 ce b6

Derived private key (d', big-endian):
  0a 4c 5e 0f 00 63 df ce
  db c8 c7 f2 b2 2c 03 0c
  86 28 b2 c2 cb ac 9f a7
  29 aa e6 1f 89 db 3e 9c

BDATA:
  0c 1e da 5c c0 94 a1 c7
  a8 88 64 9d 25 fa ee bd
  60 da e6 07 3d 57 d8 ae
  8d 45 5f 4f 13 92 c0 74
  e2 6a c6 69 bd ee c2 34
  62 b9 62 95 2c c6 e9 eb

RRBLOCK:
  00 00 00 a0 00 01 00 00
  18 2b b6 36 ed a7 9f 79
  57 11 bc 27 08 ad bb 24
  2a 60 44 6a d3 c3 08 03
  12 1d 03 d3 48 b7 ce b6
  0a d1 0b c1 3b 40 3b 5b
  25 61 26 b2 14 5a 6f 60
  c5 14 f9 51 ff a7 66 f7
  a3 fd 4b ac 4a 4e 19 90
  05 5c b8 7e 8d 1b fd 19
  aa 09 a4 29 f7 29 e9 f5
  c6 ee c2 47 0a ce e2 22
  07 59 e9 e3 6c 88 6f 35
  00 1c ee 8c 10 e2 59 80
  0c 1e da 5c c0 94 a1 c7
  a8 88 64 9d 25 fa ee bd
  60 da e6 07 3d 57 d8 ae
  8d 45 5f 4f 13 92 c0 74
  e2 6a c6 69 bd ee c2 34
  62 b9 62 95 2c c6 e9 eb
</pre><a class="pilcrow" href="#appendix-D.2-3">¶</a>
</div>
<p id="appendix-D.2-4"><strong>(2) PKEY zone with UTF-8 label and three records</strong><a class="pilcrow" href="#appendix-D.2-4">¶</a></p>
<div class="breakable lang-test-vectors sourcecode" id="appendix-D.2-5">
<pre>Zone private key (d, big-endian):
  50 d7 b6 52 a4 ef ea df
  f3 73 96 90 97 85 e5 95
  21 71 a0 21 78 c8 e7 d4
  50 fa 90 79 25 fa fd 98

Zone identifier (ztype|zkey):
  00 01 00 00 67 7c 47 7d
  2d 93 09 7c 85 b1 95 c6
  f9 6d 84 ff 61 f5 98 2c
  2c 4f e0 2d 5a 11 fe df
  b0 c2 90 1f

zTLD:
000G0037FH3QTBCK15Y8BCCNRVWPV17ZC7TSGB1C9ZG2TPGHZVFV1GMG3W

Label:
  e5 a4 a9 e4 b8 8b e7 84
  a1 e6 95 b5

Number of records (integer): 3

Record #0 := (
  EXPIRATION: 8143584694000000 us
  00 1c ee 8c 10 e2 59 80

  DATA_SIZE:
  00 10

  TYPE:
  00 00 00 1c

  FLAGS:   00 00

  DATA:
  00 00 00 00 00 00 00 00
  00 00 00 00 de ad be ef

)

Record #1 := (
  EXPIRATION: 17999736901000000 us
  00 3f f2 aa 54 08 db 40

  DATA_SIZE:
  00 06

  TYPE:
  00 01 00 01

  FLAGS:   00 00

  DATA:
  e6 84 9b e7 a7 b0

)

Record #2 := (
  EXPIRATION: 11464693629000000 us
  00 28 bb 13 ff 37 19 40

  DATA_SIZE:
  00 0b

  TYPE:
  00 00 00 10

  FLAGS:   00 04

  DATA:
  48 65 6c 6c 6f 20 57 6f
  72 6c 64

)

RDATA:
  00 1c ee 8c 10 e2 59 80
  00 10 00 00 00 00 00 1c
  00 00 00 00 00 00 00 00
  00 00 00 00 de ad be ef
  00 3f f2 aa 54 08 db 40
  00 06 00 00 00 01 00 01
  e6 84 9b e7 a7 b0 00 28
  bb 13 ff 37 19 40 00 0b
  00 04 00 00 00 10 48 65
  6c 6c 6f 20 57 6f 72 6c
  64 00 00 00 00 00 00 00
  00 00 00 00 00 00 00 00
  00 00 00 00 00 00 00 00
  00 00 00 00 00 00 00 00
  00 00 00 00 00 00 00 00
  00 00 00 00 00 00 00 00

Encryption NONCE|EXPIRATION|BLOCK COUNTER:
  ee 96 33 c1 00 1c ee 8c
  10 e2 59 80 00 00 00 01

Encryption key (K):
  fb 3a b5 de 23 bd da e1
  99 7a af 7b 92 c2 d2 71
  51 40 8b 77 af 7a 41 ac
  79 05 7c 4d f5 38 3d 01

Storage key (q):
  af f0 ad 6a 44 09 73 68
  42 9a c4 76 df a1 f3 4b
  ee 4c 36 e7 47 6d 07 aa
  64 63 ff 20 91 5b 10 05
  c0 99 1d ef 91 fc 3e 10
  90 9f 87 02 c0 be 40 43
  67 78 c7 11 f2 ca 47 d5
  5c f0 b5 4d 23 5d a9 77

ZKDF(zkey, label):
  a5 12 96 df 75 7e e2 75
  ca 11 8d 4f 07 fa 7a ae
  55 08 bc f5 12 aa 41 12
  14 29 d4 a0 de 9d 05 7e

Derived private key (d', big-endian):
  0a be 56 d6 80 68 ab 40
  e1 44 79 0c de 9a cf 4d
  78 7f 2d 3c 63 b8 53 05
  74 6e 68 03 32 15 f2 ab

BDATA:
  d8 c2 8d 2f d6 96 7d 1a
  b7 22 53 f2 10 98 b8 14
  a4 10 be 1f 59 98 de 03
  f5 8f 7e 7c db 7f 08 a6
  16 51 be 4d 0b 6f 8a 61
  df 15 30 44 0b d7 47 dc
  f0 d7 10 4f 6b 8d 24 c2
  ac 9b c1 3d 9c 6f e8 29
  05 25 d2 a6 d0 f8 84 42
  67 a1 57 0e 8e 29 4d c9
  3a 31 9f cf c0 3e a2 70
  17 d6 fd a3 47 b4 a7 94
  97 d7 f6 b1 42 2d 4e dd
  82 1c 19 93 4e 96 c1 aa
  87 76 57 25 d4 94 c7 64
  b1 55 dc 6d 13 26 91 74

RRBLOCK:
  00 00 00 f0 00 01 00 00
  a5 12 96 df 75 7e e2 75
  ca 11 8d 4f 07 fa 7a ae
  55 08 bc f5 12 aa 41 12
  14 29 d4 a0 de 9d 05 7e
  08 5b d6 5f d4 85 10 51
  ba ce 2a 45 2a fc 8a 7e
  4f 6b 2c 1f 74 f0 20 35
  d9 64 1a cd ba a4 66 e0
  00 ce d6 f2 d2 3b 63 1c
  8e 8a 0b 38 e2 ba e7 9a
  22 ca d8 1d 4c 50 d2 25
  35 8e bc 17 ac 0f 89 9e
  00 1c ee 8c 10 e2 59 80
  d8 c2 8d 2f d6 96 7d 1a
  b7 22 53 f2 10 98 b8 14
  a4 10 be 1f 59 98 de 03
  f5 8f 7e 7c db 7f 08 a6
  16 51 be 4d 0b 6f 8a 61
  df 15 30 44 0b d7 47 dc
  f0 d7 10 4f 6b 8d 24 c2
  ac 9b c1 3d 9c 6f e8 29
  05 25 d2 a6 d0 f8 84 42
  67 a1 57 0e 8e 29 4d c9
  3a 31 9f cf c0 3e a2 70
  17 d6 fd a3 47 b4 a7 94
  97 d7 f6 b1 42 2d 4e dd
  82 1c 19 93 4e 96 c1 aa
  87 76 57 25 d4 94 c7 64
  b1 55 dc 6d 13 26 91 74
</pre><a class="pilcrow" href="#appendix-D.2-5">¶</a>
</div>
<p id="appendix-D.2-6"><strong>(3) EDKEY zone with ASCII label and one delegation record</strong><a class="pilcrow" href="#appendix-D.2-6">¶</a></p>
<div class="breakable lang-test-vectors sourcecode" id="appendix-D.2-7">
<pre>Zone private key (d):
  5a f7 02 0e e1 91 60 32
  88 32 35 2b bc 6a 68 a8
  d7 1a 7c be 1b 92 99 69
  a7 c6 6d 41 5a 0d 8f 65

Zone identifier (ztype|zkey):
  00 01 00 14 3c f4 b9 24
  03 20 22 f0 dc 50 58 14
  53 b8 5d 93 b0 47 b6 3d
  44 6c 58 45 cb 48 44 5d
  db 96 68 8f

zTLD:
000G051WYJWJ80S04BRDRM2R2H9VGQCKP13VCFA4DHC4BJT88HEXQ5K8HW

Label:
  74 65 73 74 64 65 6c 65
  67 61 74 69 6f 6e

Number of records (integer): 1

Record #0 := (
  EXPIRATION: 8143584694000000 us
  00 1c ee 8c 10 e2 59 80

  DATA_SIZE:
  00 20

  TYPE:
  00 01 00 00

  FLAGS:   00 01

  DATA:
  21 e3 b3 0f f9 3b c6 d3
  5a c8 c6 e0 e1 3a fd ff
  79 4c b7 b4 4b bb c7 48
  d2 59 d0 a0 28 4d be 84

)

RDATA:
  00 1c ee 8c 10 e2 59 80
  00 20 00 01 00 01 00 00
  21 e3 b3 0f f9 3b c6 d3
  5a c8 c6 e0 e1 3a fd ff
  79 4c b7 b4 4b bb c7 48
  d2 59 d0 a0 28 4d be 84

Encryption NONCE|EXPIRATION:
  98 13 2e a8 68 59 d3 5c
  88 bf d3 17 fa 99 1b cb
  00 1c ee 8c 10 e2 59 80

Encryption key (K):
  85 c4 29 a9 56 7a a6 33
  41 1a 96 91 e9 09 4c 45
  28 16 72 be 58 60 34 aa
  e4 a2 a2 cc 71 61 59 e2

Storage key (q):
  ab aa ba c0 e1 24 94 59
  75 98 83 95 aa c0 24 1e
  55 59 c4 1c 40 74 e2 55
  7b 9f e6 d1 54 b6 14 fb
  cd d4 7f c7 f5 1d 78 6d
  c2 e0 b1 ec e7 60 37 c0
  a1 57 8c 38 4e c6 1d 44
  56 36 a9 4e 88 03 29 e9

ZKDF(zkey, label):
  9b f2 33 19 8c 6d 53 bb
  db ac 49 5c ab d9 10 49
  a6 84 af 3f 40 51 ba ca
  b0 dc f2 1c 8c f2 7a 1a

nonce := SHA-256(dh[32..63] || h):
  14 f2 c0 6b ed c3 aa 2d
  f0 71 13 9c 50 39 34 f3
  4b fa 63 11 a8 52 f2 11
  f7 3a df 2e 07 61 ec 35

Derived private key (d', big-endian):
  3b 1b 29 d4 23 0b 10 a8
  ec 4d a3 c8 6e db 88 ea
  cd 54 08 5c 1d db 63 f7
  a9 d7 3f 7c cb 2f c3 98

BDATA:
  57 7c c6 c9 5a 14 e7 04
  09 f2 0b 01 67 e6 36 d0
  10 80 7c 4f 00 37 2d 69
  8c 82 6b d9 2b c2 2b d6
  bb 45 e5 27 7c 01 88 1d
  6a 43 60 68 e4 dd f1 c6
  b7 d1 41 6f af a6 69 7c
  25 ed d9 ea e9 91 67 c3

RRBLOCK:
  00 00 00 b0 00 01 00 14
  9b f2 33 19 8c 6d 53 bb
  db ac 49 5c ab d9 10 49
  a6 84 af 3f 40 51 ba ca
  b0 dc f2 1c 8c f2 7a 1a
  9f 56 a8 86 ea 73 9d 59
  17 50 8f 9b 75 56 39 f3
  a9 ac fa ed ed ca 7f bf
  a7 94 b1 92 e0 8b f9 ed
  4c 7e c8 59 4c 9f 7b 4e
  19 77 4f f8 38 ec 38 7a
  8f 34 23 da ac 44 9f 59
  db 4e 83 94 3f 90 72 00
  00 1c ee 8c 10 e2 59 80
  57 7c c6 c9 5a 14 e7 04
  09 f2 0b 01 67 e6 36 d0
  10 80 7c 4f 00 37 2d 69
  8c 82 6b d9 2b c2 2b d6
  bb 45 e5 27 7c 01 88 1d
  6a 43 60 68 e4 dd f1 c6
  b7 d1 41 6f af a6 69 7c
  25 ed d9 ea e9 91 67 c3
</pre><a class="pilcrow" href="#appendix-D.2-7">¶</a>
</div>
<p id="appendix-D.2-8"><strong>(4) EDKEY zone with UTF-8 label and three records</strong><a class="pilcrow" href="#appendix-D.2-8">¶</a></p>
<div class="breakable lang-test-vectors sourcecode" id="appendix-D.2-9">
<pre>Zone private key (d):
  5a f7 02 0e e1 91 60 32
  88 32 35 2b bc 6a 68 a8
  d7 1a 7c be 1b 92 99 69
  a7 c6 6d 41 5a 0d 8f 65

Zone identifier (ztype|zkey):
  00 01 00 14 3c f4 b9 24
  03 20 22 f0 dc 50 58 14
  53 b8 5d 93 b0 47 b6 3d
  44 6c 58 45 cb 48 44 5d
  db 96 68 8f

zTLD:
000G051WYJWJ80S04BRDRM2R2H9VGQCKP13VCFA4DHC4BJT88HEXQ5K8HW

Label:
  e5 a4 a9 e4 b8 8b e7 84
  a1 e6 95 b5

Number of records (integer): 3

Record #0 := (
  EXPIRATION: 8143584694000000 us
  00 1c ee 8c 10 e2 59 80

  DATA_SIZE:
  00 10

  TYPE:
  00 00 00 1c

  FLAGS:   00 00

  DATA:
  00 00 00 00 00 00 00 00
  00 00 00 00 de ad be ef

)

Record #1 := (
  EXPIRATION: 17999736901000000 us
  00 3f f2 aa 54 08 db 40

  DATA_SIZE:
  00 06

  TYPE:
  00 01 00 01

  FLAGS:   00 00

  DATA:
  e6 84 9b e7 a7 b0

)

Record #2 := (
  EXPIRATION: 11464693629000000 us
  00 28 bb 13 ff 37 19 40

  DATA_SIZE:
  00 0b

  TYPE:
  00 00 00 10

  FLAGS:   00 04

  DATA:
  48 65 6c 6c 6f 20 57 6f
  72 6c 64

)

RDATA:
  00 1c ee 8c 10 e2 59 80
  00 10 00 00 00 00 00 1c
  00 00 00 00 00 00 00 00
  00 00 00 00 de ad be ef
  00 3f f2 aa 54 08 db 40
  00 06 00 00 00 01 00 01
  e6 84 9b e7 a7 b0 00 28
  bb 13 ff 37 19 40 00 0b
  00 04 00 00 00 10 48 65
  6c 6c 6f 20 57 6f 72 6c
  64 00 00 00 00 00 00 00
  00 00 00 00 00 00 00 00
  00 00 00 00 00 00 00 00
  00 00 00 00 00 00 00 00
  00 00 00 00 00 00 00 00
  00 00 00 00 00 00 00 00

Encryption NONCE|EXPIRATION:
  bb 0d 3f 0f bd 22 42 77
  50 da 5d 69 12 16 e6 c9
  00 1c ee 8c 10 e2 59 80

Encryption key (K):
  3d f8 05 bd 66 87 aa 14
  20 96 28 c2 44 b1 11 91
  88 c3 92 56 37 a4 1e 5d
  76 49 6c 29 45 dc 37 7b

Storage key (q):
  ba f8 21 77 ee c0 81 e0
  74 a7 da 47 ff c6 48 77
  58 fb 0d f0 1a 6c 7f bb
  52 fc 8a 31 be f0 29 af
  74 aa 0d c1 5a b8 e2 fa
  7a 54 b4 f5 f6 37 f6 15
  8f a7 f0 3c 3f ce be 78
  d3 f9 d6 40 aa c0 d1 ed

ZKDF(zkey, label):
  74 f9 00 68 f1 67 69 53
  52 a8 a6 c2 eb 98 48 98
  c5 3a cc a0 98 04 70 c6
  c8 12 64 cb dd 78 ad 11

nonce := SHA-256(dh[32..63] || h):
  f8 6a b5 33 8a 74 d7 a1
  d2 77 ea 11 ff 95 cb e8
  3a cf d3 97 3b b4 ab ca
  0a 1b 60 62 c3 7a b3 9c

Derived private key (d', big-endian):
  17 c0 68 a6 c3 f7 20 de
  0e 1b 69 ff 3f 53 e0 5d
  3f e5 c5 b0 51 25 7a 89
  a6 3c 1a d3 5a c4 35 58

BDATA:
  4e b3 5a 50 d4 0f e1 a4
  29 c7 f4 b2 67 a0 59 de
  4e 2c 8a 89 a5 ed 53 d3
  d4 92 58 59 d2 94 9f 7f
  30 d8 a2 0c aa 96 f8 81
  45 05 2d 1c da 04 12 49
  8f f2 5f f2 81 6e f0 ce
  61 fe 69 9b fa c7 2c 15
  dc 83 0e a9 b0 36 17 1c
  cf ca bb dd a8 de 3c 86
  ed e2 95 70 d0 17 4b 82
  82 09 48 a9 28 b7 f0 0e
  fb 40 1c 10 fe 80 bb bb
  02 76 33 1b f7 f5 1b 8d
  74 57 9c 14 14 f2 2d 50
  1a d2 5a e2 49 f5 bb f2
  a6 c3 72 59 d1 75 e4 40
  b2 94 39 c6 05 19 cb b1

RRBLOCK:
  00 00 01 00 00 01 00 14
  74 f9 00 68 f1 67 69 53
  52 a8 a6 c2 eb 98 48 98
  c5 3a cc a0 98 04 70 c6
  c8 12 64 cb dd 78 ad 11
  75 6d 2c 15 7a d2 ea 4f
  c0 b1 b9 1c 08 03 79 44
  61 d3 de f2 0d d1 63 6c
  fe dc 03 89 c5 49 d1 43
  6c c3 5b 4e 1b f8 89 5a
  64 6b d9 a6 f4 6b 83 48
  1d 9c 0e 91 d4 e1 be bb
  6a 83 52 6f b7 25 2a 06
  00 1c ee 8c 10 e2 59 80
  4e b3 5a 50 d4 0f e1 a4
  29 c7 f4 b2 67 a0 59 de
  4e 2c 8a 89 a5 ed 53 d3
  d4 92 58 59 d2 94 9f 7f
  30 d8 a2 0c aa 96 f8 81
  45 05 2d 1c da 04 12 49
  8f f2 5f f2 81 6e f0 ce
  61 fe 69 9b fa c7 2c 15
  dc 83 0e a9 b0 36 17 1c
  cf ca bb dd a8 de 3c 86
  ed e2 95 70 d0 17 4b 82
  82 09 48 a9 28 b7 f0 0e
  fb 40 1c 10 fe 80 bb bb
  02 76 33 1b f7 f5 1b 8d
  74 57 9c 14 14 f2 2d 50
  1a d2 5a e2 49 f5 bb f2
  a6 c3 72 59 d1 75 e4 40
  b2 94 39 c6 05 19 cb b1
</pre><a class="pilcrow" href="#appendix-D.2-9">¶</a>
</div>
</section>
<section id="appendix-D.3">
        <h3 id="name-zone-revocation-2">
<a class="section-number selfRef" href="#appendix-D.3">D.3. </a><a class="section-name selfRef" href="#name-zone-revocation-2">Zone Revocation</a>
        </h3>
<p id="appendix-D.3-1">
         The following is an example revocation for a PKEY zone:<a class="pilcrow" href="#appendix-D.3-1">¶</a></p>
<div class="breakable lang-test-vectors sourcecode" id="appendix-D.3-2">
<pre>Zone private key (d, big-endian):
  6f ea 32 c0 5a f5 8b fa
  97 95 53 d1 88 60 5f d5
  7d 8b f9 cc 26 3b 78 d5
  f7 47 8c 07 b9 98 ed 70

Zone identifier (ztype|zkey):
  00 01 00 00 2c a2 23 e8
  79 ec c4 bb de b5 da 17
  31 92 81 d6 3b 2e 3b 69
  55 f1 c3 77 5c 80 4a 98
  d5 f8 dd aa

zTLD:
000G001CM8HYGYFCRJXXXDET2WRS50EP7CQ3PTANY71QEQ409ACDBY6XN8

Difficulty (5 base difficulty + 2 epochs): 7

Signed message:
  00 00 00 34 00 00 00 03
  00 05 ff 1c 56 e4 b2 68
  00 01 00 00 2c a2 23 e8
  79 ec c4 bb de b5 da 17
  31 92 81 d6 3b 2e 3b 69
  55 f1 c3 77 5c 80 4a 98
  d5 f8 dd aa

Proof:
  00 05 ff 1c 56 e4 b2 68
  00 00 39 5d 18 27 c0 00
  38 0b 54 aa 70 16 ac a2
  38 0b 54 aa 70 16 ad 62
  38 0b 54 aa 70 16 af 3e
  38 0b 54 aa 70 16 af 93
  38 0b 54 aa 70 16 b0 bf
  38 0b 54 aa 70 16 b0 ee
  38 0b 54 aa 70 16 b1 c9
  38 0b 54 aa 70 16 b1 e5
  38 0b 54 aa 70 16 b2 78
  38 0b 54 aa 70 16 b2 b2
  38 0b 54 aa 70 16 b2 d6
  38 0b 54 aa 70 16 b2 e4
  38 0b 54 aa 70 16 b3 2c
  38 0b 54 aa 70 16 b3 5a
  38 0b 54 aa 70 16 b3 9d
  38 0b 54 aa 70 16 b3 c0
  38 0b 54 aa 70 16 b3 dd
  38 0b 54 aa 70 16 b3 f4
  38 0b 54 aa 70 16 b4 42
  38 0b 54 aa 70 16 b4 76
  38 0b 54 aa 70 16 b4 8c
  38 0b 54 aa 70 16 b4 a4
  38 0b 54 aa 70 16 b4 c9
  38 0b 54 aa 70 16 b4 f0
  38 0b 54 aa 70 16 b4 f7
  38 0b 54 aa 70 16 b5 79
  38 0b 54 aa 70 16 b6 34
  38 0b 54 aa 70 16 b6 8e
  38 0b 54 aa 70 16 b7 b4
  38 0b 54 aa 70 16 b8 7e
  38 0b 54 aa 70 16 b8 f8
  38 0b 54 aa 70 16 b9 2a
  00 01 00 00 2c a2 23 e8
  79 ec c4 bb de b5 da 17
  31 92 81 d6 3b 2e 3b 69
  55 f1 c3 77 5c 80 4a 98
  d5 f8 dd aa 08 ca ff de
  3c 6d f1 45 f7 e0 79 81
  15 37 b2 b0 42 2d 5e 1f
  b2 01 97 81 ec a2 61 d1
  f9 d8 ea 81 0a bc 2f 33
  47 7f 04 e3 64 81 11 be
  71 c2 48 82 1a d6 04 f4
  94 e7 4d 0b f5 11 d2 c1
  62 77 2e 81
</pre><a class="pilcrow" href="#appendix-D.3-2">¶</a>
</div>
<p id="appendix-D.3-3">
         The following is an example revocation for an EDKEY zone:<a class="pilcrow" href="#appendix-D.3-3">¶</a></p>
<div class="breakable lang-test-vectors sourcecode" id="appendix-D.3-4">
<pre>Zone private key (d):
  5a f7 02 0e e1 91 60 32
  88 32 35 2b bc 6a 68 a8
  d7 1a 7c be 1b 92 99 69
  a7 c6 6d 41 5a 0d 8f 65

Zone identifier (ztype|zkey):
  00 01 00 14 3c f4 b9 24
  03 20 22 f0 dc 50 58 14
  53 b8 5d 93 b0 47 b6 3d
  44 6c 58 45 cb 48 44 5d
  db 96 68 8f

zTLD:
000G051WYJWJ80S04BRDRM2R2H9VGQCKP13VCFA4DHC4BJT88HEXQ5K8HW

Difficulty (5 base difficulty + 2 epochs): 7

Signed message:
  00 00 00 34 00 00 00 03
  00 05 ff 1c 57 35 42 bd
  00 01 00 14 3c f4 b9 24
  03 20 22 f0 dc 50 58 14
  53 b8 5d 93 b0 47 b6 3d
  44 6c 58 45 cb 48 44 5d
  db 96 68 8f

Proof:
  00 05 ff 1c 57 35 42 bd
  00 00 39 5d 18 27 c0 00
  58 4c 93 3c b0 99 2a 08
  58 4c 93 3c b0 99 2d f7
  58 4c 93 3c b0 99 2e 21
  58 4c 93 3c b0 99 2e 2a
  58 4c 93 3c b0 99 2e 53
  58 4c 93 3c b0 99 2e 8e
  58 4c 93 3c b0 99 2f 13
  58 4c 93 3c b0 99 2f 2d
  58 4c 93 3c b0 99 2f 3c
  58 4c 93 3c b0 99 2f 41
  58 4c 93 3c b0 99 2f fd
  58 4c 93 3c b0 99 30 33
  58 4c 93 3c b0 99 30 82
  58 4c 93 3c b0 99 30 a2
  58 4c 93 3c b0 99 30 e1
  58 4c 93 3c b0 99 31 ce
  58 4c 93 3c b0 99 31 de
  58 4c 93 3c b0 99 32 12
  58 4c 93 3c b0 99 32 4e
  58 4c 93 3c b0 99 32 9f
  58 4c 93 3c b0 99 33 31
  58 4c 93 3c b0 99 33 87
  58 4c 93 3c b0 99 33 8c
  58 4c 93 3c b0 99 33 e5
  58 4c 93 3c b0 99 33 f3
  58 4c 93 3c b0 99 34 26
  58 4c 93 3c b0 99 34 30
  58 4c 93 3c b0 99 34 68
  58 4c 93 3c b0 99 34 88
  58 4c 93 3c b0 99 34 8a
  58 4c 93 3c b0 99 35 4c
  58 4c 93 3c b0 99 35 bd
  00 01 00 14 3c f4 b9 24
  03 20 22 f0 dc 50 58 14
  53 b8 5d 93 b0 47 b6 3d
  44 6c 58 45 cb 48 44 5d
  db 96 68 8f 04 ae 26 f7
  63 56 5a b7 aa ab 01 71
  72 4f 3c a8 bc c5 1a 98
  b7 d4 c9 2e a3 3c d9 34
  4c a8 b6 3e 04 53 3a bf
  1a 3c 05 49 16 b3 68 2c
  5c a8 cb 4d d0 f8 4c 3b
  77 48 7a ac 6e ce 38 48
  0b a9 d5 00
</pre><a class="pilcrow" href="#appendix-D.3-4">¶</a>
</div>
</section>
</section>
<section id="appendix-E">
      <h2 id="name-acknowledgements">
<a class="section-name selfRef" href="#name-acknowledgements">Acknowledgements</a>
      </h2>
<p id="appendix-E-1">
          The authors thank all reviewers for their comments. In particular,
          we thank <span class="contact-name">D. J. Bernstein</span>, <span class="contact-name">S. Bortzmeyer</span>, <span class="contact-name">A. Farrel</span>, <span class="contact-name">E. Lear</span>, and <span class="contact-name">R. Salz</span> for their
          insightful and detailed technical reviews. We thank <span class="contact-name">J. Yao</span> and <span class="contact-name">J. Klensin</span> for the
          internationalization reviews. We thank <span class="contact-name">Dr. J. Appelbaum</span> for suggesting the name "GNU Name System" and <span class="contact-name">Dr. Richard Stallman</span> for approving its use.  We thank <span class="contact-name">T. Lange</span> and <span class="contact-name">M. Wachs</span> for their earlier contributions to the design and implementation of GNS. We thank NLnet and NGI DISCOVERY for funding
          work on the GNU Name System.<a class="pilcrow" href="#appendix-E-1">¶</a></p>
</section>
<div id="authors-addresses">
<section id="appendix-F">
      <h2 id="name-authors-addresses">
<a class="section-name selfRef" href="#name-authors-addresses">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Martin Schanzenbach</span></div>
<div class="left" dir="auto"><span class="org">Fraunhofer AISEC</span></div>
<div class="left" dir="auto"><span class="street-address">Lichtenbergstrasse 11</span></div>
<div class="left" dir="auto">
<span class="postal-code">85748</span> <span class="locality">Garching</span>
</div>
<div class="left" dir="auto"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:martin.schanzenbach@aisec.fraunhofer.de">martin.schanzenbach@aisec.fraunhofer.de</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Christian Grothoff</span></div>
<div class="left" dir="auto"><span class="org">Berner Fachhochschule</span></div>
<div class="left" dir="auto"><span class="street-address">Hoeheweg 80</span></div>
<div class="left" dir="auto">CH-<span class="postal-code">2501</span> <span class="locality">Biel/Bienne</span>
</div>
<div class="left" dir="auto"><span class="country-name">Switzerland</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:christian.grothoff@bfh.ch">christian.grothoff@bfh.ch</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Bernd Fix</span></div>
<div class="left" dir="auto"><span class="org">GNUnet e.V.</span></div>
<div class="left" dir="auto"><span class="street-address">Boltzmannstrasse 3</span></div>
<div class="left" dir="auto">
<span class="postal-code">85748</span> <span class="locality">Garching</span>
</div>
<div class="left" dir="auto"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:fix@gnunet.org">fix@gnunet.org</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>