<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 8765: DNS Push Notifications</title>
<meta content="Tom Pusateri" name="author"/>
<meta content="Stuart Cheshire" name="author"/>
<meta content="
       The Domain Name System (DNS) was designed to return matching records
      efficiently for queries for data that are relatively static.  When those
      records change frequently, DNS is still efficient at returning the
      updated results when polled, as long as the polling rate is not too
      high.
      But, there exists no mechanism for a client to be asynchronously
      notified
      when these changes occur.  This document defines a mechanism for a
      client to be notified of such changes to DNS records, called DNS Push
      Notifications. 
    " name="description"/>
<meta content="xml2rfc 2.45.3" name="generator"/>
<meta content="Push notification" name="keyword"/>
<meta content="Asynchronous notification" name="keyword"/>
<meta content="8765" name="rfc.number"/>
<link href="rfc8765.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Avoid wrapping of URLs in references */
@media screen {
  .references a {
    white-space: nowrap;
  }
}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://dx.doi.org/10.17487/rfc8765" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <link href="https://datatracker.ietf.org/doc/draft-ietf-dnssd-push-25" rel="prev"/>
  </head>
<body>
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 8765</td>
<td class="center">DNS Push Notifications</td>
<td class="right">June 2020</td>
</tr></thead>
<tfoot><tr>
<td class="left">Pusateri &amp; Cheshire</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc8765">8765</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2020-06">June 2020</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">T. Pusateri</div>
<div class="org">Unaffiliated</div>
</div>
<div class="author">
      <div class="author-name">S. Cheshire</div>
<div class="org">Apple Inc.</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 8765</h1>
<h1 id="title">DNS Push Notifications</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">The Domain Name System (DNS) was designed to return matching records
      efficiently for queries for data that are relatively static.  When those
      records change frequently, DNS is still efficient at returning the
      updated results when polled, as long as the polling rate is not too
      high.
      But, there exists no mechanism for a client to be asynchronously
      notified
      when these changes occur.  This document defines a mechanism for a
      client to be notified of such changes to DNS records, called DNS Push
      Notifications.<a class="pilcrow" href="#section-abstract-1">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a class="pilcrow" href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc8765">https://www.rfc-editor.org/info/rfc8765</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2020 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">▲</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.1">
            <p class="keepWithNext" id="section-toc.1-1.1.1"><a class="xref" href="#section-1">1</a>.  <a class="xref" href="#name-introduction">Introduction</a><a class="pilcrow" href="#section-toc.1-1.1.1">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.1.2.1">
                <p class="keepWithNext" id="section-toc.1-1.1.2.1.1"><a class="xref" href="#section-1.1">1.1</a>.  <a class="xref" href="#name-requirements-language">Requirements Language</a><a class="pilcrow" href="#section-toc.1-1.1.2.1.1">¶</a></p>
</li>
<li class="toc compact ulEmpty" id="section-toc.1-1.1.2.2">
                <p class="keepWithNext" id="section-toc.1-1.1.2.2.1"><a class="xref" href="#section-1.2">1.2</a>.  <a class="xref" href="#name-fatal-errors">Fatal Errors</a><a class="pilcrow" href="#section-toc.1-1.1.2.2.1">¶</a></p>
</li>
</ul>
</li>
<li class="toc compact ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a class="xref" href="#section-2">2</a>.  <a class="xref" href="#name-motivation">Motivation</a><a class="pilcrow" href="#section-toc.1-1.2.1">¶</a></p>
</li>
<li class="toc compact ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a class="xref" href="#section-3">3</a>.  <a class="xref" href="#name-overview">Overview</a><a class="pilcrow" href="#section-toc.1-1.3.1">¶</a></p>
</li>
<li class="toc compact ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="xref" href="#section-4">4</a>.  <a class="xref" href="#name-state-considerations">State Considerations</a><a class="pilcrow" href="#section-toc.1-1.4.1">¶</a></p>
</li>
<li class="toc compact ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="xref" href="#section-5">5</a>.  <a class="xref" href="#name-transport">Transport</a><a class="pilcrow" href="#section-toc.1-1.5.1">¶</a></p>
</li>
<li class="toc compact ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="xref" href="#section-6">6</a>.  <a class="xref" href="#name-protocol-operation">Protocol Operation</a><a class="pilcrow" href="#section-toc.1-1.6.1">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a class="xref" href="#section-6.1">6.1</a>.  <a class="xref" href="#name-discovery">Discovery</a><a class="pilcrow" href="#section-toc.1-1.6.2.1.1">¶</a></p>
</li>
<li class="toc compact ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a class="xref" href="#section-6.2">6.2</a>.  <a class="xref" href="#name-dns-push-notification-subsc">DNS Push Notification SUBSCRIBE</a><a class="pilcrow" href="#section-toc.1-1.6.2.2.1">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.6.2.2.2.1">
                    <p id="section-toc.1-1.6.2.2.2.1.1"><a class="xref" href="#section-6.2.1">6.2.1</a>.  <a class="xref" href="#name-subscribe-request">SUBSCRIBE Request</a><a class="pilcrow" href="#section-toc.1-1.6.2.2.2.1.1">¶</a></p>
</li>
<li class="toc compact ulEmpty" id="section-toc.1-1.6.2.2.2.2">
                    <p id="section-toc.1-1.6.2.2.2.2.1"><a class="xref" href="#section-6.2.2">6.2.2</a>.  <a class="xref" href="#name-subscribe-response">SUBSCRIBE Response</a><a class="pilcrow" href="#section-toc.1-1.6.2.2.2.2.1">¶</a></p>
</li>
</ul>
</li>
<li class="toc compact ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a class="xref" href="#section-6.3">6.3</a>.  <a class="xref" href="#name-dns-push-notification-updat">DNS Push Notification Updates</a><a class="pilcrow" href="#section-toc.1-1.6.2.3.1">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.6.2.3.2.1">
                    <p id="section-toc.1-1.6.2.3.2.1.1"><a class="xref" href="#section-6.3.1">6.3.1</a>.  <a class="xref" href="#name-push-message">PUSH Message</a><a class="pilcrow" href="#section-toc.1-1.6.2.3.2.1.1">¶</a></p>
</li>
</ul>
</li>
<li class="toc compact ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a class="xref" href="#section-6.4">6.4</a>.  <a class="xref" href="#name-dns-push-notification-unsub">DNS Push Notification UNSUBSCRIBE</a><a class="pilcrow" href="#section-toc.1-1.6.2.4.1">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.6.2.4.2.1">
                    <p id="section-toc.1-1.6.2.4.2.1.1"><a class="xref" href="#section-6.4.1">6.4.1</a>.  <a class="xref" href="#name-unsubscribe-message">UNSUBSCRIBE Message</a><a class="pilcrow" href="#section-toc.1-1.6.2.4.2.1.1">¶</a></p>
</li>
</ul>
</li>
<li class="toc compact ulEmpty" id="section-toc.1-1.6.2.5">
                <p id="section-toc.1-1.6.2.5.1"><a class="xref" href="#section-6.5">6.5</a>.  <a class="xref" href="#name-dns-push-notification-recon">DNS Push Notification RECONFIRM</a><a class="pilcrow" href="#section-toc.1-1.6.2.5.1">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.6.2.5.2.1">
                    <p id="section-toc.1-1.6.2.5.2.1.1"><a class="xref" href="#section-6.5.1">6.5.1</a>.  <a class="xref" href="#name-reconfirm-message">RECONFIRM Message</a><a class="pilcrow" href="#section-toc.1-1.6.2.5.2.1.1">¶</a></p>
</li>
</ul>
</li>
<li class="toc compact ulEmpty" id="section-toc.1-1.6.2.6">
                <p id="section-toc.1-1.6.2.6.1"><a class="xref" href="#section-6.6">6.6</a>.  <a class="xref" href="#name-dns-stateful-operations-tlv">DNS Stateful Operations TLV Context Summary</a><a class="pilcrow" href="#section-toc.1-1.6.2.6.1">¶</a></p>
</li>
<li class="toc compact ulEmpty" id="section-toc.1-1.6.2.7">
                <p id="section-toc.1-1.6.2.7.1"><a class="xref" href="#section-6.7">6.7</a>.  <a class="xref" href="#name-client-initiated-terminatio">Client-Initiated Termination</a><a class="pilcrow" href="#section-toc.1-1.6.2.7.1">¶</a></p>
</li>
<li class="toc compact ulEmpty" id="section-toc.1-1.6.2.8">
                <p id="section-toc.1-1.6.2.8.1"><a class="xref" href="#section-6.8">6.8</a>.  <a class="xref" href="#name-client-fallback-to-polling">Client Fallback to Polling</a><a class="pilcrow" href="#section-toc.1-1.6.2.8.1">¶</a></p>
</li>
</ul>
</li>
<li class="toc compact ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="xref" href="#section-7">7</a>.  <a class="xref" href="#name-security-considerations">Security Considerations</a><a class="pilcrow" href="#section-toc.1-1.7.1">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a class="xref" href="#section-7.1">7.1</a>.  <a class="xref" href="#name-security-services">Security Services</a><a class="pilcrow" href="#section-toc.1-1.7.2.1.1">¶</a></p>
</li>
<li class="toc compact ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a class="xref" href="#section-7.2">7.2</a>.  <a class="xref" href="#name-tls-name-authentication">TLS Name Authentication</a><a class="pilcrow" href="#section-toc.1-1.7.2.2.1">¶</a></p>
</li>
<li class="toc compact ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a class="xref" href="#section-7.3">7.3</a>.  <a class="xref" href="#name-tls-early-data">TLS Early Data</a><a class="pilcrow" href="#section-toc.1-1.7.2.3.1">¶</a></p>
</li>
<li class="toc compact ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a class="xref" href="#section-7.4">7.4</a>.  <a class="xref" href="#name-tls-session-resumption">TLS Session Resumption</a><a class="pilcrow" href="#section-toc.1-1.7.2.4.1">¶</a></p>
</li>
</ul>
</li>
<li class="toc compact ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="xref" href="#section-8">8</a>.  <a class="xref" href="#name-iana-considerations">IANA Considerations</a><a class="pilcrow" href="#section-toc.1-1.8.1">¶</a></p>
</li>
<li class="toc compact ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="xref" href="#section-9">9</a>.  <a class="xref" href="#name-references">References</a><a class="pilcrow" href="#section-toc.1-1.9.1">¶</a></p>
<ul class="toc compact ulEmpty">
<li class="toc compact ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a class="xref" href="#section-9.1">9.1</a>.  <a class="xref" href="#name-normative-references">Normative References</a><a class="pilcrow" href="#section-toc.1-1.9.2.1.1">¶</a></p>
</li>
<li class="toc compact ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a class="xref" href="#section-9.2">9.2</a>.  <a class="xref" href="#name-informative-references">Informative References</a><a class="pilcrow" href="#section-toc.1-1.9.2.2.1">¶</a></p>
</li>
</ul>
</li>
<li class="toc compact ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a class="xref" href="#section-appendix.a"></a><a class="xref" href="#name-acknowledgments">Acknowledgments</a><a class="pilcrow" href="#section-toc.1-1.10.1">¶</a></p>
</li>
<li class="toc compact ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a class="xref" href="#section-appendix.b"></a><a class="xref" href="#name-authors-addresses">Authors' Addresses</a><a class="pilcrow" href="#section-toc.1-1.11.1">¶</a></p>
</li>
</ul>
</nav>
</section>
</div>
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">Domain Name System (DNS) records may be updated using DNS Update
      <span>[<a class="xref" href="#RFC2136">RFC2136</a>]</span>.  Other mechanisms such
      as a Discovery Proxy <span>[<a class="xref" href="#RFC8766">RFC8766</a>]</span> can
      also generate changes to a DNS zone.  This document specifies a protocol
      for DNS clients to subscribe to receive asynchronous notifications of
      changes to RRsets of interest. It is immediately relevant in the case of
      DNS-based Service Discovery <span>[<a class="xref" href="#RFC6763">RFC6763</a>]</span>
      but is not limited to that use case; it provides a general DNS
      mechanism for DNS record change notifications. Familiarity with the DNS
      protocol and DNS packet formats is assumed <span>[<a class="xref" href="#RFC1034">RFC1034</a>]</span> <span>[<a class="xref" href="#RFC1035">RFC1035</a>]</span> <span>[<a class="xref" href="#RFC6895">RFC6895</a>]</span>.<a class="pilcrow" href="#section-1-1">¶</a></p>
<section id="section-1.1">
        <h3 id="name-requirements-language">
<a class="section-number selfRef" href="#section-1.1">1.1. </a><a class="section-name selfRef" href="#name-requirements-language">Requirements Language</a>
        </h3>
<p id="section-1.1-1">
    The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>",
    "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>",
    "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
    "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are
    to be interpreted as
    described in BCP 14 <span>[<a class="xref" href="#RFC2119">RFC2119</a>]</span> <span>[<a class="xref" href="#RFC8174">RFC8174</a>]</span> 
    when, and only when, they appear in all capitals, as shown here.<a class="pilcrow" href="#section-1.1-1">¶</a></p>
</section>
<section id="section-1.2">
        <h3 id="name-fatal-errors">
<a class="section-number selfRef" href="#section-1.2">1.2. </a><a class="section-name selfRef" href="#name-fatal-errors">Fatal Errors</a>
        </h3>
<p id="section-1.2-1">Certain invalid situations are described in this specification,
 such
        as a server sending a Push Notification subscription request to a
        client, or a client sending a Push Notification response to a server.
        These should never occur with a correctly implemented client and
        server, and if they do occur, then they indicate a serious
        implementation error.  In these extreme cases, there is no reasonable
        expectation of a graceful recovery, and the recipient detecting the
        error should respond by unilaterally aborting the session without
        regard for data loss.  Such cases are addressed by having an engineer
        investigate the cause of the failure and fixing the problem in the
        software.<a class="pilcrow" href="#section-1.2-1">¶</a></p>
<p id="section-1.2-2">Where this specification says "forcibly abort", it means
       sending a TCP RST to terminate the TCP connection
       and the TLS session running over that TCP connection.
       In the BSD Sockets API, this is achieved by setting the
       SO_LINGER option to zero before closing the socket.<a class="pilcrow" href="#section-1.2-2">¶</a></p>
</section>
</section>
<section id="section-2">
      <h2 id="name-motivation">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-motivation">Motivation</a>
      </h2>
<p id="section-2-1">As the domain name system continues to adapt to new uses and changes
      in deployment, polling has the potential to burden DNS servers at many
      levels throughout the network. Other network protocols have successfully
      deployed a publish/subscribe model following the Observer design pattern
      <span>[<a class="xref" href="#OBS">OBS</a>]</span>.  Extensible Messaging and
      Presence Protocol (XMPP) Publish-Subscribe
      <span>[<a class="xref" href="#XEP0060">XEP0060</a>]</span> and Atom <span>[<a class="xref" href="#RFC4287">RFC4287</a>]</span> are examples. While DNS
      servers are generally highly tuned and capable of a high rate of
      query/response traffic, adding a publish/subscribe model for tracking
      changes to DNS records can deliver more timely notifications of changes
      with reduced CPU usage and lower network traffic.<a class="pilcrow" href="#section-2-1">¶</a></p>
<p id="section-2-2">The guiding design principle of DNS Push Notifications
      is that clients that choose to use DNS Push Notifications,
      instead of repeated polling with DNS queries,
      will receive the same results as they could
      via sufficiently rapid polling, except more efficiently.
      This means that the rules for
      which records match a given DNS Push Notification subscription are the
      same as the already established rules used to determine
      which records match a given DNS query <span>[<a class="xref" href="#RFC1034">RFC1034</a>]</span>.
      For example, name comparisons are done in a case-insensitive manner,
      and a record of type CNAME in a zone matches any DNS TYPE in a query or
      subscription.<a class="pilcrow" href="#section-2-2">¶</a></p>
<p id="section-2-3">Multicast DNS <span>[<a class="xref" href="#RFC6762">RFC6762</a>]</span>
      implementations always listen on a well-known link-local IP multicast
      group address, and changes are sent to that multicast group address for
      all group members to receive.  Therefore, Multicast DNS already has
      asynchronous change notification capability.  When DNS-based Service Discovery
      <span>[<a class="xref" href="#RFC6763">RFC6763</a>]</span> is used across a wide
      area network using Unicast DNS (possibly facilitated via a Discovery
      Proxy <span>[<a class="xref" href="#RFC8766">RFC8766</a>]</span>), it would be
      beneficial to have an equivalent capability for Unicast DNS in order to
      allow clients to learn about DNS record changes in a timely manner
      without polling.<a class="pilcrow" href="#section-2-3">¶</a></p>
<p id="section-2-4">The DNS Long-Lived Queries (LLQ) mechanism <span>[<a class="xref" href="#RFC8764">RFC8764</a>]</span> is an existing deployed solution to provide
      asynchronous change notifications; it was used by Apple's Back to
      My Mac <span>[<a class="xref" href="#RFC6281">RFC6281</a>]</span> service
      introduced in Mac OS X 10.5 Leopard in 2007.  Back to My Mac was
      designed in an era when the data center operations staff asserted that
      it was impossible for a server to handle large numbers of
      TCP connections, even if those connections carried
      very little traffic and spent most of their time idle.
      Consequently, LLQ was defined as a UDP-based protocol, effectively
      replicating much of TCP's connection state management logic in user
      space and creating its own imitation of existing TCP features like flow
      control, reliability, and the three-way handshake.<a class="pilcrow" href="#section-2-4">¶</a></p>
<p id="section-2-5">This document builds on experience gained with the LLQ protocol, with
      an improved design.  Instead of using UDP, this specification uses DNS
      Stateful Operations (DSO) <span>[<a class="xref" href="#RFC8490">RFC8490</a>]</span> running over TLS over TCP, and therefore
      doesn't need to reinvent existing TCP functionality.  Using TCP also
      gives long-lived low-traffic connections better longevity through NAT
      gateways without depending on the gateway to support NAT Port Mapping
      Protocol (NAT-PMP) <span>[<a class="xref" href="#RFC6886">RFC6886</a>]</span> or
      Port Control Protocol (PCP) <span>[<a class="xref" href="#RFC6887">RFC6887</a>]</span>, or resorting to excessive keepalive
      traffic.<a class="pilcrow" href="#section-2-5">¶</a></p>
</section>
<section id="section-3">
      <h2 id="name-overview">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-overview">Overview</a>
      </h2>
<p id="section-3-1">A DNS Push Notification client subscribes for Push Notifications for
      a particular RRset by connecting to the appropriate Push Notification
      server for that RRset and sending DSO message(s) indicating the
      RRset(s) of interest. When the client loses interest in receiving
      further updates to these records, it unsubscribes.<a class="pilcrow" href="#section-3-1">¶</a></p>
<p id="section-3-2">The DNS Push Notification server for a DNS zone is any server capable
     of generating the correct change notifications for a name.
     It may be a primary, secondary, or stealth name server <span>[<a class="xref" href="#RFC8499">RFC8499</a>]</span>.<a class="pilcrow" href="#section-3-2">¶</a></p>
<p id="section-3-3">The <code>_dns‑push‑tls._tcp.&lt;zone&gt;</code> SRV record for
      a zone <span class="bcp14">MAY</span> reference the same target host and port as
      that zone's <code>_dns‑update‑tls._tcp.&lt;zone&gt;</code> SRV
      record. When the same target host and port is offered for both DNS
      Updates and DNS Push Notifications, a client <span class="bcp14">MAY</span> use a
      single DSO session to that server for both DNS Updates and DNS Push
      Notification subscriptions.  DNS Updates and DNS Push Notifications may
      be handled on different ports on the same target host, in which case
      they are not considered to be the "same server" for the purposes of this
      specification, and communications with these two ports are handled
      independently.  Supporting DNS Updates and DNS Push Notifications on the
      same server is <span class="bcp14">OPTIONAL</span>. A DNS Push Notification server
      is not required to support DNS Update.<a class="pilcrow" href="#section-3-3">¶</a></p>
<p id="section-3-4">Standard DNS Queries <span class="bcp14">MAY</span> be sent over a DNS Push
      Notification (i.e., DSO) session.  For any zone for which the server is
      authoritative, it <span class="bcp14">MUST</span> respond authoritatively for
      queries for names falling within that zone (e.g., the
      <code>_dns‑push‑tls._tcp.&lt;zone&gt;</code> SRV record) both for
      normal DNS queries and for DNS Push Notification subscriptions.  For
      names for which the server is acting as a recursive resolver (e.g., when
      the server is the local recursive resolver) for any query for which it
      supports DNS Push Notification subscriptions, it <span class="bcp14">MUST</span>
      also support standard queries.<a class="pilcrow" href="#section-3-4">¶</a></p>
<p id="section-3-5">DNS Push Notifications impose less load on the responding server than
      rapid polling would, but Push Notifications do still have a
      cost. Therefore, DNS Push Notification clients <span class="bcp14">MUST NOT</span>
      recklessly create an excessive number of Push Notification
      subscriptions. Specifically:<a class="pilcrow" href="#section-3-5">¶</a></p>
<dl class="olPercent" id="section-3-6">
        <dt>(a)</dt>
<dd id="section-3-6.1">A subscription should only be active when there is a valid reason to need
live data (for example, an on-screen display is currently showing the results
to the user), and the subscription <span class="bcp14">SHOULD</span> be canceled as soon
as the need for that data ends (for example, when the user dismisses that
display). In the case of a device like a smartphone that, after some period
of inactivity, goes to sleep or otherwise darkens its screen, it should cancel
its subscriptions when darkening the screen (since the user cannot see any
changes on the display anyway) and reinstate its subscriptions when
reawakening from display sleep.<a class="pilcrow" href="#section-3-6.1">¶</a>
</dd>
<dt>(b)</dt>
<dd id="section-3-6.2">A DNS Push Notification client <span class="bcp14">SHOULD NOT</span> routinely keep a
DNS Push Notification subscription active 24 hours a day, 7 days a week, just
to keep a list in memory up to date so that if the user does choose to bring
up an on-screen display of that data, it can be displayed really fast. DNS
Push Notifications are designed to be fast enough that there is no need to
pre-load a "warm" list in memory just in case it might be needed later.<a class="pilcrow" href="#section-3-6.2">¶</a>
</dd>
</dl>
<p id="section-3-7">Generally, as described in the DNS Stateful Operations specification
      <span>[<a class="xref" href="#RFC8490">RFC8490</a>]</span>, a client
      must not keep a DSO session to a server open indefinitely if it has no
      subscriptions (or other operations) active on that session. A client
      should begin closing a DSO session immediately after it becomes idle,
      and then, if needed in
      the future, open a new session when required. Alternatively, a client
      may speculatively keep an idle DSO session open for some time, subject
      to the constraint that it must not keep a session open that has been
      idle for more than the session's idle timeout (15 seconds by default)
      <span>[<a class="xref" href="#RFC8490">RFC8490</a>]</span>.<a class="pilcrow" href="#section-3-7">¶</a></p>
<p id="section-3-8">Note that a DSO session that has an active DNS Push Notification
      subscription is not considered idle, even if there is no traffic flowing
      for an extended period of time.  In this case, the DSO inactivity
      timeout does not apply, because the session is not inactive, but the
      keepalive interval does still apply, to ensure the generation of
      sufficient messages to maintain state in middleboxes (such at NAT
      gateways or firewalls) and for the client and server to periodically
      verify that they still have connectivity to each other.  This is
      described in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8490#section-6.2">Section 6.2</a> of the DSO specification [<a class="xref" href="#RFC8490">RFC8490</a>]</span>.<a class="pilcrow" href="#section-3-8">¶</a></p>
</section>
<section id="section-4">
      <h2 id="name-state-considerations">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-state-considerations">State Considerations</a>
      </h2>
<p id="section-4-1">Each DNS Push Notification server is capable of handling some finite
     number of Push Notification subscriptions. This number will vary from
     server to server and is based on physical machine characteristics,
     network capacity, and operating system resource allocation. After a
     client establishes a session to a DNS server, each subscription is
     individually accepted or rejected. Servers may employ various techniques
     to limit subscriptions to a manageable level. Correspondingly, the client
     is free to establish simultaneous sessions to alternate DNS servers that
     support DNS Push Notifications for the zone and distribute subscriptions
     at the client's discretion. In this way, both clients and servers can
     react to resource constraints.<a class="pilcrow" href="#section-4-1">¶</a></p>
</section>
<section id="section-5">
      <h2 id="name-transport">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-transport">Transport</a>
      </h2>
<p id="section-5-1">Other DNS operations like DNS Update <span>[<a class="xref" href="#RFC2136">RFC2136</a>]</span> <span class="bcp14">MAY</span> use either DNS over User
      Datagram
      Protocol (UDP) <span>[<a class="xref" href="#RFC0768">RFC0768</a>]</span> or
      DNS over Transmission Control Protocol (TCP) <span>[<a class="xref" href="#RFC0793">RFC0793</a>]</span> as the transport protocol, provided they follow
      the historical precedent that DNS queries must first be sent using DNS
      over UDP
      and only switch to DNS over TCP if needed <span>[<a class="xref" href="#RFC1123">RFC1123</a>]</span>.
      This requirement to prefer UDP
      has subsequently been relaxed <span>[<a class="xref" href="#RFC7766">RFC7766</a>]</span>.<a class="pilcrow" href="#section-5-1">¶</a></p>
<p id="section-5-2">In keeping with the more recent precedent, DNS Push Notification is
      defined only for TCP.
     DNS Push Notification clients <span class="bcp14">MUST</span> use
     DNS Stateful Operations <span>[<a class="xref" href="#RFC8490">RFC8490</a>]</span>
     running over TLS over TCP <span>[<a class="xref" href="#RFC7858">RFC7858</a>]</span>.<a class="pilcrow" href="#section-5-2">¶</a></p>
<p id="section-5-3">
Connection setup over TCP ensures return reachability and alleviates concerns
of state overload at the server, a potential problem with connectionless
protocols, which can be more vulnerable to being exploited by attackers using
spoofed source addresses.

     All subscribers are guaranteed to be reachable by the server by virtue of
     the TCP three-way handshake.  Flooding attacks are possible with any
     protocol, and a benefit of TCP is that there are already established
     industry best practices to guard against SYN flooding and similar attacks
     <span>[<a class="xref" href="#SYN">SYN</a>]</span> <span>[<a class="xref" href="#RFC4953">RFC4953</a>]</span>.<a class="pilcrow" href="#section-5-3">¶</a></p>
<p id="section-5-4">Use of TCP also allows DNS Push Notifications to take advantage of
      current and future developments in TCP such as Multipath TCP (MPTCP)
      <span>[<a class="xref" href="#RFC8684">RFC8684</a>]</span>, TCP Fast Open (TFO)
      <span>[<a class="xref" href="#RFC7413">RFC7413</a>]</span>, the TCP RACK fast loss
      detection algorithm <span>[<a class="xref" href="#I-D.ietf-tcpm-rack">TCPRACK</a>]</span>, and so on.<a class="pilcrow" href="#section-5-4">¶</a></p>
<p id="section-5-5">Transport Layer Security (TLS) <span>[<a class="xref" href="#RFC8446">RFC8446</a>]</span> is well understood and is used by many
      application-layer protocols running over TCP. TLS is designed to prevent
      eavesdropping, tampering, and message forgery. TLS is
      <span class="bcp14">REQUIRED</span> for every connection between a client subscriber
      and server in this protocol specification. Additional security measures
      such as client authentication during TLS negotiation may also be
      employed to increase the trust relationship between client and
      server.<a class="pilcrow" href="#section-5-5">¶</a></p>
</section>
<section id="section-6">
      <h2 id="name-protocol-operation">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-protocol-operation">Protocol Operation</a>
      </h2>
<p id="section-6-1">The DNS Push Notification protocol is a session-oriented protocol and
      makes use of
     DNS Stateful Operations (DSO) <span>[<a class="xref" href="#RFC8490">RFC8490</a>]</span>.<a class="pilcrow" href="#section-6-1">¶</a></p>
<p id="section-6-2">For details of the DSO message format, refer to the
     DNS Stateful Operations specification <span>[<a class="xref" href="#RFC8490">RFC8490</a>]</span>.
     Those details are not repeated here.<a class="pilcrow" href="#section-6-2">¶</a></p>
<p id="section-6-3">DNS Push Notification clients and servers <span class="bcp14">MUST</span> support
      DSO.
     A single server can support DNS Queries, DNS Updates, and DNS Push
     Notifications (using DSO) on the same TCP port.<a class="pilcrow" href="#section-6-3">¶</a></p>
<p id="section-6-4">A DNS Push Notification exchange begins with the client discovering
      the appropriate server, using the procedure described in <a class="xref" href="#discovery">Section 6.1</a>, and then making a TLS/TCP
      connection to it.<a class="pilcrow" href="#section-6-4">¶</a></p>
<p id="section-6-5">After making the TLS/TCP connection to the server,
     a typical DNS Push Notification client will then immediately issue a DSO
     Keepalive operation to establish the DSO session
     and request a session timeout and/or keepalive interval
     longer than the 15-second default values, but this is not required.
     A DNS Push Notification client <span class="bcp14">MAY</span> issue other requests on
     the
     session first, and only issue a DSO Keepalive
     operation later if it determines that to be necessary.
     Sending either a DSO Keepalive operation or a Push Notification
     subscription request over the TLS/TCP connection to the server signals
     the
     client's support of DSO and serves to establish a DSO session.<a class="pilcrow" href="#section-6-5">¶</a></p>
<p id="section-6-6">In accordance with the current set of active subscriptions,
     the server sends relevant asynchronous Push Notifications to
     the client. Note that a client <span class="bcp14">MUST</span> be prepared to receive
     (and silently ignore) Push Notifications for subscriptions it
     has previously removed, since there is no way to prevent the
     situation where a Push Notification is in flight from server
     to client while the client's UNSUBSCRIBE message canceling
     that subscription is simultaneously in flight from client to
     server.<a class="pilcrow" href="#section-6-6">¶</a></p>
<div id="discovery">
<section id="section-6.1">
        <h3 id="name-discovery">
<a class="section-number selfRef" href="#section-6.1">6.1. </a><a class="section-name selfRef" href="#name-discovery">Discovery</a>
        </h3>
<p id="section-6.1-1">The first step in establishing a DNS Push Notification
        subscription is to discover an appropriate DNS server that
        supports DNS Push Notifications for the desired zone.<a class="pilcrow" href="#section-6.1-1">¶</a></p>
<p id="section-6.1-2">The client begins by opening a DSO session to its normal configured
        DNS recursive resolver and requesting a Push Notification
 subscription.
        This connection is made to TCP port 853, the default port for
        DNS over TLS <span>[<a class="xref" href="#RFC7858">RFC7858</a>]</span>.
        If the request for a Push Notification subscription is successful,
        and the recursive resolver doesn't already have an active subscription
 for that name, type, and class,
        then the recursive resolver will make a corresponding
        Push Notification subscription on the client's behalf.
        Results received are relayed to the client.
        This is closely analogous to how a client sends a normal DNS
        query to its configured DNS recursive resolver, which,
        if it doesn't already have appropriate answer(s) in its cache,
        issues an upstream query to satisfy the request.<a class="pilcrow" href="#section-6.1-2">¶</a></p>
<p id="section-6.1-3">In many contexts, the recursive resolver will be able to handle
        Push Notifications for all names that the client may need to follow.
        Use of VPN tunnels and Private DNS <span>[<a class="xref" href="#RFC8499">RFC8499</a>]</span>
        can create some additional complexity in the client software here;
        the techniques to handle VPN tunnels and Private DNS for DNS Push
        Notifications are the same as those already used to handle this for
        normal DNS queries.<a class="pilcrow" href="#section-6.1-3">¶</a></p>
<p id="section-6.1-4">If the recursive resolver does not support DNS over TLS, or
        supports DNS over TLS but is not listening on TCP port 853, or
        supports DNS over TLS on TCP port 853 but does not support DSO on that
        port, then the DSO session establishment will fail <span>[<a class="xref" href="#RFC8490">RFC8490</a>]</span>.<a class="pilcrow" href="#section-6.1-4">¶</a></p>
<p id="section-6.1-5">If the recursive resolver does support DSO on TCP port 853
        but does not support Push Notification subscriptions,
        then when the client attempts to create a subscription,
        the server will return the DSO error code DSOTYPENI (11).<a class="pilcrow" href="#section-6.1-5">¶</a></p>
<p id="section-6.1-6">In some cases, the recursive resolver may support DSO and Push
        Notification subscriptions but may not be able
        to subscribe for Push Notifications for a particular name.
        In this case, the recursive resolver should return
        SERVFAIL to the client. This includes being unable
        to establish a connection
        to the zone's DNS Push Notification server or establishing
        a connection but receiving a non-success response code.
        In some cases, where the client has a pre-established trust
        relationship with the owner of the zone (that is not handled
        via the usual mechanisms for VPN software), the client may
        handle these failures by contacting the zone's DNS Push Notification
 server
        directly.<a class="pilcrow" href="#section-6.1-6">¶</a></p>
<p id="section-6.1-7">In any of the cases described above where the client
        fails to establish a DNS Push Notification subscription via its
        configured recursive resolver, the client should proceed to discover
        the appropriate server for direct communication.  The client
 <span class="bcp14">MUST</span>
        also determine on which TCP port the server is listening for
        connections, which need not be, and often is not,
        TCP port 53 (traditionally used for conventional DNS) or
        TCP port 853 (traditionally used for DNS over TLS).<a class="pilcrow" href="#section-6.1-7">¶</a></p>
<p id="section-6.1-8">The discovery algorithm described here is an iterative algorithm,
        which starts with the full name of the record to which the
        client wishes to subscribe. Successive SOA queries are then
        issued, trimming one label each time, until
        the closest enclosing authoritative server is discovered.
        There is also an optimization to enable the client to
        take a "short cut" directly to the SOA record of
        the closest enclosing authoritative server in many cases.<a class="pilcrow" href="#section-6.1-8">¶</a></p>
<ol class="normal type-1" id="section-6.1-9" start="1" type="1">
          <li id="section-6.1-9.1">The client begins the discovery by sending a DNS query to its
          local resolver, with record type SOA <span>[<a class="xref" href="#RFC1035">RFC1035</a>]</span> for the record name to which it wishes to
          subscribe.  As an example, suppose the client wishes to subscribe to
          PTR records with the name <code>_ipp._tcp.headoffice.example.com</code>
     (to
          discover Internet Printing Protocol (IPP) printers <span>[<a class="xref" href="#RFC8010">RFC8010</a>]</span> <span>[<a class="xref" href="#RFC8011">RFC8011</a>]</span> being advertised in the head office of Example
          Company).  The client begins by sending an SOA query for
          <code>_ipp._tcp.headoffice.example.com</code> to the local recursive
     resolver.
          The goal is to determine the server that is authoritative for the
     name
          <code>_ipp._tcp.headoffice.example.com</code>.  The closest enclosing
     DNS zone
          containing the name <code>_ipp._tcp.headoffice.example.com</code> could
     be
          <code>example.com</code>, or <code>headoffice.example.com</code>, or
          <code>_tcp.headoffice.example.com</code>, or even
          <code>_ipp._tcp.headoffice.example.com</code>.  The client does not know
     in
          advance where the closest enclosing zone cut occurs, which is why it
          uses the iterative procedure described here to discover this
          information.<a class="pilcrow" href="#section-6.1-9.1">¶</a>
</li>
<li id="section-6.1-9.2">
            <p id="section-6.1-9.2.1">If the requested SOA record exists, it will be returned in the
            Answer Section with a NOERROR response code, and the client has
            succeeded in discovering the information it needs.<a class="pilcrow" href="#section-6.1-9.2.1">¶</a></p>
<p id="section-6.1-9.2.2">
            (This language is not placing any new requirements on DNS
         recursive resolvers.
            This text merely describes the existing operation of the DNS
         protocol
            <span>[<a class="xref" href="#RFC1034">RFC1034</a>]</span> <span>[<a class="xref" href="#RFC1035">RFC1035</a>]</span>.)<a class="pilcrow" href="#section-6.1-9.2.2">¶</a></p>
</li>
<li id="section-6.1-9.3">
            <p id="section-6.1-9.3.1">If the requested SOA record does not exist, the client will get
            back a NOERROR/NODATA response or an NXDOMAIN/Name Error response.
            In either case, the local resolver would normally include the SOA
            record for the closest enclosing zone of the requested name in the
            Authority Section.  If the SOA record is received in the Authority
            Section, then the client has succeeded in discovering the
            information it needs.<a class="pilcrow" href="#section-6.1-9.3.1">¶</a></p>
<p id="section-6.1-9.3.2">
            (This language is not placing any new requirements on DNS
         recursive resolvers.
            This text merely describes the existing operation of the DNS
         protocol
            regarding negative responses <span>[<a class="xref" href="#RFC2308">RFC2308</a>]</span>.)<a class="pilcrow" href="#section-6.1-9.3.2">¶</a></p>
</li>
<li id="section-6.1-9.4">If the client receives a response containing no SOA record, then
          it proceeds with the iterative approach.  The client strips the
          leading label from the current query name, and if the resulting name
          has at least two labels in it, then the client sends an SOA query
   for
          that new name and processing continues at step 2 above, repeating
          the iterative search until either an SOA is received or the query
          name consists of a single label, i.e., a Top-Level Domain (TLD).  In
          the case of a single-label name (TLD), this is a network
          configuration error, which should not happen, and the client gives
          up.  The client may retry the operation at a later time of the
          client's choosing, such as after a change in network
     attachment.<a class="pilcrow" href="#section-6.1-9.4">¶</a>
</li>
<li id="section-6.1-9.5">Once the SOA is known (by virtue of being seen either in the
          Answer Section or in the Authority Section), the client sends a DNS
          query with type SRV <span>[<a class="xref" href="#RFC2782">RFC2782</a>]</span>
          for the record name
          <code>_dns‑push‑tls._tcp.&lt;zone&gt;</code>, where
          &lt;zone&gt; is the owner name of the discovered SOA record.<a class="pilcrow" href="#section-6.1-9.5">¶</a>
</li>
<li id="section-6.1-9.6">If the zone in question is set up to offer DNS Push
          Notifications, then this SRV record <span class="bcp14">MUST</span> exist. (If
          this SRV record does not exist, then the zone is not correctly
          configured for DNS Push Notifications as specified in this
          document.) The SRV <code>target</code> contains the name of the server
          providing DNS Push Notifications for the zone. The port number on
          which to contact the server is in the SRV record <code>port</code>
          field. The address(es) of the target host <span class="bcp14">MAY</span> be
          included in the Additional Section, however, the address records
          <span class="bcp14">SHOULD</span> be authenticated before use as described in
          <a class="xref" href="#tls_name_auth">Section 7.2</a> and in the
          specification for using DNS-Based Authentication of Named Entities
     (DANE) TLSA Records with SRV Records <span>[<a class="xref" href="#RFC7673">RFC7673</a>]</span>, if applicable.<a class="pilcrow" href="#section-6.1-9.6">¶</a>
</li>
<div id="SRV">
<li id="section-6.1-9.7">More than one SRV record may be returned. In this
          case, the <code>priority</code> and <code>weight</code> values in the
          returned SRV records are used to determine the order in which to
          contact the servers for subscription requests. As described in the
          SRV specification <span>[<a class="xref" href="#RFC2782">RFC2782</a>]</span>,
          the server with the lowest <code>priority</code> is first contacted. If
          more than one server has the same <code>priority</code>, the
          <code>weight</code> indicates the weighted probability that the client
          should contact that server. Higher weights have higher probabilities
          of being selected.  If a server is not willing to accept a
          subscription request, or is not reachable within a reasonable time,
          as determined by the client, then a subsequent server is to be
          contacted.<a class="pilcrow" href="#section-6.1-9.7">¶</a>
</li>
</div>
</ol>
<p id="section-6.1-10">Each time a client makes a new DNS Push Notification subscription,
        it <span class="bcp14">SHOULD</span> repeat the discovery process in order to
        determine the preferred DNS server for that subscription at that time.
        If a client already has a DSO session with that DNS server, the client
        <span class="bcp14">SHOULD</span> reuse that existing DSO session for the new
        subscription; otherwise, a new DSO session is established.  The client
        <span class="bcp14">MUST</span> respect the DNS TTL values on records it receives
        while performing the discovery process and store them in its local
        cache with this lifetime (as it will generally do anyway for all
        DNS queries it performs).  This means that, as long as the DNS TTL
        values on the authoritative records are set to reasonable values,
        repeated application of the discovery process can be completed
 practically
        instantaneously by the client, using only locally stored cached
        data.<a class="pilcrow" href="#section-6.1-10">¶</a></p>
</section>
</div>
<div id="subscribe">
<section id="section-6.2">
        <h3 id="name-dns-push-notification-subsc">
<a class="section-number selfRef" href="#section-6.2">6.2. </a><a class="section-name selfRef" href="#name-dns-push-notification-subsc">DNS Push Notification SUBSCRIBE</a>
        </h3>
<p id="section-6.2-1">After connecting, and requesting a longer idle timeout and/or
        keepalive interval if necessary, a DNS Push Notification client then
        indicates its desire to receive DNS Push Notifications for a given
        domain name by sending a SUBSCRIBE request to the server.  A SUBSCRIBE
        request is encoded in a DSO message <span>[<a class="xref" href="#RFC8490">RFC8490</a>]</span>. This specification defines a
        DSO Primary TLV for DNS Push Notification SUBSCRIBE Requests
        (DSO Type Code 0x0040).<a class="pilcrow" href="#section-6.2-1">¶</a></p>
<p id="section-6.2-2">DSO messages with the SUBSCRIBE TLV as the Primary TLV are
        permitted in TLS early data, provided that the precautions described
 in
        <a class="xref" href="#early_data">Section 7.3</a> are followed.<a class="pilcrow" href="#section-6.2-2">¶</a></p>
<p id="section-6.2-3">The entity that initiates a SUBSCRIBE request is by definition the
        client.  A server <span class="bcp14">MUST NOT</span> send a SUBSCRIBE request
        over an existing session from a client.  If a server does send a
        SUBSCRIBE request over a DSO session initiated by a client, this is a
        fatal error and the client <span class="bcp14">MUST</span> forcibly abort the
        connection immediately.<a class="pilcrow" href="#section-6.2-3">¶</a></p>
<p id="section-6.2-4">Each SUBSCRIBE request generates exactly one SUBSCRIBE response
        from the server.  The entity that initiates a SUBSCRIBE response is by
        definition the server.  A client <span class="bcp14">MUST NOT</span> send a
        SUBSCRIBE response.  If a client does send a SUBSCRIBE response, this
        is a fatal error and the server <span class="bcp14">MUST</span> forcibly abort the
        connection immediately.<a class="pilcrow" href="#section-6.2-4">¶</a></p>
<section id="section-6.2.1">
          <h4 id="name-subscribe-request">
<a class="section-number selfRef" href="#section-6.2.1">6.2.1. </a><a class="section-name selfRef" href="#name-subscribe-request">SUBSCRIBE Request</a>
          </h4>
<p id="section-6.2.1-1">A SUBSCRIBE request begins with the standard DSO 12-byte header
          <span>[<a class="xref" href="#RFC8490">RFC8490</a>]</span>, followed by the
          SUBSCRIBE Primary TLV.  A SUBSCRIBE request is illustrated in <a class="xref" href="#subscribe_req">Figure 1</a>.<a class="pilcrow" href="#section-6.2.1-1">¶</a></p>
<p id="section-6.2.1-2">The MESSAGE ID field <span class="bcp14">MUST</span> be set to a unique
          value that the client is not using for any other active operation
          on this DSO session. For the purposes here, a MESSAGE ID is in use
          on this session if either the client has used it in a request for
     which it
          has not yet received a response, or if the client has used it for a
          subscription that it has not yet canceled using UNSUBSCRIBE. In
          the SUBSCRIBE response, the server <span class="bcp14">MUST</span> echo back the
          MESSAGE ID value unchanged.<a class="pilcrow" href="#section-6.2.1-2">¶</a></p>
<p id="section-6.2.1-3">The other header fields <span class="bcp14">MUST</span> be set as described
     in the
         <span><a class="xref" href="#RFC8490">DSO specification</a> [<a class="xref" href="#RFC8490">RFC8490</a>]</span>.
         The DNS OPCODE field contains the OPCODE value for DNS Stateful
   Operations (6).
         The four count fields must be zero, and the corresponding four
   sections must be empty (i.e., absent).<a class="pilcrow" href="#section-6.2.1-3">¶</a></p>
<p id="section-6.2.1-4">The DSO-TYPE is SUBSCRIBE (0x0040).<a class="pilcrow" href="#section-6.2.1-4">¶</a></p>
<p id="section-6.2.1-5">The DSO-LENGTH is the length of the DSO-DATA that follows, which
     specifies
         the name, type, and class of the record(s) being sought.<a class="pilcrow" href="#section-6.2.1-5">¶</a></p>
<span id="name-subscribe-request-2"></span><div id="subscribe_req">
<figure id="figure-1">
            <div class="artwork art-text alignLeft" id="section-6.2.1-6.1">
<pre>                                   1  1  1  1  1  1
     0  1  2  3  4  5  6  7  8  9  0  1  2  3  4  5
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+  \
   |                  MESSAGE ID                   |   \
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+    |
   |QR| OPCODE(6) |         Z          |   RCODE   |    |
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+    |
   |             QDCOUNT (MUST BE ZERO)            |    |
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+     &gt; HEADER
   |             ANCOUNT (MUST BE ZERO)            |    |
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+    |
   |             NSCOUNT (MUST BE ZERO)            |    |
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+    |
   |             ARCOUNT (MUST BE ZERO)            |   /
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+  /
   |         DSO-TYPE = SUBSCRIBE (0x0040)         |
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
   |   DSO-LENGTH (number of octets in DSO-DATA)   |
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+  \
   \                     NAME                      \   \
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+    |
   |                     TYPE                      |     &gt; DSO-DATA
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+    |
   |                     CLASS                     |   /
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+  /</pre>
</div>
<figcaption><a class="selfRef" href="#figure-1">Figure 1</a>:
<a class="selfRef" href="#name-subscribe-request-2">SUBSCRIBE Request</a>
            </figcaption></figure>
</div>
<p id="section-6.2.1-7">The DSO-DATA for a SUBSCRIBE request <span class="bcp14">MUST</span> contain
     exactly one NAME, TYPE, and CLASS.
         Since SUBSCRIBE requests are sent over TCP, multiple SUBSCRIBE DSO
   request messages
         can be concatenated in a single TCP stream and packed efficiently
   into TCP segments.<a class="pilcrow" href="#section-6.2.1-7">¶</a></p>
<p id="section-6.2.1-8">If accepted, the subscription will stay in effect until the
          client cancels the subscription using UNSUBSCRIBE or until the DSO
          session between the client and the server is closed.<a class="pilcrow" href="#section-6.2.1-8">¶</a></p>
<p id="section-6.2.1-9">SUBSCRIBE requests on a given session <span class="bcp14">MUST</span> be
          unique.  A client <span class="bcp14">MUST NOT</span> send a SUBSCRIBE message
          that duplicates the name, type and class of an existing active
          subscription on that DSO session.  For the purpose of this matching,
          the established DNS case insensitivity for US-ASCII letters <span>[<a class="xref" href="#RFC0020">RFC0020</a>]</span> applies (e.g., "example.com" and
          "Example.com" are the same).  If a server receives such a duplicate
          SUBSCRIBE message, this is a fatal error and the server
          <span class="bcp14">MUST</span> forcibly abort the connection immediately.<a class="pilcrow" href="#section-6.2.1-9">¶</a></p>
<p id="section-6.2.1-10">DNS wildcarding is not supported.
          That is, an asterisk character ("*") in a SUBSCRIBE message matches
          only a literal asterisk character ("*") in a name and nothing else.
          Similarly, a CNAME in a SUBSCRIBE message matches only a CNAME
     record
          with that name in the zone and no other records with that name.<a class="pilcrow" href="#section-6.2.1-10">¶</a></p>
<p id="section-6.2.1-11">A client may SUBSCRIBE to records that are unknown to the server
          at the time of the request (providing that the name falls within one
          of the zone(s) the server is responsible for), and this is not an
          error. The server <span class="bcp14">MUST NOT</span> return NXDOMAIN in this
          case. The server <span class="bcp14">MUST</span> accept these requests and send
          Push Notifications if and when matching records are found in the
          future.<a class="pilcrow" href="#section-6.2.1-11">¶</a></p>
<p id="section-6.2.1-12">If neither TYPE nor CLASS are ANY (255), then this is a specific
          subscription to changes for the given name, type, and class. If one
          or both of TYPE or CLASS are ANY (255), then this subscription
          matches all types and/or all classes as appropriate.<a class="pilcrow" href="#section-6.2.1-12">¶</a></p>
<p id="section-6.2.1-13">NOTE: A little-known quirk of DNS is that in DNS QUERY requests,
          QTYPE and QCLASS 255 mean "ANY", not "ALL". They indicate that the
          server should respond with ANY matching records of its choosing, not
          necessarily ALL matching records. This can lead to some surprising
          and unexpected results, where a query returns some valid answers,
     but
          not all of them, and makes QTYPE = 255 (ANY) queries less useful
          than people sometimes imagine.<a class="pilcrow" href="#section-6.2.1-13">¶</a></p>
<p id="section-6.2.1-14">When used in conjunction with SUBSCRIBE, TYPE 255 and CLASS 255
          should be interpreted to mean "ALL", not "ANY". After accepting a
          subscription where one or both of TYPE or CLASS are 255, the server
          <span class="bcp14">MUST</span> send Push Notification Updates for ALL record
          changes that match the subscription, not just some of them.<a class="pilcrow" href="#section-6.2.1-14">¶</a></p>
</section>
<div id="subresp">
<section id="section-6.2.2">
          <h4 id="name-subscribe-response">
<a class="section-number selfRef" href="#section-6.2.2">6.2.2. </a><a class="section-name selfRef" href="#name-subscribe-response">SUBSCRIBE Response</a>
          </h4>
<p id="section-6.2.2-1">A SUBSCRIBE response begins with the standard
         DSO 12-byte header <span>[<a class="xref" href="#RFC8490">RFC8490</a>]</span>.
         The QR bit in the header is set indicating it is a response.
         The header <span class="bcp14">MAY</span> be followed by one or more
         optional Additional TLVs such as a Retry Delay Additional TLV.
         A SUBSCRIBE response is illustrated in <a class="xref" href="#subscribe_resp">Figure 2</a>.<a class="pilcrow" href="#section-6.2.2-1">¶</a></p>
<p id="section-6.2.2-2">The MESSAGE ID field <span class="bcp14">MUST</span> echo the value given in
          the MESSAGE ID field of the SUBSCRIBE request.  This is how the
          client knows which request is being responded to.<a class="pilcrow" href="#section-6.2.2-2">¶</a></p>
<p id="section-6.2.2-3">The other header fields <span class="bcp14">MUST</span> be set as described
          in the <span><a class="xref" href="#RFC8490">DSO specification</a> [<a class="xref" href="#RFC8490">RFC8490</a>]</span>.  The DNS OPCODE field
     contains the OPCODE
          value for DNS Stateful Operations (6).  The four count fields must
          be zero, and the corresponding four sections must be empty (i.e.,
          absent).<a class="pilcrow" href="#section-6.2.2-3">¶</a></p>
<p id="section-6.2.2-4">A SUBSCRIBE response message <span class="bcp14">MUST NOT</span> include a
     SUBSCRIBE TLV.
         If a client receives a SUBSCRIBE response message containing a
   SUBSCRIBE TLV,
         then the response message is processed but the SUBSCRIBE TLV
   <span class="bcp14">MUST</span> be silently ignored.<a class="pilcrow" href="#section-6.2.2-4">¶</a></p>
<span id="name-subscribe-response-2"></span><div id="subscribe_resp">
<figure id="figure-2">
            <div class="artwork art-text alignLeft" id="section-6.2.2-5.1">
<pre>                                   1  1  1  1  1  1
     0  1  2  3  4  5  6  7  8  9  0  1  2  3  4  5
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+  \
   |                  MESSAGE ID                   |   \
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+    |
   |QR| OPCODE(6) |         Z          |   RCODE   |    |
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+    |
   |             QDCOUNT (MUST BE ZERO)            |    |
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+     &gt; HEADER
   |             ANCOUNT (MUST BE ZERO)            |    |
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+    |
   |             NSCOUNT (MUST BE ZERO)            |    |
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+    |
   |             ARCOUNT (MUST BE ZERO)            |   /
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+  /

</pre>
</div>
<figcaption><a class="selfRef" href="#figure-2">Figure 2</a>:
<a class="selfRef" href="#name-subscribe-response-2">SUBSCRIBE Response</a>
            </figcaption></figure>
</div>
<p id="section-6.2.2-6">In the SUBSCRIBE response, the RCODE indicates whether or not the
          subscription was accepted. Supported RCODEs are as follows:<a class="pilcrow" href="#section-6.2.2-6">¶</a></p>
<span id="name-subscribe-response-codes"></span><div id="subscribe_rcodes">
<table class="center" id="table-1">
            <caption>
<a class="selfRef" href="#table-1">Table 1</a>:
<a class="selfRef" href="#name-subscribe-response-codes">SUBSCRIBE Response Codes</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" colspan="1" rowspan="1">Mnemonic</th>
                <th class="text-center" colspan="1" rowspan="1">Value</th>
                <th class="text-left" colspan="1" rowspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">NOERROR</td>
                <td class="text-center" colspan="1" rowspan="1">0</td>
                <td class="text-left" colspan="1" rowspan="1">SUBSCRIBE successful.</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">FORMERR</td>
                <td class="text-center" colspan="1" rowspan="1">1</td>
                <td class="text-left" colspan="1" rowspan="1">Server failed to process request due to a
 malformed request.</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">SERVFAIL</td>
                <td class="text-center" colspan="1" rowspan="1">2</td>
                <td class="text-left" colspan="1" rowspan="1">Server failed to process request due to a
 problem with the server.</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">NOTIMP</td>
                <td class="text-center" colspan="1" rowspan="1">4</td>
                <td class="text-left" colspan="1" rowspan="1">Server does not implement DSO.</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">REFUSED</td>
                <td class="text-center" colspan="1" rowspan="1">5</td>
                <td class="text-left" colspan="1" rowspan="1">Server refuses to process request for policy
 or security reasons.</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">NOTAUTH</td>
                <td class="text-center" colspan="1" rowspan="1">9</td>
                <td class="text-left" colspan="1" rowspan="1">Server is not authoritative for the requested
 name.</td>
              </tr>
              <tr>
                <td class="text-left" colspan="1" rowspan="1">DSOTYPENI</td>
                <td class="text-center" colspan="1" rowspan="1">11</td>
                <td class="text-left" colspan="1" rowspan="1">SUBSCRIBE operation not supported.</td>
              </tr>
            </tbody>
          </table>
</div>
<p id="section-6.2.2-8">This document specifies only these RCODE values for SUBSCRIBE
          Responses. Servers sending SUBSCRIBE Responses <span class="bcp14">SHOULD</span>
          use one of these values. Note that NXDOMAIN is not a valid RCODE in
          response to a SUBSCRIBE Request. However, future circumstances may
          create situations where other RCODE values are appropriate in
          SUBSCRIBE Responses, so clients <span class="bcp14">MUST</span> be prepared to
          accept and handle SUBSCRIBE Responses with any other nonzero RCODE
     error values.<a class="pilcrow" href="#section-6.2.2-8">¶</a></p>
<p id="section-6.2.2-9">If the server sends a nonzero RCODE in the SUBSCRIBE response,
     that means:<a class="pilcrow" href="#section-6.2.2-9">¶</a></p>
<ol class="compact type-a" id="section-6.2.2-10" start="1" type="a">
            <li id="section-6.2.2-10.1">the client is (at least partially) misconfigured, or<a class="pilcrow" href="#section-6.2.2-10.1">¶</a>
</li>
<li id="section-6.2.2-10.2">the server resources are exhausted, or<a class="pilcrow" href="#section-6.2.2-10.2">¶</a>
</li>
<li id="section-6.2.2-10.3">there is some other unknown failure on the server.<a class="pilcrow" href="#section-6.2.2-10.3">¶</a>
</li>
</ol>
<p id="section-6.2.2-11">
           In any case, the client shouldn't retry the subscription to this
           server right away. If multiple SRV records were returned as
           described in <a class="xref" href="#SRV">Section 6.1, Paragraph 9, Item 7</a>, a subsequent server
           <span class="bcp14">MAY</span> be tried immediately.<a class="pilcrow" href="#section-6.2.2-11">¶</a></p>
<p id="section-6.2.2-12">If the client has other successful subscriptions to this server,
          these subscriptions remain even though additional subscriptions may
          be refused. Neither the client nor the server is required to close
          the connection, although either end may choose to do so.<a class="pilcrow" href="#section-6.2.2-12">¶</a></p>
<p id="section-6.2.2-13">If the server sends a nonzero RCODE, then it
     <span class="bcp14">SHOULD</span>
          append a Retry Delay Additional TLV <span>[<a class="xref" href="#RFC8490">RFC8490</a>]</span>
          to the response specifying a delay before the client attempts this
          operation again. Recommended values for the delay for different
          RCODE values are given below. These recommended values apply both to
          the default values a server should place in the Retry Delay
     Additional TLV and
          the default values a client should assume if the server provides no
          Retry Delay Additional TLV.<a class="pilcrow" href="#section-6.2.2-13">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.2.2-14.1">For RCODE = 1 (FORMERR), the delay may be any value selected
         by
            the implementer. A value of five minutes is
            <span class="bcp14">RECOMMENDED</span> to reduce the risk of high load from
            defective clients.<a class="pilcrow" href="#section-6.2.2-14.1">¶</a>
</li>
<li class="normal ulEmpty" id="section-6.2.2-14.2">For RCODE = 2 (SERVFAIL), the delay should be chosen according
            to the level of server overload and the anticipated duration of
            that overload. By default, a value of one minute is
            <span class="bcp14">RECOMMENDED</span>. If a more serious server failure
            occurs, the delay may be longer in accordance with the specific
            problem encountered.<a class="pilcrow" href="#section-6.2.2-14.2">¶</a>
</li>
<li class="normal ulEmpty" id="section-6.2.2-14.3">For RCODE = 4 (NOTIMP), which occurs on a server that doesn't
         implement
             DNS Stateful Operations <span>[<a class="xref" href="#RFC8490">RFC8490</a>]</span>,
             it is unlikely that the server will begin supporting DSO
             in the next few minutes, so the retry delay <span class="bcp14">SHOULD</span>
           be one hour.
             Note that in such a case, a server that doesn't implement DSO
             is unlikely to place a Retry Delay Additional TLV in its
           response, so this
             recommended value in particular applies to what a client should
           assume by default.<a class="pilcrow" href="#section-6.2.2-14.3">¶</a>
</li>
<li class="normal ulEmpty" id="section-6.2.2-14.4">For RCODE = 5 (REFUSED), which occurs on a server that
            implements DNS Push Notifications but is currently configured to
            disallow DNS Push Notifications, the retry delay may be any value
            selected by the implementer and/or configured by the
            operator.<a class="pilcrow" href="#section-6.2.2-14.4">¶</a>
</li>
<li class="normal ulEmpty" id="section-6.2.2-14.5">If the server being queried is listed in a
             <code>_dns‑push‑tls._tcp.&lt;zone&gt;</code>
             SRV record for the zone, then this is a misconfiguration,
             since this server is being advertised as supporting DNS Push
           Notifications for this zone,
             but the server itself is not currently configured to perform that
           task.
             Since it is possible that the misconfiguration may be repaired
             at any time, the retry delay should not be set too high.  By
           default,
             a value of 5 minutes is <span class="bcp14">RECOMMENDED</span>.<a class="pilcrow" href="#section-6.2.2-14.5">¶</a>
</li>
<li class="normal ulEmpty" id="section-6.2.2-14.6">For RCODE = 9 (NOTAUTH), which occurs on a server that
            implements DNS Push Notifications but is not configured to be
            authoritative for the requested name, the retry delay may be any
            value selected by the implementer and/or configured by the
            operator.<a class="pilcrow" href="#section-6.2.2-14.6">¶</a>
</li>
<li class="normal ulEmpty" id="section-6.2.2-14.7">If the server being queried is listed in a
             <code>_dns‑push‑tls._tcp.&lt;zone&gt;</code>
             SRV record for the zone, then this is a misconfiguration,
             since this server is being advertised as supporting DNS Push
           Notifications for this zone,
             but the server itself is not currently configured to perform that
           task.
             Since it is possible that the misconfiguration may be repaired
             at any time, the retry delay should not be set too high.  By
           default,
             a value of 5 minutes is <span class="bcp14">RECOMMENDED</span>.<a class="pilcrow" href="#section-6.2.2-14.7">¶</a>
</li>
<li class="normal ulEmpty" id="section-6.2.2-14.8">For RCODE = 11 (DSOTYPENI),
             which occurs on a server that implements DSO but doesn't
           implement DNS Push Notifications,
             it is unlikely that the server will begin supporting DNS Push
           Notifications
             in the next few minutes, so the retry delay <span class="bcp14">SHOULD</span>
           be one hour.<a class="pilcrow" href="#section-6.2.2-14.8">¶</a>
</li>
<li class="normal ulEmpty" id="section-6.2.2-14.9">For other RCODE values, the retry delay should be
            set by the server as appropriate for that error condition.
            By default, a value of 5 minutes is
         <span class="bcp14">RECOMMENDED</span>.<a class="pilcrow" href="#section-6.2.2-14.9">¶</a>
</li>
</ul>
<p id="section-6.2.2-15">For RCODE = 9 (NOTAUTH), the time delay applies to requests for
          other names falling within the same zone. Requests for names falling
          within other zones are not subject to the delay. For all other
          RCODEs, the time delay applies to all subsequent requests to this
          server.<a class="pilcrow" href="#section-6.2.2-15">¶</a></p>
<p id="section-6.2.2-16">After sending an error response, the server <span class="bcp14">MAY</span>
          allow the session to remain open, or <span class="bcp14">MAY</span> follow it
     with
          a DSO Retry Delay operation (using the Retry Delay Primary TLV)
          instructing the client to close the session as described in the
          <span><a class="xref" href="#RFC8490">DSO specification</a> [<a class="xref" href="#RFC8490">RFC8490</a>]</span>.
          Clients <span class="bcp14">MUST</span> correctly handle both cases.
          Note that the
          DSO Retry Delay operation (using the Retry Delay Primary TLV)
          is different to the Retry Delay Additional TLV mentioned above.<a class="pilcrow" href="#section-6.2.2-16">¶</a></p>
</section>
</div>
</section>
</div>
<div id="push">
<section id="section-6.3">
        <h3 id="name-dns-push-notification-updat">
<a class="section-number selfRef" href="#section-6.3">6.3. </a><a class="section-name selfRef" href="#name-dns-push-notification-updat">DNS Push Notification Updates</a>
        </h3>
<p id="section-6.3-1">Once a subscription has been successfully established,
        the server generates PUSH messages to send to the client as
 appropriate.
        In the case that the answer set was already non-empty at the moment
        the subscription was established, an initial PUSH message will be sent
        immediately following the SUBSCRIBE Response. Subsequent changes to
 the
        answer set are then communicated to the client in subsequent PUSH
 messages.<a class="pilcrow" href="#section-6.3-1">¶</a></p>
<p id="section-6.3-2">A client <span class="bcp14">MUST NOT</span> send a PUSH message.
       If a client does send a PUSH message,
       or a PUSH message is sent with the QR bit set indicating that it is a
       response,
       this is a fatal error and the receiver <span class="bcp14">MUST</span> forcibly
       abort the connection immediately.<a class="pilcrow" href="#section-6.3-2">¶</a></p>
<section id="section-6.3.1">
          <h4 id="name-push-message">
<a class="section-number selfRef" href="#section-6.3.1">6.3.1. </a><a class="section-name selfRef" href="#name-push-message">PUSH Message</a>
          </h4>
<p id="section-6.3.1-1">A PUSH unidirectional message begins with the standard
         DSO 12-byte header <span>[<a class="xref" href="#RFC8490">RFC8490</a>]</span>,
   followed by the PUSH Primary TLV.
         A PUSH message is illustrated in <a class="xref" href="#push_msg">Figure 3</a>.<a class="pilcrow" href="#section-6.3.1-1">¶</a></p>
<p id="section-6.3.1-2">In accordance with the definition of DSO unidirectional messages,
         the MESSAGE ID field <span class="bcp14">MUST</span> be zero.
         There is no client response to a PUSH message.<a class="pilcrow" href="#section-6.3.1-2">¶</a></p>
<p id="section-6.3.1-3">The other header fields <span class="bcp14">MUST</span> be set as described
     in the
         DSO specification <span>[<a class="xref" href="#RFC8490">RFC8490</a>]</span>.
         The DNS OPCODE field contains the OPCODE value for DNS Stateful
   Operations (6).
         The four count fields must be zero, and the corresponding four
   sections must be empty (i.e., absent).<a class="pilcrow" href="#section-6.3.1-3">¶</a></p>
<p id="section-6.3.1-4">The DSO-TYPE is PUSH (0x0041).<a class="pilcrow" href="#section-6.3.1-4">¶</a></p>
<p id="section-6.3.1-5">The DSO-LENGTH is the length of the DSO-DATA that follows, which
     specifies
         the changes being communicated.<a class="pilcrow" href="#section-6.3.1-5">¶</a></p>
<p id="section-6.3.1-6">The DSO-DATA contains one or more change notifications.
         A PUSH Message <span class="bcp14">MUST</span> contain at least one change
   notification.
         If a PUSH Message is received that contains no change notifications,
         this is a fatal error and the client <span class="bcp14">MUST</span> forcibly
   abort the connection immediately.<a class="pilcrow" href="#section-6.3.1-6">¶</a></p>
<p id="section-6.3.1-7">The change notification records are formatted similarly to how
         DNS Resource Records are conventionally expressed in DNS messages,
         as illustrated in <a class="xref" href="#push_msg">Figure 3</a>,
         and are interpreted as described below.<a class="pilcrow" href="#section-6.3.1-7">¶</a></p>
<p id="section-6.3.1-8">The TTL field holds an unsigned 32-bit integer <span>[<a class="xref" href="#RFC2181">RFC2181</a>]</span>.
         If the TTL is in the range 0 to 2,147,483,647 seconds (0 to
   2<sup>31</sup> - 1, or 0x7FFFFFFF),
         then a new DNS Resource Record with the given name, type, class, and
   RDATA is added.
         Type and class <span class="bcp14">MUST NOT</span> be 255 (ANY). If either type
   or class are 255 (ANY),
         this is a fatal error and the client <span class="bcp14">MUST</span> forcibly
   abort the connection immediately.
         A TTL of 0 means that this record should be retained for as long as
   the subscription is active
         and should be discarded immediately the moment the subscription is
    canceled.<a class="pilcrow" href="#section-6.3.1-8">¶</a></p>
<p id="section-6.3.1-9">If the TTL has the value 0xFFFFFFFF, then the DNS Resource Record
          with the given name, type, class, and RDATA is removed.  Type and
          class <span class="bcp14">MUST NOT</span> be 255 (ANY). If either type or class
          are 255 (ANY), this is a fatal error and the client
          <span class="bcp14">MUST</span> forcibly abort the connection immediately.<a class="pilcrow" href="#section-6.3.1-9">¶</a></p>
<p id="section-6.3.1-10">If the TTL has the value 0xFFFFFFFE, then this is a 'collective'
          remove notification.  For collective remove notifications, RDLEN
          <span class="bcp14">MUST</span> be zero, and consequently, the RDATA
          <span class="bcp14">MUST</span> be empty.  If a change notification is received
          where TTL = 0xFFFFFFFE and RDLEN is not zero, this is a fatal error
          and the client <span class="bcp14">MUST</span> forcibly abort the connection
          immediately.<a class="pilcrow" href="#section-6.3.1-10">¶</a></p>
<p id="section-6.3.1-11">There are three types of collective remove notification.
          For collective remove notifications:<a class="pilcrow" href="#section-6.3.1-11">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.3.1-12.1">If CLASS is not 255 (ANY) and TYPE is not 255 (ANY), then for the given
name, this removes all records of the specified type in the specified class.<a class="pilcrow" href="#section-6.3.1-12.1">¶</a>
</li>
<li class="normal" id="section-6.3.1-12.2">If CLASS is not 255 (ANY) and TYPE is 255 (ANY), then for the given name,
this removes all records of all types in the specified class.<a class="pilcrow" href="#section-6.3.1-12.2">¶</a>
</li>
<li class="normal" id="section-6.3.1-12.3">If CLASS is 255 (ANY), then for the given name, this removes all records
of all types in all classes.  In this case, TYPE <span class="bcp14">MUST</span> be set to
zero on
transmission and <span class="bcp14">MUST</span> be silently ignored on reception.<a class="pilcrow" href="#section-6.3.1-12.3">¶</a>
</li>
</ul>
<p id="section-6.3.1-13">Summary of change notification types:<a class="pilcrow" href="#section-6.3.1-13">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.3.1-14.1">
              <p id="section-6.3.1-14.1.1">Remove all RRsets from a name in all classes:<br/>
             TTL = 0xFFFFFFFE, RDLEN = 0, CLASS = 255 (ANY).<a class="pilcrow" href="#section-6.3.1-14.1.1">¶</a></p>
</li>
<li class="normal" id="section-6.3.1-14.2">
              <p id="section-6.3.1-14.2.1">Remove all RRsets from a name in given class:<br/>
             TTL = 0xFFFFFFFE, RDLEN = 0, CLASS gives class, TYPE = 255
            (ANY).<a class="pilcrow" href="#section-6.3.1-14.2.1">¶</a></p>
</li>
<li class="normal" id="section-6.3.1-14.3">
              <p id="section-6.3.1-14.3.1">Remove specified RRset from a name in given class:<br/>
             TTL = 0xFFFFFFFE, RDLEN = 0,<br/>
             CLASS and TYPE specify the RRset being removed.<a class="pilcrow" href="#section-6.3.1-14.3.1">¶</a></p>
</li>
<li class="normal" id="section-6.3.1-14.4">
              <p id="section-6.3.1-14.4.1">Remove an individual RR from a name:<br/>
             TTL = 0xFFFFFFFF,<br/>
             CLASS, TYPE, RDLEN, and RDATA specify the RR being removed.<a class="pilcrow" href="#section-6.3.1-14.4.1">¶</a></p>
</li>
<li class="normal" id="section-6.3.1-14.5">
              <p id="section-6.3.1-14.5.1">Add individual RR to a name:<br/>
             TTL &gt;= 0 and TTL &lt;= 0x7FFFFFFF,<br/>
             CLASS, TYPE, RDLEN, RDATA, and TTL specify the RR being
            added.<a class="pilcrow" href="#section-6.3.1-14.5.1">¶</a></p>
</li>
</ul>
<p id="section-6.3.1-15">Note that it is valid for the RDATA of an added or removed DNS
          Resource Record to be empty (zero length).  For example, an Address
          Prefix List Resource Record <span>[<a class="xref" href="#RFC3123">RFC3123</a>]</span> may have empty RDATA.  Therefore, a change
          notification with RDLEN = 0 does not automatically indicate a remove
          notification.  If RDLEN = 0 and TTL is in the range 0 to
          0x7FFFFFFF, this change notification signals the addition of a
          record with the given name, type, class, and empty RDATA.  If RDLEN
          = 0 and TTL = 0xFFFFFFFF, this change notification signals the
          removal specifically of that single record with the given name,
          type, class, and empty RDATA.<a class="pilcrow" href="#section-6.3.1-15">¶</a></p>
<p id="section-6.3.1-16">If the TTL is any value other than 0xFFFFFFFF, 0xFFFFFFFE, or a
     value in the range 0 to 0x7FFFFFFF,
         then the receiver <span class="bcp14">SHOULD</span> silently ignore this
   particular change notification record.
         The connection is not terminated and other valid change notification
   records
         within this PUSH message are processed as usual.<a class="pilcrow" href="#section-6.3.1-16">¶</a></p>
<p id="section-6.3.1-17">In the case where a single change affects more than one active
          subscription, only one PUSH message is sent. For example, a PUSH
          message adding a given record may match both a SUBSCRIBE request
          with the same TYPE and a different SUBSCRIBE request with TYPE = 255
          (ANY). It is not the case that two PUSH messages are sent because
          the new record matches two active subscriptions.<a class="pilcrow" href="#section-6.3.1-17">¶</a></p>
<p id="section-6.3.1-18">The server <span class="bcp14">SHOULD</span> encode change notifications in
     the most efficient manner possible.
          For example, when three AAAA records are removed from a given name,
     and no other AAAA
          records exist for that name, the server <span class="bcp14">SHOULD</span> send a
          "Remove specified RRset from a name in given class" PUSH message,
     not three separate
          "Remove an individual RR from a name" PUSH messages.
          Similarly, when both an SRV and a TXT record are removed from a
     given name, and no other
          records of any kind exist for that name in that class, the server
     <span class="bcp14">SHOULD</span> send a
          "Remove all RRsets from a name in given class" PUSH message, not two
     separate
          "Remove specified RRset from a name in given class" PUSH
     messages.<a class="pilcrow" href="#section-6.3.1-18">¶</a></p>
<p id="section-6.3.1-19">For efficiency, when generating a PUSH message, rather than
     sending
          each change notification as a separate DSO message, a server
          <span class="bcp14">SHOULD</span> include as many change notifications as it has
          immediately available to send to that client, even if those change
          notifications apply to different subscriptions from that
     client. Conceptually, a PUSH
          message is a session-level mechanism, not a subscription-level
     mechanism.
          Once it has exhausted the list of change notifications immediately
     available to send to that client,
          a server <span class="bcp14">SHOULD</span> then send the PUSH message
     immediately
          rather than waiting speculatively to see if additional change
     notifications become available.<a class="pilcrow" href="#section-6.3.1-19">¶</a></p>
<p id="section-6.3.1-20">For efficiency, when generating a PUSH message a server
          <span class="bcp14">SHOULD</span> use standard DNS name compression, with
     offsets
          relative to the beginning of the DNS message <span>[<a class="xref" href="#RFC1035">RFC1035</a>]</span>.  When multiple change notifications in a single
          PUSH message have the same owner name, this name compression can
          yield significant savings.  Name compression should be performed as
          specified in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6762#section-18.14">Section 18.14</a> of the Multicast DNS specification [<a class="xref" href="#RFC6762">RFC6762</a>]</span>; namely,
     owner names
          should always be compressed, and names appearing within RDATA should
          be compressed for only the RR types listed below:<a class="pilcrow" href="#section-6.3.1-20">¶</a></p>
<dl class="dlParallel" id="section-6.3.1-21">
            <dt id="section-6.3.1-21.1"></dt>
<dd id="section-6.3.1-21.2">NS, CNAME, PTR, DNAME, SOA, MX, AFSDB, RT, KX, RP, PX, SRV,
         NSEC<a class="pilcrow" href="#section-6.3.1-21.2">¶</a>
</dd>
<dd class="break"></dd>
</dl>
<p id="section-6.3.1-22">Servers may generate PUSH messages up to a maximum DNS message
     length of 16,382 bytes,
         counting from the start of the DSO 12-byte header.
         Including the two-byte length prefix that is used to frame DNS over a
   byte stream
         like TLS, this makes a total of 16,384 bytes.
         Servers <span class="bcp14">MUST NOT</span> generate PUSH messages larger than
   this.
         Where the immediately available change notifications
         are sufficient to exceed a DNS message length of 16,382 bytes,
         the change notifications <span class="bcp14">MUST</span> be communicated in
   separate PUSH messages
         of up to 16,382 bytes each.
         DNS name compression becomes less effective for messages larger than
   16,384 bytes,
         so little efficiency benefit is gained by sending messages larger
   than this.<a class="pilcrow" href="#section-6.3.1-22">¶</a></p>
<p id="section-6.3.1-23">If a client receives a PUSH message with a DNS message length
     larger than 16,382 bytes,
         this is a fatal error and the client <span class="bcp14">MUST</span> forcibly
   abort the connection immediately.<a class="pilcrow" href="#section-6.3.1-23">¶</a></p>
<span id="name-push-message-2"></span><div id="push_msg">
<figure id="figure-3">
            <div class="artwork art-text alignLeft" id="section-6.3.1-24.1">
<pre>                                   1  1  1  1  1  1
     0  1  2  3  4  5  6  7  8  9  0  1  2  3  4  5
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+  \
   |           MESSAGE ID (MUST BE ZERO)           |   \
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+    |
   |QR| OPCODE(6) |         Z          |   RCODE   |    |
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+    |
   |             QDCOUNT (MUST BE ZERO)            |    |
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+     &gt; HEADER
   |             ANCOUNT (MUST BE ZERO)            |    |
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+    |
   |             NSCOUNT (MUST BE ZERO)            |    |
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+    |
   |             ARCOUNT (MUST BE ZERO)            |   /
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+  /
   |            DSO-TYPE = PUSH (0x0041)           |
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
   |   DSO-LENGTH (number of octets in DSO-DATA)   |
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+  \
   \                     NAME                      \   \
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+    |
   |                     TYPE                      |    |
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+    |
   |                     CLASS                     |    |
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+    |
   |                      TTL                      |    |
   |     (32-bit unsigned big-endian integer)      |     &gt; DSO-DATA
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+    |
   |  RDLEN (16-bit unsigned big-endian integer)   |    |
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+    |
   \           RDATA (sized as necessary)          \    |
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+    |
   :     NAME, TYPE, CLASS, TTL, RDLEN, RDATA      :    |
   :             Repeated As Necessary             :   /
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+  /</pre>
</div>
<figcaption><a class="selfRef" href="#figure-3">Figure 3</a>:
<a class="selfRef" href="#name-push-message-2">PUSH Message</a>
            </figcaption></figure>
</div>
<p id="section-6.3.1-25">When processing the records received in a PUSH Message, the
     receiving client <span class="bcp14">MUST</span> validate
         that the records being added or removed correspond with at least one
   currently active
         subscription on that session. Specifically, the record name
   <span class="bcp14">MUST</span> match the name given in the
         SUBSCRIBE request, subject to the usual established DNS
   case-insensitivity for US-ASCII letters.
         For individual additions and removals,
         if the TYPE in the SUBSCRIBE request was not ANY (255),
         then the TYPE of the record must either be CNAME or match the TYPE
   given in the SUBSCRIBE request, and
         if the CLASS in the SUBSCRIBE request was not ANY (255),
         then the CLASS of the record must match the CLASS given in the
   SUBSCRIBE request.
         For collective removals, at least one of the records being removed
   must match an active subscription.
         If a matching active subscription on that session is not found, then
   that particular
         addition/removal record is silently ignored. The processing of other
   additions and removal records
         in this message is not affected. The DSO session is not closed. This
   is to allow for
         the unavoidable race condition where a client sends an outbound
   UNSUBSCRIBE while
         inbound PUSH messages for that subscription from the server are still
   in flight.<a class="pilcrow" href="#section-6.3.1-25">¶</a></p>
<p id="section-6.3.1-26">The TTL of an added record is stored by the client.  While the
     subscription
           is active the TTL is not decremented, because a change to the TTL
       would
           produce a new update.
           For as long as a relevant subscription remains active, the client
           <span class="bcp14">SHOULD</span> assume that when a record goes away, the
       server will notify it
           of that fact.  Consequently, a client does not have to poll to
       verify
           that the record is still there.  Once a subscription is canceled
           (individually, or as a result of the DSO session being closed),
       record
           aging for records covered by the subscription resumes and records
       are
           removed from the local cache when their  TTL reaches zero.<a class="pilcrow" href="#section-6.3.1-26">¶</a></p>
</section>
</section>
</div>
<div id="unsubscribe">
<section id="section-6.4">
        <h3 id="name-dns-push-notification-unsub">
<a class="section-number selfRef" href="#section-6.4">6.4. </a><a class="section-name selfRef" href="#name-dns-push-notification-unsub">DNS Push Notification UNSUBSCRIBE</a>
        </h3>
<p id="section-6.4-1">To cancel an individual subscription without closing the entire DSO
        session, the client sends an UNSUBSCRIBE message over the established
        DSO session to the server.<a class="pilcrow" href="#section-6.4-1">¶</a></p>
<p id="section-6.4-2">The entity that initiates an UNSUBSCRIBE message is by definition
 the client.
       A server <span class="bcp14">MUST NOT</span> send an UNSUBSCRIBE message over an
       existing session from a client.
       If a server does send an UNSUBSCRIBE message over a DSO session
       initiated by a client,
       or an UNSUBSCRIBE message is sent with the QR bit set indicating that
       it is a response,
       this is a fatal error and the receiver <span class="bcp14">MUST</span> forcibly
       abort the connection immediately.<a class="pilcrow" href="#section-6.4-2">¶</a></p>
<section id="section-6.4.1">
          <h4 id="name-unsubscribe-message">
<a class="section-number selfRef" href="#section-6.4.1">6.4.1. </a><a class="section-name selfRef" href="#name-unsubscribe-message">UNSUBSCRIBE Message</a>
          </h4>
<p id="section-6.4.1-1">An UNSUBSCRIBE unidirectional message begins with the standard
         DSO 12-byte header <span>[<a class="xref" href="#RFC8490">RFC8490</a>]</span>,
   followed by the UNSUBSCRIBE Primary TLV.
         An UNSUBSCRIBE message is illustrated in <a class="xref" href="#unsubscribe_msg">Figure 4</a>.<a class="pilcrow" href="#section-6.4.1-1">¶</a></p>
<p id="section-6.4.1-2">In accordance with the definition of DSO unidirectional messages,
         the MESSAGE ID field <span class="bcp14">MUST</span> be zero.
         There is no server response to an UNSUBSCRIBE message.<a class="pilcrow" href="#section-6.4.1-2">¶</a></p>
<p id="section-6.4.1-3">The other header fields <span class="bcp14">MUST</span> be set as described
     in the
         <span><a class="xref" href="#RFC8490">DSO specification</a> [<a class="xref" href="#RFC8490">RFC8490</a>]</span>.
         The DNS OPCODE field contains the OPCODE value for DNS Stateful
   Operations (6).
         The four count fields must be zero, and the corresponding four
   sections must be empty (i.e., absent).<a class="pilcrow" href="#section-6.4.1-3">¶</a></p>
<p id="section-6.4.1-4">The DSO-TYPE is UNSUBSCRIBE (0x0042).<a class="pilcrow" href="#section-6.4.1-4">¶</a></p>
<p id="section-6.4.1-5">The DSO-LENGTH field contains the value 2, the length of the
     2-octet MESSAGE ID contained in the DSO-DATA.<a class="pilcrow" href="#section-6.4.1-5">¶</a></p>
<p id="section-6.4.1-6">The DSO-DATA contains the value previously given in the MESSAGE
     ID field of an active SUBSCRIBE request.
         This is how the server knows which SUBSCRIBE request is being
   canceled.
         After receipt of the UNSUBSCRIBE message, the SUBSCRIBE request is no
   longer active.<a class="pilcrow" href="#section-6.4.1-6">¶</a></p>
<p id="section-6.4.1-7">It is allowable for the client to issue an UNSUBSCRIBE message
     for a previous SUBSCRIBE request
         for which the client has not yet received a SUBSCRIBE response.
         This is to allow for the case where a client starts and stops a
   subscription in less than the
         round-trip time to the server.
         The client is NOT required to wait for the SUBSCRIBE response before
   issuing the UNSUBSCRIBE message.<a class="pilcrow" href="#section-6.4.1-7">¶</a></p>
<p id="section-6.4.1-8">Consequently, it is possible for a server to receive an
     UNSUBSCRIBE message
         that does not match any currently active subscription.
         This can occur when a client sends a SUBSCRIBE request,
         which subsequently fails and returns an error code,
         but the client sent an UNSUBSCRIBE message before it
         became aware that the SUBSCRIBE request had failed.
         Because of this, servers <span class="bcp14">MUST</span> silently ignore
         UNSUBSCRIBE messages that do not match any currently active
    subscription.<a class="pilcrow" href="#section-6.4.1-8">¶</a></p>
<span id="name-unsubscribe-message-2"></span><div id="unsubscribe_msg">
<figure id="figure-4">
            <div class="artwork art-text alignLeft" id="section-6.4.1-9.1">
<pre>                                   1  1  1  1  1  1
     0  1  2  3  4  5  6  7  8  9  0  1  2  3  4  5
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+  \
   |           MESSAGE ID (MUST BE ZERO)           |   \
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+    |
   |QR| OPCODE(6) |         Z          |   RCODE   |    |
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+    |
   |             QDCOUNT (MUST BE ZERO)            |    |
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+     &gt; HEADER
   |             ANCOUNT (MUST BE ZERO)            |    |
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+    |
   |             NSCOUNT (MUST BE ZERO)            |    |
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+    |
   |             ARCOUNT (MUST BE ZERO)            |   /
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+  /
   |         DSO-TYPE = UNSUBSCRIBE (0x0042)       |
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
   |                DSO-LENGTH (2)                 |
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+  \
   |              SUBSCRIBE MESSAGE ID             |   &gt; DSO-DATA
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+  /</pre>
</div>
<figcaption><a class="selfRef" href="#figure-4">Figure 4</a>:
<a class="selfRef" href="#name-unsubscribe-message-2">UNSUBSCRIBE Message</a>
            </figcaption></figure>
</div>
</section>
</section>
</div>
<div id="reconfirm">
<section id="section-6.5">
        <h3 id="name-dns-push-notification-recon">
<a class="section-number selfRef" href="#section-6.5">6.5. </a><a class="section-name selfRef" href="#name-dns-push-notification-recon">DNS Push Notification RECONFIRM</a>
        </h3>
<p id="section-6.5-1">Sometimes, particularly when used with a Discovery Proxy <span>[<a class="xref" href="#RFC8766">RFC8766</a>]</span>, a DNS Zone may contain
        stale data. When a client encounters data that it believes may be
        stale (e.g., an SRV record referencing a target host+port that is not
        responding to connection requests), the client can send a RECONFIRM
        message to ask the server to re-verify that the data is still
        valid. For a Discovery Proxy, this causes it to issue new Multicast
        DNS queries to ascertain whether the target device is still
        present. How the Discovery Proxy causes these new Multicast DNS
        queries to be issued depends on the details of the underlying
        Multicast DNS implementation being used.  For example, a Discovery
        Proxy built on Apple's dns_sd.h API <span>[<a class="xref" href="#SD-API">SD-API</a>]</span> responds to a DNS Push Notification RECONFIRM
        message by calling the underlying API's DNSServiceReconfirmRecord()
        routine.<a class="pilcrow" href="#section-6.5-1">¶</a></p>
<p id="section-6.5-2">For other types of DNS server, the RECONFIRM operation is currently
        undefined and <span class="bcp14">SHOULD</span> result in a NOERROR response, but
        it need not cause any other action to occur.<a class="pilcrow" href="#section-6.5-2">¶</a></p>
<p id="section-6.5-3">Frequent use of RECONFIRM operations may be a sign of network
        unreliability, or some kind of misconfiguration, so RECONFIRM
        operations <span class="bcp14">MAY</span> be logged or otherwise communicated to a
        human administrator to assist in detecting and remedying such network
        problems.<a class="pilcrow" href="#section-6.5-3">¶</a></p>
<p id="section-6.5-4">If, after receiving a valid RECONFIRM message, the server
        determines that the disputed records are in fact no longer valid, then
        subsequent DNS PUSH Messages will be generated to inform interested
        clients. Thus, one client discovering that a previously advertised
        device (like a network printer) is no longer present has the side
        effect of informing all other interested clients that the device in
        question is now gone.<a class="pilcrow" href="#section-6.5-4">¶</a></p>
<p id="section-6.5-5">The entity that initiates a RECONFIRM message is by definition the
 client.
       A server <span class="bcp14">MUST NOT</span> send a RECONFIRM message over an
       existing session from a client.
       If a server does send a RECONFIRM message over a DSO session initiated
       by a client,
       or a RECONFIRM message is sent with the QR bit set indicating that it
       is a response,
       this is a fatal error and the receiver <span class="bcp14">MUST</span> forcibly
       abort the connection immediately.<a class="pilcrow" href="#section-6.5-5">¶</a></p>
<section id="section-6.5.1">
          <h4 id="name-reconfirm-message">
<a class="section-number selfRef" href="#section-6.5.1">6.5.1. </a><a class="section-name selfRef" href="#name-reconfirm-message">RECONFIRM Message</a>
          </h4>
<p id="section-6.5.1-1">A RECONFIRM unidirectional message begins with the standard DSO
          12-byte header <span>[<a class="xref" href="#RFC8490">RFC8490</a>]</span>,
          followed by the RECONFIRM Primary TLV.
          A RECONFIRM message is illustrated in <a class="xref" href="#reconfirm_msg">Figure 5</a>.<a class="pilcrow" href="#section-6.5.1-1">¶</a></p>
<p id="section-6.5.1-2">In accordance with the definition of DSO unidirectional messages,
         the MESSAGE ID field <span class="bcp14">MUST</span> be zero.
         There is no server response to a RECONFIRM message.<a class="pilcrow" href="#section-6.5.1-2">¶</a></p>
<p id="section-6.5.1-3">The other header fields <span class="bcp14">MUST</span> be set as described
     in the
         <span><a class="xref" href="#RFC8490">DSO specification</a> [<a class="xref" href="#RFC8490">RFC8490</a>]</span>.
         The DNS OPCODE field contains the OPCODE value for DNS Stateful
   Operations (6).
         The four count fields must be zero, and the corresponding four
   sections must be empty (i.e., absent).<a class="pilcrow" href="#section-6.5.1-3">¶</a></p>
<p id="section-6.5.1-4">The DSO-TYPE is RECONFIRM (0x0043).<a class="pilcrow" href="#section-6.5.1-4">¶</a></p>
<p id="section-6.5.1-5">The DSO-LENGTH is the length of the data that follows, which
     specifies
         the name, type, class, and content of the record being disputed.<a class="pilcrow" href="#section-6.5.1-5">¶</a></p>
<p id="section-6.5.1-6">A DNS Push Notifications RECONFIRM message contains exactly one
     RECONFIRM Primary TLV.
          The DSO-DATA in a RECONFIRM Primary TLV <span class="bcp14">MUST</span> contain
     exactly one record.
          The DSO-DATA in a RECONFIRM Primary TLV has no count field to
     specify more than one record.
          Since RECONFIRM messages are sent over TCP, multiple RECONFIRM
     messages
          can be concatenated in a single TCP stream and packed efficiently
     into TCP segments.
          Note that this means that DNS name compression cannot be used
          between different RECONFIRM messages.
          However, when a client is sending multiple RECONFIRM messages this
     indicates
          a situation with serious network problems, and this is not expected
     to occur
          frequently enough that optimizing efficiency in this case is
     important.<a class="pilcrow" href="#section-6.5.1-6">¶</a></p>
<p id="section-6.5.1-7">TYPE <span class="bcp14">MUST NOT</span> be the value ANY (255) and CLASS
     <span class="bcp14">MUST NOT</span> be the value ANY (255).<a class="pilcrow" href="#section-6.5.1-7">¶</a></p>
<p id="section-6.5.1-8">DNS wildcarding is not supported.
          That is, an asterisk character ("*") in a RECONFIRM message matches
          only a literal asterisk character ("*") in a name and nothing else.
          Similarly, a CNAME in a RECONFIRM message matches only a CNAME
     record
          with that name in the zone and no other records with that name.<a class="pilcrow" href="#section-6.5.1-8">¶</a></p>
<p id="section-6.5.1-9">Note that there is no RDLEN field,
          since the length of the RDATA can be inferred from DSO-LENGTH,
          so an additional RDLEN field would be redundant.<a class="pilcrow" href="#section-6.5.1-9">¶</a></p>
<p id="section-6.5.1-10">Following the same rules as for PUSH messages, DNS name
     compression SHOULD
          be used within the RDATA of the RECONFIRM message, with offsets
     relative to the
          beginning of the DNS message <span>[<a class="xref" href="#RFC1035">RFC1035</a>]</span>.<a class="pilcrow" href="#section-6.5.1-10">¶</a></p>
<span id="name-reconfirm-message-2"></span><div id="reconfirm_msg">
<figure id="figure-5">
            <div class="artwork art-text alignLeft" id="section-6.5.1-11.1">
<pre>                                   1  1  1  1  1  1
     0  1  2  3  4  5  6  7  8  9  0  1  2  3  4  5
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+  \
   |           MESSAGE ID (MUST BE ZERO)           |   \
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+    |
   |QR| OPCODE(6) |         Z          |   RCODE   |    |
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+    |
   |             QDCOUNT (MUST BE ZERO)            |    |
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+     &gt; HEADER
   |             ANCOUNT (MUST BE ZERO)            |    |
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+    |
   |             NSCOUNT (MUST BE ZERO)            |    |
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+    |
   |             ARCOUNT (MUST BE ZERO)            |   /
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+  /
   |         DSO-TYPE = RECONFIRM (0x0043)         |
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
   |   DSO-LENGTH (number of octets in DSO-DATA)   |
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+  \
   \                     NAME                      \   \
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+    |
   |                     TYPE                      |    |
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+     &gt; DSO-DATA
   |                     CLASS                     |    |
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+    |
   \                     RDATA                     \   /
   +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+  /</pre>
</div>
<figcaption><a class="selfRef" href="#figure-5">Figure 5</a>:
<a class="selfRef" href="#name-reconfirm-message-2">RECONFIRM Message</a>
            </figcaption></figure>
</div>
</section>
</section>
</div>
<section id="section-6.6">
        <h3 id="name-dns-stateful-operations-tlv">
<a class="section-number selfRef" href="#section-6.6">6.6. </a><a class="section-name selfRef" href="#name-dns-stateful-operations-tlv">DNS Stateful Operations TLV Context Summary</a>
        </h3>
<p id="section-6.6-1">This document defines four new DSO TLVs. As recommended in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8490#section-8.2">Section 8.2</a> of the DNS Stateful
 Operations specification [<a class="xref" href="#RFC8490">RFC8490</a>]</span>, the valid contexts of these
        new TLV types are summarized below.<a class="pilcrow" href="#section-6.6-1">¶</a></p>
<p id="section-6.6-2">The client TLV contexts are:<a class="pilcrow" href="#section-6.6-2">¶</a></p>
<dl class="dlParallel dlCompact" id="section-6.6-3">
          <dt id="section-6.6-3.1">C-P:</dt>
<dd id="section-6.6-3.2">Client request message, Primary TLV<a class="pilcrow" href="#section-6.6-3.2">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-6.6-3.3">C-U:</dt>
<dd id="section-6.6-3.4">Client Unidirectional message, primary TLV<a class="pilcrow" href="#section-6.6-3.4">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-6.6-3.5">C-A:</dt>
<dd id="section-6.6-3.6">Client request or unidirectional message, Additional TLV<a class="pilcrow" href="#section-6.6-3.6">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-6.6-3.7">CRP:</dt>
<dd id="section-6.6-3.8">Response back to client, Primary TLV<a class="pilcrow" href="#section-6.6-3.8">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-6.6-3.9">CRA:</dt>
<dd id="section-6.6-3.10">Response back to client, Additional TLV<a class="pilcrow" href="#section-6.6-3.10">¶</a>
</dd>
<dd class="break"></dd>
</dl>
<span id="name-dso-tlv-client-context-summ"></span><div id="tlv_client_contexts">
<table class="center" id="table-2">
          <caption>
<a class="selfRef" href="#table-2">Table 2</a>:
<a class="selfRef" href="#name-dso-tlv-client-context-summ">DSO TLV Client Context Summary</a>
          </caption>
<thead>
            <tr>
              <th class="text-right" colspan="1" rowspan="1">TLV Type</th>
              <th class="text-center" colspan="1" rowspan="1">C-P</th>
              <th class="text-center" colspan="1" rowspan="1">C-U</th>
              <th class="text-center" colspan="1" rowspan="1">C-A</th>
              <th class="text-center" colspan="1" rowspan="1">CRP</th>
              <th class="text-center" colspan="1" rowspan="1">CRA</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">SUBSCRIBE</td>
              <td class="text-center" colspan="1" rowspan="1">X</td>
              <td class="text-center" colspan="1" rowspan="1"></td>
              <td class="text-center" colspan="1" rowspan="1"></td>
              <td class="text-center" colspan="1" rowspan="1"></td>
              <td class="text-center" colspan="1" rowspan="1"></td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">PUSH</td>
              <td class="text-center" colspan="1" rowspan="1"></td>
              <td class="text-center" colspan="1" rowspan="1"></td>
              <td class="text-center" colspan="1" rowspan="1"></td>
              <td class="text-center" colspan="1" rowspan="1"></td>
              <td class="text-center" colspan="1" rowspan="1"></td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">UNSUBSCRIBE</td>
              <td class="text-center" colspan="1" rowspan="1"></td>
              <td class="text-center" colspan="1" rowspan="1">X</td>
              <td class="text-center" colspan="1" rowspan="1"></td>
              <td class="text-center" colspan="1" rowspan="1"></td>
              <td class="text-center" colspan="1" rowspan="1"></td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">RECONFIRM</td>
              <td class="text-center" colspan="1" rowspan="1"></td>
              <td class="text-center" colspan="1" rowspan="1">X</td>
              <td class="text-center" colspan="1" rowspan="1"></td>
              <td class="text-center" colspan="1" rowspan="1"></td>
              <td class="text-center" colspan="1" rowspan="1"></td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-6.6-5">The server TLV contexts are:<a class="pilcrow" href="#section-6.6-5">¶</a></p>
<dl class="dlParallel dlCompact" id="section-6.6-6">
          <dt id="section-6.6-6.1">S-P:</dt>
<dd id="section-6.6-6.2">Server request message, Primary TLV<a class="pilcrow" href="#section-6.6-6.2">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-6.6-6.3">S-U:</dt>
<dd id="section-6.6-6.4">Server Unidirectional message, primary TLV<a class="pilcrow" href="#section-6.6-6.4">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-6.6-6.5">S-A:</dt>
<dd id="section-6.6-6.6">Server request or unidirectional message, Additional TLV<a class="pilcrow" href="#section-6.6-6.6">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-6.6-6.7">SRP:</dt>
<dd id="section-6.6-6.8">Response back to server, Primary TLV<a class="pilcrow" href="#section-6.6-6.8">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-6.6-6.9">SRA:</dt>
<dd id="section-6.6-6.10">Response back to server, Additional TLV<a class="pilcrow" href="#section-6.6-6.10">¶</a>
</dd>
<dd class="break"></dd>
</dl>
<span id="name-dso-tlv-server-context-summ"></span><div id="tlv_server_contexts">
<table class="center" id="table-3">
          <caption>
<a class="selfRef" href="#table-3">Table 3</a>:
<a class="selfRef" href="#name-dso-tlv-server-context-summ">DSO TLV Server Context Summary</a>
          </caption>
<thead>
            <tr>
              <th class="text-right" colspan="1" rowspan="1">TLV Type</th>
              <th class="text-center" colspan="1" rowspan="1">S-P</th>
              <th class="text-center" colspan="1" rowspan="1">S-U</th>
              <th class="text-center" colspan="1" rowspan="1">S-A</th>
              <th class="text-center" colspan="1" rowspan="1">SRP</th>
              <th class="text-center" colspan="1" rowspan="1">SRA</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">SUBSCRIBE</td>
              <td class="text-center" colspan="1" rowspan="1"></td>
              <td class="text-center" colspan="1" rowspan="1"></td>
              <td class="text-center" colspan="1" rowspan="1"></td>
              <td class="text-center" colspan="1" rowspan="1"></td>
              <td class="text-center" colspan="1" rowspan="1"></td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">PUSH</td>
              <td class="text-center" colspan="1" rowspan="1"></td>
              <td class="text-center" colspan="1" rowspan="1">X</td>
              <td class="text-center" colspan="1" rowspan="1"></td>
              <td class="text-center" colspan="1" rowspan="1"></td>
              <td class="text-center" colspan="1" rowspan="1"></td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">UNSUBSCRIBE</td>
              <td class="text-center" colspan="1" rowspan="1"></td>
              <td class="text-center" colspan="1" rowspan="1"></td>
              <td class="text-center" colspan="1" rowspan="1"></td>
              <td class="text-center" colspan="1" rowspan="1"></td>
              <td class="text-center" colspan="1" rowspan="1"></td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">RECONFIRM</td>
              <td class="text-center" colspan="1" rowspan="1"></td>
              <td class="text-center" colspan="1" rowspan="1"></td>
              <td class="text-center" colspan="1" rowspan="1"></td>
              <td class="text-center" colspan="1" rowspan="1"></td>
              <td class="text-center" colspan="1" rowspan="1"></td>
            </tr>
          </tbody>
        </table>
</div>
</section>
<section id="section-6.7">
        <h3 id="name-client-initiated-terminatio">
<a class="section-number selfRef" href="#section-6.7">6.7. </a><a class="section-name selfRef" href="#name-client-initiated-terminatio">Client-Initiated Termination</a>
        </h3>
<p id="section-6.7-1">An individual subscription is terminated by sending an UNSUBSCRIBE
        TLV for that specific subscription, or all subscriptions can be
        canceled at once by the client closing the DSO session. When a client
        terminates an individual subscription (via UNSUBSCRIBE) or all
        subscriptions on that DSO session (by ending the session), it is
        signaling to the server that it is no longer interested in receiving
        those particular updates. It is informing the server that the server
        may release any state information it has been keeping with regards to
        these particular subscriptions.<a class="pilcrow" href="#section-6.7-1">¶</a></p>
<p id="section-6.7-2">After terminating its last subscription on a session via
        UNSUBSCRIBE, a client <span class="bcp14">MAY</span> close the session immediately
        or it may keep it open if it anticipates performing further operations
        on that session in the future. If a client wishes to keep an idle
        session open, it <span class="bcp14">MUST</span> respect the maximum idle time
        required by the server <span>[<a class="xref" href="#RFC8490">RFC8490</a>]</span>.<a class="pilcrow" href="#section-6.7-2">¶</a></p>
<p id="section-6.7-3">If a client plans to terminate one or more subscriptions on a
        session and doesn't intend to keep that session open, then as an
        efficiency optimization, it <span class="bcp14">MAY</span> instead choose to
 simply
        close the session, which implicitly terminates all subscriptions on
        that session. This may occur because the client computer is being shut
        down, is going to sleep, the application requiring the subscriptions
        has terminated, or simply because the last active subscription on that
        session has been canceled.<a class="pilcrow" href="#section-6.7-3">¶</a></p>
<p id="section-6.7-4">When closing a session, a client should perform an orderly close of
        the TLS session.  Typical APIs will provide a session close method
        that will send a TLS close_notify alert as described in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8446#section-6.1">Section 6.1</a> of the TLS 1.3 specification [<a class="xref" href="#RFC8446">RFC8446</a>]</span>.
 This instructs the
        recipient that the sender will not send any more data over the
        session.  After sending the TLS close_notify alert, the client
        <span class="bcp14">MUST</span> gracefully close the underlying connection using a
        TCP FIN so that the TLS close_notify is reliably delivered.  The
        mechanisms for gracefully closing a TCP connection with a TCP FIN vary
        depending on the networking API.  For example, in the BSD Sockets API,
        sending a TCP FIN is achieved by calling "shutdown(s,SHUT_WR)" and
        keeping the socket open until all remaining data has been read from
        it.<a class="pilcrow" href="#section-6.7-4">¶</a></p>
<p id="section-6.7-5">If the session is forcibly closed at the TCP level by sending a
       RST from either end of the connection, data may be lost.<a class="pilcrow" href="#section-6.7-5">¶</a></p>
</section>
<div id="polling">
<section id="section-6.8">
        <h3 id="name-client-fallback-to-polling">
<a class="section-number selfRef" href="#section-6.8">6.8. </a><a class="section-name selfRef" href="#name-client-fallback-to-polling">Client Fallback to Polling</a>
        </h3>
<p id="section-6.8-1">There are cases where a client may exhaust all avenues for
        establishing a DNS Push Notification subscription without success.
        This can happen if the client's configured recursive resolver does not
        support DNS over TLS, or supports DNS over TLS but is not listening on
        TCP port 853, or supports DNS over TLS on TCP port 853 but does not
        support DSO on that port, or for some other reason is unable to
        provide a DNS Push Notification subscription.  In this case, the
 client
        will attempt to communicate directly with an appropriate server, and
        it may be that the zone apex discovery fails, or there is no
        <code>_dns‑push‑tls._tcp.&lt;zone&gt;</code> SRV record, or
        the server indicated in the SRV record is misconfigured, overloaded,
 or is
        unresponsive for some other reason.<a class="pilcrow" href="#section-6.8-1">¶</a></p>
<p id="section-6.8-2">Regardless of the reason for the failure, after being unable to
        establish the desired DNS Push Notification subscription, it is likely
        that the client will still wish to know the answer it seeks, even if
        that answer cannot be obtained with the timely change notifications
        provided by DNS Push Notifications.  In such cases, it is likely that
        the client will obtain the answer it seeks via a conventional DNS
        query instead, repeated at some interval to detect when the answer
        RRset changes.<a class="pilcrow" href="#section-6.8-2">¶</a></p>
<p id="section-6.8-3">In the case where a client responds to its failure to establish a
        DNS Push Notification subscription by falling back to polling with
        conventional DNS queries instead, the polling rate should be
        controlled to avoid placing excessive burden on the server.  The
        interval between successive DNS queries for the same name, type, and
        class <span class="bcp14">SHOULD</span> be at least the minimum of 900 seconds (15
        minutes) or two seconds more than the TTL of the answer RRset.<a class="pilcrow" href="#section-6.8-3">¶</a></p>
<p id="section-6.8-4">The reason that for TTLs up to 898 seconds the query should
        not be reissued until two seconds <em>after</em> the answer RRset has
        expired, is to ensure that the answer RRset has also expired from the
        cache on the client's configured recursive resolver.  Otherwise
        (particularly if the clocks on the client and the recursive resolver
        do not run at precisely the same rate), there's a risk of a race
        condition where the client queries its configured recursive resolver
        just as the answer RRset has one second remaining in the recursive
        resolver's cache.  The client would receive a reply telling it
        that the answer RRset has one second remaining; the client
        would then requery the recursive resolver again one second later.
        If by this time the answer RRset has actually expired from the
        recursive resolver's cache, the recursive resolver would then
        issue a new query to fetch fresh data from the
        authoritative server.  Waiting until the answer RRset has definitely
        expired from the cache on the client's configured recursive resolver
        avoids this race condition and any unnecessary additional queries it
        causes.<a class="pilcrow" href="#section-6.8-4">¶</a></p>
<p id="section-6.8-5">Each time a client is about to reissue its query to discover
        changes to the answer RRset, it should first make a new attempt to
        establish a DNS Push Notification subscription using previously
        cached DNS answers as appropriate.  After a temporary misconfiguration
        has been remedied, this allows a client that is polling to return to
        using DNS Push Notifications for asynchronous notification of
        changes.<a class="pilcrow" href="#section-6.8-5">¶</a></p>
</section>
</div>
</section>
<div id="Security">
<section id="section-7">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<p id="section-7-1">The Strict Privacy profile for DNS over TLS is
      <span class="bcp14">REQUIRED</span> for DNS Push Notifications <span>[<a class="xref" href="#RFC8310">RFC8310</a>]</span>. Cleartext connections for DNS Push
      Notifications are not permissible. Since this is a new protocol,
      transition mechanisms from the Opportunistic Privacy profile are
      unnecessary.<a class="pilcrow" href="#section-7-1">¶</a></p>
<p id="section-7-2">Also, see
      <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8310#section-9">Section 9</a> of the document Usage
      Profiles for DNS over (D)TLS [<a class="xref" href="#RFC8310">RFC8310</a>]</span>
      for additional
      recommendations for various versions of TLS usage.<a class="pilcrow" href="#section-7-2">¶</a></p>
<p id="section-7-3">As a consequence of requiring TLS, client certificate authentication
      and verification may also be enforced by the server for stronger
      client-server security or end-to-end security. However, recommendations
      for security in particular deployment scenarios are outside the scope of
      this document.<a class="pilcrow" href="#section-7-3">¶</a></p>
<p id="section-7-4">DNSSEC is <span class="bcp14">RECOMMENDED</span> for the authentication of DNS
      Push Notification servers.  TLS alone does not provide complete
      security.  TLS certificate verification can provide reasonable assurance
      that the client is really talking to the server associated with the
      desired host name, but since the desired host name is learned via a DNS
      SRV query, if the SRV query is subverted, then the client may have a
      secure connection to a rogue server.  DNSSEC can provide added
      confidence that the SRV query has not been subverted.<a class="pilcrow" href="#section-7-4">¶</a></p>
<section id="section-7.1">
        <h3 id="name-security-services">
<a class="section-number selfRef" href="#section-7.1">7.1. </a><a class="section-name selfRef" href="#name-security-services">Security Services</a>
        </h3>
<p id="section-7.1-1">It is the goal of using TLS to provide the following security
 services:<a class="pilcrow" href="#section-7.1-1">¶</a></p>
<dl class="dlParallel" id="section-7.1-2">
          <dt id="section-7.1-2.1">Confidentiality:</dt>
<dd id="section-7.1-2.2">All application-layer communication is encrypted with the goal
     that no party should be able to decrypt it except the intended
       receiver.<a class="pilcrow" href="#section-7.1-2.2">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-7.1-2.3">Data integrity protection:</dt>
<dd id="section-7.1-2.4">Any changes made to the communication in transit are detectable
     by the receiver.<a class="pilcrow" href="#section-7.1-2.4">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-7.1-2.5">Authentication:</dt>
<dd id="section-7.1-2.6">An endpoint of the TLS communication is authenticated as the
     intended entity to communicate with.<a class="pilcrow" href="#section-7.1-2.6">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-7.1-2.7">Anti-replay protection:</dt>
<dd id="section-7.1-2.8">TLS provides for the detection of and prevention
           against messages sent previously over a TLS connection (such as DNS
       Push Notifications).
           If prior messages are re-sent at a later time as a form of a
       man-in-the-middle attack,
           then the receiver will detect this and reject the replayed
      messages.<a class="pilcrow" href="#section-7.1-2.8">¶</a>
</dd>
<dd class="break"></dd>
</dl>
<p id="section-7.1-3">Deployment recommendations on the appropriate key lengths and
 cipher suites are beyond the scope of this document. Please refer to
 the current
 TLS Recommendations <span>[<a class="xref" href="#BCP195">BCP195</a>]</span>
 for the best current practices.
 Keep in mind that best practices only exist for a snapshot in time,
 and recommendations will continue to change.
 Updated versions or errata may exist for these recommendations.<a class="pilcrow" href="#section-7.1-3">¶</a></p>
</section>
<div id="tls_name_auth">
<section id="section-7.2">
        <h3 id="name-tls-name-authentication">
<a class="section-number selfRef" href="#section-7.2">7.2. </a><a class="section-name selfRef" href="#name-tls-name-authentication">TLS Name Authentication</a>
        </h3>
<p id="section-7.2-1">As described in <a class="xref" href="#discovery">Section 6.1</a>, the
        client discovers the DNS Push Notification server using an SRV lookup
        for the record name
        <code>_dns‑push‑tls._tcp.&lt;zone&gt;</code>. The server
        connection endpoint <span class="bcp14">SHOULD</span> then be authenticated using
        DANE TLSA records for the associated SRV record. This associates the
        target's name and port number with a trusted TLS certificate <span>[<a class="xref" href="#RFC7673">RFC7673</a>]</span>. This procedure uses the TLS
        Server Name Indication (SNI) extension <span>[<a class="xref" href="#RFC6066">RFC6066</a>]</span> to inform the server of the name the client has
        authenticated through the use of TLSA records. Therefore, if the SRV
        record passes DNSSEC validation and a TLSA record matching the target
        name is usable, an SNI extension must be used for the target name to
        ensure the client is connecting to the server it has authenticated. If
        the target name does not have a usable TLSA record, then the use of
        the SNI extension is optional. See Usage Profiles for DNS over TLS and
        DNS over DTLS <span>[<a class="xref" href="#RFC8310">RFC8310</a>]</span> for more
        information on authenticating domain names.<a class="pilcrow" href="#section-7.2-1">¶</a></p>
</section>
</div>
<div id="early_data">
<section id="section-7.3">
        <h3 id="name-tls-early-data">
<a class="section-number selfRef" href="#section-7.3">7.3. </a><a class="section-name selfRef" href="#name-tls-early-data">TLS Early Data</a>
        </h3>
<p id="section-7.3-1">DSO messages with the SUBSCRIBE TLV as the Primary TLV are
 permitted in TLS early data.
       Using TLS early data can save one network round trip and can result in
       the client obtaining results faster.<a class="pilcrow" href="#section-7.3-1">¶</a></p>
<p id="section-7.3-2">However, there are some factors to consider before using TLS early
 data.<a class="pilcrow" href="#section-7.3-2">¶</a></p>
<p id="section-7.3-3">TLS early data is not forward secret.
       In cases where forward secrecy of DNS Push Notification subscriptions
       is required,
       the client should not use TLS early data.<a class="pilcrow" href="#section-7.3-3">¶</a></p>
<p id="section-7.3-4">With TLS early data, there are no guarantees of non-replay between
 connections.
       If packets are duplicated and delayed in the network,
       the later arrivals could be mistaken for new subscription requests.
       Generally, this is not a major concern
       since the amount of state generated on the server for
       these spurious subscriptions is small and short lived
       since the TCP connection will not complete the three-way handshake.
       Servers <span class="bcp14">MAY</span> choose to implement rate-limiting measures
       that are activated when
       the server detects an excessive number of spurious subscription
       requests.<a class="pilcrow" href="#section-7.3-4">¶</a></p>
<p id="section-7.3-5">For further guidance on use of TLS early data, please see
 discussion of zero round-trip data
       in Sections <a class="relref" href="https://www.rfc-editor.org/rfc/rfc8446#section-2.3">2.3</a>
       and
       <a class="relref" href="https://www.rfc-editor.org/rfc/rfc8446#section-8">8</a>, and Appendix
       <a class="relref" href="https://www.rfc-editor.org/rfc/rfc8446#appendix-E.5">E.5</a>, of <span><a class="xref" href="#RFC8446">the TLS 1.3 specification</a> [<a class="xref" href="#RFC8446">RFC8446</a>]</span>.<a class="pilcrow" href="#section-7.3-5">¶</a></p>
</section>
</div>
<div id="resumption">
<section id="section-7.4">
        <h3 id="name-tls-session-resumption">
<a class="section-number selfRef" href="#section-7.4">7.4. </a><a class="section-name selfRef" href="#name-tls-session-resumption">TLS Session Resumption</a>
        </h3>
<p id="section-7.4-1">TLS session resumption <span>[<a class="xref" href="#RFC8446">RFC8446</a>]</span>
       is permissible on DNS Push Notification servers.
       However, closing the TLS connection terminates the DSO session.
       When the TLS session is resumed, the DNS Push Notification server will
       not
       have any subscription state and will proceed as with any other new DSO
       session.
       Use of TLS session resumption may allow a TLS connection to be set up
       more quickly,
       but the client will still have to recreate any desired
       subscriptions.<a class="pilcrow" href="#section-7.4-1">¶</a></p>
</section>
</div>
</section>
</div>
<div id="IANA">
<section id="section-8">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-8">8. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<p id="section-8-1">This document defines a new service name, only applicable for the TCP
      protocol,
     which has been recorded in the IANA "Service Name and Transport Protocol
      Port Number Registry" <span>[<a class="xref" href="#RFC6335">RFC6335</a>]</span> <span>[<a class="xref" href="#SRVTYPE">SRVTYPE</a>]</span>.<a class="pilcrow" href="#section-8-1">¶</a></p>
<span id="name-iana-service-type-assignmen"></span><div id="iana_service_table">
<table class="center" id="table-4">
        <caption>
<a class="selfRef" href="#table-4">Table 4</a>:
<a class="selfRef" href="#name-iana-service-type-assignmen">IANA Service Type Assignments</a>
        </caption>
<thead>
          <tr>
            <th class="text-left" colspan="1" rowspan="1">Name</th>
            <th class="text-center" colspan="1" rowspan="1">Port</th>
            <th class="text-center" colspan="1" rowspan="1">Value</th>
            <th class="text-center" colspan="1" rowspan="1">Section</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">DNS Push Notification Service Type</td>
            <td class="text-center" colspan="1" rowspan="1">None</td>
            <td class="text-center" colspan="1" rowspan="1">
              <code>_dns‑push‑tls._tcp</code>
</td>
            <td class="text-center" colspan="1" rowspan="1">
              <a class="xref" href="#discovery">6.1</a>
</td>
          </tr>
        </tbody>
      </table>
</div>
<p id="section-8-3">This document defines four new DNS Stateful Operation TLV types,
     which have been recorded in the IANA "DSO Type Codes" registry <span>[<a class="xref" href="#RFC8490">RFC8490</a>]</span> <span>[<a class="xref" href="#DSOTYPE">DSOTYPE</a>]</span>.<a class="pilcrow" href="#section-8-3">¶</a></p>
<span id="name-iana-dso-tlv-type-code-assi"></span><div id="iana_tlv_table">
<table class="center" id="table-5">
        <caption>
<a class="selfRef" href="#table-5">Table 5</a>:
<a class="selfRef" href="#name-iana-dso-tlv-type-code-assi">IANA DSO TLV Type Code Assignments</a>
        </caption>
<thead>
          <tr>
            <th class="text-left" colspan="1" rowspan="1">Name</th>
            <th class="text-center" colspan="1" rowspan="1">Value</th>
            <th class="text-center" colspan="1" rowspan="1">Early Data</th>
            <th class="text-center" colspan="1" rowspan="1">Status</th>
            <th class="text-center" colspan="1" rowspan="1">Section</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">SUBSCRIBE</td>
            <td class="text-center" colspan="1" rowspan="1">0x0040</td>
            <td class="text-center" colspan="1" rowspan="1">OK</td>
            <td class="text-center" colspan="1" rowspan="1">Standards Track</td>
            <td class="text-center" colspan="1" rowspan="1">
              <a class="xref" href="#subscribe">6.2</a>
</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">PUSH</td>
            <td class="text-center" colspan="1" rowspan="1">0x0041</td>
            <td class="text-center" colspan="1" rowspan="1">NO</td>
            <td class="text-center" colspan="1" rowspan="1">Standards Track</td>
            <td class="text-center" colspan="1" rowspan="1">
              <a class="xref" href="#push">6.3</a>
</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">UNSUBSCRIBE</td>
            <td class="text-center" colspan="1" rowspan="1">0x0042</td>
            <td class="text-center" colspan="1" rowspan="1">NO</td>
            <td class="text-center" colspan="1" rowspan="1">Standards Track</td>
            <td class="text-center" colspan="1" rowspan="1">
              <a class="xref" href="#unsubscribe">6.4</a>
</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">RECONFIRM</td>
            <td class="text-center" colspan="1" rowspan="1">0x0043</td>
            <td class="text-center" colspan="1" rowspan="1">NO</td>
            <td class="text-center" colspan="1" rowspan="1">Standards Track</td>
            <td class="text-center" colspan="1" rowspan="1">
              <a class="xref" href="#reconfirm">6.5</a>
</td>
          </tr>
        </tbody>
      </table>
</div>
<p id="section-8-5">This document defines no new DNS OPCODEs or RCODEs.<a class="pilcrow" href="#section-8-5">¶</a></p>
</section>
</div>
<section id="section-9">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-9">9. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-9.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-9.1">9.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="DSOTYPE">[DSOTYPE]</dt>
<dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Domain Name System (DNS) Parameters"</span>, <span>&lt;<a href="https://www.iana.org/assignments/dns-parameters/">https://www.iana.org/assignments/dns-parameters/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC0020">[RFC0020]</dt>
<dd>
<span class="refAuthor">Cerf, V.</span>, <span class="refTitle">"ASCII format for network interchange"</span>, <span class="seriesInfo">STD 80</span>, <span class="seriesInfo">RFC 20</span>, <span class="seriesInfo">DOI 10.17487/RFC0020</span>, <time datetime="1969-10">October 1969</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc20">https://www.rfc-editor.org/info/rfc20</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC0768">[RFC0768]</dt>
<dd>
<span class="refAuthor">Postel, J.</span>, <span class="refTitle">"User Datagram Protocol"</span>, <span class="seriesInfo">STD 6</span>, <span class="seriesInfo">RFC 768</span>, <span class="seriesInfo">DOI 10.17487/RFC0768</span>, <time datetime="1980-08">August 1980</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc768">https://www.rfc-editor.org/info/rfc768</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC0793">[RFC0793]</dt>
<dd>
<span class="refAuthor">Postel, J.</span>, <span class="refTitle">"Transmission Control Protocol"</span>, <span class="seriesInfo">STD 7</span>, <span class="seriesInfo">RFC 793</span>, <span class="seriesInfo">DOI 10.17487/RFC0793</span>, <time datetime="1981-09">September 1981</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc793">https://www.rfc-editor.org/info/rfc793</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1034">[RFC1034]</dt>
<dd>
<span class="refAuthor">Mockapetris, P.</span>, <span class="refTitle">"Domain names - concepts and facilities"</span>, <span class="seriesInfo">STD 13</span>, <span class="seriesInfo">RFC 1034</span>, <span class="seriesInfo">DOI 10.17487/RFC1034</span>, <time datetime="1987-11">November 1987</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1034">https://www.rfc-editor.org/info/rfc1034</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1035">[RFC1035]</dt>
<dd>
<span class="refAuthor">Mockapetris, P.</span>, <span class="refTitle">"Domain names - implementation and specification"</span>, <span class="seriesInfo">STD 13</span>, <span class="seriesInfo">RFC 1035</span>, <span class="seriesInfo">DOI 10.17487/RFC1035</span>, <time datetime="1987-11">November 1987</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1035">https://www.rfc-editor.org/info/rfc1035</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1123">[RFC1123]</dt>
<dd>
<span class="refAuthor">Braden, R., Ed.</span>, <span class="refTitle">"Requirements for Internet Hosts - Application and Support"</span>, <span class="seriesInfo">STD 3</span>, <span class="seriesInfo">RFC 1123</span>, <span class="seriesInfo">DOI 10.17487/RFC1123</span>, <time datetime="1989-10">October 1989</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1123">https://www.rfc-editor.org/info/rfc1123</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
<dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2136">[RFC2136]</dt>
<dd>
<span class="refAuthor">Vixie, P., Ed.</span><span class="refAuthor">, Thomson, S.</span><span class="refAuthor">, Rekhter, Y.</span><span class="refAuthor">, and J. Bound</span>, <span class="refTitle">"Dynamic Updates in the Domain Name System (DNS UPDATE)"</span>, <span class="seriesInfo">RFC 2136</span>, <span class="seriesInfo">DOI 10.17487/RFC2136</span>, <time datetime="1997-04">April 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2136">https://www.rfc-editor.org/info/rfc2136</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2181">[RFC2181]</dt>
<dd>
<span class="refAuthor">Elz, R.</span><span class="refAuthor"> and R. Bush</span>, <span class="refTitle">"Clarifications to the DNS Specification"</span>, <span class="seriesInfo">RFC 2181</span>, <span class="seriesInfo">DOI 10.17487/RFC2181</span>, <time datetime="1997-07">July 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2181">https://www.rfc-editor.org/info/rfc2181</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2782">[RFC2782]</dt>
<dd>
<span class="refAuthor">Gulbrandsen, A.</span><span class="refAuthor">, Vixie, P.</span><span class="refAuthor">, and L. Esibov</span>, <span class="refTitle">"A DNS RR for specifying the location of services (DNS SRV)"</span>, <span class="seriesInfo">RFC 2782</span>, <span class="seriesInfo">DOI 10.17487/RFC2782</span>, <time datetime="2000-02">February 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2782">https://www.rfc-editor.org/info/rfc2782</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6066">[RFC6066]</dt>
<dd>
<span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refTitle">"Transport Layer Security (TLS) Extensions: Extension Definitions"</span>, <span class="seriesInfo">RFC 6066</span>, <span class="seriesInfo">DOI 10.17487/RFC6066</span>, <time datetime="2011-01">January 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6066">https://www.rfc-editor.org/info/rfc6066</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6335">[RFC6335]</dt>
<dd>
<span class="refAuthor">Cotton, M.</span><span class="refAuthor">, Eggert, L.</span><span class="refAuthor">, Touch, J.</span><span class="refAuthor">, Westerlund, M.</span><span class="refAuthor">, and S. Cheshire</span>, <span class="refTitle">"Internet Assigned Numbers Authority (IANA) Procedures for the Management of the Service Name and Transport Protocol Port Number Registry"</span>, <span class="seriesInfo">BCP 165</span>, <span class="seriesInfo">RFC 6335</span>, <span class="seriesInfo">DOI 10.17487/RFC6335</span>, <time datetime="2011-08">August 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6335">https://www.rfc-editor.org/info/rfc6335</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6895">[RFC6895]</dt>
<dd>
<span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refTitle">"Domain Name System (DNS) IANA Considerations"</span>, <span class="seriesInfo">BCP 42</span>, <span class="seriesInfo">RFC 6895</span>, <span class="seriesInfo">DOI 10.17487/RFC6895</span>, <time datetime="2013-04">April 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6895">https://www.rfc-editor.org/info/rfc6895</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7673">[RFC7673]</dt>
<dd>
<span class="refAuthor">Finch, T.</span><span class="refAuthor">, Miller, M.</span><span class="refAuthor">, and P. Saint-Andre</span>, <span class="refTitle">"Using DNS-Based Authentication of Named Entities (DANE) TLSA Records with SRV Records"</span>, <span class="seriesInfo">RFC 7673</span>, <span class="seriesInfo">DOI 10.17487/RFC7673</span>, <time datetime="2015-10">October 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7673">https://www.rfc-editor.org/info/rfc7673</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7766">[RFC7766]</dt>
<dd>
<span class="refAuthor">Dickinson, J.</span><span class="refAuthor">, Dickinson, S.</span><span class="refAuthor">, Bellis, R.</span><span class="refAuthor">, Mankin, A.</span><span class="refAuthor">, and D. Wessels</span>, <span class="refTitle">"DNS Transport over TCP - Implementation Requirements"</span>, <span class="seriesInfo">RFC 7766</span>, <span class="seriesInfo">DOI 10.17487/RFC7766</span>, <time datetime="2016-03">March 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7766">https://www.rfc-editor.org/info/rfc7766</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7858">[RFC7858]</dt>
<dd>
<span class="refAuthor">Hu, Z.</span><span class="refAuthor">, Zhu, L.</span><span class="refAuthor">, Heidemann, J.</span><span class="refAuthor">, Mankin, A.</span><span class="refAuthor">, Wessels, D.</span><span class="refAuthor">, and P. Hoffman</span>, <span class="refTitle">"Specification for DNS over Transport Layer Security (TLS)"</span>, <span class="seriesInfo">RFC 7858</span>, <span class="seriesInfo">DOI 10.17487/RFC7858</span>, <time datetime="2016-05">May 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7858">https://www.rfc-editor.org/info/rfc7858</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
<dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8310">[RFC8310]</dt>
<dd>
<span class="refAuthor">Dickinson, S.</span><span class="refAuthor">, Gillmor, D.</span><span class="refAuthor">, and T. Reddy</span>, <span class="refTitle">"Usage Profiles for DNS over TLS and DNS over DTLS"</span>, <span class="seriesInfo">RFC 8310</span>, <span class="seriesInfo">DOI 10.17487/RFC8310</span>, <time datetime="2018-03">March 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8310">https://www.rfc-editor.org/info/rfc8310</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
<dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8490">[RFC8490]</dt>
<dd>
<span class="refAuthor">Bellis, R.</span><span class="refAuthor">, Cheshire, S.</span><span class="refAuthor">, Dickinson, J.</span><span class="refAuthor">, Dickinson, S.</span><span class="refAuthor">, Lemon, T.</span><span class="refAuthor">, and T. Pusateri</span>, <span class="refTitle">"DNS Stateful Operations"</span>, <span class="seriesInfo">RFC 8490</span>, <span class="seriesInfo">DOI 10.17487/RFC8490</span>, <time datetime="2019-03">March 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8490">https://www.rfc-editor.org/info/rfc8490</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SRVTYPE">[SRVTYPE]</dt>
<dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Service Name and Transport Protocol Port Number Registry"</span>, <span>&lt;<a href="https://www.iana.org/assignments/service-names-port-numbers/">https://www.iana.org/assignments/service-names-port-numbers/</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-9.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-9.2">9.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="BCP195">[BCP195]</dt>
<dd>
<span class="refAuthor">Sheffer, Y.</span><span class="refAuthor">, Holz, R.</span><span class="refAuthor">, and P. Saint-Andre</span>, <span class="refTitle">"Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"</span>, <span class="seriesInfo">BCP 195</span>, <span class="seriesInfo">RFC 7525</span>, <time datetime="2015-05">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/bcp195">https://www.rfc-editor.org/info/bcp195</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OBS">[OBS]</dt>
<dd>
<span class="refAuthor">Wikipedia</span>, <span class="refTitle">"Observer pattern"</span>, <time datetime="2020-02">February 2020</time>, <span>&lt;<a href="https://en.wikipedia.org/w/index.php?title=Observer_pattern&amp;oldid=939702131">https://en.wikipedia.org/w/index.php?title=Observer_pattern&amp;oldid=939702131</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2308">[RFC2308]</dt>
<dd>
<span class="refAuthor">Andrews, M.</span>, <span class="refTitle">"Negative Caching of DNS Queries (DNS NCACHE)"</span>, <span class="seriesInfo">RFC 2308</span>, <span class="seriesInfo">DOI 10.17487/RFC2308</span>, <time datetime="1998-03">March 1998</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2308">https://www.rfc-editor.org/info/rfc2308</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3123">[RFC3123]</dt>
<dd>
<span class="refAuthor">Koch, P.</span>, <span class="refTitle">"A DNS RR Type for Lists of Address Prefixes (APL RR)"</span>, <span class="seriesInfo">RFC 3123</span>, <span class="seriesInfo">DOI 10.17487/RFC3123</span>, <time datetime="2001-06">June 2001</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3123">https://www.rfc-editor.org/info/rfc3123</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4287">[RFC4287]</dt>
<dd>
<span class="refAuthor">Nottingham, M., Ed.</span><span class="refAuthor"> and R. Sayre, Ed.</span>, <span class="refTitle">"The Atom Syndication Format"</span>, <span class="seriesInfo">RFC 4287</span>, <span class="seriesInfo">DOI 10.17487/RFC4287</span>, <time datetime="2005-12">December 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4287">https://www.rfc-editor.org/info/rfc4287</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4953">[RFC4953]</dt>
<dd>
<span class="refAuthor">Touch, J.</span>, <span class="refTitle">"Defending TCP Against Spoofing Attacks"</span>, <span class="seriesInfo">RFC 4953</span>, <span class="seriesInfo">DOI 10.17487/RFC4953</span>, <time datetime="2007-07">July 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4953">https://www.rfc-editor.org/info/rfc4953</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6281">[RFC6281]</dt>
<dd>
<span class="refAuthor">Cheshire, S.</span><span class="refAuthor">, Zhu, Z.</span><span class="refAuthor">, Wakikawa, R.</span><span class="refAuthor">, and L. Zhang</span>, <span class="refTitle">"Understanding Apple's Back to My Mac (BTMM) Service"</span>, <span class="seriesInfo">RFC 6281</span>, <span class="seriesInfo">DOI 10.17487/RFC6281</span>, <time datetime="2011-06">June 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6281">https://www.rfc-editor.org/info/rfc6281</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6762">[RFC6762]</dt>
<dd>
<span class="refAuthor">Cheshire, S.</span><span class="refAuthor"> and M. Krochmal</span>, <span class="refTitle">"Multicast DNS"</span>, <span class="seriesInfo">RFC 6762</span>, <span class="seriesInfo">DOI 10.17487/RFC6762</span>, <time datetime="2013-02">February 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6762">https://www.rfc-editor.org/info/rfc6762</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6763">[RFC6763]</dt>
<dd>
<span class="refAuthor">Cheshire, S.</span><span class="refAuthor"> and M. Krochmal</span>, <span class="refTitle">"DNS-Based Service Discovery"</span>, <span class="seriesInfo">RFC 6763</span>, <span class="seriesInfo">DOI 10.17487/RFC6763</span>, <time datetime="2013-02">February 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6763">https://www.rfc-editor.org/info/rfc6763</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6886">[RFC6886]</dt>
<dd>
<span class="refAuthor">Cheshire, S.</span><span class="refAuthor"> and M. Krochmal</span>, <span class="refTitle">"NAT Port Mapping Protocol (NAT-PMP)"</span>, <span class="seriesInfo">RFC 6886</span>, <span class="seriesInfo">DOI 10.17487/RFC6886</span>, <time datetime="2013-04">April 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6886">https://www.rfc-editor.org/info/rfc6886</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6887">[RFC6887]</dt>
<dd>
<span class="refAuthor">Wing, D., Ed.</span><span class="refAuthor">, Cheshire, S.</span><span class="refAuthor">, Boucadair, M.</span><span class="refAuthor">, Penno, R.</span><span class="refAuthor">, and P. Selkirk</span>, <span class="refTitle">"Port Control Protocol (PCP)"</span>, <span class="seriesInfo">RFC 6887</span>, <span class="seriesInfo">DOI 10.17487/RFC6887</span>, <time datetime="2013-04">April 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6887">https://www.rfc-editor.org/info/rfc6887</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7413">[RFC7413]</dt>
<dd>
<span class="refAuthor">Cheng, Y.</span><span class="refAuthor">, Chu, J.</span><span class="refAuthor">, Radhakrishnan, S.</span><span class="refAuthor">, and A. Jain</span>, <span class="refTitle">"TCP Fast Open"</span>, <span class="seriesInfo">RFC 7413</span>, <span class="seriesInfo">DOI 10.17487/RFC7413</span>, <time datetime="2014-12">December 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7413">https://www.rfc-editor.org/info/rfc7413</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8010">[RFC8010]</dt>
<dd>
<span class="refAuthor">Sweet, M.</span><span class="refAuthor"> and I. McDonald</span>, <span class="refTitle">"Internet Printing Protocol/1.1: Encoding and Transport"</span>, <span class="seriesInfo">STD 92</span>, <span class="seriesInfo">RFC 8010</span>, <span class="seriesInfo">DOI 10.17487/RFC8010</span>, <time datetime="2017-01">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8010">https://www.rfc-editor.org/info/rfc8010</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8011">[RFC8011]</dt>
<dd>
<span class="refAuthor">Sweet, M.</span><span class="refAuthor"> and I. McDonald</span>, <span class="refTitle">"Internet Printing Protocol/1.1: Model and Semantics"</span>, <span class="seriesInfo">STD 92</span>, <span class="seriesInfo">RFC 8011</span>, <span class="seriesInfo">DOI 10.17487/RFC8011</span>, <time datetime="2017-01">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8011">https://www.rfc-editor.org/info/rfc8011</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8499">[RFC8499]</dt>
<dd>
<span class="refAuthor">Hoffman, P.</span><span class="refAuthor">, Sullivan, A.</span><span class="refAuthor">, and K. Fujiwara</span>, <span class="refTitle">"DNS Terminology"</span>, <span class="seriesInfo">BCP 219</span>, <span class="seriesInfo">RFC 8499</span>, <span class="seriesInfo">DOI 10.17487/RFC8499</span>, <time datetime="2019-01">January 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8499">https://www.rfc-editor.org/info/rfc8499</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8684">[RFC8684]</dt>
<dd>
<span class="refAuthor">Ford, A.</span><span class="refAuthor">, Raiciu, C.</span><span class="refAuthor">, Handley, M.</span><span class="refAuthor">, Bonaventure, O.</span><span class="refAuthor">, and C. Paasch</span>, <span class="refTitle">"TCP Extensions for Multipath Operation with Multiple Addresses"</span>, <span class="seriesInfo">RFC 8684</span>, <span class="seriesInfo">DOI 10.17487/RFC8684</span>, <time datetime="2020-03">March 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8684">https://www.rfc-editor.org/info/rfc8684</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8764">[RFC8764]</dt>
<dd>
<span class="refAuthor">Cheshire, S.</span><span class="refAuthor"> and M. Krochmal</span>, <span class="refTitle">"Apple's DNS Long-Lived Queries Protocol"</span>, <span class="seriesInfo">RFC 8764</span>, <span class="seriesInfo">DOI 10.17487/RFC8764</span>, <time datetime="2020-06">June 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8764">https://www.rfc-editor.org/info/rfc8764</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8766">[RFC8766]</dt>
<dd>
<span class="refAuthor">Cheshire, S.</span>, <span class="refTitle">"Discovery Proxy for Multicast DNS-Based Service Discovery"</span>, <span class="seriesInfo">RFC 8766</span>, <span class="seriesInfo">DOI 10.17487/RFC8766</span>, <time datetime="2020-06">June 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8766">https://www.rfc-editor.org/info/rfc8766</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SD-API">[SD-API]</dt>
<dd>
<span class="refAuthor">Apple Inc.</span>, <span class="refTitle">"dns_sd.h"</span>, <span>&lt;<a href="https://opensource.apple.com/source/mDNSResponder/mDNSResponder-878.70.2/mDNSShared/dns_sd.h.auto.html">https://opensource.apple.com/source/mDNSResponder/mDNSResponder-878.70.2/mDNSShared/dns_sd.h.auto.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SYN">[SYN]</dt>
<dd>
<span class="refAuthor">Eddy, W.</span>, <span class="refTitle">"Defenses Against TCP SYN Flooding Attacks"</span>, <span class="refContent">The Internet Protocol Journal</span>, <span class="refContent">Cisco Systems</span>, <span class="refContent">Volume 9</span>, <span class="refContent">Number 4</span>, <time datetime="2006-12">December 2006</time>, <span>&lt;<a href="https://www.cisco.com/web/about/ac123/ac147/archived_issues/ipj_9-4/ipj_9-4.pdf">https://www.cisco.com/web/about/ac123/ac147/archived_issues/ipj_9-4/ipj_9-4.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-tcpm-rack">[TCPRACK]</dt>
<dd>
<span class="refAuthor">Cheng, Y.</span><span class="refAuthor">, Cardwell, N.</span><span class="refAuthor">, Dukkipati, N.</span><span class="refAuthor">, and P. Jha</span>, <span class="refTitle">"RACK: a time-based fast loss detection algorithm for TCP"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-tcpm-rack-08</span>, <time datetime="2020-03-09">9 March 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-tcpm-rack-08">https://tools.ietf.org/html/draft-ietf-tcpm-rack-08</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="XEP0060">[XEP0060]</dt>
<dd>
<span class="refAuthor">Millard, P.</span><span class="refAuthor">, Saint-Andre, P.</span><span class="refAuthor">, and R. Meijer</span>, <span class="refTitle">"Publish-Subscribe"</span>, <span class="refContent">XSF XEP 0060
</span>, <time datetime="2019-10">October 2019</time>, <span>&lt;<a href="https://xmpp.org/extensions/xep-0060.html">https://xmpp.org/extensions/xep-0060.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="Acknowledgments">
<section id="section-appendix.a">
      <h2 id="name-acknowledgments">
<a class="section-name selfRef" href="#name-acknowledgments">Acknowledgments</a>
      </h2>
<p id="section-appendix.a-1">The authors would like to thank <span class="contact-name">Kiren Sekar</span> and
      <span class="contact-name">Marc Krochmal</span> for previous work completed in this
      field.<a class="pilcrow" href="#section-appendix.a-1">¶</a></p>
<p id="section-appendix.a-2">This document has been improved due to comments from
     <span class="contact-name">Ran Atkinson</span>,
     <span class="contact-name">Tim Chown</span>,
     <span class="contact-name">Sara Dickinson</span>,
     <span class="contact-name">Mark Delany</span>,
     <span class="contact-name">Ralph Droms</span>,
     <span class="contact-name">Jan Komissar</span>,
     <span class="contact-name">Eric Rescorla</span>,
     <span class="contact-name">Michael Richardson</span>,
     <span class="contact-name">David Schinazi</span>,
     <span class="contact-name">Manju Shankar Rao</span>,
     <span class="contact-name">Robert Sparks</span>,
     <span class="contact-name">Markus Stenberg</span>,
     <span class="contact-name">Andrew Sullivan</span>,
     <span class="contact-name">Michael Sweet</span>,
     <span class="contact-name">Dave Thaler</span>,
     <span class="contact-name">Brian Trammell</span>,
     <span class="contact-name">Bernie Volz</span>,
     <span class="contact-name">Éric Vyncke</span>,
     <span class="contact-name">Christopher Wood</span>,
     <span class="contact-name">Liang Xia</span>,
     and
     <span class="contact-name">Soraia Zlatkovic</span>.
     <span class="contact-name">Ted Lemon</span> provided clarifying text that was greatly
      appreciated.<a class="pilcrow" href="#section-appendix.a-2">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="section-appendix.b">
      <h2 id="name-authors-addresses">
<a class="section-name selfRef" href="#name-authors-addresses">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Tom Pusateri</span></div>
<div class="left" dir="auto"><span class="org">Unaffiliated</span></div>
<div class="left" dir="auto">
<span class="locality">Raleigh</span>, <span class="region">NC</span> <span class="postal-code">27608</span>
</div>
<div class="left" dir="auto"><span class="country-name">United States of America</span></div>
<div class="tel">
<span>Phone:</span>
<a class="tel" href="tel:+1%20919%20867%201330">+1 919 867 1330</a>
</div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:pusateri@bangj.com">pusateri@bangj.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Stuart Cheshire</span></div>
<div class="left" dir="auto"><span class="org">Apple Inc.</span></div>
<div class="left" dir="auto"><span class="street-address">One Apple Park Way</span></div>
<div class="left" dir="auto">
<span class="locality">Cupertino</span>, <span class="region">CA</span> <span class="postal-code">95014</span>
</div>
<div class="left" dir="auto"><span class="country-name">United States of America</span></div>
<div class="tel">
<span>Phone:</span>
<a class="tel" href="tel:+1%20(408)%20996-1010">+1 (408) 996-1010</a>
</div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:cheshire@apple.com">cheshire@apple.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>