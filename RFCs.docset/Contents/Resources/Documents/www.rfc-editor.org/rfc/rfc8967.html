<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 8967: MAC Authentication for the Babel Routing Protocol</title>
<meta content="Clara Dô" name="author"/>
<meta content="Weronika Kolodziejak" name="author"/>
<meta content="Juliusz Chroboczek" name="author"/>
<meta content="
       This document describes a cryptographic authentication mechanism for
the Babel routing protocol that has provisions for replay avoidance.  This
document obsoletes RFC 7298. 
    " name="description"/>
<meta content="xml2rfc 3.5.0" name="generator"/>
<meta content="routing protocol" name="keyword"/>
<meta content="authentication" name="keyword"/>
<meta content="replay" name="keyword"/>
<meta content="replay protection" name="keyword"/>
<meta content="8967" name="rfc.number"/>
<!-- Generator version information:
  xml2rfc 3.5.0
    Python 3.6.10
    appdirs 1.4.4
    ConfigArgParse 1.2.3
    google-i18n-address 2.3.5
    html5lib 1.0.1
    intervaltree 3.0.2
    Jinja2 2.11.2
    kitchen 1.2.6
    lxml 4.4.2
    pycairo 1.19.0
    pycountry 19.8.18
    pyflakes 2.1.1
    PyYAML 5.3.1
    requests 2.22.0
    setuptools 40.6.2
    six 1.14.0
    WeasyPrint 51
-->
<link href="rfc8967.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://dx.doi.org/10.17487/rfc8967" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <link href="https://datatracker.ietf.org/doc/draft-ietf-babel-hmac-12" rel="prev"/>
  </head>
<body>
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 8967</td>
<td class="center">MAC Authentication for Babel</td>
<td class="right">January 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Dô, et al.</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc8967">8967</a></dd>
<dt class="label-obsoletes">Obsoletes:</dt>
<dd class="obsoletes">
<a class="eref" href="https://www.rfc-editor.org/rfc/rfc7298">7298</a> </dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2021-01">January 2021</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">C. Dô</div>
<div class="org">IRIF, University of Paris-Diderot</div>
</div>
<div class="author">
      <div class="author-name">W. Kolodziejak</div>
<div class="org">IRIF, University of Paris-Diderot</div>
</div>
<div class="author">
      <div class="author-name">J. Chroboczek</div>
<div class="org">IRIF, University of Paris-Diderot</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 8967</h1>
<h1 id="title">MAC Authentication for the Babel Routing Protocol</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">This document describes a cryptographic authentication mechanism for
the Babel routing protocol that has provisions for replay avoidance.  This
document obsoletes RFC 7298.<a class="pilcrow" href="#section-abstract-1">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a class="pilcrow" href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc8967">https://www.rfc-editor.org/info/rfc8967</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">▲</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a class="xref" href="#section-1">1</a>.  <a class="xref" href="#name-introduction">Introduction</a><a class="pilcrow" href="#section-toc.1-1.1.1">¶</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.1.2.1">
                <p class="keepWithNext" id="section-toc.1-1.1.2.1.1"><a class="xref" href="#section-1.1">1.1</a>.  <a class="xref" href="#name-applicability">Applicability</a><a class="pilcrow" href="#section-toc.1-1.1.2.1.1">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.1.2.2">
                <p class="keepWithNext" id="section-toc.1-1.1.2.2.1"><a class="xref" href="#section-1.2">1.2</a>.  <a class="xref" href="#name-assumptions-and-security-pr">Assumptions and Security Properties</a><a class="pilcrow" href="#section-toc.1-1.1.2.2.1">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.1.2.3">
                <p class="keepWithNext" id="section-toc.1-1.1.2.3.1"><a class="xref" href="#section-1.3">1.3</a>.  <a class="xref" href="#name-specification-of-requiremen">Specification of Requirements</a><a class="pilcrow" href="#section-toc.1-1.1.2.3.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a class="xref" href="#section-2">2</a>.  <a class="xref" href="#name-conceptual-overview-of-the-">Conceptual Overview of the Protocol</a><a class="pilcrow" href="#section-toc.1-1.2.1">¶</a></p>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a class="xref" href="#section-3">3</a>.  <a class="xref" href="#name-data-structures">Data Structures</a><a class="pilcrow" href="#section-toc.1-1.3.1">¶</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a class="xref" href="#section-3.1">3.1</a>.  <a class="xref" href="#name-the-interface-table">The Interface Table</a><a class="pilcrow" href="#section-toc.1-1.3.2.1.1">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a class="xref" href="#section-3.2">3.2</a>.  <a class="xref" href="#name-the-neighbour-table">The Neighbour Table</a><a class="pilcrow" href="#section-toc.1-1.3.2.2.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="xref" href="#section-4">4</a>.  <a class="xref" href="#name-protocol-operation">Protocol Operation</a><a class="pilcrow" href="#section-toc.1-1.4.1">¶</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a class="xref" href="#section-4.1">4.1</a>.  <a class="xref" href="#name-mac-computation">MAC Computation</a><a class="pilcrow" href="#section-toc.1-1.4.2.1.1">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a class="xref" href="#section-4.2">4.2</a>.  <a class="xref" href="#name-packet-transmission">Packet Transmission</a><a class="pilcrow" href="#section-toc.1-1.4.2.2.1">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a class="xref" href="#section-4.3">4.3</a>.  <a class="xref" href="#name-packet-reception">Packet Reception</a><a class="pilcrow" href="#section-toc.1-1.4.2.3.1">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a class="xref" href="#section-4.4">4.4</a>.  <a class="xref" href="#name-expiring-per-neighbour-stat">Expiring Per-Neighbour State</a><a class="pilcrow" href="#section-toc.1-1.4.2.4.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="xref" href="#section-5">5</a>.  <a class="xref" href="#name-incremental-deployment-and-">Incremental Deployment and Key Rotation</a><a class="pilcrow" href="#section-toc.1-1.5.1">¶</a></p>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="xref" href="#section-6">6</a>.  <a class="xref" href="#name-packet-format">Packet Format</a><a class="pilcrow" href="#section-toc.1-1.6.1">¶</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a class="xref" href="#section-6.1">6.1</a>.  <a class="xref" href="#name-mac-tlv">MAC TLV</a><a class="pilcrow" href="#section-toc.1-1.6.2.1.1">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a class="xref" href="#section-6.2">6.2</a>.  <a class="xref" href="#name-pc-tlv">PC TLV</a><a class="pilcrow" href="#section-toc.1-1.6.2.2.1">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a class="xref" href="#section-6.3">6.3</a>.  <a class="xref" href="#name-challenge-request-tlv">Challenge Request TLV</a><a class="pilcrow" href="#section-toc.1-1.6.2.3.1">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a class="xref" href="#section-6.4">6.4</a>.  <a class="xref" href="#name-challenge-reply-tlv">Challenge Reply TLV</a><a class="pilcrow" href="#section-toc.1-1.6.2.4.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="xref" href="#section-7">7</a>.  <a class="xref" href="#name-security-considerations">Security Considerations</a><a class="pilcrow" href="#section-toc.1-1.7.1">¶</a></p>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="xref" href="#section-8">8</a>.  <a class="xref" href="#name-iana-considerations">IANA Considerations</a><a class="pilcrow" href="#section-toc.1-1.8.1">¶</a></p>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="xref" href="#section-9">9</a>.  <a class="xref" href="#name-references">References</a><a class="pilcrow" href="#section-toc.1-1.9.1">¶</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a class="xref" href="#section-9.1">9.1</a>.  <a class="xref" href="#name-normative-references">Normative References</a><a class="pilcrow" href="#section-toc.1-1.9.2.1.1">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a class="xref" href="#section-9.2">9.2</a>.  <a class="xref" href="#name-informational-references">Informational References</a><a class="pilcrow" href="#section-toc.1-1.9.2.2.1">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a class="xref" href="#section-appendix.a"></a><a class="xref" href="#name-acknowledgments">Acknowledgments</a><a class="pilcrow" href="#section-toc.1-1.10.1">¶</a></p>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a class="xref" href="#section-appendix.b"></a><a class="xref" href="#name-authors-addresses">Authors' Addresses</a><a class="pilcrow" href="#section-toc.1-1.11.1">¶</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">By default, the Babel routing protocol <span>[<a class="xref" href="#RFC8966">RFC8966</a>]</span>
trusts the information contained
in every UDP datagram that it receives on the Babel port.  An attacker can
redirect traffic to itself or to a different node in the network, causing
a variety of potential issues.  In particular, an attacker might:<a class="pilcrow" href="#section-1-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-2.1">spoof a Babel packet and redirect traffic by announcing a route with
a smaller metric, a larger sequence number, or a longer prefix;<a class="pilcrow" href="#section-1-2.1">¶</a>
</li>
        <li class="normal" id="section-1-2.2">spoof a malformed packet, which could cause an insufficiently robust
implementation to crash or interfere with the rest of the network;<a class="pilcrow" href="#section-1-2.2">¶</a>
</li>
        <li class="normal" id="section-1-2.3">replay a previously captured Babel packet, which could cause traffic to
be redirected or otherwise interfere with the network.<a class="pilcrow" href="#section-1-2.3">¶</a>
</li>
      </ul>
<p id="section-1-3">Protecting a Babel network is challenging due to the fact that the
Babel protocol uses both unicast and multicast communication.  One
possible approach, used notably by the Babel over Datagram Transport Layer
Security (DTLS) protocol <span>[<a class="xref" href="#RFC8968">RFC8968</a>]</span>, is to use
unicast communication for all semantically significant communication, and
then use a standard unicast security protocol to protect the Babel
traffic.  In this document, we take the opposite approach: we define
a cryptographic extension to the Babel protocol that is able to protect
both unicast and multicast traffic and thus requires very few changes to
the core protocol.  This document obsoletes <span>[<a class="xref" href="#RFC7298">RFC7298</a>]</span>.<a class="pilcrow" href="#section-1-3">¶</a></p>
<section id="section-1.1">
        <h3 id="name-applicability">
<a class="section-number selfRef" href="#section-1.1">1.1. </a><a class="section-name selfRef" href="#name-applicability">Applicability</a>
        </h3>
<p id="section-1.1-1">The protocol defined in this document assumes that all interfaces on
a given link are equally trusted and share a small set of symmetric keys
(usually just one, and two during key rotation).  The protocol is inapplicable
in situations where asymmetric keying is required, where the trust
relationship is partial, or where large numbers of trusted keys are
provisioned on a single link at the same time.<a class="pilcrow" href="#section-1.1-1">¶</a></p>
<p id="section-1.1-2">This protocol supports incremental deployment (where an insecure Babel
network is made secure with no service interruption), and it supports
graceful key rotation (where the set of keys is changed with no service
interruption).<a class="pilcrow" href="#section-1.1-2">¶</a></p>
<p id="section-1.1-3">This protocol does not require synchronised clocks, it does not require
persistently monotonic clocks, and it does not require persistent storage
except for what might be required for storing cryptographic keys.<a class="pilcrow" href="#section-1.1-3">¶</a></p>
</section>
<div id="security-properties">
<section id="section-1.2">
        <h3 id="name-assumptions-and-security-pr">
<a class="section-number selfRef" href="#section-1.2">1.2. </a><a class="section-name selfRef" href="#name-assumptions-and-security-pr">Assumptions and Security Properties</a>
        </h3>
<p id="section-1.2-1">The correctness of the protocol relies on the following assumptions:<a class="pilcrow" href="#section-1.2-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.2-2.1">that the Message Authentication Code (MAC) being used is invulnerable
to forgery, i.e., that an attacker is unable to generate a packet with
a correct MAC without access to the secret key;<a class="pilcrow" href="#section-1.2-2.1">¶</a>
</li>
          <li class="normal" id="section-1.2-2.2">that a node never generates the same index or nonce twice over the
lifetime of a key.<a class="pilcrow" href="#section-1.2-2.2">¶</a>
</li>
        </ul>
<p id="section-1.2-3">
The first assumption is a property of the MAC being used.  The second
assumption can be met either by using a robust random number generator
<span>[<a class="xref" href="#RFC4086">RFC4086</a>]</span> and sufficiently large indices and nonces, by
using a reliable hardware clock, or by rekeying often enough that
collisions are unlikely.<a class="pilcrow" href="#section-1.2-3">¶</a></p>
<p id="section-1.2-4">If the assumptions above are met, the protocol described in this
document has the following properties:<a class="pilcrow" href="#section-1.2-4">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.2-5.1">it is invulnerable to spoofing: any Babel packet accepted as authentic
is the exact copy of a packet originally sent by an authorised node;<a class="pilcrow" href="#section-1.2-5.1">¶</a>
</li>
          <li class="normal" id="section-1.2-5.2">locally to a single node, it is invulnerable to replay: if a node has
previously accepted a given packet, then it will never again accept a copy
of this packet or an earlier packet from the same sender;<a class="pilcrow" href="#section-1.2-5.2">¶</a>
</li>
          <li class="normal" id="section-1.2-5.3">among different nodes, it is only vulnerable to immediate replay: if
a node A has accepted an authentic packet from C, then a node B will only
accept a copy of that packet if B has accepted an older packet from C, and
B has received no later packet from C.<a class="pilcrow" href="#section-1.2-5.3">¶</a>
</li>
        </ul>
<p id="section-1.2-6">While this protocol makes efforts to mitigate the effects of a denial
of service attack, it does not fully protect against such attacks.<a class="pilcrow" href="#section-1.2-6">¶</a></p>
</section>
</div>
<section id="section-1.3">
        <h3 id="name-specification-of-requiremen">
<a class="section-number selfRef" href="#section-1.3">1.3. </a><a class="section-name selfRef" href="#name-specification-of-requiremen">Specification of Requirements</a>
        </h3>
<p id="section-1.3-1">
    The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", 
"<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", 
"<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", 
"<span class="bcp14">NOT RECOMMENDED</span>", "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" 
in this document are to be interpreted as described in BCP 14 <span>[<a class="xref" href="#RFC2119">RFC2119</a>]</span> <span>[<a class="xref" href="#RFC8174">RFC8174</a>]</span>
    when, and only when, they appear in all capitals, as shown here.<a class="pilcrow" href="#section-1.3-1">¶</a></p>
</section>
</section>
<section id="section-2">
      <h2 id="name-conceptual-overview-of-the-">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-conceptual-overview-of-the-">Conceptual Overview of the Protocol</a>
      </h2>
<p id="section-2-1">When a node B sends out a Babel packet through an interface that is
configured for MAC cryptographic protection, it computes one or more MACs
(one per key) that it appends to the packet.  When a node A receives
a packet over an interface that requires MAC cryptographic protection, it
independently computes a set of MACs and compares them to the MACs
appended to the packet; if there is no match, the packet is discarded.<a class="pilcrow" href="#section-2-1">¶</a></p>
<p id="section-2-2">In order to protect against replay, B maintains a per-interface 32-bit
integer known as the "packet counter" (PC). Whenever B sends a packet
through the interface, it embeds the current value of the PC within the
region of the packet that is protected by the MACs and increases the PC
by at least one.  When A receives the packet, it compares the value of the
PC with the one contained in the previous packet received from B, and
unless it is strictly greater, the packet is discarded.<a class="pilcrow" href="#section-2-2">¶</a></p>
<p id="section-2-3">By itself, the PC mechanism is not sufficient to protect against
replay.  Consider a peer A that has no information about a peer
B (e.g., because it has recently rebooted).  Suppose that A receives
a packet ostensibly from B carrying a given PC; since A has no information
about B, it has no way to determine whether the packet is freshly
generated or a replay of a previously sent packet.<a class="pilcrow" href="#section-2-3">¶</a></p>
<p id="section-2-4">In this situation, peer A discards the packet and challenges B to prove that
it knows the MAC key.  It sends a "Challenge Request", a TLV containing
a unique nonce, a value that has never been used before and will never be
used again.  Peer B replies to the Challenge Request with a "Challenge Reply",
a TLV containing a copy of the nonce chosen by A, in a packet protected by
MAC and containing the new value of B's PC.  Since the nonce has never
been used before, B's reply proves B's knowledge of the MAC key and the
freshness of the PC.<a class="pilcrow" href="#section-2-4">¶</a></p>
<p id="section-2-5">By itself, this mechanism is safe against replay if B never resets its
PC.  In practice, however, this is difficult to ensure, as persistent
storage is prone to failure, and hardware clocks, even when available, are
occasionally reset.  Suppose that B resets its PC to an earlier value and 
sends a packet with a previously used PC n.  Peer A challenges B,
B successfully responds to the challenge, and A accepts the PC equal to
n + 1.  At this point, an attacker C may send a replayed packet
with PC equal to n + 2, which will be accepted by A.<a class="pilcrow" href="#section-2-5">¶</a></p>
<p id="section-2-6">Another mechanism is needed to protect against this attack.  In this
protocol, every PC is tagged with an "index", an arbitrary string of
octets.  Whenever B resets its PC, or whenever B doesn't know whether its
PC has been reset, it picks an index that it has never used before (either
by drawing it randomly or by using a reliable hardware clock) and starts
sending PCs with that index.  Whenever A detects that B has changed its
index, it challenges B again.<a class="pilcrow" href="#section-2-6">¶</a></p>
<p id="section-2-7">With this additional mechanism, this protocol is invulnerable to replay
attacks (see <a class="xref" href="#security-properties">Section 1.2</a>).<a class="pilcrow" href="#section-2-7">¶</a></p>
</section>
<section id="section-3">
      <h2 id="name-data-structures">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-data-structures">Data Structures</a>
      </h2>
<p id="section-3-1">Every Babel node maintains a set of conceptual data structures
described in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8966#section-3.2">Section 3.2</a> of [<a class="xref" href="#RFC8966">RFC8966</a>]</span>.  This protocol
extends these data structures as follows.<a class="pilcrow" href="#section-3-1">¶</a></p>
<div id="interface-table">
<section id="section-3.1">
        <h3 id="name-the-interface-table">
<a class="section-number selfRef" href="#section-3.1">3.1. </a><a class="section-name selfRef" href="#name-the-interface-table">The Interface Table</a>
        </h3>
<p id="section-3.1-1">Every Babel node maintains an interface table, as described in 
<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8966#section-3.2.3">Section 3.2.3</a> of [<a class="xref" href="#RFC8966">RFC8966</a>]</span>.  Implementations of this protocol <span class="bcp14">MUST</span>
allow each interface to be provisioned with a set of one or more MAC keys
and the associated MAC algorithms (see <a class="xref" href="#mac-computation">Section 4.1</a>
for suggested algorithms and <a class="xref" href="#security-considerations">Section 7</a> for
suggested methods for key generation).  In order to allow incremental
deployment of this protocol (see <a class="xref" href="#incremental-deployment">Section 5</a>),
implementations <span class="bcp14">SHOULD</span> allow an interface to be configured in a mode in
which it participates in the MAC authentication protocol but accepts
packets that are not authenticated.<a class="pilcrow" href="#section-3.1-1">¶</a></p>
<p id="section-3.1-2">This protocol extends each table entry associated with
an interface on which MAC authentication has been configured with two new
pieces of data:<a class="pilcrow" href="#section-3.1-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-3.1"> a set of one or more MAC keys, each associated with a given MAC
algorithm;<a class="pilcrow" href="#section-3.1-3.1">¶</a>
</li>
          <li class="normal" id="section-3.1-3.2"> a pair (Index, PC), where Index is an arbitrary string of 0 to 32
octets, and PC is a 32-bit (4-octet) integer.<a class="pilcrow" href="#section-3.1-3.2">¶</a>
</li>
        </ul>
<p id="section-3.1-4">
We say that an index is fresh when it has never been used before with any
of the keys currently configured on the interface.  The Index field is
initialised to a fresh index, for example, by drawing a random string of
sufficient length (see <a class="xref" href="#security-considerations">Section 7</a> for
suggested sizes), and the PC is initialised to an arbitrary value
(typically 0).<a class="pilcrow" href="#section-3.1-4">¶</a></p>
</section>
</div>
<section id="section-3.2">
        <h3 id="name-the-neighbour-table">
<a class="section-number selfRef" href="#section-3.2">3.2. </a><a class="section-name selfRef" href="#name-the-neighbour-table">The Neighbour Table</a>
        </h3>
<p id="section-3.2-1">Every Babel node maintains a neighbour table, as described in
<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8966#section-3.2.4">Section 3.2.4</a> of [<a class="xref" href="#RFC8966">RFC8966</a>]</span>.  This protocol extends each
entry in this table with two new pieces of data:<a class="pilcrow" href="#section-3.2-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-2.1"> a pair (Index, PC), where Index is a string of 0 to 32 octets, and PC
is a 32-bit (4-octet) integer;<a class="pilcrow" href="#section-3.2-2.1">¶</a>
</li>
          <li class="normal" id="section-3.2-2.2"> a Nonce, which is an arbitrary string of 0 to 192 octets, and an
associated challenge expiry timer.<a class="pilcrow" href="#section-3.2-2.2">¶</a>
</li>
        </ul>
<p id="section-3.2-3">
The Index and PC are initially undefined, and they are managed as described in
<a class="xref" href="#packet-reception">Section 4.3</a>.  The Nonce and challenge expiry timer are
initially undefined, and they are used as described in
<a class="xref" href="#sending-challenges">Section 4.3.1.1</a>.<a class="pilcrow" href="#section-3.2-3">¶</a></p>
</section>
</section>
<section id="section-4">
      <h2 id="name-protocol-operation">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-protocol-operation">Protocol Operation</a>
      </h2>
<div id="mac-computation">
<section id="section-4.1">
        <h3 id="name-mac-computation">
<a class="section-number selfRef" href="#section-4.1">4.1. </a><a class="section-name selfRef" href="#name-mac-computation">MAC Computation</a>
        </h3>
<p id="section-4.1-1">A Babel node computes the MAC of a Babel packet as follows.<a class="pilcrow" href="#section-4.1-1">¶</a></p>
<p id="section-4.1-2">First, the node builds a pseudo-header that will participate in MAC
computation but will not be sent.  If the packet is carried over IPv6,
the pseudo-header has the following format:<a class="pilcrow" href="#section-4.1-2">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.1-3">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                                                               +
|                                                               |
+                          Src address                          +
|                                                               |
+                                                               +
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|           Src port            |                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               +
|                                                               |
+                                                               +
|                         Dest address                          |
+                                                               +
|                                                               |
+                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                               |           Dest port           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a class="pilcrow" href="#section-4.1-3">¶</a>
</div>
<p id="section-4.1-4">
If the packet is carried over IPv4, the pseudo-header has the following
format:<a class="pilcrow" href="#section-4.1-4">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.1-5">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          Src address                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|           Src port            |        Dest address           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                               |           Dest port           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a class="pilcrow" href="#section-4.1-5">¶</a>
</div>
<p id="section-4.1-6">Fields:<a class="pilcrow" href="#section-4.1-6">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.1-7">
          <dt id="section-4.1-7.1">Src address</dt>
          <dd id="section-4.1-7.2" style="margin-left: 7.0em">The source IP address of the packet.<a class="pilcrow" href="#section-4.1-7.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-7.3">Src port</dt>
          <dd id="section-4.1-7.4" style="margin-left: 7.0em">The source UDP port number of the packet.<a class="pilcrow" href="#section-4.1-7.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-7.5">Dest address</dt>
          <dd id="section-4.1-7.6" style="margin-left: 7.0em">The destination IP address of the packet.<a class="pilcrow" href="#section-4.1-7.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-7.7">Src port</dt>
          <dd id="section-4.1-7.8" style="margin-left: 7.0em">The destination UDP port number of the packet.<a class="pilcrow" href="#section-4.1-7.8">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.1-8">The node takes the concatenation of the pseudo-header and the Babel
packet including the packet header but excluding the packet trailer (from
octet 0 inclusive up to (Body Length + 4) exclusive) and 
computes a MAC with one of the implemented algorithms.  Every
implementation <span class="bcp14">MUST</span> implement HMAC-SHA256 as defined in
<span>[<a class="xref" href="#RFC6234">RFC6234</a>]</span> and <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc2104#section-2">Section 2</a> of [<a class="xref" href="#RFC2104">RFC2104</a>]</span>,
<span class="bcp14">SHOULD</span> implement keyed BLAKE2s <span>[<a class="xref" href="#RFC7693">RFC7693</a>]</span> with 128-bit (16-octet) digests, and <span class="bcp14">MAY</span> implement
other MAC algorithms.<a class="pilcrow" href="#section-4.1-8">¶</a></p>
</section>
</div>
<div id="packet-transmission">
<section id="section-4.2">
        <h3 id="name-packet-transmission">
<a class="section-number selfRef" href="#section-4.2">4.2. </a><a class="section-name selfRef" href="#name-packet-transmission">Packet Transmission</a>
        </h3>
<p id="section-4.2-1">A Babel node might delay actually sending TLVs by a small amount, in
order to aggregate multiple TLVs in a single packet up to the
interface MTU (<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8966#section-4">Section 4</a> of [<a class="xref" href="#RFC8966">RFC8966</a>]</span>).  For an
interface on which MAC protection is configured, the TLV aggregation
logic <span class="bcp14">MUST</span> take into account the overhead due to PC TLVs (one in each
packet) and MAC TLVs (one per configured key).<a class="pilcrow" href="#section-4.2-1">¶</a></p>
<p id="section-4.2-2">Before sending a packet, the following actions are performed:<a class="pilcrow" href="#section-4.2-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-3.1">
            <p id="section-4.2-3.1.1">a PC TLV containing the PC and Index associated with the
outgoing interface <span class="bcp14">MUST</span> be appended to the packet body;<a class="pilcrow" href="#section-4.2-3.1.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-3.1.2.1">the PC <span class="bcp14">MUST</span> be
incremented by a strictly positive amount (typically just 1);<a class="pilcrow" href="#section-4.2-3.1.2.1">¶</a>
</li>
              <li class="normal" id="section-4.2-3.1.2.2">if the
PC overflows, a fresh index <span class="bcp14">MUST</span> be generated (as defined in
             <a class="xref" href="#interface-table">Section 3.1</a>);<a class="pilcrow" href="#section-4.2-3.1.2.2">¶</a>
</li>
            </ul>
<p id="section-4.2-3.1.3">a node <span class="bcp14">MUST NOT</span> include multiple PC
           TLVs in a single packet;<a class="pilcrow" href="#section-4.2-3.1.3">¶</a></p>
</li>
          <li class="normal" id="section-4.2-3.2">for each key configured on the interface, a MAC is computed as
specified in <a class="xref" href="#mac-computation">Section 4.1</a> and stored in a
MAC TLV that <span class="bcp14">MUST</span> be appended to the packet trailer (see 
<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8966#section-4.2">Section 4.2</a> of [<a class="xref" href="#RFC8966">RFC8966</a>]</span>).<a class="pilcrow" href="#section-4.2-3.2">¶</a>
</li>
        </ul>
</section>
</div>
<div id="packet-reception">
<section id="section-4.3">
        <h3 id="name-packet-reception">
<a class="section-number selfRef" href="#section-4.3">4.3. </a><a class="section-name selfRef" href="#name-packet-reception">Packet Reception</a>
        </h3>
<p id="section-4.3-1">When a packet is received on an interface that is configured for MAC
protection, the following steps are performed before the packet is passed
to normal processing:<a class="pilcrow" href="#section-4.3-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3-2.1">First, the receiver checks whether the trailer of the received packet
carries at least one MAC TLV; if not, the packet <span class="bcp14">MUST</span> be immediately dropped
and processing stops.  Then, for each key configured on the receiving
interface, the receiver computes the MAC of the packet.  It then
compares every generated MAC against every MAC included in the packet;
if there is at least one match, the packet passes the MAC test; if there
is none, the packet <span class="bcp14">MUST</span> be silently dropped and processing stops at this
point.  In order to avoid memory exhaustion attacks, an entry in the
neighbour table <span class="bcp14">MUST NOT</span> be created before the MAC test has passed
successfully.  The MAC of the packet <span class="bcp14">MUST NOT</span> be computed for each MAC
TLV contained in the packet, but only once for each configured key.<a class="pilcrow" href="#section-4.3-2.1">¶</a>
</li>
          <li class="normal" id="section-4.3-2.2">If an entry for the sender does not exist in the neighbour table, it
<span class="bcp14">MAY</span> be created at this point (or, alternatively, its creation can be
delayed until a challenge needs to be sent, see below).<a class="pilcrow" href="#section-4.3-2.2">¶</a>
</li>
          <li class="normal" id="section-4.3-2.3">The packet body is then parsed a first time.  During this "preparse"
phase, the packet body is traversed and all TLVs are ignored except PC,
Challenge Request, and Challenge Reply TLVs.  When a PC TLV is
encountered, the enclosed PC and Index are saved for later processing. If
multiple PCs are found (which should not happen, see
<a class="xref" href="#packet-transmission">Section 4.2</a>), only the first one is
processed, the remaining ones <span class="bcp14">MUST</span> be silently ignored.  If a Challenge
Request is encountered, a Challenge Reply <span class="bcp14">MUST</span> be scheduled, as described
in <a class="xref" href="#replying-challenges">Section 4.3.1.2</a>.  If a Challenge Reply is
encountered, it is tested for validity as described in
<a class="xref" href="#receiving-challenges">Section 4.3.1.3</a>, and a note is made of the result of
the test.<a class="pilcrow" href="#section-4.3-2.3">¶</a>
</li>
          <li class="normal" id="section-4.3-2.4">The preparse phase above yields two pieces of data: the PC and
Index from the first PC TLV, and a bit indicating whether the packet
contains a successful Challenge Reply.  If the packet does not contain
a PC TLV, the packet <span class="bcp14">MUST</span> be dropped, and processing stops at this point.
If the packet contains a successful Challenge Reply, then the PC and Index
contained in the PC TLV <span class="bcp14">MUST</span> be stored in the neighbour table entry
corresponding to the sender (which already exists in this case), and the
packet is accepted.<a class="pilcrow" href="#section-4.3-2.4">¶</a>
</li>
          <li class="normal" id="section-4.3-2.5">Otherwise, if there is no entry in the neighbour table corresponding to
the sender, or if such an entry exists but contains no Index, or if the
Index it contains is different from the Index contained in the PC TLV,
then a challenge <span class="bcp14">MUST</span> be sent as described in
<a class="xref" href="#sending-challenges">Section 4.3.1.1</a>, the packet <span class="bcp14">MUST</span> be dropped, and
processing stops at this stage.<a class="pilcrow" href="#section-4.3-2.5">¶</a>
</li>
          <li class="normal" id="section-4.3-2.6">At this stage, the packet contains no successful Challenge Reply, and
the Index contained in the PC TLV is equal to the Index in the neighbour
table entry corresponding to the sender.  The receiver compares the
received PC with the PC contained in the neighbour table; if the received
PC is smaller or equal than the PC contained in the neighbour table, the
packet <span class="bcp14">MUST</span> be dropped and processing stops (no challenge is sent in this
case, since the mismatch might be caused by harmless packet reordering on
the link).  Otherwise, the PC contained in the neighbour table entry is
set to the received PC, and the packet is accepted.<a class="pilcrow" href="#section-4.3-2.6">¶</a>
</li>
        </ul>
<p id="section-4.3-3">In the algorithm described above, Challenge Requests are processed and
challenges are sent before the (Index, PC) pair is verified against the
neighbour table.  This simplifies the implementation somewhat (the node
may simply schedule outgoing requests as it walks the packet during the
preparse phase) but relies on the rate limiting described in
<a class="xref" href="#sending-challenges">Section 4.3.1.1</a> to avoid sending too many challenges
in response to replayed packets.  As an optimisation, a node <span class="bcp14">MAY</span> ignore
all Challenge Requests contained in a packet except the last one, and it
<span class="bcp14">MAY</span> ignore a Challenge Request in the case where it is contained in
a packet with an Index that matches the one in the neighbour table and
a PC that is smaller or equal to the one contained in the neighbour table.
Since it is still possible to replay a packet with an obsolete Index, the
rate limiting described in <a class="xref" href="#sending-challenges">Section 4.3.1.1</a> is
required even if this optimisation is implemented.<a class="pilcrow" href="#section-4.3-3">¶</a></p>
<p id="section-4.3-4">The same is true of Challenge Replies.  However, since validating
a Challenge Reply has minimal additional cost (it is just a bitwise
comparison of two strings of octets), a similar optimisation for Challenge
Replies is not worthwhile.<a class="pilcrow" href="#section-4.3-4">¶</a></p>
<p id="section-4.3-5">After the packet has been accepted, it is processed as normal, except
that any PC, Challenge Request, and Challenge Reply TLVs that it contains
are silently ignored.<a class="pilcrow" href="#section-4.3-5">¶</a></p>
<section id="section-4.3.1">
          <h4 id="name-challenge-requests-and-repl">
<a class="section-number selfRef" href="#section-4.3.1">4.3.1. </a><a class="section-name selfRef" href="#name-challenge-requests-and-repl">Challenge Requests and Replies</a>
          </h4>
<p id="section-4.3.1-1">During the preparse stage, the receiver might encounter a mismatched
Index, to which it will react by scheduling a Challenge Request.  It might
encounter a Challenge Request TLV, to which it will reply with a Challenge
Reply TLV.  Finally, it might encounter a Challenge Reply TLV, which it
will attempt to match with a previously sent Challenge Request TLV in
order to update the neighbour table entry corresponding to the sender of
the packet.<a class="pilcrow" href="#section-4.3.1-1">¶</a></p>
<div id="sending-challenges">
<section id="section-4.3.1.1">
            <h5 id="name-sending-challenges">
<a class="section-number selfRef" href="#section-4.3.1.1">4.3.1.1. </a><a class="section-name selfRef" href="#name-sending-challenges">Sending Challenges</a>
            </h5>
<p id="section-4.3.1.1-1">When it encounters a mismatched Index during the preparse phase, a node
picks a nonce that it has never used with any of the keys currently
configured on the relevant interface, for example, by drawing
a sufficiently large random string of bytes or by consulting a strictly
monotonic hardware clock.  It <span class="bcp14">MUST</span> then store the nonce in the entry of
the neighbour table associated to the neighbour (the entry might need to
be created at this stage), initialise the neighbour's challenge expiry
timer to 30 seconds, and send a Challenge Request TLV to the unicast
address corresponding to the neighbour.<a class="pilcrow" href="#section-4.3.1.1-1">¶</a></p>
<p id="section-4.3.1.1-2">A node <span class="bcp14">MAY</span> aggregate a Challenge Request with other TLVs; in other
words, if it has already buffered TLVs to be sent to the unicast address
of the neighbour, it <span class="bcp14">MAY</span> send the buffered TLVs in the same packet as the
Challenge Request.  However, it <span class="bcp14">MUST</span> arrange for the Challenge Request to
be sent in a timely manner, as any packets received from that neighbour
will be silently ignored until the challenge completes.<a class="pilcrow" href="#section-4.3.1.1-2">¶</a></p>
<p id="section-4.3.1.1-3">A node <span class="bcp14">MUST</span> impose a rate limitation to the challenges it sends; the
limit <span class="bcp14">SHOULD</span> default to one Challenge Request every 300 ms and <span class="bcp14">MAY</span> be
configurable.  This rate limiting serves two purposes.  First, since
a challenge may be sent in response to a packet replayed by an attacker,
it limits the number of challenges that an attacker can cause a node to
send.  Second, it limits the number of challenges sent when there are
multiple packets in flight from a single neighbour.<a class="pilcrow" href="#section-4.3.1.1-3">¶</a></p>
</section>
</div>
<div id="replying-challenges">
<section id="section-4.3.1.2">
            <h5 id="name-replying-to-challenges">
<a class="section-number selfRef" href="#section-4.3.1.2">4.3.1.2. </a><a class="section-name selfRef" href="#name-replying-to-challenges">Replying to Challenges</a>
            </h5>
<p id="section-4.3.1.2-1">When it encounters a Challenge Request during the preparse phase,
a node constructs a Challenge Reply TLV by copying the Nonce from the
Challenge Request into the Challenge Reply.  It <span class="bcp14">MUST</span> then send the
Challenge Reply to the unicast address from which the Challenge Request
was sent.  A challenge sent to a multicast address <span class="bcp14">MUST</span> be silently ignored.<a class="pilcrow" href="#section-4.3.1.2-1">¶</a></p>
<p id="section-4.3.1.2-2">A node <span class="bcp14">MAY</span> aggregate a Challenge Reply with other TLVs; in other words,
if it has already buffered TLVs to be sent to the unicast address of the
sender of the Challenge Request, it <span class="bcp14">MAY</span> send the buffered TLVs in the same
packet as the Challenge Reply.  However, it <span class="bcp14">MUST</span> arrange for the Challenge
Reply to be sent in a timely manner (within a few seconds) and <span class="bcp14">SHOULD NOT</span>
send any other packets over the same interface before sending the
Challenge Reply, as those would be dropped by the challenger.<a class="pilcrow" href="#section-4.3.1.2-2">¶</a></p>
<p id="section-4.3.1.2-3">Since a Challenge Reply might be caused by a replayed Challenge Request,
a node <span class="bcp14">MUST</span> impose a rate limitation to the Challenge Replies it sends;
the limit <span class="bcp14">SHOULD</span> default to one Challenge Reply for each peer every
300 ms and <span class="bcp14">MAY</span> be configurable.<a class="pilcrow" href="#section-4.3.1.2-3">¶</a></p>
</section>
</div>
<div id="receiving-challenges">
<section id="section-4.3.1.3">
            <h5 id="name-receiving-challenge-replies">
<a class="section-number selfRef" href="#section-4.3.1.3">4.3.1.3. </a><a class="section-name selfRef" href="#name-receiving-challenge-replies">Receiving Challenge Replies</a>
            </h5>
<p id="section-4.3.1.3-1">When it encounters a Challenge Reply during the preparse phase, a node
consults the neighbour table entry corresponding to the neighbour that
sent the Challenge Reply.  If no challenge is in progress, i.e., if
there is no Nonce stored in the neighbour table entry or the challenge
timer has expired, the Challenge Reply <span class="bcp14">MUST</span> be silently ignored, and the
challenge has failed.<a class="pilcrow" href="#section-4.3.1.3-1">¶</a></p>
<p id="section-4.3.1.3-2">Otherwise, the node compares the Nonce contained in the Challenge Reply
with the Nonce contained in the neighbour table entry.  If the two are
equal (they have the same length and content), then the challenge has
succeeded and the nonce stored in the neighbour table for this neighbour
<span class="bcp14">SHOULD</span> be discarded; otherwise, the challenge has failed (and the nonce is
not discarded).<a class="pilcrow" href="#section-4.3.1.3-2">¶</a></p>
</section>
</div>
</section>
</section>
</div>
<div id="expire">
<section id="section-4.4">
        <h3 id="name-expiring-per-neighbour-stat">
<a class="section-number selfRef" href="#section-4.4">4.4. </a><a class="section-name selfRef" href="#name-expiring-per-neighbour-stat">Expiring Per-Neighbour State</a>
        </h3>
<p id="section-4.4-1">The per-neighbour (Index, PC) pair is maintained in the neighbour
table, and is normally discarded when the neighbour table entry expires.
Implementations <span class="bcp14">MUST</span> ensure that an (Index, PC) pair is discarded within
a finite time since the last time a packet has been accepted.  In
particular, unsuccessful challenges <span class="bcp14">MUST NOT</span> prevent an (Index, PC) pair
from being discarded for unbounded periods of time.<a class="pilcrow" href="#section-4.4-1">¶</a></p>
<p id="section-4.4-2">A possible implementation strategy for implementations that use a Hello
history (Appendix A of <span>[<a class="xref" href="#RFC8966">RFC8966</a>]</span>) is to discard the
(Index, PC) pair whenever the Hello history becomes empty.  Another
implementation strategy is to use a timer that is reset whenever a packet
is accepted and to discard the (Index, PC) pair whenever the timer
expires.  If the latter strategy is used, the timer <span class="bcp14">SHOULD</span> default
to a value of 5 minutes and <span class="bcp14">MAY</span> be configurable.<a class="pilcrow" href="#section-4.4-2">¶</a></p>
</section>
</div>
</section>
<div id="incremental-deployment">
<section id="section-5">
      <h2 id="name-incremental-deployment-and-">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-incremental-deployment-and-">Incremental Deployment and Key Rotation</a>
      </h2>
<p id="section-5-1">In order to perform incremental deployment, the nodes in the network
are first configured in a mode where packets are sent with authentication
but not checked on reception.  Once all the nodes in the network are
configured to send authenticated packets, nodes are reconfigured to reject
unauthenticated packets.<a class="pilcrow" href="#section-5-1">¶</a></p>
<p id="section-5-2">In order to perform key rotation, the new key is added to all the
nodes. Once this is done, both the old and the new key are sent in all
packets, and packets are accepted if they are properly signed by either of
the keys.  At that point, the old key is removed.<a class="pilcrow" href="#section-5-2">¶</a></p>
<p id="section-5-3">In order to support the procedures described above, implementations of
this protocol <span class="bcp14">SHOULD</span> support an interface configuration in which packets
are sent authenticated but received packets are accepted without
verification, and they <span class="bcp14">SHOULD</span> allow changing the set of keys associated
with an interface without a restart.<a class="pilcrow" href="#section-5-3">¶</a></p>
</section>
</div>
<section id="section-6">
      <h2 id="name-packet-format">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-packet-format">Packet Format</a>
      </h2>
<section id="section-6.1">
        <h3 id="name-mac-tlv">
<a class="section-number selfRef" href="#section-6.1">6.1. </a><a class="section-name selfRef" href="#name-mac-tlv">MAC TLV</a>
        </h3>
<div class="artwork art-text alignLeft" id="section-6.1-1">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Type = 16   |    Length     |     MAC...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
</pre><a class="pilcrow" href="#section-6.1-1">¶</a>
</div>
<p id="section-6.1-2">Fields:<a class="pilcrow" href="#section-6.1-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-6.1-3">
          <dt id="section-6.1-3.1">Type</dt>
          <dd id="section-6.1-3.2" style="margin-left: 5.0em">Set to 16 to indicate a MAC TLV.<a class="pilcrow" href="#section-6.1-3.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-3.3">Length</dt>
          <dd id="section-6.1-3.4" style="margin-left: 5.0em">The length of the body, in octets, exclusive of the
Type and Length fields.  The length depends on the MAC algorithm being
used.<a class="pilcrow" href="#section-6.1-3.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-3.5">MAC</dt>
          <dd id="section-6.1-3.6" style="margin-left: 5.0em">The body contains the MAC of the packet, computed as
described in <a class="xref" href="#mac-computation">Section 4.1</a>.<a class="pilcrow" href="#section-6.1-3.6">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-6.1-4">This TLV is allowed in the packet trailer (see 
<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8966#section-4.2">Section 4.2</a> of [<a class="xref" href="#RFC8966">RFC8966</a>]</span>) and <span class="bcp14">MUST</span> be ignored if it is found in the
packet body.<a class="pilcrow" href="#section-6.1-4">¶</a></p>
</section>
<section id="section-6.2">
        <h3 id="name-pc-tlv">
<a class="section-number selfRef" href="#section-6.2">6.2. </a><a class="section-name selfRef" href="#name-pc-tlv">PC TLV</a>
        </h3>
<div class="artwork art-text alignLeft" id="section-6.2-1">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Type = 17   |    Length     |             PC                |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                               |            Index...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
</pre><a class="pilcrow" href="#section-6.2-1">¶</a>
</div>
<p id="section-6.2-2">Fields:<a class="pilcrow" href="#section-6.2-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-6.2-3">
          <dt id="section-6.2-3.1">Type</dt>
          <dd id="section-6.2-3.2" style="margin-left: 5.0em">Set to 17 to indicate a PC TLV.<a class="pilcrow" href="#section-6.2-3.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-3.3">Length</dt>
          <dd id="section-6.2-3.4" style="margin-left: 5.0em">The length of the body, in octets, exclusive of the
Type and Length fields.<a class="pilcrow" href="#section-6.2-3.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-3.5">PC</dt>
          <dd id="section-6.2-3.6" style="margin-left: 5.0em">The Packet Counter (PC), a 32-bit (4-octet) unsigned
integer that is increased with every packet sent over this interface.
A fresh index (as defined in <a class="xref" href="#interface-table">Section 3.1</a>) <span class="bcp14">MUST</span> be
generated whenever the PC overflows.<a class="pilcrow" href="#section-6.2-3.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-3.7">Index</dt>
          <dd id="section-6.2-3.8" style="margin-left: 5.0em">The sender's Index, an opaque string of 0 to 32
octets.<a class="pilcrow" href="#section-6.2-3.8">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-6.2-4">Indices are limited to a size of 32 octets: a node <span class="bcp14">MUST NOT</span> send a TLV
with an index of size strictly larger than 32 octets, and a node <span class="bcp14">MAY</span>
ignore a PC TLV with an index of length strictly larger than 32 octets.
Indices of length 0 are valid: if a node has reliable stable storage and
the packet counter never overflows, then only one index is necessary, and
the value of length 0 is the canonical choice.<a class="pilcrow" href="#section-6.2-4">¶</a></p>
</section>
<section id="section-6.3">
        <h3 id="name-challenge-request-tlv">
<a class="section-number selfRef" href="#section-6.3">6.3. </a><a class="section-name selfRef" href="#name-challenge-request-tlv">Challenge Request TLV</a>
        </h3>
<div class="artwork art-text alignLeft" id="section-6.3-1">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Type = 18   |    Length     |     Nonce...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
</pre><a class="pilcrow" href="#section-6.3-1">¶</a>
</div>
<p id="section-6.3-2">Fields:<a class="pilcrow" href="#section-6.3-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-6.3-3">
          <dt id="section-6.3-3.1">Type</dt>
          <dd id="section-6.3-3.2" style="margin-left: 5.0em">Set to 18 to indicate a Challenge Request TLV.<a class="pilcrow" href="#section-6.3-3.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.3-3.3">Length</dt>
          <dd id="section-6.3-3.4" style="margin-left: 5.0em">The length of the body, in octets, exclusive of the
Type and Length fields.<a class="pilcrow" href="#section-6.3-3.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.3-3.5">Nonce</dt>
          <dd id="section-6.3-3.6" style="margin-left: 5.0em">The nonce uniquely identifying the challenge, an
opaque string of 0 to 192 octets.<a class="pilcrow" href="#section-6.3-3.6">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-6.3-4">Nonces are limited to a size of 192 octets: a node <span class="bcp14">MUST NOT</span> send
a Challenge Request TLV with a nonce of size strictly larger than 192
octets, and a node <span class="bcp14">MAY</span> ignore a nonce that is of size strictly larger than
192 octets.  Nonces of length 0 are valid: if a node has reliable stable
storage, then it may use a sequential counter for generating nonces that
get encoded in the minimum number of octets required; the value 0 is then
encoded as the string of length 0.<a class="pilcrow" href="#section-6.3-4">¶</a></p>
</section>
<section id="section-6.4">
        <h3 id="name-challenge-reply-tlv">
<a class="section-number selfRef" href="#section-6.4">6.4. </a><a class="section-name selfRef" href="#name-challenge-reply-tlv">Challenge Reply TLV</a>
        </h3>
<div class="artwork art-text alignLeft" id="section-6.4-1">
<pre> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Type = 19   |    Length     |     Nonce...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
</pre><a class="pilcrow" href="#section-6.4-1">¶</a>
</div>
<p id="section-6.4-2">Fields:<a class="pilcrow" href="#section-6.4-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-6.4-3">
          <dt id="section-6.4-3.1">Type</dt>
          <dd id="section-6.4-3.2" style="margin-left: 5.0em">Set to 19 to indicate a Challenge Reply TLV.<a class="pilcrow" href="#section-6.4-3.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.4-3.3">Length</dt>
          <dd id="section-6.4-3.4" style="margin-left: 5.0em">The length of the body, in octets, exclusive of the
Type and Length fields.<a class="pilcrow" href="#section-6.4-3.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.4-3.5">Nonce</dt>
          <dd id="section-6.4-3.6" style="margin-left: 5.0em">A copy of the nonce contained in the corresponding
Challenge Request.<a class="pilcrow" href="#section-6.4-3.6">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</section>
<div id="security-considerations">
<section id="section-7">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<p id="section-7-1">This document defines a mechanism that provides basic security
properties for the Babel routing protocol.  The scope of this protocol is
strictly limited: it only provides authentication (we assume that routing
information is not confidential), it only supports symmetric keying, and
it only allows for the use of a small number of symmetric keys on every
link.  Deployments that need more features, e.g., confidentiality or
asymmetric keying, should use a more feature-rich security mechanism such as
the one described in <span>[<a class="xref" href="#RFC8968">RFC8968</a>]</span>.<a class="pilcrow" href="#section-7-1">¶</a></p>
<p id="section-7-2">This mechanism relies on two assumptions, as described in
<a class="xref" href="#security-properties">Section 1.2</a>.  First, it assumes that the MAC being used
is invulnerable to forgery (<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc6039#section-1.1">Section 1.1</a> of [<a class="xref" href="#RFC6039">RFC6039</a>]</span>); at
the time of writing, HMAC-SHA256, which is mandatory to implement
(<a class="xref" href="#mac-computation">Section 4.1</a>), is believed to be safe against
practical attacks.<a class="pilcrow" href="#section-7-2">¶</a></p>
<p id="section-7-3">Second, it assumes that indices and nonces are generated uniquely over
the lifetime of a key used for MAC computation (more precisely, indices
must be unique for a given (key, source) pair, and nonces must be unique
for a given (key, source, destination) triple).  This property can be
satisfied either by using a cryptographically secure random number
generator to generate indices and nonces that contain enough entropy
(64-bit values are believed to be large enough for all practical
applications) or by using a reliably monotonic hardware clock.  If
uniqueness cannot be guaranteed (e.g., because a hardware clock has been
reset), then rekeying is necessary.<a class="pilcrow" href="#section-7-3">¶</a></p>
<p id="section-7-4">The expiry mechanism mandated in <a class="xref" href="#expire">Section 4.4</a> is required to
prevent an attacker from delaying an authentic packet by an unbounded
amount of time.  If an attacker is able to delay the delivery of a packet
(e.g., because it is located at a Layer 2 switch), then the packet will be
accepted as long as the corresponding (Index, PC) pair is present at the
receiver.  If the attacker is able to cause the (Index, PC) pair to
persist for arbitrary amounts of time (e.g., by repeatedly causing failed
challenges), then it is able to delay the packet by arbitrary amounts of
time, even after the sender has left the network, which could allow it to
redirect or blackhole traffic to destinations previously advertised by the
sender.<a class="pilcrow" href="#section-7-4">¶</a></p>
<p id="section-7-5">This protocol exposes large numbers of packets and their MACs to an
attacker that is able to capture packets; it is therefore vulnerable to
brute-force attacks.  Keys must be chosen in a manner that makes them
difficult to guess.  Ideally, they should have a length of 32 octets (both
for HMAC-SHA256 and BLAKE2s), and be chosen randomly.  If, for some
reason, it is necessary to derive keys from a human-readable passphrase,
it is recommended to use a key derivation function that hampers dictionary
attacks, such as PBKDF2 <span>[<a class="xref" href="#RFC8018">RFC8018</a>]</span>, bcrypt
<span>[<a class="xref" href="#BCRYPT">BCRYPT</a>]</span>, or scrypt <span>[<a class="xref" href="#RFC7914">RFC7914</a>]</span>.  In that case,
only the derived keys should be communicated to the routers; the original
passphrase itself should be kept on the host used to perform the key
generation (e.g., an administrator's secure laptop computer).<a class="pilcrow" href="#section-7-5">¶</a></p>
<p id="section-7-6">While it is probably not possible to be immune against denial of
service (DoS) attacks in general, this protocol includes a number of
mechanisms designed to mitigate such attacks.  In particular, reception of
a packet with no correct MAC creates no local Babel state
(<a class="xref" href="#packet-reception">Section 4.3</a>).  Reception of a replayed packet with
correct MAC, on the other hand, causes a challenge to be sent; this is
mitigated somewhat by requiring that challenges be rate limited
(<a class="xref" href="#sending-challenges">Section 4.3.1.1</a>).<a class="pilcrow" href="#section-7-6">¶</a></p>
<p id="section-7-7">Receiving a replayed packet with an obsolete index causes an entry to
be created in the neighbour table, which, at first sight, makes the
protocol susceptible to resource exhaustion attacks (similarly to the
familiar "TCP SYN Flooding" attack <span>[<a class="xref" href="#RFC4987">RFC4987</a>]</span>).  However,
the MAC computation includes the sender address (<a class="xref" href="#mac-computation">Section 4.1</a>), 
and thus the amount of storage that an
attacker can force a node to consume is limited by the number of distinct
source addresses used with a single MAC key (see also 
<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8966#section-4">Section 4</a> of [<a class="xref" href="#RFC8966">RFC8966</a>]</span>, which mandates that the source address is
a link-local IPv6 address or a local IPv4 address).<a class="pilcrow" href="#section-7-7">¶</a></p>
<p id="section-7-8">In order to make this kind of resource exhaustion attacks less
effective, implementations may use a separate table of uncompleted
challenges that is separate from the neighbour table used by the core
protocol (the data structures described in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8966#section-3.2">Section 3.2</a> of [<a class="xref" href="#RFC8966">RFC8966</a>]</span> are conceptual, and any data structure that yields the
same result may be used).  Implementers might also consider using the fact
that the nonces included in Challenge Requests and Replies can be fairly
large (up to 192 octets), which should in principle allow encoding the
per-challenge state as a secure "cookie" within the nonce itself; note,
however, that any such scheme will need to prevent cookie replay.<a class="pilcrow" href="#section-7-8">¶</a></p>
</section>
</div>
<section id="section-8">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-8">8. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<p id="section-8-1">IANA has allocated the following values in the Babel TLV Types
registry:<a class="pilcrow" href="#section-8-1">¶</a></p>
<table class="center" id="table-1">
        <caption><a class="selfRef" href="#table-1">Table 1</a></caption>
<thead>
          <tr>
            <th class="text-left" colspan="1" rowspan="1">Type</th>
            <th class="text-left" colspan="1" rowspan="1">Name</th>
            <th class="text-left" colspan="1" rowspan="1">Reference</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">16</td>
            <td class="text-left" colspan="1" rowspan="1">MAC</td>
            <td class="text-left" colspan="1" rowspan="1">RFC 8967</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">17</td>
            <td class="text-left" colspan="1" rowspan="1">PC</td>
            <td class="text-left" colspan="1" rowspan="1">RFC 8967</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">18</td>
            <td class="text-left" colspan="1" rowspan="1">Challenge Request</td>
            <td class="text-left" colspan="1" rowspan="1">RFC 8967</td>
          </tr>
          <tr>
            <td class="text-left" colspan="1" rowspan="1">19</td>
            <td class="text-left" colspan="1" rowspan="1">Challenge Reply</td>
            <td class="text-left" colspan="1" rowspan="1">RFC 8967</td>
          </tr>
        </tbody>
      </table>
</section>
<section id="section-9">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-9">9. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-9.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-9.1">9.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2104">[RFC2104]</dt>
        <dd>
<span class="refAuthor">Krawczyk, H.</span><span class="refAuthor">, Bellare, M.</span><span class="refAuthor">, and R. Canetti</span>, <span class="refTitle">"HMAC: Keyed-Hashing for Message Authentication"</span>, <span class="seriesInfo">RFC 2104</span>, <span class="seriesInfo">DOI 10.17487/RFC2104</span>, <time class="refDate" datetime="1997-02">February 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2104">https://www.rfc-editor.org/info/rfc2104</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time class="refDate" datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6234">[RFC6234]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span><span class="refAuthor"> and T. Hansen</span>, <span class="refTitle">"US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)"</span>, <span class="seriesInfo">RFC 6234</span>, <span class="seriesInfo">DOI 10.17487/RFC6234</span>, <time class="refDate" datetime="2011-05">May 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6234">https://www.rfc-editor.org/info/rfc6234</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7693">[RFC7693]</dt>
        <dd>
<span class="refAuthor">Saarinen, M-J., Ed.</span><span class="refAuthor"> and J-P. Aumasson</span>, <span class="refTitle">"The BLAKE2 Cryptographic Hash and Message Authentication Code (MAC)"</span>, <span class="seriesInfo">RFC 7693</span>, <span class="seriesInfo">DOI 10.17487/RFC7693</span>, <time class="refDate" datetime="2015-11">November 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7693">https://www.rfc-editor.org/info/rfc7693</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time class="refDate" datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8966">[RFC8966]</dt>
      <dd>
<span class="refAuthor">Chroboczek, J.</span><span class="refAuthor"> and D. Schinazi</span>, <span class="refTitle">"The Babel Routing Protocol"</span>, <span class="seriesInfo">RFC 8966</span>, <span class="seriesInfo">DOI 10.17487/RFC8966</span>, <time class="refDate" datetime="2021-01">January 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8966">https://www.rfc-editor.org/info/rfc8966</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-9.2">
        <h3 id="name-informational-references">
<a class="section-number selfRef" href="#section-9.2">9.2. </a><a class="section-name selfRef" href="#name-informational-references">Informational References</a>
        </h3>
<dl class="references">
<dt id="BCRYPT">[BCRYPT]</dt>
        <dd>
<span class="refAuthor">Niels, P.</span><span class="refAuthor"> and D. Mazières</span>, <span class="refTitle">"A Future-Adaptable Password Scheme"</span>, <span class="refContent">Proceedings of the FREENIX Track: 1999 USENIX Annual Technical Conference</span>, <time class="refDate" datetime="1999-06">June 1999</time>. </dd>
<dd class="break"></dd>
<dt id="RFC4086">[RFC4086]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span><span class="refAuthor">, Schiller, J.</span><span class="refAuthor">, and S. Crocker</span>, <span class="refTitle">"Randomness Requirements for Security"</span>, <span class="seriesInfo">BCP 106</span>, <span class="seriesInfo">RFC 4086</span>, <span class="seriesInfo">DOI 10.17487/RFC4086</span>, <time class="refDate" datetime="2005-06">June 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4086">https://www.rfc-editor.org/info/rfc4086</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4987">[RFC4987]</dt>
        <dd>
<span class="refAuthor">Eddy, W.</span>, <span class="refTitle">"TCP SYN Flooding Attacks and Common Mitigations"</span>, <span class="seriesInfo">RFC 4987</span>, <span class="seriesInfo">DOI 10.17487/RFC4987</span>, <time class="refDate" datetime="2007-08">August 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4987">https://www.rfc-editor.org/info/rfc4987</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6039">[RFC6039]</dt>
        <dd>
<span class="refAuthor">Manral, V.</span><span class="refAuthor">, Bhatia, M.</span><span class="refAuthor">, Jaeggli, J.</span><span class="refAuthor">, and R. White</span>, <span class="refTitle">"Issues with Existing Cryptographic Protection Methods for Routing Protocols"</span>, <span class="seriesInfo">RFC 6039</span>, <span class="seriesInfo">DOI 10.17487/RFC6039</span>, <time class="refDate" datetime="2010-10">October 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6039">https://www.rfc-editor.org/info/rfc6039</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7298">[RFC7298]</dt>
        <dd>
<span class="refAuthor">Ovsienko, D.</span>, <span class="refTitle">"Babel Hashed Message Authentication Code (HMAC) Cryptographic Authentication"</span>, <span class="seriesInfo">RFC 7298</span>, <span class="seriesInfo">DOI 10.17487/RFC7298</span>, <time class="refDate" datetime="2014-07">July 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7298">https://www.rfc-editor.org/info/rfc7298</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7914">[RFC7914]</dt>
        <dd>
<span class="refAuthor">Percival, C.</span><span class="refAuthor"> and S. Josefsson</span>, <span class="refTitle">"The scrypt Password-Based Key Derivation Function"</span>, <span class="seriesInfo">RFC 7914</span>, <span class="seriesInfo">DOI 10.17487/RFC7914</span>, <time class="refDate" datetime="2016-08">August 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7914">https://www.rfc-editor.org/info/rfc7914</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8018">[RFC8018]</dt>
        <dd>
<span class="refAuthor">Moriarty, K., Ed.</span><span class="refAuthor">, Kaliski, B.</span><span class="refAuthor">, and A. Rusch</span>, <span class="refTitle">"PKCS #5: Password-Based Cryptography Specification Version 2.1"</span>, <span class="seriesInfo">RFC 8018</span>, <span class="seriesInfo">DOI 10.17487/RFC8018</span>, <time class="refDate" datetime="2017-01">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8018">https://www.rfc-editor.org/info/rfc8018</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8968">[RFC8968]</dt>
      <dd>
<span class="refAuthor">Décimo, A.</span><span class="refAuthor">, Schinazi, D.</span><span class="refAuthor">, and J. Chroboczek</span>, <span class="refTitle">"Babel Routing Protocol over Datagram Transport Layer Security"</span>, <span class="seriesInfo">RFC 8968</span>, <span class="seriesInfo">DOI 10.17487/RFC8968</span>, <time class="refDate" datetime="2021-01">January 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8968">https://www.rfc-editor.org/info/rfc8968</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<section id="section-appendix.a">
      <h2 id="name-acknowledgments">
<a class="section-name selfRef" href="#name-acknowledgments">Acknowledgments</a>
      </h2>
<p id="section-appendix.a-1">The protocol described in this document is based on the original HMAC
protocol defined by <span class="contact-name">Denis Ovsienko</span> <span>[<a class="xref" href="#RFC7298">RFC7298</a>]</span>.  
The use of a pseudo-header was suggested by <span class="contact-name">David Schinazi</span>.  
The use of an index to avoid replay was suggested by <span class="contact-name">Markus Stenberg</span>.  
The authors are also indebted to <span class="contact-name">Antonin Décimo</span>, 
<span class="contact-name">Donald Eastlake</span>, <span class="contact-name">Toke Høiland-Jørgensen</span>,
<span class="contact-name">Florian Horn</span>, <span class="contact-name">Benjamin Kaduk</span>, 
<span class="contact-name">Dave Taht</span>, and <span class="contact-name">Martin Vigoureux</span>.<a class="pilcrow" href="#section-appendix.a-1">¶</a></p>
</section>
<div id="authors-addresses">
<section id="section-appendix.b">
      <h2 id="name-authors-addresses">
<a class="section-name selfRef" href="#name-authors-addresses">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Clara Dô</span></div>
<div class="left" dir="auto"><span class="org">IRIF, University of Paris-Diderot</span></div>
<div class="left" dir="auto">
<span class="postal-code">75205</span> <span class="locality">Paris CEDEX 13</span>
</div>
<div class="left" dir="auto"><span class="country-name">France</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:clarado_perso@yahoo.fr">clarado_perso@yahoo.fr</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Weronika Kolodziejak</span></div>
<div class="left" dir="auto"><span class="org">IRIF, University of Paris-Diderot</span></div>
<div class="left" dir="auto">
<span class="postal-code">75205</span> <span class="locality">Paris CEDEX 13</span>
</div>
<div class="left" dir="auto"><span class="country-name">France</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:weronika.kolodziejak@gmail.com">weronika.kolodziejak@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Juliusz Chroboczek</span></div>
<div class="left" dir="auto"><span class="org">IRIF, University of Paris-Diderot</span></div>
<div class="left" dir="auto"><span class="street-address">Case 7014</span></div>
<div class="left" dir="auto">
<span class="postal-code">75205</span> <span class="locality">Paris CEDEX 13</span>
</div>
<div class="left" dir="auto"><span class="country-name">France</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:jch@irif.fr">jch@irif.fr</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>