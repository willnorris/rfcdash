<html><head></head><body><pre>Internet Engineering Task Force (IETF)                         S. Turner
Request for Comments: 5756                                          IECA
Updates: <a href="./rfc4055">4055</a>                                                   D. Brown
Category: Standards Track                                       Certicom
ISSN: 2070-1721                                                   K. Yiu
                                                               Microsoft
                                                              R. Housley
                                                          Vigil Security
                                                                 T. Polk
                                                                    NIST
                                                            January 2010


       <span class="h1">Updates for RSAES-OAEP and RSASSA-PSS Algorithm Parameters</span>

Abstract

   This document updates <a href="./rfc4055">RFC 4055</a>.  It updates the conventions for using
   the RSA Encryption Scheme - Optimal Asymmetric Encryption Padding
   (RSAES-OAEP) key transport algorithm in the Internet X.509 Public Key
   Infrastructure (PKI).  Specifically, it updates the conventions for
   algorithm parameters in an X.509 certificate's subjectPublicKeyInfo
   field.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="./rfc5741#section-2">Section 2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc5756">http://www.rfc-editor.org/info/rfc5756</a>.

Copyright Notice

   Copyright (c) 2010 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://www.rfc-editor.org/bcp/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect



<span class="grey">Turner, et al.              Standards Track                     [Page 1]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-2"></span>
<span class="grey"><a href="./rfc5756">RFC 5756</a>                    <a href="./rfc4055">RFC 4055</a> Update                 January 2010</span>


   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

   This document may contain material from IETF Documents or IETF
   Contributions published or made publicly available before November
   10, 2008.  The person(s) controlling the copyright in some of this
   material may not have granted the IETF Trust the right to allow
   modifications of such material outside the IETF Standards Process.
   Without obtaining an adequate license from the person(s) controlling
   the copyright in such materials, this document may not be modified
   outside the IETF Standards Process, and derivative works of it may
   not be created outside the IETF Standards Process, except to format
   it for publication as an RFC or to translate it into languages other
   than English.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" id="section-1">1</a>.  Introduction</span>

   <a href="./rfc4055">RFC 4055</a> specifies conventions for using the RSA Encryption Scheme -
   Optimal Asymmetric Encryption Padding (RSAES-OAEP) key transport
   algorithm in the Internet X.509 Public Key Infrastructure (PKI).  It
   provides algorithm identifiers and parameters for RSAES-OAEP.

   This document updates the conventions for RSAES-OAEP parameters in
   the subjectPublicKeyInfo field of an X.509 certificate.  The PKIX WG
   Elliptic Curve Cryptography (ECC) design team recommended that Key
   Derivation Functions (KDFs) should not be constrained within a
   certificate; rather, KDF constraints should be negotiated in
   protocols that need to employ certificates.

   Only two paragraphs in [<a href="./rfc4055" title='"Additional Algorithms and Identifiers for RSA Cryptography for use in the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"'>RFC4055</a>] discuss RSAES-OAEP parameters in
   X.509 certificates: the second paragraph of <a href="#section-4">Section 4</a> and the first
   paragraph of <a href="#section-4.1">Section 4.1</a>.  This document only updates these two
   paragraphs.  <a href="#section-3">Section 3</a> updates the second paragraph in <a href="./rfc4055#section-4">Section 4 of
   [RFC4055]</a>, while <a href="#section-4">Section 4</a> updates the second paragraph in <a href="./rfc4055#section-4.1">Section</a>
   <a href="./rfc4055#section-4.1">4.1 of [RFC4055]</a>.  "Old:" prefaces the text to be replaced and "New:"
   prefaces the replacement text.

   This document also replaces incorrect references to the
   publicKeyAlgorithms field in <a href="#section-3">Section 3</a> with references to the
   parameters field in the subjectPublicKeyInfo algorithm field.
   <a href="#section-3">Section 3</a> also rewords the second and third paragraphs for clarity.








<span class="grey">Turner, et al.              Standards Track                     [Page 2]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-3"></span>
<span class="grey"><a href="./rfc5756">RFC 5756</a>                    <a href="./rfc4055">RFC 4055</a> Update                 January 2010</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/1.1.%20%20Conventions%20Used%20in%20This%20Document"></a><a class="selflink" href="#section-1.1" id="section-1.1">1.1</a>.  Conventions Used in This Document</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [<a href="./rfc2119" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/2.%20%20Changes%20to%20Section%203%20%28Second%20and%20Third%20Paragraphs%29"></a><a class="selflink" href="#section-2" id="section-2">2</a>.  Changes to <a href="#section-3">Section 3</a> (Second and Third Paragraphs)</span>

   This change clarifies the placement of RSASSA-PSS-params in the
   signature, signatureAlgorithm, and subjectPublicKeyInfo fields for
   certification authority (CA) and end-entity (EE) certificates.  It
   also clarifies the placement of RSASSA-PSS-params in the
   signatureAlgorithm field in certificate revocation lists (CRLs).

   Old:

   CAs that issue certificates with the id-RSASSA-PSS algorithm
   identifier SHOULD require the presence of parameters in the
   publicKeyAlgorithms field if the cA boolean flag is set in the basic
   constraints certificate extension.  CAs MAY require that the
   parameters be present in the publicKeyAlgorithms field for end-entity
   certificates.

   CAs that use the RSASSA-PSS algorithm for signing certificates SHOULD
   include RSASSA-PSS-params in the subjectPublicKeyInfo algorithm
   parameters in their own certificates.  CAs that use the RSASSA-PSS
   algorithm for signing certificates or CRLs MUST include RSASSA-PSS-
   params in the signatureAlgorithm parameters in the TBSCertificate or
   TBSCertList structures.

   New:

   When the id-RSASSA-PSS object identifier appears in the
   TBSCertificate or TBSCertList signature algorithm field, then the
   RSASSA-PSS-params structure MUST be included in the TBSCertificate or
   TBSCertList signature parameters field.

   When the id-RSASSA-PSS object identifier appears in the
   TBSCertificate subjectPublicKeyInfo algorithm field of CA
   certificates, then the parameters field SHOULD include the RSASSA-
   PSS-params structure.  When the id-RSASSA-PSS object identifier
   appears in the TBSCertificate subjectPublicKeyInfo algorithm field of
   EE certificates, then the parameters field MAY include the RSASSA-
   PSS-params structure.







<span class="grey">Turner, et al.              Standards Track                     [Page 3]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-4"></span>
<span class="grey"><a href="./rfc5756">RFC 5756</a>                    <a href="./rfc4055">RFC 4055</a> Update                 January 2010</span>


   All certificates and CRLs signed by a CA that supports the id-RSASSA-
   PSS algorithm MUST include the RSASSA-PSS-params in the
   signatureAlgorithm parameters in Certificate and CertList structures,
   respectively.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/3.%20%20Changes%20to%20Section%204%20%28Second%20Paragraph%29"></a><a class="selflink" href="#section-3" id="section-3">3</a>.  Changes to <a href="#section-4">Section 4</a> (Second Paragraph)</span>

   This change prohibits the inclusion of RSAES-OAEP-params in the
   subjectPublicKeyInfo field.  This was done because a) it does not
   affect interoperability and b) it aligns with PKIX practice to not
   include limitations on how the public key can be used in
   subjectPublicKeyInfo.  A poll of implementers was taken and there
   were no objections to this change as it did not affect current
   implementations.

   Old:

   CAs that issue certificates with the id-RSAES-OAEP algorithm
   identifier SHOULD require the presence of parameters in the
   publicKeyAlgorithms field for all certificates.  Entities that use a
   certificate with a publicKeyAlgorithm value of id-RSA-OAEP where the
   parameters are absent SHOULD use the default set of parameters for
   RSAES-OAEP-params.  Entities that use a certificate with a
   publicKeyAlgorithm value of rsaEncryption SHOULD use the default set
   of parameters for RSAES-OAEP-params.

   New:

   CAs that issue certificates with the id-RSAES-OAEP algorithm
   identifier MUST NOT include parameters in the subjectPublicKeyInfo
   algorithm field.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/4.%20%20Changes%20to%20Section%204.1%20%28First%20Paragraph%29"></a><a class="selflink" href="#section-4" id="section-4">4</a>.  Changes to <a href="#section-4.1">Section 4.1</a> (First Paragraph)</span>

   This change prohibits the inclusion of parameters in the
   subjectPublicKeyInfo field.  This was done because a) it does not
   affect interoperability and b) it aligns with PKIX practice to not
   include limitations on how the public key can be used in
   subjectPublicKeyInfo.  A poll of implementers was taken and there
   were no objections to this change as it did not affect current
   implementations.

   Old:

   When id-RSAES-OAEP is used in an AlgorithmIdentifier, the parameters
   MUST employ the RSAES-OAEP-params syntax.  The parameters may be
   either absent or present when used as subject public key information.




<span class="grey">Turner, et al.              Standards Track                     [Page 4]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-5"></span>
<span class="grey"><a href="./rfc5756">RFC 5756</a>                    <a href="./rfc4055">RFC 4055</a> Update                 January 2010</span>


   The parameters MUST be present when used in the algorithm identifier
   associated with an encrypted value.

   New:

   When id-RSAES-OAEP is used in an AlgorithmIdentifier, the parameters
   MUST employ the RSAES-OAEP-params syntax.  The parameters MUST be
   absent when used in the subjectPublicKeyInfo field.  The parameters
   MUST be present when used in the algorithm identifier associated with
   an encrypted value.

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/5.%20%20Security%20Considerations"></a><a class="selflink" href="#section-5" id="section-5">5</a>.  Security Considerations</span>

   The security considerations from [<a href="./rfc4055" title='"Additional Algorithms and Identifiers for RSA Cryptography for use in the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"'>RFC4055</a>] apply.

   If the RSAES-OAEP-params are negotiated, then the negotiation
   mechanism needs to provide integrity for these parameters.  For
   example, an S/MIME Agent can advertise their capabilities in the
   SMIMECapabilities attribute, which is either a signed attribute
   [<a href="./rfc5751" title='"Secure/Multipurpose Internet Mail Extensions (S/MIME) Version 3.2 Message Specification"'>RFC5751</a>] or a certificate extension [<a href="./rfc4262" title='"X.509 Certificate Extension for Secure/Multipurpose Internet Mail Extensions (S/MIME) Capabilities"'>RFC4262</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/cpp/Section/6.%20%20References"></a><a class="selflink" href="#section-6" id="section-6">6</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/6.1.%20%20Normative%20References"></a><a class="selflink" href="#section-6.1" id="section-6.1">6.1</a>.  Normative References</span>

   [<a id="ref-RFC2119">RFC2119</a>]     Bradner, S., "Key words for use in RFCs to Indicate
                 Requirement Levels", <a href="https://www.rfc-editor.org/bcp/bcp14">BCP 14</a>, <a href="./rfc2119">RFC 2119</a>, March 1997.

   [<a id="ref-RFC4055">RFC4055</a>]     Schaad, J., Kaliski, B., and R. Housley, "Additional
                 Algorithms and Identifiers for RSA Cryptography for use
                 in the Internet X.509 Public Key Infrastructure
                 Certificate and Certificate Revocation List (CRL)
                 Profile", <a href="./rfc4055">RFC 4055</a>, June 2005.

<span class="h3"><a class="dashAnchor" name="//apple_ref/cpp/Section/6.2.%20%20Informative%20References"></a><a class="selflink" href="#section-6.2" id="section-6.2">6.2</a>.  Informative References</span>

   [<a id="ref-RFC4262">RFC4262</a>]     Santesson, S., "X.509 Certificate Extension for
                 Secure/Multipurpose Internet Mail Extensions (S/MIME)
                 Capabilities", <a href="./rfc4262">RFC 4262</a>, December 2005.

   [<a id="ref-RFC5751">RFC5751</a>]     Ramsdell, B. and S. Turner, "Secure/Multipurpose
                 Internet Mail Extensions (S/MIME) Version 3.2 Message
                 Specification", <a href="./rfc5751">RFC 5751</a>, January 2010.








<span class="grey">Turner, et al.              Standards Track                     [Page 5]</span></pre>
<hr class="noprint"/><!--NewPage--><pre class="newpage"><span id="page-6"></span>
<span class="grey"><a href="./rfc5756">RFC 5756</a>                    <a href="./rfc4055">RFC 4055</a> Update                 January 2010</span>


Authors' Addresses

   Sean Turner
   IECA, Inc.
   3057 Nutley Street, Suite 106
   Fairfax, VA 22031
   USA

   EMail: turners@ieca.com


   Kelvin Yiu
   Microsoft
   One Microsoft Way
   Redmond, WA 98052-6399
   USA

   EMail: kelviny@microsoft.com


   Daniel R. L. Brown
   Certicom Corp
   5520 Explorer Drive #400
   Mississauga, ON L4W 5L1
   CANADA

   EMail: dbrown@certicom.com


   Russ Housley
   Vigil Security, LLC
   918 Spring Knoll Drive
   Herndon, VA 20170
   USA

   EMail: housley@vigilsec.com


   Tim Polk
   NIST
   Building 820, Room 426
   Gaithersburg, MD 20899
   USA

   EMail: wpolk@nist.gov






Turner, et al.              Standards Track                     [Page 6]
</pre>
</body></html>