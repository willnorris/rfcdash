<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 9250: DNS over Dedicated QUIC Connections</title>
<meta content="Christian Huitema" name="author"/>
<meta content="Sara Dickinson" name="author"/>
<meta content="Allison Mankin" name="author"/>
<meta content="
       This document describes the use of QUIC to provide transport confidentiality for DNS.
The encryption provided by QUIC has similar properties to those provided by TLS,
while QUIC transport eliminates the head-of-line blocking issues inherent with
TCP and provides more efficient packet-loss recovery than UDP. DNS over QUIC
(DoQ) has privacy properties similar to DNS over TLS (DoT) specified in
RFC 7858, and latency characteristics similar to classic DNS over UDP. This
specification describes the use of DoQ as a general-purpose transport
for DNS and includes the use of DoQ for stub to recursive,
recursive to authoritative, and zone transfer scenarios. 
    " name="description"/>
<meta content="xml2rfc 3.12.6" name="generator"/>
<meta content="DNS" name="keyword"/>
<meta content="QUIC" name="keyword"/>
<meta content="DNS over QUIC" name="keyword"/>
<meta content="Encrypted DNS" name="keyword"/>
<meta content="DoQ" name="keyword"/>
<meta content="9250" name="rfc.number"/>
<!-- Generator version information:
  xml2rfc 3.12.6
    Python 3.6.15
    appdirs 1.4.4
    ConfigArgParse 1.4.1
    google-i18n-address 2.4.0
    html5lib 1.0.1
    intervaltree 3.0.2
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.4.2
    MarkupSafe 2.0.1
    pycairo 1.15.1
    pycountry 19.8.18
    pyflakes 2.1.1
    PyYAML 5.4.1
    requests 2.24.0
    setuptools 40.5.0
    six 1.14.0
    WeasyPrint 52.5
-->
<link href="rfc9250.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  pre.breakable {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://dx.doi.org/10.17487/rfc9250" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  <link href="https://datatracker.ietf.org/doc/draft-ietf-dprive-dnsoquic-11" rel="prev"/>
  </head>
<body>
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9250</td>
<td class="center">DNS over Dedicated QUIC</td>
<td class="right">May 2022</td>
</tr></thead>
<tfoot><tr>
<td class="left">Huitema, et al.</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc9250">9250</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2022-05">May 2022</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">C. Huitema</div>
<div class="org">Private Octopus Inc.</div>
</div>
<div class="author">
      <div class="author-name">S. Dickinson</div>
<div class="org">Sinodun IT</div>
</div>
<div class="author">
      <div class="author-name">A. Mankin</div>
<div class="org">Salesforce</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9250</h1>
<h1 id="title">DNS over Dedicated QUIC Connections</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">This document describes the use of QUIC to provide transport confidentiality for DNS.
The encryption provided by QUIC has similar properties to those provided by TLS,
while QUIC transport eliminates the head-of-line blocking issues inherent with
TCP and provides more efficient packet-loss recovery than UDP. DNS over QUIC
(DoQ) has privacy properties similar to DNS over TLS (DoT) specified in
RFC 7858, and latency characteristics similar to classic DNS over UDP. This
specification describes the use of DoQ as a general-purpose transport
for DNS and includes the use of DoQ for stub to recursive,
recursive to authoritative, and zone transfer scenarios.<a class="pilcrow" href="#section-abstract-1">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a class="pilcrow" href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9250">https://www.rfc-editor.org/info/rfc9250</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">▲</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p class="keepWithNext" id="section-toc.1-1.1.1"><a class="xref" href="#section-1">1</a>.  <a class="xref" href="#name-introduction">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p class="keepWithNext" id="section-toc.1-1.2.1"><a class="xref" href="#section-2">2</a>.  <a class="xref" href="#name-key-words">Key Words</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a class="xref" href="#section-3">3</a>.  <a class="xref" href="#name-design-considerations">Design Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p class="keepWithNext" id="section-toc.1-1.3.2.1.1"><a class="xref" href="#section-3.1">3.1</a>.  <a class="xref" href="#name-provide-dns-privacy">Provide DNS Privacy</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a class="xref" href="#section-3.2">3.2</a>.  <a class="xref" href="#name-design-for-minimum-latency">Design for Minimum Latency</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a class="xref" href="#section-3.3">3.3</a>.  <a class="xref" href="#name-middlebox-considerations">Middlebox Considerations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a class="xref" href="#section-3.4">3.4</a>.  <a class="xref" href="#name-no-server-initiated-transac">No Server-Initiated Transactions</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="xref" href="#section-4">4</a>.  <a class="xref" href="#name-specifications">Specifications</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a class="xref" href="#section-4.1">4.1</a>.  <a class="xref" href="#name-connection-establishment">Connection Establishment</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.1">
                    <p id="section-toc.1-1.4.2.1.2.1.1"><a class="xref" href="#section-4.1.1">4.1.1</a>.  <a class="xref" href="#name-port-selection">Port Selection</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a class="xref" href="#section-4.2">4.2</a>.  <a class="xref" href="#name-stream-mapping-and-usage">Stream Mapping and Usage</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a class="xref" href="#section-4.2.1">4.2.1</a>.  <a class="xref" href="#name-dns-message-ids">DNS Message IDs</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a class="xref" href="#section-4.3">4.3</a>.  <a class="xref" href="#name-doq-error-codes">DoQ Error Codes</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.1">
                    <p id="section-toc.1-1.4.2.3.2.1.1"><a class="xref" href="#section-4.3.1">4.3.1</a>.  <a class="xref" href="#name-transaction-cancellation">Transaction Cancellation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.2">
                    <p id="section-toc.1-1.4.2.3.2.2.1"><a class="xref" href="#section-4.3.2">4.3.2</a>.  <a class="xref" href="#name-transaction-errors">Transaction Errors</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.3">
                    <p id="section-toc.1-1.4.2.3.2.3.1"><a class="xref" href="#section-4.3.3">4.3.3</a>.  <a class="xref" href="#name-protocol-errors">Protocol Errors</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.4">
                    <p id="section-toc.1-1.4.2.3.2.4.1"><a class="xref" href="#section-4.3.4">4.3.4</a>.  <a class="xref" href="#name-alternative-error-codes">Alternative Error Codes</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a class="xref" href="#section-4.4">4.4</a>.  <a class="xref" href="#name-connection-management">Connection Management</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a class="xref" href="#section-4.5">4.5</a>.  <a class="xref" href="#name-session-resumption-and-0-rt">Session Resumption and 0-RTT</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.6">
                <p id="section-toc.1-1.4.2.6.1"><a class="xref" href="#section-4.6">4.6</a>.  <a class="xref" href="#name-message-sizes">Message Sizes</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="xref" href="#section-5">5</a>.  <a class="xref" href="#name-implementation-requirements">Implementation Requirements</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a class="xref" href="#section-5.1">5.1</a>.  <a class="xref" href="#name-authentication">Authentication</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a class="xref" href="#section-5.2">5.2</a>.  <a class="xref" href="#name-fallback-to-other-protocols">Fallback to Other Protocols on Connection Failure</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a class="xref" href="#section-5.3">5.3</a>.  <a class="xref" href="#name-address-validation">Address Validation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a class="xref" href="#section-5.4">5.4</a>.  <a class="xref" href="#name-padding">Padding</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5">
                <p id="section-toc.1-1.5.2.5.1"><a class="xref" href="#section-5.5">5.5</a>.  <a class="xref" href="#name-connection-handling">Connection Handling</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5.2.1">
                    <p id="section-toc.1-1.5.2.5.2.1.1"><a class="xref" href="#section-5.5.1">5.5.1</a>.  <a class="xref" href="#name-connection-reuse">Connection Reuse</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5.2.2">
                    <p id="section-toc.1-1.5.2.5.2.2.1"><a class="xref" href="#section-5.5.2">5.5.2</a>.  <a class="xref" href="#name-resource-management">Resource Management</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5.2.3">
                    <p id="section-toc.1-1.5.2.5.2.3.1"><a class="xref" href="#section-5.5.3">5.5.3</a>.  <a class="xref" href="#name-using-0-rtt-and-session-res">Using 0-RTT and Session Resumption</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5.2.4">
                    <p id="section-toc.1-1.5.2.5.2.4.1"><a class="xref" href="#section-5.5.4">5.5.4</a>.  <a class="xref" href="#name-controlling-connection-migr">Controlling Connection Migration for Privacy</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.6">
                <p id="section-toc.1-1.5.2.6.1"><a class="xref" href="#section-5.6">5.6</a>.  <a class="xref" href="#name-processing-queries-in-paral">Processing Queries in Parallel</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.7">
                <p id="section-toc.1-1.5.2.7.1"><a class="xref" href="#section-5.7">5.7</a>.  <a class="xref" href="#name-zone-transfer">Zone Transfer</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.8">
                <p id="section-toc.1-1.5.2.8.1"><a class="xref" href="#section-5.8">5.8</a>.  <a class="xref" href="#name-flow-control-mechanisms">Flow Control Mechanisms</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="xref" href="#section-6">6</a>.  <a class="xref" href="#name-security-considerations">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="xref" href="#section-7">7</a>.  <a class="xref" href="#name-privacy-considerations">Privacy Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a class="xref" href="#section-7.1">7.1</a>.  <a class="xref" href="#name-privacy-issues-with-0-rtt-d">Privacy Issues with 0-RTT data</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a class="xref" href="#section-7.2">7.2</a>.  <a class="xref" href="#name-privacy-issues-with-session">Privacy Issues with Session Resumption</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a class="xref" href="#section-7.3">7.3</a>.  <a class="xref" href="#name-privacy-issues-with-address">Privacy Issues with Address Validation Tokens</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a class="xref" href="#section-7.4">7.4</a>.  <a class="xref" href="#name-privacy-issues-with-long-du">Privacy Issues with Long Duration Sessions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5">
                <p id="section-toc.1-1.7.2.5.1"><a class="xref" href="#section-7.5">7.5</a>.  <a class="xref" href="#name-traffic-analysis">Traffic Analysis</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="xref" href="#section-8">8</a>.  <a class="xref" href="#name-iana-considerations">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a class="xref" href="#section-8.1">8.1</a>.  <a class="xref" href="#name-registration-of-a-doq-ident">Registration of a DoQ Identification String</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a class="xref" href="#section-8.2">8.2</a>.  <a class="xref" href="#name-reservation-of-a-dedicated-">Reservation of a Dedicated Port</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a class="xref" href="#section-8.3">8.3</a>.  <a class="xref" href="#name-reservation-of-an-extended-">Reservation of an Extended DNS Error Code: Too Early</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4">
                <p id="section-toc.1-1.8.2.4.1"><a class="xref" href="#section-8.4">8.4</a>.  <a class="xref" href="#name-dns-over-quic-error-codes-r">DNS-over-QUIC Error Codes Registry</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="xref" href="#section-9">9</a>.  <a class="xref" href="#name-references">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a class="xref" href="#section-9.1">9.1</a>.  <a class="xref" href="#name-normative-references">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a class="xref" href="#section-9.2">9.2</a>.  <a class="xref" href="#name-informative-references">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a class="xref" href="#appendix-A">Appendix A</a>.  <a class="xref" href="#name-the-notify-service">The NOTIFY Service</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a class="xref" href="#appendix-B"></a><a class="xref" href="#name-acknowledgements">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a class="xref" href="#appendix-C"></a><a class="xref" href="#name-authors-addresses">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<p id="section-1-1">Domain Name System (DNS) concepts are specified in "Domain names - concepts and
facilities" <span>[<a class="xref" href="#RFC1034">RFC1034</a>]</span>. The transmission of DNS queries and responses over
UDP and TCP is specified in "Domain names - implementation and specification"
<span>[<a class="xref" href="#RFC1035">RFC1035</a>]</span>.<a class="pilcrow" href="#section-1-1">¶</a></p>
<p id="section-1-2">This document presents a mapping of the DNS protocol over the
QUIC transport <span>[<a class="xref" href="#RFC9000">RFC9000</a>]</span> <span>[<a class="xref" href="#RFC9001">RFC9001</a>]</span>. DNS over QUIC is referred to here as DoQ,
in line with "DNS Terminology" <span>[<a class="xref" href="#I-D.ietf-dnsop-rfc8499bis">DNS-TERMS</a>]</span>.<a class="pilcrow" href="#section-1-2">¶</a></p>
<p id="section-1-3">The goals of the DoQ mapping are:<a class="pilcrow" href="#section-1-3">¶</a></p>
<ol class="normal type-1" id="section-1-4" start="1" type="1">
<li id="section-1-4.1">Provide the same DNS privacy protection as DoT
<span>[<a class="xref" href="#RFC7858">RFC7858</a>]</span>. This includes an option for the client to
authenticate the server by means of an authentication domain
name as specified in "Usage Profiles for DNS over TLS and DNS
over DTLS" <span>[<a class="xref" href="#RFC8310">RFC8310</a>]</span>.<a class="pilcrow" href="#section-1-4.1">¶</a>
</li>
        <li id="section-1-4.2">Provide an improved level of source address validation for DNS
servers compared to classic DNS over UDP.<a class="pilcrow" href="#section-1-4.2">¶</a>
</li>
        <li id="section-1-4.3">Provide a transport that does not impose path MTU limitations on the
size of DNS responses it can send.<a class="pilcrow" href="#section-1-4.3">¶</a>
</li>
      </ol>
<p id="section-1-5">In order to achieve these goals, and to support ongoing work on encryption of
DNS, the scope of this document includes:<a class="pilcrow" href="#section-1-5">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-6.1">the "stub to recursive resolver" scenario (also called the "stub to recursive" scenario in this document)<a class="pilcrow" href="#section-1-6.1">¶</a>
</li>
        <li class="normal" id="section-1-6.2">the "recursive resolver to authoritative nameserver" scenario (also called the "recursive to authoritative" scenario in this document), and<a class="pilcrow" href="#section-1-6.2">¶</a>
</li>
        <li class="normal" id="section-1-6.3">the "nameserver to nameserver" scenario (mainly used for zone transfers (XFR) <span>[<a class="xref" href="#RFC1995">RFC1995</a>]</span> <span>[<a class="xref" href="#RFC5936">RFC5936</a>]</span>).<a class="pilcrow" href="#section-1-6.3">¶</a>
</li>
      </ul>
<p id="section-1-7">In other words, this document specifies QUIC as a general-purpose
transport for DNS.<a class="pilcrow" href="#section-1-7">¶</a></p>
<p id="section-1-8">The specific non-goals of this document are:<a class="pilcrow" href="#section-1-8">¶</a></p>
<ol class="normal type-1" id="section-1-9" start="1" type="1">
<li id="section-1-9.1">No attempt is made to evade potential blocking of DoQ
traffic by middleboxes.<a class="pilcrow" href="#section-1-9.1">¶</a>
</li>
        <li id="section-1-9.2">No attempt to support server-initiated transactions, which are used only in
DNS Stateful Operations (DSO) <span>[<a class="xref" href="#RFC8490">RFC8490</a>]</span>.<a class="pilcrow" href="#section-1-9.2">¶</a>
</li>
      </ol>
<p id="section-1-10">Specifying the transmission of an application over QUIC requires specifying how
the application's messages are mapped to QUIC streams, and generally how the
application will use QUIC. This is done for HTTP in "Hypertext Transfer
Protocol Version 3 (HTTP/3)" <span>[<a class="xref" href="#I-D.ietf-quic-http">HTTP/3</a>]</span>. The purpose of this
document is to define the way DNS messages can be transmitted over QUIC.<a class="pilcrow" href="#section-1-10">¶</a></p>
<p id="section-1-11">DNS over HTTPS (DoH) <span>[<a class="xref" href="#RFC8484">RFC8484</a>]</span> can be used with HTTP/3 to get some of the
benefits of QUIC. However, a lightweight direct mapping for DoQ can
be regarded as a more natural fit for both the recursive to authoritative and
zone transfer scenarios, which rarely involve intermediaries. In these
scenarios, the additional overhead of HTTP is not offset by, for example, benefits of
HTTP proxying and caching behavior.<a class="pilcrow" href="#section-1-11">¶</a></p>
<p id="section-1-12">In this document, <a class="xref" href="#design-considerations">Section 3</a> presents the reasoning that guided
the proposed design. <a class="xref" href="#specifications">Section 4</a> specifies the actual mapping of DoQ.
<a class="xref" href="#implementation-requirements">Section 5</a> presents guidelines on the implementation,
usage, and deployment of DoQ.<a class="pilcrow" href="#section-1-12">¶</a></p>
</section>
</div>
<div id="key-words">
<section id="section-2">
      <h2 id="name-key-words">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-key-words">Key Words</a>
      </h2>
<p id="section-2-1">                                                                                                
    The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>",
    "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>",
    "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
    "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are
    to be interpreted as described in BCP 14 <span>[<a class="xref" href="#RFC2119">RFC2119</a>]</span>
        <span>[<a class="xref" href="#RFC8174">RFC8174</a>]</span> when, and only when, they appear in all capitals,
    as shown here.<a class="pilcrow" href="#section-2-1">¶</a></p>
</section>
</div>
<div id="design-considerations">
<section id="section-3">
      <h2 id="name-design-considerations">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-design-considerations">Design Considerations</a>
      </h2>
<p id="section-3-1">This section and its subsections present the design guidelines that were used
for DoQ. While all other sections in this document are normative, this section
is informative in nature.<a class="pilcrow" href="#section-3-1">¶</a></p>
<div id="provide-dns-privacy">
<section id="section-3.1">
        <h3 id="name-provide-dns-privacy">
<a class="section-number selfRef" href="#section-3.1">3.1. </a><a class="section-name selfRef" href="#name-provide-dns-privacy">Provide DNS Privacy</a>
        </h3>
<p id="section-3.1-1">DoT <span>[<a class="xref" href="#RFC7858">RFC7858</a>]</span> defines how to mitigate some of the issues described in "DNS
Privacy Considerations" <span>[<a class="xref" href="#RFC9076">RFC9076</a>]</span> by specifying how to transmit DNS messages
over TLS. The "Usage Profiles for DNS over TLS and DNS over DTLS" <span>[<a class="xref" href="#RFC8310">RFC8310</a>]</span>
specify Strict and Opportunistic usage profiles for DoT including how stub
resolvers can authenticate recursive resolvers.<a class="pilcrow" href="#section-3.1-1">¶</a></p>
<p id="section-3.1-2">QUIC connection setup includes the negotiation of security parameters using
TLS, as specified in "Using TLS to Secure QUIC" <span>[<a class="xref" href="#RFC9001">RFC9001</a>]</span>,
enabling encryption of the QUIC transport. Transmitting DNS messages over QUIC
will provide essentially the same privacy protections as DoT <span>[<a class="xref" href="#RFC7858">RFC7858</a>]</span>
including Strict and Opportunistic usage profiles <span>[<a class="xref" href="#RFC8310">RFC8310</a>]</span>. Further
discussion on this is provided in <a class="xref" href="#privacy-considerations">Section 7</a>.<a class="pilcrow" href="#section-3.1-2">¶</a></p>
</section>
</div>
<div id="design-for-minimum-latency">
<section id="section-3.2">
        <h3 id="name-design-for-minimum-latency">
<a class="section-number selfRef" href="#section-3.2">3.2. </a><a class="section-name selfRef" href="#name-design-for-minimum-latency">Design for Minimum Latency</a>
        </h3>
<p id="section-3.2-1">QUIC is specifically designed to reduce protocol-induced delays, with features
such as:<a class="pilcrow" href="#section-3.2-1">¶</a></p>
<ol class="normal type-1" id="section-3.2-2" start="1" type="1">
<li id="section-3.2-2.1">Support for 0-RTT data during session resumption.<a class="pilcrow" href="#section-3.2-2.1">¶</a>
</li>
          <li id="section-3.2-2.2">Support for advanced packet-loss recovery procedures as specified in
"QUIC Loss Detection and Congestion Control" <span>[<a class="xref" href="#RFC9002">RFC9002</a>]</span>.<a class="pilcrow" href="#section-3.2-2.2">¶</a>
</li>
          <li id="section-3.2-2.3">Mitigation of head-of-line blocking by allowing parallel
delivery of data on multiple streams.<a class="pilcrow" href="#section-3.2-2.3">¶</a>
</li>
        </ol>
<p id="section-3.2-3">This mapping of DNS to QUIC will take advantage of these features in
three ways:<a class="pilcrow" href="#section-3.2-3">¶</a></p>
<ol class="normal type-1" id="section-3.2-4" start="1" type="1">
<li id="section-3.2-4.1">Optional support for sending 0-RTT data during session resumption
(the security and privacy implications of this are discussed
in later sections).<a class="pilcrow" href="#section-3.2-4.1">¶</a>
</li>
          <li id="section-3.2-4.2">Long-lived QUIC connections over which multiple DNS transactions
are performed,
generating the sustained traffic required to benefit from
advanced recovery features.<a class="pilcrow" href="#section-3.2-4.2">¶</a>
</li>
          <li id="section-3.2-4.3">Mapping of each DNS Query/Response transaction to a separate stream,
to mitigate head-of-line blocking. This enables servers to respond
to queries "out of order". It also enables clients to process
responses as soon as they arrive, without having to wait for in-order delivery of responses previously posted by the server.<a class="pilcrow" href="#section-3.2-4.3">¶</a>
</li>
        </ol>
<p id="section-3.2-5">These considerations are reflected in the mapping of DNS traffic
to QUIC streams in <a class="xref" href="#stream-mapping-and-usage">Section 4.2</a>.<a class="pilcrow" href="#section-3.2-5">¶</a></p>
</section>
</div>
<div id="middlebox-considerations">
<section id="section-3.3">
        <h3 id="name-middlebox-considerations">
<a class="section-number selfRef" href="#section-3.3">3.3. </a><a class="section-name selfRef" href="#name-middlebox-considerations">Middlebox Considerations</a>
        </h3>
<p id="section-3.3-1">Using QUIC might allow a protocol to disguise its purpose from devices on the
network path using encryption and traffic analysis resistance techniques like
padding, traffic pacing, and traffic shaping. This specification does not
include any measures that are designed to avoid such classification;
the padding mechanisms defined in <a class="xref" href="#padding">Section 5.4</a> are intended to obfuscate the specific
records contained in DNS queries and responses, but not the fact that this is DNS traffic.
Consequently, firewalls and other middleboxes might
be able to distinguish DoQ from other protocols that use QUIC, like HTTP, and
apply different treatment.<a class="pilcrow" href="#section-3.3-1">¶</a></p>
<p id="section-3.3-2">The lack of measures in this specification to avoid protocol classification is 
not an endorsement of such practices.<a class="pilcrow" href="#section-3.3-2">¶</a></p>
</section>
</div>
<div id="no-server-initiated-transactions">
<section id="section-3.4">
        <h3 id="name-no-server-initiated-transac">
<a class="section-number selfRef" href="#section-3.4">3.4. </a><a class="section-name selfRef" href="#name-no-server-initiated-transac">No Server-Initiated Transactions</a>
        </h3>
<p id="section-3.4-1">As stated in <a class="xref" href="#introduction">Section 1</a>, this document does not specify support for
server-initiated transactions within established DoQ connections. That is, only
the initiator of the DoQ connection may send queries over the connection.<a class="pilcrow" href="#section-3.4-1">¶</a></p>
<p id="section-3.4-2">DSO does support server-initiated transactions within existing connections.
However, DoQ as defined here does not meet the criteria for an applicable
transport for DSO because it does not guarantee in-order delivery of messages;
see <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8490#section-4.2">Section 4.2</a> of [<a class="xref" href="#RFC8490">RFC8490</a>]</span>.<a class="pilcrow" href="#section-3.4-2">¶</a></p>
</section>
</div>
</section>
</div>
<div id="specifications">
<section id="section-4">
      <h2 id="name-specifications">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-specifications">Specifications</a>
      </h2>
<div id="connection-establishment">
<section id="section-4.1">
        <h3 id="name-connection-establishment">
<a class="section-number selfRef" href="#section-4.1">4.1. </a><a class="section-name selfRef" href="#name-connection-establishment">Connection Establishment</a>
        </h3>
<p id="section-4.1-1">DoQ connections are established as described in the QUIC transport
specification <span>[<a class="xref" href="#RFC9000">RFC9000</a>]</span>. During connection establishment, DoQ support is
indicated by selecting the Application-Layer Protocol Negotiation (ALPN) token "doq" in the crypto handshake.<a class="pilcrow" href="#section-4.1-1">¶</a></p>
<div id="port-selection">
<section id="section-4.1.1">
          <h4 id="name-port-selection">
<a class="section-number selfRef" href="#section-4.1.1">4.1.1. </a><a class="section-name selfRef" href="#name-port-selection">Port Selection</a>
          </h4>
<p id="section-4.1.1-1">By default, a DNS server that supports DoQ <span class="bcp14">MUST</span> listen for and accept QUIC
connections on the dedicated UDP port 853 (<a class="xref" href="#iana-considerations">Section 8</a>), unless there is a mutual agreement to
use another port.<a class="pilcrow" href="#section-4.1.1-1">¶</a></p>
<p id="section-4.1.1-2">By default, a DNS client desiring to use DoQ with a particular server <span class="bcp14">MUST</span>
establish a QUIC connection to UDP port 853 on the server, unless there is a
mutual agreement to use another port.<a class="pilcrow" href="#section-4.1.1-2">¶</a></p>
<p id="section-4.1.1-3">DoQ connections <span class="bcp14">MUST NOT</span> use UDP port 53. This recommendation against use of
port 53 for DoQ is to avoid confusion between DoQ and the use of DNS over UDP
<span>[<a class="xref" href="#RFC1035">RFC1035</a>]</span>. The risk of confusion exists even if two parties agreed on
port 53, as other parties without knowledge of that agreement might still
try to use that port.<a class="pilcrow" href="#section-4.1.1-3">¶</a></p>
<p id="section-4.1.1-4">In the stub to recursive scenario, the use of port 443 as a mutually agreed
alternative port can be operationally beneficial, since port 443 is 
used by many services using QUIC and HTTP-3 and is thus less likely
to be blocked than other ports. Several mechanisms for stubs to discover
recursives offering encrypted transports, including the use of custom ports, are
the subject of ongoing work.<a class="pilcrow" href="#section-4.1.1-4">¶</a></p>
</section>
</div>
</section>
</div>
<div id="stream-mapping-and-usage">
<section id="section-4.2">
        <h3 id="name-stream-mapping-and-usage">
<a class="section-number selfRef" href="#section-4.2">4.2. </a><a class="section-name selfRef" href="#name-stream-mapping-and-usage">Stream Mapping and Usage</a>
        </h3>
<p id="section-4.2-1">The mapping of DNS traffic over QUIC streams takes advantage of the QUIC stream
features detailed in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9000#section-2">Section 2</a> of [<a class="xref" href="#RFC9000">RFC9000</a>]</span>, the QUIC transport specification.<a class="pilcrow" href="#section-4.2-1">¶</a></p>
<p id="section-4.2-2">DNS query/response traffic <span>[<a class="xref" href="#RFC1034">RFC1034</a>]</span> <span>[<a class="xref" href="#RFC1035">RFC1035</a>]</span>
follows a simple pattern in which the client sends a query, and the
server provides one or more responses (multiple responses can occur in zone
transfers).<a class="pilcrow" href="#section-4.2-2">¶</a></p>
<p id="section-4.2-3">The mapping specified here requires that the client select a separate QUIC
stream for each query. The server then uses the same stream to provide all the
response messages for that query. In order for multiple responses to be
parsed, a 2-octet length field is used in exactly the same way as the 2-octet
length field defined for DNS over TCP <span>[<a class="xref" href="#RFC1035">RFC1035</a>]</span>. The practical result of this
is that the content of each QUIC stream is exactly the same as the content of a
TCP connection that would manage exactly one query.<a class="pilcrow" href="#section-4.2-3">¶</a></p>
<p id="section-4.2-4">All DNS messages (queries and responses) sent over DoQ connections <span class="bcp14">MUST</span> be
encoded as a 2-octet length field followed by the message content as specified
in <span>[<a class="xref" href="#RFC1035">RFC1035</a>]</span>.<a class="pilcrow" href="#section-4.2-4">¶</a></p>
<p id="section-4.2-5">The client <span class="bcp14">MUST</span> select the next available client-initiated bidirectional stream
for each subsequent query on a QUIC connection, in conformance with the QUIC
transport specification <span>[<a class="xref" href="#RFC9000">RFC9000</a>]</span>. Packet losses and other network events might
cause queries to arrive in a different order. Servers <span class="bcp14">SHOULD</span> process queries
as they arrive, as not doing so would cause unnecessary delays.<a class="pilcrow" href="#section-4.2-5">¶</a></p>
<p id="section-4.2-6">The client <span class="bcp14">MUST</span> send the DNS query over the selected stream and <span class="bcp14">MUST</span> indicate
through the STREAM FIN mechanism that no further data will be sent on that
stream.<a class="pilcrow" href="#section-4.2-6">¶</a></p>
<p id="section-4.2-7">The server <span class="bcp14">MUST</span> send the response(s) on the same stream and <span class="bcp14">MUST</span> indicate, after
the last response, through the STREAM FIN mechanism that no further data will be
sent on that stream.<a class="pilcrow" href="#section-4.2-7">¶</a></p>
<p id="section-4.2-8">Therefore, a single DNS transaction consumes a single bidirectional client-initiated stream.
This means that the client's first query occurs on QUIC stream 0, the second on
4, and so on (see <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9000#section-2.1">Section 2.1</a> of [<a class="xref" href="#RFC9000">RFC9000</a>]</span>).<a class="pilcrow" href="#section-4.2-8">¶</a></p>
<p id="section-4.2-9">Servers <span class="bcp14">MAY</span> defer processing of a query until the STREAM FIN has been indicated
on the stream selected by the client.<a class="pilcrow" href="#section-4.2-9">¶</a></p>
<p id="section-4.2-10">Servers and clients <span class="bcp14">MAY</span> monitor the number
of "dangling" streams. These are open streams where the following events have not 
occurred after implementation-defined timeouts:<a class="pilcrow" href="#section-4.2-10">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-11.1">the expected queries or responses have not been received or,<a class="pilcrow" href="#section-4.2-11.1">¶</a>
</li>
          <li class="normal" id="section-4.2-11.2">the expected queries or responses have been received but not the STREAM FIN<a class="pilcrow" href="#section-4.2-11.2">¶</a>
</li>
        </ul>
<p id="section-4.2-12">Implementations <span class="bcp14">MAY</span> impose a limit on the number of
 such dangling streams. If limits are encountered, implementations <span class="bcp14">MAY</span> close the connection.<a class="pilcrow" href="#section-4.2-12">¶</a></p>
<div id="dns-message-ids">
<section id="section-4.2.1">
          <h4 id="name-dns-message-ids">
<a class="section-number selfRef" href="#section-4.2.1">4.2.1. </a><a class="section-name selfRef" href="#name-dns-message-ids">DNS Message IDs</a>
          </h4>
<p id="section-4.2.1-1">When sending queries over a QUIC connection, the DNS Message ID <span class="bcp14">MUST</span> be set to
0. The stream mapping for DoQ allows for unambiguous correlation of queries
and responses, so the Message ID field is not required.<a class="pilcrow" href="#section-4.2.1-1">¶</a></p>
<p id="section-4.2.1-2">This has implications for proxying DoQ messages to and from other transports.
For example, proxies may have to manage the fact that DoQ can support a larger
number of outstanding queries on a single connection than, for example, DNS over TCP,
because DoQ is not limited by the Message ID space. This issue already exists for DoH,
where a Message ID of 0 is recommended.<a class="pilcrow" href="#section-4.2.1-2">¶</a></p>
<p id="section-4.2.1-3">When forwarding a DNS message from DoQ over another transport, a DNS Message ID
<span class="bcp14">MUST</span> be generated according to the rules of the protocol that is in use. When
forwarding a DNS message from another transport over DoQ, the Message ID <span class="bcp14">MUST</span>
be set to 0.<a class="pilcrow" href="#section-4.2.1-3">¶</a></p>
</section>
</div>
</section>
</div>
<div id="doq-error-codes">
<section id="section-4.3">
        <h3 id="name-doq-error-codes">
<a class="section-number selfRef" href="#section-4.3">4.3. </a><a class="section-name selfRef" href="#name-doq-error-codes">DoQ Error Codes</a>
        </h3>
<p id="section-4.3-1">The following error codes are defined for use when abruptly terminating streams,
for use as application protocol error codes when
aborting reading of streams, or for immediately closing connections:<a class="pilcrow" href="#section-4.3-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.3-2">
          <dt id="section-4.3-2.1">
DOQ_NO_ERROR (0x0):  </dt>
          <dd id="section-4.3-2.2" style="margin-left: 1.5em">
            <p id="section-4.3-2.2.1">No error.  This is used when the connection or stream needs to be closed, but
there is no error to signal.<a class="pilcrow" href="#section-4.3-2.2.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-4.3-2.3">
DOQ_INTERNAL_ERROR (0x1):  </dt>
          <dd id="section-4.3-2.4" style="margin-left: 1.5em">
            <p id="section-4.3-2.4.1">The DoQ implementation encountered an internal error and is incapable of
pursuing the transaction or the connection.<a class="pilcrow" href="#section-4.3-2.4.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-4.3-2.5">
DOQ_PROTOCOL_ERROR (0x2):  </dt>
          <dd id="section-4.3-2.6" style="margin-left: 1.5em">
            <p id="section-4.3-2.6.1">The DoQ implementation encountered a protocol error and is forcibly aborting
the connection.<a class="pilcrow" href="#section-4.3-2.6.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-4.3-2.7">
DOQ_REQUEST_CANCELLED (0x3):  </dt>
          <dd id="section-4.3-2.8" style="margin-left: 1.5em">
            <p id="section-4.3-2.8.1">A DoQ client uses this to signal that it wants to cancel an
outstanding transaction.<a class="pilcrow" href="#section-4.3-2.8.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-4.3-2.9">
DOQ_EXCESSIVE_LOAD (0x4):  </dt>
          <dd id="section-4.3-2.10" style="margin-left: 1.5em">
            <p id="section-4.3-2.10.1">A DoQ implementation uses this to signal when closing a connection due to excessive load.<a class="pilcrow" href="#section-4.3-2.10.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-4.3-2.11">
DOQ_UNSPECIFIED_ERROR (0x5):  </dt>
          <dd id="section-4.3-2.12" style="margin-left: 1.5em">
            <p id="section-4.3-2.12.1">A DoQ implementation uses this in the absence of a more specific error code.<a class="pilcrow" href="#section-4.3-2.12.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-4.3-2.13">
DOQ_ERROR_RESERVED (0xd098ea5e):  </dt>
          <dd id="section-4.3-2.14" style="margin-left: 1.5em">
            <p id="section-4.3-2.14.1">An alternative error code used for tests.<a class="pilcrow" href="#section-4.3-2.14.1">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.3-3">See <a class="xref" href="#iana-error-codes">Section 8.4</a> for details on registering new error codes.<a class="pilcrow" href="#section-4.3-3">¶</a></p>
<div id="transaction-cancellation">
<section id="section-4.3.1">
          <h4 id="name-transaction-cancellation">
<a class="section-number selfRef" href="#section-4.3.1">4.3.1. </a><a class="section-name selfRef" href="#name-transaction-cancellation">Transaction Cancellation</a>
          </h4>
<p id="section-4.3.1-1">In QUIC, sending STOP_SENDING requests that a peer cease transmission on a
stream. If a DoQ client wishes to cancel an outstanding request, it <span class="bcp14">MUST</span> issue
a QUIC STOP_SENDING, and it <span class="bcp14">SHOULD</span> use the error code DOQ_REQUEST_CANCELLED.
It <span class="bcp14">MAY</span> use a more specific error code registered according to <a class="xref" href="#iana-error-codes">Section 8.4</a>.
The STOP_SENDING request may be sent at
any time but will have no effect if the server response has already been
sent, in which case the client will simply discard the incoming response.
The corresponding DNS transaction <span class="bcp14">MUST</span> be abandoned.<a class="pilcrow" href="#section-4.3.1-1">¶</a></p>
<p id="section-4.3.1-2">Servers that receive STOP_SENDING act in accordance with <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9000#section-3.5">Section 3.5</a> of [<a class="xref" href="#RFC9000">RFC9000</a>]</span>. 
Servers <span class="bcp14">SHOULD NOT</span> continue processing a DNS transaction if they receive a STOP_SENDING.<a class="pilcrow" href="#section-4.3.1-2">¶</a></p>
<p id="section-4.3.1-3">Servers <span class="bcp14">MAY</span> impose implementation limits on the total number or rate of cancellation requests.
If limits are encountered, servers <span class="bcp14">MAY</span> close the connection. In this case,
servers wanting to help client debugging <span class="bcp14">MAY</span> use the error code DOQ_EXCESSIVE_LOAD.
There is always a trade-off between helping good faith clients debug issues
and allowing denial-of-service attackers to test server defenses; depending
on circumstances servers might very well choose to send different error codes.<a class="pilcrow" href="#section-4.3.1-3">¶</a></p>
<p id="section-4.3.1-4">Note that this mechanism provides a way for secondaries to cancel a single zone
transfer occurring on a given stream without having to close the QUIC
connection.<a class="pilcrow" href="#section-4.3.1-4">¶</a></p>
<p id="section-4.3.1-5">Servers <span class="bcp14">MUST NOT</span> continue processing a DNS transaction if they receive a RESET_STREAM
request from the client before the client indicates the STREAM FIN. The server <span class="bcp14">MUST</span>
issue a RESET_STREAM to indicate that the transaction is abandoned unless:<a class="pilcrow" href="#section-4.3.1-5">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.1-6.1">it has already done so for another reason or<a class="pilcrow" href="#section-4.3.1-6.1">¶</a>
</li>
            <li class="normal" id="section-4.3.1-6.2">it has already both sent the response and indicated the STREAM FIN.<a class="pilcrow" href="#section-4.3.1-6.2">¶</a>
</li>
          </ul>
</section>
</div>
<div id="transaction-errors">
<section id="section-4.3.2">
          <h4 id="name-transaction-errors">
<a class="section-number selfRef" href="#section-4.3.2">4.3.2. </a><a class="section-name selfRef" href="#name-transaction-errors">Transaction Errors</a>
          </h4>
<p id="section-4.3.2-1">Servers normally complete transactions by sending a DNS response (or responses)
on the transaction's stream, including cases where the DNS response indicates a
DNS error. 

For example, a client <span class="bcp14">SHOULD</span> be notified of a Server Failure
(SERVFAIL, <span>[<a class="xref" href="#RFC1035">RFC1035</a>]</span>) through a response with the Response Code set to
SERVFAIL.<a class="pilcrow" href="#section-4.3.2-1">¶</a></p>
<p id="section-4.3.2-2">If a server is incapable of sending a DNS response due to an internal error, it
<span class="bcp14">SHOULD</span> issue a QUIC RESET_STREAM frame. The error code <span class="bcp14">SHOULD</span> be set to DOQ_INTERNAL_ERROR. The
corresponding DNS transaction <span class="bcp14">MUST</span> be abandoned. Clients <span class="bcp14">MAY</span> limit the number of
unsolicited QUIC RESET_STREAM frames received on a connection before choosing to close the
   connection.<a class="pilcrow" href="#section-4.3.2-2">¶</a></p>
<p id="section-4.3.2-3">Note that this mechanism provides a way for primaries to abort a single zone
transfer occurring on a given stream without having to close the QUIC
connection.<a class="pilcrow" href="#section-4.3.2-3">¶</a></p>
</section>
</div>
<div id="protocol-errors">
<section id="section-4.3.3">
          <h4 id="name-protocol-errors">
<a class="section-number selfRef" href="#section-4.3.3">4.3.3. </a><a class="section-name selfRef" href="#name-protocol-errors">Protocol Errors</a>
          </h4>
<p id="section-4.3.3-1">Other error scenarios can occur due to malformed, incomplete, or unexpected
messages during a transaction. These include (but are not limited to):<a class="pilcrow" href="#section-4.3.3-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.3-2.1">a client or server receives a message with a non-zero Message ID<a class="pilcrow" href="#section-4.3.3-2.1">¶</a>
</li>
            <li class="normal" id="section-4.3.3-2.2">a client or server receives a STREAM FIN before receiving all the bytes for a
message indicated in the 2-octet length field<a class="pilcrow" href="#section-4.3.3-2.2">¶</a>
</li>
            <li class="normal" id="section-4.3.3-2.3">a client receives a STREAM FIN before receiving all the expected responses<a class="pilcrow" href="#section-4.3.3-2.3">¶</a>
</li>
            <li class="normal" id="section-4.3.3-2.4">a server receives more than one query on a stream<a class="pilcrow" href="#section-4.3.3-2.4">¶</a>
</li>
            <li class="normal" id="section-4.3.3-2.5">a client receives a different number of responses on a stream than expected
(e.g., multiple responses to a query for an A record)<a class="pilcrow" href="#section-4.3.3-2.5">¶</a>
</li>
            <li class="normal" id="section-4.3.3-2.6">a client receives a STOP_SENDING request<a class="pilcrow" href="#section-4.3.3-2.6">¶</a>
</li>
            <li class="normal" id="section-4.3.3-2.7">the client or server does not indicate the expected STREAM FIN after
sending requests or responses (see <a class="xref" href="#stream-mapping-and-usage">Section 4.2</a>)<a class="pilcrow" href="#section-4.3.3-2.7">¶</a>
</li>
            <li class="normal" id="section-4.3.3-2.8">an implementation receives a message containing the edns-tcp-keepalive
EDNS(0) Option <span>[<a class="xref" href="#RFC7828">RFC7828</a>]</span> (see
<a class="xref" href="#resource-management">Section 5.5.2</a>)<a class="pilcrow" href="#section-4.3.3-2.8">¶</a>
</li>
            <li class="normal" id="section-4.3.3-2.9">a client or a server attempts to open a unidirectional QUIC stream<a class="pilcrow" href="#section-4.3.3-2.9">¶</a>
</li>
            <li class="normal" id="section-4.3.3-2.10">a server attempts to open a server-initiated bidirectional QUIC stream<a class="pilcrow" href="#section-4.3.3-2.10">¶</a>
</li>
            <li class="normal" id="section-4.3.3-2.11">a server receives a "replayable" transaction in 0-RTT data (for servers not willing to          
 handle this case, see <a class="xref" href="#session-resumption-and-0-rtt">Section 4.5</a>)<a class="pilcrow" href="#section-4.3.3-2.11">¶</a>
</li>
          </ul>
<p id="section-4.3.3-3">If a peer encounters such an error condition, it is considered a fatal error. It
<span class="bcp14">SHOULD</span> forcibly abort the connection using QUIC's CONNECTION_CLOSE mechanism
and <span class="bcp14">SHOULD</span> use the DoQ error code DOQ_PROTOCOL_ERROR. In some cases, it <span class="bcp14">MAY</span>
instead silently abandon the connection, which uses fewer of the local resources
but makes debugging at the offending node more difficult.<a class="pilcrow" href="#section-4.3.3-3">¶</a></p>
<p id="section-4.3.3-4">It is noted that the restrictions on use of the above EDNS(0) option has
implications for proxying messages from TCP/DoT/DoH over DoQ.<a class="pilcrow" href="#section-4.3.3-4">¶</a></p>
</section>
</div>
<div id="alternative-error-codes">
<section id="section-4.3.4">
          <h4 id="name-alternative-error-codes">
<a class="section-number selfRef" href="#section-4.3.4">4.3.4. </a><a class="section-name selfRef" href="#name-alternative-error-codes">Alternative Error Codes</a>
          </h4>
<p id="section-4.3.4-1">This specification describes specific error codes in Sections <a class="xref" href="#transaction-cancellation">4.3.1</a>,
<a class="xref" href="#transaction-errors">4.3.2</a>, and <a class="xref" href="#protocol-errors">4.3.3</a>. These error codes are meant
to facilitate investigation of failures and other incidents. New error
codes may be defined in future versions of DoQ or registered as specified
in <a class="xref" href="#iana-error-codes">Section 8.4</a>.<a class="pilcrow" href="#section-4.3.4-1">¶</a></p>
<p id="section-4.3.4-2">Because new error codes can be defined without negotiation, use of an error
code in an unexpected context or receipt of an unknown error code <span class="bcp14">MUST</span> be
treated as equivalent to DOQ_UNSPECIFIED_ERROR.<a class="pilcrow" href="#section-4.3.4-2">¶</a></p>
<p id="section-4.3.4-3">Implementations <span class="bcp14">MAY</span> wish to test the support for the error code extension
mechanism by using error codes not listed in this document, or they <span class="bcp14">MAY</span> use
DOQ_ERROR_RESERVED.<a class="pilcrow" href="#section-4.3.4-3">¶</a></p>
</section>
</div>
</section>
</div>
<div id="connection-management">
<section id="section-4.4">
        <h3 id="name-connection-management">
<a class="section-number selfRef" href="#section-4.4">4.4. </a><a class="section-name selfRef" href="#name-connection-management">Connection Management</a>
        </h3>
<p id="section-4.4-1"><span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9000#section-10">Section 10</a> of [<a class="xref" href="#RFC9000">RFC9000</a>]</span>, the QUIC transport specification, specifies that
connections can be closed in three ways:<a class="pilcrow" href="#section-4.4-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4-2.1">idle timeout<a class="pilcrow" href="#section-4.4-2.1">¶</a>
</li>
          <li class="normal" id="section-4.4-2.2">immediate close<a class="pilcrow" href="#section-4.4-2.2">¶</a>
</li>
          <li class="normal" id="section-4.4-2.3">stateless reset<a class="pilcrow" href="#section-4.4-2.3">¶</a>
</li>
        </ul>
<p id="section-4.4-3">Clients and servers implementing DoQ <span class="bcp14">SHOULD</span> negotiate use of the idle timeout.
Closing on idle timeout is done without any packet exchange, which minimizes
protocol overhead. Per <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9000#section-10.1">Section 10.1</a> of [<a class="xref" href="#RFC9000">RFC9000</a>]</span>, the QUIC transport specification, the
effective value of the idle timeout is computed as the minimum of the values
advertised by the two endpoints. Practical considerations on setting the idle
timeout are discussed in <a class="xref" href="#resource-management">Section 5.5.2</a>.<a class="pilcrow" href="#section-4.4-3">¶</a></p>
<p id="section-4.4-4">Clients <span class="bcp14">SHOULD</span> monitor the idle time incurred on their connection to the
server, defined by the time spent since the last packet from the server has
been received. When a client prepares to send a new DNS query to the server, it
<span class="bcp14">SHOULD</span> check whether the idle time is sufficiently lower than the idle timer. If it
is, the client <span class="bcp14">SHOULD</span> send the DNS query over the existing connection. If not,
the client <span class="bcp14">SHOULD</span> establish a new connection and send the query over that
connection.<a class="pilcrow" href="#section-4.4-4">¶</a></p>
<p id="section-4.4-5">Clients <span class="bcp14">MAY</span> discard their connections to the server before the idle timeout
expires. A client that has outstanding queries <span class="bcp14">SHOULD</span> close the connection
explicitly using QUIC's CONNECTION_CLOSE mechanism and the DoQ error code
DOQ_NO_ERROR.<a class="pilcrow" href="#section-4.4-5">¶</a></p>
<p id="section-4.4-6">Clients and servers <span class="bcp14">MAY</span> close the connection for a variety of other
reasons, indicated using QUIC's CONNECTION_CLOSE. Client and servers
that send packets over a connection discarded by their peer might
receive a stateless reset indication. If a connection fails, all the
in-progress transactions on that connection <span class="bcp14">MUST</span> be abandoned.<a class="pilcrow" href="#section-4.4-6">¶</a></p>
</section>
</div>
<div id="session-resumption-and-0-rtt">
<section id="section-4.5">
        <h3 id="name-session-resumption-and-0-rt">
<a class="section-number selfRef" href="#section-4.5">4.5. </a><a class="section-name selfRef" href="#name-session-resumption-and-0-rt">Session Resumption and 0-RTT</a>
        </h3>
<p id="section-4.5-1">A client <span class="bcp14">MAY</span> take advantage of the session resumption and 0-RTT mechanisms supported by
QUIC transport <span>[<a class="xref" href="#RFC9000">RFC9000</a>]</span> and QUIC TLS <span>[<a class="xref" href="#RFC9001">RFC9001</a>]</span> if the server supports them.
Clients <span class="bcp14">SHOULD</span> consider
potential privacy issues associated with session resumption before deciding to use
this mechanism and specifically evaluate the trade-offs presented in the various sections of this document. 
The privacy issues are detailed in Sections <a class="xref" href="#privacy-issues-with-0-rtt-data">7.1</a>
and <a class="xref" href="#privacy-issues-with-session-resumption">7.2</a>,
and the implementation considerations are discussed in
<a class="xref" href="#using-0-rtt-and-session-resumption">Section 5.5.3</a>.<a class="pilcrow" href="#section-4.5-1">¶</a></p>
<p id="section-4.5-2">The 0-RTT mechanism <span class="bcp14">MUST NOT</span> be used to send DNS requests that are not
"replayable" transactions. In this specification, only transactions that have
an OPCODE of QUERY or NOTIFY are considered replayable; therefore, other OPCODES <span class="bcp14">MUST NOT</span>
be sent in 0-RTT data. See <a class="xref" href="#the-notify-service">Appendix A</a> for a detailed discussion of why NOTIFY is
included here.<a class="pilcrow" href="#section-4.5-2">¶</a></p>
<p id="section-4.5-3">Servers <span class="bcp14">MAY</span> support session resumption, and <span class="bcp14">MAY</span> do that with or without supporting
0-RTT, using the mechanisms described in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9001#section-4.6.1">Section 4.6.1</a> of [<a class="xref" href="#RFC9001">RFC9001</a>]</span>.
Servers supporting 0-RTT <span class="bcp14">MUST NOT</span> immediately process
non-replayable transactions received in 0-RTT data but instead
<span class="bcp14">MUST</span> adopt one of the following behaviors:<a class="pilcrow" href="#section-4.5-3">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.5-4.1">Queue the offending transaction and only process it after the QUIC handshake
has been completed, as defined in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9001#section-4.1.1">Section 4.1.1</a> of [<a class="xref" href="#RFC9001">RFC9001</a>]</span>.<a class="pilcrow" href="#section-4.5-4.1">¶</a>
</li>
          <li class="normal" id="section-4.5-4.2">Reply to the offending transaction with a response code REFUSED and
an Extended DNS Error Code (EDE) "Too Early" using the extended RCODE
mechanisms defined in <span>[<a class="xref" href="#RFC6891">RFC6891</a>]</span> and the extended DNS errors defined in <span>[<a class="xref" href="#RFC8914">RFC8914</a>]</span>; see
<a class="xref" href="#reservation-of-extended-dns-error-code-too-early">Section 8.3</a>.<a class="pilcrow" href="#section-4.5-4.2">¶</a>
</li>
          <li class="normal" id="section-4.5-4.3">Close the connection with the error code DOQ_PROTOCOL_ERROR.<a class="pilcrow" href="#section-4.5-4.3">¶</a>
</li>
        </ul>
</section>
</div>
<div id="message-sizes">
<section id="section-4.6">
        <h3 id="name-message-sizes">
<a class="section-number selfRef" href="#section-4.6">4.6. </a><a class="section-name selfRef" href="#name-message-sizes">Message Sizes</a>
        </h3>
<p id="section-4.6-1">DoQ queries and responses are sent on QUIC streams, which in theory can carry
up to 2<sup>62</sup> bytes. However, DNS messages are restricted in practice to a maximum
size of 65535 bytes. This maximum size is enforced by the use of a 2-octet
message length field in DNS over TCP <span>[<a class="xref" href="#RFC1035">RFC1035</a>]</span> and DoT
<span>[<a class="xref" href="#RFC7858">RFC7858</a>]</span>, and by the definition of the "application/dns-message" for DoH <span>[<a class="xref" href="#RFC8484">RFC8484</a>]</span>. DoQ enforces the same restriction.<a class="pilcrow" href="#section-4.6-1">¶</a></p>
<p id="section-4.6-2">The Extension Mechanisms for DNS (EDNS(0)) <span>[<a class="xref" href="#RFC6891">RFC6891</a>]</span> allow peers to specify the
UDP message size. This parameter is ignored by DoQ. DoQ implementations always
assume that the maximum message size is 65535 bytes.<a class="pilcrow" href="#section-4.6-2">¶</a></p>
</section>
</div>
</section>
</div>
<div id="implementation-requirements">
<section id="section-5">
      <h2 id="name-implementation-requirements">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-implementation-requirements">Implementation Requirements</a>
      </h2>
<div id="authentication">
<section id="section-5.1">
        <h3 id="name-authentication">
<a class="section-number selfRef" href="#section-5.1">5.1. </a><a class="section-name selfRef" href="#name-authentication">Authentication</a>
        </h3>
<p id="section-5.1-1">For the stub to recursive scenario, the authentication requirements
are the same as described in DoT <span>[<a class="xref" href="#RFC7858">RFC7858</a>]</span> and "Usage Profiles for DNS over
TLS and DNS over DTLS" <span>[<a class="xref" href="#RFC8310">RFC8310</a>]</span>. <span>[<a class="xref" href="#RFC8932">RFC8932</a>]</span> states that DNS privacy
services <span class="bcp14">SHOULD</span> provide credentials that clients can use to authenticate the
server. Given this, and to align with the authentication model for DoH, DoQ stubs
<span class="bcp14">SHOULD</span> use a Strict usage profile. Client authentication for the encrypted
stub to recursive scenario is not described in any DNS RFC.<a class="pilcrow" href="#section-5.1-1">¶</a></p>
<p id="section-5.1-2">For zone transfer, the authentication requirements are the same as described in
<span>[<a class="xref" href="#RFC9103">RFC9103</a>]</span>.<a class="pilcrow" href="#section-5.1-2">¶</a></p>
<p id="section-5.1-3">For the recursive to authoritative scenario, authentication
requirements are unspecified at the time of writing and are the subject of
ongoing work in the DPRIVE WG.<a class="pilcrow" href="#section-5.1-3">¶</a></p>
</section>
</div>
<div id="fallback-to-other-protocols-on-connection-failure">
<section id="section-5.2">
        <h3 id="name-fallback-to-other-protocols">
<a class="section-number selfRef" href="#section-5.2">5.2. </a><a class="section-name selfRef" href="#name-fallback-to-other-protocols">Fallback to Other Protocols on Connection Failure</a>
        </h3>
<p id="section-5.2-1">If the establishment of the DoQ connection fails, clients <span class="bcp14">MAY</span> attempt to
fall back to DoT and then potentially cleartext, as specified in DoT
<span>[<a class="xref" href="#RFC7858">RFC7858</a>]</span> and "Usage Profiles for DNS over TLS and DNS over DTLS"
<span>[<a class="xref" href="#RFC8310">RFC8310</a>]</span>, depending on their usage profile.<a class="pilcrow" href="#section-5.2-1">¶</a></p>
<p id="section-5.2-2">DNS clients <span class="bcp14">SHOULD</span> remember server IP addresses that don't support DoQ.
Mobile clients might also remember the lack of DoQ support by
given IP addresses on a per-context basis (e.g., per network or provisioning domain).<a class="pilcrow" href="#section-5.2-2">¶</a></p>
<p id="section-5.2-3">Timeouts, connection refusals, and QUIC handshake failures are indicators
that a server does not support DoQ.  Clients <span class="bcp14">SHOULD NOT</span> attempt DoQ queries to a
server that does not support DoQ for a reasonable period (such as one hour per
server).  DNS clients following an out-of-band key-pinned usage profile
<span>[<a class="xref" href="#RFC7858">RFC7858</a>]</span> <span class="bcp14">MAY</span> be more aggressive about retrying after DoQ connection failures.<a class="pilcrow" href="#section-5.2-3">¶</a></p>
</section>
</div>
<div id="address-validation">
<section id="section-5.3">
        <h3 id="name-address-validation">
<a class="section-number selfRef" href="#section-5.3">5.3. </a><a class="section-name selfRef" href="#name-address-validation">Address Validation</a>
        </h3>
<p id="section-5.3-1"><span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9000#section-8">Section 8</a> of [<a class="xref" href="#RFC9000">RFC9000</a>]</span>, the QUIC transport specification, defines Address
Validation procedures to avoid servers being used in address amplification
attacks. DoQ implementations <span class="bcp14">MUST</span> conform to this specification, which limits
the worst-case amplification to a factor 3.<a class="pilcrow" href="#section-5.3-1">¶</a></p>
<p id="section-5.3-2">DoQ implementations <span class="bcp14">SHOULD</span> consider configuring servers to use the Address
Validation using Retry Packets procedure defined in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9000#section-8.1.2">Section 8.1.2</a> of [<a class="xref" href="#RFC9000">RFC9000</a>]</span>, the QUIC
transport specification. This procedure imposes a 1-RTT delay for
verifying the return routability of the source address of a client, similar to
the DNS Cookies mechanism <span>[<a class="xref" href="#RFC7873">RFC7873</a>]</span>.<a class="pilcrow" href="#section-5.3-2">¶</a></p>
<p id="section-5.3-3">DoQ implementations that configure Address Validation using Retry Packets
<span class="bcp14">SHOULD</span> implement the Address Validation for Future Connections procedure
defined in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9000#section-8.1.3">Section 8.1.3</a> of [<a class="xref" href="#RFC9000">RFC9000</a>]</span>, the QUIC transport specification.
This defines how servers can send NEW_TOKEN frames to clients after the client
address is validated in order to avoid the 1-RTT penalty during subsequent
connections by the client from the same address.<a class="pilcrow" href="#section-5.3-3">¶</a></p>
</section>
</div>
<div id="padding">
<section id="section-5.4">
        <h3 id="name-padding">
<a class="section-number selfRef" href="#section-5.4">5.4. </a><a class="section-name selfRef" href="#name-padding">Padding</a>
        </h3>
<p id="section-5.4-1">Implementations <span class="bcp14">MUST</span> protect against the traffic analysis attacks described in
<a class="xref" href="#traffic-analysis">Section 7.5</a> by the judicious injection of padding. This
could be done either by padding individual DNS messages using the
EDNS(0) Padding Option <span>[<a class="xref" href="#RFC7830">RFC7830</a>]</span> or by padding QUIC packets (see
<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9000#section-19.1">Section 19.1</a> of [<a class="xref" href="#RFC9000">RFC9000</a>]</span>).<a class="pilcrow" href="#section-5.4-1">¶</a></p>
<p id="section-5.4-2">In theory, padding at the QUIC packet level could result in better performance for the equivalent
protection, because the amount of padding can take into account non-DNS frames
such as acknowledgements or flow control updates, and also because QUIC packets
can carry multiple DNS messages. However, applications can only control the
amount of padding in QUIC packets if the implementation of QUIC exposes adequate APIs. This leads
to the following recommendations:<a class="pilcrow" href="#section-5.4-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.4-3.1">If the implementation of QUIC exposes APIs to set a padding policy,
DoQ <span class="bcp14">SHOULD</span> use that API to align the packet length to a small set of
fixed sizes.<a class="pilcrow" href="#section-5.4-3.1">¶</a>
</li>
          <li class="normal" id="section-5.4-3.2">If padding at the QUIC packet level is not available or not used,
DoQ <span class="bcp14">MUST</span> ensure that all DNS queries and responses are padded to
a small set of fixed sizes, using the EDNS(0) padding extension as specified
in <span>[<a class="xref" href="#RFC7830">RFC7830</a>]</span>.<a class="pilcrow" href="#section-5.4-3.2">¶</a>
</li>
        </ul>
<p id="section-5.4-4">Implementations might choose not to use a QUIC API for padding if it is
significantly simpler to reuse existing DNS message padding logic that is
applied to other encrypted transports.<a class="pilcrow" href="#section-5.4-4">¶</a></p>
<p id="section-5.4-5">In the absence of a standard policy for padding sizes, implementations <span class="bcp14">SHOULD</span>
follow the recommendations of the Experimental status "Padding Policies for
Extension Mechanisms for DNS (EDNS(0))" <span>[<a class="xref" href="#RFC8467">RFC8467</a>]</span>. While Experimental,
these recommendations are referenced because they are implemented and deployed
for DoT and provide a way for implementations to be fully compliant with this
specification.<a class="pilcrow" href="#section-5.4-5">¶</a></p>
</section>
</div>
<div id="connection-handling">
<section id="section-5.5">
        <h3 id="name-connection-handling">
<a class="section-number selfRef" href="#section-5.5">5.5. </a><a class="section-name selfRef" href="#name-connection-handling">Connection Handling</a>
        </h3>
<p id="section-5.5-1">"DNS Transport over TCP - Implementation Requirements" <span>[<a class="xref" href="#RFC7766">RFC7766</a>]</span> provides
updated guidance on DNS over TCP, some of which is applicable to DoQ. This 
section provides similar advice on connection handling for DoQ.<a class="pilcrow" href="#section-5.5-1">¶</a></p>
<div id="connection-reuse">
<section id="section-5.5.1">
          <h4 id="name-connection-reuse">
<a class="section-number selfRef" href="#section-5.5.1">5.5.1. </a><a class="section-name selfRef" href="#name-connection-reuse">Connection Reuse</a>
          </h4>
<p id="section-5.5.1-1">Historic implementations of DNS clients are known to open and close TCP
connections for each DNS query. To amortize connection setup costs, both
clients and servers <span class="bcp14">SHOULD</span> support connection reuse by sending multiple queries
and responses over a single persistent QUIC connection.<a class="pilcrow" href="#section-5.5.1-1">¶</a></p>
<p id="section-5.5.1-2">In order to achieve performance on par with UDP, DNS clients <span class="bcp14">SHOULD</span> send their
queries concurrently over the QUIC streams on a QUIC connection. That is, when
a DNS client sends multiple queries to a server over a QUIC connection, it
<span class="bcp14">SHOULD NOT</span> wait for an outstanding reply before sending the next query.<a class="pilcrow" href="#section-5.5.1-2">¶</a></p>
</section>
</div>
<div id="resource-management">
<section id="section-5.5.2">
          <h4 id="name-resource-management">
<a class="section-number selfRef" href="#section-5.5.2">5.5.2. </a><a class="section-name selfRef" href="#name-resource-management">Resource Management</a>
          </h4>
<p id="section-5.5.2-1">Proper management of established and idle connections is important to the
healthy operation of a DNS server.<a class="pilcrow" href="#section-5.5.2-1">¶</a></p>
<p id="section-5.5.2-2">An implementation of DoQ <span class="bcp14">SHOULD</span> follow best practices similar to those
specified for DNS over TCP <span>[<a class="xref" href="#RFC7766">RFC7766</a>]</span>, in particular with regard to:<a class="pilcrow" href="#section-5.5.2-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.5.2-3.1">Concurrent Connections (<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc7766#section-6.2.2">Section 6.2.2</a> of [<a class="xref" href="#RFC7766">RFC7766</a>]</span>, updated by <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9103#section-6.4">Section 6.4</a> of [<a class="xref" href="#RFC9103">RFC9103</a>]</span>)<a class="pilcrow" href="#section-5.5.2-3.1">¶</a>
</li>
            <li class="normal" id="section-5.5.2-3.2">Security Considerations (<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc7766#section-10">Section 10</a> of [<a class="xref" href="#RFC7766">RFC7766</a>]</span>)<a class="pilcrow" href="#section-5.5.2-3.2">¶</a>
</li>
          </ul>
<p id="section-5.5.2-4">Failure to do so may lead to resource exhaustion and denial of service.<a class="pilcrow" href="#section-5.5.2-4">¶</a></p>
<p id="section-5.5.2-5">Clients that want to maintain long duration DoQ connections <span class="bcp14">SHOULD</span> use the idle
timeout mechanisms defined in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9000#section-10.1">Section 10.1</a> of [<a class="xref" href="#RFC9000">RFC9000</a>]</span>, the QUIC transport
specification. Clients and servers <span class="bcp14">MUST NOT</span> send the edns-tcp-keepalive EDNS(0)
Option <span>[<a class="xref" href="#RFC7828">RFC7828</a>]</span> in any messages sent on a DoQ connection (because it is
specific to the use of TCP/TLS as a transport).<a class="pilcrow" href="#section-5.5.2-5">¶</a></p>
<p id="section-5.5.2-6">This document does not make specific recommendations for timeout values on idle
connections. Clients and servers should reuse and/or close connections
depending on the level of available resources. Timeouts may be longer during
periods of low activity and shorter during periods of high activity.<a class="pilcrow" href="#section-5.5.2-6">¶</a></p>
</section>
</div>
<div id="using-0-rtt-and-session-resumption">
<section id="section-5.5.3">
          <h4 id="name-using-0-rtt-and-session-res">
<a class="section-number selfRef" href="#section-5.5.3">5.5.3. </a><a class="section-name selfRef" href="#name-using-0-rtt-and-session-res">Using 0-RTT and Session Resumption</a>
          </h4>
<p id="section-5.5.3-1">Using 0-RTT for DoQ has many compelling advantages. Clients
can establish connections and send queries without incurring a connection
delay. Servers can thus negotiate low values of the connection
timers, which reduces the total number of connections that they need to
manage. They can do that because the clients that use 0-RTT will not incur
latency penalties if new connections are required for a query.<a class="pilcrow" href="#section-5.5.3-1">¶</a></p>
<p id="section-5.5.3-2">Session resumption and 0-RTT data transmission create
privacy risks detailed in Sections  <a class="xref" href="#privacy-issues-with-0-rtt-data">7.1</a> and <a class="xref" href="#privacy-issues-with-session-resumption">7.2</a>.
The following recommendations are meant to reduce the privacy
risks while enjoying the performance benefits of 0-RTT data, subject to the
restrictions specified in <a class="xref" href="#session-resumption-and-0-rtt">Section 4.5</a>.<a class="pilcrow" href="#section-5.5.3-2">¶</a></p>
<p id="section-5.5.3-3">Clients <span class="bcp14">SHOULD</span> use resumption tickets only once, as
specified in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8446#appendix-C.4">Appendix C.4</a> of [<a class="xref" href="#RFC8446">RFC8446</a>]</span>. By
default, clients <span class="bcp14">SHOULD NOT</span> use session resumption if the
client's connectivity has changed.<a class="pilcrow" href="#section-5.5.3-3">¶</a></p>
<p id="section-5.5.3-4">Clients could receive address validation tokens from the server using the
NEW_TOKEN mechanism; see <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9000#section-8">Section 8</a> of [<a class="xref" href="#RFC9000">RFC9000</a>]</span>. The associated tracking
risks are mentioned in <a class="xref" href="#privacy-issues-with-address-validation-tokens">Section 7.3</a>.
Clients <span class="bcp14">SHOULD</span> only use the address validation tokens when they are also using session
resumption thus avoiding additional tracking risks.<a class="pilcrow" href="#section-5.5.3-4">¶</a></p>
<p id="section-5.5.3-5">Servers <span class="bcp14">SHOULD</span> issue session resumption tickets with a sufficiently long lifetime (e.g., 6 hours),
so that clients are not tempted to either keep the connection alive or frequently poll the server
to renew session resumption tickets.
Servers <span class="bcp14">SHOULD</span> implement the anti-replay mechanisms specified in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8446#section-8">Section 8</a> of [<a class="xref" href="#RFC8446">RFC8446</a>]</span>.<a class="pilcrow" href="#section-5.5.3-5">¶</a></p>
</section>
</div>
<div id="controlling-connection-migration-for-privacy">
<section id="section-5.5.4">
          <h4 id="name-controlling-connection-migr">
<a class="section-number selfRef" href="#section-5.5.4">5.5.4. </a><a class="section-name selfRef" href="#name-controlling-connection-migr">Controlling Connection Migration for Privacy</a>
          </h4>
<p id="section-5.5.4-1">DoQ implementations might consider using the connection migration features defined
in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9000#section-9">Section 9</a> of [<a class="xref" href="#RFC9000">RFC9000</a>]</span>. These features enable connections to continue operating
as the client's connectivity changes.
As detailed in <a class="xref" href="#privacy-issues-with-long-duration-sessions">Section 7.4</a>, these features
trade off privacy for latency. By default, clients <span class="bcp14">SHOULD</span> be configured
to prioritize privacy and start new sessions if their connectivity changes.<a class="pilcrow" href="#section-5.5.4-1">¶</a></p>
</section>
</div>
</section>
</div>
<div id="processing-queries-in-parallel">
<section id="section-5.6">
        <h3 id="name-processing-queries-in-paral">
<a class="section-number selfRef" href="#section-5.6">5.6. </a><a class="section-name selfRef" href="#name-processing-queries-in-paral">Processing Queries in Parallel</a>
        </h3>
<p id="section-5.6-1">As specified in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc7766#section-7">Section 7</a> of [<a class="xref" href="#RFC7766">RFC7766</a>]</span> "DNS Transport over TCP - Implementation
Requirements", resolvers are <span class="bcp14">RECOMMENDED</span> to support the preparing
of responses in parallel and sending them out of order. In DoQ, they do that by
sending responses on their specific stream as soon as possible, without waiting
for availability of responses for previously opened streams.<a class="pilcrow" href="#section-5.6-1">¶</a></p>
</section>
</div>
<div id="zone-transfer">
<section id="section-5.7">
        <h3 id="name-zone-transfer">
<a class="section-number selfRef" href="#section-5.7">5.7. </a><a class="section-name selfRef" href="#name-zone-transfer">Zone Transfer</a>
        </h3>
<p id="section-5.7-1"><span>[<a class="xref" href="#RFC9103">RFC9103</a>]</span> specifies zone transfer over TLS (XoT)
and includes updates to <span>[<a class="xref" href="#RFC1995">RFC1995</a>]</span> (IXFR), <span>[<a class="xref" href="#RFC5936">RFC5936</a>]</span> (AXFR), and
<span>[<a class="xref" href="#RFC7766">RFC7766</a>]</span>. Considerations relating to the reuse of XoT connections
described there apply analogously to zone transfers performed using DoQ
connections. One reason for reiterating such specific guidance is the
lack of effective connection reuse in existing TCP/TLS zone transfer
implementations today. The following recommendations apply:<a class="pilcrow" href="#section-5.7-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.7-2.1">DoQ servers <span class="bcp14">MUST</span> be able to handle multiple concurrent IXFR requests on a
single QUIC connection.<a class="pilcrow" href="#section-5.7-2.1">¶</a>
</li>
          <li class="normal" id="section-5.7-2.2">DoQ servers <span class="bcp14">MUST</span> be able to handle multiple concurrent AXFR requests on a
single QUIC connection.<a class="pilcrow" href="#section-5.7-2.2">¶</a>
</li>
          <li class="normal" id="section-5.7-2.3">
            <p id="section-5.7-2.3.1">DoQ implementations <span class="bcp14">SHOULD</span><a class="pilcrow" href="#section-5.7-2.3.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.7-2.3.2.1">use the same QUIC connection for both AXFR and IXFR requests to the same
primary<a class="pilcrow" href="#section-5.7-2.3.2.1">¶</a>
</li>
              <li class="normal" id="section-5.7-2.3.2.2">send those requests in parallel as soon as they are queued, i.e., do not wait
for a response before sending the next query on the connection
(this is analogous to pipelining requests on a TCP/TLS connection)<a class="pilcrow" href="#section-5.7-2.3.2.2">¶</a>
</li>
              <li class="normal" id="section-5.7-2.3.2.3">send the response(s) for each request as soon as they are available, i.e.,
response streams <span class="bcp14">MAY</span> be sent intermingled<a class="pilcrow" href="#section-5.7-2.3.2.3">¶</a>
</li>
            </ul>
</li>
        </ul>
</section>
</div>
<div id="flow-control-mechanisms">
<section id="section-5.8">
        <h3 id="name-flow-control-mechanisms">
<a class="section-number selfRef" href="#section-5.8">5.8. </a><a class="section-name selfRef" href="#name-flow-control-mechanisms">Flow Control Mechanisms</a>
        </h3>
<p id="section-5.8-1">Servers and clients manage flow control using the mechanisms defined in
<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9000#section-4">Section 4</a> of [<a class="xref" href="#RFC9000">RFC9000</a>]</span>. These mechanisms allow clients and servers to specify
how many streams can be created, how much data can be sent on a stream,
and how much data can be sent on the union of all streams. For DoQ,
controlling how many streams are created allows servers to control how many
new requests the client can send on a given connection.<a class="pilcrow" href="#section-5.8-1">¶</a></p>
<p id="section-5.8-2">Flow control exists to protect endpoint resources.
For servers, global and per-stream flow control limits control how much data can be sent by
clients. The same mechanisms
allow clients to control how much data can be sent by servers.
Values that are too small will unnecessarily limit performance.
Values that are too large might expose endpoints to overload or memory exhaustion.
Implementations or deployments will need to adjust flow control limits to
balance these concerns. In particular, zone transfer implementations will need to control
these limits carefully to ensure both large and concurrent zone transfers are well managed.<a class="pilcrow" href="#section-5.8-2">¶</a></p>
<p id="section-5.8-3">Initial values of parameters control how many requests and how much data can be
sent by clients and servers at the beginning of the connection. These values
are specified in transport parameters exchanged during the connection handshake.
The parameter values received in the initial connection also control how many requests and
how much data can be sent by clients using 0-RTT data in a resumed connection.
Using too small values of these initial parameters would restrict the
usefulness of allowing 0-RTT data.<a class="pilcrow" href="#section-5.8-3">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-6">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<p id="section-6-1">A Threat Analysis of the Domain Name System is found in <span>[<a class="xref" href="#RFC3833">RFC3833</a>]</span>.
This analysis was written before the development of DoT, DoH, and DoQ, and
probably needs to be updated.<a class="pilcrow" href="#section-6-1">¶</a></p>
<p id="section-6-2">The security considerations of DoQ should be comparable to those of DoT
<span>[<a class="xref" href="#RFC7858">RFC7858</a>]</span>. DoT as specified in <span>[<a class="xref" href="#RFC7858">RFC7858</a>]</span> only addresses the stub to recursive scenario, but the considerations about person-in-the-middle
attacks, middleboxes, and caching of data from cleartext connections also
apply for DoQ to the resolver to authoritative server scenario. 
As stated in <a class="xref" href="#authentication">Section 5.1</a>, the authentication requirements for securing zone transfer using DoQ are the same as those for zone transfer over DoT; therefore, the general security considerations are entirely analogous to those described in <span>[<a class="xref" href="#RFC9103">RFC9103</a>]</span>.<a class="pilcrow" href="#section-6-2">¶</a></p>
<p id="section-6-3">DoQ relies on QUIC, which itself relies on TLS 1.3 and thus supports by default
the protections against downgrade attacks described in <span>[<a class="xref" href="#BCP195">BCP195</a>]</span>.
QUIC-specific issues and their mitigations are described in
<span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9000#section-21">Section 21</a> of [<a class="xref" href="#RFC9000">RFC9000</a>]</span>.<a class="pilcrow" href="#section-6-3">¶</a></p>
</section>
</div>
<div id="privacy-considerations">
<section id="section-7">
      <h2 id="name-privacy-considerations">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-privacy-considerations">Privacy Considerations</a>
      </h2>
<p id="section-7-1">The general considerations of encrypted transports provided in "DNS Privacy
Considerations" <span>[<a class="xref" href="#RFC9076">RFC9076</a>]</span> apply to DoQ. The specific
considerations provided there do not differ between DoT and DoQ, and they are not
discussed further here. Similarly, "Recommendations for DNS Privacy Service
Operators" <span>[<a class="xref" href="#RFC8932">RFC8932</a>]</span> (which covers operational, policy, and security
considerations for DNS privacy services) is also applicable to DoQ services.<a class="pilcrow" href="#section-7-1">¶</a></p>
<p id="section-7-2">QUIC incorporates the mechanisms of TLS 1.3 <span>[<a class="xref" href="#RFC8446">RFC8446</a>]</span>, and this enables QUIC
transmission of "0-RTT" data. This can provide interesting latency gains, but
it raises two concerns:<a class="pilcrow" href="#section-7-2">¶</a></p>
<ol class="normal type-1" id="section-7-3" start="1" type="1">
<li id="section-7-3.1">Adversaries could replay the 0-RTT data and infer its content
from the behavior of the receiving server.<a class="pilcrow" href="#section-7-3.1">¶</a>
</li>
        <li id="section-7-3.2">The 0-RTT mechanism relies on TLS session resumption, which can provide
linkability between successive client sessions.<a class="pilcrow" href="#section-7-3.2">¶</a>
</li>
      </ol>
<p id="section-7-4">These issues are developed in Sections <a class="xref" href="#privacy-issues-with-0-rtt-data">7.1</a> and <a class="xref" href="#privacy-issues-with-session-resumption">7.2</a>.<a class="pilcrow" href="#section-7-4">¶</a></p>
<div id="privacy-issues-with-0-rtt-data">
<section id="section-7.1">
        <h3 id="name-privacy-issues-with-0-rtt-d">
<a class="section-number selfRef" href="#section-7.1">7.1. </a><a class="section-name selfRef" href="#name-privacy-issues-with-0-rtt-d">Privacy Issues with 0-RTT data</a>
        </h3>
<p id="section-7.1-1">The 0-RTT data can be replayed by adversaries. That data may trigger queries by
a recursive resolver to authoritative resolvers. Adversaries may be able to
pick a time at which the recursive resolver outgoing traffic is observable and
thus find out what name was queried for in the 0-RTT data.<a class="pilcrow" href="#section-7.1-1">¶</a></p>
<p id="section-7.1-2">This risk is in fact a subset of the general problem of observing the behavior
of the recursive resolver discussed in "DNS Privacy Considerations"
<span>[<a class="xref" href="#RFC9076">RFC9076</a>]</span>. The attack is partially mitigated by reducing the observability
of this traffic. The mandatory replay protection mechanisms in
TLS 1.3 <span>[<a class="xref" href="#RFC8446">RFC8446</a>]</span> limit but do not eliminate the risk of replay.
0-RTT packets can only be replayed within a narrow window,
which is only wide enough to account for variations in clock skew and network transmission.<a class="pilcrow" href="#section-7.1-2">¶</a></p>
<p id="section-7.1-3">The recommendation for TLS 1.3 <span>[<a class="xref" href="#RFC8446">RFC8446</a>]</span> is that the capability to use 0-RTT
data should be turned off by default and only enabled if the user clearly
understands the associated risks. In the case of DoQ, allowing 0-RTT data
provides significant performance gains, and there is a concern that a
recommendation to not use it would simply be ignored. Instead, a set of
practical recommendations is provided in Sections <a class="xref" href="#session-resumption-and-0-rtt">4.5</a> and
<a class="xref" href="#using-0-rtt-and-session-resumption">5.5.3</a>.<a class="pilcrow" href="#section-7.1-3">¶</a></p>
<p id="section-7.1-4">The specifications in <a class="xref" href="#session-resumption-and-0-rtt">Section 4.5</a> block the most obvious
risks of replay attacks, as they only allow for transactions that will
not change the long-term state of the server.<a class="pilcrow" href="#section-7.1-4">¶</a></p>
<p id="section-7.1-5">The attacks described above apply to the stub resolver to recursive resolver scenario, but similar attacks might be envisaged in the
recursive resolver to authoritative resolver scenario, and the
same mitigations apply.<a class="pilcrow" href="#section-7.1-5">¶</a></p>
</section>
</div>
<div id="privacy-issues-with-session-resumption">
<section id="section-7.2">
        <h3 id="name-privacy-issues-with-session">
<a class="section-number selfRef" href="#section-7.2">7.2. </a><a class="section-name selfRef" href="#name-privacy-issues-with-session">Privacy Issues with Session Resumption</a>
        </h3>
<p id="section-7.2-1">The QUIC session resumption mechanism reduces the cost of re-establishing sessions
and enables 0-RTT data. There is a linkability issue associated with session
resumption, if the same resumption token is used several times. Attackers on path
between client and server could observe repeated usage of the token and
use that to track the client over time or over multiple locations.<a class="pilcrow" href="#section-7.2-1">¶</a></p>
<p id="section-7.2-2">The session resumption mechanism allows servers to correlate the resumed sessions
with the initial sessions and thus to track the client. This creates a virtual
long duration session. The series of queries in that session can be used by the
server to identify the client. Servers can most probably do that already if
the client address remains constant, but session resumption tickets also enable
tracking after changes of the client's address.<a class="pilcrow" href="#section-7.2-2">¶</a></p>
<p id="section-7.2-3">The recommendations in <a class="xref" href="#using-0-rtt-and-session-resumption">Section 5.5.3</a> are designed to
mitigate these risks. Using session tickets only once mitigates
the risk of tracking by third parties. Refusing to resume a session if addresses
change mitigates the incremental risk of tracking by the server (but the risk of
tracking by IP address remains).<a class="pilcrow" href="#section-7.2-3">¶</a></p>
<p id="section-7.2-4">The privacy trade-offs here may be context specific. Stub resolvers will have a strong
motivation to prefer privacy over latency since they often change location. However,
recursive resolvers that use a small set of static IP addresses are more likely to prefer the reduced
latency provided by session resumption and may consider this a valid reason to use
resumption tickets even if the IP address changed between sessions.<a class="pilcrow" href="#section-7.2-4">¶</a></p>
<p id="section-7.2-5">Encrypted zone transfer (<span>[<a class="xref" href="#RFC9103">RFC9103</a>]</span>) explicitly does
not attempt to hide the identity of the parties involved in the transfer; at the
same time, such transfers are not particularly latency sensitive. This means that
applications supporting zone transfers may decide to apply the same
protections as stub to recursive applications.<a class="pilcrow" href="#section-7.2-5">¶</a></p>
</section>
</div>
<div id="privacy-issues-with-address-validation-tokens">
<section id="section-7.3">
        <h3 id="name-privacy-issues-with-address">
<a class="section-number selfRef" href="#section-7.3">7.3. </a><a class="section-name selfRef" href="#name-privacy-issues-with-address">Privacy Issues with Address Validation Tokens</a>
        </h3>
<p id="section-7.3-1">QUIC specifies address validation mechanisms in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9000#section-8">Section 8</a> of [<a class="xref" href="#RFC9000">RFC9000</a>]</span>. Use
of an address validation token allows QUIC servers to avoid an extra RTT for
new connections. Address validation tokens are typically tied to an IP address.
QUIC clients normally only use these tokens when setting up a new connection
from a previously used address. However, clients are not always aware that they
are using a new address. This could be due to NAT, or because the client does
not have an API available to check if the IP address has changed (which can be
quite often for IPv6). There is a linkability risk if clients mistakenly use
address validation tokens after unknowingly moving to a new location.<a class="pilcrow" href="#section-7.3-1">¶</a></p>
<p id="section-7.3-2">The recommendations in <a class="xref" href="#using-0-rtt-and-session-resumption">Section 5.5.3</a> mitigates
this risk by tying the usage of the NEW_TOKEN to that of session resumption,
though this recommendation does not cover the case where the client is unaware
of the address change.<a class="pilcrow" href="#section-7.3-2">¶</a></p>
</section>
</div>
<div id="privacy-issues-with-long-duration-sessions">
<section id="section-7.4">
        <h3 id="name-privacy-issues-with-long-du">
<a class="section-number selfRef" href="#section-7.4">7.4. </a><a class="section-name selfRef" href="#name-privacy-issues-with-long-du">Privacy Issues with Long Duration Sessions</a>
        </h3>
<p id="section-7.4-1">A potential alternative to session resumption is the use of long duration sessions:
if a session remains open for a long time, new queries can be sent without incurring
connection establishment delays. It is worth pointing out that the two solutions have
similar privacy characteristics. Session resumption may allow servers to keep track
of the IP addresses of clients, but long duration sessions have the same effect.<a class="pilcrow" href="#section-7.4-1">¶</a></p>
<p id="section-7.4-2">In particular, a DoQ implementation might take advantage of the connection migration
features of QUIC to maintain a session even if the client's connectivity changes,
for example, if the client migrates from a Wi-Fi connection to a cellular network
connection and then to another Wi-Fi connection. The server would be
able to track the client location by monitoring the succession of IP addresses
used by the long duration connection.<a class="pilcrow" href="#section-7.4-2">¶</a></p>
<p id="section-7.4-3">The recommendation in <a class="xref" href="#controlling-connection-migration-for-privacy">Section 5.5.4</a> mitigates
the privacy concerns related to long duration sessions using multiple client addresses.<a class="pilcrow" href="#section-7.4-3">¶</a></p>
</section>
</div>
<div id="traffic-analysis">
<section id="section-7.5">
        <h3 id="name-traffic-analysis">
<a class="section-number selfRef" href="#section-7.5">7.5. </a><a class="section-name selfRef" href="#name-traffic-analysis">Traffic Analysis</a>
        </h3>
<p id="section-7.5-1">Even though QUIC packets are encrypted, adversaries can gain information from
observing packet lengths, in both queries and responses, as well as packet
timing. Many DNS requests are emitted by web browsers. Loading a specific web
page may require resolving dozens of DNS names. If an application adopts a
simple mapping of one query or response per packet, or "one QUIC STREAM frame
per packet", then the succession of packet lengths may provide enough
information to identify the requested site.<a class="pilcrow" href="#section-7.5-1">¶</a></p>
<p id="section-7.5-2">Implementations <span class="bcp14">SHOULD</span> use the mechanisms defined in <a class="xref" href="#padding">Section 5.4</a> to mitigate
this attack.<a class="pilcrow" href="#section-7.5-2">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-8">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-8">8. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<div id="registration-of-doq-identification-string">
<section id="section-8.1">
        <h3 id="name-registration-of-a-doq-ident">
<a class="section-number selfRef" href="#section-8.1">8.1. </a><a class="section-name selfRef" href="#name-registration-of-a-doq-ident">Registration of a DoQ Identification String</a>
        </h3>
<p id="section-8.1-1">This document creates a new registration for the identification of DoQ in the
"TLS Application-Layer Protocol Negotiation (ALPN) Protocol IDs" registry
<span>[<a class="xref" href="#RFC7301">RFC7301</a>]</span>.<a class="pilcrow" href="#section-8.1-1">¶</a></p>
<p id="section-8.1-2">The "doq" string identifies DoQ:<a class="pilcrow" href="#section-8.1-2">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-8.1-3">
          <dt id="section-8.1-3.1">
Protocol:  </dt>
          <dd id="section-8.1-3.2" style="margin-left: 1.5em">
            <p id="section-8.1-3.2.1">DoQ<a class="pilcrow" href="#section-8.1-3.2.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-8.1-3.3">
Identification Sequence:  </dt>
          <dd id="section-8.1-3.4" style="margin-left: 1.5em">
            <p id="section-8.1-3.4.1">0x64 0x6F 0x71 ("doq")<a class="pilcrow" href="#section-8.1-3.4.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-8.1-3.5">
Specification:  </dt>
          <dd id="section-8.1-3.6" style="margin-left: 1.5em">
            <p id="section-8.1-3.6.1">This document<a class="pilcrow" href="#section-8.1-3.6.1">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="reservation-of-dedicated-port">
<section id="section-8.2">
        <h3 id="name-reservation-of-a-dedicated-">
<a class="section-number selfRef" href="#section-8.2">8.2. </a><a class="section-name selfRef" href="#name-reservation-of-a-dedicated-">Reservation of a Dedicated Port</a>
        </h3>
<p id="section-8.2-1">For both TCP and UDP, port 853 is currently reserved for "DNS query-response 
protocol run over TLS/DTLS" <span>[<a class="xref" href="#RFC7858">RFC7858</a>]</span>.<a class="pilcrow" href="#section-8.2-1">¶</a></p>
<p id="section-8.2-2">However, the specification for DNS over DTLS (DoD)
<span>[<a class="xref" href="#RFC8094">RFC8094</a>]</span> is experimental, limited to stub to resolver, and no
implementations or deployments currently exist to the authors' knowledge (even though
several years have passed since the specification was published).<a class="pilcrow" href="#section-8.2-2">¶</a></p>
<p id="section-8.2-3">This specification additionally reserves the use of UDP port 853 for
DoQ. QUIC version 1 was designed to be able to coexist with other protocols on
the same port, including DTLS; see <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9000#section-17.2">Section 17.2</a> of [<a class="xref" href="#RFC9000">RFC9000</a>]</span>. This means
that deployments that serve DoD and DoQ (QUIC version 1) on the
same port will be able to demultiplex the two due to the second most
significant bit in each UDP payload. Such deployments ought to check the
signatures of future versions or extensions (e.g., <span>[<a class="xref" href="#I-D.ietf-quic-bit-grease">GREASING-QUIC</a>]</span>)
of QUIC and DTLS before deploying them to serve DNS on the same port.<a class="pilcrow" href="#section-8.2-3">¶</a></p>
<p id="section-8.2-4">IANA has updated the following value in the "Service Name and Transport
Protocol Port Number Registry" in the System range. The registry for that range
requires IETF Review or IESG Approval <span>[<a class="xref" href="#RFC6335">RFC6335</a>]</span>.<a class="pilcrow" href="#section-8.2-4">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-8.2-5">
          <dt id="section-8.2-5.1">
Service Name:  </dt>
          <dd id="section-8.2-5.2" style="margin-left: 1.5em">
            <p id="section-8.2-5.2.1">domain-s<a class="pilcrow" href="#section-8.2-5.2.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-8.2-5.3">
Port Number:  </dt>
          <dd id="section-8.2-5.4" style="margin-left: 1.5em">
            <p id="section-8.2-5.4.1">853<a class="pilcrow" href="#section-8.2-5.4.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-8.2-5.5">
Transport Protocol(s):  </dt>
          <dd id="section-8.2-5.6" style="margin-left: 1.5em">
            <p id="section-8.2-5.6.1">UDP<a class="pilcrow" href="#section-8.2-5.6.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-8.2-5.7">
Assignee:  </dt>
          <dd id="section-8.2-5.8" style="margin-left: 1.5em">
            <p id="section-8.2-5.8.1">IESG<a class="pilcrow" href="#section-8.2-5.8.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-8.2-5.9">
Contact:  </dt>
          <dd id="section-8.2-5.10" style="margin-left: 1.5em">
            <p id="section-8.2-5.10.1">IETF Chair<a class="pilcrow" href="#section-8.2-5.10.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-8.2-5.11">
Description:  </dt>
          <dd id="section-8.2-5.12" style="margin-left: 1.5em">
            <p id="section-8.2-5.12.1">DNS query-response protocol run over DTLS or QUIC<a class="pilcrow" href="#section-8.2-5.12.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-8.2-5.13">
Reference:  </dt>
          <dd id="section-8.2-5.14" style="margin-left: 1.5em">
            <p id="section-8.2-5.14.1"><span>[<a class="xref" href="#RFC7858">RFC7858</a>]</span><span>[<a class="xref" href="#RFC8094">RFC8094</a>]</span> This document<a class="pilcrow" href="#section-8.2-5.14.1">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-8.2-6">Additionally, IANA has updated the Description field for the
corresponding TCP port 853 allocation to be "DNS query-response protocol run
over TLS" and removed <span>[<a class="xref" href="#RFC8094">RFC8094</a>]</span> from the TCP allocation's Reference field for consistency and clarity.<a class="pilcrow" href="#section-8.2-6">¶</a></p>
</section>
</div>
<div id="reservation-of-extended-dns-error-code-too-early">
<section id="section-8.3">
        <h3 id="name-reservation-of-an-extended-">
<a class="section-number selfRef" href="#section-8.3">8.3. </a><a class="section-name selfRef" href="#name-reservation-of-an-extended-">Reservation of an Extended DNS Error Code: Too Early</a>
        </h3>
<p id="section-8.3-1">IANA has registered the following value in
the "Extended DNS Error Codes" registry <span>[<a class="xref" href="#RFC8914">RFC8914</a>]</span>:<a class="pilcrow" href="#section-8.3-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-8.3-2">
          <dt id="section-8.3-2.1">
INFO-CODE:  </dt>
          <dd id="section-8.3-2.2" style="margin-left: 1.5em">
            <p id="section-8.3-2.2.1">26<a class="pilcrow" href="#section-8.3-2.2.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-8.3-2.3">
Purpose:  </dt>
          <dd id="section-8.3-2.4" style="margin-left: 1.5em">
            <p id="section-8.3-2.4.1">Too Early<a class="pilcrow" href="#section-8.3-2.4.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-8.3-2.5">
Reference:  </dt>
          <dd id="section-8.3-2.6" style="margin-left: 1.5em">
            <p id="section-8.3-2.6.1">This document<a class="pilcrow" href="#section-8.3-2.6.1">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="iana-error-codes">
<section id="section-8.4">
        <h3 id="name-dns-over-quic-error-codes-r">
<a class="section-number selfRef" href="#section-8.4">8.4. </a><a class="section-name selfRef" href="#name-dns-over-quic-error-codes-r">DNS-over-QUIC Error Codes Registry</a>
        </h3>
<p id="section-8.4-1">IANA has added a registry for "DNS-over-QUIC Error Codes" on the
"Domain Name System (DNS) Parameters" web page.<a class="pilcrow" href="#section-8.4-1">¶</a></p>
<p id="section-8.4-2">The "DNS-over-QUIC Error Codes" registry governs a 62-bit space. This space is
split into three regions that are governed by different policies:<a class="pilcrow" href="#section-8.4-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.4-3.1">Permanent registrations for values between 0x00 and 0x3f (in hexadecimal;
inclusive), which are assigned using Standards Action or IESG Approval as
defined in Sections <a class="relref" href="https://www.rfc-editor.org/rfc/rfc8126#section-4.9">4.9</a> and <a class="relref" href="https://www.rfc-editor.org/rfc/rfc8126#section-4.10">4.10</a> of <span>[<a class="xref" href="#RFC8126">RFC8126</a>]</span><a class="pilcrow" href="#section-8.4-3.1">¶</a>
</li>
          <li class="normal" id="section-8.4-3.2">Permanent registrations for values larger than 0x3f, which are assigned
using the Specification Required policy (<span>[<a class="xref" href="#RFC8126">RFC8126</a>]</span>)<a class="pilcrow" href="#section-8.4-3.2">¶</a>
</li>
          <li class="normal" id="section-8.4-3.3">Provisional registrations for values larger than 0x3f, which require Expert
Review, as defined in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc8126#section-4.5">Section 4.5</a> of [<a class="xref" href="#RFC8126">RFC8126</a>]</span>.<a class="pilcrow" href="#section-8.4-3.3">¶</a>
</li>
        </ul>
<p id="section-8.4-4">Provisional reservations share the range of values larger than 0x3f
with some permanent registrations. This is by design to enable conversion
of provisional registrations into permanent registrations without requiring
changes in deployed systems. (This design is aligned with the principles
set in <span><a class="relref" href="https://www.rfc-editor.org/rfc/rfc9000#section-22">Section 22</a> of [<a class="xref" href="#RFC9000">RFC9000</a>]</span>.)<a class="pilcrow" href="#section-8.4-4">¶</a></p>
<p id="section-8.4-5">Registrations in this registry <span class="bcp14">MUST</span> include the following fields:<a class="pilcrow" href="#section-8.4-5">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-8.4-6">
          <dt id="section-8.4-6.1">
Value:  </dt>
          <dd id="section-8.4-6.2" style="margin-left: 1.5em">
            <p id="section-8.4-6.2.1">The assigned codepoint<a class="pilcrow" href="#section-8.4-6.2.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-8.4-6.3">
Status:  </dt>
          <dd id="section-8.4-6.4" style="margin-left: 1.5em">
            <p id="section-8.4-6.4.1">"Permanent" or "Provisional"<a class="pilcrow" href="#section-8.4-6.4.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-8.4-6.5">
Contact:  </dt>
          <dd id="section-8.4-6.6" style="margin-left: 1.5em">
            <p id="section-8.4-6.6.1">Contact details for the registrant<a class="pilcrow" href="#section-8.4-6.6.1">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-8.4-7">In addition, permanent registrations <span class="bcp14">MUST</span> include:<a class="pilcrow" href="#section-8.4-7">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-8.4-8">
          <dt id="section-8.4-8.1">
Error:  </dt>
          <dd id="section-8.4-8.2" style="margin-left: 1.5em">
            <p id="section-8.4-8.2.1">A short mnemonic for the parameter<a class="pilcrow" href="#section-8.4-8.2.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-8.4-8.3">
Specification:  </dt>
          <dd id="section-8.4-8.4" style="margin-left: 1.5em">
            <p id="section-8.4-8.4.1">A reference to a publicly available specification for the value (optional for provisional registrations)<a class="pilcrow" href="#section-8.4-8.4.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-8.4-8.5">
Description:  </dt>
          <dd id="section-8.4-8.6" style="margin-left: 1.5em">
            <p id="section-8.4-8.6.1">A brief description of the error code semantics, which <span class="bcp14">MAY</span> be a summary if a
specification reference is provided<a class="pilcrow" href="#section-8.4-8.6.1">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-8.4-9">Provisional registrations of codepoints are intended to allow for private use
and experimentation with extensions to DoQ.  However,
provisional registrations could be reclaimed and reassigned for other purposes.
In addition to the parameters listed above, provisional registrations <span class="bcp14">MUST</span> include:<a class="pilcrow" href="#section-8.4-9">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-8.4-10">
          <dt id="section-8.4-10.1">
Date:  </dt>
          <dd id="section-8.4-10.2" style="margin-left: 1.5em">
            <p id="section-8.4-10.2.1">The date of last update to the registration<a class="pilcrow" href="#section-8.4-10.2.1">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-8.4-11">A request to update the date on any provisional
registration can be made without review from the designated expert(s).<a class="pilcrow" href="#section-8.4-11">¶</a></p>
<p id="section-8.4-12">The initial content of this registry is shown in <a class="xref" href="#iana-error-table">Table 1</a> and all
entries share the following fields:<a class="pilcrow" href="#section-8.4-12">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-8.4-13">
          <dt id="section-8.4-13.1">
Status:  </dt>
          <dd id="section-8.4-13.2" style="margin-left: 1.5em">
            <p id="section-8.4-13.2.1">Permanent<a class="pilcrow" href="#section-8.4-13.2.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-8.4-13.3">
Contact:  </dt>
          <dd id="section-8.4-13.4" style="margin-left: 1.5em">
            <p id="section-8.4-13.4.1">DPRIVE WG<a class="pilcrow" href="#section-8.4-13.4.1">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-8.4-13.5">
Specification:  </dt>
          <dd id="section-8.4-13.6" style="margin-left: 1.5em">
            <p id="section-8.4-13.6.1"><a class="xref" href="#doq-error-codes">Section 4.3</a><a class="pilcrow" href="#section-8.4-13.6.1">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<span id="name-initial-dns-over-quic-error"></span><div id="iana-error-table">
<table class="center" id="table-1">
          <caption>
<a class="selfRef" href="#table-1">Table 1</a>:
<a class="selfRef" href="#name-initial-dns-over-quic-error">Initial DNS-over-QUIC Error Codes Entries</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Value</th>
              <th class="text-left" colspan="1" rowspan="1">Error</th>
              <th class="text-left" colspan="1" rowspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0x0</td>
              <td class="text-left" colspan="1" rowspan="1">DOQ_NO_ERROR</td>
              <td class="text-left" colspan="1" rowspan="1">No error</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0x1</td>
              <td class="text-left" colspan="1" rowspan="1">DOQ_INTERNAL_ERROR</td>
              <td class="text-left" colspan="1" rowspan="1">Implementation error</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0x2</td>
              <td class="text-left" colspan="1" rowspan="1">DOQ_PROTOCOL_ERROR</td>
              <td class="text-left" colspan="1" rowspan="1">Generic protocol violation</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0x3</td>
              <td class="text-left" colspan="1" rowspan="1">DOQ_REQUEST_CANCELLED</td>
              <td class="text-left" colspan="1" rowspan="1">Request cancelled by client</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0x4</td>
              <td class="text-left" colspan="1" rowspan="1">DOQ_EXCESSIVE_LOAD</td>
              <td class="text-left" colspan="1" rowspan="1">Closing a connection for excessive load</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0x5</td>
              <td class="text-left" colspan="1" rowspan="1">DOQ_UNSPECIFIED_ERROR</td>
              <td class="text-left" colspan="1" rowspan="1">No error reason specified</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0xd098ea5e</td>
              <td class="text-left" colspan="1" rowspan="1">DOQ_ERROR_RESERVED</td>
              <td class="text-left" colspan="1" rowspan="1">Alternative error code used for tests</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
</section>
</div>
<section id="section-9">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-9">9. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-9.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-9.1">9.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC1034">[RFC1034]</dt>
        <dd>
<span class="refAuthor">Mockapetris, P.</span>, <span class="refTitle">"Domain names - concepts and facilities"</span>, <span class="seriesInfo">STD 13</span>, <span class="seriesInfo">RFC 1034</span>, <span class="seriesInfo">DOI 10.17487/RFC1034</span>, <time class="refDate" datetime="1987-11">November 1987</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1034">https://www.rfc-editor.org/info/rfc1034</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1035">[RFC1035]</dt>
        <dd>
<span class="refAuthor">Mockapetris, P.</span>, <span class="refTitle">"Domain names - implementation and specification"</span>, <span class="seriesInfo">STD 13</span>, <span class="seriesInfo">RFC 1035</span>, <span class="seriesInfo">DOI 10.17487/RFC1035</span>, <time class="refDate" datetime="1987-11">November 1987</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1035">https://www.rfc-editor.org/info/rfc1035</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1995">[RFC1995]</dt>
        <dd>
<span class="refAuthor">Ohta, M.</span>, <span class="refTitle">"Incremental Zone Transfer in DNS"</span>, <span class="seriesInfo">RFC 1995</span>, <span class="seriesInfo">DOI 10.17487/RFC1995</span>, <time class="refDate" datetime="1996-08">August 1996</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1995">https://www.rfc-editor.org/info/rfc1995</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time class="refDate" datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5936">[RFC5936]</dt>
        <dd>
<span class="refAuthor">Lewis, E.</span> and <span class="refAuthor">A. Hoenes, Ed.</span>, <span class="refTitle">"DNS Zone Transfer Protocol (AXFR)"</span>, <span class="seriesInfo">RFC 5936</span>, <span class="seriesInfo">DOI 10.17487/RFC5936</span>, <time class="refDate" datetime="2010-06">June 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5936">https://www.rfc-editor.org/info/rfc5936</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6891">[RFC6891]</dt>
        <dd>
<span class="refAuthor">Damas, J.</span>, <span class="refAuthor">Graff, M.</span>, and <span class="refAuthor">P. Vixie</span>, <span class="refTitle">"Extension Mechanisms for DNS (EDNS(0))"</span>, <span class="seriesInfo">STD 75</span>, <span class="seriesInfo">RFC 6891</span>, <span class="seriesInfo">DOI 10.17487/RFC6891</span>, <time class="refDate" datetime="2013-04">April 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6891">https://www.rfc-editor.org/info/rfc6891</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7301">[RFC7301]</dt>
        <dd>
<span class="refAuthor">Friedl, S.</span>, <span class="refAuthor">Popov, A.</span>, <span class="refAuthor">Langley, A.</span>, and <span class="refAuthor">E. Stephan</span>, <span class="refTitle">"Transport Layer Security (TLS) Application-Layer Protocol Negotiation Extension"</span>, <span class="seriesInfo">RFC 7301</span>, <span class="seriesInfo">DOI 10.17487/RFC7301</span>, <time class="refDate" datetime="2014-07">July 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7301">https://www.rfc-editor.org/info/rfc7301</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7766">[RFC7766]</dt>
        <dd>
<span class="refAuthor">Dickinson, J.</span>, <span class="refAuthor">Dickinson, S.</span>, <span class="refAuthor">Bellis, R.</span>, <span class="refAuthor">Mankin, A.</span>, and <span class="refAuthor">D. Wessels</span>, <span class="refTitle">"DNS Transport over TCP - Implementation Requirements"</span>, <span class="seriesInfo">RFC 7766</span>, <span class="seriesInfo">DOI 10.17487/RFC7766</span>, <time class="refDate" datetime="2016-03">March 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7766">https://www.rfc-editor.org/info/rfc7766</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7830">[RFC7830]</dt>
        <dd>
<span class="refAuthor">Mayrhofer, A.</span>, <span class="refTitle">"The EDNS(0) Padding Option"</span>, <span class="seriesInfo">RFC 7830</span>, <span class="seriesInfo">DOI 10.17487/RFC7830</span>, <time class="refDate" datetime="2016-05">May 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7830">https://www.rfc-editor.org/info/rfc7830</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7858">[RFC7858]</dt>
        <dd>
<span class="refAuthor">Hu, Z.</span>, <span class="refAuthor">Zhu, L.</span>, <span class="refAuthor">Heidemann, J.</span>, <span class="refAuthor">Mankin, A.</span>, <span class="refAuthor">Wessels, D.</span>, and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Specification for DNS over Transport Layer Security (TLS)"</span>, <span class="seriesInfo">RFC 7858</span>, <span class="seriesInfo">DOI 10.17487/RFC7858</span>, <time class="refDate" datetime="2016-05">May 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7858">https://www.rfc-editor.org/info/rfc7858</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time class="refDate" datetime="2017-06">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time class="refDate" datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8310">[RFC8310]</dt>
        <dd>
<span class="refAuthor">Dickinson, S.</span>, <span class="refAuthor">Gillmor, D.</span>, and <span class="refAuthor">T. Reddy</span>, <span class="refTitle">"Usage Profiles for DNS over TLS and DNS over DTLS"</span>, <span class="seriesInfo">RFC 8310</span>, <span class="seriesInfo">DOI 10.17487/RFC8310</span>, <time class="refDate" datetime="2018-03">March 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8310">https://www.rfc-editor.org/info/rfc8310</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time class="refDate" datetime="2018-08">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8467">[RFC8467]</dt>
        <dd>
<span class="refAuthor">Mayrhofer, A.</span>, <span class="refTitle">"Padding Policies for Extension Mechanisms for DNS (EDNS(0))"</span>, <span class="seriesInfo">RFC 8467</span>, <span class="seriesInfo">DOI 10.17487/RFC8467</span>, <time class="refDate" datetime="2018-10">October 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8467">https://www.rfc-editor.org/info/rfc8467</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8914">[RFC8914]</dt>
        <dd>
<span class="refAuthor">Kumari, W.</span>, <span class="refAuthor">Hunt, E.</span>, <span class="refAuthor">Arends, R.</span>, <span class="refAuthor">Hardaker, W.</span>, and <span class="refAuthor">D. Lawrence</span>, <span class="refTitle">"Extended DNS Errors"</span>, <span class="seriesInfo">RFC 8914</span>, <span class="seriesInfo">DOI 10.17487/RFC8914</span>, <time class="refDate" datetime="2020-10">October 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8914">https://www.rfc-editor.org/info/rfc8914</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9000">[RFC9000]</dt>
        <dd>
<span class="refAuthor">Iyengar, J., Ed.</span> and <span class="refAuthor">M. Thomson, Ed.</span>, <span class="refTitle">"QUIC: A UDP-Based Multiplexed and Secure Transport"</span>, <span class="seriesInfo">RFC 9000</span>, <span class="seriesInfo">DOI 10.17487/RFC9000</span>, <time class="refDate" datetime="2021-05">May 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9000">https://www.rfc-editor.org/info/rfc9000</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9001">[RFC9001]</dt>
        <dd>
<span class="refAuthor">Thomson, M., Ed.</span> and <span class="refAuthor">S. Turner, Ed.</span>, <span class="refTitle">"Using TLS to Secure QUIC"</span>, <span class="seriesInfo">RFC 9001</span>, <span class="seriesInfo">DOI 10.17487/RFC9001</span>, <time class="refDate" datetime="2021-05">May 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9001">https://www.rfc-editor.org/info/rfc9001</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9103">[RFC9103]</dt>
      <dd>
<span class="refAuthor">Toorop, W.</span>, <span class="refAuthor">Dickinson, S.</span>, <span class="refAuthor">Sahib, S.</span>, <span class="refAuthor">Aras, P.</span>, and <span class="refAuthor">A. Mankin</span>, <span class="refTitle">"DNS Zone Transfer over TLS"</span>, <span class="seriesInfo">RFC 9103</span>, <span class="seriesInfo">DOI 10.17487/RFC9103</span>, <time class="refDate" datetime="2021-08">August 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9103">https://www.rfc-editor.org/info/rfc9103</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-9.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-9.2">9.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="BCP195">[BCP195]</dt>
        <dd>
<div class="refInstance" id="RFC7525">
            <span class="refAuthor">Sheffer, Y.</span>, <span class="refAuthor">Holz, R.</span>, and <span class="refAuthor">P. Saint-Andre</span>, <span class="refTitle">"Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"</span>, <span class="seriesInfo">BCP 195</span>, <span class="seriesInfo">RFC 7525</span>, <time class="refDate" datetime="2015-05">May 2015</time>. </div>
<div class="refInstance" id="RFC8996">
            <span class="refAuthor">Moriarty, K.</span> and <span class="refAuthor">S. Farrell</span>, <span class="refTitle">"Deprecating TLS 1.0 and TLS 1.1"</span>, <span class="seriesInfo">BCP 195</span>, <span class="seriesInfo">RFC 8996</span>, <time class="refDate" datetime="2021-03">March 2021</time>. </div>
<span>&lt;<a href="https://www.rfc-editor.org/info/bcp195">https://www.rfc-editor.org/info/bcp195</a>&gt;</span>
</dd>
<dd class="break"></dd>
<dt id="I-D.ietf-dnsop-rfc8499bis">[DNS-TERMS]</dt>
        <dd>
<span class="refAuthor">Hoffman, P.</span> and <span class="refAuthor">K. Fujiwara</span>, <span class="refTitle">"DNS Terminology"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-dnsop-rfc8499bis-03</span>, <time class="refDate" datetime="2021-09-28">28 September 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-dnsop-rfc8499bis-03">https://datatracker.ietf.org/doc/html/draft-ietf-dnsop-rfc8499bis-03</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="DNS0RTT">[DNS0RTT]</dt>
        <dd>
<span class="refAuthor">Kahn Gillmor, D.</span>, <span class="refTitle">"DNS + 0-RTT"</span>, <span class="seriesInfo">Message to DNS-Privacy WG mailing list</span>, <time class="refDate" datetime="2016-04-06">6 April 2016</time>, <span>&lt;<a href="https://www.ietf.org/mail-archive/web/dns-privacy/current/msg01276.html">https://www.ietf.org/mail-archive/web/dns-privacy/current/msg01276.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-quic-bit-grease">[GREASING-QUIC]</dt>
        <dd>
<span class="refAuthor">Thomson, M.</span>, <span class="refTitle">"Greasing the QUIC Bit"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-quic-bit-grease-02</span>, <time class="refDate" datetime="2021-11-10">10 November 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-quic-bit-grease-02">https://datatracker.ietf.org/doc/html/draft-ietf-quic-bit-grease-02</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-quic-http">[HTTP/3]</dt>
        <dd>
<span class="refAuthor">Bishop, M., Ed.</span>, <span class="refTitle">"Hypertext Transfer Protocol Version 3 (HTTP/3)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-quic-http-34</span>, <time class="refDate" datetime="2021-02-02">2 February 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-quic-http-34">https://datatracker.ietf.org/doc/html/draft-ietf-quic-http-34</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1996">[RFC1996]</dt>
        <dd>
<span class="refAuthor">Vixie, P.</span>, <span class="refTitle">"A Mechanism for Prompt Notification of Zone Changes (DNS NOTIFY)"</span>, <span class="seriesInfo">RFC 1996</span>, <span class="seriesInfo">DOI 10.17487/RFC1996</span>, <time class="refDate" datetime="1996-08">August 1996</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1996">https://www.rfc-editor.org/info/rfc1996</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3833">[RFC3833]</dt>
        <dd>
<span class="refAuthor">Atkins, D.</span> and <span class="refAuthor">R. Austein</span>, <span class="refTitle">"Threat Analysis of the Domain Name System (DNS)"</span>, <span class="seriesInfo">RFC 3833</span>, <span class="seriesInfo">DOI 10.17487/RFC3833</span>, <time class="refDate" datetime="2004-08">August 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3833">https://www.rfc-editor.org/info/rfc3833</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6335">[RFC6335]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Eggert, L.</span>, <span class="refAuthor">Touch, J.</span>, <span class="refAuthor">Westerlund, M.</span>, and <span class="refAuthor">S. Cheshire</span>, <span class="refTitle">"Internet Assigned Numbers Authority (IANA) Procedures for the Management of the Service Name and Transport Protocol Port Number Registry"</span>, <span class="seriesInfo">BCP 165</span>, <span class="seriesInfo">RFC 6335</span>, <span class="seriesInfo">DOI 10.17487/RFC6335</span>, <time class="refDate" datetime="2011-08">August 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6335">https://www.rfc-editor.org/info/rfc6335</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7828">[RFC7828]</dt>
        <dd>
<span class="refAuthor">Wouters, P.</span>, <span class="refAuthor">Abley, J.</span>, <span class="refAuthor">Dickinson, S.</span>, and <span class="refAuthor">R. Bellis</span>, <span class="refTitle">"The edns-tcp-keepalive EDNS0 Option"</span>, <span class="seriesInfo">RFC 7828</span>, <span class="seriesInfo">DOI 10.17487/RFC7828</span>, <time class="refDate" datetime="2016-04">April 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7828">https://www.rfc-editor.org/info/rfc7828</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7873">[RFC7873]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span> and <span class="refAuthor">M. Andrews</span>, <span class="refTitle">"Domain Name System (DNS) Cookies"</span>, <span class="seriesInfo">RFC 7873</span>, <span class="seriesInfo">DOI 10.17487/RFC7873</span>, <time class="refDate" datetime="2016-05">May 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7873">https://www.rfc-editor.org/info/rfc7873</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8094">[RFC8094]</dt>
        <dd>
<span class="refAuthor">Reddy, T.</span>, <span class="refAuthor">Wing, D.</span>, and <span class="refAuthor">P. Patil</span>, <span class="refTitle">"DNS over Datagram Transport Layer Security (DTLS)"</span>, <span class="seriesInfo">RFC 8094</span>, <span class="seriesInfo">DOI 10.17487/RFC8094</span>, <time class="refDate" datetime="2017-02">February 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8094">https://www.rfc-editor.org/info/rfc8094</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8484">[RFC8484]</dt>
        <dd>
<span class="refAuthor">Hoffman, P.</span> and <span class="refAuthor">P. McManus</span>, <span class="refTitle">"DNS Queries over HTTPS (DoH)"</span>, <span class="seriesInfo">RFC 8484</span>, <span class="seriesInfo">DOI 10.17487/RFC8484</span>, <time class="refDate" datetime="2018-10">October 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8484">https://www.rfc-editor.org/info/rfc8484</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8490">[RFC8490]</dt>
        <dd>
<span class="refAuthor">Bellis, R.</span>, <span class="refAuthor">Cheshire, S.</span>, <span class="refAuthor">Dickinson, J.</span>, <span class="refAuthor">Dickinson, S.</span>, <span class="refAuthor">Lemon, T.</span>, and <span class="refAuthor">T. Pusateri</span>, <span class="refTitle">"DNS Stateful Operations"</span>, <span class="seriesInfo">RFC 8490</span>, <span class="seriesInfo">DOI 10.17487/RFC8490</span>, <time class="refDate" datetime="2019-03">March 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8490">https://www.rfc-editor.org/info/rfc8490</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8932">[RFC8932]</dt>
        <dd>
<span class="refAuthor">Dickinson, S.</span>, <span class="refAuthor">Overeinder, B.</span>, <span class="refAuthor">van Rijswijk-Deij, R.</span>, and <span class="refAuthor">A. Mankin</span>, <span class="refTitle">"Recommendations for DNS Privacy Service Operators"</span>, <span class="seriesInfo">BCP 232</span>, <span class="seriesInfo">RFC 8932</span>, <span class="seriesInfo">DOI 10.17487/RFC8932</span>, <time class="refDate" datetime="2020-10">October 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8932">https://www.rfc-editor.org/info/rfc8932</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9002">[RFC9002]</dt>
        <dd>
<span class="refAuthor">Iyengar, J., Ed.</span> and <span class="refAuthor">I. Swett, Ed.</span>, <span class="refTitle">"QUIC Loss Detection and Congestion Control"</span>, <span class="seriesInfo">RFC 9002</span>, <span class="seriesInfo">DOI 10.17487/RFC9002</span>, <time class="refDate" datetime="2021-05">May 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9002">https://www.rfc-editor.org/info/rfc9002</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9076">[RFC9076]</dt>
      <dd>
<span class="refAuthor">Wicinski, T., Ed.</span>, <span class="refTitle">"DNS Privacy Considerations"</span>, <span class="seriesInfo">RFC 9076</span>, <span class="seriesInfo">DOI 10.17487/RFC9076</span>, <time class="refDate" datetime="2021-07">July 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9076">https://www.rfc-editor.org/info/rfc9076</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="the-notify-service">
<section id="appendix-A">
      <h2 id="name-the-notify-service">
<a class="section-number selfRef" href="#appendix-A">Appendix A. </a><a class="section-name selfRef" href="#name-the-notify-service">The NOTIFY Service</a>
      </h2>
<p id="appendix-A-1">This appendix discusses why it is considered acceptable to send NOTIFY
(see <span>[<a class="xref" href="#RFC1996">RFC1996</a>]</span>) in 0-RTT data.<a class="pilcrow" href="#appendix-A-1">¶</a></p>
<p id="appendix-A-2"><a class="xref" href="#session-resumption-and-0-rtt">Section 4.5</a> says "The 0-RTT mechanism <span class="bcp14">MUST NOT</span>
be used to send DNS requests that are not "replayable" transactions". This
specification supports sending a NOTIFY in 0-RTT data because
although a NOTIFY technically changes the state of the receiving server, the
effect of replaying NOTIFYs has negligible impact in practice.<a class="pilcrow" href="#appendix-A-2">¶</a></p>
<p id="appendix-A-3">NOTIFY messages prompt a secondary to either send an SOA query or an XFR
request to the primary on the basis that a newer version of the zone is
available. It has long been recognized that NOTIFYs can be forged and, in
theory, used to cause a secondary to send repeated unnecessary requests to the
primary. For this reason, most implementations have some form of throttling of the
SOA/XFR queries triggered by the receipt of one or more NOTIFYs.<a class="pilcrow" href="#appendix-A-3">¶</a></p>
<p id="appendix-A-4"><span>[<a class="xref" href="#RFC9103">RFC9103</a>]</span> describes the privacy risks associated with both NOTIFY and SOA queries
and does not include addressing those risks within the scope of encrypting zone
transfers. Given this, the privacy benefit of using DoQ for NOTIFY is not clear,
but for the same reason, sending NOTIFY as 0-RTT data has no privacy risk above
that of sending it using cleartext DNS.<a class="pilcrow" href="#appendix-A-4">¶</a></p>
</section>
</div>
<div id="acknowledgements">
<section id="appendix-B">
      <h2 id="name-acknowledgements">
<a class="section-name selfRef" href="#name-acknowledgements">Acknowledgements</a>
      </h2>
<p id="appendix-B-1">This document liberally borrows text from the HTTP/3 specification
      <span>[<a class="xref" href="#I-D.ietf-quic-http">HTTP/3</a>]</span> edited by <span class="contact-name">Mike       Bishop</span> and from the DoT specification <span>[<a class="xref" href="#RFC7858">RFC7858</a>]</span> authored by <span class="contact-name">Zi Hu</span>, <span class="contact-name">Liang Zhu</span>, <span class="contact-name">John Heidemann</span>, <span class="contact-name">Allison       Mankin</span>, <span class="contact-name">Duane Wessels</span>, and <span class="contact-name">Paul Hoffman</span>.<a class="pilcrow" href="#appendix-B-1">¶</a></p>
<p id="appendix-B-2">The privacy issue with 0-RTT data and session resumption was
      analyzed by <span class="contact-name">Daniel Kahn Gillmor</span> (DKG) in a message to the IETF DPRIVE
      Working Group <span>[<a class="xref" href="#DNS0RTT">DNS0RTT</a>]</span>.<a class="pilcrow" href="#appendix-B-2">¶</a></p>
<p id="appendix-B-3">Thanks to <span class="contact-name">Tony Finch</span> for an extensive review of the initial draft version
      of this document, and to <span class="contact-name">Robert Evans</span> for the discussion of 0-RTT privacy
      issues.  Early reviews by <span class="contact-name">Paul Hoffman</span> and <span class="contact-name">Martin Thomson</span> and
      interoperability tests conducted by Stephane Bortzmeyer helped improve
      the definition of the protocol.<a class="pilcrow" href="#appendix-B-3">¶</a></p>
<p id="appendix-B-4">Thanks also to <span class="contact-name">Martin Thomson</span> and <span class="contact-name">Martin Duke</span> for their later reviews
      focusing on the low-level QUIC details, which helped clarify several
      aspects of DoQ. Thanks to <span class="contact-name">Andrey Meshkov</span>, <span class="contact-name">Loganaden Velvindron</span>, <span class="contact-name">Lucas       Pardue</span>, <span class="contact-name">Matt Joras</span>, <span class="contact-name">Mirja Kuelewind</span>, <span class="contact-name">Brian Trammell</span>, and <span class="contact-name">Phillip       Hallam-Baker</span> for their reviews and contributions.<a class="pilcrow" href="#appendix-B-4">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-addresses">
<a class="section-name selfRef" href="#name-authors-addresses">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Christian Huitema</span></div>
<div class="left" dir="auto"><span class="org">Private Octopus Inc.</span></div>
<div class="left" dir="auto"><span class="street-address">427 Golfcourse Rd</span></div>
<div class="left" dir="auto">
<span class="locality">Friday Harbor</span>,  <span class="postal-code">WA 98250</span>
</div>
<div class="left" dir="auto"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:huitema@huitema.net">huitema@huitema.net</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Sara Dickinson</span></div>
<div class="left" dir="auto"><span class="org">Sinodun IT</span></div>
<div class="left" dir="auto"><span class="street-address">Oxford Science Park</span></div>
<div class="left" dir="auto"><span class="locality">Oxford</span></div>
<div class="left" dir="auto"><span class="postal-code">OX4 4GA</span></div>
<div class="left" dir="auto"><span class="country-name">United Kingdom</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:sara@sinodun.com">sara@sinodun.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Allison Mankin</span></div>
<div class="left" dir="auto"><span class="org">Salesforce</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:allison.mankin@gmail.com">allison.mankin@gmail.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>