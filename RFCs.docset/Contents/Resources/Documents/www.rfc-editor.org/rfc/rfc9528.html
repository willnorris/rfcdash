<!DOCTYPE html>
<html class="RFC" lang="en"><head>
<meta charset="utf-8"/>
<meta content="Common,Latin" name="scripts"/>
<meta content="initial-scale=1.0" name="viewport"/>
<title>RFC 9528: Ephemeral Diffie-Hellman Over COSE (EDHOC)</title>
<meta content="Göran Selander" name="author"/>
<meta content="John Preuß Mattsson" name="author"/>
<meta content="Francesca Palombini" name="author"/>
<meta content="
       This document specifies Ephemeral Diffie-Hellman Over COSE (EDHOC), a very compact and lightweight authenticated Diffie-Hellman key exchange with ephemeral keys. EDHOC provides mutual authentication, forward secrecy, and identity protection. EDHOC is intended for usage in constrained scenarios, and a main use case is to establish an Object Security for Constrained RESTful Environments (OSCORE) security context. By reusing CBOR Object Signing and Encryption (COSE) for cryptography, Concise Binary Object Representation (CBOR) for encoding, and Constrained Application Protocol (CoAP) for transport, the additional code size can be kept very low. 
    " name="description"/>
<meta content="xml2rfc 3.20.1" name="generator"/>
<meta content="AKE" name="keyword"/>
<meta content="LAKE" name="keyword"/>
<meta content="COSE" name="keyword"/>
<meta content="OSCORE" name="keyword"/>
<meta content="lightweight authenticated key exchange" name="keyword"/>
<meta content="constrained node networks" name="keyword"/>
<meta content="IoT security" name="keyword"/>
<meta content="9528" name="rfc.number"/>
<!-- Generator version information:
  xml2rfc 3.20.1
    Python 3.9.15
    ConfigArgParse 1.5.3
    google-i18n-address 3.0.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.0
    platformdirs 3.8.0
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.28.0
    setuptools 44.1.1
    six 1.16.0
    wcwidth 0.2.5
    weasyprint 56.1
-->
<link href="rfc9528.xml" rel="alternate" type="application/rfc+xml"/>
<link href="#copyright" rel="license"/>
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
  overflow-wrap: break-word;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
blockquote > *:last-child {
  margin-bottom: 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.refSubseries {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css"/>
<link href="https://datatracker.ietf.org/doc/draft-ietf-lake-edhoc-23" rel="prev"/>
  <link href="https://dx.doi.org/10.17487/rfc9528" rel="alternate"/>
  <link href="urn:issn:2070-1721" rel="alternate"/>
  </head>
<body class="xml2rfc">
<script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 9528</td>
<td class="center">EDHOC</td>
<td class="right">March 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Selander, et al.</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div class="document-information" id="external-metadata"></div>
<div class="document-information" id="internal-metadata">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a class="eref" href="https://www.rfc-editor.org/rfc/rfc9528">9528</a></dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time class="published" datetime="2024-03">March 2024</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">G. Selander</div>
<div class="org">Ericsson</div>
</div>
<div class="author">
      <div class="author-name">J. Preuß Mattsson</div>
<div class="org">Ericsson</div>
</div>
<div class="author">
      <div class="author-name">F. Palombini</div>
<div class="org">Ericsson</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 9528</h1>
<h1 id="title">Ephemeral Diffie-Hellman Over COSE (EDHOC)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a class="selfRef" href="#abstract">Abstract</a></h2>
<p id="section-abstract-1">This document specifies Ephemeral Diffie-Hellman Over COSE (EDHOC), a very compact and lightweight authenticated Diffie-Hellman key exchange with ephemeral keys. EDHOC provides mutual authentication, forward secrecy, and identity protection. EDHOC is intended for usage in constrained scenarios, and a main use case is to establish an Object Security for Constrained RESTful Environments (OSCORE) security context. By reusing CBOR Object Signing and Encryption (COSE) for cryptography, Concise Binary Object Representation (CBOR) for encoding, and Constrained Application Protocol (CoAP) for transport, the additional code size can be kept very low.<a class="pilcrow" href="#section-abstract-1">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a class="section-name selfRef" href="#name-status-of-this-memo">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a class="pilcrow" href="#section-boilerplate.1-1">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a class="pilcrow" href="#section-boilerplate.1-2">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc9528">https://www.rfc-editor.org/info/rfc9528</a></span>.<a class="pilcrow" href="#section-boilerplate.1-3">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a class="section-name selfRef" href="#name-copyright-notice">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a class="pilcrow" href="#section-boilerplate.2-1">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a class="pilcrow" href="#section-boilerplate.2-2">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a class="toplink" href="#" onclick="scroll(0,0)">▲</a><h2 id="name-table-of-contents">
<a class="section-name selfRef" href="#name-table-of-contents">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a class="auto internal xref" href="#section-1">1</a>.  <a class="internal xref" href="#name-introduction">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p class="keepWithNext" id="section-toc.1-1.1.2.1.1"><a class="auto internal xref" href="#section-1.1">1.1</a>.  <a class="internal xref" href="#name-motivation">Motivation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p class="keepWithNext" id="section-toc.1-1.1.2.2.1"><a class="auto internal xref" href="#section-1.2">1.2</a>.  <a class="internal xref" href="#name-message-size-examples">Message Size Examples</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3">
                <p class="keepWithNext" id="section-toc.1-1.1.2.3.1"><a class="auto internal xref" href="#section-1.3">1.3</a>.  <a class="internal xref" href="#name-document-structure">Document Structure</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.4">
                <p id="section-toc.1-1.1.2.4.1"><a class="auto internal xref" href="#section-1.4">1.4</a>.  <a class="internal xref" href="#name-terminology-and-requirement">Terminology and Requirements Language</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a class="auto internal xref" href="#section-2">2</a>.  <a class="internal xref" href="#name-edhoc-outline">EDHOC Outline</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a class="auto internal xref" href="#section-3">3</a>.  <a class="internal xref" href="#name-protocol-elements">Protocol Elements</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a class="auto internal xref" href="#section-3.1">3.1</a>.  <a class="internal xref" href="#name-general">General</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a class="auto internal xref" href="#section-3.2">3.2</a>.  <a class="internal xref" href="#name-method">Method</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a class="auto internal xref" href="#section-3.3">3.3</a>.  <a class="internal xref" href="#name-connection-identifiers">Connection Identifiers</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a class="auto internal xref" href="#section-3.4">3.4</a>.  <a class="internal xref" href="#name-transport">Transport</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a class="auto internal xref" href="#section-3.5">3.5</a>.  <a class="internal xref" href="#name-authentication-parameters">Authentication Parameters</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6">
                <p id="section-toc.1-1.3.2.6.1"><a class="auto internal xref" href="#section-3.6">3.6</a>.  <a class="internal xref" href="#name-cipher-suites">Cipher Suites</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7">
                <p id="section-toc.1-1.3.2.7.1"><a class="auto internal xref" href="#section-3.7">3.7</a>.  <a class="internal xref" href="#name-ephemeral-public-keys">Ephemeral Public Keys</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.8">
                <p id="section-toc.1-1.3.2.8.1"><a class="auto internal xref" href="#section-3.8">3.8</a>.  <a class="internal xref" href="#name-external-authorization-data">External Authorization Data (EAD)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.9">
                <p id="section-toc.1-1.3.2.9.1"><a class="auto internal xref" href="#section-3.9">3.9</a>.  <a class="internal xref" href="#name-application-profile">Application Profile</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a class="auto internal xref" href="#section-4">4</a>.  <a class="internal xref" href="#name-key-derivation">Key Derivation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a class="auto internal xref" href="#section-4.1">4.1</a>.  <a class="internal xref" href="#name-keys-for-edhoc-message-proc">Keys for EDHOC Message Processing</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a class="auto internal xref" href="#section-4.2">4.2</a>.  <a class="internal xref" href="#name-keys-for-edhoc-applications">Keys for EDHOC Applications</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a class="auto internal xref" href="#section-5">5</a>.  <a class="internal xref" href="#name-message-formatting-and-proc">Message Formatting and Processing</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a class="auto internal xref" href="#section-5.1">5.1</a>.  <a class="internal xref" href="#name-edhoc-message-processing-ou">EDHOC Message Processing Outline</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a class="auto internal xref" href="#section-5.2">5.2</a>.  <a class="internal xref" href="#name-edhoc-message-1">EDHOC Message 1</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a class="auto internal xref" href="#section-5.3">5.3</a>.  <a class="internal xref" href="#name-edhoc-message-2">EDHOC Message 2</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a class="auto internal xref" href="#section-5.4">5.4</a>.  <a class="internal xref" href="#name-edhoc-message-3">EDHOC Message 3</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5">
                <p id="section-toc.1-1.5.2.5.1"><a class="auto internal xref" href="#section-5.5">5.5</a>.  <a class="internal xref" href="#name-edhoc-message-4">EDHOC Message 4</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a class="auto internal xref" href="#section-6">6</a>.  <a class="internal xref" href="#name-error-handling">Error Handling</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a class="auto internal xref" href="#section-6.1">6.1</a>.  <a class="internal xref" href="#name-success">Success</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a class="auto internal xref" href="#section-6.2">6.2</a>.  <a class="internal xref" href="#name-unspecified-error">Unspecified Error</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a class="auto internal xref" href="#section-6.3">6.3</a>.  <a class="internal xref" href="#name-wrong-selected-cipher-suite">Wrong Selected Cipher Suite</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a class="auto internal xref" href="#section-6.4">6.4</a>.  <a class="internal xref" href="#name-unknown-credential-referenc">Unknown Credential Referenced</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a class="auto internal xref" href="#section-7">7</a>.  <a class="internal xref" href="#name-edhoc-message-deduplication">EDHOC Message Deduplication</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a class="auto internal xref" href="#section-8">8</a>.  <a class="internal xref" href="#name-compliance-requirements">Compliance Requirements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a class="auto internal xref" href="#section-9">9</a>.  <a class="internal xref" href="#name-security-considerations">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a class="auto internal xref" href="#section-9.1">9.1</a>.  <a class="internal xref" href="#name-security-properties">Security Properties</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a class="auto internal xref" href="#section-9.2">9.2</a>.  <a class="internal xref" href="#name-cryptographic-consideration">Cryptographic Considerations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a class="auto internal xref" href="#section-9.3">9.3</a>.  <a class="internal xref" href="#name-cipher-suites-and-cryptogra">Cipher Suites and Cryptographic Algorithms</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4">
                <p id="section-toc.1-1.9.2.4.1"><a class="auto internal xref" href="#section-9.4">9.4</a>.  <a class="internal xref" href="#name-post-quantum-considerations">Post-Quantum Considerations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.5">
                <p id="section-toc.1-1.9.2.5.1"><a class="auto internal xref" href="#section-9.5">9.5</a>.  <a class="internal xref" href="#name-unprotected-data-and-privac">Unprotected Data and Privacy</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.6">
                <p id="section-toc.1-1.9.2.6.1"><a class="auto internal xref" href="#section-9.6">9.6</a>.  <a class="internal xref" href="#name-updated-internet-threat-mod">Updated Internet Threat Model Considerations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.7">
                <p id="section-toc.1-1.9.2.7.1"><a class="auto internal xref" href="#section-9.7">9.7</a>.  <a class="internal xref" href="#name-denial-of-service">Denial of Service</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.8">
                <p id="section-toc.1-1.9.2.8.1"><a class="auto internal xref" href="#section-9.8">9.8</a>.  <a class="internal xref" href="#name-implementation-consideratio">Implementation Considerations</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a class="auto internal xref" href="#section-10">10</a>. <a class="internal xref" href="#name-iana-considerations">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a class="auto internal xref" href="#section-10.1">10.1</a>.  <a class="internal xref" href="#name-edhoc-exporter-label-regist">EDHOC Exporter Label Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a class="auto internal xref" href="#section-10.2">10.2</a>.  <a class="internal xref" href="#name-edhoc-cipher-suites-registr">EDHOC Cipher Suites Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3">
                <p id="section-toc.1-1.10.2.3.1"><a class="auto internal xref" href="#section-10.3">10.3</a>.  <a class="internal xref" href="#name-edhoc-method-type-registry">EDHOC Method Type Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.4">
                <p id="section-toc.1-1.10.2.4.1"><a class="auto internal xref" href="#section-10.4">10.4</a>.  <a class="internal xref" href="#name-edhoc-error-codes-registry">EDHOC Error Codes Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.5">
                <p id="section-toc.1-1.10.2.5.1"><a class="auto internal xref" href="#section-10.5">10.5</a>.  <a class="internal xref" href="#name-edhoc-external-authorizatio">EDHOC External Authorization Data Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.6">
                <p id="section-toc.1-1.10.2.6.1"><a class="auto internal xref" href="#section-10.6">10.6</a>.  <a class="internal xref" href="#name-cose-header-parameters-regi">COSE Header Parameters Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.7">
                <p id="section-toc.1-1.10.2.7.1"><a class="auto internal xref" href="#section-10.7">10.7</a>.  <a class="internal xref" href="#name-well-known-uri-registry">Well-Known URI Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.8">
                <p id="section-toc.1-1.10.2.8.1"><a class="auto internal xref" href="#section-10.8">10.8</a>.  <a class="internal xref" href="#name-media-types-registry">Media Types Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.9">
                <p id="section-toc.1-1.10.2.9.1"><a class="auto internal xref" href="#section-10.9">10.9</a>.  <a class="internal xref" href="#name-coap-content-formats-regist">CoAP Content-Formats Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.10">
                <p id="section-toc.1-1.10.2.10.1"><a class="auto internal xref" href="#section-10.10">10.10</a>. <a class="internal xref" href="#name-resource-type-rt-link-targe">Resource Type (rt=) Link Target Attribute Values Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.11">
                <p id="section-toc.1-1.10.2.11.1"><a class="auto internal xref" href="#section-10.11">10.11</a>. <a class="internal xref" href="#name-expert-review-instructions">Expert Review Instructions</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a class="auto internal xref" href="#section-11">11</a>. <a class="internal xref" href="#name-references">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a class="auto internal xref" href="#section-11.1">11.1</a>.  <a class="internal xref" href="#name-normative-references">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a class="auto internal xref" href="#section-11.2">11.2</a>.  <a class="internal xref" href="#name-informative-references">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a class="auto internal xref" href="#appendix-A">Appendix A</a>.  <a class="internal xref" href="#name-use-with-oscore-and-transfe">Use with OSCORE and Transfer over CoAP</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a class="auto internal xref" href="#appendix-A.1">A.1</a>.  <a class="internal xref" href="#name-deriving-the-oscore-securit">Deriving the OSCORE Security Context</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a class="auto internal xref" href="#appendix-A.2">A.2</a>.  <a class="internal xref" href="#name-transferring-edhoc-over-coa">Transferring EDHOC over CoAP</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a class="auto internal xref" href="#appendix-B">Appendix B</a>.  <a class="internal xref" href="#name-compact-representation">Compact Representation</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a class="auto internal xref" href="#appendix-C">Appendix C</a>.  <a class="internal xref" href="#name-use-of-cbor-cddl-and-cose-i">Use of CBOR, CDDL, and COSE in EDHOC</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.1">
                <p id="section-toc.1-1.14.2.1.1"><a class="auto internal xref" href="#appendix-C.1">C.1</a>.  <a class="internal xref" href="#name-cbor-and-cddl">CBOR and CDDL</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.2">
                <p id="section-toc.1-1.14.2.2.1"><a class="auto internal xref" href="#appendix-C.2">C.2</a>.  <a class="internal xref" href="#name-cddl-definitions">CDDL Definitions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.3">
                <p id="section-toc.1-1.14.2.3.1"><a class="auto internal xref" href="#appendix-C.3">C.3</a>.  <a class="internal xref" href="#name-cose">COSE</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a class="auto internal xref" href="#appendix-D">Appendix D</a>.  <a class="internal xref" href="#name-authentication-related-veri">Authentication-Related Verifications</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.1">
                <p id="section-toc.1-1.15.2.1.1"><a class="auto internal xref" href="#appendix-D.1">D.1</a>.  <a class="internal xref" href="#name-validating-the-authenticati">Validating the Authentication Credential</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.2">
                <p id="section-toc.1-1.15.2.2.1"><a class="auto internal xref" href="#appendix-D.2">D.2</a>.  <a class="internal xref" href="#name-identities">Identities</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.3">
                <p id="section-toc.1-1.15.2.3.1"><a class="auto internal xref" href="#appendix-D.3">D.3</a>.  <a class="internal xref" href="#name-certification-path-and-trus">Certification Path and Trust Anchors</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.4">
                <p id="section-toc.1-1.15.2.4.1"><a class="auto internal xref" href="#appendix-D.4">D.4</a>.  <a class="internal xref" href="#name-revocation-status">Revocation Status</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.5">
                <p id="section-toc.1-1.15.2.5.1"><a class="auto internal xref" href="#appendix-D.5">D.5</a>.  <a class="internal xref" href="#name-unauthenticated-operation">Unauthenticated Operation</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a class="auto internal xref" href="#appendix-E">Appendix E</a>.  <a class="internal xref" href="#name-use-of-external-authorizati">Use of External Authorization Data</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a class="auto internal xref" href="#appendix-F">Appendix F</a>.  <a class="internal xref" href="#name-application-profile-example">Application Profile Example</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18">
            <p id="section-toc.1-1.18.1"><a class="auto internal xref" href="#appendix-G">Appendix G</a>.  <a class="internal xref" href="#name-long-plaintext_2">Long PLAINTEXT_2</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19">
            <p id="section-toc.1-1.19.1"><a class="auto internal xref" href="#appendix-H">Appendix H</a>.  <a class="internal xref" href="#name-edhoc_keyupdate">EDHOC_KeyUpdate</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20">
            <p id="section-toc.1-1.20.1"><a class="auto internal xref" href="#appendix-I">Appendix I</a>.  <a class="internal xref" href="#name-example-protocol-state-mach">Example Protocol State Machine</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20.2.1">
                <p id="section-toc.1-1.20.2.1.1"><a class="auto internal xref" href="#appendix-I.1">I.1</a>.  <a class="internal xref" href="#name-initiator-state-machine">Initiator State Machine</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20.2.2">
                <p id="section-toc.1-1.20.2.2.1"><a class="auto internal xref" href="#appendix-I.2">I.2</a>.  <a class="internal xref" href="#name-responder-state-machine">Responder State Machine</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.21">
            <p id="section-toc.1-1.21.1"><a class="auto internal xref" href="#appendix-J"></a><a class="internal xref" href="#name-acknowledgments">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.22">
            <p id="section-toc.1-1.22.1"><a class="auto internal xref" href="#appendix-K"></a><a class="internal xref" href="#name-authors-addresses">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a class="section-number selfRef" href="#section-1">1. </a><a class="section-name selfRef" href="#name-introduction">Introduction</a>
      </h2>
<div id="motivation">
<section id="section-1.1">
        <h3 id="name-motivation">
<a class="section-number selfRef" href="#section-1.1">1.1. </a><a class="section-name selfRef" href="#name-motivation">Motivation</a>
        </h3>
<p id="section-1.1-1">Many Internet of Things (IoT) deployments require technologies that are highly performant in constrained environments <span>[<a class="cite xref" href="#RFC7228">RFC7228</a>]</span>. IoT devices may be constrained in various ways, including memory, storage, processing capacity, and power. The connectivity for these settings may also exhibit constraints, such as unreliable and lossy channels, highly restricted bandwidth, and dynamic topology. The IETF has acknowledged this problem by standardizing a range of lightweight protocols and enablers designed for the IoT, including CoAP <span>[<a class="cite xref" href="#RFC7252">RFC7252</a>]</span>, CBOR <span>[<a class="cite xref" href="#RFC8949">RFC8949</a>]</span>, and Static Context Header Compression (SCHC) <span>[<a class="cite xref" href="#RFC8724">RFC8724</a>]</span>.<a class="pilcrow" href="#section-1.1-1">¶</a></p>
<p id="section-1.1-2">The need for special protocols targeting constrained IoT deployments extends also to the security domain <span>[<a class="cite xref" href="#I-D.ietf-lake-reqs">LAKE-REQS</a>]</span>. Important characteristics in constrained environments are the number of round trips and protocol message sizes, which (if kept low) can contribute to good performance by enabling transport over a small number of radio frames, reducing latency due to fragmentation, duty cycles, etc. Another important criterion is code size, which may be prohibitively large for certain deployments due to device capabilities or network load during firmware updates. Some IoT deployments also need to support a variety of underlying transport technologies, potentially even with a single connection.<a class="pilcrow" href="#section-1.1-2">¶</a></p>
<p id="section-1.1-3">Some security solutions for such settings exist already. COSE <span>[<a class="cite xref" href="#RFC9052">RFC9052</a>]</span> specifies basic application-layer security services efficiently encoded in CBOR. Another example is OSCORE  <span>[<a class="cite xref" href="#RFC8613">RFC8613</a>]</span>, which is a lightweight communication security extension to CoAP using CBOR and COSE. In order to establish good quality cryptographic keys for security protocols such as COSE and OSCORE, the two endpoints may run an authenticated Diffie-Hellman key exchange protocol, from which shared secret keying material can be derived. Such a key exchange protocol should also be lightweight to prevent bad performance in case of repeated use, e.g., due to device rebooting or frequent rekeying for security reasons or to avoid latencies in a network formation setting with many devices authenticating at the same time.<a class="pilcrow" href="#section-1.1-3">¶</a></p>
<p id="section-1.1-4">This document specifies Ephemeral Diffie-Hellman Over COSE (EDHOC), a lightweight authenticated key exchange protocol providing good security properties including forward secrecy, identity protection, and cipher suite negotiation. Authentication can be based on raw public keys (RPKs) or public key certificates and requires the application to provide input on how to verify that endpoints are trusted. This specification supports the referencing of credentials in order to reduce message overhead, but credentials may alternatively be embedded in the messages.
EDHOC does not currently support Pre-Shared Key (PSK) authentication as authentication with static Diffie-Hellman (DH) public keys by reference produces equally small message sizes but with much simpler key distribution and identity protection.<a class="pilcrow" href="#section-1.1-4">¶</a></p>
<p id="section-1.1-5">EDHOC makes use of known protocol constructions, such as SIGn-and-MAc <span>[<a class="cite xref" href="#SIGMA">SIGMA</a>]</span>, the Noise XX pattern <span>[<a class="cite xref" href="#Noise">Noise</a>]</span>, and Extract-and-Expand <span>[<a class="cite xref" href="#RFC5869">RFC5869</a>]</span>. EDHOC uses COSE for cryptography and identification of credentials (including COSE_Key, CBOR Web Token (CWT), CWT Claims Set (CCS), X.509, and CBOR-encoded X.509 (C509) certificates; see <a class="auto internal xref" href="#auth-cred">Section 3.5.2</a>). COSE provides crypto agility and enables the use of future algorithms and credential types targeting IoT.<a class="pilcrow" href="#section-1.1-5">¶</a></p>
<p id="section-1.1-6">EDHOC is designed for highly constrained settings, making it especially suitable for low-power networks <span>[<a class="cite xref" href="#RFC8376">RFC8376</a>]</span> such as Cellular IoT, IPv6 over the TSCH mode of IEEE 802.15.4e (6TiSCH), and LoRaWAN. A main objective for EDHOC is to be a lightweight authenticated key exchange for OSCORE, i.e., to provide authentication and session key establishment for IoT use cases such as those built on CoAP <span>[<a class="cite xref" href="#RFC7252">RFC7252</a>]</span> involving 'things' with embedded microcontrollers, sensors, and actuators. By reusing the same lightweight primitives as OSCORE (CBOR, COSE, and CoAP), the additional code size can be kept very low. Note that while CBOR and COSE primitives are built into the protocol messages, EDHOC is not bound to a particular transport.<a class="pilcrow" href="#section-1.1-6">¶</a></p>
<p id="section-1.1-7">A typical setting is when one of the endpoints is constrained or in a constrained network and the other endpoint is a node on the Internet (such as a mobile phone). Thing-to-thing interactions over constrained networks are also relevant since both endpoints would then benefit from the lightweight properties of the protocol. EDHOC could, e.g., be run when a device connects for the first time or to establish fresh keys that are not revealed by a later compromise of the long-term keys.<a class="pilcrow" href="#section-1.1-7">¶</a></p>
</section>
</div>
<div id="message-size-examples">
<section id="section-1.2">
        <h3 id="name-message-size-examples">
<a class="section-number selfRef" href="#section-1.2">1.2. </a><a class="section-name selfRef" href="#name-message-size-examples">Message Size Examples</a>
        </h3>
<p id="section-1.2-1">Examples of EDHOC message sizes are shown in <a class="auto internal xref" href="#tab-sizes">Table 1</a>, which use different kinds of authentication keys and COSE header parameters for identification, including static Diffie-Hellman keys or signature keys, either in CWT/CCS <span>[<a class="cite xref" href="#RFC8392">RFC8392</a>]</span> identified by a key identifier using 'kid' <span>[<a class="cite xref" href="#RFC9052">RFC9052</a>]</span> or in X.509 certificates identified by a hash value using 'x5t' <span>[<a class="cite xref" href="#RFC9360">RFC9360</a>]</span>. EDHOC always uses ephemeral-ephemeral key exchange. As a comparison, in the case of RPK authentication and when transferred in CoAP, the EDHOC message size can be less than 1/7 of the DTLS 1.3 handshake <span>[<a class="cite xref" href="#RFC9147">RFC9147</a>]</span> with Ephemeral Elliptic Curve Diffie-Hellman (ECDHE) and connection ID; see <span>[<a class="cite xref" href="#I-D.ietf-iotops-security-protocol-comparison">CoAP-SEC-PROT</a>]</span>.<a class="pilcrow" href="#section-1.2-1">¶</a></p>
<span id="name-examples-of-edhoc-message-s"></span><div id="tab-sizes">
<table class="center" id="table-1">
          <caption>
<a class="selfRef" href="#table-1">Table 1</a>:
<a class="selfRef" href="#name-examples-of-edhoc-message-s">Examples of EDHOC Message Sizes in Bytes</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1"></th>
              <th class="text-left" colspan="2" rowspan="1">Static DH Keys</th>
              <th class="text-left" colspan="2" rowspan="1">Signature Keys</th>
            </tr>
            <tr>
              <th class="text-left" colspan="1" rowspan="1"></th>
              <th class="text-right" colspan="1" rowspan="1">kid</th>
              <th class="text-right" colspan="1" rowspan="1">x5t</th>
              <th class="text-right" colspan="1" rowspan="1">kid</th>
              <th class="text-right" colspan="1" rowspan="1">x5t</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">message_1</td>
              <td class="text-right" colspan="1" rowspan="1">37</td>
              <td class="text-right" colspan="1" rowspan="1">37</td>
              <td class="text-right" colspan="1" rowspan="1">37</td>
              <td class="text-right" colspan="1" rowspan="1">37</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">message_2</td>
              <td class="text-right" colspan="1" rowspan="1">45</td>
              <td class="text-right" colspan="1" rowspan="1">58</td>
              <td class="text-right" colspan="1" rowspan="1">102</td>
              <td class="text-right" colspan="1" rowspan="1">115</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">message_3</td>
              <td class="text-right" colspan="1" rowspan="1">19</td>
              <td class="text-right" colspan="1" rowspan="1">33</td>
              <td class="text-right" colspan="1" rowspan="1">77</td>
              <td class="text-right" colspan="1" rowspan="1">90</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">Total</td>
              <td class="text-right" colspan="1" rowspan="1">101</td>
              <td class="text-right" colspan="1" rowspan="1">128</td>
              <td class="text-right" colspan="1" rowspan="1">216</td>
              <td class="text-right" colspan="1" rowspan="1">242</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="document-structure">
<section id="section-1.3">
        <h3 id="name-document-structure">
<a class="section-number selfRef" href="#section-1.3">1.3. </a><a class="section-name selfRef" href="#name-document-structure">Document Structure</a>
        </h3>
<p id="section-1.3-1">The remainder of the document is organized as follows: <a class="auto internal xref" href="#background">Section 2</a> outlines EDHOC authenticated with signature keys; <a class="auto internal xref" href="#overview">Section 3</a> describes the protocol elements of EDHOC, including formatting of the ephemeral public keys; <a class="auto internal xref" href="#key-der">Section 4</a> specifies the key derivation; <a class="auto internal xref" href="#asym">Section 5</a> specifies message processing for EDHOC authenticated with signature keys or static Diffie-Hellman keys; <a class="auto internal xref" href="#error">Section 6</a> describes the error messages; <a class="auto internal xref" href="#duplication">Section 7</a> describes EDHOC support for transport that does not handle message duplication; and <a class="auto internal xref" href="#mti">Section 8</a> lists compliance requirements. Note that normative text is also used in appendices, in particular <a class="auto internal xref" href="#transfer">Appendix A</a>.<a class="pilcrow" href="#section-1.3-1">¶</a></p>
</section>
</div>
<div id="term">
<section id="section-1.4">
        <h3 id="name-terminology-and-requirement">
<a class="section-number selfRef" href="#section-1.4">1.4. </a><a class="section-name selfRef" href="#name-terminology-and-requirement">Terminology and Requirements Language</a>
        </h3>
<p id="section-1.4-1">
    The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
    "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
    described in BCP 14 <span>[<a class="cite xref" href="#RFC2119">RFC2119</a>]</span> <span>[<a class="cite xref" href="#RFC8174">RFC8174</a>]</span> 
    when, and only when, they appear in all capitals, as shown here.<a class="pilcrow" href="#section-1.4-1">¶</a></p>
<p id="section-1.4-2">Readers are expected to be familiar with the terms and
        concepts described in CBOR <span>[<a class="cite xref" href="#RFC8949">RFC8949</a>]</span>, CBOR
        Sequences <span>[<a class="cite xref" href="#RFC8742">RFC8742</a>]</span>, COSE Structures and
        Processing <span>[<a class="cite xref" href="#RFC9052">RFC9052</a>]</span>, COSE Algorithms <span>[<a class="cite xref" href="#RFC9053">RFC9053</a>]</span>, CWT and CCS <span>[<a class="cite xref" href="#RFC8392">RFC8392</a>]</span>, and the Concise Data Definition Language
        (CDDL) <span>[<a class="cite xref" href="#RFC8610">RFC8610</a>]</span>, which is used to express
        CBOR data structures. Examples of CBOR and CDDL are provided
        in <a class="auto internal xref" href="#CBOR">Appendix C.1</a>. When referring to CBOR, this
        specification always refers to Deterministically Encoded CBOR,
        as specified in Sections <a class="relref" href="https://rfc-editor.org/rfc/rfc8949#section-4.2.1">4.2.1</a> and <a class="relref" href="https://rfc-editor.org/rfc/rfc8949#section-4.2.2">4.2.2</a> of <span>[<a class="cite xref" href="#RFC8949">RFC8949</a>]</span>. The single output from authenticated
        encryption (including the authentication tag) is called
        "ciphertext", following <span>[<a class="cite xref" href="#RFC5116">RFC5116</a>]</span>.<a class="pilcrow" href="#section-1.4-2">¶</a></p>
</section>
</div>
</section>
</div>
<div id="background">
<section id="section-2">
      <h2 id="name-edhoc-outline">
<a class="section-number selfRef" href="#section-2">2. </a><a class="section-name selfRef" href="#name-edhoc-outline">EDHOC Outline</a>
      </h2>
<p id="section-2-1">EDHOC supports different authentication methods of the ephemeral-ephemeral Diffie-Hellman key exchange. This document specifies authentication methods based on signature keys and static Diffie-Hellman keys. This section outlines the signature-key-based method. Further details of protocol elements and other authentication methods are provided in the remainder of this document.<a class="pilcrow" href="#section-2-1">¶</a></p>
<p id="section-2-2">SIGn-and-MAc (SIGMA) is a family of theoretical protocols with a number of variants <span>[<a class="cite xref" href="#SIGMA">SIGMA</a>]</span>. Like in Internet Key Exchange Protocol Version 2 (IKEv2) <span>[<a class="cite xref" href="#RFC7296">RFC7296</a>]</span> and (D)TLS 1.3 <span>[<a class="cite xref" href="#RFC8446">RFC8446</a>]</span> <span>[<a class="cite xref" href="#RFC9147">RFC9147</a>]</span>, EDHOC authenticated with signature keys is built on a variant of the SIGMA protocol, SIGMA-I, which provides identity protection against active attacks on the party initiating the protocol. Also like IKEv2, EDHOC implements the MAC-then-Sign variant of the SIGMA-I protocol. The message flow (excluding an optional fourth message) is shown in <a class="auto internal xref" href="#fig-sigma">Figure 1</a>.<a class="pilcrow" href="#section-2-2">¶</a></p>
<span id="name-mac-then-sign-variant-of-th"></span><div id="fig-sigma">
<figure id="figure-1">
        <div id="section-2-3.1">
          <div class="alignCenter art-svg artwork" id="section-2-3.1.1">
<svg class="diagram" font-family="monospace" font-size="13px" stroke-linecap="round" text-anchor="middle" version="1.1" viewBox="0 0 560 192" xmlns="http://www.w3.org/2000/svg">
              <path d="M 8,48 L 8,176" fill="none" stroke="black"></path>
              <path d="M 552,48 L 552,176" fill="none" stroke="black"></path>
              <path d="M 8,64 L 544,64" fill="none" stroke="black"></path>
              <path d="M 16,112 L 552,112" fill="none" stroke="black"></path>
              <path d="M 8,160 L 544,160" fill="none" stroke="black"></path>
              <polygon class="arrowhead" fill="black" points="552,160 540,154.4 540,165.6" transform="rotate(0,544,160)"></polygon>
              <polygon class="arrowhead" fill="black" points="552,64 540,58.4 540,69.6" transform="rotate(0,544,64)"></polygon>
              <polygon class="arrowhead" fill="black" points="24,112 12,106.4 12,117.6" transform="rotate(180,16,112)"></polygon>
              <g class="text">
                <text x="40" y="36">Initiator</text>
                <text x="520" y="36">Responder</text>
                <text x="280" y="52">G_X</text>
                <text x="76" y="100">G_Y,</text>
                <text x="116" y="100">Enc(</text>
                <text x="180" y="100">ID_CRED_R,</text>
                <text x="244" y="100">Sig(</text>
                <text x="276" y="100">R;</text>
                <text x="308" y="100">MAC(</text>
                <text x="360" y="100">CRED_R,</text>
                <text x="412" y="100">G_X,</text>
                <text x="448" y="100">G_Y</text>
                <text x="472" y="100">)</text>
                <text x="488" y="100">)</text>
                <text x="504" y="100">)</text>
                <text x="96" y="148">AEAD(</text>
                <text x="164" y="148">ID_CRED_I,</text>
                <text x="228" y="148">Sig(</text>
                <text x="260" y="148">I;</text>
                <text x="292" y="148">MAC(</text>
                <text x="344" y="148">CRED_I,</text>
                <text x="396" y="148">G_Y,</text>
                <text x="432" y="148">G_X</text>
                <text x="456" y="148">)</text>
                <text x="472" y="148">)</text>
                <text x="488" y="148">)</text>
              </g>
            </svg><a class="pilcrow" href="#section-2-3.1.1">¶</a>
</div>
</div>
<figcaption><a class="selfRef" href="#figure-1">Figure 1</a>:
<a class="selfRef" href="#name-mac-then-sign-variant-of-th">MAC-then-Sign Variant of the SIGMA-I Protocol Used by the EDHOC Method 0</a>
        </figcaption></figure>
</div>
<p id="section-2-4">The parties exchanging messages in an EDHOC session are called the Initiator (I) and the Responder (R), where the Initiator sends message_1 (see <a class="auto internal xref" href="#overview">Section 3</a>). They exchange ephemeral public keys, compute a shared secret session key PRK_out, and derive symmetric application keys used to protect application data.<a class="pilcrow" href="#section-2-4">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-5.1">G_X and G_Y are the Elliptic Curve Diffie-Hellman (ECDH) ephemeral public keys of I and R, respectively.<a class="pilcrow" href="#section-2-5.1">¶</a>
</li>
        <li class="normal" id="section-2-5.2">CRED_I and CRED_R are the authentication credentials containing the public authentication keys of I and R, respectively.<a class="pilcrow" href="#section-2-5.2">¶</a>
</li>
        <li class="normal" id="section-2-5.3">ID_CRED_I and ID_CRED_R are used to identify and optionally transport the credentials of I and R, respectively.<a class="pilcrow" href="#section-2-5.3">¶</a>
</li>
        <li class="normal" id="section-2-5.4">Sig(I; . ) and Sig(R; . ) denote signatures made with the private authentication key of I and R, respectively.<a class="pilcrow" href="#section-2-5.4">¶</a>
</li>
        <li class="normal" id="section-2-5.5">Enc(), AEAD(), and MAC() denote encryption, Authenticated Encryption with Associated Data, and Message Authentication Code -- crypto algorithms applied with keys derived from one or more shared secrets calculated during the protocol.<a class="pilcrow" href="#section-2-5.5">¶</a>
</li>
      </ul>
<p id="section-2-6">In order to create a "full-fledged" protocol, some additional protocol elements are needed. This specification adds:<a class="pilcrow" href="#section-2-6">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-7.1">transcript hashes (hashes of message data), TH_2, TH_3, and TH_4, used for key derivation and as additional authenticated data,<a class="pilcrow" href="#section-2-7.1">¶</a>
</li>
        <li class="normal" id="section-2-7.2">computationally independent keys derived from the ECDH shared secret and used for authenticated encryption of different messages,<a class="pilcrow" href="#section-2-7.2">¶</a>
</li>
        <li class="normal" id="section-2-7.3">an optional fourth message giving key confirmation to I in deployments where no protected application data is sent from R to I,<a class="pilcrow" href="#section-2-7.3">¶</a>
</li>
        <li class="normal" id="section-2-7.4">a keying material exporter and a key update function with forward secrecy,<a class="pilcrow" href="#section-2-7.4">¶</a>
</li>
        <li class="normal" id="section-2-7.5">secure negotiation of the cipher suite,<a class="pilcrow" href="#section-2-7.5">¶</a>
</li>
        <li class="normal" id="section-2-7.6">method types, error handling, and padding,<a class="pilcrow" href="#section-2-7.6">¶</a>
</li>
        <li class="normal" id="section-2-7.7">the selection of connection identifiers, C_I and C_R, which may be used in EDHOC to identify the protocol state, and<a class="pilcrow" href="#section-2-7.7">¶</a>
</li>
        <li class="normal" id="section-2-7.8">transport of external authorization data.<a class="pilcrow" href="#section-2-7.8">¶</a>
</li>
      </ul>
<p id="section-2-8">EDHOC is designed to encrypt and integrity protect as much information as possible. Symmetric keys and random material used in EDHOC are derived using EDHOC_KDF with as much previous information as possible; see <a class="auto internal xref" href="#fig-edhoc-kdf">Figure 6</a>. EDHOC is furthermore designed to be as compact and lightweight as possible, in terms of message sizes, processing, and the ability to reuse already existing CBOR, COSE, and CoAP libraries. Like in (D)TLS, authentication is the responsibility of the application. EDHOC identifies (and optionally transports) authentication credentials and provides proof-of-possession of the private authentication key.<a class="pilcrow" href="#section-2-8">¶</a></p>
<p id="section-2-9">To simplify for implementors, the use of CBOR, CDDL, and COSE in EDHOC is summarized in <a class="auto internal xref" href="#CBORandCOSE">Appendix C</a>. Test vectors, including CBOR diagnostic notation, are provided in <span>[<a class="cite xref" href="#RFC9529">RFC9529</a>]</span>.<a class="pilcrow" href="#section-2-9">¶</a></p>
</section>
</div>
<div id="overview">
<section id="section-3">
      <h2 id="name-protocol-elements">
<a class="section-number selfRef" href="#section-3">3. </a><a class="section-name selfRef" href="#name-protocol-elements">Protocol Elements</a>
      </h2>
<div id="general">
<section id="section-3.1">
        <h3 id="name-general">
<a class="section-number selfRef" href="#section-3.1">3.1. </a><a class="section-name selfRef" href="#name-general">General</a>
        </h3>
<p id="section-3.1-1">The EDHOC protocol consists of three mandatory messages (message_1, message_2, and message_3), an optional fourth message (message_4), and an error message, between an Initiator (I) and a Responder (R). The odd messages are sent by I, the even by R. Both I and R can send error messages.
The roles have slightly different security properties that should be considered when the roles are assigned; see <a class="auto internal xref" href="#sec-prop">Section 9.1</a>.
All EDHOC messages are CBOR Sequences <span>[<a class="cite xref" href="#RFC8742">RFC8742</a>]</span> and are defined to be deterministically encoded CBOR as specified in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8949#section-4.2.1">Section 4.2.1</a> of [<a class="cite xref" href="#RFC8949">RFC8949</a>]</span>. <a class="auto internal xref" href="#fig-flow">Figure 2</a> illustrates an EDHOC message flow with the optional fourth message as well as the content of each message. The protocol elements in the figure are introduced in Sections <a class="auto internal xref" href="#overview">3</a> and <a class="auto internal xref" href="#asym">5</a>. Message formatting and processing are specified in Sections <a class="auto internal xref" href="#asym">5</a> and <a class="auto internal xref" href="#error">6</a>.<a class="pilcrow" href="#section-3.1-1">¶</a></p>
<p id="section-3.1-2">Application data may be protected using the agreed application algorithms (AEAD, hash) in the selected cipher suite (see <a class="auto internal xref" href="#cs">Section 3.6</a>), and the application can make use of the established connection identifiers C_I and C_R (see <a class="auto internal xref" href="#ci">Section 3.3</a>). Media types that may be used for EDHOC are defined in <a class="auto internal xref" href="#media-type">Section 10.8</a>.<a class="pilcrow" href="#section-3.1-2">¶</a></p>
<p id="section-3.1-3">The Initiator can derive symmetric application keys after creating EDHOC message_3; see <a class="auto internal xref" href="#exporter">Section 4.2.1</a>. Protected application data can therefore be sent in parallel or together with EDHOC message_3. EDHOC message_4 is typically not sent.<a class="pilcrow" href="#section-3.1-3">¶</a></p>
<span id="name-edhoc-message-flow-includin"></span><div id="fig-flow">
<figure id="figure-2">
          <div id="section-3.1-4.1">
            <div class="alignCenter art-svg artwork" id="section-3.1-4.1.1">
<svg class="diagram" font-family="monospace" font-size="13px" stroke-linecap="round" text-anchor="middle" version="1.1" viewBox="0 0 560 288" xmlns="http://www.w3.org/2000/svg">
                <path d="M 8,48 L 8,272" fill="none" stroke="black"></path>
                <path d="M 552,48 L 552,272" fill="none" stroke="black"></path>
                <path d="M 8,64 L 544,64" fill="none" stroke="black"></path>
                <path d="M 16,128 L 552,128" fill="none" stroke="black"></path>
                <path d="M 8,192 L 544,192" fill="none" stroke="black"></path>
                <polygon class="arrowhead" fill="black" points="552,192 540,186.4 540,197.6" transform="rotate(0,544,192)"></polygon>
                <polygon class="arrowhead" fill="black" points="552,64 540,58.4 540,69.6" transform="rotate(0,544,64)"></polygon>
                <polygon class="arrowhead" fill="black" points="24,128 12,122.4 12,133.6" transform="rotate(180,16,128)"></polygon>
                <g class="text">
                  <text x="40" y="36">Initiator</text>
                  <text x="520" y="36">Responder</text>
                  <text x="176" y="52">METHOD,</text>
                  <text x="248" y="52">SUITES_I,</text>
                  <text x="308" y="52">G_X,</text>
                  <text x="348" y="52">C_I,</text>
                  <text x="392" y="52">EAD_1</text>
                  <text x="280" y="84">message_1</text>
                  <text x="84" y="116">G_Y,</text>
                  <text x="124" y="116">Enc(</text>
                  <text x="164" y="116">C_R,</text>
                  <text x="228" y="116">ID_CRED_R,</text>
                  <text x="352" y="116">Signature_or_MAC_2,</text>
                  <text x="456" y="116">EAD_2</text>
                  <text x="488" y="116">)</text>
                  <text x="280" y="148">message_2</text>
                  <text x="128" y="180">AEAD(</text>
                  <text x="196" y="180">ID_CRED_I,</text>
                  <text x="320" y="180">Signature_or_MAC_3,</text>
                  <text x="424" y="180">EAD_3</text>
                  <text x="456" y="180">)</text>
                  <text x="280" y="212">message_3</text>
                  <text x="248" y="244">AEAD(</text>
                  <text x="296" y="244">EAD_4</text>
                  <text x="328" y="244">)</text>
                  <text x="20" y="260">&lt;-</text>
                  <text x="40" y="260">-</text>
                  <text x="56" y="260">-</text>
                  <text x="72" y="260">-</text>
                  <text x="88" y="260">-</text>
                  <text x="104" y="260">-</text>
                  <text x="120" y="260">-</text>
                  <text x="136" y="260">-</text>
                  <text x="152" y="260">-</text>
                  <text x="168" y="260">-</text>
                  <text x="184" y="260">-</text>
                  <text x="200" y="260">-</text>
                  <text x="216" y="260">-</text>
                  <text x="232" y="260">-</text>
                  <text x="248" y="260">-</text>
                  <text x="264" y="260">-</text>
                  <text x="280" y="260">-</text>
                  <text x="296" y="260">-</text>
                  <text x="312" y="260">-</text>
                  <text x="328" y="260">-</text>
                  <text x="344" y="260">-</text>
                  <text x="360" y="260">-</text>
                  <text x="376" y="260">-</text>
                  <text x="392" y="260">-</text>
                  <text x="408" y="260">-</text>
                  <text x="424" y="260">-</text>
                  <text x="440" y="260">-</text>
                  <text x="456" y="260">-</text>
                  <text x="472" y="260">-</text>
                  <text x="488" y="260">-</text>
                  <text x="504" y="260">-</text>
                  <text x="520" y="260">-</text>
                  <text x="536" y="260">-</text>
                  <text x="280" y="276">message_4</text>
                </g>
              </svg><a class="pilcrow" href="#section-3.1-4.1.1">¶</a>
</div>
</div>
<figcaption><a class="selfRef" href="#figure-2">Figure 2</a>:
<a class="selfRef" href="#name-edhoc-message-flow-includin">EDHOC Message Flow Including the Optional Fourth Message</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="method">
<section id="section-3.2">
        <h3 id="name-method">
<a class="section-number selfRef" href="#section-3.2">3.2. </a><a class="section-name selfRef" href="#name-method">Method</a>
        </h3>
<p id="section-3.2-1">The data item METHOD in message_1 (see <a class="auto internal xref" href="#asym-msg1-form">Section 5.2.1</a>) is an integer specifying the authentication method. EDHOC currently supports authentication with signature or static Diffie-Hellman keys, as defined in the four authentication methods: 0, 1, 2, and 3; see <a class="auto internal xref" href="#tab-method-types">Table 2</a>. When using a static Diffie-Hellman key, the authentication is provided by a Message Authentication Code (MAC) computed from an ephemeral-static ECDH shared secret that enables significant reductions in message sizes. Note that, also in the static Diffie-Hellman-based authentication methods, there is an ephemeral-ephemeral Diffie-Hellman key exchange.<a class="pilcrow" href="#section-3.2-1">¶</a></p>
<p id="section-3.2-2">The Initiator and Responder need to have agreed on a single method to be used for EDHOC; see <a class="auto internal xref" href="#applicability">Section 3.9</a>.<a class="pilcrow" href="#section-3.2-2">¶</a></p>
<span id="name-authentication-keys-for-met"></span><div id="tab-method-types">
<table class="center" id="table-2">
          <caption>
<a class="selfRef" href="#table-2">Table 2</a>:
<a class="selfRef" href="#name-authentication-keys-for-met">Authentication Keys for Method Types</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Method Type Value</th>
              <th class="text-left" colspan="1" rowspan="1">Initiator Authentication Key</th>
              <th class="text-left" colspan="1" rowspan="1">Responder Authentication Key</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">Signature Key</td>
              <td class="text-left" colspan="1" rowspan="1">Signature Key</td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">1</td>
              <td class="text-left" colspan="1" rowspan="1">Signature Key</td>
              <td class="text-left" colspan="1" rowspan="1">Static DH Key</td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">2</td>
              <td class="text-left" colspan="1" rowspan="1">Static DH Key</td>
              <td class="text-left" colspan="1" rowspan="1">Signature Key</td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">3</td>
              <td class="text-left" colspan="1" rowspan="1">Static DH Key</td>
              <td class="text-left" colspan="1" rowspan="1">Static DH Key</td>
            </tr>
            <tr>
              <td class="text-right" colspan="1" rowspan="1">23</td>
              <td class="text-left" colspan="1" rowspan="1">Reserved</td>
              <td class="text-left" colspan="1" rowspan="1">Reserved</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-3.2-4">EDHOC does not have a dedicated message field to indicate the protocol version. Breaking changes to EDHOC can be introduced by specifying and registering new methods.<a class="pilcrow" href="#section-3.2-4">¶</a></p>
</section>
</div>
<div id="ci">
<section id="section-3.3">
        <h3 id="name-connection-identifiers">
<a class="section-number selfRef" href="#section-3.3">3.3. </a><a class="section-name selfRef" href="#name-connection-identifiers">Connection Identifiers</a>
        </h3>
<p id="section-3.3-1">EDHOC includes the selection of connection identifiers (C_I and C_R) identifying a connection for which keys are agreed.<a class="pilcrow" href="#section-3.3-1">¶</a></p>
<p id="section-3.3-2">Connection identifiers may be used to correlate EDHOC messages and facilitate the retrieval of protocol state during an EDHOC session (see <a class="auto internal xref" href="#transport">Section 3.4</a>) or may be used in applications of EDHOC, e.g., in OSCORE (see <a class="auto internal xref" href="#ci-oscore">Section 3.3.3</a>). The connection identifiers do not have any cryptographic purpose in EDHOC and only facilitate the retrieval of security data associated with the protocol state.<a class="pilcrow" href="#section-3.3-2">¶</a></p>
<p id="section-3.3-3">Connection identifiers in EDHOC are intrinsically byte strings. Most constrained devices only have a few connections for which short identifiers may be sufficient. In some cases, minimum length identifiers are necessary to comply with overhead requirements. However, CBOR byte strings -- with the exception of the empty byte string h'', which encodes as one byte (0x40) -- are encoded as two or more bytes. To enable one-byte encoding of certain byte strings while maintaining CBOR encoding, EDHOC represents certain identifiers as CBOR integers on the wire; see <a class="auto internal xref" href="#bstr-repr">Section 3.3.2</a>.<a class="pilcrow" href="#section-3.3-3">¶</a></p>
<div id="selection-of-connection-identifiers">
<section id="section-3.3.1">
          <h4 id="name-selection-of-connection-ide">
<a class="section-number selfRef" href="#section-3.3.1">3.3.1. </a><a class="section-name selfRef" href="#name-selection-of-connection-ide">Selection of Connection Identifiers</a>
          </h4>
<p id="section-3.3.1-1">C_I and C_R are chosen by I and R, respectively. The Initiator selects C_I and sends it in message_1 for the Responder to use as a reference to the connection in communications with the Initiator. The Responder selects C_R and sends it in message_2 for the Initiator to use as a reference to the connection in communications with the Responder.<a class="pilcrow" href="#section-3.3.1-1">¶</a></p>
<p id="section-3.3.1-2">If connection identifiers are used by an application protocol for which EDHOC establishes keys, then the selected connection identifiers <span class="bcp14">SHALL</span> adhere to the requirements for that protocol; see <a class="auto internal xref" href="#ci-oscore">Section 3.3.3</a> for an example.<a class="pilcrow" href="#section-3.3.1-2">¶</a></p>
</section>
</div>
<div id="bstr-repr">
<section id="section-3.3.2">
          <h4 id="name-representation-of-byte-stri">
<a class="section-number selfRef" href="#section-3.3.2">3.3.2. </a><a class="section-name selfRef" href="#name-representation-of-byte-stri">Representation of Byte String Identifiers</a>
          </h4>
<p id="section-3.3.2-1">To allow identifiers with minimal overhead on the wire, certain byte strings used in connection identifiers and credential identifiers (see <a class="auto internal xref" href="#id_cred">Section 3.5.3</a>) are defined to have integer representations.<a class="pilcrow" href="#section-3.3.2-1">¶</a></p>
<p id="section-3.3.2-2">The integers with one-byte CBOR encoding are -24, ..., 23; see <a class="auto internal xref" href="#fig-int-one-byte">Figure 3</a>.<a class="pilcrow" href="#section-3.3.2-2">¶</a></p>
<span id="name-one-byte-cbor-encoded-integ"></span><div id="fig-int-one-byte">
<figure id="figure-3">
            <div class="alignCenter art-text artwork" id="section-3.3.2-3.1">
<pre>Integer:  -24  -23  ... -11  ...  -2   -1    0    1  ...  15  ...  23
Encoding:  37   36  ...  2A  ...  21   20   00   01  ...  0F  ...  17
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-3">Figure 3</a>:
<a class="selfRef" href="#name-one-byte-cbor-encoded-integ">One-Byte CBOR-Encoded Integers</a>
            </figcaption></figure>
</div>
<p id="section-3.3.2-4">The byte strings that coincide with a one-byte CBOR encoding of an integer <span class="bcp14">MUST</span> be represented by the CBOR encoding of that integer. Other byte strings are simply encoded as CBOR byte strings.<a class="pilcrow" href="#section-3.3.2-4">¶</a></p>
<p id="section-3.3.2-5">For example:<a class="pilcrow" href="#section-3.3.2-5">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3.2-6.1">0x21 is represented by 0x21 (CBOR encoding of the integer -2), not by 0x4121 (CBOR encoding of the byte string 0x21).<a class="pilcrow" href="#section-3.3.2-6.1">¶</a>
</li>
            <li class="normal" id="section-3.3.2-6.2">0x0D is represented by 0x0D (CBOR encoding of the integer 13), not by 0x410D (CBOR encoding of the byte string 0x0D).<a class="pilcrow" href="#section-3.3.2-6.2">¶</a>
</li>
            <li class="normal" id="section-3.3.2-6.3">0x18 is represented by 0x4118 (CBOR encoding of the byte string 0x18).<a class="pilcrow" href="#section-3.3.2-6.3">¶</a>
</li>
            <li class="normal" id="section-3.3.2-6.4">0x38 is represented by 0x4138 (CBOR encoding of the byte string 0x38).<a class="pilcrow" href="#section-3.3.2-6.4">¶</a>
</li>
            <li class="normal" id="section-3.3.2-6.5">0xABCD is represented by 0x42ABCD (CBOR encoding of the byte string 0xABCD).<a class="pilcrow" href="#section-3.3.2-6.5">¶</a>
</li>
          </ul>
<p id="section-3.3.2-7">One may view this representation of byte strings as a transport encoding, i.e., a byte string that parses as the one-byte CBOR encoding of an integer (i.e., integer in the interval -24, ..., 23) is just copied directly into the message, and a byte string that does not is encoded as a CBOR byte string during transport.<a class="pilcrow" href="#section-3.3.2-7">¶</a></p>
<aside id="section-3.3.2-8">
            <p id="section-3.3.2-8.1">Implementation Note: When implementing the byte string identifier representation, in some programming languages, it can help to define a new type or other data structure, which (in its user-facing API) behaves like a byte string but when serializing to CBOR produces a CBOR byte string or a CBOR integer depending on its value.<a class="pilcrow" href="#section-3.3.2-8.1">¶</a></p>
</aside>
</section>
</div>
<div id="ci-oscore">
<section id="section-3.3.3">
          <h4 id="name-use-of-connection-identifie">
<a class="section-number selfRef" href="#section-3.3.3">3.3.3. </a><a class="section-name selfRef" href="#name-use-of-connection-identifie">Use of Connection Identifiers with OSCORE</a>
          </h4>
<p id="section-3.3.3-1">For OSCORE, the choice of connection identifier results in the endpoint selecting its Recipient ID (see <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8613#section-3.1">Section 3.1</a> of [<a class="cite xref" href="#RFC8613">RFC8613</a>]</span>) for which certain uniqueness requirements apply (see <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8613#section-3.3">Section 3.3</a> of [<a class="cite xref" href="#RFC8613">RFC8613</a>]</span>). Therefore, the Initiator and Responder <span class="bcp14">MUST NOT</span> select connection identifiers such that it results in the same OSCORE Recipient ID. Since the connection identifier is a byte string, it is converted to an OSCORE Recipient ID equal to the byte string.<a class="pilcrow" href="#section-3.3.3-1">¶</a></p>
<p id="section-3.3.3-2">Examples:<a class="pilcrow" href="#section-3.3.3-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3.3-3.1">A connection identifier 0xFF (represented in the EDHOC message as 0x41FF; see <a class="auto internal xref" href="#bstr-repr">Section 3.3.2</a>) is converted to the OSCORE Recipient ID 0xFF.<a class="pilcrow" href="#section-3.3.3-3.1">¶</a>
</li>
            <li class="normal" id="section-3.3.3-3.2">A connection identifier 0x21 (represented in the EDHOC message as 0x21; see <a class="auto internal xref" href="#bstr-repr">Section 3.3.2</a>) is converted to the OSCORE Recipient ID 0x21.<a class="pilcrow" href="#section-3.3.3-3.2">¶</a>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="transport">
<section id="section-3.4">
        <h3 id="name-transport">
<a class="section-number selfRef" href="#section-3.4">3.4. </a><a class="section-name selfRef" href="#name-transport">Transport</a>
        </h3>
<p id="section-3.4-1">Cryptographically, EDHOC does not put requirements on the underlying layers. Received messages are processed as the expected next message according to the protocol state; see <a class="auto internal xref" href="#asym">Section 5</a>. If processing fails for any reason, then typically an error message is attempted to be sent and the EDHOC session is aborted.<a class="pilcrow" href="#section-3.4-1">¶</a></p>
<p id="section-3.4-2">EDHOC is not bound to a particular transport layer and can even be used in environments without IP. Ultimately, the application is free to choose how to transport EDHOC messages including errors. In order to avoid unnecessary message processing or protocol termination, it is <span class="bcp14">RECOMMENDED</span> to use reliable transport, such as CoAP in reliable mode, which is the default transport; see <a class="auto internal xref" href="#coap">Appendix A.2</a>. In general, the transport <span class="bcp14">SHOULD</span> handle:<a class="pilcrow" href="#section-3.4-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4-3.1">message loss,<a class="pilcrow" href="#section-3.4-3.1">¶</a>
</li>
          <li class="normal" id="section-3.4-3.2">message duplication (see <a class="auto internal xref" href="#duplication">Section 7</a> for an alternative),<a class="pilcrow" href="#section-3.4-3.2">¶</a>
</li>
          <li class="normal" id="section-3.4-3.3">flow control,<a class="pilcrow" href="#section-3.4-3.3">¶</a>
</li>
          <li class="normal" id="section-3.4-3.4">congestion control,<a class="pilcrow" href="#section-3.4-3.4">¶</a>
</li>
          <li class="normal" id="section-3.4-3.5">fragmentation and reassembly,<a class="pilcrow" href="#section-3.4-3.5">¶</a>
</li>
          <li class="normal" id="section-3.4-3.6">demultiplexing EDHOC messages from other types of messages,<a class="pilcrow" href="#section-3.4-3.6">¶</a>
</li>
          <li class="normal" id="section-3.4-3.7">denial-of-service mitigation, and<a class="pilcrow" href="#section-3.4-3.7">¶</a>
</li>
          <li class="normal" id="section-3.4-3.8">message correlation (see <a class="auto internal xref" href="#ci-edhoc">Section 3.4.1</a>).<a class="pilcrow" href="#section-3.4-3.8">¶</a>
</li>
        </ul>
<p id="section-3.4-4">EDHOC does not require error-free transport since a change in message content is detected through the transcript hashes in a subsequent integrity verification; see <a class="auto internal xref" href="#asym">Section 5</a>. The transport does not require additional means to handle message reordering because of the lockstep processing of EDHOC.<a class="pilcrow" href="#section-3.4-4">¶</a></p>
<p id="section-3.4-5">EDHOC is designed to enable an authenticated key exchange with small messages, where the minimum message sizes are of the order illustrated in the first column of <a class="auto internal xref" href="#tab-sizes">Table 1</a>. There is no maximum message size specified by the protocol; for example, this is dependent on the size of the authentication credentials (if they are transported, see <a class="auto internal xref" href="#auth-key-id">Section 3.5</a>). The encryption of very large content in message_2 when using certain hash algorithms is described in <a class="auto internal xref" href="#large-plaintext_2">Appendix G</a>.<a class="pilcrow" href="#section-3.4-5">¶</a></p>
<p id="section-3.4-6">The use of transport is specified in the application profile, which in particular, may specify limitations in message sizes; see <a class="auto internal xref" href="#applicability">Section 3.9</a>.<a class="pilcrow" href="#section-3.4-6">¶</a></p>
<div id="ci-edhoc">
<section id="section-3.4.1">
          <h4 id="name-edhoc-message-correlation">
<a class="section-number selfRef" href="#section-3.4.1">3.4.1. </a><a class="section-name selfRef" href="#name-edhoc-message-correlation">EDHOC Message Correlation</a>
          </h4>
<p id="section-3.4.1-1">Correlation between EDHOC messages is needed to facilitate the retrieval of the protocol state and security context during an EDHOC session. It is also helpful for the Responder to get an indication that a received EDHOC message is the beginning of a new EDHOC session, such that no existing protocol state or security context needs to be retrieved.<a class="pilcrow" href="#section-3.4.1-1">¶</a></p>
<p id="section-3.4.1-2">Correlation may be based on existing mechanisms in the transport protocol; for example, the CoAP Token may be used to correlate EDHOC messages in a CoAP response and in an associated CoAP request. The connection identifiers may also be used to correlate EDHOC messages.<a class="pilcrow" href="#section-3.4.1-2">¶</a></p>
<p id="section-3.4.1-3">If correlation between consecutive messages is not provided by other means, then the transport binding <span class="bcp14">SHOULD</span> mandate prepending of an appropriate connection identifier (when available from the EDHOC protocol) to the EDHOC message. If message_1 indication is not provided by other means, then the transport binding <span class="bcp14">SHOULD</span> mandate prepending of message_1 with the CBOR simple value <code>true</code> (0xf5).<a class="pilcrow" href="#section-3.4.1-3">¶</a></p>
<p id="section-3.4.1-4">Transport of EDHOC in CoAP payloads is described in <a class="auto internal xref" href="#coap">Appendix A.2</a>, including how to use connection identifiers and message_1 indication with CoAP. A similar construction is possible for other client-server protocols. Protocols that do not provide any correlation at all can prescribe prepending of the peer's connection identifier to all messages.<a class="pilcrow" href="#section-3.4.1-4">¶</a></p>
<p id="section-3.4.1-5">Note that correlation between EDHOC messages may be obtained without transport support or connection identifiers, for example, if the endpoints only accept a single instance of the protocol at a time and execute conditionally on a correct sequence of messages.<a class="pilcrow" href="#section-3.4.1-5">¶</a></p>
</section>
</div>
</section>
</div>
<div id="auth-key-id">
<section id="section-3.5">
        <h3 id="name-authentication-parameters">
<a class="section-number selfRef" href="#section-3.5">3.5. </a><a class="section-name selfRef" href="#name-authentication-parameters">Authentication Parameters</a>
        </h3>
<p id="section-3.5-1">EDHOC supports various settings for how the other endpoint's public key for authentication may be transported, identified, and trusted. We shall use the term "authentication key" to mean key used for authentication in general, or specifically, the public key, when there is no risk for confusion.<a class="pilcrow" href="#section-3.5-1">¶</a></p>
<p id="section-3.5-2">EDHOC performs the following authentication-related operations:<a class="pilcrow" href="#section-3.5-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5-3.1">EDHOC transports information about credentials in ID_CRED_I and ID_CRED_R (described in <a class="auto internal xref" href="#id_cred">Section 3.5.3</a>). Based on this information, the authentication credentials CRED_I and CRED_R (described in <a class="auto internal xref" href="#auth-cred">Section 3.5.2</a>) can be obtained. EDHOC may also transport certain authentication-related information as external authorization data (see <a class="auto internal xref" href="#AD">Section 3.8</a>).<a class="pilcrow" href="#section-3.5-3.1">¶</a>
</li>
          <li class="normal" id="section-3.5-3.2">
            <p id="section-3.5-3.2.1">EDHOC uses the authentication credentials in two ways (see Sections <a class="auto internal xref" href="#asym-msg2-proc">5.3.2</a> and <a class="auto internal xref" href="#asym-msg3-proc">5.4.2</a>):<a class="pilcrow" href="#section-3.5-3.2.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5-3.2.2.1">The authentication credential is input to the integrity verification using the MAC fields.<a class="pilcrow" href="#section-3.5-3.2.2.1">¶</a>
</li>
              <li class="normal" id="section-3.5-3.2.2.2">The authentication key of the authentication credential is used with the Signature_or_MAC field to verify proof-of-possession of the private key.<a class="pilcrow" href="#section-3.5-3.2.2.2">¶</a>
</li>
            </ul>
</li>
        </ul>
<p id="section-3.5-4">Other authentication-related verifications are out of scope for EDHOC and are the responsibility of the application. In particular, the authentication credential needs to be validated in the context of the connection for which EDHOC is used; see <a class="auto internal xref" href="#auth-validation">Appendix D</a>. EDHOC <span class="bcp14">MUST</span> allow the application to read received information about credentials in ID_CRED_R and ID_CRED_I. EDHOC <span class="bcp14">MUST</span> have access to the authentication key and the authentication credential.<a class="pilcrow" href="#section-3.5-4">¶</a></p>
<p id="section-3.5-5">Note that the type of authentication key, the type of authentication credential, and the identification of the credential have a large impact on the message size. For example, the Signature_or_MAC field is much smaller with a static DH key than with a signature key. A CWT Claims Set (CCS) is much smaller than a self-signed certificate / CWT, but if it is possible to reference the credential with a COSE header like 'kid', then that is in turn much smaller than a CCS.<a class="pilcrow" href="#section-3.5-5">¶</a></p>
<div id="auth-keys">
<section id="section-3.5.1">
          <h4 id="name-authentication-keys">
<a class="section-number selfRef" href="#section-3.5.1">3.5.1. </a><a class="section-name selfRef" href="#name-authentication-keys">Authentication Keys</a>
          </h4>
<p id="section-3.5.1-1">The authentication key <span class="bcp14">MUST</span> be a signature key or a static Diffie-Hellman key. The Initiator and Responder <span class="bcp14">MAY</span> use different types of authentication keys, e.g., one uses a signature key and the other uses a static Diffie-Hellman key.<a class="pilcrow" href="#section-3.5.1-1">¶</a></p>
<p id="section-3.5.1-2">The authentication key algorithm needs to be compatible with the method and the selected cipher suite (see <a class="auto internal xref" href="#cs">Section 3.6</a>). The authentication key algorithm needs to be compatible with the EDHOC key exchange algorithm when static Diffie-Hellman authentication is used and compatible with the EDHOC signature algorithm when signature authentication is used.<a class="pilcrow" href="#section-3.5.1-2">¶</a></p>
<p id="section-3.5.1-3">Note that for most signature algorithms, the signature is determined jointly by the signature algorithm and the authentication key algorithm. When using static Diffie-Hellman keys, the Initiator's and the Responder's private authentication keys are denoted as I and R, respectively, and the public authentication keys are denoted G_I and G_R, respectively.<a class="pilcrow" href="#section-3.5.1-3">¶</a></p>
<p id="section-3.5.1-4">For X.509 certificates, the authentication key is represented by a SubjectPublicKeyInfo field, which also contains information about authentication key algorithm. For CWT and CCS (see <a class="auto internal xref" href="#auth-cred">Section 3.5.2</a>), the authentication key is represented by a 'cnf' claim <span>[<a class="cite xref" href="#RFC8747">RFC8747</a>]</span> containing a COSE_Key <span>[<a class="cite xref" href="#RFC9052">RFC9052</a>]</span>, which contains information about authentication key algorithm. In EDHOC, a raw public key (RPK) is an authentication key encoded as a COSE_Key wrapped in a CCS, an example is given in <a class="auto internal xref" href="#fig-ccs">Figure 4</a>.<a class="pilcrow" href="#section-3.5.1-4">¶</a></p>
</section>
</div>
<div id="auth-cred">
<section id="section-3.5.2">
          <h4 id="name-authentication-credentials">
<a class="section-number selfRef" href="#section-3.5.2">3.5.2. </a><a class="section-name selfRef" href="#name-authentication-credentials">Authentication Credentials</a>
          </h4>
<p id="section-3.5.2-1">The authentication credentials, CRED_I and CRED_R, contain the public authentication key of the Initiator and Responder, respectively.
We use the notation CRED_x to refer to CRED_I or CRED_R.
Requirements on CRED_x applies both to CRED_I and to CRED_R.
The authentication credential typically also contains other parameters that needs to be verified by the application (see <a class="auto internal xref" href="#auth-validation">Appendix D</a>) and in particular information about the identity ("subject") of the endpoint to prevent misbinding attacks (see <a class="auto internal xref" href="#identities">Appendix D.2</a>).<a class="pilcrow" href="#section-3.5.2-1">¶</a></p>
<p id="section-3.5.2-2">EDHOC relies on COSE for identification of credentials (see <a class="auto internal xref" href="#id_cred">Section 3.5.3</a>), for example, X.509 certificates <span>[<a class="cite xref" href="#RFC9360">RFC9360</a>]</span>, C509 certificates <span>[<a class="cite xref" href="#I-D.ietf-cose-cbor-encoded-cert">C509-CERTS</a>]</span>, CWTs <span>[<a class="cite xref" href="#RFC8392">RFC8392</a>]</span>, and CCSs <span>[<a class="cite xref" href="#RFC8392">RFC8392</a>]</span>. When the identified credential is a chain or a bag, the authentication credential CRED_x is just the end entity X.509 or C509 certificate / CWT. In the choice between a chain or a bag, it is <span class="bcp14">RECOMMENDED</span> to use a chain, since the certificates in a bag are unordered and may contain self-signed and extraneous certificates, which can add complexity to the process of extracting the end entity certificate. The Initiator and Responder <span class="bcp14">MAY</span> use different types of authentication credentials, e.g., one uses an RPK and the other uses a public key certificate.<a class="pilcrow" href="#section-3.5.2-2">¶</a></p>
<p id="section-3.5.2-3">Since CRED_R is used in the integrity verification (see <a class="auto internal xref" href="#asym-msg2-proc">Section 5.3.2</a>), it needs to be specified such that it is identical when used by the Initiator or Responder. Similarly for CRED_I, see <a class="auto internal xref" href="#asym-msg3-proc">Section 5.4.2</a>. The Initiator and Responder are expected to agree on the specific encoding of the authentication credentials; see <a class="auto internal xref" href="#applicability">Section 3.9</a>. It is <span class="bcp14">RECOMMENDED</span> that the COSE 'kid' parameter, when used to identify the authentication credential, refers to such a specific encoding of the authentication credential. The Initiator and Responder <span class="bcp14">SHOULD</span> use an available authentication credential without re-encoding, i.e. an authentication credential transported in EDHOC by value, or otherwise provisioned, <span class="bcp14">SHOULD</span> be used as is. If for some reason re-encoding of an authentication credential passed by reference may occur, then a potential common encoding for CBOR-based credentials is deterministically encoded CBOR, as specified in Sections <a class="relref" href="https://rfc-editor.org/rfc/rfc8949#section-4.2.1">4.2.1</a> and <a class="relref" href="https://rfc-editor.org/rfc/rfc8949#section-4.2.2">4.2.2</a> of <span>[<a class="cite xref" href="#RFC8949">RFC8949</a>]</span>.<a class="pilcrow" href="#section-3.5.2-3">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5.2-4.1">When the authentication credential is an X.509 certificate, CRED_x <span class="bcp14">SHALL</span> be the DER-encoded certificate, encoded as a bstr <span>[<a class="cite xref" href="#RFC9360">RFC9360</a>]</span>.<a class="pilcrow" href="#section-3.5.2-4.1">¶</a>
</li>
            <li class="normal" id="section-3.5.2-4.2">When the authentication credential is a C509 certificate, CRED_x <span class="bcp14">SHALL</span> be the C509 certificate <span>[<a class="cite xref" href="#I-D.ietf-cose-cbor-encoded-cert">C509-CERTS</a>]</span>.<a class="pilcrow" href="#section-3.5.2-4.2">¶</a>
</li>
            <li class="normal" id="section-3.5.2-4.3">When the authentication credential is a CWT including a COSE_Key, CRED_x <span class="bcp14">SHALL</span> be the untagged CWT.<a class="pilcrow" href="#section-3.5.2-4.3">¶</a>
</li>
            <li class="normal" id="section-3.5.2-4.4">
              <p id="section-3.5.2-4.4.1">When the authentication credential includes a COSE_Key but is not in a CWT, CRED_x <span class="bcp14">SHALL</span> be an untagged CCS. This is how RPKs are encoded, see <a class="auto internal xref" href="#fig-ccs">Figure 4</a> for an example.<a class="pilcrow" href="#section-3.5.2-4.4.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5.2-4.4.2.1">Naked COSE_Keys are thus dressed as CCS when used in EDHOC, in its simplest form by prefixing the COSE_Key with 0xA108A101 (a map with a 'cnf' claim). In that case, the resulting authentication credential contains no other identity than the public key itself; see <a class="auto internal xref" href="#identities">Appendix D.2</a>.<a class="pilcrow" href="#section-3.5.2-4.4.2.1">¶</a>
</li>
              </ul>
</li>
          </ul>
<p id="section-3.5.2-5">An example of CRED_x is shown below:<a class="pilcrow" href="#section-3.5.2-5">¶</a></p>
<span id="name-ccs-containing-an-x25519-st"></span><div id="fig-ccs">
<figure id="figure-4">
            <div class="alignLeft art-text artwork" id="section-3.5.2-6.1">
<pre>{                                              /CCS/
  2 : "42-50-31-FF-EF-37-32-39",               /sub/
  8 : {                                        /cnf/
    1 : {                                      /COSE_Key/
      1 : 1,                                   /kty/
      2 : h'00',                               /kid/
     -1 : 4,                                   /crv/
     -2 : h'b1a3e89460e88d3a8d54211dc95f0b90   /x/
            3ff205eb71912d6db8f4af980d2db83a'
    }
  }
}
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-4">Figure 4</a>:
<a class="selfRef" href="#name-ccs-containing-an-x25519-st">CCS Containing an X25519 Static Diffie-Hellman Key and an EUI-64 Identity</a>
            </figcaption></figure>
</div>
</section>
</div>
<div id="id_cred">
<section id="section-3.5.3">
          <h4 id="name-identification-of-credentia">
<a class="section-number selfRef" href="#section-3.5.3">3.5.3. </a><a class="section-name selfRef" href="#name-identification-of-credentia">Identification of Credentials</a>
          </h4>
<p id="section-3.5.3-1">The ID_CRED fields, ID_CRED_R and ID_CRED_I, are transported in message_2 and message_3, respectively; see Sections <a class="auto internal xref" href="#asym-msg2-proc">5.3.2</a> and <a class="auto internal xref" href="#asym-msg3-proc">5.4.2</a>.
We use the notation ID_CRED_x to refer to ID_CRED_I or ID_CRED_R.
Requirements on ID_CRED_x applies both to ID_CRED_I and to ID_CRED_R.
The ID_CRED fields are used to identify and optionally transport credentials:<a class="pilcrow" href="#section-3.5.3-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5.3-2.1">ID_CRED_R is intended to facilitate for the Initiator retrieving the authentication credential CRED_R and the authentication key of R.<a class="pilcrow" href="#section-3.5.3-2.1">¶</a>
</li>
            <li class="normal" id="section-3.5.3-2.2">ID_CRED_I is intended to facilitate for the Responder retrieving the authentication credential CRED_I and the authentication key of I.<a class="pilcrow" href="#section-3.5.3-2.2">¶</a>
</li>
          </ul>
<p id="section-3.5.3-3">ID_CRED_x may contain the authentication credential CRED_x, for x = I or R, but for many settings, it is not necessary to transport the authentication credential within EDHOC. For example, it may be pre-provisioned or acquired out-of-band over less constrained links. ID_CRED_I and ID_CRED_R do not have any cryptographic purpose in EDHOC since the authentication credentials are integrity protected by the Signature_or_MAC field.<a class="pilcrow" href="#section-3.5.3-3">¶</a></p>
<p id="section-3.5.3-4">EDHOC relies on COSE for identification of credentials and supports all credential types for which COSE header parameters are defined, including X.509 certificates <span>[<a class="cite xref" href="#RFC9360">RFC9360</a>]</span>, C509 certificates <span>[<a class="cite xref" href="#I-D.ietf-cose-cbor-encoded-cert">C509-CERTS</a>]</span>, CWTs (<a class="auto internal xref" href="#new-header-param">Section 3.5.3.1</a>) and CCSs (<a class="auto internal xref" href="#new-header-param">Section 3.5.3.1</a>).<a class="pilcrow" href="#section-3.5.3-4">¶</a></p>
<p id="section-3.5.3-5">ID_CRED_I and ID_CRED_R are of type COSE header_map, as defined in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc9052#section-3">Section 3</a> of [<a class="cite xref" href="#RFC9052">RFC9052</a>]</span>, and contain one or more COSE header parameters. If a map contains several header parameters, the labels do not need to be sorted in bytewise lexicographic order. ID_CRED_I and ID_CRED_R <span class="bcp14">MAY</span> contain different header parameters. The header parameters typically provide some information about the format of the credential.<a class="pilcrow" href="#section-3.5.3-5">¶</a></p>
<p id="section-3.5.3-6">Example: X.509 certificates can be identified by a hash value using the 'x5t' parameter; see <span><a class="relref" href="https://rfc-editor.org/rfc/rfc9360#section-2">Section 2</a> of [<a class="cite xref" href="#RFC9360">RFC9360</a>]</span>:<a class="pilcrow" href="#section-3.5.3-6">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5.3-7.1">ID_CRED_x = { 34 : COSE_CertHash }, for x = I or R<a class="pilcrow" href="#section-3.5.3-7.1">¶</a>
</li>
          </ul>
<p id="section-3.5.3-8">Example: CWT or CCS can be identified by a key identifier using the 'kid' parameter; see <span><a class="relref" href="https://rfc-editor.org/rfc/rfc9052#section-3.1">Section 3.1</a> of [<a class="cite xref" href="#RFC9052">RFC9052</a>]</span>:<a class="pilcrow" href="#section-3.5.3-8">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5.3-9.1">ID_CRED_x = { 4 : kid_x }, where kid_x : kid, for x = I or R<a class="pilcrow" href="#section-3.5.3-9.1">¶</a>
</li>
          </ul>
<p id="section-3.5.3-10">Note that COSE header parameters in ID_CRED_x are used to identify the message sender's credential. Therefore, there is no reason to use the "-sender" header parameters, such as x5t-sender, defined in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc9360#section-3">Section 3</a> of [<a class="cite xref" href="#RFC9360">RFC9360</a>]</span>. Instead, the corresponding parameter without "-sender", such as x5t, <span class="bcp14">SHOULD</span> be used.<a class="pilcrow" href="#section-3.5.3-10">¶</a></p>
<p id="section-3.5.3-11">As stated in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc9052#section-3.1">Section 3.1</a> of [<a class="cite xref" href="#RFC9052">RFC9052</a>]</span>, applications <span class="bcp14">MUST NOT</span> assume that 'kid' values are unique and several keys associated with a 'kid' may need to be checked before the correct one is found. Applications might use additional information such as 'kid context' or lower layers to determine which key to try first. Applications should strive to make ID_CRED_x as unique as possible, since the recipient may otherwise have to try several keys.<a class="pilcrow" href="#section-3.5.3-11">¶</a></p>
<p id="section-3.5.3-12">See <a class="auto internal xref" href="#COSE">Appendix C.3</a> for more examples.<a class="pilcrow" href="#section-3.5.3-12">¶</a></p>
<div id="new-header-param">
<section id="section-3.5.3.1">
            <h5 id="name-cose-header-parameters-for-">
<a class="section-number selfRef" href="#section-3.5.3.1">3.5.3.1. </a><a class="section-name selfRef" href="#name-cose-header-parameters-for-">COSE Header Parameters for CWT and CWT Claims Set</a>
            </h5>
<p id="section-3.5.3.1-1">This document registers two new COSE header parameters, 'kcwt' and 'kccs', for use with CBOR Web Token (CWT) <span>[<a class="cite xref" href="#RFC8392">RFC8392</a>]</span> and CWT Claims Set (CCS) <span>[<a class="cite xref" href="#RFC8392">RFC8392</a>]</span>, respectively. The CWT/CCS <span class="bcp14">MUST</span> contain a COSE_Key in a 'cnf' claim <span>[<a class="cite xref" href="#RFC8747">RFC8747</a>]</span>. There may be any number of additional claims present in the CWT/CCS.<a class="pilcrow" href="#section-3.5.3.1-1">¶</a></p>
<p id="section-3.5.3.1-2">CWTs sent in 'kcwt' are protected using a MAC or a signature and are similar to a certificate (when used with public key cryptography) or a Kerberos ticket (when used with symmetric key cryptography). CCSs sent in 'kccs' are not protected and are therefore similar to raw public keys or self-signed certificates.<a class="pilcrow" href="#section-3.5.3.1-2">¶</a></p>
<p id="section-3.5.3.1-3">Security considerations for 'kcwt' and 'kccs' are made in <a class="auto internal xref" href="#impl-cons">Section 9.8</a>.<a class="pilcrow" href="#section-3.5.3.1-3">¶</a></p>
</section>
</div>
<div id="compact-kid">
<section id="section-3.5.3.2">
            <h5 id="name-compact-encoding-of-id_cred">
<a class="section-number selfRef" href="#section-3.5.3.2">3.5.3.2. </a><a class="section-name selfRef" href="#name-compact-encoding-of-id_cred">Compact Encoding of ID_CRED Fields for 'kid'</a>
            </h5>
<p id="section-3.5.3.2-1">To comply with the Lightweight Authenticated Key Exchange (LAKE) message size requirements (see <span>[<a class="cite xref" href="#I-D.ietf-lake-reqs">LAKE-REQS</a>]</span>), two optimizations are made for the case when ID_CRED_x, for x = I or R, contains a single 'kid' parameter.<a class="pilcrow" href="#section-3.5.3.2-1">¶</a></p>
<ol class="normal type-1" id="section-3.5.3.2-2" start="1" type="1">
<li id="section-3.5.3.2-2.1">The CBOR map { 4 : kid_x } is replaced by the byte string kid_x.<a class="pilcrow" href="#section-3.5.3.2-2.1">¶</a>
</li>
              <li id="section-3.5.3.2-2.2">The representation of identifiers specified in <a class="auto internal xref" href="#bstr-repr">Section 3.3.2</a> is applied to kid_x.<a class="pilcrow" href="#section-3.5.3.2-2.2">¶</a>
</li>
            </ol>
<p id="section-3.5.3.2-3">These optimizations <span class="bcp14">MUST</span> be applied if and only if ID_CRED_x = { 4 : kid_x } and ID_CRED_x in PLAINTEXT_y of message_y, y = 2 or 3; see Sections <a class="auto internal xref" href="#asym-msg2-proc">5.3.2</a> and <a class="auto internal xref" href="#asym-msg3-proc">5.4.2</a>. Note that these optimizations are not applied to instances of ID_CRED_x that have no impact on message size, e.g., context_y, or the COSE protected header. For example:<a class="pilcrow" href="#section-3.5.3.2-3">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5.3.2-4.1">For ID_CRED_x = { 4 : h'FF' }, the encoding in PLAINTEXT_y is not the CBOR map 0xA10441FF but the CBOR byte string h'FF', i.e., 0x41FF.<a class="pilcrow" href="#section-3.5.3.2-4.1">¶</a>
</li>
              <li class="normal" id="section-3.5.3.2-4.2">For ID_CRED_x = { 4 : h'21' }, the encoding in PLAINTEXT_y is neither the CBOR map 0xA1044121 nor the CBOR byte string h'21', i.e., 0x4121, but the CBOR integer 0x21.<a class="pilcrow" href="#section-3.5.3.2-4.2">¶</a>
</li>
            </ul>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="cs">
<section id="section-3.6">
        <h3 id="name-cipher-suites">
<a class="section-number selfRef" href="#section-3.6">3.6. </a><a class="section-name selfRef" href="#name-cipher-suites">Cipher Suites</a>
        </h3>
<p id="section-3.6-1">An EDHOC cipher suite consists of an ordered set of algorithms from the "COSE Algorithms" and "COSE Elliptic Curves" registries as well as the EDHOC MAC length. All algorithm names and definitions follow COSE Algorithms <span>[<a class="cite xref" href="#RFC9053">RFC9053</a>]</span>. Note that COSE sometimes uses peculiar names such as ES256 for Elliptic Curve Digital Signature Algorithm (ECDSA) with SHA-256, A128 for AES-128, and Ed25519 for the curve edwards25519. Algorithms need to be specified with enough parameters to make them completely determined. The EDHOC MAC length <span class="bcp14">MUST</span> be at least 8 bytes. Any cryptographic algorithm used in the COSE header parameters in ID_CRED fields is selected independently of the selected cipher suite. EDHOC is currently only specified for use with key exchange algorithms of type ECDH curves, but any Key Encapsulation Mechanism (KEM), including Post-Quantum Cryptography (PQC) KEMs, can be used in method 0; see <a class="auto internal xref" href="#pqc">Section 9.4</a>. Use of other types of key exchange algorithms to replace static DH authentication (methods 1, 2, and 3) would likely require a specification updating EDHOC with new methods.<a class="pilcrow" href="#section-3.6-1">¶</a></p>
<p id="section-3.6-2">EDHOC supports all signature algorithms defined by COSE. Just like in (D)TLS 1.3 <span>[<a class="cite xref" href="#RFC8446">RFC8446</a>]</span> <span>[<a class="cite xref" href="#RFC9147">RFC9147</a>]</span> and IKEv2 <span>[<a class="cite xref" href="#RFC7296">RFC7296</a>]</span>, a signature in COSE is determined jointly by the signature algorithm and the authentication key algorithm; see <a class="auto internal xref" href="#auth-keys">Section 3.5.1</a>. The exact details of the authentication key algorithm depend on the type of authentication credential. COSE supports different formats for storing the public authentication keys including COSE_Key and X.509, which use different names and ways to represent the authentication key and the authentication key algorithm.<a class="pilcrow" href="#section-3.6-2">¶</a></p>
<p id="section-3.6-3">An EDHOC cipher suite consists of the following parameters:<a class="pilcrow" href="#section-3.6-3">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.6-4.1">EDHOC AEAD algorithm,<a class="pilcrow" href="#section-3.6-4.1">¶</a>
</li>
          <li class="normal" id="section-3.6-4.2">EDHOC hash algorithm,<a class="pilcrow" href="#section-3.6-4.2">¶</a>
</li>
          <li class="normal" id="section-3.6-4.3">EDHOC MAC length in bytes (Static DH),<a class="pilcrow" href="#section-3.6-4.3">¶</a>
</li>
          <li class="normal" id="section-3.6-4.4">EDHOC key exchange algorithm (ECDH curve),<a class="pilcrow" href="#section-3.6-4.4">¶</a>
</li>
          <li class="normal" id="section-3.6-4.5">EDHOC signature algorithm,<a class="pilcrow" href="#section-3.6-4.5">¶</a>
</li>
          <li class="normal" id="section-3.6-4.6">application AEAD algorithm, and<a class="pilcrow" href="#section-3.6-4.6">¶</a>
</li>
          <li class="normal" id="section-3.6-4.7">application hash algorithm.<a class="pilcrow" href="#section-3.6-4.7">¶</a>
</li>
        </ul>
<p id="section-3.6-5">Each cipher suite is identified with a predefined integer label.<a class="pilcrow" href="#section-3.6-5">¶</a></p>
<p id="section-3.6-6">EDHOC can be used with all algorithms and curves defined for COSE. Implementations can either use any combination of COSE algorithms and parameters to define their own private cipher suite or use one of the predefined cipher suites. Private cipher suites can be identified with any of the four values: -24, -23, -22, and -21. The predefined cipher suites are listed in the IANA registry (<a class="auto internal xref" href="#suites-registry">Section 10.2</a>) with the initial content outlined here:<a class="pilcrow" href="#section-3.6-6">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.6-7.1">
            <p id="section-3.6-7.1.1">Cipher suites 0-3, based on AES-CCM, are intended for constrained IoT where message overhead is a very important factor. Note that AES-CCM-16-64-128 and AES-CCM-16-128-128 are compatible with the IEEE AES-CCM* mode of operation defined in Annex B of <span>[<a class="cite xref" href="#IEEE.802.15.4-2015">IEEE.802.15.4-2015</a>]</span>.<a class="pilcrow" href="#section-3.6-7.1.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.6-7.1.2.1">Cipher suites 1 and 3 use a larger tag length (128 bits) in EDHOC than in the application AEAD algorithm (64 bits).<a class="pilcrow" href="#section-3.6-7.1.2.1">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-3.6-7.2">Cipher suites 4 and 5, based on ChaCha20, are intended for less constrained applications and only use 128-bit tag lengths.<a class="pilcrow" href="#section-3.6-7.2">¶</a>
</li>
          <li class="normal" id="section-3.6-7.3">Cipher suite 6, based on AES-GCM, is for general non-constrained applications. It consists of high-performance algorithms that are widely used in non-constrained applications.<a class="pilcrow" href="#section-3.6-7.3">¶</a>
</li>
          <li class="normal" id="section-3.6-7.4">Cipher suites 24 and 25 are intended for high security applications such as government use and financial applications. These cipher suites do not share any algorithms. Cipher suite 24 consists of algorithms from the Commercial National Security Algorithm (CNSA) 1.0 suite <span>[<a class="cite xref" href="#CNSA">CNSA</a>]</span>.<a class="pilcrow" href="#section-3.6-7.4">¶</a>
</li>
        </ul>
<p id="section-3.6-8">The different methods (<a class="auto internal xref" href="#method">Section 3.2</a>) use the same cipher suites, but some algorithms are not used in some methods. The EDHOC signature algorithm is not used in methods without signature authentication.<a class="pilcrow" href="#section-3.6-8">¶</a></p>
<p id="section-3.6-9">The Initiator needs to have a list of cipher suites it supports in order of preference. The Responder needs to have a list of cipher suites it supports. SUITES_I contains cipher suites supported by the Initiator and formatted and processed as detailed in <a class="auto internal xref" href="#asym-msg1-form">Section 5.2.1</a> to secure the cipher suite negotiation. Examples of cipher suite negotiation are given in <a class="auto internal xref" href="#ex-neg">Section 6.3.2</a>.<a class="pilcrow" href="#section-3.6-9">¶</a></p>
</section>
</div>
<div id="cose_key">
<section id="section-3.7">
        <h3 id="name-ephemeral-public-keys">
<a class="section-number selfRef" href="#section-3.7">3.7. </a><a class="section-name selfRef" href="#name-ephemeral-public-keys">Ephemeral Public Keys</a>
        </h3>
<p id="section-3.7-1">The ephemeral public keys in EDHOC (G_X and G_Y) use compact representation of elliptic curve points; see <a class="auto internal xref" href="#comrep">Appendix B</a>. In COSE, compact representation is achieved by formatting the ECDH ephemeral public keys as COSE_Keys of type EC2 or Octet Key Pair (OKP) according to Sections <a class="relref" href="https://rfc-editor.org/rfc/rfc9053#section-7.1">7.1</a> and <a class="relref" href="https://rfc-editor.org/rfc/rfc9053#section-7.2">7.2</a> of <span>[<a class="cite xref" href="#RFC9053">RFC9053</a>]</span> but only including the 'x' parameter in G_X and G_Y. For Elliptic Curve Keys of type EC2, compact representation <span class="bcp14">MAY</span> be used also in the COSE_Key. COSE always uses compact output for Elliptic Curve Keys of type EC2. If the COSE implementation requires a 'y' parameter, the value y = false or a calculated y-coordinate can be used; see <a class="auto internal xref" href="#comrep">Appendix B</a>.<a class="pilcrow" href="#section-3.7-1">¶</a></p>
</section>
</div>
<div id="AD">
<section id="section-3.8">
        <h3 id="name-external-authorization-data">
<a class="section-number selfRef" href="#section-3.8">3.8. </a><a class="section-name selfRef" href="#name-external-authorization-data">External Authorization Data (EAD)</a>
        </h3>
<p id="section-3.8-1">In order to reduce round trips and the number of messages or to simplify processing, external security applications may be integrated into EDHOC by transporting authorization-related data in the messages.<a class="pilcrow" href="#section-3.8-1">¶</a></p>
<p id="section-3.8-2">EDHOC allows processing of external authorization data (EAD) to be defined in a separate specification and sent in dedicated fields of the four EDHOC messages: EAD_1, EAD_2, EAD_3, and EAD_4. EAD is opaque data to EDHOC.<a class="pilcrow" href="#section-3.8-2">¶</a></p>
<p id="section-3.8-3">Each EAD field, EAD_x, for x = 1, 2, 3, or 4, is a CBOR sequence (see <a class="auto internal xref" href="#CBOR">Appendix C.1</a>) consisting of one or more EAD items. EAD item ead is a CBOR sequence of an ead_label and an optional ead_value; see <a class="auto internal xref" href="#fig-ead-item">Figure 5</a> and  <a class="auto internal xref" href="#CDDL">Appendix C.2</a> for the CDDL definitions.<a class="pilcrow" href="#section-3.8-3">¶</a></p>
<span id="name-ead-item"></span><div id="fig-ead-item">
<figure id="figure-5">
          <div class="lang-CDDL sourcecode" id="section-3.8-4.1">
<pre>ead = (
  ead_label : int,
  ? ead_value : bstr,
)
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-5">Figure 5</a>:
<a class="selfRef" href="#name-ead-item">EAD Item</a>
          </figcaption></figure>
</div>
<p id="section-3.8-5">A security application may register one or more EAD labels (see <a class="auto internal xref" href="#iana-ead">Section 10.5</a>) and specify the associated processing and security considerations. The IANA registry contains the absolute value of the ead_label, |ead_label|; the same ead_value applies independently of the sign of the ead_label.<a class="pilcrow" href="#section-3.8-5">¶</a></p>
<p id="section-3.8-6">An EAD item can be either critical or non-critical, determined by the sign of the ead_label in the EAD item transported in the EAD field. A negative value indicates that the EAD item is critical, and a nonnegative value indicates that the EAD item is non-critical.<a class="pilcrow" href="#section-3.8-6">¶</a></p>
<p id="section-3.8-7">If an endpoint receives a critical EAD item it does not recognize or a critical EAD item that contains information that it cannot process, then the endpoint <span class="bcp14">MUST</span> send an EDHOC error message back as defined in <a class="auto internal xref" href="#error">Section 6</a>, and the EDHOC session <span class="bcp14">MUST</span> be aborted. The EAD item specification defines the error processing. A non-critical EAD item can be ignored.<a class="pilcrow" href="#section-3.8-7">¶</a></p>
<p id="section-3.8-8">The security application registering a new EAD item needs to describe under what conditions the EAD item is critical or non-critical, and thus whether the ead_label is used with a negative or positive sign. ead_label = 0 is used for padding; see <a class="auto internal xref" href="#padding">Section 3.8.1</a>.<a class="pilcrow" href="#section-3.8-8">¶</a></p>
<p id="section-3.8-9">The security application may define multiple uses of certain EAD items, e.g., the same EAD item may be used in different EDHOC messages. Multiple occurrences of an EAD item in one EAD field may also be specified, but the criticality of the repeated EAD item is expected to be the same.<a class="pilcrow" href="#section-3.8-9">¶</a></p>
<p id="section-3.8-10">The EAD fields of EDHOC <span class="bcp14">MUST</span> only be used with registered EAD items; see <a class="auto internal xref" href="#iana-ead">Section 10.5</a>. Examples of the use of EAD are provided in <a class="auto internal xref" href="#ead-appendix">Appendix E</a>.<a class="pilcrow" href="#section-3.8-10">¶</a></p>
<div id="padding">
<section id="section-3.8.1">
          <h4 id="name-padding">
<a class="section-number selfRef" href="#section-3.8.1">3.8.1. </a><a class="section-name selfRef" href="#name-padding">Padding</a>
          </h4>
<p id="section-3.8.1-1">EDHOC message_1 and the plaintext of message_2, message_3, and message_4 can be padded with the use of the corresponding EAD_x field, for x = 1, 2, 3, or 4. Padding in EAD_1 mitigates amplification attacks (see <a class="auto internal xref" href="#dos">Section 9.7</a>), and padding in EAD_2, EAD_3, and EAD_4 hides the true length of the plaintext (see <a class="auto internal xref" href="#internet-threat">Section 9.6</a>). Padding <span class="bcp14">MUST</span> be ignored and discarded by the receiving application.<a class="pilcrow" href="#section-3.8.1-1">¶</a></p>
<p id="section-3.8.1-2">Padding is obtained by using an EAD item with ead_label = 0 and a (pseudo)randomly generated byte string of appropriate length as ead_value, noting that the ead_label and the CBOR encoding of ead_value also add bytes. For example:<a class="pilcrow" href="#section-3.8.1-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.8.1-3.1">
              <p id="section-3.8.1-3.1.1">One-byte padding (optional ead_value omitted):<a class="pilcrow" href="#section-3.8.1-3.1.1">¶</a></p>
<p id="section-3.8.1-3.1.2">EAD_x = 0x00<a class="pilcrow" href="#section-3.8.1-3.1.2">¶</a></p>
</li>
            <li class="normal" id="section-3.8.1-3.2">
              <p id="section-3.8.1-3.2.1">Two-byte padding, using the empty byte string (0x40) as ead_value:<a class="pilcrow" href="#section-3.8.1-3.2.1">¶</a></p>
<p id="section-3.8.1-3.2.2">EAD_x = 0x0040<a class="pilcrow" href="#section-3.8.1-3.2.2">¶</a></p>
</li>
            <li class="normal" id="section-3.8.1-3.3">
              <p id="section-3.8.1-3.3.1">Three-byte padding, constructed from the pseudorandomly generated ead_value 0xe9 encoded as byte string:<a class="pilcrow" href="#section-3.8.1-3.3.1">¶</a></p>
<p id="section-3.8.1-3.3.2">EAD_x = 0x0041e9<a class="pilcrow" href="#section-3.8.1-3.3.2">¶</a></p>
</li>
          </ul>
<p id="section-3.8.1-4">Multiple occurrences of EAD items with ead_label = 0 are allowed. Certain padding lengths require the use of at least two such EAD items.<a class="pilcrow" href="#section-3.8.1-4">¶</a></p>
<p id="section-3.8.1-5">Note that padding is non-critical because the intended behavior when receiving is to ignore it.<a class="pilcrow" href="#section-3.8.1-5">¶</a></p>
</section>
</div>
</section>
</div>
<div id="applicability">
<section id="section-3.9">
        <h3 id="name-application-profile">
<a class="section-number selfRef" href="#section-3.9">3.9. </a><a class="section-name selfRef" href="#name-application-profile">Application Profile</a>
        </h3>
<p id="section-3.9-1">EDHOC requires certain parameters to be agreed upon between the Initiator and Responder. Some parameters can be negotiated through the protocol execution (specifically, cipher suite; see <a class="auto internal xref" href="#cs">Section 3.6</a>), but other parameters are only communicated and may not be negotiated (e.g., which authentication method is used; see <a class="auto internal xref" href="#method">Section 3.2</a>). Yet, other parameters need to be known out-of-band to ensure successful completion, e.g., whether message_4 is used or not. The application decides which endpoint is the Initiator and which is the Responder.<a class="pilcrow" href="#section-3.9-1">¶</a></p>
<p id="section-3.9-2">The purpose of an application profile is to describe the intended use of EDHOC to allow for the relevant processing and verifications to be made, including things like the following:<a class="pilcrow" href="#section-3.9-2">¶</a></p>
<ol class="normal type-1" id="section-3.9-3" start="1" type="1">
<li id="section-3.9-3.1">
            <p id="section-3.9-3.1.1">How the endpoint detects that an EDHOC message is received. This includes how EDHOC messages are transported, for example, in the payload of a CoAP message with a certain Uri-Path or Content-Format; see <a class="auto internal xref" href="#coap">Appendix A.2</a>.<a class="pilcrow" href="#section-3.9-3.1.1">¶</a></p>
<p id="section-3.9-3.1.2">The method of transporting EDHOC messages may also describe data carried along with the messages that are needed for the transport to satisfy the requirements of <a class="auto internal xref" href="#transport">Section 3.4</a>, e.g., connection identifiers used with certain messages; see <a class="auto internal xref" href="#coap">Appendix A.2</a>.<a class="pilcrow" href="#section-3.9-3.1.2">¶</a></p>
</li>
          <li id="section-3.9-3.2">Authentication method (METHOD; see <a class="auto internal xref" href="#method">Section 3.2</a>).<a class="pilcrow" href="#section-3.9-3.2">¶</a>
</li>
          <li id="section-3.9-3.3">Profile for authentication credentials (CRED_I and CRED_R; see <a class="auto internal xref" href="#auth-cred">Section 3.5.2</a>), e.g., profile for certificate or CCS, including supported authentication key algorithms (subject public key algorithm in X.509 or C509 certificate).<a class="pilcrow" href="#section-3.9-3.3">¶</a>
</li>
          <li id="section-3.9-3.4">Type used to identify credentials (ID_CRED_I and ID_CRED_R; see <a class="auto internal xref" href="#id_cred">Section 3.5.3</a>).<a class="pilcrow" href="#section-3.9-3.4">¶</a>
</li>
          <li id="section-3.9-3.5">Use and type of external authorization data (EAD_1, EAD_2, EAD_3, and EAD_4; see <a class="auto internal xref" href="#AD">Section 3.8</a>).<a class="pilcrow" href="#section-3.9-3.5">¶</a>
</li>
          <li id="section-3.9-3.6">Identifier used as the identity of the endpoint; see <a class="auto internal xref" href="#identities">Appendix D.2</a>.<a class="pilcrow" href="#section-3.9-3.6">¶</a>
</li>
          <li id="section-3.9-3.7">If message_4 shall be sent/expected, and if not, how to ensure a protected application message is sent from the Responder to the Initiator; see <a class="auto internal xref" href="#m4">Section 5.5</a>.<a class="pilcrow" href="#section-3.9-3.7">¶</a>
</li>
        </ol>
<p id="section-3.9-4">The application profile may also contain information about supported cipher suites. The procedure for selecting and verifying a cipher suite is still performed as described in Sections <a class="auto internal xref" href="#asym-msg1-form">5.2.1</a> and <a class="auto internal xref" href="#wrong-selected">6.3</a>, but it may become simplified by this knowledge. EDHOC messages can be processed without the application profile, i.e., the EDHOC messages include information about the type and length of all fields.<a class="pilcrow" href="#section-3.9-4">¶</a></p>
<p id="section-3.9-5">An example of an application profile is shown in <a class="auto internal xref" href="#appl-temp">Appendix F</a>.<a class="pilcrow" href="#section-3.9-5">¶</a></p>
<p id="section-3.9-6">For some parameters, like METHOD, the type of the ID_CRED field, or EAD, the receiver of an EDHOC message is able to verify compliance with the application profile and, if it needs to fail because of the lack of compliance, to infer the reason why the EDHOC session failed.<a class="pilcrow" href="#section-3.9-6">¶</a></p>
<p id="section-3.9-7">For other encodings, like the profiling of CRED_x in the case that it is not transported, it may not be possible to verify that the lack of compliance with the application profile was the reason for failure. For example, integrity verification in message_2 or message_3 may fail not only because of a wrong credential. For example, in case the Initiator uses a public key certificate by reference (i.e., not transported within the protocol), then both endpoints need to use an identical data structure as CRED_I or else the integrity verification will fail.<a class="pilcrow" href="#section-3.9-7">¶</a></p>
<p id="section-3.9-8">Note that it is not necessary for the endpoints to specify a single transport for the EDHOC messages. For example, a mix of CoAP and HTTP may be used along the path, and this may still allow correlation between messages.<a class="pilcrow" href="#section-3.9-8">¶</a></p>
<p id="section-3.9-9">The application profile may be dependent on the identity of the other endpoint or other information carried in an EDHOC message, but it then applies only to the later phases of the protocol when such information is known. (The Initiator does not know the identity of the Responder before having verified message_2, and the Responder does not know the identity of the Initiator before having verified message_3.)<a class="pilcrow" href="#section-3.9-9">¶</a></p>
<p id="section-3.9-10">Other conditions may be part of the application profile, such as what is the target application or use (if there is more than one application/use) to the extent that EDHOC can distinguish between them. In case multiple application profiles are used, the receiver needs to be able to determine which is applicable for a given EDHOC session, for example, based on the URI to which the EDHOC message is sent, or external authorization data type.<a class="pilcrow" href="#section-3.9-10">¶</a></p>
</section>
</div>
</section>
</div>
<div id="key-der">
<section id="section-4">
      <h2 id="name-key-derivation">
<a class="section-number selfRef" href="#section-4">4. </a><a class="section-name selfRef" href="#name-key-derivation">Key Derivation</a>
      </h2>
<div id="keys-for-edhoc-message-processing">
<section id="section-4.1">
        <h3 id="name-keys-for-edhoc-message-proc">
<a class="section-number selfRef" href="#section-4.1">4.1. </a><a class="section-name selfRef" href="#name-keys-for-edhoc-message-proc">Keys for EDHOC Message Processing</a>
        </h3>
<p id="section-4.1-1">EDHOC uses Extract-and-Expand <span>[<a class="cite xref" href="#RFC5869">RFC5869</a>]</span> with the EDHOC hash algorithm in the selected cipher suite to derive keys used in message processing. This section defines EDHOC_Extract (<a class="auto internal xref" href="#extract">Section 4.1.1</a>) and EDHOC_Expand (<a class="auto internal xref" href="#expand">Section 4.1.2</a>) and how to use them to derive PRK_out (<a class="auto internal xref" href="#prkout">Section 4.1.3</a>), which is the shared secret session key resulting from a completed EDHOC session.<a class="pilcrow" href="#section-4.1-1">¶</a></p>
<p id="section-4.1-2">EDHOC_Extract is used to derive fixed-length uniformly pseudorandom keys (PRKs) from ECDH shared secrets. EDHOC_Expand is used to define EDHOC_KDF for generating MACs and for deriving output keying material (OKM) from PRKs.<a class="pilcrow" href="#section-4.1-2">¶</a></p>
<p id="section-4.1-3">In EDHOC, a specific message is protected with a certain PRK, but how the key is derived depends on the authentication method (<a class="auto internal xref" href="#method">Section 3.2</a>), as detailed in <a class="auto internal xref" href="#asym">Section 5</a>.<a class="pilcrow" href="#section-4.1-3">¶</a></p>
<div id="extract">
<section id="section-4.1.1">
          <h4 id="name-edhoc_extract">
<a class="section-number selfRef" href="#section-4.1.1">4.1.1. </a><a class="section-name selfRef" href="#name-edhoc_extract">EDHOC_Extract</a>
          </h4>
<p id="section-4.1.1-1">The pseudorandom keys (PRKs) used for EDHOC message processing are derived using EDHOC_Extract:<a class="pilcrow" href="#section-4.1.1-1">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1.1-2">
<pre>   PRK = EDHOC_Extract( salt, IKM )
</pre><a class="pilcrow" href="#section-4.1.1-2">¶</a>
</div>
<p id="section-4.1.1-3">where the input keying material (IKM) and salt are defined for each PRK below.<a class="pilcrow" href="#section-4.1.1-3">¶</a></p>
<p id="section-4.1.1-4">The definition of EDHOC_Extract depends on the EDHOC hash algorithm of the selected cipher suite:<a class="pilcrow" href="#section-4.1.1-4">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1.1-5.1">If the EDHOC hash algorithm is SHA-2, then EDHOC_Extract( salt, IKM ) = HKDF-Extract( salt, IKM ) <span>[<a class="cite xref" href="#RFC5869">RFC5869</a>]</span>.<a class="pilcrow" href="#section-4.1.1-5.1">¶</a>
</li>
            <li class="normal" id="section-4.1.1-5.2">If the EDHOC hash algorithm is SHAKE128, then EDHOC_Extract( salt, IKM ) = KMAC128( salt, IKM, 256, "" ).<a class="pilcrow" href="#section-4.1.1-5.2">¶</a>
</li>
            <li class="normal" id="section-4.1.1-5.3">If the EDHOC hash algorithm is SHAKE256, then EDHOC_Extract( salt, IKM ) = KMAC256( salt, IKM, 512, "" ).<a class="pilcrow" href="#section-4.1.1-5.3">¶</a>
</li>
          </ul>
<p id="section-4.1.1-6">where the Keccak Message Authentication Code (KMAC) is specified in <span>[<a class="cite xref" href="#SP800-185">SP800-185</a>]</span>.<a class="pilcrow" href="#section-4.1.1-6">¶</a></p>
<p id="section-4.1.1-7">The rest of the section defines the pseudorandom keys PRK_2e, PRK_3e2m, and PRK_4e3m; their use is shown in <a class="auto internal xref" href="#fig-edhoc-kdf">Figure 6</a>. The index of a PRK indicates its use or in what message protection operation it is involved.  For example, PRK_3e2m is involved in the encryption of message 3 and in calculating the MAC of message 2.<a class="pilcrow" href="#section-4.1.1-7">¶</a></p>
<div id="prk2e">
<section id="section-4.1.1.1">
            <h5 id="name-prk_2e">
<a class="section-number selfRef" href="#section-4.1.1.1">4.1.1.1. </a><a class="section-name selfRef" href="#name-prk_2e">PRK_2e</a>
            </h5>
<p id="section-4.1.1.1-1">The pseudorandom key PRK_2e is derived with the following input:<a class="pilcrow" href="#section-4.1.1.1-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1.1.1-2.1">The salt <span class="bcp14">SHALL</span> be TH_2.<a class="pilcrow" href="#section-4.1.1.1-2.1">¶</a>
</li>
              <li class="normal" id="section-4.1.1.1-2.2">The IKM <span class="bcp14">SHALL</span> be the ephemeral-ephemeral ECDH shared secret G_XY (calculated from G_X and Y or G_Y and X) as defined in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc9053#section-6.3.1">Section 6.3.1</a> of [<a class="cite xref" href="#RFC9053">RFC9053</a>]</span>. The use of G_XY gives forward secrecy in the sense that compromise of the private authentication keys does not compromise past session keys.<a class="pilcrow" href="#section-4.1.1.1-2.2">¶</a>
</li>
            </ul>
<p id="section-4.1.1.1-3">Example: Assuming the use of curve25519, the ECDH shared secret G_XY is the output of the X25519 function <span>[<a class="cite xref" href="#RFC7748">RFC7748</a>]</span>:<a class="pilcrow" href="#section-4.1.1.1-3">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1.1.1-4">
<pre>   G_XY = X25519( Y, G_X ) = X25519( X, G_Y )
</pre><a class="pilcrow" href="#section-4.1.1.1-4">¶</a>
</div>
<p id="section-4.1.1.1-5">Example: Assuming the use of SHA-256, the extract phase of the key derivation function is HKDF-Extract, which produces PRK_2e as follows:<a class="pilcrow" href="#section-4.1.1.1-5">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1.1.1-6">
<pre>   PRK_2e = HMAC-SHA-256( TH_2, G_XY )
</pre><a class="pilcrow" href="#section-4.1.1.1-6">¶</a>
</div>
</section>
</div>
<div id="prk3e2m">
<section id="section-4.1.1.2">
            <h5 id="name-prk_3e2m">
<a class="section-number selfRef" href="#section-4.1.1.2">4.1.1.2. </a><a class="section-name selfRef" href="#name-prk_3e2m">PRK_3e2m</a>
            </h5>
<p id="section-4.1.1.2-1">The pseudorandom key PRK_3e2m is derived as follows:<a class="pilcrow" href="#section-4.1.1.2-1">¶</a></p>
<p id="section-4.1.1.2-2">If the Responder authenticates with a static Diffie-Hellman key, then PRK_3e2m = EDHOC_Extract( SALT_3e2m, G_RX ), where<a class="pilcrow" href="#section-4.1.1.2-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1.1.2-3.1">SALT_3e2m is derived from PRK_2e (see <a class="auto internal xref" href="#expand">Section 4.1.2</a>) and<a class="pilcrow" href="#section-4.1.1.2-3.1">¶</a>
</li>
              <li class="normal" id="section-4.1.1.2-3.2">G_RX is the ECDH shared secret calculated from G_R and X, or G_X and R (the Responder's private authentication key; see <a class="auto internal xref" href="#auth-keys">Section 3.5.1</a>),<a class="pilcrow" href="#section-4.1.1.2-3.2">¶</a>
</li>
            </ul>
<p id="section-4.1.1.2-4">else PRK_3e2m = PRK_2e.<a class="pilcrow" href="#section-4.1.1.2-4">¶</a></p>
</section>
</div>
<div id="prk4e3m">
<section id="section-4.1.1.3">
            <h5 id="name-prk_4e3m">
<a class="section-number selfRef" href="#section-4.1.1.3">4.1.1.3. </a><a class="section-name selfRef" href="#name-prk_4e3m">PRK_4e3m</a>
            </h5>
<p id="section-4.1.1.3-1">The pseudorandom key PRK_4e3m is derived as follows:<a class="pilcrow" href="#section-4.1.1.3-1">¶</a></p>
<p id="section-4.1.1.3-2">If the Initiator authenticates with a static Diffie-Hellman key, then PRK_4e3m = EDHOC_Extract( SALT_4e3m, G_IY ), where<a class="pilcrow" href="#section-4.1.1.3-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1.1.3-3.1">SALT_4e3m is derived from PRK_3e2m (see <a class="auto internal xref" href="#expand">Section 4.1.2</a>) and<a class="pilcrow" href="#section-4.1.1.3-3.1">¶</a>
</li>
              <li class="normal" id="section-4.1.1.3-3.2">G_IY is the ECDH shared secret calculated from G_I and Y, or G_Y and I (the Initiator's private authentication key; see <a class="auto internal xref" href="#auth-keys">Section 3.5.1</a>),<a class="pilcrow" href="#section-4.1.1.3-3.2">¶</a>
</li>
            </ul>
<p id="section-4.1.1.3-4">else PRK_4e3m = PRK_3e2m.<a class="pilcrow" href="#section-4.1.1.3-4">¶</a></p>
</section>
</div>
</section>
</div>
<div id="expand">
<section id="section-4.1.2">
          <h4 id="name-edhoc_expand-and-edhoc_kdf">
<a class="section-number selfRef" href="#section-4.1.2">4.1.2. </a><a class="section-name selfRef" href="#name-edhoc_expand-and-edhoc_kdf">EDHOC_Expand and EDHOC_KDF</a>
          </h4>
<p id="section-4.1.2-1">The output keying material (OKM) -- including keys, initialization vectors (IVs), and salts -- are derived from the PRKs using the EDHOC_KDF, which is defined through EDHOC_Expand:<a class="pilcrow" href="#section-4.1.2-1">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1.2-2">
<pre>   OKM = EDHOC_KDF( PRK, info_label, context, length )
       = EDHOC_Expand( PRK, info, length )
</pre><a class="pilcrow" href="#section-4.1.2-2">¶</a>
</div>
<p id="section-4.1.2-3">where info is encoded as the CBOR sequence:<a class="pilcrow" href="#section-4.1.2-3">¶</a></p>
<div class="lang-cbor sourcecode" id="section-4.1.2-4">
<pre>info = (
  info_label : int,
  context : bstr,
  length : uint,
)
</pre><a class="pilcrow" href="#section-4.1.2-4">¶</a>
</div>
<p id="section-4.1.2-5">where:<a class="pilcrow" href="#section-4.1.2-5">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1.2-6.1">info_label is an int,<a class="pilcrow" href="#section-4.1.2-6.1">¶</a>
</li>
            <li class="normal" id="section-4.1.2-6.2">context is a bstr, and<a class="pilcrow" href="#section-4.1.2-6.2">¶</a>
</li>
            <li class="normal" id="section-4.1.2-6.3">length is the length of OKM in bytes.<a class="pilcrow" href="#section-4.1.2-6.3">¶</a>
</li>
          </ul>
<p id="section-4.1.2-7">When EDHOC_KDF is used to derive OKM for EDHOC message processing, then the context includes one of the transcript hashes, TH_2, TH_3, or TH_4, defined in Sections <a class="auto internal xref" href="#asym-msg2-proc">5.3.2</a> and <a class="auto internal xref" href="#asym-msg3-proc">5.4.2</a>.<a class="pilcrow" href="#section-4.1.2-7">¶</a></p>
<p id="section-4.1.2-8">The definition of EDHOC_Expand depends on the EDHOC hash algorithm of the selected cipher suite:<a class="pilcrow" href="#section-4.1.2-8">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1.2-9.1">If the EDHOC hash algorithm is SHA-2, then EDHOC_Expand( PRK, info, length ) = HKDF-Expand( PRK, info, length ) <span>[<a class="cite xref" href="#RFC5869">RFC5869</a>]</span>.<a class="pilcrow" href="#section-4.1.2-9.1">¶</a>
</li>
            <li class="normal" id="section-4.1.2-9.2">If the EDHOC hash algorithm is SHAKE128, then EDHOC_Expand( PRK, info, length ) = KMAC128( PRK, info, L, "" ).<a class="pilcrow" href="#section-4.1.2-9.2">¶</a>
</li>
            <li class="normal" id="section-4.1.2-9.3">If the EDHOC hash algorithm is SHAKE256, then EDHOC_Expand( PRK, info, length ) = KMAC256( PRK, info, L, "" ).<a class="pilcrow" href="#section-4.1.2-9.3">¶</a>
</li>
          </ul>
<p id="section-4.1.2-10">where L = 8 ⋅ length, the output length in bits.<a class="pilcrow" href="#section-4.1.2-10">¶</a></p>
<p id="section-4.1.2-11"><a class="auto internal xref" href="#fig-edhoc-kdf">Figure 6</a> lists derivations made with EDHOC_KDF, where:<a class="pilcrow" href="#section-4.1.2-11">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1.2-12.1">hash_length is the length of output size of the EDHOC hash algorithm of the selected cipher suite,<a class="pilcrow" href="#section-4.1.2-12.1">¶</a>
</li>
            <li class="normal" id="section-4.1.2-12.2">key_length is the length of the encryption key of the EDHOC AEAD algorithm of the selected cipher suite, and<a class="pilcrow" href="#section-4.1.2-12.2">¶</a>
</li>
            <li class="normal" id="section-4.1.2-12.3">iv_length is the length of the initialization vector of the EDHOC AEAD algorithm of the selected cipher suite<a class="pilcrow" href="#section-4.1.2-12.3">¶</a>
</li>
          </ul>
<p id="section-4.1.2-13">Further details of the key derivation and how the output keying material is used are specified in <a class="auto internal xref" href="#asym">Section 5</a>.<a class="pilcrow" href="#section-4.1.2-13">¶</a></p>
<span id="name-key-derivations-using-edhoc"></span><div id="fig-edhoc-kdf">
<figure id="figure-6">
            <div class="alignCenter art-text artwork" id="section-4.1.2-14.1">
<pre>KEYSTREAM_2   = EDHOC_KDF( PRK_2e,   0, TH_2,      plaintext_length )
SALT_3e2m     = EDHOC_KDF( PRK_2e,   1, TH_2,      hash_length )
MAC_2         = EDHOC_KDF( PRK_3e2m, 2, context_2, mac_length_2 )
K_3           = EDHOC_KDF( PRK_3e2m, 3, TH_3,      key_length )
IV_3          = EDHOC_KDF( PRK_3e2m, 4, TH_3,      iv_length )
SALT_4e3m     = EDHOC_KDF( PRK_3e2m, 5, TH_3,      hash_length )
MAC_3         = EDHOC_KDF( PRK_4e3m, 6, context_3, mac_length_3 )
PRK_out       = EDHOC_KDF( PRK_4e3m, 7, TH_4,      hash_length )
K_4           = EDHOC_KDF( PRK_4e3m, 8, TH_4,      key_length )
IV_4          = EDHOC_KDF( PRK_4e3m, 9, TH_4,      iv_length )
PRK_exporter  = EDHOC_KDF( PRK_out, 10, h'',       hash_length )
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-6">Figure 6</a>:
<a class="selfRef" href="#name-key-derivations-using-edhoc">Key Derivations Using EDHOC_KDF</a>
            </figcaption></figure>
</div>
<p id="section-4.1.2-15">h'' is CBOR diagnostic notation for the empty byte string, 0x40.<a class="pilcrow" href="#section-4.1.2-15">¶</a></p>
</section>
</div>
<div id="prkout">
<section id="section-4.1.3">
          <h4 id="name-prk_out">
<a class="section-number selfRef" href="#section-4.1.3">4.1.3. </a><a class="section-name selfRef" href="#name-prk_out">PRK_out</a>
          </h4>
<p id="section-4.1.3-1">The pseudorandom key PRK_out, derived as shown in <a class="auto internal xref" href="#fig-edhoc-kdf">Figure 6</a>, is the output session key of a completed EDHOC session.<a class="pilcrow" href="#section-4.1.3-1">¶</a></p>
<p id="section-4.1.3-2">Keys for applications are derived using EDHOC_Exporter (see <a class="auto internal xref" href="#exporter">Section 4.2.1</a>) from PRK_exporter, which in turn is derived from PRK_out as shown in <a class="auto internal xref" href="#fig-edhoc-kdf">Figure 6</a>. For the purpose of generating application keys, it is sufficient to store PRK_out or PRK_exporter. (Note that the word "store" used here does not imply that the application has access to the plaintext PRK_out since that may be reserved for code within a Trusted Execution Environment (TEE); see <a class="auto internal xref" href="#impl-cons">Section 9.8</a>.)<a class="pilcrow" href="#section-4.1.3-2">¶</a></p>
</section>
</div>
</section>
</div>
<div id="keys-for-edhoc-applications">
<section id="section-4.2">
        <h3 id="name-keys-for-edhoc-applications">
<a class="section-number selfRef" href="#section-4.2">4.2. </a><a class="section-name selfRef" href="#name-keys-for-edhoc-applications">Keys for EDHOC Applications</a>
        </h3>
<p id="section-4.2-1">This section defines EDHOC_Exporter in terms of EDHOC_KDF and PRK_exporter. A key update function is defined in <a class="auto internal xref" href="#keyupdate">Appendix H</a>.<a class="pilcrow" href="#section-4.2-1">¶</a></p>
<div id="exporter">
<section id="section-4.2.1">
          <h4 id="name-edhoc_exporter">
<a class="section-number selfRef" href="#section-4.2.1">4.2.1. </a><a class="section-name selfRef" href="#name-edhoc_exporter">EDHOC_Exporter</a>
          </h4>
<p id="section-4.2.1-1">Keying material for the application can be derived using the EDHOC_Exporter interface defined as:<a class="pilcrow" href="#section-4.2.1-1">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.1-2">
<pre>   EDHOC_Exporter(exporter_label, context, length)
     = EDHOC_KDF(PRK_exporter, exporter_label, context, length)
</pre><a class="pilcrow" href="#section-4.2.1-2">¶</a>
</div>
<p id="section-4.2.1-3">where:<a class="pilcrow" href="#section-4.2.1-3">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.1-4.1">exporter_label is a registered uint from the "EDHOC Exporter Labels" registry (<a class="auto internal xref" href="#exporter-label">Section 10.1</a>),<a class="pilcrow" href="#section-4.2.1-4.1">¶</a>
</li>
            <li class="normal" id="section-4.2.1-4.2">context is a bstr defined by the application, and<a class="pilcrow" href="#section-4.2.1-4.2">¶</a>
</li>
            <li class="normal" id="section-4.2.1-4.3">length is a uint defined by the application.<a class="pilcrow" href="#section-4.2.1-4.3">¶</a>
</li>
          </ul>
<p id="section-4.2.1-5">The (exporter_label, context) pair used in EDHOC_Exporter must be unique, i.e., an (exporter_label, context) <span class="bcp14">MUST NOT</span> be used for two different purposes. However, an application can re-derive the same key several times as long as it is done securely. For example, in most encryption algorithms, the same key can be reused with different nonces. The context can, for example, be the empty CBOR byte string.<a class="pilcrow" href="#section-4.2.1-5">¶</a></p>
<p id="section-4.2.1-6">Examples of use of the EDHOC_Exporter are given in <a class="auto internal xref" href="#transfer">Appendix A</a>.<a class="pilcrow" href="#section-4.2.1-6">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="asym">
<section id="section-5">
      <h2 id="name-message-formatting-and-proc">
<a class="section-number selfRef" href="#section-5">5. </a><a class="section-name selfRef" href="#name-message-formatting-and-proc">Message Formatting and Processing</a>
      </h2>
<p id="section-5-1">This section specifies formatting of the messages and processing steps. Error messages are specified in <a class="auto internal xref" href="#error">Section 6</a>. Annotated traces of EDHOC sessions are provided in <span>[<a class="cite xref" href="#RFC9529">RFC9529</a>]</span>.<a class="pilcrow" href="#section-5-1">¶</a></p>
<p id="section-5-2">An EDHOC message is encoded as a sequence of CBOR data items (CBOR Sequence <span>[<a class="cite xref" href="#RFC8742">RFC8742</a>]</span>).
Additional optimizations are made to reduce message overhead.<a class="pilcrow" href="#section-5-2">¶</a></p>
<p id="section-5-3">While EDHOC uses the COSE_Key, COSE_Sign1, and COSE_Encrypt0 structures, only a subset of the parameters is included in the EDHOC messages; see <a class="auto internal xref" href="#COSE">Appendix C.3</a>. In order to recreate the COSE object, the recipient endpoint may need to add parameters to the COSE headers not included in the EDHOC message, for example, the parameter 'alg' to COSE_Sign1 or COSE_Encrypt0.<a class="pilcrow" href="#section-5-3">¶</a></p>
<div id="proc-outline">
<section id="section-5.1">
        <h3 id="name-edhoc-message-processing-ou">
<a class="section-number selfRef" href="#section-5.1">5.1. </a><a class="section-name selfRef" href="#name-edhoc-message-processing-ou">EDHOC Message Processing Outline</a>
        </h3>
<p id="section-5.1-1">For each new/ongoing EDHOC session, the endpoints are assumed to keep an associated protocol state containing identifiers, keying material, etc. used for subsequent processing of protocol-related data. The protocol state is assumed to be associated with an application profile (<a class="auto internal xref" href="#applicability">Section 3.9</a>) that provides the context for how messages are transported, identified, and processed.<a class="pilcrow" href="#section-5.1-1">¶</a></p>
<p id="section-5.1-2">EDHOC messages <span class="bcp14">SHALL</span> be processed according to the current protocol state. The following steps are expected to be performed at reception of an EDHOC message:<a class="pilcrow" href="#section-5.1-2">¶</a></p>
<ol class="normal type-1" id="section-5.1-3" start="1" type="1">
<li id="section-5.1-3.1">Detect that an EDHOC message has been received, for example, by means of a port number, URI, or media type (<a class="auto internal xref" href="#applicability">Section 3.9</a>).<a class="pilcrow" href="#section-5.1-3.1">¶</a>
</li>
          <li id="section-5.1-3.2">Retrieve the protocol state according to the message correlation; see <a class="auto internal xref" href="#ci-edhoc">Section 3.4.1</a>. If there is no protocol state, in the case of message_1, a new protocol state is created. The Responder endpoint needs to make use of available denial-of-service mitigation (<a class="auto internal xref" href="#dos">Section 9.7</a>).<a class="pilcrow" href="#section-5.1-3.2">¶</a>
</li>
          <li id="section-5.1-3.3">If the message received is an error message, then process it according to <a class="auto internal xref" href="#error">Section 6</a>, else process it as the expected next message according to the protocol state.<a class="pilcrow" href="#section-5.1-3.3">¶</a>
</li>
        </ol>
<p id="section-5.1-4">The message processing steps <span class="bcp14">SHALL</span> be processed in order, unless otherwise stated. If the processing fails for some reason, then typically an error message is sent, the EDHOC session is aborted, and the protocol state is erased. When the composition and sending of one message is completed and before the next message is received, error messages <span class="bcp14">SHALL NOT</span> be sent.<a class="pilcrow" href="#section-5.1-4">¶</a></p>
<p id="section-5.1-5">After having successfully processed the last message (message_3 or message_4 depending on application profile), the EDHOC session is completed; after which, no error messages are sent and EDHOC session output <span class="bcp14">MAY</span> be maintained even if error messages are received. Further details are provided in the following subsections and in <a class="auto internal xref" href="#error">Section 6</a>.<a class="pilcrow" href="#section-5.1-5">¶</a></p>
<p id="section-5.1-6">Different instances of the same message <span class="bcp14">MUST NOT</span> be processed in one EDHOC session.  Note that processing will fail if the same message appears a second time for EDHOC processing in the same EDHOC session because the state of the protocol has moved on and now expects something else. Message deduplication <span class="bcp14">MUST</span> be done by the transport protocol (see <a class="auto internal xref" href="#transport">Section 3.4</a>) or, if not supported by the transport, as described in <a class="auto internal xref" href="#duplication">Section 7</a>.<a class="pilcrow" href="#section-5.1-6">¶</a></p>
</section>
</div>
<div id="m1">
<section id="section-5.2">
        <h3 id="name-edhoc-message-1">
<a class="section-number selfRef" href="#section-5.2">5.2. </a><a class="section-name selfRef" href="#name-edhoc-message-1">EDHOC Message 1</a>
        </h3>
<div id="asym-msg1-form">
<section id="section-5.2.1">
          <h4 id="name-formatting-of-message-1">
<a class="section-number selfRef" href="#section-5.2.1">5.2.1. </a><a class="section-name selfRef" href="#name-formatting-of-message-1">Formatting of Message 1</a>
          </h4>
<p id="section-5.2.1-1">message_1 <span class="bcp14">SHALL</span> be a CBOR Sequence (see <a class="auto internal xref" href="#CBOR">Appendix C.1</a>), as defined below.<a class="pilcrow" href="#section-5.2.1-1">¶</a></p>
<div class="lang-cbor sourcecode" id="section-5.2.1-2">
<pre>message_1 = (
  METHOD : int,
  SUITES_I : suites,
  G_X : bstr,
  C_I : bstr / -24..23,
  ? EAD_1,
)

suites = [ 2* int ] / int
EAD_1 = 1* ead
</pre><a class="pilcrow" href="#section-5.2.1-2">¶</a>
</div>
<p id="section-5.2.1-3">where:<a class="pilcrow" href="#section-5.2.1-3">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.1-4.1">METHOD is an authentication method; see <a class="auto internal xref" href="#method">Section 3.2</a>,<a class="pilcrow" href="#section-5.2.1-4.1">¶</a>
</li>
            <li class="normal" id="section-5.2.1-4.2">SUITES_I is an array of cipher suites that the Initiator supports constructed as specified in <a class="auto internal xref" href="#init-proc-msg1">Section 5.2.2</a>,<a class="pilcrow" href="#section-5.2.1-4.2">¶</a>
</li>
            <li class="normal" id="section-5.2.1-4.3">G_X is the ephemeral public key of the Initiator, and<a class="pilcrow" href="#section-5.2.1-4.3">¶</a>
</li>
            <li class="normal" id="section-5.2.1-4.4">C_I is a variable-length connection identifier (note that connection identifiers are byte strings but certain values are represented as integers in the message; see <a class="auto internal xref" href="#bstr-repr">Section 3.3.2</a>), and<a class="pilcrow" href="#section-5.2.1-4.4">¶</a>
</li>
            <li class="normal" id="section-5.2.1-4.5">EAD_1 is external authorization data; see <a class="auto internal xref" href="#AD">Section 3.8</a>.<a class="pilcrow" href="#section-5.2.1-4.5">¶</a>
</li>
          </ul>
</section>
</div>
<div id="init-proc-msg1">
<section id="section-5.2.2">
          <h4 id="name-initiator-composition-of-me">
<a class="section-number selfRef" href="#section-5.2.2">5.2.2. </a><a class="section-name selfRef" href="#name-initiator-composition-of-me">Initiator Composition of Message 1</a>
          </h4>
<p id="section-5.2.2-1">The processing steps are detailed below and in <a class="auto internal xref" href="#wrong-selected">Section 6.3</a>.<a class="pilcrow" href="#section-5.2.2-1">¶</a></p>
<p id="section-5.2.2-2">The Initiator <span class="bcp14">SHALL</span> compose message_1 as follows:<a class="pilcrow" href="#section-5.2.2-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.2-3.1">
              <p id="section-5.2.2-3.1.1">Construct SUITES_I as an array of cipher suites supported by I in order of preference by I with the first cipher suite in the array being the most preferred by I and the last being the one selected by I for this EDHOC session. If the cipher suite most preferred by I is selected, then SUITES_I contains only that cipher suite and is encoded as an int. All cipher suites, if any, preferred by I over the selected one <span class="bcp14">MUST</span> be included. (See also <a class="auto internal xref" href="#wrong-selected">Section 6.3</a>.)<a class="pilcrow" href="#section-5.2.2-3.1.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.2-3.1.2.1">The selected suite is based on what the Initiator can assume to be supported by the Responder; if the Initiator previously received from the Responder an error message with error code 2 containing SUITES_R (see <a class="auto internal xref" href="#wrong-selected">Section 6.3</a>) indicating cipher suites supported by the Responder, then the Initiator <span class="bcp14">SHOULD</span> select its most preferred supported cipher suite among those (bearing in mind that error messages may be forged).<a class="pilcrow" href="#section-5.2.2-3.1.2.1">¶</a>
</li>
                <li class="normal" id="section-5.2.2-3.1.2.2">The Initiator <span class="bcp14">MUST NOT</span> change its order of preference for cipher suites and <span class="bcp14">MUST NOT</span> omit a cipher suite preferred to the selected one because of previous error messages received from the Responder.<a class="pilcrow" href="#section-5.2.2-3.1.2.2">¶</a>
</li>
              </ul>
</li>
            <li class="normal" id="section-5.2.2-3.2">Generate an ephemeral ECDH key pair using the curve in the selected cipher suite and format it as a COSE_Key. Let G_X be the 'x' parameter of the COSE_Key.<a class="pilcrow" href="#section-5.2.2-3.2">¶</a>
</li>
            <li class="normal" id="section-5.2.2-3.3">Choose a connection identifier C_I and store it during the EDHOC session.<a class="pilcrow" href="#section-5.2.2-3.3">¶</a>
</li>
            <li class="normal" id="section-5.2.2-3.4">Encode message_1 as a sequence of CBOR-encoded data items as specified in <a class="auto internal xref" href="#asym-msg1-form">Section 5.2.1</a><a class="pilcrow" href="#section-5.2.2-3.4">¶</a>
</li>
          </ul>
</section>
</div>
<div id="resp-proc-msg1">
<section id="section-5.2.3">
          <h4 id="name-responder-processing-of-mes">
<a class="section-number selfRef" href="#section-5.2.3">5.2.3. </a><a class="section-name selfRef" href="#name-responder-processing-of-mes">Responder Processing of Message 1</a>
          </h4>
<p id="section-5.2.3-1">The Responder <span class="bcp14">SHALL</span> process message_1 in the following order:<a class="pilcrow" href="#section-5.2.3-1">¶</a></p>
<ol class="normal type-1" id="section-5.2.3-2" start="1" type="1">
            <li id="section-5.2.3-2.1">Decode message_1 (see <a class="auto internal xref" href="#CBOR">Appendix C.1</a>).<a class="pilcrow" href="#section-5.2.3-2.1">¶</a>
</li>
            <li id="section-5.2.3-2.2">Process message_1. In particular, verify that the selected cipher suite is supported and that no prior cipher suite as ordered in SUITES_I is supported.<a class="pilcrow" href="#section-5.2.3-2.2">¶</a>
</li>
            <li id="section-5.2.3-2.3">If all processing completed successfully, and if EAD_1 is present, then make it available to the application for EAD processing.<a class="pilcrow" href="#section-5.2.3-2.3">¶</a>
</li>
          </ol>
<p id="section-5.2.3-3">If any processing step fails, then the Responder <span class="bcp14">MUST</span> send an EDHOC error message back as defined in <a class="auto internal xref" href="#error">Section 6</a>, and the EDHOC session <span class="bcp14">MUST</span> be aborted.<a class="pilcrow" href="#section-5.2.3-3">¶</a></p>
</section>
</div>
</section>
</div>
<div id="m2">
<section id="section-5.3">
        <h3 id="name-edhoc-message-2">
<a class="section-number selfRef" href="#section-5.3">5.3. </a><a class="section-name selfRef" href="#name-edhoc-message-2">EDHOC Message 2</a>
        </h3>
<div id="asym-msg2-form">
<section id="section-5.3.1">
          <h4 id="name-formatting-of-message-2">
<a class="section-number selfRef" href="#section-5.3.1">5.3.1. </a><a class="section-name selfRef" href="#name-formatting-of-message-2">Formatting of Message 2</a>
          </h4>
<p id="section-5.3.1-1">message_2 <span class="bcp14">SHALL</span> be a CBOR Sequence (see <a class="auto internal xref" href="#CBOR">Appendix C.1</a>), as defined below.<a class="pilcrow" href="#section-5.3.1-1">¶</a></p>
<div class="lang-cbor sourcecode" id="section-5.3.1-2">
<pre>message_2 = (
  G_Y_CIPHERTEXT_2 : bstr,
)
</pre><a class="pilcrow" href="#section-5.3.1-2">¶</a>
</div>
<p id="section-5.3.1-3">where:<a class="pilcrow" href="#section-5.3.1-3">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.1-4.1">G_Y_CIPHERTEXT_2 is the concatenation of G_Y (i.e., the ephemeral public key of the Responder) and CIPHERTEXT_2.<a class="pilcrow" href="#section-5.3.1-4.1">¶</a>
</li>
          </ul>
</section>
</div>
<div id="asym-msg2-proc">
<section id="section-5.3.2">
          <h4 id="name-responder-composition-of-me">
<a class="section-number selfRef" href="#section-5.3.2">5.3.2. </a><a class="section-name selfRef" href="#name-responder-composition-of-me">Responder Composition of Message 2</a>
          </h4>
<p id="section-5.3.2-1">The Responder <span class="bcp14">SHALL</span> compose message_2 as follows:<a class="pilcrow" href="#section-5.3.2-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.2-2.1">Generate an ephemeral ECDH key pair using the curve in the selected cipher suite and format it as a COSE_Key. Let G_Y be the 'x' parameter of the COSE_Key.<a class="pilcrow" href="#section-5.3.2-2.1">¶</a>
</li>
            <li class="normal" id="section-5.3.2-2.2">Choose a connection identifier C_R and store it for the length of the EDHOC session.<a class="pilcrow" href="#section-5.3.2-2.2">¶</a>
</li>
            <li class="normal" id="section-5.3.2-2.3">Compute the transcript hash TH_2 = H( G_Y, H(message_1) ), where H() is the EDHOC hash algorithm of the selected cipher suite. The input to the hash function is a CBOR Sequence. Note that H(message_1) can be computed and cached already in the processing of message_1.<a class="pilcrow" href="#section-5.3.2-2.3">¶</a>
</li>
            <li class="normal" id="section-5.3.2-2.4">
              <p id="section-5.3.2-2.4.1">Compute MAC_2 as in <a class="auto internal xref" href="#expand">Section 4.1.2</a> with context_2 = &lt;&lt; C_R, ID_CRED_R, TH_2, CRED_R, ? EAD_2 &gt;&gt; (see <a class="auto internal xref" href="#CBOR">Appendix C.1</a> for notation).<a class="pilcrow" href="#section-5.3.2-2.4.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.2-2.4.2.1">If the Responder authenticates with a static Diffie-Hellman key (method equals 1 or 3), then mac_length_2 is the EDHOC MAC length of the selected cipher suite. If the Responder authenticates with a signature key (method equals 0 or 2), then mac_length_2 is equal to hash_length.<a class="pilcrow" href="#section-5.3.2-2.4.2.1">¶</a>
</li>
                <li class="normal" id="section-5.3.2-2.4.2.2">C_R is a variable-length connection identifier.  Note that connection identifiers are byte strings but certain values are represented as integers in the message; see <a class="auto internal xref" href="#bstr-repr">Section 3.3.2</a>.<a class="pilcrow" href="#section-5.3.2-2.4.2.2">¶</a>
</li>
                <li class="normal" id="section-5.3.2-2.4.2.3">ID_CRED_R is an identifier to facilitate the retrieval of CRED_R; see <a class="auto internal xref" href="#id_cred">Section 3.5.3</a>.<a class="pilcrow" href="#section-5.3.2-2.4.2.3">¶</a>
</li>
                <li class="normal" id="section-5.3.2-2.4.2.4">CRED_R is a CBOR item containing the authentication credential of the Responder; see <a class="auto internal xref" href="#auth-cred">Section 3.5.2</a>.<a class="pilcrow" href="#section-5.3.2-2.4.2.4">¶</a>
</li>
                <li class="normal" id="section-5.3.2-2.4.2.5">EAD_2 is external authorization data; see <a class="auto internal xref" href="#AD">Section 3.8</a>.<a class="pilcrow" href="#section-5.3.2-2.4.2.5">¶</a>
</li>
              </ul>
</li>
            <li class="normal" id="section-5.3.2-2.5">
              <p id="section-5.3.2-2.5.1">If the Responder authenticates with a static Diffie-Hellman key (method equals 1 or 3), then Signature_or_MAC_2 is MAC_2. If the Responder authenticates with a signature key (method equals 0 or 2), then Signature_or_MAC_2 is the 'signature' field of a COSE_Sign1 object, computed as specified in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc9052#section-4.4">Section 4.4</a> of [<a class="cite xref" href="#RFC9052">RFC9052</a>]</span> using the signature algorithm of the selected cipher suite, the private authentication key of the Responder, and the following parameters as input (see <a class="auto internal xref" href="#COSE">Appendix C.3</a> for an overview of COSE and <a class="auto internal xref" href="#CBOR">Appendix C.1</a> for notation):<a class="pilcrow" href="#section-5.3.2-2.5.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.2-2.5.2.1">protected =  &lt;&lt; ID_CRED_R &gt;&gt;<a class="pilcrow" href="#section-5.3.2-2.5.2.1">¶</a>
</li>
                <li class="normal" id="section-5.3.2-2.5.2.2">external_aad = &lt;&lt; TH_2, CRED_R, ? EAD_2 &gt;&gt;<a class="pilcrow" href="#section-5.3.2-2.5.2.2">¶</a>
</li>
                <li class="normal" id="section-5.3.2-2.5.2.3">payload = MAC_2<a class="pilcrow" href="#section-5.3.2-2.5.2.3">¶</a>
</li>
              </ul>
</li>
            <li class="normal" id="section-5.3.2-2.6">
              <p id="section-5.3.2-2.6.1">CIPHERTEXT_2 is calculated with a binary additive stream cipher, using a keystream generated with EDHOC_Expand and the following plaintext:<a class="pilcrow" href="#section-5.3.2-2.6.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.2-2.6.2.1">
                  <p id="section-5.3.2-2.6.2.1.1">PLAINTEXT_2 = ( C_R, ID_CRED_R / bstr / -24..23, Signature_or_MAC_2, ? EAD_2 )<a class="pilcrow" href="#section-5.3.2-2.6.2.1.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.2-2.6.2.1.2.1">If ID_CRED_R contains a single 'kid' parameter, i.e., ID_CRED_R = { 4 : kid_R }, then the compact encoding is applied; see <a class="auto internal xref" href="#compact-kid">Section 3.5.3.2</a>.<a class="pilcrow" href="#section-5.3.2-2.6.2.1.2.1">¶</a>
</li>
                    <li class="normal" id="section-5.3.2-2.6.2.1.2.2">C_R is the variable-length connection identifier. Note that connection identifiers are byte strings, but certain values are represented as integers in the message; see <a class="auto internal xref" href="#bstr-repr">Section 3.3.2</a>.<a class="pilcrow" href="#section-5.3.2-2.6.2.1.2.2">¶</a>
</li>
                  </ul>
</li>
                <li class="normal" id="section-5.3.2-2.6.2.2">Compute KEYSTREAM_2 as in <a class="auto internal xref" href="#expand">Section 4.1.2</a>, where plaintext_length is the length of PLAINTEXT_2. For the case of plaintext_length exceeding the EDHOC_KDF output size, see <a class="auto internal xref" href="#large-plaintext_2">Appendix G</a>.<a class="pilcrow" href="#section-5.3.2-2.6.2.2">¶</a>
</li>
                <li class="normal" id="section-5.3.2-2.6.2.3">CIPHERTEXT_2 = PLAINTEXT_2 XOR KEYSTREAM_2<a class="pilcrow" href="#section-5.3.2-2.6.2.3">¶</a>
</li>
              </ul>
</li>
            <li class="normal" id="section-5.3.2-2.7">Encode message_2 as a sequence of CBOR-encoded data items as specified in <a class="auto internal xref" href="#asym-msg2-form">Section 5.3.1</a>.<a class="pilcrow" href="#section-5.3.2-2.7">¶</a>
</li>
          </ul>
</section>
</div>
<div id="initiator-processing-of-message-2">
<section id="section-5.3.3">
          <h4 id="name-initiator-processing-of-mes">
<a class="section-number selfRef" href="#section-5.3.3">5.3.3. </a><a class="section-name selfRef" href="#name-initiator-processing-of-mes">Initiator Processing of Message 2</a>
          </h4>
<p id="section-5.3.3-1">The Initiator <span class="bcp14">SHALL</span> process message_2 in the following order:<a class="pilcrow" href="#section-5.3.3-1">¶</a></p>
<ol class="normal type-1" id="section-5.3.3-2" start="1" type="1">
            <li id="section-5.3.3-2.1">Decode message_2 (see <a class="auto internal xref" href="#CBOR">Appendix C.1</a>).<a class="pilcrow" href="#section-5.3.3-2.1">¶</a>
</li>
            <li id="section-5.3.3-2.2">Retrieve the protocol state using available message correlation (e.g., the CoAP Token, the 5-tuple, or the prepended C_I; see <a class="auto internal xref" href="#ci-edhoc">Section 3.4.1</a>).<a class="pilcrow" href="#section-5.3.3-2.2">¶</a>
</li>
            <li id="section-5.3.3-2.3">Decrypt CIPHERTEXT_2; see <a class="auto internal xref" href="#asym-msg2-proc">Section 5.3.2</a>.<a class="pilcrow" href="#section-5.3.3-2.3">¶</a>
</li>
            <li id="section-5.3.3-2.4">If all processing is completed successfully, then make ID_CRED_R and (if present) EAD_2 available to the application for authentication and EAD processing. When and how to perform authentication is up to the application.<a class="pilcrow" href="#section-5.3.3-2.4">¶</a>
</li>
            <li id="section-5.3.3-2.5">Obtain the authentication credential (CRED_R) and the authentication key of R from the application (or by other means).<a class="pilcrow" href="#section-5.3.3-2.5">¶</a>
</li>
            <li id="section-5.3.3-2.6">Verify Signature_or_MAC_2 using the algorithm in the selected cipher suite. The verification process depends on the method; see <a class="auto internal xref" href="#asym-msg2-proc">Section 5.3.2</a>. Make the result of the verification available to the application.<a class="pilcrow" href="#section-5.3.3-2.6">¶</a>
</li>
          </ol>
<p id="section-5.3.3-3">If any processing step fails, then the Initiator <span class="bcp14">MUST</span> send an EDHOC error message back as defined in <a class="auto internal xref" href="#error">Section 6</a>, and the EDHOC session <span class="bcp14">MUST</span> be aborted.<a class="pilcrow" href="#section-5.3.3-3">¶</a></p>
</section>
</div>
</section>
</div>
<div id="m3">
<section id="section-5.4">
        <h3 id="name-edhoc-message-3">
<a class="section-number selfRef" href="#section-5.4">5.4. </a><a class="section-name selfRef" href="#name-edhoc-message-3">EDHOC Message 3</a>
        </h3>
<div id="asym-msg3-form">
<section id="section-5.4.1">
          <h4 id="name-formatting-of-message-3">
<a class="section-number selfRef" href="#section-5.4.1">5.4.1. </a><a class="section-name selfRef" href="#name-formatting-of-message-3">Formatting of Message 3</a>
          </h4>
<p id="section-5.4.1-1">message_3 <span class="bcp14">SHALL</span> be a CBOR Sequence (see <a class="auto internal xref" href="#CBOR">Appendix C.1</a>), as defined below.<a class="pilcrow" href="#section-5.4.1-1">¶</a></p>
<div class="lang-cbor sourcecode" id="section-5.4.1-2">
<pre>message_3 = (
  CIPHERTEXT_3 : bstr,
)
</pre><a class="pilcrow" href="#section-5.4.1-2">¶</a>
</div>
</section>
</div>
<div id="asym-msg3-proc">
<section id="section-5.4.2">
          <h4 id="name-initiator-composition-of-mes">
<a class="section-number selfRef" href="#section-5.4.2">5.4.2. </a><a class="section-name selfRef" href="#name-initiator-composition-of-mes">Initiator Composition of Message 3</a>
          </h4>
<p id="section-5.4.2-1">The Initiator <span class="bcp14">SHALL</span> compose message_3 as follows:<a class="pilcrow" href="#section-5.4.2-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.4.2-2.1">Compute the transcript hash TH_3 = H(TH_2, PLAINTEXT_2, CRED_R), where H() is the EDHOC hash algorithm of the selected cipher suite. The input to the hash function is a CBOR Sequence. Note that TH_3 can be computed and cached already in the processing of message_2.<a class="pilcrow" href="#section-5.4.2-2.1">¶</a>
</li>
            <li class="normal" id="section-5.4.2-2.2">
              <p id="section-5.4.2-2.2.1">Compute MAC_3 as in <a class="auto internal xref" href="#expand">Section 4.1.2</a>, with context_3 = &lt;&lt; ID_CRED_I, TH_3, CRED_I, ? EAD_3 &gt;&gt;<a class="pilcrow" href="#section-5.4.2-2.2.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.4.2-2.2.2.1">If the Initiator authenticates with a static Diffie-Hellman key (method equals 2 or 3), then mac_length_3 is the EDHOC MAC length of the selected cipher suite.  If the Initiator authenticates with a signature key (method equals 0 or 1), then mac_length_3 is equal to hash_length.<a class="pilcrow" href="#section-5.4.2-2.2.2.1">¶</a>
</li>
                <li class="normal" id="section-5.4.2-2.2.2.2">ID_CRED_I is an identifier to facilitate the retrieval of CRED_I; see <a class="auto internal xref" href="#id_cred">Section 3.5.3</a>.<a class="pilcrow" href="#section-5.4.2-2.2.2.2">¶</a>
</li>
                <li class="normal" id="section-5.4.2-2.2.2.3">CRED_I is a CBOR item containing the authentication credential of the Initiator; see <a class="auto internal xref" href="#auth-cred">Section 3.5.2</a>.<a class="pilcrow" href="#section-5.4.2-2.2.2.3">¶</a>
</li>
                <li class="normal" id="section-5.4.2-2.2.2.4">EAD_3 is external authorization data; see <a class="auto internal xref" href="#AD">Section 3.8</a>.<a class="pilcrow" href="#section-5.4.2-2.2.2.4">¶</a>
</li>
              </ul>
</li>
            <li class="normal" id="section-5.4.2-2.3">
              <p id="section-5.4.2-2.3.1">If the Initiator authenticates with a static Diffie-Hellman key (method equals 2 or 3), then Signature_or_MAC_3 is MAC_3. If the Initiator authenticates with a signature key (method equals 0 or 1), then Signature_or_MAC_3 is the 'signature' field of a COSE_Sign1 object, computed as specified in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc9052#section-4.4">Section 4.4</a> of [<a class="cite xref" href="#RFC9052">RFC9052</a>]</span> using the signature algorithm of the selected cipher suite, the private authentication key of the Initiator, and the following parameters as input (see <a class="auto internal xref" href="#COSE">Appendix C.3</a>):<a class="pilcrow" href="#section-5.4.2-2.3.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.4.2-2.3.2.1">protected =  &lt;&lt; ID_CRED_I &gt;&gt;<a class="pilcrow" href="#section-5.4.2-2.3.2.1">¶</a>
</li>
                <li class="normal" id="section-5.4.2-2.3.2.2">external_aad = &lt;&lt; TH_3, CRED_I, ? EAD_3 &gt;&gt;<a class="pilcrow" href="#section-5.4.2-2.3.2.2">¶</a>
</li>
                <li class="normal" id="section-5.4.2-2.3.2.3">payload = MAC_3<a class="pilcrow" href="#section-5.4.2-2.3.2.3">¶</a>
</li>
              </ul>
</li>
            <li class="normal" id="section-5.4.2-2.4">
              <p id="section-5.4.2-2.4.1">Compute a COSE_Encrypt0 object as defined in Sections <a class="relref" href="https://rfc-editor.org/rfc/rfc9052#section-5.2">5.2</a> and <a class="relref" href="https://rfc-editor.org/rfc/rfc9052#section-5.3">5.3</a> of <span>[<a class="cite xref" href="#RFC9052">RFC9052</a>]</span>, with the EDHOC AEAD algorithm of the selected cipher suite, using the encryption key K_3, the initialization vector IV_3 (if used by the AEAD algorithm), the plaintext PLAINTEXT_3, and the following parameters as input (see <a class="auto internal xref" href="#COSE">Appendix C.3</a>):<a class="pilcrow" href="#section-5.4.2-2.4.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.4.2-2.4.2.1">protected = h''<a class="pilcrow" href="#section-5.4.2-2.4.2.1">¶</a>
</li>
                <li class="normal" id="section-5.4.2-2.4.2.2">external_aad = TH_3<a class="pilcrow" href="#section-5.4.2-2.4.2.2">¶</a>
</li>
                <li class="normal" id="section-5.4.2-2.4.2.3">K_3 and IV_3 are defined in <a class="auto internal xref" href="#expand">Section 4.1.2</a><a class="pilcrow" href="#section-5.4.2-2.4.2.3">¶</a>
</li>
                <li class="normal" id="section-5.4.2-2.4.2.4">
                  <p id="section-5.4.2-2.4.2.4.1">PLAINTEXT_3 = ( ID_CRED_I / bstr / -24..23, Signature_or_MAC_3, ? EAD_3 )<a class="pilcrow" href="#section-5.4.2-2.4.2.4.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.4.2-2.4.2.4.2.1">If ID_CRED_I contains a single 'kid' parameter, i.e., ID_CRED_I = { 4 : kid_I }, then the compact encoding is applied; see <a class="auto internal xref" href="#compact-kid">Section 3.5.3.2</a>.<a class="pilcrow" href="#section-5.4.2-2.4.2.4.2.1">¶</a>
</li>
                  </ul>
</li>
              </ul>
<p id="section-5.4.2-2.4.3">
CIPHERTEXT_3 is the 'ciphertext' of COSE_Encrypt0.<a class="pilcrow" href="#section-5.4.2-2.4.3">¶</a></p>
</li>
            <li class="normal" id="section-5.4.2-2.5">Compute the transcript hash TH_4 = H(TH_3, PLAINTEXT_3, CRED_I), where H() is the EDHOC hash algorithm of the selected cipher suite. The input to the hash function is a CBOR Sequence.<a class="pilcrow" href="#section-5.4.2-2.5">¶</a>
</li>
            <li class="normal" id="section-5.4.2-2.6">Calculate PRK_out as defined in <a class="auto internal xref" href="#fig-edhoc-kdf">Figure 6</a>. The Initiator can now derive application keys using the EDHOC_Exporter interface; see <a class="auto internal xref" href="#exporter">Section 4.2.1</a>.<a class="pilcrow" href="#section-5.4.2-2.6">¶</a>
</li>
            <li class="normal" id="section-5.4.2-2.7">Encode message_3 as a CBOR data item as specified in <a class="auto internal xref" href="#asym-msg3-form">Section 5.4.1</a>.<a class="pilcrow" href="#section-5.4.2-2.7">¶</a>
</li>
            <li class="normal" id="section-5.4.2-2.8">Make the connection identifiers (C_I and C_R) and the application algorithms in the selected cipher suite available to the application.<a class="pilcrow" href="#section-5.4.2-2.8">¶</a>
</li>
          </ul>
<p id="section-5.4.2-3">After creating message_3, the Initiator can compute PRK_out (see <a class="auto internal xref" href="#prkout">Section 4.1.3</a>) and derive application keys using the EDHOC_Exporter interface (see <a class="auto internal xref" href="#exporter">Section 4.2.1</a>). The Initiator <span class="bcp14">SHOULD NOT</span> persistently store PRK_out or application keys until the Initiator has verified message_4 or a message protected with a derived application key, such as an OSCORE message, from the Responder and the application has authenticated the Responder. This is similar to waiting for an acknowledgment (ACK) in a transport protocol. The Initiator <span class="bcp14">SHOULD NOT</span> send protected application data until the application has authenticated the Responder.<a class="pilcrow" href="#section-5.4.2-3">¶</a></p>
</section>
</div>
<div id="responder-processing-of-message-3">
<section id="section-5.4.3">
          <h4 id="name-responder-processing-of-mess">
<a class="section-number selfRef" href="#section-5.4.3">5.4.3. </a><a class="section-name selfRef" href="#name-responder-processing-of-mess">Responder Processing of Message 3</a>
          </h4>
<p id="section-5.4.3-1">The Responder <span class="bcp14">SHALL</span> process message_3 in the following order:<a class="pilcrow" href="#section-5.4.3-1">¶</a></p>
<ol class="normal type-1" id="section-5.4.3-2" start="1" type="1">
            <li id="section-5.4.3-2.1">Decode message_3 (see <a class="auto internal xref" href="#CBOR">Appendix C.1</a>).<a class="pilcrow" href="#section-5.4.3-2.1">¶</a>
</li>
            <li id="section-5.4.3-2.2">Retrieve the protocol state using available message correlation (e.g., the CoAP Token, the 5-tuple, or the prepended C_R; see <a class="auto internal xref" href="#ci-edhoc">Section 3.4.1</a>).<a class="pilcrow" href="#section-5.4.3-2.2">¶</a>
</li>
            <li id="section-5.4.3-2.3">Decrypt and verify the COSE_Encrypt0 as defined in Sections <a class="relref" href="https://rfc-editor.org/rfc/rfc9052#section-5.2">5.2</a> and <a class="relref" href="https://rfc-editor.org/rfc/rfc9052#section-5.3">5.3</a> of <span>[<a class="cite xref" href="#RFC9052">RFC9052</a>]</span>, with the EDHOC AEAD algorithm in the selected cipher suite and the parameters defined in <a class="auto internal xref" href="#asym-msg3-proc">Section 5.4.2</a>.<a class="pilcrow" href="#section-5.4.3-2.3">¶</a>
</li>
            <li id="section-5.4.3-2.4">If all processing completed successfully, then make ID_CRED_I and (if present) EAD_3 available to the application for authentication and EAD processing. When and how to perform authentication is up to the application.<a class="pilcrow" href="#section-5.4.3-2.4">¶</a>
</li>
            <li id="section-5.4.3-2.5">Obtain the authentication credential (CRED_I) and the authentication key of I from the application (or by other means).<a class="pilcrow" href="#section-5.4.3-2.5">¶</a>
</li>
            <li id="section-5.4.3-2.6">Verify Signature_or_MAC_3 using the algorithm in the selected cipher suite. The verification process depends on the method; see <a class="auto internal xref" href="#asym-msg3-proc">Section 5.4.2</a>. Make the result of the verification available to the application.<a class="pilcrow" href="#section-5.4.3-2.6">¶</a>
</li>
            <li id="section-5.4.3-2.7">Make the connection identifiers (C_I and C_R) and the application algorithms in the selected cipher suite available to the application.<a class="pilcrow" href="#section-5.4.3-2.7">¶</a>
</li>
          </ol>
<p id="section-5.4.3-3">After processing message_3, the Responder can compute PRK_out (see <a class="auto internal xref" href="#prkout">Section 4.1.3</a>) and derive application keys using the EDHOC_Exporter interface (see <a class="auto internal xref" href="#exporter">Section 4.2.1</a>). The Responder <span class="bcp14">SHOULD NOT</span> persistently store PRK_out or application keys until the application has authenticated the Initiator. The Responder <span class="bcp14">SHOULD NOT</span> send protected application data until the application has authenticated the Initiator.<a class="pilcrow" href="#section-5.4.3-3">¶</a></p>
<p id="section-5.4.3-4">If any processing step fails, then the Responder <span class="bcp14">MUST</span> send an EDHOC error message back as defined in <a class="auto internal xref" href="#error">Section 6</a>, and the EDHOC session <span class="bcp14">MUST</span> be aborted.<a class="pilcrow" href="#section-5.4.3-4">¶</a></p>
</section>
</div>
</section>
</div>
<div id="m4">
<section id="section-5.5">
        <h3 id="name-edhoc-message-4">
<a class="section-number selfRef" href="#section-5.5">5.5. </a><a class="section-name selfRef" href="#name-edhoc-message-4">EDHOC Message 4</a>
        </h3>
<p id="section-5.5-1">This section specifies message_4, which is <span class="bcp14">OPTIONAL</span> to support. Key confirmation is normally provided by sending an application message from the Responder to the Initiator protected with a key derived with the EDHOC_Exporter, e.g., using OSCORE (see <a class="auto internal xref" href="#transfer">Appendix A</a>). In deployments where no protected application message is sent from the Responder to the Initiator, message_4 <span class="bcp14">MUST</span> be supported and <span class="bcp14">MUST</span> be used. Two examples of such deployments are:<a class="pilcrow" href="#section-5.5-1">¶</a></p>
<ol class="normal type-1" id="section-5.5-2" start="1" type="1">
<li id="section-5.5-2.1">when EDHOC is only used for authentication and no application data is sent and<a class="pilcrow" href="#section-5.5-2.1">¶</a>
</li>
          <li id="section-5.5-2.2">when application data is only sent from the Initiator to the Responder.<a class="pilcrow" href="#section-5.5-2.2">¶</a>
</li>
        </ol>
<p id="section-5.5-3">Further considerations about when to use message_4 are provided in Sections <a class="auto internal xref" href="#applicability">3.9</a> and <a class="auto internal xref" href="#sec-prop">9.1</a>.<a class="pilcrow" href="#section-5.5-3">¶</a></p>
<div id="asym-msg4-form">
<section id="section-5.5.1">
          <h4 id="name-formatting-of-message-4">
<a class="section-number selfRef" href="#section-5.5.1">5.5.1. </a><a class="section-name selfRef" href="#name-formatting-of-message-4">Formatting of Message 4</a>
          </h4>
<p id="section-5.5.1-1">message_4 <span class="bcp14">SHALL</span> be a CBOR Sequence (see <a class="auto internal xref" href="#CBOR">Appendix C.1</a>), as defined below.<a class="pilcrow" href="#section-5.5.1-1">¶</a></p>
<div class="lang-cbor sourcecode" id="section-5.5.1-2">
<pre>message_4 = (
  CIPHERTEXT_4 : bstr,

)
</pre><a class="pilcrow" href="#section-5.5.1-2">¶</a>
</div>
</section>
</div>
<div id="asym-msg4-proc">
<section id="section-5.5.2">
          <h4 id="name-responder-composition-of-mes">
<a class="section-number selfRef" href="#section-5.5.2">5.5.2. </a><a class="section-name selfRef" href="#name-responder-composition-of-mes">Responder Composition of Message 4</a>
          </h4>
<p id="section-5.5.2-1">The Responder <span class="bcp14">SHALL</span> compose message_4 as follows:<a class="pilcrow" href="#section-5.5.2-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.5.2-2.1">
              <p id="section-5.5.2-2.1.1">Compute a COSE_Encrypt0 as defined in Sections <a class="relref" href="https://rfc-editor.org/rfc/rfc9052#section-5.2">5.2</a> and <a class="relref" href="https://rfc-editor.org/rfc/rfc9052#section-5.3">5.3</a> of <span>[<a class="cite xref" href="#RFC9052">RFC9052</a>]</span>, with the EDHOC AEAD algorithm of the selected cipher suite, using the encryption key K_4, the initialization vector IV_4 (if used by the AEAD algorithm), the plaintext PLAINTEXT_4, and the following parameters as input (see <a class="auto internal xref" href="#COSE">Appendix C.3</a>):<a class="pilcrow" href="#section-5.5.2-2.1.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.5.2-2.1.2.1">protected = h''<a class="pilcrow" href="#section-5.5.2-2.1.2.1">¶</a>
</li>
                <li class="normal" id="section-5.5.2-2.1.2.2">external_aad = TH_4<a class="pilcrow" href="#section-5.5.2-2.1.2.2">¶</a>
</li>
                <li class="normal" id="section-5.5.2-2.1.2.3">K_4 and IV_4 are defined in <a class="auto internal xref" href="#expand">Section 4.1.2</a><a class="pilcrow" href="#section-5.5.2-2.1.2.3">¶</a>
</li>
                <li class="normal" id="section-5.5.2-2.1.2.4">
                  <p id="section-5.5.2-2.1.2.4.1">PLAINTEXT_4 = ( ? EAD_4 )<a class="pilcrow" href="#section-5.5.2-2.1.2.4.1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.5.2-2.1.2.4.2.1">EAD_4 is external authorization data; see <a class="auto internal xref" href="#AD">Section 3.8</a>.<a class="pilcrow" href="#section-5.5.2-2.1.2.4.2.1">¶</a>
</li>
                  </ul>
</li>
              </ul>
<p id="section-5.5.2-2.1.3">
CIPHERTEXT_4 is the 'ciphertext' of COSE_Encrypt0.<a class="pilcrow" href="#section-5.5.2-2.1.3">¶</a></p>
</li>
            <li class="normal" id="section-5.5.2-2.2">Encode message_4 as a CBOR data item as specified in <a class="auto internal xref" href="#asym-msg4-form">Section 5.5.1</a>.<a class="pilcrow" href="#section-5.5.2-2.2">¶</a>
</li>
          </ul>
</section>
</div>
<div id="initiator-processing-of-message-4">
<section id="section-5.5.3">
          <h4 id="name-initiator-processing-of-mess">
<a class="section-number selfRef" href="#section-5.5.3">5.5.3. </a><a class="section-name selfRef" href="#name-initiator-processing-of-mess">Initiator Processing of Message 4</a>
          </h4>
<p id="section-5.5.3-1">The Initiator <span class="bcp14">SHALL</span> process message_4 as follows:<a class="pilcrow" href="#section-5.5.3-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.5.3-2.1">Decode message_4 (see <a class="auto internal xref" href="#CBOR">Appendix C.1</a>).<a class="pilcrow" href="#section-5.5.3-2.1">¶</a>
</li>
            <li class="normal" id="section-5.5.3-2.2">Retrieve the protocol state using available message correlation (e.g., the CoAP Token, the 5-tuple, or the prepended C_I; see <a class="auto internal xref" href="#ci-edhoc">Section 3.4.1</a>).<a class="pilcrow" href="#section-5.5.3-2.2">¶</a>
</li>
            <li class="normal" id="section-5.5.3-2.3">Decrypt and verify the COSE_Encrypt0 as defined in Sections <a class="relref" href="https://rfc-editor.org/rfc/rfc9052#section-5.2">5.2</a> and <a class="relref" href="https://rfc-editor.org/rfc/rfc9052#section-5.3">5.3</a> of <span>[<a class="cite xref" href="#RFC9052">RFC9052</a>]</span>, with the EDHOC AEAD algorithm in the selected cipher suite and the parameters defined in <a class="auto internal xref" href="#asym-msg4-proc">Section 5.5.2</a>.<a class="pilcrow" href="#section-5.5.3-2.3">¶</a>
</li>
            <li class="normal" id="section-5.5.3-2.4">Make (if present) EAD_4 available to the application for EAD processing.<a class="pilcrow" href="#section-5.5.3-2.4">¶</a>
</li>
          </ul>
<p id="section-5.5.3-3">If any processing step fails, then the Initiator <span class="bcp14">MUST</span> send an EDHOC error message back as defined in <a class="auto internal xref" href="#error">Section 6</a>, and the EDHOC session <span class="bcp14">MUST</span> be aborted.<a class="pilcrow" href="#section-5.5.3-3">¶</a></p>
<p id="section-5.5.3-4">After verifying message_4, the Initiator is assured that the Responder has calculated the key PRK_out (key confirmation) and that no other party can derive the key.<a class="pilcrow" href="#section-5.5.3-4">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="error">
<section id="section-6">
      <h2 id="name-error-handling">
<a class="section-number selfRef" href="#section-6">6. </a><a class="section-name selfRef" href="#name-error-handling">Error Handling</a>
      </h2>
<p id="section-6-1">This section defines the format for error messages and the processing associated with the currently defined error codes. Additional error codes may be registered; see <a class="auto internal xref" href="#error-code-reg">Section 10.4</a>.<a class="pilcrow" href="#section-6-1">¶</a></p>
<p id="section-6-2">Many kinds of errors can occur during EDHOC processing. As in CoAP, an error can be triggered by errors in the received message or internal errors in the receiving endpoint. Except for processing and formatting errors, it is up to the application when to send an error message. Sending error messages is essential for debugging but <span class="bcp14">MAY</span> be skipped if, for example, an EDHOC session cannot be found or due to denial-of-service reasons; see <a class="auto internal xref" href="#dos">Section 9.7</a>. Error messages in EDHOC are always fatal. After sending an error message, the sender <span class="bcp14">MUST</span> abort the EDHOC session. The receiver <span class="bcp14">SHOULD</span> treat an error message as an indication that the other party likely has aborted the EDHOC session.  But since error messages might be forged, the receiver <span class="bcp14">MAY</span> try to continue the EDHOC session.<a class="pilcrow" href="#section-6-2">¶</a></p>
<p id="section-6-3">An EDHOC error message can be sent by either endpoint as a reply to any non-error EDHOC message. How errors at the EDHOC layer are transported depends on lower layers, which need to enable error messages to be sent and processed as intended.<a class="pilcrow" href="#section-6-3">¶</a></p>
<p id="section-6-4">error <span class="bcp14">SHALL</span> be a CBOR Sequence (see <a class="auto internal xref" href="#CBOR">Appendix C.1</a>), as defined below.<a class="pilcrow" href="#section-6-4">¶</a></p>
<span id="name-edhoc-error-message"></span><div id="fig-error-message">
<figure id="figure-7">
        <div class="lang-cbor sourcecode" id="section-6-5.1">
<pre>error = (
  ERR_CODE : int,
  ERR_INFO : any,
)
</pre>
</div>
<figcaption><a class="selfRef" href="#figure-7">Figure 7</a>:
<a class="selfRef" href="#name-edhoc-error-message">EDHOC Error Message</a>
        </figcaption></figure>
</div>
<p id="section-6-6">where:<a class="pilcrow" href="#section-6-6">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-7.1">ERR_CODE is an error code encoded as an integer. The value 0 is reserved for success and can only be used internally; all other values (negative or positive) indicate errors.<a class="pilcrow" href="#section-6-7.1">¶</a>
</li>
        <li class="normal" id="section-6-7.2">ERR_INFO is error information. Content and encoding depend on the error code.<a class="pilcrow" href="#section-6-7.2">¶</a>
</li>
      </ul>
<p id="section-6-8">The remainder of this section specifies the currently defined error codes; see <a class="auto internal xref" href="#tab-error-codes">Table 3</a>. Additional error codes and corresponding error information may be specified.<a class="pilcrow" href="#section-6-8">¶</a></p>
<span id="name-edhoc-error-codes-and-error"></span><div id="tab-error-codes">
<table class="center" id="table-3">
        <caption>
<a class="selfRef" href="#table-3">Table 3</a>:
<a class="selfRef" href="#name-edhoc-error-codes-and-error">EDHOC Error Codes and Error Information</a>
        </caption>
<thead>
          <tr>
            <th class="text-left" colspan="1" rowspan="1">ERR_CODE</th>
            <th class="text-left" colspan="1" rowspan="1">ERR_INFO Type</th>
            <th class="text-left" colspan="1" rowspan="1">Description</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-right" colspan="1" rowspan="1">0</td>
            <td class="text-left" colspan="1" rowspan="1"></td>
            <td class="text-left" colspan="1" rowspan="1">Reserved for success</td>
          </tr>
          <tr>
            <td class="text-right" colspan="1" rowspan="1">1</td>
            <td class="text-left" colspan="1" rowspan="1">tstr</td>
            <td class="text-left" colspan="1" rowspan="1">Unspecified error</td>
          </tr>
          <tr>
            <td class="text-right" colspan="1" rowspan="1">2</td>
            <td class="text-left" colspan="1" rowspan="1">suites</td>
            <td class="text-left" colspan="1" rowspan="1">Wrong selected cipher suite</td>
          </tr>
          <tr>
            <td class="text-right" colspan="1" rowspan="1">3</td>
            <td class="text-left" colspan="1" rowspan="1">true</td>
            <td class="text-left" colspan="1" rowspan="1">Unknown credential referenced</td>
          </tr>
          <tr>
            <td class="text-right" colspan="1" rowspan="1">23</td>
            <td class="text-left" colspan="1" rowspan="1"></td>
            <td class="text-left" colspan="1" rowspan="1">Reserved</td>
          </tr>
        </tbody>
      </table>
</div>
<div id="success">
<section id="section-6.1">
        <h3 id="name-success">
<a class="section-number selfRef" href="#section-6.1">6.1. </a><a class="section-name selfRef" href="#name-success">Success</a>
        </h3>
<p id="section-6.1-1">Error code 0 <span class="bcp14">MAY</span> be used internally in an application to indicate success, i.e., as a standard value in case of no error, e.g., in status reporting or log files. Error code 0 <span class="bcp14">MUST NOT</span> be used as part of the EDHOC message exchange. If an endpoint receives an error message with error code 0, then it <span class="bcp14">MUST</span> abort the EDHOC session and <span class="bcp14">MUST NOT</span> send an error message.<a class="pilcrow" href="#section-6.1-1">¶</a></p>
</section>
</div>
<div id="unspecified-error">
<section id="section-6.2">
        <h3 id="name-unspecified-error">
<a class="section-number selfRef" href="#section-6.2">6.2. </a><a class="section-name selfRef" href="#name-unspecified-error">Unspecified Error</a>
        </h3>
<p id="section-6.2-1">Error code 1 is used for errors that do not have a specific error code defined. ERR_INFO <span class="bcp14">MUST</span> be a text string containing a human-readable diagnostic message that <span class="bcp14">SHOULD</span> be written in English, for example, "Method not supported". The diagnostic text message is mainly intended for software engineers who during debugging need to interpret it in the context of the EDHOC specification. The diagnostic message <span class="bcp14">SHOULD</span> be provided to the calling application where it <span class="bcp14">SHOULD</span> be logged.<a class="pilcrow" href="#section-6.2-1">¶</a></p>
</section>
</div>
<div id="wrong-selected">
<section id="section-6.3">
        <h3 id="name-wrong-selected-cipher-suite">
<a class="section-number selfRef" href="#section-6.3">6.3. </a><a class="section-name selfRef" href="#name-wrong-selected-cipher-suite">Wrong Selected Cipher Suite</a>
        </h3>
<p id="section-6.3-1">Error code 2 <span class="bcp14">MUST</span> only be used when replying to message_1 in case the cipher suite selected by the Initiator is not supported by the Responder or if the Responder supports a cipher suite more preferred by the Initiator than the selected cipher suite; see <a class="auto internal xref" href="#resp-proc-msg1">Section 5.2.3</a>. In this case, ERR_INFO = SUITES_R and is of type suites; see <a class="auto internal xref" href="#asym-msg1-form">Section 5.2.1</a>. If the Responder does not support the selected cipher suite, then SUITES_R <span class="bcp14">MUST</span> include one or more supported cipher suites. If the Responder supports a cipher suite in SUITES_I other than the selected cipher suite (independently of if the selected cipher suite is supported or not), then SUITES_R <span class="bcp14">MUST</span> include the supported cipher suite in SUITES_I, which is most preferred by the Initiator. SUITES_R <span class="bcp14">MAY</span> include a single cipher suite; in which case, it is encoded as an int. If the Responder does not support any cipher suite in SUITES_I, then it <span class="bcp14">SHOULD</span> include all its supported cipher suites in SUITES_R.<a class="pilcrow" href="#section-6.3-1">¶</a></p>
<p id="section-6.3-2">In contrast to SUITES_I, the order of the cipher suites in SUITES_R has no significance.<a class="pilcrow" href="#section-6.3-2">¶</a></p>
<div id="cipher-suite-negotiation">
<section id="section-6.3.1">
          <h4 id="name-cipher-suite-negotiation">
<a class="section-number selfRef" href="#section-6.3.1">6.3.1. </a><a class="section-name selfRef" href="#name-cipher-suite-negotiation">Cipher Suite Negotiation</a>
          </h4>
<p id="section-6.3.1-1">After receiving SUITES_R, the Initiator can determine which cipher suite to select (if any) for the next EDHOC run with the Responder. The Initiator <span class="bcp14">SHOULD</span> remember which selected cipher suite to use until the next message_1 has been sent; otherwise, the Initiator and Responder will run into an infinite loop where the Initiator selects its most preferred cipher suite and the Responder sends an error with supported cipher suites.<a class="pilcrow" href="#section-6.3.1-1">¶</a></p>
<p id="section-6.3.1-2">After a completed EDHOC session, the Initiator <span class="bcp14">MAY</span> remember the selected cipher suite to use in future EDHOC sessions with this Responder. Note that if the Initiator or Responder is updated with new cipher suite policies, any cached information may be outdated.<a class="pilcrow" href="#section-6.3.1-2">¶</a></p>
<p id="section-6.3.1-3">Note that the Initiator's list of supported cipher suites and order of preference is fixed (see Sections <a class="auto internal xref" href="#asym-msg1-form">5.2.1</a> and <a class="auto internal xref" href="#init-proc-msg1">5.2.2</a>). Furthermore, the Responder <span class="bcp14">SHALL</span> only accept message_1 if the selected cipher suite is the first cipher suite in SUITES_I that the Responder also supports (see <a class="auto internal xref" href="#resp-proc-msg1">Section 5.2.3</a>). Following this procedure ensures that the selected cipher suite is the most preferred (by the Initiator) cipher suite supported by both parties. For examples, see <a class="auto internal xref" href="#ex-neg">Section 6.3.2</a>.<a class="pilcrow" href="#section-6.3.1-3">¶</a></p>
<p id="section-6.3.1-4">If the selected cipher suite is not the first cipher suite that the Responder supports in SUITES_I received in message_1, then the Responder <span class="bcp14">MUST</span> abort the EDHOC session; see <a class="auto internal xref" href="#resp-proc-msg1">Section 5.2.3</a>. If SUITES_I in message_1 is manipulated, then the integrity verification of message_2 containing the transcript hash TH_2 will fail and the Initiator will abort the EDHOC session.<a class="pilcrow" href="#section-6.3.1-4">¶</a></p>
</section>
</div>
<div id="ex-neg">
<section id="section-6.3.2">
          <h4 id="name-examples">
<a class="section-number selfRef" href="#section-6.3.2">6.3.2. </a><a class="section-name selfRef" href="#name-examples">Examples</a>
          </h4>
<p id="section-6.3.2-1">Assume that the Initiator supports the five cipher suites, 5, 6, 7, 8, and 9, in decreasing order of preference. Figures <a class="auto internal xref" href="#fig-error1">8</a> and <a class="auto internal xref" href="#fig-error2">9</a> show two examples of how the Initiator can format SUITES_I and how SUITES_R is used by Responders to give the Initiator information about the cipher suites that the Responder supports.<a class="pilcrow" href="#section-6.3.2-1">¶</a></p>
<p id="section-6.3.2-2">In Example 1 (<a class="auto internal xref" href="#fig-error1">Figure 8</a>), the Responder supports cipher suite 6 but not the initially selected cipher suite 5. The Responder rejects the first message_1 with an error indicating support for suite 6 in SUITES_R. The Initiator also supports suite 6 and therefore selects suite 6 in the second message_1. The Initiator prepends in SUITES_I the selected suite 6 with the more preferred suites, in this case suite 5, to mitigate a potential attack on the cipher suite negotiation.<a class="pilcrow" href="#section-6.3.2-2">¶</a></p>
<span id="name-cipher-suite-negotiation-ex"></span><div id="fig-error1">
<figure id="figure-8">
            <div id="section-6.3.2-3.1">
              <div class="alignCenter art-svg artwork" id="section-6.3.2-3.1.1">
<svg class="diagram" font-family="monospace" font-size="13px" stroke-linecap="round" text-anchor="middle" version="1.1" viewBox="0 0 560 224" xmlns="http://www.w3.org/2000/svg">
                  <path d="M 8,48 L 8,208" fill="none" stroke="black"></path>
                  <path d="M 552,48 L 552,208" fill="none" stroke="black"></path>
                  <path d="M 8,64 L 544,64" fill="none" stroke="black"></path>
                  <path d="M 16,128 L 552,128" fill="none" stroke="black"></path>
                  <path d="M 8,192 L 544,192" fill="none" stroke="black"></path>
                  <polygon class="arrowhead" fill="black" points="552,192 540,186.4 540,197.6" transform="rotate(0,544,192)"></polygon>
                  <polygon class="arrowhead" fill="black" points="552,64 540,58.4 540,69.6" transform="rotate(0,544,64)"></polygon>
                  <polygon class="arrowhead" fill="black" points="24,128 12,122.4 12,133.6" transform="rotate(180,16,128)"></polygon>
                  <g class="text">
                    <text x="40" y="36">Initiator</text>
                    <text x="520" y="36">Responder</text>
                    <text x="152" y="52">METHOD,</text>
                    <text x="220" y="52">SUITES_I</text>
                    <text x="264" y="52">=</text>
                    <text x="284" y="52">5,</text>
                    <text x="316" y="52">G_X,</text>
                    <text x="356" y="52">C_I,</text>
                    <text x="400" y="52">EAD_1</text>
                    <text x="280" y="84">message_1</text>
                    <text x="196" y="116">ERR_CODE</text>
                    <text x="240" y="116">=</text>
                    <text x="260" y="116">2,</text>
                    <text x="308" y="116">SUITES_R</text>
                    <text x="352" y="116">=</text>
                    <text x="368" y="116">6</text>
                    <text x="280" y="148">error</text>
                    <text x="144" y="180">METHOD,</text>
                    <text x="212" y="180">SUITES_I</text>
                    <text x="256" y="180">=</text>
                    <text x="280" y="180">[5,</text>
                    <text x="312" y="180">6],</text>
                    <text x="348" y="180">G_X,</text>
                    <text x="388" y="180">C_I,</text>
                    <text x="432" y="180">EAD_1</text>
                    <text x="280" y="212">message_1</text>
                  </g>
                </svg><a class="pilcrow" href="#section-6.3.2-3.1.1">¶</a>
</div>
</div>
<figcaption><a class="selfRef" href="#figure-8">Figure 8</a>:
<a class="selfRef" href="#name-cipher-suite-negotiation-ex">Cipher Suite Negotiation Example 1</a>
            </figcaption></figure>
</div>
<p id="section-6.3.2-4">In Example 2 (<a class="auto internal xref" href="#fig-error2">Figure 9</a>), the Responder supports cipher suites 8 and 9 but not the more preferred (by the Initiator) cipher suites 5, 6 or 7. To illustrate the negotiation mechanics, we let the Initiator first make a guess that the Responder supports suite 6 but not suite 5. Since the Responder supports neither 5 nor 6, it rejects the first message_1 with an error indicating support for suites 8 and 9 in SUITES_R (in any order). The Initiator also supports suites 8 and 9, and prefers suite 8, so it  selects suite 8 in the second message_1. The Initiator prepends in SUITES_I the selected suite 8 with the more preferred suites in order of preference, in this case, suites 5, 6 and 7, to mitigate a potential attack on the cipher suite negotiation.<a class="pilcrow" href="#section-6.3.2-4">¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-6.3.2-5">
          <dt>Note 1.</dt>
<dd id="section-6.3.2-5.1">If the Responder had supported suite 5, then the first message_1 would not have been accepted either, since the Responder observes that suite 5 is more preferred by the Initiator than the selected suite 6. In that case, the Responder would have included suite 5 in SUITES_R of the response, and it would then have become the selected and only suite in the second message_1.<a class="pilcrow" href="#section-6.3.2-5.1">¶</a>
</dd>
            <dd class="break"></dd>
<dt>Note 2.</dt>
<dd id="section-6.3.2-5.2">For each message_1, the Initiator <span class="bcp14">MUST</span> generate a new ephemeral ECDH key pair matching the selected cipher suite.<a class="pilcrow" href="#section-6.3.2-5.2">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<span id="name-cipher-suite-negotiation-exa"></span><div id="fig-error2">
<figure id="figure-9">
            <div id="section-6.3.2-6.1">
              <div class="alignCenter art-svg artwork" id="section-6.3.2-6.1.1">
<svg class="diagram" font-family="monospace" font-size="13px" stroke-linecap="round" text-anchor="middle" version="1.1" viewBox="0 0 560 224" xmlns="http://www.w3.org/2000/svg">
                  <path d="M 8,48 L 8,208" fill="none" stroke="black"></path>
                  <path d="M 552,48 L 552,208" fill="none" stroke="black"></path>
                  <path d="M 8,64 L 544,64" fill="none" stroke="black"></path>
                  <path d="M 16,128 L 552,128" fill="none" stroke="black"></path>
                  <path d="M 8,192 L 544,192" fill="none" stroke="black"></path>
                  <polygon class="arrowhead" fill="black" points="552,192 540,186.4 540,197.6" transform="rotate(0,544,192)"></polygon>
                  <polygon class="arrowhead" fill="black" points="552,64 540,58.4 540,69.6" transform="rotate(0,544,64)"></polygon>
                  <polygon class="arrowhead" fill="black" points="24,128 12,122.4 12,133.6" transform="rotate(180,16,128)"></polygon>
                  <g class="text">
                    <text x="40" y="36">Initiator</text>
                    <text x="520" y="36">Responder</text>
                    <text x="136" y="52">METHOD,</text>
                    <text x="204" y="52">SUITES_I</text>
                    <text x="248" y="52">=</text>
                    <text x="272" y="52">[5,</text>
                    <text x="304" y="52">6],</text>
                    <text x="340" y="52">G_X,</text>
                    <text x="380" y="52">C_I,</text>
                    <text x="424" y="52">EAD_1</text>
                    <text x="280" y="84">message_1</text>
                    <text x="188" y="116">ERR_CODE</text>
                    <text x="232" y="116">=</text>
                    <text x="252" y="116">2,</text>
                    <text x="300" y="116">SUITES_R</text>
                    <text x="344" y="116">=</text>
                    <text x="368" y="116">[9,</text>
                    <text x="396" y="116">8]</text>
                    <text x="280" y="148">error</text>
                    <text x="128" y="180">METHOD,</text>
                    <text x="196" y="180">SUITES_I</text>
                    <text x="240" y="180">=</text>
                    <text x="264" y="180">[5,</text>
                    <text x="292" y="180">6,</text>
                    <text x="316" y="180">7,</text>
                    <text x="344" y="180">8],</text>
                    <text x="380" y="180">G_X,</text>
                    <text x="420" y="180">C_I,</text>
                    <text x="464" y="180">EAD_1</text>
                    <text x="280" y="212">message_1</text>
                  </g>
                </svg><a class="pilcrow" href="#section-6.3.2-6.1.1">¶</a>
</div>
</div>
<figcaption><a class="selfRef" href="#figure-9">Figure 9</a>:
<a class="selfRef" href="#name-cipher-suite-negotiation-exa">Cipher Suite Negotiation Example 2</a>
            </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="unknown-credential-referenced">
<section id="section-6.4">
        <h3 id="name-unknown-credential-referenc">
<a class="section-number selfRef" href="#section-6.4">6.4. </a><a class="section-name selfRef" href="#name-unknown-credential-referenc">Unknown Credential Referenced</a>
        </h3>
<p id="section-6.4-1">Error code 3 is used for errors due to a received credential identifier (ID_CRED_R in message_2 or ID_CRED_I message_3) containing a reference to a credential that the receiving endpoint does not have access to. The intent with this error code is that the endpoint who sent the credential identifier should, for the next EDHOC session, try another credential identifier supported according to the application profile.<a class="pilcrow" href="#section-6.4-1">¶</a></p>
<p id="section-6.4-2">For example, an application profile could list x5t and x5chain as supported credential identifiers and state that x5t should be used if it can be assumed that the X.509 certificate is available at the receiving side. This error code thus enables the certificate chain to be sent only when needed, bearing in mind that error messages are not protected so an adversary can try to cause unnecessary, large credential identifiers.<a class="pilcrow" href="#section-6.4-2">¶</a></p>
<p id="section-6.4-3">For the error code 3, the error information <span class="bcp14">SHALL</span> be the CBOR simple value <code>true</code> (0xf5). Error code 3 <span class="bcp14">MUST NOT</span> be used when the received credential identifier type is not supported.<a class="pilcrow" href="#section-6.4-3">¶</a></p>
</section>
</div>
</section>
</div>
<div id="duplication">
<section id="section-7">
      <h2 id="name-edhoc-message-deduplication">
<a class="section-number selfRef" href="#section-7">7. </a><a class="section-name selfRef" href="#name-edhoc-message-deduplication">EDHOC Message Deduplication</a>
      </h2>
<p id="section-7-1">By default, EDHOC assumes that message duplication is handled by the transport (which is exemplified by CoAP in this section); see <a class="auto internal xref" href="#coap">Appendix A.2</a>.<a class="pilcrow" href="#section-7-1">¶</a></p>
<p id="section-7-2">Deduplication of CoAP messages is described in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc7252#section-4.5">Section 4.5</a> of [<a class="cite xref" href="#RFC7252">RFC7252</a>]</span>. This handles the case when the same Confirmable (CON) message is received multiple times due to missing acknowledgment on the CoAP messaging layer. The recommended processing in <span>[<a class="cite xref" href="#RFC7252">RFC7252</a>]</span> is that the duplicate message is acknowledged, but the received message is only processed once by the CoAP stack.<a class="pilcrow" href="#section-7-2">¶</a></p>
<p id="section-7-3">Message deduplication is resource demanding and therefore not supported in all CoAP implementations. Since EDHOC is targeting constrained environments, it is desirable that EDHOC can optionally support transport layers that do not handle message duplication. Special care is needed to avoid issues with duplicate messages; see <a class="auto internal xref" href="#proc-outline">Section 5.1</a>.<a class="pilcrow" href="#section-7-3">¶</a></p>
<p id="section-7-4">The guiding principle here is similar to the deduplication processing on the CoAP messaging layer, i.e., a received duplicate EDHOC message <span class="bcp14">SHALL NOT</span> result in another instance of the next EDHOC message. The result <span class="bcp14">MAY</span> be that a duplicate next EDHOC message is sent, provided it is still relevant with respect to the current protocol state. In any case, the received message <span class="bcp14">MUST NOT</span> be processed more than once in the same EDHOC session. This is called "EDHOC message deduplication".<a class="pilcrow" href="#section-7-4">¶</a></p>
<p id="section-7-5">An EDHOC implementation <span class="bcp14">MAY</span> store the previously sent EDHOC message to be able to resend it.<a class="pilcrow" href="#section-7-5">¶</a></p>
<p id="section-7-6">In principle, if the EDHOC implementation would deterministically regenerate the identical EDHOC message previously sent, it would be possible to instead store the protocol state to be able to recreate and resend the previously sent EDHOC message. However, even if the protocol state is fixed, the message generation may introduce differences that compromise security. For example, in the generation of message_3, if I is performing a (non-deterministic) ECDSA signature (say, method 0 or 1 and cipher suite 2 or 3), then PLAINTEXT_3 is randomized, but K_3 and IV_3 are the same, leading to a key and nonce reuse.<a class="pilcrow" href="#section-7-6">¶</a></p>
<p id="section-7-7">The EDHOC implementation <span class="bcp14">MUST NOT</span> store the previous protocol state and regenerate an EDHOC message if there is a risk that the same key and IV are used for two (or more) distinct messages.<a class="pilcrow" href="#section-7-7">¶</a></p>
<p id="section-7-8">The previous message or protocol state <span class="bcp14">MUST NOT</span> be kept longer than what is required for retransmission, for example, in the case of CoAP transport, no longer than the EXCHANGE_LIFETIME (see <span><a class="relref" href="https://rfc-editor.org/rfc/rfc7252#section-4.8.2">Section 4.8.2</a> of [<a class="cite xref" href="#RFC7252">RFC7252</a>]</span>).<a class="pilcrow" href="#section-7-8">¶</a></p>
</section>
</div>
<div id="mti">
<section id="section-8">
      <h2 id="name-compliance-requirements">
<a class="section-number selfRef" href="#section-8">8. </a><a class="section-name selfRef" href="#name-compliance-requirements">Compliance Requirements</a>
      </h2>
<p id="section-8-1">In the absence of an application profile specifying otherwise:<a class="pilcrow" href="#section-8-1">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8-2.1">An implementation <span class="bcp14">MAY</span> support only an Initiator or only a Responder.<a class="pilcrow" href="#section-8-2.1">¶</a>
</li>
        <li class="normal" id="section-8-2.2">An implementation <span class="bcp14">MAY</span> support only a single method. None of the methods are mandatory to implement.<a class="pilcrow" href="#section-8-2.2">¶</a>
</li>
        <li class="normal" id="section-8-2.3">Implementations <span class="bcp14">MUST</span> support 'kid' parameters. None of the other COSE header parameters are mandatory to implement.<a class="pilcrow" href="#section-8-2.3">¶</a>
</li>
        <li class="normal" id="section-8-2.4">An implementation <span class="bcp14">MAY</span> support only a single credential type (CCS, CWT, X.509, or C509). None of the credential types are mandatory to implement.<a class="pilcrow" href="#section-8-2.4">¶</a>
</li>
        <li class="normal" id="section-8-2.5">Implementations <span class="bcp14">MUST</span> support the EDHOC_Exporter.<a class="pilcrow" href="#section-8-2.5">¶</a>
</li>
        <li class="normal" id="section-8-2.6">Implementations <span class="bcp14">MAY</span> support message_4. Error codes (ERR_CODE) 1 and 2 <span class="bcp14">MUST</span> be supported.<a class="pilcrow" href="#section-8-2.6">¶</a>
</li>
        <li class="normal" id="section-8-2.7">Implementations <span class="bcp14">MUST</span> support EAD.<a class="pilcrow" href="#section-8-2.7">¶</a>
</li>
        <li class="normal" id="section-8-2.8">Implementations <span class="bcp14">MUST</span> support cipher suites 2 and 3. Cipher suites 2 (AES-CCM-16-64-128, SHA-256, 8, P-256, ES256, AES-CCM-16-64-128, SHA-256) and 3 (AES-CCM-16-128-128, SHA-256, 16, P-256, ES256, AES-CCM-16-64-128, SHA-256) only differ in the size of the MAC length, so supporting one or both of these is not significantly different. Implementations only need to implement the algorithms needed for their supported methods.<a class="pilcrow" href="#section-8-2.8">¶</a>
</li>
      </ul>
</section>
</div>
<div id="security">
<section id="section-9">
      <h2 id="name-security-considerations">
<a class="section-number selfRef" href="#section-9">9. </a><a class="section-name selfRef" href="#name-security-considerations">Security Considerations</a>
      </h2>
<div id="sec-prop">
<section id="section-9.1">
        <h3 id="name-security-properties">
<a class="section-number selfRef" href="#section-9.1">9.1. </a><a class="section-name selfRef" href="#name-security-properties">Security Properties</a>
        </h3>
<p id="section-9.1-1">EDHOC has similar security properties as can be expected from the theoretical SIGMA-I protocol <span>[<a class="cite xref" href="#SIGMA">SIGMA</a>]</span> and the Noise XX pattern <span>[<a class="cite xref" href="#Noise">Noise</a>]</span>, which are similar to methods 0 and 3, respectively. Proven security properties are detailed in the security analysis publications referenced at the end of this section.<a class="pilcrow" href="#section-9.1-1">¶</a></p>
<p id="section-9.1-2">Using the terminology from <span>[<a class="cite xref" href="#SIGMA">SIGMA</a>]</span>, EDHOC provides forward secrecy, mutual authentication with aliveness, consistency, and peer awareness. As described in <span>[<a class="cite xref" href="#SIGMA">SIGMA</a>]</span>, message_3 provides peer awareness to the Responder, while message_4 provides peer awareness to the Initiator. By including the authentication credentials in the transcript hash, EDHOC protects against an identity misbinding attack like the Duplicate Signature Key Selection (DSKS) that the MAC-then-Sign variant of SIGMA-I is otherwise vulnerable to.<a class="pilcrow" href="#section-9.1-2">¶</a></p>
<p id="section-9.1-3">As described in <span>[<a class="cite xref" href="#SIGMA">SIGMA</a>]</span>, different levels of identity protection are provided to the Initiator and Responder. EDHOC provides identity protection of the Initiator against active attacks and identity protection of the Responder against passive attacks. An active attacker can get the credential identifier of the Responder by eavesdropping on the destination address used for transporting message_1 and then sending its own message_1 to the same address. The roles should be assigned to protect the most sensitive identity/identifier, typically that which is not possible to infer from routing information in the lower layers.<a class="pilcrow" href="#section-9.1-3">¶</a></p>
<p id="section-9.1-4">EDHOC messages might change in transit due to a noisy channel or through modification by an attacker. Changes in message_1 and message_2 (except Signature_or_MAC_2 when the signature scheme is not strongly unforgeable) are detected when verifying Signature_or_MAC_2. Changes to not strongly unforgeable Signature_or_MAC_2 and message_3 are detected when verifying CIPHERTEXT_3. Changes to message_4 are detected when verifying CIPHERTEXT_4.<a class="pilcrow" href="#section-9.1-4">¶</a></p>
<p id="section-9.1-5">Compared to <span>[<a class="cite xref" href="#SIGMA">SIGMA</a>]</span>, EDHOC adds an explicit method type and expands the message authentication coverage to additional elements such as algorithms, external authorization data, and previous plaintext messages. This protects against an attacker replaying messages or injecting messages from another EDHOC session.<a class="pilcrow" href="#section-9.1-5">¶</a></p>
<p id="section-9.1-6">EDHOC also adds the selection of connection identifiers and downgrade-protected negotiation of cryptographic parameters, i.e., an attacker cannot affect the negotiated parameters. A single session of EDHOC does not include negotiation of cipher suites, but it enables the Responder to verify that the selected cipher suite is the most preferred cipher suite by the Initiator that is supported by both the Initiator and Responder and to abort the EDHOC session if not.<a class="pilcrow" href="#section-9.1-6">¶</a></p>
<p id="section-9.1-7">As required by <span>[<a class="cite xref" href="#RFC7258">RFC7258</a>]</span>, IETF protocols need to mitigate pervasive monitoring when possible. Therefore, EDHOC only supports methods with ephemeral Diffie-Hellman and provides a key update function (see <a class="auto internal xref" href="#keyupdate">Appendix H</a>) for lightweight application protocol rekeying. Either of these provides forward secrecy, in the sense that compromise of the private authentication keys does not compromise past session keys (PRK_out) and compromise of a session key does not compromise past session keys. Frequently re-running EDHOC with ephemeral Diffie-Hellman forces attackers to perform dynamic key exfiltration where the attacker must have continuous interactions with the collaborator, which is a significant sustained attack.<a class="pilcrow" href="#section-9.1-7">¶</a></p>
<p id="section-9.1-8">To limit the effect of breaches, it is important to limit the use of symmetric group keys for bootstrapping. Therefore, EDHOC strives to make the additional cost of using raw public keys and self-signed certificates as small as possible. Raw public keys and self-signed certificates are not a replacement for a public key infrastructure but <span class="bcp14">SHOULD</span> be used instead of symmetric group keys for bootstrapping.<a class="pilcrow" href="#section-9.1-8">¶</a></p>
<p id="section-9.1-9">Compromise of the long-term keys (private signature or static DH keys) does not compromise the security of completed EDHOC sessions. Compromising the private authentication keys of one party lets an active attacker impersonate that compromised party in EDHOC sessions with other parties but does not let the attacker impersonate other parties in EDHOC sessions with the compromised party. Compromise of the long-term keys does not enable a passive attacker to compromise future session keys (PRK_out). Compromise of the HKDF input parameters (ECDH shared secret) leads to compromise of all session keys derived from that compromised shared secret. Compromise of one session key does not compromise other session keys. Compromise of PRK_out leads to compromise of all keying material derived with the EDHOC_Exporter.<a class="pilcrow" href="#section-9.1-9">¶</a></p>
<p id="section-9.1-10">Based on the cryptographic algorithm requirements (<a class="auto internal xref" href="#sec_algs">Section 9.3</a>), EDHOC provides a minimum of 64-bit security against online brute force attacks and a minimum of 128-bit security against offline brute force attacks. To break 64-bit security against online brute force, an attacker would on average have to send 4.3 billion messages per second for 68 years, which is infeasible in constrained IoT radio technologies. A forgery against a 64-bit MAC in EDHOC breaks the security of all future application data, while a forgery against a 64-bit MAC in the subsequent application protocol (e.g., OSCORE <span>[<a class="cite xref" href="#RFC8613">RFC8613</a>]</span>) typically only breaks the security of the data in the forged packet.<a class="pilcrow" href="#section-9.1-10">¶</a></p>
<p id="section-9.1-11">As the EDHOC session is aborted when verification fails, the security against online attacks is given by the sum of the strength of the verified signatures and MACs (including MAC in AEAD). As an example, if EDHOC is used with method 3, cipher suite 2, and message_4, the Responder is authenticated with 128-bit security against online attacks (the sum of the 64-bit MACs in message_2 and message_4). The same principle applies for MACs in an application protocol keyed by EDHOC as long as EDHOC is re-run when verification of the first MACs in the application protocol fails. As an example, if EDHOC with method 3 and cipher suite 2 is used as in Figure 2 of <span>[<a class="cite xref" href="#I-D.ietf-core-oscore-edhoc">EDHOC-CoAP-OSCORE</a>]</span>, 128-bit mutual authentication against online attacks can be achieved after completion of the first OSCORE request and response.<a class="pilcrow" href="#section-9.1-11">¶</a></p>
<p id="section-9.1-12">After sending message_3, the Initiator is assured that no other party than the Responder can compute the key PRK_out. While the Initiator can securely send protected application data, the Initiator <span class="bcp14">SHOULD NOT</span> persistently store the keying material PRK_out until the Initiator has verified message_4 or a message protected with a derived application key, such as an OSCORE message, from the Responder. After verifying message_3, the Responder is assured that an honest Initiator has computed the key PRK_out. The Responder can securely derive and store the keying material PRK_out and send protected application data.<a class="pilcrow" href="#section-9.1-12">¶</a></p>
<p id="section-9.1-13">External authorization data sent in message_1 (EAD_1) or message_2 (EAD_2) should be considered unprotected by EDHOC; see <a class="auto internal xref" href="#unprot-data">Section 9.5</a>. EAD_2 is encrypted, but the Responder has not yet authenticated the Initiator and the encryption does not provide confidentiality against active attacks.<a class="pilcrow" href="#section-9.1-13">¶</a></p>
<p id="section-9.1-14">External authorization data sent in message_3 (EAD_3) or message_4 (EAD_4) is protected between the Initiator and Responder by the protocol, but note that EAD fields may be used by the application before the message verification is completed; see <a class="auto internal xref" href="#AD">Section 3.8</a>. Designing a secure mechanism that uses EAD is not necessarily straightforward. This document only provides the EAD transport mechanism, but the problem of agreeing on the surrounding context and the meaning of the information passed to and from the application remains. Any new uses of EAD should be subject to careful review.<a class="pilcrow" href="#section-9.1-14">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-9.1-15">
          <dt id="section-9.1-15.1">Key Compromise Impersonation (KCI):</dt>
          <dd id="section-9.1-15.2" style="margin-left: 1.5em">In EDHOC authenticated with signature keys, EDHOC provides KCI protection against an attacker having access to the long-term key or the ephemeral secret key. With static Diffie-Hellman key authentication, KCI protection would be provided against an attacker having access to the long-term Diffie-Hellman key but not to an attacker having access to the ephemeral secret key. Note that the term KCI has typically been used for compromise of long-term keys and that an attacker with access to the ephemeral secret key can only attack that specific EDHOC session.<a class="pilcrow" href="#section-9.1-15.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-9.1-15.3">Repudiation:</dt>
          <dd id="section-9.1-15.4" style="margin-left: 1.5em">If an endpoint authenticates with a signature, the other endpoint can prove that the endpoint performed a run of the protocol by presenting the data being signed as well as the signature itself. With static Diffie-Hellman key authentication, the authenticating endpoint can deny having participated in the protocol.<a class="pilcrow" href="#section-9.1-15.4">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-9.1-16">Earlier versions of EDHOC have been formally analyzed <span>[<a class="cite xref" href="#Bruni18">Bruni18</a>]</span> <span>[<a class="cite xref" href="#Norrman20">Norrman20</a>]</span> <span>[<a class="cite xref" href="#CottierPointcheval22">CottierPointcheval22</a>]</span> <span>[<a class="cite xref" href="#Jacomme23">Jacomme23</a>]</span> <span>[<a class="cite xref" href="#GuentherIlunga22">GuentherIlunga22</a>]</span>, and the specification has been updated based on the analysis.<a class="pilcrow" href="#section-9.1-16">¶</a></p>
</section>
</div>
<div id="crypto">
<section id="section-9.2">
        <h3 id="name-cryptographic-consideration">
<a class="section-number selfRef" href="#section-9.2">9.2. </a><a class="section-name selfRef" href="#name-cryptographic-consideration">Cryptographic Considerations</a>
        </h3>
<p id="section-9.2-1">The SIGMA protocol requires that the encryption of message_3 provides confidentiality against active attackers and EDHOC message_4 relies on the use of
authenticated encryption. Hence, the message authenticating functionality of the authenticated encryption in EDHOC is critical, i.e., authenticated encryption <span class="bcp14">MUST NOT</span> be replaced by plain encryption only, even if authentication is provided at another level or through a different mechanism.<a class="pilcrow" href="#section-9.2-1">¶</a></p>
<p id="section-9.2-2">To reduce message overhead, EDHOC does not use explicit nonces and instead relies on the ephemeral public keys to provide randomness to each EDHOC session. A good amount of randomness is important for the key generation to provide liveness and to protect against interleaving attacks. For this reason, the ephemeral keys <span class="bcp14">MUST NOT</span> be used in more than one EDHOC message, and both parties <span class="bcp14">SHALL</span> generate fresh, random ephemeral key pairs. Note that an ephemeral key may be used to calculate several ECDH shared secrets. When static Diffie-Hellman authentication is used, the same ephemeral key is used in both ephemeral-ephemeral and ephemeral-static ECDH.<a class="pilcrow" href="#section-9.2-2">¶</a></p>
<p id="section-9.2-3">As discussed in <span>[<a class="cite xref" href="#SIGMA">SIGMA</a>]</span>, the encryption of message_2 only needs to protect against a passive attacker since active attackers can always get the Responder's identity by sending their own message_1. EDHOC uses the EDHOC_Expand function (typically HKDF-Expand) as a binary additive stream cipher that is proven secure as long as the expand function is a Pseudorandom Function (PRF). HKDF-Expand is not often used as a stream cipher as it is slow on long messages, and most applications require both confidentiality with indistinguishability under adaptive chosen ciphertext attack (IND-CCA2) as well as integrity protection. For the encryption of message_2, any speed difference is negligible, IND-CCA2 does not increase security, and integrity is provided by the inner MAC (and signature depending on method).<a class="pilcrow" href="#section-9.2-3">¶</a></p>
<p id="section-9.2-4">Requirements for how to securely generate, validate, and process the public keys depend on the elliptic curve. For X25519 and X448, the requirements are defined in <span>[<a class="cite xref" href="#RFC7748">RFC7748</a>]</span>. For X25519 and X448, the check for all-zero output as specified in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc7748#section-6">Section 6</a> of [<a class="cite xref" href="#RFC7748">RFC7748</a>]</span> <span class="bcp14">MUST</span> be done. For secp256r1, secp384r1, and secp521r1, the requirements are defined in Section 5 of <span>[<a class="cite xref" href="#SP-800-56A">SP-800-56A</a>]</span>. For secp256r1, secp384r1, and secp521r1, at least partial public key validation <span class="bcp14">MUST</span> be done.<a class="pilcrow" href="#section-9.2-4">¶</a></p>
<p id="section-9.2-5">The same authentication credential <span class="bcp14">MAY</span> be used for both the Initiator
   and Responder roles.  As noted in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc9052#section-12">Section 12</a> of [<a class="cite xref" href="#RFC9052">RFC9052</a>]</span>, the use of a single key for multiple algorithms is strongly discouraged unless proven secure by a dedicated cryptographic analysis.  In particular, this recommendation applies to using the same private key for static Diffie-Hellman authentication and digital signature authentication. A preliminary conjecture is that a minor change to EDHOC may be sufficient to fit the analysis of a secure shared signature and ECDH key usage in <span>[<a class="cite xref" href="#Degabriele11">Degabriele11</a>]</span> and <span>[<a class="cite xref" href="#Thormarker21">Thormarker21</a>]</span>. Note that Section 5.6.3.2 of <span>[<a class="cite xref" href="#SP-800-56A">SP-800-56A</a>]</span> allows a key agreement key pair to be used with a signature algorithm in certificate requests.<a class="pilcrow" href="#section-9.2-5">¶</a></p>
<p id="section-9.2-6">The property that a completed EDHOC session implies that another identity has been active is upheld as long as the Initiator does not have its own identity in the set of Responder identities it is allowed to communicate with. In trust-on-first-use (TOFU) use cases (see <a class="auto internal xref" href="#tofu">Appendix D.5</a>), the Initiator should verify that the Responder's identity is not equal to its own. Any future EDHOC methods using, e.g., PSKs might need to mitigate this in other ways. However, an active attacker can gain information about the set of identities an Initiator is willing to communicate with. If the Initiator is willing to communicate with all identities except its own, an attacker can determine that a guessed Initiator identity is correct. To not leak any long-term identifiers, using a freshly generated authentication key as an identity in each initial TOFU session is <span class="bcp14">RECOMMENDED</span>.<a class="pilcrow" href="#section-9.2-6">¶</a></p>
<p id="section-9.2-7">NIST SP 800-56A <span>[<a class="cite xref" href="#SP-800-56A">SP-800-56A</a>]</span> forbids deriving secret and non-secret randomness from the same Key Derivation Function (KDF) instance, but this decision has been criticized by Krawczyk in <span>[<a class="cite xref" href="#HKDFpaper">HKDFpaper</a>]</span> and doing so is common practice. In addition to IVs, other examples are the challenge in Extensible Authentication Protocol Tunneled Transport Layer Security (EAP-TTLS), the RAND in 3GPP Authentication and Key Agreement (AKA), and the Session-Id in EAP-TLS 1.3. Note that part of KEYSTREAM_2 is also non-secret randomness, as it is known or predictable to an attacker. The more recent NIST SP 800-108 <span>[<a class="cite xref" href="#SP-800-108">SP-800-108</a>]</span> aligns with <span>[<a class="cite xref" href="#HKDFpaper">HKDFpaper</a>]</span> and states that, for a secure KDF, the revelation of one portion of the derived keying material must not degrade the security of any other portion of that keying material.<a class="pilcrow" href="#section-9.2-7">¶</a></p>
</section>
</div>
<div id="sec_algs">
<section id="section-9.3">
        <h3 id="name-cipher-suites-and-cryptogra">
<a class="section-number selfRef" href="#section-9.3">9.3. </a><a class="section-name selfRef" href="#name-cipher-suites-and-cryptogra">Cipher Suites and Cryptographic Algorithms</a>
        </h3>
<p id="section-9.3-1">When using a private cipher suite or registering new cipher suites, the choice of the key length used in the different algorithms needs to be harmonized so that a sufficient security level is maintained for authentication credentials, the EDHOC session, and the protection of application data. The Initiator and Responder should enforce a minimum security level.<a class="pilcrow" href="#section-9.3-1">¶</a></p>
<p id="section-9.3-2">The output size of the EDHOC hash algorithm <span class="bcp14">MUST</span> be at least 256 bits. In particular, the hash algorithms SHA-1 and SHA-256/64 (SHA-256 truncated to 64 bits) <span class="bcp14">SHALL NOT</span> be supported for use in EDHOC except for certificate identification with x5t and c5t. For security considerations of SHA-1, see <span>[<a class="cite xref" href="#RFC6194">RFC6194</a>]</span>. As EDHOC integrity protects all the authentication credentials, the choice of hash algorithm in x5t and c5t does not affect security and using the same hash algorithm as in the cipher suite, but with as much truncation as possible, is <span class="bcp14">RECOMMENDED</span>. That is, when the EDHOC hash algorithm is SHA-256, using SHA-256/64 in x5t and c5t is <span class="bcp14">RECOMMENDED</span>. The EDHOC MAC length <span class="bcp14">MUST</span> be at least 8 bytes and the tag length of the EDHOC AEAD algorithm <span class="bcp14">MUST</span> be at least 64 bits. Note that secp256k1 is only defined for use with ECDSA and not for ECDH. Note that some COSE algorithms are marked as not recommended in the COSE IANA registry.<a class="pilcrow" href="#section-9.3-2">¶</a></p>
</section>
</div>
<div id="pqc">
<section id="section-9.4">
        <h3 id="name-post-quantum-considerations">
<a class="section-number selfRef" href="#section-9.4">9.4. </a><a class="section-name selfRef" href="#name-post-quantum-considerations">Post-Quantum Considerations</a>
        </h3>
<p id="section-9.4-1">As of the publication of this specification, it is unclear when or even if a quantum computer of sufficient size and power to exploit public key cryptography will exist. Deployments that need to consider risks decades into the future should transition to Post-Quantum Cryptography (PQC) in the not-too-distant future. Many other systems should take a slower wait-and-see approach where PQC is phased in when the quantum threat is more imminent. Current PQC algorithms have limitations compared to Elliptic Curve Cryptography (ECC), and the data sizes would be problematic in many constrained IoT systems.<a class="pilcrow" href="#section-9.4-1">¶</a></p>
<p id="section-9.4-2">Symmetric algorithms used in EDHOC, such as SHA-256 and AES-CCM-16-64-128, are practically secure against even large quantum computers. Two of NIST's security levels for quantum-resistant public key cryptography are based on AES-128 and SHA-256. A quantum computer will likely be expensive and slow due to heavy error correction. Grover's algorithm, which is proven to be optimal, cannot effectively be parallelized. It will provide little or no advantage in attacking AES, and AES-128 will remain secure for decades to come <span>[<a class="cite xref" href="#NISTPQC">NISTPQC</a>]</span>.<a class="pilcrow" href="#section-9.4-2">¶</a></p>
<p id="section-9.4-3">EDHOC supports all signature algorithms defined by COSE, including PQC signature algorithms such as HSS-LMS. EDHOC is currently only specified for use with key exchange algorithms of type ECDH curves, but any Key Encapsulation Method (KEM), including PQC KEMs, can be used in method 0. While the key exchange in method 0 is specified with the terms of the Diffie-Hellman protocol, the key exchange adheres to a KEM interface: G_X is then the public key of the Initiator, G_Y is the encapsulation, and G_XY is the shared secret. Use of PQC KEMs to replace static DH authentication would likely require a specification updating EDHOC with new methods.<a class="pilcrow" href="#section-9.4-3">¶</a></p>
</section>
</div>
<div id="unprot-data">
<section id="section-9.5">
        <h3 id="name-unprotected-data-and-privac">
<a class="section-number selfRef" href="#section-9.5">9.5. </a><a class="section-name selfRef" href="#name-unprotected-data-and-privac">Unprotected Data and Privacy</a>
        </h3>
<p id="section-9.5-1">The Initiator and Responder must make sure that unprotected data and metadata do not reveal any sensitive information. This also applies for encrypted data sent to an unauthenticated party. In particular, it applies to EAD_1, ID_CRED_R, EAD_2, and error messages. Using the same EAD_1 in several EDHOC sessions allows passive eavesdroppers to correlate the different sessions. Note that even if ead_value is encrypted outside of EDHOC, the ead_labels in EAD_1 are revealed to passive attackers and the ead_labels in EAD_2 are revealed to active attackers. Another consideration is that the list of supported cipher suites may potentially be used to identify the application. The Initiator and Responder must also make sure that unauthenticated data does not trigger any harmful actions. In particular, this applies to EAD_1 and error messages.<a class="pilcrow" href="#section-9.5-1">¶</a></p>
<p id="section-9.5-2">An attacker observing network traffic may use connection identifiers sent in clear in EDHOC or the subsequent application protocol to correlate packets sent on different paths or at different times. The attacker may use this information for traffic flow analysis or to track an endpoint. Application protocols using connection identifiers from EDHOC <span class="bcp14">SHOULD</span> provide mechanisms to update the connection identifiers and <span class="bcp14">MAY</span> provide mechanisms to issue several simultaneously active connection identifiers. See <span>[<a class="cite xref" href="#RFC9000">RFC9000</a>]</span> for a non-constrained example of such mechanisms. Connection identifiers can, e.g., be chosen randomly among the set of unused 1-byte connection identifiers. Connection identity privacy mechanisms are only useful when there are not fixed identifiers, such as IP address or MAC address in the lower layers.<a class="pilcrow" href="#section-9.5-2">¶</a></p>
</section>
</div>
<div id="internet-threat">
<section id="section-9.6">
        <h3 id="name-updated-internet-threat-mod">
<a class="section-number selfRef" href="#section-9.6">9.6. </a><a class="section-name selfRef" href="#name-updated-internet-threat-mod">Updated Internet Threat Model Considerations</a>
        </h3>
<p id="section-9.6-1">Since the publication of <span>[<a class="cite xref" href="#RFC3552">RFC3552</a>]</span>, there has been an increased awareness of the need to protect against endpoints that are compromised or malicious or whose interests simply do not align with the interests of users <span>[<a class="cite xref" href="#I-D.arkko-arch-internet-threat-model-guidance">THREAT-MODEL-GUIDANCE</a>]</span>. <span>[<a class="cite xref" href="#RFC7624">RFC7624</a>]</span> describes an updated threat model for Internet confidentiality; see <a class="auto internal xref" href="#sec-prop">Section 9.1</a>. <span>[<a class="cite xref" href="#I-D.arkko-arch-internet-threat-model-guidance">THREAT-MODEL-GUIDANCE</a>]</span> further expands the threat model. Implementations and users should take these threat models into account and consider actions to reduce the risk of tracking by other endpoints. In particular, even data sent protected to the other endpoint, such as ID_CRED fields and EAD fields, can be used for tracking; see <span><a class="relref" href="https://datatracker.ietf.org/doc/html/draft-arkko-arch-internet-threat-model-guidance-00#section-2.7">Section 2.7</a> of [<a class="cite xref" href="#I-D.arkko-arch-internet-threat-model-guidance">THREAT-MODEL-GUIDANCE</a>]</span>.<a class="pilcrow" href="#section-9.6-1">¶</a></p>
<p id="section-9.6-2">The fields ID_CRED_I, ID_CRED_R, EAD_2, EAD_3, and EAD_4 have variable length, and information regarding the length may leak to an attacker. A passive attacker may, e.g., be able to differentiate endpoints using identifiers of different length. To mitigate this information leakage, an implementation may ensure that the fields have a fixed length or use padding. An implementation may, e.g., only use fixed length identifiers like 'kid' of length 1. Alternatively, padding may be used (see <a class="auto internal xref" href="#padding">Section 3.8.1</a>) to hide the true length of, e.g., certificates by value in 'x5chain' or 'c5c'.<a class="pilcrow" href="#section-9.6-2">¶</a></p>
</section>
</div>
<div id="dos">
<section id="section-9.7">
        <h3 id="name-denial-of-service">
<a class="section-number selfRef" href="#section-9.7">9.7. </a><a class="section-name selfRef" href="#name-denial-of-service">Denial of Service</a>
        </h3>
<p id="section-9.7-1">EDHOC itself does not provide countermeasures against denial-of-service attacks. In particular, by sending a number of new or replayed message_1, an attacker may cause the Responder to allocate the state, perform cryptographic operations, and amplify messages. To mitigate such attacks, an implementation <span class="bcp14">SHOULD</span> make use of available lower layer mechanisms. For instance, when EDHOC is transferred as an exchange of CoAP messages, the CoAP server can use the Echo option defined in <span>[<a class="cite xref" href="#RFC9175">RFC9175</a>]</span>, which forces the CoAP client to demonstrate reachability at its apparent network address. To avoid an additional round trip, the Initiator can reduce the amplification factor by padding message_1, i.e., using EAD_1; see <a class="auto internal xref" href="#padding">Section 3.8.1</a>.
Note that while the Echo option mitigates some resource exhaustion aspects of
spoofing, it does not protect against a distributed denial-of-service attack made by real, potentially compromised, clients. Similarly, limiting amplification only reduces the impact, which still may be significant because of a large number of clients engaged in the attack.<a class="pilcrow" href="#section-9.7-1">¶</a></p>
<p id="section-9.7-2">An attacker can also send a faked message_2, message_3, message_4, or error in an attempt to trick the receiving party to send an error message and abort the EDHOC session. EDHOC implementations <span class="bcp14">MAY</span> evaluate if a received message is likely to have been forged by an attacker and ignore it without sending an error message or aborting the EDHOC session.<a class="pilcrow" href="#section-9.7-2">¶</a></p>
</section>
</div>
<div id="impl-cons">
<section id="section-9.8">
        <h3 id="name-implementation-consideratio">
<a class="section-number selfRef" href="#section-9.8">9.8. </a><a class="section-name selfRef" href="#name-implementation-consideratio">Implementation Considerations</a>
        </h3>
<p id="section-9.8-1">The availability of a secure random number generator is essential for the security of EDHOC. If no true random number generator is available, a random seed <span class="bcp14">MUST</span> be provided from an external source and used with a cryptographically secure pseudorandom number generator. As each pseudorandom number must only be used once, an implementation needs to get a unique input to the pseudorandom number generator after reboot or continuously store state in nonvolatile memory. <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8613#appendix-B.1.1">Appendix B.1.1</a> of [<a class="cite xref" href="#RFC8613">RFC8613</a>]</span> describes issues and solution approaches for writing to nonvolatile memory. Intentionally or unintentionally weak or predictable pseudorandom number generators can be abused or exploited for malicious purposes. <span>[<a class="cite xref" href="#RFC8937">RFC8937</a>]</span> describes a way for security protocol implementations to augment their (pseudo)random number generators using a long-term private key and a deterministic signature function. This improves randomness from broken or otherwise subverted random number generators. The same idea can be used with other secrets and functions, such as a Diffie-Hellman function or a symmetric secret, and a PRF like HMAC or KMAC. It is <span class="bcp14">RECOMMENDED</span> to not trust a single source of randomness and to not put unaugmented random numbers on the wire.<a class="pilcrow" href="#section-9.8-1">¶</a></p>
<p id="section-9.8-2">For many constrained IoT devices, it is problematic to support several crypto primitives. Existing devices can be expected to support either ECDSA or Edwards-curve Digital Signature Algorithm (EdDSA). If ECDSA is supported, "deterministic ECDSA", as specified in <span>[<a class="cite xref" href="#RFC6979">RFC6979</a>]</span>, <span class="bcp14">MAY</span> be used. Pure deterministic elliptic-curve signatures, such as deterministic ECDSA and EdDSA, have gained popularity over randomized ECDSA as their security does not depend on a source of high-quality randomness. Recent research has however found that implementations of these signature algorithms may be vulnerable to certain side-channel and fault injection attacks due to their determinism. For example, see <span><a class="relref" href="https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-det-sigs-with-noise-02#section-1">Section 1</a> of [<a class="cite xref" href="#I-D.irtf-cfrg-det-sigs-with-noise">HEDGED-ECC-SIGS</a>]</span> for a list of attack papers. As suggested in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc9053#section-2.1.1">Section 2.1.1</a> of [<a class="cite xref" href="#RFC9053">RFC9053</a>]</span>, this can be addressed by combining randomness and determinism.<a class="pilcrow" href="#section-9.8-2">¶</a></p>
<p id="section-9.8-3"><span><a class="relref" href="https://datatracker.ietf.org/doc/html/draft-ietf-lwig-curve-representations-23#appendix-D">Appendix D</a> of [<a class="cite xref" href="#I-D.ietf-lwig-curve-representations">CURVE-REPR</a>]</span> describes how Montgomery curves, such as X25519 and X448, and (twisted) Edwards curves, such as Ed25519 and Ed448, can be mapped to and from short-Weierstrass form for implementations on platforms that accelerate elliptic curve group operations in short-Weierstrass form.<a class="pilcrow" href="#section-9.8-3">¶</a></p>
<p id="section-9.8-4">All private keys, symmetric keys, and IVs <span class="bcp14">MUST</span> be secret. Only the Responder <span class="bcp14">SHALL</span> have access to the Responder's private authentication key, and only the Initiator <span class="bcp14">SHALL</span> have access to the Initiator's private authentication key. Implementations should provide countermeasures to side-channel attacks, such as timing attacks. Intermediate computed values, such as ephemeral ECDH keys and ECDH shared secrets, <span class="bcp14">MUST</span> be deleted after key derivation is completed.<a class="pilcrow" href="#section-9.8-4">¶</a></p>
<p id="section-9.8-5">The Initiator and Responder are responsible for verifying the integrity and validity of certificates. Verification of validity may require the use of a Real-Time Clock (RTC). The selection of trusted certification authorities (CAs) should be done very carefully and certificate revocation should be supported. The choice of revocation mechanism is left to the application. For example, in case of X.509 certificates, Certificate Revocation Lists <span>[<a class="cite xref" href="#RFC5280">RFC5280</a>]</span> or the Online Certificate Status Protocol (OCSP) <span>[<a class="cite xref" href="#RFC6960">RFC6960</a>]</span> may be used.<a class="pilcrow" href="#section-9.8-5">¶</a></p>
<p id="section-9.8-6">Similar considerations as for certificates are needed for CWT/CCS. The endpoints are responsible for verifying the integrity and validity of CWT/CCS and to handle revocation. The application needs to determine what trust anchors are relevant and have a well-defined trust-establishment process. A self-signed certificate / CWT or CCS appearing in the protocol cannot be a trigger to modify the set of trust anchors. One common way for a new trust anchor to be added to (or removed from) a device is by means firmware upgrade. See <span>[<a class="cite xref" href="#RFC9360">RFC9360</a>]</span> for a longer discussion on trust and validation in constrained devices.<a class="pilcrow" href="#section-9.8-6">¶</a></p>
<p id="section-9.8-7">Just like for certificates, the contents of the COSE header parameters 'kcwt' and 'kccs' defined in <a class="auto internal xref" href="#cwt-header-param">Section 10.6</a> must be processed as untrusted inputs. Endpoints that intend to rely on the assertions made by a CWT/CCS obtained from any of these methods need to validate the contents. For 'kccs', which enables transport of raw public keys, the data structure used does not include any protection or verification data. 'kccs' may be used for unauthenticated operations, e.g., trust on first use, with the limitations and caveats entailed; see <a class="auto internal xref" href="#tofu">Appendix D.5</a>.<a class="pilcrow" href="#section-9.8-7">¶</a></p>
<p id="section-9.8-8">The Initiator and Responder are allowed to select connection identifiers C_I and C_R, respectively, for the other party to use in the ongoing EDHOC session as well as in a subsequent application protocol (e.g., OSCORE <span>[<a class="cite xref" href="#RFC8613">RFC8613</a>]</span>). The choice of the connection identifier is not security critical in EDHOC but intended to simplify the retrieval of the right security context in combination with using short identifiers. If the wrong connection identifier of the other party is used in a protocol message, it will result in the receiving party not being able to retrieve a security context (which will abort the EDHOC session) or retrieve the wrong security context (which also aborts the EDHOC session as the message cannot be verified).<a class="pilcrow" href="#section-9.8-8">¶</a></p>
<p id="section-9.8-9">If two nodes unintentionally initiate two simultaneous EDHOC sessions with each other, even if they only want to complete a single EDHOC session, they <span class="bcp14">MAY</span> abort the EDHOC session with the lexicographically smallest G_X. Note that in cases where several EDHOC sessions with different parameter sets (method, COSE headers, etc.) are used, an attacker can affect which parameter set will be used by blocking some of the parameter sets.<a class="pilcrow" href="#section-9.8-9">¶</a></p>
<p id="section-9.8-10">If supported by the device, it is <span class="bcp14">RECOMMENDED</span> that at least the long-term private keys are stored in a Trusted Execution Environment (TEE) (for example, see <span>[<a class="cite xref" href="#RFC9397">RFC9397</a>]</span>) and that sensitive operations using these keys are performed inside the TEE.  To achieve even higher security, it is <span class="bcp14">RECOMMENDED</span> that additional operations such as ephemeral key generation, all computations of shared secrets, and storage of the PRK keys can be done inside the TEE. The use of a TEE aims at preventing code within that environment to be tampered with and preventing data used by such code to be read or tampered with by code outside that environment.<a class="pilcrow" href="#section-9.8-10">¶</a></p>
<p id="section-9.8-11">Note that HKDF-Expand has a relatively small maximum output length of 255 ⋅ hash_length, where hash_length is the output size in bytes of the EDHOC hash algorithm of the selected cipher suite. This means that when SHA-256 is used as a hash algorithm, PLAINTEXT_2 cannot be longer than 8160 bytes. This is probably not a limitation for most intended applications, but to be able to support, for example, long certificate chains or large external authorization data, there is a backwards compatible method specified in <a class="auto internal xref" href="#large-plaintext_2">Appendix G</a>.<a class="pilcrow" href="#section-9.8-11">¶</a></p>
<p id="section-9.8-12">The sequence of transcript hashes in EDHOC (TH_2, TH_3, and TH_4) does not make use of a so-called running hash. This is a design choice, as running hashes are often not supported on constrained platforms.<a class="pilcrow" href="#section-9.8-12">¶</a></p>
<p id="section-9.8-13">When parsing a received EDHOC message, implementations <span class="bcp14">MUST</span> abort the EDHOC session if the message does not comply with the CDDL for that message. Implementations are not required to support non-deterministic encodings and <span class="bcp14">MAY</span> abort the EDHOC session if the received EDHOC message is not encoded using deterministic CBOR. Implementations <span class="bcp14">MUST</span> abort the EDHOC session if validation of a received public key fails or if any cryptographic field has the wrong length. It is <span class="bcp14">RECOMMENDED</span> to abort the EDHOC session if the received EDHOC message is not encoded using deterministic CBOR.<a class="pilcrow" href="#section-9.8-13">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana">
<section id="section-10">
      <h2 id="name-iana-considerations">
<a class="section-number selfRef" href="#section-10">10. </a><a class="section-name selfRef" href="#name-iana-considerations">IANA Considerations</a>
      </h2>
<p id="section-10-1">This section gives IANA considerations and, unless otherwise noted, conforms with <span>[<a class="cite xref" href="#RFC8126">RFC8126</a>]</span>.<a class="pilcrow" href="#section-10-1">¶</a></p>
<div id="exporter-label">
<section id="section-10.1">
        <h3 id="name-edhoc-exporter-label-regist">
<a class="section-number selfRef" href="#section-10.1">10.1. </a><a class="section-name selfRef" href="#name-edhoc-exporter-label-regist">EDHOC Exporter Label Registry</a>
        </h3>
<p id="section-10.1-1">IANA has created a new registry under the new registry group "Ephemeral Diffie-Hellman Over COSE (EDHOC)" as follows:<a class="pilcrow" href="#section-10.1-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-10.1-2">
          <dt id="section-10.1-2.1">Registry Name:</dt>
          <dd id="section-10.1-2.2" style="margin-left: 1.5em">EDHOC Exporter Labels<a class="pilcrow" href="#section-10.1-2.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-10.1-2.3">Reference:</dt>
          <dd id="section-10.1-2.4" style="margin-left: 1.5em">RFC 9528<a class="pilcrow" href="#section-10.1-2.4">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<span id="name-edhoc-exporter-labels"></span><div id="tab-exporter-label">
<table class="center" id="table-4">
          <caption>
<a class="selfRef" href="#table-4">Table 4</a>:
<a class="selfRef" href="#name-edhoc-exporter-labels">EDHOC Exporter Labels</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Label</th>
              <th class="text-left" colspan="1" rowspan="1">Description</th>
              <th class="text-left" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">Derived OSCORE Master Secret</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9528</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">1</td>
              <td class="text-left" colspan="1" rowspan="1">Derived OSCORE Master Salt</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9528</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">2-22</td>
              <td class="text-left" colspan="1" rowspan="1">Unassigned</td>
              <td class="text-left" colspan="1" rowspan="1"></td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">23</td>
              <td class="text-left" colspan="1" rowspan="1">Reserved</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9528</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">24-32767</td>
              <td class="text-left" colspan="1" rowspan="1">Unassigned</td>
              <td class="text-left" colspan="1" rowspan="1"></td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">32768-65535</td>
              <td class="text-left" colspan="1" rowspan="1">Reserved for Private Use</td>
              <td class="text-left" colspan="1" rowspan="1"></td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-10.1-4">This registry also has a "Change Controller" field. For registrations made by IETF documents, the IETF is listed.<a class="pilcrow" href="#section-10.1-4">¶</a></p>
<span id="name-registration-procedures-for"></span><table class="center" id="table-5">
          <caption>
<a class="selfRef" href="#table-5">Table 5</a>:
<a class="selfRef" href="#name-registration-procedures-for">Registration Procedures for EDHOC Exporter Labels</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Range</th>
              <th class="text-left" colspan="1" rowspan="1">Registration Procedures</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0-23</td>
              <td class="text-left" colspan="1" rowspan="1">Standards Action</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">24-32767</td>
              <td class="text-left" colspan="1" rowspan="1">Expert Review</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">32768-65535</td>
              <td class="text-left" colspan="1" rowspan="1">Private Use</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="suites-registry">
<section id="section-10.2">
        <h3 id="name-edhoc-cipher-suites-registr">
<a class="section-number selfRef" href="#section-10.2">10.2. </a><a class="section-name selfRef" href="#name-edhoc-cipher-suites-registr">EDHOC Cipher Suites Registry</a>
        </h3>
<p id="section-10.2-1">IANA has created a new registry under the new registry group "Ephemeral Diffie-Hellman Over COSE (EDHOC)" as follows:<a class="pilcrow" href="#section-10.2-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-10.2-2">
          <dt id="section-10.2-2.1">Registry Name:</dt>
          <dd id="section-10.2-2.2" style="margin-left: 1.5em">EDHOC Cipher Suites<a class="pilcrow" href="#section-10.2-2.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-10.2-2.3">Reference:</dt>
          <dd id="section-10.2-2.4" style="margin-left: 1.5em">RFC 9528<a class="pilcrow" href="#section-10.2-2.4">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-10.2-3">The columns of the registry are Value, Array, Description, and Reference, where Value is an integer and the other columns are text strings. The initial contents of the registry are:<a class="pilcrow" href="#section-10.2-3">¶</a></p>
<span id="name-edhoc-cipher-suites"></span><table class="center" id="table-6">
          <caption>
<a class="selfRef" href="#table-6">Table 6</a>:
<a class="selfRef" href="#name-edhoc-cipher-suites">EDHOC Cipher Suites</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Value</th>
              <th class="text-left" colspan="1" rowspan="1">Array</th>
              <th class="text-left" colspan="1" rowspan="1">Description</th>
              <th class="text-left" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">-24</td>
              <td class="text-left" colspan="1" rowspan="1">N/A</td>
              <td class="text-left" colspan="1" rowspan="1">Private Use</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9528</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">-23</td>
              <td class="text-left" colspan="1" rowspan="1">N/A</td>
              <td class="text-left" colspan="1" rowspan="1">Private Use</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9528</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">-22</td>
              <td class="text-left" colspan="1" rowspan="1">N/A</td>
              <td class="text-left" colspan="1" rowspan="1">Private Use</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9528</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">-21</td>
              <td class="text-left" colspan="1" rowspan="1">N/A</td>
              <td class="text-left" colspan="1" rowspan="1">Private Use</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9528</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">10, -16, 8, 4, -8, 10, -16</td>
              <td class="text-left" colspan="1" rowspan="1">AES-CCM-16-64-128, SHA-256, 8, X25519, EdDSA, AES‑CCM‑16‑64‑128, SHA-256</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9528</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">1</td>
              <td class="text-left" colspan="1" rowspan="1">30, -16, 16, 4, -8, 10, -16</td>
              <td class="text-left" colspan="1" rowspan="1">AES-CCM-16-128-128, SHA‑256, 16, X25519, EdDSA, AES‑CCM‑16‑64‑128, SHA-256</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9528</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">2</td>
              <td class="text-left" colspan="1" rowspan="1">10, -16, 8, 1, -7, 10, -16</td>
              <td class="text-left" colspan="1" rowspan="1">AES-CCM-16-64-128, SHA-256, 8, P-256, ES256, AES‑CCM‑16‑64‑128, SHA-256</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9528</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">3</td>
              <td class="text-left" colspan="1" rowspan="1">30, -16, 16, 1, -7, 10, -16</td>
              <td class="text-left" colspan="1" rowspan="1">AES-CCM-16-128-128, SHA‑256, 16, P-256, ES256, AES‑CCM‑16‑64‑128, SHA-256</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9528</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">4</td>
              <td class="text-left" colspan="1" rowspan="1">24, -16, 16, 4, -8, 24, -16</td>
              <td class="text-left" colspan="1" rowspan="1">ChaCha20/Poly1305, SHA-256, 16, X25519, EdDSA, ChaCha20/Poly1305, SHA-256</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9528</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">5</td>
              <td class="text-left" colspan="1" rowspan="1">24, -16, 16, 1, -7, 24, -16</td>
              <td class="text-left" colspan="1" rowspan="1">ChaCha20/Poly1305, SHA-256, 16, P-256, ES256, ChaCha20/⁠Poly1305, SHA-256</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9528</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">6</td>
              <td class="text-left" colspan="1" rowspan="1">1, -16, 16, 4, -7, 1, -16</td>
              <td class="text-left" colspan="1" rowspan="1">A128GCM, SHA-256, 16, X25519, ES256, A128GCM, SHA-256</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9528</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">23</td>
              <td class="text-left" colspan="1" rowspan="1"></td>
              <td class="text-left" colspan="1" rowspan="1">Reserved</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9528</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">24</td>
              <td class="text-left" colspan="1" rowspan="1">3, -43, 16, 2, -35, 3, -43</td>
              <td class="text-left" colspan="1" rowspan="1">A256GCM, SHA-384, 16, P-384, ES384,
      A256GCM, SHA-384</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9528</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">25</td>
              <td class="text-left" colspan="1" rowspan="1">24, -45, 16, 5, -8, 24, -45</td>
              <td class="text-left" colspan="1" rowspan="1">ChaCha20/Poly1305, SHAKE256, 16, X448, EdDSA,
      ChaCha20/Poly1305, SHAKE256</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9528</td>
            </tr>
          </tbody>
        </table>
<span id="name-registration-procedures-for-"></span><table class="center" id="table-7">
          <caption>
<a class="selfRef" href="#table-7">Table 7</a>:
<a class="selfRef" href="#name-registration-procedures-for-">Registration Procedures for EDHOC Cipher Suites</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Range</th>
              <th class="text-left" colspan="1" rowspan="1">Registration Procedures</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">-65536 to -25</td>
              <td class="text-left" colspan="1" rowspan="1">Specification Required</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">-24 to -21</td>
              <td class="text-left" colspan="1" rowspan="1">Private Use</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">-20 to 23</td>
              <td class="text-left" colspan="1" rowspan="1">Standards Action with Expert Review</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">24 to 65535</td>
              <td class="text-left" colspan="1" rowspan="1">Specification Required</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="method-types">
<section id="section-10.3">
        <h3 id="name-edhoc-method-type-registry">
<a class="section-number selfRef" href="#section-10.3">10.3. </a><a class="section-name selfRef" href="#name-edhoc-method-type-registry">EDHOC Method Type Registry</a>
        </h3>
<p id="section-10.3-1">IANA has created a new registry under the new registry group "Ephemeral Diffie-Hellman Over COSE (EDHOC)" as follows:<a class="pilcrow" href="#section-10.3-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-10.3-2">
          <dt id="section-10.3-2.1">Registry Name:</dt>
          <dd id="section-10.3-2.2" style="margin-left: 1.5em">EDHOC Method Types<a class="pilcrow" href="#section-10.3-2.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-10.3-2.3">Reference:</dt>
          <dd id="section-10.3-2.4" style="margin-left: 1.5em">RFC 9528<a class="pilcrow" href="#section-10.3-2.4">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-10.3-3">The columns of the registry are Value, Initiator Authentication Key, Responder Authentication Key, and Reference, where Value is an integer and the key columns are text strings describing the authentication keys.<a class="pilcrow" href="#section-10.3-3">¶</a></p>
<p id="section-10.3-4">The initial contents of the registry are shown in <a class="auto internal xref" href="#tab-method-types">Table 2</a>. Method 23 is Reserved.<a class="pilcrow" href="#section-10.3-4">¶</a></p>
<span id="name-registration-procedures-for-e"></span><table class="center" id="table-8">
          <caption>
<a class="selfRef" href="#table-8">Table 8</a>:
<a class="selfRef" href="#name-registration-procedures-for-e">Registration Procedures for EDHOC Method Types</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Range</th>
              <th class="text-left" colspan="1" rowspan="1">Registration Procedures</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">-65536 to -25</td>
              <td class="text-left" colspan="1" rowspan="1">Specification Required</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">-24 to 23</td>
              <td class="text-left" colspan="1" rowspan="1">Standards Action with Expert Review</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">24 to 65535</td>
              <td class="text-left" colspan="1" rowspan="1">Specification Required</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="error-code-reg">
<section id="section-10.4">
        <h3 id="name-edhoc-error-codes-registry">
<a class="section-number selfRef" href="#section-10.4">10.4. </a><a class="section-name selfRef" href="#name-edhoc-error-codes-registry">EDHOC Error Codes Registry</a>
        </h3>
<p id="section-10.4-1">IANA has created a new registry under the new registry group "Ephemeral Diffie-Hellman Over COSE (EDHOC)" as follows:<a class="pilcrow" href="#section-10.4-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-10.4-2">
          <dt id="section-10.4-2.1">Registry Name:</dt>
          <dd id="section-10.4-2.2" style="margin-left: 1.5em">EDHOC Error Codes<a class="pilcrow" href="#section-10.4-2.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-10.4-2.3">Reference:</dt>
          <dd id="section-10.4-2.4" style="margin-left: 1.5em">RFC 9528<a class="pilcrow" href="#section-10.4-2.4">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-10.4-3">The columns of the registry are ERR_CODE, ERR_INFO Type, Description, Change Controller, and Reference, where ERR_CODE is an integer, ERR_INFO is a CDDL defined type, and Description is a text string. The initial contents of the registry are shown in <a class="auto internal xref" href="#tab-error-codes">Table 3</a>. Error code 23 is Reserved. This registry also has a "Change Controller" field. For registrations made by IETF documents, the IETF is listed.<a class="pilcrow" href="#section-10.4-3">¶</a></p>
<span id="name-registration-procedures-for-ed"></span><table class="center" id="table-9">
          <caption>
<a class="selfRef" href="#table-9">Table 9</a>:
<a class="selfRef" href="#name-registration-procedures-for-ed">Registration Procedures for EDHOC Error Codes</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Range</th>
              <th class="text-left" colspan="1" rowspan="1">Registration Procedures</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">-65536 to -25</td>
              <td class="text-left" colspan="1" rowspan="1">Expert Review</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">-24 to 23</td>
              <td class="text-left" colspan="1" rowspan="1">Standards Action</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">24 to 65535</td>
              <td class="text-left" colspan="1" rowspan="1">Expert Review</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="iana-ead">
<section id="section-10.5">
        <h3 id="name-edhoc-external-authorizatio">
<a class="section-number selfRef" href="#section-10.5">10.5. </a><a class="section-name selfRef" href="#name-edhoc-external-authorizatio">EDHOC External Authorization Data Registry</a>
        </h3>
<p id="section-10.5-1">IANA has created a new registry under the new registry group "Ephemeral Diffie-Hellman Over COSE (EDHOC)" as follows:<a class="pilcrow" href="#section-10.5-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-10.5-2">
          <dt id="section-10.5-2.1">Registry Name:</dt>
          <dd id="section-10.5-2.2" style="margin-left: 1.5em">EDHOC External Authorization Data<a class="pilcrow" href="#section-10.5-2.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-10.5-2.3">Reference:</dt>
          <dd id="section-10.5-2.4" style="margin-left: 1.5em">RFC 9528<a class="pilcrow" href="#section-10.5-2.4">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-10.5-3">The columns of the registry are Name, Label, Description, and Reference, where Label is a nonnegative integer and the other columns are text strings. The initial contents of the registry are shown in <a class="auto internal xref" href="#tab-ead-labels">Table 10</a>. EAD label 23 is Reserved.<a class="pilcrow" href="#section-10.5-3">¶</a></p>
<span id="name-edhoc-ead-labels"></span><div id="tab-ead-labels">
<table class="center" id="table-10">
          <caption>
<a class="selfRef" href="#table-10">Table 10</a>:
<a class="selfRef" href="#name-edhoc-ead-labels">EDHOC EAD Labels</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Name</th>
              <th class="text-left" colspan="1" rowspan="1">Label</th>
              <th class="text-left" colspan="1" rowspan="1">Description</th>
              <th class="text-left" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">Padding</td>
              <td class="text-left" colspan="1" rowspan="1">0</td>
              <td class="text-left" colspan="1" rowspan="1">Randomly generated CBOR byte string</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9528, <a class="auto internal xref" href="#padding">Section 3.8.1</a>
</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1"></td>
              <td class="text-left" colspan="1" rowspan="1">23</td>
              <td class="text-left" colspan="1" rowspan="1">Reserved</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9528</td>
            </tr>
          </tbody>
        </table>
</div>
<span id="name-registration-procedures-for-edh"></span><table class="center" id="table-11">
          <caption>
<a class="selfRef" href="#table-11">Table 11</a>:
<a class="selfRef" href="#name-registration-procedures-for-edh">Registration Procedures for EDHOC EAD Labels</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Range</th>
              <th class="text-left" colspan="1" rowspan="1">Registration Procedures</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">0 to 23</td>
              <td class="text-left" colspan="1" rowspan="1">Standards Action with Expert Review</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">24 to 65535</td>
              <td class="text-left" colspan="1" rowspan="1">Specification Required</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="cwt-header-param">
<section id="section-10.6">
        <h3 id="name-cose-header-parameters-regi">
<a class="section-number selfRef" href="#section-10.6">10.6. </a><a class="section-name selfRef" href="#name-cose-header-parameters-regi">COSE Header Parameters Registry</a>
        </h3>
<p id="section-10.6-1">IANA has registered the following entries in the "COSE Header Parameters" registry under the registry group "CBOR Object Signing and Encryption (COSE)" (see <a class="auto internal xref" href="#tab-header-params">Table 12</a>). The value of the 'kcwt' header parameter is a COSE Web Token (CWT) <span>[<a class="cite xref" href="#RFC8392">RFC8392</a>]</span>, and the value of the 'kccs' header parameter is a CWT Claims Set (CCS); see <a class="auto internal xref" href="#term">Section 1.4</a>. The CWT/CCS must contain a COSE_Key in a 'cnf' claim <span>[<a class="cite xref" href="#RFC8747">RFC8747</a>]</span>. The Value Registry column for this item is empty and omitted from the table below.<a class="pilcrow" href="#section-10.6-1">¶</a></p>
<span id="name-cose-header-parameter-label"></span><div id="tab-header-params">
<table class="center" id="table-12">
          <caption>
<a class="selfRef" href="#table-12">Table 12</a>:
<a class="selfRef" href="#name-cose-header-parameter-label">COSE Header Parameter Labels</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Name</th>
              <th class="text-left" colspan="1" rowspan="1">Label</th>
              <th class="text-left" colspan="1" rowspan="1">Value Type</th>
              <th class="text-left" colspan="1" rowspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">kcwt</td>
              <td class="text-left" colspan="1" rowspan="1">13</td>
              <td class="text-left" colspan="1" rowspan="1">COSE_Messages</td>
              <td class="text-left" colspan="1" rowspan="1">A CBOR Web Token (CWT) containing  
       a COSE_Key in a 'cnf' claim and    
       possibly other claims. CWT is      
       defined in RFC 8392. COSE_Messages 
       is defined in RFC 9052.</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">kccs</td>
              <td class="text-left" colspan="1" rowspan="1">14</td>
              <td class="text-left" colspan="1" rowspan="1">map</td>
              <td class="text-left" colspan="1" rowspan="1">A CWT Claims Set (CCS) containing  
       a COSE_Key in a 'cnf' claim and    
       possibly other claims. CCS is     
       defined in RFC 8392.</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="well-known">
<section id="section-10.7">
        <h3 id="name-well-known-uri-registry">
<a class="section-number selfRef" href="#section-10.7">10.7. </a><a class="section-name selfRef" href="#name-well-known-uri-registry">Well-Known URI Registry</a>
        </h3>
<p id="section-10.7-1">IANA has added the well-known URI "edhoc" to the "Well-Known URIs" registry.<a class="pilcrow" href="#section-10.7-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-10.7-2">
          <dt id="section-10.7-2.1">URI Suffix:</dt>
          <dd id="section-10.7-2.2" style="margin-left: 1.5em">edhoc<a class="pilcrow" href="#section-10.7-2.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-10.7-2.3">Change Controller:</dt>
          <dd id="section-10.7-2.4" style="margin-left: 1.5em">IETF<a class="pilcrow" href="#section-10.7-2.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-10.7-2.5">Reference:</dt>
          <dd id="section-10.7-2.6" style="margin-left: 1.5em">RFC 9528<a class="pilcrow" href="#section-10.7-2.6">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-10.7-2.7">Related Information:</dt>
          <dd id="section-10.7-2.8" style="margin-left: 1.5em"> None<a class="pilcrow" href="#section-10.7-2.8">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="media-type">
<section id="section-10.8">
        <h3 id="name-media-types-registry">
<a class="section-number selfRef" href="#section-10.8">10.8. </a><a class="section-name selfRef" href="#name-media-types-registry">Media Types Registry</a>
        </h3>
<p id="section-10.8-1">IANA has added the media types "application/edhoc+cbor-seq" and "application/cid-edhoc+cbor-seq" to the "Media Types" registry.<a class="pilcrow" href="#section-10.8-1">¶</a></p>
<div id="applicationedhoccbor-seq-media-type-registration">
<section id="section-10.8.1">
          <h4 id="name-application-edhoccbor-seq-m">
<a class="section-number selfRef" href="#section-10.8.1">10.8.1. </a><a class="section-name selfRef" href="#name-application-edhoccbor-seq-m">application/edhoc+cbor-seq Media Type Registration</a>
          </h4>
<span class="break"></span><dl class="dlParallel" id="section-10.8.1-1">
            <dt id="section-10.8.1-1.1">Type name:</dt>
            <dd id="section-10.8.1-1.2" style="margin-left: 1.5em"> application<a class="pilcrow" href="#section-10.8.1-1.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.8.1-1.3">Subtype name:</dt>
            <dd id="section-10.8.1-1.4" style="margin-left: 1.5em"> edhoc+cbor-seq<a class="pilcrow" href="#section-10.8.1-1.4">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.8.1-1.5">Required parameters:</dt>
            <dd id="section-10.8.1-1.6" style="margin-left: 1.5em"> N/A<a class="pilcrow" href="#section-10.8.1-1.6">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.8.1-1.7">Optional parameters:</dt>
            <dd id="section-10.8.1-1.8" style="margin-left: 1.5em"> N/A<a class="pilcrow" href="#section-10.8.1-1.8">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.8.1-1.9">Encoding considerations:</dt>
            <dd id="section-10.8.1-1.10" style="margin-left: 1.5em"> binary<a class="pilcrow" href="#section-10.8.1-1.10">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.8.1-1.11">Security considerations:</dt>
            <dd id="section-10.8.1-1.12" style="margin-left: 1.5em">See <a class="auto internal xref" href="#duplication">Section 7</a> of RFC 9528.<a class="pilcrow" href="#section-10.8.1-1.12">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.8.1-1.13">Interoperability considerations:</dt>
            <dd id="section-10.8.1-1.14" style="margin-left: 1.5em"> N/A<a class="pilcrow" href="#section-10.8.1-1.14">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.8.1-1.15">Published specification:</dt>
            <dd id="section-10.8.1-1.16" style="margin-left: 1.5em">RFC 9528<a class="pilcrow" href="#section-10.8.1-1.16">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.8.1-1.17">Applications that use this media type:</dt>
            <dd id="section-10.8.1-1.18" style="margin-left: 1.5em"> To be identified<a class="pilcrow" href="#section-10.8.1-1.18">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.8.1-1.19">Fragment identifier considerations:</dt>
            <dd id="section-10.8.1-1.20" style="margin-left: 1.5em"> N/A<a class="pilcrow" href="#section-10.8.1-1.20">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.8.1-1.21">Additional information: </dt>
            <dd id="section-10.8.1-1.22" style="margin-left: 1.5em">
              <p id="section-10.8.1-1.22.1"><br/></p>
<span class="break"></span><dl class="dlParallel" id="section-10.8.1-1.22.2">
                <dt id="section-10.8.1-1.22.2.1">Magic number(s):</dt>
                <dd id="section-10.8.1-1.22.2.2" style="margin-left: 1.5em"> N/A<a class="pilcrow" href="#section-10.8.1-1.22.2.2">¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-10.8.1-1.22.2.3">File extension(s):</dt>
                <dd id="section-10.8.1-1.22.2.4" style="margin-left: 1.5em"> N/A<a class="pilcrow" href="#section-10.8.1-1.22.2.4">¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-10.8.1-1.22.2.5">Macintosh file type code(s):</dt>
                <dd id="section-10.8.1-1.22.2.6" style="margin-left: 1.5em"> N/A<a class="pilcrow" href="#section-10.8.1-1.22.2.6">¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</dd>
            <dd class="break"></dd>
<dt id="section-10.8.1-1.23">Person &amp; email address to contact for further information:</dt>
            <dd id="section-10.8.1-1.24" style="margin-left: 1.5em"> See "Authors' Addresses" section in RFC 9528.<a class="pilcrow" href="#section-10.8.1-1.24">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.8.1-1.25">Intended usage:</dt>
            <dd id="section-10.8.1-1.26" style="margin-left: 1.5em"> COMMON<a class="pilcrow" href="#section-10.8.1-1.26">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.8.1-1.27">Restrictions on usage:</dt>
            <dd id="section-10.8.1-1.28" style="margin-left: 1.5em"> N/A<a class="pilcrow" href="#section-10.8.1-1.28">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.8.1-1.29">Author:</dt>
            <dd id="section-10.8.1-1.30" style="margin-left: 1.5em"> See "Authors' Addresses" section.<a class="pilcrow" href="#section-10.8.1-1.30">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.8.1-1.31">Change Controller:</dt>
            <dd id="section-10.8.1-1.32" style="margin-left: 1.5em"> IETF<a class="pilcrow" href="#section-10.8.1-1.32">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="applicationcid-edhoccbor-seq-media-type-registration">
<section id="section-10.8.2">
          <h4 id="name-application-cid-edhoccbor-s">
<a class="section-number selfRef" href="#section-10.8.2">10.8.2. </a><a class="section-name selfRef" href="#name-application-cid-edhoccbor-s">application/cid-edhoc+cbor-seq Media Type Registration</a>
          </h4>
<span class="break"></span><dl class="dlParallel" id="section-10.8.2-1">
            <dt id="section-10.8.2-1.1">Type name:</dt>
            <dd id="section-10.8.2-1.2" style="margin-left: 1.5em"> application<a class="pilcrow" href="#section-10.8.2-1.2">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.8.2-1.3">Subtype name:</dt>
            <dd id="section-10.8.2-1.4" style="margin-left: 1.5em"> cid-edhoc+cbor-seq<a class="pilcrow" href="#section-10.8.2-1.4">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.8.2-1.5">Required parameters:</dt>
            <dd id="section-10.8.2-1.6" style="margin-left: 1.5em"> N/A<a class="pilcrow" href="#section-10.8.2-1.6">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.8.2-1.7">Optional parameters:</dt>
            <dd id="section-10.8.2-1.8" style="margin-left: 1.5em"> N/A<a class="pilcrow" href="#section-10.8.2-1.8">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.8.2-1.9">Encoding considerations:</dt>
            <dd id="section-10.8.2-1.10" style="margin-left: 1.5em"> binary<a class="pilcrow" href="#section-10.8.2-1.10">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.8.2-1.11">Security considerations:</dt>
            <dd id="section-10.8.2-1.12" style="margin-left: 1.5em"> See <a class="auto internal xref" href="#duplication">Section 7</a> of RFC 9528.<a class="pilcrow" href="#section-10.8.2-1.12">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.8.2-1.13">Interoperability considerations:</dt>
            <dd id="section-10.8.2-1.14" style="margin-left: 1.5em"> N/A<a class="pilcrow" href="#section-10.8.2-1.14">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.8.2-1.15">Published specification:</dt>
            <dd id="section-10.8.2-1.16" style="margin-left: 1.5em">RFC 9528<a class="pilcrow" href="#section-10.8.2-1.16">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.8.2-1.17">Applications that use this media type:</dt>
            <dd id="section-10.8.2-1.18" style="margin-left: 1.5em"> To be identified<a class="pilcrow" href="#section-10.8.2-1.18">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.8.2-1.19">Fragment identifier considerations:</dt>
            <dd id="section-10.8.2-1.20" style="margin-left: 1.5em"> N/A<a class="pilcrow" href="#section-10.8.2-1.20">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.8.2-1.21">Additional information:</dt>
            <dd id="section-10.8.2-1.22" style="margin-left: 1.5em">
              <p id="section-10.8.2-1.22.1"><br/></p>
<span class="break"></span><dl class="dlParallel" id="section-10.8.2-1.22.2">
                <dt id="section-10.8.2-1.22.2.1">Magic number(s):</dt>
                <dd id="section-10.8.2-1.22.2.2" style="margin-left: 1.5em"> N/A<a class="pilcrow" href="#section-10.8.2-1.22.2.2">¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-10.8.2-1.22.2.3">File extension(s):</dt>
                <dd id="section-10.8.2-1.22.2.4" style="margin-left: 1.5em"> N/A<a class="pilcrow" href="#section-10.8.2-1.22.2.4">¶</a>
</dd>
                <dd class="break"></dd>
<dt id="section-10.8.2-1.22.2.5">Macintosh file type code(s):</dt>
                <dd id="section-10.8.2-1.22.2.6" style="margin-left: 1.5em"> N/A<a class="pilcrow" href="#section-10.8.2-1.22.2.6">¶</a>
</dd>
              <dd class="break"></dd>
</dl>
</dd>
            <dd class="break"></dd>
<dt id="section-10.8.2-1.23">Person &amp; email address to contact for further information:</dt>
            <dd id="section-10.8.2-1.24" style="margin-left: 1.5em"> See "Authors' Addresses" section in RFC 9528.<a class="pilcrow" href="#section-10.8.2-1.24">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.8.2-1.25">Intended usage:</dt>
            <dd id="section-10.8.2-1.26" style="margin-left: 1.5em"> COMMON<a class="pilcrow" href="#section-10.8.2-1.26">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.8.2-1.27">Restrictions on usage:</dt>
            <dd id="section-10.8.2-1.28" style="margin-left: 1.5em"> N/A<a class="pilcrow" href="#section-10.8.2-1.28">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.8.2-1.29">Author:</dt>
            <dd id="section-10.8.2-1.30" style="margin-left: 1.5em"> See "Authors' Addresses" section.<a class="pilcrow" href="#section-10.8.2-1.30">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-10.8.2-1.31">Change Controller:</dt>
            <dd id="section-10.8.2-1.32" style="margin-left: 1.5em"> IETF<a class="pilcrow" href="#section-10.8.2-1.32">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="content-format">
<section id="section-10.9">
        <h3 id="name-coap-content-formats-regist">
<a class="section-number selfRef" href="#section-10.9">10.9. </a><a class="section-name selfRef" href="#name-coap-content-formats-regist">CoAP Content-Formats Registry</a>
        </h3>
<p id="section-10.9-1">IANA has added the media types "application/edhoc+cbor-seq" and "application/cid-edhoc+cbor-seq" to the "CoAP Content-Formats" registry under the registry group "Constrained RESTful Environments (CoRE) Parameters".<a class="pilcrow" href="#section-10.9-1">¶</a></p>
<span id="name-coap-content-format-ids"></span><div id="tab-format-ids">
<table class="center" id="table-13">
          <caption>
<a class="selfRef" href="#table-13">Table 13</a>:
<a class="selfRef" href="#name-coap-content-format-ids">CoAP Content-Format IDs</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Content Type</th>
              <th class="text-left" colspan="1" rowspan="1">Content Coding</th>
              <th class="text-left" colspan="1" rowspan="1">ID</th>
              <th class="text-left" colspan="1" rowspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">application/edhoc+cbor-seq</td>
              <td class="text-left" colspan="1" rowspan="1">-</td>
              <td class="text-left" colspan="1" rowspan="1">64</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9528</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">application/cid-edhoc+cbor-seq</td>
              <td class="text-left" colspan="1" rowspan="1">-</td>
              <td class="text-left" colspan="1" rowspan="1">65</td>
              <td class="text-left" colspan="1" rowspan="1">RFC 9528</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="rt">
<section id="section-10.10">
        <h3 id="name-resource-type-rt-link-targe">
<a class="section-number selfRef" href="#section-10.10">10.10. </a><a class="section-name selfRef" href="#name-resource-type-rt-link-targe">Resource Type (rt=) Link Target Attribute Values Registry</a>
        </h3>
<p id="section-10.10-1">IANA has added the resource type "core.edhoc" to the "Resource Type (rt=) Link Target Attribute Values" registry under the registry group "Constrained RESTful Environments (CoRE) Parameters".<a class="pilcrow" href="#section-10.10-1">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-10.10-2">
          <dt id="section-10.10-2.1">Value:</dt>
          <dd id="section-10.10-2.2" style="margin-left: 1.5em">core.edhoc<a class="pilcrow" href="#section-10.10-2.2">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-10.10-2.3">Description:</dt>
          <dd id="section-10.10-2.4" style="margin-left: 1.5em">EDHOC resource<a class="pilcrow" href="#section-10.10-2.4">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-10.10-2.5">Reference:</dt>
          <dd id="section-10.10-2.6" style="margin-left: 1.5em">RFC 9528<a class="pilcrow" href="#section-10.10-2.6">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="expert-review-instructions">
<section id="section-10.11">
        <h3 id="name-expert-review-instructions">
<a class="section-number selfRef" href="#section-10.11">10.11. </a><a class="section-name selfRef" href="#name-expert-review-instructions">Expert Review Instructions</a>
        </h3>
<p id="section-10.11-1">The IANA registries established in this document are defined as "Expert Review",  "Specification Required", or "Standards Action with Expert Review". This section gives some general guidelines for what the experts should be looking for, but they are being designated as experts for a reason so they should be given substantial latitude.<a class="pilcrow" href="#section-10.11-1">¶</a></p>
<p id="section-10.11-2">Expert reviewers should take into consideration the following points:<a class="pilcrow" href="#section-10.11-2">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.11-3.1">The clarity and correctness of registrations. Experts are expected to check the clarity of purpose and use of the requested entries. Expert needs to make sure the values of algorithms are taken from the right registry when that is required. Experts should consider requesting an opinion on the correctness of registered parameters from relevant IETF working groups. Encodings that do not meet these objectives of clarity and completeness should not be registered.<a class="pilcrow" href="#section-10.11-3.1">¶</a>
</li>
          <li class="normal" id="section-10.11-3.2">The expected usage of fields when approving code point assignment. The length of the encoded value should be weighed against how many code points of that length are left, the size of device it will be used on, and the number of code points left that encode to that size.<a class="pilcrow" href="#section-10.11-3.2">¶</a>
</li>
          <li class="normal" id="section-10.11-3.3">It is recommended to have a specification even if the registration procedure is "Expert Review". When specifications are not provided for a request where Expert Review is the assignment policy, the description provided needs to have sufficient information to verify the code points as above.<a class="pilcrow" href="#section-10.11-3.3">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<section id="section-11">
      <h2 id="name-references">
<a class="section-number selfRef" href="#section-11">11. </a><a class="section-name selfRef" href="#name-references">References</a>
      </h2>
<section id="section-11.1">
        <h3 id="name-normative-references">
<a class="section-number selfRef" href="#section-11.1">11.1. </a><a class="section-name selfRef" href="#name-normative-references">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time class="refDate" datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3279">[RFC3279]</dt>
        <dd>
<span class="refAuthor">Bassham, L.</span>, <span class="refAuthor">Polk, W.</span>, and <span class="refAuthor">R. Housley</span>, <span class="refTitle">"Algorithms and Identifiers for the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 3279</span>, <span class="seriesInfo">DOI 10.17487/RFC3279</span>, <time class="refDate" datetime="2002-04">April 2002</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3279">https://www.rfc-editor.org/info/rfc3279</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3552">[RFC3552]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span> and <span class="refAuthor">B. Korver</span>, <span class="refTitle">"Guidelines for Writing RFC Text on Security Considerations"</span>, <span class="seriesInfo">BCP 72</span>, <span class="seriesInfo">RFC 3552</span>, <span class="seriesInfo">DOI 10.17487/RFC3552</span>, <time class="refDate" datetime="2003-07">July 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3552">https://www.rfc-editor.org/info/rfc3552</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5116">[RFC5116]</dt>
        <dd>
<span class="refAuthor">McGrew, D.</span>, <span class="refTitle">"An Interface and Algorithms for Authenticated Encryption"</span>, <span class="seriesInfo">RFC 5116</span>, <span class="seriesInfo">DOI 10.17487/RFC5116</span>, <time class="refDate" datetime="2008-01">January 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5116">https://www.rfc-editor.org/info/rfc5116</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5869">[RFC5869]</dt>
        <dd>
<span class="refAuthor">Krawczyk, H.</span> and <span class="refAuthor">P. Eronen</span>, <span class="refTitle">"HMAC-based Extract-and-Expand Key Derivation Function (HKDF)"</span>, <span class="seriesInfo">RFC 5869</span>, <span class="seriesInfo">DOI 10.17487/RFC5869</span>, <time class="refDate" datetime="2010-05">May 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5869">https://www.rfc-editor.org/info/rfc5869</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6090">[RFC6090]</dt>
        <dd>
<span class="refAuthor">McGrew, D.</span>, <span class="refAuthor">Igoe, K.</span>, and <span class="refAuthor">M. Salter</span>, <span class="refTitle">"Fundamental Elliptic Curve Cryptography Algorithms"</span>, <span class="seriesInfo">RFC 6090</span>, <span class="seriesInfo">DOI 10.17487/RFC6090</span>, <time class="refDate" datetime="2011-02">February 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6090">https://www.rfc-editor.org/info/rfc6090</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6960">[RFC6960]</dt>
        <dd>
<span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Myers, M.</span>, <span class="refAuthor">Ankney, R.</span>, <span class="refAuthor">Malpani, A.</span>, <span class="refAuthor">Galperin, S.</span>, and <span class="refAuthor">C. Adams</span>, <span class="refTitle">"X.509 Internet Public Key Infrastructure Online Certificate Status Protocol - OCSP"</span>, <span class="seriesInfo">RFC 6960</span>, <span class="seriesInfo">DOI 10.17487/RFC6960</span>, <time class="refDate" datetime="2013-06">June 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6960">https://www.rfc-editor.org/info/rfc6960</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6979">[RFC6979]</dt>
        <dd>
<span class="refAuthor">Pornin, T.</span>, <span class="refTitle">"Deterministic Usage of the Digital Signature Algorithm (DSA) and Elliptic Curve Digital Signature Algorithm (ECDSA)"</span>, <span class="seriesInfo">RFC 6979</span>, <span class="seriesInfo">DOI 10.17487/RFC6979</span>, <time class="refDate" datetime="2013-08">August 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6979">https://www.rfc-editor.org/info/rfc6979</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7252">[RFC7252]</dt>
        <dd>
<span class="refAuthor">Shelby, Z.</span>, <span class="refAuthor">Hartke, K.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"The Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7252</span>, <span class="seriesInfo">DOI 10.17487/RFC7252</span>, <time class="refDate" datetime="2014-06">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7252">https://www.rfc-editor.org/info/rfc7252</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7748">[RFC7748]</dt>
        <dd>
<span class="refAuthor">Langley, A.</span>, <span class="refAuthor">Hamburg, M.</span>, and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"Elliptic Curves for Security"</span>, <span class="seriesInfo">RFC 7748</span>, <span class="seriesInfo">DOI 10.17487/RFC7748</span>, <time class="refDate" datetime="2016-01">January 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7748">https://www.rfc-editor.org/info/rfc7748</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7959">[RFC7959]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span> and <span class="refAuthor">Z. Shelby, Ed.</span>, <span class="refTitle">"Block-Wise Transfers in the Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7959</span>, <span class="seriesInfo">DOI 10.17487/RFC7959</span>, <time class="refDate" datetime="2016-08">August 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7959">https://www.rfc-editor.org/info/rfc7959</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time class="refDate" datetime="2017-06">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time class="refDate" datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8392">[RFC8392]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Wahlstroem, E.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"CBOR Web Token (CWT)"</span>, <span class="seriesInfo">RFC 8392</span>, <span class="seriesInfo">DOI 10.17487/RFC8392</span>, <time class="refDate" datetime="2018-05">May 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8392">https://www.rfc-editor.org/info/rfc8392</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8410">[RFC8410]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span> and <span class="refAuthor">J. Schaad</span>, <span class="refTitle">"Algorithm Identifiers for Ed25519, Ed448, X25519, and X448 for Use in the Internet X.509 Public Key Infrastructure"</span>, <span class="seriesInfo">RFC 8410</span>, <span class="seriesInfo">DOI 10.17487/RFC8410</span>, <time class="refDate" datetime="2018-08">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8410">https://www.rfc-editor.org/info/rfc8410</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8610">[RFC8610]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Vigano, C.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"Concise Data Definition Language (CDDL): A Notational Convention to Express Concise Binary Object Representation (CBOR) and JSON Data Structures"</span>, <span class="seriesInfo">RFC 8610</span>, <span class="seriesInfo">DOI 10.17487/RFC8610</span>, <time class="refDate" datetime="2019-06">June 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8610">https://www.rfc-editor.org/info/rfc8610</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8613">[RFC8613]</dt>
        <dd>
<span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Mattsson, J.</span>, <span class="refAuthor">Palombini, F.</span>, and <span class="refAuthor">L. Seitz</span>, <span class="refTitle">"Object Security for Constrained RESTful Environments (OSCORE)"</span>, <span class="seriesInfo">RFC 8613</span>, <span class="seriesInfo">DOI 10.17487/RFC8613</span>, <time class="refDate" datetime="2019-07">July 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8613">https://www.rfc-editor.org/info/rfc8613</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8724">[RFC8724]</dt>
        <dd>
<span class="refAuthor">Minaburo, A.</span>, <span class="refAuthor">Toutain, L.</span>, <span class="refAuthor">Gomez, C.</span>, <span class="refAuthor">Barthel, D.</span>, and <span class="refAuthor">JC. Zuniga</span>, <span class="refTitle">"SCHC: Generic Framework for Static Context Header Compression and Fragmentation"</span>, <span class="seriesInfo">RFC 8724</span>, <span class="seriesInfo">DOI 10.17487/RFC8724</span>, <time class="refDate" datetime="2020-04">April 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8724">https://www.rfc-editor.org/info/rfc8724</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8742">[RFC8742]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR) Sequences"</span>, <span class="seriesInfo">RFC 8742</span>, <span class="seriesInfo">DOI 10.17487/RFC8742</span>, <time class="refDate" datetime="2020-02">February 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8742">https://www.rfc-editor.org/info/rfc8742</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8747">[RFC8747]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Seitz, L.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Proof-of-Possession Key Semantics for CBOR Web Tokens (CWTs)"</span>, <span class="seriesInfo">RFC 8747</span>, <span class="seriesInfo">DOI 10.17487/RFC8747</span>, <time class="refDate" datetime="2020-03">March 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8747">https://www.rfc-editor.org/info/rfc8747</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8949">[RFC8949]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span> and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">STD 94</span>, <span class="seriesInfo">RFC 8949</span>, <span class="seriesInfo">DOI 10.17487/RFC8949</span>, <time class="refDate" datetime="2020-12">December 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8949">https://www.rfc-editor.org/info/rfc8949</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9052">[RFC9052]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Structures and Process"</span>, <span class="seriesInfo">STD 96</span>, <span class="seriesInfo">RFC 9052</span>, <span class="seriesInfo">DOI 10.17487/RFC9052</span>, <time class="refDate" datetime="2022-08">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9052">https://www.rfc-editor.org/info/rfc9052</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9053">[RFC9053]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Initial Algorithms"</span>, <span class="seriesInfo">RFC 9053</span>, <span class="seriesInfo">DOI 10.17487/RFC9053</span>, <time class="refDate" datetime="2022-08">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9053">https://www.rfc-editor.org/info/rfc9053</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9175">[RFC9175]</dt>
        <dd>
<span class="refAuthor">Amsüss, C.</span>, <span class="refAuthor">Preuß Mattsson, J.</span>, and <span class="refAuthor">G. Selander</span>, <span class="refTitle">"Constrained Application Protocol (CoAP): Echo, Request-Tag, and Token Processing"</span>, <span class="seriesInfo">RFC 9175</span>, <span class="seriesInfo">DOI 10.17487/RFC9175</span>, <time class="refDate" datetime="2022-02">February 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9175">https://www.rfc-editor.org/info/rfc9175</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9360">[RFC9360]</dt>
      <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Header Parameters for Carrying and Referencing X.509 Certificates"</span>, <span class="seriesInfo">RFC 9360</span>, <span class="seriesInfo">DOI 10.17487/RFC9360</span>, <time class="refDate" datetime="2023-02">February 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9360">https://www.rfc-editor.org/info/rfc9360</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-11.2">
        <h3 id="name-informative-references">
<a class="section-number selfRef" href="#section-11.2">11.2. </a><a class="section-name selfRef" href="#name-informative-references">Informative References</a>
        </h3>
<dl class="references">
<dt id="Bruni18">[Bruni18]</dt>
        <dd>
<span class="refAuthor">Bruni, A.</span>, <span class="refAuthor">Sahl Jørgensen, T.</span>, <span class="refAuthor">Grønbech Petersen, T.</span>, and <span class="refAuthor">C. Schürmann</span>, <span class="refTitle">"Formal Verification of Ephemeral Diffie-Hellman Over COSE (EDHOC)"</span>, <time class="refDate" datetime="2018-11">November 2018</time>, <span>&lt;<a href="https://www.springerprofessional.de/en/formal-verification-of-ephemeral-diffie-hellman-over-cose-edhoc/16284348">https://www.springerprofessional.de/en/formal-verification-of-ephemeral-diffie-hellman-over-cose-edhoc/16284348</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-cose-cbor-encoded-cert">[C509-CERTS]</dt>
        <dd>
<span class="refAuthor">Preuß Mattsson, J.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Raza, S.</span>, <span class="refAuthor">Höglund, J.</span>, and <span class="refAuthor">M. Furuhed</span>, <span class="refTitle">"CBOR Encoded X.509 Certificates (C509 Certificates)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-cose-cbor-encoded-cert-09</span>, <time class="refDate" datetime="2024-03-04">4 March 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-cose-cbor-encoded-cert-09">https://datatracker.ietf.org/doc/html/draft-ietf-cose-cbor-encoded-cert-09</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="CborMe">[CborMe]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span>, <span class="refTitle">"CBOR Playground"</span>, <span>&lt;<a href="https://cbor.me/">https://cbor.me/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="CNSA">[CNSA]</dt>
        <dd>
<span class="refAuthor">Wikipedia</span>, <span class="refTitle">"Commercial National Security Algorithm Suite"</span>, <time class="refDate" datetime="2023-10">October 2023</time>, <span>&lt;<a href="https://en.wikipedia.org/w/index.php?title=Commercial_National_Security_Algorithm_Suite&amp;oldid=1181333611">https://en.wikipedia.org/w/index.php?title=Commercial_National_Security_Algorithm_Suite&amp;oldid=1181333611</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-iotops-security-protocol-comparison">[CoAP-SEC-PROT]</dt>
        <dd>
<span class="refAuthor">Mattsson, J. P.</span>, <span class="refAuthor">Palombini, F.</span>, and <span class="refAuthor">M. Vučinić</span>, <span class="refTitle">"Comparison of CoAP Security Protocols"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-iotops-security-protocol-comparison-04</span>, <time class="refDate" datetime="2024-03-04">4 March 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-iotops-security-protocol-comparison-04">https://datatracker.ietf.org/doc/html/draft-ietf-iotops-security-protocol-comparison-04</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="CottierPointcheval22">[CottierPointcheval22]</dt>
        <dd>
<span class="refAuthor">Cottier, B.</span> and <span class="refAuthor">D. Pointcheval</span>, <span class="refTitle">"Security Analysis of the EDHOC protocol"</span>, <time class="refDate" datetime="2022-09">September 2022</time>, <span>&lt;<a href="https://arxiv.org/abs/2209.03599">https://arxiv.org/abs/2209.03599</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-lwig-curve-representations">[CURVE-REPR]</dt>
        <dd>
<span class="refAuthor">Struik, R.</span>, <span class="refTitle">"Alternative Elliptic Curve Representations"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-lwig-curve-representations-23</span>, <time class="refDate" datetime="2022-01-21">21 January 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-lwig-curve-representations-23">https://datatracker.ietf.org/doc/html/draft-ietf-lwig-curve-representations-23</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Degabriele11">[Degabriele11]</dt>
        <dd>
<span class="refAuthor">Degabriele, J.</span>, <span class="refAuthor">Lehmann, A.</span>, <span class="refAuthor">Paterson, K.</span>, <span class="refAuthor">Smart, N.</span>, and <span class="refAuthor">M. Strefler</span>, <span class="refTitle">"On the Joint Security of Encryption and Signature in EMV"</span>, <time class="refDate" datetime="2011-12">December 2011</time>, <span>&lt;<a href="https://eprint.iacr.org/2011/615">https://eprint.iacr.org/2011/615</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-rats-eat">[EAT]</dt>
        <dd>
<span class="refAuthor">Lundblade, L.</span>, <span class="refAuthor">Mandyam, G.</span>, <span class="refAuthor">O'Donoghue, J.</span>, and <span class="refAuthor">C. Wallace</span>, <span class="refTitle">"The Entity Attestation Token (EAT)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-rats-eat-25</span>, <time class="refDate" datetime="2024-01-15">15 January 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-eat-25">https://datatracker.ietf.org/doc/html/draft-ietf-rats-eat-25</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-core-oscore-edhoc">[EDHOC-CoAP-OSCORE]</dt>
        <dd>
<span class="refAuthor">Palombini, F.</span>, <span class="refAuthor">Tiloca, M.</span>, <span class="refAuthor">Höglund, R.</span>, <span class="refAuthor">Hristozov, S.</span>, and <span class="refAuthor">G. Selander</span>, <span class="refTitle">"Using Ephemeral Diffie-Hellman Over COSE (EDHOC) with the Constrained Application Protocol (CoAP) and Object Security for Constrained RESTful Environments (OSCORE)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-core-oscore-edhoc-10</span>, <time class="refDate" datetime="2023-11-29">29 November 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-edhoc-10">https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-edhoc-10</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="GuentherIlunga22">[GuentherIlunga22]</dt>
        <dd>
<span class="refAuthor">Günther, F.</span> and <span class="refAuthor">M. Mukendi</span>, <span class="refTitle">"Careful with MAc-then-SIGn: A Computational Analysis of the EDHOC Lightweight Authenticated Key Exchange Protocol"</span>, <time class="refDate" datetime="2022-12">December 2022</time>, <span>&lt;<a href="https://eprint.iacr.org/2022/1705">https://eprint.iacr.org/2022/1705</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.irtf-cfrg-det-sigs-with-noise">[HEDGED-ECC-SIGS]</dt>
        <dd>
<span class="refAuthor">Preuß Mattsson, J.</span>, <span class="refAuthor">Thormarker, E.</span>, and <span class="refAuthor">S. Ruohomaa</span>, <span class="refTitle">"Hedged ECDSA and EdDSA Signatures"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-irtf-cfrg-det-sigs-with-noise-02</span>, <time class="refDate" datetime="2024-03-01">1 March 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-det-sigs-with-noise-02">https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-det-sigs-with-noise-02</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="HKDFpaper">[HKDFpaper]</dt>
        <dd>
<span class="refAuthor">Krawczyk, H.</span>, <span class="refTitle">"Cryptographic Extraction and Key Derivation: The HKDF Scheme"</span>, <time class="refDate" datetime="2010-05">May 2010</time>, <span>&lt;<a href="https://eprint.iacr.org/2010/264.pdf">https://eprint.iacr.org/2010/264.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IEEE.802.15.4-2015">[IEEE.802.15.4-2015]</dt>
        <dd>
<span class="refAuthor">IEEE</span>, <span class="refTitle">"IEEE Standard for Low-Rate Wireless Networks"</span>, <span class="seriesInfo">DOI 10.1109/IEEESTD.2016.7460875</span>, <time class="refDate" datetime="2016-04">April 2016</time>, <span>&lt;<a href="https://ieeexplore.ieee.org/document/7460875">https://ieeexplore.ieee.org/document/7460875</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Jacomme23">[Jacomme23]</dt>
        <dd>
<span class="refAuthor">Jacomme, C.</span>, <span class="refAuthor">Klein, E.</span>, <span class="refAuthor">Kremer, S.</span>, and <span class="refAuthor">M. Racouchot</span>, <span class="refTitle">"A comprehensive, formal and automated analysis of the EDHOC protocol"</span>, <time class="refDate" datetime="2022-10">October 2022</time>, <span>&lt;<a href="https://hal.inria.fr/hal-03810102/">https://hal.inria.fr/hal-03810102/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-core-oscore-key-update">[KUDOS]</dt>
        <dd>
<span class="refAuthor">Höglund, R.</span> and <span class="refAuthor">M. Tiloca</span>, <span class="refTitle">"Key Update for OSCORE (KUDOS)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-core-oscore-key-update-07</span>, <time class="refDate" datetime="2024-03-04">4 March 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-key-update-07">https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-key-update-07</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-lake-authz">[LAKE-AUTHZ]</dt>
        <dd>
<span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Mattsson, J. P.</span>, <span class="refAuthor">Vučinić, M.</span>, <span class="refAuthor">Fedrecheski, G.</span>, and <span class="refAuthor">M. Richardson</span>, <span class="refTitle">"Lightweight Authorization using Ephemeral Diffie-Hellman Over COSE"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-lake-authz-01</span>, <time class="refDate" datetime="2024-03-04">4 March 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-lake-authz-01">https://datatracker.ietf.org/doc/html/draft-ietf-lake-authz-01</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-lake-reqs">[LAKE-REQS]</dt>
        <dd>
<span class="refAuthor">Vučinić, M.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Preuß Mattsson, J.</span>, and <span class="refAuthor">D. Garcia-Carillo</span>, <span class="refTitle">"Requirements for a Lightweight AKE for OSCORE"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-lake-reqs-04</span>, <time class="refDate" datetime="2020-06-08">8 June 2020</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-lake-reqs-04">https://datatracker.ietf.org/doc/html/draft-ietf-lake-reqs-04</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="NISTPQC">[NISTPQC]</dt>
        <dd>
<span class="refAuthor">National Institute Standards and Technology (NIST)</span>, <span class="refTitle">"Post-Quantum Cryptography FAQs"</span>, <span>&lt;<a href="https://csrc.nist.gov/Projects/post-quantum-cryptography/faqs">https://csrc.nist.gov/Projects/post-quantum-cryptography/faqs</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Noise">[Noise]</dt>
        <dd>
<span class="refAuthor">Perrin, T.</span>, <span class="refTitle">"The Noise Protocol Framework"</span>, <span class="refContent">Revision 34</span>, <time class="refDate" datetime="2018-07">July 2018</time>, <span>&lt;<a href="https://noiseprotocol.org/noise.html">https://noiseprotocol.org/noise.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Norrman20">[Norrman20]</dt>
        <dd>
<span class="refAuthor">Norrman, K.</span>, <span class="refAuthor">Sundararajan, V.</span>, and <span class="refAuthor">A. Bruni</span>, <span class="refTitle">"Formal Analysis of EDHOC Key Establishment for Constrained IoT Devices"</span>, <time class="refDate" datetime="2020-09">September 2020</time>, <span>&lt;<a href="https://arxiv.org/abs/2007.11427">https://arxiv.org/abs/2007.11427</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2986">[RFC2986]</dt>
        <dd>
<span class="refAuthor">Nystrom, M.</span> and <span class="refAuthor">B. Kaliski</span>, <span class="refTitle">"PKCS #10: Certification Request Syntax Specification Version 1.7"</span>, <span class="seriesInfo">RFC 2986</span>, <span class="seriesInfo">DOI 10.17487/RFC2986</span>, <time class="refDate" datetime="2000-11">November 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2986">https://www.rfc-editor.org/info/rfc2986</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time class="refDate" datetime="2008-05">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5280">https://www.rfc-editor.org/info/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6194">[RFC6194]</dt>
        <dd>
<span class="refAuthor">Polk, T.</span>, <span class="refAuthor">Chen, L.</span>, <span class="refAuthor">Turner, S.</span>, and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Security Considerations for the SHA-0 and SHA-1 Message-Digest Algorithms"</span>, <span class="seriesInfo">RFC 6194</span>, <span class="seriesInfo">DOI 10.17487/RFC6194</span>, <time class="refDate" datetime="2011-03">March 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6194">https://www.rfc-editor.org/info/rfc6194</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7228">[RFC7228]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span>, <span class="refAuthor">Ersue, M.</span>, and <span class="refAuthor">A. Keranen</span>, <span class="refTitle">"Terminology for Constrained-Node Networks"</span>, <span class="seriesInfo">RFC 7228</span>, <span class="seriesInfo">DOI 10.17487/RFC7228</span>, <time class="refDate" datetime="2014-05">May 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7228">https://www.rfc-editor.org/info/rfc7228</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7258">[RFC7258]</dt>
        <dd>
<span class="refAuthor">Farrell, S.</span> and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Pervasive Monitoring Is an Attack"</span>, <span class="seriesInfo">BCP 188</span>, <span class="seriesInfo">RFC 7258</span>, <span class="seriesInfo">DOI 10.17487/RFC7258</span>, <time class="refDate" datetime="2014-05">May 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7258">https://www.rfc-editor.org/info/rfc7258</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7296">[RFC7296]</dt>
        <dd>
<span class="refAuthor">Kaufman, C.</span>, <span class="refAuthor">Hoffman, P.</span>, <span class="refAuthor">Nir, Y.</span>, <span class="refAuthor">Eronen, P.</span>, and <span class="refAuthor">T. Kivinen</span>, <span class="refTitle">"Internet Key Exchange Protocol Version 2 (IKEv2)"</span>, <span class="seriesInfo">STD 79</span>, <span class="seriesInfo">RFC 7296</span>, <span class="seriesInfo">DOI 10.17487/RFC7296</span>, <time class="refDate" datetime="2014-10">October 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7296">https://www.rfc-editor.org/info/rfc7296</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7624">[RFC7624]</dt>
        <dd>
<span class="refAuthor">Barnes, R.</span>, <span class="refAuthor">Schneier, B.</span>, <span class="refAuthor">Jennings, C.</span>, <span class="refAuthor">Hardie, T.</span>, <span class="refAuthor">Trammell, B.</span>, <span class="refAuthor">Huitema, C.</span>, and <span class="refAuthor">D. Borkmann</span>, <span class="refTitle">"Confidentiality in the Face of Pervasive Surveillance: A Threat Model and Problem Statement"</span>, <span class="seriesInfo">RFC 7624</span>, <span class="seriesInfo">DOI 10.17487/RFC7624</span>, <time class="refDate" datetime="2015-08">August 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7624">https://www.rfc-editor.org/info/rfc7624</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8366">[RFC8366]</dt>
        <dd>
<span class="refAuthor">Watsen, K.</span>, <span class="refAuthor">Richardson, M.</span>, <span class="refAuthor">Pritikin, M.</span>, and <span class="refAuthor">T. Eckert</span>, <span class="refTitle">"A Voucher Artifact for Bootstrapping Protocols"</span>, <span class="seriesInfo">RFC 8366</span>, <span class="seriesInfo">DOI 10.17487/RFC8366</span>, <time class="refDate" datetime="2018-05">May 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8366">https://www.rfc-editor.org/info/rfc8366</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8376">[RFC8376]</dt>
        <dd>
<span class="refAuthor">Farrell, S., Ed.</span>, <span class="refTitle">"Low-Power Wide Area Network (LPWAN) Overview"</span>, <span class="seriesInfo">RFC 8376</span>, <span class="seriesInfo">DOI 10.17487/RFC8376</span>, <time class="refDate" datetime="2018-05">May 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8376">https://www.rfc-editor.org/info/rfc8376</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time class="refDate" datetime="2018-08">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8937">[RFC8937]</dt>
        <dd>
<span class="refAuthor">Cremers, C.</span>, <span class="refAuthor">Garratt, L.</span>, <span class="refAuthor">Smyshlyaev, S.</span>, <span class="refAuthor">Sullivan, N.</span>, and <span class="refAuthor">C. Wood</span>, <span class="refTitle">"Randomness Improvements for Security Protocols"</span>, <span class="seriesInfo">RFC 8937</span>, <span class="seriesInfo">DOI 10.17487/RFC8937</span>, <time class="refDate" datetime="2020-10">October 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8937">https://www.rfc-editor.org/info/rfc8937</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9000">[RFC9000]</dt>
        <dd>
<span class="refAuthor">Iyengar, J., Ed.</span> and <span class="refAuthor">M. Thomson, Ed.</span>, <span class="refTitle">"QUIC: A UDP-Based Multiplexed and Secure Transport"</span>, <span class="seriesInfo">RFC 9000</span>, <span class="seriesInfo">DOI 10.17487/RFC9000</span>, <time class="refDate" datetime="2021-05">May 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9000">https://www.rfc-editor.org/info/rfc9000</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9147">[RFC9147]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refAuthor">Tschofenig, H.</span>, and <span class="refAuthor">N. Modadugu</span>, <span class="refTitle">"The Datagram Transport Layer Security (DTLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 9147</span>, <span class="seriesInfo">DOI 10.17487/RFC9147</span>, <time class="refDate" datetime="2022-04">April 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9147">https://www.rfc-editor.org/info/rfc9147</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9176">[RFC9176]</dt>
        <dd>
<span class="refAuthor">Amsüss, C., Ed.</span>, <span class="refAuthor">Shelby, Z.</span>, <span class="refAuthor">Koster, M.</span>, <span class="refAuthor">Bormann, C.</span>, and <span class="refAuthor">P. van der Stok</span>, <span class="refTitle">"Constrained RESTful Environments (CoRE) Resource Directory"</span>, <span class="seriesInfo">RFC 9176</span>, <span class="seriesInfo">DOI 10.17487/RFC9176</span>, <time class="refDate" datetime="2022-04">April 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9176">https://www.rfc-editor.org/info/rfc9176</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9397">[RFC9397]</dt>
        <dd>
<span class="refAuthor">Pei, M.</span>, <span class="refAuthor">Tschofenig, H.</span>, <span class="refAuthor">Thaler, D.</span>, and <span class="refAuthor">D. Wheeler</span>, <span class="refTitle">"Trusted Execution Environment Provisioning (TEEP) Architecture"</span>, <span class="seriesInfo">RFC 9397</span>, <span class="seriesInfo">DOI 10.17487/RFC9397</span>, <time class="refDate" datetime="2023-07">July 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9397">https://www.rfc-editor.org/info/rfc9397</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9529">[RFC9529]</dt>
        <dd>
<span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Preuß Mattsson, J.</span>, <span class="refAuthor">Serafin, M.</span>, <span class="refAuthor">Tiloca, M.</span>, and <span class="refAuthor">M. Vučinić</span>, <span class="refTitle">"Traces of Ephemeral Diffie-Hellman Over COSE (EDHOC)"</span>, <span class="seriesInfo">RFC 9529</span>, <span class="seriesInfo">DOI 10.17487/RFC9529</span>, <time class="refDate" datetime="2024-03">March 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9529">https://www.rfc-editor.org/info/rfc9529</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SECG">[SECG]</dt>
        <dd>
<span class="refAuthor">Certicom Research</span>, <span class="refTitle">"SEC 1: Elliptic Curve Cryptography"</span>, <span class="refContent">Standards for Efficient Cryptography</span>, <time class="refDate" datetime="2009-05">May 2009</time>, <span>&lt;<a href="https://www.secg.org/sec1-v2.pdf">https://www.secg.org/sec1-v2.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SIGMA">[SIGMA]</dt>
        <dd>
<span class="refAuthor">Krawczyk, H.</span>, <span class="refTitle">"SIGMA: the 'SIGn-and-MAc' Approach to Authenticated Diffie-Hellman and Its Use in the IKE-Protocols"</span>, <time class="refDate" datetime="2003-06">June 2003</time>, <span>&lt;<a href="https://www.iacr.org/cryptodb/archive/2003/CRYPTO/1495/1495.pdf">https://www.iacr.org/cryptodb/archive/2003/CRYPTO/1495/1495.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SP-800-108">[SP-800-108]</dt>
        <dd>
<span class="refAuthor">Chen, L.</span>, <span class="refTitle">"Recommendation for Key Derivation Using Pseudorandom Functions"</span>, <span class="seriesInfo">NIST Special Publication 800-108 Revision 1</span>, <span class="seriesInfo">DOI 10.6028/NIST.SP.800-108r1-upd1</span>, <time class="refDate" datetime="2022-08">August 2022</time>, <span>&lt;<a href="https://doi.org/10.6028/NIST.SP.800-108r1-upd1">https://doi.org/10.6028/NIST.SP.800-108r1-upd1</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SP-800-56A">[SP-800-56A]</dt>
        <dd>
<span class="refAuthor">Barker, E.</span>, <span class="refAuthor">Chen, L.</span>, <span class="refAuthor">Roginsky, A.</span>, <span class="refAuthor">Vassilev, A.</span>, and <span class="refAuthor">R. Davis</span>, <span class="refTitle">"Recommendation for Pair-Wise Key-Establishment Schemes Using Discrete Logarithm Cryptography"</span>, <span class="seriesInfo">NIST Special Publication 800-56A Revision 3</span>, <span class="seriesInfo">DOI 10.6028/NIST.SP.800-56Ar3</span>, <time class="refDate" datetime="2018-04">April 2018</time>, <span>&lt;<a href="https://doi.org/10.6028/NIST.SP.800-56Ar3">https://doi.org/10.6028/NIST.SP.800-56Ar3</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SP800-185">[SP800-185]</dt>
        <dd>
<span class="refAuthor">Kelsey, J.</span>, <span class="refAuthor">Chang, S.</span>, and <span class="refAuthor">R. Perlner</span>, <span class="refTitle">"SHA-3 Derived Functions cSHAKE, KMAC, TupleHash and ParallelHash"</span>, <span class="seriesInfo">NIST Special Publication 800-185</span>, <span class="seriesInfo">DOI 10.6028/NIST.SP.800-185</span>, <time class="refDate" datetime="2016-12">December 2016</time>, <span>&lt;<a href="https://doi.org/10.6028/NIST.SP.800-185">https://doi.org/10.6028/NIST.SP.800-185</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Thormarker21">[Thormarker21]</dt>
        <dd>
<span class="refAuthor">Thormarker, E.</span>, <span class="refTitle">"On using the same key pair for Ed25519 and an X25519 based KEM"</span>, <time class="refDate" datetime="2021-04">April 2021</time>, <span>&lt;<a href="https://eprint.iacr.org/2021/509.pdf">https://eprint.iacr.org/2021/509.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.arkko-arch-internet-threat-model-guidance">[THREAT-MODEL-GUIDANCE]</dt>
      <dd>
<span class="refAuthor">Arkko, J.</span> and <span class="refAuthor">S. Farrell</span>, <span class="refTitle">"Internet Threat Model Guidance"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-arkko-arch-internet-threat-model-guidance-00</span>, <time class="refDate" datetime="2021-07-12">12 July 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-arkko-arch-internet-threat-model-guidance-00">https://datatracker.ietf.org/doc/html/draft-arkko-arch-internet-threat-model-guidance-00</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="transfer">
<section id="appendix-A">
      <h2 id="name-use-with-oscore-and-transfe">
<a class="section-number selfRef" href="#appendix-A">Appendix A. </a><a class="section-name selfRef" href="#name-use-with-oscore-and-transfe">Use with OSCORE and Transfer over CoAP</a>
      </h2>
<p id="appendix-A-1">This appendix describes how to derive an OSCORE security context when EDHOC is used to key OSCORE and how to transfer EDHOC messages over CoAP. The use of CoAP or OSCORE with EDHOC is optional, but if you are using CoAP or OSCORE, then certain normative requirements apply as detailed in the  subsections.<a class="pilcrow" href="#appendix-A-1">¶</a></p>
<div id="oscore-ctx-derivation">
<section id="appendix-A.1">
        <h3 id="name-deriving-the-oscore-securit">
<a class="section-number selfRef" href="#appendix-A.1">A.1. </a><a class="section-name selfRef" href="#name-deriving-the-oscore-securit">Deriving the OSCORE Security Context</a>
        </h3>
<p id="appendix-A.1-1">This section specifies how to use EDHOC output to derive the OSCORE security context.<a class="pilcrow" href="#appendix-A.1-1">¶</a></p>
<p id="appendix-A.1-2">After successful processing of EDHOC message_3, the Client and Server derive Security Context parameters for OSCORE as follows (see <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8613#section-3.2">Section 3.2</a> of [<a class="cite xref" href="#RFC8613">RFC8613</a>]</span>):<a class="pilcrow" href="#appendix-A.1-2">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.1-3.1">
            <p id="appendix-A.1-3.1.1">The Master Secret and Master Salt <span class="bcp14">SHALL</span> be derived by using the EDHOC_Exporter interface (see <a class="auto internal xref" href="#exporter">Section 4.2.1</a>):<a class="pilcrow" href="#appendix-A.1-3.1.1">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.1-3.1.2.1">The EDHOC Exporter Labels for deriving the OSCORE Master Secret and OSCORE Master Salt are the uints 0 and 1, respectively.<a class="pilcrow" href="#appendix-A.1-3.1.2.1">¶</a>
</li>
              <li class="normal" id="appendix-A.1-3.1.2.2">The context parameter is h'' (0x40), the empty CBOR byte string.<a class="pilcrow" href="#appendix-A.1-3.1.2.2">¶</a>
</li>
              <li class="normal" id="appendix-A.1-3.1.2.3">By default, oscore_key_length is the key length (in bytes) of the application AEAD Algorithm of the selected cipher suite for the EDHOC session. Also by default, oscore_salt_length has value 8. The Initiator and Responder <span class="bcp14">MAY</span> agree out-of-band on a longer oscore_key_length than the default and on shorter or
longer than the default oscore_salt_length.<a class="pilcrow" href="#appendix-A.1-3.1.2.3">¶</a>
</li>
            </ul>
</li>
        </ul>
<div class="alignLeft art-text artwork" id="appendix-A.1-4">
<pre>   Master Secret = EDHOC_Exporter( 0, h'', oscore_key_length )
   Master Salt   = EDHOC_Exporter( 1, h'', oscore_salt_length )
</pre><a class="pilcrow" href="#appendix-A.1-4">¶</a>
</div>
<ul class="normal">
<li class="normal" id="appendix-A.1-5.1">The AEAD Algorithm <span class="bcp14">SHALL</span> be the application AEAD algorithm of the selected cipher suite for the EDHOC session.<a class="pilcrow" href="#appendix-A.1-5.1">¶</a>
</li>
          <li class="normal" id="appendix-A.1-5.2">The HKDF Algorithm <span class="bcp14">SHALL</span> be the one based on the application hash algorithm of the selected cipher suite for the EDHOC session. For example, if SHA-256 is the application hash algorithm of the selected cipher suite, HKDF SHA-256 is used as the HKDF Algorithm in the OSCORE Security Context.<a class="pilcrow" href="#appendix-A.1-5.2">¶</a>
</li>
          <li class="normal" id="appendix-A.1-5.3">The relationship between identifiers in OSCORE and EDHOC is specified in <a class="auto internal xref" href="#ci-oscore">Section 3.3.3</a>. The OSCORE Sender ID and Recipient ID <span class="bcp14">SHALL</span> be determined by EDHOC connection identifiers C_R and C_I for the EDHOC session as shown in <a class="auto internal xref" href="#tab-edhoc-oscore-id-mapping">Table 14</a>.<a class="pilcrow" href="#appendix-A.1-5.3">¶</a>
</li>
        </ul>
<span id="name-usage-of-connection-identif"></span><div id="tab-edhoc-oscore-id-mapping">
<table class="center" id="table-14">
          <caption>
<a class="selfRef" href="#table-14">Table 14</a>:
<a class="selfRef" href="#name-usage-of-connection-identif">Usage of Connection Identifiers in OSCORE</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1"></th>
              <th class="text-left" colspan="1" rowspan="1">OSCORE Sender ID</th>
              <th class="text-left" colspan="1" rowspan="1">OSCORE Recipient ID</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">EDHOC Initiator</td>
              <td class="text-center" colspan="1" rowspan="1">C_R</td>
              <td class="text-center" colspan="1" rowspan="1">C_I</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">EDHOC Responder</td>
              <td class="text-center" colspan="1" rowspan="1">C_I</td>
              <td class="text-center" colspan="1" rowspan="1">C_R</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="appendix-A.1-7">The Client and Server <span class="bcp14">SHALL</span> use the parameters above to establish an OSCORE Security Context, as per <span><a class="relref" href="https://rfc-editor.org/rfc/rfc8613#section-3.2.1">Section 3.2.1</a> of [<a class="cite xref" href="#RFC8613">RFC8613</a>]</span>.<a class="pilcrow" href="#appendix-A.1-7">¶</a></p>
<p id="appendix-A.1-8">From then on, the Client and Server retrieve the OSCORE protocol state using the Recipient ID and optionally other transport information such as the 5-tuple.<a class="pilcrow" href="#appendix-A.1-8">¶</a></p>
</section>
</div>
<div id="coap">
<section id="appendix-A.2">
        <h3 id="name-transferring-edhoc-over-coa">
<a class="section-number selfRef" href="#appendix-A.2">A.2. </a><a class="section-name selfRef" href="#name-transferring-edhoc-over-coa">Transferring EDHOC over CoAP</a>
        </h3>
<p id="appendix-A.2-1">This section specifies how EDHOC can be transferred as an exchange of CoAP <span>[<a class="cite xref" href="#RFC7252">RFC7252</a>]</span> messages. CoAP provides a reliable transport that can preserve packet ordering, provides flow and congestion control, and handles message duplication. CoAP can also perform fragmentation and mitigate certain denial-of-service attacks. The underlying CoAP transport should be used in reliable mode, in particular, when fragmentation is used, to avoid, e.g., situations with hanging endpoints waiting for each other.<a class="pilcrow" href="#appendix-A.2-1">¶</a></p>
<p id="appendix-A.2-2">EDHOC may run with the Initiator either being a CoAP client or CoAP server. We denote the former by the "forward message flow" (see <a class="auto internal xref" href="#forward">Appendix A.2.1</a>) and the latter by the "reverse message flow" (see <a class="auto internal xref" href="#reverse">Appendix A.2.2</a>). By default, we assume the forward message flow, but the roles <span class="bcp14">SHOULD</span> be chosen to protect the most sensitive identity; see <a class="auto internal xref" href="#security">Section 9</a>.<a class="pilcrow" href="#appendix-A.2-2">¶</a></p>
<p id="appendix-A.2-3">According to this specification, EDHOC is transferred in POST requests to the Uri-Path: "/.well-known/edhoc" (see <a class="auto internal xref" href="#well-known">Section 10.7</a>) and 2.04 (Changed) responses. An application may define its own path that can be discovered, e.g., using a resource directory <span>[<a class="cite xref" href="#RFC9176">RFC9176</a>]</span>. Client applications can use the resource type "core.edhoc" to discover a server's EDHOC resource, i.e., where to send a request for executing the EDHOC protocol; see <a class="auto internal xref" href="#rt">Section 10.10</a>. An alternative transfer of the forward message flow is specified in <span>[<a class="cite xref" href="#I-D.ietf-core-oscore-edhoc">EDHOC-CoAP-OSCORE</a>]</span>.<a class="pilcrow" href="#appendix-A.2-3">¶</a></p>
<p id="appendix-A.2-4">In order for the server to correlate a message received from a client to a message previously sent in the same EDHOC session over CoAP, messages sent by the client <span class="bcp14">SHALL</span> be prepended with the CBOR serialization of the connection identifier that the server has selected; see <a class="auto internal xref" href="#ci-edhoc">Section 3.4.1</a>. This applies both to the forward and the reverse message flows. To indicate a new EDHOC session in the forward message flow, message_1 <span class="bcp14">SHALL</span> be prepended with the CBOR simple value <code>true</code> (0xf5). Even if CoAP is carried over a reliable transport protocol, such as TCP, the prepending of identifiers specified here <span class="bcp14">SHALL</span> be practiced to enable interoperability independent of how CoAP is transported.<a class="pilcrow" href="#appendix-A.2-4">¶</a></p>
<p id="appendix-A.2-5">The prepended identifiers are encoded in CBOR and thus self-delimiting. The representation of identifiers described in <a class="auto internal xref" href="#bstr-repr">Section 3.3.2</a> <span class="bcp14">SHALL</span> be used. They are sent in front of the actual EDHOC message to keep track of messages in an EDHOC session, and only the part of the body following the identifier is used for EDHOC processing. In particular, the connection identifiers within the EDHOC messages are not impacted by the prepended identifiers.<a class="pilcrow" href="#appendix-A.2-5">¶</a></p>
<p id="appendix-A.2-6">An EDHOC message has media type "application/edhoc+cbor-seq", whereas an EDHOC message prepended by a connection identifier has media type "application/cid-edhoc+cbor-seq"; see <a class="auto internal xref" href="#content-format">Section 10.9</a>.<a class="pilcrow" href="#appendix-A.2-6">¶</a></p>
<p id="appendix-A.2-7">To mitigate certain denial-of-service attacks, the CoAP server <span class="bcp14">MAY</span> respond to the first POST request with a 4.01 (Unauthorized) containing an Echo option <span>[<a class="cite xref" href="#RFC9175">RFC9175</a>]</span>. This forces the Initiator to demonstrate reachability at its apparent network address. If message fragmentation is needed, the EDHOC messages may be fragmented using the CoAP Block-Wise Transfer mechanism <span>[<a class="cite xref" href="#RFC7959">RFC7959</a>]</span>.<a class="pilcrow" href="#appendix-A.2-7">¶</a></p>
<p id="appendix-A.2-8">EDHOC error messages need to be transported in response to a message that failed (see <a class="auto internal xref" href="#error">Section 6</a>). EDHOC error messages transported with CoAP are carried in the payload.<a class="pilcrow" href="#appendix-A.2-8">¶</a></p>
<p id="appendix-A.2-9">Note that the transport over CoAP can serve as a blueprint for other client-server protocols:<a class="pilcrow" href="#appendix-A.2-9">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.2-10.1">The client prepends the connection identifier selected by the server  (or, for message_1, the CBOR simple value <code>true</code>) to any request message it sends.<a class="pilcrow" href="#appendix-A.2-10.1">¶</a>
</li>
          <li class="normal" id="appendix-A.2-10.2">The server does not send any such indicator, as responses are matched to request by the client-server protocol design.<a class="pilcrow" href="#appendix-A.2-10.2">¶</a>
</li>
        </ul>
<div id="forward">
<section id="appendix-A.2.1">
          <h4 id="name-the-forward-message-flow">
<a class="section-number selfRef" href="#appendix-A.2.1">A.2.1. </a><a class="section-name selfRef" href="#name-the-forward-message-flow">The Forward Message Flow</a>
          </h4>
<p id="appendix-A.2.1-1">In the forward message flow, the CoAP client is the Initiator and the CoAP server is the Responder. This flow protects the client identity against active attackers and the server identity against passive attackers.<a class="pilcrow" href="#appendix-A.2.1-1">¶</a></p>
<p id="appendix-A.2.1-2">In the forward message flow, the CoAP Token enables correlation on the Initiator (client) side, and the prepended C_R enables correlation on the Responder (server) side.<a class="pilcrow" href="#appendix-A.2.1-2">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.2.1-3.1">EDHOC message_1 is sent in the payload of a POST request from the client to the server's resource for EDHOC, prepended with the identifier <code>true</code> (0xf5), indicating a new EDHOC session.<a class="pilcrow" href="#appendix-A.2.1-3.1">¶</a>
</li>
            <li class="normal" id="appendix-A.2.1-3.2">EDHOC message_2 or the EDHOC error message is sent from the server to the client in the payload of the response, in the former case with response code 2.04 (Changed) and in the latter with response code as specified in <a class="auto internal xref" href="#edhoc-oscore-over-coap">Appendix A.2.3</a>.<a class="pilcrow" href="#appendix-A.2.1-3.2">¶</a>
</li>
            <li class="normal" id="appendix-A.2.1-3.3">EDHOC message_3 or the EDHOC error message is sent from the client to the server's resource in the payload of a POST request, prepended with connection identifier C_R.<a class="pilcrow" href="#appendix-A.2.1-3.3">¶</a>
</li>
            <li class="normal" id="appendix-A.2.1-3.4">If EDHOC message_4 is used, or in case of an error message, it is sent from the server to the client in the payload of the response, with response codes analogously to message_2. In case of an error message sent in response to message_4, it is sent analogously to the error message sent in response to message_2.<a class="pilcrow" href="#appendix-A.2.1-3.4">¶</a>
</li>
          </ul>
<p id="appendix-A.2.1-4">An example of a completed EDHOC session over CoAP in the forward message flow is shown in <a class="auto internal xref" href="#fig-coap1">Figure 10</a>.<a class="pilcrow" href="#appendix-A.2.1-4">¶</a></p>
<span id="name-example-of-the-forward-mess"></span><div id="fig-coap1">
<figure id="figure-10">
            <div id="appendix-A.2.1-5.1">
              <div class="alignCenter art-svg artwork" id="appendix-A.2.1-5.1.1">
<svg class="diagram" font-family="monospace" font-size="13px" stroke-linecap="round" text-anchor="middle" version="1.1" viewBox="0 0 496 352" xmlns="http://www.w3.org/2000/svg">
                  <path d="M 24,48 L 24,336" fill="none" stroke="black"></path>
                  <path d="M 112,48 L 112,336" fill="none" stroke="black"></path>
                  <path d="M 24,64 L 104,64" fill="none" stroke="black"></path>
                  <path d="M 32,144 L 112,144" fill="none" stroke="black"></path>
                  <path d="M 24,208 L 104,208" fill="none" stroke="black"></path>
                  <path d="M 32,288 L 112,288" fill="none" stroke="black"></path>
                  <polygon class="arrowhead" fill="black" points="112,208 100,202.4 100,213.6" transform="rotate(0,104,208)"></polygon>
                  <polygon class="arrowhead" fill="black" points="112,64 100,58.4 100,69.6" transform="rotate(0,104,64)"></polygon>
                  <polygon class="arrowhead" fill="black" points="40,288 28,282.4 28,293.6" transform="rotate(180,32,288)"></polygon>
                  <polygon class="arrowhead" fill="black" points="40,144 28,138.4 28,149.6" transform="rotate(180,32,144)"></polygon>
                  <g class="text">
                    <text x="28" y="36">Client</text>
                    <text x="108" y="36">Server</text>
                    <text x="152" y="68">Header:</text>
                    <text x="204" y="68">POST</text>
                    <text x="272" y="68">(Code=0.02)</text>
                    <text x="68" y="84">POST</text>
                    <text x="160" y="84">Uri-Path:</text>
                    <text x="284" y="84">"/.well-known/edhoc"</text>
                    <text x="184" y="100">Content-Format:</text>
                    <text x="372" y="100">application/cid-edhoc+cbor-seq</text>
                    <text x="156" y="116">Payload:</text>
                    <text x="216" y="116">true,</text>
                    <text x="264" y="116">EDHOC</text>
                    <text x="328" y="116">message_1</text>
                    <text x="152" y="148">Header:</text>
                    <text x="204" y="148">2.04</text>
                    <text x="256" y="148">Changed</text>
                    <text x="68" y="164">2.04</text>
                    <text x="184" y="164">Content-Format:</text>
                    <text x="356" y="164">application/edhoc+cbor-seq</text>
                    <text x="156" y="180">Payload:</text>
                    <text x="216" y="180">EDHOC</text>
                    <text x="280" y="180">message_2</text>
                    <text x="152" y="212">Header:</text>
                    <text x="204" y="212">POST</text>
                    <text x="272" y="212">(Code=0.02)</text>
                    <text x="68" y="228">POST</text>
                    <text x="160" y="228">Uri-Path:</text>
                    <text x="284" y="228">"/.well-known/edhoc"</text>
                    <text x="184" y="244">Content-Format:</text>
                    <text x="372" y="244">application/cid-edhoc+cbor-seq</text>
                    <text x="156" y="260">Payload:</text>
                    <text x="212" y="260">C_R,</text>
                    <text x="256" y="260">EDHOC</text>
                    <text x="320" y="260">message_3</text>
                    <text x="152" y="292">Header:</text>
                    <text x="204" y="292">2.04</text>
                    <text x="256" y="292">Changed</text>
                    <text x="68" y="308">2.04</text>
                    <text x="184" y="308">Content-Format:</text>
                    <text x="356" y="308">application/edhoc+cbor-seq</text>
                    <text x="156" y="324">Payload:</text>
                    <text x="216" y="324">EDHOC</text>
                    <text x="280" y="324">message_4</text>
                  </g>
                </svg><a class="pilcrow" href="#appendix-A.2.1-5.1.1">¶</a>
</div>
</div>
<figcaption><a class="selfRef" href="#figure-10">Figure 10</a>:
<a class="selfRef" href="#name-example-of-the-forward-mess">Example of the Forward Message Flow</a>
            </figcaption></figure>
</div>
<p id="appendix-A.2.1-6">The forward message flow of EDHOC can be combined with an OSCORE exchange in a total of two round trips; see <span>[<a class="cite xref" href="#I-D.ietf-core-oscore-edhoc">EDHOC-CoAP-OSCORE</a>]</span>.<a class="pilcrow" href="#appendix-A.2.1-6">¶</a></p>
</section>
</div>
<div id="reverse">
<section id="appendix-A.2.2">
          <h4 id="name-the-reverse-message-flow">
<a class="section-number selfRef" href="#appendix-A.2.2">A.2.2. </a><a class="section-name selfRef" href="#name-the-reverse-message-flow">The Reverse Message Flow</a>
          </h4>
<p id="appendix-A.2.2-1">In the reverse message flow, the CoAP client is the Responder and the CoAP server is the Initiator. This flow protects the server identity against active attackers and the client identity against passive attackers.<a class="pilcrow" href="#appendix-A.2.2-1">¶</a></p>
<p id="appendix-A.2.2-2">In the reverse message flow, the CoAP Token enables correlation on the Responder (client) side, and the prepended C_I enables correlation on the Initiator (server) side.<a class="pilcrow" href="#appendix-A.2.2-2">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.2.2-3.1">To trigger a new EDHOC session, the client makes an empty POST request to the server's resource for EDHOC.<a class="pilcrow" href="#appendix-A.2.2-3.1">¶</a>
</li>
            <li class="normal" id="appendix-A.2.2-3.2">EDHOC message_1 is sent from the server to the client in the payload of the response with response code 2.04 (Changed).<a class="pilcrow" href="#appendix-A.2.2-3.2">¶</a>
</li>
            <li class="normal" id="appendix-A.2.2-3.3">EDHOC message_2 or the EDHOC error message is sent from the client to the server's resource in the payload of a POST request, prepended with connection identifier C_I.<a class="pilcrow" href="#appendix-A.2.2-3.3">¶</a>
</li>
            <li class="normal" id="appendix-A.2.2-3.4">EDHOC message_3 or the EDHOC error message is sent from the server to the client in the payload of the response, in the former case with response code 2.04 (Changed) and in the latter with response code as specified in <a class="auto internal xref" href="#edhoc-oscore-over-coap">Appendix A.2.3</a>.<a class="pilcrow" href="#appendix-A.2.2-3.4">¶</a>
</li>
            <li class="normal" id="appendix-A.2.2-3.5">If EDHOC message_4 is used, or in case of an error message, it is sent from the client to the server's resource in the payload of a POST request, prepended with connection identifier C_I. In case of an error message sent in response to message_4, it is sent analogously to an error message sent in response to message_2.<a class="pilcrow" href="#appendix-A.2.2-3.5">¶</a>
</li>
          </ul>
<p id="appendix-A.2.2-4">An example of a completed EDHOC session over CoAP in the reverse message flow is shown in <a class="auto internal xref" href="#fig-coap2">Figure 11</a>.<a class="pilcrow" href="#appendix-A.2.2-4">¶</a></p>
<span id="name-example-of-the-reverse-mess"></span><div id="fig-coap2">
<figure id="figure-11">
            <div id="appendix-A.2.2-5.1">
              <div class="alignCenter art-svg artwork" id="appendix-A.2.2-5.1.1">
<svg class="diagram" font-family="monospace" font-size="13px" stroke-linecap="round" text-anchor="middle" version="1.1" viewBox="0 0 496 320" xmlns="http://www.w3.org/2000/svg">
                  <path d="M 24,48 L 24,304" fill="none" stroke="black"></path>
                  <path d="M 112,48 L 112,304" fill="none" stroke="black"></path>
                  <path d="M 24,64 L 104,64" fill="none" stroke="black"></path>
                  <path d="M 32,112 L 112,112" fill="none" stroke="black"></path>
                  <path d="M 24,176 L 104,176" fill="none" stroke="black"></path>
                  <path d="M 32,256 L 112,256" fill="none" stroke="black"></path>
                  <polygon class="arrowhead" fill="black" points="112,176 100,170.4 100,181.6" transform="rotate(0,104,176)"></polygon>
                  <polygon class="arrowhead" fill="black" points="112,64 100,58.4 100,69.6" transform="rotate(0,104,64)"></polygon>
                  <polygon class="arrowhead" fill="black" points="40,256 28,250.4 28,261.6" transform="rotate(180,32,256)"></polygon>
                  <polygon class="arrowhead" fill="black" points="40,112 28,106.4 28,117.6" transform="rotate(180,32,112)"></polygon>
                  <g class="text">
                    <text x="28" y="36">Client</text>
                    <text x="108" y="36">Server</text>
                    <text x="152" y="68">Header:</text>
                    <text x="204" y="68">POST</text>
                    <text x="272" y="68">(Code=0.02)</text>
                    <text x="68" y="84">POST</text>
                    <text x="160" y="84">Uri-Path:</text>
                    <text x="284" y="84">"/.well-known/edhoc"</text>
                    <text x="152" y="116">Header:</text>
                    <text x="204" y="116">2.04</text>
                    <text x="256" y="116">Changed</text>
                    <text x="68" y="132">2.04</text>
                    <text x="184" y="132">Content-Format:</text>
                    <text x="356" y="132">application/edhoc+cbor-seq</text>
                    <text x="156" y="148">Payload:</text>
                    <text x="216" y="148">EDHOC</text>
                    <text x="280" y="148">message_1</text>
                    <text x="152" y="180">Header:</text>
                    <text x="204" y="180">POST</text>
                    <text x="272" y="180">(Code=0.02)</text>
                    <text x="68" y="196">POST</text>
                    <text x="160" y="196">Uri-Path:</text>
                    <text x="284" y="196">"/.well-known/edhoc"</text>
                    <text x="184" y="212">Content-Format:</text>
                    <text x="372" y="212">application/cid-edhoc+cbor-seq</text>
                    <text x="156" y="228">Payload:</text>
                    <text x="212" y="228">C_I,</text>
                    <text x="256" y="228">EDHOC</text>
                    <text x="320" y="228">message_2</text>
                    <text x="152" y="260">Header:</text>
                    <text x="204" y="260">2.04</text>
                    <text x="256" y="260">Changed</text>
                    <text x="68" y="276">2.04</text>
                    <text x="184" y="276">Content-Format:</text>
                    <text x="356" y="276">application/edhoc+cbor-seq</text>
                    <text x="156" y="292">Payload:</text>
                    <text x="216" y="292">EDHOC</text>
                    <text x="280" y="292">message_3</text>
                  </g>
                </svg><a class="pilcrow" href="#appendix-A.2.2-5.1.1">¶</a>
</div>
</div>
<figcaption><a class="selfRef" href="#figure-11">Figure 11</a>:
<a class="selfRef" href="#name-example-of-the-reverse-mess">Example of the Reverse Message Flow</a>
            </figcaption></figure>
</div>
</section>
</div>
<div id="edhoc-oscore-over-coap">
<section id="appendix-A.2.3">
          <h4 id="name-errors-in-edhoc-over-coap">
<a class="section-number selfRef" href="#appendix-A.2.3">A.2.3. </a><a class="section-name selfRef" href="#name-errors-in-edhoc-over-coap">Errors in EDHOC over CoAP</a>
          </h4>
<p id="appendix-A.2.3-1">When using EDHOC over CoAP, EDHOC error messages sent as CoAP responses <span class="bcp14">MUST</span> be sent in the payload of error responses, i.e., they <span class="bcp14">MUST</span> specify a CoAP error response code. In particular, it is <span class="bcp14">RECOMMENDED</span> that such error responses have response code either 4.00 (Bad Request) in case of client error (e.g., due to a malformed EDHOC message) or 5.00 (Internal Server Error) in case of server error (e.g., due to failure in deriving EDHOC keying material). The Content-Format of the error response <span class="bcp14">MUST</span> be set to "application/edhoc+cbor-seq"; see <a class="auto internal xref" href="#content-format">Section 10.9</a>.<a class="pilcrow" href="#appendix-A.2.3-1">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="comrep">
<section id="appendix-B">
      <h2 id="name-compact-representation">
<a class="section-number selfRef" href="#appendix-B">Appendix B. </a><a class="section-name selfRef" href="#name-compact-representation">Compact Representation</a>
      </h2>
<p id="appendix-B-1">This section defines a format for compact representation based on the Elliptic-Curve-Point-to-Octet-String Conversion defined in Section 2.3.3 of <span>[<a class="cite xref" href="#SECG">SECG</a>]</span>.<a class="pilcrow" href="#appendix-B-1">¶</a></p>
<p id="appendix-B-2">As described in <span><a class="relref" href="https://rfc-editor.org/rfc/rfc6090#section-4.2">Section 4.2</a> of [<a class="cite xref" href="#RFC6090">RFC6090</a>]</span>, the x-coordinate of an elliptic curve public key is a suitable representative for the entire point whenever scalar multiplication is used as a one-way function. One example is ECDH with compact output, where only the x-coordinate of the computed value is used as the shared secret.<a class="pilcrow" href="#appendix-B-2">¶</a></p>
<p id="appendix-B-3">In EDHOC, compact representation is used for the ephemeral public keys (G_X and G_Y); see <a class="auto internal xref" href="#cose_key">Section 3.7</a>. Using the notation from <span>[<a class="cite xref" href="#SECG">SECG</a>]</span>, the output is an octet string of length ceil( (log2 q) / 8 ), where ceil(x) is the smallest integer not less than x. See <span>[<a class="cite xref" href="#SECG">SECG</a>]</span> for a definition of q, M, X, xp, and ~yp. The steps in Section 2.3.3 of <span>[<a class="cite xref" href="#SECG">SECG</a>]</span> are replaced with the following steps:<a class="pilcrow" href="#appendix-B-3">¶</a></p>
<ol class="normal type-1" id="appendix-B-4" start="1" type="1">
<li id="appendix-B-4.1">Convert the field element xp to an octet string X of length ceil( (log2 q) / 8 ) octets using the conversion routine specified in Section 2.3.5 of <span>[<a class="cite xref" href="#SECG">SECG</a>]</span>.<a class="pilcrow" href="#appendix-B-4.1">¶</a>
</li>
        <li id="appendix-B-4.2">Output M = X.<a class="pilcrow" href="#appendix-B-4.2">¶</a>
</li>
      </ol>
<p id="appendix-B-5">The encoding of the point at infinity is not supported.<a class="pilcrow" href="#appendix-B-5">¶</a></p>
<p id="appendix-B-6">Compact representation does not change any requirements on validation; see <a class="auto internal xref" href="#crypto">Section 9.2</a>. Using compact representation has some security benefits. An implementation does not need to check that the point is not the point at infinity (the identity element). Similarly, as not even the sign of the y-coordinate is encoded, compact representation trivially avoids so-called "benign malleability" attacks where an attacker changes the sign; see <span>[<a class="cite xref" href="#SECG">SECG</a>]</span>.<a class="pilcrow" href="#appendix-B-6">¶</a></p>
<p id="appendix-B-7">The following may be needed for validation or compatibility with APIs that do not support compact representation or do not support the full <span>[<a class="cite xref" href="#SECG">SECG</a>]</span> format:<a class="pilcrow" href="#appendix-B-7">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-8.1">If a compressed y-coordinate is required, then the value ~yp set to zero can be used. In such a case, the compact representation described above can be transformed into the Standards for Efficient Cryptography Group (SECG) point-compressed format by prepending it with the single byte 0x02 (i.e., M = 0x02 || X).<a class="pilcrow" href="#appendix-B-8.1">¶</a>
</li>
        <li class="normal" id="appendix-B-8.2">If an uncompressed y-coordinate is required, then a y-coordinate has to be calculated following Section 2.3.4 of <span>[<a class="cite xref" href="#SECG">SECG</a>]</span> or <span><a class="relref" href="https://rfc-editor.org/rfc/rfc6090#appendix-C">Appendix C</a> of [<a class="cite xref" href="#RFC6090">RFC6090</a>]</span>. Any of the square roots (see <span>[<a class="cite xref" href="#SECG">SECG</a>]</span> or <span>[<a class="cite xref" href="#RFC6090">RFC6090</a>]</span>) can be used. The uncompressed SECG format is M = 0x04 || X || Y.<a class="pilcrow" href="#appendix-B-8.2">¶</a>
</li>
      </ul>
<p id="appendix-B-9">For example: The curve P-256 has the parameters (using the notation in <span>[<a class="cite xref" href="#RFC6090">RFC6090</a>]</span>):<a class="pilcrow" href="#appendix-B-9">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-10.1">p = 2<sup>256</sup> - 2<sup>224</sup> + 2<sup>192</sup> + 2<sup>96</sup> - 1<a class="pilcrow" href="#appendix-B-10.1">¶</a>
</li>
        <li class="normal" id="appendix-B-10.2">a = -3<a class="pilcrow" href="#appendix-B-10.2">¶</a>
</li>
        <li class="normal" id="appendix-B-10.3">b = 410583637251521421293261297800472684091144410159937255
54835256314039467401291<a class="pilcrow" href="#appendix-B-10.3">¶</a>
</li>
      </ul>
<p id="appendix-B-11">Given an example x:<a class="pilcrow" href="#appendix-B-11">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-12.1">x = 115792089183396302095546807154740558443406795108653336
398970697772788799766525<a class="pilcrow" href="#appendix-B-12.1">¶</a>
</li>
      </ul>
<p id="appendix-B-13">We can calculate y as the square root w = (x<sup>3</sup> + a ⋅ x + b)<sup>((p + 1)/4)</sup> (mod p).<a class="pilcrow" href="#appendix-B-13">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-14.1">y = 834387180070192806820075864918626005281451259964015754
16632522940595860276856<a class="pilcrow" href="#appendix-B-14.1">¶</a>
</li>
      </ul>
<p id="appendix-B-15">Note that this does not guarantee that (x, y) is on the correct elliptic curve. A full validation according to Section 5.6.2.3.3 of <span>[<a class="cite xref" href="#SP-800-56A">SP-800-56A</a>]</span> is done by also checking that 0 ≤ x &lt; p and that y<sup>2</sup> ≡ x<sup>3</sup> + a ⋅ x + b (mod p).<a class="pilcrow" href="#appendix-B-15">¶</a></p>
</section>
</div>
<div id="CBORandCOSE">
<section id="appendix-C">
      <h2 id="name-use-of-cbor-cddl-and-cose-i">
<a class="section-number selfRef" href="#appendix-C">Appendix C. </a><a class="section-name selfRef" href="#name-use-of-cbor-cddl-and-cose-i">Use of CBOR, CDDL, and COSE in EDHOC</a>
      </h2>
<p id="appendix-C-1">This appendix is intended to help implementors not familiar with CBOR <span>[<a class="cite xref" href="#RFC8949">RFC8949</a>]</span>, CDDL <span>[<a class="cite xref" href="#RFC8610">RFC8610</a>]</span>, COSE <span>[<a class="cite xref" href="#RFC9052">RFC9052</a>]</span>, and HKDF <span>[<a class="cite xref" href="#RFC5869">RFC5869</a>]</span>.<a class="pilcrow" href="#appendix-C-1">¶</a></p>
<div id="CBOR">
<section id="appendix-C.1">
        <h3 id="name-cbor-and-cddl">
<a class="section-number selfRef" href="#appendix-C.1">C.1. </a><a class="section-name selfRef" href="#name-cbor-and-cddl">CBOR and CDDL</a>
        </h3>
<p id="appendix-C.1-1">The Concise Binary Object Representation (CBOR) <span>[<a class="cite xref" href="#RFC8949">RFC8949</a>]</span> is a data format designed for small code size and small message size. CBOR builds on the JSON data model but extends it by, e.g., encoding binary data directly without base64 conversion. In addition to the binary CBOR encoding, CBOR also has a diagnostic notation that is readable and editable by humans. The Concise Data Definition Language (CDDL) <span>[<a class="cite xref" href="#RFC8610">RFC8610</a>]</span> provides a way to express structures for protocol messages and APIs that use CBOR. <span>[<a class="cite xref" href="#RFC8610">RFC8610</a>]</span> also extends the diagnostic notation.<a class="pilcrow" href="#appendix-C.1-1">¶</a></p>
<p id="appendix-C.1-2">CBOR data items are encoded to or decoded from byte strings using a type-length-value encoding scheme, where the three highest order bits of the initial byte contain information about the major type. CBOR supports several types of data items, integers (int, uint), simple values, byte strings (bstr), and text strings (tstr). CBOR also supports arrays []  of data items, maps {} of pairs of data items, and sequences <span>[<a class="cite xref" href="#RFC8742">RFC8742</a>]</span> of data items. Some examples are given below.<a class="pilcrow" href="#appendix-C.1-2">¶</a></p>
<p id="appendix-C.1-3">The EDHOC specification sometimes use CDDL names in CBOR diagnostic notation as in, e.g., &lt;&lt; ID_CRED_R, ? EAD_2 &gt;&gt;. This means that EAD_2 is optional and that ID_CRED_R and EAD_2 should be substituted with their values before evaluation. That is, if ID_CRED_R = { 4 : h'' } and EAD_2 is omitted, then &lt;&lt; ID_CRED_R, ? EAD_2 &gt;&gt; = &lt;&lt; { 4 : h'' } &gt;&gt;, which encodes to 0x43a10440. We also make use of the occurrence symbol "*", like in, e.g.,  2* int, meaning two or more CBOR integers.<a class="pilcrow" href="#appendix-C.1-3">¶</a></p>
<p id="appendix-C.1-4">For a complete specification and more examples, see <span>[<a class="cite xref" href="#RFC8949">RFC8949</a>]</span> and <span>[<a class="cite xref" href="#RFC8610">RFC8610</a>]</span>. We recommend implementors get used to CBOR by using the CBOR playground <span>[<a class="cite xref" href="#CborMe">CborMe</a>]</span>.<a class="pilcrow" href="#appendix-C.1-4">¶</a></p>
<span id="name-examples-of-use-of-cbor-and"></span><div id="tab-cbor-examples">
<table class="center" id="table-15">
          <caption>
<a class="selfRef" href="#table-15">Table 15</a>:
<a class="selfRef" href="#name-examples-of-use-of-cbor-and">Examples of Use of CBOR and CDDL</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" colspan="1" rowspan="1">Diagnostic</th>
              <th class="text-left" colspan="1" rowspan="1">Encoded</th>
              <th class="text-left" colspan="1" rowspan="1">Type</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">1</td>
              <td class="text-left" colspan="1" rowspan="1">0x01</td>
              <td class="text-left" colspan="1" rowspan="1">unsigned integer</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">24</td>
              <td class="text-left" colspan="1" rowspan="1">0x1818</td>
              <td class="text-left" colspan="1" rowspan="1">unsigned integer</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">-24</td>
              <td class="text-left" colspan="1" rowspan="1">0x37</td>
              <td class="text-left" colspan="1" rowspan="1">negative integer</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">-25</td>
              <td class="text-left" colspan="1" rowspan="1">0x3818</td>
              <td class="text-left" colspan="1" rowspan="1">negative integer</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">true</td>
              <td class="text-left" colspan="1" rowspan="1">0xf5</td>
              <td class="text-left" colspan="1" rowspan="1">simple value</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">h''</td>
              <td class="text-left" colspan="1" rowspan="1">0x40</td>
              <td class="text-left" colspan="1" rowspan="1">byte string</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">h'12cd'</td>
              <td class="text-left" colspan="1" rowspan="1">0x4212cd</td>
              <td class="text-left" colspan="1" rowspan="1">byte string</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">'12cd'</td>
              <td class="text-left" colspan="1" rowspan="1">0x4431326364</td>
              <td class="text-left" colspan="1" rowspan="1">byte string</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">"12cd"</td>
              <td class="text-left" colspan="1" rowspan="1">0x6431326364</td>
              <td class="text-left" colspan="1" rowspan="1">text string</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">{ 4 : h'cd' }</td>
              <td class="text-left" colspan="1" rowspan="1">0xa10441cd</td>
              <td class="text-left" colspan="1" rowspan="1">map</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">&lt;&lt; 1, 2, true &gt;&gt;</td>
              <td class="text-left" colspan="1" rowspan="1">0x430102f5</td>
              <td class="text-left" colspan="1" rowspan="1">byte string</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">[ 1, 2, true ]</td>
              <td class="text-left" colspan="1" rowspan="1">0x830102f5</td>
              <td class="text-left" colspan="1" rowspan="1">array</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1">( 1, 2, true )</td>
              <td class="text-left" colspan="1" rowspan="1">0x0102f5</td>
              <td class="text-left" colspan="1" rowspan="1">sequence</td>
            </tr>
            <tr>
              <td class="text-left" colspan="1" rowspan="1"> 1, 2, true</td>
              <td class="text-left" colspan="1" rowspan="1">0x0102f5</td>
              <td class="text-left" colspan="1" rowspan="1">sequence</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="CDDL">
<section id="appendix-C.2">
        <h3 id="name-cddl-definitions">
<a class="section-number selfRef" href="#appendix-C.2">C.2. </a><a class="section-name selfRef" href="#name-cddl-definitions">CDDL Definitions</a>
        </h3>
<p id="appendix-C.2-1">This section compiles the CDDL definitions for ease of reference.<a class="pilcrow" href="#appendix-C.2-1">¶</a></p>
<div class="breakable lang-CDDL sourcecode" id="appendix-C.2-2">
<pre>suites = [ 2* int ] / int

ead = (
  ead_label : int,
  ? ead_value : bstr,
)

EAD_1 = 1* ead
EAD_2 = 1* ead
EAD_3 = 1* ead
EAD_4 = 1* ead

message_1 = (
  METHOD : int,
  SUITES_I : suites,
  G_X : bstr,
  C_I : bstr / -24..23,
  ? EAD_1,
)

message_2 = (
  G_Y_CIPHERTEXT_2 : bstr,
)

PLAINTEXT_2 = (
  C_R,
  ID_CRED_R : map / bstr / -24..23,
  Signature_or_MAC_2 : bstr,
  ? EAD_2,
)

message_3 = (
  CIPHERTEXT_3 : bstr,
)

PLAINTEXT_3 = (
  ID_CRED_I : map / bstr / -24..23,
  Signature_or_MAC_3 : bstr,
  ? EAD_3,
)

message_4 = (
  CIPHERTEXT_4 : bstr,
)

PLAINTEXT_4 = (
  ? EAD_4,
)

error = (
  ERR_CODE : int,
  ERR_INFO : any,
)

info = (
  info_label : int,
  context : bstr,
  length : uint,
)
</pre><a class="pilcrow" href="#appendix-C.2-2">¶</a>
</div>
</section>
</div>
<div id="COSE">
<section id="appendix-C.3">
        <h3 id="name-cose">
<a class="section-number selfRef" href="#appendix-C.3">C.3. </a><a class="section-name selfRef" href="#name-cose">COSE</a>
        </h3>
<p id="appendix-C.3-1">CBOR Object Signing and Encryption (COSE) <span>[<a class="cite xref" href="#RFC9052">RFC9052</a>]</span> describes how to create and process signatures, MACs, and encryptions using CBOR. COSE builds on JSON Object Signing and Encryption (JOSE) but is adapted to allow more efficient processing in constrained devices. EDHOC makes use of COSE_Key, COSE_Encrypt0, and COSE_Sign1 objects in the message processing:<a class="pilcrow" href="#appendix-C.3-1">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C.3-2.1">ECDH ephemeral public keys of type EC2 or OKP in message_1 and message_2 consist of the COSE_Key parameter named 'x'; see Sections <a class="relref" href="https://rfc-editor.org/rfc/rfc9053#section-7.1">7.1</a> and <a class="relref" href="https://rfc-editor.org/rfc/rfc9053#section-7.2">7.2</a> of <span>[<a class="cite xref" href="#RFC9053">RFC9053</a>]</span>.<a class="pilcrow" href="#appendix-C.3-2.1">¶</a>
</li>
          <li class="normal" id="appendix-C.3-2.2">
            <p id="appendix-C.3-2.2.1">The ciphertexts in message_3 and message_4 consist of a subset of the single recipient encrypted data object COSE_Encrypt0, which is described in Sections <a class="relref" href="https://rfc-editor.org/rfc/rfc9052#section-5.2">5.2</a> and <a class="relref" href="https://rfc-editor.org/rfc/rfc9052#section-5.3">5.3</a> of <span>[<a class="cite xref" href="#RFC9052">RFC9052</a>]</span>. The ciphertext is computed over the plaintext and associated data, using an encryption key and an initialization vector. The associated data is an Enc_structure consisting of protected headers and externally supplied data (external_aad). COSE constructs the input to the AEAD <span>[<a class="cite xref" href="#RFC5116">RFC5116</a>]</span> for message_i (i = 3 or 4; see Sections <a class="auto internal xref" href="#m3">5.4</a> and <a class="auto internal xref" href="#m4">5.5</a>, respectively) as follows:<a class="pilcrow" href="#appendix-C.3-2.2.1">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C.3-2.2.2.1">Secret key K = K_i<a class="pilcrow" href="#appendix-C.3-2.2.2.1">¶</a>
</li>
              <li class="normal" id="appendix-C.3-2.2.2.2">Nonce N = IV_i<a class="pilcrow" href="#appendix-C.3-2.2.2.2">¶</a>
</li>
              <li class="normal" id="appendix-C.3-2.2.2.3">Plaintext P for message_i<a class="pilcrow" href="#appendix-C.3-2.2.2.3">¶</a>
</li>
              <li class="normal" id="appendix-C.3-2.2.2.4">Associated Data A = [ "Encrypt0", h'', TH_i ]<a class="pilcrow" href="#appendix-C.3-2.2.2.4">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="appendix-C.3-2.3">
            <p id="appendix-C.3-2.3.1">Signatures in message_2 of method 0 and 2, and in message_3 of method 0 and 1, consist of a subset of the single signer data object COSE_Sign1, which is described in Sections <a class="relref" href="https://rfc-editor.org/rfc/rfc9052#section-4.2">4.2</a> and <a class="relref" href="https://rfc-editor.org/rfc/rfc9052#section-4.4">4.4</a> of <span>[<a class="cite xref" href="#RFC9052">RFC9052</a>]</span>. The signature is computed over a Sig_structure containing payload, protected headers and externally supplied data (external_aad) using a private signature key, and verified using the corresponding public signature key. For COSE_Sign1, the message to be signed is:<a class="pilcrow" href="#appendix-C.3-2.3.1">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.3-2.3.2">
<pre> [ "Signature1", protected, external_aad, payload ]
</pre><a class="pilcrow" href="#appendix-C.3-2.3.2">¶</a>
</div>
<p id="appendix-C.3-2.3.3">
where protected, external_aad, and payload are specified in Sections <a class="auto internal xref" href="#m2">5.3</a> and <a class="auto internal xref" href="#m3">5.4</a>.<a class="pilcrow" href="#appendix-C.3-2.3.3">¶</a></p>
</li>
        </ul>
<p id="appendix-C.3-3">Different header parameters to identify X.509 or C509 certificates by reference are defined in <span>[<a class="cite xref" href="#RFC9360">RFC9360</a>]</span> and <span>[<a class="cite xref" href="#I-D.ietf-cose-cbor-encoded-cert">C509-CERTS</a>]</span>:<a class="pilcrow" href="#appendix-C.3-3">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C.3-4.1">
            <p id="appendix-C.3-4.1.1">by a hash value with the 'x5t' or 'c5t' parameters, respectively:<a class="pilcrow" href="#appendix-C.3-4.1.1">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C.3-4.1.2.1">ID_CRED_x = { 34 : COSE_CertHash }, for x = I or R and<a class="pilcrow" href="#appendix-C.3-4.1.2.1">¶</a>
</li>
              <li class="normal" id="appendix-C.3-4.1.2.2">ID_CRED_x = { 22 : COSE_CertHash }, for x = I or R,<a class="pilcrow" href="#appendix-C.3-4.1.2.2">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="appendix-C.3-4.2">
            <p id="appendix-C.3-4.2.1">or by a URI with the 'x5u' or 'c5u' parameters, respectively:<a class="pilcrow" href="#appendix-C.3-4.2.1">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C.3-4.2.2.1">ID_CRED_x = { 35 : uri }, for x = I or R, and<a class="pilcrow" href="#appendix-C.3-4.2.2.1">¶</a>
</li>
              <li class="normal" id="appendix-C.3-4.2.2.2">ID_CRED_x = { 23 : uri }, for x = I or R.<a class="pilcrow" href="#appendix-C.3-4.2.2.2">¶</a>
</li>
            </ul>
</li>
        </ul>
<p id="appendix-C.3-5">When ID_CRED_x does not contain the actual credential, it may be very short, e.g., if the endpoints have agreed to use a key identifier parameter 'kid':<a class="pilcrow" href="#appendix-C.3-5">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C.3-6.1">ID_CRED_x = { 4 : kid_x }, where kid_x : kid, for x = I or R. For further optimization, see <a class="auto internal xref" href="#id_cred">Section 3.5.3</a>.<a class="pilcrow" href="#appendix-C.3-6.1">¶</a>
</li>
        </ul>
<p id="appendix-C.3-7">Note that ID_CRED_x can contain several header parameters, for example, { x5u, x5t } or { kid, kid_context }.<a class="pilcrow" href="#appendix-C.3-7">¶</a></p>
<p id="appendix-C.3-8">ID_CRED_x <span class="bcp14">MAY</span> also identify the credential by value. For example, a certificate chain can be transported in an ID_CRED field with COSE header parameter c5c or x5chain, as defined in <span>[<a class="cite xref" href="#I-D.ietf-cose-cbor-encoded-cert">C509-CERTS</a>]</span> and <span>[<a class="cite xref" href="#RFC9360">RFC9360</a>]</span>. Credentials of type CWT and CCS can be transported with the COSE header parameters registered in <a class="auto internal xref" href="#cwt-header-param">Section 10.6</a>.<a class="pilcrow" href="#appendix-C.3-8">¶</a></p>
</section>
</div>
</section>
</div>
<div id="auth-validation">
<section id="appendix-D">
      <h2 id="name-authentication-related-veri">
<a class="section-number selfRef" href="#appendix-D">Appendix D. </a><a class="section-name selfRef" href="#name-authentication-related-veri">Authentication-Related Verifications</a>
      </h2>
<p id="appendix-D-1">EDHOC performs certain authentication-related operations (see <a class="auto internal xref" href="#auth-key-id">Section 3.5</a>), but in general, it is necessary to make additional verifications beyond EDHOC message processing. Which verifications that are needed depend on the deployment, in particular, the trust model and the security policies, but most commonly, it can be expressed in terms of verifications of credential content.<a class="pilcrow" href="#appendix-D-1">¶</a></p>
<p id="appendix-D-2">EDHOC assumes the existence of mechanisms (certification authority or other trusted third party, pre-provisioning, etc.) for generating and distributing authentication credentials and other credentials, as well as the existence of trust anchors (CA certificates, trusted public keys, etc.). For example, a public key certificate or CWT may rely on a trusted third party whose public key is pre-provisioned, whereas a CCS or a self-signed certificate / CWT may be used when trust in the public key can be achieved by other means, or in the case of trust on first use, see <a class="auto internal xref" href="#tofu">Appendix D.5</a>.<a class="pilcrow" href="#appendix-D-2">¶</a></p>
<p id="appendix-D-3">In this section, we provide some examples of such verifications. These verifications are the responsibility of the application but may be implemented as part of an EDHOC library.<a class="pilcrow" href="#appendix-D-3">¶</a></p>
<div id="validating-auth-credential">
<section id="appendix-D.1">
        <h3 id="name-validating-the-authenticati">
<a class="section-number selfRef" href="#appendix-D.1">D.1. </a><a class="section-name selfRef" href="#name-validating-the-authenticati">Validating the Authentication Credential</a>
        </h3>
<p id="appendix-D.1-1">In addition to the authentication key, the authentication credential may contain other parameters that need to be verified. For example:<a class="pilcrow" href="#appendix-D.1-1">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-D.1-2.1">In X.509 and C509 certificates, signature keys typically have key usage "digitalSignature", and Diffie-Hellman public keys typically have key usage "keyAgreement" <span>[<a class="cite xref" href="#RFC3279">RFC3279</a>]</span> <span>[<a class="cite xref" href="#RFC8410">RFC8410</a>]</span>.<a class="pilcrow" href="#appendix-D.1-2.1">¶</a>
</li>
          <li class="normal" id="appendix-D.1-2.2">In X.509 and C509 certificates, validity is expressed using Not After and Not Before. In CWT and CCS, the "exp" and "nbf" claims have similar meanings.<a class="pilcrow" href="#appendix-D.1-2.2">¶</a>
</li>
        </ul>
</section>
</div>
<div id="identities">
<section id="appendix-D.2">
        <h3 id="name-identities">
<a class="section-number selfRef" href="#appendix-D.2">D.2. </a><a class="section-name selfRef" href="#name-identities">Identities</a>
        </h3>
<p id="appendix-D.2-1">The application must decide on allowing a connection or not, depending on the intended endpoint, and in particular whether it is a specific identity or in a set of identities. To prevent misbinding attacks, the identity of the endpoint is included in a MAC verified through the protocol. More details and examples are provided in this section.<a class="pilcrow" href="#appendix-D.2-1">¶</a></p>
<p id="appendix-D.2-2">Policies for what connections to allow are typically set based on the identity of the other endpoint, and endpoints typically only allow connections from a specific identity or a small restricted set of identities. For example, in the case of a device connecting to a network, the network may only allow connections from devices that authenticate with certificates having a particular range of serial numbers and signed by a particular CA. Conversely, a device may only be allowed to connect to a network that authenticates with a particular public key.<a class="pilcrow" href="#appendix-D.2-2">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-D.2-3.1">When a Public Key Infrastructure (PKI) is used with certificates, the identity is the subject whose unique name, e.g., a domain name, a Network Access Identifier (NAI), or an Extended Unique Identifier (EUI), is included in the endpoint's certificate.<a class="pilcrow" href="#appendix-D.2-3.1">¶</a>
</li>
          <li class="normal" id="appendix-D.2-3.2">Similarly, when a PKI is used with CWTs, the identity is the subject identified by the relevant claim(s), such as 'sub' (subject).<a class="pilcrow" href="#appendix-D.2-3.2">¶</a>
</li>
          <li class="normal" id="appendix-D.2-3.3">When PKI is not used (e.g., CCS, self-signed certificate / CWT), the identity is typically directly associated with the authentication key of the other party. For example, if identities can be expressed in the form of unique subject names assigned to public keys, then a binding to identity is achieved by including both the public key and associated subject name in the authentication credential. CRED_I or CRED_R may be a self-signed certificate / CWT or CCS containing the authentication key and the subject name; see <a class="auto internal xref" href="#auth-cred">Section 3.5.2</a>. Thus, each endpoint needs to know the specific authentication key / unique associated subject name or set of public authentication keys / unique associated subject names, which it is allowed to communicate with.<a class="pilcrow" href="#appendix-D.2-3.3">¶</a>
</li>
        </ul>
<p id="appendix-D.2-4">To prevent misbinding attacks in systems where an attacker can register public keys without proving knowledge of the private key, SIGMA <span>[<a class="cite xref" href="#SIGMA">SIGMA</a>]</span> enforces a MAC to be calculated over the "identity". EDHOC follows SIGMA by calculating a MAC over the whole authentication credential, which in case of an X.509 or C509 certificate, includes the "subject" and "subjectAltName" fields and, in the case of CWT or CCS, includes the "sub" claim.<a class="pilcrow" href="#appendix-D.2-4">¶</a></p>
<p id="appendix-D.2-5">(While the SIGMA paper only focuses on the identity, the same principle is true for other information such as policies associated with the public key.)<a class="pilcrow" href="#appendix-D.2-5">¶</a></p>
</section>
</div>
<div id="cert-path">
<section id="appendix-D.3">
        <h3 id="name-certification-path-and-trus">
<a class="section-number selfRef" href="#appendix-D.3">D.3. </a><a class="section-name selfRef" href="#name-certification-path-and-trus">Certification Path and Trust Anchors</a>
        </h3>
<p id="appendix-D.3-1">When a Public Key Infrastructure (PKI) is used with certificates, the trust anchor is a certification authority (CA) certificate. Each party needs at least one CA public key certificate or just the CA public key. The certification path contains proof that the subject of the certificate owns the public key in the certificate. Only validated public key certificates are to be accepted.<a class="pilcrow" href="#appendix-D.3-1">¶</a></p>
<p id="appendix-D.3-2">Similarly, when a PKI is used with CWTs, each party needs to have at least one trusted third-party public key as a trust anchor to verify the end entity CWTs. The trusted third-party public key can, e.g., be stored in a self-signed CWT or in a CCS.<a class="pilcrow" href="#appendix-D.3-2">¶</a></p>
<p id="appendix-D.3-3">The signature of the authentication credential needs to be verified with the public key of the issuer. X.509 and C509 certificates includes the "Issuer" field. In CWT and CCS, the "iss" claim has a similar meaning. The public key is either a trust anchor or the public key in another valid and trusted credential in a certification path from the trust anchor to the authentication credential.<a class="pilcrow" href="#appendix-D.3-3">¶</a></p>
<p id="appendix-D.3-4">Similar verifications as made with the authentication credential (see <a class="auto internal xref" href="#validating-auth-credential">Appendix D.1</a>) are also needed for the other credentials in the certification path.<a class="pilcrow" href="#appendix-D.3-4">¶</a></p>
<p id="appendix-D.3-5">When PKI is not used (CCS and self-signed certificate / CWT), the trust anchor is the authentication key of the other party; in which case, there is no certification path.<a class="pilcrow" href="#appendix-D.3-5">¶</a></p>
</section>
</div>
<div id="revocation">
<section id="appendix-D.4">
        <h3 id="name-revocation-status">
<a class="section-number selfRef" href="#appendix-D.4">D.4. </a><a class="section-name selfRef" href="#name-revocation-status">Revocation Status</a>
        </h3>
<p id="appendix-D.4-1">The application may need to verify that the credentials are not revoked; see <a class="auto internal xref" href="#impl-cons">Section 9.8</a>. Some use cases may be served by short-lived credentials, for example, where the validity of the credential is on par with the interval between revocation checks. But, in general, credential lifetime and revocation checking are complementary measures to control credential status. Revocation information may be transported as External Authorization Data (EAD); see <a class="auto internal xref" href="#ead-appendix">Appendix E</a>.<a class="pilcrow" href="#appendix-D.4-1">¶</a></p>
</section>
</div>
<div id="tofu">
<section id="appendix-D.5">
        <h3 id="name-unauthenticated-operation">
<a class="section-number selfRef" href="#appendix-D.5">D.5. </a><a class="section-name selfRef" href="#name-unauthenticated-operation">Unauthenticated Operation</a>
        </h3>
<p id="appendix-D.5-1">EDHOC might be used without authentication by allowing the Initiator or Responder to communicate with any identity except its own. Note that EDHOC without mutual authentication is vulnerable to active on-path attacks and therefore unsafe for general use. However, it is possible to later establish a trust relationship with an unknown or not-yet-trusted endpoint. Some examples are listed below:<a class="pilcrow" href="#appendix-D.5-1">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-D.5-2.1">The EDHOC authentication credential can be verified out-of-band at a later stage.<a class="pilcrow" href="#appendix-D.5-2.1">¶</a>
</li>
          <li class="normal" id="appendix-D.5-2.2">The EDHOC session key can be bound to an identity out-of-band at a later stage.<a class="pilcrow" href="#appendix-D.5-2.2">¶</a>
</li>
          <li class="normal" id="appendix-D.5-2.3">Trust on first use (TOFU) can be used to verify that several EDHOC connections are made to the same identity. TOFU combined with proximity is a common IoT deployment model that provides good security if done correctly. Note that secure proximity based on short range wireless technology requires very low signal strength or very low latency.<a class="pilcrow" href="#appendix-D.5-2.3">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="ead-appendix">
<section id="appendix-E">
      <h2 id="name-use-of-external-authorizati">
<a class="section-number selfRef" href="#appendix-E">Appendix E. </a><a class="section-name selfRef" href="#name-use-of-external-authorizati">Use of External Authorization Data</a>
      </h2>
<p id="appendix-E-1">In order to reduce the number of messages and round trips, or to simplify processing, external security applications may be integrated into EDHOC by transporting related external authorization data (EAD) in the messages.<a class="pilcrow" href="#appendix-E-1">¶</a></p>
<p id="appendix-E-2">The EAD format is specified in <a class="auto internal xref" href="#AD">Section 3.8</a>. This section contains examples and further details of how EAD may be used with an appropriate accompanying specification.<a class="pilcrow" href="#appendix-E-2">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-E-3.1">One example is third-party-assisted authorization, requested with EAD_1, and an authorization artifact ("voucher", cf. <span>[<a class="cite xref" href="#RFC8366">RFC8366</a>]</span>) returned in EAD_2; see <span>[<a class="cite xref" href="#I-D.ietf-lake-authz">LAKE-AUTHZ</a>]</span>.<a class="pilcrow" href="#appendix-E-3.1">¶</a>
</li>
        <li class="normal" id="appendix-E-3.2">Another example is remote attestation, requested in EAD_2, and an Entity Attestation Token (EAT) <span>[<a class="cite xref" href="#I-D.ietf-rats-eat">EAT</a>]</span> returned in EAD_3.<a class="pilcrow" href="#appendix-E-3.2">¶</a>
</li>
        <li class="normal" id="appendix-E-3.3">A third example is certificate enrollment, where a Certificate Signing Request (CSR) <span>[<a class="cite xref" href="#RFC2986">RFC2986</a>]</span> is included in EAD_3, and the issued public key certificate (X.509 <span>[<a class="cite xref" href="#RFC5280">RFC5280</a>]</span> and C509 <span>[<a class="cite xref" href="#I-D.ietf-cose-cbor-encoded-cert">C509-CERTS</a>]</span>) or a reference thereof is returned in EAD_4.<a class="pilcrow" href="#appendix-E-3.3">¶</a>
</li>
      </ul>
<p id="appendix-E-4">External authorization data should be considered unprotected by EDHOC, and the protection of EAD is the responsibility of the security application (third-party authorization, remote attestation, certificate enrollment, etc.). The security properties of the EAD fields (after EDHOC processing) are discussed in <a class="auto internal xref" href="#sec-prop">Section 9.1</a>.<a class="pilcrow" href="#appendix-E-4">¶</a></p>
<p id="appendix-E-5">The content of the EAD field may be used in the EDHOC processing of the message in which they are contained. For example, authentication-related information, like assertions and revocation information, transported in EAD fields may provide input about trust anchors or validity of credentials relevant to the authentication processing. The EAD fields (like ID_CRED fields) are therefore made available to the application before the message is verified; see details of message processing in <a class="auto internal xref" href="#asym">Section 5</a>. In the first example above, a voucher in EAD_2 made available to the application can enable the Initiator to verify the identity or the public key of the Responder before verifying the signature. An application allowing EAD fields containing authentication information thus may need to handle authentication-related verifications associated with EAD processing.<a class="pilcrow" href="#appendix-E-5">¶</a></p>
<p id="appendix-E-6">Conversely, the security application may need to wait for EDHOC message verification to complete. In the third example above, the validation of a CSR carried in EAD_3 is not started by the Responder before EDHOC has successfully verified message_3 and proven the possession of the private key of the Initiator.<a class="pilcrow" href="#appendix-E-6">¶</a></p>
<p id="appendix-E-7">The security application may reuse EDHOC protocol fields that therefore need to be available to the application. For example, the security application may use the same crypto algorithms as in the EDHOC session and therefore needs access to the selected cipher suite (or the whole SUITES_I). The application may use the ephemeral public keys G_X and G_Y as ephemeral keys or as nonces; see <span>[<a class="cite xref" href="#I-D.ietf-lake-authz">LAKE-AUTHZ</a>]</span>.<a class="pilcrow" href="#appendix-E-7">¶</a></p>
<p id="appendix-E-8">The processing of the EAD item (ead_label, ? ead_value) by the security application needs to be described in the specification where the ead_label is registered (see <a class="auto internal xref" href="#iana-ead">Section 10.5</a>), including the optional ead_value for each message and actions in case of errors. An application may support multiple security applications that make use of EAD, which may result in multiple EAD items in one EAD field; see <a class="auto internal xref" href="#AD">Section 3.8</a>. Any dependencies on security applications with previously registered EAD items need to be documented, and the processing needs to consider their simultaneous use.<a class="pilcrow" href="#appendix-E-8">¶</a></p>
<p id="appendix-E-9">Since data carried in EAD may not be protected, or processed by the application before the EDHOC message is verified, special considerations need to be made such that it does not violate security and privacy requirements of the service that uses this data; see <a class="auto internal xref" href="#unprot-data">Section 9.5</a>. The content in an EAD item may impact the security properties provided by EDHOC. Security applications making use of the EAD items must perform the necessary security analysis.<a class="pilcrow" href="#appendix-E-9">¶</a></p>
</section>
</div>
<div id="appl-temp">
<section id="appendix-F">
      <h2 id="name-application-profile-example">
<a class="section-number selfRef" href="#appendix-F">Appendix F. </a><a class="section-name selfRef" href="#name-application-profile-example">Application Profile Example</a>
      </h2>
<p id="appendix-F-1">This appendix contains a rudimentary example of an application profile; see <a class="auto internal xref" href="#applicability">Section 3.9</a>.<a class="pilcrow" href="#appendix-F-1">¶</a></p>
<p id="appendix-F-2">For use of EDHOC with application X, the following assumptions are made:<a class="pilcrow" href="#appendix-F-2">¶</a></p>
<ol class="normal type-1" id="appendix-F-3" start="1" type="1">
<li id="appendix-F-3.1">Transfer in CoAP as specified in <a class="auto internal xref" href="#coap">Appendix A.2</a> with requests expected by the CoAP server (= Responder) at /app1-edh, no Content-Format needed.<a class="pilcrow" href="#appendix-F-3.1">¶</a>
</li>
        <li id="appendix-F-3.2">METHOD = 1 (I uses signature key; R uses static DH key.)<a class="pilcrow" href="#appendix-F-3.2">¶</a>
</li>
        <li id="appendix-F-3.3">
          <p id="appendix-F-3.3.1">CRED_I is an IEEE 802.1AR Initial Device Identifier (IDevID) encoded as a C509 certificate of type 0 <span>[<a class="cite xref" href="#I-D.ietf-cose-cbor-encoded-cert">C509-CERTS</a>]</span>.<a class="pilcrow" href="#appendix-F-3.3.1">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-F-3.3.2.1">R acquires CRED_I out-of-band, indicated in EAD_1.<a class="pilcrow" href="#appendix-F-3.3.2.1">¶</a>
</li>
            <li class="normal" id="appendix-F-3.3.2.2">ID_CRED_I = {4: h''} is a 'kid' with the value of the empty CBOR byte string.<a class="pilcrow" href="#appendix-F-3.3.2.2">¶</a>
</li>
          </ul>
</li>
        <li id="appendix-F-3.4">
          <p id="appendix-F-3.4.1">CRED_R is a CCS of type OKP as specified in <a class="auto internal xref" href="#auth-cred">Section 3.5.2</a>.<a class="pilcrow" href="#appendix-F-3.4.1">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-F-3.4.2.1">The CBOR map has parameters 1 (kty), -1 (crv), and -2 (x-coordinate).<a class="pilcrow" href="#appendix-F-3.4.2.1">¶</a>
</li>
            <li class="normal" id="appendix-F-3.4.2.2">ID_CRED_R is {14 : CCS}.<a class="pilcrow" href="#appendix-F-3.4.2.2">¶</a>
</li>
          </ul>
</li>
        <li id="appendix-F-3.5">External authorization data is defined and processed as specified in <span>[<a class="cite xref" href="#I-D.ietf-lake-authz">LAKE-AUTHZ</a>]</span>.<a class="pilcrow" href="#appendix-F-3.5">¶</a>
</li>
        <li id="appendix-F-3.6">EUI-64 is used as the identity of the endpoint (see an example in <a class="auto internal xref" href="#auth-cred">Section 3.5.2</a>).<a class="pilcrow" href="#appendix-F-3.6">¶</a>
</li>
        <li id="appendix-F-3.7">No use of message_4. The application sends protected messages from R to I.<a class="pilcrow" href="#appendix-F-3.7">¶</a>
</li>
      </ol>
</section>
</div>
<div id="large-plaintext_2">
<section id="appendix-G">
      <h2 id="name-long-plaintext_2">
<a class="section-number selfRef" href="#appendix-G">Appendix G. </a><a class="section-name selfRef" href="#name-long-plaintext_2">Long PLAINTEXT_2</a>
      </h2>
<p id="appendix-G-1">By the definition of encryption of PLAINTEXT_2 with KEYSTREAM_2, it is limited to lengths of PLAINTEXT_2 not exceeding the output of EDHOC_KDF; see <a class="auto internal xref" href="#expand">Section 4.1.2</a>. If the EDHOC hash algorithm is SHA-2, then HKDF-Expand is used, which limits the length of the EDHOC_KDF output to 255 ⋅ hash_length, where hash_length is the length of the output of the EDHOC hash algorithm given by the cipher suite. For example, with SHA-256 as the EDHOC hash algorithm, the length of the hash output is 32 bytes and the maximum length of PLAINTEXT_2 is 255 ⋅ 32 = 8160 bytes.<a class="pilcrow" href="#appendix-G-1">¶</a></p>
<p id="appendix-G-2">While PLAINTEXT_2 is expected to be much shorter than 8 kB for the intended use cases, it seems nevertheless prudent to specify a solution for the event that this should turn out to be a limitation.<a class="pilcrow" href="#appendix-G-2">¶</a></p>
<p id="appendix-G-3">A potential work-around is to use a cipher suite with a different hash function. In particular, the use of KMAC removes all practical limitations in this respect.<a class="pilcrow" href="#appendix-G-3">¶</a></p>
<p id="appendix-G-4">This section specifies a solution that works with any hash function by making use of multiple invocations of HKDF-Expand and negative values of info_label.<a class="pilcrow" href="#appendix-G-4">¶</a></p>
<p id="appendix-G-5">Consider the PLAINTEXT_2 partitioned in parts P(i) of length equal to M = 255 ⋅ hash_length, except possibly the last part P(last), which has 0 &lt; length ≤ M.<a class="pilcrow" href="#appendix-G-5">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-G-6">
<pre>PLAINTEXT_2 = P(0) | P(1) | ... | P(last)
</pre><a class="pilcrow" href="#appendix-G-6">¶</a>
</div>
<p id="appendix-G-7">where "|" indicates concatenation.<a class="pilcrow" href="#appendix-G-7">¶</a></p>
<p id="appendix-G-8">The object is to define a matching KEYSTREAM_2 of the same length and perform the encryption in the same way as defined in <a class="auto internal xref" href="#asym-msg2-proc">Section 5.3.2</a>:<a class="pilcrow" href="#appendix-G-8">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-G-9">
<pre>CIPHERTEXT_2 = PLAINTEXT_2 XOR KEYSTREAM_2
</pre><a class="pilcrow" href="#appendix-G-9">¶</a>
</div>
<p id="appendix-G-10">Define the keystream as:<a class="pilcrow" href="#appendix-G-10">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-G-11">
<pre>KEYSTREAM_2 = OKM(0) | OKM(1)  | ... | OKM(last)
</pre><a class="pilcrow" href="#appendix-G-11">¶</a>
</div>
<p id="appendix-G-12">where:<a class="pilcrow" href="#appendix-G-12">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-G-13">
<pre>OKM(i) = EDHOC_KDF( PRK_2e, -i, TH_2, length(P(i)) )
</pre><a class="pilcrow" href="#appendix-G-13">¶</a>
</div>
<p id="appendix-G-14">Note that if length(PLAINTEXT_2) ≤ M, then P(0) = PLAINTEXT_2 and the definition of KEYSTREAM_2 = OKM(0) coincides with <a class="auto internal xref" href="#fig-edhoc-kdf">Figure 6</a>.<a class="pilcrow" href="#appendix-G-14">¶</a></p>
<p id="appendix-G-15">This describes the processing of the Responder when sending message_2. The Initiator makes the same calculations when receiving message_2 but interchanging PLAINTEXT_2 and CIPHERTEXT_2.<a class="pilcrow" href="#appendix-G-15">¶</a></p>
<p id="appendix-G-16">An application profile may specify if it supports or does not support the method described in this appendix.<a class="pilcrow" href="#appendix-G-16">¶</a></p>
</section>
</div>
<div id="keyupdate">
<section id="appendix-H">
      <h2 id="name-edhoc_keyupdate">
<a class="section-number selfRef" href="#appendix-H">Appendix H. </a><a class="section-name selfRef" href="#name-edhoc_keyupdate">EDHOC_KeyUpdate</a>
      </h2>
<p id="appendix-H-1">To provide forward secrecy in an even more efficient way than re-running EDHOC, this section specifies the optional function EDHOC_KeyUpdate in terms of EDHOC_KDF and PRK_out.<a class="pilcrow" href="#appendix-H-1">¶</a></p>
<p id="appendix-H-2">When EDHOC_KeyUpdate is called, a new PRK_out is calculated as the output of the EDHOC_Expand function with the old PRK_out as input. The change of PRK_out causes a change to PRK_exporter, which enables the derivation of new application keys superseding the old ones, using EDHOC_Exporter; see <a class="auto internal xref" href="#exporter">Section 4.2.1</a>. The process is illustrated by the following pseudocode.<a class="pilcrow" href="#appendix-H-2">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-H-3">
<pre>EDHOC_KeyUpdate( context ):
   new PRK_out = EDHOC_KDF( old PRK_out, 11, context, hash_length )
   new PRK_exporter = EDHOC_KDF( new PRK_out, 10, h'', hash_length )
</pre><a class="pilcrow" href="#appendix-H-3">¶</a>
</div>
<p id="appendix-H-4">where hash_length denotes the output size in bytes of the EDHOC hash algorithm of the selected cipher suite.<a class="pilcrow" href="#appendix-H-4">¶</a></p>
<p id="appendix-H-5">   The EDHOC_KeyUpdate takes a context as input to enable binding of
   the updated PRK_out to some event that triggered the key update.  The
   Initiator and Responder need to agree on the context, which can,
   e.g., be a counter, a pseudorandom number, or a hash.  To provide
   forward secrecy, the old PRK_out and keys derived from it (old
   PRK_exporter and old application keys) must be deleted as soon as
   they are not needed.  When to delete the old keys and how to verify
   that they are not needed is up to the application. Note that the
   security properties depend on the type of context and the number
   of KeyUpdate iterations.<a class="pilcrow" href="#appendix-H-5">¶</a></p>
<p id="appendix-H-6">An application using EDHOC_KeyUpdate needs to store PRK_out. Compromise of PRK_out leads to compromise of all keying material derived with the EDHOC_Exporter since the last invocation of the EDHOC_KeyUpdate function.<a class="pilcrow" href="#appendix-H-6">¶</a></p>
<p id="appendix-H-7">While this key update method provides forward secrecy, it does not give as strong security properties as re-running EDHOC. EDHOC_KeyUpdate can be used to meet cryptographic limits and provide partial protection against key leakage, but it provides significantly weaker security properties than re-running EDHOC with ephemeral Diffie-Hellman. Even with frequent use of EDHOC_KeyUpdate, compromise of one session key compromises all future session keys, and an attacker therefore only needs to perform static key exfiltration <span>[<a class="cite xref" href="#RFC7624">RFC7624</a>]</span>, which is less complicated and has a lower risk profile than the dynamic case; see <a class="auto internal xref" href="#sec-prop">Section 9.1</a>.<a class="pilcrow" href="#appendix-H-7">¶</a></p>
<p id="appendix-H-8">A similar method to do a key update for OSCORE is KUDOS; see <span>[<a class="cite xref" href="#I-D.ietf-core-oscore-key-update">KUDOS</a>]</span>.<a class="pilcrow" href="#appendix-H-8">¶</a></p>
</section>
</div>
<div id="example-protocol-state-machine">
<section id="appendix-I">
      <h2 id="name-example-protocol-state-mach">
<a class="section-number selfRef" href="#appendix-I">Appendix I. </a><a class="section-name selfRef" href="#name-example-protocol-state-mach">Example Protocol State Machine</a>
      </h2>
<p id="appendix-I-1">This appendix describes an example protocol state machine for the Initiator and Responder. States are denoted in all capitals, and parentheses denote actions taken only in some circumstances.<a class="pilcrow" href="#appendix-I-1">¶</a></p>
<p id="appendix-I-2">Note that this state machine is just an example, and that details of processing are omitted. For example:<a class="pilcrow" href="#appendix-I-2">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-I-3.1">when error messages are being sent (with one exception);<a class="pilcrow" href="#appendix-I-3.1">¶</a>
</li>
        <li class="normal" id="appendix-I-3.2">how credentials and EAD are processed by EDHOC and the application in the RCVD state; and<a class="pilcrow" href="#appendix-I-3.2">¶</a>
</li>
        <li class="normal" id="appendix-I-3.3">what verifications are made, which includes not only MACs and signatures.<a class="pilcrow" href="#appendix-I-3.3">¶</a>
</li>
      </ul>
<div id="initiator-state-machine">
<section id="appendix-I.1">
        <h3 id="name-initiator-state-machine">
<a class="section-number selfRef" href="#appendix-I.1">I.1. </a><a class="section-name selfRef" href="#name-initiator-state-machine">Initiator State Machine</a>
        </h3>
<p id="appendix-I.1-1">The Initiator sends message_1, triggering the state machine to transition from START to WAIT_M2, and waits for message_2.<a class="pilcrow" href="#appendix-I.1-1">¶</a></p>
<p id="appendix-I.1-2">If the incoming message is an error message, then the Initiator transitions from WAIT_M2 to ABORTED. In case of error code 2 (Wrong Selected Cipher Suite), the Initiator remembers the supported cipher suites for this particular Responder and transitions from ABORTED to START. The message_1 that the Initiator subsequently sends takes into account the cipher suites supported by the Responder.<a class="pilcrow" href="#appendix-I.1-2">¶</a></p>
<p id="appendix-I.1-3">Upon receiving a non-error message, the Initiator transitions from WAIT_M2 to RCVD_M2 and processes the message. If a processing error occurs on message_2, then the Initiator transitions from RCVD_M2 to ABORTED. In case of successful processing of message_2, the Initiator transitions from RCVD_M2 to VRFD_M2.<a class="pilcrow" href="#appendix-I.1-3">¶</a></p>
<p id="appendix-I.1-4">The Initiator prepares and processes message_3 for sending. If any processing error is encountered, the Initiator transitions from VRFD_M2 to ABORTED. If message_3 is successfully sent, the Initiator transitions from VRFD_M2 to COMPLETED.<a class="pilcrow" href="#appendix-I.1-4">¶</a></p>
<p id="appendix-I.1-5">If the application profile includes message_4, then the Initiator waits for message_4. If the incoming message is an error message, then the Initiator transitions from COMPLETED to ABORTED. Upon receiving a non-error message, the Initiator transitions from COMPLETED (="WAIT_M4") to RCVD_M4 and processes the message. If a processing error occurs on message_4, then the Initiator transitions from RCVD_M4 to ABORTED. In case of successful processing of message_4, the Initiator transitions from RCVD_M4 to PERSISTED (="VRFD_M4").<a class="pilcrow" href="#appendix-I.1-5">¶</a></p>
<p id="appendix-I.1-6">If the application profile does not include message_4, then the Initiator waits for an incoming application message. If the decryption and verification of the application message is successful, then the Initiator transitions from COMPLETED to PERSISTED.<a class="pilcrow" href="#appendix-I.1-6">¶</a></p>
<span id="name-initiator-state-machine-2"></span><figure id="figure-12">
          <div id="appendix-I.1-7.1">
            <div class="alignCenter art-svg artwork" id="appendix-I.1-7.1.1">
<svg class="diagram" font-family="monospace" font-size="13px" stroke-linecap="round" text-anchor="middle" version="1.1" viewBox="0 0 536 528" xmlns="http://www.w3.org/2000/svg">
                <path d="M 40,32 L 40,48" fill="none" stroke="black"></path>
                <path d="M 40,128 L 40,432" fill="none" stroke="black"></path>
                <path d="M 232,48 L 232,96" fill="none" stroke="black"></path>
                <path d="M 232,128 L 232,176" fill="none" stroke="black"></path>
                <path d="M 232,208 L 232,256" fill="none" stroke="black"></path>
                <path d="M 232,288 L 232,336" fill="none" stroke="black"></path>
                <path d="M 232,368 L 232,416" fill="none" stroke="black"></path>
                <path d="M 232,448 L 232,496" fill="none" stroke="black"></path>
                <path d="M 424,352 L 424,512" fill="none" stroke="black"></path>
                <path d="M 72,112 L 200,112" fill="none" stroke="black"></path>
                <path d="M 40,192 L 200,192" fill="none" stroke="black"></path>
                <path d="M 40,272 L 200,272" fill="none" stroke="black"></path>
                <path d="M 40,352 L 200,352" fill="none" stroke="black"></path>
                <path d="M 296,352 L 424,352" fill="none" stroke="black"></path>
                <path d="M 40,432 L 192,432" fill="none" stroke="black"></path>
                <path d="M 296,512 L 424,512" fill="none" stroke="black"></path>
                <polygon class="arrowhead" fill="black" points="304,512 292,506.4 292,517.6" transform="rotate(180,296,512)"></polygon>
                <polygon class="arrowhead" fill="black" points="240,496 228,490.4 228,501.6" transform="rotate(90,232,496)"></polygon>
                <polygon class="arrowhead" fill="black" points="240,416 228,410.4 228,421.6" transform="rotate(90,232,416)"></polygon>
                <polygon class="arrowhead" fill="black" points="240,336 228,330.4 228,341.6" transform="rotate(90,232,336)"></polygon>
                <polygon class="arrowhead" fill="black" points="240,256 228,250.4 228,261.6" transform="rotate(90,232,256)"></polygon>
                <polygon class="arrowhead" fill="black" points="240,176 228,170.4 228,181.6" transform="rotate(90,232,176)"></polygon>
                <polygon class="arrowhead" fill="black" points="240,96 228,90.4 228,101.6" transform="rotate(90,232,96)"></polygon>
                <polygon class="arrowhead" fill="black" points="80,112 68,106.4 68,117.6" transform="rotate(180,72,112)"></polygon>
                <polygon class="arrowhead" fill="black" points="48,360 36,354.4 36,365.6" transform="rotate(270,40,360)"></polygon>
                <polygon class="arrowhead" fill="black" points="48,280 36,274.4 36,285.6" transform="rotate(270,40,280)"></polygon>
                <polygon class="arrowhead" fill="black" points="48,200 36,194.4 36,205.6" transform="rotate(270,40,200)"></polygon>
                <polygon class="arrowhead" fill="black" points="48,128 36,122.4 36,133.6" transform="rotate(270,40,128)"></polygon>
                <g class="text">
                  <text x="48" y="36">-</text>
                  <text x="64" y="36">-</text>
                  <text x="80" y="36">-</text>
                  <text x="96" y="36">-</text>
                  <text x="112" y="36">-</text>
                  <text x="128" y="36">-</text>
                  <text x="144" y="36">-</text>
                  <text x="160" y="36">-</text>
                  <text x="176" y="36">-</text>
                  <text x="196" y="36">-&gt;</text>
                  <text x="232" y="36">START</text>
                  <text x="260" y="68">Send</text>
                  <text x="320" y="68">message_1</text>
                  <text x="40" y="84">|</text>
                  <text x="112" y="100">Receive</text>
                  <text x="168" y="100">error</text>
                  <text x="32" y="116">ABORTED</text>
                  <text x="240" y="116">WAIT_M2</text>
                  <text x="272" y="148">Receive</text>
                  <text x="344" y="148">message_2</text>
                  <text x="116" y="180">Processing</text>
                  <text x="184" y="180">error</text>
                  <text x="240" y="196">RCVD_M2</text>
                  <text x="268" y="228">Verify</text>
                  <text x="336" y="228">message_2</text>
                  <text x="116" y="260">Processing</text>
                  <text x="184" y="260">error</text>
                  <text x="240" y="276">VRFD_M2</text>
                  <text x="260" y="308">Send</text>
                  <text x="320" y="308">message_3</text>
                  <text x="108" y="340">(Receive</text>
                  <text x="172" y="340">error)</text>
                  <text x="248" y="356">COMPLETED</text>
                  <text x="276" y="388">(Receive</text>
                  <text x="356" y="388">message_4)</text>
                  <text x="112" y="420">(Processing</text>
                  <text x="188" y="420">error)</text>
                  <text x="464" y="420">(Verify</text>
                  <text x="240" y="436">(RCVD_M4)</text>
                  <text x="488" y="436">application</text>
                  <text x="476" y="452">message)</text>
                  <text x="272" y="468">(Verify</text>
                  <text x="348" y="468">message_4)</text>
                  <text x="248" y="516">PERSISTED</text>
                </g>
              </svg><a class="pilcrow" href="#appendix-I.1-7.1.1">¶</a>
</div>
</div>
<figcaption><a class="selfRef" href="#figure-12">Figure 12</a>:
<a class="selfRef" href="#name-initiator-state-machine-2">Initiator State Machine</a>
          </figcaption></figure>
</section>
</div>
<div id="responder-state-machine">
<section id="appendix-I.2">
        <h3 id="name-responder-state-machine">
<a class="section-number selfRef" href="#appendix-I.2">I.2. </a><a class="section-name selfRef" href="#name-responder-state-machine">Responder State Machine</a>
        </h3>
<p id="appendix-I.2-1">Upon receiving message_1, the Responder transitions from START to RCVD_M1.<a class="pilcrow" href="#appendix-I.2-1">¶</a></p>
<p id="appendix-I.2-2">If a processing error occurs on message_1, the Responder transitions from RCVD_M1 to ABORTED. This includes sending an error message with error code 2 (Wrong Selected Cipher Suite) if the selected cipher suite in message_1 is not supported. In case of successful processing of message_1, the Responder transitions from RCVD_M1 to VRFD_M1.<a class="pilcrow" href="#appendix-I.2-2">¶</a></p>
<p id="appendix-I.2-3">The Responder prepares and processes message_2 for sending. If any processing error is encountered, the Responder transitions from VRFD_M1 to ABORTED. If message_2 is successfully sent, the Initiator transitions from VRFD_M2 to WAIT_M3 and waits for message_3.<a class="pilcrow" href="#appendix-I.2-3">¶</a></p>
<p id="appendix-I.2-4">If the incoming message is an error message, then the Responder transitions from WAIT_M3 to ABORTED.<a class="pilcrow" href="#appendix-I.2-4">¶</a></p>
<p id="appendix-I.2-5">Upon receiving message_3, the Responder transitions from WAIT_M3 to RCVD_M3. If a processing error occurs on message_3, the Responder transitions from RCVD_M3 to ABORTED. In case of successful processing of message_3, the Responder transitions from RCVD_M3 to COMPLETED (="VRFD_M3").<a class="pilcrow" href="#appendix-I.2-5">¶</a></p>
<p id="appendix-I.2-6">If the application profile includes message_4, the Responder prepares and processes message_4 for sending. If any processing error is encountered, the Responder transitions from COMPLETED to ABORTED.<a class="pilcrow" href="#appendix-I.2-6">¶</a></p>
<p id="appendix-I.2-7">If message_4 is successfully sent, or if the application profile does not include message_4, the Responder transitions from COMPLETED to PERSISTED.<a class="pilcrow" href="#appendix-I.2-7">¶</a></p>
<span id="name-responder-state-machine-2"></span><figure id="figure-13">
          <div id="appendix-I.2-8.1">
            <div class="alignCenter art-svg artwork" id="appendix-I.2-8.1.1">
<svg class="diagram" font-family="monospace" font-size="13px" stroke-linecap="round" text-anchor="middle" version="1.1" viewBox="0 0 384 528" xmlns="http://www.w3.org/2000/svg">
                <path d="M 40,128 L 40,432" fill="none" stroke="black"></path>
                <path d="M 232,48 L 232,96" fill="none" stroke="black"></path>
                <path d="M 232,128 L 232,176" fill="none" stroke="black"></path>
                <path d="M 232,208 L 232,256" fill="none" stroke="black"></path>
                <path d="M 232,288 L 232,336" fill="none" stroke="black"></path>
                <path d="M 232,368 L 232,416" fill="none" stroke="black"></path>
                <path d="M 232,448 L 232,496" fill="none" stroke="black"></path>
                <path d="M 72,112 L 200,112" fill="none" stroke="black"></path>
                <path d="M 40,192 L 200,192" fill="none" stroke="black"></path>
                <path d="M 40,272 L 200,272" fill="none" stroke="black"></path>
                <path d="M 40,352 L 200,352" fill="none" stroke="black"></path>
                <path d="M 40,432 L 192,432" fill="none" stroke="black"></path>
                <polygon class="arrowhead" fill="black" points="240,496 228,490.4 228,501.6" transform="rotate(90,232,496)"></polygon>
                <polygon class="arrowhead" fill="black" points="240,416 228,410.4 228,421.6" transform="rotate(90,232,416)"></polygon>
                <polygon class="arrowhead" fill="black" points="240,336 228,330.4 228,341.6" transform="rotate(90,232,336)"></polygon>
                <polygon class="arrowhead" fill="black" points="240,256 228,250.4 228,261.6" transform="rotate(90,232,256)"></polygon>
                <polygon class="arrowhead" fill="black" points="240,176 228,170.4 228,181.6" transform="rotate(90,232,176)"></polygon>
                <polygon class="arrowhead" fill="black" points="240,96 228,90.4 228,101.6" transform="rotate(90,232,96)"></polygon>
                <polygon class="arrowhead" fill="black" points="80,112 68,106.4 68,117.6" transform="rotate(180,72,112)"></polygon>
                <polygon class="arrowhead" fill="black" points="48,360 36,354.4 36,365.6" transform="rotate(270,40,360)"></polygon>
                <polygon class="arrowhead" fill="black" points="48,280 36,274.4 36,285.6" transform="rotate(270,40,280)"></polygon>
                <polygon class="arrowhead" fill="black" points="48,200 36,194.4 36,205.6" transform="rotate(270,40,200)"></polygon>
                <polygon class="arrowhead" fill="black" points="48,128 36,122.4 36,133.6" transform="rotate(270,40,128)"></polygon>
                <g class="text">
                  <text x="232" y="36">START</text>
                  <text x="272" y="68">Receive</text>
                  <text x="344" y="68">message_1</text>
                  <text x="116" y="100">Processing</text>
                  <text x="184" y="100">error</text>
                  <text x="32" y="116">ABORTED</text>
                  <text x="240" y="116">RCVD_M1</text>
                  <text x="268" y="148">Verify</text>
                  <text x="336" y="148">message_1</text>
                  <text x="116" y="180">Processing</text>
                  <text x="184" y="180">error</text>
                  <text x="240" y="196">VRFD_M1</text>
                  <text x="260" y="228">Send</text>
                  <text x="320" y="228">message_2</text>
                  <text x="112" y="260">Receive</text>
                  <text x="168" y="260">error</text>
                  <text x="240" y="276">WAIT_M3</text>
                  <text x="272" y="308">Receive</text>
                  <text x="344" y="308">message_3</text>
                  <text x="116" y="340">Processing</text>
                  <text x="184" y="340">error</text>
                  <text x="240" y="356">RCVD_M3</text>
                  <text x="268" y="388">Verify</text>
                  <text x="336" y="388">message_3</text>
                  <text x="112" y="420">(Processing</text>
                  <text x="188" y="420">error)</text>
                  <text x="240" y="436">COMPLETED</text>
                  <text x="264" y="468">(Send</text>
                  <text x="332" y="468">message_4)</text>
                  <text x="240" y="516">PERSISTED</text>
                </g>
              </svg><a class="pilcrow" href="#appendix-I.2-8.1.1">¶</a>
</div>
</div>
<figcaption><a class="selfRef" href="#figure-13">Figure 13</a>:
<a class="selfRef" href="#name-responder-state-machine-2">Responder State Machine</a>
          </figcaption></figure>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-J">
      <h2 id="name-acknowledgments">
<a class="section-name selfRef" href="#name-acknowledgments">Acknowledgments</a>
      </h2>
<p id="appendix-J-1">The authors want to thank
<span class="contact-name">Christian Amsüss</span>,
<span class="contact-name">Karthikeyan Bhargavan</span>,
<span class="contact-name">Carsten Bormann</span>,
<span class="contact-name">Alessandro Bruni</span>,
<span class="contact-name">Timothy Claeys</span>,
<span class="contact-name">Baptiste Cottier</span>,
<span class="contact-name">Roman Danyliw</span>,
<span class="contact-name">Martin Disch</span>,
<span class="contact-name">Martin Duke</span>,
<span class="contact-name">Donald Eastlake 3rd</span>,
<span class="contact-name">Lars Eggert</span>,
<span class="contact-name">Stephen Farrell</span>,
<span class="contact-name">Loïc Ferreira</span>,
<span class="contact-name">Theis Grønbech Petersen</span>,
<span class="contact-name">Felix Günther</span>,
<span class="contact-name">Dan Harkins</span>,
<span class="contact-name">Klaus Hartke</span>,
<span class="contact-name">Russ Housley</span>,
<span class="contact-name">Stefan Hristozov</span>,
<span class="contact-name">Marc Ilunga</span>,
<span class="contact-name">Charlie Jacomme</span>,
<span class="contact-name">Elise Klein</span>,
<span class="contact-name">Erik Kline</span>,
<span class="contact-name">Steve Kremer</span>,
<span class="contact-name">Alexandros Krontiris</span>,
<span class="contact-name">Ilari Liusvaara</span>,
<span class="contact-name">Rafa Marín-López</span>,
<span class="contact-name">Kathleen Moriarty</span>,
<span class="contact-name">David Navarro</span>,
<span class="contact-name">Karl Norrman</span>,
<span class="contact-name">Salvador Pérez</span>,
<span class="contact-name">Radia Perlman</span>,
<span class="contact-name">David Pointcheval</span>,
<span class="contact-name">Maïwenn Racouchot</span>,
<span class="contact-name">Eric Rescorla</span>,
<span class="contact-name">Michael Richardson</span>,
<span class="contact-name">Thorvald Sahl Jørgensen</span>,
<span class="contact-name">Zaheduzzaman Sarker</span>,
<span class="contact-name">Jim Schaad</span>,
<span class="contact-name">Michael Scharf</span>,
<span class="contact-name">Carsten Schürmann</span>,
<span class="contact-name">John Scudder</span>,
<span class="contact-name">Ludwig Seitz</span>,
<span class="contact-name">Brian Sipos</span>,
<span class="contact-name">Stanislav Smyshlyaev</span>,
<span class="contact-name">Valery Smyslov</span>,
<span class="contact-name">Peter van der Stok</span>,
<span class="contact-name">Rene Struik</span>,
<span class="contact-name">Vaishnavi Sundararajan</span>,
<span class="contact-name">Erik Thormarker</span>,
<span class="contact-name">Marco Tiloca</span>,
<span class="contact-name">Sean Turner</span>,
<span class="contact-name">Michel Veillette</span>,
<span class="contact-name">Mališa Vučinić</span>,
<span class="contact-name">Paul Wouters</span>,
and
<span class="contact-name">Lei Yan</span>
      for reviewing and commenting on intermediate draft versions of this document.<a class="pilcrow" href="#appendix-J-1">¶</a></p>
<p id="appendix-J-2">We are especially indebted to the late <span class="contact-name">Jim Schaad</span> for his continuous review and implementation of draft versions of this document, as well as his work on other technologies such as COSE and OSCORE without which EDHOC would not have been.<a class="pilcrow" href="#appendix-J-2">¶</a></p>
<p id="appendix-J-3">Work on this document has in part been supported by the H2020 project SIFIS-Home (grant agreement 952652).<a class="pilcrow" href="#appendix-J-3">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-K">
      <h2 id="name-authors-addresses">
<a class="section-name selfRef" href="#name-authors-addresses">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Göran Selander</span></div>
<div class="left" dir="auto"><span class="org">Ericsson AB</span></div>
<div class="left" dir="auto">SE-<span class="postal-code">164 80</span> <span class="locality">Stockholm</span>
</div>
<div class="left" dir="auto"><span class="country-name">Sweden</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:goran.selander@ericsson.com">goran.selander@ericsson.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">John Preuß Mattsson</span></div>
<div class="left" dir="auto"><span class="org">Ericsson AB</span></div>
<div class="left" dir="auto">SE-<span class="postal-code">164 80</span> <span class="locality">Stockholm</span>
</div>
<div class="left" dir="auto"><span class="country-name">Sweden</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:john.mattsson@ericsson.com">john.mattsson@ericsson.com</a>
</div>
</address>
<address class="vcard">
        <div class="left" dir="auto"><span class="fn nameRole">Francesca Palombini</span></div>
<div class="left" dir="auto"><span class="org">Ericsson AB</span></div>
<div class="left" dir="auto">SE-<span class="postal-code">164 80</span> <span class="locality">Stockholm</span>
</div>
<div class="left" dir="auto"><span class="country-name">Sweden</span></div>
<div class="email">
<span>Email:</span>
<a class="email" href="mailto:francesca.palombini@ericsson.com">francesca.palombini@ericsson.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>


</body></html>