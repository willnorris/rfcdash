<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc5595 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:35 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="draft-fairhurst-dccp-serv-codes" name="DC.Relation.Replaces"/>
<meta content="urn:ietf:rfc:5595" name="DC.Identifier"/>
<meta content="September, 2009" name="DC.Date.Issued"/>
<meta content="Godred (Gorry) Fairhurst &lt;gorry@erg.abdn.ac.uk&gt;" name="DC.Creator"/>
<meta content="This document describes the usage of Service Codes by the Datagram
Congestion Control Protocol, RFC 4340. This document motivates the
setting of Service Codes by applications. Service Codes provide a
method to identify the intended service/application to process a DCCP
connection request. This provides improved flexibility in the use and
assignment of port numbers for connection multiplexing. The use of a
DCCP Service Code can also enable more explicit coordination of
services with middleboxes (e.g. network address translators and
firewalls). It updates the description provided in RFC 4340." name="DC.Description.Abstract"/>
<meta content="The DCCP Service Code" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 5595 - The DCCP Service Code</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgblue" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc5595.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc5595" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-dccp-serv-codes" title="draft-ietf-dccp-serv-codes">draft-ietf-dccp...</a>] [<a href="https://datatracker.ietf.org/doc/rfc5595" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc5595" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc5595" title="Side-by-side diff">Diff2</a>] [<a href="https://www.rfc-editor.org/errata_search.php?rfc=5595">Errata</a>]</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">Updated by: <a href="rfc6335.html">6335</a>                                       PROPOSED STANDARD</span><br/>
<span class="pre noprint docinfo">                                                            <span style="color: #C00;">Errata Exist</span></span><br/>
<pre>Network Working Group                                       G. Fairhurst
Request for Comments: 5595                        University of Aberdeen
Updates: <a href="rfc4340.html">4340</a>                                             September 2009
Category: Standards Track


     <span class="h1">The Datagram Congestion Control Protocol (DCCP) Service Codes</span>

Abstract

   This document describes the usage of Service Codes by the Datagram
   Congestion Control Protocol, <a href="rfc4340.html">RFC 4340</a>.  It motivates the setting of a
   Service Code by applications.  Service Codes provide a method to
   identify the intended service/application to process a DCCP
   connection request.  This provides improved flexibility in the use
   and assignment of port numbers for connection multiplexing.  The use
   of a DCCP Service Code can also enable more explicit coordination of
   services with middleboxes (e.g., network address translators and
   firewalls).  This document updates the specification provided in <a href="rfc4340.html">RFC</a>
   <a href="rfc4340.html">4340</a>.

Status of This Memo

   This document specifies an Internet standards track protocol for the
   Internet community, and requests discussion and suggestions for
   improvements.  Please refer to the current edition of the "Internet
   Official Protocol Standards" (STD 1) for the standardization state
   and status of this protocol.  Distribution of this memo is unlimited.

Copyright and License Notice

   Copyright (c) 2009 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the BSD License.

   This document may contain material from IETF Documents or IETF
   Contributions published or made publicly available before November
   10, 2008.  The person(s) controlling the copyright in some of this
   material may not have granted the IETF Trust the right to allow



<span class="grey">Fairhurst                   Standards Track                     [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc5595.html">RFC 5595</a>                   DCCP Service Codes             September 2009</span>


   modifications of such material outside the IETF Standards Process.
   Without obtaining an adequate license from the person(s) controlling
   the copyright in such materials, this document may not be modified
   outside the IETF Standards Process, and derivative works of it may
   not be created outside the IETF Standards Process, except to format
   it for publication as an RFC or to translate it into languages other
   than English.

Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-3">3</a>
      <a href="#section-1.1">1.1</a>. History ....................................................<a href="#page-3">3</a>
      <a href="#section-1.2">1.2</a>. Conventions Used in This Document ..........................<a href="#page-6">6</a>
   <a href="#section-2">2</a>. An Architecture for Service Codes ...............................<a href="#page-6">6</a>
      <a href="#section-2.1">2.1</a>. IANA Port Numbers ..........................................<a href="#page-6">6</a>
      <a href="#section-2.2">2.2</a>. DCCP Service Code Values ...................................<a href="#page-7">7</a>
           <a href="#section-2.2.1">2.2.1</a>. New Versions of Applications or Protocols ...........<a href="#page-8">8</a>
      <a href="#section-2.3">2.3</a>. Service Code Registry ......................................<a href="#page-8">8</a>
      <a href="#section-2.4">2.4</a>. Zero Service Code ..........................................<a href="#page-9">9</a>
      <a href="#section-2.5">2.5</a>. Invalid Service Code .......................................<a href="#page-9">9</a>
      <a href="#section-2.6">2.6</a>. SDP for Describing Service Codes ...........................<a href="#page-9">9</a>
      <a href="#section-2.7">2.7</a>. A Method to Hash the Service Code to a Dynamic Port ........<a href="#page-9">9</a>
   <a href="#section-3">3</a>. Use of the DCCP Service Code ...................................<a href="#page-10">10</a>
      <a href="#section-3.1">3.1</a>. Setting Service Codes at the Client .......................<a href="#page-11">11</a>
      <a href="#section-3.2">3.2</a>. Using Service Codes in the Network ........................<a href="#page-11">11</a>
      <a href="#section-3.3">3.3</a>. Using Service Codes at the Server .........................<a href="#page-12">12</a>
           <a href="#section-3.3.1">3.3.1</a>. Reception of a DCCP-Request ........................<a href="#page-13">13</a>
           3.3.2. Multiple Associations of a Service Code
                  with Ports .........................................<a href="#page-14">14</a>
           <a href="#section-3.3.3">3.3.3</a>. Automatically Launching a Server ...................<a href="#page-14">14</a>
   <a href="#section-4">4</a>. Security Considerations ........................................<a href="#page-14">14</a>
      <a href="#section-4.1">4.1</a>. Server Port Number Reuse ..................................<a href="#page-15">15</a>
      <a href="#section-4.2">4.2</a>. Association of Applications with Service Codes ............<a href="#page-15">15</a>
      <a href="#section-4.3">4.3</a>. Interactions with IPsec ...................................<a href="#page-15">15</a>
   <a href="#section-5">5</a>. IANA Considerations ............................................<a href="#page-16">16</a>
   <a href="#section-6">6</a>. Acknowledgments ................................................<a href="#page-16">16</a>
   <a href="#section-7">7</a>. References .....................................................<a href="#page-17">17</a>
      <a href="#section-7.1">7.1</a>. Normative References ......................................<a href="#page-17">17</a>
      <a href="#section-7.2">7.2</a>. Informative References ....................................<a href="#page-17">17</a>












<span class="grey">Fairhurst                   Standards Track                     [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc5595.html">RFC 5595</a>                   DCCP Service Codes             September 2009</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   DCCP specifies a Service Code as a 4-byte value (32 bits) that
   describes the application-level service to which a client application
   wishes to connect (<a href="rfc4340.html#section-8.1.2">[RFC4340], Section 8.1.2</a>).  A Service Code
   identifies the protocol (or the standard profile, e.g., [<a href="#ref-RTP-DCCP" title='"RTP and the Datagram Congestion Control Protocol (DCCP)"'>RTP-DCCP</a>])
   to be used at the application layer.  It is not intended to be used
   to specify a variant of an application or a specific variant of a
   protocol (<a href="#section-2.2">Section 2.2</a>).

   The Service Code mechanism allows an application to declare the set
   of services that are associated with server port numbers.  This can
   affect how an application interacts with DCCP.  It also allows
   decoupling of the role of port numbers to indicate a desired service
   from the role of port numbers in demultiplexing and state management.
   A DCCP application identifies the requested service by the Service
   Code value in a DCCP-Request packet.  Each application therefore
   associates one or more Service Codes with each listening port
   (<a href="rfc4340.html#section-8.1.2">[RFC4340], Section 8.1.2</a>).

   The use of Service Codes can assist in identifying the intended
   service by a firewall and may assist other middleboxes (e.g., a proxy
   server or network address translator (NAT) [<a href="rfc2663.html" title='"IP Network Address Translator (NAT) Terminology and Considerations"'>RFC2663</a>]).  Middleboxes
   that desire to identify the type of data a flow claims to transport
   should utilize the Service Code for this purpose.  When consistently
   used, the Service Code can provide a more specific indication of the
   actual service (e.g., indicating the type of multimedia flow or
   intended application behaviour) than deriving this information from
   the server port value.

   The more flexible use of server ports can also offer benefits to
   applications where servers need to handle very large numbers of
   simultaneous-open ports to the same service.

   <a href="rfc4340.html">RFC 4340</a> omits a description of the motivation behind Service Codes,
   and it does not properly describe how Well Known and Registered
   server ports relate to Service Codes.  The intent of this document is
   to clarify these issues.

   <a href="rfc4340.html">RFC 4340</a> states that Service Codes are not intended to be DCCP-
   specific.  Service Codes, or similar concepts, may therefore also be
   useful to other IETF transport protocols.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.1.%20%20History"></a><a class="selflink" href="#section-1.1" name="section-1.1">1.1</a>.  History</span>

   It is simplest to understand the motivation for defining Service
   Codes by describing the history of the DCCP protocol.




<span class="grey">Fairhurst                   Standards Track                     [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc5595.html">RFC 5595</a>                   DCCP Service Codes             September 2009</span>


   Most current Internet transport protocols (TCP [<a href="rfc793.html" title='"Transmission Control Protocol"'>RFC793</a>], UDP
   [<a href="rfc768.html" title='"User Datagram Protocol"'>RFC768</a>], SCTP (the Stream Control Transmission Protocol) [<a href="rfc4960.html" title='"Stream Control Transmission Protocol"'>RFC4960</a>],
   and UDP-Lite [<a href="rfc3828.html" title='"The Lightweight User Datagram Protocol (UDP-Lite)"'>RFC3828</a>]) use "Published" port numbers from the Well
   Known or Registered number spaces [<a href="rfc814.html" title='"Name, addresses, ports, and routes"'>RFC814</a>].  These 16-bit values
   indicate the application service associated with a connection or
   message.  The server port must be known to the client to allow a
   connection to be established.  This may be achieved using out-of-band
   signalling (e.g., described using SDP [<a href="rfc4566.html" title='"SDP: Session Description Protocol"'>RFC4566</a>]), but more commonly a
   Published port is allocated to a particular protocol or application;
   for example, HTTP commonly uses port 80 and SMTP commonly uses port
   25.  Making a port number Published [<a href="rfc1122.html" title='"Requirements for Internet Hosts - Communication Layers"'>RFC1122</a>] involves registration
   with the Internet Assigned Numbers Authority (IANA), which includes
   defining a service by a unique keyword and reserving a port number
   from among a fixed pool [<a href="#ref-IANA">IANA</a>].

   In the earliest draft of DCCP, the authors wanted to address the
   issue of Published ports in a future-proof manner, since this method
   suffers from several problems:

   o  The port space is not sufficiently large for ports to be easily
      allocated (e.g., in an unregulated manner).  Thus, many
      applications operate using unregistered ports, possibly colliding
      with use by other applications.

   o  The use of port-based firewalls encourages application writers to
      disguise one application as another in an attempt to bypass
      firewall filter rules.  This motivates firewall writers to use
      deep packet inspection in an attempt to identify the service
      associated with a port number.

   o  ISPs often deploy transparent proxies, primarily to improve
      performance and reduce costs.  For example, TCP requests destined
      to TCP port 80 are often redirected to a web proxy.

   These issues are coupled.  When applications collide on the same
   Published-but-unregistered port, there is no simple way for network
   security equipment to tell them apart, and thus it is likely that
   problems will be introduced through the interaction of features.

   There is little that a transport protocol designer can do about
   applications that attempt to masquerade as other applications.  For
   ones that are not attempting to hide, the problem may be simply that
   they cannot trivially obtain a Published port.  Ideally, it should be
   sufficiently easy that every application writer can request a Well
   Known or Registered port and receive one instantly with no questions
   asked.  The 16-bit port space traditionally used is not large enough
   to support such a trivial allocation of ports.




<span class="grey">Fairhurst                   Standards Track                     [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc5595.html">RFC 5595</a>                   DCCP Service Codes             September 2009</span>


   Thus, the designers of DCCP sought an alternative solution.  The idea
   was simple.  A 32-bit server port space should be sufficiently large
   to enable use of very simple allocation policies.  However, overhead
   considerations made a 32-bit port value undesirable (DCCP needed to
   be useful for low-rate applications).

   The solution in DCCP to this problem was to use a 32-bit Service Code
   [<a href="rfc4340.html" title='"Datagram Congestion Control Protocol (DCCP)"'>RFC4340</a>] that is included only in the DCCP-Request packet.  The use
   of a 32-bit value was intended to make it trivially simple to obtain
   a unique value for each application.  Placing the value in a DCCP-
   Request packet requires no additional overhead for the actual data
   flow.  It is however sufficient for both the end systems, and
   provides any stateful middleboxes along the path with additional
   information to understand what applications are being used.

   Early discussion of the DCCP protocol considered an alternative to
   the use of traditional ports; instead, it was suggested that a client
   use a 32-bit identifier to uniquely identify each connection and that
   the server listen on a socket bound only to a Service Code.  This
   solution was unambiguous; the Service Code was the only identifier
   for a listening socket at the server side.  The DCCP client included
   a Service Code in the request, allowing it to reach the corresponding
   listening application.  One downside was that this prevented
   deployment of two servers for the same service on a single machine,
   something that is trivial with ports.  The design also suffered from
   the downside of being sufficiently different from existing protocols
   that there were concerns that it would hinder the use of DCCP through
   NATs and other middleboxes.

   <a href="rfc4340.html">RFC 4340</a> abandoned the use of a 32-bit connection identifier in favor
   of two traditional 16-bit port values, one chosen by the server and
   one by the client.  This allows middleboxes to utilize similar
   techniques for DCCP, UDP, TCP, etc.  However, it introduced a new
   problem: "How does the server port relate to the Service Code?"  The
   intent was that the Service Code identified the application or
   protocol using DCCP, providing middleboxes with information about the
   intended use of a connection, and that the pair of ports effectively
   formed a 32-bit connection identifier, which was unique between a
   pair of end systems.

   The large number of available, unique Service Code values allows all
   applications to be assigned a unique Service Code.  However, there
   remained a problem: the server port was chosen by the server, but the
   client needed to know this port to establish a connection.  It was
   undesirable to mandate out-of-band communication to discover the
   server port.  The chosen solution was to register DCCP server ports.
   The limited availability of DCCP server ports appears to contradict
   the benefits of DCCP Service Codes because, although it may be



<span class="grey">Fairhurst                   Standards Track                     [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc5595.html">RFC 5595</a>                   DCCP Service Codes             September 2009</span>


   trivial to obtain a Service Code, it has not traditionally been
   trivial to obtain a Registered port from IANA and, in the long-run,
   it may not be possible to allocate a unique Registered DCCP port to
   new applications.  As port numbers become scarce, this motivates the
   need to associate more than one Service Code with a listening port
   (e.g., two different applications could be assigned the same server
   port and need to run on the same host at the same time,
   differentiated by their different associated Service Codes).

   Service Codes provide flexibility in the way clients identify the
   server application to which they wish to communicate.  The mechanism
   allows a server to associate a set of server ports with a service.
   The set may be common with other services available at the same
   server host, allowing a larger number of concurrent connections for a
   particular service than possible when the service is identified by a
   single Published port number.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.2.%20%20Conventions%20Used%20in%20This%20Document"></a><a class="selflink" href="#section-1.2" name="section-1.2">1.2</a>.  Conventions Used in This Document</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in <a href="rfc2119.html">RFC 2119</a> [<a href="rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20An%20Architecture%20for%20Service%20Codes"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  An Architecture for Service Codes</span>

   DCCP defines the use of a combination of ports and Service Codes to
   identify the server application (<a href="rfc4340.html#section-8.1.2">[RFC4340], Section 8.1.2</a>).  These
   are described in the following sections.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.1.%20%20IANA%20Port%20Numbers"></a><a class="selflink" href="#section-2.1" name="section-2.1">2.1</a>.  IANA Port Numbers</span>

   In DCCP, the packets belonging to a connection are demultiplexed
   based on a combination of four values {source IP address, source
   port, dest IP address, dest port}, as in TCP.  An endpoint address is
   associated with a port number (e.g., forming a socket) and a pair of
   associations uniquely identifies each connection.  Ports provide the
   fundamental per-packet demultiplexing function.

   The Internet Assigned Numbers Authority currently manages the set of
   globally reserved port numbers [<a href="#ref-IANA">IANA</a>].  The source port associated
   with a connection request, often known as the "ephemeral port", is
   traditionally in the range 49152-65535 and also includes the range
   1024-49151.  The value used for the ephemeral port is usually chosen
   by the client operating system.  It has been suggested that a
   randomized choice port number value can help defend against "blind"
   attacks [<a href="#ref-Rand" title='"Port Randomization"'>Rand</a>] in TCP.  This method may be applicable to other IETF-
   defined transport protocols, including DCCP.




<span class="grey">Fairhurst                   Standards Track                     [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc5595.html">RFC 5595</a>                   DCCP Service Codes             September 2009</span>


   Traditionally, the destination (server) port value associated with a
   service is determined either by an operating system index that points
   to a copy of the IANA table (e.g., getportbyname() in Unix, which
   indexes the /etc/services file) or by the application specifying a
   direct mapping.

   The UDP and TCP port number space: 0..65535, is split into three
   ranges [<a href="rfc2780.html" title='"IANA Allocation Guidelines For Values In the Internet Protocol and Related Headers"'>RFC2780</a>]:

   o  0..1023 "Well Known", also called "system" ports,

   o  1024..49151 "Registered", also called "user" ports, and

   o  49152..65535 "Dynamic", also called "private" ports.

   DCCP supports Well Known and Registered ports.  These are allocated
   in the DCCP IANA Port Numbers registry (<a href="rfc4340.html#section-19.9">[RFC4340], Section 19.9</a>).
   Each Registered DCCP port MUST be associated with at least one pre-
   defined Service Code.

   Applications that do not need to use a server port in the Well Known
   or Registered range SHOULD use a Dynamic server port (i.e., one not
   required to be registered in the DCCP Port registry).  Clients can
   identify the server port value for the services to which they wish to
   connect using a range of methods.  One common method is by reception
   of an SDP record (<a href="#section-2.6">Section 2.6</a>) exchanged out-of-band (e.g., using SIP
   [<a href="rfc3261.html" title='"SIP: Session Initiation Protocol"'>RFC3261</a>] or the Real Time Streaming Protocol (RTSP) [<a href="rfc2326.html" title='"Real Time Streaming Protocol (RTSP)"'>RFC2326</a>]).  DNS
   SRV resource records also provide a way to identify a server port for
   a particular service based on the service's string name [<a href="rfc2782.html" title='"A DNS RR for specifying the location of services (DNS SRV)"'>RFC2782</a>].

   Applications that do not use out-of-band signalling can still
   communicate, provided that both client and server agree on the port
   value to be used.  This eliminates the need for each registered
   Service Code to be allocated to an IANA-assigned server port (see
   also <a href="#section-2.7">Section 2.7</a>).

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.2.%20%20DCCP%20Service%20Code%20Values"></a><a class="selflink" href="#section-2.2" name="section-2.2">2.2</a>.  DCCP Service Code Values</span>

   DCCP specifies a 4-byte Service Code (<a href="rfc4340.html#section-8.1.2">[RFC4340], Section 8.1.2</a>)
   represented in one of three forms: a decimal number (the canonical
   method), a 4-character ASCII string [<a href="#ref-ANSI.X3-4.1986">ANSI.X3-4.1986</a>], or an 8-digit
   hexadecimal number.  All standards assigned Service Codes, including
   all values assigned by IANA, are required to use a value that may be
   represented using a subset of the ASCII character set.  Private
   Service Codes do not need to follow this convention, although <a href="rfc4340.html">RFC</a>
   <a href="rfc4340.html">4340</a> suggests that users choose Service Codes that may also be
   represented in ASCII.




<span class="grey">Fairhurst                   Standards Track                     [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc5595.html">RFC 5595</a>                   DCCP Service Codes             September 2009</span>


   The Service Code identifies the application-level service to which a
   client application wishes to connect.  For example, services have
   been defined for the Real-Time Protocol (RTP) [<a href="#ref-RTP-DCCP" title='"RTP and the Datagram Congestion Control Protocol (DCCP)"'>RTP-DCCP</a>].  In a
   different example, Datagram Transport Layer Security (DTLS) [<a href="rfc5238.html" title='"Datagram Transport Layer Security (DTLS) over the Datagram Congestion Control Protocol (DCCP)"'>RFC5238</a>]
   provides a transport-service (not an application-layer service);
   therefore, applications using DTLS are individually identified by a
   set of corresponding Service Code values.

   Endpoints MUST associate a Service Code with every DCCP socket
   [<a href="rfc4340.html" title='"Datagram Congestion Control Protocol (DCCP)"'>RFC4340</a>], both actively and passively opened.  The application will
   generally supply this Service Code.  A single passive-listening port
   may be associated with more than one Service Code value.  The set of
   Service Codes could be associated with one or more server
   applications.  This permits a more flexible correspondence between
   services and port numbers than is possible using the corresponding
   socket pair (4-tuple of layer-3 addresses and layer-4 ports).  In the
   currently defined set of packet types, the Service Code value is
   present only in DCCP-Request (<a href="rfc4340.html#section-5.2">[RFC4340], Section 5.2</a>) and DCCP-
   Response packets (<a href="rfc4340.html#section-5.3">[RFC4340], Section 5.3</a>).  Note that new DCCP packet
   types (e.g., [<a href="rfc5596.html" title='"Datagram Congestion Control Protocol (DCCP) Simultaneous-Open Technique to Facilitate NAT/Middlebox Traversal"'>RFC5596</a>]) could also carry a Service Code value.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.2.1.%20%20New%20Versions%20of%20Applications%20or%20Protocols"></a><a class="selflink" href="#section-2.2.1" name="section-2.2.1">2.2.1</a>.  New Versions of Applications or Protocols</span>

   Applications/protocols that provide version negotiation or indication
   in the protocol operating over DCCP do not require a new server port
   or new Service Code for each new protocol version.  New versions of
   such applications/protocols SHOULD continue to use the same Service
   Code.  If the application developers feel that the new version
   provides significant new capabilities (e.g., that will change the
   behavior of middleboxes), they MAY allocate a new Service Code
   associated with the same or different set of Well Known ports.  If
   the new Service Code is associated with a Well Known or Registered
   port, the DCCP Ports registry MUST also be updated to include the new
   Service Code value, but MAY share the same server port assignment(s).

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.3.%20%20Service%20Code%20Registry"></a><a class="selflink" href="#section-2.3" name="section-2.3">2.3</a>.  Service Code Registry</span>

   The set of registered Service Codes specified for use within the
   general Internet are defined in an IANA-controlled name space.  IANA
   manages new allocations of Service Codes in this space [<a href="rfc4340.html" title='"Datagram Congestion Control Protocol (DCCP)"'>RFC4340</a>].
   Private Service Codes are not centrally allocated and are denoted by
   the decimal range 1056964608-1073741823 (i.e., 32-bit values with the
   high-order byte equal to a value of 63, corresponding to the ASCII
   character '?').

   Associations of Service Code with Well Known ports are also defined
   in the IANA DCCP Port registry (<a href="#section-2.1">Section 2.1</a>).




<span class="grey">Fairhurst                   Standards Track                     [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc5595.html">RFC 5595</a>                   DCCP Service Codes             September 2009</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.4.%20%20Zero%20Service%20Code"></a><a class="selflink" href="#section-2.4" name="section-2.4">2.4</a>.  Zero Service Code</span>

   A Service Code of zero is "permanently reserved (it represents the
   absence of a meaningful Service Code)" [<a href="rfc4340.html" title='"Datagram Congestion Control Protocol (DCCP)"'>RFC4340</a>].  This indicates
   that no application information was provided.  <a href="rfc4340.html">RFC 4340</a> states that
   applications MAY be associated with this Service Code in the same way
   as other Service Code values.  This use is permitted for any server
   port.

   This document clarifies <a href="rfc4340.html#section-19.8">Section 19.8 of RFC 4340</a> by adding the
   following:

      Applications SHOULD NOT use a Service Code of zero.

      Application writers that need a temporary Service Code value
      SHOULD choose a value from the private range (<a href="#section-2.3">Section 2.3</a>).

      Applications intended for deployment in the Internet are
      encouraged to use an IANA-defined Service Code.  If no specific
      Service Code exists, they SHOULD request a new assignment from the
      IANA.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.5.%20%20Invalid%20Service%20Code"></a><a class="selflink" href="#section-2.5" name="section-2.5">2.5</a>.  Invalid Service Code</span>

   <a href="rfc4340.html">RFC 4340</a> defines the Service Code value of 4294967295 in decimal
   (0xFFFFFFFF) as "invalid".  This is provided so implementations can
   use a special 4-byte value to indicate "no valid Service Code".
   Implementations MUST NOT accept a DCCP-Request with this value, and
   SHOULD NOT allow applications to bind to this Service Code value
   [<a href="rfc4340.html" title='"Datagram Congestion Control Protocol (DCCP)"'>RFC4340</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.6.%20%20SDP%20for%20Describing%20Service%20Codes"></a><a class="selflink" href="#section-2.6" name="section-2.6">2.6</a>.  SDP for Describing Service Codes</span>

   Methods that currently signal destination port numbers, such as the
   Session Description Protocol (SDP) [<a href="rfc4566.html" title='"SDP: Session Description Protocol"'>RFC4566</a>], require an extension to
   support DCCP Service Codes [<a href="#ref-RTP-DCCP" title='"RTP and the Datagram Congestion Control Protocol (DCCP)"'>RTP-DCCP</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.7.%20%20A%20Method%20to%20Hash%20the%20Service%20Code%20to%20a%20Dynamic%20Port"></a><a class="selflink" href="#section-2.7" name="section-2.7">2.7</a>.  A Method to Hash the Service Code to a Dynamic Port</span>

   Applications that do not use out-of-band signalling or an IANA-
   assigned port still require both the client and server to agree on
   the server port value to be used.  This section describes an optional
   method that allows an application to derive a default server port
   number from the Service Code.  The returned value is in the Dynamic
   port range [<a href="rfc4340.html" title='"Datagram Congestion Control Protocol (DCCP)"'>RFC4340</a>]:






<span class="grey">Fairhurst                   Standards Track                     [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc5595.html">RFC 5595</a>                   DCCP Service Codes             September 2009</span>


     int s_port; /* server port */
     s_port = ((sc[0]&lt;&lt;7)^(sc[1]&lt;&lt;5)^(sc[2]&lt;&lt;3)^sc[3]) | 0xC000;
     if (s_port==0xFFFF) {s_port = 0xC000;}

   where sc[] represents the 4 bytes of the Service Code, and sc[3] is
   the least significant byte.  For example, this function associates
   SC:fdpz with the server port 64634.

   This algorithm has the following properties:

   o  It identifies a default server port for each service.

   o  It seeks to assign different Service Codes to different ports, but
      does not guarantee an assignment is unique.

   o  It preserves the 4 lowest bits of the final bytes of the Service
      Code, which allows many common series of Service Codes to be
      mapped to a set of adjacent port numbers, e.g., Foo1, and Foo2;
      Fooa and Foob would be assigned adjacent ports.  (Note: this
      consecutive numbering only applies to characters in the range 0-9
      and A-O and P-Z.  When the characters cross a range boundary, the
      algorithm introduces a discontinuity, resulting in mapping to
      non-consecutive ports.  Hence, Fooo and Foop respectively map to
      the decimal values of 65015 and 65000).

   o  It avoids the port 0xFFFF, which is not accessible on all host
      platforms.

   Applications and higher-layer protocols that have been assigned a
   Service Code (or use a Service Code from the unassigned private
   space) may use this method.  It does not preclude other applications
   using the selected server port, since DCCP servers are differentiated
   by the Service Code value.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Use%20of%20the%20DCCP%20Service%20Code"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Use of the DCCP Service Code</span>

   The basic operation of Service Codes is as follows:

   A client initiating a connection:

      -  issues a DCCP-Request with a Service Code and chooses a
         destination (server) port number that is expected to be
         associated with the specified Service Code at the destination.








<span class="grey">Fairhurst                   Standards Track                    [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc5595.html">RFC 5595</a>                   DCCP Service Codes             September 2009</span>


   A server that receives a DCCP-Request:

      -  determines whether an available service matching the Service
         Code is supported for the specified destination server port.
         The session is associated with the Service Code and a
         corresponding server.  A DCCP-Response is returned.

      -  if the service is not available, the session is rejected and a
         DCCP-Reset packet is returned.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.1.%20%20Setting%20Service%20Codes%20at%20the%20Client"></a><a class="selflink" href="#section-3.1" name="section-3.1">3.1</a>.  Setting Service Codes at the Client</span>

   A client application MUST associate every DCCP connection (and hence
   every DCCP active socket) with a single Service Code value
   [<a href="rfc4340.html" title='"Datagram Congestion Control Protocol (DCCP)"'>RFC4340</a>]).  This value is used in the corresponding DCCP-Request
   packet.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.2.%20%20Using%20Service%20Codes%20in%20the%20Network"></a><a class="selflink" href="#section-3.2" name="section-3.2">3.2</a>.  Using Service Codes in the Network</span>

   DCCP connections identified by the Service Code continue to use IP
   addresses and ports, although neither port number may be Published.

   Port numbers and IP addresses are the traditional methods to identify
   a flow within an IP network.  Middlebox [<a href="rfc3234.html" title='"Middleboxes: Taxonomy and Issues"'>RFC3234</a>] implementors
   therefore need to note that new DCCP connections are identified by
   the pair of server port and Service Code in addition to the IP
   address.  This means that the IANA may allocate a server port to more
   than one DCCP application [<a href="rfc4340.html" title='"Datagram Congestion Control Protocol (DCCP)"'>RFC4340</a>].

   Network address and port translators, known collectively as NATs
   [<a href="rfc2663.html" title='"IP Network Address Translator (NAT) Terminology and Considerations"'>RFC2663</a>], may interpret DCCP ports ([<a href="rfc2993.html" title='"Architectural Implications of NAT"'>RFC2993</a>] and [<a href="rfc5597.html" title='"Network Address Translation (NAT) Behavioral Requirements for the Datagram Congestion Control Protocol"'>RFC5597</a>]).  They
   may also interpret DCCP Service Codes.  Interpreting DCCP Service
   Codes can reduce the need to correctly interpret port numbers,
   leading to new opportunities for network address and port
   translators.  Although it is encouraged to associate specific
   delivery properties with the Service Code, e.g., to identify the
   real-time nature of a flow that claims to be using RTP, there is no
   guarantee that the actual connection data corresponds to the
   associated Service Code.  A middlebox implementor may still use deep
   packet inspection, and other means, in an attempt to verify the
   content of a connection.

   The use of the DCCP Service Code can potentially lead to interactions
   with other protocols that interpret or modify DCCP port numbers
   [<a href="rfc3234.html" title='"Middleboxes: Taxonomy and Issues"'>RFC3234</a>].  The following additional clarifications update the
   description provided in <a href="rfc4340.html#section-16">Section 16 of RFC 4340</a>:





<span class="grey">Fairhurst                   Standards Track                    [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc5595.html">RFC 5595</a>                   DCCP Service Codes             September 2009</span>


      o  A middlebox that intends to differentiate applications SHOULD
         test the Service Code in addition to the destination or source
         port of a DCCP-Request or DCCP-Response packet.

      o  A middlebox that does not modify the intended application
         (e.g., NATs [<a href="rfc5597.html" title='"Network Address Translation (NAT) Behavioral Requirements for the Datagram Congestion Control Protocol"'>RFC5597</a>] and Firewalls) MUST NOT change the
         Service Code.

      o  A middlebox MAY send a DCCP-Reset in response to a packet with
         a Service Code that is considered unsuitable.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.3.%20%20Using%20Service%20Codes%20at%20the%20Server"></a><a class="selflink" href="#section-3.3" name="section-3.3">3.3</a>.  Using Service Codes at the Server</span>

   The combination of the Service Code and server port disambiguates
   incoming DCCP-Requests received by a server.  The Service Code is
   used to associate a new DCCP connection with the corresponding
   application service.  Four cases can arise when two DCCP server
   applications passively listen on the same host:

      o  The simplest case arises when two servers are associated with
         different Service Codes and are bound to different server ports
         (<a href="#section-3.3.1">Section 3.3.1</a>).

      o  Two servers may be associated with the same DCCP Service Code
         value but be bound to different server ports (<a href="#section-3.3.2">Section 3.3.2</a>).

      o  Two servers could use different DCCP Service Code values and be
         bound to the same server port (<a href="#section-3.3.1">Section 3.3.1</a>).

      o  Two servers could attempt to use the same DCCP Service Code and
         bind to the same server port.  A DCCP implementation MUST
         disallow this, since there is no way for the DCCP host to
         direct a new connection to the correct server application.

   <a href="rfc4340.html">RFC 4340</a> (<a href="#section-8.1.2">Section 8.1.2</a>) states that an implementation:

      o  MUST associate each active socket with exactly one Service Code
         on a specified server port.

   In addition, <a href="rfc4340.html#section-8.1.2">Section 8.1.2 of RFC 4340</a> also states:

      o  Passive sockets MAY, at the implementation's discretion, be
         associated with more than one Service Code; this might let
         multiple applications, or multiple versions of the same
         application, listen on the same port, differentiated by Service
         Code.





<span class="grey">Fairhurst                   Standards Track                    [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc5595.html">RFC 5595</a>                   DCCP Service Codes             September 2009</span>


   This document updates the above text from <a href="rfc4340.html">RFC 4340</a> by replacing it
   with the following:

      o  An implementation SHOULD allow more than one Service Code to be
         associated with a passive server port, enabling multiple
         applications, or multiple versions of an application, to listen
         on the same port, differentiated by the associated Service
         Code.

   It also adds:

      o  An implementation SHOULD provide a method that informs a server
         of the Service Code value that was selected by an active
         connection.

   A single passively opened (listening) port MAY therefore be
   associated with multiple Service Codes, although an active (open)
   connection can only be associated with a single Service Code.  A
   single application may wish to accept connections for more than one
   Service Code using the same server port.  This may allow a server to
   offer more than the limit of 65,536 services depending on the size of
   the Port field.  The upper limit is based solely on the number of
   unique connections between two hosts (i.e., 4,294,967,296).

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.3.1.%20%20Reception%20of%20a%20DCCP-Request"></a><a class="selflink" href="#section-3.3.1" name="section-3.3.1">3.3.1</a>.  Reception of a DCCP-Request</span>

   When a DCCP-Request is received and the specified destination port is
   not bound to a server, the host MUST reject the connection by issuing
   a DCCP-Reset with the Reset Code "Connection Refused".  A host MAY
   also use the Reset Code "Too Busy" (<a href="rfc4340.html#section-8.1.3">[RFC4340], Section 8.1.3</a>).

   When the requested destination port is bound to a server, the host
   MUST also verify that the server port is associated with the
   specified Service Code (there could be multiple Service Code values
   associated with the same server port).  Two cases can occur:

   o  If the receiving host is listening on a server port and the DCCP-
      Request uses a Service Code that is associated with the port, the
      host accepts the connection.  Once connected, the server returns a
      copy of the Service Code in the DCCP-Response packet, completing
      the initial handshake [<a href="rfc4340.html" title='"Datagram Congestion Control Protocol (DCCP)"'>RFC4340</a>].

   o  If the server port is not associated with the requested Service
      Code, the server SHOULD reject the request by sending a DCCP-Reset
      packet with the Reset Code 8, "Bad Service Code" (<a href="rfc4340.html#section-8.1.2">[RFC4340],
      Section 8.1.2</a>), but MAY use the reason "Connection Refused".





<span class="grey">Fairhurst                   Standards Track                    [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc5595.html">RFC 5595</a>                   DCCP Service Codes             September 2009</span>


   After a connection has been accepted, the protocol control block is
   associated with a pair of ports, a pair of IP addresses, and a single
   Service Code value.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.3.2.%20%20Multiple%20Associations%20of%20a%20Service%20Code%20with%20Ports"></a><a class="selflink" href="#section-3.3.2" name="section-3.3.2">3.3.2</a>.  Multiple Associations of a Service Code with Ports</span>

   DCCP Service Codes are not restricted to specific ports, although
   they may be associated with a specific Well Known port.  This allows
   the same DCCP Service Code value to be associated with more than one
   server port (in either the active or passive state).

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.3.3.%20%20Automatically%20Launching%20a%20Server"></a><a class="selflink" href="#section-3.3.3" name="section-3.3.3">3.3.3</a>.  Automatically Launching a Server</span>

   A host implementation may permit a service to be associated with a
   server port (or range of ports) that is not permanently running at
   the server.  In this case, the arrival of a DCCP-Request may require
   a method to associate a DCCP-Request with a server that handles the
   corresponding Service Code.  This operation could resemble that of
   "inetd" [<a href="#ref-inetd">inetd</a>].

   As in the previous section, when the specified Service Code is not
   associated with the specified server port, the connection MUST be
   aborted and a DCCP Reset message sent [<a href="rfc4340.html" title='"Datagram Congestion Control Protocol (DCCP)"'>RFC4340</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Security%20Considerations"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Security Considerations</span>

   The security considerations of <a href="rfc4340.html">RFC 4340</a> identify and offer guidance
   on security issues relating to DCCP.  This document discusses the
   usage of Service Codes.  It does not describe new protocol functions.

   All IPsec modes protect the integrity of the DCCP header.  This
   protects the Service Code field from undetected modification within
   the network.  In addition, the IPsec Encapsulated Security Payload
   (ESP) mode may be used to encrypt the Service Code field, hiding the
   Service Code value within the network and also preventing
   interpretation by middleboxes.  The DCCP header is not protected by
   application-layer security (e.g., the use of DTLS [<a href="rfc5238.html" title='"Datagram Transport Layer Security (DTLS) over the Datagram Congestion Control Protocol (DCCP)"'>RFC5238</a>] as
   specified in DTLS/DCCP [<a href="rfc4347.html" title='"Datagram Transport Layer Security"'>RFC4347</a>]).

   There are four areas of security that are important:

   1. Server Port number reuse (<a href="#section-4.1">Section 4.1</a>).

   2. Interaction with NATs and firewalls (<a href="#section-3.2">Section 3.2</a> describes
      middlebox behavior).  Requirements relating to DCCP are described
      in [<a href="rfc5597.html" title='"Network Address Translation (NAT) Behavioral Requirements for the Datagram Congestion Control Protocol"'>RFC5597</a>].





<span class="grey">Fairhurst                   Standards Track                    [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc5595.html">RFC 5595</a>                   DCCP Service Codes             September 2009</span>


   3. Interpretation of DCCP Service Codes overriding traditional use of
      reserved/Well Known port numbers (<a href="#section-4.2">Section 4.2</a>).

   4. Interaction with IPsec and DTLS security (<a href="#section-4.3">Section 4.3</a>).

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.1.%20%20Server%20Port%20Number%20Reuse"></a><a class="selflink" href="#section-4.1" name="section-4.1">4.1</a>.  Server Port Number Reuse</span>

   Service Codes are used in addition to ports when demultiplexing
   incoming connections.  This changes the service model to be used by
   applications and middleboxes.  The Port Numbers registry already
   contains instances of multiple application registrations for a single
   port number for TCP and UDP.  These are relatively rare.  Since the
   DCCP Service Code allows multiple applications to safely share the
   same port number, even on the same host, server port number reuse in
   DCCP may be more common than in TCP and UDP.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.2.%20%20Association%20of%20Applications%20with%20Service%20Codes"></a><a class="selflink" href="#section-4.2" name="section-4.2">4.2</a>.  Association of Applications with Service Codes</span>

   The use of Service Codes provides more ready feedback that a concrete
   service is associated with a given port on a server than for a
   service that does not employ Service Codes.  By responding to an
   inbound connection request, systems not using these codes may
   indicate that some service is, or is not, available on a given port,
   but systems using this mechanism immediately provide confirmation (or
   denial) that a particular service is present.  This may have
   implications in terms of port scanning and reconnaissance.

   Care needs to be exercised when interpreting the mapping of a Service
   Code value to the corresponding service.  The same service
   (application) may be accessed using more than one Service Code.
   Examples include the use of separate Service Codes for an application
   layered directly upon DCCP and one using DTLS transport over DCCP
   [<a href="rfc5238.html" title='"Datagram Transport Layer Security (DTLS) over the Datagram Congestion Control Protocol (DCCP)"'>RFC5238</a>].  Other possibilities include the use of a private Service
   Code to map to an application that has already been assigned an IANA-
   defined Service Code value, or multiple Service Code values that map
   to a single application providing more than one service.  Different
   versions of a service (application) may also be mapped to a
   corresponding set of Service Code values.

   Processing of Service Codes may imply more processing than currently
   associated with incoming port numbers.  Implementors need to guard
   against increasing opportunities for Denial of Service attacks.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.3.%20%20Interactions%20with%20IPsec"></a><a class="selflink" href="#section-4.3" name="section-4.3">4.3</a>.  Interactions with IPsec</span>

   The Internet Key Exchange protocol (IKEv2) does not currently specify
   a method to use DCCP Service Codes as a part of the information used
   to set up an IPsec security association.



<span class="grey">Fairhurst                   Standards Track                    [Page 15]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc5595.html">RFC 5595</a>                   DCCP Service Codes             September 2009</span>


   IPsec uses port numbers to perform access control in transport mode
   [<a href="rfc4301.html" title='"Security Architecture for the Internet Protocol"'>RFC4301</a>].  Security policies can define port-specific access control
   (PROTECT, BYPASS, DISCARD) as well as port-specific algorithms and
   keys.  Similarly, firewall policies allow or block traffic based on
   port numbers.

   Use of port numbers in IPsec selectors and firewalls may assume that
   the numbers correspond to Well Known services.  It is useful to note
   that there is no such requirement; any service may run on any port,
   subject to mutual agreement between the endpoint hosts.  Use of the
   Service Code may interfere with this assumption both within IPsec and
   within other firewall systems, but it does not add a new
   vulnerability.  New implementations of IPsec and firewall systems may
   interpret the Service Code when implementing policy rules, but should
   not rely on either port numbers or Service Codes to indicate a
   specific service.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  IANA Considerations</span>

   This document does not update the IANA allocation procedures for the
   DCCP Port Number and DCCP Service Codes Registries as defined in <a href="rfc4340.html">RFC</a>
   <a href="rfc4340.html">4340</a>.

   For completeness, the document notes that it is not required to
   supply an approved document (e.g., a published RFC) to support an
   application for a DCCP Service Code or port number value, although
   RFCs may be used to request Service Code values via the IANA
   Considerations section.  A specification is however required to
   allocate a Service Code that uses a combination of ASCII digits,
   uppercase letters, and character space, '-', '.', and '/') [<a href="rfc4340.html" title='"Datagram Congestion Control Protocol (DCCP)"'>RFC4340</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20Acknowledgments"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  Acknowledgments</span>

   This work has been supported by the EC IST SatSix Project.
   Significant contributions to this document resulted from discussion
   with Joe Touch, and this is gratefully acknowledged.  The author also
   thanks Ian McDonald, Fernando Gont, Eddie Kohler, and the DCCP WG for
   helpful comments on this topic, and Gerrit Renker for his help in
   determining DCCP behavior and review of this document.  Mark Handley
   provided significant input to the text on the definition of Service
   Codes and their usage.  He also contributed much of the material that
   has formed the historical background section.









<span class="grey">Fairhurst                   Standards Track                    [Page 16]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc5595.html">RFC 5595</a>                   DCCP Service Codes             September 2009</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20References"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.1.%20%20Normative%20References"></a><a class="selflink" href="#section-7.1" name="section-7.1">7.1</a>.  Normative References</span>

   [<a id="ref-RFC1122" name="ref-RFC1122">RFC1122</a>]  Braden, R., Ed., "Requirements for Internet Hosts -
              Communication Layers", STD 3, <a href="rfc1122.html">RFC 1122</a>, October 1989.

   [<a id="ref-RFC2119" name="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a id="ref-RFC4340" name="ref-RFC4340">RFC4340</a>]  Kohler, E., Handley, M., and S. Floyd, "Datagram
              Congestion Control Protocol (DCCP)", <a href="rfc4340.html">RFC 4340</a>, March 2006.

   [<a id="ref-RFC5597" name="ref-RFC5597">RFC5597</a>]  Denis-Courmont, R., "Network Address Translation (NAT)
              Behavioral Requirements for the Datagram Congestion
              Control Protocol", <a href="https://tools.ietf.org/html/bcp150">BCP 150</a>, <a href="rfc5597.html">RFC 5597</a>, September 2009.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.2.%20%20Informative%20References"></a><a class="selflink" href="#section-7.2" name="section-7.2">7.2</a>.  Informative References</span>

   [<a id="ref-ANSI.X3-4.1986" name="ref-ANSI.X3-4.1986">ANSI.X3-4.1986</a>]
              American National Standards Institute, "Coded Character
              Set - 7-bit American Standard Code for Information
              Interchange", ANSI X3.4, 1986.

   [<a id="ref-IANA" name="ref-IANA">IANA</a>]     Internet Assigned Numbers Authority, www.iana.org.

   [<a id="ref-RTP-DCCP" name="ref-RTP-DCCP">RTP-DCCP</a>] Perkins, C., "RTP and the Datagram Congestion Control
              Protocol (DCCP)", Work in Progress, June 2007.

   [<a id="ref-Rand" name="ref-Rand">Rand</a>]     Larsen, M. and F. Gont, <a href="https://www.google.com/search?sitesearch=tools.ietf.org%2Fhtml%2F&amp;q=inurl:draft-+%22Port+Randomization%22" style="text-decoration: none">"Port Randomization"</a>, Work in
              Progress, March 2009.

   [<a id="ref-inetd" name="ref-inetd">inetd</a>]    The extended inetd project, <a href="http://xinetd.org/">http://xinetd.org</a>.

   [<a id="ref-RFC768" name="ref-RFC768">RFC768</a>]   Postel, J., "User Datagram Protocol", STD 6, <a href="rfc768.html">RFC 768</a>,
              August 1980.

   [<a id="ref-RFC793" name="ref-RFC793">RFC793</a>]   Postel, J., "Transmission Control Protocol", STD 7, <a href="rfc793.html">RFC</a>
              <a href="rfc793.html">793</a>, September 1981.

   [<a id="ref-RFC814" name="ref-RFC814">RFC814</a>]   Clark, D., "Name, addresses, ports, and routes", <a href="rfc814.html">RFC 814</a>,
              July 1982.

   [<a id="ref-RFC2326" name="ref-RFC2326">RFC2326</a>]  Schulzrinne, H., Rao, A., and R. Lanphier, "Real Time
              Streaming Protocol (RTSP)", <a href="rfc2326.html">RFC 2326</a>, April 1998.






<span class="grey">Fairhurst                   Standards Track                    [Page 17]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc5595.html">RFC 5595</a>                   DCCP Service Codes             September 2009</span>


   [<a id="ref-RFC2663" name="ref-RFC2663">RFC2663</a>]  Srisuresh, P. and M. Holdrege, "IP Network Address
              Translator (NAT) Terminology and Considerations", <a href="rfc2663.html">RFC</a>
              <a href="rfc2663.html">2663</a>, August 1999.

   [<a id="ref-RFC2780" name="ref-RFC2780">RFC2780</a>]  Bradner, S. and V. Paxson, "IANA Allocation Guidelines For
              Values In the Internet Protocol and Related Headers", <a href="https://tools.ietf.org/html/bcp37">BCP</a>
              <a href="https://tools.ietf.org/html/bcp37">37</a>, <a href="rfc2780.html">RFC 2780</a>, March 2000.

   [<a id="ref-RFC2782" name="ref-RFC2782">RFC2782</a>]  Gulbrandsen, A., Vixie, P., and L. Esibov, "A DNS RR for
              specifying the location of services (DNS SRV)", <a href="rfc2782.html">RFC 2782</a>,
              February 2000.

   [<a id="ref-RFC2993" name="ref-RFC2993">RFC2993</a>]  Hain, T., "Architectural Implications of NAT", <a href="rfc2993.html">RFC 2993</a>,
              November 2000.

   [<a id="ref-RFC3234" name="ref-RFC3234">RFC3234</a>]  Carpenter, B. and S. Brim, "Middleboxes: Taxonomy and
              Issues", <a href="rfc3234.html">RFC 3234</a>, February 2002.

   [<a id="ref-RFC3261" name="ref-RFC3261">RFC3261</a>]  Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston,
              A., Peterson, J., Sparks, R., Handley, M., and E.
              Schooler, "SIP: Session Initiation Protocol", <a href="rfc3261.html">RFC 3261</a>,
              June 2002.

   [<a id="ref-RFC3828" name="ref-RFC3828">RFC3828</a>]  Larzon, L-A., Degermark, M., Pink, S., Jonsson, L-E., Ed.,
              and G. Fairhurst, Ed., "The Lightweight User Datagram
              Protocol (UDP-Lite)", <a href="rfc3828.html">RFC 3828</a>, July 2004.

   [<a id="ref-RFC4301" name="ref-RFC4301">RFC4301</a>]  Kent, S. and K. Seo, "Security Architecture for the
              Internet Protocol", <a href="rfc4301.html">RFC 4301</a>, December 2005.

   [<a id="ref-RFC4347" name="ref-RFC4347">RFC4347</a>]  Rescorla, E. and N. Modadugu, "Datagram Transport Layer
              Security", <a href="rfc4347.html">RFC 4347</a>, April 2006.

   [<a id="ref-RFC4566" name="ref-RFC4566">RFC4566</a>]  Handley, M., Jacobson, V., and C. Perkins, "SDP: Session
              Description Protocol", <a href="rfc4566.html">RFC 4566</a>, July 2006.

   [<a id="ref-RFC4960" name="ref-RFC4960">RFC4960</a>]  Stewart, R., Ed., "Stream Control Transmission Protocol",
              <a href="rfc4960.html">RFC 4960</a>, September 2007.

   [<a id="ref-RFC5238" name="ref-RFC5238">RFC5238</a>]  Phelan, T., "Datagram Transport Layer Security (DTLS) over
              the Datagram Congestion Control Protocol (DCCP)", <a href="rfc5238.html">RFC</a>
              <a href="rfc5238.html">5238</a>, May 2008.

   [<a id="ref-RFC5596" name="ref-RFC5596">RFC5596</a>]  Fairhurst, G., "Datagram Congestion Control Protocol
              (DCCP) Simultaneous-Open Technique to Facilitate
              NAT/Middlebox Traversal", <a href="rfc5596.html">RFC 5596</a>, September 2009.





<span class="grey">Fairhurst                   Standards Track                    [Page 18]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-19" id="page-19" name="page-19"> </a>
<span class="grey"><a href="rfc5595.html">RFC 5595</a>                   DCCP Service Codes             September 2009</span>


Author's Address

   Godred Fairhurst,
   School of Engineering,
   University of Aberdeen,
   Kings College,
   Aberdeen, AB24 3UE,
   UK
   EMail: gorry@erg.abdn.ac.uk
   URL:   <a href="http://www.erg.abdn.ac.uk/users/gorry">http://www.erg.abdn.ac.uk/users/gorry</a>









































Fairhurst                   Standards Track                    [Page 19]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc5595 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:35 GMT --></html>