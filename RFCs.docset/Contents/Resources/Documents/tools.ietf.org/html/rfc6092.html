<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc6092 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:32 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="urn:ietf:rfc:6092" name="DC.Identifier"/>
<meta content='This document identifies a set of recommendations for the makers of
devices and describes how to provide for "simple security"
capabilities at the perimeter of local-area IPv6 networks in Internet-
enabled homes and small offices. This document is not an Internet
Standards Track specification; it is published for informational
purposes.' name="DC.Description.Abstract"/>
<meta content="James Woodyatt &lt;jhw@apple.com&gt;" name="DC.Creator"/>
<meta content="January, 2011" name="DC.Date.Issued"/>
<meta content="Recommended Simple Security Capabilities in Customer Premises Equipment (CPE) for Providing Residential IPv6 Internet Service" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 6092 - Recommended Simple Security Capabilities in Customer Premises Equipment (CPE) for Providing Residential IPv6 Internet Service</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgorange" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc6092.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc6092" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-v6ops-cpe-simple-security" title="draft-ietf-v6ops-cpe-simple-security">draft-ietf-v6op...</a>] [<a href="https://datatracker.ietf.org/doc/rfc6092" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc6092" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc6092" title="Side-by-side diff">Diff2</a>]         </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                           INFORMATIONAL</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Internet Engineering Task Force (IETF)                  J. Woodyatt, Ed.
Request for Comments: 6092                                         Apple
Category: Informational                                     January 2011
ISSN: 2070-1721


              <span class="h1">Recommended Simple Security Capabilities in</span>
                 <span class="h1">Customer Premises Equipment (CPE) for</span>
              <span class="h1">Providing Residential IPv6 Internet Service</span>

Abstract

   This document identifies a set of recommendations for the makers of
   devices and describes how to provide for "simple security"
   capabilities at the perimeter of local-area IPv6 networks in
   Internet-enabled homes and small offices.

Status of This Memo

   This document is not an Internet Standards Track specification; it is
   published for informational purposes.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Not all documents
   approved by the IESG are a candidate for any level of Internet
   Standard; see <a href="rfc5741.html#section-2">Section 2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc6092">http://www.rfc-editor.org/info/rfc6092</a>.

Copyright Notice

   Copyright (c) 2011 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.




<span class="grey">Woodyatt                      Informational                     [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc6092.html">RFC 6092</a>           Simple Security in IPv6 Gateway CPE      January 2011</span>


   This document may contain material from IETF Documents or IETF
   Contributions published or made publicly available before November
   10, 2008.  The person(s) controlling the copyright in some of this
   material may not have granted the IETF Trust the right to allow
   modifications of such material outside the IETF Standards Process.
   Without obtaining an adequate license from the person(s) controlling
   the copyright in such materials, this document may not be modified
   outside the IETF Standards Process, and derivative works of it may
   not be created outside the IETF Standards Process, except to format
   it for publication as an RFC or to translate it into languages other
   than English.

Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-3">3</a>
      <a href="#section-1.1">1.1</a>. Special Language ...........................................<a href="#page-3">3</a>
      <a href="#section-1.2">1.2</a>. Use of Normative Keywords ..................................<a href="#page-3">3</a>
   <a href="#section-2">2</a>. Overview ........................................................<a href="#page-4">4</a>
      <a href="#section-2.1">2.1</a>. Basic Sanitation ...........................................<a href="#page-5">5</a>
      <a href="#section-2.2">2.2</a>. Internet Layer Protocols ...................................<a href="#page-5">5</a>
      <a href="#section-2.3">2.3</a>. Transport Layer Protocols ..................................<a href="#page-6">6</a>
   <a href="#section-3">3</a>. Detailed Recommendations ........................................<a href="#page-6">6</a>
      <a href="#section-3.1">3.1</a>. Stateless Filters ..........................................<a href="#page-7">7</a>
      <a href="#section-3.2">3.2</a>. Connection-Free Filters ....................................<a href="#page-8">8</a>
           <a href="#section-3.2.1">3.2.1</a>. Internet Control and Management .....................<a href="#page-8">8</a>
           <a href="#section-3.2.2">3.2.2</a>. Upper-Layer Transport Protocols .....................<a href="#page-8">8</a>
           <a href="#section-3.2.3">3.2.3</a>. UDP Filters ........................................<a href="#page-10">10</a>
           <a href="#section-3.2.4">3.2.4</a>. IPsec and Internet Key Exchange (IKE) ..............<a href="#page-11">11</a>
           <a href="#section-3.2.5">3.2.5</a>. Mobility Support in IPv6 ...........................<a href="#page-12">12</a>
      <a href="#section-3.3">3.3</a>. Connection-Oriented Filters ...............................<a href="#page-13">13</a>
           <a href="#section-3.3.1">3.3.1</a>. TCP Filters ........................................<a href="#page-14">14</a>
           <a href="#section-3.3.2">3.3.2</a>. SCTP Filters .......................................<a href="#page-17">17</a>
           <a href="#section-3.3.3">3.3.3</a>. DCCP Filters .......................................<a href="#page-20">20</a>
           3.3.4. Level 3 Multihoming Shim Protocol for IPv6
                  (Shim6) ............................................<a href="#page-23">23</a>
      <a href="#section-3.4">3.4</a>. Passive Listeners .........................................<a href="#page-23">23</a>
      <a href="#section-3.5">3.5</a>. Management Applications ...................................<a href="#page-24">24</a>
   <a href="#section-4">4</a>. Summary of Recommendations .....................................<a href="#page-25">25</a>
   <a href="#section-5">5</a>. Contributors ...................................................<a href="#page-31">31</a>
   <a href="#section-6">6</a>. Security Considerations ........................................<a href="#page-32">32</a>
   <a href="#section-7">7</a>. References .....................................................<a href="#page-33">33</a>
      <a href="#section-7.1">7.1</a>. Normative References ......................................<a href="#page-33">33</a>
      <a href="#section-7.2">7.2</a>. Informative References ....................................<a href="#page-35">35</a>








<span class="grey">Woodyatt                      Informational                     [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc6092.html">RFC 6092</a>           Simple Security in IPv6 Gateway CPE      January 2011</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   Some IPv6 gateway devices that enable delivery of Internet services
   in residential and small-office settings may be augmented with
   "simple security" capabilities as described in "Local Network
   Protection for IPv6" [<a href="rfc4864.html" title='"Local Network Protection for IPv6"'>RFC4864</a>].  In general, these capabilities cause
   packets to be discarded in an attempt to make local networks and the
   Internet more secure.  However, it is worth noting that some packets
   sent by legitimate applications may also be discarded in this
   process, affecting reliability and ease of use for these
   applications.

   There is a constructive tension between the desires of users for
   transparent end-to-end connectivity on the one hand, and the need for
   local-area network administrators to detect and prevent intrusion by
   unauthorized public Internet users on the other.  This document is
   intended to highlight reasonable limitations on end-to-end
   transparency where security considerations are deemed important to
   promote local and Internet security.

   The reader is cautioned always to remember that the typical
   residential or small-office network administrator has no expertise
   whatsoever in Internet engineering.  Configuration interfaces for
   router/gateway appliances marketed toward them should be easy to
   understand and even easier to ignore.  In particular, extra care
   should be used in the design of baseline operating modes for
   unconfigured devices, since most devices will never be changed from
   their factory configurations.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.1.%20%20Special%20Language"></a><a class="selflink" href="#section-1.1" name="section-1.1">1.1</a>.  Special Language</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [<a href="rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].

   Additionally, the key word "DEFAULT" is to be interpreted in this
   document as pertaining to a configuration as applied by a vendor,
   prior to the administrator changing it for its initial activation.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.2.%20%20Use%20of%20Normative%20Keywords"></a><a class="selflink" href="#section-1.2" name="section-1.2">1.2</a>.  Use of Normative Keywords</span>

      NOTE WELL: This document is not a standard, and conformance with
      it is not required in order to claim conformance with IETF
      standards for IPv6.  It uses the normative keywords defined in the
      previous section only for precision.

   Particular attention is drawn to recommendation REC-49, which calls
   for an easy way to set a gateway to a transparent mode of operation.



<span class="grey">Woodyatt                      Informational                     [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc6092.html">RFC 6092</a>           Simple Security in IPv6 Gateway CPE      January 2011</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Overview"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Overview</span>

   For the purposes of this document, residential Internet gateways are
   assumed to be fairly simple devices with a limited subset of the full
   range of possible features.  They function as default routers
   [<a href="rfc4294.html" title='"IPv6 Node Requirements"'>RFC4294</a>] for a single local-area network, e.g., an Ethernet network,
   a Wi-Fi network, or a bridge between two or more such segments.  They
   have only one interface by which they can access the Internet service
   at any one time, using any of several possible sub-IP mechanisms,
   including tunnels and transition mechanisms.

   In referring to the security capabilities of residential gateways, it
   is reasonable to distinguish between their "interior" network, i.e.,
   the local-area network, and their "exterior" networks, e.g., the
   public Internet and the networks of Internet service providers.  This
   document is concerned only with the behavior of IP packet filters
   that police the flow of traffic between the interior IPv6 network and
   the exterior IPv6 networks of residential Internet gateways.

   The operational goals of security capabilities in Internet gateways
   are described with more detail in "Local Network Protection for IPv6"
   [<a href="rfc4864.html" title='"Local Network Protection for IPv6"'>RFC4864</a>], but they can be summarized as follows.

   o  Check all traffic to and from the public Internet for basic
      sanity, e.g., filter for spoofs and misdirected (sometimes called
      "Martian") packets [<a href="rfc4949.html" title='"Internet Security Glossary, Version 2"'>RFC4949</a>].

   o  Allow tracking of application usage by source and destination
      network addresses and ports.

   o  Provide a barrier against untrusted external influences on the
      interior network by requiring filter state to be activated by
      traffic originating at interior network nodes.

   o  Allow manually configured exceptions to the stateful filtering
      rules according to network administrative policy.

   o  Isolate local network DHCPv6 and DNS resolver services from the
      public Internet.

   Prior to the widespread availability of IPv6 Internet service, homes
   and small offices often used private IPv4 network address realms
   [<a href="rfc1918.html" title='"Address Allocation for Private Internets"'>RFC1918</a>] with Network Address Translation (NAT) functions deployed
   to present all the hosts on the interior network as a single host to







<span class="grey">Woodyatt                      Informational                     [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc6092.html">RFC 6092</a>           Simple Security in IPv6 Gateway CPE      January 2011</span>


   the Internet service provider.  The stateful packet filtering
   behavior of NAT set user expectations that persist today with
   residential IPv6 service.  "Local Network Protection for IPv6"
   [<a href="rfc4864.html" title='"Local Network Protection for IPv6"'>RFC4864</a>] recommends applying stateful packet filtering at
   residential IPv6 gateways that conforms to the user expectations
   already in place.

   Conventional stateful packet filters activate new states as a side
   effect of forwarding outbound flow initiations from interior network
   nodes.  This requires applications to have advance knowledge of the
   addresses of exterior nodes with which they expect to communicate.
   Several proposals are currently under consideration for allowing
   applications to solicit inbound traffic from exterior nodes without
   advance knowledge of their addresses.  While consensus within the
   Internet engineering community has emerged that such protocols are
   necessary to implement in residential IPv6 gateways, the best current
   practice has not yet been established.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.1.%20%20Basic%20Sanitation"></a><a class="selflink" href="#section-2.1" name="section-2.1">2.1</a>.  Basic Sanitation</span>

   In addition to the functions required of all IPv6 routers [<a href="rfc4294.html" title='"IPv6 Node Requirements"'>RFC4294</a>],
   residential gateways are expected to have basic stateless filters for
   prohibiting certain kinds of traffic with invalid headers, e.g.,
   "Martian" packets, spoofs, routing header type code zero, etc.  (See
   <a href="#section-3.1">Section 3.1</a> for more details.)

   Conversely, simple Internet gateways are not expected to prohibit the
   development of new applications.  In particular, packets with end-to-
   end network security and routing extension headers for mobility are
   expected to pass Internet gateways freely.

   Finally, Internet gateways that route multicast traffic are expected
   to implement appropriate filters for multicast traffic to limit the
   scope of multicast groups that span the demarcation between
   residential networks and service provider networks.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.2.%20%20Internet%20Layer%20Protocols"></a><a class="selflink" href="#section-2.2" name="section-2.2">2.2</a>.  Internet Layer Protocols</span>

   As virtual private networking tunnels are regarded as an unacceptably
   wide attack surface, this document recommends that the DEFAULT
   operating mode for residential IPv6 simple security be to treat
   Generic Packet Tunneling [<a href="rfc2473.html" title='"Generic Packet Tunneling in IPv6 Specification"'>RFC2473</a>] and similar protocols as opaque
   transport layers, i.e., inbound tunnel initiations are denied and
   outbound tunnel initiations are accepted.

   IPsec transport and tunnel modes are explicitly secured by
   definition, so this document recommends that the DEFAULT operating
   mode permit IPsec.  To facilitate the use of IPsec in support of IPv6



<span class="grey">Woodyatt                      Informational                     [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc6092.html">RFC 6092</a>           Simple Security in IPv6 Gateway CPE      January 2011</span>


   mobility, the Internet Key Exchange (IKE) protocol [<a href="rfc5996.html" title='"Internet Key Exchange Protocol Version 2 (IKEv2)"'>RFC5996</a>] and the
   Host Identity Protocol (HIP) [<a href="rfc5201.html" title='"Host Identity Protocol"'>RFC5201</a>] should also be permitted in
   the DEFAULT operating mode.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.3.%20%20Transport%20Layer%20Protocols"></a><a class="selflink" href="#section-2.3" name="section-2.3">2.3</a>.  Transport Layer Protocols</span>

   IPv6 simple security functions are principally concerned with the
   stateful filtering of the Internet Control Message Protocol (ICMPv6)
   [<a href="rfc4443.html" title='"Internet Control Message Protocol (ICMPv6) for the Internet Protocol Version 6 (IPv6) Specification"'>RFC4443</a>] and transport layers like the User Datagram Protocol (UDP)
   [<a href="https://tools.ietf.org/html/rfc0768" title='"User Datagram Protocol"'>RFC0768</a>], the Lightweight User Datagram Protocol (UDP-Lite)
   [<a href="rfc3828.html" title='"The Lightweight User Datagram Protocol (UDP-Lite)"'>RFC3828</a>], the Transmission Control Protocol (TCP) [<a href="https://tools.ietf.org/html/rfc0793" title='"Transmission Control Protocol"'>RFC0793</a>], the
   Stream Control Transmission Protocol (SCTP) [<a href="rfc4960.html" title='"Stream Control Transmission Protocol"'>RFC4960</a>], the Datagram
   Congestion Control Protocol (DCCP) [<a href="rfc4340.html" title='"Datagram Congestion Control Protocol (DCCP)"'>RFC4340</a>], and potentially any
   standards-track transport protocols to be defined in the future.

   The general operating principle is that transport layer traffic is
   not forwarded into the interior network of a residential IPv6 gateway
   unless it has been solicited explicitly by interior transport
   endpoints, e.g., by matching the reverse path for previously
   forwarded outbound traffic, or by matching configured exceptions set
   by the network administrator.  All other traffic is expected to be
   discarded or rejected with an ICMPv6 error message to indicate the
   traffic is administratively prohibited.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Detailed%20Recommendations"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Detailed Recommendations</span>

   This section describes the specific recommendations made by this
   document in full detail.  <a href="#section-4">Section 4</a> is a summary.

   Some recommended filters are to be applied to all traffic that passes
   through residential Internet gateways regardless of the direction
   they are to be forwarded.  Other recommended filters are intended to
   be sensitive to the "direction" of traffic flows.  Applied to
   bidirectional transport flows, "direction" has a specific meaning in
   this document.

   Packets are said to be "outbound" if they originate at nodes located
   in the interior network for exterior destinations, and "inbound" if
   they arrive from exterior sources with interior destinations.

   Flows are said to be "outbound" if the originator of the initial
   packet in any given transport association is an interior node and one
   or more of the participants are located in the exterior.  Flows are
   said to be "inbound" if the originator of the initial packet is an
   exterior node and one or more of the participants are nodes on the
   interior network.





<span class="grey">Woodyatt                      Informational                     [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc6092.html">RFC 6092</a>           Simple Security in IPv6 Gateway CPE      January 2011</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.1.%20%20Stateless%20Filters"></a><a class="selflink" href="#section-3.1" name="section-3.1">3.1</a>.  Stateless Filters</span>

   Certain kinds of IPv6 packets MUST NOT be forwarded in either
   direction by residential Internet gateways regardless of network
   state.  These include packets with multicast source addresses,
   packets to destinations with certain non-routable and/or reserved
   prefixes, and packets with deprecated extension headers.

   Other stateless filters are recommended to implement ingress
   filtering (see [<a href="rfc2827.html" title='"Network Ingress Filtering: Defeating Denial of Service Attacks which employ IP Source Address Spoofing"'>RFC2827</a>] and [<a href="rfc3704.html" title='"Ingress Filtering for Multihomed Networks"'>RFC3704</a>]), to enforce multicast scope
   boundaries, and to isolate certain local network services from the
   public Internet.

   REC-1: Packets bearing multicast source addresses in their outer IPv6
   headers MUST NOT be forwarded or transmitted on any interface.

   REC-2: Packets bearing multicast destination addresses in their outer
   IPv6 headers of equal or narrower scope (see "IPv6 Scoped Address
   Architecture" [<a href="rfc4007.html" title='"IPv6 Scoped Address Architecture"'>RFC4007</a>]) than the configured scope boundary level of
   the gateway MUST NOT be forwarded in any direction.  The DEFAULT
   scope boundary level SHOULD be organization-local scope, and it
   SHOULD be configurable by the network administrator.

   REC-3: Packets bearing source and/or destination addresses forbidden
   to appear in the outer headers of packets transmitted over the public
   Internet MUST NOT be forwarded.  In particular, site-local addresses
   are deprecated by [<a href="rfc3879.html" title='"Deprecating Site Local Addresses"'>RFC3879</a>], and [<a href="rfc5156.html" title='"Special-Use IPv6 Addresses"'>RFC5156</a>] explicitly forbids the use
   of address blocks of types IPv4-Mapped Addresses, IPv4-Compatible
   Addresses, Documentation Prefix, and Overlay Routable Cryptographic
   Hash IDentifiers (ORCHID).

   REC-4: Packets bearing deprecated extension headers prior to their
   first upper-layer-protocol header SHOULD NOT be forwarded or
   transmitted on any interface.  In particular, all packets with
   routing extension header type 0 [<a href="rfc2460.html" title='"Internet Protocol, Version 6 (IPv6) Specification"'>RFC2460</a>] preceding the first upper-
   layer-protocol header MUST NOT be forwarded.  See [<a href="rfc5095.html" title='"Deprecation of Type 0 Routing Headers in IPv6"'>RFC5095</a>] for
   additional background.

   REC-5: Outbound packets MUST NOT be forwarded if the source address
   in their outer IPv6 header does not have a unicast prefix configured
   for use by globally reachable nodes on the interior network.

   REC-6: Inbound packets MUST NOT be forwarded if the source address in
   their outer IPv6 header has a global unicast prefix assigned for use
   by globally reachable nodes on the interior network.






<span class="grey">Woodyatt                      Informational                     [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc6092.html">RFC 6092</a>           Simple Security in IPv6 Gateway CPE      January 2011</span>


   REC-7: By DEFAULT, packets with unique local source and/or
   destination addresses [<a href="rfc4193.html" title='"Unique Local IPv6 Unicast Addresses"'>RFC4193</a>] SHOULD NOT be forwarded to or from
   the exterior network.

   REC-8: By DEFAULT, inbound DNS queries received on exterior
   interfaces MUST NOT be processed by any integrated DNS resolving
   server.

   REC-9: Inbound DHCPv6 discovery packets [<a href="rfc3315.html" title='"Dynamic Host Configuration Protocol for IPv6 (DHCPv6)"'>RFC3315</a>] received on
   exterior interfaces MUST NOT be processed by any integrated DHCPv6
   server or relay agent.

      NOTE WELL: Nothing in this document relieves residential Internet
      gateways, when processing headers to identify valid sequences of
      upper-layer transport packets, from any of the requirements of the
      "Internet Protocol, Version 6 (IPv6) Specification" [<a href="rfc2460.html" title='"Internet Protocol, Version 6 (IPv6) Specification"'>RFC2460</a>],
      including any and all future updates and revisions.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.2.%20%20Connection-Free%20Filters"></a><a class="selflink" href="#section-3.2" name="section-3.2">3.2</a>.  Connection-Free Filters</span>

   Some Internet applications use connection-free transport protocols
   with no release semantics, e.g., UDP.  These protocols pose a special
   difficulty for stateful packet filters because most of the
   application state is not carried at the transport level.  State
   records are created when communication is initiated and are abandoned
   when no further communication is detected after some period of time.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.2.1.%20%20Internet%20Control%20and%20Management"></a><a class="selflink" href="#section-3.2.1" name="section-3.2.1">3.2.1</a>.  Internet Control and Management</span>

   Recommendations for filtering ICMPv6 messages in firewall devices are
   described separately in [<a href="rfc4890.html" title='"Recommendations for Filtering ICMPv6 Messages in Firewalls"'>RFC4890</a>] and apply to residential gateways,
   with the additional recommendation that incoming "Destination
   Unreachable" and "Packet Too Big" error messages that don't match any
   filtering state should be dropped.

   REC-10: IPv6 gateways SHOULD NOT forward ICMPv6 "Destination
   Unreachable" and "Packet Too Big" messages containing IP headers that
   do not match generic upper-layer transport state records.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.2.2.%20%20Upper-Layer%20Transport%20Protocols"></a><a class="selflink" href="#section-3.2.2" name="section-3.2.2">3.2.2</a>.  Upper-Layer Transport Protocols</span>

   Residential IPv6 gateways are not expected to prohibit the use of
   applications to be developed using future upper-layer transport
   protocols.  In particular, transport protocols not otherwise
   discussed in subsequent sections of this document are expected to be
   treated consistently, i.e., as having connection-free semantics and
   no special requirements to inspect the transport headers.




<span class="grey">Woodyatt                      Informational                     [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc6092.html">RFC 6092</a>           Simple Security in IPv6 Gateway CPE      January 2011</span>


   In general, upper-layer transport filter state records are expected
   to be created when an interior endpoint sends a packet to an exterior
   address.  The filter allocates (or reuses) a record for the duration
   of communications, with an idle timer to delete the state record when
   no further communications are detected.

   One key aspect of how a packet filter behaves is the way it evaluates
   the exterior address of an endpoint when applying a filtering rule.
   A gateway is said to have "endpoint-independent filtering" behavior
   when the exterior address is not evaluated when matching a packet
   with a flow.  A gateway is said to have "address-dependent filtering"
   behavior when the exterior address of a packet is required to match
   the exterior address for its flow.

   REC-11: If application transparency is most important, then a
   stateful packet filter SHOULD have "endpoint-independent filtering"
   behavior for generic upper-layer transport protocols.  If a more
   stringent filtering behavior is most important, then a filter SHOULD
   have "address-dependent filtering" behavior.  The filtering behavior
   MAY be an option configurable by the network administrator, and it
   MAY be independent of the filtering behavior for other protocols.
   Filtering behavior SHOULD be endpoint independent by DEFAULT in
   gateways intended for provisioning without service-provider
   management.

   REC-12: Filter state records for generic upper-layer transport
   protocols MUST NOT be deleted or recycled until an idle timer not
   less than two minutes has expired without having forwarded a packet
   matching the state in some configurable amount of time.  By DEFAULT,
   the idle timer for such state records is five minutes.

   The Internet security community is never completely at rest.  New
   attack surfaces, and vulnerabilities in them, are typically
   discovered faster than they can be patched by normal equipment
   upgrade cycles.  It's therefore important for vendors of residential
   gateway equipment to provide automatic software updates to patch
   vulnerabilities as they are discovered.

   REC-13: Residential IPv6 gateways SHOULD provide a convenient means
   to update their firmware securely, for the installation of security
   patches and other manufacturer-recommended changes.

   Vendors can expect users and operators to have differing viewpoints
   on the maintenance of patches, with some preferring automatic update
   and some preferring manual procedures.  Those preferring automatic
   update may also prefer either to download from a vendor site or from
   one managed by their network provider.  To handle the disparity,
   vendors are advised to provide both manual and automatic options.  In



<span class="grey">Woodyatt                      Informational                     [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc6092.html">RFC 6092</a>           Simple Security in IPv6 Gateway CPE      January 2011</span>


   the automatic case, they would do well to facilitate
   pre-configuration of the download URL and a means of validating the
   software image, such as a certificate.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.2.3.%20%20UDP%20Filters"></a><a class="selflink" href="#section-3.2.3" name="section-3.2.3">3.2.3</a>.  UDP Filters</span>

   "Network Address Translation (NAT) Behavioral Requirements for
   Unicast UDP" [<a href="rfc4787.html" title='"Network Address Translation (NAT) Behavioral Requirements for Unicast UDP"'>RFC4787</a>] defines the terminology and best current
   practice for stateful filtering of UDP applications in IPv4 with NAT,
   which serves as the model for behavioral requirements for simple UDP
   security in IPv6 gateways, notwithstanding the requirements related
   specifically to network address translation.

   An interior endpoint initiates a UDP flow through a stateful packet
   filter by sending a packet to an exterior address.  The filter
   allocates (or reuses) a filter state record for the duration of the
   flow.  The state record defines the interior and exterior IP
   addresses and ports used between all packets in the flow.

   State records for UDP flows remain active while they are in use and
   are only abandoned after an idle period of some time.

   REC-14: A state record for a UDP flow where both source and
   destination ports are outside the well-known port range
   (ports 0-1023) MUST NOT expire in less than two minutes of idle time.
   The value of the UDP state record idle timer MAY be configurable.
   The DEFAULT is five minutes.

   REC-15: A state record for a UDP flow where one or both of the source
   and destination ports are in the well-known port range (ports 0-1023)
   MAY expire after a period of idle time shorter than two minutes to
   facilitate the operation of the IANA-registered service assigned to
   the port in question.

   As [<a href="rfc4787.html" title='"Network Address Translation (NAT) Behavioral Requirements for Unicast UDP"'>RFC4787</a>] notes, outbound refresh is necessary for allowing the
   interior endpoint to keep the state record alive.  Inbound refresh
   may be useful for applications with no outbound UDP traffic.
   However, allowing inbound refresh can allow an attacker in the
   exterior or a misbehaving application to keep a state record alive
   indefinitely.  This could be a security risk.  Also, if the process
   is repeated with different ports, over time, it could use up all the
   state record memory and resources in the filter.

   REC-16: A state record for a UDP flow MUST be refreshed when a packet
   is forwarded from the interior to the exterior, and it MAY be
   refreshed when a packet is forwarded in the reverse direction.





<span class="grey">Woodyatt                      Informational                    [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc6092.html">RFC 6092</a>           Simple Security in IPv6 Gateway CPE      January 2011</span>


   As described in <a href="rfc4787.html#section-5">Section 5 of [RFC4787]</a>, the connection-free semantics
   of UDP pose a difficulty for packet filters in trying to recognize
   which packets comprise an application flow and which are unsolicited.
   Various strategies have been used in IPv4/NAT gateways with differing
   effects.

   REC-17: If application transparency is most important, then a
   stateful packet filter SHOULD have "endpoint-independent filtering"
   behavior for UDP.  If a more stringent filtering behavior is most
   important, then a filter SHOULD have "address-dependent filtering"
   behavior.  The filtering behavior MAY be an option configurable by
   the network administrator, and it MAY be independent of the filtering
   behavior for TCP and other protocols.  Filtering behavior SHOULD be
   endpoint independent by DEFAULT in gateways intended for provisioning
   without service-provider management.

   Application mechanisms may depend on the reception of ICMPv6 error
   messages triggered by the transmission of UDP messages.  One such
   mechanism is path MTU discovery [<a href="rfc1981.html" title='"Path MTU Discovery for IP version 6"'>RFC1981</a>].

   REC-18: If a gateway forwards a UDP flow, it MUST also forward ICMPv6
   "Destination Unreachable" and "Packet Too Big" messages containing
   UDP headers that match the flow state record.

   REC-19: Receipt of any sort of ICMPv6 message MUST NOT terminate the
   state record for a UDP flow.

   REC-20: UDP-Lite flows [<a href="rfc3828.html" title='"The Lightweight User Datagram Protocol (UDP-Lite)"'>RFC3828</a>] SHOULD be handled in the same way as
   UDP flows, except that the upper-layer transport protocol identifier
   for UDP-Lite is not the same as UDP; therefore, UDP packets MUST NOT
   match UDP-Lite state records, and vice versa.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.2.4.%20%20IPsec%20and%20Internet%20Key%20Exchange%20%28IKE%29"></a><a class="selflink" href="#section-3.2.4" name="section-3.2.4">3.2.4</a>.  IPsec and Internet Key Exchange (IKE)</span>

   The Internet Protocol security (IPsec) suite offers greater
   flexibility and better overall security than the simple security of
   stateful packet filtering at network perimeters.  Therefore,
   residential IPv6 gateways need not prohibit IPsec traffic flows.

   REC-21: In their DEFAULT operating mode, IPv6 gateways MUST NOT
   prohibit the forwarding of packets, to and from legitimate node
   addresses, with destination extension headers of type "Authentication
   Header (AH)" [<a href="rfc4302.html" title='"IP Authentication Header"'>RFC4302</a>] in their outer IP extension header chain.








<span class="grey">Woodyatt                      Informational                    [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc6092.html">RFC 6092</a>           Simple Security in IPv6 Gateway CPE      January 2011</span>


   REC-22: In their DEFAULT operating mode, IPv6 gateways MUST NOT
   prohibit the forwarding of packets, to and from legitimate node
   addresses, with an upper-layer protocol of type "Encapsulating
   Security Payload (ESP)" [<a href="rfc4303.html" title='"IP Encapsulating Security Payload (ESP)"'>RFC4303</a>] in their outer IP extension header
   chain.

   REC-23: If a gateway forwards an ESP flow, it MUST also forward (in
   the reverse direction) ICMPv6 "Destination Unreachable" and "Packet
   Too Big" messages containing ESP headers that match the flow state
   record.

   Internet Key Exchange (IKE) is a secure mechanism for performing
   mutual authentication, exchanging cryptographic material, and
   establishing IPsec Security Associations between peers.  Residential
   IPv6 gateways are expected to facilitate the use of IPsec security
   policies by allowing inbound IKE flows.

   REC-24: In their DEFAULT operating mode, IPv6 gateways MUST NOT
   prohibit the forwarding of any UDP packets, to and from legitimate
   node addresses, with a destination port of 500, i.e., the port
   reserved by IANA for the Internet Key Exchange (IKE) protocol
   [<a href="rfc5996.html" title='"Internet Key Exchange Protocol Version 2 (IKEv2)"'>RFC5996</a>].

   REC-25: In all operating modes, IPv6 gateways SHOULD use filter state
   records for Encapsulating Security Payload (ESP) [<a href="rfc4303.html" title='"IP Encapsulating Security Payload (ESP)"'>RFC4303</a>] that are
   indexable by a 3-tuple comprising the interior node address, the
   exterior node address, and the ESP protocol identifier.  In
   particular, the IPv4/NAT method of indexing state records also by the
   security parameters index (SPI) SHOULD NOT be used.  Likewise, any
   mechanism that depends on detection of Internet Key Exchange (IKE)
   [<a href="rfc5996.html" title='"Internet Key Exchange Protocol Version 2 (IKEv2)"'>RFC5996</a>] initiations SHOULD NOT be used.

   The Host Identity Protocol (HIP) is a secure mechanism for
   establishing host identity and secure communications between
   authenticated hosts.  Residential IPv6 gateways need not prohibit
   inbound HIP flows.

   REC-26: In their DEFAULT operating mode, IPv6 gateways MUST NOT
   prohibit the forwarding of packets, to and from legitimate node
   addresses, with destination extension headers of type "Host Identity
   Protocol (HIP)" [<a href="rfc5201.html" title='"Host Identity Protocol"'>RFC5201</a>] in their outer IP extension header chain.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.2.5.%20%20Mobility%20Support%20in%20IPv6"></a><a class="selflink" href="#section-3.2.5" name="section-3.2.5">3.2.5</a>.  Mobility Support in IPv6</span>

   Mobility support in IPv6 [<a href="rfc3775.html" title='"Mobility Support in IPv6"'>RFC3775</a>] relies on the use of an
   encapsulation mechanism in flows between mobile nodes and their
   correspondent nodes, involving the use of the Type 2 IPv6 Routing
   Header, the Home Address destination header option, and the Mobility



<span class="grey">Woodyatt                      Informational                    [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc6092.html">RFC 6092</a>           Simple Security in IPv6 Gateway CPE      January 2011</span>


   extension header.  In contrast to mobility support in IPv4, mobility
   is a standard feature of IPv6, and no security benefit is generally
   to be gained by denying communications with either interior or
   exterior mobile nodes.

   Not all usage scenarios of mobility support in IPv6 are expected to
   be compatible with IPv6 simple security.  In particular, exterior
   mobile nodes are expected to be prohibited from establishing bindings
   with interior correspondent nodes by the filtering of unsolicited
   inbound Mobility Header messages, unless they are the subject of an
   IPsec security policy.

   REC-27: The state records for flows initiated by outbound packets
   that bear a Home Address destination option [<a href="rfc3775.html" title='"Mobility Support in IPv6"'>RFC3775</a>] are
   distinguished by the addition of the home address of the flow as well
   as the interior care-of address.  IPv6 gateways MUST NOT prohibit the
   forwarding of any inbound packets bearing type 2 routing headers,
   which otherwise match a flow state record, and where A) the address
   in the destination field of the IPv6 header matches the interior
   care-of address of the flow, and B) the Home Address field in the
   Type 2 Routing Header matches the home address of the flow.

   REC-28: Valid sequences of Mobility Header [<a href="rfc3775.html" title='"Mobility Support in IPv6"'>RFC3775</a>] packets MUST be
   forwarded for all outbound and explicitly permitted inbound Mobility
   Header flows.

   REC-29: If a gateway forwards a Mobility Header [<a href="rfc3775.html" title='"Mobility Support in IPv6"'>RFC3775</a>] flow, then
   it MUST also forward, in both directions, the IPv4 and IPv6 packets
   that are encapsulated in IPv6 associated with the tunnel between the
   home agent and the correspondent node.

   REC-30: If a gateway forwards a Mobility Header [<a href="rfc3775.html" title='"Mobility Support in IPv6"'>RFC3775</a>] flow, then
   it MUST also forward (in the reverse direction) ICMPv6 "Destination
   Unreachable" and "Packet Too Big" messages containing any headers
   that match the associated flow state records.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.3.%20%20Connection-Oriented%20Filters"></a><a class="selflink" href="#section-3.3" name="section-3.3">3.3</a>.  Connection-Oriented Filters</span>

   Most Internet applications use connection-oriented transport
   protocols with orderly release semantics.  These protocols include
   TCP, SCTP, DCCP, and potentially any future IETF Standards-Track
   transport protocols that use such semantics.  Stateful packet filters
   track the state of individual transport flows and prohibit the
   forwarding of packets that do not match the state of an active flow
   and do not conform to a rule for the automatic creation of such
   state.





<span class="grey">Woodyatt                      Informational                    [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc6092.html">RFC 6092</a>           Simple Security in IPv6 Gateway CPE      January 2011</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.3.1.%20%20TCP%20Filters"></a><a class="selflink" href="#section-3.3.1" name="section-3.3.1">3.3.1</a>.  TCP Filters</span>

   An interior endpoint initiates a TCP flow through a stateful packet
   filter by sending a SYN packet.  The filter allocates (or reuses) a
   filter state record for the flow.  The state record defines the
   interior and exterior IP addresses and ports used for forwarding all
   packets for that flow.

   Some peer-to-peer applications use an alternate method of connection
   initiation termed "simultaneous-open" ([<a href="https://tools.ietf.org/html/rfc0793" title='"Transmission Control Protocol"'>RFC0793</a>], Figure 8) to
   traverse stateful filters.  In the simultaneous-open mode of
   operation, both peers send SYN packets for the same TCP flow.  The
   SYN packets cross in the network.  Upon receiving the other end's SYN
   packet, each end responds with a SYN-ACK packet, which also cross in
   the network.  The connection is established at each endpoint once the
   SYN-ACK packets are received.

   To provide stateful packet filtering service for TCP, it is necessary
   for a filter to receive, process, and forward all packets for a flow
   that conform to valid transitions of the TCP state machine
   ([<a href="https://tools.ietf.org/html/rfc0793" title='"Transmission Control Protocol"'>RFC0793</a>], Figure 6).

   REC-31: All valid sequences of TCP packets (defined in [<a href="https://tools.ietf.org/html/rfc0793" title='"Transmission Control Protocol"'>RFC0793</a>])
   MUST be forwarded for outbound flows and explicitly permitted inbound
   flows.  In particular, both the normal TCP 3-way handshake mode of
   operation and the simultaneous-open mode of operation MUST be
   supported.

   It is possible to reconstruct enough of the state of a TCP flow to
   allow forwarding between an interior and exterior node, even when the
   filter starts operating after TCP enters the established state.  In
   this case, because the filter has not seen the TCP window-scale
   option, it is not possible for the filter to enforce the TCP window
   invariant by dropping out-of-window segments.

   REC-32: The TCP window invariant MUST NOT be enforced on flows for
   which the filter did not detect whether the window-scale option (see
   [<a href="rfc1323.html" title='"TCP Extensions for High Performance"'>RFC1323</a>]) was sent in the 3-way handshake or simultaneous-open.

   A stateful filter can allow an existing state record to be reused by
   an externally initiated flow if its security policy permits.  Several
   different policies are possible, as described in [<a href="rfc4787.html" title='"Network Address Translation (NAT) Behavioral Requirements for Unicast UDP"'>RFC4787</a>] and
   extended in [<a href="rfc5382.html" title='"NAT Behavioral Requirements for TCP"'>RFC5382</a>].

   REC-33: If application transparency is most important, then a
   stateful packet filter SHOULD have "endpoint-independent filtering"
   behavior for TCP.  If a more stringent filtering behavior is most
   important, then a filter SHOULD have "address-dependent filtering"



<span class="grey">Woodyatt                      Informational                    [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc6092.html">RFC 6092</a>           Simple Security in IPv6 Gateway CPE      January 2011</span>


   behavior.  The filtering behavior MAY be an option configurable by
   the network administrator, and it MAY be independent of the filtering
   behavior for UDP and other protocols.  Filtering behavior SHOULD be
   endpoint independent by DEFAULT in gateways intended for provisioning
   without service-provider management.

   If an inbound SYN packet is filtered, either because a corresponding
   state record does not exist or because of the filter's normal
   behavior, a filter has two basic choices: to discard the packet
   silently, or to signal an error to the sender.  Signaling an error
   through ICMPv6 messages allows the sender to detect that the SYN did
   not reach the intended destination.  Discarding the packet, on the
   other hand, allows applications to perform simultaneous-open more
   reliably.  A more detailed discussion of this issue can be found in
   [<a href="rfc5382.html" title='"NAT Behavioral Requirements for TCP"'>RFC5382</a>], but the basic outcome of it is that filters need to wait
   on signaling errors until simultaneous-open will not be impaired.

   REC-34: By DEFAULT, a gateway MUST respond with an ICMPv6
   "Destination Unreachable" error code 1 (Communication with
   destination administratively prohibited) to any unsolicited inbound
   SYN packet after waiting at least 6 seconds without first forwarding
   the associated outbound SYN or SYN/ACK from the interior peer.

   A TCP filter maintains state associated with in-progress connections
   and established flows.  Because of this, a filter is susceptible to a
   resource-exhaustion attack whereby an attacker (or virus) on the
   interior attempts to cause the filter to exhaust its capacity for
   creating state records.  To defend against such attacks, a filter
   needs to abandon unused state records after a sufficiently long
   period of idleness.

   A common method used for TCP filters in IPv4/NAT gateways is to
   abandon preferentially flow state records for crashed endpoints,
   followed by closed flows and partially open flows.  A gateway can
   check if an endpoint for a session has crashed by sending a TCP keep-
   alive packet on behalf of the other endpoint and receiving a TCP RST
   packet in response.  If the gateway cannot determine whether the
   endpoint is active, then the associated state record needs to be
   retained until the TCP flow has been idle for some time.

      Note: An established TCP flow can stay idle (but live)
      indefinitely; hence, there is no fixed value for an idle-timeout
      that accommodates all applications.  However, a large idle-timeout
      motivated by recommendations in [<a href="rfc1122.html" title='"Requirements for Internet Hosts - Communication Layers"'>RFC1122</a>] and [<a href="rfc4294.html" title='"IPv6 Node Requirements"'>RFC4294</a>] can reduce
      the chances of abandoning a live flow.






<span class="grey">Woodyatt                      Informational                    [Page 15]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc6092.html">RFC 6092</a>           Simple Security in IPv6 Gateway CPE      January 2011</span>


   TCP flows can stay in the established phase indefinitely without
   exchanging packets.  Some end-hosts can be configured to send keep-
   alive packets on such idle flows; by default, such packets are sent
   every two hours, if enabled [<a href="rfc1122.html" title='"Requirements for Internet Hosts - Communication Layers"'>RFC1122</a>].  Consequently, a filter that
   waits for slightly over two hours can detect idle flows with keep-
   alive packets being sent at the default rate.  TCP flows in the
   partially open or closing phases, on the other hand, can stay idle
   for at most four minutes while waiting for in-flight packets to be
   delivered [<a href="rfc1122.html" title='"Requirements for Internet Hosts - Communication Layers"'>RFC1122</a>].

   The "established flow idle-timeout" for a stateful packet filter is
   defined as the minimum time a TCP flow in the established phase must
   remain idle before the filter considers the associated state record a
   candidate for collection.  The "transitory flow idle-timeout" for a
   filter is defined as the minimum time a TCP flow in the partially
   open or closing phases must remain idle before the filter considers
   the associated state record a candidate for collection.  TCP flows in
   the TIME-WAIT state are not affected by the "transitory flow idle-
   timeout" parameter.

   REC-35: If a gateway cannot determine whether the endpoints of a TCP
   flow are active, then it MAY abandon the state record if it has been
   idle for some time.  In such cases, the value of the "established
   flow idle-timeout" MUST NOT be less than two hours four minutes, as
   discussed in [<a href="rfc5382.html" title='"NAT Behavioral Requirements for TCP"'>RFC5382</a>].  The value of the "transitory flow idle-
   timeout" MUST NOT be less than four minutes.  The value of the idle-
   timeouts MAY be configurable by the network administrator.

   Behavior for handling RST packets or TCP flows in the TIME-WAIT state
   is left unspecified.  A gateway MAY hold state for a flow in the
   TIME-WAIT state to accommodate retransmissions of the last ACK.
   However, since the TIME-WAIT state is commonly encountered by
   interior endpoints properly closing the TCP flow, holding state for a
   closed flow can limit the throughput of flows through a gateway with
   limited resources.  [<a href="rfc1337.html" title='"TIME-WAIT Assassination Hazards in TCP"'>RFC1337</a>] discusses hazards associated with
   TIME-WAIT assassination.

   The handling of non-SYN packets for which there is no active state
   record is left unspecified.  Such packets can be received if the
   gateway abandons a live flow, or abandons a flow in the TIME-WAIT
   state before the four-minute TIME-WAIT period expires.  The decision
   either to discard or to respond with an ICMPv6 "Destination
   Unreachable" error code 1 (Communication with destination
   administratively prohibited) is left up to the implementation.

   Behavior for notifying endpoints when abandoning live flows is left
   unspecified.  When a gateway abandons a live flow, for example due to
   a timeout expiring, the filter MAY send a TCP RST packet to each



<span class="grey">Woodyatt                      Informational                    [Page 16]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc6092.html">RFC 6092</a>           Simple Security in IPv6 Gateway CPE      January 2011</span>


   endpoint on behalf of the other.  Sending a RST notification allows
   endpoint applications to recover more quickly; however, notifying
   endpoints might not always be possible if, for example, state records
   are lost due to power interruption.

   Several TCP mechanisms depend on the reception of ICMPv6 error
   messages triggered by the transmission of TCP segments.  One such
   mechanism is path MTU discovery, which is required for correct
   operation of TCP.

   REC-36: If a gateway forwards a TCP flow, it MUST also forward ICMPv6
   "Destination Unreachable" and "Packet Too Big" messages containing
   TCP headers that match the flow state record.

   REC-37: Receipt of any sort of ICMPv6 message MUST NOT terminate the
   state record for a TCP flow.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.3.2.%20%20SCTP%20Filters"></a><a class="selflink" href="#section-3.3.2" name="section-3.3.2">3.3.2</a>.  SCTP Filters</span>

   Because Stream Control Transmission Protocol (SCTP) [<a href="rfc4960.html" title='"Stream Control Transmission Protocol"'>RFC4960</a>] flows
   can be terminated at multiple network addresses, IPv6 simple security
   functions cannot achieve full transparency for SCTP applications.  In
   multipath traversal scenarios, full transparency requires
   coordination between all the packet filter processes in the various
   paths between the endpoint network addresses.  Such coordination is
   not "simple", and it is, therefore, beyond the scope of this
   recommendation.

   However, some SCTP applications are capable of tolerating the
   inherent unipath restriction of IPv6 simple security, even in
   multipath traversal scenarios.  They expect connection-oriented
   filtering behaviors similar to those for TCP, but at the level of
   SCTP associations, not stream connections.  This section describes
   specific recommendations for SCTP filtering for such traversal
   scenarios.

   An interior endpoint initiates SCTP associations through a stateful
   packet filter by sending a packet comprising a single INIT chunk.
   The filter allocates (or reuses) a filter state record for the
   association.  The state record defines the interior and exterior IP
   addresses and the observed verification tag used for forwarding
   packets in that association.

   Some peer-to-peer SCTP applications use an alternate method of
   association initiation, termed "simultaneous-open", to traverse
   stateful filters.  In the simultaneous-open mode of operation, both
   peers send INIT chunks at the same time to establish an association.
   Upon receiving the other end's INIT chunk, each end responds with an



<span class="grey">Woodyatt                      Informational                    [Page 17]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc6092.html">RFC 6092</a>           Simple Security in IPv6 Gateway CPE      January 2011</span>


   INIT-ACK packet, which is expected to traverse the same path in
   reverse.  Because only one SCTP association may exist between any two
   network addresses, one of the peers in the simultaneous-open mode of
   operation will send an ERROR or ABORT chunk along with the INIT-ACK
   chunk.  The association is established at each endpoint once an
   INIT-ACK chunk without an ERROR or ABORT chunk is received at one
   end.

   To provide stateful packet filtering service for SCTP, it is
   necessary for a filter to receive, process, and forward all packets
   for an association that conform to valid transitions of the SCTP
   state machine ([<a href="rfc4960.html" title='"Stream Control Transmission Protocol"'>RFC4960</a>], Figure 3).

   REC-38: All valid sequences of SCTP packets (defined in [<a href="rfc4960.html" title='"Stream Control Transmission Protocol"'>RFC4960</a>])
   MUST be forwarded for outbound associations and explicitly permitted
   inbound associations.  In particular, both the normal SCTP
   association establishment and the simultaneous-open mode of operation
   MUST be supported.

   If an inbound INIT packet is filtered, either because a corresponding
   state record does not exist or because of the filter's normal
   behavior, a filter has two basic choices: to discard the packet
   silently, or to signal an error to the sender.  Signaling an error
   through ICMPv6 messages allows the sender to detect that the INIT
   packet did not reach the intended destination.  Discarding the
   packet, on the other hand, allows applications to perform
   simultaneous-open more reliably.  Delays in signaling errors can
   prevent the impairment of the simultaneous-open mode of operation.

   REC-39: By DEFAULT, a gateway MUST respond with an ICMPv6
   "Destination Unreachable" error code 1 (Communication with
   destination administratively prohibited), to any unsolicited inbound
   INIT packet after waiting at least 6 seconds without first forwarding
   the associated outbound INIT from the interior peer.

   An SCTP filter maintains state associated with in-progress and
   established associations.  Because of this, a filter is susceptible
   to a resource-exhaustion attack whereby an attacker (or virus) on the
   interior attempts to cause the filter to exhaust its capacity for
   creating state records.  To defend against such attacks, a filter
   needs to abandon unused state records after a sufficiently long
   period of idleness.

   A common method used for TCP filters in IPv4/NAT gateways is to
   abandon preferentially sessions for crashed endpoints, followed by
   closed associations and partially opened associations.  A similar
   method is an option for SCTP filters in IPv6 gateways.  A gateway can
   check if an endpoint for an association has crashed by sending



<span class="grey">Woodyatt                      Informational                    [Page 18]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-19" id="page-19" name="page-19"> </a>
<span class="grey"><a href="rfc6092.html">RFC 6092</a>           Simple Security in IPv6 Gateway CPE      January 2011</span>


   HEARTBEAT chunks and looking for the HEARTBEAT ACK response.  If the
   gateway cannot determine whether the endpoint is active, then the
   associated state record needs to be retained until the SCTP
   association has been idle for some time.

      Note: An established SCTP association can stay idle (but live)
      indefinitely; hence, there is no fixed value of an idle-timeout
      that accommodates all applications.  However, a large idle-timeout
      motivated by recommendations in [<a href="rfc4294.html" title='"IPv6 Node Requirements"'>RFC4294</a>] can reduce the chances
      of abandoning a live association.

   SCTP associations can stay in the ESTABLISHED state indefinitely
   without exchanging packets.  Some end-hosts can be configured to send
   HEARTBEAT chunks on such idle associations, but [<a href="rfc4960.html" title='"Stream Control Transmission Protocol"'>RFC4960</a>] does not
   specify (or even suggest) a default time interval.  A filter that
   waits for slightly over two hours can detect idle associations with
   HEARTBEAT packets being sent at the same rate as most hosts use for
   TCP keep-alive, which is a reasonably similar system for this
   purpose.  SCTP associations in the partially open or closing states,
   on the other hand, can stay idle for at most four minutes while
   waiting for in-flight packets to be delivered (assuming the suggested
   SCTP protocol parameter values in <a href="rfc4960.html#section-15">Section 15 of [RFC4960]</a>).

   The "established association idle-timeout" for a stateful packet
   filter is defined as the minimum time an SCTP association in the
   established phase must remain idle before the filter considers the
   corresponding state record a candidate for collection.  The
   "transitory association idle-timeout" for a filter is defined as the
   minimum time an SCTP association in the partially open or closing
   phases must remain idle before the filter considers the corresponding
   state record a candidate for collection.

   REC-40: If a gateway cannot determine whether the endpoints of an
   SCTP association are active, then it MAY abandon the state record if
   it has been idle for some time.  In such cases, the value of the
   "established association idle-timeout" MUST NOT be less than
   two hours four minutes.  The value of the "transitory association
   idle-timeout" MUST NOT be less than four minutes.  The value of the
   idle-timeouts MAY be configurable by the network administrator.

   Behavior for handling ERROR and ABORT packets is left unspecified.  A
   gateway MAY hold state for an association after its closing phases
   have completed to accommodate retransmissions of its final SHUTDOWN
   ACK packets.  However, holding state for a closed association can
   limit the throughput of associations traversing a gateway with
   limited resources.  The discussion in [<a href="rfc1337.html" title='"TIME-WAIT Assassination Hazards in TCP"'>RFC1337</a>] regarding the hazards
   of TIME-WAIT assassination is relevant.




<span class="grey">Woodyatt                      Informational                    [Page 19]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-20" id="page-20" name="page-20"> </a>
<span class="grey"><a href="rfc6092.html">RFC 6092</a>           Simple Security in IPv6 Gateway CPE      January 2011</span>


   The handling of inbound non-INIT packets for which there is no active
   state record is left unspecified.  Such packets can be received if
   the gateway abandons a live flow, or abandons an association in the
   closing states before the transitory association idle-timeout
   expires.  The decision either to discard or to respond with an ICMPv6
   "Destination Unreachable" error code 1 (Communication with
   destination administratively prohibited) is left to the
   implementation.

   Behavior for notifying endpoints when abandoning live associations is
   left unspecified.  When a gateway abandons a live association, for
   example due to a timeout expiring, the filter MAY send an ABORT
   packet to each endpoint on behalf of the other.  Sending an ABORT
   notification allows endpoint applications to recover more quickly;
   however, notifying endpoints might not always be possible if, for
   example, state records are lost due to power interruption.

   Several SCTP mechanisms depend on the reception of ICMPv6 error
   messages triggered by the transmission of SCTP packets.

   REC-41: If a gateway forwards an SCTP association, it MUST also
   forward ICMPv6 "Destination Unreachable" and "Packet Too Big"
   messages containing SCTP headers that match the association state
   record.

   REC-42: Receipt of any sort of ICMPv6 message MUST NOT terminate the
   state record for an SCTP association.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.3.3.%20%20DCCP%20Filters"></a><a class="selflink" href="#section-3.3.3" name="section-3.3.3">3.3.3</a>.  DCCP Filters</span>

   The connection semantics described in the "Datagram Congestion
   Control Protocol (DCCP)" [<a href="rfc4340.html" title='"Datagram Congestion Control Protocol (DCCP)"'>RFC4340</a>] are very similar to those of TCP.
   An interior endpoint initiates a DCCP flow through a stateful packet
   filter by sending a DCCP-Request packet.  Simultaneous-open is not
   defined for DCCP.

   In order to provide stateful packet filtering service for DCCP, it is
   necessary for a filter to receive, process, and forward all packets
   for a flow that conform to valid transitions of the DCCP state
   machine (<a href="rfc4340.html#section-8">[RFC4340], Section 8</a>).

   REC-43: All valid sequences of DCCP packets (defined in [<a href="rfc4340.html" title='"Datagram Congestion Control Protocol (DCCP)"'>RFC4340</a>])
   MUST be forwarded for all flows to exterior servers, and for any
   flows to interior servers that have explicitly permitted service
   codes.






<span class="grey">Woodyatt                      Informational                    [Page 20]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-21" id="page-21" name="page-21"> </a>
<span class="grey"><a href="rfc6092.html">RFC 6092</a>           Simple Security in IPv6 Gateway CPE      January 2011</span>


   It is possible to reconstruct enough of the state of a DCCP flow to
   allow forwarding between an interior and exterior node, even when the
   filter starts operating after DCCP enters the OPEN state.  Also, a
   filter can allow an existing state record to be reused by an
   externally initiated flow if its security policy permits.  As with
   TCP, several different policies are possible, with a good discussion
   of the issue involved presented in [<a href="rfc4787.html" title='"Network Address Translation (NAT) Behavioral Requirements for Unicast UDP"'>RFC4787</a>] and extended in
   [<a href="rfc5382.html" title='"NAT Behavioral Requirements for TCP"'>RFC5382</a>].

   If an inbound DCCP-Request packet is filtered, either because a
   corresponding state record does not already exist for it or because
   of the filter's normal behavior of refusing flows not explicitly
   permitted, then a filter has two basic choices: to discard the packet
   silently, or to signal an error to the sender.  Signaling an error
   through ICMPv6 messages allows the sender to detect that the
   DCCP-Request did not reach the intended destination.  Discarding the
   packet, on the other hand, only delays the failure to connect and
   provides no measurable security.

   A DCCP filter maintains state associated with in-progress connections
   and established flows.  Because of this, a filter is susceptible to a
   resource-exhaustion attack whereby an attacker (or virus) on the
   interior attempts to cause the filter to exhaust its capacity for
   creating state records.  To prevent such an attack, a filter needs to
   abandon unused state records after a sufficiently long period of
   idleness.

   A common method used for TCP filters in IPv4/NAT gateways is to
   abandon preferentially sessions for crashed endpoints, followed by
   closed TCP flows and partially open flows.  No such method exists for
   DCCP, and flows can stay in the OPEN phase indefinitely without
   exchanging packets.  Hence, there is no fixed value for an idle-
   timeout that accommodates all applications.  However, a large idle-
   timeout motivated by recommendations in [<a href="rfc4294.html" title='"IPv6 Node Requirements"'>RFC4294</a>] can reduce the
   chances of abandoning a live flow.

   DCCP flows in the partially open or closing phases can stay idle for
   at most eight minutes while waiting for in-flight packets to be
   delivered.

   The "open flow idle-timeout" for a stateful packet filter is defined
   as the minimum time a DCCP flow in the open state must remain idle
   before the filter considers the associated state record a candidate








<span class="grey">Woodyatt                      Informational                    [Page 21]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-22" id="page-22" name="page-22"> </a>
<span class="grey"><a href="rfc6092.html">RFC 6092</a>           Simple Security in IPv6 Gateway CPE      January 2011</span>


   for collection.  The "transitory flow idle-timeout" for a filter is
   defined as the minimum time a DCCP flow in the partially open or
   closing phases must remain idle before the filter considers the
   associated state record a candidate for collection.  DCCP flows in
   the TIMEWAIT state are not affected by the "transitory flow idle-
   timeout" parameter.

   REC-44: A gateway MAY abandon a DCCP state record if it has been idle
   for some time.  In such cases, the value of the "open flow idle-
   timeout" MUST NOT be less than two hours four minutes.  The value of
   the "transitory flow idle-timeout" MUST NOT be less than eight
   minutes.  The value of the idle-timeouts MAY be configurable by the
   network administrator.

   Behavior for handling DCCP-Reset packets or flows in the TIMEWAIT
   state is left unspecified.  A gateway MAY hold state for a flow in
   the TIMEWAIT state to accommodate retransmissions of the last
   DCCP-Reset.  However, since the TIMEWAIT state is commonly
   encountered by interior endpoints properly closing the DCCP flow,
   holding state for a closed flow can limit the throughput of flows
   through a gateway with limited resources.  [<a href="rfc1337.html" title='"TIME-WAIT Assassination Hazards in TCP"'>RFC1337</a>] discusses
   hazards associated with TIME-WAIT assassination in TCP, and similar
   hazards exist for DCCP.

   The handling of non-SYN packets for which there is no active state
   record is left unspecified.  Such packets can be received if the
   gateway abandons a live flow, or abandons a flow in the TIMEWAIT
   state before the four-minute 2MSL period (two times the maximum
   segment lifetime [<a href="rfc4340.html" title='"Datagram Congestion Control Protocol (DCCP)"'>RFC4340</a>]) expires.  The decision either to discard
   or to respond with an ICMPv6 "Destination Unreachable" error code 1
   (Communication with destination administratively prohibited) is left
   up to the implementation.

   Behavior for notifying endpoints when abandoning live flows is left
   unspecified.  When a gateway abandons a live flow, for example due to
   a timeout expiring, the filter MAY send a DCCP-Reset packet to each
   endpoint on behalf of the other.  Sending a DCCP-Reset notification
   allows endpoint applications to recover more quickly; however,
   notifying endpoints might not always be possible if, for example,
   state records are lost due to power interruption.

   Several DCCP mechanisms depend on the reception of ICMPv6 error
   messages triggered by the transmission of DCCP packets.  One such
   mechanism is path MTU discovery, which is required for correct
   operation.






<span class="grey">Woodyatt                      Informational                    [Page 22]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-23" id="page-23" name="page-23"> </a>
<span class="grey"><a href="rfc6092.html">RFC 6092</a>           Simple Security in IPv6 Gateway CPE      January 2011</span>


   REC-45: If an Internet gateway forwards a DCCP flow, it MUST also
   forward ICMPv6 "Destination Unreachable" and "Packet Too Big"
   messages containing DCCP headers that match the flow state record.

   REC-46: Receipt of any sort of ICMPv6 message MUST NOT terminate the
   state record for a DCCP flow.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.3.4.%20%20Level%203%20Multihoming%20Shim%20Protocol%20for%20IPv6%20%28Shim6%29"></a><a class="selflink" href="#section-3.3.4" name="section-3.3.4">3.3.4</a>.  Level 3 Multihoming Shim Protocol for IPv6 (Shim6)</span>

   While IPv6 simple security is applicable to residential networks with
   only one Internet service provider at a time, the use of the Level 3
   Multihoming Shim Protocol for IPv6 (Shim6) [<a href="rfc5533.html" title='"Shim6: Level 3 Multihoming Shim Protocol for IPv6"'>RFC5533</a>] is necessary for
   communications with some multihomed exterior destinations.  No
   special recommendations are made in this document for processing the
   Shim6 message format (protocol 140) beyond the recommendations in
   <a href="#section-3.2.2">Section 3.2.2</a>.  The content of the Shim6 payload extension header may
   be ignored.

   REC-47: Valid sequences of packets bearing Shim6 payload extension
   headers in their outer IP extension header chains MUST be forwarded
   for all outbound and explicitly permitted flows.  The content of the
   Shim6 payload extension header MAY be ignored for the purpose of
   state tracking.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.4.%20%20Passive%20Listeners"></a><a class="selflink" href="#section-3.4" name="section-3.4">3.4</a>.  Passive Listeners</span>

   Some applications expect to solicit traffic from exterior nodes
   without advance knowledge of the exterior addresses of their peers.
   This requirement is met by IPv4/NAT gateways, typically by the use of
   either the NAT Port Mapping Protocol [<a href="#ref-NAT-PMP" title='"NAT Port Mapping Protocol (NAT-PMP)"'>NAT-PMP</a>] or the Universal Plug
   and Play Internet Gateway Device [<a href="#ref-UPnP-IGD" title='"Universal Plug and Play Internet Gateway Device Standardized Device Control Protocol"'>UPnP-IGD</a>] standardized device
   control protocol.  On IPv4/NAT networks connected by gateways without
   such services, applications must use techniques like Session
   Traversal Utilities for NAT (STUN) [<a href="rfc5389.html" title='"Session Traversal Utilities for NAT (STUN)"'>RFC5389</a>] to obtain and maintain
   connectivity, despite the translation and filtering effects of NAT.

   While NAT for IPv6 is unlikely to be used in most residential
   gateways, the simple security functions recommended by this document,
   and their filtering effects, are derived from comparable functions
   already in widespread use on the IPv4 Internet.  A similar barrier to
   communication at passive listeners is a natural outcome of the
   deployment of NAT for IPv6.  To avoid the need for IPv6 applications
   to use techniques like STUN for opening and maintaining dynamic
   filter state, something similar to NAT-PMP and UPnP-IGD, but without
   actually supporting NAT, could be deployed.  Alas, no consensus has
   yet emerged in the Internet engineering community as to what is most
   appropriate for residential IPv6 usage scenarios.




<span class="grey">Woodyatt                      Informational                    [Page 23]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-24" id="page-24" name="page-24"> </a>
<span class="grey"><a href="rfc6092.html">RFC 6092</a>           Simple Security in IPv6 Gateway CPE      January 2011</span>


   One proposal that has been offered is the Application Listener
   Discovery Protocol [<a href="#ref-WOODYATT-ALD">WOODYATT-ALD</a>] document.  It remains to be seen
   whether the Internet Gateway Device profile of the Universal Plug and
   Play protocol will be extended for IPv6.  Other proposals of note
   include the Middlebox Communication Protocol [<a href="rfc5189.html" title='"Middlebox Communication (MIDCOM) Protocol Semantics"'>RFC5189</a>] and the Next
   Steps in Signaling framework [<a href="rfc4080.html" title='"Next Steps in Signaling (NSIS): Framework"'>RFC4080</a>].  Until a consensus emerges
   around a specific method, the following recommendations are the best
   guidance available.

   REC-48: Internet gateways with IPv6 simple security capabilities
   SHOULD implement a protocol to permit applications to solicit inbound
   traffic without advance knowledge of the addresses of exterior nodes
   with which they expect to communicate.

   REC-49: Internet gateways with IPv6 simple security capabilities MUST
   provide an easily selected configuration option that permits a
   "transparent mode" of operation that forwards all unsolicited flows
   regardless of forwarding direction, i.e., not to use the IPv6 simple
   security capabilities of the gateway.  The transparent mode of
   operation MAY be the default configuration.

   In general, "transparent mode" will enable more flexibility and
   reliability for applications that require devices to be contacted
   inside the home directly, particularly in the absence of a protocol
   as described in REC-48.  Operating in transparent mode may come at
   the expense of security if there are IPv6 nodes in the home that do
   not have their own host-based firewall capability and require a
   firewall in the gateway in order not to be compromised.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.5.%20%20Management%20Applications"></a><a class="selflink" href="#section-3.5" name="section-3.5">3.5</a>.  Management Applications</span>

   Subscriber-managed residential gateways are unlikely ever to be
   completely zero-configuration, but their administrators will very
   often possess no particular expertise in Internet engineering.  In
   general, the specification of management interfaces for residential
   gateways is out of scope for this document, but the security of
   subscriber-managed gateways merits special attention here.

   REC-50: By DEFAULT, subscriber-managed residential gateways MUST NOT
   offer management application services to the exterior network.











<span class="grey">Woodyatt                      Informational                    [Page 24]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-25" id="page-25" name="page-25"> </a>
<span class="grey"><a href="rfc6092.html">RFC 6092</a>           Simple Security in IPv6 Gateway CPE      January 2011</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Summary%20of%20Recommendations"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Summary of Recommendations</span>

   This section collects all of the recommendations made in this
   document into a convenient list.

   REC-1   Packets bearing multicast source addresses in their outer
           IPv6 headers MUST NOT be forwarded or transmitted on any
           interface.

   REC-2   Packets bearing multicast destination addresses in their
           outer IPv6 headers of equal or narrower scope (see "IPv6
           Scoped Address Architecture" [<a href="rfc4007.html" title='"IPv6 Scoped Address Architecture"'>RFC4007</a>]) than the configured
           scope boundary level of the gateway MUST NOT be forwarded in
           any direction.  The DEFAULT scope boundary level SHOULD be
           organization-local scope, and it SHOULD be configurable by
           the network administrator.

   REC-3   Packets bearing source and/or destination addresses forbidden
           to appear in the outer headers of packets transmitted over
           the public Internet MUST NOT be forwarded.  In particular,
           site-local addresses are deprecated by [<a href="rfc3879.html" title='"Deprecating Site Local Addresses"'>RFC3879</a>], and
           [<a href="rfc5156.html" title='"Special-Use IPv6 Addresses"'>RFC5156</a>] explicitly forbids the use of address blocks of
           types IPv4-Mapped Addresses, IPv4-Compatible Addresses,
           Documentation Prefix, and Overlay Routable Cryptographic Hash
           IDentifiers (ORCHID).

   REC-4   Packets bearing deprecated extension headers prior to their
           first upper-layer-protocol header SHOULD NOT be forwarded or
           transmitted on any interface.  In particular, all packets
           with routing extension header type 0 [<a href="rfc2460.html" title='"Internet Protocol, Version 6 (IPv6) Specification"'>RFC2460</a>] preceding the
           first upper-layer-protocol header MUST NOT be forwarded.  See
           [<a href="rfc5095.html" title='"Deprecation of Type 0 Routing Headers in IPv6"'>RFC5095</a>] for additional background.

   REC-5   Outbound packets MUST NOT be forwarded if the source address
           in their outer IPv6 header does not have a unicast prefix
           configured for use by globally reachable nodes on the
           interior network.

   REC-6   Inbound packets MUST NOT be forwarded if the source address
           in their outer IPv6 header has a global unicast prefix
           assigned for use by globally reachable nodes on the interior
           network.

   REC-7   By DEFAULT, packets with unique local source and/or
           destination addresses [<a href="rfc4193.html" title='"Unique Local IPv6 Unicast Addresses"'>RFC4193</a>] SHOULD NOT be forwarded to or
           from the exterior network.





<span class="grey">Woodyatt                      Informational                    [Page 25]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-26" id="page-26" name="page-26"> </a>
<span class="grey"><a href="rfc6092.html">RFC 6092</a>           Simple Security in IPv6 Gateway CPE      January 2011</span>


   REC-8   By DEFAULT, inbound DNS queries received on exterior
           interfaces MUST NOT be processed by any integrated DNS
           resolving server.

   REC-9   Inbound DHCPv6 discovery packets [<a href="rfc3315.html" title='"Dynamic Host Configuration Protocol for IPv6 (DHCPv6)"'>RFC3315</a>] received on
           exterior interfaces MUST NOT be processed by any integrated
           DHCPv6 server or relay agent.

   REC-10  IPv6 gateways SHOULD NOT forward ICMPv6 "Destination
           Unreachable" and "Packet Too Big" messages containing IP
           headers that do not match generic upper-layer transport state
           records.

   REC-11  If application transparency is most important, then a
           stateful packet filter SHOULD have "endpoint-independent
           filtering" behavior for generic upper-layer transport
           protocols.  If a more stringent filtering behavior is most
           important, then a filter SHOULD have "address-dependent
           filtering" behavior.  The filtering behavior MAY be an option
           configurable by the network administrator, and it MAY be
           independent of the filtering behavior for other protocols.
           Filtering behavior SHOULD be endpoint independent by DEFAULT
           in gateways intended for provisioning without service-
           provider management.

   REC-12  Filter state records for generic upper-layer transport
           protocols MUST NOT be deleted or recycled until an idle timer
           not less than two minutes has expired without having
           forwarded a packet matching the state in some configurable
           amount of time.  By DEFAULT, the idle timer for such state
           records is five minutes.

   REC-13  Residential IPv6 gateways SHOULD provide a convenient means
           to update their firmware securely, for the installation of
           security patches and other manufacturer-recommended changes.

   REC-14  A state record for a UDP flow where both source and
           destination ports are outside the well-known port range
           (ports 0-1023) MUST NOT expire in less than two minutes of
           idle time.  The value of the UDP state record idle timer MAY
           be configurable.  The DEFAULT is five minutes.

   REC-15  A state record for a UDP flow where one or both of the source
           and destination ports are in the well-known port range
           (ports 0-1023) MAY expire after a period of idle time shorter
           than two minutes to facilitate the operation of the IANA-
           registered service assigned to the port in question.




<span class="grey">Woodyatt                      Informational                    [Page 26]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-27" id="page-27" name="page-27"> </a>
<span class="grey"><a href="rfc6092.html">RFC 6092</a>           Simple Security in IPv6 Gateway CPE      January 2011</span>


   REC-16  A state record for a UDP flow MUST be refreshed when a packet
           is forwarded from the interior to the exterior, and it MAY be
           refreshed when a packet is forwarded in the reverse
           direction.

   REC-17  If application transparency is most important, then a
           stateful packet filter SHOULD have "endpoint-independent
           filtering" behavior for UDP.  If a more stringent filtering
           behavior is most important, then a filter SHOULD have
           "address-dependent filtering" behavior.  The filtering
           behavior MAY be an option configurable by the network
           administrator, and it MAY be independent of the filtering
           behavior for TCP and other protocols.  Filtering behavior
           SHOULD be endpoint independent by DEFAULT in gateways
           intended for provisioning without service-provider
           management.

   REC-18  If a gateway forwards a UDP flow, it MUST also forward ICMPv6
           "Destination Unreachable" and "Packet Too Big" messages
           containing UDP headers that match the flow state record.

   REC-19  Receipt of any sort of ICMPv6 message MUST NOT terminate the
           state record for a UDP flow.

   REC-20  UDP-Lite flows [<a href="rfc3828.html" title='"The Lightweight User Datagram Protocol (UDP-Lite)"'>RFC3828</a>] SHOULD be handled in the same way as
           UDP flows, except that the upper-layer transport protocol
           identifier for UDP-Lite is not the same as UDP; therefore,
           UDP packets MUST NOT match UDP-Lite state records, and vice
           versa.

   REC-21  In their DEFAULT operating mode, IPv6 gateways MUST NOT
           prohibit the forwarding of packets, to and from legitimate
           node addresses, with destination extension headers of type
           "Authentication Header (AH)" [<a href="rfc4302.html" title='"IP Authentication Header"'>RFC4302</a>] in their outer IP
           extension header chain.

   REC-22  In their DEFAULT operating mode, IPv6 gateways MUST NOT
           prohibit the forwarding of packets, to and from legitimate
           node addresses, with an upper-layer protocol of type
           "Encapsulating Security Payload (ESP)" [<a href="rfc4303.html" title='"IP Encapsulating Security Payload (ESP)"'>RFC4303</a>] in their
           outer IP extension header chain.

   REC-23  If a gateway forwards an ESP flow, it MUST also forward (in
           the reverse direction) ICMPv6 "Destination Unreachable" and
           "Packet Too Big" messages containing ESP headers that match
           the flow state record.





<span class="grey">Woodyatt                      Informational                    [Page 27]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-28" id="page-28" name="page-28"> </a>
<span class="grey"><a href="rfc6092.html">RFC 6092</a>           Simple Security in IPv6 Gateway CPE      January 2011</span>


   REC-24  In their DEFAULT operating mode, IPv6 gateways MUST NOT
           prohibit the forwarding of any UDP packets, to and from
           legitimate node addresses, with a destination port of 500,
           i.e., the port reserved by IANA for the Internet Key Exchange
           (IKE) Protocol [<a href="rfc5996.html" title='"Internet Key Exchange Protocol Version 2 (IKEv2)"'>RFC5996</a>].

   REC-25  In all operating modes, IPv6 gateways SHOULD use filter state
           records for Encapsulating Security Payload (ESP) [<a href="rfc4303.html" title='"IP Encapsulating Security Payload (ESP)"'>RFC4303</a>]
           that are indexable by a 3-tuple comprising the interior node
           address, the exterior node address, and the ESP protocol
           identifier.  In particular, the IPv4/NAT method of indexing
           state records also by security parameters index (SPI) SHOULD
           NOT be used.  Likewise, any mechanism that depends on
           detection of Internet Key Exchange (IKE) [<a href="rfc5996.html" title='"Internet Key Exchange Protocol Version 2 (IKEv2)"'>RFC5996</a>]
           initiations SHOULD NOT be used.

   REC-26  In their DEFAULT operating mode, IPv6 gateways MUST NOT
           prohibit the forwarding of packets, to and from legitimate
           node addresses, with destination extension headers of type
           "Host Identity Protocol (HIP)" [<a href="rfc5201.html" title='"Host Identity Protocol"'>RFC5201</a>] in their outer IP
           extension header chain.

   REC-27  The state records for flows initiated by outbound packets
           that bear a Home Address destination option [<a href="rfc3775.html" title='"Mobility Support in IPv6"'>RFC3775</a>] are
           distinguished by the addition of the home address of the flow
           as well as the interior care-of address.  IPv6 gateways MUST
           NOT prohibit the forwarding of any inbound packets bearing
           type 2 routing headers, which otherwise match a flow state
           record, and where A) the address in the destination field of
           the IPv6 header matches the interior care-of address of the
           flow, and B) the Home Address field in the Type 2 Routing
           Header matches the home address of the flow.

   REC-28  Valid sequences of Mobility Header [<a href="rfc3775.html" title='"Mobility Support in IPv6"'>RFC3775</a>] packets MUST be
           forwarded for all outbound and explicitly permitted inbound
           Mobility Header flows.

   REC-29  If a gateway forwards a Mobility Header [<a href="rfc3775.html" title='"Mobility Support in IPv6"'>RFC3775</a>] flow, then
           it MUST also forward, in both directions, the IPv4 and IPv6
           packets that are encapsulated in IPv6 associated with the
           tunnel between the home agent and the correspondent node.

   REC-30  If a gateway forwards a Mobility Header [<a href="rfc3775.html" title='"Mobility Support in IPv6"'>RFC3775</a>] flow, then
           it MUST also forward (in the reverse direction) ICMPv6
           "Destination Unreachable" and "Packet Too Big" messages
           containing any headers that match the associated flow state
           records.




<span class="grey">Woodyatt                      Informational                    [Page 28]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-29" id="page-29" name="page-29"> </a>
<span class="grey"><a href="rfc6092.html">RFC 6092</a>           Simple Security in IPv6 Gateway CPE      January 2011</span>


   REC-31  All valid sequences of TCP packets (defined in [<a href="https://tools.ietf.org/html/rfc0793" title='"Transmission Control Protocol"'>RFC0793</a>])
           MUST be forwarded for outbound flows and explicitly permitted
           inbound flows.  In particular, both the normal TCP 3-way
           handshake mode of operation and the simultaneous-open mode of
           operation MUST be supported.

   REC-32  The TCP window invariant MUST NOT be enforced on flows for
           which the filter did not detect whether the window-scale
           option (see [<a href="rfc1323.html" title='"TCP Extensions for High Performance"'>RFC1323</a>]) was sent in the 3-way handshake or
           simultaneous-open.

   REC-33  If application transparency is most important, then a
           stateful packet filter SHOULD have "endpoint-independent
           filtering" behavior for TCP.  If a more stringent filtering
           behavior is most important, then a filter SHOULD have
           "address-dependent filtering" behavior.  The filtering
           behavior MAY be an option configurable by the network
           administrator, and it MAY be independent of the filtering
           behavior for UDP and other protocols.  Filtering behavior
           SHOULD be endpoint independent by DEFAULT in gateways
           intended for provisioning without service-provider
           management.

   REC-34  By DEFAULT, a gateway MUST respond with an ICMPv6
           "Destination Unreachable" error code 1 (Communication with
           destination administratively prohibited), to any unsolicited
           inbound SYN packet after waiting at least 6 seconds without
           first forwarding the associated outbound SYN or SYN/ACK from
           the interior peer.

   REC-35  If a gateway cannot determine whether the endpoints of a TCP
           flow are active, then it MAY abandon the state record if it
           has been idle for some time.  In such cases, the value of the
           "established flow idle-timeout" MUST NOT be less than
           two hours four minutes, as discussed in [<a href="rfc5382.html" title='"NAT Behavioral Requirements for TCP"'>RFC5382</a>].  The value
           of the "transitory flow idle-timeout" MUST NOT be less than
           four minutes.  The value of the idle-timeouts MAY be
           configurable by the network administrator.

   REC-36  If a gateway forwards a TCP flow, it MUST also forward ICMPv6
           "Destination Unreachable" and "Packet Too Big" messages
           containing TCP headers that match the flow state record.

   REC-37  Receipt of any sort of ICMPv6 message MUST NOT terminate the
           state record for a TCP flow.






<span class="grey">Woodyatt                      Informational                    [Page 29]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-30" id="page-30" name="page-30"> </a>
<span class="grey"><a href="rfc6092.html">RFC 6092</a>           Simple Security in IPv6 Gateway CPE      January 2011</span>


   REC-38  All valid sequences of SCTP packets (defined in [<a href="rfc4960.html" title='"Stream Control Transmission Protocol"'>RFC4960</a>])
           MUST be forwarded for outbound associations and explicitly
           permitted inbound associations.  In particular, both the
           normal SCTP association establishment and the simultaneous-
           open mode of operation MUST be supported.

   REC-39  By DEFAULT, a gateway MUST respond with an ICMPv6
           "Destination Unreachable" error code 1 (Communication with
           destination administratively prohibited) to any unsolicited
           inbound INIT packet after waiting at least 6 seconds without
           first forwarding the associated outbound INIT from the
           interior peer.

   REC-40  If a gateway cannot determine whether the endpoints of an
           SCTP association are active, then it MAY abandon the state
           record if it has been idle for some time.  In such cases, the
           value of the "established association idle-timeout" MUST NOT
           be less than two hours four minutes.  The value of the
           "transitory association idle-timeout" MUST NOT be less than
           four minutes.  The value of the idle-timeouts MAY be
           configurable by the network administrator.

   REC-41  If a gateway forwards an SCTP association, it MUST also
           forward ICMPv6 "Destination Unreachable" and "Packet Too Big"
           messages containing SCTP headers that match the association
           state record.

   REC-42  Receipt of any sort of ICMPv6 message MUST NOT terminate the
           state record for an SCTP association.

   REC-43  All valid sequences of DCCP packets (defined in [<a href="rfc4340.html" title='"Datagram Congestion Control Protocol (DCCP)"'>RFC4340</a>])
           MUST be forwarded for all flows to exterior servers, and for
           any flows to interior servers with explicitly permitted
           service codes.

   REC-44  A gateway MAY abandon a DCCP state record if it has been
           idle for some time.  In such cases, the value of the "open
           flow idle-timeout" MUST NOT be less than two hours
           four minutes.  The value of the "transitory flow idle-
           timeout" MUST NOT be less than eight minutes.  The value of
           the idle-timeouts MAY be configurable by the network
           administrator.

   REC-45  If an Internet gateway forwards a DCCP flow, it MUST also
           forward ICMPv6 "Destination Unreachable" and "Packet Too Big"
           messages containing DCCP headers that match the flow state
           record.




<span class="grey">Woodyatt                      Informational                    [Page 30]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-31" id="page-31" name="page-31"> </a>
<span class="grey"><a href="rfc6092.html">RFC 6092</a>           Simple Security in IPv6 Gateway CPE      January 2011</span>


   REC-46  Receipt of any sort of ICMPv6 message MUST NOT terminate the
           state record for a DCCP flow.

   REC-47  Valid sequences of packets bearing Shim6 payload extension
           headers in their outer IP extension header chains MUST be
           forwarded for all outbound and explicitly permitted flows.
           The content of the Shim6 payload extension header MAY be
           ignored for the purpose of state tracking.

   REC-48  Internet gateways with IPv6 simple security capabilities
           SHOULD implement a protocol to permit applications to solicit
           inbound traffic without advance knowledge of the addresses of
           exterior nodes with which they expect to communicate.

   REC-49  Internet gateways with IPv6 simple security capabilities MUST
           provide an easily selected configuration option that permits
           a "transparent mode" of operation that forwards all
           unsolicited flows regardless of forwarding direction, i.e.,
           not to use the IPv6 simple security capabilities of the
           gateway.  The transparent mode of operation MAY be the
           default configuration.

   REC-50  By DEFAULT, subscriber-managed residential gateways MUST NOT
           offer management application services to the exterior
           network.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Contributors"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Contributors</span>

   Comments and criticisms during the development of this document were
   received from the following IETF participants:

            +-------------------+----------------------------+
            | Jari Arkko        | Ran Atkinson               |
            | Fred Baker        | Norbert Bollow             |
            | Cameron Byrne     | Brian Carpenter            |
            | Remi Despres      | Arnaud Ebalard             |
            | Fabrice Fontaine  | Jun-ichiro "itojun" Hagino |
            | Thomas Herbst     | Christian Huitema          |
            | Joel Jaeggli      | Cullen Jennings            |
            | Suresh Krishnan   | Erik Kline                 |
            | Julien Laganier   | Kurt Erik Lindqvist        |
            | Mohamed Boucadair | Keith Moore                |
            | Robert Moskowitz  | Teemu Savolainen           |
            | Hemant Singh      | Yaron Sheffer              |
            | Mark Townsley     | Iljitsch van Beijnum       |
            | Magnus Westerlund | Dan Wing                   |
            +-------------------+----------------------------+




<span class="grey">Woodyatt                      Informational                    [Page 31]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-32" id="page-32" name="page-32"> </a>
<span class="grey"><a href="rfc6092.html">RFC 6092</a>           Simple Security in IPv6 Gateway CPE      January 2011</span>


   The editor thanks them all for their contributions.

   It must be noted that a substantial portion of the text describing
   the detailed requirements for TCP and UDP filtering is derived or
   transposed from [<a href="rfc4787.html" title='"Network Address Translation (NAT) Behavioral Requirements for Unicast UDP"'>RFC4787</a>] and [<a href="rfc5382.html" title='"NAT Behavioral Requirements for TCP"'>RFC5382</a>].  The editors of those
   documents, Francois Audet and Saikat Guha, also deserve substantial
   credit for the form of the present document.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20Security%20Considerations"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  Security Considerations</span>

   The IPv6 stateful filtering behavior described in this document is
   intended to be similar in function to the filtering behavior of
   commonly used IPv4/NAT gateways, which have been widely sold as a
   security tool for residential and small-office/home-office networks.
   As noted in the Security Considerations section of [<a href="rfc2993.html" title='"Architectural Implications of NAT"'>RFC2993</a>], the
   true impact of these tools may be a reduction in security.  It may be
   generally assumed that the impacts discussed in that document related
   to filtering (and not translation) are to be expected with the simple
   IPv6 security mechanisms described here.

   In particular, it is worth noting that stateful filters create the
   illusion of a security barrier, but without the managed intent of a
   firewall.  Appropriate security mechanisms implemented in the end
   nodes, in conjunction with the [<a href="rfc4864.html" title='"Local Network Protection for IPv6"'>RFC4864</a>] local network protection
   methods, function without reliance on network layer hacks and
   transport filters that may change over time.  Also, defined security
   barriers assume that threats originate in the exterior, which may
   lead to practices that result in applications being fully exposed to
   interior attack and which therefore make breaches much easier.

   The security functions described in this document may be considered
   redundant in the event that all IPv6 hosts using a particular gateway
   have their own IPv6 host firewall capabilities enabled.  At the time
   of this writing, the vast majority of commercially available
   operating systems with support for IPv6 include IPv6 host firewall
   capability.

   Also worth noting explicitly, a practical side-effect of the
   recommendations in <a href="#section-3.2.4">Section 3.2.4</a>, to allow inbound IPsec and IKE
   flows from exterior to interior, is to facilitate more transparent
   communication by the use of an unauthenticated mode of IPsec, as
   described in "Better-Than-Nothing-Security: An Unauthenticated Mode
   of IPsec" [<a href="rfc5386.html" title='"Better-Than-Nothing Security: An Unauthenticated Mode of IPsec"'>RFC5386</a>], and this may be a departure from expectations of
   transparency set by traditional IPv4/NAT residential gateways.

   Finally, residential gateways that implement simple security
   functions are a bastion between the interior and the exterior, and
   therefore are a target of denial-of-service attacks against the



<span class="grey">Woodyatt                      Informational                    [Page 32]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-33" id="page-33" name="page-33"> </a>
<span class="grey"><a href="rfc6092.html">RFC 6092</a>           Simple Security in IPv6 Gateway CPE      January 2011</span>


   interior network itself by processes designed to consume the
   resources of the gateway, e.g., a ping or SYN flood.  Gateways should
   employ the same sorts of protection techniques as application servers
   on the Internet.

   The IETF makes no statement, expressed or implied, as to whether
   using the capabilities described in this document ultimately improves
   security for any individual users or for the Internet community as a
   whole.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20References"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.1.%20%20Normative%20References"></a><a class="selflink" href="#section-7.1" name="section-7.1">7.1</a>.  Normative References</span>

   [<a id="ref-RFC0768" name="ref-RFC0768">RFC0768</a>]   Postel, J., "User Datagram Protocol", STD 6, <a href="rfc768.html">RFC 768</a>,
               August 1980.

   [<a id="ref-RFC0793" name="ref-RFC0793">RFC0793</a>]   Postel, J., "Transmission Control Protocol", STD 7,
               <a href="rfc793.html">RFC 793</a>, September 1981.

   [<a id="ref-RFC1323" name="ref-RFC1323">RFC1323</a>]   Jacobson, V., Braden, B., and D. Borman, "TCP Extensions
               for High Performance", <a href="rfc1323.html">RFC 1323</a>, May 1992.

   [<a id="ref-RFC2119" name="ref-RFC2119">RFC2119</a>]   Bradner, S., "Key words for use in RFCs to Indicate
               Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a id="ref-RFC2460" name="ref-RFC2460">RFC2460</a>]   Deering, S. and R. Hinden, "Internet Protocol, Version 6
               (IPv6) Specification", <a href="rfc2460.html">RFC 2460</a>, December 1998.

   [<a id="ref-RFC3315" name="ref-RFC3315">RFC3315</a>]   Droms, R., Bound, J., Volz, B., Lemon, T., Perkins, C.,
               and M. Carney, "Dynamic Host Configuration Protocol for
               IPv6 (DHCPv6)", <a href="rfc3315.html">RFC 3315</a>, July 2003.

   [<a id="ref-RFC3775" name="ref-RFC3775">RFC3775</a>]   Johnson, D., Perkins, C., and J. Arkko, "Mobility Support
               in IPv6", <a href="rfc3775.html">RFC 3775</a>, June 2004.

   [<a id="ref-RFC3828" name="ref-RFC3828">RFC3828</a>]   Larzon, L-A., Degermark, M., Pink, S., Jonsson, L-E., and
               G. Fairhurst, "The Lightweight User Datagram Protocol
               (UDP-Lite)", <a href="rfc3828.html">RFC 3828</a>, July 2004.

   [<a id="ref-RFC3879" name="ref-RFC3879">RFC3879</a>]   Huitema, C. and B. Carpenter, "Deprecating Site Local
               Addresses", <a href="rfc3879.html">RFC 3879</a>, September 2004.

   [<a id="ref-RFC4007" name="ref-RFC4007">RFC4007</a>]   Deering, S., Haberman, B., Jinmei, T., Nordmark, E., and
               B. Zill, "IPv6 Scoped Address Architecture", <a href="rfc4007.html">RFC 4007</a>,
               March 2005.





<span class="grey">Woodyatt                      Informational                    [Page 33]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-34" id="page-34" name="page-34"> </a>
<span class="grey"><a href="rfc6092.html">RFC 6092</a>           Simple Security in IPv6 Gateway CPE      January 2011</span>


   [<a id="ref-RFC4193" name="ref-RFC4193">RFC4193</a>]   Hinden, R. and B. Haberman, "Unique Local IPv6 Unicast
               Addresses", <a href="rfc4193.html">RFC 4193</a>, October 2005.

   [<a id="ref-RFC4302" name="ref-RFC4302">RFC4302</a>]   Kent, S., "IP Authentication Header", <a href="rfc4302.html">RFC 4302</a>,
               December 2005.

   [<a id="ref-RFC4303" name="ref-RFC4303">RFC4303</a>]   Kent, S., "IP Encapsulating Security Payload (ESP)",
               <a href="rfc4303.html">RFC 4303</a>, December 2005.

   [<a id="ref-RFC4340" name="ref-RFC4340">RFC4340</a>]   Kohler, E., Handley, M., and S. Floyd, "Datagram
               Congestion Control Protocol (DCCP)", <a href="rfc4340.html">RFC 4340</a>,
               March 2006.

   [<a id="ref-RFC4443" name="ref-RFC4443">RFC4443</a>]   Conta, A., Deering, S., and M. Gupta, "Internet Control
               Message Protocol (ICMPv6) for the Internet Protocol
               Version 6 (IPv6) Specification", <a href="rfc4443.html">RFC 4443</a>, March 2006.

   [<a id="ref-RFC4787" name="ref-RFC4787">RFC4787</a>]   Audet, F. and C. Jennings, "Network Address Translation
               (NAT) Behavioral Requirements for Unicast UDP", <a href="https://tools.ietf.org/html/bcp127">BCP 127</a>,
               <a href="rfc4787.html">RFC 4787</a>, January 2007.

   [<a id="ref-RFC4890" name="ref-RFC4890">RFC4890</a>]   Davies, E. and J. Mohacsi, "Recommendations for Filtering
               ICMPv6 Messages in Firewalls", <a href="rfc4890.html">RFC 4890</a>, May 2007.

   [<a id="ref-RFC4960" name="ref-RFC4960">RFC4960</a>]   Stewart, R., "Stream Control Transmission Protocol",
               <a href="rfc4960.html">RFC 4960</a>, September 2007.

   [<a id="ref-RFC5095" name="ref-RFC5095">RFC5095</a>]   Abley, J., Savola, P., and G. Neville-Neil, "Deprecation
               of Type 0 Routing Headers in IPv6", <a href="rfc5095.html">RFC 5095</a>,
               December 2007.

   [<a id="ref-RFC5156" name="ref-RFC5156">RFC5156</a>]   Blanchet, M., "Special-Use IPv6 Addresses", <a href="rfc5156.html">RFC 5156</a>,
               April 2008.

   [<a id="ref-RFC5201" name="ref-RFC5201">RFC5201</a>]   Moskowitz, R., Nikander, P., Jokela, P., and T.
               Henderson, "Host Identity Protocol", <a href="rfc5201.html">RFC 5201</a>,
               April 2008.

   [<a id="ref-RFC5996" name="ref-RFC5996">RFC5996</a>]   Kaufman, C., Hoffman, P., Nir, Y., and P. Eronen,
               "Internet Key Exchange Protocol Version 2 (IKEv2)",
               <a href="rfc5996.html">RFC 5996</a>, September 2010.










<span class="grey">Woodyatt                      Informational                    [Page 34]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-35" id="page-35" name="page-35"> </a>
<span class="grey"><a href="rfc6092.html">RFC 6092</a>           Simple Security in IPv6 Gateway CPE      January 2011</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.2.%20%20Informative%20References"></a><a class="selflink" href="#section-7.2" name="section-7.2">7.2</a>.  Informative References</span>

   [<a id="ref-NAT-PMP" name="ref-NAT-PMP">NAT-PMP</a>]   Cheshire, S., Krochmal, M., and K. Sekar, "NAT Port
               Mapping Protocol (NAT-PMP)", Work in Progress,
               April 2008.

   [<a id="ref-RFC1122" name="ref-RFC1122">RFC1122</a>]   Braden, R., "Requirements for Internet Hosts -
               Communication Layers", STD 3, <a href="rfc1122.html">RFC 1122</a>, October 1989.

   [<a id="ref-RFC1337" name="ref-RFC1337">RFC1337</a>]   Braden, B., "TIME-WAIT Assassination Hazards in TCP",
               <a href="rfc1337.html">RFC 1337</a>, May 1992.

   [<a id="ref-RFC1918" name="ref-RFC1918">RFC1918</a>]   Rekhter, Y., Moskowitz, R., Karrenberg, D., Groot, G.,
               and E. Lear, "Address Allocation for Private Internets",
               <a href="https://tools.ietf.org/html/bcp5">BCP 5</a>, <a href="rfc1918.html">RFC 1918</a>, February 1996.

   [<a id="ref-RFC1981" name="ref-RFC1981">RFC1981</a>]   McCann, J., Deering, S., and J. Mogul, "Path MTU
               Discovery for IP version 6", <a href="rfc1981.html">RFC 1981</a>, August 1996.

   [<a id="ref-RFC2473" name="ref-RFC2473">RFC2473</a>]   Conta, A. and S. Deering, "Generic Packet Tunneling in
               IPv6 Specification", <a href="rfc2473.html">RFC 2473</a>, December 1998.

   [<a id="ref-RFC2827" name="ref-RFC2827">RFC2827</a>]   Ferguson, P. and D. Senie, "Network Ingress Filtering:
               Defeating Denial of Service Attacks which employ IP
               Source Address Spoofing", <a href="https://tools.ietf.org/html/bcp38">BCP 38</a>, <a href="rfc2827.html">RFC 2827</a>, May 2000.

   [<a id="ref-RFC2993" name="ref-RFC2993">RFC2993</a>]   Hain, T., "Architectural Implications of NAT", <a href="rfc2993.html">RFC 2993</a>,
               November 2000.

   [<a id="ref-RFC3704" name="ref-RFC3704">RFC3704</a>]   Baker, F. and P. Savola, "Ingress Filtering for
               Multihomed Networks", <a href="https://tools.ietf.org/html/bcp84">BCP 84</a>, <a href="rfc3704.html">RFC 3704</a>, March 2004.

   [<a id="ref-RFC4080" name="ref-RFC4080">RFC4080</a>]   Hancock, R., Karagiannis, G., Loughney, J., and S. Van
               den Bosch, "Next Steps in Signaling (NSIS): Framework",
               <a href="rfc4080.html">RFC 4080</a>, June 2005.

   [<a id="ref-RFC4294" name="ref-RFC4294">RFC4294</a>]   Loughney, J., "IPv6 Node Requirements", <a href="rfc4294.html">RFC 4294</a>,
               April 2006.

   [<a id="ref-RFC4864" name="ref-RFC4864">RFC4864</a>]   Van de Velde, G., Hain, T., Droms, R., Carpenter, B., and
               E. Klein, "Local Network Protection for IPv6", <a href="rfc4864.html">RFC 4864</a>,
               May 2007.

   [<a id="ref-RFC4949" name="ref-RFC4949">RFC4949</a>]   Shirey, R., "Internet Security Glossary, Version 2",
               <a href="rfc4949.html">RFC 4949</a>, August 2007.






<span class="grey">Woodyatt                      Informational                    [Page 35]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-36" id="page-36" name="page-36"> </a>
<span class="grey"><a href="rfc6092.html">RFC 6092</a>           Simple Security in IPv6 Gateway CPE      January 2011</span>


   [<a id="ref-RFC5189" name="ref-RFC5189">RFC5189</a>]   Stiemerling, M., Quittek, J., and T. Taylor, "Middlebox
               Communication (MIDCOM) Protocol Semantics", <a href="rfc5189.html">RFC 5189</a>,
               March 2008.

   [<a id="ref-RFC5382" name="ref-RFC5382">RFC5382</a>]   Guha, S., Biswas, K., Ford, B., Sivakumar, S., and P.
               Srisuresh, "NAT Behavioral Requirements for TCP",
               <a href="https://tools.ietf.org/html/bcp142">BCP 142</a>, <a href="rfc5382.html">RFC 5382</a>, October 2008.

   [<a id="ref-RFC5386" name="ref-RFC5386">RFC5386</a>]   Williams, N. and M. Richardson, "Better-Than-Nothing
               Security: An Unauthenticated Mode of IPsec", <a href="rfc5386.html">RFC 5386</a>,
               November 2008.

   [<a id="ref-RFC5389" name="ref-RFC5389">RFC5389</a>]   Rosenberg, J., Mahy, R., Matthews, P., and D. Wing,
               "Session Traversal Utilities for NAT (STUN)", <a href="rfc5389.html">RFC 5389</a>,
               October 2008.

   [<a id="ref-RFC5533" name="ref-RFC5533">RFC5533</a>]   Nordmark, E. and M. Bagnulo, "Shim6: Level 3 Multihoming
               Shim Protocol for IPv6", <a href="rfc5533.html">RFC 5533</a>, June 2009.

   [<a id="ref-UPnP-IGD" name="ref-UPnP-IGD">UPnP-IGD</a>]  UPnP Forum, "Universal Plug and Play Internet Gateway
               Device Standardized Device Control Protocol",
               September 2010, &lt;<a href="http://upnp.org/specs/gw/igd2/">http://upnp.org/specs/gw/igd2/</a>&gt;.

   [<a id="ref-WOODYATT-ALD" name="ref-WOODYATT-ALD">WOODYATT-ALD</a>]
               Woodyatt, J., "Application Listener Discovery (ALD) for
               IPv6", Work in Progress, July 2008.

Author's Address

   James Woodyatt (editor)
   Apple Inc.
   1 Infinite Loop
   Cupertino, CA  95014
   US

   EMail: jhw@apple.com















Woodyatt                      Informational                    [Page 36]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc6092 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:32 GMT --></html>