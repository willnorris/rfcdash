<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc7904 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:18 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="urn:ietf:rfc:7904" name="DC.Identifier"/>
<meta content="This document defines a SIP Usage for REsource LOcation And Discovery
(RELOAD). The SIP Usage provides the functionality of a SIP proxy or
registrar in a fully distributed system and includes a lookup service
for Address of Records (AORs) stored in the overlay. It also defines
Globally Routable User Agent URIs (GRUUs) that allow the registrations
to map an AOR to a specific node reachable through the overlay. After
such initial contact of a Peer, the RELOAD AppAttach method is used to
establish a direct connection between nodes through which SIP messages
are exchanged." name="DC.Description.Abstract"/>
<meta content="Jennings, Cullen" name="DC.Creator"/>
<meta content="Baset, Salman" name="DC.Creator"/>
<meta content="Schmidt, Thomas" name="DC.Creator"/>
<meta content="Schulzrinne, Henning" name="DC.Creator"/>
<meta content="Lowekamp, Bruce" name="DC.Creator"/>
<meta content="Rescorla, Eric" name="DC.Creator"/>
<meta content="October, 2016" name="DC.Date.Issued"/>
<meta content="A SIP Usage for REsource LOcation And Discovery (RELOAD)" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 7904 - A SIP Usage for REsource LOcation And Discovery (RELOAD)</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgblue" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc7904.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc7904" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-p2psip-sip" title="draft-ietf-p2psip-sip">draft-ietf-p2ps...</a>] [<a href="https://datatracker.ietf.org/doc/rfc7904" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc7904" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc7904" title="Side-by-side diff">Diff2</a>]         </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                       PROPOSED STANDARD</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Internet Engineering Task Force (IETF)                       C. Jennings
Request for Comments: 7904                                         Cisco
Category: Standards Track                                    B. Lowekamp
ISSN: 2070-1721                                                    Skype
                                                             E. Rescorla
                                                              RTFM, Inc.
                                                                S. Baset
                                                                     IBM
                                                          H. Schulzrinne
                                                     Columbia University
                                                         T. Schmidt, Ed.
                                                             HAW Hamburg
                                                            October 2016


        <span class="h1">A SIP Usage for REsource LOcation And Discovery (RELOAD)</span>

Abstract

   This document defines a SIP Usage for REsource LOcation And Discovery
   (RELOAD).  The SIP Usage provides the functionality of a SIP proxy or
   registrar in a fully distributed system and includes a lookup service
   for Address of Records (AORs) stored in the overlay.  It also defines
   Globally Routable User Agent URIs (GRUUs) that allow the
   registrations to map an AOR to a specific node reachable through the
   overlay.  After such initial contact of a Peer, the RELOAD AppAttach
   method is used to establish a direct connection between nodes through
   which SIP messages are exchanged.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="rfc7841.html#section-2">Section 2 of RFC 7841</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc7904">http://www.rfc-editor.org/info/rfc7904</a>.









<span class="grey">Jennings, et al.             Standards Track                    [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc7904.html">RFC 7904</a>                    RELOAD SIP Usage                October 2016</span>


Copyright Notice

   Copyright (c) 2016 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

   This document may contain material from IETF Documents or IETF
   Contributions published or made publicly available before November
   10, 2008.  The person(s) controlling the copyright in some of this
   material may not have granted the IETF Trust the right to allow
   modifications of such material outside the IETF Standards Process.
   Without obtaining an adequate license from the person(s) controlling
   the copyright in such materials, this document may not be modified
   outside the IETF Standards Process, and derivative works of it may
   not be created outside the IETF Standards Process, except to format
   it for publication as an RFC or to translate it into languages other
   than English.

























<span class="grey">Jennings, et al.             Standards Track                    [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc7904.html">RFC 7904</a>                    RELOAD SIP Usage                October 2016</span>


Table of Contents

   <a href="#section-1">1</a>.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-4">4</a>
   <a href="#section-2">2</a>.  Terminology . . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-6">6</a>
   <a href="#section-3">3</a>.  Registering AORs in the Overlay . . . . . . . . . . . . . . .   <a href="#page-6">6</a>
     <a href="#section-3.1">3.1</a>.  Overview  . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-6">6</a>
     <a href="#section-3.2">3.2</a>.  Data Structure  . . . . . . . . . . . . . . . . . . . . .   <a href="#page-7">7</a>
     <a href="#section-3.3">3.3</a>.  Access Control  . . . . . . . . . . . . . . . . . . . . .   <a href="#page-9">9</a>
     <a href="#section-3.4">3.4</a>.  Overlay Configuration Document Extension  . . . . . . . .  <a href="#page-10">10</a>
   <a href="#section-4">4</a>.  Looking Up an AOR . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-11">11</a>
     <a href="#section-4.1">4.1</a>.  Finding a Route to an AOR . . . . . . . . . . . . . . . .  <a href="#page-11">11</a>
     <a href="#section-4.2">4.2</a>.  Resolving an AOR  . . . . . . . . . . . . . . . . . . . .  <a href="#page-12">12</a>
   <a href="#section-5">5</a>.  Forming a Direct Connection . . . . . . . . . . . . . . . . .  <a href="#page-12">12</a>
     <a href="#section-5.1">5.1</a>.  Setting Up a Connection . . . . . . . . . . . . . . . . .  <a href="#page-12">12</a>
     <a href="#section-5.2">5.2</a>.  Keeping a Connection Alive  . . . . . . . . . . . . . . .  <a href="#page-13">13</a>
   <a href="#section-6">6</a>.  Using GRUUs . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-13">13</a>
   <a href="#section-7">7</a>.  SIP-REGISTRATION Kind Definition  . . . . . . . . . . . . . .  <a href="#page-14">14</a>
   <a href="#section-8">8</a>.  Security Considerations . . . . . . . . . . . . . . . . . . .  <a href="#page-14">14</a>
     <a href="#section-8.1">8.1</a>.  RELOAD-Specific Issues  . . . . . . . . . . . . . . . . .  <a href="#page-14">14</a>
     <a href="#section-8.2">8.2</a>.  SIP-Specific Issues . . . . . . . . . . . . . . . . . . .  <a href="#page-15">15</a>
       <a href="#section-8.2.1">8.2.1</a>.  Fork Explosion  . . . . . . . . . . . . . . . . . . .  <a href="#page-15">15</a>
       <a href="#section-8.2.2">8.2.2</a>.  Malicious Retargeting . . . . . . . . . . . . . . . .  <a href="#page-15">15</a>
       <a href="#section-8.2.3">8.2.3</a>.  Misuse of AORs  . . . . . . . . . . . . . . . . . . .  <a href="#page-15">15</a>
       <a href="#section-8.2.4">8.2.4</a>.  Privacy Issues  . . . . . . . . . . . . . . . . . . .  <a href="#page-16">16</a>
   <a href="#section-9">9</a>.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .  <a href="#page-16">16</a>
     <a href="#section-9.1">9.1</a>.  Data Kind-ID  . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-16">16</a>
     <a href="#section-9.2">9.2</a>.  XML Namespace Registration  . . . . . . . . . . . . . . .  <a href="#page-16">16</a>
   <a href="#section-10">10</a>. References  . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-16">16</a>
     <a href="#section-10.1">10.1</a>.  Normative References . . . . . . . . . . . . . . . . . .  <a href="#page-16">16</a>
     <a href="#section-10.2">10.2</a>.  Informative References . . . . . . . . . . . . . . . . .  <a href="#page-18">18</a>
   <a href="#appendix-A">Appendix A</a>.  Third-Party Registration . . . . . . . . . . . . . .  <a href="#page-19">19</a>
   Acknowledgments . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-19">19</a>
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-20">20</a>


















<span class="grey">Jennings, et al.             Standards Track                    [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc7904.html">RFC 7904</a>                    RELOAD SIP Usage                October 2016</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   REsource LOcation And Discovery (RELOAD) [<a href="rfc6940.html" title='"REsource LOcation And Discovery (RELOAD) Base Protocol"'>RFC6940</a>] specifies a peer-
   to-peer (P2P) signaling protocol for general use on the Internet.
   This document defines a SIP Usage of RELOAD that allows SIP [<a href="rfc3261.html" title='"SIP: Session Initiation Protocol"'>RFC3261</a>]
   user agents (UAs) to establish peer-to-peer SIP (or SIPS) sessions
   without the requirement for a permanent proxy or registration
   servers, e.g., a fully distributed telephony service.  This service
   transparently supports SIP addressing including telephone numbers.
   In such a network, the RELOAD overlay itself performs the
   registration and rendezvous functions ordinarily associated with such
   servers.

   The SIP Usage involves two basic functions:

   Registration:  SIP UAs can use the RELOAD data storage functionality
      to store a mapping from their Address of Record (AOR) to their
      Node-ID in the overlay and to retrieve the Node-ID of other UAs.

   Rendezvous:  Once a SIP UA has identified the Node-ID for an AOR it
      wishes to call, it can use the RELOAD message routing system to
      set up a direct connection for exchanging SIP messages.

   Mappings are stored in the SipRegistration Resource Record defined in
   this document.  All operations required to perform a SIP registration
   or rendezvous are standard RELOAD protocol methods.

   For example, Bob registers his AOR, "bob@dht.example.com", for his
   Node-ID "1234".  When Alice wants to call Bob, she queries the
   overlay for "bob@dht.example.com" and receives Node-ID "1234" in
   return.  She then uses the overlay routing to establish a direct
   connection with Bob and can directly transmit a standard SIP INVITE.
   In detail, this works along the following steps:

   1.  Bob, operating Node-ID "1234", stores a mapping from his AOR to
       his Node-ID in the overlay by applying a Store request for
       "bob@dht.example.com -&gt; 1234".

   2.  Alice, operating Node-ID "5678", decides to call Bob. She
       retrieves Node-ID "1234" by performing a Fetch request on
       "bob@dht.example.com".

   3.  Alice uses the overlay to route an AppAttach message to Bob's
       Peer (ID "1234").  Bob responds with his own AppAttach and they
       set up a direct connection, as shown in Figure 1.  Note that
       mutual Interactive Connectivity Establishment (ICE) checks are
       invoked automatically from the AppAttach message exchange.




<span class="grey">Jennings, et al.             Standards Track                    [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc7904.html">RFC 7904</a>                    RELOAD SIP Usage                October 2016</span>


                        Overlay
   Alice       Peer1     ...          PeerN      Bob
   (5678)                                     (1234)
   -------------------------------------------------
   AppAttach -&gt;
               AppAttach -&gt;
                         AppAttach -&gt;
                                     AppAttach -&gt;
                                        &lt;- AppAttach
                               &lt;- AppAttach
                    &lt;- AppAttach
        &lt;- AppAttach

   &lt;------------------ ICE Checks -----------------&gt;
   INVITE -----------------------------------------&gt;
   &lt;--------------------------------------------- OK
   ACK --------------------------------------------&gt;
   &lt;------------ ICE Checks for media -------------&gt;
   &lt;-------------------- RTP ----------------------&gt;

      Figure 1: Connection Setup in P2P SIP Using the RELOAD Overlay

   It is important to note that the only role of RELOAD in this example
   is to set up the direct SIP connection between Alice and Bob.  As
   soon as the ICE checks complete and the connection is established,
   ordinary SIP or SIPS is used.  In particular, the establishment of
   the media channel for a phone call happens via the usual SIP
   mechanisms, and RELOAD is not involved.  Media never traverses the
   overlay.  After the successful exchange of SIP messages,
   communicating Peers run ICE connectivity checks for media.

   In addition to mappings from AORs to Node-IDs, the SIP Usage also
   allows mappings from AORs to other AORs.  This enables an indirection
   useful for call forwarding.  For instance, if Bob wants his phone
   calls temporarily forwarded to Charlie, he can store the mapping
   "bob@dht.example.com -&gt; charlie@dht.example.com".  When Alice wants
   to call Bob, she retrieves this mapping and can then fetch Charlie's
   AOR to retrieve his Node-ID.  These mechanisms are described in
   <a href="#section-3">Section 3</a>.

   Alternatively, Globally Routable User Agent URIs (GRUUs) [<a href="rfc5627.html" title='"Obtaining and Using Globally Routable User Agent URIs (GRUUs) in the Session Initiation Protocol (SIP)"'>RFC5627</a>]
   can be used for directly accessing Peers.  They are handled via a
   separate mechanism, as described in <a href="#section-6">Section 6</a>.

   Concepts used in this document can be extended to include tel URIs
   [<a href="rfc3966.html" title='"The tel URI for Telephone Numbers"'>RFC3966</a>], but this will require further specifications to ensure
   semantic interoperability of implementations.




<span class="grey">Jennings, et al.             Standards Track                    [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc7904.html">RFC 7904</a>                    RELOAD SIP Usage                October 2016</span>


   The SIP Usage for RELOAD addresses a fully distributed deployment of
   session-based services among overlay Peers.  This RELOAD Usage may be
   relevant in a variety of environments, including a tightly controlled
   environment of a single provider that admits parties using AORs with
   domains from controlled namespace(s) only, or an open, multi-party
   infrastructure that liberally allows a registration and rendezvous
   for various or any domain namespace.  It is noteworthy in this
   context that -- in contrast to regular SIP -- domain names play no
   role in routing to a proxy server.  Once connectivity to an overlay
   is given, the technology allows any name registration, possibly
   constrained by overlay domain restrictions.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Terminology"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Terminology</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in <a href="rfc2119.html">RFC 2119</a> [<a href="rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].

   We use the terminology and definitions from "Concepts and Terminology
   for Peer-to-Peer SIP (P2PSIP)" [<a href="rfc7890.html" title='"Concepts and Terminology for Peer-to-Peer SIP (P2PSIP)"'>RFC7890</a>] and the RELOAD Base Protocol
   [<a href="rfc6940.html" title='"REsource LOcation And Discovery (RELOAD) Base Protocol"'>RFC6940</a>] extensively in this document.

   In addition, terms defined by SIP [<a href="rfc3261.html" title='"SIP: Session Initiation Protocol"'>RFC3261</a>] apply to this memo.  The
   term AOR is the SIP "Address of Record" used to identify a user in
   SIP.  For example, "alice@example.com" could be the AOR for Alice.
   For the purposes of this specification, an AOR is considered not to
   include the scheme (e.g., sip:), as the AOR needs to match the
   rfc822Name in the X.509 v3 certificates [<a href="rfc5280.html" title='"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"'>RFC5280</a>].  It is worth
   noting that SIP and SIPS are distinguished in P2PSIP by the
   Application-ID.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Registering%20AORs%20in%20the%20Overlay"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Registering AORs in the Overlay</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.1.%20%20Overview"></a><a class="selflink" href="#section-3.1" name="section-3.1">3.1</a>.  Overview</span>

   In ordinary SIP, a UA registers the user's AOR and its network
   location with a registrar.  In RELOAD, this registrar function is
   provided by the overlay as a whole.  To register its location, a
   RELOAD peer stores a SipRegistration Resource Record under its own
   AOR using the SIP-REGISTRATION Kind, which is formally defined in
   <a href="#section-7">Section 7</a>.  Note that the registration lifetime known from the
   regular SIP REGISTER method is inherited from the lifetime attribute
   of the basic RELOAD StoredData structure (see <a href="rfc6940.html#section-7">Section 7 in
   [RFC6940]</a>).







<span class="grey">Jennings, et al.             Standards Track                    [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc7904.html">RFC 7904</a>                    RELOAD SIP Usage                October 2016</span>


   A RELOAD overlay MAY restrict the storage of AORs.  Namespaces (i.e.,
   the right-hand side of the AOR) that are supported for registration
   and lookup can be configured for each RELOAD deployment as described
   in <a href="#section-3.4">Section 3.4</a>.

   As a simple example, consider Alice with an AOR
   "alice@dht.example.org" at Node-ID "1234".  She might store the
   mapping "alice@dht.example.org -&gt; 1234" telling anyone who wants to
   call her to contact node "1234".

   RELOAD peers can store two kinds of SIP mappings,

   o  from an AOR to a destination list (a single Node-ID is just a
      trivial destination list), or

   o  from one AOR to another.

   The meaning of the first kind of mapping is "in order to contact me,
   form a connection with this Peer."  The meaning of the second kind of
   mapping is "in order to contact me, dereference this AOR".  The
   latter allows for forwarding.  For instance, if Alice wants her calls
   to be forwarded to her secretary, Sam, she might insert the following
   mapping, "alice@dht.example.org -&gt; sam@dht.example.org".

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.2.%20%20Data%20Structure"></a><a class="selflink" href="#section-3.2" name="section-3.2">3.2</a>.  Data Structure</span>

   This section defines the SipRegistration Resource Record as follows:

          enum {
              sip_registration_uri(1),
              sip_registration_route(2),
              (255)
          } SipRegistrationType;

          select (SipRegistration.type) {
            case sip_registration_uri:
              opaque               uri&lt;0..2^16-1&gt;;

            case sip_registration_route:
              opaque               contact_prefs&lt;0..2^16-1&gt;;
              Destination          destination_list&lt;3..2^16-1&gt;;

            /* This type can be extended */

          } SipRegistrationData;






<span class="grey">Jennings, et al.             Standards Track                    [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc7904.html">RFC 7904</a>                    RELOAD SIP Usage                October 2016</span>


          struct {
             SipRegistrationType   type;
             uint16                length;
             SipRegistrationData   data;
         } SipRegistration;

   The contents of the SipRegistration Resource Record are:

   type

      the type of the registration

   length

      the length of the rest of the PDU

   data

      the registration data

   o  If the registration is of type "sip_registration_uri", then the
      contents are an opaque string containing the AOR.

   o  If the registration is of type "sip_registration_route", then the
      contents are an opaque string containing the registrant's contact
      preferences and a destination list for the Peer.

   The callee expresses its capabilities within the contact preferences
   as specified in [<a href="rfc3840.html" title='"Indicating User Agent Capabilities in the Session Initiation Protocol (SIP)"'>RFC3840</a>].  It encodes a media feature set comprised
   of its capabilities as a contact predicate, i.e., a string of feature
   parameters that appear as part of the Contact header field.  Feature
   parameters are derived from the media feature set syntax of [<a href="rfc2533.html" title='"A Syntax for Describing Media Feature Sets"'>RFC2533</a>]
   (see also [<a href="rfc2738.html" title='"Corrections to "'>RFC2738</a>]) as described in [<a href="rfc3840.html" title='"Indicating User Agent Capabilities in the Session Initiation Protocol (SIP)"'>RFC3840</a>].

   This encoding covers all SIP User Agent capabilities, as defined in
   [<a href="rfc3840.html" title='"Indicating User Agent Capabilities in the Session Initiation Protocol (SIP)"'>RFC3840</a>] and registered in the SIP feature tag registration tree.
   In particular, a callee can indicate that it prefers contact via a
   particular SIP scheme -- SIP or SIPS -- by using one of the following
   contact_prefs attributes:

         (sip.schemes=SIP)
         (sip.schemes=SIPS)









<span class="grey">Jennings, et al.             Standards Track                    [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc7904.html">RFC 7904</a>                    RELOAD SIP Usage                October 2016</span>


   RELOAD explicitly supports multiple registrations for a single AOR.
   The registrations are stored in a dictionary with Node-IDs as the
   dictionary keys.  Consider, for instance, the case where Alice has
   two Peers:

   o  her desk phone (1234)

   o  her cell phone (5678)

   Alice might store the following in the overlay at resource
   "alice@dht.example.com":

   o  a SipRegistration of type "sip_registration_route" with dictionary
      key "1234" and value "1234", both referring to Node-IDs

   o  a SipRegistration of type "sip_registration_route" with dictionary
      key "5678" and value "5678"

   Note that this structure explicitly allows one Node-ID to forward to
   another Node-ID.  For instance, Alice could set calls to her desk
   phone to ring at her cell phone by storing a SipRegistration of type
   "sip_registration_route" with a dictionary key "1234" and a value
   "5678".

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.3.%20%20Access%20Control"></a><a class="selflink" href="#section-3.3" name="section-3.3">3.3</a>.  Access Control</span>

   In order to prevent hijacking or other misuse, registrations are
   subject to access control rules.  Two kinds of restrictions apply:

   o  A Store is permitted only for AORs with domain names that fall
      into the namespaces supported by the RELOAD Overlay Instance.

   o  Storing requests are performed according to the USER-NODE-MATCH
      access control policy of RELOAD.

   Before issuing a Store request to the overlay, any Peer SHOULD verify
   that the AOR of the request is a valid Resource Name with respect to
   its domain name and the namespaces defined in the overlay
   configuration document (see <a href="#section-3.4">Section 3.4</a>).

   Before a Store is permitted, the Storing Peer MUST check that:

   o  The AOR of the request is a valid Resource Name with respect to
      the namespaces defined in the overlay configuration document.

   o  The certificate contains a username that is a SIP AOR that hashes
      to the Resource-ID it is being stored at.




<span class="grey">Jennings, et al.             Standards Track                    [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc7904.html">RFC 7904</a>                    RELOAD SIP Usage                October 2016</span>


   o  The certificate contains a Node-ID that is the same as the
      dictionary key it is being stored at.

   If any of these checks fail, the request MUST be rejected with an
   Error_Forbidden error.

   Note that these rules permit Alice to forward calls to Bob without
   his permission.  However, they do not permit Alice to forward Bob's
   calls to her.  See <a href="#section-8.2.2">Section 8.2.2</a> for additional details.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.4.%20%20Overlay%20Configuration%20Document%20Extension"></a><a class="selflink" href="#section-3.4" name="section-3.4">3.4</a>.  Overlay Configuration Document Extension</span>

   The use of a SIP-enabled overlay MAY be restricted to users with AORs
   from specific domains.  When deploying an overlay service, providers
   can implement such restrictions by defining a set of namespaces for
   admissible domain names.  This section extends the overlay
   configuration document by defining new elements for patterns that
   describe a corresponding domain name syntax.

   A RELOAD overlay can be configured to accept store requests for any
   AOR, or to apply domain name restrictions.  To apply restrictions,
   the overlay configuration document needs to contain a &lt;domain-
   restrictions&gt; element.  The &lt;domain-restrictions&gt; element serves as a
   container for zero to multiple &lt;pattern&gt; sub-elements.  A &lt;pattern&gt;
   element MAY be present if the "enable" attribute of its parent
   element is set to true.  Each &lt;pattern&gt; element defines a pattern for
   constructing admissible resource names.  It is of type xsd:string and
   interpreted as a regular expression according to "POSIX Extended
   Regular Expression" (see the specifications in [<a href="#ref-IEEE-Posix">IEEE-Posix</a>]).
   Encoding of the domain name adheres to the restricted ASCII character
   set without character escaping as defined in <a href="rfc3261.html#section-19.1">Section 19.1 of
   [RFC3261]</a>.

   Inclusion of a &lt;domain-restrictions&gt; element in an overlay
   configuration document is OPTIONAL.  If the element is not included,
   the default behavior is to accept any AOR.  If the element is
   included and the "enable" attribute is not set or set to false, the
   overlay MUST only accept AORs that match the domain name of the
   overlay.  If the element is included and the "enable" attribute is
   set to true, the overlay MUST only accept AORs that match patterns
   specified in the &lt;domain-restrictions&gt; element.

   Example of Domain Patterns:
   dht\.example\.com
   .*\.my\.example

   In this example, any AOR will be accepted that is either of the form
   &lt;user&gt;@dht.example.com, or ends with the domain "my.example".



<span class="grey">Jennings, et al.             Standards Track                   [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc7904.html">RFC 7904</a>                    RELOAD SIP Usage                October 2016</span>


   The RELAX NG grammar for the AOR Domain Restriction reads:

   # AOR DOMAIN RESTRICTION URN SUB-NAMESPACE

   namespace sip = "urn:ietf:params:xml:ns:p2p:config-base:sip"

   # AOR DOMAIN RESTRICTION ELEMENT

   Kind-parameter &amp;= element sip:domain-restriction {

       attribute enable { xsd:boolean }

       # PATTERN ELEMENT

       element sip:pattern { xsd:string }*
   }?

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Looking%20Up%20an%20AOR"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Looking Up an AOR</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.1.%20%20Finding%20a%20Route%20to%20an%20AOR"></a><a class="selflink" href="#section-4.1" name="section-4.1">4.1</a>.  Finding a Route to an AOR</span>

   A RELOAD user, member of an overlay, who wishes to call another user
   with a given AOR SHALL proceed in the following way:

   AOR is a GRUU?  If the AOR is a GRUU for this overlay, the callee can
      be contacted directly as described in <a href="#section-6">Section 6</a>.

   AOR domain is hosted in overlay?  If the domain part of the AOR
      matches a domain pattern configured in the overlay, the user can
      continue to resolve the AOR in this overlay.  The user MAY choose
      to query the DNS service records to search for additional support
      of this domain name.

   AOR domain not supported by overlay?  If the domain part of the AOR
      is not supported in the current overlay, the user might query the
      DNS (or other discovery services at hand) to search for an
      alternative overlay that services the AOR under request.
      Alternatively, standard SIP procedures for contacting the callee
      might be used.

   AOR inaccessible?  If all of the above contact attempts fail, the
      call fails.

   The procedures described above likewise apply when nodes are
   simultaneously connected to several overlays.






<span class="grey">Jennings, et al.             Standards Track                   [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc7904.html">RFC 7904</a>                    RELOAD SIP Usage                October 2016</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.2.%20%20Resolving%20an%20AOR"></a><a class="selflink" href="#section-4.2" name="section-4.2">4.2</a>.  Resolving an AOR</span>

   A RELOAD user that has discovered a route to an AOR in the current
   overlay SHALL execute the following steps:

   1.  Perform a Fetch for Kind SIP-REGISTRATION at the Resource-ID
       corresponding to the AOR.  This Fetch SHOULD NOT indicate any
       dictionary keys, so that it will fetch all the stored values.

   2.  If any of the results of the Fetch are non-GRUU AORs, then repeat
       step 1 for that AOR.

   3.  Once only GRUUs and destination lists remain, the Peer removes
       duplicate destination lists and GRUUs from the list and initiates
       SIP or SIPS connections to the appropriate Peers as described in
       the following sections.  If there are also external AORs, the
       Peer follows the appropriate procedure for contacting them as
       well.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Forming%20a%20Direct%20Connection"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Forming a Direct Connection</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.1.%20%20Setting%20Up%20a%20Connection"></a><a class="selflink" href="#section-5.1" name="section-5.1">5.1</a>.  Setting Up a Connection</span>

   Once the Peer has translated the AOR into a set of destination lists,
   it then uses the overlay to route AppAttach messages to each of those
   Peers.  The "application" field MUST be either 5060 to indicate SIP
   or 5061 to indicate SIPS.  If certificate-based authentication is in
   use, the responding Peer MUST present a certificate with a Node-ID
   matching the terminal entry in the destination list.  Otherwise, the
   connection MUST NOT be used and MUST be closed.  Note that it is
   possible that the Peers already have a RELOAD connection mutually
   established.  This MUST NOT be used for SIP messages unless it is a
   SIP connection.  A previously established SIP connection MAY be used
   for a new call.

   Once the AppAttach succeeds, the Peer sends plain or (D)TLS-encrypted
   SIP messages over the connection as in normal SIP.  A caller MAY
   choose to contact the callee using SIP or SIPS, but SHOULD follow a
   preference indicated by the callee in its contact_prefs attribute
   (see <a href="#section-3.2">Section 3.2</a>).  A callee MAY choose to listen on both SIP and
   SIPS ports and accept calls from either SIP scheme, or select a
   single one.  However, a callee that decides to accept SIPS calls
   only, SHOULD indicate its choice by setting the corresponding
   attribute in its contact_prefs.  It is noteworthy that, according to
   [<a href="rfc6940.html" title='"REsource LOcation And Discovery (RELOAD) Base Protocol"'>RFC6940</a>], all overlay links are built on (D)TLS-secured transport.






<span class="grey">Jennings, et al.             Standards Track                   [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc7904.html">RFC 7904</a>                    RELOAD SIP Usage                October 2016</span>


   SIP messages carry the SIP URIs of actual overlay endpoints (e.g.,
   "sip:alice@dht.example.com") in the Via and Contact headers, while
   the communication continues via the RELOAD connection.  However, a UA
   can redirect its communication path by setting an alternate Contact
   header field like in ordinary SIP.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.2.%20%20Keeping%20a%20Connection%20Alive"></a><a class="selflink" href="#section-5.2" name="section-5.2">5.2</a>.  Keeping a Connection Alive</span>

   In many cases, RELOAD connections established from ICE [<a href="rfc5245.html" title='"Interactive Connectivity Establishment (ICE): A Protocol for Network Address Translator (NAT) Traversal for Offer/Answer Protocols"'>RFC5245</a>]
   negotiations will traverse stateful NATs and firewalls.  It is the
   responsibility of the Peers to send messages with a frequency
   sufficient to maintain the necessary state in these NATs and
   firewalls and thus keep the connection alive.  Keepalives are a
   mandatory component of ICE (see <a href="rfc5245.html#section-10">Section 10 of [RFC5245]</a>) and no
   further operations are required.  Applications that want to assure
   maintenance of sessions individually need to follow regular SIP
   means.  Accordingly, a SIP Peer MAY apply keep-alive techniques in
   agreement with its transport binding as defined in <a href="rfc5626.html#section-3.5">Section 3.5 of
   [RFC5626]</a>.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20Using%20GRUUs"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  Using GRUUs</span>

   Globally Routable User Agent URIs (GRUUs) [<a href="rfc5627.html" title='"Obtaining and Using Globally Routable User Agent URIs (GRUUs) in the Session Initiation Protocol (SIP)"'>RFC5627</a>] have been
   designed to allow direct routing to a specific UA instance without
   the need for dereferencing by a domain-specific SIP proxy function.
   The concept is transferred to RELOAD overlays as follows.  GRUUs in
   RELOAD are constructed by embedding a base64-encoded destination list
   in the "gr" URI parameter of the GRUU.  The base64 encoding is done
   with the alphabet specified in Table 1 of [<a href="rfc4648.html" title='"The Base16, Base32, and Base64 Data Encodings"'>RFC4648</a>] with the
   exception that "~" is used in place of "=".

   Example of a RELOAD GRUU:
   alice@example.com;gr=MDEyMzQ1Njc4OTAxMjM0NTY3ODk~

   GRUUs do not require storing data in the Overlay Instance.  Rather,
   when a Peer needs to route a message to a GRUU in the same P2P
   overlay, it simply uses the destination list and connects to that
   Peer.  Because a GRUU contains a destination list, it can have the
   same contents as a destination list stored elsewhere in the resource
   dictionary.

   Anonymous GRUUs [<a href="rfc5767.html" title='"User-Agent- Driven Privacy Mechanism for SIP"'>RFC5767</a>] are constructed analogously, but require
   either that the enrollment server issues a different Node-ID for each
   anonymous GRUU required, or that a destination list be used that
   includes a Peer that compresses the destination list to stop the
   Node-ID from being revealed.





<span class="grey">Jennings, et al.             Standards Track                   [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc7904.html">RFC 7904</a>                    RELOAD SIP Usage                October 2016</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20SIP-REGISTRATION%20Kind%20Definition"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  SIP-REGISTRATION Kind Definition</span>

   This section defines the SIP-REGISTRATION Kind.

   Name:  SIP-REGISTRATION

   Kind IDs:  The Resource Name for the SIP-REGISTRATION Kind-ID is the
      AOR of the user as specified in <a href="#section-2">Section 2</a>.  The data stored is a
      SipRegistration, which can contain either another URI or a
      destination list to the Peer that is acting for the user.

   Data Model:  The data model for the SIP-REGISTRATION Kind-ID is a
      dictionary.  The dictionary key is the Node-ID of the Storing
      Peer.  This allows each Peer (presumably corresponding to a single
      device) to store a single route mapping.

   Access Control:  USER-NODE-MATCH.  Note that this matches the SIP AOR
      against the rfc822Name in the X.509 v3 certificate.  The
      rfc822Name does not include the scheme so that the "sip:" prefix
      needs to be removed from the SIP AOR before matching.  Escaped
      characters ('%' encoding) in the SIP AOR also need to be decoded
      prior to matching (see [<a href="rfc3986.html" title='"Uniform Resource Identifier (URI): Generic Syntax"'>RFC3986</a>]).

   Data stored under the SIP-REGISTRATION Kind is of type
   SipRegistration, containing one of two data types:

   sip_registration_uri

      A URI that the user can be reached at.

   sip_registration_route

      A destination list that can be used to reach the user's Peer.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20Security%20Considerations"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  Security Considerations</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.1.%20%20RELOAD-Specific%20Issues"></a><a class="selflink" href="#section-8.1" name="section-8.1">8.1</a>.  RELOAD-Specific Issues</span>

   This Usage for RELOAD does not define new protocol elements or
   operations.  Hence, no new threats arrive from message exchanges in
   RELOAD.

   This document introduces an AOR domain restriction function that must
   be compared against the registration attempt by the Storing Peer.  A
   misconfigured or malicious Peer could cause frequent rejects of
   illegitimate storing requests.  However, domain name control relies
   on a lightweight pattern matching and can be processed prior to




<span class="grey">Jennings, et al.             Standards Track                   [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc7904.html">RFC 7904</a>                    RELOAD SIP Usage                October 2016</span>


   validating certificates.  Hence, no extra burden is introduced for
   RELOAD peers beyond loads already present in the base protocol.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.2.%20%20SIP-Specific%20Issues"></a><a class="selflink" href="#section-8.2" name="section-8.2">8.2</a>.  SIP-Specific Issues</span>

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/8.2.1.%20%20Fork%20Explosion"></a><a class="selflink" href="#section-8.2.1" name="section-8.2.1">8.2.1</a>.  Fork Explosion</span>

   Because SIP includes a forking capability (the ability to retarget to
   multiple recipients), fork bombs (i.e., attacks using SIP forking to
   amplify the effect on the intended victims) are a potential DoS
   concern.  However, in the SIP Usage of RELOAD, fork bombs are a much
   lower concern than in a conventional SIP Proxy infrastructure,
   because the calling party is involved in each retargeting event.  It
   can therefore directly measure the number of forks and throttle at
   some reasonable number.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/8.2.2.%20%20Malicious%20Retargeting"></a><a class="selflink" href="#section-8.2.2" name="section-8.2.2">8.2.2</a>.  Malicious Retargeting</span>

   To launch a DoS attack, the owner of a popular AOR could retarget all
   calls to the victim.  This attack is common to SIP and is difficult
   to ameliorate without requiring the target of a SIP registration to
   authorize all stores.  The overhead of that requirement would be
   excessive and, in addition, there are good use cases for retargeting
   to a Peer without its explicit cooperation.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/8.2.3.%20%20Misuse%20of%20AORs"></a><a class="selflink" href="#section-8.2.3" name="section-8.2.3">8.2.3</a>.  Misuse of AORs</span>

   A RELOAD overlay and enrollment service that liberally accepts
   registrations for AORs of domain names unrelated to the overlay
   instance and without further authorization could store presence state
   for AORs without the consent of the owner of the AOR.  An attacker
   could hijack names, register a bogus presence, and attract calls
   dedicated to a victim that resides within or outside the Overlay
   Instance.

   A hijacking of AORs can be mitigated by restricting the name spaces
   admissible in the Overlay Instance, or by additional verification
   actions of the enrollment service.  To prevent an (exclusive) routing
   to a bogus registration, a caller can in addition query the DNS (or
   other discovery services at hand), search for an alternative presence
   of the callee in another overlay or a SIP infrastructure using
   [<a href="rfc3263.html" title='"Session Initiation Protocol (SIP): Locating SIP Servers"'>RFC3263</a>] for name resolution.









<span class="grey">Jennings, et al.             Standards Track                   [Page 15]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc7904.html">RFC 7904</a>                    RELOAD SIP Usage                October 2016</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/8.2.4.%20%20Privacy%20Issues"></a><a class="selflink" href="#section-8.2.4" name="section-8.2.4">8.2.4</a>.  Privacy Issues</span>

   All RELOAD SIP registration data is visible to all nodes in the
   overlay.  Location privacy can be gained from using anonymous GRUUs.
   Methods of providing anonymity or deploying pseudonyms exist, but are
   beyond the scope of this document.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/9.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-9" name="section-9">9</a>.  IANA Considerations</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/9.1.%20%20Data%20Kind-ID"></a><a class="selflink" href="#section-9.1" name="section-9.1">9.1</a>.  Data Kind-ID</span>

   IANA has registered the following code point in the "RELOAD Data
   Kind-ID" Registry (cf., [<a href="rfc6940.html" title='"REsource LOcation And Discovery (RELOAD) Base Protocol"'>RFC6940</a>]) to represent the SIP-REGISTRATION
   Kind, as described in <a href="#section-7">Section 7</a>.

             +---------------------+------------+-----------+
             | Kind                |    Kind-ID | Reference |
             +---------------------+------------+-----------+
             | SIP-REGISTRATION    |        0x1 | <a href="rfc7904.html">RFC 7904</a>  |
             +---------------------+------------+-----------+

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/9.2.%20%20XML%20Namespace%20Registration"></a><a class="selflink" href="#section-9.2" name="section-9.2">9.2</a>.  XML Namespace Registration</span>

   This document registers the following URI for the config XML
   namespace in the IETF XML registry defined in [<a href="rfc3688.html" title='"The IETF XML Registry"'>RFC3688</a>]:

   URI:  urn:ietf:params:xml:ns:p2p:config-base:sip

   Registrant Contact:  The IESG

   XML:  N/A; the requested URI is an XML namespace

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/10.%20%20References"></a><a class="selflink" href="#section-10" name="section-10">10</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/10.1.%20%20Normative%20References"></a><a class="selflink" href="#section-10.1" name="section-10.1">10.1</a>.  Normative References</span>

   [<a id="ref-RFC2119" name="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>,
              DOI 10.17487/RFC2119, March 1997,
              &lt;<a href="http://www.rfc-editor.org/info/rfc2119">http://www.rfc-editor.org/info/rfc2119</a>&gt;.

   [<a id="ref-RFC6940" name="ref-RFC6940">RFC6940</a>]  Jennings, C., Lowekamp, B., Ed., Rescorla, E., Baset, S.,
              and H. Schulzrinne, "REsource LOcation And Discovery
              (RELOAD) Base Protocol", <a href="rfc6940.html">RFC 6940</a>, DOI 10.17487/RFC6940,
              January 2014, &lt;<a href="http://www.rfc-editor.org/info/rfc6940">http://www.rfc-editor.org/info/rfc6940</a>&gt;.






<span class="grey">Jennings, et al.             Standards Track                   [Page 16]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc7904.html">RFC 7904</a>                    RELOAD SIP Usage                October 2016</span>


   [<a id="ref-RFC3261" name="ref-RFC3261">RFC3261</a>]  Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston,
              A., Peterson, J., Sparks, R., Handley, M., and E.
              Schooler, "SIP: Session Initiation Protocol", <a href="rfc3261.html">RFC 3261</a>,
              DOI 10.17487/RFC3261, June 2002,
              &lt;<a href="http://www.rfc-editor.org/info/rfc3261">http://www.rfc-editor.org/info/rfc3261</a>&gt;.

   [<a id="ref-RFC2533" name="ref-RFC2533">RFC2533</a>]  Klyne, G., "A Syntax for Describing Media Feature Sets",
              <a href="rfc2533.html">RFC 2533</a>, DOI 10.17487/RFC2533, March 1999,
              &lt;<a href="http://www.rfc-editor.org/info/rfc2533">http://www.rfc-editor.org/info/rfc2533</a>&gt;.

   [<a id="ref-RFC2738" name="ref-RFC2738">RFC2738</a>]  Klyne, G., "Corrections to "A Syntax for Describing Media
              Feature Sets"", <a href="rfc2738.html">RFC 2738</a>, DOI 10.17487/RFC2738, December
              1999, &lt;<a href="http://www.rfc-editor.org/info/rfc2738">http://www.rfc-editor.org/info/rfc2738</a>&gt;.

   [<a id="ref-RFC3688" name="ref-RFC3688">RFC3688</a>]  Mealling, M., "The IETF XML Registry", <a href="https://tools.ietf.org/html/bcp81">BCP 81</a>, <a href="rfc3688.html">RFC 3688</a>,
              DOI 10.17487/RFC3688, January 2004,
              &lt;<a href="http://www.rfc-editor.org/info/rfc3688">http://www.rfc-editor.org/info/rfc3688</a>&gt;.

   [<a id="ref-RFC3840" name="ref-RFC3840">RFC3840</a>]  Rosenberg, J., Schulzrinne, H., and P. Kyzivat,
              "Indicating User Agent Capabilities in the Session
              Initiation Protocol (SIP)", <a href="rfc3840.html">RFC 3840</a>,
              DOI 10.17487/RFC3840, August 2004,
              &lt;<a href="http://www.rfc-editor.org/info/rfc3840">http://www.rfc-editor.org/info/rfc3840</a>&gt;.

   [<a id="ref-RFC3986" name="ref-RFC3986">RFC3986</a>]  Berners-Lee, T., Fielding, R., and L. Masinter, "Uniform
              Resource Identifier (URI): Generic Syntax", STD 66,
              <a href="rfc3986.html">RFC 3986</a>, DOI 10.17487/RFC3986, January 2005,
              &lt;<a href="http://www.rfc-editor.org/info/rfc3986">http://www.rfc-editor.org/info/rfc3986</a>&gt;.

   [<a id="ref-RFC4648" name="ref-RFC4648">RFC4648</a>]  Josefsson, S., "The Base16, Base32, and Base64 Data
              Encodings", <a href="rfc4648.html">RFC 4648</a>, DOI 10.17487/RFC4648, October 2006,
              &lt;<a href="http://www.rfc-editor.org/info/rfc4648">http://www.rfc-editor.org/info/rfc4648</a>&gt;.

   [<a id="ref-RFC5245" name="ref-RFC5245">RFC5245</a>]  Rosenberg, J., "Interactive Connectivity Establishment
              (ICE): A Protocol for Network Address Translator (NAT)
              Traversal for Offer/Answer Protocols", <a href="rfc5245.html">RFC 5245</a>,
              DOI 10.17487/RFC5245, April 2010,
              &lt;<a href="http://www.rfc-editor.org/info/rfc5245">http://www.rfc-editor.org/info/rfc5245</a>&gt;.

   [<a id="ref-RFC5280" name="ref-RFC5280">RFC5280</a>]  Cooper, D., Santesson, S., Farrell, S., Boeyen, S.,
              Housley, R., and W. Polk, "Internet X.509 Public Key
              Infrastructure Certificate and Certificate Revocation List
              (CRL) Profile", <a href="rfc5280.html">RFC 5280</a>, DOI 10.17487/RFC5280, May 2008,
              &lt;<a href="http://www.rfc-editor.org/info/rfc5280">http://www.rfc-editor.org/info/rfc5280</a>&gt;.







<span class="grey">Jennings, et al.             Standards Track                   [Page 17]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc7904.html">RFC 7904</a>                    RELOAD SIP Usage                October 2016</span>


   [<a id="ref-RFC5626" name="ref-RFC5626">RFC5626</a>]  Jennings, C., Ed., Mahy, R., Ed., and F. Audet, Ed.,
              "Managing Client-Initiated Connections in the Session
              Initiation Protocol (SIP)", <a href="rfc5626.html">RFC 5626</a>,
              DOI 10.17487/RFC5626, October 2009,
              &lt;<a href="http://www.rfc-editor.org/info/rfc5626">http://www.rfc-editor.org/info/rfc5626</a>&gt;.

   [<a id="ref-RFC5627" name="ref-RFC5627">RFC5627</a>]  Rosenberg, J., "Obtaining and Using Globally Routable User
              Agent URIs (GRUUs) in the Session Initiation Protocol
              (SIP)", <a href="rfc5627.html">RFC 5627</a>, DOI 10.17487/RFC5627, October 2009,
              &lt;<a href="http://www.rfc-editor.org/info/rfc5627">http://www.rfc-editor.org/info/rfc5627</a>&gt;.

   [<a id="ref-IEEE-Posix" name="ref-IEEE-Posix">IEEE-Posix</a>]
              IEEE, "International Standard - Information technology
              Portable Operating System Interface (POSIX) Base
              Specifications, Issue 7", ISO/IEC/IEEE 9945:2009,
              DOI 10.1109/IEEESTD.2009.5393893, September 2009.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/10.2.%20%20Informative%20References"></a><a class="selflink" href="#section-10.2" name="section-10.2">10.2</a>.  Informative References</span>

   [<a id="ref-RFC3263" name="ref-RFC3263">RFC3263</a>]  Rosenberg, J. and H. Schulzrinne, "Session Initiation
              Protocol (SIP): Locating SIP Servers", <a href="rfc3263.html">RFC 3263</a>,
              DOI 10.17487/RFC3263, June 2002,
              &lt;<a href="http://www.rfc-editor.org/info/rfc3263">http://www.rfc-editor.org/info/rfc3263</a>&gt;.

   [<a id="ref-RFC3966" name="ref-RFC3966">RFC3966</a>]  Schulzrinne, H., "The tel URI for Telephone Numbers",
              <a href="rfc3966.html">RFC 3966</a>, DOI 10.17487/RFC3966, December 2004,
              &lt;<a href="http://www.rfc-editor.org/info/rfc3966">http://www.rfc-editor.org/info/rfc3966</a>&gt;.

   [<a id="ref-RFC7890" name="ref-RFC7890">RFC7890</a>]  Bryan, D., Matthews, P., Shim, E., Willis, D., and S.
              Dawkins, "Concepts and Terminology for Peer-to-Peer SIP
              (P2PSIP)", <a href="rfc7890.html">RFC 7890</a>, DOI 10.17487/RFC7890, June 2016,
              &lt;<a href="http://www.rfc-editor.org/info/rfc7890">http://www.rfc-editor.org/info/rfc7890</a>&gt;.

   [<a id="ref-RFC5767" name="ref-RFC5767">RFC5767</a>]  Munakata, M., Schubert, S., and T. Ohba, "User-Agent-
              Driven Privacy Mechanism for SIP", <a href="rfc5767.html">RFC 5767</a>,
              DOI 10.17487/RFC5767, April 2010,
              &lt;<a href="http://www.rfc-editor.org/info/rfc5767">http://www.rfc-editor.org/info/rfc5767</a>&gt;.

   [<a id="ref-SHARE" name="ref-SHARE">SHARE</a>]    Knauf, A., Schmidt, T., Hege, G., and M. Waehlisch, "A
              Usage for Shared Resources in RELOAD (ShaRe)", Work in
              Progress, <a href="https://tools.ietf.org/html/draft-ietf-p2psip-share-08">draft-ietf-p2psip-share-08</a>, March 2016.










<span class="grey">Jennings, et al.             Standards Track                   [Page 18]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-19" id="page-19" name="page-19"> </a>
<span class="grey"><a href="rfc7904.html">RFC 7904</a>                    RELOAD SIP Usage                October 2016</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/Appendix%20A.%20%20Third-Party%20Registration"></a><a class="selflink" href="#appendix-A" name="appendix-A">Appendix A</a>.  Third-Party Registration</span>

   Non-peer-to-peer SIP defines third-party registration (e.g., an
   assistant acting for a manager or a changing set of users registering
   under a role-based AOR) in <a href="rfc3261.html#section-10.2">Section 10.2 of [RFC3261]</a>.  This is a
   REGISTER that uses the URI of the third party in its From header and
   cannot be translated directly into a P2PSIP registration because only
   the owner of the certificate can store a SIP-REGISTRATION in a RELOAD
   overlay.

   Third-party registration can be implemented by using the extended
   access control mechanism USER-CHAIN-ACL defined in [<a href="#ref-SHARE" title='"A Usage for Shared Resources in RELOAD (ShaRe)"'>SHARE</a>].  Creating
   a new Kind "SIP-3P-REGISTRATION" that is ruled by USER-CHAIN-ACL
   allows the owner of the certificate to delegate the right for
   registration to individual third parties.  This way, the SIP third-
   party registration functionality can be regained without weakening
   the security controls of RELOAD.

Acknowledgments

   This document was generated in parts from initial drafts and
   discussions in the early specification phase of the P2PSIP base
   protocol.  We gratefully acknowledge the significant contributions
   made by (in alphabetical order) David A. Bryan, James Deverick,
   Marcin Matuszewski, Jonathan Rosenberg, and Marcia Zangrilli.

   Additional thanks go to all those who helped with ideas, discussions,
   and reviews, in particular (in alphabetical order) Roland Bless,
   Michael Chen, Alissa Cooper, Marc Petit-Huguenin, Brian Rosen, Meral
   Shirazipour, and Matthias Waehlisch.





















<span class="grey">Jennings, et al.             Standards Track                   [Page 19]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-20" id="page-20" name="page-20"> </a>
<span class="grey"><a href="rfc7904.html">RFC 7904</a>                    RELOAD SIP Usage                October 2016</span>


Authors' Addresses

   Cullen Jennings
   Cisco
   170 West Tasman Drive
   MS: SJC-21/2
   San Jose, CA  95134
   United States of America
   Phone: +1 408 421-9990
   Email: fluffy@cisco.com

   Bruce B. Lowekamp
   Skype
   Palo Alto, CA
   United States of America
   Email: bbl@lowekamp.net

   Eric Rescorla
   RTFM, Inc.
   2064 Edgewood Drive
   Palo Alto, CA  94303
   United States of America
   Phone: +1 650 678 2350
   Email: ekr@rtfm.com

   Salman A. Baset
   IBM T. J. Watson Research Center
   1101 Kitchawan Road
   Yorktown Heights, NY  10598
   United States of America
   Email: sabaset@us.ibm.com

   Henning Schulzrinne
   Columbia University
   1214 Amsterdam Avenue
   New York, NY  10027
   United States of America
   Email: hgs@cs.columbia.edu

   Thomas C. Schmidt (editor)
   HAW Hamburg
   Berliner Tor 7
   Hamburg  20099
   Germany
   Email: t.schmidt@haw-hamburg.de






Jennings, et al.             Standards Track                   [Page 20]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc7904 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:18 GMT --></html>