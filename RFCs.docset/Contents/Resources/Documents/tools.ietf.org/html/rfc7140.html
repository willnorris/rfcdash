<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc7140 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:23 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="draft-jjwl-mpls-mldp-hsmp" name="DC.Relation.Replaces"/>
<meta content="urn:ietf:rfc:7140" name="DC.Identifier"/>
<meta content="March, 2014" name="DC.Date.Issued"/>
<meta content="Wijnands, IJsbrand" name="DC.Creator"/>
<meta content="Leymann, Nicolai" name="DC.Creator"/>
<meta content="Jin, Lizhong" name="DC.Creator"/>
<meta content="This document introduces a hub and spoke multipoint (HSMP) Label
Switched Path (LSP), which allows traffic from root to leaf through
point-to-multipoint (P2MP) LSPs and also leaf to root along the
reverse path. That means traffic entering the HSMP LSP from the
application/customer at the root node travels downstream to each leaf
node, exactly as if it were traveling downstream along a P2MP LSP to
each leaf node. Upstream traffic entering the HSMP LSP at any leaf
node travels upstream along the tree to the root, as if it were
unicast to the root. Direct communication among the leaf nodes is not
allowed." name="DC.Description.Abstract"/>
<meta content="LDP Extensions for Hub and Spoke Multipoint Label Switched Path" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 7140 - LDP Extensions for Hub and Spoke Multipoint Label Switched Path</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgblue" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc7140.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc7140" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-mpls-mldp-hsmp" title="draft-ietf-mpls-mldp-hsmp">draft-ietf-mpls...</a>] [<a href="https://datatracker.ietf.org/doc/rfc7140" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc7140" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc7140" title="Side-by-side diff">Diff2</a>] [<a href="https://datatracker.ietf.org/ipr/search/?rfc=7140&amp;submit=rfc" title="IPR disclosures related to this document">IPR</a>]   </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">Updated by: <a href="rfc7358.html">7358</a>                                       PROPOSED STANDARD</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Internet Engineering Task Force (IETF)                            L. Jin
Request for Comments: 7140
Category: Standards Track                                      F. Jounay
ISSN: 2070-1721                                                Orange CH
                                                            IJ. Wijnands
                                                      Cisco Systems, Inc
                                                              N. Leymann
                                                     Deutsche Telekom AG
                                                              March 2014


    <span class="h1">LDP Extensions for Hub and Spoke Multipoint Label Switched Path</span>

Abstract

   This document introduces a hub and spoke multipoint (HSMP) Label
   Switched Path (LSP), which allows traffic from root to leaf through
   point-to-multipoint (P2MP) LSPs and also leaf to root along the
   reverse path.  That means traffic entering the HSMP LSP from the
   application/customer at the root node travels downstream to each leaf
   node, exactly as if it were traveling downstream along a P2MP LSP to
   each leaf node.  Upstream traffic entering the HSMP LSP at any leaf
   node travels upstream along the tree to the root, as if it were
   unicast to the root.  Direct communication among the leaf nodes is
   not allowed.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="rfc5741.html#section-2">Section 2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc7140">http://www.rfc-editor.org/info/rfc7140</a>.












<span class="grey">Jin, et al.                  Standards Track                    [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc7140.html">RFC 7140</a>               LDP Extensions for HSMP LSP            March 2014</span>


Copyright Notice

   Copyright (c) 2014 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   <a href="#section-1">1</a>.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-3">3</a>
   <a href="#section-2">2</a>.  Terminology . . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-3">3</a>
   <a href="#section-3">3</a>.  Setting Up HSMP LSP with LDP  . . . . . . . . . . . . . . . .   <a href="#page-4">4</a>
     <a href="#section-3.1">3.1</a>.  Support for HSMP LSP Setup with LDP . . . . . . . . . . .   <a href="#page-4">4</a>
     <a href="#section-3.2">3.2</a>.  HSMP FEC Elements . . . . . . . . . . . . . . . . . . . .   <a href="#page-5">5</a>
     <a href="#section-3.3">3.3</a>.  Using the HSMP FEC Elements . . . . . . . . . . . . . . .   <a href="#page-5">5</a>
     <a href="#section-3.4">3.4</a>.  HSMP LSP Label Map  . . . . . . . . . . . . . . . . . . .   <a href="#page-6">6</a>
       <a href="#section-3.4.1">3.4.1</a>.  HSMP LSP Leaf Node Operation  . . . . . . . . . . . .   <a href="#page-7">7</a>
       <a href="#section-3.4.2">3.4.2</a>.  HSMP LSP Transit Node Operation . . . . . . . . . . .   <a href="#page-7">7</a>
       <a href="#section-3.4.3">3.4.3</a>.  HSMP LSP Root Node Operation  . . . . . . . . . . . .   <a href="#page-8">8</a>
     <a href="#section-3.5">3.5</a>.  HSMP LSP Label Withdraw . . . . . . . . . . . . . . . . .   <a href="#page-9">9</a>
       <a href="#section-3.5.1">3.5.1</a>.  HSMP Leaf Operation . . . . . . . . . . . . . . . . .   <a href="#page-9">9</a>
       <a href="#section-3.5.2">3.5.2</a>.  HSMP Transit Node Operation . . . . . . . . . . . . .   <a href="#page-9">9</a>
       <a href="#section-3.5.3">3.5.3</a>.  HSMP Root Node Operation  . . . . . . . . . . . . . .  <a href="#page-10">10</a>
     <a href="#section-3.6">3.6</a>.  HSMP LSP Upstream LSR Change  . . . . . . . . . . . . . .  <a href="#page-10">10</a>
     <a href="#section-3.7">3.7</a>.  Determining Forwarding Interface  . . . . . . . . . . . .  <a href="#page-10">10</a>
   <a href="#section-4">4</a>.  HSMP LSP on a LAN . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-11">11</a>
   <a href="#section-5">5</a>.  Redundancy Considerations . . . . . . . . . . . . . . . . . .  <a href="#page-11">11</a>
   <a href="#section-6">6</a>.  Failure Detection of HSMP LSP . . . . . . . . . . . . . . . .  <a href="#page-11">11</a>
   <a href="#section-7">7</a>.  Security Considerations . . . . . . . . . . . . . . . . . . .  <a href="#page-12">12</a>
   <a href="#section-8">8</a>.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .  <a href="#page-12">12</a>
     <a href="#section-8.1">8.1</a>.  New LDP FEC Element Types . . . . . . . . . . . . . . . .  <a href="#page-12">12</a>
     <a href="#section-8.2">8.2</a>.  HSMP LSP Capability TLV . . . . . . . . . . . . . . . . .  <a href="#page-13">13</a>
     <a href="#section-8.3">8.3</a>.  New Sub-TLVs for the Target Stack TLV . . . . . . . . . .  <a href="#page-13">13</a>
   <a href="#section-9">9</a>.  Acknowledgements  . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-13">13</a>
   <a href="#section-10">10</a>. References  . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-14">14</a>
     <a href="#section-10.1">10.1</a>.  Normative References . . . . . . . . . . . . . . . . . .  <a href="#page-14">14</a>
     <a href="#section-10.2">10.2</a>.  Informative References . . . . . . . . . . . . . . . . .  <a href="#page-14">14</a>






<span class="grey">Jin, et al.                  Standards Track                    [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc7140.html">RFC 7140</a>               LDP Extensions for HSMP LSP            March 2014</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   The point-to-multipoint (P2MP) Label Switched Path (LSP) defined in
   [<a href="rfc6388.html" title='"Label Distribution Protocol Extensions for Point-to- Multipoint and Multipoint-to-Multipoint Label Switched Paths"'>RFC6388</a>] allows traffic to transmit from root to several leaf nodes,
   and multipoint-to-multipoint (MP2MP) LSP allows traffic from every
   node to transmit to every other node.  This document introduces a hub
   and spoke multipoint (HSMP) LSP, which has one root node and one or
   more leaf nodes.  An HSMP LSP allows traffic from root to leaf
   through downstream LSP and also leaf to root along the upstream LSP.
   That means traffic entering the HSMP LSP at the root node travels
   along the downstream LSP, exactly as if it were traveling along a
   P2MP LSP, and traffic entering the HSMP LSP at any other leaf nodes
   travels along the upstream LSP toward only the root node.  The
   upstream LSP should be thought of as a unicast LSP to the root node,
   except that it follows the reverse direction of the downstream LSP,
   rather than the unicast path based on the routing protocol.  The
   combination of upstream LSPs initiated from all leaf nodes forms a
   multipoint-to-point LSP.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Terminology"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Terminology</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [<a href="rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].

   This document uses the following terms and acronyms:

      mLDP: Multipoint extensions for Label Distribution Protocol (LDP)
      defined in [<a href="rfc6388.html" title='"Label Distribution Protocol Extensions for Point-to- Multipoint and Multipoint-to-Multipoint Label Switched Paths"'>RFC6388</a>].

      P2MP LSP: point-to-multipoint Label Switched Path.  An LSP that
      has one Ingress Label Switching Router (LSR) and one or more
      Egress LSRs.

      MP2MP LSP: multipoint-to-multipoint Label Switched Path.  An LSP
      that connects a set of nodes, such that traffic sent by any node
      in the LSP is delivered to all others.

      HSMP LSP: hub and spoke multipoint Label Switched Path.  An LSP
      that has one root node and one or more leaf nodes, allows traffic
      from the root to all leaf nodes along the downstream P2MP LSP and
      also leaf to root node along the upstream unicast LSP.

      FEC: Forwarding Equivalence Class







<span class="grey">Jin, et al.                  Standards Track                    [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc7140.html">RFC 7140</a>               LDP Extensions for HSMP LSP            March 2014</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Setting%20Up%20HSMP%20LSP%20with%20LDP"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Setting Up HSMP LSP with LDP</span>

   An HSMP LSP is similar to MP2MP LSP described in [<a href="rfc6388.html" title='"Label Distribution Protocol Extensions for Point-to- Multipoint and Multipoint-to-Multipoint Label Switched Paths"'>RFC6388</a>], with the
   difference being that, when the leaf LSRs send traffic on the LSP,
   the traffic is first delivered only to the root node and follows the
   upstream path from the leaf node to the root node.  The root node
   then distributes the traffic on the P2MP tree to all of the leaf
   nodes.

   An HSMP LSP consists of a downstream path and upstream path.  The
   downstream path is the same as P2MP LSP, while the upstream path is
   only from leaf to root node, without communication between the leaf
   nodes themselves.  The transmission of packets from the root node of
   an HSMP LSP to the receivers (the leaf nodes) is identical to that of
   a P2MP LSP.  Traffic from a leaf node to the root follows the
   upstream path that is the reverse of the path from the root to the
   leaf.  Unlike an MP2MP LSP, traffic from a leaf node does not branch
   toward other leaf nodes, but it is sent direct to the root where it
   is placed on the P2MP path and distributed to all leaf nodes
   including the original sender.

   To set up the upstream path of an HSMP LSP, ordered mode MUST be
   used.  Ordered mode can guarantee that a leaf will start sending
   packets to the root immediately after the upstream path is installed,
   without being dropped due to an incomplete LSP.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.1.%20%20Support%20for%20HSMP%20LSP%20Setup%20with%20LDP"></a><a class="selflink" href="#section-3.1" name="section-3.1">3.1</a>.  Support for HSMP LSP Setup with LDP</span>

   An HSMP LSP requires the LDP capabilities [<a href="rfc5561.html" title='"LDP Capabilities"'>RFC5561</a>] for nodes to
   indicate that they support setup of HSMP LSPs.  An implementation
   supporting the HSMP LSP procedures specified in this document MUST
   implement the procedures for Capability Parameters in Initialization
   messages.  Advertisement of the HSMP LSP Capability indicates support
   of the procedures for HSMP LSP setup.

   A new Capability Parameter TLV is defined, the HSMP LSP Capability
   Parameter.  Below is the format of the HSMP LSP Capability Parameter.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |U|F|   HSMP LSP Cap (0x0902)     |           Length            |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |S|  Reserved   |
    +-+-+-+-+-+-+-+-+

             Figure 1: HSMP LSP Capability Parameter Encoding




<span class="grey">Jin, et al.                  Standards Track                    [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc7140.html">RFC 7140</a>               LDP Extensions for HSMP LSP            March 2014</span>


   U-bit:  Unknown TLV bit, as described in [<a href="rfc5036.html" title='"LDP Specification"'>RFC5036</a>].  The value MUST
           be 1.  The unknown TLV MUST be silently ignored and the rest
           of the message processed as if the unknown TLV did not exist.

   F-bit:  Forward unknown TLV bit, as described in [<a href="rfc5036.html" title='"LDP Specification"'>RFC5036</a>].  The
           value of this bit MUST be 0 since a Capability Parameter TLV
           is sent only in Initialization and Capability messages, which
           are not forwarded.

   Length: SHOULD be 1.

   S-bit:  As defined in <a href="rfc5561.html#section-3">Section 3 of [RFC5561]</a>.

   Reserved:  As defined in <a href="rfc5561.html#section-3">Section 3 of [RFC5561]</a>.

   HSMP LSP Capability Parameter type:  0x0902.

   If the peer has not advertised the corresponding capability, then
   label messages using the HSMP Forwarding Equivalence Class (FEC)
   Element SHOULD NOT be sent to the peer (as described in <a href="rfc6388.html#section-2.1">Section 2.1
   of [RFC6388]</a>).  Since ordered mode is applied for HSMP LSP signaling,
   the label message break would ensure that the initiating leaf node is
   unable to establish the upstream path to root node.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.2.%20%20HSMP%20FEC%20Elements"></a><a class="selflink" href="#section-3.2" name="section-3.2">3.2</a>.  HSMP FEC Elements</span>

   We define two new protocol entities: the HSMP Downstream FEC Element
   and Upstream FEC Element.  If a FEC TLV contains one of the HSMP FEC
   Elements, the HSMP FEC Element MUST be the only FEC Element in the
   FEC TLV.  The structure, encoding, and error handling for the HSMP-
   downstream FEC Element and HSMP-upstream FEC Element are the same as
   for the P2MP FEC Element described in <a href="rfc6388.html#section-2.2">Section 2.2 of [RFC6388]</a>.  The
   difference is that two additional new FEC types are defined: HSMP-
   downstream FEC (10) and HSMP-upstream FEC (9).

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.3.%20%20Using%20the%20HSMP%20FEC%20Elements"></a><a class="selflink" href="#section-3.3" name="section-3.3">3.3</a>.  Using the HSMP FEC Elements</span>

   The entries in the list below describe the processing of the HSMP FEC
   Elements.  Additionally, the entries defined in <a href="rfc6388.html#section-3.3">Section 3.3 of
   [RFC6388]</a> are also reused in the following sections.

   1.   HSMP downstream LSP &lt;X, Y&gt; (or simply downstream &lt;X, Y&gt;): an
        HSMP LSP downstream path with root node address X and opaque
        value Y.







<span class="grey">Jin, et al.                  Standards Track                    [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc7140.html">RFC 7140</a>               LDP Extensions for HSMP LSP            March 2014</span>


   2.   HSMP upstream LSP &lt;X, Y&gt; (or simply upstream &lt;X, Y&gt;): an HSMP
        LSP upstream path for root node address X and opaque value Y
        that will be used by any downstream node to send traffic
        upstream to root node.

   3.   HSMP-downstream FEC Element &lt;X, Y&gt;: a FEC Element with root node
        address X and opaque value Y used for a downstream HSMP LSP.

   4.   HSMP-upstream FEC Element &lt;X, Y&gt;: a FEC Element with root node
        address X and opaque value Y used for an upstream HSMP LSP.

   5.   HSMP-D Label Mapping &lt;X, Y, L&gt;: A Label Mapping message with a
        single HSMP-downstream FEC Element &lt;X, Y&gt; and label TLV with
        label L.  Label L MUST be allocated from the per-platform label
        space of the LSR sending the Label Mapping Message.

   6.   HSMP-U Label Mapping &lt;X, Y, Lu&gt;: A Label Mapping message with a
        single HSMP upstream FEC Element &lt;X, Y&gt; and label TLV with label
        Lu.  Label Lu MUST be allocated from the per-platform label
        space of the LSR sending the Label Mapping Message.

   7.   HSMP-D Label Withdraw &lt;X, Y, L&gt;: a Label Withdraw message with a
        FEC TLV with a single HSMP-downstream FEC Element &lt;X, Y&gt; and
        label TLV with label L.

   8.   HSMP-U Label Withdraw &lt;X, Y, Lu&gt;: a Label Withdraw message with
        a FEC TLV with a single HSMP-upstream FEC Element &lt;X, Y&gt; and
        label TLV with label Lu.

   9.   HSMP-D Label Release &lt;X, Y, L&gt;: a Label Release message with a
        FEC TLV with a single HSMP-downstream FEC Element &lt;X, Y&gt; and
        Label TLV with label L.

   10.  HSMP-U Label Release &lt;X, Y, Lu&gt;: a Label Release message with a
        FEC TLV with a single HSMP-upstream FEC Element &lt;X, Y&gt; and label
        TLV with label Lu.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.4.%20%20HSMP%20LSP%20Label%20Map"></a><a class="selflink" href="#section-3.4" name="section-3.4">3.4</a>.  HSMP LSP Label Map</span>

   This section specifies the procedures for originating HSMP Label
   Mapping messages and processing received HSMP Label Mapping messages
   for a particular HSMP LSP.  The procedure of a downstream HSMP LSP is
   similar to that of a downstream MP2MP LSP described in [<a href="rfc6388.html" title='"Label Distribution Protocol Extensions for Point-to- Multipoint and Multipoint-to-Multipoint Label Switched Paths"'>RFC6388</a>].
   When LDP operates in Ordered Label Distribution Control mode
   [<a href="rfc5036.html" title='"LDP Specification"'>RFC5036</a>], the upstream LSP will be set up by sending an HSMP LSP LDP
   Label Mapping message with a label that is allocated by the upstream
   LSR to its downstream LSR hop-by-hop from root to leaf node,
   installing the upstream forwarding table by every node along the LSP.



<span class="grey">Jin, et al.                  Standards Track                    [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc7140.html">RFC 7140</a>               LDP Extensions for HSMP LSP            March 2014</span>


   The detailed procedure of setting up upstream HSMP LSP is different
   than that of upstream MP2MP LSP, and it is specified in the remainder
   of this section.

   All labels discussed here are downstream-assigned [<a href="rfc5332.html" title='"MPLS Multicast Encapsulations"'>RFC5332</a>] except
   those that are assigned using the procedures described in <a href="#section-4">Section 4</a>.

   Determining the upstream LSR for the HSMP LSP &lt;X, Y&gt; follows the
   procedure for a P2MP LSP described in <a href="rfc6388.html#section-2.4.1.1">Section 2.4.1.1 of [RFC6388]</a>.
   That is, a node Z that wants to join an HSMP LSP &lt;X, Y&gt; determines
   the LDP peer U that is Z's next hop on the best path from Z to the
   root node X.  If there are multiple upstream LSRs, a local algorithm
   should be applied to ensure that there is exactly one upstream LSR
   for a particular LSP.

   To determine one's HSMP downstream LSR, an upstream LDP peer that
   receives a Label Mapping with the HSMP-downstream FEC Element from an
   LDP peer D will treat D as HSMP downstream LDP peer.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.4.1.%20%20HSMP%20LSP%20Leaf%20Node%20Operation"></a><a class="selflink" href="#section-3.4.1" name="section-3.4.1">3.4.1</a>.  HSMP LSP Leaf Node Operation</span>

   The leaf node operation is much the same as the operation of MP2MP
   LSP defined in <a href="rfc6388.html#section-3.3.1.4">Section 3.3.1.4 of [RFC6388]</a>.  The only difference is
   the FEC elements as specified below.

   A leaf node Z of an HSMP LSP &lt;X, Y&gt; determines its upstream LSR U for
   &lt;X, Y&gt; as per <a href="#section-3.3">Section 3.3</a>, allocates a label L, and sends an HSMP-D
   Label Mapping &lt;X, Y, L&gt; to U.  Leaf node Z expects an HSMP-U Label
   Mapping &lt;X, Y, Lu&gt; from node U and checks whether it already has
   forwarding state for upstream &lt;X, Y&gt;.  If not, Z creates forwarding
   state to push label Lu onto the traffic that Z wants to forward over
   the HSMP LSP.  How it determines what traffic to forward on this HSMP
   LSP is outside the scope of this document.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.4.2.%20%20HSMP%20LSP%20Transit%20Node%20Operation"></a><a class="selflink" href="#section-3.4.2" name="section-3.4.2">3.4.2</a>.  HSMP LSP Transit Node Operation</span>

   The procedure for processing an HSMP-D Label Mapping message is much
   the same as that for an MP2MP-D Label Mapping message defined in
   <a href="rfc6388.html#section-3.3.1.5">Section 3.3.1.5 of [RFC6388]</a>.  The processing of an HSMP-U Label
   Mapping message is different from that of an MP2MP-U Label Mapping
   message as specified below.

   Suppose node Z receives an HSMP-D Label Mapping &lt;X, Y, L&gt; from LSR D.
   Z checks whether it has forwarding state for downstream &lt;X, Y&gt;.  If
   not, Z determines its upstream LSR U for &lt;X, Y&gt; as per <a href="#section-3.3">Section 3.3</a>.
   Using this Label Mapping to update the label forwarding table MUST
   NOT be done as long as LSR D is equal to LSR U.  If LSR U is
   different from LSR D, Z will allocate a label L' and install



<span class="grey">Jin, et al.                  Standards Track                    [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc7140.html">RFC 7140</a>               LDP Extensions for HSMP LSP            March 2014</span>


   downstream forwarding state to swap label L' with label L over
   interface I associated with LSR D and send an HSMP-D Label Mapping
   &lt;X, Y, L'&gt; to U.  Interface I is determined via the procedures in
   <a href="#section-3.7">Section 3.7</a>.

   If Z already has forwarding state for downstream &lt;X, Y&gt;, all that Z
   needs to do in this case is check that LSR D is not equal to the
   upstream LSR of &lt;X, Y&gt; and update its forwarding state.  Assuming its
   old forwarding state was L'-&gt; {&lt;I1, L1&gt; &lt;I2, L2&gt; ..., &lt;In, Ln&gt;}, its
   new forwarding state becomes L'-&gt; {&lt;I1, L1&gt; &lt;I2, L2&gt; ..., &lt;In, Ln&gt;,
   &lt;I, L&gt;}.  If the LSR D is equal to the installed upstream LSR, the
   Label Mapping from LSR D MUST be retained and MUST NOT update the
   label forwarding table.

   Node Z checks if the upstream LSR U already has assigned a label Lu
   to upstream &lt;X, Y&gt;.  If not, transit node Z waits until it receives
   an HSMP-U Label Mapping &lt;X, Y, Lu&gt; from LSR U.  Once the HSMP-U Label
   Mapping is received from LSR U, node Z checks whether it already has
   forwarding state upstream &lt;X, Y&gt; with incoming label Lu' and outgoing
   label Lu.  If it does not, it allocates a label Lu' and creates a new
   label swap for Lu' with Label Lu over interface Iu.  Interface Iu is
   determined via the procedures in <a href="#section-3.7">Section 3.7</a>.  Node Z determines the
   downstream HSMP LSR as per <a href="#section-3.4">Section 3.4</a> and sends an HSMP-U Label
   Mapping &lt;X, Y, Lu'&gt; to node D.

   Since a packet from any downstream node is forwarded only to the
   upstream node, the same label (representing the upstream path) SHOULD
   be distributed to all downstream nodes.  This differs from the
   procedures for MP2MP LSPs [<a href="rfc6388.html" title='"Label Distribution Protocol Extensions for Point-to- Multipoint and Multipoint-to-Multipoint Label Switched Paths"'>RFC6388</a>], where a distinct label must be
   distributed to each downstream node.  The forwarding state upstream
   &lt;X, Y&gt; on node Z will be like this: {&lt;Lu'&gt;, &lt;Iu Lu&gt;}.  Iu means the
   upstream interface over which Z receives HSMP-U Label Map &lt;X, Y, Lu&gt;
   from LSR U.  Packets from any downstream interface over which Z sends
   HSMP-U Label Map &lt;X, Y, Lu'&gt; with label Lu' will be forwarded to Iu
   with label Lu' swapped to Lu.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.4.3.%20%20HSMP%20LSP%20Root%20Node%20Operation"></a><a class="selflink" href="#section-3.4.3" name="section-3.4.3">3.4.3</a>.  HSMP LSP Root Node Operation</span>

   The procedure for an HSMP-D Label Mapping message is much the same as
   processing an MP2MP-D Label Mapping message defined in
   <a href="rfc6388.html#section-3.3.1.6">Section 3.3.1.6 of [RFC6388]</a>.  The processing of an HSMP-U Label
   Mapping message is different from that of an MP2MP-U Label Mapping
   message as specified below.

   Suppose the root node Z receives an HSMP-D Label Mapping &lt;X, Y, L&gt;
   from node D.  Z checks whether it already has forwarding state for
   downstream &lt;X, Y&gt;.  If not, Z creates downstream forwarding state and
   installs an outgoing label L over interface I.  Interface I is



<span class="grey">Jin, et al.                  Standards Track                    [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc7140.html">RFC 7140</a>               LDP Extensions for HSMP LSP            March 2014</span>


   determined via the procedures in <a href="#section-3.7">Section 3.7</a>.  If Z already has
   forwarding state for downstream &lt;X, Y&gt;, then Z will add label L over
   interface I to the existing state.

   Node Z checks if it has forwarding state for upstream &lt;X, Y&gt;.  If
   not, Z creates a forwarding state for incoming label Lu' that
   indicates that Z is the HSMP LSP egress Label Edge Router (LER).  For
   example, the forwarding state might specify that the label stack is
   popped and the packet passed to some specific application.  Node Z
   determines the downstream HSMP LSR as per <a href="#section-3.3">Section 3.3</a> and sends an
   HSMP-U Label Map &lt;X, Y, Lu'&gt; to node D.

   Since Z is the root of the tree, Z will not send an HSMP-D Label Map
   and will not receive an HSMP-U Label Mapping.

   The root node could also be a leaf node, and it is able to determine
   what traffic to forward on this HSMP LSP; that determination is
   outside the scope of this document.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.5.%20%20HSMP%20LSP%20Label%20Withdraw"></a><a class="selflink" href="#section-3.5" name="section-3.5">3.5</a>.  HSMP LSP Label Withdraw</span>

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.5.1.%20%20HSMP%20Leaf%20Operation"></a><a class="selflink" href="#section-3.5.1" name="section-3.5.1">3.5.1</a>.  HSMP Leaf Operation</span>

   If a leaf node Z discovers that it has no need to be an Egress LSR
   for that LSP (by means outside the scope of this document), then it
   SHOULD send an HSMP-D Label Withdraw &lt;X, Y, L&gt; to its upstream LSR U
   for &lt;X, Y&gt;, where L is the label it had previously advertised to U
   for &lt;X, Y&gt;.  Leaf node Z will also send an unsolicited HSMP-U Label
   Release &lt;X, Y, Lu&gt; to U to indicate that the upstream path is no
   longer used and that label Lu can be removed.

   Leaf node Z expects the upstream router U to respond by sending a
   downstream Label Release for L.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.5.2.%20%20HSMP%20Transit%20Node%20Operation"></a><a class="selflink" href="#section-3.5.2" name="section-3.5.2">3.5.2</a>.  HSMP Transit Node Operation</span>

   If a transit node Z receives an HSMP-D Label Withdraw message
   &lt;X, Y, L&gt; from node D, it deletes label L from its forwarding state
   downstream &lt;X, Y&gt;.  Node Z sends an HSMP-D Label Release message with
   label L to D.  There is no need to send an HSMP-U Label Withdraw &lt;X,
   Y, Lu&gt; to D because node D already removed Lu and sent a label
   release for Lu to Z.

   If deleting L from Z's forwarding state for downstream &lt;X, Y&gt; results
   in no state remaining for &lt;X, Y&gt;, then Z propagates the HSMP-D Label
   Withdraw &lt;X, Y, L&gt; to its upstream node U for &lt;X, Y&gt;.  Z should also
   check if there are any incoming interfaces in forwarding state
   upstream &lt;X, Y&gt;.  If all downstream nodes are released and there is



<span class="grey">Jin, et al.                  Standards Track                    [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc7140.html">RFC 7140</a>               LDP Extensions for HSMP LSP            March 2014</span>


   no incoming interface, Z should delete the forwarding state upstream
   &lt;X, Y&gt; and send an HSMP-U Label Release message to its upstream node.
   Otherwise, no HSMP-U Label Release message will be sent to the
   upstream node.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.5.3.%20%20HSMP%20Root%20Node%20Operation"></a><a class="selflink" href="#section-3.5.3" name="section-3.5.3">3.5.3</a>.  HSMP Root Node Operation</span>

   When the root node of an HSMP LSP receives an HSMP-D Label Withdraw
   message and an HSMP-U Label Release message, the procedure is the
   same as that for transit nodes, except that the root node will not
   propagate the Label Withdraw and Label Release upstream (as it has no
   upstream).

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.6.%20%20HSMP%20LSP%20Upstream%20LSR%20Change"></a><a class="selflink" href="#section-3.6" name="section-3.6">3.6</a>.  HSMP LSP Upstream LSR Change</span>

   The procedure for changing the upstream LSR is the same as defined in
   <a href="rfc6388.html#section-2.4.3">Section 2.4.3 of [RFC6388]</a>, only with different processing of the FEC
   Element.

   When the upstream LSR changes from U to U', node Z should set up the
   HSMP LSP &lt;X, Y&gt; to U' by applying the procedures in <a href="#section-3.4">Section 3.4</a>.  Z
   will also remove the HSMP LSP &lt;X, Y&gt; to U by applying the procedure
   in <a href="#section-3.5">Section 3.5</a>.

   To set up an HSMP LSP to U' before/after removing the HSMP LSP to U
   is a local matter.  The recommended default behavior is to remove
   before adding.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.7.%20%20Determining%20Forwarding%20Interface"></a><a class="selflink" href="#section-3.7" name="section-3.7">3.7</a>.  Determining Forwarding Interface</span>

   The upstream and downstream LSPs can be co-routed by applying the
   procedures below.  Both LSR U and LSR D would ensure that the same
   interface sends traffic by applying some procedures.  For a network
   with symmetric IGP cost configuration, the following procedure MAY be
   used.  To determine the downstream interface, LSR U MUST do a lookup
   in the unicast routing table to find the best interface and next hop
   to reach LSR D.  If the next hop and interface are also advertised by
   LSR D via the LDP session, it should be used to transmit the packet
   to LSR D.  The mechanism to determine the upstream interface is the
   same as that used to determine the downstream interface except the
   roles of LSR U and LSR D are switched.  If symmetric IGP cost could
   not be ensured, static route configuration on LSR U and D could also
   be a way to ensure a co-routed path.

   If a co-routed path is not required for the HSMP LSP, the procedure
   defined in <a href="rfc6388.html#section-2.4.1.2">Section 2.4.1.2 of [RFC6388]</a> could be applied.  LSR U is
   free to transmit the packet on any of the interfaces to LSR D.  The
   algorithm it uses to choose a particular interface is a local matter.



<span class="grey">Jin, et al.                  Standards Track                   [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc7140.html">RFC 7140</a>               LDP Extensions for HSMP LSP            March 2014</span>


   The mechanism to determine the upstream interface is the same as that
   used to determine the downstream interface.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20HSMP%20LSP%20on%20a%20LAN"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  HSMP LSP on a LAN</span>

   The procedure to process the downstream HSMP LSP on a LAN is much the
   same as for a downstream MP2MP LSP as described in <a href="rfc6388.html#section-6.1.1">Section 6.1.1 of
   [RFC6388]</a>.

   When establishing the downstream path of an HSMP LSP, as defined in
   [<a href="rfc6389.html" title='"MPLS Upstream Label Assignment for LDP"'>RFC6389</a>], a Label Request message for an LSP label is sent to the
   upstream LSR.  The upstream LSR should send a Label Mapping message
   that contains the LSP label for the downstream HSMP FEC and the
   upstream LSR context label defined in [<a href="rfc5331.html" title='"MPLS Upstream Label Assignment and Context-Specific Label Space"'>RFC5331</a>].  When the LSR
   forwards a packet downstream on one of those LSPs, the packet's top
   label must be the "upstream LSR context label" and the packet's
   second label is the "LSP label".  The HSMP downstream path will be
   installed in the context-specific forwarding table corresponding to
   the upstream LSR label.  Packets sent by the upstream LSR can be
   forwarded downstream using this forwarding state based on a two-label
   lookup.

   The upstream path of an HSMP LSP on a LAN is the same as the one on
   other kinds of links.  That is, the upstream LSR must send a Label
   Mapping message that contains the LSP label for the upstream HSMP FEC
   to the downstream node.  Packets traveling upstream need to be
   forwarded in the direction of the root by using the label allocated
   for the upstream HSMP FEC.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Redundancy%20Considerations"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Redundancy Considerations</span>

   In some scenarios, it is necessary to provide two root nodes for
   redundancy purposes.  One way to implement this is to use two
   independent HSMP LSPs acting as active and standby.  At a given time,
   only one HSMP LSP will be active; the other will be standby.  After
   detecting the failure of the active HSMP LSP, the root and leaf nodes
   will switch the traffic to the standby HSMP LSP, which takes on the
   role as active HSMP LSP.  The details of the redundancy mechanism are
   out of the scope of this document.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20Failure%20Detection%20of%20HSMP%20LSP"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  Failure Detection of HSMP LSP</span>

   The idea of LSP ping for HSMP LSPs could be expressed as an intention
   to test the LSP Ping Echo Request packets that enter at the root
   along a particular downstream path of HSMP LSP and that end their
   MPLS path on the leaf.  The leaf node then sends the LSP Ping Echo
   Reply along the upstream path of HSMP LSP, and it ends on the root
   that is the (intended) root node.



<span class="grey">Jin, et al.                  Standards Track                   [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc7140.html">RFC 7140</a>               LDP Extensions for HSMP LSP            March 2014</span>


   New sub-TLVs have been assigned by IANA in Target FEC Stack TLV and
   Reverse-path Target FEC Stack TLV to define the corresponding HSMP-
   downstream FEC type and HSMP-upstream FEC type.  In order to ensure
   that the leaf node sends the LSP Ping Echo Reply along the HSMP
   upstream path, the R flag (Validate Reverse Path) in the Global Flags
   field defined in [<a href="rfc6426.html" title='"MPLS On-Demand Connectivity Verification and Route Tracing"'>RFC6426</a>] is reused here.

   The node-processing mechanism of LSP Ping Echo Request and Echo Reply
   for the HSMP LSP is inherited from [<a href="rfc6425.html" title='"Detecting Data-Plane Failures in Point-to-Multipoint MPLS - Extensions to LSP Ping"'>RFC6425</a>] and <a href="rfc6426.html#section-3.4">Section 3.4 of
   [RFC6426]</a>, except for the following:

   1.  The root node sending the LSP Ping Echo Request message for the
       HSMP LSP MUST attach the Target FEC Stack TLV with the HSMP-
       downstream FEC type, and set the R flag to '1' in the Global
       Flags field.

   2.  When the leaf node receives the LSP Ping Echo Request, it MUST
       send the LSP Ping Echo Reply to the associated HSMP upstream
       path.  The Reverse-path Target FEC Stack TLV attached by the leaf
       node in the Echo Reply message SHOULD contain the sub-TLV of the
       associated HSMP-upstream FEC.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20Security%20Considerations"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  Security Considerations</span>

   The same security considerations apply as for the MP2MP LSP described
   in [<a href="rfc6388.html" title='"Label Distribution Protocol Extensions for Point-to- Multipoint and Multipoint-to-Multipoint Label Switched Paths"'>RFC6388</a>] and [<a href="rfc6425.html" title='"Detecting Data-Plane Failures in Point-to-Multipoint MPLS - Extensions to LSP Ping"'>RFC6425</a>].

   Although this document introduces new FEC Elements and corresponding
   procedures, the protocol does not bring any new security issues
   beyond those in [<a href="rfc6388.html" title='"Label Distribution Protocol Extensions for Point-to- Multipoint and Multipoint-to-Multipoint Label Switched Paths"'>RFC6388</a>] and [<a href="rfc6425.html" title='"Detecting Data-Plane Failures in Point-to-Multipoint MPLS - Extensions to LSP Ping"'>RFC6425</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  IANA Considerations</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.1.%20%20New%20LDP%20FEC%20Element%20Types"></a><a class="selflink" href="#section-8.1" name="section-8.1">8.1</a>.  New LDP FEC Element Types</span>

   Two new LDP FEC Element types have been allocated from the "Label
   Distribution Protocol (LDP) Parameters" registry, under "Forwarding
   Equivalence Class (FEC) Type Name Space":

   1.  the HSMP-upstream FEC type - 9

   2.  the HSMP-downstream FEC type - 10

   The values have been allocated from the "IETF Consensus" [<a href="rfc5226.html" title='"Guidelines for Writing an IANA Considerations Section in RFCs"'>RFC5226</a>]
   range (0-127).






<span class="grey">Jin, et al.                  Standards Track                   [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc7140.html">RFC 7140</a>               LDP Extensions for HSMP LSP            March 2014</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.2.%20%20HSMP%20LSP%20Capability%20TLV"></a><a class="selflink" href="#section-8.2" name="section-8.2">8.2</a>.  HSMP LSP Capability TLV</span>

   One new code point has been allocated for the HSMP LSP capability TLV
   from "Label Distribution Protocol (LDP) Parameters" registry, under
   "TLV Type Name Space":

   HSMP LSP Capability Parameter - 0x0902

   The value has been allocated from the"IETF Consensus" range
   (0x0901-0x3DFF).

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.3.%20%20New%20Sub-TLVs%20for%20the%20Target%20Stack%20TLV"></a><a class="selflink" href="#section-8.3" name="section-8.3">8.3</a>.  New Sub-TLVs for the Target Stack TLV</span>

   Two new sub-TLV types have been allocated for inclusion within the
   LSP ping [<a href="rfc4379.html" title='"Detecting Multi-Protocol Label Switched (MPLS) Data Plane Failures"'>RFC4379</a>] Target FEC Stack TLV (TLV type 1), Reverse-path
   Target FEC Stack TLV (TLV type 16), and Reply Path TLV (TLV type 21).

   o  the HSMP-upstream LDP FEC Stack - 29

   o  the HSMP-downstream LDP FEC Stack - 30

   The value has been allocated from the "IETF Standards Action" range
   (0-16383) that is used for mandatory and optional sub-TLVs that
   requires a response if not understood.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/9.%20%20Acknowledgements"></a><a class="selflink" href="#section-9" name="section-9">9</a>.  Acknowledgements</span>

   The author would like to thank Eric Rosen, Sebastien Jobert, Fei Su,
   Edward, Mach Chen, Thomas Morin, and Loa Andersson for their valuable
   comments.





















<span class="grey">Jin, et al.                  Standards Track                   [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc7140.html">RFC 7140</a>               LDP Extensions for HSMP LSP            March 2014</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/10.%20%20References"></a><a class="selflink" href="#section-10" name="section-10">10</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/10.1.%20%20Normative%20References"></a><a class="selflink" href="#section-10.1" name="section-10.1">10.1</a>.  Normative References</span>

   [<a id="ref-RFC2119" name="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a id="ref-RFC5331" name="ref-RFC5331">RFC5331</a>]  Aggarwal, R., Rekhter, Y., and E. Rosen, "MPLS Upstream
              Label Assignment and Context-Specific Label Space", <a href="rfc5331.html">RFC</a>
              <a href="rfc5331.html">5331</a>, August 2008.

   [<a id="ref-RFC5332" name="ref-RFC5332">RFC5332</a>]  Eckert, T., Rosen, E., Aggarwal, R., and Y. Rekhter, "MPLS
              Multicast Encapsulations", <a href="rfc5332.html">RFC 5332</a>, August 2008.

   [<a id="ref-RFC5561" name="ref-RFC5561">RFC5561</a>]  Thomas, B., Raza, K., Aggarwal, S., Aggarwal, R., and JL.
              Le Roux, "LDP Capabilities", <a href="rfc5561.html">RFC 5561</a>, July 2009.

   [<a id="ref-RFC6388" name="ref-RFC6388">RFC6388</a>]  Wijnands, IJ., Minei, I., Kompella, K., and B. Thomas,
              "Label Distribution Protocol Extensions for Point-to-
              Multipoint and Multipoint-to-Multipoint Label Switched
              Paths", <a href="rfc6388.html">RFC 6388</a>, November 2011.

   [<a id="ref-RFC6389" name="ref-RFC6389">RFC6389</a>]  Aggarwal, R. and JL. Le Roux, "MPLS Upstream Label
              Assignment for LDP", <a href="rfc6389.html">RFC 6389</a>, November 2011.

   [<a id="ref-RFC6425" name="ref-RFC6425">RFC6425</a>]  Saxena, S., Swallow, G., Ali, Z., Farrel, A., Yasukawa,
              S., and T. Nadeau, "Detecting Data-Plane Failures in
              Point-to-Multipoint MPLS - Extensions to LSP Ping", <a href="rfc6425.html">RFC</a>
              <a href="rfc6425.html">6425</a>, November 2011.

   [<a id="ref-RFC6426" name="ref-RFC6426">RFC6426</a>]  Gray, E., Bahadur, N., Boutros, S., and R. Aggarwal, "MPLS
              On-Demand Connectivity Verification and Route Tracing",
              <a href="rfc6426.html">RFC 6426</a>, November 2011.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/10.2.%20%20Informative%20References"></a><a class="selflink" href="#section-10.2" name="section-10.2">10.2</a>.  Informative References</span>

   [<a id="ref-RFC4379" name="ref-RFC4379">RFC4379</a>]  Kompella, K. and G. Swallow, "Detecting Multi-Protocol
              Label Switched (MPLS) Data Plane Failures", <a href="rfc4379.html">RFC 4379</a>,
              February 2006.

   [<a id="ref-RFC5036" name="ref-RFC5036">RFC5036</a>]  Andersson, L., Minei, I., and B. Thomas, "LDP
              Specification", <a href="rfc5036.html">RFC 5036</a>, October 2007.

   [<a id="ref-RFC5226" name="ref-RFC5226">RFC5226</a>]  Narten, T. and H. Alvestrand, "Guidelines for Writing an
              IANA Considerations Section in RFCs", <a href="https://tools.ietf.org/html/bcp26">BCP 26</a>, <a href="rfc5226.html">RFC 5226</a>,
              May 2008.





<span class="grey">Jin, et al.                  Standards Track                   [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc7140.html">RFC 7140</a>               LDP Extensions for HSMP LSP            March 2014</span>


Authors' Addresses

   Lizhong Jin
   Shanghai
   China

   EMail: lizho.jin@gmail.com


   Frederic Jounay
   Orange CH
   4 rue du Caudray
   1007 Lausanne
   Switzerland

   EMail: frederic.jounay@orange.ch


   IJsbrand Wijnands
   Cisco Systems, Inc
   De kleetlaan 6a
   Diegem  1831
   Belgium

   EMail: ice@cisco.com


   Nicolai Leymann
   Deutsche Telekom AG
   Winterfeldtstrasse 21
   Berlin  10781
   Germany

   EMail: N.Leymann@telekom.de

















Jin, et al.                  Standards Track                   [Page 15]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc7140 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:23 GMT --></html>