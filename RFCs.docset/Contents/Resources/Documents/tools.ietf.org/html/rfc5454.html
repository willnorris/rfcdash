<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc5454 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 28 Apr 2015 16:01:30 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.111" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="urn:ietf:rfc:5454" name="DC.Identifier"/>
<meta content="This specification provides IPv6 extensions to the Mobile IPv4
protocol. The extensions allow a dual stack node to use IPv4 and IPv6
home addresses as well as to move between IPv4 and dual stack network
infrastructures." name="DC.Description.Abstract"/>
<meta content="Soliman, Hesham" name="DC.Creator"/>
<meta content="Tsirtsis, George" name="DC.Creator"/>
<meta content="Park, Vincent" name="DC.Creator"/>
<meta content="March, 2009" name="DC.Date.Issued"/>
<meta content="Dual Stack Mobile IPv4" name="DC.Title"/>

    <link href="http://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="http://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 5454 - Dual Stack Mobile IPv4</title>
    
    
    <style type="text/css">
	body {
	    margin: 0px 8px;
            font-size: 1em;
	}
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgblue" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="http://tools.ietf.org/rfc/rfc5454.txt" title="Plaintext version of this document">txt</a>|<a href="http://tools.ietf.org/pdf/rfc5454" title="PDF version of this document">pdf</a>] [<a href="http://tools.ietf.org/html/draft-ietf-mip4-dsmipv4" title="draft-ietf-mip4-dsmipv4">draft-ietf-mip4-d...</a>] [<a href="http://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc5454" title="Inline diff (wdiff)">Diff1</a>] [<a href="http://tools.ietf.org/rfcdiff?url2=rfc5454" title="Side-by-side diff">Diff2</a>] [<a href="https://datatracker.ietf.org/ipr/search/?option=rfc_search&amp;rfc_search=5454" title="IPR disclosures related to this document">IPR</a>] [<a href="https://www.rfc-editor.org/errata_search.php?rfc=5454">Errata</a>]  </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                       PROPOSED STANDARD</span><br/>
<span class="pre noprint docinfo">                                                            <span style="color: #C00;">Errata Exist</span></span><br/>
<pre>Network Working Group                                        G. Tsirtsis
Request for Comments: 5454                                       V. Park
Category: Standards Track                                       Qualcomm
                                                              H. Soliman
                                                    Elevate Technologies
                                                              March 2009


                         <span class="h1">Dual-Stack Mobile IPv4</span>

Status of This Memo

   This document specifies an Internet standards track protocol for the
   Internet community, and requests discussion and suggestions for
   improvements.  Please refer to the current edition of the "Internet
   Official Protocol Standards" (STD 1) for the standardization state
   and status of this protocol.  Distribution of this memo is unlimited.

Copyright Notice

   Copyright (c) 2009 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="http://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents in effect on the date of
   publication of this document (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>).
   Please review these documents carefully, as they describe your rights
   and restrictions with respect to this document.

Abstract

   This specification provides IPv6 extensions to the Mobile IPv4
   protocol.  The extensions allow a dual-stack node to use IPv4 and
   IPv6 home addresses as well as to move between IPv4 and dual stack
   network infrastructures.
















<span class="grey">Tsirtsis, et al.            Standards Track                     [Page 1]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc5454.html">RFC 5454</a>                 Dual-Stack Mobile IPv4               March 2009</span>


Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-3">3</a>
      <a href="#section-1.1">1.1</a>. Requirements Notation ......................................<a href="#page-3">3</a>
      <a href="#section-1.2">1.2</a>. Goals ......................................................<a href="#page-3">3</a>
      <a href="#section-1.3">1.3</a>. Non-Goals ..................................................<a href="#page-4">4</a>
      <a href="#section-1.4">1.4</a>. Implicit and Explicit Modes ................................<a href="#page-4">4</a>
   <a href="#section-2">2</a>. Extension Formats ...............................................<a href="#page-4">4</a>
      <a href="#section-2.1">2.1</a>. IPv6 Prefix Request Extension ..............................<a href="#page-4">4</a>
      <a href="#section-2.2">2.2</a>. IPv6 Prefix Reply Extension ................................<a href="#page-5">5</a>
      <a href="#section-2.3">2.3</a>. IPv6 Tunneling Mode Extension ..............................<a href="#page-7">7</a>
   <a href="#section-3">3</a>. Mobile IP Registrations .........................................<a href="#page-8">8</a>
      <a href="#section-3.1">3.1</a>. Registration Request .......................................<a href="#page-8">8</a>
      <a href="#section-3.2">3.2</a>. Registration Reply .........................................<a href="#page-8">8</a>
      <a href="#section-3.3">3.3</a>. Home Agent Considerations ..................................<a href="#page-9">9</a>
           <a href="#section-3.3.1">3.3.1</a>. IPv6 Reachability ..................................<a href="#page-10">10</a>
           <a href="#section-3.3.2">3.3.2</a>. Processing Intercepted IPv6 Packets ................<a href="#page-10">10</a>
           <a href="#section-3.3.3">3.3.3</a>. IPv6 Multicast Membership Control ..................<a href="#page-12">12</a>
      <a href="#section-3.4">3.4</a>. Foreign Agent Considerations ..............................<a href="#page-12">12</a>
      <a href="#section-3.5">3.5</a>. Mobile Node Considerations ................................<a href="#page-12">12</a>
      <a href="#section-3.6">3.6</a>. Tunneling Impacts .........................................<a href="#page-13">13</a>
      <a href="#section-3.7">3.7</a>. IPv6 Prefixes .............................................<a href="#page-14">14</a>
           <a href="#section-3.7.1">3.7.1</a>. Dynamic IPv6 Prefix Delegation .....................<a href="#page-14">14</a>
      <a href="#section-3.8">3.8</a>. Deregistration of IPv6 Prefix .............................<a href="#page-15">15</a>
      <a href="#section-3.9">3.9</a>. Registration with a Private CoA ...........................<a href="#page-15">15</a>
   <a href="#section-4">4</a>. Security Considerations ........................................<a href="#page-15">15</a>
   <a href="#section-5">5</a>. IANA Considerations ............................................<a href="#page-16">16</a>
   <a href="#section-6">6</a>. Acknowledgements ...............................................<a href="#page-16">16</a>
   <a href="#section-7">7</a>. References .....................................................<a href="#page-16">16</a>
      <a href="#section-7.1">7.1</a>. Normative References ......................................<a href="#page-16">16</a>
      <a href="#section-7.2">7.2</a>. Informative References ....................................<a href="#page-17">17</a>




















<span class="grey">Tsirtsis, et al.            Standards Track                     [Page 2]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc5454.html">RFC 5454</a>                 Dual-Stack Mobile IPv4               March 2009</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   Mobile IPv4 [<a href="rfc3344.html" title='"IP Mobility Support for IPv4"'>RFC3344</a>] allows a mobile node with an IPv4 address to
   maintain communications while moving in an IPv4 network.

   Extensions defined in this document allow a node that has IPv4 and
   IPv6 addresses [<a href="rfc2460.html" title='"Internet Protocol, Version 6 (IPv6) Specification"'>RFC2460</a>] to maintain communications through any of
   its addresses while moving in IPv4 or dual stack networks.

   Essentially, this specification separates the Mobile IPv4 signaling
   from the IP version of the traffic it tunnels.  Mobile IPv4 with the
   present extensions remains a signaling protocol that runs over IPv4,
   and yet can set up both IPv4 and IPv6 tunnels over IPv4.

   The aim is two-fold:

      On one hand, Mobile IPv4 with the present extensions becomes a
      useful transition mechanism, allowing automated but controlled
      tunneling of IPv6 traffic over IPv4 tunnels.  Dual-stack nodes in
      dual-stack home networks can now roam to and from legacy IPv4
      networks, while IPv4 mobile nodes and networks can migrate to IPv6
      without changing mobility management, and without upgrading all
      network nodes to IPv6 at once.

      On the other hand, and more importantly, it allows dual-stack
      mobile nodes and networks to utilize a single protocol for the
      movement of both IPv4 and IPv6 stacks in the network topology.

   Note that features like Mobile IPv6 [<a href="rfc3775.html" title='"Mobility Support in IPv6"'>RFC3775</a>] style route
   optimization will not be possible with this solution as it still
   relies on Mobile IPv4 signaling, which does not provide route
   optimization.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.1.%20%20Requirements%20Notation"></a><a class="selflink" href="#section-1.1" name="section-1.1">1.1</a>.  Requirements Notation</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [<a href="rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.2.%20%20Goals"></a><a class="selflink" href="#section-1.2" name="section-1.2">1.2</a>.  Goals</span>

   a.  The solution supports the registration of IPv6 home prefix(es) in
       addition to regular IPv4 home address (HoA) registration.

   b.  The solution supports static and dynamic IPv6 prefix delegation.






<span class="grey">Tsirtsis, et al.            Standards Track                     [Page 3]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc5454.html">RFC 5454</a>                 Dual-Stack Mobile IPv4               March 2009</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.3.%20%20Non-Goals"></a><a class="selflink" href="#section-1.3" name="section-1.3">1.3</a>.  Non-Goals</span>

   a.  The solution does not provide support for IPv6 care-of address
       (CoA) registration.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.4.%20%20Implicit%20and%20Explicit%20Modes"></a><a class="selflink" href="#section-1.4" name="section-1.4">1.4</a>.  Implicit and Explicit Modes</span>

   As defined in Network Mobility (NEMO) [<a href="rfc3963.html" title='"Network Mobility (NEMO) Basic Support Protocol"'>RFC3963</a>], this specification
   also supports two modes of operation; the implicit mode and the
   explicit mode.

   In the implicit mode, the mobile node does not include any IPv6
   prefix request extensions in the registration request.  The home
   agent can use any mechanism (not defined in this document) to
   determine the IPv6 prefix(es) owned by the mobile node and to set up
   forwarding for these prefixes.  In this mode of operation, all
   traffic to and from the IPv6 prefixes MUST be encapsulated over the
   IPv4 tunnel between the mobile node's IPv4 home address and the IPv4
   address of the home agent, and as such, it is transparent to any
   foreign agent in the path.  This IPv4 tunnel is established by
   mechanisms that are out of the scope of this document on both the
   mobile node and home agent when operating in the implicit mode.

   In the explicit mode, IPv6 bindings are signaled explicitly.  The
   mobile node includes one or more IPv6 prefix request extensions in
   the registration request, while the home agent returns corresponding
   IPv6 prefix reply extensions to accept/reject the IPv6 bindings.

   Additionally, in the explicit mode, the mobile node (when co-located
   mode of operation is used) can indicate whether IPv6 traffic should
   be tunneled to the care-of address or the home address of the mobile
   node.

   The rest of this specification is primarily defining the explicit
   mode.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Extension%20Formats"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Extension Formats</span>

   The following extensions are defined according to this specification.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.1.%20%20IPv6%20Prefix%20Request%20Extension"></a><a class="selflink" href="#section-2.1" name="section-2.1">2.1</a>.  IPv6 Prefix Request Extension</span>

   A new skippable extension to the Mobile IPv4 registration request
   message in accordance to the short extension format of [<a href="rfc3344.html" title='"IP Mobility Support for IPv4"'>RFC3344</a>] is
   defined here.






<span class="grey">Tsirtsis, et al.            Standards Track                     [Page 4]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc5454.html">RFC 5454</a>                 Dual-Stack Mobile IPv4               March 2009</span>


   This extension contains a Mobile IPv6 network prefix and its prefix
   length.

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |      Type     |   Length      |   Subtype     | Prefix Length |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                                                               |
      +                                                               +
      |                                                               |
      +                   Mobile IPv6 Network Prefix                  +
      |                                                               |
      +                                                               +
      |                                                               |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                 Figure 1:  IPv6 Prefix Request Extension

   Type

      152 (Dual-Stack Mobile IPv4 (DSMIPv4) Extension)

   Length

      18

   Subtype

      1 (IPv6 Prefix Request)

   Prefix Length

      A sixteen-byte field containing the Mobile IPv6 Network Prefix;
      all insignificant (low-order) bits (beyond the Prefix Length) MUST
      be set to 0 by the originator of the option and ignored by the
      receiver.

   Mobile IPv6 Network Prefix

      A sixteen-byte field containing the Mobile IPv6 Network Prefix

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.2.%20%20IPv6%20Prefix%20Reply%20Extension"></a><a class="selflink" href="#section-2.2" name="section-2.2">2.2</a>.  IPv6 Prefix Reply Extension</span>

   A new skippable extension to the Mobile IPv4 registration reply
   message in accordance to the short extension format of [<a href="rfc3344.html" title='"IP Mobility Support for IPv4"'>RFC3344</a>] is
   defined here.




<span class="grey">Tsirtsis, et al.            Standards Track                     [Page 5]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc5454.html">RFC 5454</a>                 Dual-Stack Mobile IPv4               March 2009</span>


   This extension defines a Mobile IPv6 Network Prefix and its prefix
   length, as well as a code.

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |     Type      |   Length      |   Subtype     |     Code      |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | Prefix Length |    Reserved   |                               |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               +
      |                                                               |
      +                                                               +
      |                                                               |
      +                   Mobile IPv6 Network Prefix                  +
      |                                                               |
      +                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                               |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                   Figure 2: IPv6 Prefix Reply Extension

   Type

      152 (DSMIPv4 Extension)

   Length

      20

   Subtype

      2 (IPv6 Prefix Reply)

   Code

      A value indicating the result of the registration request with
      respect to the IPv6 home prefix registration.  See below for
      currently defined Codes.

   Prefix Length

      Indicates the prefix length of the prefix included in the Mobile
      IPv6 Network Prefix field.  A value of 255 indicates that a link-
      local address is included in the Mobile IPv6 Network Prefix field.







<span class="grey">Tsirtsis, et al.            Standards Track                     [Page 6]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc5454.html">RFC 5454</a>                 Dual-Stack Mobile IPv4               March 2009</span>


   Reserved

      Set to 0 by the sender, ignored by the receiver

   Mobile IPv6 Network Prefix

      A sixteen-byte field containing the Mobile IPv6 Network Prefix;
      all insignificant (low-order) bits (beyond the Prefix Length) MUST
      be set to 0 by the originator of the option and ignored by the
      receiver.

   The following values are defined for use as a Code value in the above
   extension:

      0 registration accepted, IPv6 to be tunneled to HoA

      1 registration accepted, IPv6 to be tunneled to CoA

      8 registration rejected, reason unspecified

      9 registration rejected, administratively prohibited

   Note that a registration reply that does not include an IPv6 prefix
   reply extension, when received in response to a registration request
   carrying at least one instance of the IPv6 prefix request extension,
   indicates that the home agent does not support IPv6 extensions and
   thus has ignored such extensions in the registration request.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.3.%20%20IPv6%20Tunneling%20Mode%20Extension"></a><a class="selflink" href="#section-2.3" name="section-2.3">2.3</a>.  IPv6 Tunneling Mode Extension</span>

   A new skippable extension to the Mobile IPv4 registration request
   message in accordance to the short extension format of [<a href="rfc3344.html" title='"IP Mobility Support for IPv4"'>RFC3344</a>] is
   defined here.

   By including this extension in a registration request, the sender
   indicates that IPv6 traffic can be tunneled to the mobile node's CoA.

   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Type      |   Length      |    Subtype    |   Reserved    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                  Figure 3: IPv6 Tunneling Mode Extension

   Type

      152 (DSMIPv4 Extension)



<span class="grey">Tsirtsis, et al.            Standards Track                     [Page 7]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc5454.html">RFC 5454</a>                 Dual-Stack Mobile IPv4               March 2009</span>


   Length

      2

   Subtype

      3 (IPv6 Tunneling Mode)

   Reserved

      Set to 0 by the sender, ignored by the receiver

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Mobile%20IP%20Registrations"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Mobile IP Registrations</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.1.%20%20Registration%20Request"></a><a class="selflink" href="#section-3.1" name="section-3.1">3.1</a>.  Registration Request</span>

   A mobile node MAY include in a registration request one or more IPv6
   prefix request extensions defined in this specification.

   A mobile node MAY also include exactly one IPv6 tunneling mode
   extension when it uses the co-located care-of address mode of
   [<a href="rfc3344.html" title='"IP Mobility Support for IPv4"'>RFC3344</a>].

   When IPv6 prefix and/or IPv6 tunneling mode extensions are used by
   the mobile IP client, they MUST be placed after the registration
   request header and before the mobile -- home authentication extension
   so they MUST be included in the computation of any authentication
   extension.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.2.%20%20Registration%20Reply"></a><a class="selflink" href="#section-3.2" name="section-3.2">3.2</a>.  Registration Reply</span>

   The mechanism described in this specification depends on skippable
   extensions.  For that reason, a registration reply that does not
   include an IPv6 prefix reply extension, in response to a registration
   request including an IPv6 prefix request extension, indicates that
   the home agent does not support IPv6 extensions and has ignored the
   request.

   If an IPv6 prefix reply extension is included in a registration
   reply, then the extension indicates the success or failure of the
   IPv6 prefix registration.  The IPv6 prefix reply extension does not
   affect, in any way, the code value in the registration reply header
   but it is superseded by it.  In other words, if the code field in the
   registration reply header is set to a reject code, then all IPv6
   prefix request extensions are also rejected.  If the code field in
   the registration reply header, however, is set to an accept code,





<span class="grey">Tsirtsis, et al.            Standards Track                     [Page 8]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc5454.html">RFC 5454</a>                 Dual-Stack Mobile IPv4               March 2009</span>


   then an IPv6 prefix reply extension with a code field set to a reject
   code only rejects the binding for the specific IPv6 prefix indicated
   in the same extension.

   Note that a rejecting IPv6 prefix reply extension has the same effect
   as not including such an extension at all, in the sense that, in both
   cases, the mobile node must act as if the corresponding IPv6 prefix
   request extension included in the registration request was rejected.
   Of course, the inclusion of the IPv6 prefix reply extension allows
   the home agent to indicate why a given IPv6 prefix request extension
   was rejected.  A detailed description of how the mobile node handles
   different IPv6 prefix reply extension code values and the absence of
   IPv6 prefix reply extensions is given in <a href="#section-3.5">Section 3.5</a>.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.3.%20%20Home%20Agent%20Considerations"></a><a class="selflink" href="#section-3.3" name="section-3.3">3.3</a>.  Home Agent Considerations</span>

   The dual-stack home agent defined in this specification is a Mobile
   IPv4 home agent in that, it MUST operate as defined in MIPv4
   [<a href="rfc3344.html" title='"IP Mobility Support for IPv4"'>RFC3344</a>].  In addition to that, the following mechanisms are defined
   in this specification.

   For each IPv6 prefix request extension included in a valid
   registration request, a home agent that supports this specification
   SHOULD include a corresponding IPv6 prefix reply extension in the
   registration reply message.  The home agent MUST NOT include more
   than one IPv6 prefix reply extension for the same prefix.  For each
   accepted IPv6 prefix, the home agent MUST decide the tunneling mode
   it is going to use and set the code field of the IPv6 prefix reply
   extension to the appropriate value.  The IPv6 prefix field of each of
   the IPv6 prefix reply extensions included in the registration reply
   MUST match the IPv6 prefix field of an IPv6 prefix request extension
   included in the corresponding registration request message.

   When the home agent sends a successful registration reply to the
   mobile node, with the code field of a corresponding IPv6 prefix reply
   extension set to one of the "registration accepted" values, the home
   agent indicates that the IPv6 prefix is registered for the lifetime
   granted for the binding.  It also indicates the tunneling mode used
   i.e., tunneling to home address or care-of address, based on the
   value of the code field used in the IPv6 prefix reply extension.

   Note that since only IPv6 prefixes (and not addresses) are supported
   by this specification, there is no need for Duplicate Address
   Detection.  The home agent, however, MUST check that registered
   prefixes are not overlapping so that all addresses under each
   registered prefix belong to a single mobile node at any one time.
   These prefixes MUST NOT appear as on-link to any other node (e.g.,
   via Router Advertisements).



<span class="grey">Tsirtsis, et al.            Standards Track                     [Page 9]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc5454.html">RFC 5454</a>                 Dual-Stack Mobile IPv4               March 2009</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.3.1.%20%20IPv6%20Reachability"></a><a class="selflink" href="#section-3.3.1" name="section-3.3.1">3.3.1</a>.  IPv6 Reachability</span>

   For each registered IPv6 prefix, the home agent MUST advertise its
   reachability as defined in NEMO <a href="rfc3963.html#section-6.3">Section 6.3 of [RFC3963]</a>.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.3.2.%20%20Processing%20Intercepted%20IPv6%20Packets"></a><a class="selflink" href="#section-3.3.2" name="section-3.3.2">3.3.2</a>.  Processing Intercepted IPv6 Packets</span>

   A dual-stack home agent that supports the IPv6 extensions defined in
   this specification MUST keep track of the following IPv6 related
   state for the mobile nodes it supports, in addition to the state
   defined in [<a href="rfc3344.html" title='"IP Mobility Support for IPv4"'>RFC3344</a>].

   - Registered IPv6 prefix(es) and prefix length(s).

   - Tunneling mode for IPv6 traffic:

      - Tunnel to IPv4 HoA and accept IPv6 tunneled from IPv4 HoA.

      - Tunnel to CoA and accept IPv6 tunneled from CoA.

   When IPv6 traffic is encapsulated over the tunnel between the home
   agent (HA) and the mobile node's care-of address, the tunneling
   mechanism used should be the same as the mechanism negotiated by the
   Mobile IP header as defined in MIPv4 [<a href="rfc3344.html" title='"IP Mobility Support for IPv4"'>RFC3344</a>].  In that case, when
   IPinIP encapsulation is negotiated, IPv6 is tunneled over IPv4
   according to [<a href="rfc4213.html" title='"Basic Transition Mechanisms for IPv6 Hosts and Routers"'>RFC4213</a>].  Generic Routing Encapsulation (GRE) also
   allows tunneling of IPv6 packets by setting the Protocol Type
   [<a href="rfc2784.html" title='"Generic Routing Encapsulation (GRE)"'>RFC2784</a>] field, to the appropriate payload type defined for IPv6 by
   IANA.  Minimal Encapsulation [<a href="rfc2004.html" title='"Minimal Encapsulation within IP"'>RFC2004</a>] cannot be used, since the
   second (inner) IP header is IPv6, which is not supported by
   [<a href="rfc2004.html" title='"Minimal Encapsulation within IP"'>RFC2004</a>].

   When IPv6 traffic is encapsulated over the tunnel between the HA and
   the mobile node's home address, IPv6 is always tunneled over IPv4
   according to [<a href="rfc4213.html" title='"Basic Transition Mechanisms for IPv6 Hosts and Routers"'>RFC4213</a>].  The resulting IPv4 packet is then delivered
   just like any other IPv4 packet addressed to the IPv4 HoA (using the
   tunneling for normal IPv4 traffic, possibly going via the foreign
   agent (FA)).

   Tunneling mode selection for IPv6 traffic depends on the following
   parameters in a successful registration request:

   1)  A registration request is received with one or more IPv6 prefix
       request extensions.  An IPv6 tunneling mode extension is not
       included.






<span class="grey">Tsirtsis, et al.            Standards Track                    [Page 10]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc5454.html">RFC 5454</a>                 Dual-Stack Mobile IPv4               March 2009</span>


          All IPv6 packets destined to the registered IPv6 prefix(es)
          MUST be tunneled by the home agent to the registered IPv4 home
          address of the mobile node.  The home agent first encapsulates
          the IPv6 packet, addressing it to the mobile node's IPv4 home
          address, and then tunnels this encapsulated packet to the
          foreign agent.  This extra level of encapsulation is required
          so that IPv6 routing remains transparent to a foreign agent
          that does not support IPv6.  When received by the foreign
          agent, the unicast encapsulated packet is de-tunneled and
          delivered to the mobile node in the same way as any other
          packet.  The mobile node must decapsulate the received IPv4
          packet in order to recover the original IPv6 packet.

          Additionally, the home agent MUST be prepared to accept
          reverse-tunneled packets from the IPv4 home address of the
          mobile node encapsulating IPv6 packets sent by that mobile
          node.

   2)  A registration request is received with one or more IPv6 prefix
       request extensions.  An IPv6 tunneling mode extension is
       included.

          All IPv6 packets destined to the registered IPv6 prefix(es)
          SHOULD be tunneled by the home agent to the registered care-of
          address of the mobile node.  Additionally, the home agent
          SHOULD be prepared to accept reverse-tunneled packets from the
          care-of address of the mobile node encapsulating IPv6 packets
          sent by that mobile node.  The home agent MAY ignore the
          presence of the IPv6 tunneling mode extension and act as in
          case (1) above.

   The home agent MUST check that all inner IPv6 packets received from
   the mobile node over a tunnel with the mobile node's home address or
   the care-of address as the outer source address, include a source
   address that falls under the registered IPv6 prefix(es) for that
   mobile node.  If the source address of the outer header of a tunneled
   packet is not the registered IPv4 care-of address or the registered
   IPv4 home addresses, the packet SHOULD be dropped.  If the source
   address of the inner header of an tunneled packet does not match any
   of the registered prefixes, the packet SHOULD be dropped.

   Multicast packets addressed to a group to which the mobile node has
   successfully subscribed, MUST be tunneled to the mobile node.








<span class="grey">Tsirtsis, et al.            Standards Track                    [Page 11]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc5454.html">RFC 5454</a>                 Dual-Stack Mobile IPv4               March 2009</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.3.3.%20%20IPv6%20Multicast%20Membership%20Control"></a><a class="selflink" href="#section-3.3.3" name="section-3.3.3">3.3.3</a>.  IPv6 Multicast Membership Control</span>

   IPv6 multicast membership control is provided as defined in MIPv6
   <a href="rfc3775.html#section-10.4.3">[RFC3775], Section 10.4.3</a>.  The only clarification required for the
   purpose of this specification is that all Multicast Listener
   Discovery (MLD) [<a href="rfc2710.html" title='"Multicast Listener Discovery (MLD) for IPv6"'>RFC2710</a>] or MLDv2 [<a href="rfc3810.html" title='"Multicast Listener Discovery Version 2 (MLDv2) for IPv6"'>RFC3810</a>] messages between the
   mobile node and the home agent MUST be tunneled over an IPv4 tunnel
   between the mobile node's IPv4 home address and the home agent's IPv4
   address, bypassing the foreign agent.  Note that if tunneling to the
   care-of address has been negotiated for other traffic, then the rest
   of the traffic continues using this tunnel.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.4.%20%20Foreign%20Agent%20Considerations"></a><a class="selflink" href="#section-3.4" name="section-3.4">3.4</a>.  Foreign Agent Considerations</span>

   This specification does not affect the operation of the foreign
   agent.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.5.%20%20Mobile%20Node%20Considerations"></a><a class="selflink" href="#section-3.5" name="section-3.5">3.5</a>.  Mobile Node Considerations</span>

   A dual-stack mobile node that supports the extensions described in
   this document MAY use these extensions to register its IPv6
   prefix(es) while moving between access routers.

   The mobile node MAY include one or more IPv6 prefix request
   extension(s) in the registration request.

   In this case, the mobile node MUST take the following action
   depending on the extensions included in the registration reply it
   receives in response to the registration request:

   1)  The registration reply does not include any IPv6 prefix reply
       extensions.

          The mobile node MUST assume that the home agent does not
          support the extensions defined in this specification.  The
          mobile node SHOULD continue to operate according to MIPv4
          [<a href="rfc3344.html" title='"IP Mobility Support for IPv4"'>RFC3344</a>].

   2)  The registration reply includes one or more IPv6 prefix reply
       extensions.

          The mobile node MUST match each IPv6 prefix reply extension
          with one of the IPv6 prefix request extensions included
          earlier in the corresponding registration request message.







<span class="grey">Tsirtsis, et al.            Standards Track                    [Page 12]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc5454.html">RFC 5454</a>                 Dual-Stack Mobile IPv4               March 2009</span>


          If a matching IPv6 prefix reply extension is not included for
          one or more of corresponding IPv6 prefix request extensions
          included in the registration request message, the mobile node
          MUST assume that these IPv6 prefixes are rejected.

          For each matching IPv6 prefix reply extension, the mobile node
          MUST inspect the code field.  If the field is set to a
          rejection code, then the corresponding IPv6 prefix
          registration has been rejected.  If the code field is set to
          an acceptance code, then the corresponding IPv6 prefix
          registration has been accepted.

          If the code field is set to "0", then the mobile node MUST be
          prepared to send/receive IPv6 packets encapsulated in the
          bidirectional tunnel between the home agent address and the
          registered IPv4 home address of the mobile node.

          If the code field is set to "1", then the mobile node MUST act
          as follows:

          -  Assuming the co-located care-of address mode is used, the
             mobile node MUST be prepared to send/receive IPv6 packets
             over the bidirectional tunnel between the home agent
             address and its co-located care-of address.  Otherwise, the
             mobile node SHOULD act as in the case where the code field
             is set to "0".

   The mobile node SHOULD include exactly one IPv6 tunneling mode
   extension if it uses the co-located care-of address model and it
   wants to request that IPv6 packets are tunneled to its co-located
   care-of address.  If the mobile node uses the co-located care-of
   address model but it does not include the IPv6 tunneling mode
   extension, the home agent will tunnel IPv6 traffic to the mobile
   node's IPv4 home address.  The mobile node MUST NOT include an IPv6
   tunneling mode extension if it uses the foreign agent care-of address
   mode of operation.  Note that if the mobile node includes an IPv6
   tunneling mode extension in this case, IPv6 packets could be tunneled
   to the FA by the HA.  The FA is then likely to drop them since it
   will not have appropriate state to process them.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.6.%20%20Tunneling%20Impacts"></a><a class="selflink" href="#section-3.6" name="section-3.6">3.6</a>.  Tunneling Impacts</span>

   When IPv6 runs over an IPv4 tunnel, the IPv6 tunnel endpoints can
   treat the IPv4 tunnel as a single hop link as defined in [<a href="rfc4213.html" title='"Basic Transition Mechanisms for IPv6 Hosts and Routers"'>RFC4213</a>].
   The two tunnel endpoints, e.g., mobile node and home agent, MUST
   configure link-local IPv6 addresses as defined in <a href="#section-3.7">Section 3.7</a> of





<span class="grey">Tsirtsis, et al.            Standards Track                    [Page 13]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc5454.html">RFC 5454</a>                 Dual-Stack Mobile IPv4               March 2009</span>


   [<a href="rfc4213.html" title='"Basic Transition Mechanisms for IPv6 Hosts and Routers"'>RFC4213</a>], while they MUST also adhere to the neighbor discovery
   requirements of the same specification, <a href="#section-3.8">Section 3.8</a>, and the hop
   limit requirements of <a href="#section-3.3">Section 3.3</a>.

   With respect to the Tunnel MTU, an implementation MUST support the
   Static Tunnel MTU approach as defined in <a href="rfc4213.html#section-3.2">Section 3.2 of [RFC4213]</a>.
   Implementation and use of the Dynamic Tunnel MTU method defined in
   the same section of [<a href="rfc4213.html" title='"Basic Transition Mechanisms for IPv6 Hosts and Routers"'>RFC4213</a>] is OPTIONAL.

   To accommodate traffic that uses Explicit Congestion Notification
   (ECN), it is RECOMMENDED that the ECN and Diffserv Code Point (DSCP)
   information is copied between the inner and outer header as defined
   in [<a href="rfc3168.html" title='"The Addition of Explicit Congestion Notification (ECN) to IP"'>RFC3168</a>] and [<a href="rfc2983.html" title='"Differentiated Services and Tunnels"'>RFC2983</a>].  It is RECOMMENDED that the full-
   functionality option defined in <a href="rfc3168.html#section-9.1.1">Section 9.1.1 of [RFC3168]</a> be used to
   deal with ECN.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.7.%20%20IPv6%20Prefixes"></a><a class="selflink" href="#section-3.7" name="section-3.7">3.7</a>.  IPv6 Prefixes</span>

   An implementation can use any number of mechanisms to allocate IPv6
   prefixes to a mobile node.  Once one or more IPv6 prefixes are
   allocated, they can be registered using the extensions and mechanism
   already described in this specification.

   How a home agent decides to accept an IPv6 prefix for a given mobile
   node is out of scope of this specification.  Local configuration or
   external authorization via an authorization system, e.g., Diameter
   [<a href="rfc3588.html" title='"Diameter Base Protocol"'>RFC3588</a>], or other mechanisms may be used to make such
   determination.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.7.1.%20%20Dynamic%20IPv6%20Prefix%20Delegation"></a><a class="selflink" href="#section-3.7.1" name="section-3.7.1">3.7.1</a>.  Dynamic IPv6 Prefix Delegation</span>

   A dual-stack mobile node MAY use prefix delegation as defined in
   DHCPv6 Prefix Delegation [<a href="rfc3633.html" title='"IPv6 Prefix Options for Dynamic Host Configuration Protocol (DHCP) version 6"'>RFC3633</a>] to get access to IPv6 prefixes.
   In that case, if the mobile node is not directly attached to its home
   agent, the mobile node MUST first register its IPv4 home address as
   per MIPv4 [<a href="rfc3344.html" title='"IP Mobility Support for IPv4"'>RFC3344</a>].  When that is done, the mobile node can generate
   a link-local IPv6 address as per <a href="rfc4213.html#section-3.7">Section 3.7 of [RFC4213]</a>.  The
   mobile node then sends a registration request to its home agent,
   including an IPv6 prefix request extension with the prefix length
   field set to 255 and setting the Mobile IPv6 Network Prefix field to
   the locally generated link-local address.  If the registration reply
   message includes an IPv6 prefix reply extension with the code field
   set to a success code, the mobile node can use the tunnel to send and
   receive IPv6 link-local packets.  The mobile node can now send DHCPv6
   messages according to [<a href="rfc3633.html" title='"IPv6 Prefix Options for Dynamic Host Configuration Protocol (DHCP) version 6"'>RFC3633</a>].  All IPv6 messages at this stage
   MUST be tunneled over the IPv4 tunnel between the mobile node's IPv4
   home address and the home agent's IPv4 address.




<span class="grey">Tsirtsis, et al.            Standards Track                    [Page 14]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc5454.html">RFC 5454</a>                 Dual-Stack Mobile IPv4               March 2009</span>


   Once prefixes are delegated, and assuming explicit mode is used, the
   mobile node SHOULD send a registration request with the appropriate
   IPv6 prefix request extensions to the home agent to register the
   delegated prefixes.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.8.%20%20Deregistration%20of%20IPv6%20Prefix"></a><a class="selflink" href="#section-3.8" name="section-3.8">3.8</a>.  Deregistration of IPv6 Prefix</span>

   The mobile IP registration lifetime included in the registration
   request header is valid for all the bindings created by the
   registration request, which may include bindings for IPv6 prefix(es).

   A registration request with a zero lifetime can be used to remove all
   bindings from the home agent.

   A re-registration request with non-zero lifetime can be used to
   deregister some of the registered IPv6 prefixes by not including
   corresponding IPv6 prefix request extensions in the registration
   request message.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.9.%20%20Registration%20with%20a%20Private%20CoA"></a><a class="selflink" href="#section-3.9" name="section-3.9">3.9</a>.  Registration with a Private CoA</span>

   If the care-of address is a private address, then Mobile IP NAT
   Traversal as [<a href="rfc3519.html" title='"Mobile IP Traversal of Network Address Translation (NAT) Devices"'>RFC3519</a>] MAY be used in combination with the extensions
   described in this specification.  In that case, to transport IPv6
   packets, the next header field of the Mobile Tunnel Data message
   header [<a href="rfc3519.html" title='"Mobile IP Traversal of Network Address Translation (NAT) Devices"'>RFC3519</a>] MUST be set to the value for IPv6.  Note that in
   that case, the encapsulation field of the UDP Tunnel Request
   Extension defined in [<a href="rfc3519.html" title='"Mobile IP Traversal of Network Address Translation (NAT) Devices"'>RFC3519</a>] MUST be set to zero.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Security%20Considerations"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Security Considerations</span>

   This specification operates in the security constraints and
   requirements of [<a href="rfc3344.html" title='"IP Mobility Support for IPv4"'>RFC3344</a>].  It extends the operations defined in
   [<a href="rfc3344.html" title='"IP Mobility Support for IPv4"'>RFC3344</a>] for IPv4 home addresses to cover home IPv6 prefixes and
   provides the same level of security for both IP address versions.

   Home agents MUST perform appropriate checks for reverse-tunneled IPv6
   packets similar to what is defined in [<a href="rfc3024.html" title='"Reverse Tunneling for Mobile IP, revised"'>RFC3024</a>] for IPv4 packets.
   The check defined in [<a href="rfc3024.html" title='"Reverse Tunneling for Mobile IP, revised"'>RFC3024</a>] requires that the outer header's
   source address is set to a registered care-of address for the mobile
   node and as such the same check protects from attacks whether the
   encapsulated (inner) header is IPv4 or IPv6.

   In addition to that, the home agent MUST check that the source
   address of the inner header is a registered IPv4 home address or IPv6
   prefix for this mobile node.  If that is not the case, the home agent
   SHOULD silently discard the packet and log the event as a security
   exception.



<span class="grey">Tsirtsis, et al.            Standards Track                    [Page 15]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc5454.html">RFC 5454</a>                 Dual-Stack Mobile IPv4               March 2009</span>


   Security devices should look for IPv6 packets encapsulated over IPv4
   either directly to the mobile node's care-of address or via double
   encapsulation first to the mobile node's IPv4 home address and then
   to the mobile node's care-of address.  Interactions with Mobile IPv4
   and IPsec have been covered elsewhere, for instance in [<a href="rfc5265.html" title='"Mobile IPv4 Traversal across IPsec-Based VPN Gateways"'>RFC5265</a>] and
   [<a href="rfc5266.html" title='"Secure Connectivity and Mobility Using Mobile IPv4 and IKEv2 Mobility and Multihoming (MOBIKE)"'>RFC5266</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  IANA Considerations</span>

   A new type number (152) for DSMIPv4 extensions has been registered
   from the space of numbers for skippable mobility extensions (i.e.,
   128-255), defined for Mobile IPv4 [<a href="rfc3344.html" title='"IP Mobility Support for IPv4"'>RFC3344</a>].  This registry is
   available from <a href="http://www.iana.org/">http://www.iana.org</a> under "Extensions appearing in
   Mobile IP control messages".

   A new subtype space for the type number of this extension has been
   created: "DSMIPv4 Extension subtypes".  The subtype values 1, 2, and
   3 are defined in this specification, while the rest of the subtypes
   are reserved and available for allocation based on Expert Review.

   Finally, a new space for the code field of the IPv6 prefix reply
   extension has been created: "IPv6 Prefix Reply Extension Codes".
   Values 0, 1, 8, and 9 are defined in this specification.  Values 2-7
   are reserved for accept codes, and values 10-255 are reserved for
   reject codes.

   Similar to the procedures specified for Mobile IPv4 [<a href="rfc3344.html" title='"IP Mobility Support for IPv4"'>RFC3344</a>] number
   spaces, future allocations from the two number spaces require Expert
   Review [<a href="rfc5226.html" title='"Guidelines for Writing an IANA Considerations Section in RFCs"'>RFC5226</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20Acknowledgements"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  Acknowledgements</span>

   Thanks to Pat Calhoun, Paal Engelstad, Tom Hiller, and Pete McCann
   for earlier work on this subject.  Thanks also to Alex Petrescu for
   various suggestions.  Special thanks also to Sri Gundavelli and Kent
   Leung for their thorough review and suggestions.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20References"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.1.%20%20Normative%20References"></a><a class="selflink" href="#section-7.1" name="section-7.1">7.1</a>.  Normative References</span>

   [<a id="ref-RFC2119" name="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="http://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a id="ref-RFC2460" name="ref-RFC2460">RFC2460</a>]  Deering, S. and R. Hinden, "Internet Protocol, Version 6
              (IPv6) Specification", <a href="rfc2460.html">RFC 2460</a>, December 1998.





<span class="grey">Tsirtsis, et al.            Standards Track                    [Page 16]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc5454.html">RFC 5454</a>                 Dual-Stack Mobile IPv4               March 2009</span>


   [<a id="ref-RFC3024" name="ref-RFC3024">RFC3024</a>]  Montenegro, G., "Reverse Tunneling for Mobile IP,
              revised", <a href="rfc3024.html">RFC 3024</a>, January 2001.

   [<a id="ref-RFC3344" name="ref-RFC3344">RFC3344</a>]  Perkins, C., "IP Mobility Support for IPv4", <a href="rfc3344.html">RFC 3344</a>,
              August 2002.

   [<a id="ref-RFC3519" name="ref-RFC3519">RFC3519</a>]  Levkowetz, H. and S. Vaarala, "Mobile IP Traversal of
              Network Address Translation (NAT) Devices", <a href="rfc3519.html">RFC 3519</a>,
              April 2003.

   [<a id="ref-RFC3633" name="ref-RFC3633">RFC3633</a>]  Troan, O. and R. Droms, "IPv6 Prefix Options for Dynamic
              Host Configuration Protocol (DHCP) version 6", <a href="rfc3633.html">RFC 3633</a>,
              December 2003.

   [<a id="ref-RFC3775" name="ref-RFC3775">RFC3775</a>]  Johnson, D., Perkins, C., and J. Arkko, "Mobility Support
              in IPv6", <a href="rfc3775.html">RFC 3775</a>, June 2004.

   [<a id="ref-RFC3963" name="ref-RFC3963">RFC3963</a>]  Devarapalli, V., Wakikawa, R., Petrescu, A., and P.
              Thubert, "Network Mobility (NEMO) Basic Support Protocol",
              <a href="rfc3963.html">RFC 3963</a>, January 2005.

   [<a id="ref-RFC4213" name="ref-RFC4213">RFC4213</a>]  Nordmark, E. and R. Gilligan, "Basic Transition Mechanisms
              for IPv6 Hosts and Routers", <a href="rfc4213.html">RFC 4213</a>, October 2005.

   [<a id="ref-RFC5226" name="ref-RFC5226">RFC5226</a>]  Narten, T. and H. Alvestrand, "Guidelines for Writing an
              IANA Considerations Section in RFCs", <a href="http://tools.ietf.org/html/bcp26">BCP 26</a>, <a href="rfc5226.html">RFC 5226</a>,
              May 2008.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.2.%20%20Informative%20References"></a><a class="selflink" href="#section-7.2" name="section-7.2">7.2</a>.  Informative References</span>

   [<a id="ref-RFC2004" name="ref-RFC2004">RFC2004</a>]  Perkins, C., "Minimal Encapsulation within IP", <a href="rfc2004.html">RFC 2004</a>,
              October 1996.

   [<a id="ref-RFC2710" name="ref-RFC2710">RFC2710</a>]  Deering, S., Fenner, W., and B. Haberman, "Multicast
              Listener Discovery (MLD) for IPv6", <a href="rfc2710.html">RFC 2710</a>,
              October 1999.

   [<a id="ref-RFC2784" name="ref-RFC2784">RFC2784</a>]  Farinacci, D., Li, T., Hanks, S., Meyer, D., and P.
              Traina, "Generic Routing Encapsulation (GRE)", <a href="rfc2784.html">RFC 2784</a>,
              March 2000.

   [<a id="ref-RFC2983" name="ref-RFC2983">RFC2983</a>]  Black, D., "Differentiated Services and Tunnels",
              <a href="rfc2983.html">RFC 2983</a>, October 2000.

   [<a id="ref-RFC3168" name="ref-RFC3168">RFC3168</a>]  Ramakrishnan, K., Floyd, S., and D. Black, "The Addition
              of Explicit Congestion Notification (ECN) to IP",
              <a href="rfc3168.html">RFC 3168</a>, September 2001.




<span class="grey">Tsirtsis, et al.            Standards Track                    [Page 17]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc5454.html">RFC 5454</a>                 Dual-Stack Mobile IPv4               March 2009</span>


   [<a id="ref-RFC3588" name="ref-RFC3588">RFC3588</a>]  Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J.
              Arkko, "Diameter Base Protocol", <a href="rfc3588.html">RFC 3588</a>, September 2003.

   [<a id="ref-RFC3810" name="ref-RFC3810">RFC3810</a>]  Vida, R. and L. Costa, "Multicast Listener Discovery
              Version 2 (MLDv2) for IPv6", <a href="rfc3810.html">RFC 3810</a>, June 2004.

   [<a id="ref-RFC5265" name="ref-RFC5265">RFC5265</a>]  Vaarala, S. and E. Klovning, "Mobile IPv4 Traversal across
              IPsec-Based VPN Gateways", <a href="rfc5265.html">RFC 5265</a>, June 2008.

   [<a id="ref-RFC5266" name="ref-RFC5266">RFC5266</a>]  Devarapalli, V. and P. Eronen, "Secure Connectivity and
              Mobility Using Mobile IPv4 and IKEv2 Mobility and
              Multihoming (MOBIKE)", <a href="http://tools.ietf.org/html/bcp136">BCP 136</a>, <a href="rfc5266.html">RFC 5266</a>, June 2008.

Authors' Addresses

   George Tsirtsis
   Qualcomm

   EMail: tsirtsis@googlemail.com


   Vincent Park
   Qualcomm

   Phone: +908-947-7084
   EMail: vpark@qualcomm.com


   Hesham Soliman
   Elevate Technologies

   Phone: +614-111-410-445
   EMail: hesham@elevatemobile.com


















Tsirtsis, et al.            Standards Track                    [Page 18]

</pre><br/>
<span class="noprint"><small><small>Html markup produced by rfcmarkup 1.111, available from
<a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
</small></small></span>



</body><!-- Mirrored from tools.ietf.org/html/rfc5454 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 28 Apr 2015 16:01:30 GMT --></html>