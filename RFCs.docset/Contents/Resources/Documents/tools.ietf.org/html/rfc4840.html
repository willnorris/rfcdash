<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc4840 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:39 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="urn:ietf:rfc:4840" name="DC.Identifier"/>
<meta content="This document describes architectural and operational issues that
arise from link-layer protocols supporting multiple Internet Protocol
encapsulation methods. This memo provides information for the Internet
community." name="DC.Description.Abstract"/>
<meta content="Aboba, Bernard" name="DC.Creator"/>
<meta content="Davies, Elwyn B." name="DC.Creator"/>
<meta content="Davies, Elwyn" name="DC.Creator"/>
<meta content="Thaler, Dave" name="DC.Creator"/>
<meta content="April, 2007" name="DC.Date.Issued"/>
<meta content="Multiple Encapsulation Methods Considered Harmful" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 4840 - Multiple Encapsulation Methods Considered Harmful</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgorange" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc4840.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc4840" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-iab-link-encaps" title="draft-iab-link-encaps">draft-iab-link-...</a>] [<a href="https://datatracker.ietf.org/doc/rfc4840" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc4840" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc4840" title="Side-by-side diff">Diff2</a>]         </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                           INFORMATIONAL</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Network Working Group                                      B. Aboba, Ed.
Request for Comments: 4840                                     E. Davies
Category: Informational                                        D. Thaler
                                             Internet Architecture Board
                                                              April 2007


           <span class="h1">Multiple Encapsulation Methods Considered Harmful</span>

Status of This Memo

   This memo provides information for the Internet community.  It does
   not specify an Internet standard of any kind.  Distribution of this
   memo is unlimited.

Copyright Notice

   Copyright (C) The IETF Trust (2007).

Abstract

   This document describes architectural and operational issues that
   arise from link-layer protocols supporting multiple Internet Protocol
   encapsulation methods.



























<span class="grey">Aboba, et al.                Informational                      [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc4840.html">RFC 4840</a>         Multiple Encapsulation Methods Harmful       April 2007</span>


Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-3">3</a>
      <a href="#section-1.1">1.1</a>. Terminology ................................................<a href="#page-3">3</a>
      <a href="#section-1.2">1.2</a>. Ethernet Experience ........................................<a href="#page-4">4</a>
           <a href="#section-1.2.1">1.2.1</a>. IEEE 802.2/802.3 LLC Type 1 Encapsulation ...........<a href="#page-6">6</a>
           <a href="#section-1.2.2">1.2.2</a>. Trailer Encapsulation ...............................<a href="#page-7">7</a>
      <a href="#section-1.3">1.3</a>. PPP Experience ............................................<a href="#page-10">10</a>
      <a href="#section-1.4">1.4</a>. Potential Mitigations .....................................<a href="#page-10">10</a>
   <a href="#section-2">2</a>. Evaluation of Arguments for Multiple Encapsulations ............<a href="#page-11">11</a>
      <a href="#section-2.1">2.1</a>. Efficiency ................................................<a href="#page-11">11</a>
      <a href="#section-2.2">2.2</a>. Multicast/Broadcast .......................................<a href="#page-12">12</a>
      <a href="#section-2.3">2.3</a>. Multiple Uses .............................................<a href="#page-13">13</a>
   <a href="#section-3">3</a>. Additional Issues ..............................................<a href="#page-15">15</a>
      <a href="#section-3.1">3.1</a>. Generality ................................................<a href="#page-15">15</a>
      <a href="#section-3.2">3.2</a>. Layer Interdependence .....................................<a href="#page-16">16</a>
      <a href="#section-3.3">3.3</a>. Inspection of Payload Contents ............................<a href="#page-17">17</a>
      <a href="#section-3.4">3.4</a>. Interoperability Guidance .................................<a href="#page-17">17</a>
      <a href="#section-3.5">3.5</a>. Service Consistency .......................................<a href="#page-19">19</a>
      <a href="#section-3.6">3.6</a>. Implementation Complexity .................................<a href="#page-19">19</a>
      <a href="#section-3.7">3.7</a>. Negotiation ...............................................<a href="#page-19">19</a>
      <a href="#section-3.8">3.8</a>. Roaming ...................................................<a href="#page-20">20</a>
   <a href="#section-4">4</a>. Security Considerations ........................................<a href="#page-20">20</a>
   <a href="#section-5">5</a>. Conclusion .....................................................<a href="#page-21">21</a>
   <a href="#section-6">6</a>. References .....................................................<a href="#page-22">22</a>
      <a href="#section-6.1">6.1</a>. Normative Reference .......................................<a href="#page-22">22</a>
      <a href="#section-6.2">6.2</a>. Informative References ....................................<a href="#page-22">22</a>
   <a href="#section-7">7</a>. Acknowledgments ................................................<a href="#page-25">25</a>
   <a href="#appendix-A">Appendix A</a>. IAB Members at the Time of This Writing ...............<a href="#page-26">26</a>






















<span class="grey">Aboba, et al.                Informational                      [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc4840.html">RFC 4840</a>         Multiple Encapsulation Methods Harmful       April 2007</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   This document describes architectural and operational issues arising
   from the use of multiple ways of encapsulating IP packets on the same
   link.

   While typically a link-layer protocol supports only a single Internet
   Protocol (IP) encapsulation method, this is not always the case.  For
   example, on the same cable it is possible to encapsulate an IPv4
   packet using Ethernet [<a href="#ref-DIX" title='"The Ethernet -- A Local Area Network: Data Link Layer and Physical Layer (Version 2.0)"'>DIX</a>] encapsulation as defined in "A Standard
   for the Transmission of IP Datagrams over Ethernet Networks"
   [<a href="rfc894.html" title='"A Standard for the Transmission of IP Datagrams over Ethernet Networks"'>RFC894</a>], the IEEE 802.2/802.3 LLC [<a href="#ref-IEEE-802.3.2002" title='"Carrier Sense Multiple Access with Collision Detection (CSMA/CD) Access Method and Physical Layer Specifications"'>IEEE-802.3.2002</a>] Type 1
   encapsulation defined in "Two Methods For The Transmission of IP
   Datagrams over IEEE 802.3 Networks" [<a href="rfc948.html" title='"Two Methods for the Transmission of IP Datagrams over IEEE 802.3 Networks"'>RFC948</a>], or the IEEE 802
   [<a href="#ref-IEEE-802.1A.1990" title='"Local Area Networks and Metropolitan Area Networks: Overview and Architecture of Network Standards"'>IEEE-802.1A.1990</a>] encapsulation defined in "A Standard for the
   Transmission of IP Datagrams over IEEE 802 Networks" [<a href="rfc1042.html" title='"Standard for the transmission of IP datagrams over IEEE 802 networks"'>RFC1042</a>].
   Historically, a further encapsulation method was used on some
   Ethernet systems as specified in "Trailer Encapsulations" [<a href="rfc893.html" title='"Trailer encapsulations"'>RFC893</a>].
   Similarly, ATM (e.g., see [<a href="rfc2684.html" title='"Multiprotocol Encapsulation over ATM Adaptation Layer 5"'>RFC2684</a>]), the Point-to-Point Protocol
   (PPP) [<a href="rfc1661.html" title='"The Point-to-Point Protocol (PPP)"'>RFC1661</a>], and IEEE 802.16 [<a href="#ref-IEEE-802.16e.2005" title='"Information technology - Telecommunications and information exchange between systems - Local and Metropolitan Area Networks - Part 16: Air Interface for Fixed and Mobile Broadband Wireless Access Systems, Amendment for Physical and Medium Access Control Layers for Combined Fixed and Mobile Operation in Licensed Bands"'>IEEE-802.16e.2005</a>] also support
   multiple encapsulation mechanisms.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.1.%20%20Terminology"></a><a class="selflink" href="#section-1.1" name="section-1.1">1.1</a>.  Terminology</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in <a href="rfc2119.html">RFC 2119</a> [<a href="rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].

   Broadcast domain
        The set of all endpoints that receive broadcast frames sent by
        an endpoint in the set.

   Classification
        As defined in [<a href="#ref-IEEE-802.16e.2005" title='"Information technology - Telecommunications and information exchange between systems - Local and Metropolitan Area Networks - Part 16: Air Interface for Fixed and Mobile Broadband Wireless Access Systems, Amendment for Physical and Medium Access Control Layers for Combined Fixed and Mobile Operation in Licensed Bands"'>IEEE-802.16e.2005</a>], the process by which a Medium
        Access Control (MAC) Service Data Unit (SDU) is mapped into a
        particular transport connection for transmission between MAC
        peers.

   Connection Identifier (CID)
        In [<a href="#ref-IEEE-802.16e.2005" title='"Information technology - Telecommunications and information exchange between systems - Local and Metropolitan Area Networks - Part 16: Air Interface for Fixed and Mobile Broadband Wireless Access Systems, Amendment for Physical and Medium Access Control Layers for Combined Fixed and Mobile Operation in Licensed Bands"'>IEEE-802.16e.2005</a>] the connection identifier is a 16-bit
        value that identifies a transport connection or an uplink
        (UL)/downlink (DL) pair of associated management connections.  A
        connection is a unidirectional mapping between base station (BS)
        and subscriber station (SS) MAC peers.  Each transport
        connection has a particular set of associated parameters
        indicating characteristics such as the ciphersuite and quality-
        of-service.




<span class="grey">Aboba, et al.                Informational                      [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc4840.html">RFC 4840</a>         Multiple Encapsulation Methods Harmful       April 2007</span>


   Link
        A communication facility or medium over which nodes can
        communicate at the link layer, i.e., the layer immediately below
        IP.

   Link Layer
        The conceptual layer of control or processing logic that is
        responsible for maintaining control of the link.  The link-layer
        functions provide an interface between the higher-layer logic
        and the link.  The link layer is the layer immediately below IP.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.2.%20%20Ethernet%20Experience"></a><a class="selflink" href="#section-1.2" name="section-1.2">1.2</a>.  Ethernet Experience</span>

   The fundamental issues with multiple encapsulation methods on the
   same link are described in [<a href="rfc1042.html" title='"Standard for the transmission of IP datagrams over IEEE 802 networks"'>RFC1042</a>] and "Requirements for Internet
   Hosts -- Communication Layers" [<a href="rfc1122.html" title='"Requirements for Internet Hosts -- Communication Layers"'>RFC1122</a>].  This section summarizes
   the concerns articulated in those documents and also describes the
   limitations of approaches suggested to mitigate the problems,
   including encapsulation negotiation and use of routers.

   [<a id="ref-RFC1042" name="ref-RFC1042">RFC1042</a>] described the potential issues resulting from
   contemporaneous use of Ethernet and IEEE 802.3 encapsulations on the
   same physical cable:

      Interoperation with Ethernet

      It is possible to use the Ethernet link level protocol [<a href="#ref-DIX" title='"The Ethernet -- A Local Area Network: Data Link Layer and Physical Layer (Version 2.0)"'>DIX</a>] on
      the same physical cable with the IEEE 802.3 link level protocol.
      A computer interfaced to a physical cable used in this way could
      potentially read both Ethernet and 802.3 packets from the network.
      If a computer does read both types of packets, it must keep track
      of which link protocol was used with each other computer on the
      network and use the proper link protocol when sending packets.

      One should note that in such an environment, link level broadcast
      packets will not reach all the computers attached to the network,
      but only those using the link level protocol used for the
      broadcast.

      Since it must be assumed that most computers will read and send
      using only one type of link protocol, it is recommended that if
      such an environment (a network with both link protocols) is
      necessary, an IP gateway be used as if there were two distinct
      networks.

      Note that the MTU for the Ethernet allows a 1500 octet IP
      datagram, with the MTU for the 802.3 network allows only a 1492
      octet IP datagram.



<span class="grey">Aboba, et al.                Informational                      [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc4840.html">RFC 4840</a>         Multiple Encapsulation Methods Harmful       April 2007</span>


   When multiple IP encapsulation methods were supported on a given
   link, all hosts could not be assumed to support the same set of
   encapsulation methods.  This in turn implied that the broadcast
   domain might not include all hosts on the link.  Where a single
   encapsulation does not reach all hosts on the link, a host needs to
   determine the appropriate encapsulation prior to sending.  While a
   host supporting reception of multiple encapsulations could keep track
   of the encapsulations it receives, this does not enable initiation of
   communication; supporting initiation requires a host to support
   sending of multiple encapsulations in order to determine which one to
   use.  However, requiring hosts to send and receive multiple
   encapsulations is a potentially onerous requirement.  <a href="rfc1122.html#section-2.3.3">[RFC1122],
   Section 2.3.3</a>, notes the difficulties with this approach:

      Furthermore, it is not useful or even possible for a dual-format
      host to discover automatically which format to send, because of
      the problem of link-layer broadcasts.

   To enable hosts that only support sending and receiving of a single
   encapsulation to communicate with each other, a router can be
   utilized to segregate the hosts by encapsulation.  Here only the
   router needs to support sending and receiving of multiple
   encapsulations.  This requires assigning a separate unicast prefix to
   each encapsulation, or else all hosts in the broadcast domain would
   not be reachable with a single encapsulation.

   <a href="rfc1122.html#section-2.3.3">[RFC1122], Section 2.3.3</a>, provided guidance on encapsulation support:

      Every Internet host connected to a 10Mbps Ethernet cable:

      o  MUST be able to send and receive packets using <a href="rfc894.html">RFC-894</a>
         encapsulation;

      o  SHOULD be able to receive <a href="rfc1042.html">RFC-1042</a> packets, intermixed with
         <a href="rfc894.html">RFC-894</a> packets; and

      o  MAY be able to send packets using <a href="rfc1042.html">RFC-1042</a> encapsulation.

   An Internet host that implements sending both the <a href="rfc894.html">RFC-894</a> and the
   <a href="rfc1042.html">RFC-1042</a> encapsulation MUST provide a configuration switch to select
   which is sent, and this switch MUST default to <a href="rfc894.html">RFC-894</a>.

   By making Ethernet encapsulation mandatory to implement for both send
   and receive, and also the default for sending, [<a href="rfc1122.html" title='"Requirements for Internet Hosts -- Communication Layers"'>RFC1122</a>] recognized
   Ethernet as the predominant encapsulation, heading off potential
   interoperability problems.





<span class="grey">Aboba, et al.                Informational                      [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc4840.html">RFC 4840</a>         Multiple Encapsulation Methods Harmful       April 2007</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/1.2.1.%20%20IEEE%20802.2%2F802.3%20LLC%20Type%201%20Encapsulation"></a><a class="selflink" href="#section-1.2.1" name="section-1.2.1">1.2.1</a>.  IEEE 802.2/802.3 LLC Type 1 Encapsulation</span>

   Prior to standardization of the IEEE 802 encapsulation in [<a href="rfc1042.html" title='"Standard for the transmission of IP datagrams over IEEE 802 networks"'>RFC1042</a>],
   an IEEE 802.2/802.3 LLC Type 1 encapsulation was specified in
   [<a href="rfc948.html" title='"Two Methods for the Transmission of IP Datagrams over IEEE 802.3 Networks"'>RFC948</a>], utilizing 6 in the Source Service Access Point (SSAP) and
   Destination Service Access Point (DSAP) fields of the IEEE 802.2
   header.  However, since the SSAP and DSAP fields are each only a
   single octet, and the Ethertype values for IP, ARP [<a href="rfc826.html" title='"Ethernet Address Resolution Protocol: Or converting network protocol addresses to 48.bit Ethernet address for transmission on Ethernet hardware"'>RFC826</a>], and RARP
   [<a href="rfc903.html" title='"A Reverse Address Resolution Protocol"'>RFC903</a>] are greater than 1500, these values cannot be represented in
   the SSAP and DSAP fields.  As a result, the encapsulation described
   in [<a href="rfc948.html" title='"Two Methods for the Transmission of IP Datagrams over IEEE 802.3 Networks"'>RFC948</a>] did not support protocols requiring distinct Ethertypes
   such as ARP or RARP, and implementations typically included support
   for alternatives to ARP such as the Probe [<a href="#ref-PROBE" title='"A Primer on HP Probe"'>PROBE</a>] protocol.  Support
   for ARP, RARP and other IP protocols utilizing distinct Ethertypes
   was addressed in [<a href="rfc1042.html" title='"Standard for the transmission of IP datagrams over IEEE 802 networks"'>RFC1042</a>], which obsoleted [<a href="rfc948.html" title='"Two Methods for the Transmission of IP Datagrams over IEEE 802.3 Networks"'>RFC948</a>]. [<a href="rfc1042.html" title='"Standard for the transmission of IP datagrams over IEEE 802 networks"'>RFC1042</a>]
   utilized the Sub-Network Access Protocol (SNAP) form of the IEEE
   802.2 Logical Link Control (LLC) with the SSAP and DSAP fields set to
   170, including support for the Ethertype field.  As noted in
   "Assigned Numbers" [<a href="rfc1010.html" title='"Assigned Numbers"'>RFC1010</a>]:

      At an ad hoc special session on "IEEE 802 Networks and ARP", held
      during the TCP Vendors Workshop (August 1986), an approach to a
      consistent way to send DoD-IP datagrams and other IP related
      protocols on 802 networks was developed.

      Due to some evolution of the IEEE 802.2 standards and the need to
      provide for a standard way to do additional DoD-IP related
      protocols (such as the Address Resolution Protocol (ARP) on IEEE
      802 network, the following new policy is established, which will
      replace the old policy (see <a href="rfc960.html">RFC 960</a> and <a href="rfc948.html">RFC 948</a> [108]).

      The new policy is for the Internet community to use the IEEE 802.2
      encapsulation on 802.3, 802.4, and 802.5 networks by using the
      SNAP with an organization code indicating that the following 16
      bits specify the EtherType code (where IP = 2048 (0800 hex), see
      Ethernet Numbers of Interest).















<span class="grey">Aboba, et al.                Informational                      [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc4840.html">RFC 4840</a>         Multiple Encapsulation Methods Harmful       April 2007</span>


                                                                  Header
       ...--------+--------+--------+
        MAC Header|      Length     |                    802.{3/4/5} MAC
       ...--------+--------+--------+

       +--------+--------+--------+
       | Dsap=K1| Ssap=K1| control|                            802.2 SAP
       +--------+--------+--------+

       +--------+--------+---------+--------+--------+
       |protocol id or org code =K2|    Ether Type   |        802.2 SNAP
       +--------+--------+---------+--------+--------+

      The total length of the SAP Header and the SNAP header is
      8-octets, making the 802.2 protocol overhead come out on a nice
      boundary.

      K1 is 170.  The IEEE likes to talk about things in little-endian
      bit transmission order and specifies this value as 01010101.  In
      big-endian order, as used in Internet specifications, this becomes
      10101010 binary, or AA hex, or 170 decimal.

      K2 is 0 (zero).

      The use of the IP LSAP (K1 = 6) is to be phased out as quickly as
      possible.

   Many of the issues involved in coexistence of the [<a href="rfc948.html" title='"Two Methods for the Transmission of IP Datagrams over IEEE 802.3 Networks"'>RFC948</a>] and
   [<a href="rfc1042.html" title='"Standard for the transmission of IP datagrams over IEEE 802 networks"'>RFC1042</a>] encapsulations are similar to those described in <a href="#section-1.2">Section</a>
   <a href="#section-1.2">1.2</a>.  For example, due to use of different SSAP/DSAP values, the
   broadcast domain might not include all hosts on the link, and a host
   would need to determine the appropriate encapsulation prior to
   sending.  However, the lack of support for ARP within the [<a href="rfc948.html" title='"Two Methods for the Transmission of IP Datagrams over IEEE 802.3 Networks"'>RFC948</a>]
   encapsulation created additional interoperability and implementation
   issues.  For example, the lack of support for ARP in [<a href="rfc948.html" title='"Two Methods for the Transmission of IP Datagrams over IEEE 802.3 Networks"'>RFC948</a>] implied
   that implementations supporting both [<a href="rfc948.html" title='"Two Methods for the Transmission of IP Datagrams over IEEE 802.3 Networks"'>RFC948</a>] and [<a href="rfc894.html" title='"A Standard for the Transmission of IP Datagrams over Ethernet Networks"'>RFC894</a>] or
   [<a href="rfc1042.html" title='"Standard for the transmission of IP datagrams over IEEE 802 networks"'>RFC1042</a>] encapsulations would need to implement both ARP and an
   alternative address resolution mechanism such as Probe.  Also, since
   the address resolution mechanism for [<a href="rfc948.html" title='"Two Methods for the Transmission of IP Datagrams over IEEE 802.3 Networks"'>RFC948</a>] implementations was not
   standardized, interoperability problems would likely have arisen had
   [<a href="rfc948.html" title='"Two Methods for the Transmission of IP Datagrams over IEEE 802.3 Networks"'>RFC948</a>] been widely implemented.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/1.2.2.%20%20Trailer%20Encapsulation"></a><a class="selflink" href="#section-1.2.2" name="section-1.2.2">1.2.2</a>.  Trailer Encapsulation</span>

   As noted in "Trailer Encapsulations" [<a href="rfc893.html" title='"Trailer encapsulations"'>RFC893</a>], trailer encapsulation
   was an optimization developed to minimize memory-to-memory copies on
   reception.  By placing variable-length IP and transport headers at
   the end of the packet, page alignment of data could be more easily



<span class="grey">Aboba, et al.                Informational                      [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc4840.html">RFC 4840</a>         Multiple Encapsulation Methods Harmful       April 2007</span>


   maintained.  Trailers were implemented in 4.2 Berkeley System
   Distribution (BSD), among others.  While, in theory, trailer
   encapsulation could have been applied to the Ethernet [<a href="rfc894.html" title='"A Standard for the Transmission of IP Datagrams over Ethernet Networks"'>RFC894</a>] or
   IEEE 802 [<a href="rfc1042.html" title='"Standard for the transmission of IP datagrams over IEEE 802 networks"'>RFC1042</a>] encapsulations (creating four potential
   encapsulations of IP!), in practice, trailer encapsulation was only
   supported for Ethernet.  A separate Ethertype was utilized in order
   to enable IP packets in trailer encapsulation to be distinguished
   from [<a href="rfc894.html" title='"A Standard for the Transmission of IP Datagrams over Ethernet Networks"'>RFC894</a>] encapsulation.  Since the [<a href="rfc948.html" title='"Two Methods for the Transmission of IP Datagrams over IEEE 802.3 Networks"'>RFC948</a>] encapsulation did
   not support the Ethertype field (or ARP), this mechanism could not
   have been used in [<a href="rfc948.html" title='"Two Methods for the Transmission of IP Datagrams over IEEE 802.3 Networks"'>RFC948</a>] implementations.

   <a href="rfc1122.html#section-2.3.1">[RFC1122], Section 2.3.1</a>, described the issues with trailer
   encapsulation:

      DISCUSSION

         The trailer protocol is a link-layer encapsulation technique
         that rearranges the data contents of packets sent on the
         physical network.  In some cases, trailers improve the
         throughput of higher layer protocols by reducing the amount of
         data copying within the operating system.  Higher layer
         protocols are unaware of trailer use, but both the sending and
         receiving host MUST understand the protocol if it is used.
         Improper use of trailers can result in very confusing symptoms.
         Only packets with specific size attributes are encapsulated
         using trailers, and typically only a small fraction of the
         packets being exchanged have these attributes.  Thus, if a
         system using trailers exchanges packets with a system that does
         not, some packets disappear into a black hole while others are
         delivered successfully.

      IMPLEMENTATION:

         On an Ethernet, packets encapsulated with trailers use a
         distinct Ethernet type [<a href="rfc893.html" title='"Trailer encapsulations"'>RFC893</a>], and trailer negotiation is
         performed at the time that ARP is used to discover the link-
         layer address of a destination system.

         Specifically, the ARP exchange is completed in the usual manner
         using the normal IP protocol type, but a host that wants to
         speak trailers will send an additional "trailer ARP reply"
         packet, i.e., an ARP reply that specifies the trailer
         encapsulation protocol type but otherwise has the format of a
         normal ARP reply.  If a host configured to use trailers
         receives a trailer ARP reply message from a remote machine, it
         can add that machine to the list of machines that understand
         trailers, e.g., by marking the corresponding entry in the ARP
         cache.



<span class="grey">Aboba, et al.                Informational                      [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc4840.html">RFC 4840</a>         Multiple Encapsulation Methods Harmful       April 2007</span>


         Hosts wishing to receive trailers send trailer ARP replies
         whenever they complete exchanges of normal ARP messages for IP.
         Thus, a host that received an ARP request for its IP protocol
         address would send a trailer ARP reply in addition to the
         normal IP ARP reply; a host that sent the IP ARP request would
         send a trailer ARP reply when it received the corresponding IP
         ARP reply.  In this way, either the requesting or responding
         host in an IP ARP exchange may request that it receive
         trailers.

         This scheme, using extra trailer ARP reply packets rather than
         sending an ARP request for the trailer protocol type, was
         designed to avoid a continuous exchange of ARP packets with a
         misbehaving host that, contrary to any specification or common
         sense, responded to an ARP reply for trailers with another ARP
         reply for IP.  This problem is avoided by sending a trailer ARP
         reply in response to an IP ARP reply only when the IP ARP reply
         answers an outstanding request; this is true when the hardware
         address for the host is still unknown when the IP ARP reply is
         received.  A trailer ARP reply may always be sent along with an
         IP ARP reply responding to an IP ARP request.

   Since trailer encapsulation negotiation depends on ARP, it can only
   be used where all hosts on the link are within the same broadcast
   domain.  It was assumed that all hosts supported sending and
   receiving ARP packets in standard Ethernet encapsulation [<a href="rfc894.html" title='"A Standard for the Transmission of IP Datagrams over Ethernet Networks"'>RFC894</a>], so
   that negotiation between Ethernet and IEEE 802 encapsulations was not
   required, only negotiation between standard Ethernet [<a href="rfc894.html" title='"A Standard for the Transmission of IP Datagrams over Ethernet Networks"'>RFC894</a>] and
   trailer [<a href="rfc893.html" title='"Trailer encapsulations"'>RFC893</a>] encapsulation.  Had hosts supporting trailer
   encapsulation also supported one or more IEEE 802 framing mechanisms,
   the negotiation would have been complicated still further.  For
   example, since [<a href="rfc948.html" title='"Two Methods for the Transmission of IP Datagrams over IEEE 802.3 Networks"'>RFC948</a>] implementations did not support the Ethertype
   field or ARP, the trailer negotiation mechanism could not have been
   utilized, and additional difficulty would have been encountered in
   distinguishing trailer encapsulated data frames from normally
   encapsulated frames.

   <a href="rfc1122.html#section-2.3.1">[RFC1122], Section 2.3.1</a>, provided the following guidance for use of
   trailer encapsulation:

      The trailer protocol for link-layer encapsulation MAY be used, but
      only when it has been verified that both systems (host or gateway)
      involved in the link-layer communication implement trailers.  If
      the system does not dynamically negotiate use of the trailer
      protocol on a per-destination basis, the default configuration
      MUST disable the protocol.





<span class="grey">Aboba, et al.                Informational                      [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc4840.html">RFC 4840</a>         Multiple Encapsulation Methods Harmful       April 2007</span>


   4.2BSD did not support dynamic negotiation, only configuration of
   trailer encapsulation at boot time, and therefore [<a href="rfc1122.html" title='"Requirements for Internet Hosts -- Communication Layers"'>RFC1122</a>] required
   that the trailer encapsulation be disabled by default on those
   systems.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.3.%20%20PPP%20Experience"></a><a class="selflink" href="#section-1.3" name="section-1.3">1.3</a>.  PPP Experience</span>

   PPP can support both encapsulation of IEEE 802 frames as defined in
   [<a href="rfc3518.html" title='"Point- to-Point Protocol (PPP) Bridging Control Protocol (BCP)"'>RFC3518</a>], as well as IPv4 and IPv6 [<a href="rfc2472.html" title='"IP Version 6 over PPP"'>RFC2472</a>] packets.  Multiple
   compression schemes are also supported.

   In addition to PPP Data Link Layer (DLL) protocol numbers allocated
   for IPv4 (0x0021), IPv6 (0x0057), and Bridging PDU (0x0031), the
   following codepoints have been assigned:

   o  two for RObust Header Compression (ROHC) [<a href="rfc3095.html">RFC3095</a>]:
      ROHC small-CID (0x0003) and ROHC large-CID (0x0005)

   o  two for Van Jacobson compression [<a href="rfc1144.html" title='"Compressing TCP/IP Headers for Low-Speed Serial Links"'>RFC1144</a>]:
      Compressed TCP/IP (0x002d) and Uncompressed TCP/IP (002f)

   o  one for IPv6 Header Compression [<a href="rfc2507.html" title='"IP Header Compression"'>RFC2507</a>]: (0x004f)

   o  nine for RTP IP Header Compression [<a href="rfc3544.html" title='"IP Header Compression over PPP"'>RFC3544</a>]:
      Full Header (0x0061), Compressed TCP (0x0063), Compressed Non TCP
      (0x0065), UDP 8 (0x0067), RTP 8 (0x0069), Compressed TCP No Delta
      (0x2063), Context State (0x2065), UDP 16 (0x2067), and RTP 16
      (0x2069)

   Although PPP can encapsulate IP packets in multiple ways, typically
   multiple encapsulation schemes are not operational on the same link,
   and therefore the issues described in this document rarely arise.
   For example, while PPP can support both encapsulation of IEEE 802
   frames as defined in [<a href="rfc3518.html" title='"Point- to-Point Protocol (PPP) Bridging Control Protocol (BCP)"'>RFC3518</a>], as well as IPv4 and IPv6 [<a href="rfc2472.html" title='"IP Version 6 over PPP"'>RFC2472</a>]
   packets, in practice, multiple encapsulation mechanisms are not
   operational on the same link.  Similarly, only a single compression
   scheme is typically negotiated for use on a link.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.4.%20%20Potential%20Mitigations"></a><a class="selflink" href="#section-1.4" name="section-1.4">1.4</a>.  Potential Mitigations</span>

   In order to mitigate problems arising from multiple encapsulation
   methods, it may be possible to use switches [<a href="#ref-IEEE-802.1D.2004" title='"Information technology - Telecommunications and information exchange between systems - Local area networks - Media access control (MAC) bridges"'>IEEE-802.1D.2004</a>] or
   routers, or to attempt to negotiate the encapsulation method to be
   used.  As described below, neither approach may be completely
   satisfactory.






<span class="grey">Aboba, et al.                Informational                     [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc4840.html">RFC 4840</a>         Multiple Encapsulation Methods Harmful       April 2007</span>


   The use of switches or routers to enable communication between hosts
   utilizing multiple encapsulation methods is not a panacea.  If
   separate unicast prefixes are used for each encapsulation, then the
   choice of encapsulation can be determined from the routing table.  If
   the same unicast prefix is used for each encapsulation method, it is
   necessary to keep state for each destination host.  However, this may
   not work in situations where hosts using different encapsulations
   respond to the same anycast address.

   In situations where multiple encapsulation methods are enabled on a
   single link, negotiation may be supported to allow hosts to determine
   how to encapsulate a packet for a particular destination host.

   Negotiating the encapsulation above the link layer is potentially
   problematic since the negotiation itself may need to be carried out
   using multiple encapsulations.  In theory, it is possible to
   negotiate an encapsulation method by sending negotiation packets over
   all encapsulation methods supported, and keeping state for each
   destination host.  However, if the encapsulation method must be
   dynamically negotiated for each new on-link destination,
   communication to new destinations may be delayed.  If most
   communication is short, and the negotiation requires an extra round
   trip beyond link-layer address resolution, this can become a
   noticeable factor in performance.  Also, the negotiation may result
   in consumption of additional bandwidth.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Evaluation%20of%20Arguments%20for%20Multiple%20Encapsulations"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Evaluation of Arguments for Multiple Encapsulations</span>

   There are several reasons often given in support of multiple
   encapsulation methods.  We discuss each in turn, below.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.1.%20%20Efficiency"></a><a class="selflink" href="#section-2.1" name="section-2.1">2.1</a>.  Efficiency</span>

   Claim: Multiple encapsulation methods allow for greater efficiency.
   For example, it has been argued that IEEE 802 or Ethernet
   encapsulation of IP results in excessive overhead due to the size of
   the data frame headers, and that this can adversely affect
   performance on wireless networks, particularly in situations where
   support of Voice over IP (VoIP) is required.

   Discussion: Even where these performance concerns are valid,
   solutions exist that do not require defining multiple IP
   encapsulation methods.  For example, links may support Ethernet frame
   compression so that Ethernet Source and Destination Address fields
   are not sent with every packet.

   It is possible for link layers to negotiate compression without
   requiring higher-layer awareness; the Point-to-Point Protocol (PPP)



<span class="grey">Aboba, et al.                Informational                     [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc4840.html">RFC 4840</a>         Multiple Encapsulation Methods Harmful       April 2007</span>


   [<a id="ref-RFC1661" name="ref-RFC1661">RFC1661</a>] is an example.  "The PPP Compression Control Protocol
   (CCP)" [<a href="rfc1962.html" title='"The PPP Compression Control Protocol (CCP)"'>RFC1962</a>] enables negotiation of data compression mechanisms,
   and "Robust Header Compression (ROHC) over PPP" [<a href="rfc3241.html" title='"Robust Header Compression (ROHC) over PPP"'>RFC3241</a>] and "IP
   Header Compression over PPP" [<a href="rfc3544.html" title='"IP Header Compression over PPP"'>RFC3544</a>] enable negotiation of header
   compression, without Internet-layer awareness.  Any frame can be
   "decompressed" based on the content of the frame, and prior state
   based on previous control messages or data frames.  Use of
   compression is a good way to solve the efficiency problem without
   introducing problems at higher layers.

   There are also situations in which use of multiple encapsulations can
   degrade performance or result in packet loss.  The use of multiple
   encapsulation methods with differing Maximum Transfer Units (MTUs)
   can result in differing MTUs for on-link destinations.  If the link-
   layer protocol does not provide per-destination MTUs to the IP layer,
   it will need to use a default MTU; to avoid fragmentation, this must
   be less than or equal to the minimum MTU of on-link destinations.  If
   the default MTU is too low, the full bandwidth may not be achievable.
   If the default MTU is too high, packet loss will result unless or
   until IP Path MTU Discovery is used to discover the correct MTU.

   Recommendation: Where encapsulation is an efficiency issue, use
   header compression.  Where the encapsulation method or the use of
   compression must be negotiated, negotiation should either be part of
   bringing up the link, or be piggybacked in the link-layer address
   resolution exchange; only a single compression scheme should be
   negotiated on a link.  Where the MTU may vary among destinations on
   the same link, the link-layer protocol should provide a per-
   destination MTU to IP.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.2.%20%20Multicast%2FBroadcast"></a><a class="selflink" href="#section-2.2" name="section-2.2">2.2</a>.  Multicast/Broadcast</span>

   Claim: Support for Ethernet encapsulation requires layer 2 support
   for distribution of IP multicast/broadcast packets.  In situations
   where this is difficult, support for Ethernet is problematic and
   other encapsulations are necessary.

   Discussion: Irrespective of the encapsulation used, IP packets sent
   to multicast (IPv4/IPv6) or broadcast (IPv4) addresses need to reach
   all potential on-link receivers.  Use of alternative encapsulations
   cannot remove this requirement, although there is considerable
   flexibility in how it can be met.  Non-Broadcast Multiple Access
   (NBMA) networks can still support the broadcast/multicast service via
   replication of unicast frames.

   Techniques are also available for improving the efficiency of IP
   multicast/broadcast delivery in wireless networks.  In order to be
   receivable by any host within listening range, an IP



<span class="grey">Aboba, et al.                Informational                     [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc4840.html">RFC 4840</a>         Multiple Encapsulation Methods Harmful       April 2007</span>


   multicast/broadcast packet sent as link-layer multicast/broadcast
   over a wireless link needs to be sent at the lowest rate supported by
   listeners.  If the sender does not keep track of the rates negotiated
   by group listeners, by default, multicast/broadcast traffic is sent
   at the lowest supported rate, resulting in increased overhead.
   However, a sender can also deliver an IP multicast/broadcast packet
   using unicast frame(s) where this would be more efficient.  For
   example, in IEEE 802.11, multicast/broadcast traffic sent from the
   Station (STA) to the Access Point (AP) is always sent as unicast, and
   the AP tracks the negotiated rate for each STA, so that it can send
   unicast frames at a rate appropriate for each station.

   In order to limit the propagation of link-scope multicast or
   broadcast traffic, it is possible to assign a separate prefix to each
   host.

   Unlike broadcasts, which are received by all hosts on the link
   regardless of the protocol they are running, multicasts only need be
   received by those hosts belonging to the multicast group.  In wired
   networks, it is possible to avoid forwarding multicast traffic on
   switch ports without group members, by snooping of Internet Group
   Management Protocol (IGMP) and Multicast Listener Discovery (MLD)
   traffic as described in "Considerations for IGMP and MLD Snooping
   Switches" [<a href="rfc4541.html" title='"Considerations for Internet Group Management Protocol (IGMP) and Multicast Listener Discovery (MLD) Snooping Switches"'>RFC4541</a>].

   In wireless media where data rates to specific destinations are
   negotiated and may vary over a wide range, it may be more efficient
   to send multiple frames via link-layer unicast than to send a single
   multicast/broadcast frame.  For example, in [<a href="#ref-IEEE-802.11.2003" title='"Wireless LAN Medium Access Control (MAC) and Physical Layer (PHY) Specifications"'>IEEE-802.11.2003</a>]
   multicast/broadcast traffic from the client station (STA) to the
   Access Point (AP) is sent via link-layer unicast.

   Recommendation: Where support for link-layer multicast/broadcast is
   problematic, limit the propagation of link-scope multicast and
   broadcast traffic by assignment of separate prefixes to hosts.  In
   some circumstances, it may be more efficient to distribute
   multicast/broadcast traffic as multiple link-layer unicast frames.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.3.%20%20Multiple%20Uses"></a><a class="selflink" href="#section-2.3" name="section-2.3">2.3</a>.  Multiple Uses</span>

   Claim: No single encapsulation is optimal for all purposes.
   Therefore, where a link layer is utilized in disparate scenarios
   (such as both fixed and mobile deployments), multiple encapsulations
   are a practical requirement.

   Discussion: "Architectural Principles of the Internet" [<a href="rfc1958.html" title='"Architectural Principles of the Internet"'>RFC1958</a>],
   point 3.2, states:




<span class="grey">Aboba, et al.                Informational                     [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc4840.html">RFC 4840</a>         Multiple Encapsulation Methods Harmful       April 2007</span>


      If there are several ways of doing the same thing, choose one.  If
      a previous design, in the Internet context or elsewhere, has
      successfully solved the same problem, choose the same solution
      unless there is a good technical reason not to.  Duplication of
      the same protocol functionality should be avoided as far as
      possible, without of course using this argument to reject
      improvements.

   Existing encapsulations have proven themselves capable of supporting
   disparate usage scenarios.  For example, the Point-to-Point Protocol
   (PPP) has been utilized by wireless link layers such as General
   Packet Radio Service (GPRS), as well as in wired networks in
   applications such as "PPP over SONET/SDH" [<a href="rfc2615.html" title='"PPP over SONET/SDH"'>RFC2615</a>].  PPP can even
   support bridging, as described in "Point-to-Point Protocol (PPP)
   Bridging Control Protocol (BCP)" [<a href="rfc3518.html" title='"Point- to-Point Protocol (PPP) Bridging Control Protocol (BCP)"'>RFC3518</a>].

   Similarly, Ethernet encapsulation has been used in wired networks as
   well as Wireless Local Area Networks (WLANs) such as IEEE 802.11
   [<a href="#ref-IEEE-802.11.2003" title='"Wireless LAN Medium Access Control (MAC) and Physical Layer (PHY) Specifications"'>IEEE-802.11.2003</a>].  Ethernet can also support Virtual LANs (VLANs)
   and Quality of Service (QoS) [<a href="#ref-IEEE-802.1Q.2003" title="P802.1Q-2003">IEEE-802.1Q.2003</a>].

   Therefore, disparate usage scenarios can be addressed by choosing a
   single encapsulation, rather than multiple encapsulations.  Where an
   existing encapsulation is suitable, this is preferable to creating a
   new encapsulation.

   Where encapsulations other than IP over Point-to-Point Protocol (PPP)
   [<a href="rfc1661.html" title='"The Point-to-Point Protocol (PPP)"'>RFC1661</a>], Ethernet, or IEEE 802 are supported, difficulties in
   operating system integration can lead to interoperability problems.

   In order to take advantage of operating system support for IP
   encapsulation over PPP, Ethernet, or IEEE 802, it may be tempting for
   a driver supporting an alternative encapsulation to emulate PPP,
   Ethernet, or IEEE 802 support.  Typically, PPP emulation requires
   that the driver implement PPP, enabling translation of PPP control
   and data frames to the equivalent native facilities.  Similarly,
   Ethernet or IEEE 802 emulation typically requires that the driver
   implement Dynamic Host Configuration Protocol (DHCP) v4 or v6, Router
   Solicitation/Router Advertisement (RS/RA), Address Resolution
   Protocol (ARP), or IPv6 Neighbor Discovery (ND) in order to enable
   translation of these frames to and from native facilities.

   Where drivers are implemented in kernel mode, the work required to
   provide faithful emulation may be substantial.  This creates the
   temptation to cut corners, potentially resulting in interoperability
   problems.





<span class="grey">Aboba, et al.                Informational                     [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc4840.html">RFC 4840</a>         Multiple Encapsulation Methods Harmful       April 2007</span>


   For example, it might be tempting for driver implementations to
   neglect IPv6 support.  A driver emulating PPP might support only IP
   Control Protocol (IPCP), but not IPCPv6; a driver emulating Ethernet
   or IEEE 802 might support only DHCPv4 and ARP, but not DHCPv6, RS/RA,
   or ND.  As a result, an IPv6 host connecting to a network supporting
   IPv6 might find itself unable to use IPv6 due to lack of driver
   support.

   Recommendation: Support a single existing encapsulation where
   possible.  Emulation of PPP, Ethernet, or IEEE 802 on top of
   alternative encapsulations should be avoided.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Additional%20Issues"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Additional Issues</span>

   There are a number of additional issues arising from use of multiple
   encapsulation methods, as hinted at in <a href="#section-1">Section 1</a>.  We discuss each of
   these below.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.1.%20%20Generality"></a><a class="selflink" href="#section-3.1" name="section-3.1">3.1</a>.  Generality</span>

   Link-layer protocols such as [<a href="#ref-IEEE-802.1A.1990" title='"Local Area Networks and Metropolitan Area Networks: Overview and Architecture of Network Standards"'>IEEE-802.1A.1990</a>] and [<a href="#ref-DIX" title='"The Ethernet -- A Local Area Network: Data Link Layer and Physical Layer (Version 2.0)"'>DIX</a>] inherently
   support the ability to add support for a new packet type without
   modification to the link-layer protocol.

   IEEE 802.16 [<a href="#ref-IEEE-802.16.2004" title='"Information technology - Telecommunications and information exchange between systems - Local and metropolitan area networks, Part 16: Air Interface for Fixed Broadband Wireless Access Systems"'>IEEE-802.16.2004</a>] splits the Media Access Control (MAC)
   layer into a number of sublayers.  For the uppermost of these, the
   standard defines the concept of a service-specific Convergence
   Sublayer (CS).  The two underlying sublayers (the MAC Common Part
   Sublayer and the Security Sublayer) provide common services for all
   instantiations of the CS.

   While [<a href="#ref-IEEE-802.16.2004" title='"Information technology - Telecommunications and information exchange between systems - Local and metropolitan area networks, Part 16: Air Interface for Fixed Broadband Wireless Access Systems"'>IEEE-802.16.2004</a>] defined support for the Asynchronous
   Transfer Mode (ATM) CS and the Packet CS for raw IPv4, raw IPv6, and
   Ethernet with a choice of six different classifiers,
   [<a href="#ref-IEEE-802.16e.2005" title='"Information technology - Telecommunications and information exchange between systems - Local and Metropolitan Area Networks - Part 16: Air Interface for Fixed and Mobile Broadband Wireless Access Systems, Amendment for Physical and Medium Access Control Layers for Combined Fixed and Mobile Operation in Licensed Bands"'>IEEE-802.16e.2005</a>] added support for raw and Ethernet-framed ROHC
   Enhanced Compressed RTP (ECRTP) compressed packets.  As a result,
   [<a href="#ref-IEEE-802.16e.2005" title='"Information technology - Telecommunications and information exchange between systems - Local and Metropolitan Area Networks - Part 16: Air Interface for Fixed and Mobile Broadband Wireless Access Systems, Amendment for Physical and Medium Access Control Layers for Combined Fixed and Mobile Operation in Licensed Bands"'>IEEE-802.16e.2005</a>] defines the ATM CS and multiple versions of the
   Packet CS for the transmission of raw IPv4, raw IPv6, 802.3/Ethernet,
   802.1Q VLAN, IPv4 over 802.3/Ethernet, IPv6 over 802.3/Ethernet, IPv4
   over 802.1Q VLAN, IPv6 over 802.1Q VLAN, raw ROHC-compressed packets,
   raw ECRTP-compressed packets, ROHC-compressed packets over
   802.3/Ethernet. and ECRTP-compressed packets over 802.3/Ethernet.

   As noted in [<a href="#ref-Generic" title='"A Generic Packet Convergence Sublayer (GPCS) for Supporting Multiple Protocols over 802.16 Air Interface"'>Generic</a>], [<a href="#ref-IEEE-802.16.2004" title='"Information technology - Telecommunications and information exchange between systems - Local and metropolitan area networks, Part 16: Air Interface for Fixed Broadband Wireless Access Systems"'>IEEE-802.16.2004</a>] appears to imply that the
   standard will need to be modified to support new packet types:






<span class="grey">Aboba, et al.                Informational                     [Page 15]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc4840.html">RFC 4840</a>         Multiple Encapsulation Methods Harmful       April 2007</span>


      We are concerned that the 802.16 protocol cannot easily be
      extendable to transport new protocols over the 802.16 air
      interface.  It would appear that a Convergence Sublayer is needed
      for every type of protocol transported over the 802.16 MAC.  Every
      time a new protocol type needs to be transported over the 802.16
      air interface, the 802.16 standard needs to be modified to define
      a new CS type.  We need to have a generic Packet Convergence
      Sublayer that can support multi-protocols and which does not
      require further modification to the 802.16 standard to support new
      protocols.  We believe that this was the original intention of the
      Packet CS.  Furthermore, we believe it is difficult for the
      industry to agree on a set of CS's that all devices must implement
      to claim "compliance".

   The use of IP and/or upper-layer protocol specific classification and
   encapsulation methods, rather than a 'neutral' general purpose
   encapsulation, may give rise to a number of undesirable effects
   explored in the following subsections.

   If the link layer does not provide a general purpose encapsulation
   method, deployment of new IP and/or upper-layer protocols will be
   dependent on deployment of the corresponding new encapsulation
   support in the link layer.

   Even if a single encapsulation method is used, problems can still
   occur if demultiplexing of ARP, IPv4, IPv6, and any other protocols
   in use, is not supported at the link layer.  While it is possible to
   demultiplex such packets based on the Version field (first four bits
   on the packet), this assumes that IPv4-only implementations will be
   able to properly handle IPv6 packets.  As a result, a more robust
   design is to demultiplex protocols in the link layer, such as by
   assigning a different protocol type, as is done in IEEE 802 media
   where a Type of 0x0800 is used for IPv4, and 0x86DD for IPv6.

   Recommendations: Link-layer protocols should enable network packets
   (IPv4, IPv6, ARP, etc.) to be demultiplexed in the link layer.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.2.%20%20Layer%20Interdependence"></a><a class="selflink" href="#section-3.2" name="section-3.2">3.2</a>.  Layer Interdependence</span>

   Within IEEE 802.16, the process by which frames are selected for
   transmission on a connection identifier (CID) is known as
   "classification".  Fields in the Ethernet, IP, and UDP/TCP headers
   can be used for classification; for a particular CS, a defined subset
   of header fields may be applied for that purpose.

   Utilizing IP and/or upper layer headers in link-layer classification
   will almost inevitably lead to interdependencies between link-layer
   and upper-layer specifications.  Although this might appear to be



<span class="grey">Aboba, et al.                Informational                     [Page 16]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc4840.html">RFC 4840</a>         Multiple Encapsulation Methods Harmful       April 2007</span>


   desirable in terms of providing a highly specific (and hence
   interoperable) mapping between the capabilities provided by the link
   layer (e.g., quality-of-service support) and those that are needed by
   upper layers, this sort of capability is probably better provided by
   a more comprehensive service interface (Application Programming
   Interface) in conjunction with a single encapsulation mechanism.

   IPv6, in particular, provides an extensible header system.  An
   upper-layer-specific classification scheme would still have to
   provide a degree of generality in order to cope with future
   extensions of IPv6 that might wish to make use of some of the link
   layer services already provided.

   Recommendations: Upper-layer-specific classification schemes should
   be avoided.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.3.%20%20Inspection%20of%20Payload%20Contents"></a><a class="selflink" href="#section-3.3" name="section-3.3">3.3</a>.  Inspection of Payload Contents</span>

   If a classification scheme utilizing higher-layer headers proposes to
   inspect the contents of the packet being encapsulated (e.g., IEEE
   802.16 IP CS mechanisms for determining the connection identifier
   (CID) to use to transmit a packet), the fields available for
   inspection may be limited if the packet is compressed or encrypted
   before passing to the link layer.  This may prevent the link layer
   from utilizing existing compression mechanisms, such as Van Jacobson
   Compression [<a href="rfc1144.html" title='"Compressing TCP/IP Headers for Low-Speed Serial Links"'>RFC1144</a>], ROHC [<a href="rfc3095.html">RFC3095</a>][RFC3759], Compressed RTP (CRTP)
   [<a href="rfc2508.html" title='"Compressing IP/UDP/RTP Headers for Low-Speed Serial Links"'>RFC2508</a>], Enhanced Compressed RTP (ECRTP) [<a href="rfc3545.html" title='"Enhanced Compressed RTP (CRTP) for Links with High Delay, Packet Loss and Reordering"'>RFC3545</a>], or IP Header
   Compression [<a href="rfc2507.html" title='"IP Header Compression"'>RFC2507</a>].

   Recommendations: Link-layer classification schemes should not rely on
   the contents of higher-layer headers.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.4.%20%20Interoperability%20Guidance"></a><a class="selflink" href="#section-3.4" name="section-3.4">3.4</a>.  Interoperability Guidance</span>

   In situations where multiple encapsulation methods are operational
   and capable of carrying IP traffic, interoperability problems are
   possible in the absence of clear implementation guidelines.  For
   example, there is no guarantee that other hosts on the link will
   support the same set of encapsulation methods, or that if they do,
   that their routing tables will result in identical preferences.

   In IEEE 802.16, the Subscriber Station (SS) indicates the Convergence
   Sublayers it supports to the Base Station (BS), which selects from
   the list one or more that it will support on the link.  Therefore, it
   is possible for multiple CSes to be operational.

   Note that IEEE 802.16 does not provide multiple encapsulation methods
   for the same kind of data payload; it defines exactly one



<span class="grey">Aboba, et al.                Informational                     [Page 17]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc4840.html">RFC 4840</a>         Multiple Encapsulation Methods Harmful       April 2007</span>


   encapsulation scheme for each data payload.  For example, there is
   one way to encapsulate a raw IPv4 packet into an IEEE 802.16 MAC
   frame, one encapsulation scheme for a raw IPv6 packet, etc.  There is
   also one way to encapsulate an Ethernet frame, even when there are
   multiple possibilities for classifying an Ethernet frame for
   forwarding over a connection identifier (CID).  Since support for
   multiple CSes enables IEEE 802.16 to encapsulate layer 2 frames as
   well as layer 3 packets, IP packets may be directly encapsulated in
   IEEE 802.16 MAC frames as well as framed with Ethernet headers in
   IEEE 802.16 MAC frames.  Where CSes supporting both layer 2 frames as
   well as layer 3 packets are operational on the same link, a number of
   issues may arise, including:

   Use of Address Resolution Protocol (ARP)
      Where both IPv4 CS and Ethernet CS are operational on the same
      link, it may not be obvious how address resolution should be
      implemented.  For example, should an ARP frame be encapsulated
      over the Ethernet CS, or should alternative mechanisms be used for
      address resolution, utilizing the IPv4 CS?

   Data Frame Encapsulation
      When sending an IP packet, which CS should be used?  Where
      multiple encapsulations are operational, multiple connection
      identifiers (CIDs) will also be present.  The issue can therefore
      be treated as a multi-homing problem, with each CID constituting
      its own interface.  Since a given CID may have associated
      bandwidth or quality-of-service constraints, routing metrics could
      be adjusted to take this into account, allowing the routing layer
      to choose based on which CID (and encapsulation) appears more
      attractive.

   This could lead to interoperability problems or routing asymmetry.
   For example, consider the effects on IPv6 Neighbor Discovery:

   (a)  If hosts choose to send IPv6 Neighbor Discovery traffic on
        different CSes, it is possible that a host sending an IPv6
        Neighbor Discovery packet will not receive a reply, even though
        the target host is reachable over another CS.

   (b)  Where hosts all support the same set of CSes, but have different
        routing preferences, it is possible for a host to send an IPv6
        Neighbor Discovery packet over one CS and receive a reply over
        another CS.

   Recommendations: Given these issues, it is strongly recommended that
   only a single kind of CS supporting a single encapsulation method
   should be usable on a particular link.




<span class="grey">Aboba, et al.                Informational                     [Page 18]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-19" id="page-19" name="page-19"> </a>
<span class="grey"><a href="rfc4840.html">RFC 4840</a>         Multiple Encapsulation Methods Harmful       April 2007</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.5.%20%20Service%20Consistency"></a><a class="selflink" href="#section-3.5" name="section-3.5">3.5</a>.  Service Consistency</span>

   If a link-layer protocol provides multiple encapsulation methods, the
   services offered to the IP-layer and upper-layer protocols may differ
   qualitatively between the different encapsulation methods.  For
   example, the 802.16 [<a href="#ref-IEEE-802.16.2004" title='"Information technology - Telecommunications and information exchange between systems - Local and metropolitan area networks, Part 16: Air Interface for Fixed Broadband Wireless Access Systems"'>IEEE-802.16.2004</a>] link-layer protocol offers
   both 'native' encapsulation for raw IPv4 and IPv6 packets, and
   Ethernet encapsulation.  In the raw case, the IP layer can be
   directly mapped to the quality-of-service (QoS) capabilities of the
   IEEE 802.16 transmission channels, whereas using the Ethernet
   encapsulation, an IP-over-Ethernet CS has to be deployed to
   circumvent the mapping of the IP QoS to the Ethernet header fields to
   avoid the limitations of Ethernet QoS.  Consequently, the service
   offered to an application depends on the classification method
   employed and may be inconsistent between sessions.  This may be
   confusing for the user and the application.

   Recommendations: If multiple encapsulation methods for IP packets on
   a single link-layer technology are deemed to be necessary, care
   should be taken to match the services available between encapsulation
   methods as closely as possible.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.6.%20%20Implementation%20Complexity"></a><a class="selflink" href="#section-3.6" name="section-3.6">3.6</a>.  Implementation Complexity</span>

   Support of multiple encapsulation methods results in additional
   implementation complexity.  Lack of uniform encapsulation support
   also results in potential interoperability problems.  To avoid
   interoperability issues, devices with limited resources may be
   required to implement multiple encapsulation mechanisms, which may
   not be practical.

   When encapsulation methods require hardware support, implementations
   may choose to support different encapsulation sets, resulting in
   market fragmentation.  This can prevent users from benefiting from
   economies of scale, precluding some uses of the technology entirely.

   Recommendations: Choose a single encapsulation mechanism that is
   mandatory to implement for both sending and receiving, and make that
   encapsulation mechanism the default for sending.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.7.%20%20Negotiation"></a><a class="selflink" href="#section-3.7" name="section-3.7">3.7</a>.  Negotiation</span>

   The complexity of negotiation within ARP or IP can be reduced by
   performing encapsulation negotiation within the link layer.

   However, unless the link layer allows the negotiation of the
   encapsulation between any two hosts, interoperability problems can
   still result if more than one encapsulation is possible on a given



<span class="grey">Aboba, et al.                Informational                     [Page 19]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-20" id="page-20" name="page-20"> </a>
<span class="grey"><a href="rfc4840.html">RFC 4840</a>         Multiple Encapsulation Methods Harmful       April 2007</span>


   link.  In general, a host cannot assume that all other hosts on a
   link support the same set of encapsulation methods, so that unless a
   link-layer protocol only supports point-to-point communication,
   negotiation of multiple potential encapsulation methods will be
   problematic.  To avoid this problem, it is desirable for link-layer
   encapsulation negotiation to determine a single IP encapsulation, not
   merely to indicate which encapsulation methods are possible.

   Recommendations: Encapsulation negotiation is best handled in the
   link layer.  In order to avoid dependencies on the data frame
   encapsulation mechanism, it is preferable for the negotiation to be
   carried out using management frames, if they are supported.  If
   multiple encapsulations are required and negotiation is provided,
   then the negotiation should result in a single encapsulation method
   being negotiated on the link.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.8.%20%20Roaming"></a><a class="selflink" href="#section-3.8" name="section-3.8">3.8</a>.  Roaming</span>

   Where a mobile node roams between base stations or to a fixed
   infrastructure, and the base stations and fixed infrastructure do not
   all support the same set of encapsulations, then it may be necessary
   to alter the encapsulation method, potentially in mid-conversation.
   Even if the change can be handled seamlessly at the link and IP layer
   so that applications are not affected, unless the services offered
   over the different encapsulations are equivalent (see <a href="#section-3.5">Section 3.5</a>),
   the service experienced by the application may change as the mobile
   node crosses boundaries.  If the service is significantly different,
   it might even require 'in-flight' renegotiation, which most
   applications are not equipped to manage.

   Recommendations: Ensure uniformity of the encapsulation set
   (preferably only a single encapsulation) within a given mobile
   domain, between mobile domains, and between mobile domains and fixed
   infrastructure.  If a link layer protocol offers multiple
   encapsulation methods for IP packets, it is strongly recommended that
   only one of these encapsulation methods should be in use on any given
   link or within a single wireless transmission domain.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Security%20Considerations"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Security Considerations</span>

   The use of multiple encapsulation methods does not appear to have
   significant security implications.

   An attacker might be able to utilize an encapsulation method that was
   not in normal use on a link to cause a denial-of-service attack,
   which would exhaust the processing resources of interfaces if packets
   utilizing this encapsulation were passed up the stack to any
   significant degree before being discarded.



<span class="grey">Aboba, et al.                Informational                     [Page 20]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-21" id="page-21" name="page-21"> </a>
<span class="grey"><a href="rfc4840.html">RFC 4840</a>         Multiple Encapsulation Methods Harmful       April 2007</span>


   An attacker might be able to force a more cumbersome encapsulation
   method between two endpoints, even when a lighter weight one is
   available, hence forcing higher resource consumption on the link and
   within those endpoints, or causing fragmentation.  Since IP fragments
   are more difficult to classify than non-fragments, this may result in
   packet loss or may even expose security vulnerabilities [<a href="#ref-WEP" title="&quot;The Final Nail in WEP's Coffin&quot;">WEP</a>].

   If different methods have different security properties, an attacker
   might be able to force a less secure method as an elevation path to
   get access to some other resource or data.  Similarly, if one method
   is rarely used, that method is potentially more likely to have
   exploitable implementation bugs.

   Since lower-layer classification methods may need to inspect fields
   in the packet being encapsulated, this might deter the deployment of
   end-to-end security, which is undesirable.  Where encryption of upper
   layer headers (e.g., IPsec tunnel mode) is required, this may obscure
   headers required for classification.  As a result, it may be
   necessary for all encrypted traffic to flow over a single connection.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Conclusion"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Conclusion</span>

   The use of multiple encapsulation methods on the same link is
   problematic, as discussed above.

   Although multiple IP encapsulation methods were defined on Ethernet
   cabling, recent implementations support only the Ethernet
   encapsulation of IPv4 defined in [<a href="rfc894.html" title='"A Standard for the Transmission of IP Datagrams over Ethernet Networks"'>RFC894</a>].  In order to avoid a
   repeat of the experience with IPv4, for operation of IPv6 on IEEE
   802.3 media, only the Ethernet encapsulation was defined in "A Method
   for the Transmission of IPv6 Packets over Ethernet Networks"
   [<a href="rfc1972.html" title='"A Method for the Transmission of IPv6 Packets over Ethernet Networks"'>RFC1972</a>], later updated in [<a href="rfc2464.html" title='"Transmission of IPv6 Packets over Ethernet Networks"'>RFC2464</a>].

   In addition to the recommendations given earlier, we give the
   following general recommendations to avoid problems resulting from
   use of multiple IP encapsulation methods:

      When developing standards for encapsulating IP packets on a link-
      layer technology, it is desirable that only a single encapsulation
      method should be standardized for each link-layer technology.

      If a link-layer protocol offers multiple encapsulation methods for
      IP packets, it is strongly recommended that only one of these
      encapsulation methods should be in use within any given link.

      Where multiple encapsulation methods are supported on a link, a
      single encapsulation should be mandatory to implement for send and
      receive.



<span class="grey">Aboba, et al.                Informational                     [Page 21]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-22" id="page-22" name="page-22"> </a>
<span class="grey"><a href="rfc4840.html">RFC 4840</a>         Multiple Encapsulation Methods Harmful       April 2007</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20References"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.1.%20%20Normative%20Reference"></a><a class="selflink" href="#section-6.1" name="section-6.1">6.1</a>.  Normative Reference</span>

   [<a id="ref-RFC2119" name="ref-RFC2119">RFC2119</a>]           Bradner, S., "Key words for use in RFCs to
                       Indicate Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>,
                       March 1997.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.2.%20%20Informative%20References"></a><a class="selflink" href="#section-6.2" name="section-6.2">6.2</a>.  Informative References</span>

   [<a id="ref-DIX" name="ref-DIX">DIX</a>]               Digital Equipment Corporation, Intel Corporation,
                       and Xerox Corporation, "The Ethernet -- A Local
                       Area Network: Data Link Layer and Physical Layer
                       (Version 2.0)", November 1982.

   [<a id="ref-Generic" name="ref-Generic">Generic</a>]           Wang, L. et al, "A Generic Packet Convergence
                       Sublayer (GPCS) for Supporting Multiple Protocols
                       over 802.16 Air Interface", Submission to IEEE
                       802.16g: CB0216g_05_025r4.pdf, November 2005,
                       &lt;<a href="http://www.ieee802.org/16/netman/contrib/C80216g-05_025r4.pdf">http://www.ieee802.org/16/netman/contrib/</a>
                       <a href="http://www.ieee802.org/16/netman/contrib/C80216g-05_025r4.pdf">C80216g-05_025r4.pdf</a>&gt;.

   [<a id="ref-IEEE-802.1A.1990" name="ref-IEEE-802.1A.1990">IEEE-802.1A.1990</a>]  Institute of Electrical and Electronics
                       Engineers, "Local Area Networks and Metropolitan
                       Area Networks:  Overview and Architecture of
                       Network Standards", IEEE Standard 802.1A, 1990.

   [<a id="ref-IEEE-802.1D.2004" name="ref-IEEE-802.1D.2004">IEEE-802.1D.2004</a>]  Institute of Electrical and Electronics
                       Engineers, "Information technology -
                       Telecommunications and information exchange
                       between systems - Local area networks - Media
                       access control (MAC) bridges", IEEE Standard
                       802.1D, 2004.

   [<a id="ref-IEEE-802.1Q.2003" name="ref-IEEE-802.1Q.2003">IEEE-802.1Q.2003</a>]  IEEE Standards for Local and Metropolitan Area
                       Networks: Draft Standard for Virtual Bridged
                       Local Area Networks, P802.1Q-2003, January 2003.

   [<a id="ref-IEEE-802.3.2002" name="ref-IEEE-802.3.2002">IEEE-802.3.2002</a>]   Institute of Electrical and Electronics
                       Engineers, "Carrier Sense Multiple Access with
                       Collision Detection (CSMA/CD) Access Method and
                       Physical Layer Specifications", IEEE Standard
                       802.3, 2002.

   [<a id="ref-IEEE-802.11.2003" name="ref-IEEE-802.11.2003">IEEE-802.11.2003</a>]  Institute of Electrical and Electronics
                       Engineers, "Wireless LAN Medium Access Control
                       (MAC) and Physical Layer (PHY) Specifications",
                       IEEE Standard 802.11, 2003.



<span class="grey">Aboba, et al.                Informational                     [Page 22]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-23" id="page-23" name="page-23"> </a>
<span class="grey"><a href="rfc4840.html">RFC 4840</a>         Multiple Encapsulation Methods Harmful       April 2007</span>


   [<a id="ref-IEEE-802.16.2004" name="ref-IEEE-802.16.2004">IEEE-802.16.2004</a>]  Institute of Electrical and Electronics
                       Engineers, "Information technology -
                       Telecommunications and information exchange
                       between systems - Local and metropolitan area
                       networks, Part 16: Air Interface for Fixed
                       Broadband Wireless Access Systems", IEEE Standard
                       802.16-2004, October 2004.

   [<a id="ref-IEEE-802.16e.2005" name="ref-IEEE-802.16e.2005">IEEE-802.16e.2005</a>] Institute of Electrical and Electronics
                       Engineers, "Information technology -
                       Telecommunications and information exchange
                       between systems - Local and Metropolitan Area
                       Networks - Part 16: Air Interface for Fixed and
                       Mobile Broadband Wireless Access Systems,
                       Amendment for Physical and Medium Access Control
                       Layers for Combined Fixed and Mobile Operation in
                       Licensed Bands", IEEE P802.16e, September 2005.

   [<a id="ref-PROBE" name="ref-PROBE">PROBE</a>]             Hewlett Packard, "A Primer on HP Probe",
                       <a href="http://www.hp.com/rnd/support/manuals/pdf/hp_probe.pdf">http://www.hp.com/rnd/support/manuals/pdf/</a>
                       <a href="http://www.hp.com/rnd/support/manuals/pdf/hp_probe.pdf">hp_probe.pdf</a>, July 1993.

   [<a id="ref-RFC826" name="ref-RFC826">RFC826</a>]            Plummer, D., "Ethernet Address Resolution
                       Protocol:  Or converting network protocol
                       addresses to 48.bit Ethernet address for
                       transmission on Ethernet hardware", STD 37, <a href="rfc826.html">RFC</a>
                       <a href="rfc826.html">826</a>, November 1982.

   [<a id="ref-RFC893" name="ref-RFC893">RFC893</a>]            Leffler, S. and M. Karels, "Trailer
                       encapsulations", <a href="rfc893.html">RFC 893</a>, April 1984.

   [<a id="ref-RFC894" name="ref-RFC894">RFC894</a>]            Hornig, C., "A Standard for the Transmission of
                       IP Datagrams over Ethernet Networks", STD 41, <a href="rfc894.html">RFC</a>
                       <a href="rfc894.html">894</a>, April 1984.

   [<a id="ref-RFC903" name="ref-RFC903">RFC903</a>]            Finlayson, R., Mann, T., Mogul, J., and M.
                       Theimer, "A Reverse Address Resolution Protocol",
                       STD 38, <a href="rfc903.html">RFC 903</a>, June 1984.

   [<a id="ref-RFC948" name="ref-RFC948">RFC948</a>]            Winston, I., "Two Methods for the Transmission of
                       IP Datagrams over IEEE 802.3 Networks", <a href="rfc948.html">RFC 948</a>,
                       June 1985.

   [<a id="ref-RFC1010" name="ref-RFC1010">RFC1010</a>]           Reynolds, J. and J. Postel, "Assigned Numbers",
                       <a href="rfc1010.html">RFC 1010</a>, May 1987.






<span class="grey">Aboba, et al.                Informational                     [Page 23]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-24" id="page-24" name="page-24"> </a>
<span class="grey"><a href="rfc4840.html">RFC 4840</a>         Multiple Encapsulation Methods Harmful       April 2007</span>


   [<a id="ref-RFC1042" name="ref-RFC1042">RFC1042</a>]           Postel, J. and J. Reynolds, "Standard for the
                       transmission of IP datagrams over IEEE 802
                       networks", STD 43, <a href="rfc1042.html">RFC 1042</a>, February 1988.

   [<a id="ref-RFC1122" name="ref-RFC1122">RFC1122</a>]           Braden, R., "Requirements for Internet Hosts --
                       Communication Layers", STD 3, <a href="rfc1122.html">RFC 1122</a>, October
                       1989.

   [<a id="ref-RFC1144" name="ref-RFC1144">RFC1144</a>]           Jacobson, V., "Compressing TCP/IP Headers for
                       Low-Speed Serial Links", <a href="rfc1144.html">RFC 1144</a>, February 1990.

   [<a id="ref-RFC1661" name="ref-RFC1661">RFC1661</a>]           Simpson, W., "The Point-to-Point Protocol (PPP)",
                       STD 51, <a href="rfc1661.html">RFC 1661</a>, July 1994.

   [<a id="ref-RFC1958" name="ref-RFC1958">RFC1958</a>]           Carpenter, B., "Architectural Principles of the
                       Internet", <a href="rfc1958.html">RFC 1958</a>, June 1996.

   [<a id="ref-RFC1962" name="ref-RFC1962">RFC1962</a>]           Rand, D., "The PPP Compression Control Protocol
                       (CCP)", <a href="rfc1962.html">RFC 1962</a>, June 1996.

   [<a id="ref-RFC1972" name="ref-RFC1972">RFC1972</a>]           Crawford, M., "A Method for the Transmission of
                       IPv6 Packets over Ethernet Networks", <a href="rfc1972.html">RFC 1972</a>,
                       August 1996.

   [<a id="ref-RFC2472" name="ref-RFC2472">RFC2472</a>]           Haskin, D. and E. Allen, "IP Version 6 over PPP",
                       <a href="rfc2472.html">RFC 2472</a>, December 1998.

   [<a id="ref-RFC2464" name="ref-RFC2464">RFC2464</a>]           Crawford, M., "Transmission of IPv6 Packets over
                       Ethernet Networks", <a href="rfc2464.html">RFC 2464</a>, December 1998.

   [<a id="ref-RFC2507" name="ref-RFC2507">RFC2507</a>]           Degermark, M., Nordgren, B., and S. Pink, "IP
                       Header Compression", <a href="rfc2507.html">RFC 2507</a>, February 1999.

   [<a id="ref-RFC2508" name="ref-RFC2508">RFC2508</a>]           Casner, S. and V. Jacobson, "Compressing
                       IP/UDP/RTP Headers for Low-Speed Serial Links",
                       <a href="rfc2508.html">RFC 2508</a>, February 1999.

   [<a id="ref-RFC2615" name="ref-RFC2615">RFC2615</a>]           Malis, A. and W. Simpson, "PPP over SONET/SDH",
                       <a href="rfc2615.html">RFC 2615</a>, June 1999.

   [<a id="ref-RFC2684" name="ref-RFC2684">RFC2684</a>]           Grossman, D. and J. Heinanen, "Multiprotocol
                       Encapsulation over ATM Adaptation Layer 5", <a href="rfc2684.html">RFC</a>
                       <a href="rfc2684.html">2684</a>, September 1999.

   [<a id="ref-RFC3095" name="ref-RFC3095">RFC3095</a>]           Bormann, C., Burmeister, C., Degermark, M.,
                       Fukushima, H., Hannu, H., Jonsson, L-E.,
                       Hakenberg, R., Koren, T., Le, K., Liu, Z.,
                       Martensson, A., Miyazaki, A., Svanbro, K.,



<span class="grey">Aboba, et al.                Informational                     [Page 24]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-25" id="page-25" name="page-25"> </a>
<span class="grey"><a href="rfc4840.html">RFC 4840</a>         Multiple Encapsulation Methods Harmful       April 2007</span>


                       Wiebke, T., Yoshimura, T., and H. Zheng, "RObust
                       Header Compression (ROHC):  Framework and four
                       profiles: RTP, UDP, ESP, and uncompressed", <a href="rfc3095.html">RFC</a>
                       <a href="rfc3095.html">3095</a>, July 2001.

   [<a id="ref-RFC3241" name="ref-RFC3241">RFC3241</a>]           Bormann, C., "Robust Header Compression (ROHC)
                       over PPP", <a href="rfc3241.html">RFC 3241</a>, April 2002.

   [<a id="ref-RFC3518" name="ref-RFC3518">RFC3518</a>]           Higashiyama, M., Baker, F., and T. Liao, "Point-
                       to-Point Protocol (PPP) Bridging Control Protocol
                       (BCP)", <a href="rfc3518.html">RFC 3518</a>, April 2003.

   [<a id="ref-RFC3544" name="ref-RFC3544">RFC3544</a>]           Koren, T., Casner, S., and C. Bormann, "IP Header
                       Compression over PPP", <a href="rfc3544.html">RFC 3544</a>, July 2003.

   [<a id="ref-RFC3545" name="ref-RFC3545">RFC3545</a>]           Koren, T., Casner, S., Geevarghese, J., Thompson,
                       B., and P. Ruddy, "Enhanced Compressed RTP (CRTP)
                       for Links with High Delay, Packet Loss and
                       Reordering", <a href="rfc3545.html">RFC 3545</a>, July 2003.

   [<a id="ref-RFC3759" name="ref-RFC3759">RFC3759</a>]           Jonsson, L-E., "RObust Header Compression (ROHC):
                       Terminology and Channel Mapping Examples", <a href="rfc3759.html">RFC</a>
                       <a href="rfc3759.html">3759</a>, April 2004.

   [<a id="ref-RFC4541" name="ref-RFC4541">RFC4541</a>]           Christensen, M., Kimball, K., and F. Solensky,
                       "Considerations for Internet Group Management
                       Protocol (IGMP) and Multicast Listener Discovery
                       (MLD) Snooping Switches", <a href="rfc4541.html">RFC 4541</a>, May 2006.

   [<a id="ref-WEP" name="ref-WEP">WEP</a>]               Bittau, A., Handley, M., and J. Lackey, "The
                       Final Nail in WEP's Coffin", Proceedings of the
                       2006 IEEE Symposium on Security and Privacy, pp.
                       386-400.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20Acknowledgments"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  Acknowledgments</span>

   The authors would like to acknowledge Jeff Mandin, Bob Hinden, Jari
   Arkko, Max Riegel, Alfred Hoenes, and Phil Roberts for contributions
   to this document.












<span class="grey">Aboba, et al.                Informational                     [Page 25]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-26" id="page-26" name="page-26"> </a>
<span class="grey"><a href="rfc4840.html">RFC 4840</a>         Multiple Encapsulation Methods Harmful       April 2007</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/Appendix%20A.%20%20IAB%20Members%20at%20the%20Time%20of%20This%20Writing"></a><a class="selflink" href="#appendix-A" name="appendix-A">Appendix A</a>.  IAB Members at the Time of This Writing</span>

   Bernard Aboba
   Loa Andersson
   Brian Carpenter
   Leslie Daigle
   Elwyn Davies
   Kevin Fall
   Olaf Kolkman
   Kurtis Lindqvist
   David Meyer
   David Oran
   Eric Rescorla
   Dave Thaler
   Lixia Zhang

Authors' Addresses

   Bernard Aboba
   Microsoft Corporation
   One Microsoft Way
   Redmond, WA 98052

   EMail: bernarda@microsoft.com
   Phone: +1 425 706 6605
   Fax:   +1 425 936 7329


   Elwyn B. Davies
   Consultant
   Soham, Cambs
   UK

   EMail: elwynd@dial.pipex.com
   Phone: +44 7889 488 335


   Dave Thaler
   Microsoft Corporation
   One Microsoft Way
   Redmond, WA 98052

   EMail: dthaler@microsoft.com
   Phone: +1 425 703 8835







<span class="grey">Aboba, et al.                Informational                     [Page 26]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-27" id="page-27" name="page-27"> </a>
<span class="grey"><a href="rfc4840.html">RFC 4840</a>         Multiple Encapsulation Methods Harmful       April 2007</span>


Full Copyright Statement

   Copyright (C) The IETF Trust (2007).

   This document is subject to the rights, licenses and restrictions
   contained in <a href="https://tools.ietf.org/html/bcp78">BCP 78</a>, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST AND
   THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS
   OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF
   THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and <a href="https://tools.ietf.org/html/bcp79">BCP 79</a>.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   <a href="http://www.ietf.org/ipr">http://www.ietf.org/ipr</a>.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.

Acknowledgement

   Funding for the RFC Editor function is currently provided by the
   Internet Society.







Aboba, et al.                Informational                     [Page 27]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc4840 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:39 GMT --></html>