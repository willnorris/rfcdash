<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc3603 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:45 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="urn:ietf:rfc:3603" name="DC.Identifier"/>
<meta content="In order to deploy a residential telephone service at very large scale
across different domains, it is necessary for trusted elements owned
by different service providers to exchange trusted information that
conveys customer-specific information and expectations about the
parties involved in the call. This document describes private
extensions to the Session Initiation Protocol (SIP) (RFC3261) for
supporting the exchange of customer information and billing
information between trusted entities in the PacketCable Distributed
Call Signaling Architecture. These extensions provide mechanisms for
access network coordination to prevent theft of service, customer
originated trace of harassing calls, support for operator services and
emergency services, and support for various other regulatory issues.
The use of the extensions is only applicable within closed
administrative domains, or among federations of administrative domains
with previously agreed-upon policies where coordination of charging
and other functions is required." name="DC.Description.Abstract"/>
<meta content="Flemming Andreasen &lt;fandreas@cisco.com&gt;" name="DC.Creator"/>
<meta content="October, 2003" name="DC.Date.Issued"/>
<meta content="Private Session Initiation Protocol (SIP) Proxy-to-Proxy Extensions for Supporting the PacketCable Distributed Call Signaling Architecture" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 3603 - Private Session Initiation Protocol (SIP) Proxy-to-Proxy Extensions for Supporting the PacketCable Distributed Call Signaling Architecture</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgbrown" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc3603.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc3603" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-dcsgroup-sipping-proxy-proxy" title="draft-dcsgroup-sipping-proxy-proxy">draft-dcsgroup-...</a>] [<a href="https://datatracker.ietf.org/doc/rfc3603" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc3603" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc3603" title="Side-by-side diff">Diff2</a>] [<a href="https://datatracker.ietf.org/ipr/search/?rfc=3603&amp;submit=rfc" title="IPR disclosures related to this document">IPR</a>]   </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">Obsoleted by: <a href="rfc5503.html">5503</a>                                         INFORMATIONAL</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Network Working Group                                   W. Marshall, Ed.
Request for Comments: 3603                                          AT&amp;T
Category: Informational                                F. Andreasen, Ed.
                                                                   Cisco
                                                            October 2003


  <span class="h1">Private Session Initiation Protocol (SIP) Proxy-to-Proxy Extensions</span>
 <span class="h1">for Supporting the PacketCable Distributed Call Signaling Architecture</span>

Status of this Memo

   This memo provides information for the Internet community.  It does
   not specify an Internet standard of any kind.  Distribution of this
   memo is unlimited.

Copyright Notice

   Copyright (C) The Internet Society (2003).  All Rights Reserved.

Abstract

   In order to deploy a residential telephone service at very large
   scale across different domains, it is necessary for trusted elements
   owned by different service providers to exchange trusted information
   that conveys customer-specific information and expectations about the
   parties involved in the call.  This document describes private
   extensions to the Session Initiation Protocol (SIP) (<a href="rfc3261.html">RFC3261</a>) for
   supporting the exchange of customer information and billing
   information between trusted entities in the PacketCable Distributed
   Call Signaling Architecture.  These extensions provide mechanisms for
   access network coordination to prevent theft of service, customer
   originated trace of harassing calls, support for operator services
   and emergency services, and support for various other regulatory
   issues.  The use of the extensions is only applicable within closed
   administrative domains, or among federations of administrative
   domains with previously agreed-upon policies where coordination of
   charging and other functions is required.

Table of Contents

   <a href="#section-1">1</a>.  Applicability Statement . . . . . . . . . . . . . . . . . . .  <a href="#page-3">3</a>
   <a href="#section-2">2</a>.  Introduction. . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-3">3</a>
   <a href="#section-3">3</a>.  Trust Boundary. . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-5">5</a>
   <a href="#section-4">4</a>.  Conventions used in this document . . . . . . . . . . . . . .  <a href="#page-6">6</a>






<span class="grey">Marshall &amp; Andreasen         Informational                      [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc3603.html">RFC 3603</a>             SIP Proxy-to-Proxy Extensions          October 2003</span>


   <a href="#section-5">5</a>.  P-DCS-TRACE-PARTY-ID. . . . . . . . . . . . . . . . . . . . .  <a href="#page-6">6</a>
       <a href="#section-5.1">5.1</a>.  Syntax. . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-7">7</a>
       <a href="#section-5.2">5.2</a>.  Procedures at an Untrusted User Agent Client (UAC). . .  <a href="#page-7">7</a>
       <a href="#section-5.3">5.3</a>.  Procedures at a Trusted User Agent Client (UAC) . . . .  <a href="#page-7">7</a>
       <a href="#section-5.4">5.4</a>.  Procedures at an Untrusted User Agent Server (UAS). . .  <a href="#page-7">7</a>
       <a href="#section-5.5">5.5</a>.  Procedures at a Trusted User Agent Server (UAS) . . . .  <a href="#page-7">7</a>
       <a href="#section-5.6">5.6</a>.  Procedures at Proxy . . . . . . . . . . . . . . . . . .  <a href="#page-8">8</a>
             <a href="#section-5.6.1">5.6.1</a>.  Procedures at Originating Proxy . . . . . . . .  <a href="#page-8">8</a>
             <a href="#section-5.6.2">5.6.2</a>.  Procedures at Terminating Proxy . . . . . . . .  <a href="#page-8">8</a>
   <a href="#section-6">6</a>.  P-DCS-OSPS. . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-8">8</a>
       <a href="#section-6.1">6.1</a>.  Syntax. . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-9">9</a>
       <a href="#section-6.2">6.2</a>.  Procedures at an Untrusted User Agent Client (UAC). . .  <a href="#page-9">9</a>
       <a href="#section-6.3">6.3</a>.  Procedures at a Trusted User Agent Client (UAC) . . . . <a href="#page-10">10</a>
       <a href="#section-6.4">6.4</a>.  Procedures at an Untrusted User Agent Server (UAS). . . <a href="#page-10">10</a>
       <a href="#section-6.5">6.5</a>.  Procedures at a Trusted User Agent Server (UAS) . . . . <a href="#page-11">11</a>
       <a href="#section-6.6">6.6</a>.  Procedures at Proxy . . . . . . . . . . . . . . . . . . <a href="#page-11">11</a>
   <a href="#section-7">7</a>.  P-DCS-BILLING-INFO. . . . . . . . . . . . . . . . . . . . . . <a href="#page-11">11</a>
       <a href="#section-7.1">7.1</a>.  Syntax. . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-13">13</a>
       <a href="#section-7.2">7.2</a>.  Procedures at an Untrusted User Agent Client (UAC). . . <a href="#page-14">14</a>
       <a href="#section-7.3">7.3</a>.  Procedures at a Trusted User Agent Client (UAC) . . . . <a href="#page-14">14</a>
       <a href="#section-7.4">7.4</a>.  Procedures at an Untrusted User Agent Server (UAS). . . <a href="#page-15">15</a>
       <a href="#section-7.5">7.5</a>.  Procedures at a Trusted User Agent Server (UAS) . . . . <a href="#page-15">15</a>
       <a href="#section-7.6">7.6</a>.  Procedures at Proxy . . . . . . . . . . . . . . . . . . <a href="#page-16">16</a>
             <a href="#section-7.6.1">7.6.1</a>.  Procedures at Originating Proxy . . . . . . . . <a href="#page-16">16</a>
             <a href="#section-7.6.2">7.6.2</a>.  Procedures at Terminating Proxy . . . . . . . . <a href="#page-17">17</a>
             <a href="#section-7.6.3">7.6.3</a>.  Procedures at Tandem Proxy. . . . . . . . . . . <a href="#page-18">18</a>
   <a href="#section-8">8</a>.  P-DCS-LAES and P-DCS-REDIRECT . . . . . . . . . . . . . . . . <a href="#page-18">18</a>
       <a href="#section-8.1">8.1</a>.  Syntax. . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-19">19</a>
       <a href="#section-8.2">8.2</a>.  Procedures at an Untrusted User Agent Client (UAC). . . <a href="#page-20">20</a>
       <a href="#section-8.3">8.3</a>.  Procedures at a Trusted User Agent Client (UAC) . . . . <a href="#page-20">20</a>
       <a href="#section-8.4">8.4</a>.  Procedures at an Untrusted User Agent Server (UAS). . . <a href="#page-21">21</a>
       <a href="#section-8.5">8.5</a>.  Procedures at a Trusted User Agent Server (UAS) . . . . <a href="#page-21">21</a>
       <a href="#section-8.6">8.6</a>.  Procedures at Proxy . . . . . . . . . . . . . . . . . . <a href="#page-21">21</a>
             <a href="#section-8.6.1">8.6.1</a>.  Procedures at Originating Proxy . . . . . . . . <a href="#page-22">22</a>
             <a href="#section-8.6.2">8.6.2</a>.  Procedures at Terminating Proxy . . . . . . . . <a href="#page-23">23</a>
   <a href="#section-9">9</a>.  Security Considerations . . . . . . . . . . . . . . . . . . . <a href="#page-24">24</a>
   <a href="#section-10">10</a>. IANA Considerations . . . . . . . . . . . . . . . . . . . . . <a href="#page-25">25</a>
   <a href="#section-11">11</a>. Intellectual Property Rights Notice . . . . . . . . . . . . . <a href="#page-25">25</a>
   <a href="#section-12">12</a>. References  . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-25">25</a>
       <a href="#section-12.1">12.1</a>. Normative References. . . . . . . . . . . . . . . . . . <a href="#page-25">25</a>
       <a href="#section-12.2">12.2</a>. Informative References. . . . . . . . . . . . . . . . . <a href="#page-26">26</a>
   <a href="#section-13">13</a>. Acknowledgements. . . . . . . . . . . . . . . . . . . . . . . <a href="#page-26">26</a>
   <a href="#section-14">14</a>. Editors' Addresses. . . . . . . . . . . . . . . . . . . . . . <a href="#page-27">27</a>
   <a href="#section-15">15</a>. Full Copyright Statement. . . . . . . . . . . . . . . . . . . <a href="#page-28">28</a>







<span class="grey">Marshall &amp; Andreasen         Informational                      [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc3603.html">RFC 3603</a>             SIP Proxy-to-Proxy Extensions          October 2003</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Applicability%20Statement"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Applicability Statement</span>

   The SIP extensions described in this document make certain
   assumptions regarding network topology, linkage between SIP and lower
   layers, and the availability of transitive trust.  These assumptions
   are generally not applicable in the Internet as a whole.  The use of
   these headers is only applicable within closed administrative
   domains, or among federations of administrative domains with
   previously agreed-upon policies where coordination of charging and
   other functions is required, as in for example the architecture
   presented in [<a href="#ref-6" title='"Architectural Considerations for Providing Carrier Class Telephony Services Utilizing SIP-based Distributed Call Control Mechanisms"'>6</a>].  Use outside such a domain could result in the
   leakage of potentially sensitive or private information.  User
   consent to the privacy implications of the policies in [<a href="#ref-6" title='"Architectural Considerations for Providing Carrier Class Telephony Services Utilizing SIP-based Distributed Call Control Mechanisms"'>6</a>] is
   strongly encouraged in those domains as well.

   Although <a href="rfc2119.html">RFC 2119</a> language is used in this document, the scope of the
   normative language is only for the area of applicability of the
   document and, like the technology, it does not apply to the general
   Internet.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Introduction"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Introduction</span>

   In order to deploy a SIP-based [<a href="#ref-2" title='"SIP: Session Initiation Protocol"'>2</a>] residential telephone service at
   very large scale across different domains, it is necessary for
   trusted elements owned by different service providers to exchange
   trusted information that conveys billing information and expectations
   about the parties involved in the call.

   There are many billing models used in deriving revenue from telephony
   services today.  Charging for telephony services is tightly coupled
   to the use of network resources.  It is outside the scope of this
   document to discuss the details of these numerous and varying
   methods.

   A key motivating principle of the DCS architecture described in [<a href="#ref-6" title='"Architectural Considerations for Providing Carrier Class Telephony Services Utilizing SIP-based Distributed Call Control Mechanisms"'>6</a>]
   is the need for network service providers to be able to control and
   monitor network resources; revenue may be derived from the usage of
   these resources as well as from the delivery of enhanced services
   such as telephony.  Furthermore, the DCS architecture recognizes the
   need for coordination between call signaling and resource management.
   This coordination ensures that users are authenticated and authorized
   before receiving access to network resources and billable enhanced
   services.








<span class="grey">Marshall &amp; Andreasen         Informational                      [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc3603.html">RFC 3603</a>             SIP Proxy-to-Proxy Extensions          October 2003</span>


   DCS Proxies, as defined in [<a href="#ref-6" title='"Architectural Considerations for Providing Carrier Class Telephony Services Utilizing SIP-based Distributed Call Control Mechanisms"'>6</a>], have access to subscriber information
   and act as policy decision points and trusted intermediaries along
   the call signaling path.  Edge routers provide the network
   connectivity and resource policy enforcement mechanism and also
   capture and report network connectivity and resource usage
   information.  Edge routers need to be given billing information that
   can be logged with Record Keeping or Billing servers.  The DCS Proxy,
   as a central point of coordination between call signaling and
   resource management, can provide this information based on the
   authenticated identity of the calling and called parties.  Since
   there is a trust relationship among DCS Proxies, they can be relied
   upon to exchange trusted billing information pertaining to the
   parties involved in a call.  See [<a href="#ref-6" title='"Architectural Considerations for Providing Carrier Class Telephony Services Utilizing SIP-based Distributed Call Control Mechanisms"'>6</a>] for a description of the trust
   boundary and trusted versus untrusted entities.

   For these reasons, it is appropriate to consider defining SIP header
   extensions to allow DCS Proxies to exchange information during call
   setup.  It is the intent that the extensions would only appear on
   trusted network segments, should be inserted upon entering a trusted
   network region, and removed before leaving trusted network segments.

   Significant amounts of information is retrieved by an originating DCS
   Proxy in its handling of a connection setup request from a user
   agent.  Such information includes location information about the
   subscriber (essential for emergency services calls), billing
   information, and station information (e.g., coin operated phone).  In
   addition, while translating the destination number, information such
   as the local-number-portability office code is obtained and will be
   needed by all other proxies handling this call.

   For Usage Accounting records, it is necessary to have an identifier
   that can be associated with all the event records produced for the
   call.  The SIP Call-ID header field cannot be used as such an
   identifier since it is selected by the originating user agent, and
   may not be unique among all past calls as well as current calls.
   Further, since this identifier is to be used by the service provider,
   it should be chosen in a manner and in a format that meets the
   service provider's needs.

   Billing information may not necessarily be unique for each user
   (consider the case of calls from an office all billed to the same
   account).  Billing information may not necessarily be identical for
   all calls made by a single user (consider prepaid calls, credit card
   calls, collect calls, etc).  It is therefore necessary to carry
   billing information separate from the calling and called party
   identification.  Furthermore, some billing models call for split-
   charging where multiple entities are billed for portions of the call.




<span class="grey">Marshall &amp; Andreasen         Informational                      [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc3603.html">RFC 3603</a>             SIP Proxy-to-Proxy Extensions          October 2003</span>


   The addition of a SIP General Header Field allows for the capture of
   billing information and billing identification for the duration of
   the call.

   It is the intent that the billing extensions would only appear on
   trusted network segments, and MAY be inserted by a DCS Proxy in
   INVITE and REFER requests and INVITE responses in a trusted network
   segment, and removed before leaving trusted network segments.

   In addition to support for billing, current residential telephone
   service includes the need for customer originated trace (of harassing
   or obscene calls), for operator services such as busy line
   verification and emergency interrupt (initiated by an operator from
   an Operator Services Position System (OSPS)), for emergency services
   such as 9-1-1 calls to a Public Service Access Point (PSAP) and the
   subsequent call handling, and support for Electronic Surveillance and
   Law Enforcement access as required by applicable legislation and
   court orders.  In all of these cases, additional information about
   the call and about the subscribers involved in the call needs to be
   exchanged between the proxies.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Trust%20Boundary"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Trust Boundary</span>

   The DCS architecture [<a href="#ref-6" title='"Architectural Considerations for Providing Carrier Class Telephony Services Utilizing SIP-based Distributed Call Control Mechanisms"'>6</a>] defines a trust boundary around the various
   systems and servers that are owned, operated by, and/or controlled by
   the service provider.  These trusted systems include the proxies and
   various servers such as bridge servers, voicemail servers,
   announcement servers, etc.  Outside of the trust boundary lie the
   customer premises equipment, and various application and media
   servers operated by third-party service providers.

   Certain subscriber-specific information, such as billing and
   accounting information, stays within the trust boundary.  Other
   subscriber-specific information, such as endpoint identity, may be
   presented to untrusted endpoints or may be withheld based on
   subscriber profiles.

   The User Agent (UA) may be either within the trust boundary or
   outside the trust boundary, depending on exactly what function is
   being performed and exactly how it is being performed. Accordingly,
   the procedures followed by a User Agent are different depending on
   whether the UA is within the trust boundary or outside the trust
   boundary.

   The following sections giving procedures for User Agents therefore
   are subdivided into trusted user agents and untrusted user agents.





<span class="grey">Marshall &amp; Andreasen         Informational                      [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc3603.html">RFC 3603</a>             SIP Proxy-to-Proxy Extensions          October 2003</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Conventions%20used%20in%20this%20document"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Conventions used in this document</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED",  "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a> [<a href="#ref-1" title='"Key words for use in RFCs to Indicate Requirement Levels"'>1</a>].

   The term "private-URL" used in this document refers to a SIP URI that
   is generated by a proxy, contains a "hostport" that identifies the
   proxy, and contains a "userinfo" string that is generated by the
   proxy.  The "userinfo" typically contains (or points to) information
   that is not to be disclosed outside the trusted domain of the
   proxies, such as billing account numbers, electronic surveillance
   indication, electronic surveillance parameters, and call redirection
   information.  Consequently, the information is either stored locally
   by the proxy, or encrypted with a private key known only to the proxy
   and encoded in a character string in the "userinfo" portion of the
   URL.  A checksum is included in the "userinfo" data to detect
   tampering.  The mechanism by which a proxy recognizes a "userinfo" as
   a private-URL and decodes and recovers the original information is
   local to the proxy and is not subject to standardization.  Some
   possible implementations include an initial magic cookie (e.g.,
   z9hG4Bk followed by the pointer/information), or use of a reserved
   "user" name (e.g., "private") with the optional "password" containing
   the pointer/information.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20P-DCS-TRACE-PARTY-ID"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  P-DCS-TRACE-PARTY-ID</span>

   In the telephone network, calling identity information is used to
   support regulatory requirements such as the Customer Originated Trace
   service, which provide the called party with the ability to report
   obscene or harassing phone calls to law enforcement.  This service is
   provided independently of caller-id, and works even if the caller
   requested anonymity.  The calling party is here identified as the
   station originating the call.  In order for this service to be
   dependable, the called party must be able to trust that the calling
   identity information being presented is valid.  One way to achieve
   this is described in [<a href="#ref-10" title='"Private Extensions to the Session Initiation Protocol (SIP) for Asserted Identity within Trusted Networks"'>10</a>].

   To initiate a customer-originated-trace from an untrusted UAC, an
   additional header is defined for the INVITE request.  This header is
   called P-DCS-Trace-Party-ID, and does not appear in any other request
   or response.  The entity addressed by the Request-URI performs the
   service-provider-specific functions of recording and reporting the
   caller identity in the P-DCS-Trace-Party-ID for law enforcement
   action.  It then forwards the call to either an announcement server
   or to the service-provider's business office to collect further
   information about the complaint.  A trusted UAC does not use this
   header, as it initiates this action locally.



<span class="grey">Marshall &amp; Andreasen         Informational                      [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc3603.html">RFC 3603</a>             SIP Proxy-to-Proxy Extensions          October 2003</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.1.%20%20Syntax"></a><a class="selflink" href="#section-5.1" name="section-5.1">5.1</a>.  Syntax</span>

   The ABNF description of this header is (some terms used in this ABNF
   are defined in [<a href="#ref-2" title='"SIP: Session Initiation Protocol"'>2</a>]):

      P-DCS-Trace-Party-ID = "P-DCS-Trace-Party-ID" HCOLON
                                     name-addr

   This document adds the following entry to Table 2 of [<a href="#ref-2" title='"SIP: Session Initiation Protocol"'>2</a>]:

      Header field         where proxy  ACK  BYE  CAN  INV  OPT  REG
      ------------         ----- -----  ---  ---  ---  ---  ---  ---
      P-DCS-Trace-Party-ID   R     dr    -    -    -    o    -    -


                                        SUB  NOT  REF  INF  UPD  PRA
                                        ---  ---  ---  ---  ---  ---
                                         -    -    -    -    -    -

   The addr-spec contained in name-addr contains a URL that identifies
   the remote endpoint.  Addr-spec typically contains a tel: URL or SIP
   URI giving the identity of the remote endpoint, as provided in the
   signaling messages that established the session to be traced.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.2.%20%20Procedures%20at%20an%20Untrusted%20User%20Agent%20Client%20%28UAC%29"></a><a class="selflink" href="#section-5.2" name="section-5.2">5.2</a>.  Procedures at an Untrusted User Agent Client (UAC)</span>

   The UAC MUST insert a P-DCS-Trace-Party-ID header into the initial
   INVITE message for a customer-originated-trace request.  The UAC MUST
   use a SIP URI in the Request-URI with userinfo set to "call-trace"
   and hostport identifying the call tracing entity for the untrusted
   UA.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.3.%20%20Procedures%20at%20a%20Trusted%20User%20Agent%20Client%20%28UAC%29"></a><a class="selflink" href="#section-5.3" name="section-5.3">5.3</a>.  Procedures at a Trusted User Agent Client (UAC)</span>

   A trusted UAC performs the customer-originated-trace in a manner
   similar to the trusted UAS, described below.  A trusted UAC MUST NOT
   include this header in any request.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.4.%20%20Procedures%20at%20an%20Untrusted%20User%20Agent%20Server%20%28UAS%29"></a><a class="selflink" href="#section-5.4" name="section-5.4">5.4</a>.  Procedures at an Untrusted User Agent Server (UAS)</span>

   This header MUST NOT appear in any response sent by a UAS.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.5.%20%20Procedures%20at%20a%20Trusted%20User%20Agent%20Server%20%28UAS%29"></a><a class="selflink" href="#section-5.5" name="section-5.5">5.5</a>.  Procedures at a Trusted User Agent Server (UAS)</span>

   If the P-DCS-Trace-Party-ID header is present in the initial INVITE
   request from a UAC, and the Request-URI of the INVITE has userinfo
   set to "call-trace" and hostport set to the UAS, the UAS MUST perform
   the service-provider-specific functions of recording and reporting



<span class="grey">Marshall &amp; Andreasen         Informational                      [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc3603.html">RFC 3603</a>             SIP Proxy-to-Proxy Extensions          October 2003</span>


   the caller identity for law enforcement action.  The UAS then MUST
   redirect the call, via a 3xx response, to either an announcement
   server or to the service-provider's business office to collect
   further information about the complaint.

   This header MUST NOT appear in any response sent by a UAS.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.6.%20%20Procedures%20at%20Proxy"></a><a class="selflink" href="#section-5.6" name="section-5.6">5.6</a>.  Procedures at Proxy</span>

   Two sets of proxy procedures are defined: (1) the procedures at an
   originating proxy, and (2) the procedures at a terminating proxy. The
   originating proxy is a proxy that received the INVITE request from a
   non-trusted endpoint.

   The terminating proxy is a proxy that sends the INVITE request to a
   non-trusted endpoint.

   A proxy that both receives the INVITE request from an untrusted
   endpoint, and sends the INVITE request to an untrusted endpoint,
   performs both sets of procedures.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.6.1.%20%20Procedures%20at%20Originating%20Proxy"></a><a class="selflink" href="#section-5.6.1" name="section-5.6.1">5.6.1</a>.  Procedures at Originating Proxy</span>

   If the P-DCS-Trace-Party-ID header is present in the initial INVITE
   request from the UAC, and the Request-URI of the INVITE has userinfo
   other than "call-trace" and hostport set to other than a potentially
   provisioned call tracing entity, then the Proxy MAY reject the
   request, or MAY remove the P-DCS-Trace-Party-ID header from the
   request.  If the header is present in a valid request, and contains a
   private-URL that identifies the Proxy in the hostport, then the
   Originating Proxy SHOULD replace the private-URL with its original
   contents (i.e., the verified identity of the caller of the session
   that is being traced).

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.6.2.%20%20Procedures%20at%20Terminating%20Proxy"></a><a class="selflink" href="#section-5.6.2" name="section-5.6.2">5.6.2</a>.  Procedures at Terminating Proxy</span>

   This header MUST NOT appear in any request or response sent by a
   terminating proxy to an untrusted endpoint.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20P-DCS-OSPS"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  P-DCS-OSPS</span>

   Some calls have special call processing requirements that may not be
   satisfied by normal user agent call processing.  For example, when a
   user is engaged in a call and another call arrives, such a call might
   be rejected with a busy indication.  However, some PSTN operator
   services require special call processing.  In particular, the Busy
   Line Verification (BLV) and Emergency Interrupt (EI) services
   initiated by an operator from an Operator Services Position System



<span class="grey">Marshall &amp; Andreasen         Informational                      [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc3603.html">RFC 3603</a>             SIP Proxy-to-Proxy Extensions          October 2003</span>


   (OSPS) on the PSTN network have such a need.  Similarly, emergency
   calls to a 9-1-1 Public Service Access Point (PSAP) may result in
   trunk signaling causing operator ringback using a howling tone or
   sustained ring on the originating line (country-specific variations
   may exist).

   In order to inform the SIP user agent that special treatment should
   be given to a call, we use a new P-DCS-OSPS header field, which may
   be set to a value indicating when a special type of call processing
   is requested.  We define three values in this header, namely "BLV"
   for busy line verification, "EI" for emergency interrupt, and "RING"
   for operator ringback (e.g., howling/sustained tone ring in the US).

   If the user agent decides to honor such a request, the response of
   the user agent to an INVITE with either "BLV" or "EI" will not be a
   busy indication.  Since "EI" and "RING" only occur on established
   dialogs, they may also appear in UPDATE requests.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.1.%20%20Syntax"></a><a class="selflink" href="#section-6.1" name="section-6.1">6.1</a>.  Syntax</span>

   The ABNF description of the P-DCS-OSPS header is as follows (some
   terms used in this ABNF are defined in [<a href="#ref-2" title='"SIP: Session Initiation Protocol"'>2</a>]):

      P-DCS-OSPS      = "P-DCS-OSPS" HCOLON OSPS-Tag
      OSPS-Tag        = "BLV" / "EI" / "RING" / token

   This document adds the following entry to Table 2 of [<a href="#ref-2" title='"SIP: Session Initiation Protocol"'>2</a>]:

      Header field         where proxy  ACK  BYE  CAN  INV  OPT  REG
      ------------         ----- -----  ---  ---  ---  ---  ---  ---
      P-DCS-OSPS             R     dr    -    -    -    o    -    -


                                        SUB  NOT  REF  INF  UPD  PRA
                                        ---  ---  ---  ---  ---  ---
                                         -    -    -    -    o    -

   The OSPS-Tag value of "token" is defined for extensibility, and is
   reserved for future use.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.2.%20%20Procedures%20at%20an%20Untrusted%20User%20Agent%20Client%20%28UAC%29"></a><a class="selflink" href="#section-6.2" name="section-6.2">6.2</a>.  Procedures at an Untrusted User Agent Client (UAC)</span>

   The P-DCS-OSPS header MUST NOT be sent in a request from an untrusted
   UAC.







<span class="grey">Marshall &amp; Andreasen         Informational                      [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc3603.html">RFC 3603</a>             SIP Proxy-to-Proxy Extensions          October 2003</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.3.%20%20Procedures%20at%20a%20Trusted%20User%20Agent%20Client%20%28UAC%29"></a><a class="selflink" href="#section-6.3" name="section-6.3">6.3</a>.  Procedures at a Trusted User Agent Client (UAC)</span>

   This header is typically only inserted by a Media Gateway Controller
   [<a href="#ref-6" title='"Architectural Considerations for Providing Carrier Class Telephony Services Utilizing SIP-based Distributed Call Control Mechanisms"'>6</a>] that is controlling a Media Gateway with special trunks to a PSTN
   OSPS system or PSAP.  This trunk group is usually referred to as a
   BLV-trunk group and employs special signaling procedures that prevent
   inadvertent use.  Calls originating at the PSTN OSPS system are sent
   over this trunk group, and result in an INVITE request with the P-
   DCS-OSPS header.

   This header MAY be sent in an INVITE request, and MUST NOT appear in
   any message other than those listed below.

   OSPS-Tag value "BLV" MUST NOT appear in any request or response other
   than an initial INVITE request establishing a new dialog.

   OSPS-Tag value "EI" MUST NOT appear in any request or response other
   than (1) a subsequent INVITE within a pre-existing dialog established
   with the OSPS-Tag value of "BLV", or (2) an UPDATE request within a
   pre-existing dialog established with the OSPS-Tag value of "BLV".

   OSPS-Tag value "RING" MUST NOT appear in any request or response
   other than (1) a subsequent INVITE within a pre-existing dialog
   established by a UAC to an operator or PSAP, or (2) an UPDATE request
   within a pre-existing dialog established by a UAC to an operator or
   PSAP.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.4.%20%20Procedures%20at%20an%20Untrusted%20User%20Agent%20Server%20%28UAS%29"></a><a class="selflink" href="#section-6.4" name="section-6.4">6.4</a>.  Procedures at an Untrusted User Agent Server (UAS)</span>

   If the UAS receives an INVITE request with an OSPS-Tag of "BLV",
   dialog identification that matches an existing dialog, and the
   existing call was not established with the OSPS-Tag, it MUST reject
   the request with a 403-Forbidden error code.

   If the UAS receives an INVITE/UPDATE request with an OSPS-Tag value
   of "EI" or "RING", with dialog identification that does not match an
   existing dialog, it MUST reject the request with a 403-Forbidden
   response code.

   If the UAS receives an INVITE that contains an OSPS-Tag value of
   "BLV" and is not willing to cooperate in offering this service, it
   MUST reject the request with a 403-Forbidden response code.

   The UAS SHOULD NOT reject an INVITE with a BLV OSPS-Tag due to a busy
   condition.  The UAS MUST NOT respond with a 3xx-Redirect response
   code to an INVITE with a BLV OSPS-Tag.  The UAS SHOULD NOT alert the
   user of the incoming call attempt if the BLV OSPS-Tag is present in
   the INVITE.



<span class="grey">Marshall &amp; Andreasen         Informational                     [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc3603.html">RFC 3603</a>             SIP Proxy-to-Proxy Extensions          October 2003</span>


   If an INVITE with OSPS-Tag of "BLV" is accepted (e.g., meeting all
   QoS pre-conditions, etc.), the UAS MUST send an audio stream on this
   connection to the address and port given in the SDP of the INVITE.
   The UAS MAY perform a mixing operation between the two ends of an
   existing active call and send the resulting media stream to the
   address and port indicated.  Alternatively, the UAS MAY send a copy
   of the local voice stream, and (if no activity on the local voice
   stream) send a copy of the received voice stream of an existing call.
   If the state of the UAS is idle, the UAS SHOULD send a stream of
   silence packets to OSPS.  If the state of the UAS is ringing or
   ringback, the UAS SHOULD send a ringback stream to OSPS.

   If an INVITE/UPDATE with OSPS-Tag of "EI" is accepted, the UAS MUST
   enable communication between the UAC and the local user.  The UAS MAY
   put any existing call on hold, or initiate an ad-hoc conference.

   If an INVITE/UPDATE with OSPS-Tag of "RING" is accepted, the UAS MUST
   perform operator ringback in accordance with local procedures, e.g.,
   generate a 3-second howling tone or a sustained ring, depending on
   the state of the user equipment.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.5.%20%20Procedures%20at%20a%20Trusted%20User%20Agent%20Server%20%28UAS%29"></a><a class="selflink" href="#section-6.5" name="section-6.5">6.5</a>.  Procedures at a Trusted User Agent Server (UAS)</span>

   The procedures at a trusted UAS MUST be identical to those described
   in 6.4.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.6.%20%20Procedures%20at%20Proxy"></a><a class="selflink" href="#section-6.6" name="section-6.6">6.6</a>.  Procedures at Proxy</span>

   In the DCS architecture, the OSPS is considered a trusted UAC.  If a
   proxy receives a P-DCS-OSPS header in a request from an untrusted
   source, it MUST either remove the header or reject the request with a
   403-Forbidden response.

   A proxy that implements a call-forwarding service MUST NOT respond to
   an INVITE request with a 3xx response, if the request contained the
   P-DCS-OSPS header.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20P-DCS-BILLING-INFO"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  P-DCS-BILLING-INFO</span>

   There are many billing models used in deriving revenue from telephony
   services today.  Charging for telephony services is tightly coupled
   to the use of network resources.  It is outside the scope of this
   document to discuss the details of these numerous and varying
   methods.

   Proxies have access to subscriber information and act as policy
   decision points and trusted intermediaries along the call signaling
   path.  Edge routers provide the network connection and resource



<span class="grey">Marshall &amp; Andreasen         Informational                     [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc3603.html">RFC 3603</a>             SIP Proxy-to-Proxy Extensions          October 2003</span>


   policy enforcement mechanism and also capture and report network
   connection and resource usage information.  Edge routers need to be
   given billing information that can be logged with Record Keeping or
   Billing servers.  The proxy, as a central point of coordination
   between call signaling and resource management, can provide this
   information based on the authenticated identity of the calling and
   called parties.  Since there is a trust relationship among proxies,
   they can be relied upon to exchange trusted billing information
   pertaining to the parties involved in a call.

   For Usage Accounting records, it is necessary to have an identifier
   that can be associated with all the event records produced for the
   call.  The SIP Call-ID header field cannot be used as such an
   identifier since it is selected by the originating user agent, and
   may not be unique among all past calls as well as current calls.
   Further, since this identifier is to be used by the service provider,
   it should be chosen in a manner and in a format that meets the
   service provider's needs.

   Billing information may not necessarily be unique for each user
   (consider the case of calls from an office all billed to the same
   account).  Billing information may not necessarily be identical for
   all calls made by a single user (consider prepaid calls, credit card
   calls, collect calls, etc).  It is therefore necessary to carry
   billing information separate from the calling and called party
   identification.  Furthermore, some billing models call for split-
   charging where multiple entities are billed for portions of the call.

   The addition of a SIP General Header Field allows for the capture of
   billing information and billing identification for the duration of
   the call.

   It is the intent that the billing extensions would only appear on
   trusted network segments, and MAY be inserted by a proxy or trusted
   UA in INVITE requests in a trusted network segment, and removed
   before leaving trusted network segments.  The P-DCS-Billing-Info
   header extension is used only on requests and responses between
   proxies and trusted User Agents.  It is never sent to, nor sent by,
   an untrusted UA.












<span class="grey">Marshall &amp; Andreasen         Informational                     [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc3603.html">RFC 3603</a>             SIP Proxy-to-Proxy Extensions          October 2003</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.1.%20%20Syntax"></a><a class="selflink" href="#section-7.1" name="section-7.1">7.1</a>.  Syntax</span>

   The DCS-Billing-Info header is defined by the following ABNF (some
   terms used in this ABNF are defined in [<a href="#ref-2" title='"SIP: Session Initiation Protocol"'>2</a>]):

   P-DCS-Billing-Info      = "P-DCS-Billing-Info" HCOLON
                              Billing-Correlation-ID "/" FEID
                              *(SEMI Billing-Info-param)
   Billing-Correlation-ID  = 1*48(HEXDIG)
   FEID                    = 1*16(HEXDIG) "@" host
   Billing-Info-param      = RKS-Group-ID-param / Charge-param /
                             Calling-param / Called-param /
                             Routing-param / Loc-Routing-param /
                             generic-param
   RKS-Group-ID-param      = "rksgroup" EQUAL RKS-Group-ID
   RKS-Group-ID            = token
   Charge-param            = "charge" EQUAL Acct-Charge-URI
   Acct-Charge-URI         = LDQUOT addr-spec RDQUOT
   Calling-param           = "calling" EQUAL Acct-Calling-URI
   Acct-Calling-URI        = LDQUOT addr-spec RDQUOT
   Called-param            = "called" EQUAL Acct-Called-URI
   Acct-Called-URI         = LDQUOT addr-spec RDQUOT
   Routing-param           = "routing" EQUAL Acct-Routing-URI
   Acct-Routing-URI        = LDQUOT addr-spec RDQUOT
   Loc-Routing-param       = "locroute" EQUAL Acct-Loc-Routing-URI
   Acct-Loc-Routing-URI    = LDQUOT addr-spec RDQUOT

   This document adds the following entry to Table 2 of [<a href="#ref-2" title='"SIP: Session Initiation Protocol"'>2</a>]:

   Header field         where proxy  ACK  BYE  CAN  INV  OPT  REG
   ------------         ----- -----  ---  ---  ---  ---  ---  ---
   P-DCS-Billing-Info         admr    -    -    -    o    -    -


                                     SUB  NOT  REF  INF  UPD  PRA
                                     ---  ---  ---  ---  ---  ---
                                      -    -    -    -    -    -

   The P-DCS-Billing-Info extension contains an identifier that can be
   used by an event recorder to associate multiple usage records,
   possibly from different sources, with a billable account.  It further
   contains the subscriber account information, and other information
   necessary for accurate billing of the service.  This header is only
   used between proxies and trusted User Agents.

   The Billing-Correlation-ID is specified in [<a href="#ref-9" title="pkt-sp-em-i07-030815">9</a>] as a 24-byte binary
   structure, containing 4 bytes of NTP timestamp, 8 bytes of the unique
   identifier of the network element that generated the ID, 8 bytes



<span class="grey">Marshall &amp; Andreasen         Informational                     [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc3603.html">RFC 3603</a>             SIP Proxy-to-Proxy Extensions          October 2003</span>


   giving the time zone, and 4 bytes of monotonically increasing
   sequence number at that network element.  This identifier is chosen
   to be globally unique within the system for a window of several
   months.  This MUST be encoded in the P-DCS-Billing-Info header as a
   hexadecimal string of up to 48 characters.  Leading zeroes MAY be
   suppressed.

   The Financial-Entity-ID (FEID) is specified in [<a href="#ref-9" title="pkt-sp-em-i07-030815">9</a>] as an 8-byte
   structure, containing the financial identifier for that domain,
   followed by a domain name.  FEID can be associated with a type of
   service and could be assigned to multiple domains by the same
   provider.  A domain could contain multiple assigned FEIDs.  This 8-
   byte structure MUST be encoded in the P-DCS-Billing-Info header as a
   hexadecimal string of up to 16 characters.  Trailing zeroes MAY be
   suppressed.  "Host" contains the domain name.

   The RKS-Group-ID specifies a record keeping server (or group of
   cooperating servers) for event messages relating to this call.  It is
   used to control certain optimizations of procedures when multiple
   event message streams are being sent to the same Record Keeping
   Server.

   Additional parameters contain the information needed for generation
   of event message records.  Acct-Charge-URI, Acct-Calling-URI, Acct-
   Called-URI, Acct-Routing-URI, and Acct-Location-Routing-URI are each
   defined as URLs; they should all contain tel: URLs with E.164
   formatted addresses.  These fields are further defined in [<a href="#ref-9" title="pkt-sp-em-i07-030815">9</a>] under
   the element identifiers "Charge_Number" (element ID 16),
   "Calling_Party_Number" (element ID 4), "Called_Party_Number" (element
   ID 5), "Routing Number" (element ID 25), and
   "Location_Routing_Number" (element ID 22).

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.2.%20%20Procedures%20at%20an%20Untrusted%20User%20Agent%20Client%20%28UAC%29"></a><a class="selflink" href="#section-7.2" name="section-7.2">7.2</a>.  Procedures at an Untrusted User Agent Client (UAC)</span>

   This header is never sent to an untrusted UAC, and is never sent by
   an untrusted UAC.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.3.%20%20Procedures%20at%20a%20Trusted%20User%20Agent%20Client%20%28UAC%29"></a><a class="selflink" href="#section-7.3" name="section-7.3">7.3</a>.  Procedures at a Trusted User Agent Client (UAC)</span>

   The UAC MUST generate the Billing-Correlation-ID for the call, and
   insert it into the P-DCS-Billing-Info header in the initial INVITE
   message sent to the terminating proxy, along with the charging
   information for the call.  The UAC MUST include its FEID, and the
   RKS-Group-ID for the Record-Keeping-Server being used by the UAC. If
   the UAC performed a Local Number Portability (LNP) query, it MUST
   include the Routing Number and Location Routing Number returned by
   the query.




<span class="grey">Marshall &amp; Andreasen         Informational                     [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc3603.html">RFC 3603</a>             SIP Proxy-to-Proxy Extensions          October 2003</span>


   If the response to the initial INVITE is a 3xx-Redirect, the UAC
   generates a new initial INVITE request to the destination specified
   in the Contact: header, as per standard SIP.  If a UAC receives a
   3xx-Redirect response to an initial INVITE, the new INVITE generated
   by the UAC MUST contain the P-DCS-Billing-Info header from the 3xx-
   Redirect response.  If the UAC is acting as a B2BUA, instead of
   generating a new INVITE it MAY generate a private-URL and place it in
   the Contact header of a 3xx-Redirect response sent to the originating
   endpoint.  This private-URL MUST contain (or contain a pointer to)
   the P-DCS-Billing-Info value, which indicates the charging
   arrangement for the new call, and an expiration time very shortly in
   the future, to limit the ability of the originator to re-use this
   private-URL for multiple calls.

   A UAC that includes a Refer-to header in a REFER request MUST include
   a P-DCS-Billing-Info header in the Refer-to's URL.  This P-DCS-
   Billing-Info header MUST include the accounting information of the
   initiator of the REFER.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.4.%20%20Procedures%20at%20an%20Untrusted%20User%20Agent%20Server%20%28UAS%29"></a><a class="selflink" href="#section-7.4" name="section-7.4">7.4</a>.  Procedures at an Untrusted User Agent Server (UAS)</span>

   This header is never sent to an untrusted UAS, and is never sent by
   an untrusted UAS.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.5.%20%20Procedures%20at%20a%20Trusted%20User%20Agent%20Server%20%28UAS%29"></a><a class="selflink" href="#section-7.5" name="section-7.5">7.5</a>.  Procedures at a Trusted User Agent Server (UAS)</span>

   The UAS MUST include a P-DCS-Billing-Info header in the first
   reliable 1xx (except 100) or 2xx response to an initial INVITE
   message.  This P-DCS-Billing-Info header MUST include the Billing-
   Correlation-ID generated by the UAS, the FEID of the UAS, and the
   RKS-Group-ID of the Record-Keeping-Server being used by the UAS.  The
   UAS MAY change the values of Acct-Charge-URI if it wishes to override
   the billing information that was present in the INVITE (e.g., for a
   toll-free call).  The decision to do this and the contents of the new
   Acct-Charge-URI MUST be determined by service provider policy
   provisioned in the UAS.  If the UAS performed a LNP query, it MUST
   include the Routing Number and Location Routing Number returned by
   the query.

   The UAS MUST add a P-DCS-Billing-Info header to a 3xx-redirect
   response to an initial INVITE, giving the accounting information for
   the call forwarder, for the call segment from the destination to the
   forwarded-to destination.








<span class="grey">Marshall &amp; Andreasen         Informational                     [Page 15]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc3603.html">RFC 3603</a>             SIP Proxy-to-Proxy Extensions          October 2003</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.6.%20%20Procedures%20at%20Proxy"></a><a class="selflink" href="#section-7.6" name="section-7.6">7.6</a>.  Procedures at Proxy</span>

   Three sets of proxy procedures are defined: (1) the procedures at an
   originating proxy, (2) the procedures at a terminating proxy, and (3)
   the procedures at a tandem proxy.

   The originating proxy is a proxy that received the INVITE request
   from a non-trusted endpoint.

   The terminating proxy is a proxy that sends the INVITE request to a
   non-trusted endpoint.

   A proxy that is neither an originating proxy, nor a terminating
   proxy, is a tandem proxy.

   For purposes of mid-call changes, such as call transfers, the proxy
   that receives the request from a non-trusted endpoint is considered
   the initiating proxy; the proxy that sends the request to a non-
   trusted endpoint is considered the recipient proxy.  Procedures for
   the initiating proxy are included below with those for originating
   proxies, while procedures for the recipient proxy are included with
   those for terminating proxies.

   A proxy that both receives the INVITE request from an untrusted
   endpoint, and sends the INVITE request to a non-trusted endpoint,
   performs both sets of procedures.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/7.6.1.%20%20Procedures%20at%20Originating%20Proxy"></a><a class="selflink" href="#section-7.6.1" name="section-7.6.1">7.6.1</a>.  Procedures at Originating Proxy</span>

   The originating proxy MUST generate the Billing-Correlation-ID for
   the call, and insert it into the P-DCS-Billing-Info header in the
   initial INVITE message sent to the terminating proxy, along with the
   charging information for the call.  The originating proxy MUST
   include its FEID, and the RKS-Group-ID for the Record-Keeping-Server
   being used by the originating proxy.  If the originating proxy
   performed a LNP query, it MUST include the Routing Number and
   Location Routing Number returned by the query.  Any P-DCS-Billing-
   Info header present from an untrusted UA MUST be removed.

   If the Request-URI contains a private-URL, and the decoded username
   contains billing information, the originating proxy MUST generate a
   P-DCS-Billing-Info header with that decrypted information. Otherwise,
   the originating proxy MUST determine the accounting information for
   the call originator, and insert a P-DCS-Billing-Info header including
   that information.






<span class="grey">Marshall &amp; Andreasen         Informational                     [Page 16]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc3603.html">RFC 3603</a>             SIP Proxy-to-Proxy Extensions          October 2003</span>


   If the response to the initial INVITE is a 3xx-Redirect, received
   prior to a 18x, the originating proxy generates a new initial INVITE
   request to the destination specified in the Contact: header, as per
   standard SIP.  If an originating proxy receives a 3xx-Redirect
   response to an initial INVITE prior to a 18x response, the INVITE
   generated by the proxy MUST contain the P-DCS-Billing-Info header
   from the 3xx-Redirect response.

   If the response to the initial INVITE is a 3xx-Redirect, received
   after a 18x, the originating proxy generates a private-URL and places
   it in the Contact header of a 3xx-Redirect response sent to the
   originating endpoint.  This private-URL MUST contain (or contain a
   pointer to) the P-DCS-Billing-Info value, which indicate the charging
   arrangement for the new call, and an expiration time very shortly in
   the future, to limit the ability of the originator to re-use this
   private-URL for multiple calls.

   An originating proxy that processes a REFER request from an untrusted
   UA MUST include a P-DCS-Billing-Info header in the Refer-to's URL.
   This P-DCS-Billing-Info header MUST include the accounting
   information of the initiator.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/7.6.2.%20%20Procedures%20at%20Terminating%20Proxy"></a><a class="selflink" href="#section-7.6.2" name="section-7.6.2">7.6.2</a>.  Procedures at Terminating Proxy</span>

   The terminating proxy MUST NOT send the P-DCS-Billing-Info header to
   an untrusted destination.

   The terminating proxy MUST include a P-DCS-Billing-Info header in the
   first reliable 1xx (except 100) or 2xx response to an initial INVITE
   message.  This P-DCS-Billing-Info header MUST include the Billing-
   Correlation-ID generated by the terminating proxy, the FEID of the
   terminating proxy, and the RKS-Group-ID of the Record-Keeping-Server
   being used by the terminating proxy.  The terminating proxy MAY
   change the values of Acct-Charge-URI if it wishes to override the
   billing information that was present in the INVITE (e.g., for a
   toll-free call).  The decision to do this and the contents of the
   resulting P-DCS-Billing-Info header MUST be determined by service
   provider policy provisioned in the terminating proxy.  If the
   terminating proxy performed a LNP query, it MUST include the Routing
   Number and Location Routing Number returned by the query.

   The terminating proxy MUST add P-DCS-Billing-Info headers to a 3xx-
   redirect response to an initial INVITE, giving the accounting
   information for the call forwarder, for the call segment from the
   destination to the forwarded-to destination.






<span class="grey">Marshall &amp; Andreasen         Informational                     [Page 17]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc3603.html">RFC 3603</a>             SIP Proxy-to-Proxy Extensions          October 2003</span>


   A proxy receiving a mid-call REFER request that includes a Refer-to
   header generates a private-URL and places it in the Refer-to header
   sent to the endpoint.  This private-URL MUST contain the P-DCS-
   Billing-Info value, which indicate the charging arrangement for the
   new call, and an expiration time very shortly in the future, to limit
   the ability of the endpoint to re-use this private-URL for multiple
   calls.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/7.6.3.%20%20Procedures%20at%20Tandem%20Proxy"></a><a class="selflink" href="#section-7.6.3" name="section-7.6.3">7.6.3</a>.  Procedures at Tandem Proxy</span>

   If the tandem proxy performed a LNP query, it MUST insert the Routing
   Number and Location Routing Number returned by the query into the P-
   DCS-Billing-Info header in the first reliable 1xx/2xx/3xx (except
   100) response.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20P-DCS-LAES%20and%20P-DCS-REDIRECT"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  P-DCS-LAES and P-DCS-REDIRECT</span>

   NOTE:  According to <a href="rfc2804.html">RFC 2804</a> [<a href="#ref-5" title='"IETF Policy on Wiretapping"'>5</a>], the IETF supports documentation of
   lawful intercept technology if it is necessary to develop it.  The
   following section provides such documentation.  The <a href="rfc2119.html">RFC 2119</a>
   language, as stated above, describes the requirements of the
   specification only if implemented, and strictly within the
   applicability domain described above.  See <a href="rfc2804.html">RFC 2804</a> for description
   of issues regarding privacy, security, and complexity in relation to
   this technology.

   The P-DCS-LAES extension contains the information needed to support
   Lawfully Authorized Electronic Surveillance.  This header contains
   the address and port of an Electronic Surveillance Delivery Function
   for delivery of a duplicate stream of event messages related to this
   call.  The header may also contain an additional address and port for
   delivery of call content.  Security key information is included to
   enable pairs of Delivery Functions to securely exchange surveillance
   information.  This header is only used between proxies and trusted
   User Agents.

   The P-DCS-Redirect extension contains call identifying information
   needed to support the requirements of Lawfully Authorized Electronic
   Surveillance of redirected calls.  This header is only used between
   proxies and trusted User Agents.

   Use of P-DCS-LAES and P-DCS-Redirect is controlled by a combination
   of legislation, regulation, and court orders, which MUST be followed.
   In certain cases inclusion of these headers will be mandated, and
   therefore MUST be present in the requests and responses indicated.
   In other cases inclusion of these headers will be forbidden, and
   therefore MUST NOT be present in the request and responses indicated.
   In the sub-sections that follow, use of "SHOULD" is intended to



<span class="grey">Marshall &amp; Andreasen         Informational                     [Page 18]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-19" id="page-19" name="page-19"> </a>
<span class="grey"><a href="rfc3603.html">RFC 3603</a>             SIP Proxy-to-Proxy Extensions          October 2003</span>


   capture these conflicting situations, e.g., a P-DCS-LAES header
   SHOULD be included in an initial INVITE means either that it MUST be
   included or that it MUST NOT be included, based on the applicable
   court orders.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.1.%20%20Syntax"></a><a class="selflink" href="#section-8.1" name="section-8.1">8.1</a>.  Syntax</span>

   The formats of the P-DCS-LAES and P-DCS-Redirect headers are given by
   the following ABNF (some terms used in this ABNF are defined in [<a href="#ref-2" title='"SIP: Session Initiation Protocol"'>2</a>]
   and [<a href="#ref-3" title='"Augmented BNF for Syntax Specifications: ABNF"'>3</a>]):

      P-DCS-LAES        = "P-DCS-LAES" HCOLON Laes-sig
                          *(SEMI Laes-param)
      Laes-sig          = hostport
      Laes-param        = Laes-content / Laes-key / generic-param
      Laes-content      = "content" EQUAL hostport
      Laes-key          = "key" EQUAL token

      P-DCS-Redirect    = "P-DCS-Redirect" HCOLON Called-ID
                          *(redir-params)
      Called-ID         = LDQUOT addr-spec RDQUOT
      redir-params      = redir-uri-param / redir-count-param /
                          generic-param
      redir-uri-param   = "redirector-uri" EQUAL Redirector
      Redirector        = LDQUOT addr-spec RDQUOT
      redir-count-param = "count" EQUAL Redir-count
      Redir-count       = 1*DIGIT

   This document adds the following entry to Table 2 of [<a href="#ref-2" title='"SIP: Session Initiation Protocol"'>2</a>]:

      Header field         where proxy  ACK  BYE  CAN  INV  OPT  REG
      ------------         ----- -----  ---  ---  ---  ---  ---  ---
      P-DCS-LAES                  adr    -    -    -    o    -    -
      P-DCS-Redirect              adr    -    -    -    o    -    -


                                        SUB  NOT  REF  INF  UPD  PRA
                                        ---  ---  ---  ---  ---  ---
                                         -    -    -    -    -    -
                                         -    -    -    -    -    -

   The values of Laes-sig and Laes-content are addresses of the
   Electronic Surveillance Delivery Function, and used as the
   destination address for call-identifying information and call-
   content, respectively.  Laes-key is a string generated by the proxy
   that is used by the Delivery Function to securely transfer
   information between them [<a href="#ref-8" title="pkt-sp-sec-i09-030728">8</a>].




<span class="grey">Marshall &amp; Andreasen         Informational                     [Page 19]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-20" id="page-20" name="page-20"> </a>
<span class="grey"><a href="rfc3603.html">RFC 3603</a>             SIP Proxy-to-Proxy Extensions          October 2003</span>


   The P-DCS-Redirect header contains redirection information.  The
   redir-uri-param indicates the original destination requested by the
   user (e.g., dialed number), the Redirector indicates the new
   destination, and the Redir-count indicates the number of redirections
   that have occurred.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.2.%20%20Procedures%20at%20an%20Untrusted%20User%20Agent%20Client%20%28UAC%29"></a><a class="selflink" href="#section-8.2" name="section-8.2">8.2</a>.  Procedures at an Untrusted User Agent Client (UAC)</span>

   This header MUST NOT be sent to an untrusted UAC, and MUST NOT be
   sent by an untrusted UAC.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.3.%20%20Procedures%20at%20a%20Trusted%20User%20Agent%20Client%20%28UAC%29"></a><a class="selflink" href="#section-8.3" name="section-8.3">8.3</a>.  Procedures at a Trusted User Agent Client (UAC)</span>

   The UAC checks for an outstanding lawfully authorized surveillance
   order for the originating subscriber, and, if present, includes this
   information in the Authorization for Quality of Service [<a href="#ref-7" title="pkt-sp- dqos-i07-030815">7</a>] or
   signals this information to the device performing the intercept
   (e.g., a Media Gateway).

   If the P-DCS-LAES header is present in the first reliable 1xx (except
   100), 2xx or 3xx response (indicating surveillance is required on the
   terminating subscriber, but that the terminating equipment is unable
   to perform that function), the UAC MUST include this information in
   the Authorization for Quality of Service, or MUST signal this
   information to the device performing the intercept (e.g., a Media
   Gateway).

   If a 3xx-Redirect response is received to the initial INVITE request,
   and if a P-DCS-LAES header is present in the 3xx response, the UAC
   SHOULD include that header unchanged in the reissued INVITE. The UAC
   SHOULD also include a P-DCS-Redirect header containing the original
   dialed number, the new destination number, and the number of
   redirections that have occurred.  Although it is technically possible
   for the originating equipment to perform this surveillance (or add to
   its existing surveillance of the call), the design of the
   surveillance system has the terminating equipment performing the
   surveillance for all the intermediate forwardings.

   A UAC that includes a Refer-to header in a REFER request, when the
   originating subscriber has an outstanding lawfully authorized
   surveillance order, SHOULD include a P-DCS-LAES header attached to
   the Refer-to.  The P-DCS-LAES header SHOULD include the address and
   port of the local Electronic Surveillance Delivery Function for a
   copy of the call's event messages, SHOULD include the address and
   port of the local Electronic Surveillance Delivery Function for the
   copy of call content if call content is to be intercepted, and SHOULD
   include a random string for use as a security key between the
   Delivery Functions.



<span class="grey">Marshall &amp; Andreasen         Informational                     [Page 20]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-21" id="page-21" name="page-21"> </a>
<span class="grey"><a href="rfc3603.html">RFC 3603</a>             SIP Proxy-to-Proxy Extensions          October 2003</span>


   The trusted UAC MUST NOT send the P-DCS-LAES and P-DCS-Redirect
   headers to an untrusted entity.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.4.%20%20Procedures%20at%20an%20Untrusted%20User%20Agent%20Server%20%28UAS%29"></a><a class="selflink" href="#section-8.4" name="section-8.4">8.4</a>.  Procedures at an Untrusted User Agent Server (UAS)</span>

   This header MUST NOT be sent to an untrusted UAS, and MUST NOT be
   sent by an untrusted UAS.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.5.%20%20Procedures%20at%20a%20Trusted%20User%20Agent%20Server%20%28UAS%29"></a><a class="selflink" href="#section-8.5" name="section-8.5">8.5</a>.  Procedures at a Trusted User Agent Server (UAS)</span>

   The UAS checks for an outstanding lawfully authorized surveillance
   order for the terminating subscriber, or presence of the P-DCS-LAES
   header in the INVITE request.  If either is present, the UAS includes
   this information in the authorization for Quality of Service [<a href="#ref-7" title="pkt-sp- dqos-i07-030815">7</a>].

   If the terminating equipment is unable to perform the required
   surveillance (e.g., if the destination is a voicemail server), the
   UAS SHOULD include a P-DCS-LAES header in the first reliable non-100
   response requesting the originating proxy to perform the
   surveillance.  The P-DCS-LAES header SHOULD include the address and
   port of the local Electronic Surveillance Delivery Function for a
   copy of the call's event messages, SHOULD include the address and
   port of the local Electronic Surveillance Delivery Function for the
   copy of call content if call content is to be intercepted, and SHOULD
   include a random string for use as a security key between the
   Delivery Functions.

   If the response to the initial INVITE request is a 3xx-Redirect
   response, and there is an outstanding lawfully authorized
   surveillance order for the terminating subscriber, the UAS SHOULD
   include a P-DCS-LAES header in the 3xx-Redirect response, with
   contents as described above.

   The trusted UAS MUST NOT send the P-DCS-LAES and P-DCS-Redirect
   headers to an untrusted entity.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.6.%20%20Procedures%20at%20Proxy"></a><a class="selflink" href="#section-8.6" name="section-8.6">8.6</a>.  Procedures at Proxy</span>

   Two sets of proxy procedures are defined: (1) the procedures at an
   originating proxy, and (2) the procedures at a terminating proxy. The
   originating proxy is a proxy that received the INVITE request from a
   non-trusted endpoint.

   The terminating proxy is a proxy that sends the INVITE request to a
   non-trusted endpoint.






<span class="grey">Marshall &amp; Andreasen         Informational                     [Page 21]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-22" id="page-22" name="page-22"> </a>
<span class="grey"><a href="rfc3603.html">RFC 3603</a>             SIP Proxy-to-Proxy Extensions          October 2003</span>


   For purposes of mid-call changes, such as call transfers, the proxy
   that receives the request from a non-trusted endpoint is considered
   the initiating proxy; the proxy that sends the request to a non-
   trusted endpoint is considered the recipient proxy.  Procedures for
   the initiating proxy are included below with those for originating
   proxies, while procedures for the recipient proxy are included with
   those for terminating proxies.

   A proxy that both receives the INVITE request from an untrusted
   endpoint, and sends the INVITE request to a non-trusted endpoint,
   MUST NOT generate P-DCS-LAES nor P-DCS-Redirect headers.

   A proxy that is neither an originating proxy nor a terminating proxy
   SHOULD pass the P-DCS-Laes and P-DCS-Redirect headers in requests and
   responses.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/8.6.1.%20%20Procedures%20at%20Originating%20Proxy"></a><a class="selflink" href="#section-8.6.1" name="section-8.6.1">8.6.1</a>.  Procedures at Originating Proxy</span>

   The Originating Proxy MUST remove any P-DCS-LAES and P-DCS-Redirect
   headers in requests or responses to or from an untrusted proxy or
   untrusted UA.

   The originating proxy checks for an outstanding lawfully authorized
   surveillance order for the originating subscriber, and, if present,
   includes this information in the Authorization for Quality of Service
   [<a href="#ref-7" title="pkt-sp- dqos-i07-030815">7</a>] or signals this information to the device performing the
   intercept (e.g., a Media Gateway).

   If the P-DCS-LAES header is present in the first reliable 1xx (except
   100), 2xx or 3xx response (indicating surveillance is required on the
   terminating subscriber, but that the terminating equipment is unable
   to perform that function), the originating proxy MUST include this
   information in the Authorization for Quality of Service, or MUST
   signal this information to the device performing the intercept (e.g.,
   a Media Gateway).

   If the Request-URI in an initial INVITE request contains a private-
   URL, the originating proxy MUST decrypt the userinfo information to
   find the real destination for the call, and other special processing
   information.  If electronic surveillance information is contained in
   the decrypted userinfo, the originating proxy SHOULD generate a P-
   DCS-LAES header with the surveillance information.

   If a 3xx-Redirect response is received to the initial INVITE request
   prior to a 18x, and if a P-DCS-LAES header is present in the 3xx
   response, the originating proxy SHOULD include that header unchanged
   in the reissued INVITE.  The originating proxy SHOULD also include a




<span class="grey">Marshall &amp; Andreasen         Informational                     [Page 22]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-23" id="page-23" name="page-23"> </a>
<span class="grey"><a href="rfc3603.html">RFC 3603</a>             SIP Proxy-to-Proxy Extensions          October 2003</span>


   P-DCS-Redirect header containing the original dialed number, the new
   destination number, and the number of redirections that have
   occurred.

   If a 3xx-Redirect response is received to the initial INVITE request
   after a 18x, the originating proxy generates a private-URL and places
   it in the Contact header of a 3xx-Redirect response sent to the
   originating endpoint.  If a P-DCS-LAES header is present in the 3xx
   response, this private-URL MUST contain (1) the electronic
   surveillance information from the 3xx-Redirect response, (2) the
   original destination number, (3) the identity of the redirecting
   party, and (4) the number of redirections of this call.

   An originating proxy that processes a REFER request [<a href="#ref-4" title='"The Session Initiation Protocol (SIP) Refer Method"'>4</a>] from an
   untrusted UA, when the originating subscriber has an outstanding
   lawfully authorized surveillance order, becomes a B2BUA for that
   request.  It SHOULD reissue the request with a P-DCS-LAES header
   added to the Refer-to's URL.  The P-DCS-LAES header SHOULD include
   (1) the address and port of the local Electronic Surveillance
   Delivery Function for a copy of the call's event messages, (2) the
   address and port of the local Electronic Surveillance Delivery
   Function for the copy of call content if call content is to be
   intercepted, and (3) a random string for use as a security key
   between the Delivery Functions.

   An initiating proxy that sends a mid-call REFER request including a
   Refer-to header, when the initiating subscriber has an outstanding
   lawfully authorized surveillance order, SHOULD include a P-DCS-LAES
   header in the Refer-to's URL.

   The originating proxy MUST NOT send the P-DCS-LAES and P-DCS-Redirect
   headers to an untrusted entity.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/8.6.2.%20%20Procedures%20at%20Terminating%20Proxy"></a><a class="selflink" href="#section-8.6.2" name="section-8.6.2">8.6.2</a>.  Procedures at Terminating Proxy</span>

   The Terminating Proxy MUST remove any P-DCS-LAES and P-DCS-Redirect
   headers in requests or responses to or from an untrusted proxy or UA.

   The terminating proxy checks for an outstanding lawfully authorized
   surveillance order for the terminating subscriber.  If present, the
   terminating proxy includes this information in the authorization for
   Quality of Service [<a href="#ref-7" title="pkt-sp- dqos-i07-030815">7</a>].

   The terminating proxy MUST NOT send the P-DCS-LAES and P-DCS-Redirect
   headers to an untrusted entity, either as headers in the request or
   response, or as headers attached to URIs in the request or response.





<span class="grey">Marshall &amp; Andreasen         Informational                     [Page 23]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-24" id="page-24" name="page-24"> </a>
<span class="grey"><a href="rfc3603.html">RFC 3603</a>             SIP Proxy-to-Proxy Extensions          October 2003</span>


   If the terminating equipment is unable to perform the required
   surveillance (e.g., if the destination is a voicemail server), the
   terminating proxy SHOULD include a P-DCS-LAES header in the first
   reliable 1xx/2xx/3xx (except 100) response requesting the originating
   proxy to perform the surveillance.  The P-DCS-LAES header SHOULD
   include the address and port of the local Electronic Surveillance
   Delivery Function for a copy of the call's event messages, SHOULD
   include the address and port of the local Electronic Surveillance
   Delivery Function for the copy of call content if call content is to
   be intercepted, and SHOULD include a random string for use as a
   security key between the Delivery Functions.

   If the response to the initial INVITE request is a 3xx-Redirect
   response, and there is an outstanding lawfully authorized
   surveillance order for the terminating subscriber, the terminating
   proxy SHOULD include a P-DCS-LAES header in the 3xx-Redirect
   response, with contents as described above.

   A proxy receiving a mid-call REFER request [<a href="#ref-4" title='"The Session Initiation Protocol (SIP) Refer Method"'>4</a>] that includes a
   Refer-to header with a P-DCS-LAES header attached becomes a B2BUA for
   this request.  It MUST generate a private-URL and place it in the
   Refer-to header sent to the endpoint.  This private-URL MUST contain
   the P-DCS-LAES information from the attached header.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/9.%20%20Security%20Considerations"></a><a class="selflink" href="#section-9" name="section-9">9</a>.  Security Considerations</span>

   QoS gate coordination, billing information, and electronic
   surveillance information are all considered to be sensitive
   information that MUST be protected from eavesdropping and furthermore
   require integrity checking.  It is therefore necessary that the
   trusted UAs and proxies take precautions to protect this information
   from eavesdropping and tampering.  Use of IPsec or TLS between
   Proxies is REQUIRED.  A minimum mandatory-to-implement IPsec
   configuration for the DCS architecture is given by [<a href="#ref-8" title="pkt-sp-sec-i09-030728">8</a>].  Also
   REQUIRED is mutual authentication (1) between Proxies and (2) between
   trusted UAs and Proxies, both of which MAY be implemented with
   administratively pre-shared keys, or through consultation with
   another trusted third party.  If IPsec is to be used, the
   specification of the security policies and procedures of the
   administrative domain where these headers are applicable (and all
   connections between administrative domains in the federation) MUST
   define an interoperable set of options.









<span class="grey">Marshall &amp; Andreasen         Informational                     [Page 24]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-25" id="page-25" name="page-25"> </a>
<span class="grey"><a href="rfc3603.html">RFC 3603</a>             SIP Proxy-to-Proxy Extensions          October 2003</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/10.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-10" name="section-10">10</a>.  IANA Considerations</span>

   This document defines a number of SIP extension headers, which have
   been included in the registry of SIP headers defined in [<a href="#ref-2" title='"SIP: Session Initiation Protocol"'>2</a>].
   Registration information for new headers is as follows:

   Header Field Name:   P-DCS-Trace-Party-ID
        RFC Number:     3603
        Compact Form:   none

   Header Field Name:   P-DCS-OSPS
        RFC Number:     3603
        Compact Form:   none

   Header Field Name:   P-DCS-Billing-Info
        RFC Number:     3603
        Compact Form:   none

   Header Field Name:   P-DCS-LAES
        RFC Number:     3603
        Compact Form:   none

   Header Field Name:   P-DCS-Redirect
        RFC Number:     3603
        Compact Form:   none

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/11.%20%20Intellectual%20Property%20Rights%20Notice"></a><a class="selflink" href="#section-11" name="section-11">11</a>.  Intellectual Property Rights Notice</span>

   The IETF has been notified of intellectual property rights claimed in
   regard to some or all of the specification contained in this
   document.  For more information consult the online list of claimed
   rights.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/12.%20%20References"></a><a class="selflink" href="#section-12" name="section-12">12</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/12.1.%20%20Normative%20References"></a><a class="selflink" href="#section-12.1" name="section-12.1">12.1</a>.  Normative References</span>

   [<a id="ref-1" name="ref-1">1</a>]  Bradner, S., "Key words for use in RFCs to Indicate Requirement
        Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a id="ref-2" name="ref-2">2</a>]  Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A.,
        Peterson, J., Sparks, R., Handley, M. and E. Schooler, "SIP:
        Session Initiation Protocol", <a href="rfc3261.html">RFC 3261</a>, June 2002.

   [<a id="ref-3" name="ref-3">3</a>]  Crocker, D., Ed. and P. Overell, "Augmented BNF for Syntax
        Specifications: ABNF", <a href="rfc2234.html">RFC 2234</a>, November 1997.





<span class="grey">Marshall &amp; Andreasen         Informational                     [Page 25]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-26" id="page-26" name="page-26"> </a>
<span class="grey"><a href="rfc3603.html">RFC 3603</a>             SIP Proxy-to-Proxy Extensions          October 2003</span>


   [<a id="ref-4" name="ref-4">4</a>]  Sparks, R., "The Session Initiation Protocol (SIP) Refer
        Method", <a href="rfc3515.html">RFC 3515</a>, April 2003.

   [<a id="ref-5" name="ref-5">5</a>]  IAB and IESG, "IETF Policy on Wiretapping", <a href="rfc2804.html">RFC 2804</a>, May 2000.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/12.2.%20Informative%20References"></a><a class="selflink" href="#section-12.2" name="section-12.2">12.2</a>. Informative References</span>

   [<a id="ref-6" name="ref-6">6</a>]  DCS Group, "Architectural Considerations for Providing Carrier
        Class Telephony Services Utilizing SIP-based Distributed Call
        Control Mechanisms", Work in Progress.

   [<a id="ref-7" name="ref-7">7</a>]  PacketCable Dynamic Quality of Service Specification, pkt-sp-
        dqos-i07-030815, August 2003.

   [<a id="ref-8" name="ref-8">8</a>]  PacketCable Security Specification, pkt-sp-sec-i09-030728, July
        2003.

   [<a id="ref-9" name="ref-9">9</a>]  PacketCable Event Message Specification, pkt-sp-em-i07-030815,
        August 2003.

   [<a id="ref-10" name="ref-10">10</a>] Jennings, C., Peterson, J. and M. Watson, "Private Extensions to
        the Session Initiation Protocol (SIP) for Asserted Identity
        within Trusted Networks", <a href="rfc3325.html">RFC 3325</a>, November 2002.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/13.%20%20Acknowledgements"></a><a class="selflink" href="#section-13" name="section-13">13</a>.  Acknowledgements</span>

   The Distributed Call Signaling work in the PacketCable project is the
   work of a large number of people, representing many different
   companies.  The authors would like to recognize and thank the
   following for their assistance: John Wheeler, Motorola; David
   Boardman, Daniel Paul, Arris Interactive; Bill Blum, Jon Fellows, Jay
   Strater, Jeff Ollis, Clive Holborow, Motorola; Doug Newlin, Guido
   Schuster, Ikhlaq Sidhu, 3Com; Jiri Matousek, Bay Networks; Farzi
   Khazai, Nortel; John Chapman, Bill Guckel, Michael Ramalho, Cisco;
   Chuck Kalmanek, Doug Nortz, John Lawser, James Cheng, Tung- Hai
   Hsiao, Partho Mishra, AT&amp;T; Telcordia Technologies; and Lucent Cable
   Communications.

   Previous versions further acknowledged, as co-authors, several people
   for providing the text of this document.  They are:

      Bill Marshall (wtm@research.att.com) and K. K. Ramakrishnan
      (kkrama@research.att.com), AT&amp;T; Ed Miller
      (edward.miller@terayon.com), Terayon; Glenn Russell
      (G.Russell@Cablelabs.com), CableLabs; Burcak Beser
      (burcak@juniper.net) Juniper Networks, Mike Mannette
      (Michael_Mannette@3com.com) and Kurt Steinbrenner
      (Kurt_Steinbrenner@3com.com), 3Com; Dave Oran (oran@cisco.com) and



<span class="grey">Marshall &amp; Andreasen         Informational                     [Page 26]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-27" id="page-27" name="page-27"> </a>
<span class="grey"><a href="rfc3603.html">RFC 3603</a>             SIP Proxy-to-Proxy Extensions          October 2003</span>


      Flemming Andreasen (fandreas@cisco.com), Cisco Systems; John
      Pickens (jpickens@com21.com), Com21; Poornima Lalwaney
      (poornima.lalwaney@nokia.com), Nokia; Jon Fellows
      (jfellows@coppermountain.com), Copper Mountain Networks; Doc Evans
      (n7dr@arrisi.com) Arris, and Keith Kelly (keith@netspeak.com),
      NetSpeak.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/14.%20%20Editors%27%20Addresses"></a><a class="selflink" href="#section-14" name="section-14">14</a>.  Editors' Addresses</span>

   Bill Marshall
   AT&amp;T
   Florham Park, NJ  07932

   EMail: wtm@research.att.com


   Flemming Andreasen
   Cisco
   Edison, NJ

   EMail: fandreas@cisco.com






























<span class="grey">Marshall &amp; Andreasen         Informational                     [Page 27]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-28" id="page-28" name="page-28"> </a>
<span class="grey"><a href="rfc3603.html">RFC 3603</a>             SIP Proxy-to-Proxy Extensions          October 2003</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/15.%20%20Full%20Copyright%20Statement"></a><a class="selflink" href="#section-15" name="section-15">15</a>.  Full Copyright Statement</span>

   Copyright (C) The Internet Society (2003).  All Rights Reserved.

   This document and translations of it may be copied and furnished to
   others, and derivative works that comment on or otherwise explain it
   or assist in its implementation may be prepared, copied, published
   and distributed, in whole or in part, without restriction of any
   kind, provided that the above copyright notice and this paragraph are
   included on all such copies and derivative works.  However, this
   document itself may not be modified in any way, such as by removing
   the copyright notice or references to the Internet Society or other
   Internet organizations, except as needed for the purpose of
   developing Internet standards in which case the procedures for
   copyrights defined in the Internet Standards process must be
   followed, or as required to translate it into languages other than
   English.

   The limited permissions granted above are perpetual and will not be
   revoked by the Internet Society or its successors or assignees.

   This document and the information contained herein is provided on an
   "AS IS" basis and THE INTERNET SOCIETY AND THE INTERNET ENGINEERING
   TASK FORCE DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING
   BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE INFORMATION
   HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED WARRANTIES OF
   MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Acknowledgement

   Funding for the RFC Editor function is currently provided by the
   Internet Society.



















Marshall &amp; Andreasen         Informational                     [Page 28]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc3603 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:45 GMT --></html>