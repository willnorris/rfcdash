<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc6176 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:31 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="draft-turner-ssl-must-not" name="DC.Relation.Replaces"/>
<meta content="urn:ietf:rfc:6176" name="DC.Identifier"/>
<meta content="March, 2011" name="DC.Date.Issued"/>
<meta content="&lt;&gt;, Sean Turner" name="DC.Creator"/>
<meta content="&lt;&gt;, Tim Polk" name="DC.Creator"/>
<meta content="This document requires that when Transport Layer Security (TLS)
clients and servers establish connections, they never negotiate the
use of Secure Sockets Layer (SSL) version 2.0. This document updates
the backward compatibility sections found in the Transport Layer
Security (TLS). [STANDARDS-TRACK]" name="DC.Description.Abstract"/>
<meta content="Prohibiting Secure Sockets Layer (SSL) Version 2.0" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 6176 - Prohibiting Secure Sockets Layer (SSL) Version 2.0</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgblue" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc6176.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc6176" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-tls-ssl2-must-not" title="draft-ietf-tls-ssl2-must-not">draft-ietf-tls-...</a>] [<a href="https://datatracker.ietf.org/doc/rfc6176" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc6176" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc6176" title="Side-by-side diff">Diff2</a>]         </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                       PROPOSED STANDARD</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Internet Engineering Task Force (IETF)                         S. Turner
Request for Comments: 6176                                          IECA
Updates: <a href="rfc2246.html">2246</a>, <a href="rfc4346.html">4346</a>, <a href="rfc5246.html">5246</a>                                        T. Polk
Category: Standards Track                                           NIST
ISSN: 2070-1721                                               March 2011


           <span class="h1">Prohibiting Secure Sockets Layer (SSL) Version 2.0</span>

Abstract

   This document requires that when Transport Layer Security (TLS)
   clients and servers establish connections, they never negotiate the
   use of Secure Sockets Layer (SSL) version 2.0.  This document updates
   the backward compatibility sections found in the Transport Layer
   Security (TLS).

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="rfc5741.html#section-2">Section 2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc6176">http://www.rfc-editor.org/info/rfc6176</a>.

Copyright Notice

   Copyright (c) 2011 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.






<span class="grey">Turner &amp; Polk                Standards Track                    [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc6176.html">RFC 6176</a>                   Prohibiting SSL 2.0                March 2011</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   Many protocols specified in the IETF rely on Transport Layer Security
   (TLS) [<a href="#ref-TLS1.0" title='"The TLS Protocol Version 1.0"'>TLS1.0</a>][TLS1.1][<a href="#ref-TLS1.2" title='"The Transport Layer Security (TLS) Protocol Version 1.2"'>TLS1.2</a>] for security services.  This is a good
   thing, but some TLS clients and servers also support negotiating the
   use of Secure Sockets Layer (SSL) version 2.0 [<a href="#ref-SSL2" title='"The SSL Protocol"'>SSL2</a>]; however, this
   version does not provide a sufficiently high level of security.  SSL
   version 2.0 has known deficiencies.  This document describes those
   deficiencies, and it requires that TLS clients and servers never
   negotiate the use of SSL version 2.0.

   <a href="rfc4346.html">RFC 4346</a> [<a href="#ref-TLS1.1" title='"The Transport Layer Security (TLS) Protocol Version 1.1"'>TLS1.1</a>], and later <a href="rfc5246.html">RFC 5246</a> [<a href="#ref-TLS1.2" title='"The Transport Layer Security (TLS) Protocol Version 1.2"'>TLS1.2</a>], explicitly warned
   implementers that the "ability to send version 2.0 CLIENT-HELLO
   messages will be phased out with all due haste".  This document
   accomplishes this by updating the backward compatibility sections
   found in TLS [<a href="#ref-TLS1.0" title='"The TLS Protocol Version 1.0"'>TLS1.0</a>][TLS1.1][<a href="#ref-TLS1.2" title='"The Transport Layer Security (TLS) Protocol Version 1.2"'>TLS1.2</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.1.%20%20Requirements%20Terminology"></a><a class="selflink" href="#section-1.1" name="section-1.1">1.1</a>.  Requirements Terminology</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in
   [<a href="rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20SSL%202.0%20Deficiencies"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  SSL 2.0 Deficiencies</span>

   SSL version 2.0 [<a href="#ref-SSL2" title='"The SSL Protocol"'>SSL2</a>] deficiencies include the following:

   o  Message authentication uses MD5 [<a href="#ref-MD5" title='"The MD5 Message-Digest Algorithm"'>MD5</a>].  Most security-aware users
      have already moved away from any use of MD5 [<a href="rfc6151.html" title='"Updated Security Considerations for the MD5 Message-Digest and the HMAC-MD5 Algorithms"'>RFC6151</a>].

   o  Handshake messages are not protected.  This permits a man-in-the-
      middle to trick the client into picking a weaker cipher suite than
      it would normally choose.

   o  Message integrity and message encryption use the same key, which
      is a problem if the client and server negotiate a weak encryption
      algorithm.

   o  Sessions can be easily terminated.  A man-in-the-middle can easily
      insert a TCP FIN to close the session, and the peer is unable to
      determine whether or not it was a legitimate end of the session.









<span class="grey">Turner &amp; Polk                Standards Track                    [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc6176.html">RFC 6176</a>                   Prohibiting SSL 2.0                March 2011</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Changes%20to%20TLS"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Changes to TLS</span>

   Because of the deficiencies noted in the previous section:

   o  TLS clients MUST NOT send the SSL version 2.0 compatible CLIENT-
      HELLO message format.  Clients MUST NOT send any ClientHello
      message that specifies a protocol version less than
      { 0x03, 0x00 }.  As previously stated by the definitions of all
      previous versions of TLS, the client SHOULD specify the highest
      protocol version it supports.

   o  TLS servers MAY continue to accept ClientHello messages in the
      version 2 CLIENT-HELLO format as specified in <a href="rfc5246.html">RFC 5246</a> [<a href="#ref-TLS1.2" title='"The Transport Layer Security (TLS) Protocol Version 1.2"'>TLS1.2</a>],
      <a href="#appendix-E.2">Appendix E.2</a>.  Note that this does not contradict the prohibition
      against actually negotiating the use of SSL 2.0.

   o  TLS servers MUST NOT reply with an SSL 2.0 SERVER-HELLO with a
      protocol version that is less than { 0x03, 0x00 } and instead MUST
      abort the connection, i.e., when the highest protocol version
      offered by the client is { 0x02, 0x00 }, the TLS connection will
      be refused.

   Note that the number of servers that support this above-mentioned
   "MAY accept" implementation option is declining, and the SSL 2.0
   CLIENT-HELLO precludes the use of TLS protocol enhancements that
   require TLS extensions.  TLS extensions can only be sent as part of
   an (Extended) ClientHello handshake message.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Security%20Considerations"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Security Considerations</span>

   This entire document is about security considerations.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Acknowledgements"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Acknowledgements</span>

   The idea for this document was inspired by discussions between Peter
   Saint Andre, Simon Josefsson, and others on the Extensible Messaging
   and Presence Protocol (XMPP) mailing list.

   We would also like to thank Michael D'Errico, Paul Hoffman, Nikos
   Mavrogiannopoulos, Tom Petch, Yngve Pettersen, Marsh Ray, Martin Rex,
   Yaron Sheffer, and Glen Zorn for their reviews and comments.










<span class="grey">Turner &amp; Polk                Standards Track                    [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc6176.html">RFC 6176</a>                   Prohibiting SSL 2.0                March 2011</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20References"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.1.%20%20Normative%20References"></a><a class="selflink" href="#section-6.1" name="section-6.1">6.1</a>.  Normative References</span>

   [<a id="ref-RFC2119" name="ref-RFC2119">RFC2119</a>]   Bradner, S., "Key words for use in RFCs to Indicate
               Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a id="ref-TLS1.0" name="ref-TLS1.0">TLS1.0</a>]    Dierks, T. and C. Allen, "The TLS Protocol Version 1.0",
               <a href="rfc2246.html">RFC 2246</a>, January 1999.

   [<a id="ref-TLS1.1" name="ref-TLS1.1">TLS1.1</a>]    Dierks, T. and E. Rescorla, "The Transport Layer Security
               (TLS) Protocol Version 1.1", <a href="rfc4346.html">RFC 4346</a>, April 2006.

   [<a id="ref-TLS1.2" name="ref-TLS1.2">TLS1.2</a>]    Dierks, T. and E. Rescorla, "The Transport Layer Security
               (TLS) Protocol Version 1.2", <a href="rfc5246.html">RFC 5246</a>, August 2008.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.2.%20%20Informative%20References"></a><a class="selflink" href="#section-6.2" name="section-6.2">6.2</a>.  Informative References</span>

   [<a id="ref-MD5" name="ref-MD5">MD5</a>]       Rivest, R., "The MD5 Message-Digest Algorithm", <a href="rfc1321.html">RFC 1321</a>,
               April 1992.

   [<a id="ref-SSL2" name="ref-SSL2">SSL2</a>]      Hickman, Kipp, "The SSL Protocol", Netscape
               Communications Corp., Feb 9, 1995.

   [<a id="ref-RFC6151" name="ref-RFC6151">RFC6151</a>]   Turner, S. and L. Chen, "Updated Security Considerations
               for the MD5 Message-Digest and the HMAC-MD5 Algorithms",
               <a href="rfc6151.html">RFC 6151</a>, March 2011.

Authors' Addresses

   Sean Turner
   IECA, Inc.
   3057 Nutley Street, Suite 106
   Fairfax, VA 22031
   USA

   EMail: turners@ieca.com

   Tim Polk
   National Institute of Standards and Technology
   100 Bureau Drive, Mail Stop 8930
   Gaithersburg, MD 20899-8930
   USA

   EMail: tim.polk@nist.gov






Turner &amp; Polk                Standards Track                    [Page 4]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc6176 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:31 GMT --></html>