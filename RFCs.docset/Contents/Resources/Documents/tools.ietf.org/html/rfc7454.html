<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc7454 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:21 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="draft-jdurand-bgp-security" name="DC.Relation.Replaces"/>
<meta content="urn:ietf:rfc:7454" name="DC.Identifier"/>
<meta content="February, 2015" name="DC.Date.Issued"/>
<meta content="Doering, Gert" name="DC.Creator"/>
<meta content="Durand, Jerome" name="DC.Creator"/>
<meta content="Pepelnjak, Ivan" name="DC.Creator"/>
<meta content="The Border Gateway Protocol (BGP) is the protocol almost exclusively
used in the Internet to exchange routing information between network
domains. Due to this central nature, it is important to understand the
security measures that can and should be deployed to prevent
accidental or intentional routing disturbances.  This document
describes measures to protect the BGP sessions itself such as Time to
Live (TTL), the TCP Authentication Option (TCP-AO), and control-plane
filtering. It also describes measures to better control the flow of
routing information, using prefix filtering and automation of prefix
filters, max-prefix filtering, Autonomous System (AS) path filtering,
route flap dampening, and BGP community scrubbing." name="DC.Description.Abstract"/>
<meta content="BGP Operations and Security" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 7454 - BGP Operations and Security</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgmagenta" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc7454.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc7454" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-opsec-bgp-security" title="draft-ietf-opsec-bgp-security">draft-ietf-opse...</a>] [<a href="https://datatracker.ietf.org/doc/rfc7454" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc7454" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc7454" title="Side-by-side diff">Diff2</a>]         </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                   BEST CURRENT PRACTICE</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Internet Engineering Task Force (IETF)                         J. Durand
Request for Comments: 7454                           Cisco Systems, Inc.
BCP: 194                                                    I. Pepelnjak
Category: Best Current Practice                                      NIL
ISSN: 2070-1721                                               G. Doering
                                                                SpaceNet
                                                           February 2015


                      <span class="h1">BGP Operations and Security</span>

Abstract

   The Border Gateway Protocol (BGP) is the protocol almost exclusively
   used in the Internet to exchange routing information between network
   domains.  Due to this central nature, it is important to understand
   the security measures that can and should be deployed to prevent
   accidental or intentional routing disturbances.

   This document describes measures to protect the BGP sessions itself
   such as Time to Live (TTL), the TCP Authentication Option (TCP-AO),
   and control-plane filtering.  It also describes measures to better
   control the flow of routing information, using prefix filtering and
   automation of prefix filters, max-prefix filtering, Autonomous System
   (AS) path filtering, route flap dampening, and BGP community
   scrubbing.

Status of This Memo

   This memo documents an Internet Best Current Practice.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   BCPs is available in <a href="rfc5741.html#section-2">Section 2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc7454">http://www.rfc-editor.org/info/rfc7454</a>.











<span class="grey">Durand, et al.            Best Current Practice                 [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc7454.html">RFC 7454</a>                        BGP OPSEC                  February 2015</span>


Copyright Notice

   Copyright (c) 2015 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.





































<span class="grey">Durand, et al.            Best Current Practice                 [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc7454.html">RFC 7454</a>                        BGP OPSEC                  February 2015</span>


Table of Contents

   <a href="#section-1">1</a>.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-4">4</a>
     <a href="#section-1.1">1.1</a>.  Requirements Language . . . . . . . . . . . . . . . . . .   <a href="#page-4">4</a>
   <a href="#section-2">2</a>.  Scope of the Document . . . . . . . . . . . . . . . . . . . .   <a href="#page-4">4</a>
   <a href="#section-3">3</a>.  Definitions and Acronyms  . . . . . . . . . . . . . . . . . .   <a href="#page-4">4</a>
   <a href="#section-4">4</a>.  Protection of the BGP Speaker . . . . . . . . . . . . . . . .   <a href="#page-5">5</a>
   <a href="#section-5">5</a>.  Protection of BGP Sessions  . . . . . . . . . . . . . . . . .   <a href="#page-6">6</a>
     <a href="#section-5.1">5.1</a>.  Protection of TCP Sessions Used by BGP  . . . . . . . . .   <a href="#page-6">6</a>
     <a href="#section-5.2">5.2</a>.  BGP TTL Security (GTSM) . . . . . . . . . . . . . . . . .   <a href="#page-6">6</a>
   <a href="#section-6">6</a>.  Prefix Filtering  . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-7">7</a>
     <a href="#section-6.1">6.1</a>.  Definition of Prefix Filters  . . . . . . . . . . . . . .   <a href="#page-7">7</a>
       <a href="#section-6.1.1">6.1.1</a>.  Special-Purpose Prefixes  . . . . . . . . . . . . . .   <a href="#page-7">7</a>
       <a href="#section-6.1.2">6.1.2</a>.  Unallocated Prefixes  . . . . . . . . . . . . . . . .   <a href="#page-8">8</a>
       <a href="#section-6.1.3">6.1.3</a>.  Prefixes That Are Too Specific  . . . . . . . . . . .  <a href="#page-12">12</a>
       6.1.4.  Filtering Prefixes Belonging to the Local AS and
               Downstreams . . . . . . . . . . . . . . . . . . . . .  <a href="#page-12">12</a>
       <a href="#section-6.1.5">6.1.5</a>.  IXP LAN Prefixes  . . . . . . . . . . . . . . . . . .  <a href="#page-12">12</a>
       <a href="#section-6.1.6">6.1.6</a>.  The Default Route . . . . . . . . . . . . . . . . . .  <a href="#page-13">13</a>
     6.2.  Prefix Filtering Recommendations in Full Routing Networks  14
       <a href="#section-6.2.1">6.2.1</a>.  Filters with Internet Peers . . . . . . . . . . . . .  <a href="#page-14">14</a>
       <a href="#section-6.2.2">6.2.2</a>.  Filters with Customers  . . . . . . . . . . . . . . .  <a href="#page-16">16</a>
       <a href="#section-6.2.3">6.2.3</a>.  Filters with Upstream Providers . . . . . . . . . . .  <a href="#page-16">16</a>
     <a href="#section-6.3">6.3</a>.  Prefix Filtering Recommendations for Leaf Networks  . . .  <a href="#page-17">17</a>
       <a href="#section-6.3.1">6.3.1</a>.  Inbound Filtering . . . . . . . . . . . . . . . . . .  <a href="#page-17">17</a>
       <a href="#section-6.3.2">6.3.2</a>.  Outbound Filtering  . . . . . . . . . . . . . . . . .  <a href="#page-17">17</a>
   <a href="#section-7">7</a>.  BGP Route Flap Dampening  . . . . . . . . . . . . . . . . . .  <a href="#page-17">17</a>
   <a href="#section-8">8</a>.  Maximum Prefixes on a Peering . . . . . . . . . . . . . . . .  <a href="#page-18">18</a>
   <a href="#section-9">9</a>.  AS Path Filtering . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-18">18</a>
   <a href="#section-10">10</a>. Next-Hop Filtering  . . . . . . . . . . . . . . . . . . . . .  <a href="#page-20">20</a>
   <a href="#section-11">11</a>. BGP Community Scrubbing . . . . . . . . . . . . . . . . . . .  <a href="#page-21">21</a>
   <a href="#section-12">12</a>. Security Considerations . . . . . . . . . . . . . . . . . . .  <a href="#page-21">21</a>
   <a href="#section-13">13</a>. References  . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-21">21</a>
     <a href="#section-13.1">13.1</a>.  Normative References . . . . . . . . . . . . . . . . . .  <a href="#page-21">21</a>
     <a href="#section-13.2">13.2</a>.  Informative References . . . . . . . . . . . . . . . . .  <a href="#page-22">22</a>
   <a href="#appendix-A">Appendix A</a>.  IXP LAN Prefix Filtering - Example . . . . . . . . .  <a href="#page-25">25</a>
   Acknowledgements  . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-25">25</a>
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-26">26</a>













<span class="grey">Durand, et al.            Best Current Practice                 [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc7454.html">RFC 7454</a>                        BGP OPSEC                  February 2015</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   The Border Gateway Protocol (BGP), specified in <a href="rfc4271.html">RFC 4271</a> [<a href="#ref-2" title='"A Border Gateway Protocol 4 (BGP-4)"'>2</a>], is the
   protocol used in the Internet to exchange routing information between
   network domains.  BGP does not directly include mechanisms that
   control whether the routes exchanged conform to the various
   guidelines defined by the Internet community.  This document intends
   to both summarize common existing guidelines and help network
   administrators apply coherent BGP policies.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.1.%20%20Requirements%20Language"></a><a class="selflink" href="#section-1.1" name="section-1.1">1.1</a>.  Requirements Language</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in <a href="rfc2119.html">RFC 2119</a> [<a href="#ref-1" title='"Key words for use in RFCs to Indicate Requirement Levels"'>1</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Scope%20of%20the%20Document"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Scope of the Document</span>

   The guidelines defined in this document are intended for generic
   Internet BGP peerings.  The nature of the Internet is such that
   Autonomous Systems can always agree on exceptions to a common
   framework for relevant local needs, and therefore configure a BGP
   session in a manner that may differ from the recommendations provided
   in this document.  While this is perfectly acceptable, every
   configured exception might have an impact on the entire inter-domain
   routing environment, and network administrators SHOULD carefully
   appraise this impact before implementation.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Definitions%20and%20Acronyms"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Definitions and Acronyms</span>

   o  ACL: Access Control List

   o  ASN: Autonomous System Number

   o  IRR: Internet Routing Registry

   o  IXP: Internet Exchange Point

   o  LIR: Local Internet Registry

   o  PMTUD: Path MTU Discovery

   o  RIR: Regional Internet Registry

   o  Tier 1 transit provider: an IP transit provider that can reach any
      network on the Internet without purchasing transit services.

   o  uRPF: Unicast Reverse Path Forwarding



<span class="grey">Durand, et al.            Best Current Practice                 [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc7454.html">RFC 7454</a>                        BGP OPSEC                  February 2015</span>


   In addition to the list above, the following terms are used with a
   specific meaning.

   o  Downstream: any network that is downstream; it can be a provider
      or a customer network.

   o  Upstream: any network that is upstream.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Protection%20of%20the%20BGP%20Speaker"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Protection of the BGP Speaker</span>

   The BGP speaker needs to be protected from attempts to subvert the
   BGP session.  This protection SHOULD be achieved by an Access Control
   List (ACL) that would discard all packets directed to TCP port 179 on
   the local device and sourced from an address not known or permitted
   to become a BGP neighbor.  Experience has shown that the natural
   protection TCP should offer is not always sufficient, as it is
   sometimes run in control-plane software.  In the absence of ACLs, it
   is possible to attack a BGP speaker by simply sending a high volume
   of connection requests to it.

   If supported, an ACL specific to the control plane of the router
   SHOULD be used (receive-ACL, control-plane policing, etc.), to avoid
   configuration of data-plane filters for packets transiting through
   the router (and therefore not reaching the control plane).  If the
   hardware cannot do that, interface ACLs can be used to block packets
   addressed to the local router.

   Some routers automatically program such an ACL upon BGP
   configuration.  On other devices, this ACL should be configured and
   maintained manually or using scripts.

   In addition to strict filtering, rate-limiting MAY be configured for
   accepted BGP traffic.  Rate-limiting BGP traffic consists in
   permitting only a certain quantity of bits per second (or packets per
   second) of BGP traffic to the control plane.  This protects the BGP
   router control plane in case the amount of BGP traffic surpasses
   platform capabilities.

   Filtering and rate-limiting of control-plane traffic is a wider topic
   than "just for BGP".  (If a network administrator brings down a
   router by overloading one of the other protocols remotely, BGP is
   harmed as well.)  For a more detailed recommendation on how to
   protect the router's control plane, see <a href="rfc6192.html">RFC 6192</a> [<a href="#ref-11" title='"Protecting the Router Control Plane"'>11</a>].








<span class="grey">Durand, et al.            Best Current Practice                 [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc7454.html">RFC 7454</a>                        BGP OPSEC                  February 2015</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Protection%20of%20BGP%20Sessions"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Protection of BGP Sessions</span>

   Current security issues of TCP-based protocols (therefore including
   BGP) have been documented in <a href="rfc6952.html">RFC 6952</a> [<a href="#ref-14" title='"Analysis of BGP, LDP, PCEP, and MSDP Issues According to the Keying and Authentication for Routing Protocols (KARP) Design Guide"'>14</a>].  The following
   subsections list the major points raised in this RFC and give the
   best practices related to TCP session protection for BGP operation.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.1.%20%20Protection%20of%20TCP%20Sessions%20Used%20by%20BGP"></a><a class="selflink" href="#section-5.1" name="section-5.1">5.1</a>.  Protection of TCP Sessions Used by BGP</span>

   Attacks on TCP sessions used by BGP (aka BGP sessions), for example,
   sending spoofed TCP RST packets, could bring down a BGP peering.
   Following a successful ARP spoofing attack (or other similar man-in-
   the-middle attack), the attacker might even be able to inject packets
   into the TCP stream (routing attacks).

   BGP sessions can be secured with a variety of mechanisms.  MD5
   protection of the TCP session header, described in <a href="rfc2385.html">RFC 2385</a> [<a href="#ref-7" title='"Protection of BGP Sessions via the TCP MD5 Signature Option"'>7</a>], was
   the first such mechanism.  It has been obsoleted by the TCP
   Authentication Option (TCP-AO; <a href="rfc5925.html">RFC 5925</a> [<a href="#ref-4" title='"The TCP Authentication Option"'>4</a>]), which offers stronger
   protection.  While MD5 is still the most used mechanism due to its
   availability in vendors' equipment, TCP-AO SHOULD be preferred when
   implemented.

   IPsec could also be used for session protection.  At the time of
   publication, there is not enough experience of the impact of using
   IPsec for BGP peerings, and further analysis is required to define
   guidelines.

   The drawback of TCP session protection is additional configuration
   and management overhead for the maintenance of authentication
   information (for example, MD5 passwords).  Protection of TCP sessions
   used by BGP is thus NOT REQUIRED even when peerings are established
   over shared networks where spoofing can be done (like IXPs), but
   operators are RECOMMENDED to consider the trade-offs and to apply TCP
   session protection where appropriate.

   Furthermore, network administrators SHOULD block spoofed packets
   (packets with a source IP address belonging to their IP address
   space) at all edges of their network (see <a href="rfc2827.html">RFC 2827</a> [<a href="#ref-8" title='"Network Ingress Filtering: Defeating Denial of Service Attacks which employ IP Source Address Spoofing"'>8</a>] and <a href="rfc3704.html">RFC 3704</a>
   [<a href="#ref-9" title='"Ingress Filtering for Multihomed Networks"'>9</a>]).  This protects the TCP session used by Internal BGP (IBGP) from
   attackers outside the Autonomous System.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.2.%20%20BGP%20TTL%20Security%20%28GTSM%29"></a><a class="selflink" href="#section-5.2" name="section-5.2">5.2</a>.  BGP TTL Security (GTSM)</span>

   BGP sessions can be made harder to spoof with the Generalized TTL
   Security Mechanisms (GTSM aka TTL security), defined in <a href="rfc5082.html">RFC 5082</a> [<a href="#ref-3" title='"The Generalized TTL Security Mechanism (GTSM)"'>3</a>].
   Instead of sending TCP packets with TTL value of 1, the BGP speakers
   send the TCP packets with TTL value of 255, and the receiver checks



<span class="grey">Durand, et al.            Best Current Practice                 [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc7454.html">RFC 7454</a>                        BGP OPSEC                  February 2015</span>


   that the TTL value equals 255.  Since it's impossible to send an IP
   packet with TTL of 255 to an IP host that is not directly connected,
   BGP TTL security effectively prevents all spoofing attacks coming
   from third parties not directly connected to the same subnet as the
   BGP-speaking routers.  Network administrators SHOULD implement TTL
   security on directly connected BGP peerings.

   GTSM could also be applied to multi-hop BGP peering as well.  To
   achieve this, TTL needs to be configured with a proper value
   depending on the distance between BGP speakers (using the principle
   described above).  Nevertheless, it is not as effective because
   anyone inside the TTL diameter could spoof the TTL.

   Like MD5 protection, TTL security has to be configured on both ends
   of a BGP session.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20Prefix%20Filtering"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  Prefix Filtering</span>

   The main aspect of securing BGP resides in controlling the prefixes
   that are received and advertised on the BGP peerings.  Prefixes
   exchanged between BGP peers are controlled with inbound and outbound
   filters that can match on IP prefixes (as described in this section),
   AS paths (as described in <a href="#section-9">Section 9</a>) or any other attributes of a BGP
   prefix (for example, BGP communities, as described in <a href="#section-11">Section 11</a>).

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.1.%20%20Definition%20of%20Prefix%20Filters"></a><a class="selflink" href="#section-6.1" name="section-6.1">6.1</a>.  Definition of Prefix Filters</span>

   This section lists the most commonly used prefix filters.  The
   following sections will clarify where these filters should be
   applied.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/6.1.1.%20%20Special-Purpose%20Prefixes"></a><a class="selflink" href="#section-6.1.1" name="section-6.1.1">6.1.1</a>.  Special-Purpose Prefixes</span>

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/6.1.1.1.%20%20IPv4%20Special-Purpose%20Prefixes"></a><a class="selflink" href="#section-6.1.1.1" name="section-6.1.1.1">6.1.1.1</a>.  IPv4 Special-Purpose Prefixes</span>

   The IANA IPv4 Special-Purpose Address Registry [<a href="#ref-23" title='"IANA IPv4 Special-Purpose Address Registry"'>23</a>] maintains the
   list of IPv4 special-purpose prefixes and their routing scope, and it
   SHOULD be used for prefix-filter configuration.  Prefixes with value
   "False" in column "Global" SHOULD be discarded on Internet BGP
   peerings.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/6.1.1.2.%20%20IPv6%20Special-Purpose%20Prefixes"></a><a class="selflink" href="#section-6.1.1.2" name="section-6.1.1.2">6.1.1.2</a>.  IPv6 Special-Purpose Prefixes</span>

   The IANA IPv6 Special-Purpose Address Registry [<a href="#ref-24" title='"IANA IPv6 Special-Purpose Address Registry"'>24</a>] maintains the
   list of IPv6 special-purpose prefixes and their routing scope, and it
   SHOULD be used for prefix-filter configuration.  Only prefixes with
   value "False" in column "Global" SHOULD be discarded on Internet BGP
   peerings.



<span class="grey">Durand, et al.            Best Current Practice                 [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc7454.html">RFC 7454</a>                        BGP OPSEC                  February 2015</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/6.1.2.%20%20Unallocated%20Prefixes"></a><a class="selflink" href="#section-6.1.2" name="section-6.1.2">6.1.2</a>.  Unallocated Prefixes</span>

   IANA allocates prefixes to RIRs that in turn allocate prefixes to
   LIRs (Local Internet Registries).  It is wise not to accept routing
   table prefixes that are not allocated by IANA and/or RIRs.  This
   section details the options for building a list of allocated prefixes
   at every level.  It is important to understand that filtering
   unallocated prefixes requires constant updates, as prefixes are
   continually allocated.  Therefore, automation of such prefix filters
   is key for the success of this approach.  Network administrators
   SHOULD NOT consider solutions described in this section if they are
   not capable of maintaining updated prefix filters: the damage would
   probably be worse than the intended security policy.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/6.1.2.1.%20%20IANA-Allocated%20Prefix%20Filters"></a><a class="selflink" href="#section-6.1.2.1" name="section-6.1.2.1">6.1.2.1</a>.  IANA-Allocated Prefix Filters</span>

   IANA has allocated all the IPv4 available space.  Therefore, there is
   no reason why network administrators would keep checking that
   prefixes they receive from BGP peers are in the IANA-allocated IPv4
   address space [<a href="#ref-25" title='"IANA IPv4 Address Space Registry"'>25</a>].  No specific filters need to be put in place by
   administrators who want to make sure that IPv4 prefixes they receive
   in BGP updates have been allocated by IANA.

   For IPv6, given the size of the address space, it can be seen as wise
   to accept only prefixes derived from those allocated by IANA.
   Administrators can dynamically build this list from the IANA-
   allocated IPv6 space [<a href="#ref-26" title='"Internet Protocol Version 6 Address Space"'>26</a>].  As IANA keeps allocating prefixes to
   RIRs, the aforementioned list should be checked regularly against
   changes, and if they occur, prefix filters should be computed and
   pushed on network devices.  The list could also be pulled directly by
   routers when they implement such mechanisms.  As there is delay
   between the time a RIR receives a new prefix and the moment it starts
   allocating portions of it to its LIRs, there is no need for doing
   this step quickly and frequently.  However, network administrators
   SHOULD ensure that all IPv6 prefix filters are updated within a
   maximum of one month after any change in the list of IPv6 prefixes
   allocated by IANA.

   If the process in place (whether manual or automatic) cannot
   guarantee that the list is updated regularly, then it's better not to
   configure any filters based on allocated networks.  The IPv4
   experience has shown that many network operators implemented filters
   for prefixes not allocated by IANA but did not update them on a
   regular basis.  This created problems for the latest allocations, and
   required extra work for RIRs that had to "de-bogonize" the newly
   allocated prefixes.  (See [<a href="#ref-18" title='"RIPE-351 - De-Bogonising New Address Blocks"'>18</a>] for information on de-bogonizing.)





<span class="grey">Durand, et al.            Best Current Practice                 [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc7454.html">RFC 7454</a>                        BGP OPSEC                  February 2015</span>


<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/6.1.2.2.%20%20RIR-Allocated%20Prefix%20Filters"></a><a class="selflink" href="#section-6.1.2.2" name="section-6.1.2.2">6.1.2.2</a>.  RIR-Allocated Prefix Filters</span>

   A more precise check can be performed when one would like to make
   sure that prefixes they receive are being originated or transited by
   Autonomous Systems (ASes) entitled to do so.  It has been observed in
   the past that an AS could easily advertise someone else's prefix (or
   more specific prefixes) and create black holes or security threats.
   To partially mitigate this risk, administrators would need to make
   sure BGP advertisements correspond to information located in the
   existing registries.  At this stage, two options can be considered:
   short- and long-term options.  They are described in the following
   subsections.

<span class="h6"><a class="dashAnchor" name="//apple_ref/Section/6.1.2.2.1.%20%20Prefix%20Filters%20Created%20from%20Internet%20Routing%20Registries"></a><a class="selflink" href="#section-6.1.2.2.1" name="section-6.1.2.2.1">6.1.2.2.1</a>.  Prefix Filters Created from Internet Routing Registries</span>
            (IRRs)

   An Internet Routing Registry (IRR) is a database containing Internet
   routing information, described using Routing Policy Specification
   Language objects as described in <a href="rfc4012.html">RFC 4012</a> [<a href="#ref-10" title='"Routing Policy Specification Language next generation (RPSLng)"'>10</a>].  Network
   administrators are given privileges to describe routing policies of
   their own networks in the IRR, and that information is published,
   usually publicly.  A majority of Regional Internet Registries do also
   operate an IRR and can control whether registered routes conform to
   the prefixes that are allocated or directly assigned.  However, it
   should be noted that the list of such prefixes is not necessarily a
   complete list, and as such the list of routes in an IRR is not the
   same as the set of RIR-allocated prefixes.

   It is possible to use the IRR information to build, for a given
   neighbor AS, a list of originated or transited prefixes that one may
   accept.  This can be done relatively easily using scripts and
   existing tools capable of retrieving this information from the
   registries.  This approach is exactly the same for both IPv4 and
   IPv6.

   The macro-algorithm for the script is as follows.  For the peer that
   is considered, the distant network administrator has provided the AS
   and may be able to provide an AS-SET object (aka AS-MACRO).  An
   AS-SET is an object that contains AS numbers or other AS-SETs.  An
   operator may create an AS-SET defining all the AS numbers of its
   customers.  A Tier 1 transit provider might create an AS-SET
   describing the AS-SET of connected operators, which in turn describe
   the AS numbers of their customers.  Using recursion, it is possible
   to retrieve from an AS-SET the complete list of AS numbers that the
   peer is likely to announce.  For each of these AS numbers, it is also
   easy to look in the corresponding IRR for all associated prefixes.
   With these two mechanisms, a script can build, for a given peer, the




<span class="grey">Durand, et al.            Best Current Practice                 [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc7454.html">RFC 7454</a>                        BGP OPSEC                  February 2015</span>


   list of allowed prefixes and the AS number from which they should be
   originated.  One could decide not use the origin information and only
   build monolithic prefix filters from fetched data.

   As prefixes, AS numbers, and AS-SETs may not all be under the same
   RIR authority, it is difficult to choose for each object the
   appropriate IRR to poll.  Some IRRs have been created and are not
   restricted to a given region or authoritative RIR.  They allow RIRs
   to publish information contained in their IRR in a common place.
   They also make it possible for any subscriber (probably under
   contract) to publish information too.  When doing requests inside
   such an IRR, it is possible to specify the source of information in
   order to have the most reliable data.  One could check a popular IRR
   containing many sources (such as RADb [<a href="#ref-27" title='"Merit RADb"'>27</a>], the Routing Assets
   Database) and only select as sources some desired RIRs and trusted
   major ISPs (Internet Service Providers).

   As objects in IRRs may frequently vary over time, it is important
   that prefix filters computed using this mechanism are refreshed
   regularly.  Refreshing the filters on a daily basis SHOULD be
   considered because routing changes must sometimes be done in an
   emergency and registries may be updated at the very last moment.
   Note that this approach significantly increases the complexity of the
   router configurations, as it can quickly add tens of thousands of
   configuration lines for some important peers.  To manage this
   complexity, network administrators could use, for example, IRRToolSet
   [<a href="#ref-30" title='"IRRToolSet project page"'>30</a>], a set of tools making it possible to simplify the creation of
   automated filter configuration from policies stored in an IRR.

   Last but not least, network administrators SHOULD publish and
   maintain their resources properly in the IRR database maintained by
   their RIR, when available.

<span class="h6"><a class="dashAnchor" name="//apple_ref/Section/6.1.2.2.2.%20%20SIDR%20-%20Secure%20Inter-Domain%20Routing"></a><a class="selflink" href="#section-6.1.2.2.2" name="section-6.1.2.2.2">6.1.2.2.2</a>.  SIDR - Secure Inter-Domain Routing</span>

   An infrastructure called SIDR (Secure Inter-Domain Routing),
   described in <a href="rfc6480.html">RFC 6480</a> [<a href="#ref-12" title='"An Infrastructure to Support Secure Internet Routing"'>12</a>], has been designed to secure Internet
   advertisements.  At the time of writing this document, many documents
   have been published and a framework with a complete set of protocols
   is proposed so that advertisements can be checked against signed
   routing objects in RIRs.  There are basically two services that SIDR
   offers:

   o  Origin validation, described in <a href="rfc6811.html">RFC 6811</a> [<a href="#ref-5" title='"BGP Prefix Origin Validation"'>5</a>], seeks to make sure
      that attributes associated with routes are correct.  (The major
      point is the validation of the AS number originating a given
      route.)  Origin validation is now operational (Internet




<span class="grey">Durand, et al.            Best Current Practice                [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc7454.html">RFC 7454</a>                        BGP OPSEC                  February 2015</span>


      registries, protocols, implementations on some routers), and in
      theory it can be implemented knowing that the number of signed
      resources is still low at the time of writing this document.

   o  Path validation provided by BGPsec [<a href="#ref-29" title='"Security Requirements for BGP Path Validation"'>29</a>] seeks to make sure that no
      one announces fake/wrong BGP paths that would attract traffic for
      a given destination; see <a href="rfc7132.html">RFC 7132</a> [<a href="#ref-16" title='"Threat Model for BGP Path Security"'>16</a>].  BGPsec is still an
      ongoing work item at the time of writing this document and
      therefore cannot be implemented.

   Implementing SIDR mechanisms is expected to solve many of the BGP
   routing security problems in the long term, but it may take time for
   deployments to be made and objects to become signed.  Also, note that
   the SIDR infrastructure is complementing (not replacing) the security
   best practices listed in this document.  Therefore, network
   administrators SHOULD implement any SIDR proposed mechanism (for
   example, route origin validation) on top of the other existing
   mechanisms even if they could sometimes appear to be targeting the
   same goal.

   If route origin validation is implemented, the reader SHOULD refer to
   the rules described in <a href="rfc7115.html">RFC 7115</a> [<a href="#ref-15" title='"Origin Validation Operation Based on the Resource Public Key Infrastructure (RPKI)"'>15</a>].  In short, each external route
   received on a router SHOULD be checked against the Resource Public
   Key Infrastructure (RPKI) data set:

   o  If a corresponding ROA (Route Origin Authorization) is found and
      is valid, then the prefix SHOULD be accepted.

   o  If the ROA is found and is INVALID, then the prefix SHOULD be
      discarded.

   o  If a ROA is not found, then the prefix SHOULD be accepted, but the
      corresponding route SHOULD be given a low preference.

   In addition to this, network administrators SHOULD sign their routing
   objects so their routes can be validated by other networks running
   origin validation.

   One should understand that the RPKI model brings new, interesting
   challenges.  The paper "On the Risk of Misbehaving RPKI Authorities"
   [<a href="#ref-31" title='"On the Risk of Misbehaving RPKI Authorities"'>31</a>] explains how the RPKI model can impact the Internet if
   authorities don't behave as they are supposed to.  Further analysis
   is certainly required on RPKI, which carries part of BGP security.








<span class="grey">Durand, et al.            Best Current Practice                [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc7454.html">RFC 7454</a>                        BGP OPSEC                  February 2015</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/6.1.3.%20%20Prefixes%20That%20Are%20Too%20Specific"></a><a class="selflink" href="#section-6.1.3" name="section-6.1.3">6.1.3</a>.  Prefixes That Are Too Specific</span>

   Most ISPs will not accept advertisements beyond a certain level of
   specificity (and in return, they do not announce prefixes they
   consider to be too specific).  That acceptable specificity is decided
   for each peering between the two BGP peers.  Some ISP communities
   have tried to document acceptable specificity.  This document does
   not make any judgement on what the best approach is, it just notes
   that there are existing practices on the Internet and recommends that
   the reader refer to them.  As an example, the RIPE community has
   documented that, at the time of writing of this document, IPv4
   prefixes longer than /24 and IPv6 prefixes longer than /48 are
   generally neither announced nor accepted in the Internet [<a href="#ref-20" title='"RIPE-399 - RIPE Routing Working Group Recommendations on Route Aggregation"'>20</a>] [<a href="#ref-21" title='"RIPE-532 - RIPE Routing Working Group Recommendations on IPv6 Route Aggregation"'>21</a>].
   These values may change in the future.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/6.1.4.%20%20Filtering%20Prefixes%20Belonging%20to%20the%20Local%20AS%20and%20Downstreams"></a><a class="selflink" href="#section-6.1.4" name="section-6.1.4">6.1.4</a>.  Filtering Prefixes Belonging to the Local AS and Downstreams</span>

   A network SHOULD filter its own prefixes on peerings with all its
   peers (inbound direction).  This prevents local traffic (from a local
   source to a local destination) from leaking over an external peering,
   in case someone else is announcing the prefix over the Internet.
   This also protects the infrastructure that may directly suffer if the
   backbone's prefix is suddenly preferred over the Internet.

   In some cases, for example, multihoming scenarios, such filters
   SHOULD NOT be applied, as this would break the desired redundancy.

   To an extent, such filters can also be configured on a network for
   the prefixes of its downstreams in order to protect them, too.  Such
   filters must be defined with caution as they can break existing
   redundancy mechanisms.  For example, when an operator has a
   multihomed customer, it should keep accepting the customer prefix
   from its peers and upstreams.  This will make it possible for the
   customer to keep accessing its operator network (and other customers)
   via the Internet even if the BGP peering between the customer and the
   operator is down.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/6.1.5.%20%20IXP%20LAN%20Prefixes"></a><a class="selflink" href="#section-6.1.5" name="section-6.1.5">6.1.5</a>.  IXP LAN Prefixes</span>

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/6.1.5.1.%20%20Network%20Security"></a><a class="selflink" href="#section-6.1.5.1" name="section-6.1.5.1">6.1.5.1</a>.  Network Security</span>

   When a network is present on an IXP and peers with other IXP members
   over a common subnet (IXP LAN prefix), it SHOULD NOT accept more-
   specific prefixes for the IXP LAN prefix from any of its external BGP
   peers.  Accepting these routes may create a black hole for
   connectivity to the IXP LAN.





<span class="grey">Durand, et al.            Best Current Practice                [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc7454.html">RFC 7454</a>                        BGP OPSEC                  February 2015</span>


   If the IXP LAN prefix is accepted as an "exact match", care needs to
   be taken to prevent other routers in the network from sending IXP
   traffic towards the externally learned IXP LAN prefix (recursive
   route lookup pointing into the wrong direction).  This can be
   achieved by preferring IGP routes over External BGP (EBGP), or by
   using "BGP next-hop-self" on all routes learned on that IXP.

   If the IXP LAN prefix is accepted at all, it SHOULD only be accepted
   from the ASes that the IXP authorizes to announce it -- this will
   usually be automatically achieved by filtering announcements using
   the IRR database.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/6.1.5.2.%20%20PMTUD%20and%20the%20Loose%20uRPF%20Problem"></a><a class="selflink" href="#section-6.1.5.2" name="section-6.1.5.2">6.1.5.2</a>.  PMTUD and the Loose uRPF Problem</span>

   In order to have PMTUD working in the presence of loose uRPF, it is
   necessary that all the networks that may source traffic that could
   flow through the IXP (i.e., IXP members and their downstreams) have a
   route for the IXP LAN prefix.  This is necessary as "packet too big"
   ICMP messages sent by IXP members' routers may be sourced using an
   address of the IXP LAN prefix.  In the presence of loose uRPF, this
   ICMP packet is dropped if there is no route for the IXP LAN prefix or
   a less specific route covering IXP LAN prefix.

   In that case, any IXP member SHOULD make sure it has a route for the
   IXP LAN prefix or a less specific prefix on all its routers and that
   it announces the IXP LAN prefix or the less specific route (up to a
   default route) to its downstreams.  The announcements done for this
   purpose SHOULD pass IRR-generated filters described in
   <a href="#section-6.1.2.2.1">Section 6.1.2.2.1</a> as well as "prefixes that are too specific" filters
   described in <a href="#section-6.1.3">Section 6.1.3</a>.  The easiest way to implement this is for
   the IXP itself to take care of the origination of its prefix and
   advertise it to all IXP members through a BGP peering.  Most likely,
   the BGP route servers would be used for this, and the IXP would send
   its entire prefix, which would be equal to or less specific than the
   IXP LAN prefix.

   <a href="#appendix-A">Appendix A</a> gives an example of guidelines regarding IXP LAN prefix.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/6.1.6.%20%20The%20Default%20Route"></a><a class="selflink" href="#section-6.1.6" name="section-6.1.6">6.1.6</a>.  The Default Route</span>

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/6.1.6.1.%20%20IPv4"></a><a class="selflink" href="#section-6.1.6.1" name="section-6.1.6.1">6.1.6.1</a>.  IPv4</span>

   Typically, the 0.0.0.0/0 prefix is not intended to be accepted or
   advertised except in specific customer/provider configurations;
   general filtering outside of these is RECOMMENDED.






<span class="grey">Durand, et al.            Best Current Practice                [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc7454.html">RFC 7454</a>                        BGP OPSEC                  February 2015</span>


<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/6.1.6.2.%20%20IPv6"></a><a class="selflink" href="#section-6.1.6.2" name="section-6.1.6.2">6.1.6.2</a>.  IPv6</span>

   Typically, the ::/0 prefix is not intended to be accepted or
   advertised except in specific customer/provider configurations;
   general filtering outside of these is RECOMMENDED.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.2.%20%20Prefix%20Filtering%20Recommendations%20in%20Full%20Routing%20Networks"></a><a class="selflink" href="#section-6.2" name="section-6.2">6.2</a>.  Prefix Filtering Recommendations in Full Routing Networks</span>

   For networks that have the full Internet BGP table, some policies
   should be applied on each BGP peer for received and advertised
   routes.  It is RECOMMENDED that each Autonomous System configures
   rules for advertised and received routes at all its borders, as this
   will protect the network and its peer even in case of
   misconfiguration.  The most commonly used filtering policy is
   proposed in this section and uses prefix filters defined in
   <a href="#section-6.1">Section 6.1</a>.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/6.2.1.%20%20Filters%20with%20Internet%20Peers"></a><a class="selflink" href="#section-6.2.1" name="section-6.2.1">6.2.1</a>.  Filters with Internet Peers</span>

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/6.2.1.1.%20%20Inbound%20Filtering"></a><a class="selflink" href="#section-6.2.1.1" name="section-6.2.1.1">6.2.1.1</a>.  Inbound Filtering</span>

   There are basically two options -- the loose one where no check will
   be done against RIR allocations and the strict one where it will be
   verified that announcements strictly conform to what is declared in
   routing registries.

<span class="h6"><a class="dashAnchor" name="//apple_ref/Section/6.2.1.1.1.%20%20Inbound%20Filtering%20Loose%20Option"></a><a class="selflink" href="#section-6.2.1.1.1" name="section-6.2.1.1.1">6.2.1.1.1</a>.  Inbound Filtering Loose Option</span>

   In this case, the following prefixes received from a BGP peer will be
   filtered:

   o  prefixes that are not globally routable (<a href="#section-6.1.1">Section 6.1.1</a>)

   o  prefixes not allocated by IANA (IPv6 only) (<a href="#section-6.1.2.1">Section 6.1.2.1</a>)

   o  routes that are too specific (<a href="#section-6.1.3">Section 6.1.3</a>)

   o  prefixes belonging to the local AS (<a href="#section-6.1.4">Section 6.1.4</a>)

   o  IXP LAN prefixes (<a href="#section-6.1.5">Section 6.1.5</a>)

   o  the default route (<a href="#section-6.1.6">Section 6.1.6</a>)

<span class="h6"><a class="dashAnchor" name="//apple_ref/Section/6.2.1.1.2.%20%20Inbound%20Filtering%20Strict%20Option"></a><a class="selflink" href="#section-6.2.1.1.2" name="section-6.2.1.1.2">6.2.1.1.2</a>.  Inbound Filtering Strict Option</span>

   In this case, filters are applied to make sure advertisements
   strictly conform to what is declared in routing registries
   (<a href="#section-6.1.2.2">Section 6.1.2.2</a>).  Warning is given as registries are not always



<span class="grey">Durand, et al.            Best Current Practice                [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc7454.html">RFC 7454</a>                        BGP OPSEC                  February 2015</span>


   accurate (prefixes missing, wrong information, etc.).  This varies
   across the registries and regions of the Internet.  Before applying a
   strict policy, the reader SHOULD check the impact on the filter and
   make sure the solution is not worse than the problem.

   Also, in case of script failure, each administrator may decide if all
   routes are accepted or rejected depending on routing policy.  While
   accepting the routes during that time frame could break the BGP
   routing security, rejecting them might re-route too much traffic on
   transit peers, and could cause more harm than what a loose policy
   would have done.

   In addition to this, network administrators could apply the following
   filters beforehand in case the routing registry that's used as the
   source of information by the script is not fully trusted:

   o  prefixes that are not globally routable (<a href="#section-6.1.1">Section 6.1.1</a>)

   o  routes that are too specific (<a href="#section-6.1.3">Section 6.1.3</a>)

   o  prefixes belonging to the local AS (<a href="#section-6.1.4">Section 6.1.4</a>)

   o  IXP LAN prefixes (<a href="#section-6.1.5">Section 6.1.5</a>)

   o  the default route (<a href="#section-6.1.6">Section 6.1.6</a>)

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/6.2.1.2.%20%20Outbound%20Filtering"></a><a class="selflink" href="#section-6.2.1.2" name="section-6.2.1.2">6.2.1.2</a>.  Outbound Filtering</span>

   The configuration should ensure that only appropriate prefixes are
   sent.  These can be, for example, prefixes belonging to both the
   network in question and its downstreams.  This can be achieved by
   using BGP communities, AS paths, or both.  Also, it may be desirable
   to add the following filters before any policy to avoid unwanted
   route announcements due to bad configuration:

   o  Prefixes that are not globally routable (<a href="#section-6.1.1">Section 6.1.1</a>)

   o  Routes that are too specific (<a href="#section-6.1.3">Section 6.1.3</a>)

   o  IXP LAN prefixes (<a href="#section-6.1.5">Section 6.1.5</a>)

   o  The default route (<a href="#section-6.1.6">Section 6.1.6</a>)

   If it is possible to list the prefixes to be advertised, then just
   configuring the list of allowed prefixes and denying the rest is
   sufficient.





<span class="grey">Durand, et al.            Best Current Practice                [Page 15]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc7454.html">RFC 7454</a>                        BGP OPSEC                  February 2015</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/6.2.2.%20%20Filters%20with%20Customers"></a><a class="selflink" href="#section-6.2.2" name="section-6.2.2">6.2.2</a>.  Filters with Customers</span>

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/6.2.2.1.%20%20Inbound%20Filtering"></a><a class="selflink" href="#section-6.2.2.1" name="section-6.2.2.1">6.2.2.1</a>.  Inbound Filtering</span>

   The inbound policy with end customers is pretty straightforward: only
   customer prefixes SHOULD be accepted, all others SHOULD be discarded.
   The list of accepted prefixes can be manually specified, after having
   verified that they are valid.  This validation can be done with the
   appropriate IP address management authorities.

   The same rules apply when the customer is a network connecting other
   customers (for example, a Tier 1 transit provider connecting service
   providers).  An exception is when the customer network applies strict
   inbound/outbound prefix filtering, and there are too many prefixes
   announced by that network to list them in the router configuration.
   In that case, filters as in <a href="#section-6.2.1.1">Section 6.2.1.1</a> can be applied.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/6.2.2.2.%20%20Outbound%20Filtering"></a><a class="selflink" href="#section-6.2.2.2" name="section-6.2.2.2">6.2.2.2</a>.  Outbound Filtering</span>

   The outbound policy with customers may vary according to the routes
   the customer wants to receive.  In the simplest possible scenario,
   the customer may want to receive only the default route; this can be
   done easily by applying a filter with the default route only.

   In case the customer wants to receive the full routing (if it is
   multihomed or if it wants to have a view of the Internet table), the
   following filters can be applied on the BGP peering:

   o  prefixes that are not globally routable (<a href="#section-6.1.1">Section 6.1.1</a>)

   o  routes that are too specific (<a href="#section-6.1.3">Section 6.1.3</a>)

   o  the default route (<a href="#section-6.1.6">Section 6.1.6</a>)

   In some cases, the customer may desire to receive the default route
   in addition to the full BGP table.  This can be done by the provider
   simply by removing the filter for the default route.  As the default
   route may not be present in the routing table, network administrators
   may decide to originate it only for peerings where it has to be
   advertised.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/6.2.3.%20%20Filters%20with%20Upstream%20Providers"></a><a class="selflink" href="#section-6.2.3" name="section-6.2.3">6.2.3</a>.  Filters with Upstream Providers</span>

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/6.2.3.1.%20%20Inbound%20Filtering"></a><a class="selflink" href="#section-6.2.3.1" name="section-6.2.3.1">6.2.3.1</a>.  Inbound Filtering</span>

   If the full routing table is desired from the upstream, the prefix
   filtering to apply is the same as the one for peers <a href="#section-6.2.1.1">Section 6.2.1.1</a>
   with the exception of the default route.  Sometimes, the default



<span class="grey">Durand, et al.            Best Current Practice                [Page 16]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc7454.html">RFC 7454</a>                        BGP OPSEC                  February 2015</span>


   route (in addition to the full BGP table) can be desired from an
   upstream provider.  If the upstream provider is supposed to announce
   only the default route, a simple filter will be applied to accept
   only the default prefix and nothing else.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/6.2.3.2.%20%20Outbound%20Filtering"></a><a class="selflink" href="#section-6.2.3.2" name="section-6.2.3.2">6.2.3.2</a>.  Outbound Filtering</span>

   The filters to be applied would most likely not differ much from the
   ones applied for Internet peers (<a href="#section-6.2.1.2">Section 6.2.1.2</a>).  However,
   different policies could be applied if a particular upstream should
   not provide transit to all the prefixes.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.3.%20%20Prefix%20Filtering%20Recommendations%20for%20Leaf%20Networks"></a><a class="selflink" href="#section-6.3" name="section-6.3">6.3</a>.  Prefix Filtering Recommendations for Leaf Networks</span>

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/6.3.1.%20%20Inbound%20Filtering"></a><a class="selflink" href="#section-6.3.1" name="section-6.3.1">6.3.1</a>.  Inbound Filtering</span>

   The leaf network will deploy the filters corresponding to the routes
   it is requesting from its upstream.  If a default route is requested,
   a simple inbound filter can be applied to accept only the default
   route (<a href="#section-6.1.6">Section 6.1.6</a>).  If the leaf network is not capable of listing
   the prefixes because there are too many (for example, if it requires
   the full Internet routing table), then it should configure the
   following filters to avoid receiving bad announcements from its
   upstream:

   o  prefixes not routable (<a href="#section-6.1.1">Section 6.1.1</a>)

   o  routes that are too specific (<a href="#section-6.1.3">Section 6.1.3</a>)

   o  prefixes belonging to local AS (<a href="#section-6.1.4">Section 6.1.4</a>)

   o  the default route (<a href="#section-6.1.6">Section 6.1.6</a>) depending on whether or not the
      route is requested

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/6.3.2.%20%20Outbound%20Filtering"></a><a class="selflink" href="#section-6.3.2" name="section-6.3.2">6.3.2</a>.  Outbound Filtering</span>

   A leaf network will most likely have a very straightforward policy:
   it will only announce its local routes.  It can also configure the
   prefix filters described in <a href="#section-6.2.1.2">Section 6.2.1.2</a> to avoid announcing
   invalid routes to its upstream provider.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20BGP%20Route%20Flap%20Dampening"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  BGP Route Flap Dampening</span>

   The BGP route flap dampening mechanism makes it possible to give
   penalties to routes each time they change in the BGP routing table.
   Initially, this mechanism was created to protect the entire Internet
   from multiple events that impact a single network.  Studies have
   shown that implementations of BGP route flap dampening could cause



<span class="grey">Durand, et al.            Best Current Practice                [Page 17]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc7454.html">RFC 7454</a>                        BGP OPSEC                  February 2015</span>


   more harm than benefit; therefore, in the past, the RIPE community
   has recommended against using BGP route flap dampening [<a href="#ref-19" title='"RIPE-378 - RIPE Routing Working Group Recommendations On Route-flap Damping"'>19</a>].  Later,
   studies were conducted to propose new route flap dampening thresholds
   in order to make the solution "usable"; see <a href="rfc7196.html">RFC 7196</a> [<a href="#ref-6" title='"Making Route Flap Damping Usable"'>6</a>] and [<a href="#ref-22" title='"RIPE-580 - RIPE Routing Working Group Recommendations On Route-flap Damping"'>22</a>] (in
   which RIPE reviewed its recommendations).  This document RECOMMENDS
   following IETF and RIPE recommendations and using BGP route flap
   dampening with the adjusted configured thresholds.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20Maximum%20Prefixes%20on%20a%20Peering"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  Maximum Prefixes on a Peering</span>

   It is RECOMMENDED to configure a limit on the number of routes to be
   accepted from a peer.  The following rules are generally RECOMMENDED:

   o  From peers, it is RECOMMENDED to have a limit lower than the
      number of routes in the Internet.  This will shut down the BGP
      peering if the peer suddenly advertises the full table.  Network
      administrators can also configure different limits for each peer,
      according to the number of routes they are supposed to advertise,
      plus some headroom to permit growth.

   o  From upstreams that provide full routing, it is RECOMMENDED to
      have a limit higher than the number of routes in the Internet.  A
      limit is still useful in order to protect the network (and in
      particular, the routers' memory) if too many routes are sent by
      the upstream.  The limit should be chosen according to the number
      of routes that can actually be handled by routers.

   It is important to regularly review the limits that are configured as
   the Internet can quickly change over time.  Some vendors propose
   mechanisms to have two thresholds: while the higher number specified
   will shut down the peering, the first threshold will only trigger a
   log and can be used to passively adjust limits based on observations
   made on the network.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/9.%20%20AS%20Path%20Filtering"></a><a class="selflink" href="#section-9" name="section-9">9</a>.  AS Path Filtering</span>

   This section lists the RECOMMENDED practices when processing BGP AS
   paths.

   o  Network administrators SHOULD accept from customers only 2-byte or
      4-byte AS paths containing ASNs belonging to (or authorized to
      transit through) the customer.  If network administrators cannot
      build and generate filtering expressions to implement this, they
      SHOULD consider accepting only path lengths relevant to the type
      of customer they have (as in, if these customers are a leaf or
      have customers of their own) and SHOULD try to discourage
      excessive prepending in such paths.  This loose policy could be




<span class="grey">Durand, et al.            Best Current Practice                [Page 18]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-19" id="page-19" name="page-19"> </a>
<span class="grey"><a href="rfc7454.html">RFC 7454</a>                        BGP OPSEC                  February 2015</span>


      combined with filters for specific 2-byte or 4-byte AS paths that
      must not be accepted if advertised by the customer, such as
      upstream transit providers or peer ASNs.

   o  Network administrators SHOULD NOT accept prefixes with private AS
      numbers in the AS path unless the prefixes are from customers.  An
      exception could occur when an upstream is offering some particular
      service like black-hole origination based on a private AS number:
      in that case, prefixes SHOULD be accepted.  Customers should be
      informed by their upstream in order to put in place ad hoc policy
      to use such services.

   o  Network administrators SHOULD NOT accept prefixes when the first
      AS number in the AS path is not the one of the peer's unless the
      peering is done toward a BGP route server [<a href="#ref-17" title='"Internet Exchange Route Server"'>17</a>] (for example, on an
      IXP) with transparent AS path handling.  In that case, this
      verification needs to be deactivated, as the first AS number will
      be the one of an IXP member, whereas the peer AS number will be
      the one of the BGP route server.

   o  Network administrators SHOULD NOT advertise prefixes with a
      nonempty AS path unless they intend to provide transit for these
      prefixes.

   o  Network administrators SHOULD NOT advertise prefixes with upstream
      AS numbers in the AS path to their peering AS unless they intend
      to provide transit for these prefixes.

   o  Private AS numbers are conventionally used in contexts that are
      "private" and SHOULD NOT be used in advertisements to BGP peers
      that are not party to such private arrangements, and they SHOULD
      be stripped when received from BGP peers that are not party to
      such private arrangements.

   o  Network administrators SHOULD NOT override BGP's default behavior,
      i.e., they should not accept their own AS number in the AS path.
      When considering an exception, the impact (which may be severe on
      routing) should be studied carefully.

   AS path filtering should be further analyzed when ASN renumbering is
   done.  Such an operation is common, and mechanisms exist to allow
   smooth ASN migration [<a href="#ref-28" title='"Autonomous System (AS) Migration Features and Their Effects on the BGP AS_PATH Attribute"'>28</a>].  The usual migration technique, local to a
   router, consists in modifying the AS path so it is presented to a
   peer with the previous ASN, as if no renumbering was done.  This
   makes it possible to change the ASN of a router without reconfiguring
   all EBGP peers at the same time (as that operation would require
   synchronization with all peers attached to that router).  During this
   renumbering operation, the rules described above may be adjusted.



<span class="grey">Durand, et al.            Best Current Practice                [Page 19]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-20" id="page-20" name="page-20"> </a>
<span class="grey"><a href="rfc7454.html">RFC 7454</a>                        BGP OPSEC                  February 2015</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/10.%20%20Next-Hop%20Filtering"></a><a class="selflink" href="#section-10" name="section-10">10</a>.  Next-Hop Filtering</span>

   If peering on a shared network, like an IXP, BGP can advertise
   prefixes with a third-party next hop, thus directing packets not to
   the peer announcing the prefix but somewhere else.

   This is a desirable property for BGP route-server setups [<a href="#ref-17" title='"Internet Exchange Route Server"'>17</a>], where
   the route server will relay routing information but has neither the
   capacity nor the desire to receive the actual data packets.  So, the
   BGP route server will announce prefixes with a next-hop setting
   pointing to the router that originally announced the prefix to the
   route server.

   In direct peerings between ISPs, this is undesirable, as one of the
   peers could trick the other one into sending packets into a black
   hole (unreachable next hop) or to an unsuspecting third party who
   would then have to carry the traffic.  Especially for black-holing,
   the root cause of the problem is hard to see without inspecting BGP
   prefixes at the receiving router of the IXP.

   Therefore, an inbound route policy SHOULD be applied on IXP peerings
   in order to set the next hop for accepted prefixes to the BGP peer IP
   address (belonging to the IXP LAN) that sent the prefix (which is
   what "next-hop-self" would enforce on the sending side).

   This policy SHOULD NOT be used on route-server peerings or on
   peerings where network administrators intentionally permit the other
   side to send third-party next hops.

   This policy also SHOULD be adjusted if the best practice of Remote
   Triggered Black Holing (aka RTBH as described in <a href="rfc6666.html">RFC 6666</a> [<a href="#ref-13" title='"A Discard Prefix for IPv6"'>13</a>]) is
   implemented.  In that case, network administrators would apply a
   well-known BGP next hop for routes they want to filter (if an
   Internet threat is observed from/to this route, for example).  This
   well-known next hop will be statically routed to a null interface.
   In combination with a unicast RPF check, this will discard traffic
   from and toward this prefix.  Peers can exchange information about
   black holes using, for example, particular BGP communities.  Network
   administrators could propagate black-hole information to their peers
   using an agreed-upon BGP community: when receiving a route with that
   community, a configured policy could change the next hop in order to
   create the black hole.









<span class="grey">Durand, et al.            Best Current Practice                [Page 20]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-21" id="page-21" name="page-21"> </a>
<span class="grey"><a href="rfc7454.html">RFC 7454</a>                        BGP OPSEC                  February 2015</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/11.%20%20BGP%20Community%20Scrubbing"></a><a class="selflink" href="#section-11" name="section-11">11</a>.  BGP Community Scrubbing</span>

   Optionally, we can consider the following rules on BGP AS paths:

   o  Network administrators SHOULD scrub inbound communities with their
      number in the high-order bits, and allow only those communities
      that customers/peers can use as a signaling mechanism

   o  Networks administrators SHOULD NOT remove other communities
      applied on received routes (communities not removed after
      application of the previous statement).  In particular, they
      SHOULD keep original communities when they apply a community.
      Customers might need them to communicate with upstream providers.
      In particular, network administrators SHOULD NOT (generally)
      remove the no-export community, as it is usually announced by
      their peer for a certain purpose.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/12.%20%20Security%20Considerations"></a><a class="selflink" href="#section-12" name="section-12">12</a>.  Security Considerations</span>

   This document is entirely about BGP operational security.  It depicts
   best practices that one should adopt to secure BGP infrastructure:
   protecting BGP router and BGP sessions, adopting consistent BGP
   prefix and AS path filters, and configuring other options to secure
   the BGP network.

   This document does not aim to describe existing BGP implementations,
   their potential vulnerabilities, or ways they handle errors.  It does
   not detail how protection could be enforced against attack techniques
   using crafted packets.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/13.%20%20References"></a><a class="selflink" href="#section-13" name="section-13">13</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/13.1.%20%20Normative%20References"></a><a class="selflink" href="#section-13.1" name="section-13.1">13.1</a>.  Normative References</span>

   [<a id="ref-1" name="ref-1">1</a>]   Bradner, S., "Key words for use in RFCs to Indicate Requirement
         Levels", <a href="rfc2119.html">RFC 2119</a>, March 1997,
         &lt;<a href="http://www.rfc-editor.org/info/rfc2119">http://www.rfc-editor.org/info/rfc2119</a>&gt;.

   [<a id="ref-2" name="ref-2">2</a>]   Rekhter,, Y., Li,, T., and S. Hares,, "A Border Gateway
         Protocol 4 (BGP-4)", <a href="rfc4271.html">RFC 4271</a>, January 2006,
         &lt;<a href="http://www.rfc-editor.org/info/rfc4271">http://www.rfc-editor.org/info/rfc4271</a>&gt;.

   [<a id="ref-3" name="ref-3">3</a>]   Gill, V., Heasley, J., Meyer, D., Savola,, P., and C.
         Pignataro, "The Generalized TTL Security Mechanism (GTSM)", <a href="rfc5082.html">RFC</a>
         <a href="rfc5082.html">5082</a>, October 2007, &lt;<a href="http://www.rfc-editor.org/info/rfc5082">http://www.rfc-editor.org/info/rfc5082</a>&gt;.






<span class="grey">Durand, et al.            Best Current Practice                [Page 21]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-22" id="page-22" name="page-22"> </a>
<span class="grey"><a href="rfc7454.html">RFC 7454</a>                        BGP OPSEC                  February 2015</span>


   [<a id="ref-4" name="ref-4">4</a>]   Touch, J., Mankin, A., and R. Bonica, "The TCP Authentication
         Option", <a href="rfc5925.html">RFC 5925</a>, June 2010,
         &lt;<a href="http://www.rfc-editor.org/info/rfc5925">http://www.rfc-editor.org/info/rfc5925</a>&gt;.

   [<a id="ref-5" name="ref-5">5</a>]   Mohapatra, P., Scudder, J., Ward, D., Bush, R., and R.
         Austein, "BGP Prefix Origin Validation", <a href="rfc6811.html">RFC 6811</a>, January
         2013, &lt;<a href="http://www.rfc-editor.org/info/rfc6811">http://www.rfc-editor.org/info/rfc6811</a>&gt;.

   [<a id="ref-6" name="ref-6">6</a>]   Pelsser, C., Bush, R., Patel, K., Mohapatra, P., and O.
         Maennel, "Making Route Flap Damping Usable", <a href="rfc7196.html">RFC 7196</a>, May
         2014, &lt;<a href="http://www.rfc-editor.org/info/rfc7196">http://www.rfc-editor.org/info/rfc7196</a>&gt;.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/13.2.%20%20Informative%20References"></a><a class="selflink" href="#section-13.2" name="section-13.2">13.2</a>.  Informative References</span>

   [<a id="ref-7" name="ref-7">7</a>]   Heffernan, A., "Protection of BGP Sessions via the TCP MD5
         Signature Option", <a href="rfc2385.html">RFC 2385</a>, August 1998,
         &lt;<a href="http://www.rfc-editor.org/info/rfc2385">http://www.rfc-editor.org/info/rfc2385</a>&gt;.

   [<a id="ref-8" name="ref-8">8</a>]   Ferguson, P. and D. Senie, "Network Ingress Filtering:
         Defeating Denial of Service Attacks which employ IP Source
         Address Spoofing", <a href="rfc2827.html">RFC 2827</a>, May 2000,
         &lt;<a href="http://www.rfc-editor.org/info/rfc2827">http://www.rfc-editor.org/info/rfc2827</a>&gt;.

   [<a id="ref-9" name="ref-9">9</a>]   Baker, F. and P. Savola, "Ingress Filtering for Multihomed
         Networks", <a href="rfc3704.html">RFC 3704</a>, March 2004,
         &lt;<a href="http://www.rfc-editor.org/info/rfc3704">http://www.rfc-editor.org/info/rfc3704</a>&gt;.

   [<a id="ref-10" name="ref-10">10</a>]  Blunk, L., Damas, J., Parent, F., and A. Robachevsky, "Routing
         Policy Specification Language next generation (RPSLng)", <a href="rfc4012.html">RFC</a>
         <a href="rfc4012.html">4012</a>, March 2005, &lt;<a href="http://www.rfc-editor.org/info/rfc4012">http://www.rfc-editor.org/info/rfc4012</a>&gt;.

   [<a id="ref-11" name="ref-11">11</a>]  Dugal, D., Pignataro, C., and R. Dunn, "Protecting the Router
         Control Plane", <a href="rfc6192.html">RFC 6192</a>, March 2011,
         &lt;<a href="http://www.rfc-editor.org/info/rfc6192">http://www.rfc-editor.org/info/rfc6192</a>&gt;.

   [<a id="ref-12" name="ref-12">12</a>]  Lepinski, M. and S. Kent, "An Infrastructure to Support Secure
         Internet Routing", <a href="rfc6480.html">RFC 6480</a>, February 2012,
         &lt;<a href="http://www.rfc-editor.org/info/rfc6480">http://www.rfc-editor.org/info/rfc6480</a>&gt;.

   [<a id="ref-13" name="ref-13">13</a>]  Hilliard, N. and D. Freedman, "A Discard Prefix for IPv6", <a href="rfc6666.html">RFC</a>
         <a href="rfc6666.html">6666</a>, August 2012, &lt;<a href="http://www.rfc-editor.org/info/rfc6666">http://www.rfc-editor.org/info/rfc6666</a>&gt;.

   [<a id="ref-14" name="ref-14">14</a>]  Jethanandani, M., Patel, K., and L. Zheng, "Analysis of BGP,
         LDP, PCEP, and MSDP Issues According to the Keying and
         Authentication for Routing Protocols (KARP) Design Guide", <a href="rfc6952.html">RFC</a>
         <a href="rfc6952.html">6952</a>, May 2013, &lt;<a href="http://www.rfc-editor.org/info/rfc6952">http://www.rfc-editor.org/info/rfc6952</a>&gt;.





<span class="grey">Durand, et al.            Best Current Practice                [Page 22]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-23" id="page-23" name="page-23"> </a>
<span class="grey"><a href="rfc7454.html">RFC 7454</a>                        BGP OPSEC                  February 2015</span>


   [<a id="ref-15" name="ref-15">15</a>]  Bush, R., "Origin Validation Operation Based on the Resource
         Public Key Infrastructure (RPKI)", <a href="rfc7115.html">RFC 7115</a>, January 2014,
         &lt;<a href="http://www.rfc-editor.org/info/rfc7115">http://www.rfc-editor.org/info/rfc7115</a>&gt;.

   [<a id="ref-16" name="ref-16">16</a>]  Kent, S. and A. Chi, "Threat Model for BGP Path Security", <a href="rfc7132.html">RFC</a>
         <a href="rfc7132.html">7132</a>, February 2014, &lt;<a href="http://www.rfc-editor.org/info/rfc7132">http://www.rfc-editor.org/info/rfc7132</a>&gt;.

   [<a id="ref-17" name="ref-17">17</a>]  Jasinska, E., Hilliard, N., Raszuk, R., and N. Bakker,
         "Internet Exchange Route Server", Work in Progress,
         <a href="https://tools.ietf.org/html/draft-ietf-idr-ix-bgp-route-server-06">draft-ietf-idr-ix-bgp-route-server-06</a>, December 2014.

   [<a id="ref-18" name="ref-18">18</a>]  Karrenberg, D., "RIPE-351 - De-Bogonising New Address Blocks",
         October 2005.

   [<a id="ref-19" name="ref-19">19</a>]  Smith, P. and C. Panigl, "RIPE-378 - RIPE Routing Working Group
         Recommendations On Route-flap Damping", May 2006.

   [<a id="ref-20" name="ref-20">20</a>]  Smith, P., Evans, R., and M. Hughes, "RIPE-399 - RIPE Routing
         Working Group Recommendations on Route Aggregation", December
         2006.

   [<a id="ref-21" name="ref-21">21</a>]  Smith, P. and R. Evans, "RIPE-532 - RIPE Routing Working Group
         Recommendations on IPv6 Route Aggregation", November 2011.

   [<a id="ref-22" name="ref-22">22</a>]  Smith, P., Bush, R., Kuhne, M., Pelsser, C., Maennel, O.,
         Patel, K., Mohapatra, P., and R. Evans, "RIPE-580 - RIPE
         Routing Working Group Recommendations On Route-flap Damping",
         January 2013.

   [<a id="ref-23" name="ref-23">23</a>]  IANA, "IANA IPv4 Special-Purpose Address Registry",
         &lt;<a href="http://www.iana.org/assignments/iana-ipv4-special-registry">http://www.iana.org/assignments/iana-ipv4-special-registry</a>&gt;.

   [<a id="ref-24" name="ref-24">24</a>]  IANA, "IANA IPv6 Special-Purpose Address Registry",
         &lt;<a href="http://www.iana.org/assignments/iana-ipv6-special-registry">http://www.iana.org/assignments/iana-ipv6-special-registry</a>&gt;.

   [<a id="ref-25" name="ref-25">25</a>]  IANA, "IANA IPv4 Address Space Registry",
         &lt;<a href="http://www.iana.org/assignments/ipv4-address-space">http://www.iana.org/assignments/ipv4-address-space</a>&gt;.

   [<a id="ref-26" name="ref-26">26</a>]  IANA, "Internet Protocol Version 6 Address Space",
         &lt;<a href="http://www.iana.org/assignments/ipv6-address-space">http://www.iana.org/assignments/ipv6-address-space</a>&gt;.

   [<a id="ref-27" name="ref-27">27</a>]  Merit Network Inc., "Merit RADb", &lt;<a href="http://www.radb.net/">http://www.radb.net</a>&gt;.

   [<a id="ref-28" name="ref-28">28</a>]  George, W. and S. Amante, "Autonomous System (AS) Migration
         Features and Their Effects on the BGP AS_PATH Attribute", Work
         in Progress, <a href="https://tools.ietf.org/html/draft-ga-idr-as-migration-03">draft-ga-idr-as-migration-03</a>, January 2014.





<span class="grey">Durand, et al.            Best Current Practice                [Page 23]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-24" id="page-24" name="page-24"> </a>
<span class="grey"><a href="rfc7454.html">RFC 7454</a>                        BGP OPSEC                  February 2015</span>


   [<a id="ref-29" name="ref-29">29</a>]  Bellovin, S., Bush, R., and D. Ward, "Security Requirements for
         BGP Path Validation", <a href="rfc7353.html">RFC 7353</a>, August 2014,
         &lt;<a href="http://www.rfc-editor.org/info/rfc7353">http://www.rfc-editor.org/info/rfc7353</a>&gt;.

   [<a id="ref-30" name="ref-30">30</a>]  "IRRToolSet project page", &lt;<a href="http://irrtoolset.isc.org/">http://irrtoolset.isc.org</a>&gt;.

   [<a id="ref-31" name="ref-31">31</a>]  Cooper, D., Heilman, E., Brogle, K., Reyzin, L., and S.
         Goldberg, "On the Risk of Misbehaving RPKI Authorities",
         &lt;<a href="http://www.cs.bu.edu/~goldbe/papers/hotRPKI.pdf">http://www.cs.bu.edu/~goldbe/papers/hotRPKI.pdf</a>&gt;.










































<span class="grey">Durand, et al.            Best Current Practice                [Page 24]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-25" id="page-25" name="page-25"> </a>
<span class="grey"><a href="rfc7454.html">RFC 7454</a>                        BGP OPSEC                  February 2015</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/Appendix%20A.%20%20IXP%20LAN%20Prefix%20Filtering%20-%20Example"></a><a class="selflink" href="#appendix-A" name="appendix-A">Appendix A</a>.  IXP LAN Prefix Filtering - Example</span>

   An IXP in the RIPE region is allocated an IPv4 /22 prefix by RIPE NCC
   (X.Y.0.0/22 in this example) and uses a /23 of this /22 for the IXP
   LAN (let say X.Y.0.0/23).  This IXP LAN prefix is the one used by IXP
   members to configure EBGP peerings.  The IXP could also be allocated
   an AS number (AS64496 in our example).

   Any IXP member SHOULD make sure it filters prefixes more specific
   than X.Y.0.0/23 from all its EBGP peers.  If it received X.Y.0.0/24
   or X.Y.1.0/24 this could seriously impact its routing.

   The IXP SHOULD originate X.Y.0.0/22 and advertise it to its members
   through an EBGP peering (most likely from its BGP route servers,
   configured with AS64496).

   The IXP members SHOULD accept the IXP prefix only if it passes the
   IRR generated filters (see <a href="#section-6.1.2.2.1">Section 6.1.2.2.1</a>)

   IXP members SHOULD then advertise X.Y.0.0/22 prefix to their
   downstreams.  This announce would pass IRR based filters as it is
   originated by the IXP.

Acknowledgements

   The authors would like to thank the following people for their
   comments and support: Marc Blanchet, Ron Bonica, Randy Bush, David
   Freedman, Wesley George, Daniel Ginsburg, David Groves, Mike Hugues,
   Joel Jaeggli, Tim Kleefass, Warren Kumari, Jacques Latour, Lionel
   Morand, Jerome Nicolle, Hagen Paul Pfeifer, Thomas Pinaud, Carlos
   Pignataro, Jean Rebiffe, Donald Smith, Kotikalapudi Sriram, Matjaz
   Straus, Tony Tauber, Gunter Van de Velde, Sebastian Wiesinger, and
   Matsuzaki Yoshinobu.

   The authors would like to thank once again Gunter Van de Velde for
   presenting the document at several IETF meetings in various working
   groups, indeed helping dissemination of this document and gathering
   of precious feedback.













<span class="grey">Durand, et al.            Best Current Practice                [Page 25]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-26" id="page-26" name="page-26"> </a>
<span class="grey"><a href="rfc7454.html">RFC 7454</a>                        BGP OPSEC                  February 2015</span>


Authors' Addresses

   Jerome Durand
   Cisco Systems, Inc.
   11 rue Camille Desmoulins
   Issy-les-Moulineaux  92782 CEDEX
   France

   EMail: jerduran@cisco.com


   Ivan Pepelnjak
   NIL Data Communications
   Tivolska 48
   Ljubljana  1000
   Slovenia

   EMail: ip@ipspace.net


   Gert Doering
   SpaceNet AG
   Joseph-Dollinger-Bogen 14
   Muenchen  D-80807
   Germany

   EMail: gert@space.net
























Durand, et al.            Best Current Practice                [Page 26]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc7454 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:21 GMT --></html>