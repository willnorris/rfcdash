<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<!-- Mirrored from tools.ietf.org/html/rfc8242 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 28 Jul 2019 12:16:12 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head profile="http://dublincore.org/documents/2008/08/04/dc-html/">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="robots" content="index,follow" />
    <meta name="creator" content="rfcmarkup version 1.129c" />
    <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" />
<meta name="DC.Relation.Replaces" content="draft-haas-i2rs-ephemeral-state-reqs" />
<meta name="DC.Identifier" content="urn:ietf:rfc:8242" />
<meta name="DC.Date.Issued" content="September, 2017" />
<meta name="DC.Creator" content="Hares, Susan" />
<meta name="DC.Creator" content="Haas, Jeffrey" />
<meta name="DC.Description.Abstract" content="&quot;An Architecture for the Interface to the Routing System&quot; (RFC 7921)
abstractly describes a number of requirements for ephemeral state (in
terms of capabilities and behaviors) that any protocol suite
attempting to meet the needs of the Interface to the Routing System
(I2RS) protocol has to provide. This document describes, in detail,
requirements for ephemeral state for those implementing the I2RS
protocol." />
<meta name="DC.Title" content="Interface to the Routing System (I2RS) Ephemeral State Requirements" />

    <link rel="icon" href="https://tools.ietf.org/images/rfc.png" type="image/png" />
    <link rel="shortcut icon" href="https://tools.ietf.org/images/rfc.png" type="image/png" />
    <title>RFC 8242 - Interface to the Routing System (I2RS) Ephemeral State Requirements</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div onmouseover="this.style.cursor='pointer';"
         onclick="showElem('legend');"
         onmouseout="hideElem('legend')"
	 style="height: 6px; position: absolute;"
         class="pre noprint docinfo bgorange"
         title="Click for colour legend." >                                                                        </div>
      <div id="legend"
           class="docinfo noprint pre legend"
           style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; "
           onmouseover="showElem('legend');"
           onmouseout="hideElem('legend');">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc8242.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc8242" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-i2rs-ephemeral-state" title="draft-ietf-i2rs-ephemeral-state">draft-ietf-i2rs...</a>] [<a href='https://datatracker.ietf.org/doc/rfc8242' title='IESG Datatracker information for this document'>Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc8242" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc8242" title="Side-by-side diff">Diff2</a>]         </span><br />
<span class="pre noprint docinfo">                                                                        </span><br />
<span class="pre noprint docinfo">                                                           INFORMATIONAL</span><br />
<span class="pre noprint docinfo">                                                                        </span><br />
<pre>
Internet Engineering Task Force (IETF)                           J. Haas
Request for Comments: 8242                                       Juniper
Category: Informational                                         S. Hares
ISSN: 2070-1721                                                   Huawei
                                                          September 2017


  <span class="h1">Interface to the Routing System (I2RS) Ephemeral State Requirements</span>

Abstract

   "An Architecture for the Interface to the Routing System" (<a href="rfc7921.html">RFC 7921</a>)
   abstractly describes a number of requirements for ephemeral state (in
   terms of capabilities and behaviors) that any protocol suite
   attempting to meet the needs of the Interface to the Routing System
   (I2RS) protocol has to provide.  This document describes, in detail,
   requirements for ephemeral state for those implementing the I2RS
   protocol.

Status of This Memo

   This document is not an Internet Standards Track specification; it is
   published for informational purposes.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Not all documents
   approved by the IESG are a candidate for any level of Internet
   Standard; see <a href="rfc7841.html#section-2">Section&nbsp;2 of RFC 7841</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="https://www.rfc-editor.org/info/rfc8242">https://www.rfc-editor.org/info/rfc8242</a>.

















<span class="grey">Haas &amp; Hares                  Informational                     [Page 1]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-2" id="page-2" href="#page-2" class="invisible"> </a>
<span class="grey"><a href="rfc8242.html">RFC 8242</a>            I2RS Ephemeral State Requirements     September 2017</span>


Copyright Notice

   Copyright (c) 2017 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-3">3</a>
      <a href="#section-1.1">1.1</a>. Requirements Language ......................................<a href="#page-4">4</a>
   <a href="#section-2">2</a>. Architectural Requirements for Ephemeral State ..................<a href="#page-4">4</a>
   <a href="#section-3">3</a>. Ephemeral State Requirements ....................................<a href="#page-5">5</a>
      <a href="#section-3.1">3.1</a>. Persistence ................................................<a href="#page-5">5</a>
      <a href="#section-3.2">3.2</a>. Constraints ................................................<a href="#page-6">6</a>
      <a href="#section-3.3">3.3</a>. Hierarchy ..................................................<a href="#page-6">6</a>
      <a href="#section-3.4">3.4</a>. Ephemeral Configuration Overlapping Local Configuration ....<a href="#page-6">6</a>
   <a href="#section-4">4</a>. YANG Features for Ephemeral State ...............................<a href="#page-7">7</a>
   <a href="#section-5">5</a>. NETCONF Features for Ephemeral State ............................<a href="#page-7">7</a>
   <a href="#section-6">6</a>. RESTCONF Features for Ephemeral State ...........................<a href="#page-7">7</a>
   7. Requirements regarding Supporting Multi-Head Control via
      Client ..........................................................<a href="#page-7">7</a>
   <a href="#section-8">8</a>. Multiple Message Transactions ...................................<a href="#page-9">9</a>
   <a href="#section-9">9</a>. Pub/Sub Requirements Expanded for Ephemeral State ...............<a href="#page-9">9</a>
   <a href="#section-10">10</a>. IANA Considerations ...........................................<a href="#page-10">10</a>
   <a href="#section-11">11</a>. Security Considerations .......................................<a href="#page-10">10</a>
   <a href="#section-12">12</a>. Normative References ..........................................<a href="#page-10">10</a>
   Acknowledgements ..................................................<a href="#page-12">12</a>
   Authors' Addresses ................................................<a href="#page-12">12</a>














<span class="grey">Haas &amp; Hares                  Informational                     [Page 2]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-3" id="page-3" href="#page-3" class="invisible"> </a>
<span class="grey"><a href="rfc8242.html">RFC 8242</a>            I2RS Ephemeral State Requirements     September 2017</span>


<span class="h2"><a class="selflink" name="section-1" href="#section-1">1</a>.  Introduction</span>

   The Interface to the Routing System (I2RS) Working Group (WG) is
   chartered with providing architecture and mechanisms to inject into
   and retrieve information from the routing system.  The I2RS
   Architecture document [<a href="rfc7921.html" title="&quot;An Architecture for the Interface to the Routing System&quot;">RFC7921</a>] abstractly documents a number of
   requirements for implementing the I2RS and defines ephemeral state as
   "state that does not survive the reboot of a routing device or the
   reboot of the software handling the I2RS software on a routing
   device" (see <a href="rfc7921.html#section-1.1">Section&nbsp;1.1 of [RFC7921]</a>).  <a href="#section-2">Section 2</a> of this document
   describes the specific requirements that the I2RS WG has identified
   based on the I2RS architecture's abstract requirements.  The
   Interface to the Routing System (I2RS) Working Group (WG) is
   chartered with providing architecture and mechanisms to inject into
   and retrieve information from the routing system.  The I2RS
   Architecture document [<a href="rfc7921.html" title="&quot;An Architecture for the Interface to the Routing System&quot;">RFC7921</a>] abstractly documents a number of
   requirements for implementing the I2RS and defines ephemeral state as
   "state that does not survive the reboot of a routing device or the
   reboot of the software handling the I2RS software on a routing
   device" (see <a href="rfc7921.html#section-1.1">Section&nbsp;1.1 of [RFC7921]</a>).  <a href="#section-2">Section 2</a> of this document
   provides a summary of these abstract requirements, and <a href="#section-3">section 3</a>
   recasts these abstract requirements into specific requirements for
   the Ephemeral state for any IETF network management system.

   The I2RS WG has chosen to use the YANG data modeling language
   [<a href="rfc7950.html" title="&quot;The YANG 1.1 Data Modeling Language&quot;">RFC7950</a>] as the basis to implement its mechanisms.

   Additionally, the I2RS WG has chosen to reuse two existing protocols,
   NETCONF [<a href="rfc6241.html" title="&quot;Network Configuration Protocol (NETCONF)&quot;">RFC6241</a>] and its similar but lighter-weight relative
   RESTCONF [<a href="rfc8040.html" title="&quot;RESTCONF Protocol&quot;">RFC8040</a>], as the protocols for carrying I2RS.

   What does reuse of a protocol mean?  Reuse means that while the
   combination of the YANG modeling language and the NETCONF and
   RESTCONF protocols is a good starting basis for the I2RS data
   modeling language and protocol, the requirements for I2RS protocol
   implementations should:

   1.  select features from the YANG modeling language and the NETCONF
       and RESTCONF protocols per version of the I2RS protocol (see
       Sections <a href="#section-4">4</a>, <a href="#section-5">5</a>, and <a href="#section-6">6</a>), and

   2.  propose additions to YANG, NETCONF, and RESTCONF per version of
       the I2RS protocol for key functions (ephemeral state, protocol
       security, publication/subscription service, traceability).

   The purpose of these requirements is to ensure clarity during I2RS
   protocol creation.




<span class="grey">Haas &amp; Hares                  Informational                     [Page 3]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-4" id="page-4" href="#page-4" class="invisible"> </a>
<span class="grey"><a href="rfc8242.html">RFC 8242</a>            I2RS Ephemeral State Requirements     September 2017</span>


   Support for ephemeral state is an I2RS protocol requirement that
   necessitates datastore changes (see <a href="#section-3">Section 3</a>), YANG additions (see
   <a href="#section-4">Section 4</a>), NETCONF additions (see <a href="#section-5">Section 5</a>), and RESTCONF additions
   (see <a href="#section-6">Section 6</a>).

   Sections <a href="#section-7">7</a>-<a href="#section-9">9</a> provide details that expand upon the changes in Sections
   3-6 to clarify requirements discussed by the I2RS and NETCONF WGs.
   <a href="#section-7">Section 7</a> provides additional requirements that detail how write-
   conflicts should be resolved if two I2RS client write the same data.
   <a href="#section-8">Section 8</a> describes I2RS requirements for support of multiple message
   transactions.  <a href="#section-9">Section 9</a> highlights two requirements for I2RS
   publication/subscription [<a href="rfc7923.html" title="&quot;Requirements for Subscription to YANG Datastores&quot;">RFC7923</a>] that must be expanded for
   ephemeral state.

<span class="h3"><a class="selflink" name="section-1.1" href="#section-1.1">1.1</a>.  Requirements Language</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in
   <a href="https://tools.ietf.org/html/bcp14">BCP 14</a> [<a href="rfc2119.html" title="&quot;Key words for use in RFCs to Indicate Requirement Levels&quot;">RFC2119</a>] [<a href="rfc8174.html" title="&quot;Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words&quot;">RFC8174</a>] when, and only when, they appear in all
   capitals, as shown here.

<span class="h2"><a class="selflink" name="section-2" href="#section-2">2</a>.  Architectural Requirements for Ephemeral State</span>

   The I2RS architecture [<a href="rfc7921.html" title="&quot;An Architecture for the Interface to the Routing System&quot;">RFC7921</a>] and the I2RS problem statement
   [<a href="rfc7920.html" title="&quot;Problem Statement for the Interface to the Routing System&quot;">RFC7920</a>] define the important high-level requirements for the I2RS
   protocol in abstract terms.  This section distills this high-level
   abstract guidance into specific requirements for the I2RS protocol.
   To aid the reader, there are references back to the abstract
   descriptions in the I2RS architecture document and the I2RS problem
   statement, but the reader should note the requirements below are not
   explicitly stated in the I2RS architecture document or in the I2RS
   problem statement.

   Requirements:

   1.  The I2RS protocol SHOULD support an asynchronous programmatic
       interface with properties described in <a href="rfc7920.html#section-5">Section&nbsp;5 of [RFC7920]</a>
       (e.g., high throughput) with support for target information
       streams, filtered events, and thresholded events (real-time
       events) sent by an I2RS agent to an I2RS client (from <a href="rfc7921.html#section-1.1">Section&nbsp;1.1
       of [RFC7921]</a>).









<span class="grey">Haas &amp; Hares                  Informational                     [Page 4]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-5" id="page-5" href="#page-5" class="invisible"> </a>
<span class="grey"><a href="rfc8242.html">RFC 8242</a>            I2RS Ephemeral State Requirements     September 2017</span>


   2.  An I2RS agent MUST record the client identity when a node is
       created or modified.  The I2RS agent SHOULD be able to read the
       client identity of a node and use the client identity's
       associated priority to resolve conflicts.  The secondary identity
       is useful for traceability and may also be recorded (from
       <a href="rfc7921.html#section-4">Section&nbsp;4 of [RFC7921]</a>).

   3.  An I2RS client identity MUST have only one priority for the
       client's identifier.  A collision on writes is considered an
       error, but the priority associated with each client identifier is
       utilized to compare requests from two different clients in order
       to modify an existing node entry.  Only an entry from a client
       that is higher priority can modify an existing entry (first entry
       wins).  Priority only has meaning at the time of use (from
       <a href="rfc7921.html#section-7.8">Section&nbsp;7.8 of [RFC7921]</a>).

   4.  An I2RS client's secondary identity data is read-only metadata
       that is recorded by the I2RS agent associated with a data model's
       node when the data node is written.  Just like the primary client
       identity, the secondary identity SHOULD only be recorded when the
       data node is written (from Sections <a href="#section-7.4">7.4</a> of [<a href="rfc7921.html" title="&quot;An Architecture for the Interface to the Routing System&quot;">RFC7921</a>].)

   5.  An I2RS agent MAY have a lower-priority I2RS client attempting to
       modify a higher-priority client's entry in a data model.  The
       filtering out of lower-priority clients attempting to write or
       modify a higher-priority client's entry in a data model SHOULD be
       effectively handled and SHOULD not put an undue strain on the
       I2RS agent.  (See <a href="rfc7921.html#section-7.8">Section&nbsp;7.8 of [RFC7921]</a> augmented by the
       resource limitation language in <a href="rfc7921.html#section-8">Section&nbsp;8 [RFC7921]</a>.)

<span class="h2"><a class="selflink" name="section-3" href="#section-3">3</a>.  Ephemeral State Requirements</span>

   In requirements Ephemeral-REQ-01 to Ephemeral-REQ-15, Ephemeral state
   is defined as potentially including in a data model ephemeral
   configuration and operational state which is flagged as ephemeral.

<span class="h3"><a class="selflink" name="section-3.1" href="#section-3.1">3.1</a>.  Persistence</span>

   Ephemeral-REQ-01: I2RS requires ephemeral state, i.e., state that
   does not persist across reboots.  If state must be restored, it
   should be done solely by replay actions from the I2RS client via the
   I2RS agent.

   At first glance, the I2RS ephemeral state may seem equivalent to the
   writable-running datastore in NETCONF (e.g., running-config), which
   can be copied to a datastore that persists across a reboot (software
   or hardware).  However, I2RS ephemeral state MUST NOT persist across
   a reboot (software or hardware).



<span class="grey">Haas &amp; Hares                  Informational                     [Page 5]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-6" id="page-6" href="#page-6" class="invisible"> </a>
<span class="grey"><a href="rfc8242.html">RFC 8242</a>            I2RS Ephemeral State Requirements     September 2017</span>


<span class="h3"><a class="selflink" name="section-3.2" href="#section-3.2">3.2</a>.  Constraints</span>

   Ephemeral-REQ-02: Non-ephemeral state MUST NOT refer to ephemeral
   state for constraint purposes; it SHALL be considered a validation
   error if it does.

   Ephemeral-REQ-03: Ephemeral state MUST be able to have constraints
   that refer to operational state, this includes potentially fast-
   changing or short-lived operational state nodes, such as MPLS LSP-ID
   (label-switched path ID) or a BGP Adj-RIB-IN (Adjacent RIB Inbound).
   Ephemeral state constraints should be assessed when the ephemeral
   state is written, and if any of the constraints change to make the
   constraints invalid after that time, the I2RS agent SHOULD notify the
   I2RS client.

   Ephemeral-REQ-04: Ephemeral state MUST be able to refer to non-
   ephemeral state as a constraint.  Non-ephemeral state can be
   configuration state or operational state.

   Ephemeral-REQ-05: I2RS pub-sub [<a href="rfc7923.html" title="&quot;Requirements for Subscription to YANG Datastores&quot;">RFC7923</a>], tracing [<a href="rfc7922.html" title="&quot;Interface to the Routing System (I2RS) Traceability: Framework and Information Model&quot;">RFC7922</a>], RPC, or
   other mechanisms may lead to undesirable or unsustainable resource
   consumption on a system implementing an I2RS agent.  It is
   RECOMMENDED that mechanisms be made available to permit
   prioritization of I2RS operations, when appropriate, to permit
   implementations to shed work load when operating under constrained
   resources.  An example of such a work-shedding mechanism is rate-
   limiting.

<span class="h3"><a class="selflink" name="section-3.3" href="#section-3.3">3.3</a>.  Hierarchy</span>

   Ephemeral-REQ-06: YANG MUST have the ability to do the following:

   1.  define a YANG module or submodule schema that only contains data
       nodes with the property of being ephemeral, and

   2.  augment a YANG module with additional YANG schema nodes that have
       the property of being ephemeral.

<span class="h3"><a class="selflink" name="section-3.4" href="#section-3.4">3.4</a>.  Ephemeral Configuration Overlapping Local Configuration</span>

   Ephemeral-REQ-07: Local configuration MUST have a priority that is
   comparable with individual I2RS client priorities for making changes.
   This priority will determine whether local configuration changes or
   individual ephemeral configuration changes take precedence as
   described in [<a href="rfc7921.html" title="&quot;An Architecture for the Interface to the Routing System&quot;">RFC7921</a>].  The I2RS protocol MUST support this
   mechanism.





<span class="grey">Haas &amp; Hares                  Informational                     [Page 6]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-7" id="page-7" href="#page-7" class="invisible"> </a>
<span class="grey"><a href="rfc8242.html">RFC 8242</a>            I2RS Ephemeral State Requirements     September 2017</span>


<span class="h2"><a class="selflink" name="section-4" href="#section-4">4</a>.  YANG Features for Ephemeral State</span>

   Ephemeral-REQ-08: In addition to config true/false, there MUST be a
   way to indicate that YANG schema nodes represent ephemeral state.  It
   is desirable to allow for, and have a way to indicate, config false
   YANG schema nodes that are writable operational state.

<span class="h2"><a class="selflink" name="section-5" href="#section-5">5</a>.  NETCONF Features for Ephemeral State</span>

   Ephemeral-REQ-09: The changes to NETCONF must include:

   1.  Support for communication mechanisms to enable an I2RS client to
       determine that an I2RS agent supports the mechanisms needed for
       I2RS operation.

   2.  The ephemeral state MUST support notification of write conflicts
       using the priority requirements defined in <a href="#section-7">Section 7</a> (see
       requirements Ephemeral-REQ-11 through Ephemeral-REQ-14).

<span class="h2"><a class="selflink" name="section-6" href="#section-6">6</a>.  RESTCONF Features for Ephemeral State</span>

   Ephemeral-REQ-10: The conceptual changes to RESTCONF are:

   1.  Support for communication mechanisms to enable an I2RS client to
       determine that an I2RS agent supports the mechanisms needed for
       I2RS operation.

   2.  The ephemeral state MUST support notification of write conflicts
       using the priority requirements defined in <a href="#section-7">Section 7</a> (see
       requirements Ephemeral-REQ-11 through Ephemeral-REQ-14).

<span class="h2"><a class="selflink" name="section-7" href="#section-7">7</a>.  Requirements regarding Supporting Multi-Head Control via Client</span>
<span class="h2">    Priority</span>

   To support multi-headed control, I2RS requires that there be a
   decidable means of arbitrating the correct state of data when
   multiple clients attempt to manipulate the same piece of data.  This
   is done via a priority mechanism with the highest priority winning.
   This priority is per client.

   Ephemeral-REQ-11: The following requirements must be supported by the
   I2RS protocol in order to support I2RS client identity and priority:

   o  the data nodes MUST store I2RS client identity and MAY store the
      effective priority at the time the data node is stored.






<span class="grey">Haas &amp; Hares                  Informational                     [Page 7]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-8" id="page-8" href="#page-8" class="invisible"> </a>
<span class="grey"><a href="rfc8242.html">RFC 8242</a>            I2RS Ephemeral State Requirements     September 2017</span>


   o  Per SEC-REQ-07 in <a href="rfc8241.html#section-4.3">Section&nbsp;4.3 of [RFC8241]</a>, an I2RS Identifier
      MUST have just one priority.  The I2RS protocol MUST support the
      ability to have data nodes store I2RS client identity and not the
      effective priority of the I2RS client at the time the data node is
      stored.

   o  The priority MAY be dynamically changed by AAA, but the exact
      actions are part of the protocol definition as long as collisions
      are handled as described in Ephemeral-REQ-12, Ephemeral-REQ-13,
      and Ephemeral-REQ-14.

   Ephemeral-REQ-12: When a collision occurs as two I2RS clients are
   trying to write the same data node, this collision is considered an
   error.  The I2RS priorities are used to provide a deterministic
   resolution to the conflict.  When there is a collision, and the data
   node is changed, a notification (which includes indicating the data
   node the collision occurred on) MUST be sent to the original client
   to give the original client a chance to deal with the issues
   surrounding the collision.  The original client may need to fix their
   state.

   Explanation: RESTCONF and NETCONF updates can come in concurrently
   from alternative sources.  Therefore, the collision detection and
   comparison of priority needs to occur for any type of update.

   For example, RESTCONF tracks the source of configuration change via
   the entity-tag (see <a href="rfc8040.html#section-3.5.2">Section&nbsp;3.5.2 of [RFC8040]</a>), which the server
   returns to the client along with the value in GET or HEAD methods.
   RESTCONF requires that this resource entity-tag be updated whenever a
   resource or configuration resource within the resource is altered.
   In the RESTCONF processing, when the resource or a configuration
   resource within the resource is altered, the processing of the
   configuration change for two I2RS clients must detect an I2RS
   collision and resolve the collision using the priority mechanism.

   Ephemeral-REQ-13: Multi-headed control is required for collisions and
   the priority resolution of collisions.  Multi-headed control is not
   tied to ephemeral state.  The I2RS protocol MUST NOT mandate the
   internal mechanism for how AAA protocols (e.g., Radius or Diameter)
   or mechanisms distribute priority per identity except that any AAA
   protocols MUST operate over a secure transport layer (see Radius
   [<a href="rfc6614.html" title="&quot;Transport Layer Security (TLS) Encryption for RADIUS&quot;">RFC6614</a>] and Diameter [<a href="rfc6733.html" title="&quot;Diameter Base Protocol&quot;">RFC6733</a>]).  Mechanisms that prevent
   collisions of two clients trying to modify the same node of data are
   the focus.







<span class="grey">Haas &amp; Hares                  Informational                     [Page 8]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-9" id="page-9" href="#page-9" class="invisible"> </a>
<span class="grey"><a href="rfc8242.html">RFC 8242</a>            I2RS Ephemeral State Requirements     September 2017</span>


   Ephemeral-REQ-14: A deterministic conflict resolution mechanism MUST
   be provided to handle the error scenario in which two clients, with
   the same priority, update the same configuration data node.  The I2RS
   architecture gives one way that this could be achieved: by specifying
   that the first update wins.  Other solutions that prevent oscillation
   of the config data node are also acceptable.

<span class="h2"><a class="selflink" name="section-8" href="#section-8">8</a>.  Multiple Message Transactions</span>

   Ephemeral-REQ-15: <a href="#section-7.9">Section 7.9</a> of the [<a href="rfc7921.html" title="&quot;An Architecture for the Interface to the Routing System&quot;">RFC7921</a>] states the I2RS
   architecture does not include multi-message atomicity and roll-back
   mechanisms.  The I2RS protocol implementation MUST NOT require the
   support of these features.  As part of this requirement, the I2RS
   protocol should support:

      multiple operations in one message.  An error in one operation
      MUST NOT stop additional operations from being carried out, nor
      can it cause previous operations to be rolled back.

      multiple operations in multiple messages, but multiple message-
      command error handling MUST NOT insert errors into the I2RS
      ephemeral state.

<span class="h2"><a class="selflink" name="section-9" href="#section-9">9</a>.  Pub/Sub Requirements Expanded for Ephemeral State</span>

   I2RS clients require the ability to monitor changes to ephemeral
   state.  While subscriptions are well defined for receiving
   notifications, the need to create a notification set for all
   ephemeral configuration state may be overly burdensome to the user.

   Thus, there is a need for a general subscription mechanism that can
   provide notification of changed state, with sufficient information to
   permit the client to retrieve the impacted nodes.  This should be
   doable without requiring the notifications to be created as part of
   every single I2RS module.

   The publication/subscription requirements for I2RS are in [<a href="rfc7923.html" title="&quot;Requirements for Subscription to YANG Datastores&quot;">RFC7923</a>],
   and the following general requirements SHOULD be understood to be
   expanded to include ephemeral state:

   o  Pub-Sub-REQ-01: The subscription service MUST support
      subscriptions against ephemeral state in operational datastores,
      configuration datastores, or both.








<span class="grey">Haas &amp; Hares                  Informational                     [Page 9]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-10" id="page-10" href="#page-10" class="invisible"> </a>
<span class="grey"><a href="rfc8242.html">RFC 8242</a>            I2RS Ephemeral State Requirements     September 2017</span>


   o  Pub-Sub-REQ-02: The subscription service MUST support filtering so
      that subscribed updates under a target node might publish either:

      1.  only ephemeral state in operational data or configuration
          data, or

      2.  both ephemeral and operational data.

   o  Pub-Sub-REQ-03: The subscription service MUST support
      subscriptions that are ephemeral.  (For example, an ephemeral data
      model that has ephemeral subscriptions.)

<span class="h2"><a class="selflink" name="section-10" href="#section-10">10</a>.  IANA Considerations</span>

   This document does not require any IANA actions.

<span class="h2"><a class="selflink" name="section-11" href="#section-11">11</a>.  Security Considerations</span>

   The security requirements for the I2RS protocol are covered in
   [<a href="rfc8241.html" title="&quot;Interface to the Routing System (I2RS) Security-Related Requirements&quot;">RFC8241</a>].

<span class="h2"><a class="selflink" name="section-12" href="#section-12">12</a>.  Normative References</span>

   [<a name="ref-RFC2119" id="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>,
              DOI 10.17487/RFC2119, March 1997,
              &lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;.

   [<a name="ref-RFC6241" id="ref-RFC6241">RFC6241</a>]  Enns, R., Ed., Bjorklund, M., Ed., Schoenwaelder, J., Ed.,
              and A. Bierman, Ed., "Network Configuration Protocol
              (NETCONF)", <a href="rfc6241.html">RFC 6241</a>, DOI 10.17487/RFC6241, June 2011,
              &lt;<a href="https://www.rfc-editor.org/info/rfc6241">https://www.rfc-editor.org/info/rfc6241</a>&gt;.

   [<a name="ref-RFC6614" id="ref-RFC6614">RFC6614</a>]  Winter, S., McCauley, M., Venaas, S., and K. Wierenga,
              "Transport Layer Security (TLS) Encryption for RADIUS",
              <a href="rfc6614.html">RFC 6614</a>, DOI 10.17487/RFC6614, May 2012,
              &lt;<a href="https://www.rfc-editor.org/info/rfc6614">https://www.rfc-editor.org/info/rfc6614</a>&gt;.

   [<a name="ref-RFC6733" id="ref-RFC6733">RFC6733</a>]  Fajardo, V., Ed., Arkko, J., Loughney, J., and G. Zorn,
              Ed., "Diameter Base Protocol", <a href="rfc6733.html">RFC 6733</a>,
              DOI 10.17487/RFC6733, October 2012,
              &lt;<a href="https://www.rfc-editor.org/info/rfc6733">https://www.rfc-editor.org/info/rfc6733</a>&gt;.

   [<a name="ref-RFC7920" id="ref-RFC7920">RFC7920</a>]  Atlas, A., Ed., Nadeau, T., Ed., and D. Ward, "Problem
              Statement for the Interface to the Routing System",
              <a href="rfc7920.html">RFC 7920</a>, DOI 10.17487/RFC7920, June 2016,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7920">https://www.rfc-editor.org/info/rfc7920</a>&gt;.




<span class="grey">Haas &amp; Hares                  Informational                    [Page 10]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-11" id="page-11" href="#page-11" class="invisible"> </a>
<span class="grey"><a href="rfc8242.html">RFC 8242</a>            I2RS Ephemeral State Requirements     September 2017</span>


   [<a name="ref-RFC7921" id="ref-RFC7921">RFC7921</a>]  Atlas, A., Halpern, J., Hares, S., Ward, D., and T.
              Nadeau, "An Architecture for the Interface to the Routing
              System", <a href="rfc7921.html">RFC 7921</a>, DOI 10.17487/RFC7921, June 2016,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7921">https://www.rfc-editor.org/info/rfc7921</a>&gt;.

   [<a name="ref-RFC7922" id="ref-RFC7922">RFC7922</a>]  Clarke, J., Salgueiro, G., and C. Pignataro, "Interface to
              the Routing System (I2RS) Traceability: Framework and
              Information Model", <a href="rfc7922.html">RFC 7922</a>, DOI 10.17487/RFC7922, June
              2016, &lt;<a href="https://www.rfc-editor.org/info/rfc7922">https://www.rfc-editor.org/info/rfc7922</a>&gt;.

   [<a name="ref-RFC7923" id="ref-RFC7923">RFC7923</a>]  Voit, E., Clemm, A., and A. Gonzalez Prieto, "Requirements
              for Subscription to YANG Datastores", <a href="rfc7923.html">RFC 7923</a>,
              DOI 10.17487/RFC7923, June 2016,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7923">https://www.rfc-editor.org/info/rfc7923</a>&gt;.

   [<a name="ref-RFC7950" id="ref-RFC7950">RFC7950</a>]  Bjorklund, M., Ed., "The YANG 1.1 Data Modeling Language",
              <a href="rfc7950.html">RFC 7950</a>, DOI 10.17487/RFC7950, August 2016,
              &lt;<a href="https://www.rfc-editor.org/info/rfc7950">https://www.rfc-editor.org/info/rfc7950</a>&gt;.

   [<a name="ref-RFC8040" id="ref-RFC8040">RFC8040</a>]  Bierman, A., Bjorklund, M., and K. Watsen, "RESTCONF
              Protocol", <a href="rfc8040.html">RFC 8040</a>, DOI 10.17487/RFC8040, January 2017,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8040">https://www.rfc-editor.org/info/rfc8040</a>&gt;.

   [<a name="ref-RFC8174" id="ref-RFC8174">RFC8174</a>]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in <a href="rfc2119.html">RFC</a>
              <a href="rfc2119.html">2119</a> Key Words", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc8174.html">RFC 8174</a>, DOI 10.17487/RFC8174,
              May 2017, &lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;.

   [<a name="ref-RFC8241" id="ref-RFC8241">RFC8241</a>]  Hares, S., Migault, D., and J. Halpern, "Interface to the
              Routing System (I2RS) Security-Related Requirements",
              <a href="rfc8241.html">RFC 8241</a>, DOI 10.17487/RFC8241, September 2017,
              &lt;<a href="https://www.rfc-editor.org/info/rfc8241">https://www.rfc-editor.org/info/rfc8241</a>&gt;.




















<span class="grey">Haas &amp; Hares                  Informational                    [Page 11]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-12" id="page-12" href="#page-12" class="invisible"> </a>
<span class="grey"><a href="rfc8242.html">RFC 8242</a>            I2RS Ephemeral State Requirements     September 2017</span>


Acknowledgements

   This document is an attempt to distill lengthy conversations on the
   I2RS mailing list for an architecture that was, for a long period of
   time, a moving target.  Some individuals in particular warrant
   specific mention for their extensive help in providing the basis for
   this document:

      Alia Atlas,
      Andy Bierman,
      Martin Bjorklund,
      Dean Bogdanavic,
      Rex Fernando,
      Joel Halpern,
      Thomas Nadeau,
      Juergen Schoenwaelder,
      Kent Watsen,
      Robert Wilton, and
      Joe Clarke.

Authors' Addresses

   Jeff Haas
   Juniper

   Email: jhaas@juniper.net


   Susan Hares
   Huawei
   Saline
   United States of America

   Email: shares@ndzh.com

















Haas &amp; Hares                  Informational                    [Page 12]

</pre><br />
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.129c, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>
</body>

<!-- Mirrored from tools.ietf.org/html/rfc8242 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 28 Jul 2019 12:16:12 GMT -->
</html>
