<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc4915 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:38 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="urn:ietf:rfc:4915" name="DC.Identifier"/>
<meta content="This document describes an extension to Open Shortest Path First
(OSPF) in order to define independent IP topologies called Multi-
Topologies (MTs). The Multi-Topologies extension can be used for
computing different paths for unicast traffic, multicast traffic,
different classes of service based on flexible criteria, or an in-
band network management topology.  An optional extension to exclude
selected links from the default topology is also described.
[STANDARDS-TRACK]" name="DC.Description.Abstract"/>
<meta content="Nguyen, Liem" name="DC.Creator"/>
<meta content="Psenak, Peter" name="DC.Creator"/>
<meta content="Mirtorabi, Sina" name="DC.Creator"/>
<meta content="Pillay-Esnault, Padma" name="DC.Creator"/>
<meta content="Roy, Abhay" name="DC.Creator"/>
<meta content="June, 2007" name="DC.Date.Issued"/>
<meta content="Multi-Topology (MT) Routing in OSPF" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 4915 - Multi-Topology (MT) Routing in OSPF</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgblue" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc4915.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc4915" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-ospf-mt" title="draft-ietf-ospf-mt">draft-ietf-ospf-mt</a>] [<a href="https://datatracker.ietf.org/doc/rfc4915" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc4915" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc4915" title="Side-by-side diff">Diff2</a>]         </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                       PROPOSED STANDARD</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Network Working Group                                          P. Psenak
Request for Comments: 4915                                 Cisco Systems
Category: Standards Track                                   S. Mirtorabi
                                                        Force10 Networks
                                                                  A. Roy
                                                               L. Nguyen
                                                       P. Pillay-Esnault
                                                           Cisco Systems
                                                               June 2007


                  <span class="h1">Multi-Topology (MT) Routing in OSPF</span>

Status of This Memo

   This document specifies an Internet standards track protocol for the
   Internet community, and requests discussion and suggestions for
   improvements.  Please refer to the current edition of the "Internet
   Official Protocol Standards" (STD 1) for the standardization state
   and status of this protocol.  Distribution of this memo is unlimited.

Copyright Notice

   Copyright (C) The IETF Trust (2007).

Abstract

   This document describes an extension to Open Shortest Path First
   (OSPF) in order to define independent IP topologies called Multi-
   Topologies (MTs).  The Multi-Topologies extension can be used for
   computing different paths for unicast traffic, multicast traffic,
   different classes of service based on flexible criteria, or an in-
   band network management topology.

   An optional extension to exclude selected links from the default
   topology is also described.















<span class="grey">Psenak, et al.              Standards Track                     [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc4915.html">RFC 4915</a>          Multi-Topology (MT) Routing in OSPF          June 2007</span>


Table of Contents

   <a href="#section-1">1</a>.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-3">3</a>
     1.1.  Differences between Multi-Topology and TOS-Based
           Routing  . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-3">3</a>
   <a href="#section-2">2</a>.  Terminology  . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-3">3</a>
     <a href="#section-2.1">2.1</a>.  Requirements Notation  . . . . . . . . . . . . . . . . . .  <a href="#page-3">3</a>
     <a href="#section-2.2">2.2</a>.  Terms  . . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-4">4</a>
   <a href="#section-3">3</a>.  Base MT Functional Specifications  . . . . . . . . . . . . . .  <a href="#page-4">4</a>
     <a href="#section-3.1">3.1</a>.  MT Area Boundary . . . . . . . . . . . . . . . . . . . . .  <a href="#page-4">4</a>
     <a href="#section-3.2">3.2</a>.  Adjacency for MTs  . . . . . . . . . . . . . . . . . . . .  <a href="#page-4">4</a>
     <a href="#section-3.3">3.3</a>.  Sending OSPF Control Packets . . . . . . . . . . . . . . .  <a href="#page-5">5</a>
     3.4.  Advertising MT Adjacencies and the Corresponding IP
           Prefixes . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-5">5</a>
       <a href="#section-3.4.1">3.4.1</a>.  Inter-Area and External Routing  . . . . . . . . . . .  <a href="#page-5">5</a>
     <a href="#section-3.5">3.5</a>.  Flushing MT Information  . . . . . . . . . . . . . . . . .  <a href="#page-6">6</a>
     <a href="#section-3.6">3.6</a>.  MT SPF Computation . . . . . . . . . . . . . . . . . . . .  <a href="#page-6">6</a>
     <a href="#section-3.7">3.7</a>.  MT-ID Values . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-6">6</a>
     <a href="#section-3.8">3.8</a>.  Forwarding in MT . . . . . . . . . . . . . . . . . . . . .  <a href="#page-6">6</a>
   <a href="#section-4">4</a>.  Default Topology Link Exclusion Functional Specifications  . .  <a href="#page-7">7</a>
     <a href="#section-4.1">4.1</a>.  Exclusion of Links in the Default Topology . . . . . . . .  <a href="#page-7">7</a>
     <a href="#section-4.2">4.2</a>.  New Area Data Structure Parameter  . . . . . . . . . . . .  <a href="#page-7">7</a>
     <a href="#section-4.3">4.3</a>.  Adjacency Formation with Link Exclusion Capability . . . .  <a href="#page-8">8</a>
     <a href="#section-4.4">4.4</a>.  OSPF Control Packets Transmission over Excluded Links  . .  <a href="#page-9">9</a>
     4.5.  OSPF LSA Advertisement and SPF Computation for
           Excluded Links . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-9">9</a>
   5.  Interoperability between MT-Capable and Non-MT-Capable
       Routers  . . . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-9">9</a>
     <a href="#section-5.1">5.1</a>.  Demand Circuit Compatibility Considerations  . . . . . . . <a href="#page-10">10</a>
   <a href="#section-6">6</a>.  Migration from Non-MT-Area to MT-Area  . . . . . . . . . . . . <a href="#page-10">10</a>
   <a href="#section-7">7</a>.  MT Network Management Considerations . . . . . . . . . . . . . <a href="#page-11">11</a>
     7.1.  Create Dedicated Management Topology to Include All
           the Nodes  . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-11">11</a>
     <a href="#section-7.2">7.2</a>.  Extend the Default Topology to All the Nodes . . . . . . . <a href="#page-11">11</a>
   <a href="#section-8">8</a>.  Security Considerations  . . . . . . . . . . . . . . . . . . . <a href="#page-11">11</a>
   <a href="#section-9">9</a>.  IANA Considerations  . . . . . . . . . . . . . . . . . . . . . <a href="#page-12">12</a>
   <a href="#section-10">10</a>. References . . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-12">12</a>
     <a href="#section-10.1">10.1</a>. Normative References . . . . . . . . . . . . . . . . . . . <a href="#page-12">12</a>
     <a href="#section-10.2">10.2</a>. Informative References . . . . . . . . . . . . . . . . . . <a href="#page-12">12</a>
   <a href="#appendix-A">Appendix A</a>.  Acknowledgments . . . . . . . . . . . . . . . . . . . <a href="#page-13">13</a>
   <a href="#appendix-B">Appendix B</a>.  OSPF Data Formats . . . . . . . . . . . . . . . . . . <a href="#page-13">13</a>
     <a href="#appendix-B.1">B.1</a>.  Router-LSAs  . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-13">13</a>
     <a href="#appendix-B.2">B.2</a>.  Network-LSAs . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-15">15</a>
     <a href="#appendix-B.3">B.3</a>.  Summary-LSAs . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-16">16</a>
     <a href="#appendix-B.4">B.4</a>.  AS-external-LSAs . . . . . . . . . . . . . . . . . . . . . <a href="#page-17">17</a>
     <a href="#appendix-B.5">B.5</a>.  Type-7 AS-external-LSAs  . . . . . . . . . . . . . . . . . <a href="#page-18">18</a>





<span class="grey">Psenak, et al.              Standards Track                     [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc4915.html">RFC 4915</a>          Multi-Topology (MT) Routing in OSPF          June 2007</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   OSPF uses a fixed packet format, therefore it is not easy to
   introduce any backward-compatible extensions.  However, the OSPF
   specification [<a href="#ref-OSPF" title='"OSPF Version 2"'>OSPF</a>] introduced Type of Service (TOS) metric in an
   earlier specification [<a href="#ref-TOS-OSPF" title='"OSPF Version 2"'>TOS-OSPF</a>] in order to announce a different
   link cost based on TOS.  TOS-based routing as described in [<a href="#ref-TOS-OSPF" title='"OSPF Version 2"'>TOS-OSPF</a>]
   was never deployed and was subsequently deprecated.  [<a href="#ref-M-ISIS" title='"M-ISIS: Multi Topology (MT) Routing in IS-IS"'>M-ISIS</a>]
   describes a similar mechanism for ISIS.

   We propose to reuse the TOS-based metric fields.  They have been
   redefined and are used to advertise different topologies by
   advertising separate metrics for each of them.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.1.%20%20Differences%20between%20Multi-Topology%20and%20TOS-Based%20Routing"></a><a class="selflink" href="#section-1.1" name="section-1.1">1.1</a>.  Differences between Multi-Topology and TOS-Based Routing</span>

   Multi-Topology routing differs from [<a href="#ref-TOS-OSPF" title='"OSPF Version 2"'>TOS-OSPF</a>] TOS-based routing in
   the following ways:

   1.  With TOS routing [<a href="#ref-TOS-OSPF" title='"OSPF Version 2"'>TOS-OSPF</a>], the TOS or Diffserv Code Point
       (DSCP) in the IP header is mapped directly to the corresponding
       OSPF SPF calculation and routing table.  This limits the number
       and definition of the topologies to the 16 TOS values specified
       in Section 12.3 of [<a href="#ref-TOS-OSPF" title='"OSPF Version 2"'>TOS-OSPF</a>].  With Multi-Topology routing, the
       classification of what type of traffic maps to which topology is
       not within the scope of this document.

   2.  With TOS routing [<a href="#ref-TOS-OSPF" title='"OSPF Version 2"'>TOS-OSPF</a>], traffic that is unreachable in the
       routing table associated with the corresponding TOS will revert
       to the TOS 0 routing table.  With Multi-Topology routing, this is
       optional.

   3.  With TOS routing [<a href="#ref-TOS-OSPF" title='"OSPF Version 2"'>TOS-OSPF</a>], individual links or prefixes could
       not be excluded from a topology.  If the Link State Advertisement
       (LSA) options T-bit was set, all links or prefixes were either
       advertised explicitly or defaulted to the TOS 0 metric.  With
       Multi-Topology routing, links or prefixes that are not advertised
       for a specific topology do not exist in that topology.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Terminology"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Terminology</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.1.%20%20Requirements%20Notation"></a><a class="selflink" href="#section-2.1" name="section-2.1">2.1</a>.  Requirements Notation</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in <a href="rfc2119.html">RFC 2119</a>
   [<a href="#ref-RFC-KEYWORDS" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC-KEYWORDS</a>].




<span class="grey">Psenak, et al.              Standards Track                     [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc4915.html">RFC 4915</a>          Multi-Topology (MT) Routing in OSPF          June 2007</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.2.%20%20Terms"></a><a class="selflink" href="#section-2.2" name="section-2.2">2.2</a>.  Terms</span>

   We use the following terminology in this document:

   Non-MT router
      Routers that do not have the MT capability.

   MT router
      Routers that have MT capability as described in this document.

   MT-ID
      Renamed TOS field in LSAs to represent Multi-Topology ID.

   Default topology
      Topology that is built using the TOS 0 metric (default metric).

   MT topology
      Topology that is built using the corresponding MT-ID metric.

   MT
      Shorthand notation for MT topology.

   MT#0 topology
      Representation of TOS 0 metric in MT-ID format.

   Non-MT-Area
      An area that contains only non-MT routers.

   MT-Area
      An area that contains both non-MT routers and MT routers, or only
      MT routers.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Base%20MT%20Functional%20Specifications"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Base MT Functional Specifications</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.1.%20%20MT%20Area%20Boundary"></a><a class="selflink" href="#section-3.1" name="section-3.1">3.1</a>.  MT Area Boundary</span>

   Each OSPF interface belongs to a single area, and all MTs sharing
   that link need to belong to the same area.  Therefore, the area
   boundaries for all MTs are the same, but each MT's attachment to the
   area is independent.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.2.%20%20Adjacency%20for%20MTs"></a><a class="selflink" href="#section-3.2" name="section-3.2">3.2</a>.  Adjacency for MTs</span>

   Each interface can be configured to belong to a set of topologies.  A
   single adjacency is formed with neighbors on the interface even if
   the interface is configured to participate in multiple topologies.
   Furthermore, adjacency formation is independent of the topologies
   configured on the local interface and the neighboring router.



<span class="grey">Psenak, et al.              Standards Track                     [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc4915.html">RFC 4915</a>          Multi-Topology (MT) Routing in OSPF          June 2007</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.3.%20%20Sending%20OSPF%20Control%20Packets"></a><a class="selflink" href="#section-3.3" name="section-3.3">3.3</a>.  Sending OSPF Control Packets</span>

   Sending OSPF control packets is unchanged from [<a href="#ref-OSPF" title='"OSPF Version 2"'>OSPF</a>].  For OSPF
   control packets sent to the remote end of a virtual link, the transit
   area path MUST be composed of links participating in the default
   topology and the OSPF control packets MUST be forwarded using the
   default topology.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.4.%20%20Advertising%20MT%20Adjacencies%20and%20the%20Corresponding%20IP%20Prefixes"></a><a class="selflink" href="#section-3.4" name="section-3.4">3.4</a>.  Advertising MT Adjacencies and the Corresponding IP Prefixes</span>

   The TOS metric field is reused to advertise topology specific metric
   for links and prefixes belonging to that topology.  The TOS field is
   redefined as MT-ID in the payload of Router, Summary, and Type-5 and
   Type-7 AS-external-LSAs (see <a href="#appendix-B">Appendix B</a>).

   MT-ID metrics in LSAs SHOULD be in ascending order of MT-ID.  If an
   MT-ID exists in an LSA or router link multiple times, the metric in
   the first MT-ID instance MUST be used.

   When a router establishes a FULL adjacency over a link that belongs
   to a set of MTs, it advertises the corresponding cost for each MT-ID.

   By default, all links are included in the default topology and all
   advertised prefixes belonging to the default topology will use the
   TOS 0 metric as in [<a href="#ref-OSPF" title='"OSPF Version 2"'>OSPF</a>].

   Each MT has its own MT-ID metric field.  When a link is not part of a
   given MT, the corresponding MT-ID metric is excluded from the LSA.

   The Network-LSA does not contain any MT information since the
   Designated Router (DR) is shared by all MTs.  Hence, there is no
   change to the Network-LSA.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.4.1.%20%20Inter-Area%20and%20External%20Routing"></a><a class="selflink" href="#section-3.4.1" name="section-3.4.1">3.4.1</a>.  Inter-Area and External Routing</span>

   In Summary-LSAs and Type-5 and Type-7 AS-external-LSAs, the TOS
   metric fields are redefined as MT-ID metric fields and are used to
   advertise prefix and router reachability in the corresponding
   topology.

   When a router originates a Summary-LSA, or Type-5 or Type-7 AS-
   external-LSA that belongs to a set of MTs, it includes the
   corresponding cost for each MT-ID.  By default, the prefix
   participates in the default topology and uses the TOS 0 metric for
   the default topology, similar to standard OSPF [<a href="#ref-OSPF" title='"OSPF Version 2"'>OSPF</a>].

   Setting the P-bit in Type-7 AS-external-LSA is topology independent
   and pertains to all MT-ID advertised in the body of the LSA.



<span class="grey">Psenak, et al.              Standards Track                     [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc4915.html">RFC 4915</a>          Multi-Topology (MT) Routing in OSPF          June 2007</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.5.%20%20Flushing%20MT%20Information"></a><a class="selflink" href="#section-3.5" name="section-3.5">3.5</a>.  Flushing MT Information</span>

   When a certain link or prefix that existed or was reachable in a
   certain topology is no longer part of that topology or is unreachable
   in that topology, a new version of the LSA MUST be originated
   excluding metric information representing the link or prefix in that
   topology.

   The MT metric in the Router-LSA can also be set to the maximum
   possible metric to enable the router to become a stub in a certain
   topology [<a href="#ref-STUB" title='"OSPF Stub Router Advertisement"'>STUB</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.6.%20%20MT%20SPF%20Computation"></a><a class="selflink" href="#section-3.6" name="section-3.6">3.6</a>.  MT SPF Computation</span>

   By considering MT-ID metrics in the LSAs, OSPF computes multiple
   topologies and finds paths to IP prefixes for each MT independently.
   A separate SPF will be computed for each MT-ID to find independent
   paths to IP prefixes.

   Network-LSAs are used by all topologies during the SPF computation.
   During the SPF for a given MT-ID, only the links and metrics for that
   MT-ID are considered.  Entries in the Router Routing table are also
   MT-ID specific.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.7.%20%20MT-ID%20Values"></a><a class="selflink" href="#section-3.7" name="section-3.7">3.7</a>.  MT-ID Values</span>

   Since AS-External-LSAs use the high-order bit in the MT-ID field
   (E-bit) for the external metric-type, only MT-IDs in the 0 to 127
   range are valid.  The following MT-ID values are reserved:

            0      - Reserved for advertising the metric associated
                     with the default topology (see <a href="#section-4.2">Section 4.2</a>)
            1      - Reserved for advertising the metric associated
                     with the default multicast topology
            2      - Reserved for IPv4 in-band management purposes
           3-31    - Reserved for assignments by IANA
           32-127  - Reserved for development, experimental and
                     proprietary features [<a href="rfc3692.html" title='"Assigning Experimental and Testing Numbers Considered Useful"'>RFC3692</a>]
           128-255 - Invalid and SHOULD be ignored

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.8.%20%20Forwarding%20in%20MT"></a><a class="selflink" href="#section-3.8" name="section-3.8">3.8</a>.  Forwarding in MT</span>

   It is outside of the scope of this document to specify how the
   information in various topology specific forwarding structures are
   used during packet forwarding or how incoming packets are associated
   with the corresponding topology.  For correct operation, both
   forwarding behavior and methods of associating incoming packets to a
   corresponding topology must be consistently applied in the network.



<span class="grey">Psenak, et al.              Standards Track                     [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc4915.html">RFC 4915</a>          Multi-Topology (MT) Routing in OSPF          June 2007</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Default%20Topology%20Link%20Exclusion%20Functional%20Specifications"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Default Topology Link Exclusion Functional Specifications</span>

   The Multi-Topologies imply that all the routers participate in the
   default topology.  However, it can be useful to exclude some links
   from the default topology and reserve them for some specific classes
   of traffic.

   The Multi-Topologies extension for the default topology link or
   prefix exclusion is described in the following subsections.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.1.%20%20Exclusion%20of%20Links%20in%20the%20Default%20Topology"></a><a class="selflink" href="#section-4.1" name="section-4.1">4.1</a>.  Exclusion of Links in the Default Topology</span>

   OSPF does not have the notion of an unreachable link.  All links can
   have a maximum metric of 0xFFFF advertised in the Router-LSA.  The
   link exclusion capability requires routers to ignore TOS 0 metrics in
   Router-LSAs in the default topology and to alternately use the MT-
   ID#0 metric to advertise the metric associated with the default
   topology.  Hence, all routers within an area MUST agree on how the
   metric for the default topology will be advertised.

   The unused T-bit is defined as the MT-bit in the option field in
   order to ensure that a Multi-Topology link-excluding capable router
   will only form an adjacency with another similarly configured router.


              +---+---+---+---+---+---+---+---+
              |DN |O  |DC |EA |NP |MC |E  |MT |
              +---+---+---+---+---+---+---+---+

                 Figure 1: OSPF Option Bits

          MT-bit: If DefaultExclusionCapability is enabled, the bit MUST
                  be set in Hello packets and SHOULD be set in Database
                  Description packet (see <a href="#section-4.2">Section 4.2</a>).

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.2.%20%20New%20Area%20Data%20Structure%20Parameter"></a><a class="selflink" href="#section-4.2" name="section-4.2">4.2</a>.  New Area Data Structure Parameter</span>

   We define a new parameter in the Area Data Structure:

   DefaultExclusionCapability
      This configurable parameter ensures that all routers in an area
      have this capability enabled before the default topology can be
      disabled on a router link in the area without causing backward-
      compatibility problems.

   When an area data structure is created, the
   DefaultExclusionCapability is disabled by default.




<span class="grey">Psenak, et al.              Standards Track                     [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc4915.html">RFC 4915</a>          Multi-Topology (MT) Routing in OSPF          June 2007</span>


   If DefaultExclusionCapability is disabled:

   o  The MT-bit MUST be cleared in Hello packets and SHOULD be cleared
      in Database Description packets.

   o  If a link participates in a non-default topology, it is
      automatically included in the default topology to support backward
      compatibility between MT and non-MT routers.  This is accomplished
      using the TOS 0 metric field as in [<a href="#ref-OSPF" title='"OSPF Version 2"'>OSPF</a>].

   If DefaultExclusionCapability is enabled:

   o  The MT-bit MUST be set in Hello packets and SHOULD be set in
      Database Description packets.

   o  The router will only accept a Hello packet if the MT-bit is set
      (see <a href="#section-4.3">Section 4.3</a>).

   When DefaultExclusionCapability is set to enabled, a router is said
   to be operating in DefaultExclusionCapability mode.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.3.%20%20Adjacency%20Formation%20with%20Link%20Exclusion%20Capability"></a><a class="selflink" href="#section-4.3" name="section-4.3">4.3</a>.  Adjacency Formation with Link Exclusion Capability</span>

   In order to have a smooth transition from a non-MT area to an MT-
   area, an MT router with DefaultExclusionCapability disabled will form
   adjacencies with non-MT routers and will include all links as part of
   the default topology.

   A link may cease participating in the default topology if
   DefaultExclusionCapability is set to enabled.  In this state, a
   router will only form adjacency with routers that set the MT-bit in
   their Hello packets.  This will ensure that all routers have
   DefaultExclusionCapability enabled before the default topology can be
   disabled on a link.

   Receiving OSPF Hello packets as defined in Section 10.5 of [<a href="#ref-OSPF" title='"OSPF Version 2"'>OSPF</a>] is
   modified as follows:

   o  If the DefaultExclusionCapability in the Area Data structure is
      set to enabled, Hello packets are discarded if the received packet
      does not have the MT-bit set in the Header Options.

   Receiving OSPF Database Description packets as defined in <a href="#section-10.6">Section</a>
   <a href="#section-10.6">10.6</a> of [<a href="#ref-OSPF" title='"OSPF Version 2"'>OSPF</a>] is unchanged.  While packet options are validated in
   Hello packets, the only option checking performed for Database
   Description packets is ensuring that the options do not change during
   the database exchange process.




<span class="grey">Psenak, et al.              Standards Track                     [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc4915.html">RFC 4915</a>          Multi-Topology (MT) Routing in OSPF          June 2007</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.4.%20%20OSPF%20Control%20Packets%20Transmission%20over%20Excluded%20Links"></a><a class="selflink" href="#section-4.4" name="section-4.4">4.4</a>.  OSPF Control Packets Transmission over Excluded Links</span>

   If DefaultExclusionCapability is enabled, the default topology can be
   disabled on an interface.  Disabling the default topology on an
   interface does not impact the installation of connected routes for
   the interface in the default topology.  It only affects what a router
   advertises in its Router-LSA.

   This allows OSPF control packets to be sent and received over an
   interface even if the default topology is disabled on the interface.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.5.%20%20OSPF%20LSA%20Advertisement%20and%20SPF%20Computation%20for%20Excluded%20Links"></a><a class="selflink" href="#section-4.5" name="section-4.5">4.5</a>.  OSPF LSA Advertisement and SPF Computation for Excluded Links</span>

   When DefaultExclusionCapability is enabled and the link does not
   participate in the default topology, the MT-ID#0 metric is not
   advertised.  The link's TOS 0 metric is ignored during the default
   topology SPF computation.

   When DefaultExclusionCapability is enabled and a link participates in
   the default topology, MT-ID#0 metric is used to advertise the metric
   associated with the default topology.  The link's TOS 0 metric is
   ignored during the default topology SPF computation.

   Independent of the DefaultExclusionCapability, the TOS 0 metric is
   used for Summary-LSAs and Type-5 and Type-7 AS-external-LSAs.

   o  If the prefix or router does not exist in the default topology,
      the TOS 0 metric is set to infinity (0xFFFFFF).

   o  If the prefix or router exists in the default topology, the TOS 0
      metric is used to advertise the metric in the default topology.

   During the summary and external prefix calculation for the default
   topology, the TOS 0 metric is used for Summary-LSAs and Type-5 and
   Type-7 AS-external-LSAs.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Interoperability%20between%20MT-Capable%20and%20Non-MT-Capable%20Routers"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Interoperability between MT-Capable and Non-MT-Capable Routers</span>

   The default metric field is mandatory in all LSAs (even when the
   metric value is 0).  Even when a link or prefix does not exist in the
   default topology, a non-MT router will consider the zero value in the
   metric field as a valid metric and consider the link or prefix as
   part of the default topology.

   In order to prevent the above problem, an MT-capable router will
   include all links as part of the default topology.  If links need to
   be removed from the default topology, an MT-capable router must be
   configured in DefaultExclusionCapability mode.  In this mode, routers



<span class="grey">Psenak, et al.              Standards Track                     [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc4915.html">RFC 4915</a>          Multi-Topology (MT) Routing in OSPF          June 2007</span>


   will ensure that all other routers in the area are in the
   DefaultExclusionCapability mode before considering the MT-ID#0 metric
   in the SPF calculation.  Only then can the TOS 0 metric field in
   Router-LSAs be safely ignored during the default topology SPF
   computation.

   Note that for any prefix or router to become reachable in a certain
   topology, a contiguous path inside that topology must exist between
   the calculating router and the destination prefix or router.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.1.%20%20Demand%20Circuit%20Compatibility%20Considerations"></a><a class="selflink" href="#section-5.1" name="section-5.1">5.1</a>.  Demand Circuit Compatibility Considerations</span>

   A change to an area's DefaultExclusionCapability requires additional
   processing for area neighbors that are suppressing Hello packets as
   specified in "Extending OSPF to Support Demand Circuits" [<a href="#ref-DEMAND" title='"Extending OSPF to Support Demand Circuits"'>DEMAND</a>].
   When the DefaultExclusionCapability for an area is changed, Hello
   suppression must be disabled for these neighbors for a period of
   RouterDeadInterval seconds.  This implies that Hello packets are sent
   with the DC-bit clear as specified in Section 3.2.1 of [<a href="#ref-DEMAND" title='"Extending OSPF to Support Demand Circuits"'>DEMAND</a>]
   during this period.  After RouterDeadInterval seconds, either the
   adjacency will be taken down due to rejection of Hello packets with a
   conflicting MT-bit or Hello suppression will be renegotiated.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20Migration%20from%20Non-MT-Area%20to%20MT-Area"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  Migration from Non-MT-Area to MT-Area</span>

   Introducing MT-OSPF into a network can be done gradually to allow MT
   routers and non-MT routers to participate in the default topology
   while MT routers participate in other topologies.

   If there is a requirement to exclude some links from the default
   topology in an area, all routers in the area MUST be in
   DefaultExclusionCapability mode.  In this section, we describe the
   migration steps to consider while transitioning from a non-MT network
   to an MT network.

   Consider a network with a backbone area and a set of non-backbone
   areas functioning in standard OSPF mode.  We would like to migrate to
   an MT network either partially or completely.

   1.  As required, part of an area is upgraded to be MT capable.  The
       MT routers will interact with non-MT routers in the default
       topology and participate in other topologies as required.

   2.  If a new non-backbone area is created for MT routers, it may be
       configured in DefaultExclusionCapability mode since there is no
       interaction required with non-MT routers.  In this mode, the
       default topology can be excluded on links as required.




<span class="grey">Psenak, et al.              Standards Track                    [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc4915.html">RFC 4915</a>          Multi-Topology (MT) Routing in OSPF          June 2007</span>


   3.  If there are several non-backbone areas where MT is being used,
       it is desirable that the backbone area first be upgraded to be MT
       capable so that inter-area routing is ensured for MT destinations
       in different areas.

   4.  Gradually, the whole network can be made MT capable.

   Note that inter-area routing for the MT-area still depends on the
   backbone area.  Therefore, if different areas configured for a given
   topology need to communicate, the backbone area also needs to be
   configured for this topology.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20MT%20Network%20Management%20Considerations"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  MT Network Management Considerations</span>

   When multiple OSPF topologies exist within a domain, some of the
   routers can be configured to participate in a subset of the MTs in
   the network.  This section discusses some of the options we have to
   enable operations or the network management stations to access those
   routers.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.1.%20%20Create%20Dedicated%20Management%20Topology%20to%20Include%20All%20the%20Nodes"></a><a class="selflink" href="#section-7.1" name="section-7.1">7.1</a>.  Create Dedicated Management Topology to Include All the Nodes</span>

   This approach is to set up a dedicated management topology or 'in-
   band' management topology.  This 'mgmt' topology will include all the
   routers need to be managed.  The computed routes in the topology will
   be installed into the 'mgmt' Routing Information Base (RIB).  In the
   condition of the 'mgmt' topology uses a set of non-overlapping
   address space with the default topology, those 'mgmt' routes can also
   be optionally installed into the default RIB.  The advantages of
   duplicate 'mgmt' routes in both RIBs include: the network management
   utilities on the system do not have to be modified to use specific
   RIB other than the default RIB; the 'mgmt' topology can share the
   same link with the default topology if so designed.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.2.%20%20Extend%20the%20Default%20Topology%20to%20All%20the%20Nodes"></a><a class="selflink" href="#section-7.2" name="section-7.2">7.2</a>.  Extend the Default Topology to All the Nodes</span>

   Even in the case in which default topology is not used on some of the
   nodes in the IP forwarding, we may want to extend the default
   topology to those nodes for the purpose of network management.
   Operators SHOULD set a high cost on the links that belong to the
   extended portion of the default topology.  This way, the IP data
   traffic will not be forwarded through those nodes during network
   topology changes.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20Security%20Considerations"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  Security Considerations</span>

   This document does not raise any security issues that are not already
   covered in [<a href="#ref-OSPF" title='"OSPF Version 2"'>OSPF</a>].



<span class="grey">Psenak, et al.              Standards Track                    [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc4915.html">RFC 4915</a>          Multi-Topology (MT) Routing in OSPF          June 2007</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/9.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-9" name="section-9">9</a>.  IANA Considerations</span>

   The T-bit as defined in [<a href="#ref-TOS-OSPF" title='"OSPF Version 2"'>TOS-OSPF</a>] for a router's TOS capability is
   redefined as the MT-bit in this document.  IANA has assigned the MT-
   bit as defined in <a href="#section-4.1">Section 4.1</a>.

   Similarly, the TOS field for Router-LSAs, Summary-LSAs, and Type-5
   and Type-7 AS-external-LSAs, as defined in [<a href="#ref-OSPF" title='"OSPF Version 2"'>OSPF</a>], is redefined as
   MT-ID in <a href="#section-3.7">Section 3.7</a>.

   IANA created a new registry, "OSPF Multi-Topology ID Values", with
   the assignments and registration policies listed in <a href="#section-3.7">Section 3.7</a> of
   this document.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/10.%20%20References"></a><a class="selflink" href="#section-10" name="section-10">10</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/10.1.%20%20Normative%20References"></a><a class="selflink" href="#section-10.1" name="section-10.1">10.1</a>.  Normative References</span>

   [<a id="ref-DEMAND" name="ref-DEMAND">DEMAND</a>]        Moy, J., "Extending OSPF to Support Demand Circuits",
                   <a href="rfc1793.html">RFC 1793</a>, April 1995.

   [<a id="ref-NSSA" name="ref-NSSA">NSSA</a>]          Murphy, P., "The OSPF Not-So-Stubby Area (NSSA)
                   Option", <a href="rfc3101.html">RFC 3101</a>, January 2003.

   [<a id="ref-OSPF" name="ref-OSPF">OSPF</a>]          Moy, J., "OSPF Version 2", <a href="rfc2328.html">RFC 2328</a>, April 1998.

   [<a id="ref-RFC-KEYWORDS" name="ref-RFC-KEYWORDS">RFC-KEYWORDS</a>]  Bradner, S., "Key words for use in RFCs to Indicate
                   Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a id="ref-RFC3692" name="ref-RFC3692">RFC3692</a>]       Narten, T., "Assigning Experimental and Testing
                   Numbers Considered Useful", <a href="rfc3692.html">RFC 3692</a>, January 2004.

   [<a id="ref-TOS-OSPF" name="ref-TOS-OSPF">TOS-OSPF</a>]      Moy, J., "OSPF Version 2", <a href="rfc1583.html">RFC 1583</a>, March 1994.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/10.2.%20%20Informative%20References"></a><a class="selflink" href="#section-10.2" name="section-10.2">10.2</a>.  Informative References</span>

   [<a id="ref-M-ISIS" name="ref-M-ISIS">M-ISIS</a>]        Przygienda, T., Shen, N., and N. Sheth, "M-ISIS:
                   Multi Topology (MT) Routing in IS-IS", Work
                   in Progress, October 2005.

   [<a id="ref-STUB" name="ref-STUB">STUB</a>]          Retana, A., Nguyen, L., White, R., Zinin, A., and D.
                   McPherson, "OSPF Stub Router Advertisement",
                   <a href="rfc3137.html">RFC 3137</a>, June 2001.








<span class="grey">Psenak, et al.              Standards Track                    [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc4915.html">RFC 4915</a>          Multi-Topology (MT) Routing in OSPF          June 2007</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/Appendix%20A.%20%20Acknowledgments"></a><a class="selflink" href="#appendix-A" name="appendix-A">Appendix A</a>.  Acknowledgments</span>

   The authors would like to thank Scott Sturgess, Alvaro Retana, David
   Kushi, Yakov Rekhter, Tony Przygienda, and Naiming Shen for their
   comments on the document.  Special thanks to Acee Lindem for editing
   and to Tom Henderson for an extensive review during the OSPF Working
   Group last call.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/Appendix%20B.%20%20OSPF%20Data%20Formats"></a><a class="selflink" href="#appendix-B" name="appendix-B">Appendix B</a>.  OSPF Data Formats</span>

   LSA content defined in [<a href="#ref-OSPF" title='"OSPF Version 2"'>OSPF</a>] is modified to introduce the MT-ID.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/B.1.%20%20Router-LSAs"></a><a class="selflink" href="#appendix-B.1" name="appendix-B.1">B.1</a>.  Router-LSAs</span>

   Router-LSAs are the Type 1 LSAs.  Each router in an area originates a
   router-LSA.  The LSA describes the state and cost of the router's
   links (i.e., interfaces) to the area.  All of the router's links to
   the area must be described in a single router-LSA.  For details
   concerning the construction of router-LSAs, see Section 12.4.1 of
   [<a href="#ref-OSPF" title='"OSPF Version 2"'>OSPF</a>].































<span class="grey">Psenak, et al.              Standards Track                    [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc4915.html">RFC 4915</a>          Multi-Topology (MT) Routing in OSPF          June 2007</span>


     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |            LS age             |     Options   |       1       |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                        Link State ID                          |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                     Advertising Router                        |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                     LS sequence number                        |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |         LS checksum           |             length            |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |*|*|*|N|W|V|E|B|        0      |            # links            |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                          Link ID                              |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                         Link Data                             |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |     Type      |     # MT-ID   |            metric             |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |     MT-ID     |       0       |          MT-ID  metric        |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                              ...                              |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |     MT-ID     |       0       |          MT-ID  metric        |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                          Link ID                              |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                         Link Data                             |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                              ...                              |

                        Figure 2: Router-LSA Format

















<span class="grey">Psenak, et al.              Standards Track                    [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc4915.html">RFC 4915</a>          Multi-Topology (MT) Routing in OSPF          June 2007</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/B.2.%20%20Network-LSAs"></a><a class="selflink" href="#appendix-B.2" name="appendix-B.2">B.2</a>.  Network-LSAs</span>

   Network-LSAs are the Type 2 LSAs.  A network-LSA is originated for
   each broadcast and Non-Broadcast Multi-Access (NBMA) network in the
   area that supports two or more routers.  The network-LSA is
   originated by the network's Designated Router.  The LSA describes all
   routers attached to the network, including the Designated Router
   itself.  The LSA's Link State ID field lists the IP interface address
   of the Designated Router.

   The distance from the network to all attached routers is zero.  This
   is why metric fields need not be specified in the network-LSA.  For
   details concerning the construction of network-LSAs, see <a href="#section-12.4.2">Section</a>
   <a href="#section-12.4.2">12.4.2</a> of [<a href="#ref-OSPF" title='"OSPF Version 2"'>OSPF</a>].


     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |            LS age             |      Options  |      2        |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                        Link State ID                          |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                     Advertising Router                        |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                     LS sequence number                        |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |         LS checksum           |             length            |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                         Network Mask                          |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                        Attached Router                        |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                              ...                              |

                       Figure 3: Network-LSA Format

   Note that network-LSA does not contain any MT-ID fields as the cost
   of the network to the attached routers is 0 and DR is shared by all
   topologies.











<span class="grey">Psenak, et al.              Standards Track                    [Page 15]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc4915.html">RFC 4915</a>          Multi-Topology (MT) Routing in OSPF          June 2007</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/B.3.%20%20Summary-LSAs"></a><a class="selflink" href="#appendix-B.3" name="appendix-B.3">B.3</a>.  Summary-LSAs</span>

   Summary-LSAs are the Type 3 and 4 LSAs.  These LSAs are originated by
   area border routers.  Summary-LSAs describe inter-area destinations.
   For details concerning the construction of summary-LSAs, see <a href="#section-12.4.3">Section</a>
   <a href="#section-12.4.3">12.4.3</a> of [<a href="#ref-OSPF" title='"OSPF Version 2"'>OSPF</a>].

   Type 3 summary-LSAs are used when the destination is an IP network.
   In this case the LSA's Link State ID field is an IP network number
   (if necessary, the Link State ID can also have one or more of the
   network's "host" bits set; see <a href="#appendix-E">Appendix E</a> of [<a href="#ref-OSPF" title='"OSPF Version 2"'>OSPF</a>] for details).
   When the destination is an AS boundary router, a Type 4 summary-LSA
   is used, and the Link State ID field is the AS boundary router's OSPF
   Router ID.  (To see why it is necessary to advertise the location of
   each ASBR, consult Section 16.4 of [<a href="#ref-OSPF" title='"OSPF Version 2"'>OSPF</a>].)  Other than the
   difference in the Link State ID field, the format of Type 3 and 4
   summary-LSAs is identical.


     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |            LS age             |     Options   |    3 or 4     |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                        Link State ID                          |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                     Advertising Router                        |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                     LS sequence number                        |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |         LS checksum           |             length            |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                         Network Mask                          |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |       0       |                  metric                       |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |     MT-ID     |                MT-ID  metric                  |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                              ...                              |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |     MT-ID     |                MT-ID  metric                  |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                       Figure 4: Summary-LSA Format







<span class="grey">Psenak, et al.              Standards Track                    [Page 16]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc4915.html">RFC 4915</a>          Multi-Topology (MT) Routing in OSPF          June 2007</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/B.4.%20%20AS-external-LSAs"></a><a class="selflink" href="#appendix-B.4" name="appendix-B.4">B.4</a>.  AS-external-LSAs</span>

   AS-external-LSAs are the Type 5 LSAs.  These LSAs are originated by
   AS boundary routers, and describe destinations external to the AS.
   For details concerning the construction of AS-external-LSAs, see
   Section 12.4.3 of [<a href="#ref-OSPF" title='"OSPF Version 2"'>OSPF</a>].

   AS-external-LSAs usually describe a particular external destination.
   For these LSAs, the Link State ID field specifies an IP network
   number (if necessary, the Link State ID can also have one or more of
   the network's "host" bits set; see <a href="#appendix-E">Appendix E</a> of [<a href="#ref-OSPF" title='"OSPF Version 2"'>OSPF</a>] for details).
   AS-external-LSAs are also used to describe a default route.  Default
   routes are used when no specific route exists to the destination.
   When describing a default route, the Link State ID is always set to
   DefaultDestination (0.0.0.0) and the Network Mask is set to 0.0.0.0.




































<span class="grey">Psenak, et al.              Standards Track                    [Page 17]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc4915.html">RFC 4915</a>          Multi-Topology (MT) Routing in OSPF          June 2007</span>


      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |            LS age             |     Options   |      5        |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                        Link State ID                          |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                     Advertising Router                        |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                     LS sequence number                        |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |         LS checksum           |             length            |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                         Network Mask                          |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |E|     0       |                  metric                       |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                      Forwarding address                       |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                      External Route Tag                       |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |E|    MT-ID    |              MT-ID  metric                    |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                      Forwarding address                       |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                      External Route Tag                       |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                              ...                              |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |E|    MT-ID    |              MT-ID  metric                    |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                      Forwarding address                       |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                      External Route Tag                       |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                     Figure 5: AS-External-LSA Format

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/B.5.%20%20Type-7%20AS-external-LSAs"></a><a class="selflink" href="#appendix-B.5" name="appendix-B.5">B.5</a>.  Type-7 AS-external-LSAs</span>

   Type-7 AS-external-LSAs are originated by AS boundary routers local
   to an NSSA (Not-So-Stubby Area), and describe destinations external
   to the AS.  The changes to Type-7 AS-external-LSAs are identical to
   those for AS-external-LSAs (Appendix A.4.5 of [<a href="#ref-OSPF" title='"OSPF Version 2"'>OSPF</a>]).  For details
   concerning the construction of Type-7 AS-external-LSAs, see <a href="#section-2.4">Section</a>
   <a href="#section-2.4">2.4</a> of [<a href="#ref-NSSA" title='"The OSPF Not-So-Stubby Area (NSSA) Option"'>NSSA</a>].





<span class="grey">Psenak, et al.              Standards Track                    [Page 18]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-19" id="page-19" name="page-19"> </a>
<span class="grey"><a href="rfc4915.html">RFC 4915</a>          Multi-Topology (MT) Routing in OSPF          June 2007</span>


Authors' Addresses

   Peter Psenak
   Cisco Systems
   Mlynske Nivy 43
   821 09
   Bratislava
   Slovakia

   EMail: ppsenak@cisco.com


   Sina Mirtorabi
   Force10 Networks
   1440 McCarthy Blvd
   Milpitas, CA  95035
   USA

   EMail: sina@force10networks.com


   Abhay Roy
   Cisco Systems
   170 West Tasman Drive
   San Jose, CA  95134
   USA

   EMail: akr@cisco.com


   Liem Nguyen
   Cisco Systems
   170 West Tasman Drive
   San Jose, CA  95134
   USA

   EMail: lhnguyen@cisco.com


   Padma Pillay-Esnault
   Cisco Systems
   170 West Tasman Drive
   San Jose, CA  95134
   USA

   EMail: ppe@cisco.com





<span class="grey">Psenak, et al.              Standards Track                    [Page 19]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-20" id="page-20" name="page-20"> </a>
<span class="grey"><a href="rfc4915.html">RFC 4915</a>          Multi-Topology (MT) Routing in OSPF          June 2007</span>


Full Copyright Statement

   Copyright (C) The IETF Trust (2007).

   This document is subject to the rights, licenses and restrictions
   contained in <a href="https://tools.ietf.org/html/bcp78">BCP 78</a>, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST AND
   THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS
   OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF
   THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and <a href="https://tools.ietf.org/html/bcp79">BCP 79</a>.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   <a href="http://www.ietf.org/ipr">http://www.ietf.org/ipr</a>.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.

Acknowledgement

   Funding for the RFC Editor function is currently provided by the
   Internet Society.







Psenak, et al.              Standards Track                    [Page 20]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc4915 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:38 GMT --></html>