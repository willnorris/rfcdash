<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc5571 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:34 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="urn:ietf:rfc:5571" name="DC.Identifier"/>
<meta content='This document describes the framework of the Softwire "Hub and Spoke"
solution with the Layer Two Tunneling Protocol version 2 (L2TPv2). The
implementation details specified in this document should be followed
to achieve interoperability among different vendor implementations.
[STANDARDS-TRACK]' name="DC.Description.Abstract"/>
<meta content="Storer, Bill" name="DC.Creator"/>
<meta content="Pignataro, Carlos" name="DC.Creator"/>
<meta content="Stevant, Bruno" name="DC.Creator"/>
<meta content="Tremblay, Jean-Francois" name="DC.Creator"/>
<meta content="June, 2009" name="DC.Date.Issued"/>
<meta content="Softwire Hub and Spoke Deployment Framework with Layer Two Tunneling Protocol Version 2 (L2TPv2)" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 5571 - Softwire Hub and Spoke Deployment Framework with Layer Two Tunneling Protocol Version 2 (L2TPv2)</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgblue" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc5571.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc5571" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-softwire-hs-framework-l2tpv2" title="draft-ietf-softwire-hs-framework-l2tpv2">draft-ietf-soft...</a>] [<a href="https://datatracker.ietf.org/doc/rfc5571" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc5571" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc5571" title="Side-by-side diff">Diff2</a>]         </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                       PROPOSED STANDARD</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Network Working Group                                          B. Storer
Request for Comments: 5571                             C. Pignataro, Ed.
Category: Standards Track                                  M. Dos Santos
                                                           Cisco Systems
                                                         B. Stevant, Ed.
                                                              L. Toutain
                                                        TELECOM Bretagne
                                                             J. Tremblay
                                                          Videotron Ltd.
                                                               June 2009


              <span class="h1">Softwire Hub and Spoke Deployment Framework</span>
          <span class="h1">with Layer Two Tunneling Protocol Version 2 (L2TPv2)</span>

Status of This Memo

   This document specifies an Internet standards track protocol for the
   Internet community, and requests discussion and suggestions for
   improvements.  Please refer to the current edition of the "Internet
   Official Protocol Standards" (STD 1) for the standardization state
   and status of this protocol.  Distribution of this memo is unlimited.

Copyright Notice

   Copyright (c) 2009 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents in effect on the date of
   publication of this document (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>).
   Please review these documents carefully, as they describe your rights
   and restrictions with respect to this document.

   This document may contain material from IETF Documents or IETF
   Contributions published or made publicly available before November
   10, 2008.  The person(s) controlling the copyright in some of this
   material may not have granted the IETF Trust the right to allow
   modifications of such material outside the IETF Standards Process.
   Without obtaining an adequate license from the person(s) controlling
   the copyright in such materials, this document may not be modified
   outside the IETF Standards Process, and derivative works of it may
   not be created outside the IETF Standards Process, except to format
   it for publication as an RFC or to translate it into languages other
   than English.






<span class="grey">Storer, et al.              Standards Track                     [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc5571.html">RFC 5571</a>          Softwire H &amp; S Framework with L2TPv2         June 2009</span>


Abstract

   This document describes the framework of the Softwire "Hub and Spoke"
   solution with the Layer Two Tunneling Protocol version 2 (L2TPv2).
   The implementation details specified in this document should be
   followed to achieve interoperability among different vendor
   implementations.

Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-4">4</a>
      <a href="#section-1.1">1.1</a>. Abbreviations ..............................................<a href="#page-5">5</a>
      <a href="#section-1.2">1.2</a>. Requirements Language ......................................<a href="#page-5">5</a>
      <a href="#section-1.3">1.3</a>. Considerations .............................................<a href="#page-6">6</a>
   <a href="#section-2">2</a>. Applicability of L2TPv2 for Softwire Requirements ...............<a href="#page-6">6</a>
      <a href="#section-2.1">2.1</a>. Traditional Network Address Translation (NAT and NAPT) .....<a href="#page-6">6</a>
      <a href="#section-2.2">2.2</a>. Scalability ................................................<a href="#page-7">7</a>
      <a href="#section-2.3">2.3</a>. Routing ....................................................<a href="#page-7">7</a>
      <a href="#section-2.4">2.4</a>. Multicast ..................................................<a href="#page-7">7</a>
      <a href="#section-2.5">2.5</a>. Authentication, Authorization, and Accounting (AAA) ........<a href="#page-7">7</a>
      <a href="#section-2.6">2.6</a>. Privacy, Integrity, and Replay Protection ..................<a href="#page-7">7</a>
      <a href="#section-2.7">2.7</a>. Operations and Management ..................................<a href="#page-8">8</a>
      <a href="#section-2.8">2.8</a>. Encapsulations .............................................<a href="#page-8">8</a>
   <a href="#section-3">3</a>. Deployment Scenarios ............................................<a href="#page-8">8</a>
      <a href="#section-3.1">3.1</a>. IPv6-over-IPv4 Softwires with L2TPv2 .......................<a href="#page-9">9</a>
           <a href="#section-3.1.1">3.1.1</a>. Host CPE as Softwire Initiator ......................<a href="#page-9">9</a>
           <a href="#section-3.1.2">3.1.2</a>. Router CPE as Softwire Initiator ...................<a href="#page-10">10</a>
           <a href="#section-3.1.3">3.1.3</a>. Host behind CPE as Softwire Initiator ..............<a href="#page-11">11</a>
           <a href="#section-3.1.4">3.1.4</a>. Router behind CPE as Softwire Initiator ............<a href="#page-12">12</a>
      <a href="#section-3.2">3.2</a>. IPv4-over-IPv6 Softwires with L2TPv2 ......................<a href="#page-14">14</a>
           <a href="#section-3.2.1">3.2.1</a>. Host CPE as Softwire Initiator .....................<a href="#page-14">14</a>
           <a href="#section-3.2.2">3.2.2</a>. Router CPE as Softwire Initiator ...................<a href="#page-15">15</a>
           <a href="#section-3.2.3">3.2.3</a>. Host behind CPE as Softwire Initiator ..............<a href="#page-16">16</a>
           <a href="#section-3.2.4">3.2.4</a>. Router behind CPE as Softwire Initiator ............<a href="#page-16">16</a>
   <a href="#section-4">4</a>. References to Standardization Documents ........................<a href="#page-17">17</a>
      <a href="#section-4.1">4.1</a>. L2TPv2 ....................................................<a href="#page-18">18</a>
      <a href="#section-4.2">4.2</a>. Securing the Softwire Transport ...........................<a href="#page-18">18</a>
      <a href="#section-4.3">4.3</a>. Authentication, Authorization, and Accounting .............<a href="#page-18">18</a>
      <a href="#section-4.4">4.4</a>. MIB .......................................................<a href="#page-18">18</a>
      <a href="#section-4.5">4.5</a>. Softwire Payload Related ..................................<a href="#page-19">19</a>
           <a href="#section-4.5.1">4.5.1</a>. For IPv6 Payloads ..................................<a href="#page-19">19</a>
           <a href="#section-4.5.2">4.5.2</a>. For IPv4 Payloads ..................................<a href="#page-19">19</a>
   <a href="#section-5">5</a>. Softwire Establishment .........................................<a href="#page-20">20</a>
      <a href="#section-5.1">5.1</a>. L2TPv2 Tunnel Setup .......................................<a href="#page-22">22</a>
           <a href="#section-5.1.1">5.1.1</a>. Tunnel Establishment ...............................<a href="#page-22">22</a>
                  <a href="#section-5.1.1.1">5.1.1.1</a>. AVPs Required for Softwires ...............<a href="#page-25">25</a>
                  <a href="#section-5.1.1.2">5.1.1.2</a>. AVPs Optional for Softwires ...............<a href="#page-25">25</a>
                  <a href="#section-5.1.1.3">5.1.1.3</a>. AVPs Not Relevant for Softwires ...........<a href="#page-26">26</a>



<span class="grey">Storer, et al.              Standards Track                     [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc5571.html">RFC 5571</a>          Softwire H &amp; S Framework with L2TPv2         June 2009</span>


           <a href="#section-5.1.2">5.1.2</a>. Tunnel Maintenance .................................<a href="#page-26">26</a>
           <a href="#section-5.1.3">5.1.3</a>. Tunnel Teardown ....................................<a href="#page-27">27</a>
           <a href="#section-5.1.4">5.1.4</a>. Additional L2TPv2 Considerations ...................<a href="#page-27">27</a>
      <a href="#section-5.2">5.2</a>. PPP Connection ............................................<a href="#page-27">27</a>
           <a href="#section-5.2.1">5.2.1</a>. MTU ................................................<a href="#page-27">27</a>
           <a href="#section-5.2.2">5.2.2</a>. LCP ................................................<a href="#page-27">27</a>
           <a href="#section-5.2.3">5.2.3</a>. Authentication .....................................<a href="#page-28">28</a>
           <a href="#section-5.2.4">5.2.4</a>. IPCP ...............................................<a href="#page-28">28</a>
                  <a href="#section-5.2.4.1">5.2.4.1</a>. IPV6CP ....................................<a href="#page-28">28</a>
                  <a href="#section-5.2.4.2">5.2.4.2</a>. IPv4CP ....................................<a href="#page-28">28</a>
      <a href="#section-5.3">5.3</a>. Global IPv6 Address Assignment to Endpoints ...............<a href="#page-28">28</a>
      <a href="#section-5.4">5.4</a>. DHCP ......................................................<a href="#page-29">29</a>
           <a href="#section-5.4.1">5.4.1</a>. DHCPv6 .............................................<a href="#page-29">29</a>
           <a href="#section-5.4.2">5.4.2</a>. DHCPv4 .............................................<a href="#page-29">29</a>
   <a href="#section-6">6</a>. Considerations about the Address Provisioning Model ............<a href="#page-30">30</a>
      <a href="#section-6.1">6.1</a>. Softwire Endpoints' Addresses .............................<a href="#page-30">30</a>
           <a href="#section-6.1.1">6.1.1</a>. IPv6 ...............................................<a href="#page-30">30</a>
           <a href="#section-6.1.2">6.1.2</a>. IPv4 ...............................................<a href="#page-31">31</a>
      <a href="#section-6.2">6.2</a>. Delegated Prefixes ........................................<a href="#page-31">31</a>
           <a href="#section-6.2.1">6.2.1</a>. IPv6 Prefixes ......................................<a href="#page-31">31</a>
           <a href="#section-6.2.2">6.2.2</a>. IPv4 Prefixes ......................................<a href="#page-31">31</a>
      <a href="#section-6.3">6.3</a>. Possible Address Provisioning Scenarios ...................<a href="#page-31">31</a>
           <a href="#section-6.3.1">6.3.1</a>. Scenarios for IPv6 .................................<a href="#page-32">32</a>
           <a href="#section-6.3.2">6.3.2</a>. Scenarios for IPv4 .................................<a href="#page-32">32</a>
   <a href="#section-7">7</a>. Considerations about Address Stability .........................<a href="#page-32">32</a>
   <a href="#section-8">8</a>. Considerations about RADIUS Integration ........................<a href="#page-33">33</a>
      <a href="#section-8.1">8.1</a>. Softwire Endpoints ........................................<a href="#page-33">33</a>
           <a href="#section-8.1.1">8.1.1</a>. IPv6 Softwires .....................................<a href="#page-33">33</a>
           <a href="#section-8.1.2">8.1.2</a>. IPv4 Softwires .....................................<a href="#page-33">33</a>
      <a href="#section-8.2">8.2</a>. Delegated Prefixes ........................................<a href="#page-34">34</a>
           <a href="#section-8.2.1">8.2.1</a>. IPv6 Prefixes ......................................<a href="#page-34">34</a>
           <a href="#section-8.2.2">8.2.2</a>. IPv4 Prefixes ......................................<a href="#page-34">34</a>
   <a href="#section-9">9</a>. Considerations for Maintenance and Statistics ..................<a href="#page-34">34</a>
      <a href="#section-9.1">9.1</a>. RADIUS Accounting .........................................<a href="#page-35">35</a>
      <a href="#section-9.2">9.2</a>. MIBs ......................................................<a href="#page-35">35</a>
   <a href="#section-10">10</a>. Security Considerations .......................................<a href="#page-35">35</a>
   <a href="#section-11">11</a>. Acknowledgements ..............................................<a href="#page-36">36</a>
   <a href="#section-12">12</a>. References ....................................................<a href="#page-37">37</a>
      <a href="#section-12.1">12.1</a>. Normative References .....................................<a href="#page-37">37</a>
      <a href="#section-12.2">12.2</a>. Informative References ...................................<a href="#page-38">38</a>











<span class="grey">Storer, et al.              Standards Track                     [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc5571.html">RFC 5571</a>          Softwire H &amp; S Framework with L2TPv2         June 2009</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   The Softwires Working Group has selected Layer Two Tunneling Protocol
   version 2 (L2TPv2) as the phase 1 protocol to be deployed in the
   Softwire "Hub and Spoke" solution space.  This document describes the
   framework for the L2TPv2 "Hub and Spoke" solution, and the
   implementation details specified in this document should be followed
   to achieve interoperability among different vendor implementations.

   In the "Hub and Spoke" solution space, a Softwire is established to
   provide the home network with IPv4 connectivity across an IPv6-only
   access network, or IPv6 connectivity across an IPv4-only access
   network.  When L2TPv2 is used in the Softwire context, the voluntary
   tunneling model applies.  The Softwire Initiator (SI) at the home
   network takes the role of the L2TP Access Concentrator (LAC) client
   (initiating both the L2TP tunnel/session and the PPP link) while the
   Softwire Concentrator (SC) at the ISP takes the role of the L2TP
   Network Server (LNS).  The terms voluntary tunneling and compulsory
   tunneling are defined in <a href="rfc3193.html#section-1.1">Section 1.1 of [RFC3193]</a>.  Since the L2TPv2
   compulsory tunneling model does not apply to Softwires, it SHOULD NOT
   be requested or honored.  This document identifies all the voluntary
   tunneling related L2TPv2 attributes that apply to Softwires and
   specifies the handling mechanism for such attributes in order to
   avoid ambiguities in implementations.  This document also identifies
   the set of L2TPv2 attributes specific to the compulsory tunneling
   model that does not apply to Softwires and specifies the mechanism to
   ignore or nullify their effect within the Softwire context.

   The SI and SC MUST follow the L2TPv2 operations described in
   [<a href="rfc2661.html" title='"Layer Two Tunneling Protocol "'>RFC2661</a>] when performing Softwire establishment, teardown, and
   Operations, Administration, and Management (OAM).  With L2TPv2, a
   Softwire consists of an L2TPv2 Control Connection (also referred to
   as Control Channel), a single L2TPv2 Session, and the PPP link
   negotiated over the Session.  To establish the Softwire, the SI first
   initiates an L2TPv2 Control Channel to the SC, which accepts the
   request and terminates the Control Channel.  L2TPv2 supports an
   optional mutual Control Channel authentication that allows both SI
   and SC to validate each other's identity at the initial phase of
   hand-shaking before proceeding with Control Channel establishment.
   After the L2TPv2 Control Channel is established between the SI and
   SC, the SI initiates an L2TPv2 Session to the SC.  Then the PPP/IP
   link is negotiated over the L2TPv2 Session between the SI and SC.
   After the PPP/IP link is established, it acts as the Softwire between
   the SI and SC for tunneling IP traffic of one Address Family (AF)
   across the access network of another Address Family.






<span class="grey">Storer, et al.              Standards Track                     [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc5571.html">RFC 5571</a>          Softwire H &amp; S Framework with L2TPv2         June 2009</span>


   During the life of the Softwire, both SI and SC send L2TPv2 keepalive
   HELLO messages to monitor the health of the Softwire and the peer
   L2TP Control Connection Endpoint (LCCE), and to potentially refresh
   the NAT/NAPT (Network Address Translation / Network Address Port
   Translation) entry at the CPE or at the other end of the access link.
   Optionally, Link Control Protocol (LCP) ECHO messages can be used as
   keepalives for the same purposes.  In the event of keepalive timeout
   or administrative shutdown of the Softwire, either the SI or the SC
   MAY tear down the Softwire by tearing down the L2TPv2 Control Channel
   and Session as specified in [<a href="rfc2661.html" title='"Layer Two Tunneling Protocol "'>RFC2661</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.1.%20%20Abbreviations"></a><a class="selflink" href="#section-1.1" name="section-1.1">1.1</a>.  Abbreviations</span>

   AF     Address Family, IPv4 or IPv6.

   CPE    Customer Premises Equipment.

   LCCE   L2TP Control Connection Endpoint, an L2TP node that exists at
          either end of an L2TP Control Connection.  (See [<a href="rfc3931.html" title='"Layer Two Tunneling Protocol - Version 3 (L2TPv3)"'>RFC3931</a>].)

   LNS    L2TP Network Server, a node that acts as one side of an L2TP
          tunnel (Control Connection) endpoint.  The LNS is the logical
          termination point of a PPP session that is being tunneled from
          the remote system by the peer LCCE.  (See [<a href="rfc2661.html" title='"Layer Two Tunneling Protocol "'>RFC2661</a>].)

   SC     Softwire Concentrator, the node terminating the Softwire in
          the service provider network.  (See [<a href="rfc4925.html" title='"Softwire Problem Statement"'>RFC4925</a>].)

   SI     Softwire Initiator, the node initiating the Softwire within
          the customer network.  (See [<a href="rfc4925.html" title='"Softwire Problem Statement"'>RFC4925</a>].)

   SPH    Softwire Payload Header, the IP headers being carried within a
          Softwire.  (See [<a href="rfc4925.html" title='"Softwire Problem Statement"'>RFC4925</a>].)

   STH    Softwire Transport Header, the outermost IP header of a
          Softwire.  (See [<a href="rfc4925.html" title='"Softwire Problem Statement"'>RFC4925</a>].)

   SW     Softwire, a shared-state "tunnel" created between the SC and
          SI.  (See [<a href="rfc4925.html" title='"Softwire Problem Statement"'>RFC4925</a>].)

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.2.%20%20Requirements%20Language"></a><a class="selflink" href="#section-1.2" name="section-1.2">1.2</a>.  Requirements Language</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [<a href="rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].






<span class="grey">Storer, et al.              Standards Track                     [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc5571.html">RFC 5571</a>          Softwire H &amp; S Framework with L2TPv2         June 2009</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.3.%20%20Considerations"></a><a class="selflink" href="#section-1.3" name="section-1.3">1.3</a>.  Considerations</span>

   Some sections of this document contain considerations that are not
   required for interoperability and correct operation of Softwire
   implementations.  These sections' titles are marked beginning with
   "Considerations".

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Applicability%20of%20L2TPv2%20for%20Softwire%20Requirements"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Applicability of L2TPv2 for Softwire Requirements</span>

   A list of Softwire "Hub and Spoke" requirements has been identified
   by the Softwire Problem Statement [<a href="rfc4925.html" title='"Softwire Problem Statement"'>RFC4925</a>].  The following sub-
   sections describe how L2TPv2 fulfills each of them.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.1.%20%20Traditional%20Network%20Address%20Translation%20%28NAT%20and%20NAPT%29"></a><a class="selflink" href="#section-2.1" name="section-2.1">2.1</a>.  Traditional Network Address Translation (NAT and NAPT)</span>

   A "Hub and Spoke" Softwire must be able to traverse Network Address
   Translation (NAT) and Network Address Port Translation (NAPT, also
   referred to as Port Address Translation or PAT) devices [<a href="rfc3022.html" title='"Traditional IP Network Address Translator (Traditional NAT)"'>RFC3022</a>] in
   case the scenario in question involves a non-upgradable, preexisting
   IPv4 home gateway performing NAT/NAPT or some carrier equipment at
   the other end of the access link performing NAT/NAPT.  The L2TPv2
   Softwire (i.e., Control Channel and Session) is capable of NAT/NAPT
   traversal since L2TPv2 can run over UDP.

   Since L2TPv2 does not detect NAT/NAPT along the path, L2TPv2 does not
   offer the option of disabling UDP.  The UDP encapsulation is present
   regardless of NAT/NAPT presence.  Both NAT/NAPT "autodetect" and UDP
   "bypass" are optional requirements in <a href="rfc4925.html#section-2.3">Section 2.3 of [RFC4925]</a>.

   As mentioned in <a href="rfc2661.html#section-8.1">Section 8.1 of [RFC2661]</a> and <a href="rfc3193.html#section-4">Section 4 of [RFC3193]</a>,
   an L2TP Start-Control-Connection-Reply (SCCRP) responder (SC) can
   chose a different IP address and/or UDP port than those from the
   initiator's Start-Control-Connection-Request (SCCRQ) (SI).  This may
   or may not traverse a NAT/NAPT depending on the NAT/NAPT's Filtering
   Behavior (see <a href="rfc4787.html#section-5">Section 5 of [RFC4787]</a>).  Specifically, any IP address
   and port combination will work with Endpoint-Independent Filtering,
   but changing the IP address and port will not work through Address-
   Dependent or Address-and-Port-Dependent Filtering.  Given this,
   responding from a different IP address and/or UDP port is NOT
   RECOMMENDED.











<span class="grey">Storer, et al.              Standards Track                     [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc5571.html">RFC 5571</a>          Softwire H &amp; S Framework with L2TPv2         June 2009</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.2.%20%20Scalability"></a><a class="selflink" href="#section-2.2" name="section-2.2">2.2</a>.  Scalability</span>

   In the "Hub and Spoke" model, a carrier must be able to scale the
   solution to millions of Softwire Initiators by adding more hubs
   (i.e., Softwire Concentrators).  L2TPv2 is a widely deployed protocol
   in broadband services, and its scalability has been proven in
   multiple large-scale IPv4 Virtual Private Network deployments, which
   scale up to millions of subscribers each.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.3.%20%20Routing"></a><a class="selflink" href="#section-2.3" name="section-2.3">2.3</a>.  Routing</span>

   There are no dynamic routing protocols between the SC and SI.  A
   default route from the SI to the SC is used.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.4.%20%20Multicast"></a><a class="selflink" href="#section-2.4" name="section-2.4">2.4</a>.  Multicast</span>

   Multicast protocols simply run transparently over L2TPv2 Softwires
   together with other regular IP traffic.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.5.%20%20Authentication%2C%20Authorization%2C%20and%20Accounting%20%28AAA%29"></a><a class="selflink" href="#section-2.5" name="section-2.5">2.5</a>.  Authentication, Authorization, and Accounting (AAA)</span>

   L2TPv2 supports optional mutual Control Channel authentication and
   leverages the optional mutual PPP per-session authentication.  L2TPv2
   is well integrated with AAA solutions (such as RADIUS) for both
   authentication and authorization.  Most L2TPv2 implementations
   available in the market support the logging of authentication and
   authorization events.

   L2TPv2 integration with RADIUS accounting (RADIUS Accounting
   extension for tunnel [<a href="rfc2867.html" title='"RADIUS Accounting Modifications for Tunnel Protocol Support"'>RFC2867</a>]) allows the collection and reporting
   of L2TPv2 Softwire usage statistics.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.6.%20%20Privacy%2C%20Integrity%2C%20and%20Replay%20Protection"></a><a class="selflink" href="#section-2.6" name="section-2.6">2.6</a>.  Privacy, Integrity, and Replay Protection</span>

   Since L2TPv2 runs over IP/UDP in the Softwire context, IPsec
   Encapsulating Security Payload (ESP) can be used in conjunction to
   provide per-packet authentication, integrity, replay protection, and
   confidentiality for both L2TPv2 control and data traffic [<a href="rfc3193.html" title='"Securing L2TP using IPsec"'>RFC3193</a>]
   and [<a href="rfc3948.html" title='"UDP Encapsulation of IPsec ESP Packets"'>RFC3948</a>].

   For Softwire deployments in which full payload security is not
   required, the L2TPv2 built-in Control Channel authentication and the
   inherited PPP authentication and PPP Encryption Control Protocol can
   be considered.







<span class="grey">Storer, et al.              Standards Track                     [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc5571.html">RFC 5571</a>          Softwire H &amp; S Framework with L2TPv2         June 2009</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.7.%20%20Operations%20and%20Management"></a><a class="selflink" href="#section-2.7" name="section-2.7">2.7</a>.  Operations and Management</span>

   L2TPv2 supports an optional in-band keepalive mechanism that injects
   HELLO control messages after a specified period of time has elapsed
   since the last data or control message was received on a tunnel (see
   <a href="rfc2661.html#section-5.5">Section 5.5 of [RFC2661]</a>).  If the HELLO control message is not
   reliably delivered, then the Control Channel and its Session will be
   torn down.  In the Softwire context, the L2TPv2 keepalive is used to
   monitor the connectivity status between the SI and SC and/or as a
   refresh mechanism for any NAT/NAPT translation entry along the access
   link.

   LCP ECHO offers a similar mechanism to monitor the connectivity
   status, as described in [<a href="rfc1661.html" title='"The Point-to-Point Protocol (PPP)"'>RFC1661</a>].  Softwire implementations SHOULD
   use L2TPv2 Hello keepalives, and in addition MAY use PPP LCP Echo
   messages to ensure Dead End Detection and/or to refresh NAT/NAPT
   translation entries.  The combination of these two mechanisms can be
   used as an optimization.

   The L2TPv2 MIB [<a href="rfc3371.html" title='"Layer Two Tunneling Protocol "'>RFC3371</a>] supports the complete suite of management
   operations such as configuration of Control Channel and Session,
   polling of Control Channel and Session status and their traffic
   statistics and notifications of Control Channel and Session UP/DOWN
   events.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.8.%20%20Encapsulations"></a><a class="selflink" href="#section-2.8" name="section-2.8">2.8</a>.  Encapsulations</span>

   L2TPv2 supports the following encapsulations:

   o  IPv6/PPP/L2TPv2/UDP/IPv4

   o  IPv4/PPP/L2TPv2/UDP/IPv6

   o  IPv4/PPP/L2TPv2/UDP/IPv4

   o  IPv6/PPP/L2TPv2/UDP/IPv6

   Note that UDP bypass is not supported by L2TPv2 since L2TPv2 does not
   support "autodetect" of NAT/NAPT.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Deployment%20Scenarios"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Deployment Scenarios</span>

   For the "Hub and Spoke" problem space, four scenarios have been
   identified.  In each of these four scenarios, different home
   equipment plays the role of the Softwire Initiator.  This section
   elaborates each scenario with L2TPv2 as the Softwire protocol and





<span class="grey">Storer, et al.              Standards Track                     [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc5571.html">RFC 5571</a>          Softwire H &amp; S Framework with L2TPv2         June 2009</span>


   other possible protocols involved to complete the solution.  This
   section examines the four scenarios for both IPv6-over-IPv4
   (<a href="#section-3.1">Section 3.1</a>) and IPv4-over-IPv6 (<a href="#section-3.2">Section 3.2</a>) encapsulations.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.1.%20%20IPv6-over-IPv4%20Softwires%20with%20L2TPv2"></a><a class="selflink" href="#section-3.1" name="section-3.1">3.1</a>.  IPv6-over-IPv4 Softwires with L2TPv2</span>

   The following sub-sections cover IPv6 connectivity (SPH) across an
   IPv4-only access network (STH) using a Softwire.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.1.1.%20%20Host%20CPE%20as%20Softwire%20Initiator"></a><a class="selflink" href="#section-3.1.1" name="section-3.1.1">3.1.1</a>.  Host CPE as Softwire Initiator</span>

   The Softwire Initiator (SI) is the host CPE (directly connected to a
   modem), which is dual-stack.  There is no other gateway device.  The
   IPv4 traffic SHOULD NOT traverse the Softwire.  See Figure 1.

             IPv6 or dual-stack      IPv4-only      dual-stack
            |------------------||-----------------||----------|

      I                    SC                          SI
      N                  +-----+                   +----------+
      T                  |     |                   |  v4/v6   |
      E  &lt;==[ IPv6  ]....|v4/v6|....[IPv4-only]....| host CPE |
      R     [network]    |     |    [ network ]    |          |
      N                  | LNS |                   |LAC Client|
      E                  +-----+                   +----------+
      T                          _ _ _ _ _ _ _ _ _
                               ()_ _ _ _ _ _ _ _ _() &lt;-- IPv6 traffic
                             PPP o L2TPv2 o UDP o IPv4          (SPH)
                                      Softwire

                               &lt;------------------&gt;
                    IPV6CP: capable of /64 Intf-Id assignment or
                                 uniqueness check

                               |------------------&gt;/64 prefix
                                        RA
                               |------------------&gt;DNS, etc.
                                      DHCPv6

                 Figure 1: Host CPE as Softwire Initiator

   In this scenario, after the L2TPv2 Control Channel and Session
   establishment and PPP LCP negotiation (and optionally PPP
   Authentication) are successful, the IPv6 Control Protocol (IPV6CP)
   negotiates IPv6-over-PPP, which also provides the capability for the
   ISP to assign the 64-bit Interface-Identifier to the host CPE or
   perform uniqueness validation for the two interface identifiers at
   the two PPP ends [<a href="rfc5072.html" title='"IP Version 6 over PPP"'>RFC5072</a>].  After IPv6-over-PPP is up, IPv6



<span class="grey">Storer, et al.              Standards Track                     [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc5571.html">RFC 5571</a>          Softwire H &amp; S Framework with L2TPv2         June 2009</span>


   Stateless Address Autoconfiguration / Neighbor Discovery runs over
   the IPv6-over-PPP link, and the LNS can inform the host CPE of a
   prefix to use for stateless address autoconfiguration through a
   Router Advertisement (RA) while other non-address configuration
   options (such as DNS [<a href="rfc3646.html" title='"DNS Configuration options for Dynamic Host Configuration Protocol for IPv6 (DHCPv6)"'>RFC3646</a>] or other servers' addresses that might
   be available) can be conveyed to the host CPE via DHCPv6.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.1.2.%20%20Router%20CPE%20as%20Softwire%20Initiator"></a><a class="selflink" href="#section-3.1.2" name="section-3.1.2">3.1.2</a>.  Router CPE as Softwire Initiator</span>

   The Softwire Initiator (SI) is the router CPE, which is a dual-stack
   device.  The IPv4 traffic SHOULD NOT traverse the Softwire.  See
   Figure 2.

          IPv6 or dual-stack      IPv4-only           dual-stack
         |------------------||-----------------||---------------------|

   I                    SC                          SI
   N                  +-----+                   +----------+
   T                  |     |                   |  v4/v6   |    +-----+
   E  &lt;==[ IPv6  ]....|v4/v6|....[IPv4-only]....|   CPE    |----|v4/v6|
   R     [network]    |     |    [ network ]    |          |    | host|
   N                  | LNS |                   |LAC Client|    +-----+
   E                  +-----+                   +----------+
   T                          _ _ _ _ _ _ _ _ _
                            ()_ _ _ _ _ _ _ _ _() &lt;-------- IPv6 traffic
                          PPP o L2TPv2 o UDP o IPv4                (SPH)
                                   Softwire

                            &lt;------------------&gt;
                    IPV6CP: capable of /64 Intf-Id assignment or
                                uniqueness check

                            |------------------&gt;/64 prefix
                                     RA
                            |------------------&gt;/48 prefix,
                                   DHCPv6       DNS, etc.

                                                     |-------&gt;/64 prefix
                                                         RA
                                                     |-------&gt; DNS, etc.
                                                     DHCPv4/v6

                Figure 2: Router CPE as Softwire Initiator

   In this scenario, after the L2TPv2 Control Channel and Session
   establishment and PPP LCP negotiation (and optionally PPP
   Authentication) are successful, IPV6CP negotiates IPv6-over-PPP,
   which also provides the capability for the ISP to assign the 64-bit



<span class="grey">Storer, et al.              Standards Track                    [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc5571.html">RFC 5571</a>          Softwire H &amp; S Framework with L2TPv2         June 2009</span>


   Interface-Identifier to the router CPE or perform uniqueness
   validation for the two interface identifiers at the two PPP ends
   [<a href="rfc5072.html" title='"IP Version 6 over PPP"'>RFC5072</a>].  After IPv6-over-PPP is up, IPv6 Stateless Address
   Autoconfiguration / Neighbor Discovery runs over the IPv6-over-PPP
   link, and the LNS can inform the router CPE of a prefix to use for
   stateless address autoconfiguration through a Router Advertisement
   (RA).  DHCPv6 can be used to perform IPv6 Prefix Delegation (e.g.,
   delegating a prefix to be used within the home network [<a href="rfc3633.html" title='"IPv6 Prefix Options for Dynamic Host Configuration Protocol (DHCP) version 6"'>RFC3633</a>]) and
   convey other non-address configuration options (such as DNS
   [<a href="rfc3646.html" title='"DNS Configuration options for Dynamic Host Configuration Protocol for IPv6 (DHCPv6)"'>RFC3646</a>]) to the router CPE.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.1.3.%20%20Host%20behind%20CPE%20as%20Softwire%20Initiator"></a><a class="selflink" href="#section-3.1.3" name="section-3.1.3">3.1.3</a>.  Host behind CPE as Softwire Initiator</span>

   The CPE is IPv4-only.  The Softwire Initiator (SI) is a dual-stack
   host (behind the IPv4-only CPE), which acts as an IPv6 host CPE.  The
   IPv4 traffic SHOULD NOT traverse the Softwire.  See Figure 3.


          IPv6 or dual-stack            IPv4-only           dual-stack
         |------------------||----------------------------||----------|

    I                   SC                                    SI
    N                 +-----+                              +----------+
    T                 |     |                   +-------+  |   v4/v6  |
    E &lt;==[ IPv6  ]....|v4/v6|....[IPv4-only]....|v4-only|--|   host   |
    R    [network]    |     |    [ network ]    |  CPE  |  |          |
    N                 | LNS |                   +-------+  |LAC Client|
    E                 +-----+                              +----------+
    T                         _ _ _ _ _ _ _ _ _ _ _ _ _ _
                            ()_ _ _ _ _ _ _ _ _ _ _ _ _ _() &lt;--  IPv6
                               PPP o L2TPv2 o UDP o IPv4        traffic
                                        Softwire                 (SPH)

                            &lt;------------------------------&gt;
                     IPV6CP: capable of /64 Intf-Id assignment or
                                   uniqueness check

                            |------------------------------&gt;/64 prefix
                                           RA
                            |------------------------------&gt;DNS, etc.
                                         DHCPv6

              Figure 3: Host behind CPE as Softwire Initiator

   In this scenario, after the L2TPv2 Control Channel and Session
   establishment and PPP LCP negotiation (and optionally PPP
   Authentication) are successful, IPV6CP negotiates IPv6-over-PPP,
   which also provides the capability for the ISP to assign the 64-bit



<span class="grey">Storer, et al.              Standards Track                    [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc5571.html">RFC 5571</a>          Softwire H &amp; S Framework with L2TPv2         June 2009</span>


   Interface-Identifier to the host or perform uniqueness validation for
   the two interface identifiers at the two PPP ends [<a href="rfc5072.html" title='"IP Version 6 over PPP"'>RFC5072</a>].  After
   IPv6-over-PPP is up, IPv6 Stateless Address Autoconfiguration /
   Neighbor Discovery runs over the IPv6-over-PPP link, and the LNS can
   inform the host of a prefix to use for stateless address
   autoconfiguration through a Router Advertisement (RA) while other
   non-address configuration options (such as DNS [<a href="rfc3646.html" title='"DNS Configuration options for Dynamic Host Configuration Protocol for IPv6 (DHCPv6)"'>RFC3646</a>]) can be
   conveyed to the host via DHCPv6.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.1.4.%20%20Router%20behind%20CPE%20as%20Softwire%20Initiator"></a><a class="selflink" href="#section-3.1.4" name="section-3.1.4">3.1.4</a>.  Router behind CPE as Softwire Initiator</span>

   The CPE is IPv4-only.  The Softwire Initiator (SI) is a dual-stack
   device (behind the IPv4-only CPE) acting as an IPv6 CPE router inside
   the home network.  The IPv4 traffic SHOULD NOT traverse the Softwire.
   See Figure 4.




































<span class="grey">Storer, et al.              Standards Track                    [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc5571.html">RFC 5571</a>          Softwire H &amp; S Framework with L2TPv2         June 2009</span>


         IPv6 or dual-stack           IPv4-only          dual-stack
        |------------------||-------------------------||-------------|

   I                   SC                                 SI
   N                 +-----+                           +----------+
   T                 |     |               +-------+   |  v4/v6   |
   E &lt;==[ IPv6  ]....|v4/v6|..[IPv4-only]..|v4-only|---|  router  |
   R    [network]    |     |  [ network ]  |  CPE  | | |          |
   N                 | LNS |               +-------+ | |LAC Client|
   E                 +-----+                         | +----------+
   T                                                 |
                                                     ---------+-----+
                                                              |v4/v6|
                                                              | host|
                             _ _ _ _ _ _ _ _ _ _ _ _ _        +-----+
                           ()_ _ _ _ _ _ _ _ _ _ _ _ _() &lt;--  IPv6
                              PPP o L2TPv2 o UDP o IPv4      traffic
                                       Softwire               (SPH)

                           &lt;---------------------------&gt;
                  IPV6CP: capable of /64 Intf-Id assignment or
                                 uniqueness check

                           |---------------------------&gt;/64 prefix
                                         RA
                           |---------------------------&gt;/48 prefix,
                                       DHCPv6           DNS, etc.

                                                           |----&gt; /64
                                                             RA   prefix
                                                           |----&gt; DNS,
                                                           DHCPv6 etc.

             Figure 4: Router behind CPE as Softwire Initiator

   In this scenario, after the L2TPv2 Control Channel and Session
   establishment and PPP LCP negotiation (and optionally PPP
   Authentication) are successful, IPV6CP negotiates IPv6-over-PPP,
   which also provides the capability for the ISP to assign the 64-bit
   Interface-Identifier to the v4/v6 router or perform uniqueness
   validation for the two interface identifiers at the two PPP ends
   [<a href="rfc5072.html" title='"IP Version 6 over PPP"'>RFC5072</a>].  After IPv6-over-PPP is up, IPv6 Stateless Address
   Autoconfiguration / Neighbor Discovery runs over the IPv6-over-PPP
   link, and the LNS can inform the v4/v6 router of a prefix to use for
   stateless address autoconfiguration through a Router Advertisement






<span class="grey">Storer, et al.              Standards Track                    [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc5571.html">RFC 5571</a>          Softwire H &amp; S Framework with L2TPv2         June 2009</span>


   (RA).  DHCPv6 can be used to perform IPv6 Prefix Delegation (e.g.,
   delegating a prefix to be used within the home network [<a href="rfc3633.html" title='"IPv6 Prefix Options for Dynamic Host Configuration Protocol (DHCP) version 6"'>RFC3633</a>]) and
   convey other non-address configuration options (such as DNS
   [<a href="rfc3646.html" title='"DNS Configuration options for Dynamic Host Configuration Protocol for IPv6 (DHCPv6)"'>RFC3646</a>]) to the v4/v6 router.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.2.%20%20IPv4-over-IPv6%20Softwires%20with%20L2TPv2"></a><a class="selflink" href="#section-3.2" name="section-3.2">3.2</a>.  IPv4-over-IPv6 Softwires with L2TPv2</span>

   The following sub-sections cover IPv4 connectivity (SPH) across an
   IPv6-only access network (STH) using a Softwire.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.2.1.%20%20Host%20CPE%20as%20Softwire%20Initiator"></a><a class="selflink" href="#section-3.2.1" name="section-3.2.1">3.2.1</a>.  Host CPE as Softwire Initiator</span>

   The Softwire Initiator (SI) is the host CPE (directly connected to a
   modem), which is dual-stack.  There is no other gateway device.  The
   IPv6 traffic SHOULD NOT traverse the Softwire.  See Figure 5.

             IPv4 or dual-stack      IPv6-only      dual-stack
            |------------------||-----------------||----------|

       I                   SC                          SI
       N                 +-----+                   +----------+
       T                 |     |                   |  v4/v6   |
       E &lt;==[ IPv4  ]....|v4/v6|....[IPv6-only]....| host CPE |
       R    [network]    |     |    [ network ]    |          |
       N                 | LNS |                   |LAC Client|
       E                 +-----+                   +----------+
       T                         _ _ _ _ _ _ _ _ _
                               ()_ _ _ _ _ _ _ _ _() &lt;-- IPv4 traffic
                             PPP o L2TPv2 o UDP o IPv6          (SPH)
                                      Softwire

                               &lt;------------------&gt;
                       IPCP: capable of global IP assignment
                                    and DNS, etc.

                 Figure 5: Host CPE as Softwire Initiator

   In this scenario, after the L2TPv2 Control Channel and Session
   establishment and PPP LCP negotiation (and optionally PPP
   Authentication) are successful, the IP Control Protocol (IPCP)
   negotiates IPv4-over-PPP, which also provides the capability for the
   ISP to assign a global IPv4 address to the host CPE.  A global IPv4
   address can also be assigned via DHCP.  Other configuration options
   (such as DNS) can be conveyed to the host CPE via IPCP [<a href="rfc1877.html" title='"PPP Internet Protocol Control Protocol Extensions for Name Server Addresses"'>RFC1877</a>] or
   DHCP [<a href="rfc2132.html" title='"DHCP Options and BOOTP Vendor Extensions"'>RFC2132</a>].






<span class="grey">Storer, et al.              Standards Track                    [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc5571.html">RFC 5571</a>          Softwire H &amp; S Framework with L2TPv2         June 2009</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.2.2.%20%20Router%20CPE%20as%20Softwire%20Initiator"></a><a class="selflink" href="#section-3.2.2" name="section-3.2.2">3.2.2</a>.  Router CPE as Softwire Initiator</span>

   The Softwire Initiator (SI) is the router CPE, which is a dual-stack
   device.  The IPv6 traffic SHOULD NOT traverse the Softwire.  See
   Figure 6.

         IPv4 or dual-stack      IPv6-only        dual-stack Home
        |------------------||-----------------||-------------------|

   I                   SC                          SI
   N                 +-----+                   +----------+
   T                 |     |                   |  v4/v6   |  +-----+
   E &lt;==[ IPv4  ]....|v4/v6|....[IPv6-only]....|   CPE    |--|v4/v6|
   R    [network]    |     |    [ network ]    |          |  | host|
   N                 | LNS |                   |LAC Client|  +-----+
   E                 +-----+                   +----------+
   T                         _ _ _ _ _ _ _ _ _
                           ()_ _ _ _ _ _ _ _ _() &lt;--------- IPv4 traffic
                         PPP o L2TPv2 o UDP o IPv6                 (SPH)
                                  Softwire

                           &lt;------------------&gt;
                   IPCP: capable of global IP assignment
                               and DNS, etc.

                           |------------------&gt;
                         DHCPv4: prefix, mask, PD

                                                             private/
                                                    |------&gt; global
                                                      DHCP   IP, DNS,
                                                             etc.

                Figure 6: Router CPE as Softwire Initiator

   In this scenario, after the L2TPv2 Control Channel and Session
   establishment and PPP LCP negotiation (and optionally PPP
   Authentication) are successful, IPCP negotiates IPv4-over-PPP, which
   also provides the capability for the ISP to assign a global IPv4
   address to the router CPE.  A global IPv4 address can also be
   assigned via DHCP.  Other configuration options (such as DNS) can be
   conveyed to the router CPE via IPCP [<a href="rfc1877.html" title='"PPP Internet Protocol Control Protocol Extensions for Name Server Addresses"'>RFC1877</a>] or DHCP [<a href="rfc2132.html" title='"DHCP Options and BOOTP Vendor Extensions"'>RFC2132</a>].  For
   IPv4 Prefix Delegation for the home network, DHCP [<a href="#ref-SUBNET-ALL" title='"Subnet Allocation Option"'>SUBNET-ALL</a>] can be
   used.







<span class="grey">Storer, et al.              Standards Track                    [Page 15]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc5571.html">RFC 5571</a>          Softwire H &amp; S Framework with L2TPv2         June 2009</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.2.3.%20%20Host%20behind%20CPE%20as%20Softwire%20Initiator"></a><a class="selflink" href="#section-3.2.3" name="section-3.2.3">3.2.3</a>.  Host behind CPE as Softwire Initiator</span>

   The CPE is IPv6-only.  The Softwire Initiator (SI) is a dual-stack
   host (behind the IPv6 CPE), which acts as an IPv4 host CPE.  The IPv6
   traffic SHOULD NOT traverse the Softwire.  See Figure 7.


          IPv4 or dual-stack            IPv6-only           dual-stack
         |------------------||----------------------------||----------|

    I                   SC                                      SI
    N                 +-----+                              +----------+
    T                 |     |                   +-------+  |   v4/v6  |
    E &lt;==[ IPv4  ]....|v4/v6|....[IPv6-only]....|v6-only|--|   host   |
    R    [network]    |     |    [ network ]    |  CPE  |  |          |
    N                 | LNS |                   +-------+  |LAC Client|
    E                 +-----+                              +----------+
    T                         _ _ _ _ _ _ _ _ _ _ _ _ _ _
                            ()_ _ _ _ _ _ _ _ _ _ _ _ _ _() &lt;--  IPv4
                               PPP o L2TPv2 o UDP o IPv6        traffic
                                        Softwire                 (SPH)

                            &lt;------------------------------&gt;
                        IPCP: capable of global IP assignment
                                    and DNS, etc.

              Figure 7: Host behind CPE as Softwire Initiator

   In this scenario, after the L2TPv2 Control Channel and Session
   establishment and PPP LCP negotiation (and optionally PPP
   Authentication) are successful, IPCP negotiates IPv4-over-PPP, which
   also provides the capability for the ISP to assign a global IPv4
   address to the host.  A global IPv4 address can also be assigned via
   DHCP.  Other configuration options (such as DNS) can be conveyed to
   the host CPE via IPCP [<a href="rfc1877.html" title='"PPP Internet Protocol Control Protocol Extensions for Name Server Addresses"'>RFC1877</a>] or DHCP [<a href="rfc2132.html" title='"DHCP Options and BOOTP Vendor Extensions"'>RFC2132</a>].

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.2.4.%20%20Router%20behind%20CPE%20as%20Softwire%20Initiator"></a><a class="selflink" href="#section-3.2.4" name="section-3.2.4">3.2.4</a>.  Router behind CPE as Softwire Initiator</span>

   The CPE is IPv6-only.  The Softwire Initiator (SI) is a dual-stack
   device (behind the IPv6-only CPE) acting as an IPv4 CPE router inside
   the home network.  The IPv6 traffic SHOULD NOT traverse the Softwire.
   See Figure 8.









<span class="grey">Storer, et al.              Standards Track                    [Page 16]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc5571.html">RFC 5571</a>          Softwire H &amp; S Framework with L2TPv2         June 2009</span>


         IPv4 or dual-stack          IPv6-only           dual-stack
        |------------------||-------------------------||------------|

   I                   SC                                 SI
   N                 +-----+                           +----------+
   T                 |     |               +-------+   |  v4/v6   |
   E &lt;==[ IPv4  ]....|v4/v6|..[IPv6-only]..|v6-only|---|  router  |
   R    [network]    |     |  [ network ]  |  CPE  | | |          |
   N                 | LNS |               +-------+ | |LAC Client|
   E                 +-----+                         | +----------+
   T                                                 |
                                                     --------+-----+
                                                             |v4/v6|
                                                             | host|
                             _ _ _ _ _ _ _ _ _ _ _ _ _       +-----+
                           ()_ _ _ _ _ _ _ _ _ _ _ _ _() &lt;---  IPv4
                             PPP o L2TPv2 o UDP o IPv4        traffic
                                      Softwire                 (SPH)

                           &lt;---------------------------&gt;
                   IPCP: assigns global IP address and DNS, etc.

                           |---------------------------&gt;
                              DHCPv4: prefix, mask, PD

                                                                private/
                                                         |----&gt; global
                                                          DHCP  IP, DNS,
                                                                etc.

             Figure 8: Router behind CPE as Softwire Initiator

   In this scenario, after the L2TPv2 Control Channel and Session
   establishment and PPP LCP negotiation (and optionally PPP
   Authentication) are successful, IPCP negotiates IPv4-over-PPP, which
   also provides the capability for the ISP to assign a global IPv4
   address to the v4/v6 router.  A global IPv4 address can also be
   assigned via DHCP.  Other configuration options (such as DNS) can be
   conveyed to the v4/v6 router via IPCP [<a href="rfc1877.html" title='"PPP Internet Protocol Control Protocol Extensions for Name Server Addresses"'>RFC1877</a>] or DHCP [<a href="rfc2132.html" title='"DHCP Options and BOOTP Vendor Extensions"'>RFC2132</a>].
   For IPv4 Prefix Delegation for the home network, DHCP [<a href="#ref-SUBNET-ALL" title='"Subnet Allocation Option"'>SUBNET-ALL</a>]
   can be used.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20References%20to%20Standardization%20Documents"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  References to Standardization Documents</span>

   This section lists and groups documents from the Internet
   standardization describing technologies used to design the framework
   of the Softwire "Hub and Spoke" solution.  This emphasizes the
   motivation of Softwire to reuse as many existing standards as



<span class="grey">Storer, et al.              Standards Track                    [Page 17]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc5571.html">RFC 5571</a>          Softwire H &amp; S Framework with L2TPv2         June 2009</span>


   possible.  This list contains both Standards Track (Proposed
   Standard, Draft Standard, and Standard) and Informational documents.
   The list of documents and their status should only be only used for
   description purposes.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.1.%20%20L2TPv2"></a><a class="selflink" href="#section-4.1" name="section-4.1">4.1</a>.  L2TPv2</span>

   <a href="rfc2661.html">RFC 2661</a>   "Layer Two Tunneling Protocol 'L2TP'" [<a href="rfc2661.html" title='"Layer Two Tunneling Protocol "'>RFC2661</a>].

              *  For both IPv4 and IPv6 payloads (SPH), support is
                 complete.

              *  For both IPv4 and IPv6 transports (STH), support is
                 complete.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.2.%20%20Securing%20the%20Softwire%20Transport"></a><a class="selflink" href="#section-4.2" name="section-4.2">4.2</a>.  Securing the Softwire Transport</span>

   <a href="rfc3193.html">RFC 3193</a>   "Securing L2TP using IPsec" [<a href="rfc3193.html" title='"Securing L2TP using IPsec"'>RFC3193</a>].

   <a href="rfc3948.html">RFC 3948</a>   "UDP Encapsulation of IPsec ESP Packets" [<a href="rfc3948.html" title='"UDP Encapsulation of IPsec ESP Packets"'>RFC3948</a>].

              *  IPsec supports both IPv4 and IPv6 transports.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.3.%20%20Authentication%2C%20Authorization%2C%20and%20Accounting"></a><a class="selflink" href="#section-4.3" name="section-4.3">4.3</a>.  Authentication, Authorization, and Accounting</span>

   <a href="rfc2865.html">RFC 2865</a>   "Remote Authentication Dial In User Service (RADIUS)"
              [<a href="rfc2865.html" title='"Remote Authentication Dial In User Service (RADIUS)"'>RFC2865</a>].

              *  Updated by [<a href="rfc2868.html" title='"RADIUS Attributes for Tunnel Protocol Support"'>RFC2868</a>], [<a href="rfc3575.html" title='"IANA Considerations for RADIUS (Remote Authentication Dial In User Service)"'>RFC3575</a>], and [<a href="rfc5080.html" title='"Common Remote Authentication Dial In User Service (RADIUS) Implementation Issues and Suggested Fixes"'>RFC5080</a>].

   <a href="rfc2867.html">RFC 2867</a>   "RADIUS Accounting Modifications for Tunnel Protocol
              Support" [<a href="rfc2867.html" title='"RADIUS Accounting Modifications for Tunnel Protocol Support"'>RFC2867</a>].

   <a href="rfc2868.html">RFC 2868</a>   "RADIUS Attributes for Tunnel Protocol Support" [<a href="rfc2868.html" title='"RADIUS Attributes for Tunnel Protocol Support"'>RFC2868</a>].

   <a href="rfc3162.html">RFC 3162</a>   "RADIUS and IPv6" [<a href="rfc3162.html" title='"RADIUS and IPv6"'>RFC3162</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.4.%20%20MIB"></a><a class="selflink" href="#section-4.4" name="section-4.4">4.4</a>.  MIB</span>

   <a href="rfc1471.html">RFC 1471</a>   "The Definitions of Managed Objects for the Link Control
              Protocol of the Point-to-Point Protocol" [<a href="rfc1471.html" title='"The Definitions of Managed Objects for the Link Control Protocol of the Point-to-Point Protocol"'>RFC1471</a>].

   <a href="rfc1473.html">RFC 1473</a>   "The Definitions of Managed Objects for the IP Network
              Control Protocol of the Point-to-Point Protocol"
              [<a href="rfc1473.html" title='"The Definitions of Managed Objects for the IP Network Control Protocol of the Point-to-Point Protocol"'>RFC1473</a>].






<span class="grey">Storer, et al.              Standards Track                    [Page 18]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-19" id="page-19" name="page-19"> </a>
<span class="grey"><a href="rfc5571.html">RFC 5571</a>          Softwire H &amp; S Framework with L2TPv2         June 2009</span>


   <a href="rfc3371.html">RFC 3371</a>   "Layer Two Tunneling Protocol "L2TP" Management
              Information Base" [<a href="rfc3371.html" title='"Layer Two Tunneling Protocol "'>RFC3371</a>].

   <a href="rfc4087.html">RFC 4087</a>   "IP Tunnel MIB" [<a href="rfc4087.html" title='"IP Tunnel MIB"'>RFC4087</a>].

              *  Both IPv4 and IPv6 transports are supported.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.5.%20%20Softwire%20Payload%20Related"></a><a class="selflink" href="#section-4.5" name="section-4.5">4.5</a>.  Softwire Payload Related</span>

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.5.1.%20%20For%20IPv6%20Payloads"></a><a class="selflink" href="#section-4.5.1" name="section-4.5.1">4.5.1</a>.  For IPv6 Payloads</span>

   <a href="rfc4861.html">RFC 4861</a>   "Neighbor Discovery for IP version 6 (IPv6)" [<a href="rfc4861.html" title='"Neighbor Discovery for IP version 6 (IPv6)"'>RFC4861</a>].

   <a href="rfc4862.html">RFC 4862</a>   "IPv6 Stateless Address Autoconfiguration" [<a href="rfc4862.html" title='"IPv6 Stateless Address Autoconfiguration"'>RFC4862</a>].

   <a href="rfc5072.html">RFC 5072</a>   "IP Version 6 over PPP" [<a href="rfc5072.html" title='"IP Version 6 over PPP"'>RFC5072</a>].

   <a href="rfc3315.html">RFC 3315</a>   "Dynamic Host Configuration Protocol for IPv6 (DHCPv6)"
              [<a href="rfc3315.html" title='"Dynamic Host Configuration Protocol for IPv6 (DHCPv6)"'>RFC3315</a>].

   <a href="rfc3633.html">RFC 3633</a>   "IPv6 Prefix Options for Dynamic Host Configuration
              Protocol (DHCP) version 6" [<a href="rfc3633.html" title='"IPv6 Prefix Options for Dynamic Host Configuration Protocol (DHCP) version 6"'>RFC3633</a>].

   <a href="rfc3646.html">RFC 3646</a>   "DNS Configuration options for Dynamic Host Configuration
              Protocol for IPv6 (DHCPv6)" [<a href="rfc3646.html" title='"DNS Configuration options for Dynamic Host Configuration Protocol for IPv6 (DHCPv6)"'>RFC3646</a>].

   <a href="rfc3736.html">RFC 3736</a>   "Stateless Dynamic Host Configuration Protocol (DHCP)
              Service for IPv6" [<a href="rfc3736.html" title='"Stateless Dynamic Host Configuration Protocol (DHCP) Service for IPv6"'>RFC3736</a>].

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.5.2.%20%20For%20IPv4%20Payloads"></a><a class="selflink" href="#section-4.5.2" name="section-4.5.2">4.5.2</a>.  For IPv4 Payloads</span>

   <a href="rfc1332.html">RFC 1332</a>   "The PPP Internet Protocol Control Protocol (IPCP)"
              [<a href="rfc1332.html" title='"The PPP Internet Protocol Control Protocol (IPCP)"'>RFC1332</a>].

   <a href="rfc1661.html">RFC 1661</a>   "The Point-to-Point Protocol (PPP)" [<a href="rfc1661.html" title='"The Point-to-Point Protocol (PPP)"'>RFC1661</a>].

   <a href="rfc1877.html">RFC 1877</a>   "PPP Internet Protocol Control Protocol Extensions for
              Name Server Addresses" [<a href="rfc1877.html" title='"PPP Internet Protocol Control Protocol Extensions for Name Server Addresses"'>RFC1877</a>].

   <a href="rfc2131.html">RFC 2131</a>   "Dynamic Host Configuration Protocol" [<a href="rfc2131.html" title='"Dynamic Host Configuration Protocol"'>RFC2131</a>].

   <a href="rfc2132.html">RFC 2132</a>   "DHCP Options and BOOTP Vendor Extensions" [<a href="rfc2132.html" title='"DHCP Options and BOOTP Vendor Extensions"'>RFC2132</a>].

   DHCP Subnet Allocation  "Subnet Allocation Option".

              *  Work in progress, see [<a href="#ref-SUBNET-ALL" title='"Subnet Allocation Option"'>SUBNET-ALL</a>].





<span class="grey">Storer, et al.              Standards Track                    [Page 19]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-20" id="page-20" name="page-20"> </a>
<span class="grey"><a href="rfc5571.html">RFC 5571</a>          Softwire H &amp; S Framework with L2TPv2         June 2009</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Softwire%20Establishment"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Softwire Establishment</span>

   A Softwire is established in three distinct steps, potentially
   preceded by an optional IPsec-related step 0 (see Figure 9).  First,
   an L2TPv2 tunnel with a single session is established from the SI to
   the SC.  Second, a PPP session is established over the L2TPv2 session
   and the SI obtains an address.  Third, the SI optionally gets other
   information through DHCP such as a delegated prefix and DNS servers.


      SC                                 SI
       |                                 |
       |&lt;-------------IKEv1-------------&gt;| Step 0
       |                                 | IPsec SA establishment
       |                                 | (optional)
       |                                 |
       |&lt;-------------L2TPv2------------&gt;| Step 1
       |                                 | L2TPv2 Tunnel establishment
       |                                 |
       |&lt;--------------PPP--------------&gt;| Step 2
       |&lt;-----Endpoint Configuration----&gt;| PPP and Endpoint
       |                                 | configuration
       |                                 |
       |&lt;------Router Configuration-----&gt;| Step 3
       |                                 | Additional configuration
       |                                 | (optional)

            Figure 9: Steps for the Establishment of a Softwire

   Figure 10 depicts details of each of these steps required to
   establish a Softwire.




















<span class="grey">Storer, et al.              Standards Track                    [Page 20]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-21" id="page-21" name="page-21"> </a>
<span class="grey"><a href="rfc5571.html">RFC 5571</a>          Softwire H &amp; S Framework with L2TPv2         June 2009</span>


         SC                                 SI
          |                                 |
          |                                 | Step 0
          |&lt;------------IKEv1--------------&gt;| = IKEv1 (Optional)
          |                                 |
          |                                 | Step 1
          |&lt;------------SCCRQ---------------| -
          |-------------SCCRP--------------&gt;| |
          |&lt;------------SCCCN---------------| |
          |&lt;------------ICRQ----------------| | L2TPv2
          |-------------ICRP---------------&gt;| |
          |&lt;------------ICCN----------------| -
          |                                 |
          |                                 | Step 2
          |&lt;-----Configuration-Request------| -
          |------Configuration-Request-----&gt;| | PPP
          |--------Configuration-Ack-------&gt;| | LCP
          |&lt;-------Configuration-Ack--------| -
          |                                 |
          |-----------Challenge------------&gt;| - PPP Authentication
          |&lt;----------Response--------------| | (Optional - CHAP)
          |------------Success-------------&gt;| -
          |                                 |
          |&lt;-----Configuration-Request------| -
          |------Configuration-Request-----&gt;| | PPP NCP
          |--------Configuration-Ack-------&gt;| | (IPV6CP or IPCP)
          |&lt;-------Configuration-Ack--------| -
          |                                 |
          |&lt;------Router-Solicitation-------| - Neighbor Discovery
          |-------Router-Advertisement-----&gt;| | (IPv6 only)
          |                                 | -
          |                                 |
          |                                 | Step3
          |                                 | DHCP (Optional)
          |&lt;-----------SOLICIT--------------| -
          |-----------ADVERTISE------------&gt;| | DHCPv6
          |&lt;---------- REQUEST--------------| | (IPv6 SW, Optional)
          |-------------REPLY--------------&gt;| -
          |                                 | or
          |&lt;---------DHCPDISCOVER-----------| -
          |-----------DHCPOFFER------------&gt;| | DHCPv4
          |&lt;---------DHCPREQUEST------------| | (IPv4 SW, Optional)
          |------------DHCPACK-------------&gt;| -

       Figure 10: Detailed Steps in the Establishment of a Softwire






<span class="grey">Storer, et al.              Standards Track                    [Page 21]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-22" id="page-22" name="page-22"> </a>
<span class="grey"><a href="rfc5571.html">RFC 5571</a>          Softwire H &amp; S Framework with L2TPv2         June 2009</span>


   The IPsec-related negotiations in step 0 are optional.  The L2TPv2
   negotiations in step 1 are described in <a href="#section-5.1">Section 5.1</a>.  The PPP Network
   Control Protocol (NCP) negotiations in step 2 use IPV6CP for IPv6-
   over-IPv4 Softwires, and IPCP for IPv4-over-IPv6 Softwires (see
   <a href="#section-5.2.4">Section 5.2.4</a>).  The optional DHCP negotiations in step 3 use DHCPv6
   for IPv6-over-IPv4 Softwires, and DHCPv4 for IPv4-over-IPv6 Softwires
   (see <a href="#section-5.4">Section 5.4</a>).  Additionally, for IPv6-over-IPv4 Softwires, the
   DHCPv6 exchange for non-address configuration (such as DNS) can use
   Stateless DHCPv6, the two-message exchange with Information-Request
   and Reply messages (see <a href="rfc3315.html#section-1.2">Section 1.2 of [RFC3315]</a> and [<a href="rfc3736.html" title='"Stateless Dynamic Host Configuration Protocol (DHCP) Service for IPv6"'>RFC3736</a>]).

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.1.%20%20L2TPv2%20Tunnel%20Setup"></a><a class="selflink" href="#section-5.1" name="section-5.1">5.1</a>.  L2TPv2 Tunnel Setup</span>

   L2TPv2 [<a href="rfc2661.html" title='"Layer Two Tunneling Protocol "'>RFC2661</a>] was originally designed to provide private network
   access to end users connected to a public network.  In the L2TPv2
   incoming call model, the end user makes a connection to an L2TP
   Access Concentrator (LAC).  The LAC then initiates an L2TPv2 tunnel
   to an L2TP Network Server (LNS).  The LNS then transfers end-user
   traffic between the L2TPv2 tunnel and the private network.

   In the Softwire "Hub and Spoke" model, the Softwire Initiator (SI)
   assumes the role of the LAC Client and the Softwire Concentrator (SC)
   assumes the role of the LNS.

   In the Softwire model, an L2TPv2 packet MUST be carried over UDP.
   The underlying version of the IP protocol may be IPv4 or IPv6,
   depending on the Softwire scenario.

   In the following sections, the term "Tunnel" follows the definition
   from <a href="rfc2661.html#section-1.2">Section 1.2 of [RFC2661]</a>, namely: "The Tunnel consists of a
   Control Connection and zero or more L2TP Sessions".

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.1.1.%20%20Tunnel%20Establishment"></a><a class="selflink" href="#section-5.1.1" name="section-5.1.1">5.1.1</a>.  Tunnel Establishment</span>

   Figure 11 describes the messages exchanged and Attribute Value Pairs
   (AVPs) used to establish a tunnel between an SI (LAC) and an SC
   (LNS).  The messages and AVPs described here are only a subset of
   those defined in [<a href="rfc2661.html" title='"Layer Two Tunneling Protocol "'>RFC2661</a>].  This is because Softwires use only a
   subset of the L2TPv2 functionality.  The subset of L2TP Control
   Connection Management AVPs that is applicable to Softwires is grouped
   into Required AVPs and Optional AVPs on a per-control-message basis
   (see Figure 11).  For each control message, Required AVPs include all
   the "MUST be present" AVPs from [<a href="rfc2661.html" title='"Layer Two Tunneling Protocol "'>RFC2661</a>] for that control message,
   and Optional AVPs include the "MAY be present" AVPs from [<a href="rfc2661.html" title='"Layer Two Tunneling Protocol "'>RFC2661</a>]
   that are used in the Softwire context on that control message.  Note
   that in the Softwire environment, the SI always initiates the tunnel.
   L2TPv2 AVPs SHOULD NOT be hidden.




<span class="grey">Storer, et al.              Standards Track                    [Page 22]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-23" id="page-23" name="page-23"> </a>
<span class="grey"><a href="rfc5571.html">RFC 5571</a>          Softwire H &amp; S Framework with L2TPv2         June 2009</span>


                        SC                       SI
                         |&lt;--------SCCRQ---------|
                          Required AVPs:
                             Message Type
                             Protocol Version
                             Host Name
                             Framing Capabilities
                             Assigned Tunnel ID
                          Optional AVPs:
                             Receive Window Size
                             Challenge
                             Firmware Revision
                             Vendor Name

                         |---------SCCRP--------&gt;|
                          Required AVPs:
                             Message Type
                             Protocol Version
                             Framing Capabilities
                             Host Name
                             Assigned Tunnel ID
                          Optional AVPs:
                             Firmware Revision
                             Vendor Name
                             Receive Window Size
                             Challenge
                             Challenge Response

                         |&lt;--------SCCCN---------|
                          Required AVPs:
                             Message Type
                          Optional AVPs:
                             Challenge Response

                Figure 11: Control Connection Establishment

   In L2TPv2, generally, the tunnel between an LAC and LNS may carry the
   data of multiple users.  Each of these users is represented by an
   L2TPv2 session within the tunnel.  In the Softwire environment, the
   tunnel carries the information of a single user.  Consequently, there
   is only one L2TPv2 session per tunnel.  Figure 12 describes the
   messages exchanged and the AVPs used to establish a session between
   an SI (LAC) and an SC (LNS).  The messages and AVPs described here
   are only a subset of those defined in [<a href="rfc2661.html" title='"Layer Two Tunneling Protocol "'>RFC2661</a>].  This is because
   Softwires use only a subset of the L2TPv2 functionality.  The subset
   of L2TP Call Management (i.e., Session Management) AVPs that is
   applicable to Softwires is grouped into Required AVPs and Optional
   AVPs on a per-control-message basis (see Figure 12).  For each



<span class="grey">Storer, et al.              Standards Track                    [Page 23]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-24" id="page-24" name="page-24"> </a>
<span class="grey"><a href="rfc5571.html">RFC 5571</a>          Softwire H &amp; S Framework with L2TPv2         June 2009</span>


   control message, Required AVPs include all the "MUST be present" AVPs
   from [<a href="rfc2661.html" title='"Layer Two Tunneling Protocol "'>RFC2661</a>] for that control message, and Optional AVPs include
   the "MAY be present" AVPs from [<a href="rfc2661.html" title='"Layer Two Tunneling Protocol "'>RFC2661</a>] that are used in the
   Softwire context on that control message.  Note that in the Softwire
   environment, the SI always initiates the session.  An L2TPv2 session
   setup for a Softwire uses only the incoming call model.  No outgoing
   or analog calls (sessions) are permitted.  L2TPv2 AVPs SHOULD NOT be
   hidden.


                         SC                      SI
                          |&lt;--------ICRQ---------|
                           Required AVPs:
                              Message Type
                              Assigned Session ID
                              Call Serial Number

                          |---------ICRP--------&gt;|
                           Required AVPs:
                              Message Type
                              Assigned Session ID

                          |&lt;--------ICCN---------|
                           Required AVPs:
                              Message Type
                              (Tx) Connect Speed
                              Framing Type

                     Figure 12: Session Establishment

   The following sub-sections (5.1.1.1 through 5.1.1.3) describe in more
   detail the Control Connection and Session establishment AVPs (see
   message flows in Figures 11 and 12, respectively) that are required,
   optional and not relevant for the L2TPv2 Tunnel establishment of a
   Softwire.  Specific L2TPv2 protocol messages and flows that are not
   explicitly described in these sections are handled as defined in
   [<a href="rfc2661.html" title='"Layer Two Tunneling Protocol "'>RFC2661</a>].

   The mechanism for hiding AVP Attribute values is used, as described
   in <a href="rfc2661.html#section-4.3">Section 4.3 of [RFC2661]</a>, to hide sensitive control message data
   such as usernames, user passwords, or IDs, instead of sending the AVP
   contents in the clear.  Since AVPs used in L2TP messages for the
   Softwire establishment do not transport such sensitive data, L2TPv2
   AVPs SHOULD NOT be hidden.







<span class="grey">Storer, et al.              Standards Track                    [Page 24]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-25" id="page-25" name="page-25"> </a>
<span class="grey"><a href="rfc5571.html">RFC 5571</a>          Softwire H &amp; S Framework with L2TPv2         June 2009</span>


<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/5.1.1.1.%20%20AVPs%20Required%20for%20Softwires"></a><a class="selflink" href="#section-5.1.1.1" name="section-5.1.1.1">5.1.1.1</a>.  AVPs Required for Softwires</span>

   This section prescribes specific values for AVPs that are required
   (by [<a href="rfc2661.html" title='"Layer Two Tunneling Protocol "'>RFC2661</a>]) to be present in one or more of the messages used for
   the Softwire establishment, as they are used in the Softwire context.
   It combines all the Required AVPs from all the control messages in
   <a href="#section-5.1.1">Section 5.1.1</a>, and provides Softwire-specific use guidance.

   Host Name AVP

      This AVP is required in SCCRQ and SCCRP messages.  This AVP MAY be
      used to authenticate users, in which case it would contain a user
      identification.  If this AVP is not used to authenticate users, it
      may be used for logging purposes.

   Framing Capabilities AVP

      Both the synchronous (S) and asynchronous (A) bits SHOULD be set
      to 1.  This AVP SHOULD be ignored by the receiver.

   Framing Type AVP

      The synchronous bit SHOULD be set to 1 and the asynchronous bit to
      0.  This AVP SHOULD be ignored by the receiver.

   (Tx) Connect Speed AVP

      (Tx) Connect Speed is a required AVP but is not meaningful in the
      Softwire context.  Its value SHOULD be set to 0 and ignored by the
      receiver.

   Message Type AVP, Protocol Version AVP, Assigned Tunnel ID AVP, Call
   Serial Number AVP, and Assigned Session ID AVP

      As defined in [<a href="rfc2661.html" title='"Layer Two Tunneling Protocol "'>RFC2661</a>].

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/5.1.1.2.%20%20AVPs%20Optional%20for%20Softwires"></a><a class="selflink" href="#section-5.1.1.2" name="section-5.1.1.2">5.1.1.2</a>.  AVPs Optional for Softwires</span>

   This section prescribes specific values for AVPs that are Optional
   (not required by [<a href="rfc2661.html" title='"Layer Two Tunneling Protocol "'>RFC2661</a>]) but used in the Softwire context.  It
   combines all the Optional AVPs from all the control messages in
   <a href="#section-5.1.1">Section 5.1.1</a>, and provides Softwire-specific use guidance.









<span class="grey">Storer, et al.              Standards Track                    [Page 25]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-26" id="page-26" name="page-26"> </a>
<span class="grey"><a href="rfc5571.html">RFC 5571</a>          Softwire H &amp; S Framework with L2TPv2         June 2009</span>


   Challenge AVP and Challenge Response AVP

      These AVPs are not required, but are necessary to implement tunnel
      authentication.  Since tunnel authentication happens at the
      beginning of L2TPv2 tunnel creation, it can be helpful in
      preventing denial-of-service (DoS) attacks.  See <a href="rfc2661.html#section-5.1.1">Section 5.1.1 of
      [RFC2661]</a>.

      The usage of these AVPs in L2TP messages is OPTIONAL, but SHOULD
      be implemented in the SC.

   Receive Window Size AVP, Firmware Revision AVP, and Vendor Name AVP

      As defined in [<a href="rfc2661.html" title='"Layer Two Tunneling Protocol "'>RFC2661</a>].

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/5.1.1.3.%20%20AVPs%20Not%20Relevant%20for%20Softwires"></a><a class="selflink" href="#section-5.1.1.3" name="section-5.1.1.3">5.1.1.3</a>.  AVPs Not Relevant for Softwires</span>

   L2TPv2 specifies numerous AVPs that, while allowed for a given
   message, are irrelevant to Softwires.  They can be irrelevant to
   Softwires because they do not apply to the Softwire establishment
   flow (e.g., they are only used in the Outgoing Call establishment
   message exchange, while Softwires only use the Incoming Call message
   flow), or because they are Optional AVPs that are not used.  L2TPv2
   AVPs that are relevant to Softwires were covered in Sections <a href="#section-5.1.1">5.1.1</a>,
   5.1.1.1, and 5.1.1.2.  Softwire implementations SHOULD NOT send AVPs
   that are not relevant to Softwires.  However, they SHOULD ignore them
   when they are received.  This will simplify the creation of Softwire
   applications that build upon existing L2TPv2 implementations.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.1.2.%20%20Tunnel%20Maintenance"></a><a class="selflink" href="#section-5.1.2" name="section-5.1.2">5.1.2</a>.  Tunnel Maintenance</span>

   Periodically, the SI/SC MUST transmit a message to the peer to detect
   tunnel or peer failure and maintain NAT/NAPT contexts.  The L2TPv2
   HELLO message provides a simple, low-overhead method of doing this.

   The default values specified in [<a href="rfc2661.html" title='"Layer Two Tunneling Protocol "'>RFC2661</a>] for L2TPv2 HELLO messages
   could result in a dead-end detection time of 83 seconds.  Although
   these retransmission timers and counters SHOULD be configurable (see
   <a href="rfc2661.html#section-5.8">Section 5.8 of [RFC2661]</a>), these values may not be adapted for all
   situations, where a quicker dead-end detection is required, or where
   NAT/NAPT context needs to be refreshed more frequently.  In such
   cases, the SI/SC MAY use, in combination with L2TPv2 HELLO, LCP ECHO
   messages (Echo-Request and Echo-Reply codes) described in [<a href="rfc1661.html" title='"The Point-to-Point Protocol (PPP)"'>RFC1661</a>].
   When used, LCP ECHO messages SHOULD have a re-emission timer lower
   than the value for L2TPv2 HELLO messages.  The default value
   recommended in <a href="rfc2661.html#section-6.5">Section 6.5 of [RFC2661]</a> for the HELLO message
   retransmission interval is 60 seconds.  When used, a set of suggested
   values (included here only for guidance) for the LCP ECHO message



<span class="grey">Storer, et al.              Standards Track                    [Page 26]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-27" id="page-27" name="page-27"> </a>
<span class="grey"><a href="rfc5571.html">RFC 5571</a>          Softwire H &amp; S Framework with L2TPv2         June 2009</span>


   request interval is a default of 30 seconds, a minimum of 10 seconds,
   and a maximum of the lesser of the configured L2TPv2 HELLO
   retransmission interval and 60 seconds.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.1.3.%20%20Tunnel%20Teardown"></a><a class="selflink" href="#section-5.1.3" name="section-5.1.3">5.1.3</a>.  Tunnel Teardown</span>

   Either the SI or SC can tear down the session and tunnel.  This is
   done as specified in <a href="rfc2661.html#section-5.7">Section 5.7 of [RFC2661]</a>, by sending a StopCCN
   control message.  There is no action specific to Softwires in this
   case.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.1.4.%20%20Additional%20L2TPv2%20Considerations"></a><a class="selflink" href="#section-5.1.4" name="section-5.1.4">5.1.4</a>.  Additional L2TPv2 Considerations</span>

   In the Softwire "Hub and Spoke" framework, L2TPv2 is layered on top
   of UDP, as part of an IP-in-IP tunnel; <a href="rfc2661.html#section-8.1">Section 8.1 of [RFC2661]</a>
   describes L2TP over UDP/IP.  Therefore, the UDP guidelines specified
   in [<a href="rfc5405.html" title='"Unicast UDP Usage Guidelines for Application Designers"'>RFC5405</a>] apply, as they pertain to the UDP tunneling scenarios
   carrying IP-based traffic.  <a href="rfc5405.html#section-3.1.3">Section 3.1.3 of [RFC5405]</a> specifies that
   for this case, specific congestion control mechanisms for the tunnel
   are not necessary.  Additionally, <a href="rfc5405.html#section-3.2">Section 3.2 of [RFC5405]</a> provides
   message size guidelines for the encapsulating (outer) datagrams,
   including the recommendation to implement Path MTU Discovery (PMTUD).

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.2.%20%20PPP%20Connection"></a><a class="selflink" href="#section-5.2" name="section-5.2">5.2</a>.  PPP Connection</span>

   This section describes the PPP negotiations between the SI and SC in
   the Softwire context.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.2.1.%20%20MTU"></a><a class="selflink" href="#section-5.2.1" name="section-5.2.1">5.2.1</a>.  MTU</span>

   The MTU of the PPP link presented to the SPH SHOULD be the link MTU
   minus the size of the IP, UDP, L2TPv2, and PPP headers together.  On
   an IPv4 link with an MTU equal to 1500 bytes, this could typically
   mean a PPP MTU of 1460 bytes.  When the link is managed by IPsec,
   this MTU SHOULD be lowered to take into account the ESP encapsulation
   (see [<a href="#ref-SW-SEC" title='"Softwire Security Analysis and Requirements"'>SW-SEC</a>]).  The value for the MTU may also vary according to the
   size of the L2TP header, as defined by the leading bits of the L2TP
   message header (see [<a href="rfc2661.html" title='"Layer Two Tunneling Protocol "'>RFC2661</a>]).  Additionally, see [<a href="rfc4623.html" title='"Pseudowire Emulation Edge- to-Edge (PWE3) Fragmentation and Reassembly"'>RFC4623</a>] for a
   detailed discussion of fragmentation issues.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.2.2.%20%20LCP"></a><a class="selflink" href="#section-5.2.2" name="section-5.2.2">5.2.2</a>.  LCP</span>

   Once the L2TPv2 session is established, the SI and SC initiate the
   PPP connection by negotiating LCP as described in [<a href="rfc1661.html" title='"The Point-to-Point Protocol (PPP)"'>RFC1661</a>].  The
   Address-and-Control-Field-Compression configuration option (ACFC)
   [<a href="rfc1661.html" title='"The Point-to-Point Protocol (PPP)"'>RFC1661</a>] MAY be rejected.





<span class="grey">Storer, et al.              Standards Track                    [Page 27]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-28" id="page-28" name="page-28"> </a>
<span class="grey"><a href="rfc5571.html">RFC 5571</a>          Softwire H &amp; S Framework with L2TPv2         June 2009</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.2.3.%20%20Authentication"></a><a class="selflink" href="#section-5.2.3" name="section-5.2.3">5.2.3</a>.  Authentication</span>

   After completing LCP negotiation, the SI and SC MAY optionally
   perform authentication.  If authentication is chosen, Challenge
   Handshake Authentication Protocol (CHAP) [<a href="rfc1994.html" title='"PPP Challenge Handshake Authentication Protocol (CHAP)"'>RFC1994</a>] authentication
   MUST be supported by both the Softwire Initiator and Softwire
   Concentrator.  Other authentication methods such as Microsoft CHAP
   version 1 (MS-CHAPv1) [<a href="rfc2433.html" title='"Microsoft PPP CHAP Extensions"'>RFC2433</a>] and Extensible Authentication
   Protocol (EAP) [<a href="rfc3748.html" title='"Extensible Authentication Protocol (EAP)"'>RFC3748</a>] MAY be supported.

   A detailed discussion of Softwire security is contained in [<a href="#ref-SW-SEC" title='"Softwire Security Analysis and Requirements"'>SW-SEC</a>].

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.2.4.%20%20IPCP"></a><a class="selflink" href="#section-5.2.4" name="section-5.2.4">5.2.4</a>.  IPCP</span>

   The only Network Control Protocol (NCP) negotiated in the Softwire
   context is IPV6CP (see <a href="#section-5.2.4.1">Section 5.2.4.1</a>) for IPv6 as SPH, and IPCP
   (see <a href="#section-5.2.4.2">Section 5.2.4.2</a>) for IPv4 as SPH.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/5.2.4.1.%20%20IPV6CP"></a><a class="selflink" href="#section-5.2.4.1" name="section-5.2.4.1">5.2.4.1</a>.  IPV6CP</span>

   In the IPv6-over-IPv4 scenarios (see <a href="#section-3.1">Section 3.1</a>), after the optional
   authentication phase, the Softwire Initiator MUST negotiate IPV6CP as
   defined in [<a href="rfc5072.html" title='"IP Version 6 over PPP"'>RFC5072</a>].  IPV6CP provides a way to negotiate a unique
   64-bit Interface-Identifier to be used for the address
   autoconfiguration at the local end of the link.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/5.2.4.2.%20%20IPv4CP"></a><a class="selflink" href="#section-5.2.4.2" name="section-5.2.4.2">5.2.4.2</a>.  IPv4CP</span>

   In the IPv4-over-IPv6 scenarios (see <a href="#section-3.2">Section 3.2</a>), a Softwire
   Initiator MUST negotiate IPCP [<a href="rfc1332.html" title='"The PPP Internet Protocol Control Protocol (IPCP)"'>RFC1332</a>].  The SI uses IPCP to obtain
   an IPv4 address from the SC.  IPCP MAY also be used to obtain DNS
   information as described in [<a href="rfc1877.html" title='"PPP Internet Protocol Control Protocol Extensions for Name Server Addresses"'>RFC1877</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.3.%20%20Global%20IPv6%20Address%20Assignment%20to%20Endpoints"></a><a class="selflink" href="#section-5.3" name="section-5.3">5.3</a>.  Global IPv6 Address Assignment to Endpoints</span>

   In several scenarios defined in <a href="#section-3.1">Section 3.1</a>, global IPv6 addresses
   are expected to be allocated to Softwire endpoints (in addition to
   the Link-Local addresses autoconfigured using the IPV6CP negotiated
   interface identifier).  The Softwire Initiator assigns global IPv6
   addresses using the IPV6CP negotiated interface identifier and using
   Stateless Address Autoconfiguration [<a href="rfc4862.html" title='"IPv6 Stateless Address Autoconfiguration"'>RFC4862</a>], and/or using Privacy
   Extensions for Stateless Address Autoconfiguration [<a href="rfc4941.html" title='"Privacy Extensions for Stateless Address Autoconfiguration in IPv6"'>RFC4941</a>], (as
   described in <a href="rfc5072.html#section-5">Section 5 of [RFC5072]</a>), and/or using DHCPv6 [<a href="rfc3315.html" title='"Dynamic Host Configuration Protocol for IPv6 (DHCPv6)"'>RFC3315</a>].








<span class="grey">Storer, et al.              Standards Track                    [Page 28]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-29" id="page-29" name="page-29"> </a>
<span class="grey"><a href="rfc5571.html">RFC 5571</a>          Softwire H &amp; S Framework with L2TPv2         June 2009</span>


   The Softwire Initiator of an IPv6 Softwire MUST send a Router
   Solicitation message to the Softwire Concentrator after IPV6CP is
   completed.  The Softwire Concentrator MUST answer with a Router
   Advertisement.  This message MUST contain the global IPv6 prefix of
   the PPP link if Neighbor Discovery is used to configure addresses of
   Softwire endpoints.

   If DHCPv6 is available for address delegation, the M bits of the
   Router Advertisement SHOULD be set.  The Softwire Initiator MUST then
   send a DHCPv6 Request to configure the address of the Softwire
   endpoint.

   Duplicate Address Detection ([<a href="rfc4861.html" title='"Neighbor Discovery for IP version 6 (IPv6)"'>RFC4861</a>]) MUST be performed on the
   Softwire in both cases.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.4.%20%20DHCP"></a><a class="selflink" href="#section-5.4" name="section-5.4">5.4</a>.  DHCP</span>

   The Softwire Initiator MAY use DHCP to get additional information
   such as delegated prefix and DNS servers.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.4.1.%20%20DHCPv6"></a><a class="selflink" href="#section-5.4.1" name="section-5.4.1">5.4.1</a>.  DHCPv6</span>

   In the scenarios in <a href="#section-3.1">Section 3.1</a>, if the SI supports DHCPv6, it SHOULD
   send a Solicit message to verify if more information is available.

   If an SI establishing an IPv6 Softwire acts as a router (i.e., in the
   scenarios in Sections <a href="#section-3.1.2">3.1.2</a> and <a href="#section-3.1.4">3.1.4</a>) it MUST include the Identity
   Association for Prefix Delegation (IA_PD) option [<a href="rfc3633.html" title='"IPv6 Prefix Options for Dynamic Host Configuration Protocol (DHCP) version 6"'>RFC3633</a>] in the
   DHCPv6 Solicit message [<a href="rfc3315.html" title='"Dynamic Host Configuration Protocol for IPv6 (DHCPv6)"'>RFC3315</a>] in order to request an IPv6 prefix.

   When delegating an IPv6 prefix to the SI by returning a DHCPv6
   Advertise message with the IA_PD and IP_PD Prefix options [<a href="rfc3633.html" title='"IPv6 Prefix Options for Dynamic Host Configuration Protocol (DHCP) version 6"'>RFC3633</a>],
   the SC SHOULD inject a route for this prefix in the IPv6 routing
   table in order to forward the traffic to the relevant Softwire.

   Configuration of DNS MUST be done as specified in [<a href="rfc3646.html" title='"DNS Configuration options for Dynamic Host Configuration Protocol for IPv6 (DHCPv6)"'>RFC3646</a>] and
   transmitted according to [<a href="rfc3315.html" title='"Dynamic Host Configuration Protocol for IPv6 (DHCPv6)"'>RFC3315</a>] and [<a href="rfc3736.html" title='"Stateless Dynamic Host Configuration Protocol (DHCP) Service for IPv6"'>RFC3736</a>].  In general, all
   DHCPv6 options MUST be transmitted according to [<a href="rfc3315.html" title='"Dynamic Host Configuration Protocol for IPv6 (DHCPv6)"'>RFC3315</a>] and
   [<a href="rfc3736.html" title='"Stateless Dynamic Host Configuration Protocol (DHCP) Service for IPv6"'>RFC3736</a>].

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.4.2.%20%20DHCPv4"></a><a class="selflink" href="#section-5.4.2" name="section-5.4.2">5.4.2</a>.  DHCPv4</span>

   An SI establishing an IPv4 Softwire MAY send a DHCP request
   containing the Subnet Allocation option [<a href="#ref-SUBNET-ALL" title='"Subnet Allocation Option"'>SUBNET-ALL</a>].  This practice
   is not common, but it may be used to connect IPv4 subnets using
   Softwires, as defined in Sections <a href="#section-3.2.2">3.2.2</a> and <a href="#section-3.2.4">3.2.4</a>.





<span class="grey">Storer, et al.              Standards Track                    [Page 29]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-30" id="page-30" name="page-30"> </a>
<span class="grey"><a href="rfc5571.html">RFC 5571</a>          Softwire H &amp; S Framework with L2TPv2         June 2009</span>


   One Subnet-Request suboption MUST be configured with the 'h' bit set
   to '1', as the SI is expected to perform the DHCP server function.
   The 'i' bit of the Subnet-Request suboption SHOULD be set to '0' the
   first time a prefix is requested and to '1' on subsequent requests,
   if a prefix has been allocated.  The Prefix length suboption SHOULD
   be 0 by default.  If the SI is configured to support only specific
   prefix lengths, it SHOULD specify the longest (smallest) prefix
   length it supports.

   If the SI was previously assigned a prefix from that same SC, it
   SHOULD include the Subnet-Information suboption with the prefix it
   was previously assigned.  The 'c' and 's' bits of the suboption
   SHOULD be set to '0'.

   In the scenarios in <a href="#section-3.2">Section 3.2</a>, when delegating an IPv4 prefix to
   the SI, the SC SHOULD inject a route for this prefix in the IPv4
   routing table in order to forward the traffic to the relevant
   Softwire.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20Considerations%20about%20the%20Address%20Provisioning%20Model"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  Considerations about the Address Provisioning Model</span>

   This section describes how a Softwire Concentrator may manage
   delegated addresses for Softwire endpoints and for subnets behind the
   Softwire Initiator.  One common practice is to aggregate endpoints'
   addresses and delegated prefixes into one prefix routed to the SC.
   The main benefit is to ease the routing scheme by isolating on the SC
   succeeding route injections (when delegating new prefixes for SI).

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.1.%20%20Softwire%20Endpoints%27%20Addresses"></a><a class="selflink" href="#section-6.1" name="section-6.1">6.1</a>.  Softwire Endpoints' Addresses</span>

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/6.1.1.%20%20IPv6"></a><a class="selflink" href="#section-6.1.1" name="section-6.1.1">6.1.1</a>.  IPv6</span>

   A Softwire Concentrator should provide globally routable addresses to
   Softwire endpoints.  Other types of addresses such as Unique Local
   Addresses (ULAs) [<a href="rfc4193.html" title='"Unique Local IPv6 Unicast Addresses"'>RFC4193</a>] may be used to address Softwire endpoints
   in a private network with no global connectivity.  A single /64
   should be assigned to the Softwire to address both Softwire
   endpoints.

   Global addresses or ULAs must be assigned to endpoints when the
   scenario "Host CPE as Softwire Initiator" (described in
   <a href="#section-3.1.1">Section 3.1.1</a>) is considered to be deployed.  For other scenarios,
   link-local addresses may also be used.








<span class="grey">Storer, et al.              Standards Track                    [Page 30]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-31" id="page-31" name="page-31"> </a>
<span class="grey"><a href="rfc5571.html">RFC 5571</a>          Softwire H &amp; S Framework with L2TPv2         June 2009</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/6.1.2.%20%20IPv4"></a><a class="selflink" href="#section-6.1.2" name="section-6.1.2">6.1.2</a>.  IPv4</span>

   A Softwire Concentrator may provide either globally routable or
   private IPv4 addresses.  When using IPv4 private addresses [<a href="rfc1918.html" title='"Address Allocation for Private Internets"'>RFC1918</a>]
   on the endpoints, it is not recommended to delegate an IPv4 private
   prefix to the SI, as it can lead to a nested-NAT situation.

   The endpoints of the PPP link use host addresses (i.e., /32),
   negotiated using IPCP.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.2.%20%20Delegated%20Prefixes"></a><a class="selflink" href="#section-6.2" name="section-6.2">6.2</a>.  Delegated Prefixes</span>

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/6.2.1.%20%20IPv6%20Prefixes"></a><a class="selflink" href="#section-6.2.1" name="section-6.2.1">6.2.1</a>.  IPv6 Prefixes</span>

   Delegated IPv6 prefixes should be of global scope if the IPv6
   addresses assigned to endpoints are global.  Using ULAs is not
   recommended when the subnet is connected to the global IPv6 Internet.
   When using IPv6 ULAs on the endpoints, the delegated IPv6 prefix may
   be either of global or ULA scope.

   Delegated IPv6 prefixes are between /48 and /64 in length.  When an
   SI receives a prefix shorter than 64, it can assign different /64
   prefixes to each of its interfaces.  An SI receiving a single /64 is
   expected to perform bridging if more than one interface is available
   (e.g., wired and wireless).

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/6.2.2.%20%20IPv4%20Prefixes"></a><a class="selflink" href="#section-6.2.2" name="section-6.2.2">6.2.2</a>.  IPv4 Prefixes</span>

   Delegated IPv4 prefixes should be routable within the address space
   used by assigned IPv4 addresses.  Delegate non-routable IPv4 prefixes
   (i.e., private IPv4 prefix over public IPv4 addresses or another
   class of private IPv4 addresses) is not recommended as a practice for
   provisioning and address translation should be considered in these
   cases.  The prefix length is between /8 and /30.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.3.%20%20Possible%20Address%20Provisioning%20Scenarios"></a><a class="selflink" href="#section-6.3" name="section-6.3">6.3</a>.  Possible Address Provisioning Scenarios</span>

   This section summarizes the different scenarios for address
   provisioning with the considerations given in the previous sections.












<span class="grey">Storer, et al.              Standards Track                    [Page 31]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-32" id="page-32" name="page-32"> </a>
<span class="grey"><a href="rfc5571.html">RFC 5571</a>          Softwire H &amp; S Framework with L2TPv2         June 2009</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/6.3.1.%20%20Scenarios%20for%20IPv6"></a><a class="selflink" href="#section-6.3.1" name="section-6.3.1">6.3.1</a>.  Scenarios for IPv6</span>

   This table describes the possible combination of IPv6 address scope
   for endpoints and delegated prefixes.

   +------------------+-----------------------+------------------------+
   | Endpoint IPv6    | Delegated Global IPv6 | Delegated ULA IPv6     |
   | Address          | Prefix                | Prefix                 |
   +------------------+-----------------------+------------------------+
   | Link Local       | Possible              | Possible               |
   |                  |                       |                        |
   | ULA              | Possible              | Possible               |
   |                  |                       |                        |
   | Global           | Possible              | Possible, but Not      |
   |                  |                       | Recommended            |
   +------------------+-----------------------+------------------------+

                        Table 1: Scenarios for IPv6

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/6.3.2.%20%20Scenarios%20for%20IPv4"></a><a class="selflink" href="#section-6.3.2" name="section-6.3.2">6.3.2</a>.  Scenarios for IPv4</span>

   This table describes the possible combination of IPv4 address scope
   for endpoints and delegated prefixes.

   +-------------+-----------------+-----------------------------------+
   | Endpoint    | Delegated       | Delegated Private IPv4 Prefix     |
   | IPv4        | Public IPv4     |                                   |
   | Address     | Prefix          |                                   |
   +-------------+-----------------+-----------------------------------+
   | Private     | Possible        | Possible, but Not Recommended     |
   | IPv4        |                 | when using NAT (cf.               |
   |             |                 | <a href="#section-6.1.2">Section 6.1.2</a>)                    |
   |             |                 |                                   |
   | Public IPv4 | Possible        | Possible, but NAT usage is        |
   |             |                 | recommended (cf. <a href="#section-6.2.2">Section 6.2.2</a>)   |
   +-------------+-----------------+-----------------------------------+

                        Table 2: Scenarios for IPv4

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20Considerations%20about%20Address%20Stability"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  Considerations about Address Stability</span>

   A Softwire can provide stable addresses even if the underlying
   addressing scheme changes, by opposition to automatic tunneling.  A
   Softwire Concentrator should always provide the same address and
   prefix to a reconnecting user.  However, if the goal of the Softwire
   service is to provide a temporary address for a roaming user, it may
   be provisioned to provide only a temporary address.




<span class="grey">Storer, et al.              Standards Track                    [Page 32]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-33" id="page-33" name="page-33"> </a>
<span class="grey"><a href="rfc5571.html">RFC 5571</a>          Softwire H &amp; S Framework with L2TPv2         June 2009</span>


   The address and prefix are expected to change when reconnecting to a
   different Softwire Concentrator.  However, an organization providing
   a Softwire service may provide the same address and prefix across
   different Softwire Concentrators at the cost of a more fragmented
   routing table.  The routing fragmentation issue may be limited if the
   prefixes are aggregated in a location topologically close to the SC.
   This would be the case, for example, if several SCs are put in
   parallel for load-balancing purpose.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20Considerations%20about%20RADIUS%20Integration"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  Considerations about RADIUS Integration</span>

   The Softwire Concentrator is expected to act as a client to a AAA
   server, for example, a RADIUS server.  During the PPP authentication
   phase, the RADIUS server may return additional information in the
   form of attributes in the Access-Accept message.

   The Softwire Concentrator may include the Tunnel-Type and Tunnel-
   Medium-Type attributes [<a href="rfc2868.html" title='"RADIUS Attributes for Tunnel Protocol Support"'>RFC2868</a>] in the Access-Request messages to
   provide a hint of the type of Softwire being configured.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.1.%20%20Softwire%20Endpoints"></a><a class="selflink" href="#section-8.1" name="section-8.1">8.1</a>.  Softwire Endpoints</span>

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/8.1.1.%20%20IPv6%20Softwires"></a><a class="selflink" href="#section-8.1.1" name="section-8.1.1">8.1.1</a>.  IPv6 Softwires</span>

   If the RADIUS server includes a Framed-Interface-Id attribute
   [<a href="rfc3162.html" title='"RADIUS and IPv6"'>RFC3162</a>], the Softwire Concentrator must send it to the Softwire
   Initiator in the Interface-Identifier field of its IPV6CP
   Configuration Request message.

   If the Framed-IPv6-Prefix attribute [<a href="rfc3162.html" title='"RADIUS and IPv6"'>RFC3162</a>] is included, that
   prefix must be used in the router advertisements sent to the SI.  If
   Framed-IPv6-Prefix is not present but Framed-IPv6-Pool is, the SC
   must choose a prefix from that pool to send RAs.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/8.1.2.%20%20IPv4%20Softwires"></a><a class="selflink" href="#section-8.1.2" name="section-8.1.2">8.1.2</a>.  IPv4 Softwires</span>

   If the Framed-IP-Address attribute [<a href="rfc2865.html" title='"Remote Authentication Dial In User Service (RADIUS)"'>RFC2865</a>] is present, the Softwire
   Concentrator must provide that address to the Softwire Initiator
   during IPCP address negotiation.  That is, when the Softwire
   Initiator requests an IP address from the Softwire Concentrator, the
   address provided should be the Framed-IP-Address.










<span class="grey">Storer, et al.              Standards Track                    [Page 33]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-34" id="page-34" name="page-34"> </a>
<span class="grey"><a href="rfc5571.html">RFC 5571</a>          Softwire H &amp; S Framework with L2TPv2         June 2009</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.2.%20%20Delegated%20Prefixes"></a><a class="selflink" href="#section-8.2" name="section-8.2">8.2</a>.  Delegated Prefixes</span>

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/8.2.1.%20%20IPv6%20Prefixes"></a><a class="selflink" href="#section-8.2.1" name="section-8.2.1">8.2.1</a>.  IPv6 Prefixes</span>

   If the attribute Delegated-IPv6-Prefix [<a href="rfc4818.html" title='"RADIUS Delegated-IPv6-Prefix Attribute"'>RFC4818</a>] is present in the
   RADIUS Access-Accept message, it must be used by the Softwire
   Concentrator for the delegation of the IPv6 prefix.  Since the prefix
   delegation is performed by DHCPv6 and the attribute is linked to a
   username, the SC must associate the DHCP Unique Identifier (DUID) of
   a DHCPv6 request to the tunnel it came from and its user.

   Interaction between RADIUS, PPP, and DHCPv6 server may follow the
   mechanism proposed in [<a href="#ref-RELAY-RAD" title='"DHCPv6 Relay agent RADIUS Attribute Option"'>RELAY-RAD</a>].  In this case, during the Softwire
   authentication phase, PPP collects the RADIUS attributes for the user
   such as Delegated-IPv6-Prefix.  A specific DHCPv6 relay is assigned
   to the Softwire.  The DHCPv6 relay fills in these attributes in the
   Relay agent RADIUS Attribute Option (RRAO) DHCPv6 option, before
   forwarding the DHCPv6 requests to the DHCPv6 server.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/8.2.2.%20%20IPv4%20Prefixes"></a><a class="selflink" href="#section-8.2.2" name="section-8.2.2">8.2.2</a>.  IPv4 Prefixes</span>

   RADIUS does not define an attribute for the delegated IPv4 Prefix.
   Attributes indicating an IPv4 prefix and its length (for instance the
   combination of the Framed-IP-Address and Framed-IP-Netmask attributes
   [<a href="rfc2865.html" title='"Remote Authentication Dial In User Service (RADIUS)"'>RFC2865</a>]) may be used by the Softwire Concentrator to delegate an
   IPv4 prefix to the Softwire Initiator.  The Softwire Concentrator
   must add a corresponding route with the Softwire Initiator as next-
   hop.

   As this practice had been used, the inclusion of the Framed-IP-
   Netmask attribute along with the Framed-IP-Address attribute tells
   the Softwire Concentrator to delegate an IPv4 prefix to the Softwire
   Initiator (e.g., in the IPv4-over-IPv6 scenarios where the Softwire
   Initiator is a router, see Sections <a href="#section-3.2.2">3.2.2</a> and <a href="#section-3.2.4">3.2.4</a>), as the SC
   should forward packets destined to any IPv4 address in the prefix to
   the SI.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/9.%20%20Considerations%20for%20Maintenance%20and%20Statistics"></a><a class="selflink" href="#section-9" name="section-9">9</a>.  Considerations for Maintenance and Statistics</span>

   Existing protocol mechanics for conveying adjunct or accessory
   information for logging purposes, including L2TPv2 and RADIUS
   methods, can include informational text that the behavior is
   according to the Softwire "Hub and Spoke" framework (following the
   implementation details specified in this document).







<span class="grey">Storer, et al.              Standards Track                    [Page 34]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-35" id="page-35" name="page-35"> </a>
<span class="grey"><a href="rfc5571.html">RFC 5571</a>          Softwire H &amp; S Framework with L2TPv2         June 2009</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/9.1.%20%20RADIUS%20Accounting"></a><a class="selflink" href="#section-9.1" name="section-9.1">9.1</a>.  RADIUS Accounting</span>

   RADIUS Accounting for L2TP and PPP are documented (see <a href="#section-4.3">Section 4.3</a>).

   When deploying Softwire solutions, operators may experience
   difficulties to differentiate the address family of the traffic
   reported in accounting information from RADIUS.  This problem and
   some potential solutions are described in [<a href="#ref-SW-ACCT" title='"Accounting on Softwires"'>SW-ACCT</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/9.2.%20%20MIBs"></a><a class="selflink" href="#section-9.2" name="section-9.2">9.2</a>.  MIBs</span>

   MIB support for L2TPv2 and PPP are documented (see <a href="#section-4.4">Section 4.4</a>).
   Also, see [<a href="rfc4293.html" title='"Management Information Base for the Internet Protocol (IP)"'>RFC4293</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/10.%20%20Security%20Considerations"></a><a class="selflink" href="#section-10" name="section-10">10</a>.  Security Considerations</span>

   One design goal of the "Hub and Spoke" problem is to very strongly
   consider the reuse of already deployed protocols (see [<a href="rfc4925.html" title='"Softwire Problem Statement"'>RFC4925</a>]).
   Another design goal is a solution with very high scaling properties.
   L2TPv2 [<a href="rfc2661.html" title='"Layer Two Tunneling Protocol "'>RFC2661</a>] is the phase 1 protocol used in the Softwire "Hub
   and Spoke" solution space, and the L2TPv2 security considerations
   apply to this document (see <a href="rfc2661.html#section-9">Section 9 of [RFC2661]</a>).

   The L2TPv2 Softwire solution adds the following considerations:

   o  L2TP Tunnel Authentication (see Sections <a href="#section-5.1.1">5.1.1</a> and <a href="#section-9.1">9.1</a> of
      [<a href="rfc2661.html" title='"Layer Two Tunneling Protocol "'>RFC2661</a>]) provides authentication at tunnel setup.  It may be
      used to limit DoS attacks by authenticating the tunnel before L2TP
      and PPP resources are allocated.

   o  In a Softwire environment, L2TPv2 AVPs do not transport sensitive
      data, and thus the L2TPv2 AVP hiding mechanism is not used (see
      <a href="#section-5.1.1">Section 5.1.1</a>).

   o  PPP CHAP [<a href="rfc1994.html" title='"PPP Challenge Handshake Authentication Protocol (CHAP)"'>RFC1994</a>] provides basic user authentication.  Other
      authentication protocols may additionally be supported (see
      <a href="#section-5.2.3">Section 5.2.3</a>).

   L2TPv2 can also be secured with IPsec to provide privacy, integrity,
   and replay protection.  Currently, there are two different solutions
   for security L2TPv2 with IPsec:

   o  Securing L2TPv2 using IPsec "version 2" (IKEv1) is specified in
      [<a href="rfc3193.html" title='"Securing L2TP using IPsec"'>RFC3193</a>], [<a href="rfc3947.html" title='"Negotiation of NAT-Traversal in the IKE"'>RFC3947</a>], and [<a href="rfc3948.html" title='"UDP Encapsulation of IPsec ESP Packets"'>RFC3948</a>].  When L2TPv2 is used in the
      Softwire context, the voluntary tunneling model applies.
      [<a href="rfc3193.html" title='"Securing L2TP using IPsec"'>RFC3193</a>] describes the interaction between IPsec and L2TPv2, and





<span class="grey">Storer, et al.              Standards Track                    [Page 35]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-36" id="page-36" name="page-36"> </a>
<span class="grey"><a href="rfc5571.html">RFC 5571</a>          Softwire H &amp; S Framework with L2TPv2         June 2009</span>


      is deployed.  [<a href="rfc3193.html" title='"Securing L2TP using IPsec"'>RFC3193</a>] MUST be supported, given that deployed
      technology must be very strongly considered [<a href="rfc4925.html" title='"Softwire Problem Statement"'>RFC4925</a>] for this
      'time-to-market' solution.

   o  [<a href="#ref-SW-SEC" title='"Softwire Security Analysis and Requirements"'>SW-SEC</a>] also specifies a new (incompatible) solution for securing
      L2TPv2 with IPsec "version 3" (IKEv2).  Section 3.5 of [<a href="#ref-SW-SEC" title='"Softwire Security Analysis and Requirements"'>SW-SEC</a>]
      describes the advantages of using IKEv2, and this solution needs
      to be considered for future phases.

   Additional discussion of Softwire security is contained in [<a href="#ref-SW-SEC" title='"Softwire Security Analysis and Requirements"'>SW-SEC</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/11.%20%20Acknowledgements"></a><a class="selflink" href="#section-11" name="section-11">11</a>.  Acknowledgements</span>

   The authors would like to acknowledge the following contributors who
   provided helpful input on this document: Florent Parent, Jordi Palet
   Martinez, Ole Troan, Shin Miyakawa, Carl Williams, Mark Townsley,
   Francis Dupont, Ralph Droms, Hemant Singh, and Alain Durand.

   The authors would also like to acknowledge the participants in the
   Softwires interim meetings held in Hong Kong, China, and Barcelona,
   Spain.  The minutes for the interim meeting at the China University -
   Hong Kong (February 23-24, 2006) are at
   &lt;<a href="http://www.ietf.org/proceedings/06mar/isoftwire.html">http://www.ietf.org/proceedings/06mar/isoftwire.html</a>&gt;.  The minutes
   for the interim meeting at Polytechnic University of Catalonia -
   Barcelona (September 14-15, 2006) are reachable at
   &lt;<a href="http://www.ietf.org/proceedings/06nov/isoftwire.html">http://www.ietf.org/proceedings/06nov/isoftwire.html</a>&gt;.  The
   Softwires auxiliary page at &lt;<a href="http://bgp.nu/~dward/softwires/">http://bgp.nu/~dward/softwires/</a>&gt;
   contains additional meeting information.

   During and after the IETF Last Call, useful comments and discussion
   were provided by Jari Arkko, David Black, Lars Eggert, Pasi Eronen,
   and Dan Romascanu.



















<span class="grey">Storer, et al.              Standards Track                    [Page 36]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-37" id="page-37" name="page-37"> </a>
<span class="grey"><a href="rfc5571.html">RFC 5571</a>          Softwire H &amp; S Framework with L2TPv2         June 2009</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/12.%20%20References"></a><a class="selflink" href="#section-12" name="section-12">12</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/12.1.%20%20Normative%20References"></a><a class="selflink" href="#section-12.1" name="section-12.1">12.1</a>.  Normative References</span>

   [<a id="ref-RFC1332" name="ref-RFC1332">RFC1332</a>]     McGregor, G., "The PPP Internet Protocol Control
                 Protocol (IPCP)", <a href="rfc1332.html">RFC 1332</a>, May 1992.

   [<a id="ref-RFC1661" name="ref-RFC1661">RFC1661</a>]     Simpson, W., "The Point-to-Point Protocol (PPP)",
                 STD 51, <a href="rfc1661.html">RFC 1661</a>, July 1994.

   [<a id="ref-RFC1918" name="ref-RFC1918">RFC1918</a>]     Rekhter, Y., Moskowitz, R., Karrenberg, D., Groot, G.,
                 and E. Lear, "Address Allocation for Private
                 Internets", <a href="https://tools.ietf.org/html/bcp5">BCP 5</a>, <a href="rfc1918.html">RFC 1918</a>, February 1996.

   [<a id="ref-RFC1994" name="ref-RFC1994">RFC1994</a>]     Simpson, W., "PPP Challenge Handshake Authentication
                 Protocol (CHAP)", <a href="rfc1994.html">RFC 1994</a>, August 1996.

   [<a id="ref-RFC2119" name="ref-RFC2119">RFC2119</a>]     Bradner, S., "Key words for use in RFCs to Indicate
                 Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a id="ref-RFC2661" name="ref-RFC2661">RFC2661</a>]     Townsley, W., Valencia, A., Rubens, A., Pall, G., Zorn,
                 G., and B. Palter, "Layer Two Tunneling Protocol
                 "L2TP"", <a href="rfc2661.html">RFC 2661</a>, August 1999.

   [<a id="ref-RFC2865" name="ref-RFC2865">RFC2865</a>]     Rigney, C., Willens, S., Rubens, A., and W. Simpson,
                 "Remote Authentication Dial In User Service (RADIUS)",
                 <a href="rfc2865.html">RFC 2865</a>, June 2000.

   [<a id="ref-RFC3162" name="ref-RFC3162">RFC3162</a>]     Aboba, B., Zorn, G., and D. Mitton, "RADIUS and IPv6",
                 <a href="rfc3162.html">RFC 3162</a>, August 2001.

   [<a id="ref-RFC3193" name="ref-RFC3193">RFC3193</a>]     Patel, B., Aboba, B., Dixon, W., Zorn, G., and S.
                 Booth, "Securing L2TP using IPsec", <a href="rfc3193.html">RFC 3193</a>,
                 November 2001.

   [<a id="ref-RFC3315" name="ref-RFC3315">RFC3315</a>]     Droms, R., Bound, J., Volz, B., Lemon, T., Perkins, C.,
                 and M. Carney, "Dynamic Host Configuration Protocol for
                 IPv6 (DHCPv6)", <a href="rfc3315.html">RFC 3315</a>, July 2003.

   [<a id="ref-RFC3371" name="ref-RFC3371">RFC3371</a>]     Caves, E., Calhoun, P., and R. Wheeler, "Layer Two
                 Tunneling Protocol "L2TP" Management Information Base",
                 <a href="rfc3371.html">RFC 3371</a>, August 2002.

   [<a id="ref-RFC3633" name="ref-RFC3633">RFC3633</a>]     Troan, O. and R. Droms, "IPv6 Prefix Options for
                 Dynamic Host Configuration Protocol (DHCP) version 6",
                 <a href="rfc3633.html">RFC 3633</a>, December 2003.





<span class="grey">Storer, et al.              Standards Track                    [Page 37]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-38" id="page-38" name="page-38"> </a>
<span class="grey"><a href="rfc5571.html">RFC 5571</a>          Softwire H &amp; S Framework with L2TPv2         June 2009</span>


   [<a id="ref-RFC3736" name="ref-RFC3736">RFC3736</a>]     Droms, R., "Stateless Dynamic Host Configuration
                 Protocol (DHCP) Service for IPv6", <a href="rfc3736.html">RFC 3736</a>,
                 April 2004.

   [<a id="ref-RFC3947" name="ref-RFC3947">RFC3947</a>]     Kivinen, T., Swander, B., Huttunen, A., and V. Volpe,
                 "Negotiation of NAT-Traversal in the IKE", <a href="rfc3947.html">RFC 3947</a>,
                 January 2005.

   [<a id="ref-RFC3948" name="ref-RFC3948">RFC3948</a>]     Huttunen, A., Swander, B., Volpe, V., DiBurro, L., and
                 M. Stenberg, "UDP Encapsulation of IPsec ESP Packets",
                 <a href="rfc3948.html">RFC 3948</a>, January 2005.

   [<a id="ref-RFC4818" name="ref-RFC4818">RFC4818</a>]     Salowey, J. and R. Droms, "RADIUS Delegated-IPv6-Prefix
                 Attribute", <a href="rfc4818.html">RFC 4818</a>, April 2007.

   [<a id="ref-RFC4862" name="ref-RFC4862">RFC4862</a>]     Thomson, S., Narten, T., and T. Jinmei, "IPv6 Stateless
                 Address Autoconfiguration", <a href="rfc4862.html">RFC 4862</a>, September 2007.

   [<a id="ref-RFC5072" name="ref-RFC5072">RFC5072</a>]     S.Varada, Haskins, D., and E. Allen, "IP Version 6 over
                 PPP", <a href="rfc5072.html">RFC 5072</a>, September 2007.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/12.2.%20%20Informative%20References"></a><a class="selflink" href="#section-12.2" name="section-12.2">12.2</a>.  Informative References</span>

   [<a id="ref-RELAY-RAD" name="ref-RELAY-RAD">RELAY-RAD</a>]   Lau, W., <a href="https://www.google.com/search?sitesearch=tools.ietf.org%2Fhtml%2F&amp;q=inurl:draft-+%22DHCPv6+Relay+agent+RADIUS+Attribute+Option%22" style="text-decoration: none">"DHCPv6 Relay agent RADIUS Attribute Option"</a>,
                 Work in Progress, February 2006.

   [<a id="ref-RFC1471" name="ref-RFC1471">RFC1471</a>]     Kastenholz, F., "The Definitions of Managed Objects for
                 the Link Control Protocol of the Point-to-Point
                 Protocol", <a href="rfc1471.html">RFC 1471</a>, June 1993.

   [<a id="ref-RFC1473" name="ref-RFC1473">RFC1473</a>]     Kastenholz, F., "The Definitions of Managed Objects for
                 the IP Network Control Protocol of the Point-to-Point
                 Protocol", <a href="rfc1473.html">RFC 1473</a>, June 1993.

   [<a id="ref-RFC1877" name="ref-RFC1877">RFC1877</a>]     Cobb, S. and F. Baker, "PPP Internet Protocol Control
                 Protocol Extensions for Name Server Addresses",
                 <a href="rfc1877.html">RFC 1877</a>, December 1995.

   [<a id="ref-RFC2131" name="ref-RFC2131">RFC2131</a>]     Droms, R., "Dynamic Host Configuration Protocol",
                 <a href="rfc2131.html">RFC 2131</a>, March 1997.

   [<a id="ref-RFC2132" name="ref-RFC2132">RFC2132</a>]     Alexander, S. and R. Droms, "DHCP Options and BOOTP
                 Vendor Extensions", <a href="rfc2132.html">RFC 2132</a>, March 1997.

   [<a id="ref-RFC2433" name="ref-RFC2433">RFC2433</a>]     Zorn, G. and S. Cobb, "Microsoft PPP CHAP Extensions",
                 <a href="rfc2433.html">RFC 2433</a>, October 1998.





<span class="grey">Storer, et al.              Standards Track                    [Page 38]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-39" id="page-39" name="page-39"> </a>
<span class="grey"><a href="rfc5571.html">RFC 5571</a>          Softwire H &amp; S Framework with L2TPv2         June 2009</span>


   [<a id="ref-RFC2867" name="ref-RFC2867">RFC2867</a>]     Zorn, G., Aboba, B., and D. Mitton, "RADIUS Accounting
                 Modifications for Tunnel Protocol Support", <a href="rfc2867.html">RFC 2867</a>,
                 June 2000.

   [<a id="ref-RFC2868" name="ref-RFC2868">RFC2868</a>]     Zorn, G., Leifer, D., Rubens, A., Shriver, J.,
                 Holdrege, M., and I. Goyret, "RADIUS Attributes for
                 Tunnel Protocol Support", <a href="rfc2868.html">RFC 2868</a>, June 2000.

   [<a id="ref-RFC3022" name="ref-RFC3022">RFC3022</a>]     Srisuresh, P. and K. Egevang, "Traditional IP Network
                 Address Translator (Traditional NAT)", <a href="rfc3022.html">RFC 3022</a>,
                 January 2001.

   [<a id="ref-RFC3575" name="ref-RFC3575">RFC3575</a>]     Aboba, B., "IANA Considerations for RADIUS (Remote
                 Authentication Dial In User Service)", <a href="rfc3575.html">RFC 3575</a>,
                 July 2003.

   [<a id="ref-RFC3646" name="ref-RFC3646">RFC3646</a>]     Droms, R., "DNS Configuration options for Dynamic Host
                 Configuration Protocol for IPv6 (DHCPv6)", <a href="rfc3646.html">RFC 3646</a>,
                 December 2003.

   [<a id="ref-RFC3748" name="ref-RFC3748">RFC3748</a>]     Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and
                 H. Levkowetz, "Extensible Authentication Protocol
                 (EAP)", <a href="rfc3748.html">RFC 3748</a>, June 2004.

   [<a id="ref-RFC3931" name="ref-RFC3931">RFC3931</a>]     Lau, J., Townsley, M., and I. Goyret, "Layer Two
                 Tunneling Protocol - Version 3 (L2TPv3)", <a href="rfc3931.html">RFC 3931</a>,
                 March 2005.

   [<a id="ref-RFC4087" name="ref-RFC4087">RFC4087</a>]     Thaler, D., "IP Tunnel MIB", <a href="rfc4087.html">RFC 4087</a>, June 2005.

   [<a id="ref-RFC4193" name="ref-RFC4193">RFC4193</a>]     Hinden, R. and B. Haberman, "Unique Local IPv6 Unicast
                 Addresses", <a href="rfc4193.html">RFC 4193</a>, October 2005.

   [<a id="ref-RFC4293" name="ref-RFC4293">RFC4293</a>]     Routhier, S., "Management Information Base for the
                 Internet Protocol (IP)", <a href="rfc4293.html">RFC 4293</a>, April 2006.

   [<a id="ref-RFC4623" name="ref-RFC4623">RFC4623</a>]     Malis, A. and M. Townsley, "Pseudowire Emulation Edge-
                 to-Edge (PWE3) Fragmentation and Reassembly", <a href="rfc4623.html">RFC 4623</a>,
                 August 2006.

   [<a id="ref-RFC4787" name="ref-RFC4787">RFC4787</a>]     Audet, F. and C. Jennings, "Network Address Translation
                 (NAT) Behavioral Requirements for Unicast UDP",
                 <a href="https://tools.ietf.org/html/bcp127">BCP 127</a>, <a href="rfc4787.html">RFC 4787</a>, January 2007.

   [<a id="ref-RFC4861" name="ref-RFC4861">RFC4861</a>]     Narten, T., Nordmark, E., Simpson, W., and H. Soliman,
                 "Neighbor Discovery for IP version 6 (IPv6)", <a href="rfc4861.html">RFC 4861</a>,
                 September 2007.




<span class="grey">Storer, et al.              Standards Track                    [Page 39]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-40" id="page-40" name="page-40"> </a>
<span class="grey"><a href="rfc5571.html">RFC 5571</a>          Softwire H &amp; S Framework with L2TPv2         June 2009</span>


   [<a id="ref-RFC4925" name="ref-RFC4925">RFC4925</a>]     Li, X., Dawkins, S., Ward, D., and A. Durand, "Softwire
                 Problem Statement", <a href="rfc4925.html">RFC 4925</a>, July 2007.

   [<a id="ref-RFC4941" name="ref-RFC4941">RFC4941</a>]     Narten, T., Draves, R., and S. Krishnan, "Privacy
                 Extensions for Stateless Address Autoconfiguration in
                 IPv6", <a href="rfc4941.html">RFC 4941</a>, September 2007.

   [<a id="ref-RFC5080" name="ref-RFC5080">RFC5080</a>]     Nelson, D. and A. DeKok, "Common Remote Authentication
                 Dial In User Service (RADIUS) Implementation Issues and
                 Suggested Fixes", <a href="rfc5080.html">RFC 5080</a>, December 2007.

   [<a id="ref-RFC5405" name="ref-RFC5405">RFC5405</a>]     Eggert, L. and G. Fairhurst, "Unicast UDP Usage
                 Guidelines for Application Designers", <a href="https://tools.ietf.org/html/bcp145">BCP 145</a>,
                 <a href="rfc5405.html">RFC 5405</a>, November 2008.

   [<a id="ref-SUBNET-ALL" name="ref-SUBNET-ALL">SUBNET-ALL</a>]  Johnson, R., Kumarasamy, J., Kinnear, K., and M. Stapp,
                 "Subnet Allocation Option", Work in Progress,
                 March 2009.

   [<a id="ref-SW-ACCT" name="ref-SW-ACCT">SW-ACCT</a>]     Stevant, B., Toutain, L., Dupont, F., and D. Binet,
                 "Accounting on Softwires", Work in Progress,
                 April 2009.

   [<a id="ref-SW-SEC" name="ref-SW-SEC">SW-SEC</a>]      Yamamoto, S., Williams, C., Parent, F., and H. Yokota,
                 "Softwire Security Analysis and Requirements", Work
                 in Progress, May 2009.

Authors' Addresses

   Bill Storer
   Cisco Systems
   170 W Tasman Dr
   San Jose, CA  95134
   USA

   EMail: bstorer@cisco.com


   Carlos Pignataro (editor)
   Cisco Systems
   7200 Kit Creek Road
   PO Box 14987
   Research Triangle Park, NC  27709
   USA

   EMail: cpignata@cisco.com





<span class="grey">Storer, et al.              Standards Track                    [Page 40]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-41" id="page-41" name="page-41"> </a>
<span class="grey"><a href="rfc5571.html">RFC 5571</a>          Softwire H &amp; S Framework with L2TPv2         June 2009</span>


   Maria Alice Dos Santos
   Cisco Systems
   170 W Tasman Dr
   San Jose, CA  95134
   USA

   EMail: mariados@cisco.com


   Bruno Stevant (editor)
   TELECOM Bretagne
   2 rue de la Chataigneraie CS17607
   Cesson Sevigne,   35576
   France

   EMail: bruno.stevant@telecom-bretagne.eu


   Laurent Toutain
   TELECOM Bretagne
   2 rue de la Chataigneraie CS17607
   Cesson Sevigne,   35576
   France

   EMail: laurent.toutain@telecom-bretagne.eu


   Jean-Francois Tremblay
   Videotron Ltd.
   612 Saint-Jacques
   Montreal, QC  H3C 4M8
   Canada

   EMail: jf@jftremblay.com

















Storer, et al.              Standards Track                    [Page 41]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc5571 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:34 GMT --></html>