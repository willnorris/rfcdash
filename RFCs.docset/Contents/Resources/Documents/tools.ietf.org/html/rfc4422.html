<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc4422 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:41 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="rfc2222" name="DC.Relation.Replaces"/>
<meta content="urn:ietf:rfc:4422" name="DC.Identifier"/>
<meta content="June, 2006" name="DC.Date.Issued"/>
<meta content="Zeilenga, Kurt D." name="DC.Creator"/>
<meta content="Melnikov, Alexey" name="DC.Creator"/>
<meta content="The Simple Authentication and Security Layer (SASL) is a framework for
providing authentication and data security services in connection-
oriented protocols via replaceable mechanisms. It provides a
structured interface between protocols and mechanisms. The resulting
framework allows new protocols to reuse existing mechanisms and allows
old protocols to make use of new mechanisms. The framework also
provides a protocol for securing subsequent protocol exchanges within
a data security layer.  This document describes how a SASL mechanism
is structured, describes how protocols include support for SASL, and
defines the protocol for carrying a data security layer over a
connection. In addition, this document defines one SASL mechanism, the
EXTERNAL mechanism.  This document obsoletes RFC 2222. [STANDARDS-
TRACK]" name="DC.Description.Abstract"/>
<meta content="Simple Authentication and Security Layer (SASL)" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 4422 - Simple Authentication and Security Layer (SASL)</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgblue" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc4422.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc4422" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-sasl-rfc2222bis" title="draft-ietf-sasl-rfc2222bis">draft-ietf-sasl...</a>] [<a href="https://datatracker.ietf.org/doc/rfc4422" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc4422" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc4422" title="Side-by-side diff">Diff2</a>]         </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                       PROPOSED STANDARD</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Network Working Group                                   A. Melnikov, Ed.
Request for Comments: 4422                                 Isode Limited
Obsoletes: <a href="rfc2222.html">2222</a>                                         K. Zeilenga, Ed.
Category: Standards Track                            OpenLDAP Foundation
                                                               June 2006


            <span class="h1">Simple Authentication and Security Layer (SASL)</span>

Status of This Memo

   This document specifies an Internet standards track protocol for the
   Internet community, and requests discussion and suggestions for
   improvements.  Please refer to the current edition of the "Internet
   Official Protocol Standards" (STD 1) for the standardization state
   and status of this protocol.  Distribution of this memo is unlimited.

Copyright Notice

   Copyright (C) The Internet Society (2006).

Abstract

   The Simple Authentication and Security Layer (SASL) is a framework
   for providing authentication and data security services in
   connection-oriented protocols via replaceable mechanisms.  It
   provides a structured interface between protocols and mechanisms.
   The resulting framework allows new protocols to reuse existing
   mechanisms and allows old protocols to make use of new mechanisms.
   The framework also provides a protocol for securing subsequent
   protocol exchanges within a data security layer.

   This document describes how a SASL mechanism is structured, describes
   how protocols include support for SASL, and defines the protocol for
   carrying a data security layer over a connection.  In addition, this
   document defines one SASL mechanism, the EXTERNAL mechanism.

   This document obsoletes <a href="rfc2222.html">RFC 2222</a>.













<span class="grey">Melnikov &amp; Zeilenga         Standards Track                     [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc4422.html">RFC 4422</a>                          SASL                         June 2006</span>


Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-3">3</a>
      <a href="#section-1.1">1.1</a>. Document Audiences .........................................<a href="#page-4">4</a>
      <a href="#section-1.2">1.2</a>. Relationship to Other Documents ............................<a href="#page-4">4</a>
      <a href="#section-1.3">1.3</a>. Conventions ................................................<a href="#page-5">5</a>
   <a href="#section-2">2</a>. Identity Concepts ...............................................<a href="#page-5">5</a>
   <a href="#section-3">3</a>. The Authentication Exchange .....................................<a href="#page-6">6</a>
      <a href="#section-3.1">3.1</a>. Mechanism Naming ...........................................<a href="#page-8">8</a>
      <a href="#section-3.2">3.2</a>. Mechanism Negotiation ......................................<a href="#page-9">9</a>
      <a href="#section-3.3">3.3</a>. Request Authentication Exchange ............................<a href="#page-9">9</a>
      <a href="#section-3.4">3.4</a>. Challenges and Responses ...................................<a href="#page-9">9</a>
           <a href="#section-3.4.1">3.4.1</a>. Authorization Identity String ......................<a href="#page-10">10</a>
      <a href="#section-3.5">3.5</a>. Aborting Authentication Exchanges .........................<a href="#page-10">10</a>
      <a href="#section-3.6">3.6</a>. Authentication Outcome ....................................<a href="#page-11">11</a>
      <a href="#section-3.7">3.7</a>. Security Layers ...........................................<a href="#page-12">12</a>
      <a href="#section-3.8">3.8</a>. Multiple Authentications ..................................<a href="#page-12">12</a>
   <a href="#section-4">4</a>. Protocol Requirements ..........................................<a href="#page-13">13</a>
   <a href="#section-5">5</a>. Mechanism Requirements .........................................<a href="#page-16">16</a>
   <a href="#section-6">6</a>. Security Considerations ........................................<a href="#page-18">18</a>
      <a href="#section-6.1">6.1</a>. Active Attacks ............................................<a href="#page-19">19</a>
           <a href="#section-6.1.1">6.1.1</a>. Hijack Attacks .....................................<a href="#page-19">19</a>
           <a href="#section-6.1.2">6.1.2</a>. Downgrade Attacks ..................................<a href="#page-19">19</a>
           <a href="#section-6.1.3">6.1.3</a>. Replay Attacks .....................................<a href="#page-20">20</a>
           <a href="#section-6.1.4">6.1.4</a>. Truncation Attacks .................................<a href="#page-20">20</a>
           <a href="#section-6.1.5">6.1.5</a>. Other Active Attacks ...............................<a href="#page-20">20</a>
      <a href="#section-6.2">6.2</a>. Passive Attacks ...........................................<a href="#page-20">20</a>
      <a href="#section-6.3">6.3</a>. Re-keying .................................................<a href="#page-21">21</a>
      <a href="#section-6.4">6.4</a>. Other Considerations ......................................<a href="#page-21">21</a>
   <a href="#section-7">7</a>. IANA Considerations ............................................<a href="#page-22">22</a>
      <a href="#section-7.1">7.1</a>. SASL Mechanism Registry ...................................<a href="#page-22">22</a>
      <a href="#section-7.2">7.2</a>. Registration Changes ......................................<a href="#page-26">26</a>
   <a href="#section-8">8</a>. References .....................................................<a href="#page-26">26</a>
      <a href="#section-8.1">8.1</a>. Normative References ......................................<a href="#page-26">26</a>
      <a href="#section-8.2">8.2</a>. Informative References ....................................<a href="#page-27">27</a>
   <a href="#section-9">9</a>. Acknowledgements ...............................................<a href="#page-28">28</a>
   <a href="#appendix-A">Appendix A</a>.  The SASL EXTERNAL Mechanism ..........................<a href="#page-29">29</a>
      <a href="#appendix-A.1">A.1</a>. EXTERNAL Technical Specification ..........................<a href="#page-29">29</a>
      <a href="#appendix-A.2">A.2</a>. SASL EXTERNAL Examples ....................................<a href="#page-30">30</a>
      <a href="#appendix-A.3">A.3</a>. Security Considerations ...................................<a href="#page-31">31</a>
   <a href="#appendix-B">Appendix B</a>.  Changes since <a href="rfc2222.html">RFC 2222</a> ...............................<a href="#page-31">31</a>










<span class="grey">Melnikov &amp; Zeilenga         Standards Track                     [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc4422.html">RFC 4422</a>                          SASL                         June 2006</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   The Simple Authentication and Security Layer (SASL) is a framework
   for providing authentication and data security services in
   connection-oriented protocols via replaceable mechanisms.  SASL
   provides a structured interface between protocols and mechanisms.
   SASL also provides a protocol for securing subsequent protocol
   exchanges within a data security layer.  The data security layer can
   provide data integrity, data confidentiality, and other services.

   SASL's design is intended to allow new protocols to reuse existing
   mechanisms without requiring redesign of the mechanisms and allows
   existing protocols to make use of new mechanisms without redesign of
   protocols.

   SASL is conceptually a framework that provides an abstraction layer
   between protocols and mechanisms as illustrated in the following
   diagram.

                  SMTP    LDAP    XMPP   Other protocols ...
                     \       |    |      /
                      \      |    |     /
                     SASL abstraction layer
                      /      |    |     \
                     /       |    |      \
              EXTERNAL   GSSAPI  PLAIN   Other mechanisms ...

   It is through the interfaces of this abstraction layer that the
   framework allows any protocol to utilize any mechanism.  While this
   layer does generally hide the particulars of protocols from
   mechanisms and the particulars of mechanisms from protocols, this
   layer does not generally hide the particulars of mechanisms from
   protocol implementations.  For example, different mechanisms require
   different information to operate, some of them use password-based
   authentication, some of then require realm information, others make
   use of Kerberos tickets, certificates, etc.  Also, in order to
   perform authorization, server implementations generally have to
   implement identity mapping between authentication identities, whose
   form is mechanism specific, and authorization identities, whose form
   is application protocol specific.  <a href="#section-2">Section 2</a> discusses identity
   concepts.

   It is possible to design and implement this framework in ways that do
   abstract away particulars of similar mechanisms.  Such a framework
   implementation, as well as mechanisms implementations, could be
   designed not only to be shared by multiple implementations of a
   particular protocol but to be shared by implementations of multiple
   protocols.



<span class="grey">Melnikov &amp; Zeilenga         Standards Track                     [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc4422.html">RFC 4422</a>                          SASL                         June 2006</span>


   The framework incorporates interfaces with both protocols and
   mechanisms in which authentication exchanges are carried out.
   <a href="#section-3">Section 3</a> discusses SASL authentication exchanges.

   To use SASL, each protocol (amongst other items) provides a method
   for identifying which mechanism is to be used, a method for exchange
   of mechanism-specific server-challenges and client-responses, and a
   method for communicating the outcome of the authentication exchange.
   <a href="#section-4">Section 4</a> discusses SASL protocol requirements.

   Each SASL mechanism defines (amongst other items) a series of
   server-challenges and client-responses that provide authentication
   services and negotiate data security services.  <a href="#section-5">Section 5</a> discusses
   SASL mechanism requirements.

   <a href="#section-6">Section 6</a> discusses security considerations.  <a href="#section-7">Section 7</a> discusses
   IANA considerations.  <a href="#appendix-A">Appendix A</a> defines the SASL EXTERNAL mechanism.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.1.%20%20Document%20Audiences"></a><a class="selflink" href="#section-1.1" name="section-1.1">1.1</a>.  Document Audiences</span>

   This document is written to serve several different audiences:

      -  protocol designers using this specification to support
         authentication in their protocol,

      -  mechanism designers that define new SASL mechanisms, and

      -  implementors of clients or servers for those protocols that
         support SASL.

   While the document organization is intended to allow readers to focus
   on details relevant to their engineering, readers are encouraged to
   read and understand all aspects of this document.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.2.%20%20Relationship%20to%20Other%20Documents"></a><a class="selflink" href="#section-1.2" name="section-1.2">1.2</a>.  Relationship to Other Documents</span>

   This document obsoletes <a href="rfc2222.html">RFC 2222</a>.  It replaces all portions of <a href="rfc2222.html">RFC</a>
   <a href="rfc2222.html">2222</a> excepting sections <a href="#section-7.1">7.1</a> (the KERBEROS_IV mechanism), 7.2 (the
   GSSAPI mechanism), 7.3 (the SKEY mechanism).  The KERBEROS_IV and
   SKEY mechanisms are now viewed as obsolete and their specifications
   provided in <a href="rfc2222.html">RFC 2222</a> are Historic.  The GSSAPI mechanism is now
   separately specified [<a href="#ref-SASL-GSSAPI" title='"The Kerberos V5 ("'>SASL-GSSAPI</a>].

   <a href="#appendix-B">Appendix B</a> provides a summary of changes since <a href="rfc2222.html">RFC 2222</a>.







<span class="grey">Melnikov &amp; Zeilenga         Standards Track                     [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc4422.html">RFC 4422</a>                          SASL                         June 2006</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.3.%20%20Conventions"></a><a class="selflink" href="#section-1.3" name="section-1.3">1.3</a>.  Conventions</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in <a href="https://tools.ietf.org/html/bcp14">BCP 14</a> [<a href="rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].

   Character names in this document use the notation for code points and
   names from the Unicode Standard [<a href="#ref-Unicode" title='"The Unicode Standard, Version 3.2.0"'>Unicode</a>].  For example, the letter
   "a" may be represented as either &lt;U+0061&gt; or &lt;LATIN SMALL LETTER A&gt;.

   Note: a glossary of terms used in Unicode can be found in [<a href="#ref-Glossary" title='"Unicode Glossary"'>Glossary</a>].
   Information on the Unicode character encoding model can be found in
   [<a href="#ref-CharModel" title='"Unicode Technical Report #17, Character Encoding Model"'>CharModel</a>].

   In examples, "C:" and "S:" indicate lines of data to be sent by the
   client and server, respectively.  Lines have been wrapped for
   improved readability.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Identity%20Concepts"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Identity Concepts</span>

   In practice, authentication and authorization may involve multiple
   identities, possibly in different forms (simple username, Kerberos
   principal, X.500 Distinguished Name, etc.), possibly with different
   representations (e.g., ABNF-described UTF-8 encoded Unicode character
   string, BER-encoded Distinguished Name).  While technical
   specifications often prescribe both the identity form and
   representation used on the network, different identity forms and/or
   representations may be (and often are) used within implementations.
   How identities of different forms relate to each other is, generally,
   a local matter.  In addition, the forms and representations used
   within an implementation are a local matter.

   However, conceptually, the SASL framework involves two identities:

      1) an identity associated with the authentication credentials
         (termed the authentication identity), and

      2) an identity to act as (termed the authorization identity).

   SASL mechanism specifications describe the credential form(s) (e.g.,
   X.509 certificates, Kerberos tickets, simple username/password) used
   to authenticate the client, including (where appropriate) the syntax
   and semantics of authentication identities carried in the
   credentials.  SASL protocol specifications describe the identity
   form(s) used in authorization and, in particular, prescribe the
   syntax and semantics of the authorization identity character string
   to be transferred by mechanisms.




<span class="grey">Melnikov &amp; Zeilenga         Standards Track                     [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc4422.html">RFC 4422</a>                          SASL                         June 2006</span>


   The client provides its credentials (which include or imply an
   authentication identity) and, optionally, a character string
   representing the requested authorization identity as part of the SASL
   exchange.  When this character string is omitted or empty, the client
   is requesting to act as the identity associated with the credentials
   (e.g., the user is requesting to act as the authentication identity).

   The server is responsible for verifying the client's credentials and
   verifying that the identity it associates with the client's
   credentials (e.g., the authentication identity) is allowed to act as
   the authorization identity.  A SASL exchange fails if either (or
   both) of these verifications fails.  (The SASL exchange may fail for
   other reasons, such as service authorization failure.)

   However, the precise form(s) of the authentication identities (used
   within the server in its verifications, or otherwise) and the precise
   form(s) of the authorization identities (used in making authorization
   decisions, or otherwise) are beyond the scope of SASL and this
   specification.  In some circumstances, the precise identity forms
   used in some context outside of the SASL exchange may be dictated by
   other specifications.  For instance, an identity assumption
   authorization (proxy authorization) policy specification may dictate
   how authentication and authorization identities are represented in
   policy statements.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20The%20Authentication%20Exchange"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  The Authentication Exchange</span>

   Each authentication exchange consists of a message from the client to
   the server requesting authentication via a particular mechanism,
   followed by one or more pairs of challenges from the server and
   responses from the client, followed by a message from the server
   indicating the outcome of the authentication exchange.  (Note:
   exchanges may also be aborted as discussed in <a href="#section-3.5">Section 3.5</a>.)

   The following illustration provides a high-level overview of an
   authentication exchange.

      C: Request authentication exchange
      S: Initial challenge
      C: Initial response
      &lt;additional challenge/response messages&gt;
      S: Outcome of authentication exchange

   If the outcome is successful and a security layer was negotiated,
   this layer is then installed (see <a href="#section-3.7">Section 3.7</a>).  This also applies to
   the following illustrations.





<span class="grey">Melnikov &amp; Zeilenga         Standards Track                     [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc4422.html">RFC 4422</a>                          SASL                         June 2006</span>


   Some mechanisms specify that the first data sent in the
   authentication exchange is from the client to the server.  Protocols
   may provide an optional initial response field in the request message
   to carry this data.  Where the mechanism specifies that the first
   data sent in the exchange is from the client to the server, the
   protocol provides an optional initial response field, and the client
   uses this field, the exchange is shortened by one round-trip:

      C: Request authentication exchange + Initial response
      &lt;additional challenge/response messages&gt;
      S: Outcome of authentication exchange

   Where the mechanism specifies that the first data sent in the
   exchange is from the client to the server and this field is
   unavailable or unused, the client request is followed by an empty
   challenge.

      C: Request authentication exchange
      S: Empty Challenge
      C: Initial Response
      &lt;additional challenge/response messages&gt;
      S: Outcome of authentication exchange

   Should a client include an initial response in its request where the
   mechanism does not allow the client to send data first, the
   authentication exchange fails.

   Some mechanisms specify that the server is to send additional data to
   the client when indicating a successful outcome.  Protocols may
   provide an optional additional data field in the outcome message to
   carry this data.  Where the mechanism specifies that the server is to
   return additional data with the successful outcome, the protocol
   provides an optional additional data field in the outcome message,
   and the server uses this field, the exchange is shortened by one
   round-trip:

      C: Request authentication exchange
      S: Initial challenge
      C: Initial response
      &lt;additional challenge/response messages&gt;
      S: Outcome of authentication exchange with
         additional data with success

   Where the mechanism specifies that the server is to return additional
   data to the client with a successful outcome and this field is
   unavailable or unused, the additional data is sent as a challenge
   whose response is empty.  After receiving this response, the server
   then indicates the successful outcome.



<span class="grey">Melnikov &amp; Zeilenga         Standards Track                     [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc4422.html">RFC 4422</a>                          SASL                         June 2006</span>


      C: Request authentication exchange
      S: Initial challenge
      C: Initial response
      &lt;additional challenge/response messages&gt;
      S: Additional data challenge
      C: Empty Response
      S: Outcome of authentication exchange

   Where mechanisms specify that the first data sent in the exchange is
   from the client to the server and additional data is sent to the
   client along with indicating a successful outcome, and the protocol
   provides fields supporting both, then the exchange takes two fewer
   round-trips:

      C: Request authentication exchange + Initial response
      &lt;additional challenge/response messages&gt;
      S: Outcome of authentication exchange
         with additional data with success

   instead of:

      C: Request authentication exchange
      S: Empty Challenge
      C: Initial Response
      &lt;additional challenge/response messages&gt;
      S: Additional data challenge
      C: Empty Response
      S: Outcome of authentication exchange

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.1.%20%20Mechanism%20Naming"></a><a class="selflink" href="#section-3.1" name="section-3.1">3.1</a>.  Mechanism Naming</span>

   SASL mechanisms are named by character strings, from 1 to 20
   characters in length, consisting of ASCII [<a href="#ref-ASCII">ASCII</a>] uppercase letters,
   digits, hyphens, and/or underscores.  In the following Augmented
   Backus-Naur Form (ABNF) [<a href="rfc4234.html" title='"Augmented BNF for Syntax Specifications: ABNF"'>RFC4234</a>] grammar, the &lt;sasl-mech&gt; production
   defines the syntax of a SASL mechanism name.

      sasl-mech    = 1*20mech-char
      mech-char    = UPPER-ALPHA / DIGIT / HYPHEN / UNDERSCORE
      ; mech-char is restricted to A-Z (uppercase only), 0-9, -, and _
      ; from ASCII character set.

      UPPER-ALPHA  = %x41-5A  ; A-Z (uppercase only)
      DIGIT        = %x30-39  ; 0-9
      HYPHEN       = %x2D ; hyphen (-)
      UNDERSCORE   = %x5F ; underscore (_)

   SASL mechanism names are registered as discussed in <a href="#section-7.1">Section 7.1</a>.



<span class="grey">Melnikov &amp; Zeilenga         Standards Track                     [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc4422.html">RFC 4422</a>                          SASL                         June 2006</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.2.%20%20Mechanism%20Negotiation"></a><a class="selflink" href="#section-3.2" name="section-3.2">3.2</a>.  Mechanism Negotiation</span>

   Mechanism negotiation is protocol specific.

   Commonly, a protocol will specify that the server advertises
   supported and available mechanisms to the client via some facility
   provided by the protocol, and the client will then select the "best"
   mechanism from this list that it supports and finds suitable.

   Note that the mechanism negotiation is not protected by the
   subsequent authentication exchange and hence is subject to downgrade
   attacks if not protected by other means.

   To detect downgrade attacks, a protocol can allow the client to
   discover available mechanisms subsequent to the authentication
   exchange and installation of data security layers with at least data
   integrity protection.  This allows the client to detect changes to
   the list of mechanisms supported by the server.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.3.%20%20Request%20Authentication%20Exchange"></a><a class="selflink" href="#section-3.3" name="section-3.3">3.3</a>.  Request Authentication Exchange</span>

   The authentication exchange is initiated by the client by requesting
   authentication via a mechanism it specifies.  The client sends a
   message that contains the name of the mechanism to the server.  The
   particulars of the message are protocol specific.

   Note that the name of the mechanism is not protected by the
   mechanism, and hence is subject to alteration by an attacker if not
   integrity protected by other means.

   Where the mechanism is defined to allow the client to send data
   first, and the protocol's request message includes an optional
   initial response field, the client may include the response to the
   initial challenge in the authentication request message.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.4.%20%20Challenges%20and%20Responses"></a><a class="selflink" href="#section-3.4" name="section-3.4">3.4</a>.  Challenges and Responses</span>

   The authentication exchange involves one or more pairs of server-
   challenges and client-responses, the particulars of which are
   mechanism specific.  These challenges and responses are enclosed in
   protocol messages, the particulars of which are protocol specific.

   Through these challenges and responses, the mechanism may:

      -  authenticate the client to the server,

      -  authenticate the server to the client,




<span class="grey">Melnikov &amp; Zeilenga         Standards Track                     [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc4422.html">RFC 4422</a>                          SASL                         June 2006</span>


      -  transfer an authorization identity string,

      -  negotiate a security layer, and

      -  provide other services.

   The negotiation of the security layer may involve negotiation of the
   security services to be provided in the layer, how these services
   will be provided, and negotiation of a maximum cipher-text buffer
   size each side is able to receive in the layer (see <a href="#section-3.6">Section 3.6</a>).

   After receiving an authentication request or any client response, the
   server may issue a challenge, abort the exchange, or indicate the
   outcome of an exchange.  After receiving a challenge, a client
   mechanism may issue a response or abort the exchange.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.4.1.%20%20Authorization%20Identity%20String"></a><a class="selflink" href="#section-3.4.1" name="section-3.4.1">3.4.1</a>.  Authorization Identity String</span>

   The authorization identity string is a sequence of zero or more
   Unicode [<a href="#ref-Unicode" title='"The Unicode Standard, Version 3.2.0"'>Unicode</a>] characters, excluding the NUL (U+0000) character,
   representing the identity to act as.

   If the authorization identity string is absent, the client is
   requesting to act as the identity the server associates with the
   client's credentials.  An empty string is equivalent to an absent
   authorization identity.

   A non-empty authorization identity string indicates that the client
   wishes to act as the identity represented by the string.  In this
   case, the form of identity represented by the string, as well as the
   precise syntax and semantics of the string, is protocol specific.

   While the character encoding schema used to transfer the
   authorization identity string in the authentication exchange is
   mechanism specific, mechanisms are expected to be capable of carrying
   the entire Unicode repertoire (with the exception of the NUL
   character).

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.5.%20%20Aborting%20Authentication%20Exchanges"></a><a class="selflink" href="#section-3.5" name="section-3.5">3.5</a>.  Aborting Authentication Exchanges</span>

   A client or server may desire to abort an authentication exchange if
   it is unwilling or unable to continue (or enter into).

   A client may abort the authentication exchange by sending a message,
   the particulars of which are protocol specific, to the server,
   indicating that the exchange is aborted.  The server may be required
   by the protocol to return a message in response to the client's abort
   message.



<span class="grey">Melnikov &amp; Zeilenga         Standards Track                    [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc4422.html">RFC 4422</a>                          SASL                         June 2006</span>


   Likewise, a server may abort the authentication exchange by sending a
   message, the particulars of which are protocol specific, to the
   client, indicating that the exchange is aborted.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.6.%20%20Authentication%20Outcome"></a><a class="selflink" href="#section-3.6" name="section-3.6">3.6</a>.  Authentication Outcome</span>

   At the conclusion of the authentication exchange, the server sends a
   message, the particulars of which are protocol specific, to the
   client indicating the outcome of the exchange.

   The outcome is not successful if

      -  the authentication exchange failed for any reason,

      -  the client's credentials could not be verified,

      -  the server cannot associate an identity with the client's
         credentials,

      -  the client-provided authorization identity string is malformed,

      -  the identity associated with the client's credentials is not
         authorized to act as the requested authorization identity,

      -  the negotiated security layer (or lack thereof) is not
         suitable, or

      -  the server is not willing to provide service to the client for
         any reason.

   The protocol may include an optional additional data field in this
   outcome message.  This field can only include additional data when
   the outcome is successful.

   If the outcome is successful and a security layer was negotiated,
   this layer is then installed.  If the outcome is unsuccessful, or a
   security layer was not negotiated, any existing security is left in
   place.

   The outcome message provided by the server can provide a way for the
   client to distinguish between errors that are best dealt with by re-
   prompting the user for her credentials, errors that are best dealt
   with by telling the user to try again later, and errors where the
   user must contact a system administrator for resolution (see the SYS
   and AUTH POP Response Codes [<a href="rfc3206.html" title='"The SYS and AUTH POP Response Codes"'>RFC3206</a>] specification for an example).
   This distinction is particularly useful during scheduled server
   maintenance periods as it reduces support costs.  It is also
   important that the server can be configured such that the outcome



<span class="grey">Melnikov &amp; Zeilenga         Standards Track                    [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc4422.html">RFC 4422</a>                          SASL                         June 2006</span>


   message will not distinguish between a valid user with invalid
   credentials and an invalid user.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.7.%20%20Security%20Layers"></a><a class="selflink" href="#section-3.7" name="section-3.7">3.7</a>.  Security Layers</span>

   SASL mechanisms may offer a wide range of services in security
   layers.  Typical services include data integrity and data
   confidentiality.  SASL mechanisms that do not provide a security
   layer are treated as negotiating no security layer.

   If use of a security layer is negotiated in the authentication
   protocol exchange, the layer is installed by the server after
   indicating the outcome of the authentication exchange and installed
   by the client upon receipt of the outcome indication.  In both cases,
   the layer is installed before transfer of further protocol data.  The
   precise position upon which the layer takes effect in the protocol
   data stream is protocol specific.

   Once the security layer is in effect in the protocol data stream, it
   remains in effect until either a subsequently negotiated security
   layer is installed or the underlying transport connection is closed.

   When in effect, the security layer processes protocol data into
   buffers of protected data.  If at any time the security layer is
   unable or unwilling to continue producing buffers protecting protocol
   data, the underlying transport connection MUST be closed.  If the
   security layer is not able to decode a received buffer, the
   underlying connection MUST be closed.  In both cases, the underlying
   transport connection SHOULD be closed gracefully.

   Each buffer of protected data is transferred over the underlying
   transport connection as a sequence of octets prepended with a four-
   octet field in network byte order that represents the length of the
   buffer.  The length of the protected data buffer MUST be no larger
   than the maximum size that the other side expects.  Upon the receipt
   of a length field whose value is greater than the maximum size, the
   receiver SHOULD close the connection, as this might be a sign of an
   attack.

   The maximum size that each side expects is fixed by the mechanism,
   either through negotiation or by its specification.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.8.%20%20Multiple%20Authentications"></a><a class="selflink" href="#section-3.8" name="section-3.8">3.8</a>.  Multiple Authentications</span>

   Unless explicitly permitted in the protocol (as stated in the
   protocol's technical specification), only one successful SASL
   authentication exchange may occur in a protocol session.  In this




<span class="grey">Melnikov &amp; Zeilenga         Standards Track                    [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc4422.html">RFC 4422</a>                          SASL                         June 2006</span>


   case, once an authentication exchange has successfully completed,
   further attempts to initiate an authentication exchange fail.

   Where multiple successful SASL authentication exchanges are permitted
   in the protocol, then in no case may multiple SASL security layers be
   simultaneously in effect.  If a security layer is in effect and a
   subsequent SASL negotiation selects a second security layer, then the
   second security layer replaces the first.  If a security layer is in
   effect and a subsequent SASL negotiation selects no security layer,
   the original security layer remains in effect.

   Where multiple successful SASL negotiations are permitted in the
   protocol, the effect of a failed SASL authentication exchange upon
   the previously established authentication and authorization state is
   protocol specific.  The protocol's technical specification should be
   consulted to determine whether the previous authentication and
   authorization state remains in force, or changed to an anonymous
   state, or otherwise was affected.  Regardless of the protocol-
   specific effect upon previously established authentication and
   authorization state, the previously negotiated security layer remains
   in effect.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Protocol%20Requirements"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Protocol Requirements</span>

   In order for a protocol to offer SASL services, its specification
   MUST supply the following information:

   1) A service name, to be selected from registry of "service" elements
      for the Generic Security Service Application Program Interface
      (GSSAPI) host-based service name form, as described in <a href="rfc2743.html#section-4.1">Section 4.1
      of [RFC2743]</a>.  Note that this registry is shared by all GSSAPI and
      SASL mechanisms.

   2) Detail any mechanism negotiation facility that the protocol
      provides (see <a href="#section-3.2">Section 3.2</a>).

      A protocol SHOULD specify a facility through which the client may
      discover, both before initiation of the SASL exchange and after
      installing security layers negotiated by the exchange, the names
      of the SASL mechanisms that the server makes available to the
      client.  The latter is important to allow the client to detect
      downgrade attacks.  This facility is typically provided through
      the protocol's extensions or capabilities discovery facility.

   3) Definition of the messages necessary for authentication exchange,
      including the following:





<span class="grey">Melnikov &amp; Zeilenga         Standards Track                    [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc4422.html">RFC 4422</a>                          SASL                         June 2006</span>


      a) A message to initiate the authentication exchange (see <a href="#section-3.3">Section</a>
         <a href="#section-3.3">3.3</a>).

         This message MUST contain a field for carrying the name of the
         mechanism selected by the client.

         This message SHOULD contain an optional field for carrying an
         initial response.  If the message is defined with this field,
         the specification MUST describe how messages with an empty
         initial response are distinguished from messages with no
         initial response.  This field MUST be capable of carrying
         arbitrary sequences of octets (including zero-length sequences
         and sequences containing zero-valued octets).

      b) Messages to transfer server challenges and client responses
         (see <a href="#section-3.4">Section 3.4</a>).

         Each of these messages MUST be capable of carrying arbitrary
         sequences of octets (including zero-length sequences and
         sequences containing zero-valued octets).

      c) A message to indicate the outcome of the authentication
         exchange (see <a href="#section-3.6">Section 3.6</a>).

         This message SHOULD contain an optional field for carrying
         additional data with a successful outcome.  If the message is
         defined with this field, the specification MUST describe how
         messages with an empty additional data are distinguished from
         messages with no additional data.  This field MUST be capable
         of carrying arbitrary sequences of octets (including zero-
         length sequences and sequences containing zero-valued octets).

   4) Prescribe the syntax and semantics of non-empty authorization
      identity strings (see <a href="#section-3.4.1">Section 3.4.1</a>).

      In order to avoid interoperability problems due to differing
      normalizations, the protocol specification MUST detail precisely
      how and where (client or server) non-empty authorization identity
      strings are prepared, including all normalizations, for comparison
      and other applicable functions to ensure proper function.

      Specifications are encouraged to prescribe use of existing
      authorization identity forms as well as existing string
      representations, such as simple user names [<a href="rfc4013.html" title='"SASLprep: Stringprep Profile for User Names and Passwords"'>RFC4013</a>].

      Where the specification does not precisely prescribe how
      identities in SASL relate to identities used elsewhere in the
      protocol, for instance, in access control policy statements, it



<span class="grey">Melnikov &amp; Zeilenga         Standards Track                    [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc4422.html">RFC 4422</a>                          SASL                         June 2006</span>


      may be appropriate for the protocol to provide a facility by which
      the client can discover information (such as the representation of
      the identity used in making access control decisions) about
      established identities for these uses.

   5) Detail any facility the protocol provides that allows the client
      and/or server to abort authentication exchange (see <a href="#section-3.5">Section 3.5</a>).

      Protocols that support multiple authentications typically allow a
      client to abort an ongoing authentication exchange by initiating a
      new authentication exchange.  Protocols that do not support
      multiple authentications may require the client to close the
      connection and start over to abort an ongoing authentication
      exchange.

      Protocols typically allow the server to abort ongoing
      authentication exchanges by returning a non-successful outcome
      message.

   6) Identify precisely where newly negotiated security layers start to
      take effect, in both directions (see <a href="#section-3.7">Section 3.7</a>).

      Typically, specifications require security layers to start taking
      effect on the first octet following the outcome message in data
      being sent by the server and on the first octet sent after receipt
      of the outcome message in data being sent by the client.

   7) If the protocol supports other layered security services, such as
      Transport Layer Security (TLS) [<a href="rfc4346.html" title='"The Transport Layer Security (TLS) Protocol Version 1.1"'>RFC4346</a>], the specification MUST
      prescribe the order in which security layers are applied to
      protocol data.

      For instance, where a protocol supports both TLS and SASL security
      layers, the specification could prescribe any of the following:

      a) SASL security layer is always applied first to data being sent
         and, hence, applied last to received data,

      b) SASL security layer is always applied last to data being sent
         and, hence, applied first to received data,

      c) Layers are applied in the order in which they were installed,

      d) Layers are applied in the reverse order in which they were
         installed, or

      e) Both TLS and SASL security layers cannot be installed.




<span class="grey">Melnikov &amp; Zeilenga         Standards Track                    [Page 15]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc4422.html">RFC 4422</a>                          SASL                         June 2006</span>


   8) Indicate whether the protocol supports multiple authentications
      (see <a href="#section-3.8">Section 3.8</a>).  If so, the protocol MUST detail the effect a
      failed SASL authentication exchange will have upon a previously
      established authentication and authorization state.

   Protocol specifications SHOULD avoid stating implementation
   requirements that would hinder replacement of applicable mechanisms.
   In general, protocol specifications SHOULD be mechanism neutral.
   There are a number of reasonable exceptions to this recommendation,
   including

      -  detailing how credentials (which are mechanism specific) are
         managed in the protocol,

      -  detailing how authentication identities (which are mechanism
         specific) and authorization identities (which are protocol
         specific) relate to each other, and

      -  detailing which mechanisms are applicable to the protocol.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Mechanism%20Requirements"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Mechanism Requirements</span>

   SASL mechanism specifications MUST supply the following information:

   1) The name of the mechanism (see <a href="#section-3.1">Section 3.1</a>).  This name MUST be
      registered as discussed in <a href="#section-7.1">Section 7.1</a>.

   2) A definition of the server-challenges and client-responses of the
      authentication exchange, as well as the following:

      a) An indication of whether the mechanism is client-first,
         variable, or server-first.  If a SASL mechanism is defined as
         client-first and the client does not send an initial response
         in the authentication request, then the first server challenge
         MUST be empty (the EXTERNAL mechanism is an example of this
         case).  If a SASL mechanism is defined as variable, then the
         specification needs to state how the server behaves when the
         initial client response in the authentication request is
         omitted (the DIGEST-MD5 mechanism [<a href="#ref-DIGEST-MD5" title='"Using Digest Authentication as a SASL Mechanism"'>DIGEST-MD5</a>] is an example of
         this case).  If a SASL mechanism is defined as server-first,
         then the client MUST NOT send an initial client response in the
         authentication request (the CRAM-MD5 mechanism [<a href="#ref-CRAM-MD5" title='"The CRAM-MD5 SASL Mechanism"'>CRAM-MD5</a>] is an
         example of this case).

      b) An indication of whether the server is expected to provide
         additional data when indicating a successful outcome.  If so,
         if the server sends the additional data as a challenge, the




<span class="grey">Melnikov &amp; Zeilenga         Standards Track                    [Page 16]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc4422.html">RFC 4422</a>                          SASL                         June 2006</span>


         specification MUST indicate that the response to this challenge
         is an empty response.

      SASL mechanisms SHOULD be designed to minimize the number of
      challenges and responses necessary to complete the exchange.

   3) An indication of whether the mechanism is capable of transferring
      authorization identity strings (see <a href="#section-3.4.1">Section 3.4.1</a>).  While some
      legacy mechanisms are incapable of transmitting an authorization
      identity (which means that for these mechanisms, the authorization
      identity is always the empty string), newly defined mechanisms
      SHOULD be capable of transferring authorization identity strings.
      The mechanism SHOULD NOT be capable of transferring both no
      authorization identity string and an empty authorization identity.

      Mechanisms that are capable of transferring an authorization
      identity string MUST be capable of transferring arbitrary non-
      empty sequences of Unicode characters, excluding those that
      contain the NUL (U+0000) character.  Mechanisms SHOULD use the
      UTF-8 [<a href="rfc3629.html" title='"UTF-8, a transformation format of ISO 10646"'>RFC3629</a>] transformation format.  The specification MUST
      detail how any Unicode code points special to the mechanism that
      might appear in the authorization identity string are escaped to
      avoid ambiguity during decoding of the authorization identity
      string.  Typically, mechanisms that have special characters
      require these special characters to be escaped or encoded in the
      character string (after encoding it in a particular Unicode
      transformation format) using a data encoding scheme such as Base64
      [<a href="rfc3548.html" title='"The Base16, Base32, and Base64 Data Encodings"'>RFC3548</a>].

   4) The specification MUST detail whether the mechanism offers a
      security layer.  If the mechanism does, the specification MUST
      detail the security and other services offered in the layer as
      well as how these services are to be implemented.

   5) If the underlying cryptographic technology used by a mechanism
      supports data integrity, then the mechanism specification MUST
      integrity protect the transmission of an authorization identity
      and the negotiation of the security layer.

   SASL mechanisms SHOULD be protocol neutral.

   SASL mechanisms SHOULD reuse existing credential and identity forms,
   as well as associated syntaxes and semantics.

   SASL mechanisms SHOULD use the UTF-8 transformation format [<a href="rfc3629.html" title='"UTF-8, a transformation format of ISO 10646"'>RFC3629</a>]
   for encoding Unicode [<a href="#ref-Unicode" title='"The Unicode Standard, Version 3.2.0"'>Unicode</a>] code points for transfer.





<span class="grey">Melnikov &amp; Zeilenga         Standards Track                    [Page 17]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc4422.html">RFC 4422</a>                          SASL                         June 2006</span>


   In order to avoid interoperability problems due to differing
   normalizations, when a mechanism calls for character data (other than
   the authorization identity string) to be used as input to a
   cryptographic and/or comparison function, the specification MUST
   detail precisely how and where (client or server) the character data
   is to be prepared, including all normalizations, for input into the
   function to ensure proper operation.

   For simple user names and/or passwords in authentication credentials,
   SASLprep [<a href="rfc4013.html" title='"SASLprep: Stringprep Profile for User Names and Passwords"'>RFC4013</a>] (a profile of the StringPrep [<a href="rfc3454.html" title='"Preparation of Internationalized Strings ("'>RFC3454</a>] preparation
   algorithm), SHOULD be specified as the preparation algorithm.

   The mechanism SHOULD NOT use the authorization identity string in
   generation of any long-term cryptographic keys or hashes as there is
   no requirement that the authorization identity string be canonical.
   Long-term, here, means a term longer than the duration of the
   authentication exchange in which they were generated.  That is, as
   different clients (of the same or different protocol) may provide
   different authorization identity strings that are semantically
   equivalent, use of authorization identity strings in generation of
   cryptographic keys and hashes will likely lead to interoperability
   and other problems.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20Security%20Considerations"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  Security Considerations</span>

   Security issues are discussed throughout this memo.

   Many existing SASL mechanisms do not provide adequate protection
   against passive attacks, let alone active attacks, in the
   authentication exchange.  Many existing SASL mechanisms do not offer
   security layers.  It is hoped that future SASL mechanisms will
   provide strong protection against passive and active attacks in the
   authentication exchange, as well as security layers with strong basic
   data security features (e.g., data integrity and data
   confidentiality) services.  It is also hoped that future mechanisms
   will provide more advanced data security services like re-keying (see
   <a href="#section-6.3">Section 6.3</a>).

   Regardless, the SASL framework is susceptible to downgrade attacks.
   <a href="#section-6.1.2">Section 6.1.2</a> offers a variety of approaches for preventing or
   detecting these attacks.  In some cases, it is appropriate to use
   data integrity protective services external to SASL (e.g., TLS) to
   protect against downgrade attacks in SASL.  Use of external
   protective security services is also important when the mechanisms
   available do not themselves offer adequate integrity and/or
   confidentiality protection of the authentication exchange and/or
   protocol data.




<span class="grey">Melnikov &amp; Zeilenga         Standards Track                    [Page 18]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-19" id="page-19" name="page-19"> </a>
<span class="grey"><a href="rfc4422.html">RFC 4422</a>                          SASL                         June 2006</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.1.%20%20Active%20Attacks"></a><a class="selflink" href="#section-6.1" name="section-6.1">6.1</a>.  Active Attacks</span>

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/6.1.1.%20%20Hijack%20Attacks"></a><a class="selflink" href="#section-6.1.1" name="section-6.1.1">6.1.1</a>.  Hijack Attacks</span>

   When the client selects a SASL security layer with at least integrity
   protection, this protection serves as a counter-measure against an
   active attacker hijacking the connection and modifying protocol data
   sent after establishment of the security layer.  Implementations
   SHOULD close the connection when the security services in a SASL
   security layer report protocol data report lack of data integrity.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/6.1.2.%20%20Downgrade%20Attacks"></a><a class="selflink" href="#section-6.1.2" name="section-6.1.2">6.1.2</a>.  Downgrade Attacks</span>

   It is important that any security-sensitive protocol negotiations be
   performed after installation of a security layer with data integrity
   protection.  Protocols should be designed such that negotiations
   performed prior to this installation should be revalidated after
   installation is complete.  Negotiation of the SASL mechanism is
   security sensitive.

   When a client negotiates the authentication mechanism with the server
   and/or other security features, it is possible for an active attacker
   to cause a party to use the least secure security services available.
   For instance, an attacker can modify the server-advertised mechanism
   list or can modify the client-advertised security feature list within
   a mechanism response.  To protect against this sort of attack,
   implementations SHOULD NOT advertise mechanisms and/or features that
   cannot meet their minimum security requirements, SHOULD NOT enter
   into or continue authentication exchanges that cannot meet their
   minimum security requirements, and SHOULD verify that completed
   authentication exchanges result in security services that meet their
   minimum security requirements.  Note that each endpoint needs to
   independently verify that its security requirements are met.

   In order to detect downgrade attacks to the least (or less) secure
   mechanism supported, the client can discover the SASL mechanisms that
   the server makes available both before the SASL authentication
   exchange and after the negotiated SASL security layer (with at least
   data integrity protection) has been installed through the protocol's
   mechanism discovery facility.  If the client finds that the
   integrity-protected list (the list obtained after the security layer
   was installed) contains a stronger mechanism than those in the
   previously obtained list, the client should assume that the
   previously obtained list was modified by an attacker and SHOULD close
   the underlying transport connection.

   The client's initiation of the SASL exchange, including the selection
   of a SASL mechanism, is done in the clear and may be modified by an



<span class="grey">Melnikov &amp; Zeilenga         Standards Track                    [Page 19]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-20" id="page-20" name="page-20"> </a>
<span class="grey"><a href="rfc4422.html">RFC 4422</a>                          SASL                         June 2006</span>


   active attacker.  It is important for any new SASL mechanisms to be
   designed such that an active attacker cannot obtain an authentication
   with weaker security properties by modifying the SASL mechanism name
   and/or the challenges and responses.

   Multi-level negotiation of security features is prone to downgrade
   attack.  Protocol designers should avoid offering higher-level
   negotiation of security features in protocols (e.g., above SASL
   mechanism negotiation) and mechanism designers should avoid lower-
   level negotiation of security features in mechanisms (e.g., below
   SASL mechanism negotiation).

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/6.1.3.%20%20Replay%20Attacks"></a><a class="selflink" href="#section-6.1.3" name="section-6.1.3">6.1.3</a>.  Replay Attacks</span>

   Some mechanisms may be subject to replay attacks unless protected by
   external data security services (e.g., TLS).

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/6.1.4.%20%20Truncation%20Attacks"></a><a class="selflink" href="#section-6.1.4" name="section-6.1.4">6.1.4</a>.  Truncation Attacks</span>

   Most existing SASL security layers do not themselves offer protection
   against truncation attack.  In a truncation attack, the active
   attacker causes the protocol session to be closed, causing a
   truncation of the possibly integrity-protected data stream that leads
   to behavior of one or both the protocol peers that inappropriately
   benefits the attacker.  Truncation attacks are fairly easy to defend
   against in connection-oriented application-level protocols.  A
   protocol can defend against these attacks by ensuring that each
   information exchange has a clear final result and that each protocol
   session has a graceful closure mechanism, and that these are
   integrity protected.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/6.1.5.%20%20Other%20Active%20Attacks"></a><a class="selflink" href="#section-6.1.5" name="section-6.1.5">6.1.5</a>.  Other Active Attacks</span>

   When use of a security layer is negotiated by the authentication
   protocol exchange, the receiver SHOULD handle gracefully any
   protected data buffer larger than the defined/negotiated maximal
   size.  In particular, it MUST NOT blindly allocate the amount of
   memory specified in the buffer size field, as this might cause the
   "out of memory" condition.  If the receiver detects a large block, it
   SHOULD close the connection.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.2.%20%20Passive%20Attacks"></a><a class="selflink" href="#section-6.2" name="section-6.2">6.2</a>.  Passive Attacks</span>

   Many mechanisms are subject to various passive attacks, including
   simple eavesdropping of unprotected credential information as well as
   online and offline dictionary attacks of protected credential
   information.




<span class="grey">Melnikov &amp; Zeilenga         Standards Track                    [Page 20]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-21" id="page-21" name="page-21"> </a>
<span class="grey"><a href="rfc4422.html">RFC 4422</a>                          SASL                         June 2006</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.3.%20%20Re-keying"></a><a class="selflink" href="#section-6.3" name="section-6.3">6.3</a>.  Re-keying</span>

   The secure or administratively permitted lifetimes of SASL
   mechanisms' security layers are finite.  Cryptographic keys weaken as
   they are used and as time passes; the more time and/or cipher-text
   that a cryptanalyst has after the first use of the a key, the easier
   it is for the cryptanalyst to mount attacks on the key.

   Administrative limits on a security layer's lifetime may take the
   form of time limits expressed in X.509 certificates, in Kerberos V
   tickets, or in directories, and are often desired.  In practice, one
   likely effect of administrative lifetime limits is that applications
   may find that security layers stop working in the middle of
   application protocol operation, such as, perhaps, during large data
   transfers.  As the result of this, the connection will be closed (see
   <a href="#section-3.7">Section 3.7</a>), which will result in an unpleasant user experience.

   Re-keying (key renegotiation process) is a way of addressing the
   weakening of cryptographic keys.  The SASL framework does not itself
   provide for re-keying; SASL mechanisms may.  Designers of future SASL
   mechanisms should consider providing re-keying services.

   Implementations that wish to re-key SASL security layers where the
   mechanism does not provide for re-keying SHOULD reauthenticate the
   same IDs and replace the expired or soon-to-expire security layers.
   This approach requires support for reauthentication in the
   application protocols (see <a href="#section-3.8">Section 3.8</a>).

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.4.%20%20Other%20Considerations"></a><a class="selflink" href="#section-6.4" name="section-6.4">6.4</a>.  Other Considerations</span>

   Protocol designers and implementors should understand the security
   considerations of mechanisms so they may select mechanisms that are
   applicable to their needs.

   Distributed server implementations need to be careful in how they
   trust other parties.  In particular, authentication secrets should
   only be disclosed to other parties that are trusted to manage and use
   those secrets in a manner acceptable to the disclosing party.
   Applications using SASL assume that SASL security layers providing
   data confidentiality are secure even when an attacker chooses the
   text to be protected by the security layer.  Similarly, applications
   assume that the SASL security layer is secure even if the attacker
   can manipulate the cipher-text output of the security layer.  New
   SASL mechanisms are expected to meet these assumptions.







<span class="grey">Melnikov &amp; Zeilenga         Standards Track                    [Page 21]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-22" id="page-22" name="page-22"> </a>
<span class="grey"><a href="rfc4422.html">RFC 4422</a>                          SASL                         June 2006</span>


   Unicode security considerations [<a href="#ref-UTR36" title='"(Draft) Unicode Technical Report #36, Character Encoding Model"'>UTR36</a>] apply to authorization
   identity strings, as well as UTF-8 [<a href="rfc3629.html" title='"UTF-8, a transformation format of ISO 10646"'>RFC3629</a>] security considerations
   where UTF-8 is used.  SASLprep [<a href="rfc4013.html" title='"SASLprep: Stringprep Profile for User Names and Passwords"'>RFC4013</a>] and StringPrep [<a href="rfc3454.html" title='"Preparation of Internationalized Strings ("'>RFC3454</a>]
   security considerations also apply where used.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  IANA Considerations</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.1.%20%20SASL%20Mechanism%20Registry"></a><a class="selflink" href="#section-7.1" name="section-7.1">7.1</a>.  SASL Mechanism Registry</span>

   The SASL mechanism registry is maintained by IANA.  The registry is
   currently available at &lt;<a href="http://www.iana.org/assignments/sasl-mechanisms">http://www.iana.org/assignments/sasl-</a>
   <a href="http://www.iana.org/assignments/sasl-mechanisms">mechanisms</a>&gt;.

   The purpose of this registry is not only to ensure uniqueness of
   values used to name SASL mechanisms, but also to provide a definitive
   reference to technical specifications detailing each SASL mechanism
   available for use on the Internet.

   There is no naming convention for SASL mechanisms; any name that
   conforms to the syntax of a SASL mechanism name can be registered.

   The procedure detailed in <a href="#section-7.1.1">Section 7.1.1</a> is to be used for
   registration of a value naming a specific individual mechanism.

   The procedure detailed in <a href="#section-7.1.2">Section 7.1.2</a> is to be used for
   registration of a value naming a family of related mechanisms.

   Comments may be included in the registry as discussed in <a href="#section-7.1.3">Section</a>
   <a href="#section-7.1.3">7.1.3</a> and may be changed as discussed in <a href="#section-7.1.4">Section 7.1.4</a>.

   The SASL mechanism registry has been updated to reflect that this
   document provides the definitive technical specification for SASL and
   that this section provides the registration procedures for this
   registry.

















<span class="grey">Melnikov &amp; Zeilenga         Standards Track                    [Page 22]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-23" id="page-23" name="page-23"> </a>
<span class="grey"><a href="rfc4422.html">RFC 4422</a>                          SASL                         June 2006</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/7.1.1.%20%20Mechanism%20Name%20Registration%20Procedure"></a><a class="selflink" href="#section-7.1.1" name="section-7.1.1">7.1.1</a>.  Mechanism Name Registration Procedure</span>

   IANA will register new SASL mechanism names on a First Come First
   Served basis, as defined in <a href="https://tools.ietf.org/html/bcp26">BCP 26</a> [<a href="rfc2434.html" title='"Guidelines for Writing an IANA Considerations Section in RFCs"'>RFC2434</a>].  IANA has the right to
   reject obviously bogus registration requests, but will perform no
   review of claims made in the registration form.

   Registration of a SASL mechanism is requested by filling in the
   following template:

      Subject: Registration of SASL mechanism X

      SASL mechanism name (or prefix for the family):

      Security considerations:

      Published specification (recommended):

      Person &amp; email address to contact for further information:

      Intended usage: (One of COMMON, LIMITED USE, or OBSOLETE)

      Owner/Change controller:

      Note: (Any other information that the author deems relevant may be
      added here.)

   and sending it via electronic mail to IANA at &lt;iana@iana.org&gt;.

   While this registration procedure does not require expert review,
   authors of SASL mechanisms are encouraged to seek community review
   and comment whenever that is feasible.  Authors may seek community
   review by posting a specification of their proposed mechanism as an
   Internet-Draft.  SASL mechanisms intended for widespread use should
   be standardized through the normal IETF process, when appropriate.
















<span class="grey">Melnikov &amp; Zeilenga         Standards Track                    [Page 23]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-24" id="page-24" name="page-24"> </a>
<span class="grey"><a href="rfc4422.html">RFC 4422</a>                          SASL                         June 2006</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/7.1.2.%20%20Family%20Name%20Registration%20Procedure"></a><a class="selflink" href="#section-7.1.2" name="section-7.1.2">7.1.2</a>.  Family Name Registration Procedure</span>

   As noted above, there is no general naming convention for SASL
   mechanisms.  However, specifications may reserve a portion of the
   SASL mechanism namespace for a set of related SASL mechanisms, a
   "family" of SASL mechanisms.  Each family of SASL mechanisms is
   identified by a unique prefix, such as X-.  Registration of new SASL
   mechanism family names requires expert review as defined in <a href="https://tools.ietf.org/html/bcp26">BCP 26</a>
   [<a href="rfc2434.html" title='"Guidelines for Writing an IANA Considerations Section in RFCs"'>RFC2434</a>].

   Registration of a SASL family name is requested by filling in the
   following template:

      Subject: Registration of SASL mechanism family X

      SASL family name (or prefix for the family):

      Security considerations:

      Published specification (recommended):

      Person &amp; email address to contact for further information:

      Intended usage: (One of COMMON, LIMITED USE, or OBSOLETE)

      Owner/Change controller:

      Note: (Any other information that the author deems relevant may be
      added here.)

   and sending it via electronic mail to the IETF SASL mailing list at
   &lt;ietf-sasl@imc.org&gt; and carbon copying IANA at &lt;iana@iana.org&gt;.
   After allowing two weeks for community input on the IETF SASL mailing
   list, the expert will determine the appropriateness of the
   registration request and either approve or disapprove the request
   with notice to the requestor, the mailing list, and IANA.

   The review should focus on the appropriateness of the requested
   family name for the proposed use and the appropriateness of the
   proposed naming and registration plan for existing and future
   mechanism names in the family.  The scope of this request review may
   entail consideration of relevant aspects of any provided technical
   specification, such as their IANA Considerations section.  However,
   this review is narrowly focused on the appropriateness of the
   requested registration and not on the overall soundness of any
   provided technical specification.





<span class="grey">Melnikov &amp; Zeilenga         Standards Track                    [Page 24]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-25" id="page-25" name="page-25"> </a>
<span class="grey"><a href="rfc4422.html">RFC 4422</a>                          SASL                         June 2006</span>


   Authors are encouraged to pursue community review by posting the
   technical specification as an Internet-Draft and soliciting comment
   by posting to appropriate IETF mailing lists.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/7.1.3.%20%20Comments%20on%20SASL%20Mechanism%20Registrations"></a><a class="selflink" href="#section-7.1.3" name="section-7.1.3">7.1.3</a>.  Comments on SASL Mechanism Registrations</span>

   Comments on a registered SASL mechanism/family should first be sent
   to the "owner" of the mechanism/family and/or to the &lt;ietf-
   sasl@imc.org&gt; mailing list.

   Submitters of comments may, after a reasonable attempt to contact the
   owner, request IANA to attach their comment to the SASL mechanism
   registration itself by sending mail to &lt;iana@iana.org&gt;.  At IANA's
   sole discretion, IANA may attach the comment to the SASL mechanism's
   registration.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/7.1.4.%20%20Change%20Control"></a><a class="selflink" href="#section-7.1.4" name="section-7.1.4">7.1.4</a>.  Change Control</span>

   Once a SASL mechanism registration has been published by IANA, the
   author may request a change to its definition.  The change request
   follows the same procedure as the registration request.

   The owner of a SASL mechanism may pass responsibility for the SASL
   mechanism to another person or agency by informing IANA; this can be
   done without discussion or review.

   The IESG may reassign responsibility for a SASL mechanism.  The most
   common case of this will be to enable changes to be made to
   mechanisms where the author of the registration has died, has moved
   out of contact, or is otherwise unable to make changes that are
   important to the community.

   SASL mechanism registrations may not be deleted; mechanisms that are
   no longer believed appropriate for use can be declared OBSOLETE by a
   change to their "intended usage" field; such SASL mechanisms will be
   clearly marked in the lists published by IANA.

   The IESG is considered to be the owner of all SASL mechanisms that
   are on the IETF standards track.












<span class="grey">Melnikov &amp; Zeilenga         Standards Track                    [Page 25]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-26" id="page-26" name="page-26"> </a>
<span class="grey"><a href="rfc4422.html">RFC 4422</a>                          SASL                         June 2006</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.2.%20%20Registration%20Changes"></a><a class="selflink" href="#section-7.2" name="section-7.2">7.2</a>.  Registration Changes</span>

   The IANA has updated the SASL mechanisms registry as follows:

   1) Changed the "Intended usage" of the KERBEROS_V4 and SKEY mechanism
      registrations to OBSOLETE.

   2) Changed the "Published specification" of the EXTERNAL mechanism to
      this document as indicated below:

      Subject: Updated Registration of SASL mechanism EXTERNAL
      Family of SASL mechanisms: NO
      SASL mechanism name: EXTERNAL
      Security considerations: See A.3 of <a href="rfc4422.html">RFC 4422</a>
      Published specification (optional, recommended): <a href="rfc4422.html">RFC 4422</a>
      Person &amp; email address to contact for further information:
          Alexey Melnikov &lt;Alexey.Melnikov@isode.com&gt;
      Intended usage: COMMON
      Owner/Change controller: IESG &lt;iesg@ietf.org&gt;
      Note: Updates existing entry for EXTERNAL

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20References"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.1.%20%20Normative%20References"></a><a class="selflink" href="#section-8.1" name="section-8.1">8.1</a>.  Normative References</span>

   [<a id="ref-RFC2119" name="ref-RFC2119">RFC2119</a>]     Bradner, S., "Key words for use in RFCs to Indicate
                 Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a id="ref-RFC2244" name="ref-RFC2244">RFC2244</a>]     Newman, C. and J. G. Myers, "ACAP -- Application
                 Configuration Access Protocol", <a href="rfc2244.html">RFC 2244</a>, November
                 1997.

   [<a id="ref-RFC2434" name="ref-RFC2434">RFC2434</a>]     Narten, T. and H. Alvestrand, "Guidelines for Writing
                 an IANA Considerations Section in RFCs", <a href="https://tools.ietf.org/html/bcp26">BCP 26</a>, <a href="rfc2434.html">RFC</a>
                 <a href="rfc2434.html">2434</a>, October 1998.

   [<a id="ref-RFC2743" name="ref-RFC2743">RFC2743</a>]     Linn, J., "Generic Security Service Application Program
                 Interface Version 2, Update 1", <a href="rfc2743.html">RFC 2743</a>, January 2000.

   [<a id="ref-RFC3454" name="ref-RFC3454">RFC3454</a>]     Hoffman, P. and M. Blanchet, "Preparation of
                 Internationalized Strings ("stringprep")", <a href="rfc3454.html">RFC 3454</a>,
                 December 2002.

   [<a id="ref-RFC3629" name="ref-RFC3629">RFC3629</a>]     Yergeau, F., "UTF-8, a transformation format of ISO
                 10646", STD 63, <a href="rfc3629.html">RFC 3629</a>, November 2003.

   [<a id="ref-RFC4013" name="ref-RFC4013">RFC4013</a>]     Zeilenga, K., "SASLprep: Stringprep Profile for User
                 Names and Passwords", <a href="rfc4013.html">RFC 4013</a>, February 2005.



<span class="grey">Melnikov &amp; Zeilenga         Standards Track                    [Page 26]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-27" id="page-27" name="page-27"> </a>
<span class="grey"><a href="rfc4422.html">RFC 4422</a>                          SASL                         June 2006</span>


   [<a id="ref-RFC4234" name="ref-RFC4234">RFC4234</a>]     Crocker, D. and P. Overell, "Augmented BNF for Syntax
                 Specifications: ABNF", <a href="rfc4234.html">RFC 4234</a>, October 2005.

   [<a id="ref-ASCII" name="ref-ASCII">ASCII</a>]       Coded Character Set--7-bit American Standard Code for
                 Information Interchange, ANSI X3.4-1986.

   [<a id="ref-Unicode" name="ref-Unicode">Unicode</a>]     The Unicode Consortium, "The Unicode Standard, Version
                 3.2.0" is defined by "The Unicode Standard, Version
                 3.0" (Reading, MA, Addison-Wesley, 2000. ISBN 0-201-
                 61633-5), as amended by the "Unicode Standard Annex
                 #27: Unicode 3.1"
                 (<a href="http://www.unicode.org/reports/tr27/">http://www.unicode.org/reports/tr27/</a>) and by the
                 "Unicode Standard Annex #28: Unicode 3.2"
                 (<a href="http://www.unicode.org/reports/tr28/">http://www.unicode.org/reports/tr28/</a>).

   [<a id="ref-CharModel" name="ref-CharModel">CharModel</a>]   Whistler, K. and M. Davis, "Unicode Technical Report
                 #17, Character Encoding Model", UTR17,
                 &lt;<a href="http://www.unicode.org/unicode/reports/tr17/">http://www.unicode.org/unicode/reports/tr17/</a>&gt;, August
                 2000.

   [<a id="ref-Glossary" name="ref-Glossary">Glossary</a>]    The Unicode Consortium, "Unicode Glossary",
                 &lt;<a href="http://www.unicode.org/glossary/">http://www.unicode.org/glossary/</a>&gt;.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.2.%20%20Informative%20References"></a><a class="selflink" href="#section-8.2" name="section-8.2">8.2</a>.  Informative References</span>

   [<a id="ref-RFC3206" name="ref-RFC3206">RFC3206</a>]     Gellens, R., "The SYS and AUTH POP Response Codes", <a href="rfc3206.html">RFC</a>
                 <a href="rfc3206.html">3206</a>, February 2002.

   [<a id="ref-RFC3548" name="ref-RFC3548">RFC3548</a>]     Josefsson, S., "The Base16, Base32, and Base64 Data
                 Encodings", <a href="rfc3548.html">RFC 3548</a>, July 2003.

   [<a id="ref-RFC4301" name="ref-RFC4301">RFC4301</a>]     Kent, S. and K. Seo, "Security Architecture for the
                 Internet Protocol", <a href="rfc4301.html">RFC 4301</a>, December 2005.

   [<a id="ref-RFC4346" name="ref-RFC4346">RFC4346</a>]     Dierks, T. and E. Rescorla, "The Transport Layer
                 Security (TLS) Protocol Version 1.1", <a href="rfc4346.html">RFC 4346</a>, April
                 2006.

   [<a id="ref-SASL-GSSAPI" name="ref-SASL-GSSAPI">SASL-GSSAPI</a>] Melnikov, A. (Editor), "The Kerberos V5 ("GSSAPI") SASL
                 Mechanism", Work in Progress, May 2006.

   [<a id="ref-UTR36" name="ref-UTR36">UTR36</a>]       Davis, M., "(Draft) Unicode Technical Report #36,
                 Character Encoding Model", UTR17,
                 &lt;<a href="http://www.unicode.org/unicode/reports/tr36/">http://www.unicode.org/unicode/reports/tr36/</a>&gt;,
                 February 2005.

   [<a id="ref-CRAM-MD5" name="ref-CRAM-MD5">CRAM-MD5</a>]    Nerenberg, L., <a href="https://www.google.com/search?sitesearch=tools.ietf.org%2Fhtml%2F&amp;q=inurl:draft-+%22The+CRAM-MD5+SASL+Mechanism%22" style="text-decoration: none">"The CRAM-MD5 SASL Mechanism"</a>, Work in
                 Progress.



<span class="grey">Melnikov &amp; Zeilenga         Standards Track                    [Page 27]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-28" id="page-28" name="page-28"> </a>
<span class="grey"><a href="rfc4422.html">RFC 4422</a>                          SASL                         June 2006</span>


   [<a id="ref-DIGEST-MD5" name="ref-DIGEST-MD5">DIGEST-MD5</a>]  Leach, P., C. Newman, and A. Melnikov, "Using Digest
                 Authentication as a SASL Mechanism", Work in Progress,
                 March 2006.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/9.%20%20Acknowledgements"></a><a class="selflink" href="#section-9" name="section-9">9</a>.  Acknowledgements</span>

   This document is a revision of <a href="rfc2222.html">RFC 2222</a> written by John Myers.

   This revision is a product of the IETF Simple Authentication and
   Security Layer (SASL) Working Group.

   The following individuals contributed significantly to this revision:
   Abhijit Menon-Sen, Hallvard Furuseth, Jeffrey Hutzelman, John Myers,
   Luke Howard, Magnus Nystrom, Nicolas Williams, Peter Saint-Andre, RL
   'Bob' Morgan, Rob Siemborski, Sam Hartman, Simon Josefsson, Tim
   Alsop, and Tony Hansen.



































<span class="grey">Melnikov &amp; Zeilenga         Standards Track                    [Page 28]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-29" id="page-29" name="page-29"> </a>
<span class="grey"><a href="rfc4422.html">RFC 4422</a>                          SASL                         June 2006</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/Appendix%20A.%20%20The%20SASL%20EXTERNAL%20Mechanism"></a><a class="selflink" href="#appendix-A" name="appendix-A">Appendix A</a>.  The SASL EXTERNAL Mechanism</span>

   This appendix is normative.

   The EXTERNAL mechanism allows a client to request the server to use
   credentials established by means external to the mechanism to
   authenticate the client.  The external means may be, for instance, IP
   Security [<a href="rfc4301.html" title='"Security Architecture for the Internet Protocol"'>RFC4301</a>] or TLS [<a href="rfc4346.html" title='"The Transport Layer Security (TLS) Protocol Version 1.1"'>RFC4346</a>] services.  In absence of some a
   priori agreement between the client and the server, the client cannot
   make any assumption as to what external means the server has used to
   obtain the client's credentials, nor make an assumption as to the
   form of credentials.  For example, the client cannot assume that the
   server will use the credentials the client has established via TLS.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/A.1.%20%20EXTERNAL%20Technical%20Specification"></a><a class="selflink" href="#appendix-A.1" name="appendix-A.1">A.1</a>.  EXTERNAL Technical Specification</span>

   The name of this mechanism is "EXTERNAL".

   The mechanism does not provide a security layer.

   The mechanism is capable of transferring an authorization identity
   string.  If empty, the client is requesting to act as the identity
   the server has associated with the client's credentials.  If non-
   empty, the client is requesting to act as the identity represented by
   the string.

   The client is expected to send data first in the authentication
   exchange.  Where the client does not provide an initial response data
   in its request to initiate the authentication exchange, the server is
   to respond to the request with an empty initial challenge and then
   the client is to provide its initial response.

   The client sends the initial response containing the UTF-8 [<a href="rfc3629.html" title='"UTF-8, a transformation format of ISO 10646"'>RFC3629</a>]
   encoding of the requested authorization identity string.  This
   response is non-empty when the client is requesting to act as the
   identity represented by the (non-empty) string.  This response is
   empty when the client is requesting to act as the identity the server
   associated with its authentication credentials.

   The syntax of the initial response is specified as a value of the
   &lt;extern-initial-resp&gt; production detailed below using the Augmented
   Backus-Naur Form (ABNF) [<a href="rfc4234.html" title='"Augmented BNF for Syntax Specifications: ABNF"'>RFC4234</a>] notation.

      external-initial-resp = authz-id-string
      authz-id-string       = *( UTF8-char-no-nul )
      UTF8-char-no-nul      = UTF8-1-no-nul / UTF8-2 / UTF8-3 / UTF8-4
      UTF8-1-no-nul         = %x01-7F




<span class="grey">Melnikov &amp; Zeilenga         Standards Track                    [Page 29]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-30" id="page-30" name="page-30"> </a>
<span class="grey"><a href="rfc4422.html">RFC 4422</a>                          SASL                         June 2006</span>


   where the &lt;UTF8-2&gt;, &lt;UTF8-3&gt;, and &lt;UTF8-4&gt; productions are as defined
   in [<a href="rfc3629.html" title='"UTF-8, a transformation format of ISO 10646"'>RFC3629</a>].

   There are no additional challenges and responses.

   Hence, the server is to return the outcome of the authentication
   exchange.

   The exchange fails if

   -  the client has not established its credentials via external means,

   -  the client's credentials are inadequate,

   -  the client provided an empty authorization identity string and the
      server is unwilling or unable to associate an authorization
      identity with the client's credentials,

   -  the client provided a non-empty authorization identity string that
      is invalid per the syntax requirements of the applicable
      application protocol specification,

   -  the client provided a non-empty authorization identity string
      representing an identity that the client is not allowed to act as,
      or

   -  the server is unwilling or unable to provide service to the client
      for any other reason.

   Otherwise the exchange is successful.  When indicating a successful
   outcome, additional data is not provided.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/A.2.%20%20SASL%20EXTERNAL%20Examples"></a><a class="selflink" href="#appendix-A.2" name="appendix-A.2">A.2</a>.  SASL EXTERNAL Examples</span>

   This section provides examples of EXTERNAL authentication exchanges.
   The examples are intended to help the readers understand the above
   text.  The examples are not definitive.  The Application
   Configuration Access Protocol (ACAP) [<a href="rfc2244.html" title='"ACAP -- Application Configuration Access Protocol"'>RFC2244</a>] is used in the
   examples.

   The first example shows use of EXTERNAL with an empty authorization
   identity.  In this example, the initial response is not sent in the
   client's request to initiate the authentication exchange.

      S: * ACAP (SASL "DIGEST-MD5")
      C: a001 STARTTLS
      S: a001 OK "Begin TLS negotiation now"
      &lt;TLS negotiation, further commands are under TLS layer&gt;



<span class="grey">Melnikov &amp; Zeilenga         Standards Track                    [Page 30]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-31" id="page-31" name="page-31"> </a>
<span class="grey"><a href="rfc4422.html">RFC 4422</a>                          SASL                         June 2006</span>


      S: * ACAP (SASL "DIGEST-MD5" "EXTERNAL")
      C: a002 AUTHENTICATE "EXTERNAL"
      S: + ""
      C: + ""
      S: a002 OK "Authenticated"

   The second example shows use of EXTERNAL with an authorization
   identity of "fred@example.com".  In this example, the initial
   response is sent with the client's request to initiate the
   authentication exchange.  This saves a round-trip.

      S: * ACAP (SASL "DIGEST-MD5")
      C: a001 STARTTLS
      S: a001 OK "Begin TLS negotiation now"
      &lt;TLS negotiation, further commands are under TLS layer&gt;
      S: * ACAP (SASL "DIGEST-MD5" "EXTERNAL")
      C: a002 AUTHENTICATE "EXTERNAL" {16+}
      C: fred@example.com
      S: a002 NO "Cannot assume requested authorization identity"

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/A.3.%20%20Security%20Considerations"></a><a class="selflink" href="#appendix-A.3" name="appendix-A.3">A.3</a>.  Security Considerations</span>

   The EXTERNAL mechanism provides no security protection; it is
   vulnerable to spoofing by either client or server, active attack, and
   eavesdropping.  It should only be used when adequate security
   services have been established.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/Appendix%20B.%20%20Changes%20since%20RFC%202222"></a><a class="selflink" href="#appendix-B" name="appendix-B">Appendix B</a>.  Changes since <a href="rfc2222.html">RFC 2222</a></span>

   This appendix is non-normative.

   The material in <a href="rfc2222.html">RFC 2222</a> was significantly rewritten in the
   production of this document.

   <a href="rfc2222.html">RFC 2222</a>, by not stating that the authorization identity string was a
   string of Unicode characters, let alone character data, implied that
   the authorization identity string was a string of octets.

   -  The authorization identity string is now defined as a string of
      Unicode characters.  The NUL (U+0000) character is prohibited.
      While protocol specifications are responsible for defining the
      authorization identity form, as well as the Unicode string syntax
      and related semantics, mechanism specifications are responsible
      for defining how the Unicode string is carried in the
      authentication exchange.

   -  Deleted "If so, when the client does not send data first, the
      initial challenge MUST be specified as being an empty challenge."



<span class="grey">Melnikov &amp; Zeilenga         Standards Track                    [Page 31]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-32" id="page-32" name="page-32"> </a>
<span class="grey"><a href="rfc4422.html">RFC 4422</a>                          SASL                         June 2006</span>


   The following technical change was made to the EXTERNAL mechanism:

      - The authorization identity string is to be UTF-8 encoded.

      Note that protocol and mechanism specification requirements have
      been significantly tightened.  Existing protocol and mechanism
      specifications will need to be updated to meet these requirements.

Editors' Addresses

   Alexey Melnikov
   Isode Limited
   5 Castle Business Village
   36 Station Road
   Hampton, Middlesex,
   TW12 2BX, United Kingdom

   EMail: Alexey.Melnikov@isode.com
   URI:   <a href="http://www.melnikov.ca/">http://www.melnikov.ca/</a>


   Kurt D. Zeilenga
   OpenLDAP Foundation

   EMail: Kurt@OpenLDAP.org


























<span class="grey">Melnikov &amp; Zeilenga         Standards Track                    [Page 32]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-33" id="page-33" name="page-33"> </a>
<span class="grey"><a href="rfc4422.html">RFC 4422</a>                          SASL                         June 2006</span>


Full Copyright Statement

   Copyright (C) The Internet Society (2006).

   This document is subject to the rights, licenses and restrictions
   contained in <a href="https://tools.ietf.org/html/bcp78">BCP 78</a>, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY AND THE INTERNET
   ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR IMPLIED,
   INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE
   INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and <a href="https://tools.ietf.org/html/bcp79">BCP 79</a>.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   <a href="http://www.ietf.org/ipr">http://www.ietf.org/ipr</a>.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.

Acknowledgement

   Funding for the RFC Editor function is provided by the IETF
   Administrative Support Activity (IASA).







Melnikov &amp; Zeilenga         Standards Track                    [Page 33]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc4422 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:41 GMT --></html>