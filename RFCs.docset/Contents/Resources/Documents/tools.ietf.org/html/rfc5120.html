<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc5120 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:36 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="urn:ietf:rfc:5120" name="DC.Identifier"/>
<meta content='This document describes an optional mechanism within Intermediate
System to Intermediate Systems (IS-ISs) used today by many ISPs for
IGP routing within their clouds. This document describes how to run,
within a single IS-IS domain, a set of independent IP topologies that
we call Multi-Topologies (MTs). This MT extension can be used for a
variety of purposes, such as an in-band management network "on top" of
the original IGP topology, maintaining separate IGP routing domains
for isolated multicast or IPv6 islands within the backbone, or forcing
a subset of an address space to follow a different topology.
[STANDARDS-TRACK]' name="DC.Description.Abstract"/>
<meta content="Tony Przygienda &lt;prz@net4u.ch&gt;" name="DC.Creator"/>
<meta content="February, 2008" name="DC.Date.Issued"/>
<meta content="M-ISIS: Multi Topology (MT) Routing in Intermediate System to Intermediate Systems (IS-ISs)" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 5120 - M-ISIS: Multi Topology (MT) Routing in Intermediate System to Intermediate Systems (IS-ISs)</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgblue" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc5120.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc5120" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-isis-wg-multi-topology" title="draft-ietf-isis-wg-multi-topology">draft-ietf-isis...</a>] [<a href="https://datatracker.ietf.org/doc/rfc5120" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc5120" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc5120" title="Side-by-side diff">Diff2</a>]         </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                       PROPOSED STANDARD</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Network Working Group                                      T. Przygienda
Request for Comments: 5120                                       Z2 Sagl
Category: Standards Track                                        N. Shen
                                                           Cisco Systems
                                                                N. Sheth
                                                        Juniper Networks
                                                           February 2008


                <span class="h1">M-ISIS: Multi Topology (MT) Routing in</span>
          <span class="h1">Intermediate System to Intermediate Systems (IS-ISs)</span>

Status of This Memo

   This document specifies an Internet standards track protocol for the
   Internet community, and requests discussion and suggestions for
   improvements.  Please refer to the current edition of the "Internet
   Official Protocol Standards" (STD 1) for the standardization state
   and status of this protocol.  Distribution of this memo is unlimited.

Abstract

   This document describes an optional mechanism within Intermediate
   System to Intermediate Systems (IS-ISs) used today by many ISPs for
   IGP routing within their clouds.  This document describes how to run,
   within a single IS-IS domain, a set of independent IP topologies that
   we call Multi-Topologies (MTs).  This MT extension can be used for a
   variety of purposes, such as an in-band management network "on top"
   of the original IGP topology, maintaining separate IGP routing
   domains for isolated multicast or IPv6 islands within the backbone,
   or forcing a subset of an address space to follow a different
   topology.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   Maintaining multiple MTs for IS-IS [<a href="#ref-ISO10589">ISO10589</a>] [<a href="rfc1195.html" title='"Use of OSI IS-IS for routing in TCP/IP and dual environments"'>RFC1195</a>] in a
   backwards-compatible manner necessitates several extensions to the
   packet encoding and additional Shortest Path First (SPF) procedures.
   The problem can be partitioned into the forming of adjacencies and
   advertising of prefixes and reachable intermediate systems within
   each topology.  Having put all the necessary additional information
   in place, it must be properly used by MT capable SPF computation.
   The following sections describe each of the problems separately.  To
   simplify the text, "standard" IS-IS topology is defined to be MT ID
   #0 (zero).






<span class="grey">Przygienda, et al.          Standards Track                     [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc5120.html">RFC 5120</a>                         M-ISIS                    February 2008</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.1.%20%20Conventions%20Used%20in%20This%20Document"></a><a class="selflink" href="#section-1.1" name="section-1.1">1.1</a>.  Conventions Used in This Document</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in <a href="rfc2119.html">RFC 2119</a> [<a href="rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.2.%20%20Definitions%20of%20Terms%20Used%20in%20This%20Document"></a><a class="selflink" href="#section-1.2" name="section-1.2">1.2</a>.  Definitions of Terms Used in This Document</span>

   CSNP Complete Sequence Number Packet.  Used to describe all the
        contents of a link state database of IS-IS.

   DIS  Designated Intermediate System.  The intermediate system elected
        to advertise the pseudo-node for a broadcast network.

   IIH  IS-IS Hello.  Packets that are used to discover adjacent
        intermediate systems.

   LSP  Link State Packet.  Packet generated by an intermediate system
        and lists adjacent systems, prefixes, and other information.

   PSNP Partial Sequence Number Packet.  Used to request information
        from an adjacent intermediate system's link state database.

   SPF  Shortest Path First.  An algorithm that takes a database of
        nodes within a domain and builds a tree of connectivity along
        the shortest paths through the entire network.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Maintaining%20MT%20Adjacencies"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Maintaining MT Adjacencies</span>

   Each adjacency formed MUST be classified as belonging to a set of MTs
   on the interface.  This is achieved by adding a new TLV into IIH
   packets that advertises to which topologies the interface belongs.
   If MT #0 is the only MT on the interface, it is optional to advertise
   it in the new TLV.  Thus, not including such a TLV in the IIH implies
   MT ID #0 capability only.  Through this exchange of MT capabilities,
   a router is able to advertise the IS TLVs in LSPs with common MT set
   over those adjacencies.

   The case of adjacency contains multiple MTs on an interface, and if
   there exists an overlapping IP address space among the topologies,
   additional mechanisms MUST be used to resolve the topology identity
   of the incoming IP packets on the interface.  See further discussion
   in <a href="#section-8.2.2">Section 8.2.2</a> of this document.








<span class="grey">Przygienda, et al.          Standards Track                     [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc5120.html">RFC 5120</a>                         M-ISIS                    February 2008</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.1.%20%20Forming%20Adjacencies%20on%20Point-to-Point%20Interfaces"></a><a class="selflink" href="#section-2.1" name="section-2.1">2.1</a>.  Forming Adjacencies on Point-to-Point Interfaces</span>

   Adjacencies on point-to-point interfaces are formed as usual with
   IS-IS routers not implementing MT extensions.  If a local router does
   not participate in certain MTs, it will not advertise those MT IDs in
   its IIHs and thus will not include that neighbor within its LSPs.  On
   the other hand, if an MT ID is not detected in the remote side's
   IIHs, the local router MUST NOT include that neighbor within its
   LSPs.  The local router SHOULD NOT form an adjacency if they don't
   have at least one common MT over the interface.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.2.%20%20Forming%20Adjacencies%20on%20Broadcast%20Interfaces"></a><a class="selflink" href="#section-2.2" name="section-2.2">2.2</a>.  Forming Adjacencies on Broadcast Interfaces</span>

   On a LAN, all the routers on the LAN that implement the MT extension
   MAY advertise their MT capability TLV in their IIHs.  If there is at
   least one adjacency on the LAN interface that belongs to this MT, the
   MT capable router MUST include the corresponding MT IS Reachable TLV
   in its LSP, otherwise it MAY include this MT IS Reachable TLV in its
   LSP if the LAN interface participates in this MT set.

   Two routers on a LAN SHALL always establish adjacency, regardless of
   whether or not they have a common MT.  This is to ensure all the
   routers on the LAN can correctly elect the same DIS.  The IS SHOULD
   NOT include the MT IS TLV in its LSP if none of the adjacencies on
   the LAN contain this MT.

   The DIS, CSNP, and PSNP functions are not changed by MT extension.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Advertising%20MT%20Reachable%20Intermediate%20Systems%20in%20LSPs"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Advertising MT Reachable Intermediate Systems in LSPs</span>

   A router MUST include within its LSPs in the Reachable Intermediate
   Systems TLV-only adjacent nodes that are participating in the
   corresponding topology and advertise such TLVs only if it
   participates itself in the corresponding topology.  The Standard
   Reachable Intermediate Systems TLV is acting here as MT ID #0, the
   equivalent of the newly introduced MT Reachable Intermediate Systems
   TLV.  A router MUST announce the MT IS TLV when there is at least one
   adjacency on the interface that belongs to this MT, otherwise it MAY
   announce the MT IS TLV of an adjacency for a given MT if this
   interface participates in the LAN.

   Since it is not possible to prevent a router that does not understand
   MT extensions from being responsible for the generation of the
   according pseudo-node, it is possible to neither introduce special
   TLVs in the pseudo-node LSPs, nor run distinct DIS elections per MT.
   Therefore, a generated pseudo-node LSP by DIS MUST contain





<span class="grey">Przygienda, et al.          Standards Track                     [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc5120.html">RFC 5120</a>                         M-ISIS                    February 2008</span>


   in its IS Reachable TLV all nodes on the LAN as usual, regardless of
   their MT capabilities.  In other words, there is no change to the
   pseudo-node LSP construction.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20MTs%20and%20Overload%2C%20Partition%2C%20and%20Attached%20Bits"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  MTs and Overload, Partition, and Attached Bits</span>

   For each of the MTs, a router could become potentially partitioned,
   overloaded, and attached independently.  To prevent unnecessary
   complexity, MT extensions do not support MT based partition repair.
   The overload, partition, and attached bits in the LSP header only
   reflect the status of the default topology.

   Attached bit and overload bit are part of the MT TLV being
   distributed within a node's LSP fragment zero.  Since each adjacency
   can belong to different MTs, it is possible that some MTs are L2
   attached, and others are not on the same router.  The overload bit in
   the MT TLV can be used to signal the topology being overloaded.  An
   MT-based system is considered overloaded if the overload bit in the
   MT is set.

   Route leaking between the levels SHOULD only be performed within the
   same MT.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Advertising%20MT%20Specific%20IP%20Prefixes"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Advertising MT Specific IP Prefixes</span>

   Each of the MTs commands its own address space so a new TLV is
   necessary for prefixes stored in MTs other than MT ID #0.  To make
   the encoding less confusing when same prefixes are present in
   multiple MTs and accelerate SPF per MT, rather than adding a sub-TLV
   in Traffic Engineered (TE) extensions, a new TLV is introduced for
   that purpose that closely follows TE encoding [<a href="rfc3784.html" title='"Intermediate System to Intermediate System (IS-IS) Extensions for Traffic Engineering (TE)"'>RFC3784</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20MT%20SPF%20Computation"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  MT SPF Computation</span>

   Each MT MUST run its own instance of the decision process.  The
   pseudo-node LSPs are used by all topologies during computation.  Each
   non-default topology MAY have its attached bit and overload bit set
   in the MT TLV.  A reverse-connectivity check within SPF MUST follow
   the according MT to assure the bi-directional reachability within the
   same MT.

   The results of each computation SHOULD be stored in a separate
   Routing Information Base (RIB), in normal cases, otherwise
   overlapping addresses in different topologies could lead to
   undesirable routing behavior, such as forwarding loops.  The
   forwarding logic and configuration need to ensure the same MT is
   traversed from the source to the destination for packets.  The
   nexthops derived from the MT SPF MUST belong to the adjacencies



<span class="grey">Przygienda, et al.          Standards Track                     [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc5120.html">RFC 5120</a>                         M-ISIS                    February 2008</span>


   conforming to the same MT for correct forwarding.  It is recommended
   for the administrators to ensure consistent configuration of all
   routers in the domain to prevent undesirable forwarding behavior.

   No attempt is made in this document to allow one topology to
   calculate routes using the routing information from another topology
   inside SPF.  Even though it is possible to redistribute and leak
   routes from another IS-IS topology or from external sources, the
   exact mechanism is beyond the scope of this document.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20Packet%20Encoding"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  Packet Encoding</span>

   Four new TLVs are added to support MT extensions.  One of them is
   common for the LSPs and IIHs.  Encoding of Intermediate System TLV
   and IPv4 Reachable Prefixes is tied to traffic engineering extensions
   [<a href="rfc3784.html" title='"Intermediate System to Intermediate System (IS-IS) Extensions for Traffic Engineering (TE)"'>RFC3784</a>] to simplify the implementation effort.  The main reasons we
   chose to use new TLVs instead of using sub-TLVs inside existing TLV
   type-22 and type-135 are:

      1.  In many cases, multi-topologies are non-congruent, using the
          sub-TLV approach will not save LSP space;

      2.  Many sub-TLVs are already being used in TLV type-22, and many
          more are being proposed while there is a maximum limit on the
          TLV size, from the existing TLVs;

      3.  If traffic engineering or some other applications are being
          applied per topology level later, the new TLVs can
          automatically inherit the same attributes already defined for
          the "standard" topology without going through long standard
          process to redefine them per topology.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.1.%20%20Multi-Topology%20TLV"></a><a class="selflink" href="#section-7.1" name="section-7.1">7.1</a>.  Multi-Topology TLV</span>

   The TLV number of this TLV is 229.  It contains one or more MTs; the
   router is participating in the following structure:

      x  CODE - 229
      x  LENGTH - total length of the value field, it SHOULD be 2
                  times the number of MT components.
      x  VALUE - one or more 2-byte MT components, structured
                 as follows:
                                                          No. of Octets
                      +--------------------------------+
                      |O |A |R |R |        MT ID       |      2
                      +--------------------------------+





<span class="grey">Przygienda, et al.          Standards Track                     [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc5120.html">RFC 5120</a>                         M-ISIS                    February 2008</span>


      Bit O represents the OVERLOAD bit for the MT (only valid in LSP
      fragment zero for MTs other than ID #0, otherwise SHOULD be set to
      0 on transmission and ignored on receipt).

      Bit A represents the ATTACH bit for the MT (only valid in LSP
      fragment zero for MTs other than ID #0, otherwise SHOULD be set to
      0 on transmission and ignored on receipt).

      Bits R are reserved, SHOULD be set to 0 on transmission and
      ignored on receipt.

      MT ID is a 12-bit field containing the ID of the topology being
      announced.

   This MT TLV can advertise up to 127 MTs.  It is announced in IIHs and
   LSP fragment 0, and can occur multiple times.  The resulting MT set
   SHOULD be the union of all the MT TLV occurrences in the packet.  Any
   other IS-IS PDU occurrence of this TLV MUST be ignored.  Lack of MT
   TLV in hellos and fragment zero LSPs MUST be interpreted as
   participation of the advertising interface or router in MT ID #0
   only.  If a router advertises MT TLV, it has to advertise all the MTs
   it participates in, specifically including topology ID #0 also.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.2.%20%20MT%20Intermediate%20Systems%20TLV"></a><a class="selflink" href="#section-7.2" name="section-7.2">7.2</a>.  MT Intermediate Systems TLV</span>

   The TLV number of this TLV is 222.  It is aligned with extended IS
   reachability TLV type 22 beside an additional two bytes in front at
   the beginning of the TLV.

      x  CODE - 222
      x  LENGTH - total length of the value field
      x  VALUE - 2-byte MT membership plus the format of extended IS
                 reachability TLV, structured as follows:
                                                     No. of Octets
                 +--------------------------------+
                 |R |R |R |R |        MT ID       |      2
                 +--------------------------------+
                 | extended IS TLV format         |    11 - 253
                 +--------------------------------+
                 .                                .
                 .                                .
                 +--------------------------------+
                 | extended IS TLV format         |    11 - 253
                 +--------------------------------+

      Bits R are reserved, SHOULD be set to 0 on transmission and
      ignored on receipt.




<span class="grey">Przygienda, et al.          Standards Track                     [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc5120.html">RFC 5120</a>                         M-ISIS                    February 2008</span>


      MT ID is a 12-bit field containing the non-zero MT ID of the
      topology being announced.  The TLV MUST be ignored if the ID is
      zero.  This is to ensure the consistent view of the standard
      unicast topology.

      After the 2-byte MT membership format, the MT IS content is in the
      same format as extended IS TLV, type 22 [<a href="rfc3784.html" title='"Intermediate System to Intermediate System (IS-IS) Extensions for Traffic Engineering (TE)"'>RFC3784</a>].  It can contain
      up to 23 neighbors of the same MT if no sub-TLVs are used.

   This TLV can occur multiple times.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.3.%20%20Multi-Topology%20Reachable%20IPv4%20Prefixes%20TLV"></a><a class="selflink" href="#section-7.3" name="section-7.3">7.3</a>.  Multi-Topology Reachable IPv4 Prefixes TLV</span>

   The TLV number of this TLV is 235.  It is aligned with extended IP
   reachability TLV type 135 beside an additional two bytes in front.

      x  CODE - 235
      x  LENGTH - total length of the value field
      x  VALUE - 2-byte MT membership plus the format of
                 extended IP reachability TLV, structured as follows:

                                                     No. of Octets
                 +--------------------------------+
                 |R |R |R |R |        MT ID       |      2
                 +--------------------------------+
                 | extended IP TLV format         |    5 - 253
                 +--------------------------------+
                 .                                .
                 .                                .
                 +--------------------------------+
                 | extended IP TLV format         |    5 - 253
                 +--------------------------------+

      Bits R are reserved, SHOULD be set to 0 on transmission and
      ignored on receipt.

      MT ID is a 12-bit field containing the non-zero ID of the topology
      being announced.  The TLV MUST be ignored if the ID is zero.  This
      is to ensure the consistent view of the standard unicast topology.

      After the 2-byte MT membership format, the MT IPv4 content is in
      the same format as extended IP reachability TLV, type 135
      [<a href="rfc3784.html" title='"Intermediate System to Intermediate System (IS-IS) Extensions for Traffic Engineering (TE)"'>RFC3784</a>].

   This TLV can occur multiple times.






<span class="grey">Przygienda, et al.          Standards Track                     [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc5120.html">RFC 5120</a>                         M-ISIS                    February 2008</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.4.%20%20Multi-Topology%20Reachable%20IPv6%20Prefixes%20TLV"></a><a class="selflink" href="#section-7.4" name="section-7.4">7.4</a>.  Multi-Topology Reachable IPv6 Prefixes TLV</span>

   The TLV number of this TLV is 237.  It is aligned with IPv6
   Reachability TLV type 236 beside an additional two bytes in front.

      x  CODE - 237
      x  LENGTH - total length of the value field
      x  VALUE - 2-byte MT membership plus the format of IPv6
                 Reachability TLV, structured as follows:

                                                     No. of Octets
                 +--------------------------------+
                 |R |R |R |R |        MT ID       |      2
                 +--------------------------------+
                 | IPv6 Reachability format       |    6 - 253
                 +--------------------------------+
                 .                                .
                 +--------------------------------+
                 | IPv6 Reachability format       |    6 - 253
                 +--------------------------------+

      Bits R are reserved, SHOULD be set to 0 on transmission and
      ignored on receipt.

      MT ID is a 12-bit field containing the ID of the topology being
      announced.  The TLV MUST be ignored if the ID is zero.

      After the 2-byte MT membership format, the MT IPv6 context is in
      the same format as IPv6 Reachability TLV, type 236 [<a href="#ref-H01" title='"Routing IPv6 with IS-IS"'>H01</a>].

   This TLV can occur multiple times.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.5.%20%20Reserved%20MT%20ID%20Values"></a><a class="selflink" href="#section-7.5" name="section-7.5">7.5</a>.  Reserved MT ID Values</span>

   Certain MT topologies are assigned to serve predetermined purposes:

   -  MT ID #0:          Equivalent to the "standard" topology.
   -  MT ID #1:          Reserved for IPv4 in-band management
                         purposes.
   -  MT ID #2:          Reserved for IPv6 routing topology.
   -  MT ID #3:          Reserved for IPv4 multicast routing topology.
   -  MT ID #4:          Reserved for IPv6 multicast routing topology.
   -  MT ID #5:          Reserved for IPv6 in-band management
                         purposes.
   -  MT ID #6-#3995:    Reserved for IETF consensus.
   -  MT ID #3996-#4095: Reserved for development, experimental and
                         proprietary features [<a href="rfc3692.html" title='"Assigning Experimental and Testing Numbers Considered Useful"'>RFC3692</a>].




<span class="grey">Przygienda, et al.          Standards Track                     [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc5120.html">RFC 5120</a>                         M-ISIS                    February 2008</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20MT%20IP%20Forwarding%20Considerations"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  MT IP Forwarding Considerations</span>

   Using MT extension for IS-IS routing can result in multiple RIBs on
   the system.  In this section, we list some of the known
   considerations for IP forwarding in various MT scenarios.  Certain
   deployment scenarios presented here imply different trade-offs in
   terms of deployment difficulties and advantages obtained.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.1.%20%20Each%20MT%20Belongs%20to%20a%20Distinct%20Address%20Family"></a><a class="selflink" href="#section-8.1" name="section-8.1">8.1</a>.  Each MT Belongs to a Distinct Address Family</span>

   In this case, each MT related route is installed into a separate RIB.
   Multiple topologies can share the same IS-IS interface on detecting
   the incoming packet address family.  As an example, IPv4 and IPv6 can
   share the same interface without any further considerations under MT
   ISIS.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.2.%20%20Some%20MTs%20Belong%20to%20the%20Same%20Address%20Family"></a><a class="selflink" href="#section-8.2" name="section-8.2">8.2</a>.  Some MTs Belong to the Same Address Family</span>

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/8.2.1.%20%20Each%20Interface%20Belongs%20to%20One%20and%20Only%20One%20MT"></a><a class="selflink" href="#section-8.2.1" name="section-8.2.1">8.2.1</a>.  Each Interface Belongs to One and Only One MT</span>

   In this case, MTs can be used to forward packets from the same
   address family, even with overlapping addresses, since the MTs have
   their dedicated interfaces, and those interfaces can be associated
   with certain MT RIBs and FIBs.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/8.2.2.%20%20Multiple%20MTs%20Share%20an%20Interface%20with%20Overlapping%20Addresses"></a><a class="selflink" href="#section-8.2.2" name="section-8.2.2">8.2.2</a>.  Multiple MTs Share an Interface with Overlapping Addresses</span>

   Some additional mechanism is needed to select the correct RIBs for
   the incoming IP packets to determine the correct RIB to make a
   forwarding decision.  For example, if the topologies are Quality of
   Service (QoS) partitioned, then the Differentiated Services Code
   Point (DSCP) bits in the IP packet header can be utilized to make the
   decision.  Some IP headers, or even packet data information, MAY be
   checked to make the forwarding table selection, for example, the
   source IP address in the header can be used to determine the desired
   forwarding behavior.

   This topic is not unique to IS-IS or even to Multi-topology, it is a
   local policy and configuration decision to make sure the inbound
   traffic uses the correct forwarding tables.  For example, preferred
   customer packets are sent through a Layer 2 Tunneling Protocol (L2TP)
   towards the high-bandwidth upstream provider, and other packets are
   sent through a different L2TP to a normal-bandwidth provider.  Those
   mechanisms are not part of the L2TP protocol specifications.

   The generic approach of packet to multiple MT RIB mapping over the
   same inbound interface is outside the scope of this document.




<span class="grey">Przygienda, et al.          Standards Track                     [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc5120.html">RFC 5120</a>                         M-ISIS                    February 2008</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/8.2.3.%20%20Multiple%20MTs%20Share%20an%20Interface%20with%20Non-Overlapping%20Addresses"></a><a class="selflink" href="#section-8.2.3" name="section-8.2.3">8.2.3</a>.  Multiple MTs Share an Interface with Non-Overlapping Addresses</span>

   When there is no overlap in the address space among all the MTs,
   strictly speaking, the destination address space classifies the
   topology to which a packet belongs.  It is possible to install routes
   from different MTs into a shared RIB.  As an example of such a
   deployment, a special IS-IS topology can be set up for certain
   External Border Gateway Protocol (eBGP) nexthop addresses.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.3.%20%20Some%20MTs%20Are%20Not%20Used%20for%20Forwarding%20Purposes"></a><a class="selflink" href="#section-8.3" name="section-8.3">8.3</a>.  Some MTs Are Not Used for Forwarding Purposes</span>

   MT in IS-IS MAY be used even if the resulting RIB is not used for
   forwarding purposes.  As an example, multicast Reverse Path
   Forwarding (RPF) check can be performed on a different RIB than the
   standard unicast RIB, albeit an entirely different RIB is used for
   the multicast forwarding.  However, an incoming packet MUST still be
   clearly identified as belonging to a unique topology.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/9.%20%20MT%20Network%20Management%20Considerations"></a><a class="selflink" href="#section-9" name="section-9">9</a>.  MT Network Management Considerations</span>

   When multiple IS-IS topologies exist within a domain, some of the
   routers can be configured to participate in a subset of the MTs in
   the network.  This section discusses some of the options we have to
   enable operations or the network management stations to access those
   routers.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/9.1.%20%20Create%20Dedicated%20Management%20Topology%20to%20Include%20All%20the%20Nodes"></a><a class="selflink" href="#section-9.1" name="section-9.1">9.1</a>.  Create Dedicated Management Topology to Include All the Nodes</span>

   This approach is to set up a dedicated management topology or 'in-
   band' management topology.  This 'mgmt' topology will include all the
   routers need to be managed.  The computed routes in the topology will
   be installed into the 'mgmt' RIB.  In the condition that the 'mgmt'
   topology uses a set of non-overlapping address space with the default
   topology, those 'mgmt' routes can also be optionally installed into
   the default RIB.  The advantages of duplicate 'mgmt' routes in both
   RIBs include:  the network management utilities on the system does
   not have to be modified to use a specific RIB other than the default
   RIB; the 'mgmt' topology can share the same link with the default
   topology if so designed.












<span class="grey">Przygienda, et al.          Standards Track                    [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc5120.html">RFC 5120</a>                         M-ISIS                    February 2008</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/9.2.%20%20Extend%20the%20Default%20Topology%20to%20All%20the%20Nodes"></a><a class="selflink" href="#section-9.2" name="section-9.2">9.2</a>.  Extend the Default Topology to All the Nodes</span>

   Even in the case that default topology is not used on some of the
   nodes in the IP forwarding, we MAY want to extend the default
   topology to those nodes for the purpose of network management.
   Operators SHOULD set high costs on the links that belong to the
   extended portion of the default topology.  This way, the IP data
   traffic will not be forwarded through those nodes during network
   topology changes.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/10.%20%20Acknowledgments"></a><a class="selflink" href="#section-10" name="section-10">10</a>.  Acknowledgments</span>

   The authors would like to thank Andrew Partan, Dino Farinacci, Derek
   Yeung, Alex Zinin, Stefano Previdi, Heidi Ou, Steve Luong, Pekka
   Savola, Mike Shand, Shankar Vemulapalli, and Les Ginsberg for the
   discussion, their review, comments, and contributions to this
   document.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/11.%20%20Security%20Considerations"></a><a class="selflink" href="#section-11" name="section-11">11</a>.  Security Considerations</span>

   IS-IS security applies to the work presented.  No specific security
   issues with the proposed solutions are known.  The authentication
   procedure for IS-IS PDUs is the same regardless of MT information
   inside the IS-IS PDUs.

   Note that an authentication mechanism, such as the one defined in
   [<a href="rfc3567.html" title='"Intermediate System to Intermediate System (IS-IS) Cryptographic Authentication"'>RFC3567</a>], SHOULD be applied if there is high risk resulting from
   modification of multi-topology information.

   As described in <a href="#section-8.2.2">Section 8.2.2</a>, multiple topologies share an interface
   in the same address space, some mechanism beyond IS-IS needs to be
   used to select the right forwarding table for an inbound packet.  A
   misconfiguration on the system or a packet with a spoofed source
   address, for example, can lead to packet loss or unauthorized use of
   premium network resource.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/12.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-12" name="section-12">12</a>.  IANA Considerations</span>

   This document defines the following new IS-IS TLV types, which have
   already been reflected in the IANA IS-IS TLV code-point registry:

          Name                    Value

          MT-ISN                  222
          M-Topologies            229
          MT IP. Reach            235
          MT IPv6 IP. Reach       237




<span class="grey">Przygienda, et al.          Standards Track                    [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc5120.html">RFC 5120</a>                         M-ISIS                    February 2008</span>


   IANA has created a new registry, "IS-IS Multi-Topology Parameters",
   with the assignments listed in <a href="#section-7.5">Section 7.5</a> of this document and
   registration policies [<a href="rfc2434.html" title='"Guidelines for Writing an IANA Considerations Section in RFCs"'>RFC2434</a>] for future assignments.  The MT ID
   values range 6-3995 are allocated through Expert Review; values in
   the range of 3996-4095 are reserved for Private Use.  In all cases,
   assigned values are to be registered with IANA.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/13.%20%20References"></a><a class="selflink" href="#section-13" name="section-13">13</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/13.1.%20%20Normative%20References"></a><a class="selflink" href="#section-13.1" name="section-13.1">13.1</a>.  Normative References</span>

   [<a id="ref-ISO10589" name="ref-ISO10589">ISO10589</a>]  ISO.  Intermediate System to Intermediate System Routing
               Exchange Protocol for Use in Conjunction with the
               Protocol for Providing the Connectionless-Mode Network
               Service. ISO 10589, 1992.

   [<a id="ref-RFC1195" name="ref-RFC1195">RFC1195</a>]   Callon, R., "Use of OSI IS-IS for routing in TCP/IP and
               dual environments", <a href="rfc1195.html">RFC 1195</a>, December 1990.

   [<a id="ref-RFC2119" name="ref-RFC2119">RFC2119</a>]   Bradner, S., "Key words for use in RFCs to Indicate
               Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a id="ref-RFC3692" name="ref-RFC3692">RFC3692</a>]   Narten, T., "Assigning Experimental and Testing Numbers
               Considered Useful", <a href="https://tools.ietf.org/html/bcp82">BCP 82</a>, <a href="rfc3692.html">RFC 3692</a>, January 2004.

   [<a id="ref-RFC2434" name="ref-RFC2434">RFC2434</a>]   Narten, T. and H. Alvestrand, "Guidelines for Writing an
               IANA Considerations Section in RFCs", <a href="https://tools.ietf.org/html/bcp26">BCP 26</a>, <a href="rfc2434.html">RFC 2434</a>,
               October 1998.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/13.2.%20%20Informative%20References"></a><a class="selflink" href="#section-13.2" name="section-13.2">13.2</a>.  Informative References</span>

   [<a id="ref-RFC3567" name="ref-RFC3567">RFC3567</a>]   Li, T. and R. Atkinson, "Intermediate System to
               Intermediate System (IS-IS) Cryptographic
               Authentication", <a href="rfc3567.html">RFC 3567</a>, July 2003.

   [<a id="ref-RFC3784" name="ref-RFC3784">RFC3784</a>]   Smit, H. and T. Li, "Intermediate System to Intermediate
               System (IS-IS) Extensions for Traffic Engineering (TE)",
               <a href="rfc3784.html">RFC 3784</a>, June 2004.

   [<a id="ref-H01" name="ref-H01">H01</a>]      C. Hopps, <a href="https://www.google.com/search?sitesearch=tools.ietf.org%2Fhtml%2F&amp;q=inurl:draft-+%22Routing+IPv6+with+IS-IS%22" style="text-decoration: none">"Routing IPv6 with IS-IS"</a>, Work in Progress.











<span class="grey">Przygienda, et al.          Standards Track                    [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc5120.html">RFC 5120</a>                         M-ISIS                    February 2008</span>


Authors' Addresses

   Tony Przygienda
   Z2 Sagl
   Via Rovello 32
   CH-6942 Savosa
   EMail: prz@net4u.ch

   Naiming Shen
   Cisco Systems
   225 West Tasman Drive
   San Jose, CA, 95134 USA
   EMail: naiming@cisco.com

   Nischal Sheth
   Juniper Networks
   1194 North Mathilda Avenue
   Sunnyvale, CA 94089 USA
   EMail: nsheth@juniper.net
































<span class="grey">Przygienda, et al.          Standards Track                    [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc5120.html">RFC 5120</a>                         M-ISIS                    February 2008</span>


Full Copyright Statement

   Copyright (C) The IETF Trust (2008).

   This document is subject to the rights, licenses and restrictions
   contained in <a href="https://tools.ietf.org/html/bcp78">BCP 78</a>, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST AND
   THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS
   OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF
   THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and <a href="https://tools.ietf.org/html/bcp79">BCP 79</a>.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   <a href="http://www.ietf.org/ipr">http://www.ietf.org/ipr</a>.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.












Przygienda, et al.          Standards Track                    [Page 14]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc5120 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:36 GMT --></html>