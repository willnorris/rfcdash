<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc5419 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 14 Aug 2018 14:27:34 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.127" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="draft-patil-mip6-whyauthdataoption" name="DC.Relation.Replaces"/>
<meta content="urn:ietf:rfc:5419" name="DC.Identifier"/>
<meta content="January, 2009" name="DC.Date.Issued"/>
<meta content="Patil, Basavaraj" name="DC.Creator"/>
<meta content="Dommety, Gopal" name="DC.Creator"/>
<meta content="Mobile IPv6 defines a set of messages that enable the mobile node (MN)
to authenticate and perform registration with its home agent (HA).
These authentication signaling messages between the mobile node and
home agent are secured by an IPsec SA that is established between the
MN and HA. The MIP6 working group has proposed a mechanism to secure
the binding update and binding acknowledgement messages using an
authentication option, similar to the authentication option in Mobile
IPv4, carried within the messages that are exchanged between the MN
and HA to establish a binding. This document provides the
justifications as to why the authentication option mechanism is needed
for Mobile IPv6 deployment in certain deployment environments." name="DC.Description.Abstract"/>
<meta content="Why the Authentication Data Suboption is Needed for Mobile IPv6 (MIPv6)" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 5419 - Why the Authentication Data Suboption is Needed for Mobile IPv6 (MIPv6)</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgorange" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc5419.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc5419" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-mip6-whyauthdataoption" title="draft-ietf-mip6-whyauthdataoption">draft-ietf-mip6...</a>] [<a href="https://datatracker.ietf.org/doc/rfc5419" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc5419" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc5419" title="Side-by-side diff">Diff2</a>]         </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                           INFORMATIONAL</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Network Working Group                                           B. Patil
Request for Comments: 5419                                         Nokia
Category: Informational                                       G. Dommety
                                                                   Cisco
                                                            January 2009


Why the Authentication Data Suboption is Needed for Mobile IPv6 (MIPv6)

Status of This Memo

   This memo provides information for the Internet community.  It does
   not specify an Internet standard of any kind.  Distribution of this
   memo is unlimited.

Copyright Notice

   Copyright (c) 2009 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/</a>
   <a href="http://trustee.ietf.org/license-info">license-info</a>) in effect on the date of publication of this document.
   Please review these documents carefully, as they describe your rights
   and restrictions with respect to this document.

Abstract

   Mobile IPv6 defines a set of signaling messages that enable the
   mobile node (MN) to authenticate and perform registration with its
   home agent (HA).  These authentication signaling messages between the
   mobile node and home agent are secured by an IPsec security
   association (SA) that is established between the MN and HA.  The MIP6
   working group has specified a mechanism to secure the Binding Update
   (BU) and Binding Acknowledgement (BAck) messages using an
   authentication option, similar to the authentication option in Mobile
   IPv4, carried within the signaling messages that are exchanged
   between the MN and HA to establish a binding.  This document provides
   the justifications as to why the authentication option mechanism is
   needed for Mobile IPv6 deployment in certain environments.











<span class="grey">Patil &amp; Dommety              Informational                      [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc5419.html">RFC 5419</a>             Why Authdata Option for MIPv6          January 2009</span>


Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-2">2</a>
   <a href="#section-2">2</a>. Conventions Used in This Document ...............................<a href="#page-3">3</a>
   <a href="#section-3">3</a>. Background ......................................................<a href="#page-3">3</a>
   <a href="#section-4">4</a>. Applicability Statement .........................................<a href="#page-3">3</a>
   <a href="#section-5">5</a>. Justification for the Use of the Authentication Option ..........<a href="#page-5">5</a>
      5.1. Motivation for Use of the Authentication Option in
           CDMA2000 ...................................................<a href="#page-5">5</a>
      5.2. Additional Arguments for the Use of the
           Authentication Option ......................................<a href="#page-6">6</a>
   <a href="#section-6">6</a>. Application of Mobile IPv6 in CDMA Networks .....................<a href="#page-9">9</a>
      <a href="#section-6.1">6.1</a>. IPv4-Based Mobility Architecture in CDMA2000 Networks ......<a href="#page-9">9</a>
      <a href="#section-6.2">6.2</a>. IPv6-Based Mobility Architecture in CDMA2000 Networks .....<a href="#page-11">11</a>
           6.2.1. Overview of the Mobility Operation in
                  IPv6-Based CDMA2000 Networks .......................<a href="#page-11">11</a>
           <a href="#section-6.2.2">6.2.2</a>. Authentication and Security Details ................<a href="#page-12">12</a>
   <a href="#section-7">7</a>. Limitations of the Authentication Protocol Option ..............<a href="#page-14">14</a>
   <a href="#section-8">8</a>. Security Considerations ........................................<a href="#page-16">16</a>
   <a href="#section-9">9</a>. Conclusion .....................................................<a href="#page-16">16</a>
   <a href="#section-10">10</a>. Acknowledgements ..............................................<a href="#page-17">17</a>
   <a href="#section-11">11</a>. References ....................................................<a href="#page-17">17</a>
      <a href="#section-11.1">11.1</a>. Normative References .....................................<a href="#page-17">17</a>
      <a href="#section-11.2">11.2</a>. Informative References ...................................<a href="#page-18">18</a>

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   Mobile IPv6 relies on the IPsec Security Association between the
   Mobile Node (MN) and the Home Agent (HA) for authentication of the MN
   to its HA before a binding cache can be created at the HA.  An
   alternate mechanism that does not rely on the existence of the IPsec
   SA between the MN and HA for authenticating the MN is needed in
   certain deployment environments.  Such an alternate mechanism is
   outlined in [<a href="rfc4285.html" title='"Authentication Protocol for Mobile IPv6"'>RFC4285</a>].  This document is intended to capture for
   archival purposes the reasoning behind the need for the
   authentication protocol [<a href="rfc4285.html" title='"Authentication Protocol for Mobile IPv6"'>RFC4285</a>].  It should be noted that the
   alternate solution does not imply that the IPsec-based solution will
   be deprecated.  It simply means that in certain deployment scenarios
   there is a need for supporting MIPv6 without an IPsec SA between the
   MN and HA.  So the alternate solution is in addition to the IPsec-
   based mechanism specified in the base RFCs, i.e., [<a href="rfc3775.html" title='"Mobility Support in IPv6"'>RFC3775</a>],
   [<a href="rfc3776.html" title='"Using IPsec to Protect Mobile IPv6 Signaling Between Mobile Nodes and Home Agents"'>RFC3776</a>], and [<a href="rfc4877.html" title='"Mobile IPv6 Operation with IKEv2 and the Revised IPsec Architecture"'>RFC4877</a>].  It has been noted that some of the
   challenges of deploying MIPv6 in certain types of networks arose from
   dependence on the Internet Key Exchange (IKE), which did not
   integrate well with an Authentication, Authorization, and Accounting
   (AAA) backend infrastructure.  IKEv2 solves this problem.  However,
   at the time of discussion on the need for the authentication




<span class="grey">Patil &amp; Dommety              Informational                      [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc5419.html">RFC 5419</a>             Why Authdata Option for MIPv6          January 2009</span>


   protocol, "Mobile IPv6 Operation with IKEv2 and the Revised IPsec
   Architecture" [<a href="rfc4877.html" title='"Mobile IPv6 Operation with IKEv2 and the Revised IPsec Architecture"'>RFC4877</a>] was still a work in progress and, as a
   result, an alternative solution was needed.

   It should be noted that some of the arguments for justifying the
   specification of the authentication protocol have been made redundant
   as a result of the specification of Mobile IPv6 operation with IKEv2
   [<a href="rfc4877.html" title='"Mobile IPv6 Operation with IKEv2 and the Revised IPsec Architecture"'>RFC4877</a>].  However, some of the arguments discussed in this document
   are still applicable and justify usage of the authentication protocol
   in certain deployment environments.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Conventions%20Used%20in%20This%20Document"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Conventions Used in This Document</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in <a href="rfc2119.html">RFC 2119</a> [<a href="rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Background"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Background</span>

   Mobile IPv6 signaling involves several messages.  These include:

   o  The Binding Update/Binding Acknowledgment between the mobile node
      and the home agent.

   o  The route optimization signaling messages, which include the
      HoTI-HoT (Home Test Init/Home Test), CoTI-CoT (Care-of Test Init/
      Care-of Test), and BU-BAck messages between the MN and CN.  HoTI
      and HoT signaling messages are routed through the MN's HA.

   o  Mobile prefix solicitation and advertisements between the MN and
      HA.

   o  Home agent discovery by MNs.

   The signaling messages between the MN and HA are secured using the
   IPsec SA that is established between these entities.  The exception
   to this are the messages involved in the home agent discovery
   process.  [<a href="rfc4877.html" title='"Mobile IPv6 Operation with IKEv2 and the Revised IPsec Architecture"'>RFC4877</a>] specifies the establishment of the IPsec SA using
   IKEv2.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Applicability%20Statement"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Applicability Statement</span>

   The authentication option specified in "Authentication Protocol for
   MIPv6" [<a href="rfc4285.html" title='"Authentication Protocol for Mobile IPv6"'>RFC4285</a>] provides a solution for MIPv6 deployment in
   environments in which an operator may not require IPsec-based
   security for the signaling.  The reasons for an operator choosing to





<span class="grey">Patil &amp; Dommety              Informational                      [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc5419.html">RFC 5419</a>             Why Authdata Option for MIPv6          January 2009</span>


   deploy MIPv6 without mandating IPsec-based security for signaling
   messages between the MN and HA could be many.  Some of these are, for
   example:

   1.  Operators deploying MIPv6 in cellular networks may consider IPsec
       and IKEv2 as adding overhead to the limited bandwidth over the
       air interface.  The overhead here is in terms of the bytes that
       IPsec and IKEv2 introduce to the signaling.

   2.  Operators may consider the number of messages between the MN and
       HA that are required to establish the IPsec SA as too many.  The
       number of transactions chew into the capacity of limited
       bandwidth air interfaces when MIPv6 is used in such environments.
       It also adds additional latency to the establishment of the
       binding.

   3.  In many deployments, authentication credentials already exist in
       a AAA server.  These credentials are used for authenticating a
       user and authorizing network access.  The same credentials and
       security parameters cannot be reused for MIPv6 security as well,
       if IKEv1 is used.

   4.  Dynamic assignment of home agents is needed in certain
       deployments to minimize the latency of the backhaul.  This is
       done by allocating an HA in a visited network, for example.
       Requiring IPsec SAs with home agents that are dynamically
       assigned is an overhead, especially when the HA is in a visited
       network.

   5.  In certain deployments, signaling messages between the MN and HA
       may be over secure link layers.  The lower layers provide
       ciphering and security for the messages, and hence the need for
       IPsec to do the same for MIPv6 messages does not exist.

   One example of networks that have such characteristics are Code
   Division Multiple Access (CDMA) networks as defined in the 3GPP2
   [3GPP2 X.S0011-002-D] specification.  Mobile WiMAX (Worldwide
   Interoperability for Microwave Access), which is based on IEEE
   802.16e, also specifies in the network architecture the use of MIPv6,
   with the default security for signaling being the authentication
   protocol [<a href="rfc4285.html" title='"Authentication Protocol for Mobile IPv6"'>RFC4285</a>].  The WiMAX network architecture specifications
   are available at [<a href="#ref-WiMAX-NWG" title='"WiMAX Network Architecture - WiMAX End-to-End Network Systems Architecture"'>WiMAX-NWG</a>].









<span class="grey">Patil &amp; Dommety              Informational                      [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc5419.html">RFC 5419</a>             Why Authdata Option for MIPv6          January 2009</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Justification%20for%20the%20Use%20of%20the%20Authentication%20Option"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Justification for the Use of the Authentication Option</span>

   The following two sections provide the reasoning for why the
   authentication option-based registration process for Mobile IPv6 is
   needed.  <a href="#section-5.1">Section 5.1</a> provides key arguments for the use of the
   authentication option.  <a href="#section-5.2">Section 5.2</a> provides further explanation and
   additional motivations for the authentication option.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.1.%20%20Motivation%20for%20Use%20of%20the%20Authentication%20Option%20in%20CDMA2000"></a><a class="selflink" href="#section-5.1" name="section-5.1">5.1</a>.  Motivation for Use of the Authentication Option in CDMA2000</span>
<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/Wireless%20Networks"></a>      Wireless Networks</span>

   CDMA2000 networks deployed and operational today use Mobile IPv4 for
   IP mobility.  Operators have gained a significant amount of
   operational experience in the process of deploying and operating
   these networks. 3GPP2 has specified Mobile IPv6 operation in the
   [3GPP2 X.S0011-002-D] specification.  The following are the
   deployment constraints that existing CDMA networks have to deal with
   when deploying mobility service based on IPv6:

   o  Operators intend to leverage the Mobile IPv4 deployment and
      operational experience by ensuring that Mobile IPv6 has a similar
      deployment and operating model.

   o  Operators will have two parallel networks: one that offers IPv4
      mobility with MIPv4 and another providing IPv6 mobility using
      MIPv6.

   o  The same backend subscriber profile database, security keys, etc.
      are intended to be used for both Mobile IPv4 and Mobile IPv6
      service.  However, from a security standpoint, the reuse of the
      same keys with multiple algorithms/protocols is a bad idea.

   o  The same user-configuration information, i.e., the identity and
      keys associated with a user, will be used for IP mobility service
      in IPv4 and/or IPv6 networks.  The only security association that
      is preconfigured is a shared secret between the mobile node and
      the home AAA server.  This is in contrast with an earlier version
      of the Mobile IPv6 model, which required an IPsec SA between the
      MN and HA.  At the time of this writing, the IKEv2-based solution
      for establishing an IPsec SA [<a href="rfc4877.html" title='"Mobile IPv6 Operation with IKEv2 and the Revised IPsec Architecture"'>RFC4877</a>] was not available.  IKEv2
      does enable integration with a AAA backend.

   o  At the time of specifying the authentication protocol, the Mobile
      IPv6 specification did not support the dynamic assignment of home
      agent and home address.  However, work done in the MIP6 working
      group on bootstrapping of Mobile IPv6 as specified in [<a href="rfc5026.html" title='"Mobile IPv6 Bootstrapping in Split Scenario"'>RFC5026</a>]
      and "MIPv6-Bootstrapping for the Integrated Scenario" [<a href="#ref-BOOT" title='"MIP6- Bootstrapping for the Integrated Scenario"'>BOOT</a>]
      addresses this deficiency.  The mechanism defined in



<span class="grey">Patil &amp; Dommety              Informational                      [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc5419.html">RFC 5419</a>             Why Authdata Option for MIPv6          January 2009</span>


      "Authentication Protocol for Mobile IPv6" [<a href="rfc4285.html" title='"Authentication Protocol for Mobile IPv6"'>RFC4285</a>] is capable of
      handling authentication even in the case of dynamic assignments
      (and is similar to what is used in current MIPv4 deployments).

   Consequently, MIPv6 as specified at the time the authentication
   protocol was being specified, did not satisfy many of the deployment
   requirements.  "Authentication Protocol for MIPv6" [<a href="rfc4285.html" title='"Authentication Protocol for Mobile IPv6"'>RFC4285</a>] along
   with "MN Identifier Option for MIPv6" [<a href="rfc4283.html" title='"Mobile Node Identifier Option for Mobile IPv6 (MIPv6)"'>RFC4283</a>] are enabling the
   deployment of Mobile IPv6 in a manner that is similar to what is
   deployed in CDMA2000 networks today.  This authentication model is
   very similar to the one adopted by the MIP4 WG.  This is explained in
   detail in [3GPP2 X.S0011-002-D].

   The earlier MIPv6 deployment model, which requires an IPsec SA that
   is either configured manually or established using IKE, does not have
   synergy with the deployment models of 3GPP2 or WiMAX networks.  This
   issue has however been alleviated with the publication of <a href="rfc4877.html">RFC 4877</a>,
   which enables the establishment of an IPsec SA using IKEv2 and which
   is also able to integrate with the backend AAA infrastructure that is
   responsible for the authentication of the MN in 3GPP2 and WiMAX
   networks.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.2.%20%20Additional%20Arguments%20for%20the%20Use%20of%20the%20Authentication%20Option"></a><a class="selflink" href="#section-5.2" name="section-5.2">5.2</a>.  Additional Arguments for the Use of the Authentication Option</span>

   The use of IPsec for performing Registration with a home agent is not
   always an optimal solution.  While it is true that IPsec is viewed as
   an integral part of the IPv6 stack, it is still a considerable
   overhead from a deployment perspective of using IPsec as the security
   mechanism for the signaling messages between the MN and HA.  This
   statement is a result of experience gained from deployment of Mobile
   IPv4.  MIPv4 does not rely on IPsec for securing the Registration
   signaling messages.

   Deployment of Mobile IPv6 on a large scale is possible only when the
   protocol is flexible for being adapted to various scenarios.  The
   scenario being considered is the deployment in CDMA2000 networks or
   WiMAX networks.  CDMA2000 networks are currently deployed in many
   countries today.  WiMAX deployments in many countries began in 2008.
   The packet data network architecture of CDMA2000 [3GPP2
   X.S0011-002-D] includes a MIPv4 foreign agent/home agent and a
   RADIUS-based AAA infrastructure for Authentication, Authorization,
   and Accounting purposes.  The AAA infrastructure provides
   authentication capability in the case of Mobile IPv4.

   Typically, the mobile node shares a security association with the
   AAA-Home entity.  This is the preferred mode of operation over having
   a shared secret between the MN and HA because the AAA-Home entity
   provides a central location for provisioning and administering the



<span class="grey">Patil &amp; Dommety              Informational                      [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc5419.html">RFC 5419</a>             Why Authdata Option for MIPv6          January 2009</span>


   shared secrets for a large number of mobiles (millions).  This mode
   of operation also makes dynamic home address and dynamic home agent
   assignment easier.  A similar approach is needed for the deployment
   of Mobile IPv6 in these networks.  There is no practical mechanism to
   use IPsec directly with the AAA infrastructure without the use of
   IKEv2 or some other mechanism that enables the establishment of the
   IPsec SA between the MN and HA.

   Mobile IPv6 as specified in [<a href="rfc3775.html" title='"Mobility Support in IPv6"'>RFC3775</a>] and [<a href="rfc3776.html" title='"Using IPsec to Protect Mobile IPv6 Signaling Between Mobile Nodes and Home Agents"'>RFC3776</a>] is based on a
   very specific model for deployment.  It anticipates the mobile node's
   having a static home IPv6 address and a designated home agent.  This
   is not practical in most deployment scenarios being considered.  An
   IPsec SA is expected to be created via manual keying or established
   dynamically via IKE or IKEv2.  These assumptions do not necessarily
   fit in very well for the deployment model envisioned in CDMA2000 or
   WiMAX networks.  These limitations have however been overcome as a
   result of the bootstrapping specifications as per [<a href="rfc5026.html" title='"Mobile IPv6 Bootstrapping in Split Scenario"'>RFC5026</a>] and
   "MIPv6-Bootstrapping for the Integrated Scenario" [<a href="#ref-BOOT" title='"MIP6- Bootstrapping for the Integrated Scenario"'>BOOT</a>].

   CDMA2000 and WiMAX networks would prefer to allocate home addresses
   to MNs on a dynamic basis.  The advantage of doing so is the fact
   that the HA can be assigned on a link that is close to the MN's point
   of attachment.  While route optimization negates the benefit of
   having a home agent on a link close to the MN, it cannot always be
   guaranteed that the MN and correspondent node (CN) will use or
   support route optimization.  There may also be instances where the
   operator prefers to not allow route optimization for various reasons,
   such as accounting aggregation or enforcing service contracts.  In
   such cases, an HA that is close to the MN's point of attachment
   reduces the issues of latency, etc. of forward and reverse tunnelling
   of packets between the MN and HA.

   CDMA2000 networks that are operational today have large numbers of
   subscribers who are authenticated via the AAA infrastructure.
   Deployment of Mobile IPv6 should leverage the existing AAA
   infrastructure.  The security model needed in these networks is an SA
   between the MN and AAA-Home entity.  This is the primary security
   association that should be used for authenticating and authorizing
   users to utilize MIPv6 service.  This SA is then used for
   establishing session keys between the MN and the dynamically assigned
   HA for authenticating subsequent Binding Updates and Binding
   Acknowledgements between them.  Establishing an IPsec SA between the
   MN and HA using AAA infrastructure was not specified for Mobile IPv6
   at the time the authentication protocol was being specified.  <a href="rfc3776.html">RFC</a>
   <a href="rfc3776.html">3776</a> explains how IKE is used for establishing the SA between the MN
   and HA.  [<a href="rfc4877.html" title='"Mobile IPv6 Operation with IKEv2 and the Revised IPsec Architecture"'>RFC4877</a>] has been published subsequently and hence the
   issue of establishing an IPsec SA dynamically between the MN and HA
   no longer exists.  CDMA2000 network operators would prefer to assign



<span class="grey">Patil &amp; Dommety              Informational                      [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc5419.html">RFC 5419</a>             Why Authdata Option for MIPv6          January 2009</span>


   home addresses to the MN on a dynamic basis -- preferably using the
   AAA infrastructure, which contains subscriber profile and capability
   information.  This was not possible prior to the specification of the
   bootstrapping mechanism in [<a href="rfc5026.html" title='"Mobile IPv6 Bootstrapping in Split Scenario"'>RFC5026</a>].

   A large subset of MNs in CDMA2000 networks do not have IKE
   capability.  As a result, the use of <a href="rfc3776.html">RFC 3776</a> for setting up the
   MN-HA IPsec SA is not an option.  It should also be noted that IKE
   requires several transactions before it is able to establish the
   IPsec SA.  [<a href="rfc4877.html" title='"Mobile IPv6 Operation with IKEv2 and the Revised IPsec Architecture"'>RFC4877</a>] specifies the establishment of an IPsec SA
   between the MN and HA using IKEv2.  It is possible that not all MNs
   in a deployment will support IKEv2, and hence an alternative
   mechanism provides the needed flexibility.

   CDMA2000 network operators are extremely conscious in terms of the
   number of messages sent and received over the air interface for
   signaling.  The overhead associated with sending/receiving a large
   number of signaling messages over the air interface has a direct
   impact on the overall capacity and cost for the operator.
   Optimization of the number of messages needed for using a service
   like Mobile IPv6 is of great concern.  As a result, the use of IKE
   for Mobile IPv6 deployment is considered as being suboptimal in
   certain network architectures and deployment scenarios from the
   perspective of message overhead.

   Another downside of IKE for setting up the IPsec SA between the MN
   and HA is that IKE does not integrate very well with the RADIUS-based
   AAA backend.  Since operators rely on the AAA infrastructure to
   provision subscribers as well as define profiles, keys, etc. in the
   AAA-Home, there is no getting away from the use of AAA in CDMA2000
   networks.  IKEv2 does address this problem.  However, from a timeline
   perspective, the availability of IKEv2 specifications for "Mobile
   IPv6 Operation with IKEv2 and the Revised IPsec Architecture"
   [<a href="rfc4877.html" title='"Mobile IPv6 Operation with IKEv2 and the Revised IPsec Architecture"'>RFC4877</a>] and its implementations did not meet the need of operators
   that were relying on 3GPP2 specifications.  With the specification of
   IKEv2 and publication of <a href="rfc4877.html">RFC 4877</a>, integration with AAA backends is
   no longer an issue.

   In summary, the model of Mobile IPv6 deployment that mandated the
   existence of an IPsec SA between the MN and HA, as specified in RFCs
   3775 and 3776, was too rigid and did not meet the requirements of
   operators building networks based on the CDMA2000 [3GPP2
   X.S0011-002-D] specifications.  To address this shortcoming, the
   authentication protocol [<a href="rfc4285.html" title='"Authentication Protocol for Mobile IPv6"'>RFC4285</a>] was specified.







<span class="grey">Patil &amp; Dommety              Informational                      [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc5419.html">RFC 5419</a>             Why Authdata Option for MIPv6          January 2009</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20Application%20of%20Mobile%20IPv6%20in%20CDMA%20Networks"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  Application of Mobile IPv6 in CDMA Networks</span>

   Sections <a href="#section-6.1">6.1</a> and <a href="#section-6.2">6.2</a> describe the IPv4- and IPv6-based mobility
   architectures in CDMA networks, respectively.  For further details
   associated with the description below, please refer to <a href="#section-5">Section 5</a>,
   "MIP6 Operation", in the 3GPP2 specification [3GPP2 X.S0011-002-D].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.1.%20%20IPv4-Based%20Mobility%20Architecture%20in%20CDMA2000%20Networks"></a><a class="selflink" href="#section-6.1" name="section-6.1">6.1</a>.  IPv4-Based Mobility Architecture in CDMA2000 Networks</span>

   The figure below shows a high level view of the key network elements
   that play a role in providing IP mobility using Mobile IPv4.

                 +--------------+           +----------------------+
                 |   +------+   |           |   +------+           |
                 |   |      |   |           |   |      |           |
                 |   |F-AAA |   |           |   |H-AAAH|           |
                 |   |      +-------------------+      |           |
                 |   +---+--+   |           |   +--+---+           |
                 |       |      |           |      |               |
                 |       |      |           |      |               |
      +------+   |   +---+--+   |           |   +--+---+           |
      |      |   |   |      |   |           |   |      |           |
      |  MN  +- -|- -+ PDSN + --  --  --  --  - +  HA  |           |
      |      |   |   |  /FA |   |           |   |      |           |
      +------+   |   +------+   |           |   +------+           |
                 |              |           |                      |
                 +--------------+           +----------------------+

   Figure 1: CDMA2000 Packet Data Network Architecture with Mobile IPv4

   The CDMA mobility architecture based on MIPv4 is explained below.  In
   this architecture, mobility is tightly integrated with the AAA
   infrastructure.  The Mobile Node is configured with an NAI (Network
   Access Identifier) and an MN-AAA key.  The MN-AAA key is a shared key
   that is shared between the MN and the home AAA server.

   Below is the access link setup procedure:

   (1)  Bring up the PPP on the MN/PDSN (access router link).  PPP
        authentication is skipped.  Mobile IP authentication is
        performed via the FA (Foreign Agent).

   (2)  The PDSN (Packet Data Serving Node) sends a Mobile IP challenge
        to the MN on the PPP link (<a href="rfc3012.html">RFC 3012</a>).







<span class="grey">Patil &amp; Dommety              Informational                      [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc5419.html">RFC 5419</a>             Why Authdata Option for MIPv6          January 2009</span>


   (3)  The MN sends a MIP Registration Request (RRQ), which includes
        the user's NAI, challenge, and MN-AAA extension that has a
        challenge response, and an MN-HA extension, which is generated
        based on the MN-HA key.

   (4)  The PDSN extracts the MIP NAI, challenge, and the response to
        the challenge, from the MIP MN-AAA extension, and sends an
        Access Request to the F-AAA (challenge/response using MD5).

   (5)  The F-AAA (Foreign AAA) may forward it to the H-AAA (Home AAA)
        if needed (based on realm).

   (6)  AAA authenticates the CHAP-challenge/response and returns
        "success" if authentication succeeds.

   (7)  The PDSN forwards the Registration Request (RRQ) to the HA.

   (8)  The HA authenticates the RRQ (MHAE (Mobile-Home Authentication
        Extension)).  The HA may optionally authenticate with the AAA
        infrastructure (just like the PDSN in #4).

   (9)  If authentication is successful, the HA creates a binding and
        sends a success Registration Reply (RRP) to the PDSN.

   (10) The PDSN creates a visitor entry and forwards the RRP to the MN.


























<span class="grey">Patil &amp; Dommety              Informational                     [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc5419.html">RFC 5419</a>             Why Authdata Option for MIPv6          January 2009</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.2.%20%20IPv6-Based%20Mobility%20Architecture%20in%20CDMA2000%20Networks"></a><a class="selflink" href="#section-6.2" name="section-6.2">6.2</a>.  IPv6-Based Mobility Architecture in CDMA2000 Networks</span>

   Due to the need for co-existence with MIPv4, and having the same
   operational model, the 3GPP2 standards body is adopting the following
   mobility architecture for MIPv6.

                        Access Domain                  Home Domain
                  +--------------+           +----------------------+
                  |   +------+   |           |   +------+           |
                  |   |      |   |           |   |      |           |
                  |   |F-AAA |   |           |   |H-AAA |           |
                  |   |      +-------------------+      |           |
                  |   +---+--+   |           |   +--+---+           |
                  |       |      |           |      |               |
                  |       |      |           |      |               |
       +------+   |   +---+--+   |           |   +--+---+           |
       |      |   |   |      |   |           |   |      |           |
       |  MN  +- -|- -+ PDSN + --  --  --  --  - +  HA  |           |
       |      |   |   |  /AR |   |           |   |      |           |
       +------+   |   +------+   |           |   +------+           |
                  |              |           |                      |
                  +--------------+           +----------------------+

   Figure 2: CDMA2000 Packet Data Network Architecture with Mobile IPv6

   The Mobile Node is configured with an NAI (Network Access Identifier)
   and an MN-AAA key.  The MN-AAA key is a shared key between the MN and
   the home AAA server.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/6.2.1.%20%20Overview%20of%20the%20Mobility%20Operation%20in%20IPv6-Based%20CDMA2000"></a><a class="selflink" href="#section-6.2.1" name="section-6.2.1">6.2.1</a>.  Overview of the Mobility Operation in IPv6-Based CDMA2000</span>
<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/Networks"></a>        Networks</span>

   The following steps explain at a very generic level the operation of
   IP mobility in CDMA2000 networks:

   (1)  The MN performs link-layer establishment.  This includes setting
        up the PPP link.  PPP-CHAP authentication is performed.  This is
        authenticated by the PDSN/AR (Access Router) by sending an
        Access Request to the F-AAA (and to the H-AAA when/if needed).
        Optionally, the MN acquires bootstrap information from the Home
        Network (via the PDSN; the PDSN receives this information in
        Access Accept).  The bootstrap information includes home address
        and home agent assignment.  The MN uses stateless DHCPv6
        [<a href="rfc3736.html" title='"Stateless Dynamic Host Configuration Protocol (DHCP) Service for IPv6"'>RFC3736</a>] to obtain the bootstrap information from the PDSN.







<span class="grey">Patil &amp; Dommety              Informational                     [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc5419.html">RFC 5419</a>             Why Authdata Option for MIPv6          January 2009</span>


   (2)  The MN begins to use the home address (HoA) that was assigned in
        step 1.  If no HoA was assigned at step 1, the MN generates
        (auto-configures) an IPv6 global unicast address based on the
        prefix information received at step 1.

   (3)  The MN sends a Binding Update to the selected home agent.  In
        the BU, the MN includes the NAI option, timestamp option, and
        MN-AAA auth option.

   (4)  The HA extracts the NAI, authenticator, etc. from the BU and
        sends an Access Request to the Home RADIUS server.

   (5)  The Home RADIUS server authenticates and authorizes the user and
        sends back a RADIUS Access Accept to the HA indicating
        successful authentication and authorization.

   (6)  The HA performs a replay check with the ID field in the received
        BU.  The HA also performs proxy Duplicate Address Detection
        (DAD) on the MN's home address (global) using proxy Neighbor
        Solicitation as specified in [<a href="rfc4861.html" title='"Neighbor Discovery for IP version 6 (IPv6)"'>RFC4861</a>].

   (7)  Assuming that proxy DAD is successful, the HA sends back a
        Binding Acknowledgment to the MN.  In this BAck message, the HA
        includes the MN-HA mobility option, NAI mobility option, and ID
        mobility option.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/6.2.2.%20%20Authentication%20and%20Security%20Details"></a><a class="selflink" href="#section-6.2.2" name="section-6.2.2">6.2.2</a>.  Authentication and Security Details</span>

   Access Link Setup, Access Authentication, and Bootstrapping:

   (1)  The MN brings up a PPP session.  The PDSN triggers the MN to
        perform CHAP authentication, as part of access authentication,
        while bringing up the PPP link.

   (2)  The MN is authenticated using the PPP-CHAP by the H-AAA (Home
        AAA), via the F-AAA (Foreign AAA).

   (3)  The H-AAA may optionally send the HoA and HA IP address to the
        PDSN for bootstrapping the MN (skipping details).












<span class="grey">Patil &amp; Dommety              Informational                     [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc5419.html">RFC 5419</a>             Why Authdata Option for MIPv6          January 2009</span>


   Mobile IPv6 Authentication:

   The call flow for the initial authentication (the numbers in the
   parentheses correspond to the explanation below):

     MN                                    HA                    H-AAA
      |              BU to HA (4)           | RADIUS Access-ReQ(5)
      |------------------------------------&gt;|-------------------&gt;|(6)
      | (includes NAI option, MN-ID option, |                    |
      | Mesg ID option, MN-AAA auth option) |RADIUS Access Accept|(7)
      |
                                            |&lt;-------------------|
      |                                     |                    |
      |                             HA/AAAH authenticates MN
      |
      |                                     |(8)
      |
      |                                     |
      |
      |              BAck to MN    (9)        |
      |
      |&lt;------------------------------------|--------------------|
      | (including MN-ID option,            | (10)
      |  Message ID option,                 |
      |  MN-HA auth options)                |                    |

             Figure 3: Flow Diagram for Initial Authentication

   (4)  The MN sends a Binding Update (BU) to the HA.  The Binding
        Update is authenticated using the MN-AAA option.  The
        authenticator in the MN-AAA option is calculated using the hash
        of the BU and MN-AAA shared key.  It uses the HMAC_SHA1
        algorithm.  The Security Parameter Index (SPI) field in MN-AAA
        is set to 3 (as per [<a href="rfc4285.html" title='"Authentication Protocol for Mobile IPv6"'>RFC4285</a>]).  The BU also includes the NAI
        and timestamp, among other details.  The hash of the BU includes
        the 'timestamp' option and thus provides proof of liveness to
        prevent replay.

   (5)  The HA, on receiving the BU, extracts the NAI, timestamp, and
        authenticator from the MN-AAA option, and generates the hash of
        the BU.  The HA sends an Access Request to the AAA and puts this
        information in 3GPP2-defined VSAs (Vendor Specific Attributes).
        The NAI is inserted in the username option in the Access Request
        message.  The other attributes sent are: the timestamp option,
        the hash of the BU (till SPI field of MN-AAA auth option), and
        the authentication data from the MN-AAA auth option.





<span class="grey">Patil &amp; Dommety              Informational                     [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc5419.html">RFC 5419</a>             Why Authdata Option for MIPv6          January 2009</span>


   (6)  AAA (RADIUS server that interprets these attributes)
        authenticates the MN based on the hash of the BU and the
        authenticator.  Proceed to step 7.

   (7)  AAA calculates a session key based on the MN-AAA shared secret
        and timestamp, and sends this to the HA in an Access Accept (in
        a 3GPP2-defined VSA).

   (8)  The HA creates a binding and a security association per
        Authentication Protocol for MIPv6 [<a href="rfc4285.html" title='"Authentication Protocol for Mobile IPv6"'>RFC4285</a>].  The key for this
        association is retrieved from the Access Accept and is referred
        to as the session key.  The HA associates a fixed SPI of 5 with
        this SA, and is associated with the binding for the MN.  (The
        description of this step skips the details for timestamp
        processing at the HA.)

   (9)  The HA sends a Binding Acknowledgement (BAck) to the MN.  The
        BAck has the MN-HA authentication option, authenticated using
        the session key.  This option has the SPI set to 5.

   (10) On receiving a BAck, the MN calculates the session key (using
        the same method as AAA) and associates it with an SPI value of
        5.

   The MN derives the session key and SA using the timestamp in the BU
   that the MN sent and the MN-AAA shared key.  The MN uses this key to
   authenticate the MN-HA option in the Binding Ack.  If authentication
   is successful, the MN creates a security association with SPI=5.
   This key is used to authenticate further BUs to the HA using the
   MN-HA auth option.  Once the binding lifetime expires and the binding
   is deleted, the binding as well as the security association based on
   the integrity key is removed at the MN and HA.

   Migration from MobileIPv4 to MobileIPv6 utilizes the same network
   architecture and, specifically, the same AAA infrastructure.  Thus,
   it is natural to have similar signaling in MIPv6 as in MIPv4,
   specifically the authentication with AAA infrastructure.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20Limitations%20of%20the%20Authentication%20Protocol%20Option"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  Limitations of the Authentication Protocol Option</span>

   While the authentication protocol as specified in [<a href="rfc4285.html" title='"Authentication Protocol for Mobile IPv6"'>RFC4285</a>] provides
   Mobile IPv6 [<a href="rfc3775.html" title='"Mobility Support in IPv6"'>RFC3775</a>] deployments a certain degree of flexibility, it
   does have a few disadvantages as well.  These are:

   (1)  The route optimization feature specified in <a href="rfc3775.html">RFC 3775</a> requires a
        secure transport (IPsec/ESP (Encapsulating Security Payload)
        mode) between the MN and HA.  In cases where the authentication
        protocol [<a href="rfc4285.html" title='"Authentication Protocol for Mobile IPv6"'>RFC4285</a>] is used as the means for securing the MIPv6



<span class="grey">Patil &amp; Dommety              Informational                     [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc5419.html">RFC 5419</a>             Why Authdata Option for MIPv6          January 2009</span>


        signaling between the MN and HA, route optimization should be
        switched off unless the security of the signaling between the MN
        and HA can be guaranteed via other means (such as link-layer
        security in the case of 3GPP2 networks).

   (2)  The MIPv6 protocol is responsible for the security of the
        signaling messages as opposed to relying on IPsec for providing
        the security.

   (3)  In 3GPP2 networks, link-layer security mechanisms, ingress
        filtering at the PDSN, and various network domain security
        mechanisms largely ensure that reverse tunnelled packets
        received by the HA do not have spoofed source addresses, and
        that their contents have not been modified.  This implies the HA
        can determine the specific MN that sent the packet simply by
        verifying the outer-source IP address matches the currently
        registered care-of address.  Authentication of payload packets
        can be necessary for, e.g.:

        -     Authenticating signaling messages other than BU/BAck
              between the MN and HA, such as ICMPv6, MLD, and DHCPv6.

        -     Enforcing access control to the network behind the HA.

        -     Accounting or other flow-specific processing performed by
              the HA.

              This means the authentication option is of limited
              applicability in environments where the HA can receive
              reverse-tunneled packets with spoofed source IP addresses
              and/or modified contents.

   (4)  As described in [<a href="rfc4285.html" title='"Authentication Protocol for Mobile IPv6"'>RFC4285</a>], the authentication option assumes
        that the MN-AAA shared key and security association are created
        by out-of-band mechanisms.  These mechanisms are specific to
        specific deployment environments.  IKEv2, on the other hand,
        supports a wide range of authentication mechanisms, such as
        certificates and Extensible Authentication Protocol (EAP)
        methods, and is independent of the access network technology
        being used.  However, it would be possible to specify a similar
        authentication and key management protocol for the
        authentication option in the future.

   (5)  Sending the long-term user identity (NAI) in the clear raises
        privacy concerns.  These concerns are addressed by access
        network and network domain security mechanisms in 3GPP2
        networks, but do limit the applicability in networks where
        sniffing other users' traffic is possible.



<span class="grey">Patil &amp; Dommety              Informational                     [Page 15]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc5419.html">RFC 5419</a>             Why Authdata Option for MIPv6          January 2009</span>


   (6)  <a href="rfc4285.html">RFC 4285</a> does not specify a mechanism for creating the MN-HA
        shared key and SA from the MN-AAA SA (unlike similar Mobile IPv4
        mechanisms defined in [<a href="rfc3957.html" title='"Authentication, Authorization, and Accounting (AAA) Registration Keys for Mobile IPv4"'>RFC3957</a>]), and thus relies on deployment-
        specific mechanisms not standardized in the IETF.

   (7)  The authentication option does not support negotiation of
        cryptographic algorithms.

   (8)  The replay protection mechanisms in [<a href="rfc4285.html" title='"Authentication Protocol for Mobile IPv6"'>RFC4285</a>] rely on
        timestamps, and thus require reasonably synchronized clocks (by
        default, +/- 7 seconds).  This assumes the MN implements, and is
        configured to use, some mechanism for synchronizing its clock.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20Security%20Considerations"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  Security Considerations</span>

   When MIPv6 signaling messages use IPsec with ESP encapsulation, they
   are accorded privacy on the links over which the messages traverse.
   When MIPv6 signaling messages are secured using the authentication
   protocol, such ciphering capability will have to be enabled by the
   underlying link layers.  It should be noted that the MIPv6 signaling
   messages are susceptible to snooping/sniffing when the authentication
   protocol [<a href="rfc4285.html" title='"Authentication Protocol for Mobile IPv6"'>RFC4285</a>] is used.  Route optimization messages need to be
   secured between the MN and HA and this is not possible with the
   authentication protocol.  However, route optimization is not
   supported in the current specification of the authentication protocol
   in [<a href="rfc4285.html" title='"Authentication Protocol for Mobile IPv6"'>RFC4285</a>].

   Security issues with <a href="rfc4285.html">RFC 4285</a> are specifically:

   1.  Key length.  This is being addressed in [<a href="#ref-AUTH-PRO" title='"Authentication Protocol for Mobile IPv6"'>AUTH-PRO</a>].

   2.  The keys used for securing the signaling between the MN and HA
       are derived from a security association that exists between the
       MN and AAA.  The MIPv6 keys, which are bootstrapped from the MN-
       AAA SA, are transient.  Limiting the lifetime of the keys to
       shorter periods should be recommended.

   3.  Location privacy is an issue in the absence of lower-layer
       security in the case of shared links.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/9.%20%20Conclusion"></a><a class="selflink" href="#section-9" name="section-9">9</a>.  Conclusion</span>

   Mobile IPv6 was published as a Standards Track RFC [<a href="rfc3775.html" title='"Mobility Support in IPv6"'>RFC3775</a>] in 2004.
   Deployment of this protocol on a large scale is in the interest of
   the IETF and the working group, as well as that of many people who
   have worked on this.  A rigid model for deployment will cause the
   protocol to be limited to an academic exercise only.  It is extremely
   critical that the working group consider the needs of the industry



<span class="grey">Patil &amp; Dommety              Informational                     [Page 16]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc5419.html">RFC 5419</a>             Why Authdata Option for MIPv6          January 2009</span>


   and the deployment scenarios, and address them accordingly.  This
   document captures the reasoning behind the need for the
   authentication protocol, which has been published as <a href="rfc4285.html">RFC 4285</a>.  <a href="rfc4877.html">RFC</a>
   <a href="rfc4877.html">4877</a> has alleviated some of the issues that have been of primary
   concern and were motivators for the authentication protocol.
   However, the IETF should consider the architectures of networks such
   as 3GPP2 and WiMAX and their security models, and enable deployment
   of Mobile IPv6 without requiring IPsec.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/10.%20%20Acknowledgements"></a><a class="selflink" href="#section-10" name="section-10">10</a>.  Acknowledgements</span>

   The authors would like to thank Alpesh Patel, AC Mahendra, Kuntal
   Chowdhury, and Vijay Devarapalli for their input and discussions.
   Jari Arkko has reviewed the ID and provided valuable feedback.
   Thomas Narten has provided valuable reviews and made significant
   improvements to the text in this document.  In his role as the IETF
   liaison to 3GPP2, Thomas Narten has ensured that the IETF understands
   the 3GPP2 requirements.  Pasi Eronen, in his role as the Security AD,
   has reviewed and helped improve the document.  Vidya Narayanan has
   reviewed the document from a security directorate perspective and
   provided input that has been incorporated.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/11.%20%20References"></a><a class="selflink" href="#section-11" name="section-11">11</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/11.1.%20%20Normative%20References"></a><a class="selflink" href="#section-11.1" name="section-11.1">11.1</a>.  Normative References</span>

   [<a id="ref-RFC2119" name="ref-RFC2119">RFC2119</a>]              Bradner, S., "Key words for use in RFCs to
                          Indicate Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>,
                          <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a id="ref-RFC3736" name="ref-RFC3736">RFC3736</a>]              Droms, R., "Stateless Dynamic Host
                          Configuration Protocol (DHCP) Service for
                          IPv6", <a href="rfc3736.html">RFC 3736</a>, April 2004.

   [<a id="ref-RFC3775" name="ref-RFC3775">RFC3775</a>]              Johnson, D., Perkins, C., and J. Arkko,
                          "Mobility Support in IPv6", <a href="rfc3775.html">RFC 3775</a>,
                          June 2004.

   [<a id="ref-RFC3776" name="ref-RFC3776">RFC3776</a>]              Arkko, J., Devarapalli, V., and F. Dupont,
                          "Using IPsec to Protect Mobile IPv6 Signaling
                          Between Mobile Nodes and Home Agents",
                          <a href="rfc3776.html">RFC 3776</a>, June 2004.

   [<a id="ref-RFC4283" name="ref-RFC4283">RFC4283</a>]              Patel, A., Leung, K., Khalil, M., Akhtar, H.,
                          and K. Chowdhury, "Mobile Node Identifier
                          Option for Mobile IPv6 (MIPv6)", <a href="rfc4283.html">RFC 4283</a>,
                          November 2005.




<span class="grey">Patil &amp; Dommety              Informational                     [Page 17]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc5419.html">RFC 5419</a>             Why Authdata Option for MIPv6          January 2009</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/11.2.%20%20Informative%20References"></a><a class="selflink" href="#section-11.2" name="section-11.2">11.2</a>.  Informative References</span>

   [3GPP2 X.S0011-002-D]  3GPP2 X.S0011-002-D, "cdma2000 Wireless IP
                          Network Standard: Simple IP and Mobile IP
                          Access Services", <a href="http://www.3gpp2.org/Public_html/specs/">http://www.3gpp2.org/</a>
                          <a href="http://www.3gpp2.org/Public_html/specs/">Public_html/specs/</a>
                          X.S0011-002-D_v1.0_060301.pdf, February 2006.

   [<a id="ref-AUTH-PRO" name="ref-AUTH-PRO">AUTH-PRO</a>]             Patel, A., Leung, K., Khalil, M., Akhtar, H.,
                          and K. Chowdhury, "Authentication Protocol for
                          Mobile IPv6", Work in Progress, July 2008.

   [<a id="ref-BOOT" name="ref-BOOT">BOOT</a>]                 Chowdhury, K. and A. Yegin, "MIP6-
                          Bootstrapping for the Integrated Scenario",
                          Work in Progress, April 2008.

   [<a id="ref-RFC4861" name="ref-RFC4861">RFC4861</a>]              Narten, T., Nordmark, E., Simpson, W., and H.
                          Soliman, "Neighbor Discovery for IP version 6
                          (IPv6)", <a href="rfc4861.html">RFC 4861</a>, September 2007.

   [<a id="ref-RFC3957" name="ref-RFC3957">RFC3957</a>]              Perkins, C. and P. Calhoun, "Authentication,
                          Authorization, and Accounting (AAA)
                          Registration Keys for Mobile IPv4", <a href="rfc3957.html">RFC 3957</a>,
                          March 2005.

   [<a id="ref-RFC4285" name="ref-RFC4285">RFC4285</a>]              Patel, A., Leung, K., Khalil, M., Akhtar, H.,
                          and K. Chowdhury, "Authentication Protocol for
                          Mobile IPv6", <a href="rfc4285.html">RFC 4285</a>, January 2006.

   [<a id="ref-RFC4877" name="ref-RFC4877">RFC4877</a>]              Devarapalli, V. and F. Dupont, "Mobile IPv6
                          Operation with IKEv2 and the Revised IPsec
                          Architecture", <a href="rfc4877.html">RFC 4877</a>, April 2007.

   [<a id="ref-RFC5026" name="ref-RFC5026">RFC5026</a>]              Giaretta, G., Kempf, J., and V. Devarapalli,
                          "Mobile IPv6 Bootstrapping in Split Scenario",
                          <a href="rfc5026.html">RFC 5026</a>, October 2007.

   [<a id="ref-WiMAX-NWG" name="ref-WiMAX-NWG">WiMAX-NWG</a>]            "WiMAX Network Architecture - WiMAX End-to-End
                          Network Systems Architecture", May 2008, &lt;http
                          ://www.wimaxforum.org/documents/documents/
                          WiMAX_Forum_Network_Architecture_Stage_2-
                          3_Rel_1v1.2.zip&gt;.









<span class="grey">Patil &amp; Dommety              Informational                     [Page 18]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-19" id="page-19" name="page-19"> </a>
<span class="grey"><a href="rfc5419.html">RFC 5419</a>             Why Authdata Option for MIPv6          January 2009</span>


Authors' Addresses

   Basavaraj Patil
   Nokia
   6021 Connection Drive
   Irving, TX  75039
   USA

   EMail: basavaraj.patil@nokia.com


   Gopal Dommety
   Cisco
   170 West Tasman Drive
   San Jose, CA  95134
   USA

   EMail: gdommety@cisco.com

































Patil &amp; Dommety              Informational                     [Page 19]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.127, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc5419 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 14 Aug 2018 14:27:34 GMT --></html>