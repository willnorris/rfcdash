<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc6738 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:27 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="urn:ietf:rfc:6738" name="DC.Identifier"/>
<meta content="The Internet Key Exchange Protocol version 2 (IKEv2) is a component of
the IPsec architecture and is used to perform mutual authentication as
well as to establish and to maintain IPsec Security Associations (SAs)
between the respective parties. IKEv2 supports several different
authentication mechanisms, such as the Extensible Authentication
Protocol (EAP), certificates, and Shared Key (SK).  Diameter
interworking for Mobile IPv6 between the Home Agent (HA), as a
Diameter client, and the Diameter server has been specified. However,
that specification focused on the usage of EAP and did not include
support for SK-based authentication available with IKEv2. This
document specifies the IKEv2-server-to-Diameter-server communication
when the IKEv2 peer authenticates using IKEv2 with SK. [STANDARDS-
TRACK]" name="DC.Description.Abstract"/>
<meta content="Cakulev, Violeta" name="DC.Creator"/>
<meta content="Mizikovsky, Semyon" name="DC.Creator"/>
<meta content="Lior, Avi" name="DC.Creator"/>
<meta content="October, 2012" name="DC.Date.Issued"/>
<meta content="Diameter IKEv2 SK: Using Shared Keys to Support Interaction between IKEv2 Servers and Diameter Servers" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 6738 - Diameter IKEv2 SK: Using Shared Keys to Support Interaction between IKEv2 Servers and Diameter Servers</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgblue" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc6738.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc6738" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-dime-ikev2-psk-diameter" title="draft-ietf-dime-ikev2-psk-diameter">draft-ietf-dime...</a>] [<a href="https://datatracker.ietf.org/doc/rfc6738" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc6738" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc6738" title="Side-by-side diff">Diff2</a>]         </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                       PROPOSED STANDARD</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Internet Engineering Task Force (IETF)                        V. Cakulev
Request for Comments: 6738                                Alcatel Lucent
Category: Standards Track                                        A. Lior
ISSN: 2070-1721                                      Bridgewater Systems
                                                           S. Mizikovsky
                                                          Alcatel Lucent
                                                            October 2012


  <span class="h1">Diameter IKEv2 SK: Using Shared Keys to Support Interaction between</span>
                   <span class="h1">IKEv2 Servers and Diameter Servers</span>

Abstract

   The Internet Key Exchange Protocol version 2 (IKEv2) is a component
   of the IPsec architecture and is used to perform mutual
   authentication as well as to establish and to maintain IPsec Security
   Associations (SAs) between the respective parties.  IKEv2 supports
   several different authentication mechanisms, such as the Extensible
   Authentication Protocol (EAP), certificates, and Shared Key (SK).

   Diameter interworking for Mobile IPv6 between the Home Agent (HA), as
   a Diameter client, and the Diameter server has been specified.
   However, that specification focused on the usage of EAP and did not
   include support for SK-based authentication available with IKEv2.
   This document specifies the IKEv2-server-to-Diameter-server
   communication when the IKEv2 peer authenticates using IKEv2 with SK.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="rfc5741.html#section-2">Section 2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc6738">http://www.rfc-editor.org/info/rfc6738</a>.










<span class="grey">Cakulev, et al.              Standards Track                    [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc6738.html">RFC 6738</a>                    Diameter IKEv2 SK               October 2012</span>


Copyright Notice

   Copyright (c) 2012 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-3">3</a>
   <a href="#section-2">2</a>. Requirements Notation ...........................................<a href="#page-4">4</a>
      <a href="#section-2.1">2.1</a>. Abbreviations ..............................................<a href="#page-4">4</a>
   <a href="#section-3">3</a>. Application Identifier ..........................................<a href="#page-5">5</a>
   <a href="#section-4">4</a>. Protocol Description ............................................<a href="#page-5">5</a>
      <a href="#section-4.1">4.1</a>. Support for IKEv2 and Shared Keys ..........................<a href="#page-5">5</a>
      <a href="#section-4.2">4.2</a>. Session Management .........................................<a href="#page-7">7</a>
           <a href="#section-4.2.1">4.2.1</a>. Session-Termination-Request/Answer ..................<a href="#page-7">7</a>
           <a href="#section-4.2.2">4.2.2</a>. Abort-Session-Request/Answer ........................<a href="#page-7">7</a>
   <a href="#section-5">5</a>. Command Codes for Diameter IKEv2 with SK ........................<a href="#page-7">7</a>
      <a href="#section-5.1">5.1</a>. IKEv2-SK-Request (IKESKR) Command ..........................<a href="#page-8">8</a>
      <a href="#section-5.2">5.2</a>. IKEv2-SK-Answer (IKESKA) Command ...........................<a href="#page-9">9</a>
   <a href="#section-6">6</a>. Attribute-Value Pair Definitions ...............................<a href="#page-10">10</a>
      <a href="#section-6.1">6.1</a>. IKEv2-Nonces ..............................................<a href="#page-10">10</a>
           <a href="#section-6.1.1">6.1.1</a>. Ni .................................................<a href="#page-10">10</a>
           <a href="#section-6.1.2">6.1.2</a>. Nr .................................................<a href="#page-10">10</a>
      <a href="#section-6.2">6.2</a>. IKEv2-Identity ............................................<a href="#page-10">10</a>
           <a href="#section-6.2.1">6.2.1</a>. Initiator-Identity .................................<a href="#page-10">10</a>
           <a href="#section-6.2.2">6.2.2</a>. Responder-Identity .................................<a href="#page-11">11</a>
   <a href="#section-7">7</a>. AVP Occurrence Tables ..........................................<a href="#page-12">12</a>
   <a href="#section-8">8</a>. AVP Flag Rules .................................................<a href="#page-13">13</a>
   <a href="#section-9">9</a>. IANA Considerations ............................................<a href="#page-14">14</a>
      <a href="#section-9.1">9.1</a>. Command Codes .............................................<a href="#page-14">14</a>
      <a href="#section-9.2">9.2</a>. AVP Codes .................................................<a href="#page-14">14</a>
      <a href="#section-9.3">9.3</a>. AVP Values ................................................<a href="#page-14">14</a>
      <a href="#section-9.4">9.4</a>. Application Identifier ....................................<a href="#page-14">14</a>
   <a href="#section-10">10</a>. Security Considerations .......................................<a href="#page-15">15</a>
   <a href="#section-11">11</a>. References ....................................................<a href="#page-16">16</a>
      <a href="#section-11.1">11.1</a>. Normative References .....................................<a href="#page-16">16</a>
      <a href="#section-11.2">11.2</a>. Informative References ...................................<a href="#page-16">16</a>




<span class="grey">Cakulev, et al.              Standards Track                    [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc6738.html">RFC 6738</a>                    Diameter IKEv2 SK               October 2012</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   The Internet Key Exchange Protocol version 2 (IKEv2) [<a href="rfc5996.html" title='"Internet Key Exchange Protocol Version 2 (IKEv2)"'>RFC5996</a>] is
   used to mutually authenticate two parities and to establish a
   Security Association (SA) that can be used to efficiently secure the
   communication between the IKEv2 peer and server, for example, using
   Encapsulating Security Payload (ESP) [<a href="rfc4303.html" title='"IP Encapsulating Security Payload (ESP)"'>RFC4303</a>] and/or Authentication
   Header (AH) [<a href="rfc4302.html" title='"IP Authentication Header"'>RFC4302</a>].  The IKEv2 protocol allows several different
   mechanisms for authenticating an IKEv2 peer to be used, such as the
   Extensible Authentication Protocol (EAP), certificates, and SK.

   From a service provider perspective, it is important to ensure that a
   user is authorized to use the services.  Therefore, the IKEv2 server
   must verify that the IKEv2 peer is authorized for the requested
   services, possibly with the assistance of the operator's Diameter
   servers.  [<a href="rfc5778.html" title='"Diameter Mobile IPv6: Support for Home Agent to Diameter Server Interaction"'>RFC5778</a>] defines the home agent as a Diameter-client-to-
   Diameter-server communication when the mobile node authenticates
   using the IKEv2 protocol with the Extensible Authentication Protocol
   (EAP) [<a href="rfc3748.html" title='"Extensible Authentication Protocol (EAP)"'>RFC3748</a>] or using the Mobile IPv6 Authentication Protocol
   [<a href="rfc4285.html" title='"Authentication Protocol for Mobile IPv6"'>RFC4285</a>].  This document specifies the IKEv2-server-to-Diameter-
   server communication when the IKEv2 peer authenticates using IKEv2
   with SK.

   Figure 1 depicts the reference architecture for this document.

                                       +--------+
                                       |Diameter|
                                       |Server  |
                                       +--------+
                                           ^
                                  Back-End | IKEv2 Server&lt;-&gt;HAAA Server
                                  Support  | Interaction
                                  Protocol | (this document)
                                           v
   +---------+                      +---------------+
   | IKEv2   |  Front-End Protocol  |IKEv2 Server/  |
   | Peer    |&lt;--------------------&gt;|Diameter Client|
   +---------+       IKEv2          +---------------+

                      Figure 1: Architecture Overview

   An example use case for this architecture is Mobile IPv6 deployment
   in which the Mobile IPv6 signaling between the Mobile Node and the
   Home Agent is protected using IPsec.  The Mobile node acts as the
   IKEv2 peer and the Home Agent acts as an IKEv2 server.  In this use
   case, IKEv2 with SK-based initiator authentication is used for the
   setup of the IPsec SAs.  The HA obtains the SK using the Diameter
   application specified in this document.



<span class="grey">Cakulev, et al.              Standards Track                    [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc6738.html">RFC 6738</a>                    Diameter IKEv2 SK               October 2012</span>


   This document assumes that the SK provided to the IKEv2 peer as well
   as the SK delivered to the IKEv2 server by the Diameter server are
   established or derived using the same rules.  Furthermore, it assumes
   that these rules are agreed to by the external protocol on a peer
   side providing the key to the IKEv2 peer, and on the Diameter server
   side providing the key to the IKEv2 server.  This document allows for
   the SK to be obtained for a specific IKEv2 session and exchanged
   between IKEv2 server and the Home Authentication, Authorization, and
   Accounting (HAAA) server.  The protocol provides IKEv2 attributes to
   allow the HAAA to compute the SK specific to the session if desired
   (see <a href="#section-10">Section 10</a>).  This is accomplished through the use of a new
   Diameter application specifically designed for performing IKEv2
   authorization decisions.  This document focuses on the IKEv2 server,
   as a Diameter client, communicating to the Diameter server, and it
   specifies the Diameter application needed for this communication.
   Other protocols leveraging this Diameter application MAY specify
   their own SK derivation scheme.  For example see [<a href="#ref-X.S0047" title='"Mobile IPv6 Enhancements"'>X.S0047</a>] and
   [<a href="#ref-X.S0058" title='"WiMAX-HRPD Interworking: Core Network Aspects"'>X.S0058</a>].  This document specifies the default procedure for
   derivation of the SK used in IKEv2 authentication when protocols
   leveraging this Diameter application do not specify their own
   derivation procedure.  Selection of either default or other SK
   derivation procedure is done by the external protocol between the
   Peer and the Diameter Server, and is outside the scope of this
   document.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Requirements%20Notation"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Requirements Notation</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [<a href="rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.1.%20%20Abbreviations"></a><a class="selflink" href="#section-2.1" name="section-2.1">2.1</a>.  Abbreviations</span>

   AH        Authentication Header

   AVP       Attribute-Value Pair

   EAP       Extensible Authentication Protocol

   ESP       Encapsulating Security Payload

   HAAA      Home Authentication, Authorization, and Accounting

   IKEv2     Internet Key Exchange Protocol version 2

   NAI       Network Access Identifier

   PSK       Pre-Shared Key



<span class="grey">Cakulev, et al.              Standards Track                    [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc6738.html">RFC 6738</a>                    Diameter IKEv2 SK               October 2012</span>


   SA        Security Association

   SK        Shared Key

   SPI       Security Parameter Index

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Application%20Identifier"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Application Identifier</span>

   This specification defines a new Diameter application and its
   respective Application Identifier:

      Diameter IKE SK  (IKESK)  11


   The IKESK Application Identifier is used when the IKEv2 peer is to be
   authenticated and authorized using IKEv2 with SK-based
   authentication.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Protocol%20Description"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Protocol Description</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.1.%20%20Support%20for%20IKEv2%20and%20Shared%20Keys"></a><a class="selflink" href="#section-4.1" name="section-4.1">4.1</a>.  Support for IKEv2 and Shared Keys</span>

   When IKEv2 is used with SK-based initiator authentication, the
   Diameter commands IKEv2-SK-Request/Answer defined in this document
   are used between the IKEv2 server and a Home AAA (HAAA) server to
   authorize the IKEv2 peer for the services.  Upon receiving the
   IKE_AUTH message from the IKEv2 peer, the IKEv2 server uses the
   information received in IDi [<a href="rfc5996.html" title='"Internet Key Exchange Protocol Version 2 (IKEv2)"'>RFC5996</a>] to identify the IKEv2 peer and
   the SPI, if available, to determine the correct SK for this IKEv2
   peer.  If no SK associated with this IKEv2 peer is found, the IKEv2
   server MUST send an Authorize-Only (Auth-Request-Type set to
   "Authorize-Only") Diameter IKEv2-SK-Request message to the HAAA to
   obtain the SK.  If the IDi payload extracted from the IKE_AUTH
   message contains an identity that is meaningful for the Diameter
   infrastructure, such as a Network Access Identifier (NAI), it SHALL
   be used by the IKEv2 server to populate the User-Name AVP in the
   Diameter message.  Otherwise, it is out of scope of this document how
   the IKEv2 server maps the value received in the IDi payload to the
   User-Name AVP and whether or not the User-Name AVP is included in the
   IKEv2-SK-Request message.  In the same Diameter message, the IKEv2
   server SHALL also include the IKEv2-Nonces AVP with the initiator and
   responder nonces (Ni and Nr) exchanged during initial IKEv2 exchange.
   Finally, the IKEv2 server SHALL include the IKEv2-Identity AVP in the
   IKEv2-SK-Request message.  The Initiator-Identity AVP SHALL be
   populated with the IDi field extracted from the IKE_AUTH message.  If
   the IDr payload was included in the IKE_AUTH message received from
   the IKEv2 peer, the IKEv2 server SHALL also include a Responder-
   Identity AVP populated with the received IDr.



<span class="grey">Cakulev, et al.              Standards Track                    [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc6738.html">RFC 6738</a>                    Diameter IKEv2 SK               October 2012</span>


   The IKEv2 server sends the IKEv2-SK-Request message to the IKEv2
   peer's HAAA.  The Diameter message is routed to the correct HAAA per
   [<a href="rfc6733.html" title='"Diameter Base Protocol"'>RFC6733</a>].

   Upon receiving a Diameter IKEv2-SK-Request message from the IKEv2
   server, the HAAA SHALL use the User-Name AVP (if present) and/or
   Initiator-Identity AVP to retrieve the associated keying material.
   When the default SK-generation procedure specified in this document
   is used, the peer side that provides the SK to the IKEv2 peer, as
   well as the Diameter server, SHALL use the same SK derivation that
   follows the methodology similar to that specified in <a href="rfc5295.html#section-3.1">Section 3.1 of
   [RFC5295]</a>, specifically:

   SK = KDF(PSK, key label | "\0" | Ni | Nr | IDi | length)

   Where:

   o  KDF is the default key derivation function based on HMAC-SHA-256
      as specified in <a href="rfc5295.html#section-3.1.2">Section 3.1.2 of [RFC5295]</a>.

   o  Pre-Shared Key (PSK) is the key available to the protocol
      leveraging this Diameter application, e.g., the long-term shared
      secret, or the Extended Master Session Key (EMSK) as the result of
      prior EAP authentication, etc.  Selection of this value is left up
      to the protocol leveraging this Diameter application.

   o  Key label is set to 'sk4ikev2@ietf.org'.

   o  | denotes concatenation

   o  "\0" is a NULL octet (0x00 in hex)

   o  Length is a 2-octet unsigned integer in network byte order of the
      output key length, in octets.

   When applications using this protocol define their own SK-generation
   algorithm, it is strongly RECOMMENDED that the nonces Ni and Nr be
   used in the computation.  It is also RECOMMENDED that IDi be used.
   IDr SHOULD NOT be used in the SK generation algorithm.  Applications
   that want to use IDr in the computation should take into
   consideration that the IDr asserted by the IKEv2 peer may not be the
   same as the IDr returned by the IKEv2 responder.  This mismatch will
   result in different SKs being generated.  The HAAA returns the SK to
   the IKEv2 server using the Key AVP as specified in [<a href="rfc6734.html" title='"Diameter Attribute- Value Pairs for Cryptographic Key Transport"'>RFC6734</a>].







<span class="grey">Cakulev, et al.              Standards Track                    [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc6738.html">RFC 6738</a>                    Diameter IKEv2 SK               October 2012</span>


   Once the IKEv2 server receives the SK from the HAAA, the IKEv2 server
   verifies the IKE_AUTH message received from the IKEv2 peer.  If the
   verification of AUTH is successful, the IKEv2 server sends the IKE
   message back to the IKEv2 peer.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.2.%20%20Session%20Management"></a><a class="selflink" href="#section-4.2" name="section-4.2">4.2</a>.  Session Management</span>

   The HAAA may maintain Diameter session state or may be stateless.
   This is indicated by the presence or absence of the Auth-Session-
   State AVP included in the answer message.  The IKEv2 server MUST
   support the Authorization Session State Machine defined in [<a href="rfc6733.html" title='"Diameter Base Protocol"'>RFC6733</a>].

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.2.1.%20%20Session-Termination-Request%2FAnswer"></a><a class="selflink" href="#section-4.2.1" name="section-4.2.1">4.2.1</a>.  Session-Termination-Request/Answer</span>

   In the case where the HAAA is maintaining session state, when the
   IKEv2 server terminates the SA, it SHALL send a Session-Termination-
   Request (STR) message [<a href="rfc6733.html" title='"Diameter Base Protocol"'>RFC6733</a>] to inform the HAAA that the
   authorized session has been terminated.

   The Session-Termination-Answer (STA) message [<a href="rfc6733.html" title='"Diameter Base Protocol"'>RFC6733</a>] is sent by the
   HAAA to acknowledge the notification that the session has been
   terminated.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.2.2.%20%20Abort-Session-Request%2FAnswer"></a><a class="selflink" href="#section-4.2.2" name="section-4.2.2">4.2.2</a>.  Abort-Session-Request/Answer</span>

   The Abort-Session-Request (ASR) message [<a href="rfc6733.html" title='"Diameter Base Protocol"'>RFC6733</a>] is sent by the HAAA
   to the IKEv2 server to terminate the authorized session.  When the
   IKEv2 server receives the ASR message, it MUST delete the
   corresponding IKE_SA and all CHILD_SAs set up through it.

   The Abort-Session-Answer (ASA) message [<a href="rfc6733.html" title='"Diameter Base Protocol"'>RFC6733</a>] is sent by the IKEv2
   server in response to an ASR message.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Command%20Codes%20for%20Diameter%20IKEv2%20with%20SK"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Command Codes for Diameter IKEv2 with SK</span>

   This section defines new Command Code values that MUST be supported
   by all Diameter implementations conforming to this specification.

   +------------------+---------+------+-----------------+-------------+
   |   Command Name   | Abbrev. | Code |     Section     | Application |
   |                  |         |      |    Reference    |             |
   +------------------+---------+------+-----------------+-------------+
   | IKEv2-SK-Request |  IKESKR |  329 |   <a href="#section-5.1">Section 5.1</a>   |    IKESK    |
   |                  |         |      |                 |             |
   |  IKEv2-SK-Answer |  IKESKA |  329 |   <a href="#section-5.2">Section 5.2</a>   |    IKESK    |
   +------------------+---------+------+-----------------+-------------+

                          Table 1: Command Codes



<span class="grey">Cakulev, et al.              Standards Track                    [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc6738.html">RFC 6738</a>                    Diameter IKEv2 SK               October 2012</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.1.%20%20IKEv2-SK-Request%20%28IKESKR%29%20Command"></a><a class="selflink" href="#section-5.1" name="section-5.1">5.1</a>.  IKEv2-SK-Request (IKESKR) Command</span>

   The IKEv2-SK-Request message, indicated with the Command Code set to
   329 and the 'R' bit set in the Command Flags field, is sent from the
   IKEv2 server to the HAAA to initiate IKEv2 with SK authorization.  In
   this case, the Application-Id field of the Diameter header MUST be
   set to the Diameter IKE SK Application-Id (11).

   Message format

         &lt;IKEv2-SK-Request&gt; ::= &lt; Diameter Header: 329, REQ, PXY &gt;
                                 &lt; Session-Id &gt;
                                 { Auth-Application-Id }
                                 { Origin-Host }
                                 { Origin-Realm }
                                 { Destination-Realm }
                                 { Auth-Request-Type }
                                 [ Destination-Host ]
                                 [ NAS-Identifier ]
                                 [ NAS-IP-Address ]
                                 [ NAS-IPv6-Address ]
                                 [ NAS-Port ]
                                 [ Origin-State-Id ]
                                 [ User-Name ]
                                 [ Key-SPI ]
                                 { IKEv2-Identity }
                                 [ Auth-Session-State ]
                                 { IKEv2-Nonces }
                               * [ Proxy-Info ]
                               * [ Route-Record ]
                                 ...
                               * [ AVP ]

   The IKEv2-SK-Request message MUST include an IKEv2-Nonces AVP
   containing the Ni and Nr nonces swapped during initial IKEv2
   exchange.  The IKEv2-SK-Request message MAY contain a Key-SPI AVP
   (Key-SPI AVP is specified in [<a href="rfc6734.html" title='"Diameter Attribute- Value Pairs for Cryptographic Key Transport"'>RFC6734</a>]).  If included, it contains
   the SPI that HAAA SHALL use, in addition to the other parameters
   (e.g., Initiator-Identity), to identify the appropriate SK.  The
   IKEv2-SK-Request message MUST include IKEv2-Identity AVP.  The
   Initiator-Identity AVP SHALL contain IDi as received in IKE_AUTH
   message.  The Responder-Identity AVP SHALL be included in the IKEv2-
   SK-Request message, if IDr payload was included in the IKE_AUTH
   message received from the IKEv2 peer.  If included, the Responder-
   Identity AVP contains the received IDr.






<span class="grey">Cakulev, et al.              Standards Track                    [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc6738.html">RFC 6738</a>                    Diameter IKEv2 SK               October 2012</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.2.%20%20IKEv2-SK-Answer%20%28IKESKA%29%20Command"></a><a class="selflink" href="#section-5.2" name="section-5.2">5.2</a>.  IKEv2-SK-Answer (IKESKA) Command</span>

   The IKEv2-SK-Answer (IKESKA) message, indicated by the Command Code
   field set to 329 and the 'R' bit cleared in the Command Flags field,
   is sent by the HAAA to the IKEv2 server in response to the IKESKR
   command.  In this case, the Application-Id field of the Diameter
   header MUST be set to the Diameter IKE SK Application-Id (11).

   Message format

           &lt;IKEv2-SK-Answer&gt; ::= &lt; Diameter Header: 329, PXY &gt;
                                  &lt; Session-Id &gt;
                                  { Auth-Application-Id }
                                  { Auth-Request-Type }
                                  { Result-Code }
                                  { Origin-Host }
                                  { Origin-Realm }
                                  [ User-Name ]
                                  [ Key ]
                                  [ Responder-Identity ]
                                  [ Auth-Session-State ]
                                  [ Error-Message ]
                                  [ Error-Reporting-Host ]
                                * [ Failed-AVP ]
                                  [ Origin-State-Id ]
                                * [ Redirect-Host ]
                                  [ Redirect-Host-Usage ]
                                  [ Redirect-Max-Cache-Time ]
                                * [ Proxy-Info ]
                                * [ Route-Record ]
                                  ...
                                * [ AVP ]

   If the authorization procedure is successful, then the IKEv2-SK-
   Answer message SHALL include the Key AVP as specified in [<a href="rfc6734.html" title='"Diameter Attribute- Value Pairs for Cryptographic Key Transport"'>RFC6734</a>].
   The value of the Key-Type AVP SHALL be set to IKEv2 SK (3).  The
   Keying-Material AVP SHALL contain the SK.  If the Key-SPI AVP is
   received in IKEv2-SK-Request, the Key-SPI AVP SHALL be included in
   the Key AVP.  The Key-Lifetime AVP may be included; if so, then the
   associated key SHALL NOT be used by the receiver of the answer if the
   lifetime has expired.  Finally, the Responder-Identity AVP may be
   included.









<span class="grey">Cakulev, et al.              Standards Track                    [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc6738.html">RFC 6738</a>                    Diameter IKEv2 SK               October 2012</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20Attribute-Value%20Pair%20Definitions"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  Attribute-Value Pair Definitions</span>

   This section defines new AVPs for IKEv2 with SK.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.1.%20%20IKEv2-Nonces"></a><a class="selflink" href="#section-6.1" name="section-6.1">6.1</a>.  IKEv2-Nonces</span>

   The IKEv2-Nonces AVP (Code 587) is of type Grouped and contains the
   nonces exchanged between the IKEv2 peer and the IKEv2 server during
   IKEv2 initial exchange.  The nonces are used for SK generation.

               IKEv2-Nonces ::= &lt; AVP Header: 587 &gt;
                                {Ni}
                                {Nr}
                               *[AVP]

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/6.1.1.%20%20Ni"></a><a class="selflink" href="#section-6.1.1" name="section-6.1.1">6.1.1</a>.  Ni</span>

   The Ni AVP (AVP Code 588) is of type OctetString and contains the
   IKEv2 initiator nonce as contained in Nonce Data field.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/6.1.2.%20%20Nr"></a><a class="selflink" href="#section-6.1.2" name="section-6.1.2">6.1.2</a>.  Nr</span>

   The Nr AVP (AVP Code 589) is of type OctetString and contains the
   IKEv2 responder nonce as contained in Nonce Data field.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.2.%20%20IKEv2-Identity"></a><a class="selflink" href="#section-6.2" name="section-6.2">6.2</a>.  IKEv2-Identity</span>

   The IKEv2-Identity AVP (Code 590) is of type Grouped and contains the
   Initiator and possibly Responder identities as included in IKE_AUTH
   message sent from the IKEv2 peer to the IKEv2 server.

               IKEv2-Identity ::= &lt; AVP Header: 590 &gt;
                                {Initiator-Identity}
                                [Responder-Identity]
                               *[AVP]

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/6.2.1.%20%20Initiator-Identity"></a><a class="selflink" href="#section-6.2.1" name="section-6.2.1">6.2.1</a>.  Initiator-Identity</span>

   The Initiator-Identity AVP (AVP Code 591) is of type Grouped and
   contains the identity type and identification data of the IDi payload
   of the IKE_AUTH message.

               Initiator-Identity ::= &lt; AVP Header: 591 &gt;
                                {ID-Type}
                                {Identification-Data}
                               *[AVP]





<span class="grey">Cakulev, et al.              Standards Track                   [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc6738.html">RFC 6738</a>                    Diameter IKEv2 SK               October 2012</span>


<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/6.2.1.1.%20%20ID-Type"></a><a class="selflink" href="#section-6.2.1.1" name="section-6.2.1.1">6.2.1.1</a>.  ID-Type</span>

   The ID-Type AVP (AVP Code 592) is of type Enumerated and contains the
   ID type value of IDi payload of the IKE_AUTH message.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/6.2.1.2.%20%20Identification-Data"></a><a class="selflink" href="#section-6.2.1.2" name="section-6.2.1.2">6.2.1.2</a>.  Identification-Data</span>

   The Identification-Data AVP (AVP Code 593) is of type OctetString and
   contains the Identification Data field of IDi payload of the IKE_AUTH
   message.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/6.2.2.%20%20Responder-Identity"></a><a class="selflink" href="#section-6.2.2" name="section-6.2.2">6.2.2</a>.  Responder-Identity</span>

   The Responder-Identity AVP (AVP Code 594) is of type Grouped and
   contains the identity type and identification data of the IDr payload
   of the IKE_AUTH message.

               Responder-Identity ::= &lt; AVP Header: 594 &gt;
                                {ID-Type}
                                {Identification-Data}
                               *[AVP]

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/6.2.2.1.%20%20ID-Type"></a><a class="selflink" href="#section-6.2.2.1" name="section-6.2.2.1">6.2.2.1</a>.  ID-Type</span>

   The ID-Type AVP (AVP Code 592) is of type Enumerated and contains the
   ID type value of IDr payload of the IKE_AUTH message.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/6.2.2.2.%20%20Identification-Data"></a><a class="selflink" href="#section-6.2.2.2" name="section-6.2.2.2">6.2.2.2</a>.  Identification-Data</span>

   The Identification-Data AVP (AVP Code 593) is of type OctetString and
   contains the Identification Data field of IDr payload of the IKE_AUTH
   message.



















<span class="grey">Cakulev, et al.              Standards Track                   [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc6738.html">RFC 6738</a>                    Diameter IKEv2 SK               October 2012</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20AVP%20Occurrence%20Tables"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  AVP Occurrence Tables</span>

   The following tables present the AVPs defined or used in this
   document and their occurrences in Diameter messages.  Note that AVPs
   that can only be present within a Grouped AVP are not represented in
   this table.

   The table uses the following symbols:

   0:       The AVP MUST NOT be present in the message.

   0+:      Zero or more instances of the AVP MAY be present in the
            message.

   0-1:     Zero or one instance of the AVP MAY be present in the
            message.

   1:       One instance of the AVP MUST be present in the message.

                                     +-------------------+
                                     |   Command Code    |
                                     |---------+---------+
      AVP Name                       | IKESKR  | IKESKA  |
      -------------------------------|---------+---------+
      Key                            |    0    |   0-1   |
      Key-SPI                        |   0-1   |    0    |
      IKEv2-Nonces                   |    1    |    0    |
      IKEv2-Identity                 |    1    |    0    |
      Responder-Identity             |    0    |   0-1   |
                                     +---------+---------+

                   IKESKR and IKESKA Commands AVP Table



















<span class="grey">Cakulev, et al.              Standards Track                   [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc6738.html">RFC 6738</a>                    Diameter IKEv2 SK               October 2012</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20AVP%20Flag%20Rules"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  AVP Flag Rules</span>

   The following table describes the Diameter AVPs, their AVP Code
   values, types, and possible flag values.  The Diameter base protocol
   [<a href="rfc6733.html" title='"Diameter Base Protocol"'>RFC6733</a>] specifies the AVP Flag rules for AVPs in <a href="#section-4.5">Section 4.5</a>.

                                                 +---------+
                                                 |AVP Flag |
                                                 |  Rules  |
                                                 +----+----+
                       AVP  Section              |    |MUST|
    Attribute Name     Code Defined   Value Type |MUST| NOT|
   +---------------------------------------------+----+----+
   |Key                 581  Note 1   Grouped    |  M | V  |
   +---------------------------------------------+----+----+
   |Keying-Material     583  Note 1   OctetString|  M | V  |
   +---------------------------------------------+----+----+
   |Key-Lifetime        584  Note 1   Integer64  |  M | V  |
   +---------------------------------------------+----+----+
   |Key-SPI             585  Note 1   Unsigned32 |  M | V  |
   +---------------------------------------------+----+----+
   |Key-Type            582  Note 1   Enumerated |  M | V  |
   +---------------------------------------------+----+----+
   |IKEv2-Nonces        587  6.1      Grouped    |  M | V  |
   +---------------------------------------------+----+----+
   |Ni                  588  6.1.1    OctetString|  M | V  |
   +---------------------------------------------+----+----+
   |Nr                  589  6.1.2    OctetString|  M | V  |
   +---------------------------------------------+----+----+
   |IKEv2-Identity      590  6.2      Grouped    |  M | V  |
   +---------------------------------------------+----+----+
   |Initiator-Identity  591  6.2.1    Grouped    |  M | V  |
   +---------------------------------------------+----+----+
   |ID-Type             592  6.2.1.1  Enumerated |  M | V  |
   +---------------------------------------------+----+----+
   |Identification-Data 593  6.2.1.2  OctetString|  M | V  |
   +---------------------------------------------+----+----+
   |Responder-Identity  594  6.2.2    Grouped    |  M | V  |
   +---------------------------------------------+----+----+

                           AVP Flag Rules Table

   Note 1: The Key, Keying-Material, Key-Lifetime, Key-SPI, and Key-Type
   AVPs are defined in [<a href="rfc6734.html" title='"Diameter Attribute- Value Pairs for Cryptographic Key Transport"'>RFC6734</a>].







<span class="grey">Cakulev, et al.              Standards Track                   [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc6738.html">RFC 6738</a>                    Diameter IKEv2 SK               October 2012</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/9.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-9" name="section-9">9</a>.  IANA Considerations</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/9.1.%20%20Command%20Codes"></a><a class="selflink" href="#section-9.1" name="section-9.1">9.1</a>.  Command Codes</span>

   IANA has allocated a Command Code value for the following new command
   from the Command Code namespace defined in [<a href="rfc6733.html" title='"Diameter Base Protocol"'>RFC6733</a>].

      Command Code                     | Value
      ---------------------------------+------
      IKEv2-SK-Request/Answer          | 329

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/9.2.%20%20AVP%20Codes"></a><a class="selflink" href="#section-9.2" name="section-9.2">9.2</a>.  AVP Codes</span>

   This specification requires IANA to register the following new AVPs
   from the AVP Code namespace defined in [<a href="rfc6733.html" title='"Diameter Base Protocol"'>RFC6733</a>].

   o  IKEv2-Nonces - 587

   o  Ni - 588

   o  Nr - 589

   o  IKEv2-Identity - 590

   o  Initiator-Identity - 591

   o  ID-Type - 592

   o  Identification-Data - 593

   o  Responder-Identity - 594

   The AVPs are defined in <a href="#section-6">Section 6</a>.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/9.3.%20%20AVP%20Values"></a><a class="selflink" href="#section-9.3" name="section-9.3">9.3</a>.  AVP Values</span>

   IANA is requested to create a new value for the Key-Type AVP.  The
   new value 3 signifies that IKEv2 SK is being sent.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/9.4.%20%20Application%20Identifier"></a><a class="selflink" href="#section-9.4" name="section-9.4">9.4</a>.  Application Identifier</span>

   This specification requires IANA to allocate one new value "Diameter
   IKE SK" from the Application Identifier namespace defined in
   [<a href="rfc6733.html" title='"Diameter Base Protocol"'>RFC6733</a>].

   Application Identifier         | Value
   -------------------------------+------
   Diameter IKE SK (IKESK)        | 11



<span class="grey">Cakulev, et al.              Standards Track                   [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc6738.html">RFC 6738</a>                    Diameter IKEv2 SK               October 2012</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/10.%20%20Security%20Considerations"></a><a class="selflink" href="#section-10" name="section-10">10</a>.  Security Considerations</span>

   The security considerations of the Diameter base protocol [<a href="rfc6733.html" title='"Diameter Base Protocol"'>RFC6733</a>]
   are applicable to this document (e.g., it is expected that Diameter
   protocol is used with security mechanism and that Diameter messages
   are secured).

   In addition, the assumption is that the IKEv2 server and the Diameter
   server, where the SK is generated, are in a trusted relationship.
   Hence, the assumption is that there is an appropriate security
   mechanism to protect the communication between these servers.  For
   example, the IKEv2 server and the Diameter server would be deployed
   in the same secure network or would utilize transport-layer security
   as specified in [<a href="rfc6733.html" title='"Diameter Base Protocol"'>RFC6733</a>].

   The Diameter messages between the IKEv2 server and the HAAA may be
   transported via one or more AAA brokers or Diameter agents.  In this
   case, the IKEv2 server to the Diameter server AAA communication is
   hop-by-hop protected; hence, it relies on the security properties of
   the intermediating AAA inter-connection networks, AAA brokers, and
   Diameter agents.  Furthermore, any agents that process IKEv2-SK-
   Answer messages can see the contents of the Key AVP.

   To mitigate the threat of exposing a long-lived PSK, this
   specification expects that the HAAA derive and return the associated
   SK to the IKEv2 server.  Given that SK derivation is security-
   critical, for the SK derivation, this specification recommends the
   use of short-lived secrets, possibly based on a previous network
   access authentication, if such secrets are available.  To ensure key
   freshness and to limit the key scope, this specification strongly
   recommends the use of nonces included in the IKEv2-SK-Request.  The
   specifics of key derivation depend on the security characteristics of
   the system that is leveraging this specification (for example, see
   [<a href="#ref-X.S0047" title='"Mobile IPv6 Enhancements"'>X.S0047</a>] and [<a href="#ref-X.S0058" title='"WiMAX-HRPD Interworking: Core Network Aspects"'>X.S0058</a>]); therefore, this specification does not
   define how the Diameter server derives required keys for these
   systems.  For systems and protocols that leverage this Diameter
   application but do not specify the key derivation procedure, this
   document specifies the default key derivation procedure that
   preserves expected security characteristics.












<span class="grey">Cakulev, et al.              Standards Track                   [Page 15]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc6738.html">RFC 6738</a>                    Diameter IKEv2 SK               October 2012</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/11.%20%20References"></a><a class="selflink" href="#section-11" name="section-11">11</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/11.1.%20%20Normative%20References"></a><a class="selflink" href="#section-11.1" name="section-11.1">11.1</a>.  Normative References</span>

   [<a id="ref-RFC2119" name="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a id="ref-RFC4302" name="ref-RFC4302">RFC4302</a>]  Kent, S., "IP Authentication Header", <a href="rfc4302.html">RFC 4302</a>,
              December 2005.

   [<a id="ref-RFC4303" name="ref-RFC4303">RFC4303</a>]  Kent, S., "IP Encapsulating Security Payload (ESP)",
              <a href="rfc4303.html">RFC 4303</a>, December 2005.

   [<a id="ref-RFC5295" name="ref-RFC5295">RFC5295</a>]  Salowey, J., Dondeti, L., Narayanan, V., and M. Nakhjiri,
              "Specification for the Derivation of Root Keys from an
              Extended Master Session Key (EMSK)", <a href="rfc5295.html">RFC 5295</a>,
              August 2008.

   [<a id="ref-RFC5996" name="ref-RFC5996">RFC5996</a>]  Kaufman, C., Hoffman, P., Nir, Y., and P. Eronen,
              "Internet Key Exchange Protocol Version 2 (IKEv2)",
              <a href="rfc5996.html">RFC 5996</a>, September 2010.

   [<a id="ref-RFC6733" name="ref-RFC6733">RFC6733</a>]  Fajardo, V., Arkko, J., Loughney, J., and G. Zorn,
              "Diameter Base Protocol", <a href="rfc6733.html">RFC 6733</a>, October 2012.

   [<a id="ref-RFC6734" name="ref-RFC6734">RFC6734</a>]  Zorn, G., Wu, W., and V. Cakulev, "Diameter Attribute-
              Value Pairs for Cryptographic Key Transport", <a href="rfc6734.html">RFC 6734</a>,
              October 2012.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/11.2.%20%20Informative%20References"></a><a class="selflink" href="#section-11.2" name="section-11.2">11.2</a>.  Informative References</span>

   [<a id="ref-RFC3748" name="ref-RFC3748">RFC3748</a>]  Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H.
              Levkowetz, "Extensible Authentication Protocol (EAP)",
              <a href="rfc3748.html">RFC 3748</a>, June 2004.

   [<a id="ref-RFC4285" name="ref-RFC4285">RFC4285</a>]  Patel, A., Leung, K., Khalil, M., Akhtar, H., and K.
              Chowdhury, "Authentication Protocol for Mobile IPv6",
              <a href="rfc4285.html">RFC 4285</a>, January 2006.

   [<a id="ref-RFC5778" name="ref-RFC5778">RFC5778</a>]  Korhonen, J., Tschofenig, H., Bournelle, J., Giaretta, G.,
              and M. Nakhjiri, "Diameter Mobile IPv6: Support for Home
              Agent to Diameter Server Interaction", <a href="rfc5778.html">RFC 5778</a>,
              February 2010.

   [<a id="ref-X.S0047" name="ref-X.S0047">X.S0047</a>]  3GPP2: X.S0047, "Mobile IPv6 Enhancements", February 2009.

   [<a id="ref-X.S0058" name="ref-X.S0058">X.S0058</a>]  3GPP2: X.S0058, "WiMAX-HRPD Interworking: Core Network
              Aspects", June 2010.



<span class="grey">Cakulev, et al.              Standards Track                   [Page 16]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc6738.html">RFC 6738</a>                    Diameter IKEv2 SK               October 2012</span>


Authors' Addresses

   Violeta Cakulev
   Alcatel Lucent
   600 Mountain Ave.
   3D-517
   Murray Hill, NJ  07974
   US

   Phone: +1 908 582 3207
   EMail: violeta.cakulev@alcatel-lucent.com


   Avi Lior
   Bridgewater Systems
   303 Terry Fox Drive
   Ottawa, Ontario  K2K 3J1
   Canada

   Phone: +1 613-591-6655
   EMail: avi.ietf@lior.org


   Semyon Mizikovsky
   Alcatel Lucent
   600 Mountain Ave.
   3C-506
   Murray Hill, NJ  07974
   US

   Phone: +1 908 582 0729
   EMail: Simon.Mizikovsky@alcatel-lucent.com



















Cakulev, et al.              Standards Track                   [Page 17]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc6738 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:27 GMT --></html>