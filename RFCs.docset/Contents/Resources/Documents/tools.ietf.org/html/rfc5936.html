<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc5936 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:32 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="urn:ietf:rfc:5936" name="DC.Identifier"/>
<meta content="The standard means within the Domain Name System protocol for
maintaining coherence among a zone's authoritative name servers
consists of three mechanisms. Authoritative Transfer (AXFR) is one of
the mechanisms and is defined in RFC 1034 and RFC 1035.  The
definition of AXFR has proven insufficient in detail, thereby forcing
implementations intended to be compliant to make assumptions, impeding
interoperability. Yet today we have a satisfactory set of
implementations that do interoperate. This document is a new
definition of AXFR -- new in the sense that it records an accurate
definition of an interoperable AXFR mechanism. [STANDARDS-TRACK]" name="DC.Description.Abstract"/>
<meta content="Hoenes, Alfred" name="DC.Creator"/>
<meta content="Lewis, Edward" name="DC.Creator"/>
<meta content="June, 2010" name="DC.Date.Issued"/>
<meta content="DNS Zone Transfer Protocol (AXFR)" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 5936 - DNS Zone Transfer Protocol (AXFR)</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgblue" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc5936.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc5936" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-dnsext-axfr-clarify" title="draft-ietf-dnsext-axfr-clarify">draft-ietf-dnse...</a>] [<a href="https://datatracker.ietf.org/doc/rfc5936" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc5936" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc5936" title="Side-by-side diff">Diff2</a>]         </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                       PROPOSED STANDARD</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Internet Engineering Task Force (IETF)                          E. Lewis
Request for Comments: 5936                                 NeuStar, Inc.
Updates: <a href="rfc1034.html">1034</a>, <a href="rfc1035.html">1035</a>                                       A. Hoenes, Ed.
Category: Standards Track                                         TR-Sys
ISSN: 2070-1721                                                June 2010


                   <span class="h1">DNS Zone Transfer Protocol (AXFR)</span>

Abstract

   The standard means within the Domain Name System protocol for
   maintaining coherence among a zone's authoritative name servers
   consists of three mechanisms.  Authoritative Transfer (AXFR) is one
   of the mechanisms and is defined in <a href="rfc1034.html">RFC 1034</a> and <a href="rfc1035.html">RFC 1035</a>.

   The definition of AXFR has proven insufficient in detail, thereby
   forcing implementations intended to be compliant to make assumptions,
   impeding interoperability.  Yet today we have a satisfactory set of
   implementations that do interoperate.  This document is a new
   definition of AXFR -- new in the sense that it records an accurate
   definition of an interoperable AXFR mechanism.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="rfc5741.html#section-2">Section 2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc5936">http://www.rfc-editor.org/info/rfc5936</a>.















<span class="grey">Lewis &amp; Hoenes               Standards Track                    [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc5936.html">RFC 5936</a>            DNS Zone Transfer Protocol (AXFR)          June 2010</span>


Copyright Notice

   Copyright (c) 2010 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

   This document may contain material from IETF Documents or IETF
   Contributions published or made publicly available before November
   10, 2008.  The person(s) controlling the copyright in some of this
   material may not have granted the IETF Trust the right to allow
   modifications of such material outside the IETF Standards Process.
   Without obtaining an adequate license from the person(s) controlling
   the copyright in such materials, this document may not be modified
   outside the IETF Standards Process, and derivative works of it may
   not be created outside the IETF Standards Process, except to format
   it for publication as an RFC or to translate it into languages other
   than English.

























<span class="grey">Lewis &amp; Hoenes               Standards Track                    [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc5936.html">RFC 5936</a>            DNS Zone Transfer Protocol (AXFR)          June 2010</span>


Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-4">4</a>
      <a href="#section-1.1">1.1</a>. Definition of Terms ........................................<a href="#page-4">4</a>
      <a href="#section-1.2">1.2</a>. Scope ......................................................<a href="#page-5">5</a>
      <a href="#section-1.3">1.3</a>. Context ....................................................<a href="#page-5">5</a>
      <a href="#section-1.4">1.4</a>. Coverage and Relationship to Original AXFR Specification ...<a href="#page-5">5</a>
   <a href="#section-2">2</a>. AXFR Messages ...................................................<a href="#page-6">6</a>
      <a href="#section-2.1">2.1</a>. AXFR Query .................................................<a href="#page-8">8</a>
           <a href="#section-2.1.1">2.1.1</a>. Header Values .......................................<a href="#page-8">8</a>
           <a href="#section-2.1.2">2.1.2</a>. Question Section ...................................<a href="#page-10">10</a>
           <a href="#section-2.1.3">2.1.3</a>. Answer Section .....................................<a href="#page-10">10</a>
           <a href="#section-2.1.4">2.1.4</a>. Authority Section ..................................<a href="#page-10">10</a>
           <a href="#section-2.1.5">2.1.5</a>. Additional Section .................................<a href="#page-10">10</a>
      <a href="#section-2.2">2.2</a>. AXFR Response .............................................<a href="#page-11">11</a>
           <a href="#section-2.2.1">2.2.1</a>. Header Values ......................................<a href="#page-12">12</a>
           <a href="#section-2.2.2">2.2.2</a>. Question Section ...................................<a href="#page-14">14</a>
           <a href="#section-2.2.3">2.2.3</a>. Answer Section .....................................<a href="#page-14">14</a>
           <a href="#section-2.2.4">2.2.4</a>. Authority Section ..................................<a href="#page-14">14</a>
           <a href="#section-2.2.5">2.2.5</a>. Additional Section .................................<a href="#page-14">14</a>
      <a href="#section-2.3">2.3</a>. TCP Connection Aborts .....................................<a href="#page-15">15</a>
   <a href="#section-3">3</a>. Zone Contents ..................................................<a href="#page-15">15</a>
      <a href="#section-3.1">3.1</a>. Records to Include ........................................<a href="#page-15">15</a>
      <a href="#section-3.2">3.2</a>. Delegation Records ........................................<a href="#page-16">16</a>
      <a href="#section-3.3">3.3</a>. Glue Records ..............................................<a href="#page-18">18</a>
      <a href="#section-3.4">3.4</a>. Name Compression ..........................................<a href="#page-19">19</a>
      <a href="#section-3.5">3.5</a>. Occluded Names ............................................<a href="#page-19">19</a>
   <a href="#section-4">4</a>. Transport ......................................................<a href="#page-20">20</a>
      <a href="#section-4.1">4.1</a>. TCP .......................................................<a href="#page-20">20</a>
           <a href="#section-4.1.1">4.1.1</a>. AXFR Client TCP ....................................<a href="#page-21">21</a>
           <a href="#section-4.1.2">4.1.2</a>. AXFR Server TCP ....................................<a href="#page-22">22</a>
      <a href="#section-4.2">4.2</a>. UDP .......................................................<a href="#page-22">22</a>
   <a href="#section-5">5</a>. Authorization ..................................................<a href="#page-22">22</a>
   <a href="#section-6">6</a>. Zone Integrity .................................................<a href="#page-23">23</a>
   <a href="#section-7">7</a>. Backwards Compatibility ........................................<a href="#page-24">24</a>
      <a href="#section-7.1">7.1</a>. Server ....................................................<a href="#page-24">24</a>
      <a href="#section-7.2">7.2</a>. Client ....................................................<a href="#page-25">25</a>
   <a href="#section-8">8</a>. Security Considerations ........................................<a href="#page-25">25</a>
   <a href="#section-9">9</a>. IANA Considerations ............................................<a href="#page-25">25</a>
   <a href="#section-10">10</a>. Internationalization Considerations ...........................<a href="#page-25">25</a>
   <a href="#section-11">11</a>. Acknowledgments ...............................................<a href="#page-25">25</a>
   <a href="#section-12">12</a>. References ....................................................<a href="#page-26">26</a>
      <a href="#section-12.1">12.1</a>. Normative References .....................................<a href="#page-26">26</a>
      <a href="#section-12.2">12.2</a>. Informative References ...................................<a href="#page-28">28</a>







<span class="grey">Lewis &amp; Hoenes               Standards Track                    [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc5936.html">RFC 5936</a>            DNS Zone Transfer Protocol (AXFR)          June 2010</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   The Domain Name System standard facilities for maintaining coherent
   servers for a zone consist of three elements.  Authoritative Transfer
   (AXFR) is defined in "Domain Names - Concepts and Facilities"
   [<a href="rfc1034.html" title='"Domain names - concepts and facilities"'>RFC1034</a>] (referred to in this document as <a href="rfc1034.html">RFC 1034</a>) and "Domain
   Names - Implementation and Specification" [<a href="rfc1035.html" title='"Domain names - implementation and specification"'>RFC1035</a>] (henceforth <a href="rfc1035.html">RFC</a>
   <a href="rfc1035.html">1035</a>).  Incremental Zone Transfer (IXFR) is defined in "Incremental
   Zone Transfer in DNS" [<a href="rfc1995.html" title='"Incremental Zone Transfer in DNS"'>RFC1995</a>].  A mechanism for prompt notification
   of zone changes (NOTIFY) is defined in "A Mechanism for Prompt
   Notification of Zone Changes (DNS NOTIFY)" [<a href="rfc1996.html" title='"A Mechanism for Prompt Notification of Zone Changes (DNS NOTIFY)"'>RFC1996</a>].  The goal of
   these mechanisms is to enable a set of DNS name servers to remain
   coherently authoritative for a given zone.

   This document re-specifies the AXFR mechanism as it is deployed in
   the Internet at large, hopefully with the precision expected from
   modern Internet Standards, and thereby updates <a href="rfc1034.html">RFC 1034</a> and <a href="rfc1035.html">RFC 1035</a>.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.1.%20%20Definition%20of%20Terms"></a><a class="selflink" href="#section-1.1" name="section-1.1">1.1</a>.  Definition of Terms</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in "Key words for use in
   RFCs to Indicate Requirement Levels" [<a href="#ref-BCP14" title='"Key words for use in RFCs to Indicate Requirement Levels"'>BCP14</a>].

   Use of "newer"/"new" and "older"/"old" DNS refers to implementations
   written after and prior to the publication of this document.

   "General-purpose DNS implementation" refers to DNS software developed
   for widespread use.  This includes resolvers and servers freely
   accessible as libraries and standalone processes.  This also includes
   proprietary implementations used only in support of DNS service
   offerings.

   "Turnkey DNS implementation" refers to custom-made, single-use
   implementations of DNS.  Such implementations consist of software
   that employs the DNS protocol message format yet does not conform to
   the entire range of DNS functionality.

   The terms "AXFR session", "AXFR server", and "AXFR client" will be
   introduced in the first paragraph of <a href="#section-2">Section 2</a>, after some more
   context has been established.









<span class="grey">Lewis &amp; Hoenes               Standards Track                    [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc5936.html">RFC 5936</a>            DNS Zone Transfer Protocol (AXFR)          June 2010</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.2.%20%20Scope"></a><a class="selflink" href="#section-1.2" name="section-1.2">1.2</a>.  Scope</span>

   In general terms, authoritative name servers for a given zone can use
   various means to achieve coherency of the zone contents they serve.
   For example, there are DNS implementations that assemble answers from
   data stored in relational databases (as opposed to master files),
   relying on the database's non-DNS means to synchronize the database
   instances.  Some of these non-DNS solutions interoperate in some
   fashion.  However, AXFR, IXFR, and NOTIFY are the only protocol-
   defined in-band mechanisms to provide coherence of a set of name
   servers, and they are the only mechanisms specified by the IETF.

   This document does not cover incoherent DNS situations.  There are
   applications of the DNS in which servers for a zone are designed to
   be incoherent.  For these configurations, a coherency mechanism as
   described here would be unsuitable.

   A DNS implementation is not required to support AXFR, IXFR, and
   NOTIFY, but it should have some means for maintaining name server
   coherency.  A general-purpose DNS implementation will likely support
   AXFR (and in the same vein IXFR and NOTIFY), but turnkey DNS
   implementations may exist without AXFR.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.3.%20%20Context"></a><a class="selflink" href="#section-1.3" name="section-1.3">1.3</a>.  Context</span>

   Besides describing the mechanisms themselves, there is the context in
   which they operate to consider.  In the initial specifications of
   AXFR (and IXFR and NOTIFY), little consideration was given to
   security and privacy issues.  Since the original definition of AXFR,
   new opinions have appeared on the access to an entire zone's
   contents.  In this document, the basic mechanisms will be discussed
   separately from the permission to use these mechanisms.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.4.%20%20Coverage%20and%20Relationship%20to%20Original%20AXFR%20Specification"></a><a class="selflink" href="#section-1.4" name="section-1.4">1.4</a>.  Coverage and Relationship to Original AXFR Specification</span>

   This document concentrates on just the definition of AXFR.  Any
   effort to update the specification of the IXFR or NOTIFY mechanisms
   is left to different documents.

   The original "specification" of the AXFR sub-protocol is scattered
   through <a href="rfc1034.html">RFC 1034</a> and <a href="rfc1035.html">RFC 1035</a>.  <a href="rfc1035.html#section-2.2">Section 2.2 of RFC 1035</a> (on page 5)
   depicts the scenario for which AXFR has been designed.  <a href="rfc1034.html#section-4.3.5">Section 4.3.5
   of RFC 1034</a> describes the zone synchronization strategies in general
   and rules for the invocation of a full zone transfer via AXFR; the
   fifth paragraph of that section contains a very short sketch of the
   AXFR protocol; <a href="rfc2181.html#section-5.5">Section 5.5 of RFC 2181</a> has corrected a significant
   flaw in that specification.  <a href="rfc1035.html#section-3.2.3">Section 3.2.3 of RFC 1035</a> has assigned
   the code point for the AXFR QTYPE (see <a href="#section-2.1.2">Section 2.1.2</a> below for more



<span class="grey">Lewis &amp; Hoenes               Standards Track                    [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc5936.html">RFC 5936</a>            DNS Zone Transfer Protocol (AXFR)          June 2010</span>


   details).  <a href="rfc1035.html#section-4.2">Section 4.2 of RFC 1035</a> discusses how the DNS uses the
   transport layer and briefly explains why UDP transport is deemed
   inappropriate for AXFR; the last paragraph of <a href="#section-4.2.2">Section 4.2.2</a> gives
   details regarding TCP connection management for AXFR.  Finally, the
   second paragraph of <a href="rfc1035.html#section-6.3">Section 6.3 in RFC 1035</a> mandates server behavior
   when zone data changes occur during an ongoing zone transfer using
   AXFR.

   This document will update the specification of AXFR.  To this end, it
   fully specifies the record formats and processing rules for AXFR,
   largely expanding on paragraph 5 of <a href="rfc1034.html#section-4.3.5">Section 4.3.5 of RFC 1034</a>, and it
   details the transport considerations for AXFR, thus amending <a href="rfc1035.html#section-4.2.2">Section</a>
   <a href="rfc1035.html#section-4.2.2">4.2.2 of RFC 1035</a>.  Furthermore, it discusses backward-compatibility
   issues and provides policy/management considerations, as well as
   specific security considerations for AXFR.  The goal of this document
   is to define AXFR as it is understood by the DNS community to exist
   today.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20AXFR%20Messages"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  AXFR Messages</span>

   An AXFR session consists of an AXFR query message and the sequence of
   AXFR response messages returned for it.  In this document, the AXFR
   client is the sender of the AXFR query, and the AXFR server is the
   responder.  (Use of terms such as master, slave, primary, and
   secondary are not important for defining AXFR.)  The use of the word
   "session" without qualification refers to an AXFR session.

   An important aspect to keep in mind is that the definition of AXFR is
   restricted to TCP [<a href="https://tools.ietf.org/html/rfc0793" title='"Transmission Control Protocol"'>RFC0793</a>] (see <a href="#section-4">Section 4</a> for details).  The design
   of the AXFR process has certain inherent features that are not easily
   ported to UDP [<a href="https://tools.ietf.org/html/rfc0768" title='"User Datagram Protocol"'>RFC0768</a>].

   The basic format of an AXFR message is the DNS message as defined in
   <a href="#section-4">Section 4</a> ("MESSAGES") of <a href="rfc1035.html">RFC 1035</a> [<a href="rfc1035.html" title='"Domain names - implementation and specification"'>RFC1035</a>], updated by the
   following documents.

   o  The "Basic" DNS specification:

      -  "A Mechanism for Prompt Notification of Zone Changes
          (DNS NOTIFY)" [<a href="rfc1996.html" title='"A Mechanism for Prompt Notification of Zone Changes (DNS NOTIFY)"'>RFC1996</a>]

      -  "Dynamic Updates in the Domain Name System (DNS UPDATE)"
          [<a href="rfc2136.html" title='"Dynamic Updates in the Domain Name System (DNS UPDATE)"'>RFC2136</a>]

      -  "Clarifications to the DNS Specification" [<a href="rfc2181.html" title='"Clarifications to the DNS Specification"'>RFC2181</a>]

      -  "Extension Mechanisms for DNS (EDNS0)" [<a href="rfc2671.html" title='"Extension Mechanisms for DNS (EDNS0)"'>RFC2671</a>]




<span class="grey">Lewis &amp; Hoenes               Standards Track                    [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc5936.html">RFC 5936</a>            DNS Zone Transfer Protocol (AXFR)          June 2010</span>


      -  "Secret Key Transaction Authentication for DNS (TSIG)"
          [<a href="rfc2845.html" title='"Secret Key Transaction Authentication for DNS (TSIG)"'>RFC2845</a>]

      -  "Secret Key Establishment for DNS (TKEY RR)" [<a href="rfc2930.html" title='"Secret Key Establishment for DNS (TKEY RR)"'>RFC2930</a>]

      -  "Obsoleting IQUERY" [<a href="rfc3425.html" title='"Obsoleting IQUERY"'>RFC3425</a>]

      -  "Handling of Unknown DNS Resource Record (RR) Types"
          [<a href="rfc3597.html" title='"Handling of Unknown DNS Resource Record (RR) Types"'>RFC3597</a>]

      -  "HMAC SHA (Hashed Message Authentication Code, Secure Hash
          Algorithm) TSIG Algorithm Identifiers" [<a href="rfc4635.html" title='"HMAC SHA (Hashed Message Authentication Code, Secure Hash Algorithm) TSIG Algorithm Identifiers"'>RFC4635</a>]

      -  "Domain Name System (DNS) IANA Considerations" [<a href="rfc5395.html" title='"Domain Name System (DNS) IANA Considerations"'>RFC5395</a>]

   o  Further additions related to the DNS Security Extensions (DNSSEC),
      defined in these base documents:

      -  "DNS Security Introduction and Requirements" [<a href="rfc4033.html" title='"DNS Security Introduction and Requirements"'>RFC4033</a>]

      -  "Resource Records for the DNS Security Extensions"
          [<a href="rfc4034.html" title='"Resource Records for the DNS Security Extensions"'>RFC4034</a>]

      -  "Protocol Modifications for the DNS Security Extensions"
          [<a href="rfc4035.html" title='"Protocol Modifications for the DNS Security Extensions"'>RFC4035</a>]

      -  "Use of SHA-256 in DNSSEC Delegation Signer (DS) Resource
          Records (RRs)" [<a href="rfc4509.html" title='"Use of SHA-256 in DNSSEC Delegation Signer (DS) Resource Records (RRs)"'>RFC4509</a>]

      -  "DNS Security (DNSSEC) Hashed Authenticated Denial of
          Existence" [<a href="rfc5155.html" title='"DNS Security (DNSSEC) Hashed Authenticated Denial of Existence"'>RFC5155</a>]

      -  "Use of SHA-2 Algorithms with RSA in DNSKEY and RRSIG
          Resource Records for DNSSEC" [<a href="rfc5702.html" title='"Use of SHA-2 Algorithms with RSA in DNSKEY and RRSIG Resource Records for DNSSEC"'>RFC5702</a>]

      -  "Clarifications and Implementation Notes for DNSSECbis"
          [<a href="#ref-DNSSEC-U" title='"Clarifications and Implementation Notes for DNSSECbis"'>DNSSEC-U</a>]

   These documents contain information about the syntax and semantics of
   DNS messages.  They do not interfere with AXFR but are also helpful
   in understanding what will be carried via AXFR.

   For convenience, the synopsis of the DNS message header from
   [<a href="rfc5395.html" title='"Domain Name System (DNS) IANA Considerations"'>RFC5395</a>] (and the IANA registry for DNS Parameters [<a href="#ref-DNSVALS" title='"Domain Name System (DNS) Parameters"'>DNSVALS</a>]) is
   reproduced here informally:






<span class="grey">Lewis &amp; Hoenes               Standards Track                    [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc5936.html">RFC 5936</a>            DNS Zone Transfer Protocol (AXFR)          June 2010</span>


             0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15
           +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
           |                      ID                       |
           +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
           |QR|   OpCode  |AA|TC|RD|RA| Z|AD|CD|   RCODE   |
           +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
           |                QDCOUNT/ZOCOUNT                |
           +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
           |                ANCOUNT/PRCOUNT                |
           +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
           |                NSCOUNT/UPCOUNT                |
           +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
           |                    ARCOUNT                    |
           +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+

   This document makes use of the field names as they appear in this
   diagram.  The names of sections in the body of DNS messages are
   capitalized in this document for clarity, e.g., "Additional section".

   The DNS message size limit from [<a href="rfc1035.html" title='"Domain names - implementation and specification"'>RFC1035</a>] for DNS over UDP (and its
   extension via the EDNS0 mechanism specified in [<a href="rfc2671.html" title='"Extension Mechanisms for DNS (EDNS0)"'>RFC2671</a>]) is not
   relevant for AXFR, as explained in <a href="#section-4">Section 4</a>.  The upper limit on the
   permissible size of a DNS message over TCP is only restricted by the
   TCP framing defined in <a href="rfc1035.html#section-4.2.2">Section 4.2.2 of RFC 1035</a>, which specifies a
   two-octet message length field, understood to be unsigned, and thus
   causing a limit of 65535 octets.  This limit is not changed by EDNS0.

   Note that the TC (truncation) bit is never set by an AXFR server nor
   considered/read by an AXFR client.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.1.%20%20AXFR%20Query"></a><a class="selflink" href="#section-2.1" name="section-2.1">2.1</a>.  AXFR Query</span>

   An AXFR query is sent by a client whenever there is a reason to ask.
   This might be because of scheduled or triggered zone maintenance
   activities (see <a href="rfc1034.html#section-4.3.5">Section 4.3.5 of RFC 1034</a> and DNS NOTIFY [<a href="rfc1996.html" title='"A Mechanism for Prompt Notification of Zone Changes (DNS NOTIFY)"'>RFC1996</a>],
   respectively) or as a result of a command line request, say for
   debugging.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.1.1.%20%20Header%20Values"></a><a class="selflink" href="#section-2.1.1" name="section-2.1.1">2.1.1</a>.  Header Values</span>

   These are the DNS message header values for an AXFR query.

      ID          Selected by client; see Note a)

      QR          MUST be 0 (Query)

      OPCODE      MUST be 0 (Standard Query)




<span class="grey">Lewis &amp; Hoenes               Standards Track                    [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc5936.html">RFC 5936</a>            DNS Zone Transfer Protocol (AXFR)          June 2010</span>


      Flags:
         AA       "n/a" -- see Note b)
         TC       "n/a" -- see Note b)
         RD       "n/a" -- see Note b)
         RA       "n/a" -- see Note b)
         Z        "mbz" -- see Note c)
         AD       "n/a" -- see Note b)
         CD       "n/a" -- see Note b)

      RCODE       MUST be 0 (No error)

      QDCOUNT     Number of entries in Question section;   MUST be 1

      ANCOUNT     Number of entries in Answer section;     MUST be 0

      NSCOUNT     Number of entries in Authority section;  MUST be 0

      ARCOUNT     Number of entries in Additional section -- see Note d)

   Notes:

   a) Set to any value that the client is not already using with the
      same server.  There is no specific means for selecting the value
      in this field.  (Recall that AXFR is done only via TCP connections
      -- see <a href="#section-4">Section 4</a>, "Transport".)

      A server MUST reply using messages that use the same message ID to
      allow a client to have multiple queries outstanding concurrently
      over the same TCP connection -- see Note a) in <a href="#section-2.2.1">Section 2.2.1</a> for
      more details.

   b) "n/a" -- The value in this field has no meaning in the context of
      AXFR query messages.  For the client, it is RECOMMENDED that the
      value be zero.  The server MUST ignore this value.

   c) "mbz" -- The client MUST set this bit to 0; the server MUST ignore
      it.

   d) The client MUST set this field to the number of resource records
      it places into the Additional section.  In the absence of explicit
      specification of new RRs to be carried in the Additional section
      of AXFR queries, the value MAY be 0, 1, or 2.  See <a href="#section-2.1.5">Section 2.1.5</a>,
      "Additional Section", for details on the currently applicable RRs.








<span class="grey">Lewis &amp; Hoenes               Standards Track                    [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc5936.html">RFC 5936</a>            DNS Zone Transfer Protocol (AXFR)          June 2010</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.1.2.%20%20Question%20Section"></a><a class="selflink" href="#section-2.1.2" name="section-2.1.2">2.1.2</a>.  Question Section</span>

   The Question section of the AXFR query MUST conform to <a href="rfc1035.html#section-4.1.2">Section 4.1.2
   of RFC 1035</a>, and contain a single resource record with the following
   values:

      QNAME       the name of the zone requested

      QTYPE       AXFR (= 252), the pseudo-RR type for zone transfer
                  [<a href="#ref-DNSVALS" title='"Domain Name System (DNS) Parameters"'>DNSVALS</a>]

      QCLASS      the class of the zone requested [<a href="#ref-DNSVALS" title='"Domain Name System (DNS) Parameters"'>DNSVALS</a>]

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.1.3.%20%20Answer%20Section"></a><a class="selflink" href="#section-2.1.3" name="section-2.1.3">2.1.3</a>.  Answer Section</span>

   The Answer section MUST be empty.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.1.4.%20%20Authority%20Section"></a><a class="selflink" href="#section-2.1.4" name="section-2.1.4">2.1.4</a>.  Authority Section</span>

   The Authority section MUST be empty.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.1.5.%20%20Additional%20Section"></a><a class="selflink" href="#section-2.1.5" name="section-2.1.5">2.1.5</a>.  Additional Section</span>

   Currently, two kinds of resource records are defined that can appear
   in the Additional section of AXFR queries and responses: EDNS and DNS
   transaction security.  Future specifications defining RRs that can be
   carried in the Additional section of normal DNS transactions need to
   explicitly describe their use with AXFR, should that be desired.

   The client MAY include one OPT resource record [<a href="rfc2671.html" title='"Extension Mechanisms for DNS (EDNS0)"'>RFC2671</a>].  If the
   server does not support EDNS0, the client MUST send this section
   without an OPT resource record if there is a retry.  However, the
   protocol does not define an explicit indication that the server does
   not support EDNS0; that needs to be inferred by the client.  Often,
   the server will return a FormErr(1) that might be related to the OPT
   resource record.  Note that, at the time of this writing, only the
   EXTENDED-RCODE field of the OPT RR is meaningful in the context of
   AXFR; future specifications of EDNS flags and/or EDNS options must
   describe their usage in the context of AXFR, if applicable.

   The client MAY include one transaction integrity and authentication
   resource record, currently a choice of TSIG [<a href="rfc2845.html" title='"Secret Key Transaction Authentication for DNS (TSIG)"'>RFC2845</a>] or SIG(0)
   [<a href="rfc2931.html" title='"DNS Request and Transaction Signatures ( SIG(0)s )"'>RFC2931</a>].  If the server has indicated that it does not recognize
   the resource record, and that the error is indeed caused by the
   resource record, the client probably should not try again.  Removing
   the security data in the face of an obstacle ought to only be done
   with full awareness of the implication of doing so.




<span class="grey">Lewis &amp; Hoenes               Standards Track                   [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc5936.html">RFC 5936</a>            DNS Zone Transfer Protocol (AXFR)          June 2010</span>


   In general, if an AXFR client is aware that an AXFR server does not
   support a particular mechanism, the client SHOULD NOT attempt to
   engage the server using the mechanism (or engage the server at all).
   A client could become aware of a server's abilities via a
   configuration setting or via some other (as yet) undefined means.

   The range of permissible resource records that MAY appear in the
   Additional section might change over time.  If either a change to an
   existing resource record (like the OPT RR for EDNS) is made or a new
   Additional section record is created, the new definitions ought to
   include a discussion on the applicability and impact upon AXFR.
   Future resource records residing in the Additional section might have
   an effect that is orthogonal to AXFR, and so can ride through the
   session as opaque data.  In this case, a "wise" implementation ought
   to be able to pass these records through without disruption.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.2.%20%20AXFR%20Response"></a><a class="selflink" href="#section-2.2" name="section-2.2">2.2</a>.  AXFR Response</span>

   The AXFR response will consist of one or more messages.  The special
   case of a server closing the TCP connection without sending an AXFR
   response is covered in <a href="#section-2.3">Section 2.3</a>.

   An AXFR response that is transferring the zone's contents will
   consist of a series (which could be a series of length 1) of DNS
   messages.  In such a series, the first message MUST begin with the
   SOA resource record of the zone, and the last message MUST conclude
   with the same SOA resource record.  Intermediate messages MUST NOT
   contain the SOA resource record.  The AXFR server MUST copy the
   Question section from the corresponding AXFR query message into the
   first response message's Question section.  For subsequent messages,
   it MAY do the same or leave the Question section empty.

   The AXFR protocol treats the zone contents as an unordered collection
   (or to use the mathematical term, a "set") of RRs.  Except for the
   requirement that the transfer must begin and end with the SOA RR,
   there is no requirement to send the RRs in any particular order or
   grouped into response messages in any particular way.  Although
   servers typically do attempt to send related RRs (such as the RRs
   forming an RRset, and the RRsets of a name) as a contiguous group or,
   when message space allows, in the same response message, they are not
   required to do so, and clients MUST accept any ordering and grouping
   of the non-SOA RRs.  Each RR SHOULD be transmitted only once, and
   AXFR clients MUST ignore any duplicate RRs received.

   Each AXFR response message SHOULD contain a sufficient number of RRs
   to reasonably amortize the per-message overhead, up to the largest
   number that will fit within a DNS message (taking the required
   content of the other sections into account, as described below).



<span class="grey">Lewis &amp; Hoenes               Standards Track                   [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc5936.html">RFC 5936</a>            DNS Zone Transfer Protocol (AXFR)          June 2010</span>


   Some old AXFR clients expect each response message to contain only a
   single RR.  To interoperate with such clients, the server MAY
   restrict response messages to a single RR.  As there is no standard
   way to automatically detect such clients, this typically requires
   manual configuration at the server.

   To indicate an error in an AXFR response, the AXFR server sends a
   single DNS message when the error condition is detected, with the
   response code set to the appropriate value for the condition
   encountered.  Such a message terminates the AXFR session; it MUST
   contain a copy of the Question section from the AXFR query in its
   Question section, but the inclusion of the terminating SOA resource
   record is not necessary.

   An AXFR server may send a number of AXFR response messages free of an
   error condition before it sends the message indicating an error.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.2.1.%20%20Header%20Values"></a><a class="selflink" href="#section-2.2.1" name="section-2.2.1">2.2.1</a>.  Header Values</span>

   These are the DNS message header values for AXFR responses.

      ID          MUST be copied from request -- see Note a)

      QR          MUST be 1 (Response)

      OPCODE      MUST be 0 (Standard Query)

      Flags:
         AA       normally 1 -- see Note b)
         TC       MUST be 0 (Not truncated)
         RD       RECOMMENDED: copy request's value; MAY be set to 0
         RA       SHOULD be 0 -- see Note c)
         Z        "mbz" -- see Note d)
         AD       "mbz" -- see Note d)
         CD       "mbz" -- see Note d)

      RCODE       See Note e)

      QDCOUNT     MUST be 1 in the first message;
                  MUST be 0 or 1 in all following messages;
                  MUST be 1 if RCODE indicates an error

      ANCOUNT     See Note f)

      NSCOUNT     MUST be 0

      ARCOUNT     See Note g)




<span class="grey">Lewis &amp; Hoenes               Standards Track                   [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc5936.html">RFC 5936</a>            DNS Zone Transfer Protocol (AXFR)          June 2010</span>


   Notes:

   a) Because some old implementations behave differently than is now
      desired, the requirement on this field is stated in detail.  New
      DNS servers MUST set this field to the value of the AXFR query ID
      in each AXFR response message for the session.  AXFR clients MUST
      be able to manage sessions resulting from the issuance of multiple
      outstanding queries, whether AXFR queries or other DNS queries.  A
      client SHOULD discard responses that do not correspond (via the
      message ID) to any outstanding queries.

      Unless the client is sure that the server will consistently set
      the ID field to the query's ID, the client is NOT RECOMMENDED to
      issue any other queries until the end of the zone transfer.  A
      client MAY become aware of a server's abilities via a
      configuration setting.

   b) If the RCODE is 0 (no error), then the AA bit MUST be 1.  For any
      other value of RCODE, the AA bit MUST be set according to the
      rules for that error code.  If in doubt, it is RECOMMENDED that it
      be set to 1.  It is RECOMMENDED that the value be ignored by the
      AXFR client.

   c) It is RECOMMENDED that the server set the value to 0; the client
      MUST ignore this value.

      The server MAY set this value according to the local policy
      regarding recursive service, but doing so might confuse the
      interpretation of the response, as AXFR cannot be retrieved
      recursively.  A client MAY note the server's policy regarding
      recursive service from this value, but SHOULD NOT conclude that
      the AXFR response was obtained recursively, even if the RD bit was
      1 in the query.

   d) "mbz" -- The server MUST set this bit to 0; the client MUST ignore
      it.

   e) In the absence of an error, the server MUST set the value of this
      field to NoError(0).  If a server is not authoritative for the
      queried zone, the server SHOULD set the value to NotAuth(9).
      (Reminder: Consult the appropriate IANA registry [<a href="#ref-DNSVALS" title='"Domain Name System (DNS) Parameters"'>DNSVALS</a>].)  If a
      client receives any other value in response, it MUST act according
      to the error.  For example, a malformed AXFR query or the presence
      of an OPT resource record sent to an old server will result in a
      FormErr(1) value.  This value is not set as part of the AXFR-
      specific response processing.  The same is true for other values
      indicating an error.




<span class="grey">Lewis &amp; Hoenes               Standards Track                   [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc5936.html">RFC 5936</a>            DNS Zone Transfer Protocol (AXFR)          June 2010</span>


   f) The count of answer records MUST equal the number of resource
      records in the AXFR Answer section.  When a server is aware that a
      client will only accept response messages with a single resource
      record, then the value MUST be 1.  A server MAY be made aware of a
      client's limitations via configuration data.

   g) The server MUST set this field to the number of resource records
      it places into the Additional section.  In the absence of explicit
      specification of new RRs to be carried in the Additional section
      of AXFR response messages, the value MAY be 0, 1, or 2.  See
      <a href="#section-2.1.5">Section 2.1.5</a> above for details on the currently applicable RRs
      and <a href="#section-2.2.5">Section 2.2.5</a> for additional considerations specific to AXFR
      servers.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.2.2.%20%20Question%20Section"></a><a class="selflink" href="#section-2.2.2" name="section-2.2.2">2.2.2</a>.  Question Section</span>

   In the first response message, this section MUST be copied from the
   query.  In subsequent messages, this section MAY be copied from the
   query, or it MAY be empty.  However, in an error response message
   (see <a href="#section-2.2">Section 2.2</a>), this section MUST be copied as well.  The content
   of this section MAY be used to determine the context of the message,
   that is, the name of the zone being transferred.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.2.3.%20%20Answer%20Section"></a><a class="selflink" href="#section-2.2.3" name="section-2.2.3">2.2.3</a>.  Answer Section</span>

   The Answer section MUST be populated with the zone contents.  See
   <a href="#section-3">Section 3</a> below on encoding zone contents.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.2.4.%20%20Authority%20Section"></a><a class="selflink" href="#section-2.2.4" name="section-2.2.4">2.2.4</a>.  Authority Section</span>

   The Authority section MUST be empty.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.2.5.%20%20Additional%20Section"></a><a class="selflink" href="#section-2.2.5" name="section-2.2.5">2.2.5</a>.  Additional Section</span>

   The contents of this section MUST follow the guidelines for the OPT,
   TSIG, and SIG(0) RRs, or whatever other future record is possible
   here.  The contents of <a href="#section-2.1.5">Section 2.1.5</a> apply analogously as well.

   The following considerations specifically apply to AXFR responses:

   If the client has supplied an EDNS OPT RR in the AXFR query and if
   the server supports EDNS as well, it SHOULD include one OPT RR in the
   first response message and MAY do so in subsequent response messages
   (see <a href="#section-2.2">Section 2.2</a>); the specifications of EDNS options to be carried
   in the OPT RR may impose stronger requirements.






<span class="grey">Lewis &amp; Hoenes               Standards Track                   [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc5936.html">RFC 5936</a>            DNS Zone Transfer Protocol (AXFR)          June 2010</span>


   If the client has supplied a transaction security resource record
   (currently a choice of TSIG and SIG(0)) and the server supports the
   method chosen by the client, it MUST place the corresponding resource
   record into the AXFR response message(s), according to the rules
   specified for that method.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.3.%20%20TCP%20Connection%20Aborts"></a><a class="selflink" href="#section-2.3" name="section-2.3">2.3</a>.  TCP Connection Aborts</span>

   If an AXFR client sends a query on a TCP connection and the
   connection is closed at any point, the AXFR client MUST consider the
   AXFR session terminated.  The message ID MAY be used again on a new
   connection, even if the question and AXFR server are the same.

   Facing a dropped connection, a client SHOULD try to make some
   determination as to whether the connection closure was the result of
   network activity or due to a decision by the AXFR server.  This
   determination is not an exact science.  It is up to the AXFR client
   to react, but the implemented reaction SHOULD NOT be either an
   endless cycle of retries or an increasing (in frequency) retry rate.

   An AXFR server implementer should take into consideration the dilemma
   described above when a connection is closed with an outstanding query
   in the pipeline.  For this reason, a server ought to reserve this
   course of action for situations in which it believes beyond a doubt
   that the AXFR client is attempting abusive behavior.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Zone%20Contents"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Zone Contents</span>

   The objective of the AXFR session is to request and transfer the
   contents of a zone, in order to permit the AXFR client to faithfully
   reconstruct the zone as it exists at the primary server for the given
   zone serial number.  The word "exists" here designates the externally
   visible behavior, i.e., the zone content that is being served (handed
   out to clients) -- not its persistent representation in a zone file
   or database used by the server -- and that for consistency should be
   served subsequently by the AXFR client in an identical manner.

   Over time the definition of a zone has evolved from denoting a static
   set of records to also cover a dynamically updated set of records,
   and then a potentially continually regenerated set of records (e.g.,
   RRs synthesized "on the fly" from rule sets or database lookup
   results in other forms than RR format) as well.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.1.%20%20Records%20to%20Include"></a><a class="selflink" href="#section-3.1" name="section-3.1">3.1</a>.  Records to Include</span>

   In the Answer section of AXFR response messages, the resource records
   within a zone for the given serial number MUST appear.  The
   definition of what belongs in a zone is described in <a href="rfc1034.html">RFC 1034</a>,



<span class="grey">Lewis &amp; Hoenes               Standards Track                   [Page 15]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc5936.html">RFC 5936</a>            DNS Zone Transfer Protocol (AXFR)          June 2010</span>


   <a href="#section-4.2">Section 4.2</a>, "How the database is divided into zones" (in particular
   <a href="#section-4.2.1">Section 4.2.1</a>, "Technical considerations"), and it has been clarified
   in <a href="rfc2181.html#section-6">Section 6 of RFC 2181</a>.

   Zones for which it is impractical to list the entire zone for a
   serial number are not suitable for AXFR retrieval.  A typical (but
   not limiting) description of such a zone is a zone consisting of
   responses generated via other database lookups and/or computed based
   upon ever-changing data.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.2.%20%20Delegation%20Records"></a><a class="selflink" href="#section-3.2" name="section-3.2">3.2</a>.  Delegation Records</span>

   In <a href="rfc1034.html#section-4.2.1">Section 4.2.1 of RFC 1034</a>, this text appears (keep in mind that
   the "should" in the quotation predates [<a href="#ref-BCP14" title='"Key words for use in RFCs to Indicate Requirement Levels"'>BCP14</a>], cf. <a href="#section-1.1">Section 1.1</a>):

      The RRs that describe cuts ... should be exactly the same as the
      corresponding RRs in the top node of the subzone.

   There has been some controversy over this statement and the impact on
   which NS resource records are included in a zone transfer.

   The phrase "that describe cuts" is a reference to the NS set and
   applicable glue records.  It does not mean that the cut point and
   apex resource records are identical.  For example, the SOA resource
   record is only found at the apex.  The discussion here is restricted
   to just the NS resource record set and glue, as these "describe
   cuts".

   DNSSEC resource records have special specifications regarding their
   occurrence at a zone cut and the apex of a zone.  This was first
   described in Sections <a href="#section-5.3">5.3</a> ff. and 6.2 of <a href="rfc2181.html">RFC 2181</a> (for the initial
   specification of DNSSEC), which parts of <a href="rfc2181.html">RFC 2181</a> now in fact are
   historical.  The current DNSSEC core document set (see second bullet
   in <a href="#section-2">Section 2</a> above) gives the full details for DNSSEC(bis) resource
   record placement, and <a href="rfc4035.html#section-3.1.5">Section 3.1.5 of RFC 4035</a> normatively specifies
   their treatment during AXFR; the alternate NSEC3 resource record
   defined later in <a href="rfc5155.html">RFC 5155</a> behaves identically to the NSEC RR, for the
   purpose of AXFR.

   Informally:

   o  The DS RRSet only occurs at the parental side of a zone cut and is
      authoritative data in the parent zone, not the secure child zone.

   o  The DNSKEY RRSet only occurs at the apex of a signed zone and is
      part of the authoritative data of the zone it serves.





<span class="grey">Lewis &amp; Hoenes               Standards Track                   [Page 16]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc5936.html">RFC 5936</a>            DNS Zone Transfer Protocol (AXFR)          June 2010</span>


   o  Independent RRSIG RRSets occur at the signed parent side of a zone
      cut and at the apex of a signed zone; they are authoritative data
      in the respective zone; simple queries for RRSIG resource records
      may return both RRSets at once if the same server is authoritative
      for the parent zone and the child zone (<a href="rfc4035.html#section-3.1.5">Section 3.1.5 of RFC 4035</a>
      describes how to distinguish these RRs); this seeming ambiguity
      does not occur for AXFR, since each such RRSIG RRset belongs to a
      single zone.

   o  Different NSEC [<a href="rfc4034.html" title='"Resource Records for the DNS Security Extensions"'>RFC4034</a>] (or NSEC3 [<a href="rfc5155.html" title='"DNS Security (DNSSEC) Hashed Authenticated Denial of Existence"'>RFC5155</a>]) resource records
      equally may occur at the parental side of a zone cut and at the
      apex of a zone; each such resource record belongs to exactly one
      of these zones and is to be included in the AXFR of that zone.

   One issue is that in operations there are times when the NS resource
   records for a zone might be different at a cut point in the parent
   and at the apex of a zone.  Sometimes this is the result of an error,
   and sometimes it is part of an ongoing change in name servers.  The
   DNS protocol is robust enough to overcome inconsistencies up to (but
   not including) there being no parent-indicated NS resource record
   referencing a server that is able to serve the child zone.  This
   robustness is one quality that has fueled the success of the DNS.
   Still, the inconsistency is an error state, and steps need to be
   taken to make it apparent (if it is unplanned).

   Another issue is that the AXFR server could be authoritative for a
   different set of zones than the AXFR client.  It is possible that the
   AXFR server be authoritative for both halves of an inconsistent cut
   point and that the AXFR client is authoritative for just the parent
   side of the cut point.

   When facing a situation in which a cut point's NS resource records do
   not match the authoritative set, the question arises whether an AXFR
   server responds with the NS resource record set that is in the zone
   being transferred or the one that is at the authoritative location.

   The AXFR response MUST contain the cut point NS resource record set
   registered with the zone whether it agrees with the authoritative set
   or not.  "Registered with" can be widely interpreted to include data
   residing in the zone file of the zone for the particular serial
   number (in zone file environments) or as any data configured to be in
   the zone (database), statically or dynamically.









<span class="grey">Lewis &amp; Hoenes               Standards Track                   [Page 17]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc5936.html">RFC 5936</a>            DNS Zone Transfer Protocol (AXFR)          June 2010</span>


   The reasons for this requirement are:

   1) The AXFR server might not be able to determine that there is an
      inconsistency given local data; hence, requiring consistency would
      mean a lot more needed work and even network retrieval of data.
      An authoritative server ought not be required to perform any
      queries.

   2) By transferring the inconsistent NS resource records from a server
      that is authoritative for both the cut point and the apex to a
      client that is not authoritative for both, the error is exposed.
      For example, an authorized administrator can manually request the
      AXFR and inspect the results to see the inconsistent records.  (A
      server authoritative for both halves would otherwise always answer
      from the more authoritative set, concealing the error.)

   3) The inconsistent NS resource record set might indicate a problem
      in a registration database.

   4) This requirement is necessary to ensure that retrieving a given
      (zone, serial) pair by AXFR yields the exact same set of resource
      records, no matter which of the zone's authoritative servers is
      chosen as the source of the transfer.

   If an AXFR server were allowed to respond with the authoritative NS
   RRset of a child zone instead of a parent-side NS RRset in the zone
   being transferred, the set of records returned could vary depending
   on whether or not the server happened to be authoritative for the
   child zone as well.

   The property that a given (zone, serial) pair corresponds to a
   single, well-defined set of records is necessary for the correct
   operation of incremental transfer protocols such as IXFR [<a href="rfc1995.html" title='"Incremental Zone Transfer in DNS"'>RFC1995</a>].
   For example, a client may retrieve a zone by AXFR from one server,
   and then apply an incremental change obtained by IXFR from a
   different server.  If the two servers have different ideas of the
   zone contents, the client can end up attempting to incrementally add
   records that already exist or to delete records that do not exist.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.3.%20%20Glue%20Records"></a><a class="selflink" href="#section-3.3" name="section-3.3">3.3</a>.  Glue Records</span>

   As quoted in the previous section, <a href="rfc1034.html#section-4.2.1">Section 4.2.1 of RFC 1034</a> provides
   guidance and rationale for the inclusion of glue records as part of
   an AXFR response.  And, as also argued in the previous section of
   this document, even when there is an inconsistency between the
   address in a glue record and the authoritative copy of the name
   server's address, the glue resource record that is registered as part
   of the zone for that serial number is to be included.



<span class="grey">Lewis &amp; Hoenes               Standards Track                   [Page 18]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-19" id="page-19" name="page-19"> </a>
<span class="grey"><a href="rfc5936.html">RFC 5936</a>            DNS Zone Transfer Protocol (AXFR)          June 2010</span>


   This applies to glue records for any address family [<a href="#ref-IANA-AF" title='"Address Family Numbers"'>IANA-AF</a>].

   The AXFR response MUST contain the appropriate glue records as
   registered with the zone.  The interpretation of "registered with" in
   the previous section applies here.  Inconsistent glue records are an
   operational matter.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.4.%20%20Name%20Compression"></a><a class="selflink" href="#section-3.4" name="section-3.4">3.4</a>.  Name Compression</span>

   Compression of names in DNS messages is described in <a href="rfc1035.html#section-4.1.4">RFC 1035,
   Section 4.1.4</a>, "Message compression".  The issue highlighted here
   relates to a comment made in <a href="rfc1034.html#section-3.1">RFC 1034, Section 3.1</a>, "Name space
   specifications and terminology", which says:

      When you receive a domain name or label, you should preserve its
      case.

   ("Should" in the quote predates [<a href="#ref-BCP14" title='"Key words for use in RFCs to Indicate Requirement Levels"'>BCP14</a>].)

   Since the primary objective of AXFR is to enable the client to serve
   the same zone content as the server, unlike such normal DNS responses
   that are expected to preserve the case in the query, the actual zone
   transfer needs to retain the case of the labels in the zone content.
   Hence, name compression in an AXFR message SHOULD be performed in a
   case-preserving manner, unlike how it is done for "normal" DNS
   responses.  That is, although when comparing a domain name for
   matching, "a" equals "A", when comparing for the purposes of message
   compression for AXFR, "a" is not equal to "A".  Note that this is not
   the usual definition of name comparison in the DNS protocol and
   represents a new understanding of the requirement on AXFR servers.

   Rules governing name compression of RDATA in an AXFR message MUST
   abide by the specification in "Handling of Unknown DNS Resource
   Record (RR) Types" [<a href="rfc3597.html" title='"Handling of Unknown DNS Resource Record (RR) Types"'>RFC3597</a>], specifically, <a href="#section-4">Section 4</a> on "Domain Name
   Compression".

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.5.%20%20Occluded%20Names"></a><a class="selflink" href="#section-3.5" name="section-3.5">3.5</a>.  Occluded Names</span>

   Dynamic Update [<a href="rfc2136.html" title='"Dynamic Updates in the Domain Name System (DNS UPDATE)"'>RFC2136</a>] operations, and in particular their
   interaction with DNAME [<a href="rfc2672.html" title='"Non-Terminal DNS Name Redirection"'>RFC2672</a>], can have a side effect of occluding
   names in a zone.  The addition of a delegation point via dynamic
   update will render all subordinate domain names to be in a limbo,
   still part of the zone but not available to the lookup process.  The
   addition of a DNAME resource record has the same impact.  The
   subordinate names are said to be "occluded".






<span class="grey">Lewis &amp; Hoenes               Standards Track                   [Page 19]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-20" id="page-20" name="page-20"> </a>
<span class="grey"><a href="rfc5936.html">RFC 5936</a>            DNS Zone Transfer Protocol (AXFR)          June 2010</span>


   Occluded names MUST be included in AXFR responses.  An AXFR client
   MUST be able to identify and handle occluded names.  The rationale
   for this action is based on a speedy recovery if the dynamic update
   operation was in error and is to be undone.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Transport"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Transport</span>

   AXFR sessions are currently restricted to TCP by Section 4.3.5 of <a href="rfc1034.html">RFC</a>
   <a href="rfc1034.html">1034</a>, which states:

      Because accuracy is essential, TCP or some other reliable protocol
      must be used for AXFR requests.

   The restriction to TCP is also mentioned in <a href="#section-6.1.3.2">Section 6.1.3.2</a> of
   "Requirements for Internet Hosts - Application and Support"
   [<a href="rfc1123.html" title='"Requirements for Internet Hosts - Application and Support"'>RFC1123</a>].

   The most common scenario is for an AXFR client to open a TCP
   connection to the AXFR server, send an AXFR query, receive the AXFR
   response, and then close the connection.  But variations of that most
   simple scenario are legitimate and likely: in particular, sending a
   query for the zone's SOA resource record first over the same TCP
   connection, and reusing an existing TCP connection for other queries.

   Therefore, the assumption that a TCP connection is dedicated to a
   single AXFR session is incorrect.  This wrong assumption has led to
   implementation choices that prevent either multiple concurrent zone
   transfers or the use of an open connection for other queries.

   Since the early days of the DNS, operators who have sets of name
   servers that are authoritative for a common set of zones have found
   it desirable to be able to have multiple concurrent zone transfers in
   progress; this way, a name server does not have to wait for one zone
   transfer to complete before the next can begin.  <a href="rfc1035.html">RFC 1035</a> did not
   exclude this possibility, but legacy implementations failed to
   support this functionality efficiently, over a single TCP connection.
   The remaining presence of such legacy implementations makes it
   necessary that new general-purpose client implementations still
   provide options for graceful fallback to the old behavior in their
   support of concurrent DNS transactions and AXFR sessions on a single
   TCP connection.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.1.%20%20TCP"></a><a class="selflink" href="#section-4.1" name="section-4.1">4.1</a>.  TCP</span>

   In the original definition, there arguably is an implicit assumption
   (probably unintentional) that a TCP connection is used for one and
   only one AXFR session.  This is evidenced in the lack of an explicit
   requirement to copy the Question section and/or the message ID into



<span class="grey">Lewis &amp; Hoenes               Standards Track                   [Page 20]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-21" id="page-21" name="page-21"> </a>
<span class="grey"><a href="rfc5936.html">RFC 5936</a>            DNS Zone Transfer Protocol (AXFR)          June 2010</span>


   responses, no explicit ordering information within the AXFR response
   messages, and the lack of an explicit notice indicating that a zone
   transfer continues in the next message.

   The guidance given below is intended to enable better performance of
   the AXFR exchange as well as provide guidelines on interactions with
   older software.  Better performance includes being able to multiplex
   DNS message exchanges including zone transfer sessions.  Guidelines
   for interacting with older software are generally applicable to new
   AXFR clients.  In the reverse situation -- older AXFR client and
   newer AXFR server -- the server ought to operate within the
   specification for an older server.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.1.1.%20%20AXFR%20Client%20TCP"></a><a class="selflink" href="#section-4.1.1" name="section-4.1.1">4.1.1</a>.  AXFR Client TCP</span>

   An AXFR client MAY request a connection to an AXFR server for any
   reason.  An AXFR client SHOULD close the connection when there is no
   apparent need to use the connection for some time period.  The AXFR
   server ought not have to maintain idle connections; the burden of
   connection closure ought to be on the client.  "Apparent need" for
   the connection is a judgment for the AXFR client and the DNS client.
   If the connection is used for multiple sessions, or if it is known
   that sessions will be coming, or if there is other query/response
   traffic anticipated or currently on the open connection, then there
   is "apparent need".

   An AXFR client can cancel the delivery of a zone only by closing the
   connection.  However, this action will also cancel all other
   outstanding activity using the connection.  There is no other
   mechanism by which an AXFR response can be cancelled.

   When a TCP connection is closed remotely (relative to the client),
   whether by the AXFR server or due to a network event, the AXFR client
   MUST cancel all outstanding sessions and non-AXFR transactions.
   Recovery from this situation is not straightforward.  If the
   disruption was a spurious event, attempting to restart the connection
   would be proper.  If the disruption was caused by a failure that
   proved to be persistent, the AXFR client would be wise not to spend
   too many resources trying to rebuild the connection.  Finally, if the
   connection was dropped because of a policy at the AXFR server (as can
   be the case with older AXFR servers), the AXFR client would be wise
   not to retry the connection.  Unfortunately, knowing which of the
   three cases above (momentary disruption, failure, policy) applies is
   not possible with certainty, and can only be assessed by heuristics.
   This exemplifies the general complications for clients in connection-
   oriented protocols not receiving meaningful error responses.





<span class="grey">Lewis &amp; Hoenes               Standards Track                   [Page 21]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-22" id="page-22" name="page-22"> </a>
<span class="grey"><a href="rfc5936.html">RFC 5936</a>            DNS Zone Transfer Protocol (AXFR)          June 2010</span>


   An AXFR client MAY use an already opened TCP connection to start an
   AXFR session.  Using an existing open connection is RECOMMENDED over
   opening a new connection.  (Non-AXFR session traffic can also use an
   open connection.)  If in doing so the AXFR client realizes that the
   responses cannot be properly differentiated (lack of matching query
   IDs, for example) or the connection is terminated for a remote
   reason, then the AXFR client SHOULD NOT attempt to reuse an open
   connection with the specific AXFR server until the AXFR server is
   updated (which is, of course, not an event captured in the DNS
   protocol).

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.1.2.%20%20AXFR%20Server%20TCP"></a><a class="selflink" href="#section-4.1.2" name="section-4.1.2">4.1.2</a>.  AXFR Server TCP</span>

   An AXFR server MUST be able to handle multiple AXFR sessions on a
   single TCP connection, as well as to handle other query/response
   transactions over it.

   If a TCP connection is closed remotely, the AXFR server MUST cancel
   all AXFR sessions in place.  No retry activity is necessary; that is
   initiated by the AXFR client.

   Local policy MAY dictate that a TCP connection is to be closed.  Such
   an action SHOULD be in reaction to limits such as those placed on the
   number of outstanding open connections.  Closing a connection in
   response to a suspected security event SHOULD be done only in extreme
   cases, when the server is certain the action is warranted.  An
   isolated request for a zone not on the AXFR server SHOULD receive a
   response with the appropriate response code and not see the
   connection broken.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.2.%20%20UDP"></a><a class="selflink" href="#section-4.2" name="section-4.2">4.2</a>.  UDP</span>

   With the addition of EDNS0 and applications that require many small
   zones, such as in web hosting and some ENUM scenarios, AXFR sessions
   on UDP would now seem desirable.  However, there are still some
   aspects of AXFR sessions that are not easily translated to UDP.

   Therefore, this document does not update <a href="rfc1035.html">RFC 1035</a> in this respect:
   AXFR sessions over UDP transport are not defined.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Authorization"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Authorization</span>

   A zone administrator has the option to restrict AXFR access to a
   zone.  This was not envisioned in the original design of the DNS but
   has emerged as a requirement as the DNS has evolved.  Restrictions on
   AXFR could be for various reasons including a desire (or in some
   instances, having a legal requirement) to keep the bulk version of
   the zone concealed or to prevent the servers from handling the load



<span class="grey">Lewis &amp; Hoenes               Standards Track                   [Page 22]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-23" id="page-23" name="page-23"> </a>
<span class="grey"><a href="rfc5936.html">RFC 5936</a>            DNS Zone Transfer Protocol (AXFR)          June 2010</span>


   incurred in serving AXFR.  It has been argued that these reasons are
   questionable, but this document, driven by the desire to leverage the
   interoperable practice that has evolved since <a href="rfc1035.html">RFC 1035</a>, acknowledges
   the factual requirement to provide mechanisms to restrict AXFR.

   A DNS implementation SHOULD provide means to restrict AXFR sessions
   to specific clients.

   An implementation SHOULD allow access to be granted to Internet
   Protocol addresses and ranges, regardless of whether a source address
   could be spoofed.  Combining this with techniques such as Virtual
   Private Networks (VPNs) [<a href="rfc2764.html" title='"A Framework for IP Based Virtual Private Networks"'>RFC2764</a>] or Virtual LANs has proven to be
   effective.

   A general-purpose implementation is RECOMMENDED to implement access
   controls based upon "Secret Key Transaction Authentication for DNS
   (TSIG)" [<a href="rfc2845.html" title='"Secret Key Transaction Authentication for DNS (TSIG)"'>RFC2845</a>] and/or "DNS Request and Transaction Signatures
   ( SIG(0)s )" [<a href="rfc2931.html" title='"DNS Request and Transaction Signatures ( SIG(0)s )"'>RFC2931</a>].

   A general-purpose implementation SHOULD allow access to be open to
   all AXFR requests.  That is, an operator ought to be able to allow
   any AXFR query to be granted.

   A general-purpose implementation SHOULD NOT have a default policy for
   AXFR requests to be "open to all".  For example, a default could be
   to restrict transfers to addresses selected by the DNS
   administrator(s) for zones on the server.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20Zone%20Integrity"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  Zone Integrity</span>

   An AXFR client MUST ensure that only a successfully transferred copy
   of the zone data can be used to serve this zone.  Previous
   description and implementation practice has introduced a two-stage
   model of the whole zone synchronization procedure:  Upon a trigger
   event (e.g., when polling of a SOA resource record detects a change
   in the SOA serial number, or when a DNS NOTIFY request [<a href="rfc1996.html" title='"A Mechanism for Prompt Notification of Zone Changes (DNS NOTIFY)"'>RFC1996</a>] is
   received), the AXFR session is initiated, whereby the zone data are
   saved in a zone file or database (this latter step is necessary
   anyway to ensure proper restart of the server); upon successful
   completion of the AXFR operation and some sanity checks, this data
   set is "loaded" and made available for serving the zone in an atomic
   operation, and flagged "valid" for use during the next restart of the
   DNS server; if any error is detected, this data set MUST be deleted,
   and the AXFR client MUST continue to serve the previous version of
   the zone, if it did before.  The externally visible behavior of an
   AXFR client implementation MUST be equivalent to that of this two-
   stage model.




<span class="grey">Lewis &amp; Hoenes               Standards Track                   [Page 23]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-24" id="page-24" name="page-24"> </a>
<span class="grey"><a href="rfc5936.html">RFC 5936</a>            DNS Zone Transfer Protocol (AXFR)          June 2010</span>


   If an AXFR client rejects data obtained in an AXFR session, it SHOULD
   remember the serial number and MAY attempt to retrieve the same zone
   version again.  The reason the same retrieval could make sense is
   that the reason for the rejection could be rooted in an
   implementation detail of one AXFR server used for the zone and not
   present in another AXFR server used for the zone.

   Ensuring that an AXFR client does not accept a forged copy of a zone
   is important to the security of a zone.  If a zone operator has the
   opportunity, protection can be afforded via dedicated links, physical
   or virtual via a VPN among the authoritative servers.  But there are
   instances in which zone operators have no choice but to run AXFR
   sessions over the global public Internet.

   Besides best attempts at securing TCP connections, DNS
   implementations SHOULD provide means to make use of "Secret Key
   Transaction Authentication for DNS (TSIG)" [<a href="rfc2845.html" title='"Secret Key Transaction Authentication for DNS (TSIG)"'>RFC2845</a>] and/or "DNS
   Request and Transaction Signatures ( SIG(0)s )" [<a href="rfc2931.html" title='"DNS Request and Transaction Signatures ( SIG(0)s )"'>RFC2931</a>] to allow
   AXFR clients to verify the contents.  These techniques MAY also be
   used for authorization.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20Backwards%20Compatibility"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  Backwards Compatibility</span>

   Describing backwards compatibility is difficult because of the lack
   of specifics in the original definition.  In this section, some hints
   at building in backwards compatibility are given, mostly repeated
   from the relevant earlier sections.

   Backwards compatibility is not necessary, but the greater the extent
   of an implementation's compatibility, the greater its
   interoperability.  For turnkey implementations, this is not usually a
   concern.  For general-purpose implementations, this takes on varying
   levels of importance, depending on the implementer's desire to
   maintain interoperability.

   It is unfortunate that a need to fall back to older behavior cannot
   be discovered, and thus has to be noted in a configuration file.  An
   implementation SHOULD, in its documentation, encourage operators to
   periodically review AXFR clients and servers it has made notes about
   repeatedly, as old software gets updated from time to time.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.1.%20%20Server"></a><a class="selflink" href="#section-7.1" name="section-7.1">7.1</a>.  Server</span>

   An AXFR server has the luxury of being able to react to an AXFR
   client's abilities, with the exception of knowing whether the client
   can accept multiple resource records per AXFR response message.  The
   knowledge that a client is so restricted cannot be discovered; hence,
   it has to be set by configuration.



<span class="grey">Lewis &amp; Hoenes               Standards Track                   [Page 24]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-25" id="page-25" name="page-25"> </a>
<span class="grey"><a href="rfc5936.html">RFC 5936</a>            DNS Zone Transfer Protocol (AXFR)          June 2010</span>


   An implementation of an AXFR server MAY permit configuring, on a per
   AXFR client basis, the necessity to revert to a single resource
   record per message; in that case, the default SHOULD be to use
   multiple records per message.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.2.%20%20Client"></a><a class="selflink" href="#section-7.2" name="section-7.2">7.2</a>.  Client</span>

   An AXFR client has the opportunity to try other features (i.e., those
   not defined by this document) when querying an AXFR server.

   Attempting to issue multiple DNS queries over a TCP transport for an
   AXFR session SHOULD be aborted if it interrupts the original request,
   and SHOULD take into consideration whether the AXFR server intends to
   close the connection immediately upon completion of the original
   (connection-causing) zone transfer.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20Security%20Considerations"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  Security Considerations</span>

   This document is a clarification of a mechanism outlined in RFCs 1034
   and 1035 and as such does not add any new security considerations.
   <a href="rfc3833.html">RFC 3833</a> [<a href="rfc3833.html" title='"Threat Analysis of the Domain Name System (DNS)"'>RFC3833</a>] is devoted entirely to security considerations for
   the DNS; its <a href="#section-4.3">Section 4.3</a> delineates zone transfer security aspects
   from the security threats addressed by DNSSEC.

   Concerns regarding authorization, traffic flooding, and message
   integrity are mentioned in "Authorization" (<a href="#section-5">Section 5</a>), "TCP"
   (<a href="#section-4.1">Section 4.1</a>), and "Zone Integrity" (<a href="#section-6">Section 6</a>).

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/9.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-9" name="section-9">9</a>.  IANA Considerations</span>

   IANA has added a reference to this RFC in the AXFR (252) row of the
   "Resource Record (RR) TYPEs" subregistry of the "Domain Name System
   (DNS) Parameters" registry.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/10.%20%20Internationalization%20Considerations"></a><a class="selflink" href="#section-10" name="section-10">10</a>.  Internationalization Considerations</span>

   The AXFR protocol is transparent to the parts of DNS zone content
   that can possibly be subject to Internationalization considerations.
   It is assumed that for DNS labels and domain names, the issue has
   been solved via "Internationalizing Domain Names in Applications
   (IDNA)" [<a href="rfc3490.html" title='"Internationalizing Domain Names in Applications (IDNA)"'>RFC3490</a>] or its successor(s).

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/11.%20%20Acknowledgments"></a><a class="selflink" href="#section-11" name="section-11">11</a>.  Acknowledgments</span>

   Earlier draft versions of this document have been edited by Andreas
   Gustafsson.  In his latest draft version, this acknowledgment
   appeared:




<span class="grey">Lewis &amp; Hoenes               Standards Track                   [Page 25]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-26" id="page-26" name="page-26"> </a>
<span class="grey"><a href="rfc5936.html">RFC 5936</a>            DNS Zone Transfer Protocol (AXFR)          June 2010</span>


      Many people have contributed input and commentary to earlier
      versions of this document, including but not limited to Bob
      Halley, Dan Bernstein, Eric A. Hall, Josh Littlefield, Kevin
      Darcy, Robert Elz, Levon Esibov, Mark Andrews, Michael Patton,
      Peter Koch, Sam Trenholme, and Brian Wellington.

   Comments on later draft versions have come from these individuals:
   Mark Andrews, Paul Vixie, Wouter Wijngaards, Iain Calder, Tony Finch,
   Ian Jackson, Andreas Gustafsson, Brian Wellington, Niall O'Reilly,
   Bill Manning, and other participants of the DNSEXT working group.
   Significant comments from the IETF at large have been received from
   Subramanian Moonesamy, Chris Lonvick, and Vijay K. Gurbani.

   Edward Lewis served as a patiently listening sole document editor for
   two years.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/12.%20%20References"></a><a class="selflink" href="#section-12" name="section-12">12</a>.  References</span>

   All "RFC" references below -- like all RFCs -- and information about
   the RFC series can be obtained from the RFC Editor web site at
   <a href="http://www.rfc-editor.org/">http://www.rfc-editor.org</a>.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/12.1.%20%20Normative%20References"></a><a class="selflink" href="#section-12.1" name="section-12.1">12.1</a>.  Normative References</span>

   [<a id="ref-BCP14" name="ref-BCP14">BCP14</a>]     Bradner, S., "Key words for use in RFCs to Indicate
               Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a id="ref-RFC0793" name="ref-RFC0793">RFC0793</a>]   Postel, J., "Transmission Control Protocol", STD 7, <a href="rfc793.html">RFC</a>
               <a href="rfc793.html">793</a>, September 1981.

   [<a id="ref-RFC0768" name="ref-RFC0768">RFC0768</a>]   Postel, J., "User Datagram Protocol", STD 6, <a href="rfc768.html">RFC 768</a>,
               August 1980.

   [<a id="ref-RFC1034" name="ref-RFC1034">RFC1034</a>]   Mockapetris, P., "Domain names - concepts and
               facilities", STD 13, <a href="rfc1034.html">RFC 1034</a>, November 1987.

   [<a id="ref-RFC1035" name="ref-RFC1035">RFC1035</a>]   Mockapetris, P., "Domain names - implementation and
               specification", STD 13, <a href="rfc1035.html">RFC 1035</a>, November 1987.

   [<a id="ref-RFC1123" name="ref-RFC1123">RFC1123</a>]   Braden, R., Ed., "Requirements for Internet Hosts -
               Application and Support", STD 3, <a href="rfc1123.html">RFC 1123</a>, October 1989.

   [<a id="ref-RFC1995" name="ref-RFC1995">RFC1995</a>]   Ohta, M., "Incremental Zone Transfer in DNS", <a href="rfc1995.html">RFC 1995</a>,
               August 1996.

   [<a id="ref-RFC1996" name="ref-RFC1996">RFC1996</a>]   Vixie, P., "A Mechanism for Prompt Notification of Zone
               Changes (DNS NOTIFY)", <a href="rfc1996.html">RFC 1996</a>, August 1996.




<span class="grey">Lewis &amp; Hoenes               Standards Track                   [Page 26]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-27" id="page-27" name="page-27"> </a>
<span class="grey"><a href="rfc5936.html">RFC 5936</a>            DNS Zone Transfer Protocol (AXFR)          June 2010</span>


   [<a id="ref-RFC2136" name="ref-RFC2136">RFC2136</a>]   Vixie, P., Ed., Thomson, S., Rekhter, Y., and J. Bound,
               "Dynamic Updates in the Domain Name System (DNS UPDATE)",
               <a href="rfc2136.html">RFC 2136</a>, April 1997.

   [<a id="ref-RFC2181" name="ref-RFC2181">RFC2181</a>]   Elz, R. and R. Bush, "Clarifications to the DNS
               Specification", <a href="rfc2181.html">RFC 2181</a>, July 1997.

   [<a id="ref-RFC2671" name="ref-RFC2671">RFC2671</a>]   Vixie, P., "Extension Mechanisms for DNS (EDNS0)", <a href="rfc2671.html">RFC</a>
               <a href="rfc2671.html">2671</a>, August 1999.

   [<a id="ref-RFC2672" name="ref-RFC2672">RFC2672</a>]   Crawford, M., "Non-Terminal DNS Name Redirection", <a href="rfc2672.html">RFC</a>
               <a href="rfc2672.html">2672</a>, August 1999.

   [<a id="ref-RFC2845" name="ref-RFC2845">RFC2845</a>]   Vixie, P., Gudmundsson, O., Eastlake 3rd, D., and B.
               Wellington, "Secret Key Transaction Authentication for
               DNS (TSIG)", <a href="rfc2845.html">RFC 2845</a>, May 2000.

   [<a id="ref-RFC2930" name="ref-RFC2930">RFC2930</a>]   Eastlake 3rd, D., "Secret Key Establishment for DNS (TKEY
               RR)", <a href="rfc2930.html">RFC 2930</a>, September 2000.

   [<a id="ref-RFC2931" name="ref-RFC2931">RFC2931</a>]   Eastlake 3rd, D., "DNS Request and Transaction Signatures
               ( SIG(0)s )", <a href="rfc2931.html">RFC 2931</a>, September 2000.

   [<a id="ref-RFC3425" name="ref-RFC3425">RFC3425</a>]   Lawrence, D., "Obsoleting IQUERY", <a href="rfc3425.html">RFC 3425</a>, November
               2002.

   [<a id="ref-RFC3597" name="ref-RFC3597">RFC3597</a>]   Gustafsson, A., "Handling of Unknown DNS Resource Record
               (RR) Types", <a href="rfc3597.html">RFC 3597</a>, September 2003.

   [<a id="ref-RFC4033" name="ref-RFC4033">RFC4033</a>]   Arends, R., Austein, R., Larson, M., Massey, D., and S.
               Rose, "DNS Security Introduction and Requirements", <a href="rfc4033.html">RFC</a>
               <a href="rfc4033.html">4033</a>, March 2005.

   [<a id="ref-RFC4034" name="ref-RFC4034">RFC4034</a>]   Arends, R., Austein, R., Larson, M., Massey, D., and S.
               Rose, "Resource Records for the DNS Security Extensions",
               <a href="rfc4034.html">RFC 4034</a>, March 2005.

   [<a id="ref-RFC4035" name="ref-RFC4035">RFC4035</a>]   Arends, R., Austein, R., Larson, M., Massey, D., and S.
               Rose, "Protocol Modifications for the DNS Security
               Extensions", <a href="rfc4035.html">RFC 4035</a>, March 2005.

   [<a id="ref-RFC4509" name="ref-RFC4509">RFC4509</a>]   Hardaker, W., "Use of SHA-256 in DNSSEC Delegation Signer
               (DS) Resource Records (RRs)", <a href="rfc4509.html">RFC 4509</a>, May 2006.

   [<a id="ref-RFC4635" name="ref-RFC4635">RFC4635</a>]   Eastlake 3rd, D., "HMAC SHA (Hashed Message
               Authentication Code, Secure Hash Algorithm) TSIG
               Algorithm Identifiers", <a href="rfc4635.html">RFC 4635</a>, August 2006.




<span class="grey">Lewis &amp; Hoenes               Standards Track                   [Page 27]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-28" id="page-28" name="page-28"> </a>
<span class="grey"><a href="rfc5936.html">RFC 5936</a>            DNS Zone Transfer Protocol (AXFR)          June 2010</span>


   [<a id="ref-RFC5155" name="ref-RFC5155">RFC5155</a>]   Laurie, B., Sisson, G., Arends, R., and D. Blacka, "DNS
               Security (DNSSEC) Hashed Authenticated Denial of
               Existence", <a href="rfc5155.html">RFC 5155</a>, March 2008.

   [<a id="ref-RFC5395" name="ref-RFC5395">RFC5395</a>]   Eastlake 3rd, D., "Domain Name System (DNS) IANA
               Considerations", <a href="https://tools.ietf.org/html/bcp42">BCP 42</a>, <a href="rfc5395.html">RFC 5395</a>, November 2008.

   [<a id="ref-RFC5702" name="ref-RFC5702">RFC5702</a>]   Jansen, J., "Use of SHA-2 Algorithms with RSA in DNSKEY
               and RRSIG Resource Records for DNSSEC", <a href="rfc5702.html">RFC 5702</a>, October
               2009.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/12.2.%20%20Informative%20References"></a><a class="selflink" href="#section-12.2" name="section-12.2">12.2</a>.  Informative References</span>

   [<a id="ref-DNSVALS" name="ref-DNSVALS">DNSVALS</a>]   IANA Registry "Domain Name System (DNS) Parameters",
               <a href="http://www.iana.org/">http://www.iana.org/</a>.

   [<a id="ref-IANA-AF" name="ref-IANA-AF">IANA-AF</a>]   IANA Registry "Address Family Numbers",
               <a href="http://www.iana.org/">http://www.iana.org/</a>.

   [<a id="ref-RFC2764" name="ref-RFC2764">RFC2764</a>]   Gleeson, B., Lin, A., Heinanen, J., Armitage, G., and A.
               Malis, "A Framework for IP Based Virtual Private
               Networks", <a href="rfc2764.html">RFC 2764</a>, February 2000.

   [<a id="ref-RFC3490" name="ref-RFC3490">RFC3490</a>]   Faltstrom, P., Hoffman, P., and A. Costello,
               "Internationalizing Domain Names in Applications (IDNA)",
               <a href="rfc3490.html">RFC 3490</a>, March 2003.

   [<a id="ref-RFC3833" name="ref-RFC3833">RFC3833</a>]   Atkins, D. and R. Austein, "Threat Analysis of the Domain
               Name System (DNS)", <a href="rfc3833.html">RFC 3833</a>, August 2004.

   [<a id="ref-DNSSEC-U" name="ref-DNSSEC-U">DNSSEC-U</a>]  Weiler, S. and D. Blacka, "Clarifications and
               Implementation Notes for DNSSECbis", Work in Progress,
               March 2010.


















<span class="grey">Lewis &amp; Hoenes               Standards Track                   [Page 28]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-29" id="page-29" name="page-29"> </a>
<span class="grey"><a href="rfc5936.html">RFC 5936</a>            DNS Zone Transfer Protocol (AXFR)          June 2010</span>


Authors' Addresses

   Edward Lewis
   46000 Center Oak Plaza
   Sterling, VA  20166
   US

   EMail: ed.lewis@neustar.biz


   Alfred Hoenes, Editor
   TR-Sys
   Gerlinger Str. 12
   Ditzingen  D-71254
   Germany

   EMail: ah@TR-Sys.de


































Lewis &amp; Hoenes               Standards Track                   [Page 29]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc5936 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:32 GMT --></html>