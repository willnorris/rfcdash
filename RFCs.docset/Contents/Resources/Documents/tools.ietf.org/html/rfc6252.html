<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc6252 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:30 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="urn:ietf:rfc:6252" name="DC.Identifier"/>
<meta content="This document describes Media-independent Pre-Authentication (MPA), a
new handover optimization mechanism that addresses the issues on
existing mobility management protocols and mobility optimization
mechanisms to support inter-domain handover. MPA is a mobile-
assisted, secure handover optimization scheme that works over any link
layer and with any mobility management protocol, and is most
applicable to supporting optimization during inter-domain handover.
MPA's pre-authentication, pre-configuration, and proactive handover
techniques allow many of the handoff-related operations to take place
before the mobile node has moved to the new network. We describe the
details of all the associated techniques and their applicability for
different scenarios involving various mobility protocols during inter-
domain handover. We have implemented the MPA mechanism for various
network-layer and application-layer mobility protocols, and we report
a summary of experimental performance results in this document.  This
document is a product of the IP Mobility Optimizations (MOBOPTS)
Research Group. This document is not an Internet Standards Track
specification; it is published for informational purposes." name="DC.Description.Abstract"/>
<meta content="Ohba, Yoshihiro" name="DC.Creator"/>
<meta content="Schulzrinne, Henning" name="DC.Creator"/>
<meta content="Taniuchi, Kenichi" name="DC.Creator"/>
<meta content="Fajardo, Victor" name="DC.Creator"/>
<meta content="Dutta, Ashutosh" name="DC.Creator"/>
<meta content="June, 2011" name="DC.Date.Issued"/>
<meta content="A Framework of Media-Independent Pre-Authentication (MPA) for Inter-Domain Handover Optimization" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 6252 - A Framework of Media-Independent Pre-Authentication (MPA) for Inter-Domain Handover Optimization</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgorange" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc6252.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc6252" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-irtf-mobopts-mpa-framework" title="draft-irtf-mobopts-mpa-framework">draft-irtf-mobo...</a>] [<a href="https://datatracker.ietf.org/doc/rfc6252" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc6252" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc6252" title="Side-by-side diff">Diff2</a>]         </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                           INFORMATIONAL</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Internet Research Task Force (IRTF)                        A. Dutta, Ed.
Request for Comments: 6252                                    V. Fajardo
Category: Informational                                           NIKSUN
ISSN: 2070-1721                                                  Y. Ohba
                                                             K. Taniuchi
                                                                 Toshiba
                                                          H. Schulzrinne
                                                          Columbia Univ.
                                                               June 2011


     <span class="h1">A Framework of Media-Independent Pre-Authentication (MPA) for</span>
                   <span class="h1">Inter-Domain Handover Optimization</span>

Abstract

   This document describes Media-independent Pre-Authentication (MPA), a
   new handover optimization mechanism that addresses the issues on
   existing mobility management protocols and mobility optimization
   mechanisms to support inter-domain handover.  MPA is a mobile-
   assisted, secure handover optimization scheme that works over any
   link layer and with any mobility management protocol, and is most
   applicable to supporting optimization during inter-domain handover.
   MPA's pre-authentication, pre-configuration, and proactive handover
   techniques allow many of the handoff-related operations to take place
   before the mobile node has moved to the new network.  We describe the
   details of all the associated techniques and their applicability for
   different scenarios involving various mobility protocols during
   inter-domain handover.  We have implemented the MPA mechanism for
   various network-layer and application-layer mobility protocols, and
   we report a summary of experimental performance results in this
   document.

   This document is a product of the IP Mobility Optimizations (MOBOPTS)
   Research Group.

Status of This Memo

   This document is not an Internet Standards Track specification; it is
   published for informational purposes.

   This document is a product of the Internet Research Task Force
   (IRTF).  The IRTF publishes the results of Internet-related research
   and development activities.  These results might not be suitable for
   deployment.  This RFC represents the consensus of the MOBOPTS
   Research Group of the Internet Research Task Force (IRTF).  Documents
   approved for publication by the IRSG are not a candidate for any
   level of Internet Standard; see <a href="rfc5741.html#section-2">Section 2 of RFC 5741</a>.



<span class="grey">Dutta, et al.                 Informational                     [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc6252.html">RFC 6252</a>                      MPA Framework                    June 2011</span>


   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc6252">http://www.rfc-editor.org/info/rfc6252</a>.

Copyright Notice

   Copyright (c) 2011 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.

Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-3">3</a>
      <a href="#section-1.1">1.1</a>. Specification of Requirements ..............................<a href="#page-5">5</a>
      <a href="#section-1.2">1.2</a>. Performance Requirements ...................................<a href="#page-5">5</a>
   <a href="#section-2">2</a>. Terminology .....................................................<a href="#page-7">7</a>
   <a href="#section-3">3</a>. Handover Taxonomy ...............................................<a href="#page-7">7</a>
   <a href="#section-4">4</a>. Related Work ...................................................<a href="#page-11">11</a>
   <a href="#section-5">5</a>. Applicability of MPA ...........................................<a href="#page-12">12</a>
   <a href="#section-6">6</a>. MPA Framework ..................................................<a href="#page-13">13</a>
      <a href="#section-6.1">6.1</a>. Overview ..................................................<a href="#page-13">13</a>
      <a href="#section-6.2">6.2</a>. Functional Elements .......................................<a href="#page-14">14</a>
      <a href="#section-6.3">6.3</a>. Basic Communication Flow ..................................<a href="#page-16">16</a>
   <a href="#section-7">7</a>. MPA Operations .................................................<a href="#page-20">20</a>
      <a href="#section-7.1">7.1</a>. Discovery .................................................<a href="#page-21">21</a>
      <a href="#section-7.2">7.2</a>. Pre-Authentication in Multiple-CTN Environment ............<a href="#page-22">22</a>
      <a href="#section-7.3">7.3</a>. Proactive IP Address Acquisition ..........................<a href="#page-23">23</a>
           <a href="#section-7.3.1">7.3.1</a>. PANA-Assisted Proactive IP Address Acquisition .....<a href="#page-24">24</a>
           <a href="#section-7.3.2">7.3.2</a>. IKEv2-Assisted Proactive IP Address Acquisition ....<a href="#page-24">24</a>
           7.3.3. Proactive IP Address Acquisition Using
                  DHCPv4 Only ........................................<a href="#page-24">24</a>
           7.3.4. Proactive IP Address Acquisition Using Stateless
                  Autoconfiguration ..................................<a href="#page-26">26</a>
      <a href="#section-7.4">7.4</a>. Tunnel Management .........................................<a href="#page-26">26</a>
      <a href="#section-7.5">7.5</a>. Binding Update ............................................<a href="#page-28">28</a>
      <a href="#section-7.6">7.6</a>. Preventing Packet Loss ....................................<a href="#page-29">29</a>
           <a href="#section-7.6.1">7.6.1</a>. Packet Loss Prevention in Single-Interface MPA .....<a href="#page-29">29</a>
           <a href="#section-7.6.2">7.6.2</a>. Preventing Packet Losses for Multiple Interfaces ...<a href="#page-29">29</a>
           <a href="#section-7.6.3">7.6.3</a>. Reachability Test ..................................<a href="#page-30">30</a>






<span class="grey">Dutta, et al.                 Informational                     [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc6252.html">RFC 6252</a>                      MPA Framework                    June 2011</span>


      <a href="#section-7.7">7.7</a>. Security and Mobility .....................................<a href="#page-31">31</a>
           <a href="#section-7.7.1">7.7.1</a>. Link-Layer Security and Mobility ...................<a href="#page-31">31</a>
           <a href="#section-7.7.2">7.7.2</a>. IP-Layer Security and Mobility .....................<a href="#page-32">32</a>
      <a href="#section-7.8">7.8</a>. Authentication in Initial Network Attachment ..............<a href="#page-33">33</a>
   <a href="#section-8">8</a>. Security Considerations ........................................<a href="#page-33">33</a>
   <a href="#section-9">9</a>. Acknowledgments ................................................<a href="#page-34">34</a>
   <a href="#section-10">10</a>. References ....................................................<a href="#page-34">34</a>
      <a href="#section-10.1">10.1</a>. Normative References .....................................<a href="#page-34">34</a>
      <a href="#section-10.2">10.2</a>. Informative References ...................................<a href="#page-36">36</a>
   <a href="#appendix-A">Appendix A</a>. Proactive Duplicate Address Detection .................<a href="#page-40">40</a>
   <a href="#appendix-B">Appendix B</a>. Address Resolution ....................................<a href="#page-41">41</a>
   <a href="#appendix-C">Appendix C</a>. MPA Deployment Issues .................................<a href="#page-42">42</a>
     <a href="#appendix-C.1">C.1</a>. Considerations for Failed Switching and Switch-Back ........<a href="#page-42">42</a>
     <a href="#appendix-C.2">C.2</a>. Authentication State Management ............................<a href="#page-43">43</a>
     <a href="#appendix-C.3">C.3</a>. Pre-Allocation of QoS Resources ............................<a href="#page-44">44</a>
     <a href="#appendix-C.4">C.4</a>. Resource Allocation Issue during Pre-Authentication ........<a href="#page-45">45</a>
     <a href="#appendix-C.5">C.5</a>. Systems Evaluation and Performance Results .................<a href="#page-47">47</a>
       <a href="#appendix-C.5.1">C.5.1</a>. Intra-Technology, Intra-Domain .........................<a href="#page-47">47</a>
       <a href="#appendix-C.5.2">C.5.2</a>. Inter-Technology, Inter-Domain .........................<a href="#page-49">49</a>
       <a href="#appendix-C.5.3">C.5.3</a>. MPA-Assisted Layer 2 Pre-Authentication ................<a href="#page-49">49</a>
     <a href="#appendix-C.6">C.6</a>. Guidelines for Handover Preparation ........................<a href="#page-54">54</a>

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   As wireless technologies, including cellular and wireless LANs, are
   becoming popular, supporting terminal handovers across different
   types of access networks, such as from a wireless LAN to CDMA or to
   General Packet Radio Service (GPRS), is considered a clear challenge.
   On the other hand, supporting seamless terminal handovers between
   access networks of the same type is still more challenging,
   especially when the handovers are across IP subnets or administrative
   domains.  To address those challenges, it is important to provide
   terminal mobility that is agnostic to link-layer technologies in an
   optimized and secure fashion without incurring unreasonable
   complexity.  In this document, we discuss a framework to support
   terminal mobility that provides seamless handovers with low latency
   and low loss.  Seamless handovers are characterized in terms of
   performance requirements as described in <a href="#section-1.2">Section 1.2</a>.  [<a href="#ref-MPA-WIRELESS" title='"Media- Independent Pre-authentication Supporting Secure Interdomain Handover Optimization"'>MPA-WIRELESS</a>]
   is an accompanying document that describes implementation of a few
   MPA-based systems, including performance results to show how existing
   protocols could be leveraged to realize the functionalities of MPA.

   Terminal mobility is accomplished by a mobility management protocol
   that maintains a binding between a locator and an identifier of a
   mobile node, where the binding is referred to as the mobility
   binding.  The locator of the mobile node may dynamically change when
   there is a movement of the mobile node.  The movement that causes a




<span class="grey">Dutta, et al.                 Informational                     [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc6252.html">RFC 6252</a>                      MPA Framework                    June 2011</span>


   change of the locator may occur when there is a change in attachment
   point due to physical movement or network change.  A mobility
   management protocol may be defined at any layer.  In the rest of this
   document, the term "mobility management protocol" refers to a
   mobility management protocol that operates at the network layer or
   higher.

   There are several mobility management protocols at different layers.
   Mobile IP [<a href="rfc5944.html" title='"IP Mobility Support for IPv4, Revised"'>RFC5944</a>] and Mobile IPv6 [<a href="rfc3775.html" title='"Mobility Support in IPv6"'>RFC3775</a>] are mobility management
   protocols that operate at the network layer.  Similarly, MOBIKE
   (IKEv2 Mobility and Multihoming) [<a href="rfc4555.html" title='"IKEv2 Mobility and Multihoming Protocol (MOBIKE)"'>RFC4555</a>] is an extension to the
   Internet Key Exchange Protocol (IKEv2) that provides the ability to
   deal with a change of an IP address of an IKEv2 end-point.  There are
   several ongoing activities in the IETF to define mobility management
   protocols at layers higher than the network layer.  HIP (Host
   Identity Protocol) [<a href="rfc5201.html" title='"Host Identity Protocol"'>RFC5201</a>] defines a new protocol layer between the
   network layer and transport layer to provide terminal mobility in a
   way that is transparent to both the network layer and transport
   layer.  Also, SIP-based mobility is an extension to SIP to maintain
   the mobility binding of a SIP user agent [<a href="#ref-SIPMM" title='"Application-Layer Mobility Using SIP"'>SIPMM</a>].

   While mobility management protocols maintain mobility bindings, these
   cannot provide seamless handover if used in their current form.  An
   additional optimization mechanism is needed to prevent the loss of
   in-flight packets transmitted during the mobile node's binding update
   procedure and to achieve seamless handovers.  Such a mechanism is
   referred to as a mobility optimization mechanism.  For example,
   mobility optimization mechanisms for Mobile IPv4 [<a href="rfc4881.html" title='"Low-Latency Handoffs in Mobile IPv4"'>RFC4881</a>] and Mobile
   IPv6 [<a href="rfc5568.html" title='"Mobile IPv6 Fast Handovers"'>RFC5568</a>] are defined to allow neighboring access routers to
   communicate and carry information about mobile terminals.  There are
   protocols that are considered as "helpers" of mobility optimization
   mechanisms.  The CARD (Candidate Access Router Discovery) protocol
   [<a href="rfc4066.html" title='"Candidate Access Router Discovery (CARD)"'>RFC4066</a>] is designed to discover neighboring access routers.  CXTP
   (Context Transfer Protocol) [<a href="rfc4067.html" title='"Context Transfer Protocol (CXTP)"'>RFC4067</a>] is designed to carry state that
   is associated with the services provided for the mobile node, or
   context, among access routers.  In <a href="#section-4">Section 4</a>, we describe some of the
   fast-handover schemes that attempt to reduce the handover delay.

   There are several issues in existing mobility optimization
   mechanisms.  First, existing mobility optimization mechanisms are
   tightly coupled with specific mobility management protocols.  For
   example, it is not possible to use mobility optimization mechanisms
   designed for Mobile IPv4 or Mobile IPv6 with MOBIKE.  What is
   strongly desired is a single, unified mobility optimization mechanism
   that works with any mobility management protocol.  Second, there is
   no existing mobility optimization mechanism that easily supports
   handovers across administrative domains without assuming a
   pre-established security association between administrative domains.



<span class="grey">Dutta, et al.                 Informational                     [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc6252.html">RFC 6252</a>                      MPA Framework                    June 2011</span>


   A mobility optimization mechanism should work across administrative
   domains in a secure manner only based on a trust relationship between
   a mobile node and each administrative domain.  Third, a mobility
   optimization mechanism needs to support not only terminals with
   multiple interfaces where simultaneous connectivity through multiple
   interfaces or connectivity through a single interface can be
   expected, but also terminals with a single interface.

   This document describes a framework of Media-independent
   Pre-Authentication (MPA), a new handover optimization mechanism that
   addresses all those issues.  MPA is a mobile-assisted, secure
   handover optimization scheme that works over any link layer and with
   any mobility management protocol, including Mobile IPv4, Mobile IPv6,
   MOBIKE, HIP, and SIP mobility.  In cases of multiple operators
   without a roaming relationship or without an agreement to participate
   in a key management scheme, MPA provides a framework that can perform
   pre-authentication to establish the security mechanisms without
   assuming a common source of trust.  In MPA, the notion of IEEE
   802.11i pre-authentication is extended to work at a higher layer,
   with additional mechanisms to perform early acquisition of an IP
   address from a network where the mobile node may move, as well as
   proactive handover to the network while the mobile node is still
   attached to the current network.  Since this document focuses on the
   MPA framework, it is left to future work to choose the protocols for
   MPA and define detailed operations.  The accompanying document
   [<a href="#ref-MPA-WIRELESS" title='"Media- Independent Pre-authentication Supporting Secure Interdomain Handover Optimization"'>MPA-WIRELESS</a>] provides one method that describes usage and
   interactions between existing protocols to accomplish MPA
   functionality.

   This document represents the consensus of the IP Mobility
   Optimizations (MOBOPTS) Research Group.  It has been reviewed by
   Research Group members active in the specific area of work.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.1.%20%20Specification%20of%20Requirements"></a><a class="selflink" href="#section-1.1" name="section-1.1">1.1</a>.  Specification of Requirements</span>

   In this document, several words are used to signify the requirements
   of the specification.  These words are often capitalized.  The key
   words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD",
   "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document
   are to be interpreted as described in [<a href="rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.2.%20%20Performance%20Requirements"></a><a class="selflink" href="#section-1.2" name="section-1.2">1.2</a>.  Performance Requirements</span>

   In order to provide desirable quality of service for interactive
   Voice over IP (VoIP) and streaming traffic, one needs to limit the
   value of end-to-end delay, jitter, and packet loss to a certain
   threshold level.  ITU-T and ITU-E standards define the acceptable
   values for these parameters.  For example, for one-way delay, ITU-T



<span class="grey">Dutta, et al.                 Informational                     [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc6252.html">RFC 6252</a>                      MPA Framework                    June 2011</span>


   G.114 [<a href="#ref-RG98" title='"General Characteristics of International Telephone Connections and International Telephone Circuits: One-Way Transmission Time"'>RG98</a>] recommends 150 ms as the upper limit for most of the
   applications, and 400 ms as generally unacceptable delay.  One-way
   delay tolerance for video conferencing is in the range of 200 to
   300 ms [<a href="#ref-ITU98" title='"The E-Model, a computational model for use in transmission planning"'>ITU98</a>].  Also, if an out-of-order packet is received after a
   certain threshold, it is considered lost.  According to ETSI TR 101
   [<a href="#ref-ETSI" title='"Telecommunications and Internet Protocol Harmonization Over Networks (TIPHON) Release 3; End-to-end Quality of Service in TIPHON systems; Part 1: General aspects of Quality of Service (QoS)"'>ETSI</a>], a normal voice conversation can tolerate up to 2% packet
   loss.  But this is the mean packet loss probability and may be
   applicable to a scenario when the mobile node is subjected to
   repeated handoff during a normal conversation.  Measurement
   techniques for delay and jitter are described in [<a href="rfc2679.html" title='"A One-way Delay Metric for IPPM"'>RFC2679</a>],
   [<a href="rfc2680.html" title='"A One-way Packet Loss Metric for IPPM"'>RFC2680</a>], and [<a href="rfc2681.html" title='"A Round-trip Delay Metric for IPPM"'>RFC2681</a>].

   In the case of interactive VoIP traffic, end-to-end delay affects the
   jitter value, and thus is an important issue to consider.  An end-to-
   end delay consists of several components, such as network delay,
   operating system (OS) delay, codec delay, and application delay.  A
   complete analysis of these delays can be found in [<a href="#ref-WENYU" title='"Modeling of Packet Loss and Delay and their Effect on Real-Time Multimedia Service Quality"'>WENYU</a>].  During a
   mobile node's handover, in-flight transient traffic cannot reach the
   mobile node because of the associated handover delay.  These
   in-flight packets could either be lost or buffered.  If the in-flight
   packets are lost, this packet loss will contribute to jitter between
   the last packet before handoff and the first packet after handoff.
   If these packets are buffered, packet loss is minimized, but there is
   additional jitter for the in-flight packets when these are flushed
   after the handoff.  Buffering during handoff avoids the packet loss,
   but at the cost of additional one-way delay.  A tradeoff between one-
   way delay and packet loss is desired based on the type of
   application.  For example, for a streaming application, packet loss
   can be reduced by increasing the playout buffer, resulting in longer
   one-way packet delay.

   The handover delay is attributed to several factors, such as
   discovery, configuration, authentication, binding update, and media
   delivery.  Many of the security-related procedures, such as handover
   keying and re-authentication procedures, deal with cases where there
   is a single source of trust at the top, and the underlying
   Authentication, Authorization, and Accounting (AAA) domain elements
   trust the top source of trust and the keys it generates and
   distributes.  In this scenario, there is an appreciable delay in
   re-establishing link-security-related parameters, such as
   authentication, link key management, and access authorization during
   inter-domain handover.  The focus of this document is the design of a
   framework that can reduce the delay due to authentication and other
   handoff-related operations such as configuration and binding update.







<span class="grey">Dutta, et al.                 Informational                     [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc6252.html">RFC 6252</a>                      MPA Framework                    June 2011</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Terminology"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Terminology</span>

   Mobility Binding:  A binding between a locator and an identifier of a
      mobile terminal.

   Mobility Management Protocol (MMP):  A protocol that operates at the
      network layer or above to maintain a binding between a locator and
      an identifier of a mobile node.

   Binding Update (BU):  A procedure to update a mobility binding.

   Media-independent Pre-Authentication Mobile Node (MN):  A mobile node
      using Media-independent Pre-Authentication (MPA).  MPA is a
      mobile-assisted, secure handover optimization scheme that works
      over any link layer and with any mobility management protocol.  An
      MPA mobile node is an IP node.  In this document, the term "mobile
      node" or "MN" without a modifier refers to "MPA mobile node".  An
      MPA mobile node usually has a functionality of a mobile node of a
      mobility management protocol as well.

   Candidate Target Network (CTN):  A network to which the mobile node
      may move in the near future.

   Target Network (TN):  The network to which the mobile node has
      decided to move.  The target network is selected from one or more
      candidate target networks.

   Proactive Handover Tunnel (PHT):  A bidirectional IP tunnel [<a href="rfc2003.html" title='"IP Encapsulation within IP"'>RFC2003</a>]
      [<a href="rfc2473.html" title='"Generic Packet Tunneling in IPv6 Specification"'>RFC2473</a>] that is established between the MPA mobile node and an
      access router of a candidate target network.  In this document,
      the term "tunnel" without a modifier refers to "proactive handover
      tunnel".

   Point of Attachment (PoA):  A link-layer device (e.g., a switch, an
      access point, or a base station) that functions as a link-layer
      attachment point for the MPA mobile node to a network.

   Care-of Address (CoA):  An IP address used by a mobility management
      protocol as a locator of the MPA mobile node.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Handover%20Taxonomy"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Handover Taxonomy</span>

   Based on the type of movement, type of access network, and underlying
   mobility support, one can primarily define the handover as inter-
   technology, intra-technology, inter-domain, and intra-domain.  We
   describe briefly each of these handover processes.  However, our
   focus of the discussion is on inter-domain handover.




<span class="grey">Dutta, et al.                 Informational                     [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc6252.html">RFC 6252</a>                      MPA Framework                    June 2011</span>


   Inter-technology:  A mobile node may be equipped with multiple
      interfaces, where each interface can support a different access
      technology (e.g., 802.11, CDMA).  A mobile node may communicate
      with one interface at any time in order to conserve power.  During
      the handover, the mobile node may move out of the footprint of one
      access technology (e.g., 802.11) and move into the footprint of a
      different access technology (e.g., CDMA).  This will warrant
      switching of the communicating interface on the mobile node as
      well.  This type of inter-technology handover is often called
      "vertical handover", since the mobile node moves between two
      different cell sizes.

   Intra-technology:  An intra-technology handover is defined as when a
      mobile node moves within the same type of access technology, such
      as between 802.11[a,b,n] and 802.11 [a,b,n] or between CDMA1XRTT
      and CDMA1EVDO.  In this scenario, a mobile node may be equipped
      with a single interface (with multiple PHY types of the same
      technology) or with multiple interfaces.  An intra-technology
      handover may involve intra-subnet or inter-subnet movement and
      thus may need to change its L3 locator, depending upon the type of
      movement.

   Inter-domain:  A domain can be defined in several ways.  But for the
      purposes of roaming, we define "domain" as an administrative
      domain that consists of networks managed by a single
      administrative entity that authenticates and authorizes a mobile
      node for accessing the networks.  An administrative entity may be
      a service provider, an enterprise, or any organization.  Thus, an
      inter-domain handover will by default be subjected to inter-subnet
      handover, and in addition it may be subjected to either inter-
      technology or intra-technology handover.  A mobile node is
      subjected to inter-subnet handover when it moves from one subnet
      (broadcast domain) to another subnet (broadcast domain).  Inter-
      domain handover will be subjected to all the transition steps a
      subnet handover goes through, and it will be subjected to
      authentication and authorization processes as well.  It is also
      likely that the type of mobility support in each administrative
      domain will be different.  For example, administrative domain A
      may have Mobile IP version 6 (MIPv6) support, while administrative
      domain B may use Proxy MIPv6 [<a href="rfc5213.html" title='"Proxy Mobile IPv6"'>RFC5213</a>].

   Intra-domain:  When a mobile node's movement is confined to movement
      within an administrative domain, it is called "intra-domain
      movement".  An intra-domain movement may involve intra-subnet,
      inter-subnet, intra-technology, and inter-technology as well.






<span class="grey">Dutta, et al.                 Informational                     [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc6252.html">RFC 6252</a>                      MPA Framework                    June 2011</span>


   Both inter-domain and intra-domain handovers can be subjected to
   either inter-technology or intra-technology handover based on the
   network access characteristics.  Inter-domain handover requires
   authorization for acquisition or modification of resources assigned
   to a mobile node, and the authorization needs interaction with a
   central authority in a domain.  In many cases, an authorization
   procedure during inter-domain handover follows an authentication
   procedure that also requires interaction with a central authority in
   a domain.  Thus, security associations between the network entities,
   such as routers in the neighboring administrative domains, need to be
   established before any interaction takes place between these
   entities.  Similarly, an inter-domain mobility may involve different
   mobility protocols, such as MIPv6 and Proxy MIPv6, in each of its
   domains.  In that case, one needs a generalized framework to achieve
   the optimization during inter-domain handover.  Figure 1 shows a
   typical example of inter-domain mobility involving two domains,
   domain A and domain B.  It illustrates several important components,
   such as a AAA Home server (AAAH); AAA visited servers (e.g., AAAV1
   and AAAV2); an Authentication Agent (AA); a layer 3 point of
   attachment, such as an Access Router (AR); and a layer 2 point of
   attachment, such as an Access Point (AP).  Any mobile node may be
   using a specific mobility protocol and associated mobility
   optimization technique during intra-domain movement in either domain.
   But the same optimization technique may not be suitable to support
   inter-domain handover, independent of whether it uses the same or a
   different mobility protocol in either domain.

























<span class="grey">Dutta, et al.                 Informational                     [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc6252.html">RFC 6252</a>                      MPA Framework                    June 2011</span>


                        +-----------------------------+
                        |      +--------+             |
                        |      |        |             |
                        |      | AAAH   ------------------|
                        |      |        |             |   |
                        |      +|-------+             |   |
                        |       |                     |   |
                        |       |  Home Domain        |   |
                        |       |                     |   |
                        +-------|---------------------+   |
                                |                         |
                                |                         |
                                |                         |
   +----------------------------|---------+ +-------------|------------+
   | Domain A                   |         | | Domain B    |            |
   |                            |         | |            +|-------+    |
   |                    +-------|+        | | +-----+    |        |    |
   |                    |        |        | | |     ------ AAAV2  |    |
   |                    | AAAV1  |        | | | AA  |    |        |    |
   |      +--------------        |        | | +|----+    +--------+    |
   |      |     |       +--------+        | |  |                       |
   |      |AA   |                         | |  |---         ----       |
   |      +--|--+                         | | /    \       /    \      |
   |         |              /----\        | || AR   |-----| AR   |     |
   |        -|--           /      \       | | \    /       \    /      |
   |       /    \         | AR     |      | |  -|--         --|-       |
   |      | AR   -----------      /       | |+--|---+  +------|------+ |
   |       \    /           \--|-/        | || AP4  |  |  L2 Switch  | |
   |        -/--         +-----|------+   | ||      |  +-|---------|-+ |
   |        /            |  L2 Switch |   | |+------+    |         |   |
   |       /             +-|-------|--+   | |        +---|--+ +----|-+ |
   | +----/-+         +----|-+   +-|----+ | |        |      | |      | |
   | |      |         |      |   |      | | |        | AP5  | |AP6   | |
   | | AP1  |         | AP2  |   | AP3  | | |        +----|-+ +------+ |
   | +------+         +------+   +--|---+ | |             |            |
   +--------------------------------|-----+ +------------ |------------+
                                  --|---------            |
                              ////            \\\\   -----|-----
                            //    +------+       ////  +------+ \\\\
                            |     | MN   -------------&gt;|MN  |     \\\
                           |      |      |    |     |  |      |       |
                            |     +------+   |     |   +------+        |
                            \\                |   //                  |
                              \\\\            \\\/                  ///
                                  ------------   \\\\------------- ////

                      Figure 1: Inter-Domain Mobility




<span class="grey">Dutta, et al.                 Informational                    [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc6252.html">RFC 6252</a>                      MPA Framework                    June 2011</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Related%20Work"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Related Work</span>

   While basic mobility management protocols such as Mobile IP
   [<a href="rfc5944.html" title='"IP Mobility Support for IPv4, Revised"'>RFC5944</a>], Mobile IPv6 [<a href="rfc3775.html" title='"Mobility Support in IPv6"'>RFC3775</a>], and SIP-Mobility [<a href="#ref-SIPMM" title='"Application-Layer Mobility Using SIP"'>SIPMM</a>] provide
   continuity to TCP and RTP traffic, these are not optimized to reduce
   the handover latency during a mobile node's movement between subnets
   and domains.  In general, these mobility management protocols
   introduce handover delays incurred at several layers, such as layer 3
   and the application layer, for updating the mobile node's mobility
   binding.  These protocols are affected by underlying layer 2 delay as
   well.  As a result, applications using these mobility protocols
   suffer from performance degradation.

   There have been several optimization techniques that apply to current
   mobility management schemes that try to reduce handover delay and
   packet loss during a mobile node's movement between cells, subnets,
   and domains.  Micro-mobility management schemes such as [<a href="#ref-CELLIP" title='"Design, Implementation, and Evaluation of Cellular IP"'>CELLIP</a>] and
   [<a href="#ref-HAWAII" title='"HAWAII: A Domain-based Approach for Supporting Mobility in Wide-area Wireless networks"'>HAWAII</a>], and intra-domain mobility management schemes such as
   [<a href="#ref-IDMP" title='"IDMP: An Intra-Domain Mobility Management Protocol for Next Generation Wireless Networks"'>IDMP</a>], [<a href="#ref-MOBIP-REG" title='"Mobile IPv4 Regional Registration"'>MOBIP-REG</a>], and [<a href="rfc5380.html" title='"Hierarchical Mobile IPv6 (HMIPv6) Mobility Management"'>RFC5380</a>], provide fast handover by limiting
   the signaling updates within a domain.  Fast Mobile IP protocols for
   IPv4 and IPv6 networks [<a href="rfc4881.html" title='"Low-Latency Handoffs in Mobile IPv4"'>RFC4881</a>] [<a href="rfc5568.html" title='"Mobile IPv6 Fast Handovers"'>RFC5568</a>] utilize mobility
   information made available by link-layer triggers.  Yokota et
   al. [<a href="#ref-YOKOTA" title='"Link Layer Assisted Mobile IP Fast Handoff Method over Wireless LAN Networks"'>YOKOTA</a>] propose the joint use of an access point and a dedicated
   Media Access Control (MAC) bridge to provide fast handover without
   altering the MIPv4 specification.  Shin et al. [<a href="#ref-MACD" title='"Reducing MAC Layer Handoff Latency in IEEE 802.11 Wireless LANs"'>MACD</a>] propose a
   scheme that reduces the delay due to MAC-layer handoff by providing a
   cache-based algorithm.  In this scheme, the mobile node caches the
   neighboring channels that it has already visited and thus uses a
   selective scanning method.  This helps to reduce the associated
   scanning time.

   Some mobility management schemes use dual interfaces, thus providing
   make-before-break [<a href="#ref-SUM" title='"Secured Universal Mobility for Wireless Internet"'>SUM</a>].  In a make-before-break situation,
   communication usually continues with one interface when the secondary
   interface is in the process of getting connected.  The IEEE 802.21
   working group is discussing these scenarios in detail [<a href="#ref-802.21" title='"IEEE Standard for Local and Metropolitan Area Networks: Media Independent Handover Services, IEEE 802.21-2008"'>802.21</a>].
   Providing fast handover using a single interface needs more careful
   design than for a client with multiple interfaces.  Dutta et
   al. [<a href="#ref-SIPFAST" title='"Fast-handoff Schemes for Application Layer Mobility Management"'>SIPFAST</a>] provide an optimized handover scheme for SIP-based
   mobility management, where the transient traffic is forwarded from
   the old subnet to the new one by using an application-layer
   forwarding scheme.  [<a href="#ref-MITH" title='"Fast Handoffs in Wireless LAN Networks using Mobile initiated Tunneling Handoff Protocol for IPv4 (MITHv4)"'>MITH</a>] provides a fast-handover scheme for the
   single-interface case that uses mobile-initiated tunneling between
   the old Foreign Agent and a new Foreign Agent.  [<a href="#ref-MITH" title='"Fast Handoffs in Wireless LAN Networks using Mobile initiated Tunneling Handoff Protocol for IPv4 (MITHv4)"'>MITH</a>] defines two
   types of handover schemes: Pre-MIT (Mobile Initiated Tunneling) and
   Post-MIT (Media Initiated Tunneling).  The proposed MPA scheme is
   very similar to Mobile Initiated Tunneling Handoff's (MITH's)
   predictive scheme, where the mobile node communicates with the



<span class="grey">Dutta, et al.                 Informational                    [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc6252.html">RFC 6252</a>                      MPA Framework                    June 2011</span>


   Foreign Agent before actually moving to the new network.  However,
   the MPA scheme is not limited to MIP; this scheme takes care of
   movement between domains and performs pre-authentication in addition
   to proactive handover.  Thus, MPA reduces the overall delay to a
   period close to that of link-layer handover delay.  Most of the
   mobility optimization techniques developed so far are restricted to a
   specific type of mobility protocol only.  While supporting
   optimization for inter-domain mobility, these protocols assume that
   there is a pre-established security arrangement between two
   administrative domains.  But this assumption may not always be
   viable.  Thus, there is a need to develop an optimization mechanism
   that can support inter-domain mobility without any underlying
   constraints or security-related assumptions.

   Recently, the HOKEY working group within the IETF has been defining
   ways to expedite the authentication process.  In particular, it has
   defined pre-authentication [<a href="rfc5836.html" title='"Extensible Authentication Protocol (EAP) Early Authentication Problem Statement"'>RFC5836</a>] and fast re-authentication
   [<a href="rfc5169.html" title='"Handover Key Management and Re-Authentication Problem Statement"'>RFC5169</a>] mechanisms to expedite the authentication and security
   association process.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Applicability%20of%20MPA"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Applicability of MPA</span>

   MPA is more applicable where an accurate prediction of movement can
   be easily made.  For other environments, special care must be taken
   to deal with issues such as pre-authentication to multiple CTNs
   (Candidate Target Networks), and failed switching and switching back
   as described in [<a href="#ref-MPA-WIRELESS" title='"Media- Independent Pre-authentication Supporting Secure Interdomain Handover Optimization"'>MPA-WIRELESS</a>].  However, addressing those issues in
   actual deployments may not be easier.  Some of the deployment issues
   are described in <a href="#appendix-C">Appendix C</a>.

   The authors of the accompanying document [<a href="#ref-MPA-WIRELESS" title='"Media- Independent Pre-authentication Supporting Secure Interdomain Handover Optimization"'>MPA-WIRELESS</a>] have cited
   several use cases of how MPA can be used to optimize several network-
   layer and application-layer mobility protocols.  The effectiveness of
   MPA may be relatively reduced if the network employs network-
   controlled localized mobility management in which the MN does not
   need to change its IP address while moving within the network.  The
   effectiveness of MPA may also be relatively reduced if signaling for
   network access authentication is already optimized for movements
   within the network, e.g., when simultaneous use of multiple
   interfaces during handover is allowed.  In other words, MPA is more
   viable as a solution for inter-administrative domain predictive
   handover without the simultaneous use of multiple interfaces.  Since
   MPA is not tied to a specific mobility protocol, it is also
   applicable to support optimization for inter-domain handover where
   each domain may be equipped with a different mobility protocol.






<span class="grey">Dutta, et al.                 Informational                    [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc6252.html">RFC 6252</a>                      MPA Framework                    June 2011</span>


   Figure 1 shows an example of inter-domain mobility where MPA could be
   applied.  For example, domain A may support just Proxy MIPv6, whereas
   domain B may support Client Mobile IPv6.  MPA's different functional
   components can provide the desired optimization techniques
   proactively.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20MPA%20Framework"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  MPA Framework</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.1.%20%20Overview"></a><a class="selflink" href="#section-6.1" name="section-6.1">6.1</a>.  Overview</span>

   Media-independent Pre-Authentication (MPA) is a mobile-assisted,
   secure handover optimization scheme that works over any link layer
   and with any mobility management protocol.  With MPA, a mobile node
   is not only able to securely obtain an IP address and other
   configuration parameters for a CTN, but also able to send and receive
   IP packets using the IP address obtained before it actually attaches
   to the CTN.  This makes it possible for the mobile node to complete
   the binding update of any mobility management protocol and use the
   new CoA before performing a handover at the link layer.

   MPA adopts the following basic procedures to provide this
   functionality.  The first procedure is referred to as
   "pre-authentication", the second procedure is referred to as
   "pre-configuration", and the combination of the third and fourth
   procedures is referred to as "secure proactive handover".  The
   security association established through pre-authentication is
   referred to as an "MPA-SA".

   This functionality is provided by allowing a mobile node that has
   connectivity to the current network, but is not yet attached to a
   CTN, to

      (i) establish a security association with the CTN to secure the
      subsequent protocol signaling, then

      (ii) securely execute a configuration protocol to obtain an IP
      address and other parameters from the CTN as well as execute a
      tunnel management protocol to establish a Proactive Handover
      Tunnel (PHT) [<a href="rfc2003.html" title='"IP Encapsulation within IP"'>RFC2003</a>] between the mobile node and an access
      router of the CTN, then

      (iii) send and receive IP packets, including signaling messages
      for the binding update of an MMP and data packets transmitted
      after completion of the binding update, over the PHT, using the
      obtained IP address as the tunnel inner address, and finally






<span class="grey">Dutta, et al.                 Informational                    [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc6252.html">RFC 6252</a>                      MPA Framework                    June 2011</span>


      (iv) delete or disable the PHT immediately before attaching to the
      CTN when it becomes the target network, and then re-assign the
      inner address of the deleted or disabled tunnel to its physical
      interface immediately after the mobile node is attached to the
      target network through the interface.  Instead of deleting or
      disabling the tunnel before attaching to the target network, the
      tunnel may be deleted or disabled immediately after being attached
      to the target network.

   Step (iii) above (i.e., the binding update procedure), in particular,
   makes it possible for the mobile node to complete the higher-layer
   handover before starting a link-layer handover.  This means that the
   mobile node is able to send and receive data packets transmitted
   after completing the binding update over the tunnel, while data
   packets transmitted before completion of the binding update do not
   use the tunnel.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.2.%20%20Functional%20Elements"></a><a class="selflink" href="#section-6.2" name="section-6.2">6.2</a>.  Functional Elements</span>

   In the MPA framework, the following functional elements are expected
   to reside in each CTN to communicate with a mobile node: an
   Authentication Agent (AA), a Configuration Agent (CA), and an Access
   Router (AR).  These elements can reside in one or more network
   devices.

   An authentication agent is responsible for pre-authentication.  An
   authentication protocol is executed between the mobile node and the
   authentication agent to establish an MPA-SA.  The authentication
   protocol MUST be able to establish a shared key between the mobile
   node and the authentication agent and SHOULD be able to provide
   mutual authentication.  The authentication protocol SHOULD be able to
   interact with a AAA protocol, such as RADIUS or Diameter, to carry
   authentication credentials to an appropriate authentication server in
   the AAA infrastructure.  This interaction happens through the
   authentication agent, such as the PANA Authentication Agent (PAA).
   In turn, the derived key is used to derive additional keys that will
   be applied to protecting message exchanges used for pre-configuration
   and secure proactive handover.  Other keys that are used for
   bootstrapping link-layer and/or network-layer ciphers MAY also be
   derived from the MPA-SA.  A protocol that can carry the Extensible
   Authentication Protocol (EAP) [<a href="rfc3748.html" title='"Extensible Authentication Protocol (EAP)"'>RFC3748</a>] would be suitable as an
   authentication protocol for MPA.









<span class="grey">Dutta, et al.                 Informational                    [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc6252.html">RFC 6252</a>                      MPA Framework                    June 2011</span>


   A configuration agent is responsible for one part of
   pre-configuration, namely securely executing a configuration protocol
   to deliver an IP address and other configuration parameters to the
   mobile node.  The signaling messages of the configuration protocol
   (e.g., DHCP) MUST be protected using a key derived from the key
   corresponding to the MPA-SA.

   An access router in the MPA framework is a router that is responsible
   for the other part of pre-configuration, i.e., securely executing a
   tunnel management protocol to establish a proactive handover tunnel
   to the mobile node.  IP packets transmitted over the proactive
   handover tunnel SHOULD be protected using a key derived from the key
   corresponding to the MPA-SA.  Details of this procedure are described
   in <a href="#section-6.3">Section 6.3</a>.





































<span class="grey">Dutta, et al.                 Informational                    [Page 15]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc6252.html">RFC 6252</a>                      MPA Framework                    June 2011</span>


   Figure 2 shows the basic functional components of MPA.

                                        +----+
                                        | CN |
                                        +----+
                                         /
                              (Core Network)
                             /              \
                            /                \
          +----------------/--------+    +----\-----------------+
          | +-----+                 |    |+-----+               |
          | |     |        +-----+  |    ||     |       +-----+ |
          | | AA  |        |CA   |  |    ||AA   |       | CA  | |
          | +--+--+        +--+--+  |    |+--+--+       +--+--+ |
          |    |   +------+   |     |    |   | +-----+     |    |
          |    |   | pAR  |   |     |    |   | |nAR  |     |    |
          | ---+---+      +---+-----+----+---+-+     +-----+    |
          |        +---+--+         |    |     +-----+          |
          |            |            |    |                      |
          |            |            |    |                      |
          |            |            |    |                      |
          +------------+------------+    +--------|-------------+
          Current      |                 Candidate| Target Network
          Network      |                          |
                    +------+                  +------+
                    | oPoA |                  | nPoA |
                    +--.---+                  +--.---+
                       .                         .
                       .                         .
                    +------+
                    |  MN  |  ----------&gt;
                    +------+

                    Figure 2: MPA Functional Components

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.3.%20%20Basic%20Communication%20Flow"></a><a class="selflink" href="#section-6.3" name="section-6.3">6.3</a>.  Basic Communication Flow</span>

   Assume that the mobile node is already connected to a point of
   attachment, say oPoA (old point of attachment), and assigned a
   care-of address, say oCoA (old care-of address).  The communication
   flow of MPA is described as follows.  Throughout the communication
   flow, data packet loss should not occur except for the period during
   the switching procedure in Step 5 below, and it is the responsibility
   of link-layer handover to minimize packet loss during this period.







<span class="grey">Dutta, et al.                 Informational                    [Page 16]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc6252.html">RFC 6252</a>                      MPA Framework                    June 2011</span>


   Step 1 (pre-authentication phase):  The mobile node finds a CTN
      through some discovery process, such as IEEE 802.21, and obtains
      the IP addresses of an authentication agent, a configuration
      agent, and an access router in the CTN (Candidate Target Network)
      by some means.  Details about discovery mechanisms are discussed
      in <a href="#section-7.1">Section 7.1</a>.  The mobile node performs pre-authentication with
      the authentication agent.  As discussed in <a href="#section-7.2">Section 7.2</a>, the mobile
      node may need to pre-authenticate with multiple candidate target
      networks.  The decision regarding with which candidate network the
      mobile node needs to pre-authenticate will depend upon several
      factors, such as signaling overhead, bandwidth requirement
      (Quality of Service (QoS)), the mobile node's location,
      communication cost, handover robustness, etc.  Determining the
      policy that decides the target network with which the mobile node
      should pre-authenticate is out of scope for this document.

      If the pre-authentication is successful, an MPA-SA is created
      between the mobile node and the authentication agent.  Two keys
      are derived from the MPA-SA, namely an MN-CA key and an MN-AR key,
      which are used to protect subsequent signaling messages of a
      configuration protocol and a tunnel management protocol,
      respectively.  The MN-CA key and the MN-AR key are then securely
      delivered to the configuration agent and the access router,
      respectively.

   Step 2 (pre-configuration phase):  The mobile node realizes that its
      point of attachment is likely to change from the oPoA to a new
      one, say nPoA (new point of attachment).  It then performs
      pre-configuration with the configuration agent, using the
      configuration protocol to obtain several configuration parameters
      such as an IP address, say nCoA (new care-of address), and a
      default router from the CTN.  The mobile node then communicates
      with the access router using the tunnel management protocol to
      establish a proactive handover tunnel.  In the tunnel management
      protocol, the mobile node registers the oCoA and the nCoA as the
      tunnel outer address and the tunnel inner address, respectively.
      The signaling messages of the pre-configuration protocol are
      protected using the MN-CA key and the MN-AR key.  When the
      configuration agent and the access router are co-located in the
      same device, the two protocols may be integrated into a single
      protocol, such as IKEv2.  After completion of the tunnel
      establishment, the mobile node is able to communicate using both
      the oCoA and the nCoA by the end of Step 4.  A configuration
      protocol and a tunnel management protocol may be combined in a
      single protocol or executed in different orders depending on the
      actual protocol(s) used for configuration and tunnel management.





<span class="grey">Dutta, et al.                 Informational                    [Page 17]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc6252.html">RFC 6252</a>                      MPA Framework                    June 2011</span>


   Step 3 (secure proactive handover main phase):  The mobile node
      decides to switch to the new point of attachment by some means.
      Before the mobile node switches to the new point of attachment, it
      starts secure proactive handover by executing the binding update
      operation of a mobility management protocol and transmitting
      subsequent data traffic over the tunnel (main phase).  This
      proactive binding update could be triggered based on certain local
      policy at the mobile node end, after the pre-configuration phase
      is over.  This local policy could be Signal-to-Noise Ratio,
      location of the mobile node, etc.  In some cases, it may cache
      multiple nCoA addresses and perform simultaneous binding with the
      Correspondent Node (CN) or Home Agent (HA).

   Step 4 (secure proactive handover pre-switching phase):  The mobile
      node completes the binding update and becomes ready to switch to
      the new point of attachment.  The mobile node may execute the
      tunnel management protocol to delete or disable the proactive
      handover tunnel and cache the nCoA after deletion or disabling of
      the tunnel.  This transient tunnel can be deleted prior to or
      after the handover.  The buffering module at the next access
      router buffers the packets once the tunnel interface is deleted.
      The decision as to when the mobile node is ready to switch to the
      new point of attachment depends on the handover policy.

   Step 5 (switching):  It is expected that a link-layer handover occurs
      in this step.

   Step 6 (secure proactive handover post-switching phase):  The mobile
      node executes the switching procedure.  Upon successful completion
      of the switching procedure, the mobile node immediately restores
      the cached nCoA and assigns it to the physical interface attached
      to the new point of attachment.  If the proactive handover tunnel
      was not deleted or disabled in Step 4, the tunnel is deleted or
      disabled as well.  After this, direct transmission of data packets
      using the nCoA is possible without using a proactive handover
      tunnel.

   Call flow for MPA is shown in Figures 3 and 4.













<span class="grey">Dutta, et al.                 Informational                    [Page 18]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-19" id="page-19" name="page-19"> </a>
<span class="grey"><a href="rfc6252.html">RFC 6252</a>                      MPA Framework                    June 2011</span>


                                                         IP address(es)
                                                          Available for
                                                             Use by MN
                                                                   |
                           +-----------------------------------+   |
                           |     Candidate Target Network      |   |
                           |     (Future Target Network)       |   |
             MN       oPoA | nPoA     AA        CA        AR   |   |
             |         |   |  |       |         |         |    |   |
             |         |   +-----------------------------------+   |
             |         |      |       |         |         |        .
    +---------------+  |      |       |         |         |        .
    |(1) Found a CTN|  |      |       |         |         |        .
    +---------------+  |      |       |         |         |        |
             |   Pre-authentication   |         |         |        |
             |   [authentication protocol]      |         |        |
             |&lt;--------+-------------&gt;|MN-CA key|         |        |
             |         |      |       |--------&gt;|MN-AR key|        |
   +-----------------+ |      |       |------------------&gt;|        |
   |(2) Increased    | |      |       |         |         |     [oCoA]
   |chance to switch | |      |       |         |         |        |
   |     to CTN      | |      |       |         |         |        |
   +-----------------+ |      |       |         |         |        |
             |         |      |       |         |         |        |
             |   Pre-configuration    |         |         |        |
             |   [configuration protocol to get nCoA]     |        |
             |&lt;--------+-----------------------&gt;|         |        |
             |   Pre-configuration    |         |         |        |
             |   [tunnel management protocol to establish PHT]     V
             |&lt;--------+---------------------------------&gt;|
             |         |      |       |         |         |        ^
   +-----------------+ |      |       |         |         |        |
   |(3) Determined   | |      |       |         |         |        |
   |to switch to CTN | |      |       |         |         |        |
   +-----------------+ |      |       |         |         |        |
             |         |      |       |         |         |        |
             |   Secure proactive handover main phase     |        |
             |   [execution of binding update of MMP and  |        |
             |    transmission of data packets through AR | [oCoA, nCoA]
             |    based on nCoA over the PHT]   |         |        |
             |&lt;&lt;=======+================================&gt;+---&gt;...  |
             .         .      .       .         .         .        .
             .         .      .       .         .         .        .
             .         .      .       .         .         .        .

                Figure 3: Example Communication Flow (1/2)





<span class="grey">Dutta, et al.                 Informational                    [Page 19]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-20" id="page-20" name="page-20"> </a>
<span class="grey"><a href="rfc6252.html">RFC 6252</a>                      MPA Framework                    June 2011</span>


             |         |      |       |         |         |        |
   +----------------+  |      |       |         |         |        |
   |(4) Completion  |  |      |       |         |         |        |
   |of MMP BU and   |  |      |       |         |         |        |
   |ready to switch |  |      |       |         |         |        |
   +----------------+  |      |       |         |         |        |
             |   Secure proactive handover pre-switching phase     |
             |   [tunnel management protocol to delete PHT]        V
             |&lt;--------+---------------------------------&gt;|
    +---------------+         |       |         |         |
    |(5)Switching   |         |       |         |         |
    +---------------+         |       |         |         |
             |                |       |         |         |
    +---------------+         |       |         |         |
    |(6) Completion |         |       |         |         |
    |of switching   |         |       |         |         |
    +---------------+         |       |         |         |
             o&lt;- Secure proactive handover post-switching phase ^
             |   [Re-assignment of Tunnel Inner Address   |        |
             |                 to the physical I/F]       |        |
             |                |       |         |         |        |
             |   Transmission of data packets through AR  |     [nCoA]
             |   based on nCoA|       |         |         |        |
             |&lt;---------------+---------------------------+--&gt;...  |
             |                |       |         |         |        .

                Figure 4: Example Communication Flow (2/2)

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20MPA%20Operations"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  MPA Operations</span>

   In order to provide an optimized handover for a mobile node
   experiencing rapid movement between subnets and/or domains, one needs
   to look into several operations.  These issues include:

      i) discovery of neighboring networking elements,

      ii) connecting to the right network based on certain policy,

      iii) changing the layer 2 point of attachment,

      iv) obtaining an IP address from a DHCP or PPP server,

      v) confirming the uniqueness of the IP address,

      vi) pre-authenticating with the authentication agent,

      vii) sending the binding update to the Correspondent Host (CH),




<span class="grey">Dutta, et al.                 Informational                    [Page 20]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-21" id="page-21" name="page-21"> </a>
<span class="grey"><a href="rfc6252.html">RFC 6252</a>                      MPA Framework                    June 2011</span>


      viii) obtaining the redirected streaming traffic to the new point
      of attachment,

      ix) ping-pong effect, and

      x) probability of moving to more than one network and associating
      with multiple target networks.

   We describe these issues in detail in the following paragraphs and
   describe how we have optimized these issues in the case of MPA-based
   secure proactive handover.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.1.%20%20Discovery"></a><a class="selflink" href="#section-7.1" name="section-7.1">7.1</a>.  Discovery</span>

   Discovery of neighboring networking elements such as access points,
   access routers, and authentication servers helps expedite the
   handover process during a mobile node's movement between networks.
   After discovering the network neighborhood with a desired set of
   coordinates, capabilities, and parameters, the mobile node can
   perform many of the operations, such as pre-authentication, proactive
   IP address acquisition, proactive address resolution, and binding
   update, while in the previous network.

   There are several ways a mobile node can discover neighboring
   networks.  The Candidate Access Router Discovery protocol [<a href="rfc4066.html" title='"Candidate Access Router Discovery (CARD)"'>RFC4066</a>]
   helps discover the candidate access routers in the neighboring
   networks.  Given a certain network domain, SLP (Service Location
   Protocol) [<a href="rfc2608.html" title='"Service Location Protocol, Version 2"'>RFC2608</a>] and DNS help provide addresses of the networking
   components for a given set of services in the specific domain.  In
   some cases, many of the network-layer and upper-layer parameters may
   be sent over link-layer management frames, such as beacons, when the
   mobile node approaches the vicinity of the neighboring networks.
   IEEE 802.11u is considering issues such as discovering the
   neighborhood using information contained in the link layer.  However,
   if the link-layer management frames are encrypted by some link-layer
   security mechanism, then the mobile node may not be able to obtain
   the requisite information before establishing link-layer connectivity
   to the access point.  In addition, this may add burden to the
   bandwidth-constrained wireless medium.  In such cases, a higher-layer
   protocol is preferred to obtain the information regarding the
   neighboring elements.  Some proposals, such as [<a href="#ref-802.21" title='"IEEE Standard for Local and Metropolitan Area Networks: Media Independent Handover Services, IEEE 802.21-2008"'>802.21</a>], help obtain
   information about the neighboring networks from a mobility server.
   When the movement is imminent, the mobile node starts the discovery
   process by querying a specific server and obtains the required
   parameters, such as the IP address of the access point, its
   characteristics, routers, SIP servers, or authentication servers of
   the neighboring networks.  In the event of multiple networks, it may
   obtain the required parameters from more than one neighboring network



<span class="grey">Dutta, et al.                 Informational                    [Page 21]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-22" id="page-22" name="page-22"> </a>
<span class="grey"><a href="rfc6252.html">RFC 6252</a>                      MPA Framework                    June 2011</span>


   and keep these in a cache.  At some point, the mobile node finds
   several CTNs out of many probable networks and starts the pre-
   authentication process by communicating with the required entities in
   the CTNs.  Further details of this scenario are in <a href="#section-7.2">Section 7.2</a>.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.2.%20%20Pre-Authentication%20in%20Multiple-CTN%20Environment"></a><a class="selflink" href="#section-7.2" name="section-7.2">7.2</a>.  Pre-Authentication in Multiple-CTN Environment</span>

   In some cases, although a mobile node selects a specific network to
   be the target network, it may actually end up moving into a
   neighboring network other than the target network, due to factors
   that are beyond the mobile node's control.  Thus, it may be useful to
   perform the pre-authentication with a few probable candidate target
   networks and establish time-bound transient tunnels with the
   respective access routers in those networks.  Thus, in the event of a
   mobile node moving to a candidate target network other than that
   chosen as the target network, it will not be subjected to packet loss
   due to authentication and IP address acquisition delay that could
   occur if the mobile node did not pre-authenticate with that candidate
   target network.  It may appear that by pre-authenticating with a
   number of candidate target networks and reserving the IP addresses,
   the mobile node is reserving resources that could be used otherwise.
   But since this happens for a time-limited period, it should not be a
   big problem; it depends upon the mobility pattern and duration.  The
   mobile node uses a pre-authentication procedure to obtain an IP
   address proactively and to set up the time-bound tunnels with the
   access routers of the candidate target networks.  Also, the MN may
   retain some or all of the nCoAs for future movement.

   The mobile node may choose one of these addresses as the binding
   update address and send it to the CN (Correspondent Node) or HA (Home
   Agent), and will thus receive the tunneled traffic via the target
   network while in the previous network.  But in some instances, the
   mobile node may eventually end up moving to a network that is other
   than the target network.  Thus, there will be a disruption in traffic
   as the mobile node moves to the new network, since the mobile node
   has to go through the process of assigning the new IP address and
   sending the binding update again.  There are two solutions to this
   problem.  As one solution to the problem, the mobile node can take
   advantage of the simultaneous mobility binding and send multiple
   binding updates to the Correspondent Host or HA.  Thus, the
   Correspondent Host or HA forwards the traffic to multiple IP
   addresses assigned to the virtual interfaces for a specific period of
   time.  This binding update gets refreshed at the CH after the mobile
   node moves to the new network, thus stopping the flow to the other
   candidate networks.  <a href="rfc5648.html">RFC 5648</a> [<a href="rfc5648.html" title='"Multiple Care-of Addresses Registration"'>RFC5648</a>] discusses different scenarios
   of mobility binding with multiple care-of-addresses.  As the second





<span class="grey">Dutta, et al.                 Informational                    [Page 22]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-23" id="page-23" name="page-23"> </a>
<span class="grey"><a href="rfc6252.html">RFC 6252</a>                      MPA Framework                    June 2011</span>


   solution, in case simultaneous binding is not supported in a specific
   mobility scheme, forwarding of traffic from the previous target
   network will help take care of the transient traffic until the new
   binding update is sent from the new network.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.3.%20%20Proactive%20IP%20Address%20Acquisition"></a><a class="selflink" href="#section-7.3" name="section-7.3">7.3</a>.  Proactive IP Address Acquisition</span>

   In general, a mobility management protocol works in conjunction with
   the Foreign Agent or in the co-located address mode.  The MPA
   approach can use both the co-located address mode and the Foreign
   Agent address mode.  We discuss here the address assignment component
   that is used in the co-located address mode.  There are several ways
   a mobile node can obtain an IP address and configure itself.  In some
   cases, a mobile node can configure itself statically in the absence
   of any configuration element such as a server or router in the
   network.  In a LAN environment, the mobile node can obtain an IP
   address from DHCP servers.  In the case of IPv6 networks, a mobile
   node has the option of obtaining the IP address using stateless
   autoconfiguration or DHCPv6.  In some wide-area networking
   environments, the mobile node uses PPP (Point-to-Point Protocol) to
   obtain the IP address by communicating with a NAS (Network Access
   Server).

   Each of these processes takes on the order of few hundred
   milliseconds to a few seconds, depending upon the type of IP address
   acquisition process and operating system of the clients and servers.
   Since IP address acquisition is part of the handover process, it adds
   to the handover delay, and thus it is desirable to reduce this delay
   as much as possible.  There are a few optimized techniques available,
   such as DHCP Rapid Commit [<a href="rfc4039.html" title='"Rapid Commit Option for the Dynamic Host Configuration Protocol version 4 (DHCPv4)"'>RFC4039</a>] and GPS-coordinate-based IP
   address [<a href="#ref-GPSIP" title='"GPS-IP based fast-handoff approaches for Mobiles"'>GPSIP</a>], that attempt to reduce the handover delay due to IP
   address acquisition time.  However, in all these cases, the mobile
   node also obtains the IP address after it moves to the new subnet and
   incurs some delay because of the signaling handshake between the
   mobile node and the DHCP server.

   In Fast MIPv6 [<a href="rfc5568.html" title='"Mobile IPv6 Fast Handovers"'>RFC5568</a>], through the RtSolPr and PrRtAdv messages,
   the MN also formulates a prospective new CoA (nCoA) when it is still
   present on the Previous Access Router's (pAR's) link.  Hence, the
   latency due to new prefix discovery subsequent to handover is
   eliminated.  However, in this case, both the pAR and the Next Access
   Router (nAR) need to cooperate with each other to be able to retrieve
   the prefix from the target network.

   In the following paragraph, we describe a few ways that a mobile node
   can obtain the IP address proactively from the CTN, and the
   associated tunnel setup procedure.  These can broadly be divided into
   four categories: PANA-assisted proactive IP address acquisition,



<span class="grey">Dutta, et al.                 Informational                    [Page 23]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-24" id="page-24" name="page-24"> </a>
<span class="grey"><a href="rfc6252.html">RFC 6252</a>                      MPA Framework                    June 2011</span>


   IKE-assisted proactive IP address acquisition, proactive IP address
   acquisition using DHCP only, and stateless autoconfiguration.  When
   DHCP is used for address configuration, a DHCP server is assumed to
   be serving one subnet.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/7.3.1.%20%20PANA-Assisted%20Proactive%20IP%20Address%20Acquisition"></a><a class="selflink" href="#section-7.3.1" name="section-7.3.1">7.3.1</a>.  PANA-Assisted Proactive IP Address Acquisition</span>

   In the case of PANA-assisted proactive IP address acquisition, the
   mobile node obtains an IP address proactively from a CTN.  The mobile
   node makes use of PANA [<a href="rfc5191.html" title='"Protocol for Carrying Authentication for Network Access (PANA)"'>RFC5191</a>] messages to trigger the IP address
   acquisition process via a DHCP client that is co-located with the
   PANA authentication agent in the access router in the CTN acting on
   behalf of the mobile node.  Upon receiving a PANA message from the
   mobile node, the DHCP client on the authentication agent performs
   normal DHCP message exchanges to obtain the IP address from the DHCP
   server in the CTN.  This address is piggy-backed in a PANA message
   and is delivered to the mobile node.  In the case of IPv6, a Router
   Advertisement (RA) is carried as part of the PANA message.  In the
   case of stateless autoconfiguration, the mobile node uses the
   prefix(es) obtained as part of the RA and its MAC address to
   construct the unique IPv6 address(es) as it would have done in the
   new network.  In the case of stateful address autoconfiguration, a
   procedure similar to DHCPv4 can be applied.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/7.3.2.%20%20IKEv2-Assisted%20Proactive%20IP%20Address%20Acquisition"></a><a class="selflink" href="#section-7.3.2" name="section-7.3.2">7.3.2</a>.  IKEv2-Assisted Proactive IP Address Acquisition</span>

   IKEv2-assisted proactive IP address acquisition works when an IPsec
   gateway and a DHCP relay agent [<a href="rfc3046.html" title='"DHCP Relay Agent Information Option"'>RFC3046</a>] are resident within each
   access router in the CTN.  In this case, the IPsec gateway and DHCP
   relay agent in a CTN help the mobile node acquire the IP address from
   the DHCP server in the CTN.  The MN-AR key established during the
   pre-authentication phase is used as the IKEv2 pre-shared secret
   needed to run IKEv2 between the mobile node and the access router.
   The IP address from the CTN is obtained as part of the standard IKEv2
   procedure, using the co-located DHCP relay agent for obtaining the IP
   address from the DHCP server in the target network using standard
   DHCP.  The obtained IP address is sent back to the client in the
   IKEv2 Configuration Payload exchange.  In this case, IKEv2 is also
   used as the tunnel management protocol for a proactive handover
   tunnel (see <a href="#section-7.4">Section 7.4</a>).  Alternatively, a VPN gateway can dispense
   the IP address from its IP address pool.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/7.3.3.%20%20Proactive%20IP%20Address%20Acquisition%20Using%20DHCPv4%20Only"></a><a class="selflink" href="#section-7.3.3" name="section-7.3.3">7.3.3</a>.  Proactive IP Address Acquisition Using DHCPv4 Only</span>

   As another alternative, DHCP may be used for proactively obtaining an
   IP address from a CTN without relying on PANA or IKEv2-based
   approaches by allowing direct DHCP communication between the mobile
   node and the DHCP relay agent or DHCP server in the CTN.  The



<span class="grey">Dutta, et al.                 Informational                    [Page 24]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-25" id="page-25" name="page-25"> </a>
<span class="grey"><a href="rfc6252.html">RFC 6252</a>                      MPA Framework                    June 2011</span>


   mechanism described in this section is applicable to DHCPv4 only.
   The mobile node sends a unicast DHCP message to the DHCP relay agent
   or DHCP server in the CTN requesting an address, while using the
   address associated with the current physical interface as the source
   address of the request.

   When the message is sent to the DHCP relay agent, the DHCP relay
   agent relays the DHCP messages back and forth between the mobile node
   and the DHCP server.  In the absence of a DHCP relay agent, the
   mobile node can also directly communicate with the DHCP server in the
   target network.  The broadcast option in the client's unicast
   DISCOVER message should be set to 0 so that the relay agent or the
   DHCP server can send the reply directly back to the mobile node using
   the mobile node's source address.

   In order to prevent malicious nodes from obtaining an IP address from
   the DHCP server, DHCP authentication should be used, or the access
   router should be configured with a filter to block unicast DHCP
   messages sent to the remote DHCP server from mobile nodes that are
   not pre-authenticated.  When DHCP authentication is used, the DHCP
   authentication key may be derived from the MPA-SA established between
   the mobile node and the authentication agent in the candidate target
   network.

   The proactively obtained IP address is not assigned to the mobile
   node's physical interface until the mobile node has moved to the new
   network.  The IP address thus obtained proactively from the target
   network should not be assigned to the physical interface but rather
   to a virtual interface of the client.  Thus, such a proactively
   acquired IP address via direct DHCP communication between the mobile
   node and the DHCP relay agent or the DHCP server in the CTN may be
   carried with additional information that is used to distinguish it
   from other addresses as assigned to the physical interface.

   Upon the mobile node's entry to the new network, the mobile node can
   perform DHCP over the physical interface to the new network to get
   other configuration parameters, such as the SIP server or DNS server,
   by using DHCP INFORM.  This should not affect the ongoing
   communication between the mobile node and Correspondent Host.  Also,
   the mobile node can perform DHCP over the physical interface to the
   new network to extend the lease of the address that was proactively
   obtained before entering the new network.

   In order to maintain the DHCP binding for the mobile node and keep
   track of the dispensed IP address before and after the secure
   proactive handover, the same DHCP client identifier needs to be used





<span class="grey">Dutta, et al.                 Informational                    [Page 25]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-26" id="page-26" name="page-26"> </a>
<span class="grey"><a href="rfc6252.html">RFC 6252</a>                      MPA Framework                    June 2011</span>


   for the mobile node for both DHCP for proactive IP address
   acquisition and for DHCP performed after the mobile node enters the
   target network.  The DHCP client identifier may be the MAC address of
   the mobile node or some other identifier.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/7.3.4.%20%20Proactive%20IP%20Address%20Acquisition%20Using%20Stateless"></a><a class="selflink" href="#section-7.3.4" name="section-7.3.4">7.3.4</a>.  Proactive IP Address Acquisition Using Stateless</span>
<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/Autoconfiguration"></a>        Autoconfiguration</span>

   For IPv6, a network address is configured either using DHCPv6 or
   stateless autoconfiguration.  In order to obtain the new IP address
   proactively, the router advertisement of the next-hop router can be
   sent over the established tunnel, and a new IPv6 address is generated
   based on the prefix and MAC address of the mobile node.  Generating a
   CoA from the new network will avoid the time needed to obtain an IP
   address and perform Duplicate Address Detection.

   Duplicate Address Detection and address resolution are part of the IP
   address acquisition process.  As part of the proactive configuration,
   these two processes can be done ahead of time.  Details of how these
   two processes can be done proactively are described in <a href="#appendix-A">Appendix A</a> and
   <a href="#appendix-B">Appendix B</a>, respectively.

   In the case of stateless autoconfiguration, the mobile node checks to
   see the prefix of the router advertisement in the new network and
   matches it with the prefix of the newly assigned IP address.  If
   these turn out to be the same, then the mobile node does not go
   through the IP address acquisition phase again.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.4.%20%20Tunnel%20Management"></a><a class="selflink" href="#section-7.4" name="section-7.4">7.4</a>.  Tunnel Management</span>

   After an IP address is proactively acquired from the DHCP server in a
   CTN, or via stateless autoconfiguration in the case of IPv6, a
   proactive handover tunnel is established between the mobile node and
   the access router in the CTN.  The mobile node uses the acquired IP
   address as the tunnel's inner address.

   There are several reasons why this transient tunnel is established
   between the nAR and the mobile node in the old PoA, unlike the
   transient tunnel in FMIPv6 (Fast MIPv6) [<a href="rfc5568.html" title='"Mobile IPv6 Fast Handovers"'>RFC5568</a>], where it is set up
   between the mobile node's new point of attachment and the old access
   router.

   In the case of inter-domain handoff, it is important that any
   signaling message between the nPoA and the mobile node needs to be
   secured.  This transient secured tunnel provides the desired
   functionality, including securing the proactive binding update and
   transient data between the end-points before the handover has taken
   place.  Unlike the proactive mode of FMIPv6, transient handover



<span class="grey">Dutta, et al.                 Informational                    [Page 26]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-27" id="page-27" name="page-27"> </a>
<span class="grey"><a href="rfc6252.html">RFC 6252</a>                      MPA Framework                    June 2011</span>


   packets are not sent to the pAR, and thus a tunnel between the mobile
   node's new point of attachment and the old access router is not
   needed.

   In the case of inter-domain handoff, the pAR and nAR could logically
   be far from each other.  Thus, the signaling and data during the
   pre-authentication period will take a longer route, and thus may be
   subjected to longer one-way delay.  Hence, MPA provides a tradeoff
   between larger packet loss or larger one-way packet delay for a
   transient period, when the mobile node is preparing for handoff.

   The proactive handover tunnel is established using a tunnel
   management protocol.  When IKEv2 is used for proactive IP address
   acquisition, IKEv2 is also used as the tunnel management protocol.
   Alternatively, when PANA is used for proactive IP address
   acquisition, PANA may be used as the secure tunnel management
   protocol.

   Once the proactive handover tunnel is established between the mobile
   node and the access router in the candidate target network, the
   access router also needs to perform proxy address resolution (Proxy
   ARP) on behalf of the mobile node so that it can capture any packets
   destined to the mobile node's new address.

   Since the mobile node needs to be able to communicate with the
   Correspondent Node while in the previous network, some or all parts
   of the binding update and data from the Correspondent Node to the
   mobile node need to be sent back to the mobile node over a proactive
   handover tunnel.  Details of these binding update procedures are
   described in <a href="#section-7.5">Section 7.5</a>.

   In order for the traffic to be directed to the mobile node after the
   mobile node attaches to the target network, the proactive handover
   tunnel needs to be deleted or disabled.  The tunnel management
   protocol used for establishing the tunnel is used for this purpose.
   Alternatively, when PANA is used as the authentication protocol, the
   tunnel deletion or disabling at the access router can be triggered by
   means of the PANA update mechanism as soon as the mobile node moves
   to the target network.  A link-layer trigger ensures that the mobile
   node is indeed connected to the target network and can also be used
   as the trigger to delete or disable the tunnel.  A tunnel management
   protocol also triggers the router advertisement (RA) from the next
   access router to be sent over the tunnel, as soon as the tunnel
   creation is complete.







<span class="grey">Dutta, et al.                 Informational                    [Page 27]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-28" id="page-28" name="page-28"> </a>
<span class="grey"><a href="rfc6252.html">RFC 6252</a>                      MPA Framework                    June 2011</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.5.%20%20Binding%20Update"></a><a class="selflink" href="#section-7.5" name="section-7.5">7.5</a>.  Binding Update</span>

   There are several kinds of binding update mechanisms for different
   mobility management schemes.

   In the case of Mobile IPv4 and Mobile IPv6, the mobile node performs
   a binding update with the Home Agent only, if route optimization is
   not used.  Otherwise, the mobile node performs the binding update
   with both the Home Agent (HA) and Correspondent Node (CN).

   In the case of SIP-based terminal mobility, the mobile node sends a
   binding update using an INVITE to the Correspondent Node and a
   REGISTER message to the Registrar.  Based on the distance between the
   mobile node and the Correspondent Node, the binding update may
   contribute to the handover delay.  SIP-fast handover [<a href="#ref-SIPFAST" title='"Fast-handoff Schemes for Application Layer Mobility Management"'>SIPFAST</a>]
   provides several ways of reducing the handover delay due to binding
   update.  In the case of secure proactive handover using SIP-based
   mobility management, we do not encounter the delay due to the binding
   update at all, as it takes place in the previous network.

   Thus, this proactive binding update scheme looks more attractive when
   the Correspondent Node is too far from the communicating mobile node.
   Similarly, in the case of Mobile IPv6, the mobile node sends the
   newly acquired CoA from the target network as the binding update to
   the HA and CN.  Also, all signaling messages between the MN and HA
   and between the MN and CN are passed through this proactive tunnel
   that is set up.  These messages include Binding Update (BU); Binding
   Acknowledgement (BA); and the associated return routability messages,
   such as Home Test Init (HoTI), Home Test (HoT), Care-of Test Init
   (CoTI), and Care-of Test (CoT).  In Mobile IPv6, since the receipt of
   an on-link router advertisement is mandatory for the mobile node to
   detect the movement and trigger the binding update, a router
   advertisement from the next access router needs to be advertised over
   the tunnel.  By proper configuration on the nAR, the router
   advertisement can be sent over the tunnel interface to trigger the
   proactive binding update.  The mobile node also needs to make the
   tunnel interface the active interface, so that it can send the
   binding update using this interface as soon as it receives the router
   advertisement.

   If the proactive handover tunnel is realized as an IPsec tunnel, it
   will also protect these signaling messages between the tunnel end-
   points and will make the return routability test secured as well.
   Any subsequent data will also be tunneled through, as long as the
   mobile node is in the previous network.  The accompanying document
   [<a href="#ref-MPA-WIRELESS" title='"Media- Independent Pre-authentication Supporting Secure Interdomain Handover Optimization"'>MPA-WIRELESS</a>] talks about the details of how binding updates and
   signaling for return routability are sent over the secured tunnel.




<span class="grey">Dutta, et al.                 Informational                    [Page 28]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-29" id="page-29" name="page-29"> </a>
<span class="grey"><a href="rfc6252.html">RFC 6252</a>                      MPA Framework                    June 2011</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.6.%20%20Preventing%20Packet%20Loss"></a><a class="selflink" href="#section-7.6" name="section-7.6">7.6</a>.  Preventing Packet Loss</span>

   In the MPA case, packet loss due to IP address acquisition, secured
   authentication, and binding update does not occur.  However,
   transient packets during link-layer handover can be lost.  Possible
   scenarios of packet loss and its prevention are described below.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/7.6.1.%20%20Packet%20Loss%20Prevention%20in%20Single-Interface%20MPA"></a><a class="selflink" href="#section-7.6.1" name="section-7.6.1">7.6.1</a>.  Packet Loss Prevention in Single-Interface MPA</span>

   For single-interface MPA, there may be some transient packets during
   link-layer handover that are directed to the mobile node at the old
   point of attachment before the mobile node is able to attach to the
   target network.  Those transient packets can be lost.  Buffering
   these packets at the access router of the old point of attachment can
   eliminate packet loss.  Dynamic buffering signals from the MN can
   temporarily hold transient traffic during handover, and then these
   packets can be forwarded to the MN once it attaches to the target
   network.  A detailed analysis of the buffering technique can be found
   in [<a href="#ref-PIMRC06" title='"Dynamic Buffering Control Scheme for Mobile Handoff"'>PIMRC06</a>].

   An alternative method is to use bicasting.  Bicasting helps to
   forward the traffic to two destinations at the same time.  However,
   it does not eliminate packet loss if link-layer handover is not
   seamlessly performed.  On the other hand, buffering does not reduce
   packet delay.  While packet delay can be compensated by a playout
   buffer at the receiver side for a streaming application, a playout
   buffer does not help much for interactive VoIP applications that
   cannot tolerate large delay jitters.  Thus, it is still important to
   optimize the link-layer handover anyway.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/7.6.2.%20%20Preventing%20Packet%20Losses%20for%20Multiple%20Interfaces"></a><a class="selflink" href="#section-7.6.2" name="section-7.6.2">7.6.2</a>.  Preventing Packet Losses for Multiple Interfaces</span>

   MPA usage in multi-interface handover scenarios involves preparing
   the second interface for use via the current active interface.  This
   preparation involves pre-authentication and provisioning at a target
   network where the second interface would be the eventual active
   interface.  For example, during inter-technology handover from a WiFi
   to a CDMA network, pre-authentication at the CDMA network can be
   performed via the WiFi interface.  The actual handover occurs when
   the CDMA interface becomes the active interface for the MN.

   In such scenarios, if handover occurs while both interfaces are
   active, there is generally no packet loss, since transient packets
   directed towards the old interface will still reach the MN.  However,
   if sudden disconnection of the current active interface is used to
   initiate handover to the prepared interface, then transient packets
   for the disconnected interface will be lost while the MN attempts to
   be reachable at the prepared interface.  In such cases, a specialized



<span class="grey">Dutta, et al.                 Informational                    [Page 29]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-30" id="page-30" name="page-30"> </a>
<span class="grey"><a href="rfc6252.html">RFC 6252</a>                      MPA Framework                    June 2011</span>


   form of buffering can be used to eliminate packet loss where packets
   are merely copied at an access router in the current active network
   prior to disconnection.  If sudden disconnection does occur, copied
   packets can be forwarded to the MN once the prepared interface
   becomes the active reachable interface.  The copy-and-forward
   mechanism is not limited to multi-interface handover.

   A notable side-effect of this process is the possible duplication of
   packets during forwarding to the new active interface.  Several
   approaches can be employed to minimize this effect.  Relying on
   upper-layer protocols such as TCP to detect and eliminate duplicates
   is the most common approach.  Customized duplicate detection and
   handling techniques can also be used.  In general, packet duplication
   is a well-known issue that can also be handled locally by the MN.

   If the mobile node takes a longer amount of time to detect the
   disconnection event of the current active interface, this can also
   have an adverse effect on the length of the handover process.  Thus,
   it becomes necessary to use an optimized scheme of detecting
   interface disconnection in such scenarios.  Use of the current
   interface to perform pre-authentication instead of the new interface
   is desirable in certain circumstances, such as to save battery power,
   or in cases where the adjacent cells (e.g., WiFi or CDMA) are
   non-overlapping, or in cases when the carrier does not allow the
   simultaneous use of both interfaces.  However, in certain
   circumstances, depending upon the type of target network, only parts
   of MPA operations can be performed (e.g., pre-authentication,
   pre-configuration, or proactive binding update).  In a specific
   scenario involving handoff between WiFi and CDMA networks, some of
   the PPP context can be set up during the pre-authentication period,
   thus reducing the time for PPP activation.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/7.6.3.%20%20Reachability%20Test"></a><a class="selflink" href="#section-7.6.3" name="section-7.6.3">7.6.3</a>.  Reachability Test</span>

   In addition to previous techniques, the MN may also want to ensure
   reachability of the new point of attachment before switching from the
   old one.  This can be done by exchanging link-layer management frames
   with the new point of attachment.  This reachability check should be
   performed as quickly as possible.  In order to prevent packet loss
   during this reachability check, transmission of packets over the link
   between the MN and the old point of attachment should be suspended by
   buffering the packets at both ends of the link during the
   reachability check.  How to perform this buffering is out of scope of
   this document.  Some of the results of using this buffering scheme
   are explained in the accompanying document [<a href="#ref-MPA-WIRELESS" title='"Media- Independent Pre-authentication Supporting Secure Interdomain Handover Optimization"'>MPA-WIRELESS</a>].






<span class="grey">Dutta, et al.                 Informational                    [Page 30]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-31" id="page-31" name="page-31"> </a>
<span class="grey"><a href="rfc6252.html">RFC 6252</a>                      MPA Framework                    June 2011</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.7.%20%20Security%20and%20Mobility"></a><a class="selflink" href="#section-7.7" name="section-7.7">7.7</a>.  Security and Mobility</span>

   This section describes how MPA can help establish layer 2 and layer 3
   security association in the target networks while the mobile node is
   in the previous network.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/7.7.1.%20%20Link-Layer%20Security%20and%20Mobility"></a><a class="selflink" href="#section-7.7.1" name="section-7.7.1">7.7.1</a>.  Link-Layer Security and Mobility</span>

   Using the MPA-SA established between the mobile node and the
   authentication agent for a CTN, during the pre-authentication phase,
   it is possible to bootstrap link-layer security in the CTN while the
   mobile node is in the current network, as described in the following
   steps.  Figure 5 shows the sequence of operation.

   (1)  The authentication agent and the mobile node derive a PMK (Pair-
        wise Master Key) [<a href="rfc5247.html" title='"Extensible Authentication Protocol (EAP) Key Management Framework"'>RFC5247</a>] using the MPA-SA that is established
        as a result of successful pre-authentication.  Successful
        operation of EAP and a AAA protocol may be involved during
        pre-authentication to establish the MPA-SA.  From the PMK,
        distinct TSKs (Transient Session Keys) [<a href="rfc5247.html" title='"Extensible Authentication Protocol (EAP) Key Management Framework"'>RFC5247</a>] for the mobile
        node are directly or indirectly derived for each point of
        attachment of the CTN.

   (2)  The authentication agent may install the keys derived from the
        PMK and used for secure association to points of attachment.
        The derived keys may be TSKs or intermediary keys from which
        TSKs are derived.

   (3)  After the mobile node chooses a CTN as the target network and
        switches to a point of attachment in the target network (which
        now becomes the new network for the mobile node), it executes a
        secure association protocol such as the IEEE 802.11i 4-way
        handshake [<a href="#ref-802.11" title='"IEEE Wireless LAN Edition A compilation based on IEEE Std 802.11-1999(R2003)"'>802.11</a>], using the PMK in order to establish PTKs
        (Pair-wise Transient Keys) and group keys [<a href="rfc5247.html" title='"Extensible Authentication Protocol (EAP) Key Management Framework"'>RFC5247</a>] used for
        protecting link-layer packets between the mobile node and the
        point of attachment.  No additional execution of EAP
        authentication is needed here.

   (4)  While the mobile node is roaming in the new network, the mobile
        node only needs to perform a secure association protocol with
        its point of attachment, and no additional execution of EAP
        authentication is needed either.  Integration of MPA with link-
        layer handover optimization mechanisms such as 802.11r can be
        archived this way.

   The mobile node may need to know the link-layer identities of the
   points of attachment in the CTN to derive TSKs.




<span class="grey">Dutta, et al.                 Informational                    [Page 31]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-32" id="page-32" name="page-32"> </a>
<span class="grey"><a href="rfc6252.html">RFC 6252</a>                      MPA Framework                    June 2011</span>


          _________________        ____________________________
         | Current Network |      |           CTN              |
         |   ____          |      |                 ____       |
         |  |    |      (1) pre-authentication     |    |      |
         |  | MN |&lt;-------------------------------&gt;| AA |      |
         |  |____|         |      |                |____|      |
         |    .            |      |                  |         |
         |    .            |      |                  |         |
         |____.____________|      |                  |         |
              .movement           |                  |(2) Keys |
          ____.___________________|                  |         |
         |   _v__                      _____         |         |
         |  |    |(3) secure assoc.   |     |        |         |
         |  | MN |&lt;------------------&gt;| AP1 |&lt;-------+         |
         |  |____|                    |_____|        |         |
         |    .                                      |         |
         |    .movement                              |         |
         |    .                                      |         |
         |    .                                      |         |
         |   _v__                      _____         |         |
         |  |    |(4) secure assoc.   |     |        |         |
         |  | MN |&lt;------------------&gt;| AP2 |&lt;-------+         |
         |  |____|                    |_____|                  |
         |_____________________________________________________|

                Figure 5: Bootstrapping Link-Layer Security

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/7.7.2.%20%20IP-Layer%20Security%20and%20Mobility"></a><a class="selflink" href="#section-7.7.2" name="section-7.7.2">7.7.2</a>.  IP-Layer Security and Mobility</span>

   IP-layer security is typically maintained between the mobile node and
   the first-hop router, or any other network element such as SIP proxy
   by means of IPsec.  This IPsec SA can be set up either in tunnel mode
   or in ESP mode.  However, as the mobile node moves, the IP address of
   the router and outbound proxy will change in the new network.  The
   mobile node's IP address may or may not change, depending upon the
   mobility protocol being used.  This will warrant re-establishing a
   new security association between the mobile node and the desired
   network entity.  In some cases, such as in a 3GPP/3GPP2 IMS/MMD
   environment, data traffic is not allowed to pass through unless there
   is an IPsec SA established between the mobile node and outbound
   proxy.  This will of course add unreasonable delay to the existing
   real-time communication during a mobile node's movement.  In this
   scenario, key exchange is done as part of a SIP registration that
   follows a key exchange procedure called AKA (Authentication and Key
   Agreement).






<span class="grey">Dutta, et al.                 Informational                    [Page 32]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-33" id="page-33" name="page-33"> </a>
<span class="grey"><a href="rfc6252.html">RFC 6252</a>                      MPA Framework                    June 2011</span>


   MPA can be used to bootstrap this security association as part of
   pre-authentication via the new outbound proxy.  Prior to the
   movement, if the mobile node can pre-register via the new outbound
   proxy in the target network and completes the pre-authentication
   procedure, then the new SA state between the mobile node and new
   outbound proxy can be established prior to the movement to the new
   network.  A similar approach can also be applied if a key exchange
   mechanism other than AKA is used or the network element with which
   the security association has to be established is different than an
   outbound proxy.

   By having the security association established ahead of time, the
   mobile node does not need to be involved in any exchange to set up
   the new security association after the movement.  Any further key
   exchange will be limited to renew the expiry time.  This will reduce
   the delay for real-time communication as well.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.8.%20%20Authentication%20in%20Initial%20Network%20Attachment"></a><a class="selflink" href="#section-7.8" name="section-7.8">7.8</a>.  Authentication in Initial Network Attachment</span>

   When the mobile node initially attaches to a network, network access
   authentication would occur regardless of the use of MPA.  The
   protocol used for network access authentication when MPA is used for
   handover optimization can be a link-layer network access
   authentication protocol such as IEEE 802.1X, or a higher-layer
   network access authentication protocol such as PANA.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20Security%20Considerations"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  Security Considerations</span>

   This document describes a framework for a secure handover
   optimization mechanism based on performing handover-related signaling
   between a mobile node and one or more candidate target networks to
   which the mobile node may move in the future.  This framework
   involves acquisition of the resources from the CTN as well as data
   packet redirection from the CTN to the mobile node in the current
   network before the mobile node physically connects to one of those
   CTNs.

   Acquisition of the resources from the candidate target networks must
   be done with appropriate authentication and authorization procedures
   in order to prevent an unauthorized mobile node from obtaining the
   resources.  For this reason, it is important for the MPA framework to
   perform pre-authentication between the mobile node and the candidate
   target networks.  The MN-CA key and the MN-AR key generated as a
   result of successful pre-authentication can protect subsequent
   handover signaling packets and data packets exchanged between the
   mobile node and the MPA functional elements in the CTNs.





<span class="grey">Dutta, et al.                 Informational                    [Page 33]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-34" id="page-34" name="page-34"> </a>
<span class="grey"><a href="rfc6252.html">RFC 6252</a>                      MPA Framework                    June 2011</span>


   The MPA framework also addresses security issues when the handover is
   performed across multiple administrative domains.  With MPA, it is
   possible for handover signaling to be performed based on direct
   communication between the mobile node and routers or mobility agents
   in the candidate target networks.  This eliminates the need for a
   context transfer protocol [<a href="rfc5247.html" title='"Extensible Authentication Protocol (EAP) Key Management Framework"'>RFC5247</a>] for which known limitations exist
   in terms of security and authorization.  For this reason, the MPA
   framework does not require trust relationships among administrative
   domains or access routers, which makes the framework more deployable
   in the Internet without compromising the security in mobile
   environments.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/9.%20%20Acknowledgments"></a><a class="selflink" href="#section-9" name="section-9">9</a>.  Acknowledgments</span>

   We would like to thank Farooq Anjum and Raziq Yaqub for their review
   of this document, and Subir Das for standardization support in the
   IEEE 802.21 working group.

   The authors would like to acknowledge Christian Vogt, Rajeev Koodli,
   Marco Liebsch, Juergen Schoenwaelder, and Charles Perkins for their
   thorough review of the document and useful feedback.

   Author and Editor Ashutosh Dutta would like to thank Telcordia
   Technologies, and author Victor Fajardo would like to thank Toshiba
   America Research and Telcordia Technologies, for supporting the
   development of their document while they were employed in their
   respective organizations.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/10.%20%20References"></a><a class="selflink" href="#section-10" name="section-10">10</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/10.1.%20%20Normative%20References"></a><a class="selflink" href="#section-10.1" name="section-10.1">10.1</a>.  Normative References</span>

   [<a id="ref-RFC5944" name="ref-RFC5944">RFC5944</a>]  Perkins, C., Ed., "IP Mobility Support for IPv4, Revised",
              <a href="rfc5944.html">RFC 5944</a>, November 2010.

   [<a id="ref-RFC3748" name="ref-RFC3748">RFC3748</a>]  Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H.
              Levkowetz, Ed., "Extensible Authentication Protocol
              (EAP)", <a href="rfc3748.html">RFC 3748</a>, June 2004.

   [<a id="ref-RFC3775" name="ref-RFC3775">RFC3775</a>]  Johnson, D., Perkins, C., and J. Arkko, "Mobility Support
              in IPv6", <a href="rfc3775.html">RFC 3775</a>, June 2004.

   [<a id="ref-RFC2205" name="ref-RFC2205">RFC2205</a>]  Braden, R., Ed., Zhang, L., Berson, S., Herzog, S., and S.
              Jamin, "Resource ReSerVation Protocol (RSVP) -- Version 1
              Functional Specification", <a href="rfc2205.html">RFC 2205</a>, September 1997.






<span class="grey">Dutta, et al.                 Informational                    [Page 34]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-35" id="page-35" name="page-35"> </a>
<span class="grey"><a href="rfc6252.html">RFC 6252</a>                      MPA Framework                    June 2011</span>


   [<a id="ref-RFC5380" name="ref-RFC5380">RFC5380</a>]  Soliman, H., Castelluccia, C., El Malki, K., and L.
              Bellier, "Hierarchical Mobile IPv6 (HMIPv6) Mobility
              Management", <a href="rfc5380.html">RFC 5380</a>, October 2008.

   [<a id="ref-RFC5568" name="ref-RFC5568">RFC5568</a>]  Koodli, R., Ed., "Mobile IPv6 Fast Handovers", <a href="rfc5568.html">RFC 5568</a>,
              July 2009.

   [<a id="ref-RFC2119" name="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a id="ref-RFC4555" name="ref-RFC4555">RFC4555</a>]  Eronen, P., "IKEv2 Mobility and Multihoming Protocol
              (MOBIKE)", <a href="rfc4555.html">RFC 4555</a>, June 2006.

   [<a id="ref-RFC4881" name="ref-RFC4881">RFC4881</a>]  El Malki, K., Ed., "Low-Latency Handoffs in Mobile IPv4",
              <a href="rfc4881.html">RFC 4881</a>, June 2007.

   [<a id="ref-RFC4066" name="ref-RFC4066">RFC4066</a>]  Liebsch, M., Ed., Singh, A., Ed., Chaskar, H., Funato, D.,
              and E. Shim, "Candidate Access Router Discovery (CARD)",
              <a href="rfc4066.html">RFC 4066</a>, July 2005.

   [<a id="ref-RFC4067" name="ref-RFC4067">RFC4067</a>]  Loughney, J., Nakhjiri, M., Perkins, C., and R. Koodli,
              "Context Transfer Protocol (CXTP)", <a href="rfc4067.html">RFC 4067</a>, July 2005.

   [<a id="ref-RFC5247" name="ref-RFC5247">RFC5247</a>]  Aboba, B., Simon, D., and P. Eronen, "Extensible
              Authentication Protocol (EAP) Key Management Framework",
              <a href="rfc5247.html">RFC 5247</a>, August 2008.

   [<a id="ref-RFC5191" name="ref-RFC5191">RFC5191</a>]  Forsberg, D., Ohba, Y., Ed., Patil, B., Tschofenig, H.,
              and A. Yegin, "Protocol for Carrying Authentication for
              Network Access (PANA)", <a href="rfc5191.html">RFC 5191</a>, May 2008.

   [<a id="ref-RG98" name="ref-RG98">RG98</a>]     ITU-T, "General Characteristics of International Telephone
              Connections and International Telephone Circuits: One-Way
              Transmission Time", ITU-T Recommendation G.114, 1998.

   [<a id="ref-ITU98" name="ref-ITU98">ITU98</a>]    ITU-T, "The E-Model, a computational model for use in
              transmission planning", ITU-T Recommendation G.107, 1998.

   [<a id="ref-ETSI" name="ref-ETSI">ETSI</a>]     ETSI, "Telecommunications and Internet Protocol
              Harmonization Over Networks (TIPHON) Release 3; End-to-end
              Quality of Service in TIPHON systems; Part 1: General
              aspects of Quality of Service (QoS)", ETSI TR 101
              329-1 V3.1.2, 2002.








<span class="grey">Dutta, et al.                 Informational                    [Page 35]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-36" id="page-36" name="page-36"> </a>
<span class="grey"><a href="rfc6252.html">RFC 6252</a>                      MPA Framework                    June 2011</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/10.2.%20%20Informative%20References"></a><a class="selflink" href="#section-10.2" name="section-10.2">10.2</a>.  Informative References</span>

   [<a id="ref-RFC5201" name="ref-RFC5201">RFC5201</a>]      Moskowitz, R., Nikander, P., Jokela, P., Ed., and T.
                  Henderson, "Host Identity Protocol", <a href="rfc5201.html">RFC 5201</a>,
                  April 2008.

   [<a id="ref-RFC2679" name="ref-RFC2679">RFC2679</a>]      Almes, G., Kalidindi, S., and M. Zekauskas, "A One-way
                  Delay Metric for IPPM", <a href="rfc2679.html">RFC 2679</a>, September 1999.

   [<a id="ref-RFC2680" name="ref-RFC2680">RFC2680</a>]      Almes, G., Kalidindi, S., and M. Zekauskas, "A One-way
                  Packet Loss Metric for IPPM", <a href="rfc2680.html">RFC 2680</a>,
                  September 1999.

   [<a id="ref-RFC2681" name="ref-RFC2681">RFC2681</a>]      Almes, G., Kalidindi, S., and M. Zekauskas, "A
                  Round-trip Delay Metric for IPPM", <a href="rfc2681.html">RFC 2681</a>,
                  September 1999.

   [<a id="ref-RFC2003" name="ref-RFC2003">RFC2003</a>]      Perkins, C., "IP Encapsulation within IP", <a href="rfc2003.html">RFC 2003</a>,
                  October 1996.

   [<a id="ref-RFC2608" name="ref-RFC2608">RFC2608</a>]      Guttman, E., Perkins, C., Veizades, J., and M. Day,
                  "Service Location Protocol, Version 2", <a href="rfc2608.html">RFC 2608</a>,
                  June 1999.

   [<a id="ref-RFC2473" name="ref-RFC2473">RFC2473</a>]      Conta, A. and S. Deering, "Generic Packet Tunneling in
                  IPv6 Specification", <a href="rfc2473.html">RFC 2473</a>, December 1998.

   [<a id="ref-RFC3046" name="ref-RFC3046">RFC3046</a>]      Patrick, M., "DHCP Relay Agent Information Option",
                  <a href="rfc3046.html">RFC 3046</a>, January 2001.

   [<a id="ref-RFC4039" name="ref-RFC4039">RFC4039</a>]      Park, S., Kim, P., and B. Volz, "Rapid Commit Option
                  for the Dynamic Host Configuration Protocol version 4
                  (DHCPv4)", <a href="rfc4039.html">RFC 4039</a>, March 2005.

   [<a id="ref-RFC5172" name="ref-RFC5172">RFC5172</a>]      Varada, S., Ed., "Negotiation for IPv6 Datagram
                  Compression Using IPv6 Control Protocol", <a href="rfc5172.html">RFC 5172</a>,
                  March 2008.

   [<a id="ref-RFC5648" name="ref-RFC5648">RFC5648</a>]      Wakikawa, R., Ed., Devarapalli, V., Tsirtsis, G.,
                  Ernst, T., and K. Nagami, "Multiple Care-of Addresses
                  Registration", <a href="rfc5648.html">RFC 5648</a>, October 2009.

   [<a id="ref-RFC4429" name="ref-RFC4429">RFC4429</a>]      Moore, N., "Optimistic Duplicate Address Detection
                  (DAD) for IPv6", <a href="rfc4429.html">RFC 4429</a>, April 2006.







<span class="grey">Dutta, et al.                 Informational                    [Page 36]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-37" id="page-37" name="page-37"> </a>
<span class="grey"><a href="rfc6252.html">RFC 6252</a>                      MPA Framework                    June 2011</span>


   [<a id="ref-RFC5836" name="ref-RFC5836">RFC5836</a>]      Ohba, Y., Ed., Wu, Q., Ed., and G. Zorn, Ed.,
                  "Extensible Authentication Protocol (EAP) Early
                  Authentication Problem Statement", <a href="rfc5836.html">RFC 5836</a>,
                  April 2010.

   [<a id="ref-RFC5213" name="ref-RFC5213">RFC5213</a>]      Gundavelli, S., Ed., Leung, K., Devarapalli, V.,
                  Chowdhury, K., and B. Patil, "Proxy Mobile IPv6",
                  <a href="rfc5213.html">RFC 5213</a>, August 2008.

   [<a id="ref-RFC5974" name="ref-RFC5974">RFC5974</a>]      Manner, J., Karagiannis, G., and A. McDonald, "NSIS
                  Signaling Layer Protocol (NSLP) for Quality-of-Service
                  Signaling", <a href="rfc5974.html">RFC 5974</a>, October 2010.

   [<a id="ref-RFC5169" name="ref-RFC5169">RFC5169</a>]      Clancy, T., Nakhjiri, M., Narayanan, V., and L.
                  Dondeti, "Handover Key Management and
                  Re-Authentication Problem Statement", <a href="rfc5169.html">RFC 5169</a>,
                  March 2008.

   [<a id="ref-SIPMM" name="ref-SIPMM">SIPMM</a>]        Schulzrinne, H. and E. Wedlund, "Application-Layer
                  Mobility Using SIP", ACM MC2R, July 2000.

   [<a id="ref-CELLIP" name="ref-CELLIP">CELLIP</a>]       Campbell, A., Gomez, J., Kim, S., Valko, A., Wan, C.,
                  and Z. Turanyi, "Design, Implementation, and
                  Evaluation of Cellular IP", IEEE Personal
                  Communications, August 2000.

   [<a id="ref-MOBIQUIT07" name="ref-MOBIQUIT07">MOBIQUIT07</a>]   Lopez, R., Dutta, A., Ohba, Y., Schulzrinne, H., and
                  A.  Skarmeta, "Network-layer assisted mechanism to
                  optimize authentication delay during handoff in 802.11
                  networks", IEEE Mobiquitous, June 2007.

   [<a id="ref-MISHRA04" name="ref-MISHRA04">MISHRA04</a>]     Mishra, A., Shin, M., Petroni, N., Clancy, T., and W.
                  Arbaugh, "Proactive key distribution using neighbor
                  graphs", IEEE Wireless Communications Magazine,
                  February 2004.

   [<a id="ref-SPRINGER07" name="ref-SPRINGER07">SPRINGER07</a>]   Dutta, A., Das, S., Famolari, D., Ohba, Y., Taniuchi,
                  K., Fajardo, V., Lopez, R., Kodama, T., Schulzrinne,
                  H., and A. Skarmeta, "Seamless proactive handover
                  across heterogeneous access networks", Wireless
                  Personal Communications, November 2007.

   [<a id="ref-HAWAII" name="ref-HAWAII">HAWAII</a>]       Ramjee, R., La Porta, T., Thuel, S., Varadhan, K., and
                  S.  Wang, "HAWAII: A Domain-based Approach for
                  Supporting Mobility in Wide-area Wireless networks",
                  International Conference on Network Protocols ICNP'99.





<span class="grey">Dutta, et al.                 Informational                    [Page 37]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-38" id="page-38" name="page-38"> </a>
<span class="grey"><a href="rfc6252.html">RFC 6252</a>                      MPA Framework                    June 2011</span>


   [<a id="ref-IDMP" name="ref-IDMP">IDMP</a>]         Das, S., McAuley, A., Dutta, A., Misra, A.,
                  Chakraborty, K., and S. Das, "IDMP: An Intra-Domain
                  Mobility Management Protocol for Next Generation
                  Wireless Networks", IEEE Wireless Communications
                  Magazine, October 2000.

   [<a id="ref-MOBIP-REG" name="ref-MOBIP-REG">MOBIP-REG</a>]    Gustafsson, E., Jonsson, A., and C. Perkins, "Mobile
                  IPv4 Regional Registration", Work in Progress,
                  June 2004.

   [<a id="ref-YOKOTA" name="ref-YOKOTA">YOKOTA</a>]       Yokota, H., Idoue, A., Hasegawa, T., and T. Kato,
                  "Link Layer Assisted Mobile IP Fast Handoff Method
                  over Wireless LAN Networks", Proceedings of ACM
                  MobiCom02, 2002.

   [<a id="ref-MACD" name="ref-MACD">MACD</a>]         Shin, S., Forte, A., Rawat, A., and H. Schulzrinne,
                  "Reducing MAC Layer Handoff Latency in IEEE 802.11
                  Wireless LANs", MobiWac Workshop, 2004.

   [<a id="ref-SUM" name="ref-SUM">SUM</a>]          Dutta, A., Zhang, T., Madhani, S., Taniuchi, K.,
                  Fujimoto, K., Katsube, Y., Ohba, Y., and H.
                  Schulzrinne, "Secured Universal Mobility for Wireless
                  Internet", WMASH'04, October 2004.

   [<a id="ref-SIPFAST" name="ref-SIPFAST">SIPFAST</a>]      Dutta, A., Madhani, S., Chen, W., Altintas, O., and H.
                  Schulzrinne, "Fast-handoff Schemes for Application
                  Layer Mobility Management", PIMRC 2004.

   [<a id="ref-PIMRC06" name="ref-PIMRC06">PIMRC06</a>]      Dutta, A., Berg, E., Famolari, D., Fajardo, V., Ohba,
                  Y., Taniuchi, K., Kodama, T., and H. Schulzrinne,
                  "Dynamic Buffering Control Scheme for Mobile Handoff",
                  Proceedings of PIMRC 2006, 1-11.

   [<a id="ref-MITH" name="ref-MITH">MITH</a>]         Gwon, Y., Fu, G., and R. Jain, "Fast Handoffs in
                  Wireless LAN Networks using Mobile initiated Tunneling
                  Handoff Protocol for IPv4 (MITHv4)", Wireless
                  Communications and Networking 2003, January 2005.

   [<a id="ref-WENYU" name="ref-WENYU">WENYU</a>]        Jiang, W. and H. Schulzrinne, "Modeling of Packet Loss
                  and Delay and their Effect on Real-Time Multimedia
                  Service Quality", NOSSDAV 2000, June 2000.

   [<a id="ref-802.21" name="ref-802.21">802.21</a>]       "IEEE Standard for Local and Metropolitan Area
                  Networks: Media Independent Handover Services, IEEE
                  802.21-2008", a contribution to IEEE 802.21 WG,
                  January 2009.





<span class="grey">Dutta, et al.                 Informational                    [Page 38]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-39" id="page-39" name="page-39"> </a>
<span class="grey"><a href="rfc6252.html">RFC 6252</a>                      MPA Framework                    June 2011</span>


   [<a id="ref-802.11" name="ref-802.11">802.11</a>]       "IEEE Wireless LAN Edition A compilation based on IEEE
                  Std 802.11-1999(R2003)", Institute of Electrical and
                  Electronics Engineers, September 2003.

   [<a id="ref-GPSIP" name="ref-GPSIP">GPSIP</a>]        Dutta, A., Madhani, S., Chen, W., Altintas, O., and H.
                  Schulzrinne, "GPS-IP based fast-handoff approaches for
                  Mobiles", IEEE Sarnoff Symposium 2006.

   [<a id="ref-MAGUIRE" name="ref-MAGUIRE">MAGUIRE</a>]      Vatn, J. and G. Maguire, "The effect of using
                  co-located care-of addresses on macro handover
                  latency", 14th Nordic Teletraffic Seminar 1998.

   [<a id="ref-MPA-MOBIKE" name="ref-MPA-MOBIKE">MPA-MOBIKE</a>]   El Mghazli, Y., Bournelle, J., and J. Laganier, "MPA
                  using IKEv2 and MOBIKE", Work in Progress, June 2006.

   [<a id="ref-MPA-WIRELESS" name="ref-MPA-WIRELESS">MPA-WIRELESS</a>] Dutta, A., Famolari, D., Das, S., Ohba, Y., Fajardo,
                  V., Taniuchi, K., Lopez, R., and H. Schulzrinne,
                  "Media- Independent Pre-authentication Supporting
                  Secure Interdomain Handover Optimization", IEEE
                  Wireless Communications Magazine, April 2008.































<span class="grey">Dutta, et al.                 Informational                    [Page 39]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-40" id="page-40" name="page-40"> </a>
<span class="grey"><a href="rfc6252.html">RFC 6252</a>                      MPA Framework                    June 2011</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/Appendix%20A.%20%20Proactive%20Duplicate%20Address%20Detection"></a><a class="selflink" href="#appendix-A" name="appendix-A">Appendix A</a>.  Proactive Duplicate Address Detection</span>

   When the DHCP server dispenses an IP address, it updates its lease
   table, so that this same address is not given to another client for
   that specific period of time.  At the same time, the client also
   keeps a lease table locally so that it can renew when needed.  In
   some cases where a network consists of both DHCP and non-DHCP-enabled
   clients, there is a probability that another client in the LAN may
   have been configured with an IP address from the DHCP address pool.
   In such a scenario, the server detects a duplicate address based on
   ARP (Address Resolution Protocol) or IPv6 Neighbor Discovery before
   assigning the IP address.  This detection procedure may take from 4
   sec to 15 sec [<a href="#ref-MAGUIRE" title='"The effect of using co-located care-of addresses on macro handover latency"'>MAGUIRE</a>] and will thus contribute to a larger handover
   delay.  In the case of a proactive IP address acquisition process,
   this detection is performed ahead of time and thus does not affect
   the handover delay at all.  By performing the Duplicate Address
   Detection (DAD) ahead of time, we reduce the IP address acquisition
   time.

   The proactive DAD over the candidate target network should be
   performed by the nAR on behalf of the mobile node at the time of
   proactive handover tunnel establishment, since DAD over a tunnel is
   not always performed.  For example, in the case of IPv6, DAD over an
   IP-IP tunnel interface is turned off in an existing implementation.
   In the case of IPv6 over PPP [<a href="rfc5172.html" title='"Negotiation for IPv6 Datagram Compression Using IPv6 Control Protocol"'>RFC5172</a>], the IP Control Protocol
   (IPCPv6) negotiates the link-local addresses, and hence DAD over the
   tunnel is not needed.  After the mobile node has moved to the target
   network, a DAD procedure may be started because of reassignment of
   the nCoA to the physical interface to the target network.  In that
   case, the mobile node should use optimistic DAD [<a href="rfc4429.html" title='"Optimistic Duplicate Address Detection (DAD) for IPv6"'>RFC4429</a>] over the
   physical interface so that the nCoA that was used inside the
   proactive handover tunnel before handover can be immediately used
   over that physical interface after handover.  The schemes used for
   the proactive DAD and optimistic DAD are applicable to both stateless
   and stateful address autoconfiguration schemes used for obtaining a
   nCoA.















<span class="grey">Dutta, et al.                 Informational                    [Page 40]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-41" id="page-41" name="page-41"> </a>
<span class="grey"><a href="rfc6252.html">RFC 6252</a>                      MPA Framework                    June 2011</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/Appendix%20B.%20%20Address%20Resolution"></a><a class="selflink" href="#appendix-B" name="appendix-B">Appendix B</a>.  Address Resolution</span>

   Address resolution involves updating the next access router's
   neighbor cache.  We briefly describe these two operations below.

   During the process of pre-configuration, the MAC address resolution
   mappings needed by the mobile node to communicate with nodes in the
   target network after attaching to the target network can also be
   known, where the communicating nodes may be the access router,
   authentication agent, configuration agent, or Correspondent Node.
   There are several possible ways of performing such proactive MAC
   address resolution.

   o  One can use an information service mechanism [<a href="#ref-802.21" title='"IEEE Standard for Local and Metropolitan Area Networks: Media Independent Handover Services, IEEE 802.21-2008"'>802.21</a>] to resolve
      the MAC addresses of the nodes.  This might require each node in
      the target network to be involved in the information service so
      that the server of the information service can construct the
      database for proactive MAC address resolution.

   o  One can extend the authentication protocol used for pre-
      authentication or the configuration protocol used for
      pre-configuration to support proactive MAC address resolution.
      For example, if PANA is used as the authentication protocol for
      pre-authentication, PANA messages may carry attribute-value pairs
      (AVPs) used for proactive address resolution.  In this case, the
      PANA authentication agent in the target network may perform
      address resolution on behalf of the mobile node.

   o  One can also make use of DNS to map the MAC address of the
      specific interface associated with a specific IP address of the
      network element in the target network.  One may define a new DNS
      resource record (RR) to proactively resolve the MAC addresses of
      the nodes in the target network.  But this approach may have its
      own limitations, since a MAC address is a resource that is bound
      to an IP address, and not directly to a domain name.

   When the mobile node attaches to the target network, it installs the
   proactively obtained address resolution mappings without necessarily
   performing address resolution queries for the nodes in the target
   network.

   On the other hand, the nodes that reside in the target network and
   that are communicating with the mobile node should also update their
   address resolution mappings for the mobile node as soon as the mobile
   node attaches to the target network.  The above proactive address
   resolution methods could also be used for those nodes to proactively
   resolve the MAC address of the mobile node before the mobile node
   attaches to the target network.  However, this is not useful, since



<span class="grey">Dutta, et al.                 Informational                    [Page 41]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-42" id="page-42" name="page-42"> </a>
<span class="grey"><a href="rfc6252.html">RFC 6252</a>                      MPA Framework                    June 2011</span>


   those nodes need to detect the attachment of the mobile node to the
   target network before adopting the proactively resolved address
   resolution mapping.  A better approach would be integration of
   attachment detection and address resolution mapping update.  This is
   based on gratuitously performing address resolution [<a href="rfc5944.html" title='"IP Mobility Support for IPv4, Revised"'>RFC5944</a>],
   [<a href="rfc3775.html" title='"Mobility Support in IPv6"'>RFC3775</a>] in which the mobile node sends an ARP Request or an ARP
   Reply in the case of IPv4, or a Neighbor Advertisement in the case of
   IPv6, immediately after the mobile node attaches to the new network,
   so that the nodes in the target network can quickly update the
   address resolution mapping for the mobile node.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/Appendix%20C.%20%20MPA%20Deployment%20Issues"></a><a class="selflink" href="#appendix-C" name="appendix-C">Appendix C</a>.  MPA Deployment Issues</span>

   In this section, we describe some of the deployment issues related to
   MPA.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/C.1.%20%20Considerations%20for%20Failed%20Switching%20and%20Switch-Back"></a><a class="selflink" href="#appendix-C.1" name="appendix-C.1">C.1</a>.  Considerations for Failed Switching and Switch-Back</span>

   The ping-pong effect is one of the common problems found during
   handover.  The ping-pong effect arises when a mobile node is located
   at the borderline of the cell or decision point and a handover
   procedure is frequently executed.  This results in higher call drop
   probability, lower connection quality, increased signaling traffic,
   and waste of resources.  All of these affect mobility optimization.
   Handoff algorithms are the deciding factors for performing the
   handoff between the networks.  Traditionally, these algorithms employ
   a threshold to compare the values of different metrics to decide on
   the handoff.  These metrics include signal strength, path loss,
   Carrier-to-Interference Ratio (CIR), Signal-to-Interference Ratio
   (SIR), Bit Error Rate (BER), and power budget.  In order to avoid the
   ping-pong effect, some additional parameters are employed by the
   decision algorithm, such as hysteresis margin, dwell timers, and
   averaging window.  For a vehicle moving at a high speed, other
   parameters, such as the distance between the mobile node and the
   point of attachment, velocity of the mobile node, location of the
   mobile node, traffic, and bandwidth characteristics are also taken
   into account to reduce the ping-pong effect.  More recently, there
   are other handoff algorithms available that help reduce the ping-pong
   effect in a heterogeneous network environment and that are based on
   techniques such as hypothesis testing, dynamic programming, and
   pattern recognition techniques.  While it is important to devise
   smart handoff algorithms to reduce the ping-pong effect, it is also
   important to devise methods to recover from this effect.

   In the case of the MPA framework, the ping-pong effect will result in
   the back-and-forth movement of the mobile node between the current
   network and target network, and between the candidate target
   networks.  MPA in its current form will be affected because of the



<span class="grey">Dutta, et al.                 Informational                    [Page 42]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-43" id="page-43" name="page-43"> </a>
<span class="grey"><a href="rfc6252.html">RFC 6252</a>                      MPA Framework                    June 2011</span>


   number of tunnels set up between the mobile node and neighboring
   access routers, the number of binding updates, and associated handoff
   latency resulting from the ping-pong situation.  The mobile node's
   handoff rate may also contribute to delay and packet loss.  We
   propose a few techniques that will help reduce the probability of the
   ping-pong effect and propose several methods for the MPA framework so
   that it can recover from the packet loss resulting from the ping-pong
   effect.

   The MPA framework can take advantage of the mobile node's geo-
   location with respect to APs in the neighboring networks using GPS.
   In order to avoid the oscillation between the networks, a location-
   aware algorithm can be derived by using a co-relation between the
   user's location and cached data from the previous handover attempts.
   In some cases, location may not be the only indicator for a handoff
   decision.  For example, in Manhattan-type grid networks, although a
   mobile node is close to an AP, it may not have enough SNR (Signal-to-
   Noise Ratio) to make a good connection.  Thus, knowledge of the
   mobility pattern, dwell time in a call, and path identification will
   help avoid the ping-pong problem to a great extent.

   In the absence of a good handoff algorithm that can avoid the ping-
   pong effect, it may be required to put in place a good recovery
   mechanism so as to mitigate the effect of ping-pong.  It may be
   necessary to keep the established context in the current network for
   a period of time, so that it can be quickly recovered when the mobile
   node comes back to the network where the context was last used.  This
   context may include security association, IP address used, and
   tunnels established.  Bicasting the data to both the previous network
   and the new network for a predefined period will also help the mobile
   node to take care of the lost packets in case the mobile node moves
   back and forth between the networks.  The mobile node can also take
   certain action, after it determines that it is in a stable state with
   respect to a ping-pong situation.

   When the MPA framework takes advantage of a combination of IKEv2 and
   MOBIKE, the ping-pong effect can be reduced further [<a href="#ref-MPA-MOBIKE" title='"MPA using IKEv2 and MOBIKE"'>MPA-MOBIKE</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/C.2.%20%20Authentication%20State%20Management"></a><a class="selflink" href="#appendix-C.2" name="appendix-C.2">C.2</a>.  Authentication State Management</span>

   In the case of pre-authentication with multiple target networks, it
   is useful to maintain the state in the authentication agent of each
   of the neighboring networks for a certain time period.  Thus, if the
   mobile node does move back and forth between neighboring networks,
   already-maintained authentication state can be helpful.  We provide
   some highlights on multiple security association state management
   below.




<span class="grey">Dutta, et al.                 Informational                    [Page 43]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-44" id="page-44" name="page-44"> </a>
<span class="grey"><a href="rfc6252.html">RFC 6252</a>                      MPA Framework                    June 2011</span>


   A mobile node that has pre-authenticated with an authentication agent
   in a candidate target network and has an MPA-SA may need to continue
   to keep the MPA-SA while it continues to stay in the current network
   or even after it makes a handover to a network that is different from
   the candidate target network.

   When an MN that has been authenticated and authorized by an
   authentication agent in the current network makes a handover to a
   target network, it may want to hold the SA that has been established
   between the MN and the authentication agent for a certain time period
   so that it does not have to go through the entire authentication
   signaling to create an SA from scratch, in case it returns to the
   previous network.  Such an SA being held at the authentication agent
   after the MN's handover to another network is considered as an
   MPA-SA.  In this case, the authentication agent should change the
   fully authorized state for the MN to an unauthorized state.  The
   unauthorized state can be changed to the fully authorized state only
   when the MN comes back to the network and provides proof of
   possession of a key associated with the MPA-SA.

   While an MPA-SA is being held at an authentication agent, the MN will
   need to keep updating the authentication agent when an IP address of
   the MN changes due to a handover, to re-establish the new SA.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/C.3.%20%20Pre-Allocation%20of%20QoS%20Resources"></a><a class="selflink" href="#appendix-C.3" name="appendix-C.3">C.3</a>.  Pre-Allocation of QoS Resources</span>

   In the pre-configuration phase, it is also possible to pre-allocate
   QoS resources that may be used by the mobile node not only after
   handover but also before handover.  When pre-allocated QoS resources
   are used before handover, they are used for application traffic
   carried over a proactive handover tunnel.

   It is possible that QoS resources are pre-allocated in an end-to-end
   fashion.  One method to achieve this proactive end-to-end QoS
   reservation is to execute the NSIS Signaling Layer Protocol (NSLP)
   [<a href="rfc5974.html" title='"NSIS Signaling Layer Protocol (NSLP) for Quality-of-Service Signaling"'>RFC5974</a>] or the Resource Reservation Protocol (RSVP) [<a href="rfc2205.html" title='"Resource ReSerVation Protocol (RSVP) -- Version 1 Functional Specification"'>RFC2205</a>] over
   a proactive handover tunnel where pre-authentication can be used for
   bootstrapping a security association for the proactive handover
   tunnel to protect the QoS signaling.  In this case, QoS resources are
   pre-allocated on the path between the Correspondent Node and a target
   access router and can be used continuously before and after handover.
   On the other hand, duplicate pre-allocation of QoS resources between
   the target access router and the mobile node is necessary when using
   pre-allocated QoS resources before handover, due to differences in







<span class="grey">Dutta, et al.                 Informational                    [Page 44]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-45" id="page-45" name="page-45"> </a>
<span class="grey"><a href="rfc6252.html">RFC 6252</a>                      MPA Framework                    June 2011</span>


   paths between the target access router and the mobile node before and
   after handover.  QoS resources to be used for the path between the
   target access router and the mobile node after handover may be
   pre-allocated by extending NSLP to work for off-path signaling (Note:
   this path can be viewed as off-path before handover) or by
   media-specific QoS signaling at layer 2.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/C.4.%20%20Resource%20Allocation%20Issue%20during%20Pre-Authentication"></a><a class="selflink" href="#appendix-C.4" name="appendix-C.4">C.4</a>.  Resource Allocation Issue during Pre-Authentication</span>

   In the case of multiple CTNs, establishing multiple tunnels with the
   neighboring target networks provides some additional benefits.  But
   it contributes to some resource utilization issues as well.  A
   pre-authentication process with multiple candidate target networks
   can happen in several ways.

   The very basic scheme involves authenticating the mobile node with
   the multiple authentication agents in the neighboring networks, but
   actual pre-configuration and binding update take place only after
   layer 2 movement to a specific network is complete.

   Similarly, in addition to pre-authentication, the mobile node can
   also complete the pre-configuration while in the previous network,
   but can postpone the binding update until after the mobile node has
   moved.  Like the previous case, in this case the mobile node also
   does not need to set up the pre-configured tunnels.  While the pre-
   authentication process and part of the pre-configuration process are
   taken care of before the mobile node has moved to the new network,
   the binding update is actually done after the mobile node has moved.

   The third type of multiple pre-authentication involves all the three
   steps while the mobile node is in the previous networks, such as
   authentication, configuration, and binding update.  But, this
   specific process utilizes the highest amount of resources.  Some of
   the resources that get used during this process are as follows:

   (1)  Additional signaling for pre-authentication in the neighboring
        networks

   (2)  Holding the IP address of the neighboring networks in the mobile
        node's cache for a certain amount of time.  Additional
        processing in the mobile node is needed for storing these IP
        addresses.  In addition, this caching of addresses also uses up
        the temporary IP addresses from the neighboring routers.

   (3)  There is an additional cost associated with setting up
        additional transient tunnels with the target routers in the
        neighboring networks and the mobile node.




<span class="grey">Dutta, et al.                 Informational                    [Page 45]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-46" id="page-46" name="page-46"> </a>
<span class="grey"><a href="rfc6252.html">RFC 6252</a>                      MPA Framework                    June 2011</span>


   (4)  In the case of a binding update with multiple IP addresses
        obtained from the neighboring networks, multiple transient
        streams flow between the CN and mobile node using these
        transient tunnels.

   However, there are pros and cons related to sending the binding
   update after the handover.  If the binding update is sent after the
   mobile node has moved to the new network, this will contribute to the
   delay if the CH or HA is far from the MN.  Multiple binding updates
   can be taken care of in many different ways.  We describe a few of
   these update mechanisms below.

   When only pre-authentication and pre-configuration are done ahead of
   time with multiple networks, the mobile node sends one binding update
   to the CN.  In this case, it is important to find out when to send
   the binding update after the layer 2 handoff.

   In case a binding update with multiple contact addresses is sent,
   multiple media streams stem out of the CN, using the transient
   tunnels.  But in that case, one needs to send another binding update
   after the handover, with the contact address set to the new address
   (only one address) where the mobile node has moved.  This way, the
   mobile node stops sending media to other neighboring networks where
   the mobile node did not move.

   The following is an illustration of this specific case that takes
   care of multiple binding streams, when the mobile node moves only to
   a specific network, but sends multiple binding updates in the
   previous network.  The MN sends a binding update to the CH with
   multiple contact addresses, such as c1, c2, and c3, that were
   obtained from three neighboring networks.  This allows the CN to send
   transient multiple streams to the mobile node over the pre-
   established tunnels.  After the mobile node moves to the actual
   network, it sends another binding update to the CN with the care-of
   address of the mobile node in the network where the mobile node has
   moved.  One issue with multiple streams is consumption of extra
   bandwidth for a small period of time.

   Alternatively, one can apply the buffering technique at the target
   access router or at the Home Agent.  Transient data can be forwarded
   to the mobile node after it has moved.  Forwarding of data can be
   triggered by the mobile node either as part of Mobile IP registration
   or as a separate buffering protocol.








<span class="grey">Dutta, et al.                 Informational                    [Page 46]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-47" id="page-47" name="page-47"> </a>
<span class="grey"><a href="rfc6252.html">RFC 6252</a>                      MPA Framework                    June 2011</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/C.5.%20%20Systems%20Evaluation%20and%20Performance%20Results"></a><a class="selflink" href="#appendix-C.5" name="appendix-C.5">C.5</a>.  Systems Evaluation and Performance Results</span>

   In this section, we present some of the results from MPA
   implementation when applied to different handover scenarios.  We
   present the summary of results from our experiments using MPA
   techniques for two types of handovers: i) intra-technology and
   intra-domain, and ii) inter-technology and inter-domain.  We also
   present the results of how the MPA can bootstrap layer 2 security for
   both roaming and non-roaming cases.  Detailed procedures and results
   are explained in [<a href="#ref-MOBIQUIT07" title='"Network-layer assisted mechanism to optimize authentication delay during handoff in 802.11 networks"'>MOBIQUIT07</a>] and [<a href="#ref-SPRINGER07" title='"Seamless proactive handover across heterogeneous access networks"'>SPRINGER07</a>].

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/C.5.1.%20%20Intra-Technology%2C%20Intra-Domain"></a><a class="selflink" href="#appendix-C.5.1" name="appendix-C.5.1">C.5.1</a>.  Intra-Technology, Intra-Domain</span>

   The results for MIPv6 and SIP mobility involving intra-domain
   mobility are shown in Figures 6 and 7, respectively.

                         Buffering    Buffering   Buffering   Buffering
                         (disabled)   (enabled)   (disabled)  (enabled)
                          &amp; RO         &amp; RO        &amp; RO        &amp; RO
                         (disabled)   (disabled)  (enabled)   (enabled)
    -------------------------------------------------------------------
    L2 handoff (ms)         4.00        4.33        4.00        4.00

    L3 handoff (ms)         1.00        1.00        1.00        1.00

    Avg. packet loss        1.33           0        0.66           0

    Avg. inter-packet      16.00       16.00       16.00       16.00
    arrival interval
        (ms)

    Avg. inter-packet       n/a        45.33        n/a        66.60
    arrival time during
      handover
        (ms)

    Avg. packet jitter      n/a        29.33        n/a        50.60
        (ms)

    Buffering Period        n/a        50.00        n/a        50.00
        (ms)

    Buffered Packets        n/a         2.00        n/a         3.00


   RO = Router Optimization

                  Figure 6: Mobile IPv6 with MPA Results



<span class="grey">Dutta, et al.                 Informational                    [Page 47]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-48" id="page-48" name="page-48"> </a>
<span class="grey"><a href="rfc6252.html">RFC 6252</a>                      MPA Framework                    June 2011</span>


                                      Buffering      Buffering
                                      disabled       enabled
               -----------------------------------------------
               L2 handoff (ms)           4.00          5.00

               L3 handoff (ms)           1.00          1.00

               Avg. packet loss          1.50             0

               Avg. inter-packet        16.00         16.00
               arrival interval
                   (ms)

               Avg. inter-packet         n/a          29.00
               arrival time during
                 handover
                   (ms)

               Avg. packet jitter        n/a          13.00
                   (ms)

               Buffering Period          n/a          20.00
                   (ms)

               Buffered Packets          n/a           3.00

                  Figure 7: SIP Mobility with MPA Results

   For all measurements, we did not experience any performance
   degradation during handover in terms of the audio quality of the
   voice traffic.

   With the use of buffering during handover, packet loss during the
   actual L2 and L3 handover is eliminated with appropriate and
   reasonable settings of the buffering period for both MIP6 and SIP
   mobility.  In the case of MIP6, there is not a significant difference
   in results with and without route optimization.  It should be noted
   that results with more samples would be necessary for a more detailed
   analysis.

   In the case of non-MPA-assisted handover, handover delay and
   associated packet loss occur from the moment the link-layer handover
   procedure begins, up to successful processing of the binding update.
   During this process, IP address acquisitions via DHCP incur the
   longest delay.  This is due to the detection of duplicate IP
   addresses in the network before the DHCP request completes.  The
   binding update exchange also experiences a long delay if the CN is
   too far from the MN.  As a result, the non-MPA-assisted handover took



<span class="grey">Dutta, et al.                 Informational                    [Page 48]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-49" id="page-49" name="page-49"> </a>
<span class="grey"><a href="rfc6252.html">RFC 6252</a>                      MPA Framework                    June 2011</span>


   an average of 4 seconds to complete, with an approximate packet loss
   of about 200 packets.  The measurement is based on the same traffic
   rate and traffic source as the MPA-assisted handover.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/C.5.2.%20%20Inter-Technology%2C%20Inter-Domain"></a><a class="selflink" href="#appendix-C.5.2" name="appendix-C.5.2">C.5.2</a>.  Inter-Technology, Inter-Domain</span>

   Handoff involving heterogeneous access can take place in many
   different ways.  We limit the experiment to two interfaces, and
   therefore results in several possible setup scenarios, depending upon
   the activity of the second interface.  In one scenario, the second
   interface comes up when the link to the first interface goes down.
   This is a reactive scenario and usually gives rise to undesirable
   packet loss and handoff delay.  In a second scenario, the second
   interface is being prepared while the mobile node still communicates
   using the old interface.  Preparation of the second interface should
   include setup of all the required state and security associations
   (e.g., PPP state, the Link Control Protocol (LCP), the Challenge
   Handshake Authentication Protocol (CHAP)).  If such a lengthy process
   is established ahead of time, it reduces the time taken for the
   secondary interface to be attached to the network.  After
   preparation, the mobile node decides to use the second interface as
   the active interface.  This results in less packet loss, as it uses
   make-before-break techniques.  This is a proactive scenario and can
   have two "flavors".  The first is where both interfaces are up; the
   second is when only the old interface is up and the prepared
   interface is brought up only when handoff is about to occur.  This
   scenario may be beneficial from a battery management standpoint.
   Devices that operate two interfaces simultaneously can rapidly
   deplete their batteries.  However, by activating the second interface
   only after an appropriate network has been selected, the client may
   utilize battery power effectively.

   As compared to non-optimized handover that may result in a delay of
   up to 18 sec and loss of 1000 or more packets during the handover
   from the wireless LAN (WLAN) to CDMA, we observed 0 packet loss and a
   50-ms handoff delay between the last pre-handoff packet and the first
   in-handoff packet.  This handoff delay includes the time due to link
   down detection and time needed to delete the tunnel after the mobile
   node has moved.  However, we observed about 10 duplicate packets
   because of the copy-and-forward mechanism at the access routers.  But
   these duplicate packets are usually handled easily by the upper-layer
   protocols.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/C.5.3.%20%20MPA-Assisted%20Layer%202%20Pre-Authentication"></a><a class="selflink" href="#appendix-C.5.3" name="appendix-C.5.3">C.5.3</a>.  MPA-Assisted Layer 2 Pre-Authentication</span>

   In this section, we discuss the results obtained from MPA-assisted
   layer 2 pre-authentication and compare these with EAP authentication
   and IEEE 802.11i's pre-authentication techniques.  Figure 8 shows the



<span class="grey">Dutta, et al.                 Informational                    [Page 49]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-50" id="page-50" name="page-50"> </a>
<span class="grey"><a href="rfc6252.html">RFC 6252</a>                      MPA Framework                    June 2011</span>


   experimental testbed where we have conducted the MPA-assisted
   pre-authentication experiment for bootstrapping layer 2 security as
   explained in <a href="#section-7">Section 7</a>.  By pre-authenticating and pre-configuring
   the link, the security association procedure during handoff reduces
   to a 4-way handshake only.  Then the MN moves to the AP and, after
   association, runs a 4-way handshake by using the PSKap (Pre-shared
   Key at AP) generated during PANA pre-authentication.  At this point,
   the handoff is complete.  Details of this experimental testbed can be
   found in [<a href="#ref-MOBIQUIT07" title='"Network-layer assisted mechanism to optimize authentication delay during handoff in 802.11 networks"'>MOBIQUIT07</a>].

   +----------------------------+-----------+ +-------------+----------+
   |                                        | |                        |
   |  Home Domain       +-------++          | |                        |
   |                    |        |          | |                        |
   |                    |AAAHome |          | |                        |
   |                    +        |          | |                        |
   |                    +-----+--+          | |                        |
   |                          |             | |  Network B             |
   |   Network A              |             | |                        |
   |                        /----\          | |            /---\       |
   |                       /nAR   \         | |           /     \      |
   |                      | PAA    |--------+-+----------+ pAR   |     |
   |                       \      /         | |           \     /      |
   |                        \----/          | |            \-+-/       |
   |                           |            | |              |         |
   |             +-------------------|      | |              |         |
   |             |       IEEE 802.11i|      | |              |         |
   |           +------+          +------+   | |          +---+--+      |
   |           |      |          |      |   | |          |      |      |
   |           |AP2   |          |AP1   |   | |          |AP0   |      |
   |           +------+          +------+   | |          +------+      |
   |           +------+            +-----+  | |           +-----+      |
   |           |      |            |     |  | |           |     |      |
   |           |MN    +-----------&gt;|MN   |&lt;+------------- |MN   |      |
   |           +------+            +-----+  | |           ++----+      |
   |----------------------------------------+ +------------+-----------+

              Figure 8: Experimental Testbed for MPA-Assisted
                    L2 Pre-Authentication (Non-Roaming)












<span class="grey">Dutta, et al.                 Informational                    [Page 50]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-51" id="page-51" name="page-51"> </a>
<span class="grey"><a href="rfc6252.html">RFC 6252</a>                      MPA Framework                    June 2011</span>


                        +-----------------------------+
                        |      +--------+             |
                        |      |        |             |
                        |      | AAAH   +             |
                        |      |        |             |
                        |      ++-------+             |
                        |       |                     |
                        |       |  Home AAA Domain    |
                        |       |                     |
                        +-------+---------------------+
                                |
                                |
                                |
                       RADIUS/  |
                       Diameter |
                                |
                                |
   +----------------------------+-----------+ +-------------+----------+
   |                            |           | |                        |
   | Roaming            +-------++          | |                        |
   | AAA Domain A       |        |          | |                        |
   |                    | AAAV   |          | |                        |
   |                    +        |          | |                        |
   | Network A          +-----+--+          | |  Network B             |
   |                          |             | |                        |
   |                          |             | |                        |
   |                        /----\          | |            /---\       |
   |                       /nAR   \         | |           /     \      |
   |                      | PAA    |--------+-+----------+ pAR   |     |
   |                       \      /         | |           \     /      |
   |                        \----/          | |            \-+-/       |
   |                           |            | |              |         |
   |             +-------------------|      | |              |         |
   |             |       IEEE 802.11i|      | |              |         |
   |           +------+          +------+   | |          +---+--+      |
   |           |      |          |      |   | |          |      |      |
   |           |AP2   |          |AP1   |   | |          |AP0   |      |
   |           +------+          +------+   | |          +------+      |
   |           +------+            +-----+  | |           +-----+      |
   |           |      |            |     |  | |           |     |      |
   |           |MN    +-----------&gt;|MN   |&lt;---------------| MN  |      |
   |           +------+            +-----+  | |           ++----+      |
   -----------------------------------------+ +------------+-----------+

              Figure 9: Experimental Testbed for MPA-Assisted
                      L2 Pre-Authentication (Roaming)





<span class="grey">Dutta, et al.                 Informational                    [Page 51]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-52" id="page-52" name="page-52"> </a>
<span class="grey"><a href="rfc6252.html">RFC 6252</a>                      MPA Framework                    June 2011</span>


   We have experimented with three types of movement scenarios involving
   both non-roaming and roaming cases, using the testbeds shown in
   Figures 8 and 9, respectively.  In the roaming case, the MN is
   visiting in a domain different than its home domain.  Consequently,
   the MN needs to contact the AAA server in the home domain (AAAH) from
   its new domain.  For the non-roaming case, we assume the MN is moving
   within its home domain, and only the local AAA server (AAAHome),
   which is the home AAA server for the mobile node, is contacted.

   The first scenario does not involve any pre-authentication.  The MN
   is initially connected to AP0 and moves to AP1.  Because neither
   network-layer authentication nor IEEE 802.11i pre-authentication is
   used, the MN needs to engage in a full EAP authentication with AP1 to
   gain access to the network after the move (post-authentication).
   This experiment shows the effect of the absence of any kind of
   pre-authentication.

   The second scenario involves 802.11i pre-authentication and involves
   movement between AP1 and AP2.  In this scenario, the MN is initially
   connected to AP2, and starts IEEE 802.11i pre-authentication with
   AP1.  This is an ideal scenario to compare the values obtained from
   802.11i pre-authentication with that of network-layer assisted
   pre-authentication.  Both scenarios use RADIUS as the AAA protocol
   (APs implement a RADIUS client).  The third scenario takes advantage
   of network-layer assisted link-layer pre-authentication.  It involves
   movement between two APs (e.g., between AP0 and AP1) that belong to
   two different subnets where 802.11i pre-authentication is not
   possible.  Here, Diameter is used as the AAA protocol (PAA implements
   a Diameter client).

   In the third movement scenario, the MN is initially connected to AP0.
   The MN starts PANA pre-authentication with the PAA, which is
   co-located on the AR in the new candidate target network (nAR in
   network A) from the current associated network (network B).  After
   authentication, the PAA proactively installs two keys, PSKap1 and
   PSKap2, in AP1 and AP2, respectively.  By doing the key installations
   proactively, the PAA preempts the process of communicating with the
   AAA server for the keys after the mobile node moves to the new
   network.  Finally, because PSKap1 is already installed, AP1
   immediately starts the 4-way handshake.  We have used measurement
   tools such as ethereal and kismet to analyze the measurements for the
   4-way handshake and PANA authentication.  These measurements reflect
   different operations involved during network-layer pre-
   authentication.

   In our experiment, as part of the discovery phase, we assume that the
   MN is able to retrieve the PAA's IP address and all required
   information about AP1 and AP2 (e.g., channel, security-related



<span class="grey">Dutta, et al.                 Informational                    [Page 52]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-53" id="page-53" name="page-53"> </a>
<span class="grey"><a href="rfc6252.html">RFC 6252</a>                      MPA Framework                    June 2011</span>


   parameters, etc.) at some point before the handover.  This avoids the
   scanning during link-layer handoff.  We have applied this assumption
   to all three scenarios.  Because our focus is on reducing the time
   spent on the authentication phase during handoff, we do not discuss
   the details of how we avoid the scanning.

   =====================================================================
   Types    |802.11i            | 802.11i           | MPA-assisted
            |Post-              | Pre-              | Layer 2
            |authentication     | authentication    | Pre-authentication
   =====================================================================
   Operation| Non-    | Roaming | Non-    | Roaming |Non-   | Roaming|
            | Roaming |         | Roaming |         |Roaming|        |
   ===================================================================
   Tauth    | 61 ms   |  599 ms | 99 ms   | 638 ms  | 177 ms| 831 ms |
   -------------------------------------------------------------------
   Tconf    | --      |  --     | --      | --      | 16 ms | 17ms   |
   -------------------------------------------------------------------
   Tassoc+  |         |         |         |         |       |        |
   4way     | 18 ms   |  17 ms  | 16 ms   | 17 ms   | 16 ms | 17 ms  |
   ------------------------------------------------------------------|
   Total    | 79 ms   |  616 ms | 115 ms  | 655 ms  | 208 ms| 865 ms |
   ------------------------------------------------------------------|
   Time     |         |         |         |         |       |        |
   affecting| 79 ms   |  616 ms | 16 ms   | 17 ms   | 15 ms | 17 ms  |
   handover |         |         |         |         |       |        |
   ------------------------------------------------------------------|

                Figure 10: Results of MPA-Assisted Layer 2
                       Pre- and Post-Authentication

   Figure 10 shows the timing (rounded off to the most significant
   number) associated with some of the handoff operations we have
   measured in the testbed.  We describe each of the timing parameters
   below.

   "Tauth" refers to the execution of EAP-Transport Layer Security (TLS)
   authentication.  This time does not distinguish whether this
   authentication was performed during pre-authentication or a typical
   post-authentication.

   "Tconf" refers to the time spent during PSK generation and
   installation after EAP authentication is complete.  When network-
   layer pre-authentication is not used, this time is not considered.

   "Tassoc+4way" refers to the time dedicated to the completion of the
   association and the 4-way handshake with the target AP after the
   handoff.



<span class="grey">Dutta, et al.                 Informational                    [Page 53]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-54" id="page-54" name="page-54"> </a>
<span class="grey"><a href="rfc6252.html">RFC 6252</a>                      MPA Framework                    June 2011</span>


   The first two columns in the figure show the results for non-roaming
   and roaming cases, respectively, when no pre-authentication is used
   at all.  The second two columns depict the same cases when IEEE
   802.11i pre-authentication is used.  The last two columns show when
   we used network-layer-assisted layer 2 pre-authentication.  When pre-
   authentication is used, only the factor Tassoc+4way affects the
   handoff time.  When no pre-authentication is used, the time affecting
   the handoff includes Tauth (the complete EAP-TLS authentication) plus
   Tassoc+4way.

   That is precisely the time affecting the handoff in the case where
   the MN moves from AP0 to AP1 in the absence of pre-authentication.
   As it is seen, these delays are not suitable for real-time
   applications.  Indeed, for the non-roaming case, we obtained a ~80-ms
   delay for re-establishing the connection with target AP1.  It takes
   about 600 ms to complete the handoff when the MN moves to a visited
   domain and the home AAA server is located far away.  However,
   network-layer pre-authentication is only affected by Tassoc+4way
   (~17 ms) involving any kind of handoff authentication.  As is
   evident, IEEE 802.11i pre-authentication provides a comparable
   benefit (~16 ms) in terms of handoff but is limited to cases when APs
   are in the same Distribution System (DS).  Additionally, network-
   layer pre-authentication leverages a single EAP authentication to
   bootstrap security in several target APs by allowing the MN to move
   among APs under the same PAA without running EAP and consequently
   without contacting the AAA server.  In this sense, it extends IEEE
   802.11r advantages over IEEE 802.11i by allowing inter-subnet and
   inter-domain and even inter-technology handoffs.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/C.6.%20%20Guidelines%20for%20Handover%20Preparation"></a><a class="selflink" href="#appendix-C.6" name="appendix-C.6">C.6</a>.  Guidelines for Handover Preparation</span>

   In this section, we provide some guidelines for the roaming clients
   that use pre-authentication mechanisms to reduce the handoff delay.
   These guidelines can help determine the extent of the
   pre-authentication operation that is needed based on a specific type
   of movement of the client.  IEEE 802.11i and 802.11r take advantage
   of the pre-authentication mechanism at layer 2.  Thus, many of the
   guidelines observed for 802.11i-based pre-authentication and 802.11r-
   based fast roaming could also be applicable to the clients that use
   MPA-based pre-authentication techniques.  However, since MPA
   operations are not limited to a specific subnet and involve inter-
   subnet and inter-domain handover, the guidelines need to take into
   account other factors, such as movement pattern of the mobile node,
   cell size, etc.







<span class="grey">Dutta, et al.                 Informational                    [Page 54]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-55" id="page-55" name="page-55"> </a>
<span class="grey"><a href="rfc6252.html">RFC 6252</a>                      MPA Framework                    June 2011</span>


   The time needed to complete the pre-authentication mechanism is an
   important parameter, since the mobile node needs to determine how
   much ahead of time the mobile node needs to start the
   pre-authentication process so that it can finish the desired
   operations before the handover to the target network starts.  The
   pre-authentication time will vary, depending upon the speed of the
   mobile node (e.g., pedestrian vs. vehicular) and cell sizes (e.g.,
   WiFi, Cellular).  Cell residence time is defined as the average time
   the mobile node stays in the cell before the next handoff takes
   place.  Cell residence time is dependent upon the coverage area and
   velocity of the mobile node.  Thus, cell residence time is an
   important factor in determining the desirable pre-authentication time
   that a mobile node should consider.

   Since the pre-authentication operation involves six steps as
   described in <a href="#section-6.3">Section 6.3</a> and each step takes some discrete amount of
   time, only part of these sub-operations may be completed before
   handoff, depending upon the available delay budget.

   For example, a mobile node could complete only network discovery and
   the network-layer authentication process before the handoff and
   postpone the rest of the operations until after the handover is
   complete.  On the other hand, if it is a slow-moving vehicle and the
   adjacent cells are sparsely spaced, a mobile node could complete all
   the desired MPA-related operations.  Finishing all the MPA-related
   operations ahead of time reduces the handoff delay but adds other
   constraints, such as cell residence time.

   We give a numerical example here, similar to [<a href="#ref-MISHRA04" title='"Proactive key distribution using neighbor graphs"'>MISHRA04</a>].

      D = Coverage diameter

      v = Mobile node's velocity

      RTT = round trip time from AP to AAA server, including processing
      time for authentication (Tauth)

      Tpsk = Time spent to install keys proactively on the target APs

   If for a given value of D = 100 ft, Tpsk = 10 ms, and RTT = 100 ms, a
   mobile node needs to execute only the pre-authentication procedure
   associated with MPA, then the following can be calculated for a
   successful MPA procedure before the handoff is complete.

      2RTT + Tpsk &lt; D/v

      v = 100 ft/(200 ms + 10 ms) = ~500 ft/sec




<span class="grey">Dutta, et al.                 Informational                    [Page 55]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-56" id="page-56" name="page-56"> </a>
<span class="grey"><a href="rfc6252.html">RFC 6252</a>                      MPA Framework                    June 2011</span>


   Similarly, for a similar cell size, if the mobile node is involved in
   both pre-authentication and pre-configuration operations as part of
   the MPA procedure, and it takes an amount of time Tconf = 190 ms to
   complete the layer 3 configuration including IP address
   configuration, then for a successful MPA operation,

      2RTT + Tpsk + Tconf &lt; D/v

      v = 100 ft/(200 ms + 10 ms + 190 ms) = ~250 ft/sec

   Thus, compared to only the pre-authentication part of the MPA
   operation, in order to be able to complete both pre-authentication
   and pre-configuration operations successfully, either the mobile node
   needs to move at a slower pace or it needs to expedite these
   operations for this given cell size.  Thus, types of MPA operations
   will be constrained by the velocity of the mobile node.

   As an alternative, if a mobile node does complete all of the
   pre-authentication procedure well ahead of time, it uses up the
   resources accordingly by way of an extra IP address, tunnel, and
   extra bandwidth.  Thus, there is always a tradeoff between the
   performance benefit obtained from the pre-authentication mechanism
   and network characteristics, such as movement speed, cell size, and
   resources utilized.



























<span class="grey">Dutta, et al.                 Informational                    [Page 56]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-57" id="page-57" name="page-57"> </a>
<span class="grey"><a href="rfc6252.html">RFC 6252</a>                      MPA Framework                    June 2011</span>


Authors' Addresses

   Ashutosh Dutta (editor)
   NIKSUN
   100 Nassau Park Blvd.
   Princeton, NJ  08540
   USA

   EMail: ashutosh.dutta@ieee.org


   Victor Fajardo
   NIKSUN
   100 Nassau Park Blvd.
   Princeton, NJ  08540
   USA

   EMail: vf0213@gmail.com


   Yoshihiro Ohba
   Corporate R&amp;D Center, Toshiba Corporation
   1 Komukai-Toshiba-cho, Saiwai-ku
   Kawasaki, Kanagawa  212-0001
   Japan

   EMail: yoshihiro.ohba@toshiba.co.jp


   Kenichi Taniuchi
   Toshiba Corporation
   2-9 Suehiro-cho
   Ome, Tokyo  198-8710
   Japan

   EMail: kenichi.taniuchi@toshiba.co.jp


   Henning Schulzrinne
   Columbia University
   Department of Computer Science
   450 Computer Science Building
   New York, NY  10027
   USA

   Phone: +1 212 939 7004
   EMail: hgs@cs.columbia.edu




Dutta, et al.                 Informational                    [Page 57]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc6252 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:30 GMT --></html>