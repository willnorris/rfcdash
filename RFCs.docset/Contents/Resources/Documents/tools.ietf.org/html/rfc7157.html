<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc7157 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:23 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="draft-v6ops-multihoming-without-ipv6nat" name="DC.Relation.Replaces"/>
<meta content="urn:ietf:rfc:7157" name="DC.Identifier"/>
<meta content="March, 2014" name="DC.Date.Issued"/>
<meta content="Miles, David" name="DC.Creator"/>
<meta content="Wing, Dan" name="DC.Creator"/>
<meta content="Matsushima, Satoru" name="DC.Creator"/>
<meta content="Okimoto, Tadahisa" name="DC.Creator"/>
<meta content="Troan, Ole" name="DC.Creator"/>
<meta content="Network Address and Port Translation (NAPT) works well for conserving
global addresses and addressing multihoming requirements because an
IPv4 NAPT router implements three functions: source address selection,
next-hop resolution, and (optionally) DNS resolution. For IPv6 hosts,
one approach could be the use of IPv6-to-IPv6 Network Prefix
Translation (NPTv6). However, NAT and NPTv6 should be avoided, if at
all possible, to permit transparent end-to-end connectivity. In this
document, we analyze the use cases of multihoming. We also describe
functional requirements and possible solutions for multihoming without
the use of NAT in IPv6 for hosts and small IPv6 networks that would
otherwise be unable to meet minimum IPv6-allocation criteria. We
conclude that DHCPv6-based solutions are suitable to solve the
multihoming issues described in this document, but NPTv6 may be
required as an intermediate solution." name="DC.Description.Abstract"/>
<meta content="IPv6 Multihoming without Network Address Translation" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 7157 - IPv6 Multihoming without Network Address Translation</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgorange" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc7157.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc7157" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-v6ops-ipv6-multihoming-without-ipv6nat" title="draft-ietf-v6ops-ipv6-multihoming-without-ipv6nat">draft-ietf-v6op...</a>] [<a href="https://datatracker.ietf.org/doc/rfc7157" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc7157" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc7157" title="Side-by-side diff">Diff2</a>]         </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                           INFORMATIONAL</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Internet Engineering Task Force (IETF)                     O. Troan, Ed.
Request for Comments: 7157                                         Cisco
Category: Informational                                         D. Miles
ISSN: 2070-1721                                             Google Fiber
                                                           S. Matsushima
                                                        Softbank Telecom
                                                              T. Okimoto
                                                                NTT West
                                                                 D. Wing
                                                                   Cisco
                                                              March 2014


          <span class="h1">IPv6 Multihoming without Network Address Translation</span>

Abstract

   Network Address and Port Translation (NAPT) works well for conserving
   global addresses and addressing multihoming requirements because an
   IPv4 NAPT router implements three functions: source address
   selection, next-hop resolution, and (optionally) DNS resolution.  For
   IPv6 hosts, one approach could be the use of IPv6-to-IPv6 Network
   Prefix Translation (NPTv6).  However, NAT and NPTv6 should be
   avoided, if at all possible, to permit transparent end-to-end
   connectivity.  In this document, we analyze the use cases of
   multihoming.  We also describe functional requirements and possible
   solutions for multihoming without the use of NAT in IPv6 for hosts
   and small IPv6 networks that would otherwise be unable to meet
   minimum IPv6-allocation criteria.  We conclude that DHCPv6-based
   solutions are suitable to solve the multihoming issues described in
   this document, but NPTv6 may be required as an intermediate solution.

Status of This Memo

   This document is not an Internet Standards Track specification; it is
   published for informational purposes.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Not all documents
   approved by the IESG are a candidate for any level of Internet
   Standard; see <a href="rfc5741.html#section-2">Section 2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc7157">http://www.rfc-editor.org/info/rfc7157</a>.




<span class="grey">Troan, et al.                 Informational                     [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc7157.html">RFC 7157</a>              IPv6 Multihoming without NAT            March 2014</span>


Copyright Notice

   Copyright (c) 2014 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   <a href="#section-1">1</a>.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-3">3</a>
   <a href="#section-2">2</a>.  Terminology . . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-5">5</a>
   <a href="#section-3">3</a>.  IPv6 Multihomed Network Scenarios . . . . . . . . . . . . . .   <a href="#page-6">6</a>
     3.1.  Classification of Network Scenarios for Multihomed Host .   6
     <a href="#section-3.2">3.2</a>.  Multihomed Network Environment  . . . . . . . . . . . . .   <a href="#page-8">8</a>
     <a href="#section-3.3">3.3</a>.  Problem Statement . . . . . . . . . . . . . . . . . . . .   <a href="#page-9">9</a>
   <a href="#section-4">4</a>.  Requirements  . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-11">11</a>
     <a href="#section-4.1">4.1</a>.  End-to-End Transparency . . . . . . . . . . . . . . . . .  <a href="#page-11">11</a>
     <a href="#section-4.2">4.2</a>.  Scalability . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-11">11</a>
   <a href="#section-5">5</a>.  Problem Analysis  . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-11">11</a>
     <a href="#section-5.1">5.1</a>.  Source Address Selection  . . . . . . . . . . . . . . . .  <a href="#page-11">11</a>
     <a href="#section-5.2">5.2</a>.  Next Hop Selection  . . . . . . . . . . . . . . . . . . .  <a href="#page-12">12</a>
     <a href="#section-5.3">5.3</a>.  DNS Recursive Name Server Selection . . . . . . . . . . .  <a href="#page-13">13</a>
   <a href="#section-6">6</a>.  Implementation Approach . . . . . . . . . . . . . . . . . . .  <a href="#page-13">13</a>
     <a href="#section-6.1">6.1</a>.  Source Address Selection  . . . . . . . . . . . . . . . .  <a href="#page-14">14</a>
     <a href="#section-6.2">6.2</a>.  Next Hop Selection  . . . . . . . . . . . . . . . . . . .  <a href="#page-14">14</a>
     <a href="#section-6.3">6.3</a>.  DNS Recursive Name Server Selection . . . . . . . . . . .  <a href="#page-15">15</a>
     <a href="#section-6.4">6.4</a>.  Other Algorithms Available in RFCs  . . . . . . . . . . .  <a href="#page-16">16</a>
   <a href="#section-7">7</a>.  Considerations for MHMP Deployment  . . . . . . . . . . . . .  <a href="#page-16">16</a>
     <a href="#section-7.1">7.1</a>.  Non-MHMP Host Consideration . . . . . . . . . . . . . . .  <a href="#page-16">16</a>
     <a href="#section-7.2">7.2</a>.  Coexistence Considerations  . . . . . . . . . . . . . . .  <a href="#page-17">17</a>
     <a href="#section-7.3">7.3</a>.  Policy Collision Consideration  . . . . . . . . . . . . .  <a href="#page-17">17</a>
   <a href="#section-8">8</a>.  Security Considerations . . . . . . . . . . . . . . . . . . .  <a href="#page-18">18</a>
   <a href="#section-9">9</a>.  Contributors  . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-19">19</a>
   <a href="#section-10">10</a>. References  . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-20">20</a>
     <a href="#section-10.1">10.1</a>.  Normative References . . . . . . . . . . . . . . . . . .  <a href="#page-20">20</a>
     <a href="#section-10.2">10.2</a>.  Informative References . . . . . . . . . . . . . . . . .  <a href="#page-20">20</a>







<span class="grey">Troan, et al.                 Informational                     [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc7157.html">RFC 7157</a>              IPv6 Multihoming without NAT            March 2014</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   In this document, we analyze the use cases of multihoming, describe
   functional requirements, and describe the problems with IPv6
   multihoming.  There are two ways to avoid the problems of IPv6
   multihoming:

   1.  using IPv6-to-IPv6 network prefix translation (NPTv6) [<a href="rfc6296.html" title='"IPv6-to-IPv6 Network Prefix Translation"'>RFC6296</a>],
       or;

   2.  refining IPv6 specifications to resolve the problems with IPv6
       multihoming.

   This document concerns itself with the latter and explores the
   solution space.  We hope this will encourage the development of
   solutions to the problem so that, in the long run, NPTv6 can be
   avoided.

   IPv6 provides enough globally unique addresses to permit every
   conceivable host on the Internet to be uniquely addressed without the
   requirement for Network Address Port Translation (NAPT) [<a href="rfc3022.html" title='"Traditional IP Network Address Translator (Traditional NAT)"'>RFC3022</a>],
   offering a renaissance in end-to-end transparent connectivity.

   Unfortunately, this may not be possible in every case, due to the
   possible necessity of NAT even in IPv6, because of multihoming.
   Though there are mechanisms to implement multihoming, such as BGP
   multihoming [<a href="rfc4116.html" title='"IPv4 Multihoming Practices and Limitations"'>RFC4116</a>] at the network level and multihoming based on
   the Stream Control Transmission Protocol (SCTP) [<a href="rfc4960.html" title='"Stream Control Transmission Protocol"'>RFC4960</a>] in the
   transport layer, there is no mechanism in IPv6 that serves as a
   replacement for NAT-based multihoming in IPv4.  In IPv4, for a host
   or a small network, NAT-based multihoming is easily deployable and is
   an already-deployed technique.

   Whenever a host or small network (that does not meet minimum IPv6
   allocation criteria) is connected to multiple upstream networks, an
   IPv6 address is assigned by each respective service provider
   resulting in hosts with multiple global scope IPv6 addresses with
   different prefixes.  As each service provider is allocated a
   different address space from its Internet Registry, it, in turn,
   assigns a different address space to the end-user network or host.
   For example, a remote access user's host or router may use a VPN to
   simultaneously connect to a remote network and retain a default route
   to the Internet for other purposes.








<span class="grey">Troan, et al.                 Informational                     [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc7157.html">RFC 7157</a>              IPv6 Multihoming without NAT            March 2014</span>


   In IPv4, a common solution to the multihoming problem is to employ
   NAPT on a border router and use private address space for individual
   host addressing.  The use of NAPT allows hosts to have exactly one IP
   address visible on the public network, and the combination of NAPT
   with provider-specific outside addresses (one for each uplink) and
   destination-based routing insulates a host from the impacts of
   multiple upstream networks.  The border router may also implement a
   DNS cache or DNS policy to resolve address queries from hosts.

   It is our goal to avoid the IPv6 equivalent of NAT.  So, the goals
   for IPv6 multihoming defined in [<a href="rfc3582.html" title='"Goals for IPv6 Site- Multihoming Architectures"'>RFC3582</a>] do not match the goals of
   this document.  Also, regardless of what the NPTv6 specification is,
   we are trying to avoid any form of network address translation
   technique that may not be visible to either of the end hosts.  To
   reach this goal, several mechanisms are needed for end-user hosts to
   have multiple address assignments and resolve issues such as which
   address to use for sourcing traffic to which destination:

   o  If multiple routers exist on a single link, the host must select
      the appropriate next hop for each connected network.  Each router
      is in turn connected to a different service provider network,
      which provides independent address assignment.  Routing protocols
      that would normally be employed for router-to-router network
      advertisement seem inappropriate for use by individual hosts.

   o  Source address selection becomes difficult whenever a host has
      more than one address of the same address scope.  Current address
      selection criteria may result in hosts using an arbitrary or
      random address when sourcing upstream traffic.  Unfortunately, for
      the host, the appropriate source address is a function of the
      upstream network for which the packet is bound.  If an upstream
      service provider uses IP anti-spoofing or ingress filtering, it is
      conceivable that the packets that have an inappropriate source
      address for the upstream network would never reach their
      destination.

   o  In a multihomed environment, different DNS scopes or partitions
      may exist in each independent upstream network.  A DNS query sent
      to an arbitrary upstream DNS recursive name server may result in
      incorrect or poisoned responses.

   In short, while IPv6 facilitates hosts having more than one address
   in the same address scope, the application of this causes significant
   issues for a host from routing, source address selection, and DNS
   resolution perspectives.  A possible consequence of assigning a host
   multiple identically scoped addresses is severely impaired IP
   connectivity.




<span class="grey">Troan, et al.                 Informational                     [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc7157.html">RFC 7157</a>              IPv6 Multihoming without NAT            March 2014</span>


   If a host connects to a network behind an IPv4 NAPT, the host has one
   private address in the local network.  There is no confusion.  The
   NAT becomes the gateway of the host and forwards the packet to an
   appropriate network when it is multihomed.  It also operates a DNS
   cache server or DNS proxy, which receives all DNS inquires, and gives
   a correct answer to the host.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Terminology"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Terminology</span>

   NPTv6       IPv6-to-IPv6 Network Prefix Translation as described in
               [<a href="rfc6296.html" title='"IPv6-to-IPv6 Network Prefix Translation"'>RFC6296</a>].

   NAPT        Network Address Port Translation as described in
               [<a href="rfc3022.html" title='"Traditional IP Network Address Translator (Traditional NAT)"'>RFC3022</a>].  In other contexts, NAPT is often pronounced
               "NAT" or written as "NAT".

   MHMP        Multihomed with multi-prefix.  A host implementation that
               supports the mechanisms described in this document;
               namely, source address selection policy, next hop
               selection, and DNS selection policy.































<span class="grey">Troan, et al.                 Informational                     [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc7157.html">RFC 7157</a>              IPv6 Multihoming without NAT            March 2014</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20IPv6%20Multihomed%20Network%20Scenarios"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  IPv6 Multihomed Network Scenarios</span>

   In this section, we classify three scenarios of the multihoming
   environment.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.1.%20%20Classification%20of%20Network%20Scenarios%20for%20Multihomed%20Host"></a><a class="selflink" href="#section-3.1" name="section-3.1">3.1</a>.  Classification of Network Scenarios for Multihomed Host</span>

   Scenario 1:

   In this scenario, two or more routers are present on a single link
   shared with the host(s).  Each router is, in turn, connected to a
   different service provider network, which provides independent
   address assignment and DNS recursive name servers.  A host in this
   environment would be offered multiple prefixes and DNS recursive name
   servers advertised from the two different routers.

                                +------+       ___________
                                |      |      /           \
                            +---| rtr1 |=====/   network   \
                            |   |      |     \      1      /
               +------+     |   +------+      \___________/
               |      |     |
               | hosts|-----+
               |      |     |
               +------+     |   +------+       ___________
                            |   |      |      /           \
                            +---| rtr2 |=====/   network   \
                                |      |     \      2      /
                                +------+      \___________/

        Figure 1: Single Uplink, Multiple Next Hop, Multiple Prefix
                               (Scenario 1)

   Figure 1 illustrates the host connecting to rtr1 and rtr2 via a
   shared link.  Networks 1 and 2 are reachable via rtr1 and rtr2,
   respectively.  When the host sends packets to network 1, the next hop
   to network 1 is rtr1.  Similarly, rtr2 is the next hop to network 2.

   Example: multiple broadband service providers (Internet, VoIP, IPTV,
   etc.)











<span class="grey">Troan, et al.                 Informational                     [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc7157.html">RFC 7157</a>              IPv6 Multihoming without NAT            March 2014</span>


   Scenario 2:

   In this scenario, a single gateway router connects the host to two or
   more upstream service provider networks.  This gateway router would
   receive prefix delegations and a different set of DNS recursive name
   servers from each independent service provider network.  The gateway,
   in turn, advertises the provider prefixes to the host, and for DNS,
   may either act as a lightweight DNS cache server or advertise the
   complete set of service provider DNS recursive name servers to the
   hosts.

                                     +------+       ___________
                       +-----+       |      |      /           \
                       |     |=======| rtr1 |=====/   network   \
                       |     |port1  |      |     \      1      /
          +------+     |     |       +------+      \___________/
          |      |     |     |
          | hosts|-----| GW  |
          |      |     | rtr |
          +------+     |     |       +------+       ___________
                       |     |port2  |      |      /           \
                       |     |-------| rtr2 |=====/   network   \
                       +-----+       |      |     \      2      /
                                     +------+      \___________/

         Figure 2: Single Uplink, Single Next Hop, Multiple Prefix
                               (Scenario 2)

   Figure 2 illustrates the host connected to GW rtr.  GW rtr connects
   to networks 1 and 2 via port1 and 2, respectively.  As the figure
   shows a logical topology of the scenario, port1 could be a pseudo-
   interface for tunneling, which connects to network 1 through network
   2 and vice versa.  When the host sends packets to either network 1 or
   2, the next hop is GW rtr.  When the packets are sent to network 1
   (network 2), GW rtr forwards the packets to port1 (port2).

   Example: Internet + VPN / Application Service Provider (ASP)














<span class="grey">Troan, et al.                 Informational                     [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc7157.html">RFC 7157</a>              IPv6 Multihoming without NAT            March 2014</span>


   Scenario 3:

   In this scenario, a host has more than one active interface that
   connects to different routers and service provider networks.  Each
   router provides the host with a different address prefix and set of
   DNS recursive name servers, resulting in a host with a unique address
   per link/interface.

   +------+     +------+       ___________
   |      |     |      |      /           \
   |      |-----| rtr1 |=====/   network   \
   |      |     |      |     \      1      /
   |      |     +------+      \___________/
   |      |
   | host |
   |      |
   |      |     +------+       ___________
   |      |     |      |      /           \
   |      |=====| rtr2 |=====/   network   \
   |      |     |      |     \      2      /
   +------+     +------+      \___________/

       Figure 3: Multiple Uplink, Multiple Next Hop, Multiple Prefix
                               (Scenario 3)

   Figure 3 illustrates the host connecting to rtr1 and rtr2 via a
   direct connection or a virtual link.  When the host sends packets to
   network 1, the next hop to network 1 is rtr1.  Similarly, rtr2 is the
   next hop to network 2.

   Example: Mobile Wifi + 3G, ISP A + ISP B

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.2.%20%20Multihomed%20Network%20Environment"></a><a class="selflink" href="#section-3.2" name="section-3.2">3.2</a>.  Multihomed Network Environment</span>

   In an IPv6 multihomed network, a host is assigned two or more IPv6
   addresses and DNS recursive name servers from independent service
   provider networks.  When this multihomed host attempts to connect
   with other hosts, it may incorrectly resolve the next-hop router, use
   an inappropriate source address, or use a DNS response from an
   incorrect service provider that may result in impaired IP
   connectivity.

   In many cases, multihomed networks in IPv4 have been implemented
   through the use of a gateway router with NAPT function (scenario 2
   with NAPT).  An analysis of the current IPv4 NAPT and DNS functions
   within the gateway router should provide a baseline set of





<span class="grey">Troan, et al.                 Informational                     [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc7157.html">RFC 7157</a>              IPv6 Multihoming without NAT            March 2014</span>


   requirements for IPv6 multihomed environments.  A destination prefix/
   route is often used on the gateway router to separate traffic between
   the networks.

                                     +------+       ___________
                                     |      |      /           \
                                 +---| rtr1 |=====/   network   \
                                 |   |      |     \      1      /
          +------+     +-----+   |   +------+      \___________/
          | IPv4 |     |     |   |
          | hosts|-----| GW  |---+
          |      |     | rtr |   |
          +------+     +-----+   |   +------+       ___________
                      (NAPT&amp;DNS) |   |      |      /           \
          (private               +---| rtr2 |=====/   network   \
              address                |      |     \      2      /
                 space)              +------+      \___________/

                Figure 4: IPv4 Multihomed Environment with
                      Gateway Router Performing NAPT

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.3.%20%20Problem%20Statement"></a><a class="selflink" href="#section-3.3" name="section-3.3">3.3</a>.  Problem Statement</span>

   A multihomed IPv6 host has one or more assigned IPv6 addresses and
   DNS recursive name servers from each upstream service provider,
   resulting in the host having multiple valid IPv6 addresses and DNS
   recursive name servers.  The host must be able to resolve the
   appropriate next hop, the correct source address, and the correct DNS
   recursive name server to use based on the destination prefix.  To
   prevent IP spoofing, operators will often implement ingress filtering
   to discard traffic with an inappropriate source address, making it
   essential for the host to correctly resolve these three items before
   sourcing the first packet.

   IPv6 has mechanisms for the provision of multiple routers on a single
   link and multiple address assignments to a single host.  However,
   when these mechanisms are applied to the three scenarios described in
   <a href="#section-3.1">Section 3.1</a>, a number of connectivity issues are identified:

   Scenario 1:

   The host has been assigned an address from each router and recognizes
   both rtr1 and rtr2 as valid default routers (in the default routers
   list).







<span class="grey">Troan, et al.                 Informational                     [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc7157.html">RFC 7157</a>              IPv6 Multihoming without NAT            March 2014</span>


   o  The source address selection policy on the host does not
      deterministically resolve a source address.  Ingress filtering or
      filter policies will discard traffic with source addresses that
      the operator did not assign.

   o  The host will select one of the two routers as the active default
      router.  No traffic is sent to the other router.

   Scenario 2:

   The host has been assigned two different addresses from the single
   gateway router.  The gateway router is the only default router on the
   link.

   o  The source address selection policy on the host does not
      deterministically resolve a source address.  Ingress filtering or
      filter policies will discard traffic with source addresses that
      the operator did not assign.

   o  The gateway router does not have an autonomous mechanism for
      determining which traffic should be sent to which network.  If the
      gateway router is implementing host functions (i.e., processing
      Router Advertisement (RA)), then two valid default routers may be
      recognized.

   Scenario 3:

   A host has two separate interfaces, and each interface has a
   different address assigned.  Each link has its own router.

   o  The host does not have enough information to determine which
      traffic should be sent to which upstream routers.  The host will
      select one of the two routers as the active default router, and no
      traffic is sent to the other router.  The default address
      selection rules select the address assigned to the outgoing
      interface as the source address.  So, if a host has an appropriate
      routing table, an appropriate source address will be selected.

   All scenarios:

   o  In network deployments utilizing local namespaces, the host may
      choose to communicate with a "wrong" DNS recursive server unable
      to serve a local namespace.








<span class="grey">Troan, et al.                 Informational                    [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc7157.html">RFC 7157</a>              IPv6 Multihoming without NAT            March 2014</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Requirements"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Requirements</span>

   This section describes requirements that any solution multi-address
   and multi-uplink architectures need to meet.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.1.%20%20End-to-End%20Transparency"></a><a class="selflink" href="#section-4.1" name="section-4.1">4.1</a>.  End-to-End Transparency</span>

   One of the major design goals for IPv6 is to restore the end-to-end
   transparency of the Internet.  If NAT is applied to IP communication
   between hosts, NAT traversal mechanisms are required to establish
   bidirectional IP communication.  In an environment with end-to-end
   transparency, a NAT traversal mechanism does not need to be
   implemented in an application (e.g., ICE [<a href="rfc5245.html" title='"Interactive Connectivity Establishment (ICE): A Protocol for Network Address Translator (NAT) Traversal for Offer/Answer Protocols"'>RFC5245</a>]).  Therefore, the
   IPv6 multihoming solution should strive to avoid NPTv6 to achieve
   end-to-end transparency.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.2.%20%20Scalability"></a><a class="selflink" href="#section-4.2" name="section-4.2">4.2</a>.  Scalability</span>

   The solution will have to be able to manage a large number of sites/
   nodes.  In services for residential users, provider edge devices have
   to manage thousands of sites.  In such environments, sending packets
   periodically to each site may affect edge system performance.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Problem%20Analysis"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Problem Analysis</span>

   The problems described in <a href="#section-3">Section 3</a> can be classified into these
   three types:

   o  Wrong source address selection

   o  Wrong next hop selection

   o  Wrong DNS server selection

   This section reviews the problem statements presented above and the
   proposed functional requirements to resolve the issues.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.1.%20%20Source%20Address%20Selection"></a><a class="selflink" href="#section-5.1" name="section-5.1">5.1</a>.  Source Address Selection</span>

   A multihomed IPv6 host will typically have different addresses
   assigned from each service provider on either the same link
   (scenarios 1 and 2) or different links (scenario 3).  When the host
   wishes to send a packet to any given destination, the current source
   address selection rules [<a href="rfc6724.html" title='"Default Address Selection for Internet Protocol Version 6 (IPv6)"'>RFC6724</a>] may not deterministically select
   the correct source address.  [<a href="rfc7078.html" title='"Distributing Address Selection Policy Using DHCPv6"'>RFC7078</a>] describes the use of the
   policy table (as discussed in [<a href="rfc6724.html" title='"Default Address Selection for Internet Protocol Version 6 (IPv6)"'>RFC6724</a>]) to resolve this problem,
   using a DHCPv6 mechanism for host policy table management.




<span class="grey">Troan, et al.                 Informational                    [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc7157.html">RFC 7157</a>              IPv6 Multihoming without NAT            March 2014</span>


   Again, by employing DHCPv6, the server could restrict address
   assignment (of additional prefixes) only to hosts that support policy
   table management.

   Scenario 1: Host needs to support the solution for this problem.

   Scenario 2: Host needs to support the solution for this problem.

   Scenario 3: If Host supports the next hop selection solution, there
   is no need to support the address selection functionality on the
   host.

   It is noted that the network's DHCP server and DHCP-forwarding
   routers must also support the Address Selection option [<a href="rfc7078.html" title='"Distributing Address Selection Policy Using DHCPv6"'>RFC7078</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.2.%20%20Next%20Hop%20Selection"></a><a class="selflink" href="#section-5.2" name="section-5.2">5.2</a>.  Next Hop Selection</span>

   A multihomed IPv6 host or gateway may have multiple uplinks to
   different service providers.  Here, each router would use Router
   Advertisements [<a href="rfc4861.html" title='"Neighbor Discovery for IP version 6 (IPv6)"'>RFC4861</a>] to distribute default route/next-hop
   information to the host or gateway router.

   In this case, the host or gateway router may select any valid default
   router from the default routers list, resulting in traffic being sent
   to the wrong router and discarded by the upstream service provider.
   Using the above scenarios as an example, whenever the host wishes to
   reach a destination in network 2 and there is no connectivity between
   networks 1 and 2 (as is the case for a walled-garden or closed
   service), the host or gateway router does not know whether to forward
   traffic to rtr1 or rtr2 to reach a destination in network 2.  The
   host or gateway router may choose rtr1 as the default router, but
   traffic will fail to reach the destination server.  The host or
   gateway router requires route information for each upstream service
   provider, but the use of a routing protocol between the gateway and
   the two routers causes both configuration and scaling issues.  In
   IPv4, gateway routers are often pre-configured with static routes or
   use the Classless Static Route Options [<a href="rfc3442.html" title='"The Classless Static Route Option for Dynamic Host Configuration Protocol (DHCP) version 4"'>RFC3442</a>] for DHCPv4.  An
   extension to Router Advertisements through Default Router Preference
   and More-Specific Routes [<a href="rfc4191.html" title='"Default Router Preferences and More-Specific Routes"'>RFC4191</a>] provides for link-specific
   preferences but does not address per-host configuration in a multi-
   access topology because of its reliance on Router Advertisements.

   Scenario 1: Host needs to support the solution for this problem.

   Scenario 2: GW rtr needs to support the solution for this problem.

   Scenario 3: Host needs to support the solution for this problem.




<span class="grey">Troan, et al.                 Informational                    [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc7157.html">RFC 7157</a>              IPv6 Multihoming without NAT            March 2014</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.3.%20%20DNS%20Recursive%20Name%20Server%20Selection"></a><a class="selflink" href="#section-5.3" name="section-5.3">5.3</a>.  DNS Recursive Name Server Selection</span>

   A multihomed IPv6 host or gateway router may be provided multiple DNS
   recursive name servers through DHCPv6 [<a href="rfc3646.html" title='"DNS Configuration options for Dynamic Host Configuration Protocol for IPv6 (DHCPv6)"'>RFC3646</a>] or RA [<a href="rfc6106.html" title='"IPv6 Router Advertisement Options for DNS Configuration"'>RFC6106</a>].
   When the host or gateway router sends a DNS query, it would normally
   choose one of the available DNS recursive name servers for the query.

   In the IPv6 gateway router scenario, the Broadband Forum (BBF)
   [<a href="#ref-TR-124" title='"TR-124, Functional Requirements for Broadband Residential Gateway Devices"'>TR-124</a>] requires that the query be sent to all DNS recursive name
   servers and that the gateway wait for the first reply.  In IPv6,
   given our use of specific destination-based policy for both routing
   and source address selection, it is desirable to extend a policy-
   based concept to DNS recursive name server selection.  Doing so can
   minimize DNS recursive name server load and avoid issues where DNS
   recursive name servers in different networks have connectivity
   issues, or the DNS recursive name servers are not publicly
   accessible.  In the worst case, a DNS query for a name from a local
   namespace may not be resolved correctly if sent towards a DNS server
   not aware of said local namespace, resulting in a lack of
   connectivity.

   It is not an issue of the Domain Name System model itself, but an
   IPv6 multihomed host or gateway router should have the ability to
   select appropriate DNS recursive name servers for each service based
   on the domain space for the destination, and each service should
   provide rules specific to that network.  [<a href="rfc6731.html" title='"Improved Recursive DNS Server Selection for Multi-Interfaced Nodes"'>RFC6731</a>] proposes a
   solution for distributing DNS server selection policy using a DHCPv6
   option.

   Scenario 1: Host needs to support the solution for this problem.

   Scenario 2: GW rtr needs to support the solution for this problem.

   Scenario 3: Host needs to support the solution for this problem.

   It is noted that the network's DHCP server and DHCP-forwarding
   routers must also support the Address Selection option [<a href="rfc6731.html" title='"Improved Recursive DNS Server Selection for Multi-Interfaced Nodes"'>RFC6731</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20Implementation%20Approach"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  Implementation Approach</span>

   As mentioned in <a href="#section-5">Section 5</a>, in the multi-prefix environment, we have
   three problems: source address selection, next hop selection, and DNS
   recursive name server selection.  In this section, possible solutions
   for each problem are introduced and evaluated against the
   requirements in <a href="#section-4">Section 4</a>.






<span class="grey">Troan, et al.                 Informational                    [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc7157.html">RFC 7157</a>              IPv6 Multihoming without NAT            March 2014</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.1.%20%20Source%20Address%20Selection"></a><a class="selflink" href="#section-6.1" name="section-6.1">6.1</a>.  Source Address Selection</span>

   The problems of address selection in multi-prefix environments are
   summarized in [<a href="rfc5220.html" title='"Problem Statement for Default Address Selection in Multi- Prefix Environments: Operational Issues of RFC 3484 Default Rules"'>RFC5220</a>].  When solutions are examined against the
   requirements in <a href="#section-4">Section 4</a>, the proactive approaches, such as the
   policy table distribution mechanism and the routing hints mechanism,
   are more appropriate in that they can propagate the network
   administrator's policy directly.  The policy distribution mechanism
   has an advantage with regard to the host's protocol stack impact and
   the static nature of the assumed target network environment.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.2.%20%20Next%20Hop%20Selection"></a><a class="selflink" href="#section-6.2" name="section-6.2">6.2</a>.  Next Hop Selection</span>

   As for the source address selection problem, both a policy-based
   approach and a non-policy-based approach are possible with regard to
   the next hop selection problem.  Because of the same requirements,
   the policy propagation-based solution mechanism, whatever the policy,
   should be more appropriate.

   Routing information is a typical example of policy related to next
   hop selection.  If we assume source-address-based routing at hosts or
   intermediate routers, pairs of source prefixes and next hops can be
   another example of next hop selection policy.

   The routing-information-based approach has a clear advantage in
   implementation and is already commonly used.

   The existing proposed or standardized routing information
   distribution mechanisms are routing protocols (such as Routing
   Information Protocol Next Generation (RIPng) and OSPFv3), the RA
   extension option defined in [<a href="rfc4191.html" title='"Default Router Preferences and More-Specific Routes"'>RFC4191</a>], and the CPE WAN Management
   Protocol (CWMP) [<a href="#ref-TR069" title='"TR-069, CPE WAN Management Protocol v1.1"'>TR069</a>] standardized at BBF.

   The RA-based mechanism doesn't handle distribution of per-host
   routing information easily.  Dynamic routing protocols are not
   typically used between residential users and ISPs, because of their
   scalability and security implications.  The DHCPv6 mechanism does not
   have these problems and has the advantage of relay functionality.  It
   is commonly used and is thus easy to deploy.

   [<a href="#ref-TR069" title='"TR-069, CPE WAN Management Protocol v1.1"'>TR069</a>], mentioned above, defines a possible solution mechanism for
   routing information distribution to customer premises equipment
   (CPE).  It assumes, however, that IP reachability to the Auto
   Configuration Server (ACS) has been established.  Therefore, if the
   CPE requires routing information to reach the ACS, CWMP [<a href="#ref-TR069" title='"TR-069, CPE WAN Management Protocol v1.1"'>TR069</a>]
   cannot be used to distribute this information.





<span class="grey">Troan, et al.                 Informational                    [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc7157.html">RFC 7157</a>              IPv6 Multihoming without NAT            March 2014</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.3.%20%20DNS%20Recursive%20Name%20Server%20Selection"></a><a class="selflink" href="#section-6.3" name="section-6.3">6.3</a>.  DNS Recursive Name Server Selection</span>

      Note: Split-horizon DNS is discussed in this section.  Split-
      horizon DNS is known to cause problems with applications to allow
      information leakage.  The discussion of split-horizon DNS is not
      condoning its use, but rather acknowledging that split-horizon DNS
      is used and that its use is another justification for network
      address translation.  The goal of this document is to encourage
      building solutions that do not need network address translation.
      Two solutions appear possible: improve the function of split-
      horizon DNS (which is discussed below) or meet network
      administrators' requirements without split-horizon DNS (which is
      out of scope of this document).

   As in the above two problems, a policy-based approach and a non-
   policy-based approach are possible.  In a non-policy-based approach,
   a host or a home gateway router is assumed to send DNS queries to
   several DNS recursive name servers at once or to select one of the
   available servers.

   In the non-policy-based approach, by making a query to a DNS
   recursive name server in a different service provider to that which
   hosts the service, a user could be directed to an unexpected IP
   address or receive an invalid response, and thus it could not connect
   to the service provider's private and legitimate service.  For
   example, some DNS recursive name servers reply with different answers
   depending on the source address of the DNS query, which is sometimes
   called "split-horizon".  When the host mistakenly makes a query to a
   different provider's DNS recursive name server to resolve a Fully
   Qualified Domain Name (FQDN) of another provider's private service,
   and the DNS recursive name server adopts the split-horizon
   configuration, the queried server returns an IP address of the non-
   private side of the service.  Another problem with this approach is
   that it causes unnecessary DNS traffic to the DNS recursive name
   servers that are visible to the users.

   The alternative to a policy-based approach is documented in
   [<a href="rfc6731.html" title='"Improved Recursive DNS Server Selection for Multi-Interfaced Nodes"'>RFC6731</a>], where several pairs of DNS recursive name server addresses
   and DNS domain suffixes are defined as part of a policy and conveyed
   to hosts in a new DHCP option.  In an environment where there is a
   home gateway router, that router can act as a DNS recursive name
   server, interpret this option, and distribute DNS queries to the
   appropriate DNS servers according to the policy.








<span class="grey">Troan, et al.                 Informational                    [Page 15]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc7157.html">RFC 7157</a>              IPv6 Multihoming without NAT            March 2014</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.4.%20%20Other%20Algorithms%20Available%20in%20RFCs"></a><a class="selflink" href="#section-6.4" name="section-6.4">6.4</a>.  Other Algorithms Available in RFCs</span>

   The authors of this document are aware of a variety of other
   algorithms and architectures, such as Shim6 [<a href="rfc5533.html" title='"Shim6: Level 3 Multihoming Shim Protocol for IPv6"'>RFC5533</a>] and HIP
   [<a href="rfc5206.html" title='"End- Host Mobility and Multihoming with the Host Identity Protocol"'>RFC5206</a>], that may be useful in this environment.  At the time of
   this writing, there is not enough operational experience on which to
   base a recommendation.  Should such operational experience become
   available, this document may be updated in the future.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20Considerations%20for%20MHMP%20Deployment"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  Considerations for MHMP Deployment</span>

   This section describes considerations to mitigate possible problems
   in a network that implements MHMP (described in <a href="#section-6">Section 6</a>).

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.1.%20%20Non-MHMP%20Host%20Consideration"></a><a class="selflink" href="#section-7.1" name="section-7.1">7.1</a>.  Non-MHMP Host Consideration</span>

   In a typical IPv4 multihomed network deployment, IPv4 NAPT is
   practically used and it can eventually avoid assigning multiple
   addresses to the hosts and solve the next hop selection problem.  In
   a similar fashion, NPTv6 can be used as a last resort for IPv6
   multihomed network deployments where one needs to assign a single
   IPv6 address to a non-MHMP host.

                                                      __________
                                                     /          \
                                                +---/  Internet  \
                            gateway router      |   \            /
          +------+     +---------------------+  |    \__________/
          |      |     |   |        |  WAN1  +--+
          | host |-----|LAN| Router |--------|
          |      |     |   |        |NAT|WAN2+--+
          +------+     +---------------------+  |     __________
                                                |    /          \
                                                +---/    ASP     \
                                                    \            /
                                                     \__________/

                           Figure 5: Legacy Host

   The gateway router also has to support the two features, next hop
   selection and DNS server selection, shown in <a href="#section-6">Section 6</a>.

   The implementation and issues of NPTv6 are out of the scope of this
   document, but are discussed in <a href="rfc6296.html#section-5">Section 5 of [RFC6296]</a>.







<span class="grey">Troan, et al.                 Informational                    [Page 16]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc7157.html">RFC 7157</a>              IPv6 Multihoming without NAT            March 2014</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.2.%20%20Coexistence%20Considerations"></a><a class="selflink" href="#section-7.2" name="section-7.2">7.2</a>.  Coexistence Considerations</span>

   To allow the coexistence of non-MHMP hosts and MHMP hosts (i.e.,
   hosts supporting multi-prefix with the enhancements for the source
   address selection), GW rtr may need to treat those hosts separately.

   An idea for how to achieve this would be for GW rtr to identify the
   hosts, and then assign a single prefix to non-MHMP hosts and assign
   multiple prefixes to MHMP hosts.  In this case, GW rtr can perform
   IPv6 NAT only for the traffic from non-MHMP hosts if its source
   address is not appropriate.

   Another idea is that GW rtr could assign multiple prefixes to both
   hosts and perform IPv6 NAT for traffic from non-MHMP hosts if its
   source address is not appropriate.

   In scenarios 1 and 3, the non-MHMP hosts can be placed behind the NAT
   box.  In this case, the non-MHMP host can access the service through
   the NAT box.

   The implementation of identifying non-MHMP hosts and NAT policy is
   outside the scope of this document.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.3.%20%20Policy%20Collision%20Consideration"></a><a class="selflink" href="#section-7.3" name="section-7.3">7.3</a>.  Policy Collision Consideration</span>

   When multiple policy distributors exist, a policy receiver may not
   follow each of the received policies.  In particular, when a policy
   conflicts with another policy, a policy receiver cannot implement
   both of the policies.  To solve or mitigate this issue, a
   prioritization rule is required to align the policies with the
   preferences of a trusted interface.  Another solution is to preclude
   the functionality of the acceptance of multiple policies at the
   receiver side.  In this case, a policy distributor should cooperate
   with other policy distributors, and a single representative provider
   should distribute a merged policy.

   This document does not presume specific recommendations for resolving
   policy collision.  It is expected that the implementation will decide
   how to resolve the conflicts.  If they are not resolved consistently
   by different implementations, that could affect interoperability and
   security trust boundaries.  Future work is expected to address the
   need for consistent policy resolution to avoid interoperability and
   security trust boundary issues.








<span class="grey">Troan, et al.                 Informational                    [Page 17]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc7157.html">RFC 7157</a>              IPv6 Multihoming without NAT            March 2014</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20Security%20Considerations"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  Security Considerations</span>

   In today's multihomed IPv4 networks, it is difficult to resolve or
   coordinate conflicts between the two upstream networks.  This problem
   persists with IPv6, no matter if the hosts use IPv6 provider-
   dependent or provider-independent addresses.

   This document requires that MHMP solutions have functions that
   provide policy controls.  New security threats can be introduced
   depending on the kind and form of the policy.  The threats can be
   categorized in two parts: the policy receiver side and the policy
   distributor side.

   A policy receiver may receive an evil policy from a policy
   distributor.  A policy distributor should expect that some hosts in
   its network will not follow the distributed policy.  At the time of
   this writing, there are no known methods to resolve conflicts between
   the host's own policy (policy receiver) and the policies of upstream
   providers (policy provider).  As this document is analyzing the
   problem space, rather than proposing a solution, we note the
   following problems:

   Threats related to the policy distributor side:

         The service provider should expect the existence of hosts that
         will not obey the received policy.  A possible solution is to
         ingress-filter those packets that do not match the distributed
         policy and drop them.  For route selection, packet forwarding
         or redirection can be another possible solution.  For source
         address selection, IPv6 NAT can be another possible solution.

         In a multihomed multiple-provider network, nodes in the network
         may be administered by different organizations.  Administrators
         might need to control policies (and a node's behavior)
         independently of other administrators.  Access control policies
         need to be in place to restrict the administrator's access to
         only the nodes it is authorized to control.

   Threats related to the policy receiver side:

         For the policy receiver side, who should be trusted to accept
         policies is a fundamental issue.  How is the trust established?
         How can the network element be assured that it can establish
         that trust before the network is fully configured?  If a policy
         receiver trusts an untrusted network, it will cause the
         distributing of the unwanted and unauthorized policy that is
         described below.




<span class="grey">Troan, et al.                 Informational                    [Page 18]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-19" id="page-19" name="page-19"> </a>
<span class="grey"><a href="rfc7157.html">RFC 7157</a>              IPv6 Multihoming without NAT            March 2014</span>


         A policy receiver is exposed to the threats of unauthorized
         policy, which can lead to session hijack, falsification, DoS,
         wiretapping, and phishing.  Unauthorized policy here means a
         policy distributed from an entity that does not have rights to
         do so.  Usually, only a site administrator and a network
         service provider have rights to distribute these policies in
         addition to IP address assignment and DNS server address
         notification.  Regarding source address selection, unauthorized
         policy can expose an IP address that will not usually be
         exposed to an external server, which can be a privacy problem.
         To solve or mitigate the problem of unauthorized policy, one
         approach is to limit the use of these policy distribution
         mechanisms, as described in the <a href="rfc6731.html#section-4.4">Section 4.4 of [RFC6731]</a>.  For
         example, a policy should be preferred or accepted if delivered
         over a secure, trusted channel such as a cellular data
         connection.  The proposed solutions are based on DHCP, so the
         limitation of local site communication, which is often used in
         WiFi access services, should be another solution or mitigation
         for this problem.  For the DNS server selection issue, DNS
         Security (DNSSEC) can be another solution.  For source address
         selection, the ingress filter at the network service provider
         router can be a solution.

         Another threat is the leakage of the policy and privacy issues
         resulting from that.  Especially when clients receive different
         policies from the network service provider, that difference
         provides hints about the host itself and can be useful to
         uniquely identify the host.  Encryption of the communication
         channel and separation of the communication channel per host
         can be solutions for this problem.

   The security threats related to IPv6 multihoming are described in
   [<a href="rfc4218.html" title='"Threats Relating to IPv6 Multihoming Solutions"'>RFC4218</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/9.%20%20Contributors"></a><a class="selflink" href="#section-9" name="section-9">9</a>.  Contributors</span>

   The following people contributed to this document: Akiko Hattori,
   Arifumi Matsumoto, Frank Brockners, Fred Baker, Tomohiro Fujisaki,
   Jun-ya Kato, Shigeru Akiyama, Seiichi Morikawa, Mark Townsley,
   Wojciech Dec, Yasuo Kashimura, and Yuji Yamazaki.  This document has
   greatly benefited from inputs by Randy Bush, Brian Carpenter, and
   Teemu Savolainen.









<span class="grey">Troan, et al.                 Informational                    [Page 19]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-20" id="page-20" name="page-20"> </a>
<span class="grey"><a href="rfc7157.html">RFC 7157</a>              IPv6 Multihoming without NAT            March 2014</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/10.%20%20References"></a><a class="selflink" href="#section-10" name="section-10">10</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/10.1.%20%20Normative%20References"></a><a class="selflink" href="#section-10.1" name="section-10.1">10.1</a>.  Normative References</span>

   [<a id="ref-RFC4191" name="ref-RFC4191">RFC4191</a>]  Draves, R. and D. Thaler, "Default Router Preferences and
              More-Specific Routes", <a href="rfc4191.html">RFC 4191</a>, November 2005.

   [<a id="ref-RFC4861" name="ref-RFC4861">RFC4861</a>]  Narten, T., Nordmark, E., Simpson, W., and H. Soliman,
              "Neighbor Discovery for IP version 6 (IPv6)", <a href="rfc4861.html">RFC 4861</a>,
              September 2007.

   [<a id="ref-RFC6296" name="ref-RFC6296">RFC6296</a>]  Wasserman, M. and F. Baker, "IPv6-to-IPv6 Network Prefix
              Translation", <a href="rfc6296.html">RFC 6296</a>, June 2011.

   [<a id="ref-RFC6724" name="ref-RFC6724">RFC6724</a>]  Thaler, D., Draves, R., Matsumoto, A., and T. Chown,
              "Default Address Selection for Internet Protocol Version 6
              (IPv6)", <a href="rfc6724.html">RFC 6724</a>, September 2012.

   [<a id="ref-RFC6731" name="ref-RFC6731">RFC6731</a>]  Savolainen, T., Kato, J., and T. Lemon, "Improved
              Recursive DNS Server Selection for Multi-Interfaced
              Nodes", <a href="rfc6731.html">RFC 6731</a>, December 2012.

   [<a id="ref-RFC7078" name="ref-RFC7078">RFC7078</a>]  Matsumoto, A., Fujisaki, T., and T. Chown, "Distributing
              Address Selection Policy Using DHCPv6", <a href="rfc7078.html">RFC 7078</a>, January
              2014.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/10.2.%20%20Informative%20References"></a><a class="selflink" href="#section-10.2" name="section-10.2">10.2</a>.  Informative References</span>

   [<a id="ref-RFC3022" name="ref-RFC3022">RFC3022</a>]  Srisuresh, P. and K. Egevang, "Traditional IP Network
              Address Translator (Traditional NAT)", <a href="rfc3022.html">RFC 3022</a>, January
              2001.

   [<a id="ref-RFC3442" name="ref-RFC3442">RFC3442</a>]  Lemon, T., Cheshire, S., and B. Volz, "The Classless
              Static Route Option for Dynamic Host Configuration
              Protocol (DHCP) version 4", <a href="rfc3442.html">RFC 3442</a>, December 2002.

   [<a id="ref-RFC3582" name="ref-RFC3582">RFC3582</a>]  Abley, J., Black, B., and V. Gill, "Goals for IPv6 Site-
              Multihoming Architectures", <a href="rfc3582.html">RFC 3582</a>, August 2003.

   [<a id="ref-RFC3646" name="ref-RFC3646">RFC3646</a>]  Droms, R., "DNS Configuration options for Dynamic Host
              Configuration Protocol for IPv6 (DHCPv6)", <a href="rfc3646.html">RFC 3646</a>,
              December 2003.

   [<a id="ref-RFC4116" name="ref-RFC4116">RFC4116</a>]  Abley, J., Lindqvist, K., Davies, E., Black, B., and V.
              Gill, "IPv4 Multihoming Practices and Limitations", <a href="rfc4116.html">RFC</a>
              <a href="rfc4116.html">4116</a>, July 2005.





<span class="grey">Troan, et al.                 Informational                    [Page 20]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-21" id="page-21" name="page-21"> </a>
<span class="grey"><a href="rfc7157.html">RFC 7157</a>              IPv6 Multihoming without NAT            March 2014</span>


   [<a id="ref-RFC4218" name="ref-RFC4218">RFC4218</a>]  Nordmark, E. and T. Li, "Threats Relating to IPv6
              Multihoming Solutions", <a href="rfc4218.html">RFC 4218</a>, October 2005.

   [<a id="ref-RFC4960" name="ref-RFC4960">RFC4960</a>]  Stewart, R., "Stream Control Transmission Protocol", <a href="rfc4960.html">RFC</a>
              <a href="rfc4960.html">4960</a>, September 2007.

   [<a id="ref-RFC5206" name="ref-RFC5206">RFC5206</a>]  Nikander, P., Henderson, T., Vogt, C., and J. Arkko, "End-
              Host Mobility and Multihoming with the Host Identity
              Protocol", <a href="rfc5206.html">RFC 5206</a>, April 2008.

   [<a id="ref-RFC5220" name="ref-RFC5220">RFC5220</a>]  Matsumoto, A., Fujisaki, T., Hiromi, R., and K. Kanayama,
              "Problem Statement for Default Address Selection in Multi-
              Prefix Environments: Operational Issues of <a href="rfc3484.html">RFC 3484</a>
              Default Rules", <a href="rfc5220.html">RFC 5220</a>, July 2008.

   [<a id="ref-RFC5245" name="ref-RFC5245">RFC5245</a>]  Rosenberg, J., "Interactive Connectivity Establishment
              (ICE): A Protocol for Network Address Translator (NAT)
              Traversal for Offer/Answer Protocols", <a href="rfc5245.html">RFC 5245</a>, April
              2010.

   [<a id="ref-RFC5533" name="ref-RFC5533">RFC5533</a>]  Nordmark, E. and M. Bagnulo, "Shim6: Level 3 Multihoming
              Shim Protocol for IPv6", <a href="rfc5533.html">RFC 5533</a>, June 2009.

   [<a id="ref-RFC6106" name="ref-RFC6106">RFC6106</a>]  Jeong, J., Park, S., Beloeil, L., and S. Madanapalli,
              "IPv6 Router Advertisement Options for DNS Configuration",
              <a href="rfc6106.html">RFC 6106</a>, November 2010.

   [<a id="ref-TR-124" name="ref-TR-124">TR-124</a>]   The Broadband Forum, "TR-124, Functional Requirements for
              Broadband Residential Gateway Devices", Issue: 2, May
              2010, &lt;<a href="http://www.broadband-forum.org/technical/download/TR-124_Issue-2.pdf">http://www.broadband-forum.org/technical/download/</a>
              <a href="http://www.broadband-forum.org/technical/download/TR-124_Issue-2.pdf">TR-124_Issue-2.pdf</a>&gt;.

   [<a id="ref-TR069" name="ref-TR069">TR069</a>]    The Broadband Forum, "TR-069, CPE WAN Management Protocol
              v1.1", Version: Issue 1 Amendment 2, December 2007,
              &lt;<a href="http://www.broadband-forum.org/technical/download/TR-069_Amendment-2.pdf">http://www.broadband-forum.org/technical/download/</a>
              <a href="http://www.broadband-forum.org/technical/download/TR-069_Amendment-2.pdf">TR-069_Amendment-2.pdf</a>&gt;.















<span class="grey">Troan, et al.                 Informational                    [Page 21]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-22" id="page-22" name="page-22"> </a>
<span class="grey"><a href="rfc7157.html">RFC 7157</a>              IPv6 Multihoming without NAT            March 2014</span>


Authors' Addresses

   Ole Troan (editor)
   Cisco
   Oslo
   Norway

   EMail: ot@cisco.com


   David Miles
   Google Fiber
   Mountain View, CA
   USA

   EMail: davidmiles@google.com


   Satoru Matsushima
   Softbank Telecom
   Tokyo
   Japan

   EMail: satoru.matsushima@g.softbank.co.jp


   Tadahisa Okimoto
   NTT West
   Osaka
   Japan

   EMail: t.okimoto@west.ntt.co.jp


   Dan Wing
   Cisco
   170 West Tasman Drive
   San Jose
   USA

   EMail: dwing@cisco.com










Troan, et al.                 Informational                    [Page 22]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc7157 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:23 GMT --></html>