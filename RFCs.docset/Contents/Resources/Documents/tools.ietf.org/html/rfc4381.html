<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc4381 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:42 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="urn:ietf:rfc:4381" name="DC.Identifier"/>
<meta content="This document analyses the security of the BGP/MPLS IP virtual private
network (VPN) architecture that is described in RFC 4364, for the
benefit of service providers and VPN users.  The analysis shows that
BGP/MPLS IP VPN networks can be as secure as traditional layer-2 VPN
services using Asynchronous Transfer Mode (ATM) or Frame Relay. This
memo provides information for the Internet community." name="DC.Description.Abstract"/>
<meta content="Michael H. Behringer &lt;mbehring@cisco.com&gt;" name="DC.Creator"/>
<meta content="February, 2006" name="DC.Date.Issued"/>
<meta content="Analysis of the Security of BGP/MPLS IP Virtual Private Networks (VPNs)" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 4381 - Analysis of the Security of BGP/MPLS IP Virtual Private Networks (VPNs)</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgorange" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc4381.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc4381" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-behringer-mpls-security" title="draft-behringer-mpls-security">draft-behringer...</a>] [<a href="https://datatracker.ietf.org/doc/rfc4381" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc4381" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc4381" title="Side-by-side diff">Diff2</a>]         </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                           INFORMATIONAL</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Network Working Group                                       M. Behringer
Request for Comments: 4381                             Cisco Systems Inc
Category: Informational                                    February 2006


                <span class="h1">Analysis of the Security of BGP/MPLS IP</span>
                    <span class="h1">Virtual Private Networks (VPNs)</span>

Status of This Memo

   This memo provides information for the Internet community.  It does
   not specify an Internet standard of any kind.  Distribution of this
   memo is unlimited.

Copyright Notice

   Copyright (C) The Internet Society (2006).

IESG Note

   The content of this RFC was at one time considered by the IETF, and
   therefore it may resemble a current IETF work in progress or a
   published IETF work.  This RFC is not a candidate for any level of
   Internet Standard.  The IETF disclaims any knowledge of the fitness
   of this RFC for any purpose, and in particular notes that the
   decision to publish is not based on IETF review for such things as
   security, congestion control or inappropriate interaction with
   deployed protocols.  The RFC Editor has chosen to publish this
   document at its discretion.  Readers of this RFC should exercise
   caution in evaluating its value for implementation and deployment.
   See <a href="rfc3932.html">RFC 3932</a> for more information.

Abstract

   This document analyses the security of the BGP/MPLS IP virtual
   private network (VPN) architecture that is described in <a href="rfc4364.html">RFC 4364</a>, for
   the benefit of service providers and VPN users.

   The analysis shows that BGP/MPLS IP VPN networks can be as secure as
   traditional layer-2 VPN services using Asynchronous Transfer Mode
   (ATM) or Frame Relay.










<span class="grey">Behringer                    Informational                      [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc4381.html">RFC 4381</a>              Security of BGP/MPLS IP VPNs         February 2006</span>


Table of Contents

   <a href="#section-1">1</a>. Scope and Introduction ..........................................<a href="#page-3">3</a>
   <a href="#section-2">2</a>. Security Requirements of VPN Networks ...........................<a href="#page-4">4</a>
      <a href="#section-2.1">2.1</a>. Address Space, Routing, and Traffic Separation .............<a href="#page-4">4</a>
      <a href="#section-2.2">2.2</a>. Hiding the Core Infrastructure .............................<a href="#page-5">5</a>
      <a href="#section-2.3">2.3</a>. Resistance to Attacks ......................................<a href="#page-5">5</a>
      <a href="#section-2.4">2.4</a>. Impossibility of Label Spoofing ............................<a href="#page-6">6</a>
   <a href="#section-3">3</a>. Analysis of BGP/MPLS IP VPN Security ............................<a href="#page-6">6</a>
      <a href="#section-3.1">3.1</a>. Address Space, Routing, and Traffic Separation .............<a href="#page-6">6</a>
      <a href="#section-3.2">3.2</a>. Hiding of the BGP/MPLS IP VPN Core Infrastructure ..........<a href="#page-7">7</a>
      <a href="#section-3.3">3.3</a>. Resistance to Attacks ......................................<a href="#page-9">9</a>
      <a href="#section-3.4">3.4</a>. Label Spoofing ............................................<a href="#page-11">11</a>
      <a href="#section-3.5">3.5</a>. Comparison with ATM/FR VPNs ...............................<a href="#page-12">12</a>
   <a href="#section-4">4</a>. Security of Advanced BGP/MPLS IP VPN Architectures .............<a href="#page-12">12</a>
      <a href="#section-4.1">4.1</a>. Carriers' Carrier .........................................<a href="#page-13">13</a>
      <a href="#section-4.2">4.2</a>. Inter-Provider Backbones ..................................<a href="#page-14">14</a>
   <a href="#section-5">5</a>. What BGP/MPLS IP VPNs Do Not Provide ...........................<a href="#page-16">16</a>
      5.1. Protection against Misconfigurations of the Core
           and Attacks 'within' the Core .............................<a href="#page-16">16</a>
      <a href="#section-5.2">5.2</a>. Data Encryption, Integrity, and Origin Authentication .....<a href="#page-17">17</a>
      <a href="#section-5.3">5.3</a>. Customer Network Security .................................<a href="#page-17">17</a>
   <a href="#section-6">6</a>. Layer 2 Security Considerations ................................<a href="#page-18">18</a>
   <a href="#section-7">7</a>. Summary and Conclusions ........................................<a href="#page-19">19</a>
   <a href="#section-8">8</a>. Security Considerations ........................................<a href="#page-20">20</a>
   <a href="#section-9">9</a>. Acknowledgements ...............................................<a href="#page-20">20</a>
   <a href="#section-10">10</a>. Normative References ..........................................<a href="#page-20">20</a>
   <a href="#section-11">11</a>. Informative References ........................................<a href="#page-20">20</a>























<span class="grey">Behringer                    Informational                      [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc4381.html">RFC 4381</a>              Security of BGP/MPLS IP VPNs         February 2006</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Scope%20and%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Scope and Introduction</span>

   As Multiprotocol Label Switching (MPLS) is becoming a more widespread
   technology for providing IP virtual private network (VPN) services,
   the security of the BGP/MPLS IP VPN architecture is of increasing
   concern to service providers and VPN customers.  This document gives
   an overview of the security of the BGP/MPLS IP VPN architecture that
   is described in <a href="rfc4364.html">RFC 4364</a> [<a href="#ref-1" title='"BGP/MPLS IP Virtual Private Networks (VPNs)"'>1</a>], and compares it with the security of
   traditional layer-2 services such as ATM or Frame Relay.

   The term "MPLS core" is defined for this document as the set of
   Provider Edge (PE) and provider (P) routers that provide a BGP/MPLS
   IP VPN service, typically under the control of a single service
   provider (SP).  This document assumes that the MPLS core network is
   trusted and secure.  Thus, it does not address basic security
   concerns such as securing the network elements against unauthorised
   access, misconfigurations of the core, or attacks internal to the
   core.  A customer that does not wish to trust the service provider
   network must use additional security mechanisms such as IPsec over
   the MPLS infrastructure.

   This document analyses only the security features of BGP/MPLS IP
   VPNs, not the security of routing protocols in general.  IPsec
   technology is also not covered, except to highlight the combination
   of MPLS VPNs with IPsec.

   The overall security of a system has three aspects: the architecture,
   the implementation, and the operation of the system.  Security issues
   can exist in any of these aspects.  This document analyses only the
   architectural security of BGP/MPLS IP VPNs, not implementation or
   operational security issues.

   This document is targeted at technical staff of service providers and
   enterprises.  Knowledge of the basic BGP/MPLS IP VPN architecture as
   described in <a href="rfc4364.html">RFC 4364</a> [<a href="#ref-1" title='"BGP/MPLS IP Virtual Private Networks (VPNs)"'>1</a>] is required to understand this document.
   For specific Layer 3 VPN terminology and reference models refer to
   [<a href="#ref-11" title='"Security Framework for Provider-Provisioned Virtual Private Networks (PPVPNs)"'>11</a>].

   <a href="#section-2">Section 2</a> of this document specifies the typical VPN requirements a
   VPN user might have, and <a href="#section-3">section 3</a> analyses how <a href="rfc4364.html">RFC 4364</a> [<a href="#ref-1" title='"BGP/MPLS IP Virtual Private Networks (VPNs)"'>1</a>]
   addresses these requirements.  <a href="#section-4">Section 4</a> discusses specific security
   issues of multi-AS (Autonomous System) MPLS architectures, and
   <a href="#section-5">section 5</a> lists security features that are not covered by this
   architecture and therefore need to be addressed separately.  <a href="#section-6">Section</a>
   <a href="#section-6">6</a> highlights potential security issues on layer 2 that might impact
   the overall security of a BGP/MPLS IP VPN service.  The findings of
   this document are summarized in <a href="#section-7">section 7</a>.




<span class="grey">Behringer                    Informational                      [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc4381.html">RFC 4381</a>              Security of BGP/MPLS IP VPNs         February 2006</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Security%20Requirements%20of%20VPN%20Networks"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Security Requirements of VPN Networks</span>

   Both service providers offering any type of VPN services and
   customers using them have specific demands for security.  Mostly,
   they compare MPLS-based solutions with traditional layer 2-based VPN
   solutions such as Frame Relay and ATM, since these are widely
   deployed and accepted.  This section outlines the typical security
   requirements for VPN networks.  The following section discusses if
   and how BGP/MPLS IP VPNs address these requirements, for both the
   MPLS core and the connected VPNs.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.1.%20%20Address%20Space%2C%20Routing%2C%20and%20Traffic%20Separation"></a><a class="selflink" href="#section-2.1" name="section-2.1">2.1</a>.  Address Space, Routing, and Traffic Separation</span>

   Non-intersecting layer 3 VPNs of the same VPN service are assumed to
   have independent address spaces.  For example, two non-intersecting
   VPNs may each use the same 10/8 network addresses without conflict.
   In addition, traffic from one VPN must never enter another VPN.  This
   implies separation of routing protocol information, so that routing
   tables must also be separate per VPN.  Specifically:

   o  Any VPN must be able to use the same address space as any other
      VPN.
   o  Any VPN must be able to use the same address space as the MPLS
      core.
   o  Traffic, including routing traffic, from one VPN must never flow
      to another VPN.
   o  Routing information, as well as distribution and processing of
      that information, for one VPN instance must be independent from
      any other VPN instance.
   o  Routing information, as well as distribution and processing of
      that information, for one VPN instance must be independent from
      the core.

   From a security point of view, the basic requirement is to prevent
   packets destined to a host a.b.c.d within a given VPN reaching a host
   with the same address in another VPN or in the core, and to prevent
   routing packets to another VPN even if it does not contain that
   destination address.

   Confidentiality, as defined in the L3VPN Security Framework [<a href="#ref-11" title='"Security Framework for Provider-Provisioned Virtual Private Networks (PPVPNs)"'>11</a>], is
   a requirement that goes beyond simple isolation of VPNs and provides
   protection against eavesdropping on any transmission medium.
   Encryption is the mechanism used to provide confidentiality.  This
   document considers confidentiality an optional VPN requirement, since
   many existing VPN deployments do not encrypt transit traffic.






<span class="grey">Behringer                    Informational                      [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc4381.html">RFC 4381</a>              Security of BGP/MPLS IP VPNs         February 2006</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.2.%20%20Hiding%20the%20Core%20Infrastructure"></a><a class="selflink" href="#section-2.2" name="section-2.2">2.2</a>.  Hiding the Core Infrastructure</span>

   The internal structure of the core network (MPLS PE and P elements)
   should not be externally visible.  Whilst breaking this requirement
   is not a security problem in itself, many service providers believe
   it is advantageous if the internal addresses and network structure
   are hidden from the outside world.  An argument is that denial-of-
   service (DoS) attacks against a core router are much easier to carry
   out if an attacker knows the router addresses.  Addresses can always
   be guessed, but attacks are more difficult if addresses are not
   known.  The core should be as invisible to the outside world as a
   comparable layer 2 infrastructure (e.g., Frame Relay, ATM).  Core
   network elements should also not be accessible from within a VPN.

   Security should never rely entirely on obscurity, i.e., the hiding of
   information.  Services should be equally secure if the implementation
   is known.  However, there is a strong market perception that hiding
   of details is advantageous.  This point addresses that market
   perception.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.3.%20%20Resistance%20to%20Attacks"></a><a class="selflink" href="#section-2.3" name="section-2.3">2.3</a>.  Resistance to Attacks</span>

   There are two basic types of attacks: DoS attacks, where resources
   become unavailable to authorised users, and intrusions, where
   resources become available to unauthorised users.  BGP/MPLS IP VPN
   networks must provide at least the same level of protection against
   both forms of attack as current layer 2 networks.

   For intrusions, there are two fundamental ways to protect the
   network: first, to harden protocols that could be abused (e.g.,
   Telnet into a router), and second, to make the network as
   inaccessible as possible.  This is achieved by a combination of
   packet filtering / firewalling and address hiding, as discussed
   above.

   DoS attacks are easier to execute, since a single known IP address
   might be enough information to attack a machine.  This can be done
   using normal "permitted" traffic, but using higher than normal packet
   rates, so that other users cannot access the targeted machine.  The
   only way to be invulnerable to this kind of attack is to make sure
   that machines are not reachable, again by packet filtering and
   optionally by address hiding.

   This document concentrates on protecting the core network against
   attacks from the "outside", i.e., the Internet and connected VPNs.
   Protection against attacks from the "inside", i.e., an attacker who
   has logical or physical access to the core network, is not discussed
   here.



<span class="grey">Behringer                    Informational                      [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc4381.html">RFC 4381</a>              Security of BGP/MPLS IP VPNs         February 2006</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.4.%20%20Impossibility%20of%20Label%20Spoofing"></a><a class="selflink" href="#section-2.4" name="section-2.4">2.4</a>.  Impossibility of Label Spoofing</span>

   Assuming the address and traffic separation discussed above, an
   attacker might try to access other VPNs by inserting packets with a
   label that he does not "own".  This could be done from the outside,
   i.e., another Customer Edge (CE) router or from the Internet, or from
   within the MPLS core.  The latter case (from within the core) will
   not be discussed, since we assume that the core network is provided
   securely.  Should protection against an insecure core be required, it
   is necessary to use security protocols such as IPsec across the MPLS
   infrastructure, at least from CE to CE, since the PEs belong to the
   core.

   Depending on the way that CE routers are connected to PE routers, it
   might be possible to intrude into a VPN that is connected to the same
   PE, using layer 2 attack mechanisms such as 802.1Q-label spoofing or
   ATM VPI/VCI spoofing.  Layer 2 security issues will be discussed in
   <a href="#section-6">section 6</a>.

   It is required that VPNs cannot abuse the MPLS label mechanisms or
   protocols to gain unauthorised access to other VPNs or the core.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Analysis%20of%20BGP%2FMPLS%20IP%20VPN%20Security"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Analysis of BGP/MPLS IP VPN Security</span>

   In this section, the BGP/MPLS IP VPN architecture is analysed with
   respect to the security requirements listed above.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.1.%20%20Address%20Space%2C%20Routing%2C%20and%20Traffic%20Separation"></a><a class="selflink" href="#section-3.1" name="section-3.1">3.1</a>.  Address Space, Routing, and Traffic Separation</span>

   BGP/MPLS allows distinct IP VPNs to use the same address space, which
   can also be private address space (<a href="rfc1918.html">RFC 1918</a> [<a href="#ref-2" title='"Address Allocation for Private Internets"'>2</a>]).  This is achieved
   by adding a 64-bit Route Distinguisher (RD) to each IPv4 route,
   making VPN-unique addresses also unique in the MPLS core.  This
   "extended" address is also called a "VPN-IPv4 address".  Thus,
   customers of a BGP/MPLS IP VPN service do not need to change their
   current addressing plan.

   Each PE router maintains a separate Virtual Routing and Forwarding
   instance (VRF) for each connected VPN.  A VRF includes the addresses
   of that VPN as well as the addresses of the PE routers with which the
   CE routers are peering.  All addresses of a VRF, including these PE
   addresses, belong logically to the VPN and are accessible from the
   VPN.  The fact that PE addresses are accessible to the VPN is not an
   issue if static routing is used between the PE and CE routers, since
   packet filters can be deployed to block access to all addresses of
   the VRF on the PE router.  If dynamic routing protocols are used, the
   CE routers need to have the address of the peer PE router in the core
   configured.  In an environment where the service provider manages the



<span class="grey">Behringer                    Informational                      [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc4381.html">RFC 4381</a>              Security of BGP/MPLS IP VPNs         February 2006</span>


   CE routers as CPE, this can be invisible to the customer.  The
   address space on the CE-PE link (including the peering PE address) is
   considered part of the VPN address space.  Since address space can
   overlap between VPNs, the CE-PE link addresses can overlap between
   VPNs.  For practical management considerations, SPs typically address
   CE-PE links from a global pool, maintaining uniqueness across the
   core.

   Routing separation between VPNs can also be achieved.  Each VRF is
   populated with routes from one VPN through statically configured
   routes or through routing protocols that run between the PE and CE
   router.  Since each VPN is associated with a separate VRF there is no
   interference between VPNs on the PE router.

   Across the core to the other PE routers separation is maintained with
   unique VPN identifiers in multiprotocol BGP, the Route Distinguishers
   (RDs).  VPN routes including the RD are exclusively exchanged between
   PE routers by Multi-Protocol BGP (MP-BGP, <a href="rfc2858.html">RFC 2858</a> [<a href="#ref-8" title='"Multiprotocol Extensions for BGP-4"'>8</a>]) across the
   core.  These BGP routing updates are not re-distributed into the
   core, but only to the other PE routers, where the information is kept
   again in VPN-specific VRFs.  Thus, routing across a BGP/MPLS network
   is separate per VPN.

   On the data plane, traffic separation is achieved by the ingress PE
   pre-pending a VPN-specific label to the packets.  The packets with
   the VPN labels are sent through the core to the egress PE, where the
   VPN label is used to select the egress VRF.

   Given the addressing, routing, and traffic separation across an BGP/
   MPLS IP VPN core network, it can be assumed that this architecture
   offers in this respect the same security as a layer-2 VPN.  It is not
   possible to intrude from a VPN or the core into another VPN unless
   this has been explicitly configured.

   If and when confidentiality is required, it can be achieved in BGP/
   MPLS IP VPNs by overlaying encryption services over the network.
   However, encryption is not a standard service on BGP/MPLS IP VPNs.
   See also <a href="#section-5.2">section 5.2</a>.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.2.%20%20Hiding%20of%20the%20BGP%2FMPLS%20IP%20VPN%20Core%20Infrastructure"></a><a class="selflink" href="#section-3.2" name="section-3.2">3.2</a>.  Hiding of the BGP/MPLS IP VPN Core Infrastructure</span>

   Service providers and end-customers do not normally want their
   network topology revealed to the outside.  This makes attacks more
   difficult to execute: If an attacker doesn't know the address of a
   victim, he can only guess the IP addresses to attack.  Since most DoS
   attacks don't provide direct feedback to the attacker it would be
   difficult to attack the network.  It has to be mentioned specifically




<span class="grey">Behringer                    Informational                      [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc4381.html">RFC 4381</a>              Security of BGP/MPLS IP VPNs         February 2006</span>


   that information hiding as such does not provide security.  However,
   in the market this is a perceived requirement.

   With a known IP address, a potential attacker can launch a DoS attack
   more easily against that device.  Therefore, the ideal is to not
   reveal any information about the internal network to the outside
   world.  This applies to the customer network and the core.  A number
   of additional security measures also have to be taken: most of all,
   extensive packet filtering.

   For security reasons, it is recommended for any core network to
   filter packets from the "outside" (Internet or connected VPNs)
   destined to the core infrastructure.  This makes it very hard to
   attack the core, although some functionality such as pinging core
   routers will be lost.  Traceroute across the core will still work,
   since it addresses a destination outside the core.

   MPLS does not reveal unnecessary information to the outside, not even
   to customer VPNs.  The addressing of the core can be done with
   private addresses (<a href="rfc1918.html">RFC 1918</a> [<a href="#ref-2" title='"Address Allocation for Private Internets"'>2</a>]) or public addresses.  Since the
   interface to the VPNs as well as the Internet is BGP, there is no
   need to reveal any internal information.  The only information
   required in the case of a routing protocol between PE and CE is the
   address of the PE router.  If no dynamic routing is required, static
   routing on unnumbered interfaces can be configured between the PE and
   CE.  With this measure, the BGP/MPLS IP VPN core can be kept
   completely hidden.

   Customer VPNs must advertise their routes to the BGP/MPLS IP VPN core
   (dynamically or statically), to ensure reachability across their VPN.
   In some cases, VPN users prefer that the service provider have no
   visibility of the addressing plan of the VPN.  The following has to
   be noted: First, the information known to the core is not about
   specific hosts, but networks (routes); this offers a degree of
   abstraction.  Second, in a VPN-only BGP/MPLS IP VPN network (no
   Internet access) this is equal to existing layer-2 models, where the
   customer has to trust the service provider.  Also, in a Frame Relay
   or ATM network, routing and addressing information about the VPNs can
   be seen on the core network.

   In a VPN service with shared Internet access, the service provider
   will typically announce the routes of customers who wish to use the
   Internet to his upstream or peer providers.  This can be done
   directly if the VPN customer uses public address space, or via
   Network Address Translation (NAT) to obscure the addressing
   information of the customers' networks.  In either case, the customer
   does not reveal more information than would be revealed by a general
   Internet service.  Core information will not be revealed, except for



<span class="grey">Behringer                    Informational                      [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc4381.html">RFC 4381</a>              Security of BGP/MPLS IP VPNs         February 2006</span>


   the peering address(es) of the PE router(s) that hold(s) the peering
   with the Internet.  These addresses must be secured as in a
   traditional IP backbone.

   In summary, in a pure MPLS-VPN service, where no Internet access is
   provided, information hiding is as good as on a comparable FR or ATM
   network.  No addressing information is revealed to third parties or
   the Internet.  If a customer chooses to access the Internet via the
   BGP/MPLS IP VPN core, he will have to reveal the same information as
   required for a normal Internet service.  NAT can be used for further
   obscurity.  Being reachable from the Internet automatically exposes a
   customer network to additional security threats.  Appropriate
   security mechanisms have to be deployed such as firewalls and
   intrusion detection systems.  This is true for any Internet access,
   over MPLS or direct.

   A BGP/MPLS IP VPN network with no interconnections to the Internet
   has security equal to that of FR or ATM VPN networks.  With an
   Internet access from the MPLS cloud, the service provider has to
   reveal at least one IP address (of the peering PE router) to the next
   provider, and thus to the outside world.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.3.%20%20Resistance%20to%20Attacks"></a><a class="selflink" href="#section-3.3" name="section-3.3">3.3</a>.  Resistance to Attacks</span>

   <a href="#section-3.1">Section 3.1</a> shows that it is impossible to directly intrude into
   other VPNs.  Another possibility is to attack the MPLS core and try
   to attack other VPNs from there.  As shown above, it is impossible to
   address a P router directly.  The only addresses reachable from a VPN
   or the Internet are the peering addresses of the PE routers.  Thus,
   there are two basic ways that the BGP/MPLS IP VPN core can be
   attacked:

   1.  By attacking the PE routers directly.
   2.  By attacking the signaling mechanisms of MPLS (mostly routing).

   To attack an element of a BGP/MPLS IP VPN network, it is first
   necessary to know the address of the element.  As discussed in
   <a href="#section-3.2">section 3.2</a>, the addressing structure of the BGP/MPLS IP VPN core is
   hidden from the outside world.  Thus, an attacker cannot know the IP
   address of any router in the core to attack.  The attacker could
   guess addresses and send packets to these addresses.  However, due to
   the address separation of MPLS each incoming packet will be treated
   as belonging to the address space of the customer.  Thus, it is
   impossible to reach an internal router, even by guessing IP
   addresses.  There is only one exception to this rule, which is the
   peer interface of the PE router.  This address of the PE is the only
   attack point from the outside (a VPN or Internet).




<span class="grey">Behringer                    Informational                      [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc4381.html">RFC 4381</a>              Security of BGP/MPLS IP VPNs         February 2006</span>


   The routing between a VPN and the BGP/MPLS IP VPN core can be
   configured two ways:

   1.  Static: In this case, the PE routers are configured with static
       routes to the networks behind each CE, and the CEs are configured
       to statically point to the PE router for any network in other
       parts of the VPN (mostly a default route).  There are two sub-
       cases: The static route can point to the IP address of the PE
       router or to an interface of the CE router (e.g., serial0).
   2.  Dynamic: A routing protocol (e.g., Routing Information Protocol
       (RIP), OSPF, BGP) is used to exchange routing information between
       the CE and PE at each peering point.

   In the case of a static route that points to an interface, the CE
   router doesn't need to know any IP addresses of the core network or
   even of the PE router.  This has the disadvantage of needing a more
   extensive (static) configuration, but is the most secure option.  In
   this case, it is also possible to configure packet filters on the PE
   interface to deny any packet to the PE interface.  This protects the
   router and the whole core from attack.

   In all other cases, each CE router needs to know at least the router
   ID (RID, i.e., peer IP address) of the PE router in the core, and
   thus has a potential destination for an attack.  One could imagine
   various attacks on various services running on a router.  In
   practice, access to the PE router over the CE-PE interface can be
   limited to the required routing protocol by using access control
   lists (ACLs).  This limits the point of attack to one routing
   protocol, for example, BGP.  A potential attack could be to send an
   extensive number of routes, or to flood the PE router with routing
   updates.  Both could lead to a DoS, however, not to unauthorised
   access.

   To reduce this risk, it is necessary to configure the routing
   protocol on the PE router to operate as securely as possible.  This
   can be done in various ways:

   o  By accepting only routing protocol packets, and only from the CE
      router.  The inbound ACL on each CE interface of the PE router
      should allow only routing protocol packets from the CE to the PE.
   o  By configuring MD5 authentication for routing protocols.  This is
      available for BGP (<a href="rfc2385.html">RFC 2385</a> [<a href="#ref-6" title='"Protection of BGP Sessions via the TCP MD5 Signature Option"'>6</a>]), OSPF (<a href="rfc2154.html">RFC 2154</a> [<a href="#ref-4" title='"OSPF with Digital Signatures"'>4</a>]), and RIP2
      (<a href="rfc2082.html">RFC 2082</a> [<a href="#ref-3" title='"RIP-2 MD5 Authentication"'>3</a>]), for example.  This avoids packets being spoofed
      from other parts of the customer network than the CE router.  It
      requires the service provider and customer to agree on a shared
      secret between all CE and PE routers.  It is necessary to do this
      for all VPN customers.  It is not sufficient to do this only for
      the customer with the highest security requirements.



<span class="grey">Behringer                    Informational                     [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc4381.html">RFC 4381</a>              Security of BGP/MPLS IP VPNs         February 2006</span>


   o  By configuring parameters of the routing protocol to further
      secure this communication.  For example, the rate of routing
      updates should be restricted where possible (in BGP through
      damping); a maximum number of routes accepted per VRF and per
      routing neighbor should be configured where possible; and the
      Generalized TTL Security Mechanism (GTSM; <a href="rfc3682.html">RFC 3682</a> [<a href="#ref-10" title='"The Generalized TTL Security Mechanism (GTSM)"'>10</a>]) should be
      used for all supported protocols.

   In summary, it is not possible to intrude from one VPN into other
   VPNs, or the core.  However, it is theoretically possible to attack
   the routing protocol port to execute a DoS attack against the PE
   router.  This in turn might have a negative impact on other VPNs on
   this PE router.  For this reason, PE routers must be extremely well
   secured, especially on their interfaces to CE routers.  ACLs must be
   configured to limit access only to the port(s) of the routing
   protocol, and only from the CE router.  Further routing protocols'
   security mechanisms such as MD5 authentication, maximum prefix
   limits, and Time to Live (TTL) security mechanisms should be used on
   all PE-CE peerings.  With all these security measures, the only
   possible attack is a DoS attack against the routing protocol itself.
   BGP has a number of countermeasures such as prefix filtering and
   damping built into the protocol, to assist with stability.  It is
   also easy to track the source of such a potential DoS attack.
   Without dynamic routing between CEs and PEs, the security is
   equivalent to the security of ATM or Frame Relay networks.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.4.%20%20Label%20Spoofing"></a><a class="selflink" href="#section-3.4" name="section-3.4">3.4</a>.  Label Spoofing</span>

   Similar to IP spoofing attacks, where an attacker fakes the source IP
   address of a packet, it is also theoretically possible to spoof the
   label of an MPLS packet.  In the first section, the assumption was
   made that the core network is trusted.  If this assumption cannot be
   made, IPsec must be run over the MPLS cloud.  Thus in this section
   the emphasis is on whether it is possible to insert packets with
   spoofed labels into the MPLS network from the outside, i.e., from a
   VPN (CE router) or from the Internet.

   The interface between a CE router and its peering PE router is an IP
   interface, i.e., without labels.  The CE router is unaware of the
   MPLS core, and thinks it is sending IP packets to another router.
   The "intelligence" is done in the PE device, where, based on the
   configuration, the label is chosen and pre-pended to the packet.
   This is the case for all PE routers, towards CE routers as well as
   the upstream service provider.  All interfaces into the MPLS cloud
   only require IP packets, without labels.






<span class="grey">Behringer                    Informational                     [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc4381.html">RFC 4381</a>              Security of BGP/MPLS IP VPNs         February 2006</span>


   For security reasons, a PE router should never accept a packet with a
   label from a CE router.  <a href="rfc3031.html">RFC 3031</a> [<a href="#ref-9" title='"Multiprotocol Label Switching Architecture"'>9</a>] specifies: "Therefore, when a
   labeled packet is received with an invalid incoming label, it MUST be
   discarded, UNLESS it is determined by some means (not within the
   scope of the current document) that forwarding it unlabeled cannot
   cause any harm."  Since accepting labels on the CE interface would
   potentially allow passing packets to other VPNs it is not permitted
   by the RFC.

   Thus, it is impossible for an outside attacker to send labeled
   packets into the BGP/MPLS IP VPN core.

   There remains the possibility to spoof the IP address of a packet
   being sent to the MPLS core.  Since there is strict address
   separation within the PE router, and each VPN has its own VRF, this
   can only harm the VPN the spoofed packet originated from; that is, a
   VPN customer can attack only himself.  MPLS doesn't add any security
   risk here.

   The Inter-AS and Carrier's Carrier cases are special cases, since on
   the interfaces between providers typically packets with labels are
   exchanged.  See <a href="#section-4">section 4</a> for an analysis of these architectures.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.5.%20%20Comparison%20with%20ATM%2FFR%20VPNs"></a><a class="selflink" href="#section-3.5" name="section-3.5">3.5</a>.  Comparison with ATM/FR VPNs</span>

   ATM and FR VPN services enjoy a very high reputation in terms of
   security.  Although ATM and FR VPNs can be provided in a secure
   manner, it has been reported that these technologies also can have
   security vulnerabilities [<a href="#ref-14" title='"Data Communications Report, Vol 15, No 4: Frame Relay and ATM: Are they really secure?"'>14</a>].  In ATM/FR as in any other networking
   technology, the security depends on the configuration of the network
   being secure, and errors can also lead to security problems.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Security%20of%20Advanced%20BGP%2FMPLS%20IP%20VPN%20Architectures"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Security of Advanced BGP/MPLS IP VPN Architectures</span>

   The BGP/MPLS IP VPN architecture described in <a href="rfc2547.html">RFC 2547</a> [<a href="#ref-7" title='"BGP/MPLS VPNs"'>7</a>] defines
   the PE-CE interface as the only external interface seen from the
   service provider network.  In this case, the PE treats the CE as
   untrusted and only accepts IP packets from the CE.  The IP address
   range is treated as belonging to the VPN of the CE, so the PE
   maintains full control over VPN separation.

   <a href="rfc4364.html">RFC 4364</a> [<a href="#ref-1" title='"BGP/MPLS IP Virtual Private Networks (VPNs)"'>1</a>] has subsequently defined a more complex architecture,
   with more open interfaces.  These interfaces allow the exchange of
   label information and labeled packets to and from devices outside the
   control of the service provider.  This section discusses the security
   implications of this advanced architecture.





<span class="grey">Behringer                    Informational                     [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc4381.html">RFC 4381</a>              Security of BGP/MPLS IP VPNs         February 2006</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.1.%20%20Carriers%27%20Carrier"></a><a class="selflink" href="#section-4.1" name="section-4.1">4.1</a>.  Carriers' Carrier</span>

   In the Carriers' Carrier (CsC) architecture, the CE is linked to a
   VRF on the PE.  The CE may send labeled packets to the PE.  The label
   has been previously assigned by the PE to the CE, and represents the
   label switched path (LSP) from this CE to the remote CE via the
   carrier's network.

   <a href="rfc4364.html">RFC 4364</a> [<a href="#ref-1" title='"BGP/MPLS IP Virtual Private Networks (VPNs)"'>1</a>] specifies for this case: "When the PE receives a labeled
   packet from a CE, it must verify that the top label is one that was
   distributed to that CE."  This ensures that the CE can only use
   labels that the PE correctly associates with the corresponding VPN.
   Packets with incorrect labels will be discarded, and thus label
   spoofing is impossible.

   The use of label maps on the PE leaves the control of the label
   information entirely with the PE, so that this has no impact on the
   security of the solution.

   The packet underneath the top label will -- as in standard <a href="rfc2547.html">RFC 2547</a>
   [<a href="#ref-7" title='"BGP/MPLS VPNs"'>7</a>] networks -- remain local to the customer carrier's VPN and not be
   inspected in the carriers' carrier core.  Potential spoofing of
   subsequent labels or IP addresses remains local to the carrier's VPN;
   it has no implication on the carriers' carrier core nor on other VPNs
   in that core.  This is specifically stated in <a href="rfc4364.html#section-6">section 6 of RFC 4364</a>
   [<a href="#ref-1" title='"BGP/MPLS IP Virtual Private Networks (VPNs)"'>1</a>].

   Note that if the PE and CE are interconnected using a shared layer 2
   infrastructure such as a switch, attacks are possible on layer 2,
   which might enable a third party on the shared layer 2 network to
   intrude into a VPN on that PE router.  <a href="rfc4364.html">RFC 4364</a> [<a href="#ref-1" title='"BGP/MPLS IP Virtual Private Networks (VPNs)"'>1</a>] specifies
   therefore that either all devices on a shared layer 2 network have to
   be part of the same VPN, or the layer 2 network must be split
   logically to avoid this issue.  This will be discussed in more detail
   in <a href="#section-6">section 6</a>.

   In the CsC architecture, the customer carrier needs to trust the
   carriers' carrier for correct configuration and operation.  The
   customer of the carrier thus implicitly needs to trust both his
   carrier and the carriers' carrier.

   In summary, a correctly configured carriers' carrier network provides
   the same level of security as comparable layer 2 networks or
   traditional <a href="rfc2547.html">RFC 2547</a> [<a href="#ref-7" title='"BGP/MPLS VPNs"'>7</a>] networks.







<span class="grey">Behringer                    Informational                     [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc4381.html">RFC 4381</a>              Security of BGP/MPLS IP VPNs         February 2006</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.2.%20%20Inter-Provider%20Backbones"></a><a class="selflink" href="#section-4.2" name="section-4.2">4.2</a>.  Inter-Provider Backbones</span>

   <a href="rfc4364.html">RFC 4364</a> [<a href="#ref-1" title='"BGP/MPLS IP Virtual Private Networks (VPNs)"'>1</a>] specifies three sub-cases for the inter-provider
   backbone (Inter-AS) case.

   a) VRF-to-VRF connections at the autonomous system border routers
   (ASBRs).

   In this case, each PE sees and treats the other PE as a CE; each will
   not accept labeled packets, and there is no signaling between the PEs
   other than inside the VRFs on both sides.  Thus, the separation of
   the VPNs on both sides and the security of those are the same as on a
   single AS <a href="rfc2547.html">RFC 2547</a> [<a href="#ref-7" title='"BGP/MPLS VPNs"'>7</a>] network.  This has already been shown to have
   the same security properties as traditional layer 2 VPNs.

   This solution has potential scalability issues in that the ASBRs need
   to maintain a VRF per VPN, and all of the VRFs need to hold all
   routes of the specific VPNs.  Thus, an ASBR can run into memory
   problems affecting all VPNs if one single VRF contains too many
   routes.  Thus, the service providers needs to ensure that the ASBRs
   are properly dimensioned and apply appropriate security measures such
   as limiting the number of prefixes per VRF.

   The two service providers connecting their VPNs in this way must
   trust each other.  Since the VPNs are separated on different
   (sub-)interfaces, all signaling between ASBRs remains within a given
   VPN.  This means that dynamic cross-VPN security breaches are
   impossible.  It is conceivable that a service provider connects a
   specific VPN to the wrong interface, thus interconnecting two VPNs
   that should not be connected.  This must be controlled operationally.

   b) EBGP redistribution of labeled VPN-IPv4 routes from AS to
   neighboring AS.

   In this case, ASBRs on both sides hold full routing information for
   all shared VPNs on both sides.  This is not held in separate VRFs,
   but in the BGP database.  (This is typically limited to the Inter-AS
   VPNs through filtering.)  The separation inside the PE is maintained
   through the use of VPN-IPv4 addresses.  The control plane between the
   ASBRs uses Multi-Protocol BGP (MP-BGP, <a href="rfc2858.html">RFC 2858</a> [<a href="#ref-8" title='"Multiprotocol Extensions for BGP-4"'>8</a>]).  It exchanges
   VPN routes as VPN-IPv4 addresses, the ASBR addresses as BGP next-hop
   IPv4 addresses, and labels to be used in the data plane.

   The data plane is separated through the use of a single label,
   representing a VRF or a subset thereof.  <a href="rfc4364.html">RFC 4364</a> [<a href="#ref-1" title='"BGP/MPLS IP Virtual Private Networks (VPNs)"'>1</a>] states that an
   ASBR should only accept packets with a label that it has assigned to
   this router.  This prevents the insertion of packets with unknown
   labels, but it is possible for a service provider to use any label



<span class="grey">Behringer                    Informational                     [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc4381.html">RFC 4381</a>              Security of BGP/MPLS IP VPNs         February 2006</span>


   that the ASBR of the other provider has passed on.  This allows one
   provider to insert packets into any VPN of the other provider for
   which it has a label.

   This solution also needs to consider the security on layer 2 at the
   interconnection.  The RFC states that this type of interconnection
   should only be implemented on private interconnection points.  See
   <a href="#section-6">section 6</a> for more details.

   <a href="rfc4364.html">RFC 4364</a> [<a href="#ref-1" title='"BGP/MPLS IP Virtual Private Networks (VPNs)"'>1</a>] states that a trust relationship between the two
   connecting ASes must exist for this model to work securely.
   Effectively, all ASes interconnected in this way form a single zone
   of trust.  The VPN customer needs to trust all the service providers
   involved in the provisioning of his VPN on this architecture.

   c) PEs exchange labeled VPN-IPv4 routes, ASBRs only exchange
   loopbacks of PEs with labels.

   In this solution, there are effectively two control connections
   between ASes.  The route reflectors (RRs) exchange the VPN-IPv4
   routes via multihop eBGP.  The ASBRs only exchange the labeled
   addresses of those PE routers that hold VPN routes that are shared
   between those ASes.  This maintains scalability for the ASBRs, since
   they do not need to know the VPN-IPv4 routes.

   In this solution, the top label specifies an LSP to an egress PE
   router, and the second label specifies a VPN connected to this egress
   PE.  The security of the ASBR connection has the same constraints as
   in solution b): An ASBR should only accept packets with top labels
   that it has assigned to the other router, thus verifying that the
   packet is addressed to a valid PE router.  Any label, which was
   assigned to the other ASBR, will be accepted.  It is impossible for
   an ASBR to distinguish between different egress PEs or between
   different VPNs on those PEs.  A malicious service provider of one AS
   could introduce packets into any VPN on a PE of the other AS; it only
   needs a valid LSP on its ASBR and PEs to the corresponding PE on the
   other AS.  The VPN label can be statistically guessed from the
   theoretical label space, which allows unidirectional traffic into a
   VPN.

   This means that such an ASBR-ASBR connection can only be made with a
   trusted party over a private interface, as described in b).

   In addition, this solution exchanges labeled VPN-IPv4 addresses
   between route reflectors (RRs) via MP-eBGP.  The control plane itself
   can be protected via routing authentication (<a href="rfc2385.html">RFC 2385</a> [<a href="#ref-6" title='"Protection of BGP Sessions via the TCP MD5 Signature Option"'>6</a>]), which
   ensures that the routing information has been originated by the
   expected RR and has not been modified in transit.  The received VPN



<span class="grey">Behringer                    Informational                     [Page 15]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc4381.html">RFC 4381</a>              Security of BGP/MPLS IP VPNs         February 2006</span>


   information cannot be verified, as in the previous case.  Thus, a
   service provider can introduce bogus routes for any shared VPN.  The
   ASes need to trust each other to configure their respective networks
   correctly.  All ASes involved in this design form one trusted zone.
   The customer needs to trust all service providers involved.

   The difference between case b) and case c) is that in b) the ASBRs
   act as iBGP next-hops for their AS; thus, each SP needs to know of
   the other SP's core only the addresses of the ASBRs.  In case c), the
   SPs exchange the loopback addresses of their PE routers; thus, each
   SP reveals information to the other about its PE routers, and these
   routers must be accessible from the other AS.  As stated above,
   accessibility does not necessarily mean insecurity, and networks
   should never rely on "security through obscurity".  This should not
   be an issue if the PE routers are appropriately secured.  However,
   there is an increasing perception that network devices should
   generally not be accessible.

   In addition, there are scalability considerations for case c).  A
   number of BGP peerings have to be made for the overall network
   including all ASes linked this way.  SPs on both sides need to work
   together in defining a scalable architecture, probably with route
   reflectors.

   In summary, all of these Inter-AS solutions logically merge several
   provider networks.  For all cases of Inter-AS configuration, all ASes
   form a single zone of trust and service providers need to trust each
   other.  For the VPN customer, the security of the overall solution is
   equal to the security of traditional <a href="rfc2547.html">RFC 2547</a> [<a href="#ref-7" title='"BGP/MPLS VPNs"'>7</a>] networks, but the
   customer needs to trust all service providers involved in the
   provisioning of this Inter-AS solution.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20What%20BGP%2FMPLS%20IP%20VPNs%20Do%20Not%20Provide"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  What BGP/MPLS IP VPNs Do Not Provide</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.1.%20%20Protection%20against%20Misconfigurations%20of%20the%20Core%20and%20Attacks"></a><a class="selflink" href="#section-5.1" name="section-5.1">5.1</a>.  Protection against Misconfigurations of the Core and Attacks</span>
      'within' the Core

   The security mechanisms discussed here assume correct configuration
   of the network elements of the core network (PE and P routers).
   Deliberate or inadvertent misconfiguration may result in severe
   security leaks.

   Note that this paragraph specifically refers to the core network,
   i.e., the PE and P elements.  Misconfigurations of any of the
   customer side elements such as the CE router are covered by the
   security mechanisms above.  This means that a potential attacker must
   have access to either PE or P routers to gain advantage from
   misconfigurations.  If an attacker has access to core elements, or is



<span class="grey">Behringer                    Informational                     [Page 16]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc4381.html">RFC 4381</a>              Security of BGP/MPLS IP VPNs         February 2006</span>


   able to insert into the core additional equipment, he will be able to
   attack both the core network and the connected VPNs.  Thus, the
   following is important:

   o  To avoid the risk of misconfigurations, it is important that the
      equipment is easy to configure and that SP staff have the
      appropriate training and experience when configuring the network.
      Proper tools are required to configure the core network.
   o  To minimise the risk of "internal" attacks, the core network must
      be properly secured.  This includes network element security,
      management security, physical security of the service provider
      infrastructure, access control to service provider installations,
      and other standard SP security mechanisms.

   BGP/MPLS IP VPNs can only provide a secure service if the core
   network is provided in a secure fashion.  This document assumes this
   to be the case.

   There are various approaches to control the security of a core if the
   VPN customer cannot or does not want to trust the service provider.
   IPsec from customer-controlled devices is one of them.  The document
   "CE-to-CE Member Verification for Layer 3 VPNs" [<a href="#ref-13" title='"CE-to-CE Member Verification for Layer 3 VPNs"'>13</a>] proposes a
   CE-based authentication scheme using tokens, aimed at detecting
   misconfigurations in the MPLS core.  The document "MPLS VPN
   Import/Export Verification" [<a href="#ref-12" title='"MPLS VPN Import/Export Verification"'>12</a>] proposes a similar scheme based on
   using the MD5 routing authentication.  Both schemes aim to detect and
   prevent misconfigurations in the core.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.2.%20%20Data%20Encryption%2C%20Integrity%2C%20and%20Origin%20Authentication"></a><a class="selflink" href="#section-5.2" name="section-5.2">5.2</a>.  Data Encryption, Integrity, and Origin Authentication</span>

   BGP/MPLS IP VPNs themselves do not provide encryption, integrity, or
   authentication service.  If these are required, IPsec should be used
   over the MPLS infrastructure.  The same applies to ATM and Frame
   Relay: IPsec can provide these missing services.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.3.%20%20Customer%20Network%20Security"></a><a class="selflink" href="#section-5.3" name="section-5.3">5.3</a>.  Customer Network Security</span>

   BGP/MPLS IP VPNs can be secured so that they are comparable with
   other VPN services.  However, the security of the core network is
   only one factor for the overall security of a customer's network.
   Threats in today's networks do not come only from an "outside"
   connection, but also from the "inside" and from other entry points
   (modems, for example).  To reach a good security level for a customer
   network in a BGP/MPLS infrastructure, MPLS security is necessary but
   not sufficient.  The same applies to other VPN technologies like ATM
   or Frame Relay.  See also <a href="rfc2196.html">RFC 2196</a> [<a href="#ref-5" title='"Site Security Handbook"'>5</a>] for more information on how to
   secure a network.




<span class="grey">Behringer                    Informational                     [Page 17]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc4381.html">RFC 4381</a>              Security of BGP/MPLS IP VPNs         February 2006</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20Layer%202%20Security%20Considerations"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  Layer 2 Security Considerations</span>

   In most cases of Inter-AS or Carrier's Carrier solutions, a network
   will be interconnected to other networks via a point-to-point private
   connection.  This connection cannot be interfered with by third
   parties.  It is important to understand that the use of any
   shared-medium layer 2 technology for such interconnections, such as
   Ethernet switches, may carry additional security risks.

   There are two types of risks with layer 2 infrastructure:

   a) Attacks against layer 2 protocols or mechanisms

   Risks in a layer 2 environment include many different forms of
   Address Resolution Protocol (ARP) attacks, VLAN trunking attacks, or
   Content Addressable Memory (CAM) overflow attacks.  For example, ARP
   spoofing allows an attacker to redirect traffic between two routers
   through his device, gaining access to all packets between those two
   routers.

   These attacks can be prevented by appropriate security measures, but
   often these security concerns are overlooked.  It is of the utmost
   importance that if a shared medium (such as a switch) is used in the
   above scenarios, that all available layer 2 security mechanisms are
   used to prevent layer 2 based attacks.

   b) Traffic insertion attacks

   Where many routers share a common layer 2 network (for example, at an
   Internet exchange point), it is possible for a third party to
   introduce packets into a network.  This has been abused in the past
   on traditional exchange points when some service providers have
   defaulted to another provider on this exchange point.  In effect,
   they are sending all their traffic into the other SP's network even
   though the control plane (routing) might not allow that.

   For this reason, routers on exchange points (or other shared layer 2
   connections) should only accept non-labeled IP packets into the
   global routing table.  Any labeled packet must be discarded.  This
   maintains the security of connected networks.

   Some of the above designs require the exchange of labeled packets.
   This would make it possible for a third party to introduce labeled
   packets, which if correctly crafted might be associated with certain
   VPNs on an BGP/MPLS IP VPN network, effectively introducing false
   packets into a VPN.





<span class="grey">Behringer                    Informational                     [Page 18]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-19" id="page-19" name="page-19"> </a>
<span class="grey"><a href="rfc4381.html">RFC 4381</a>              Security of BGP/MPLS IP VPNs         February 2006</span>


   The current recommendation is therefore to discard labeled packets on
   generic shared-medium layer 2 networks such as Internet exchange
   points (IXPs).  Where labeled packets need to be exchanged, it is
   strongly recommended to use private connections.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20Summary%20and%20Conclusions"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  Summary and Conclusions</span>

   BGP/MPLS IP VPNs provide full address and traffic separation as in
   traditional layer-2 VPN services.  It hides addressing structures of
   the core and other VPNs, and it is not possible to intrude into other
   VPNs abusing the BGP/MPLS mechanisms.  It is also impossible to
   intrude into the MPLS core if this is properly secured.  However,
   there is a significant difference between BGP/MPLS-based IP VPNs and,
   for example, FR- or ATM-based VPNs: The control structure of the core
   is layer 3 in the case of MPLS.  This caused significant skepticism
   in the industry towards MPLS, since this might open the architecture
   to DoS attacks from other VPNs or the Internet (if connected).

   As shown in this document, it is possible to secure a BGP/MPLS IP VPN
   infrastructure to the same level of security as a comparable ATM or
   FR service.  It is also possible to offer Internet connectivity to
   MPLS VPNs in a secure manner, and to interconnect different VPNs via
   firewalls.  Although ATM and FR services have a strong reputation
   with regard to security, it has been shown that also in these
   networks security problems can exist [<a href="#ref-14" title='"Data Communications Report, Vol 15, No 4: Frame Relay and ATM: Are they really secure?"'>14</a>].

   As far as attacks from within the MPLS core are concerned, all VPN
   classes (BGP/MPLS, FR, ATM) have the same problem: If an attacker can
   install a sniffer, he can read information in all VPNs, and if the
   attacker has access to the core devices, he can execute a large
   number of attacks, from packet spoofing to introducing new peer
   routers.  There are a number of precautionary measures outlined above
   that a service provider can use to tighten security of the core, but
   the security of the BGP/MPLS IP VPN architecture depends on the
   security of the service provider.  If the service provider is not
   trusted, the only way to fully secure a VPN against attacks from the
   "inside" of the VPN service is to run IPsec on top, from the CE
   devices or beyond.

   This document discussed many aspects of BGP/MPLS IP VPN security.  It
   has to be noted that the overall security of this architecture
   depends on all components and is determined by the security of the
   weakest part of the solution.  For example, a perfectly secured
   static BGP/MPLS IP VPN network with secured Internet access and
   secure management is still open to many attacks if there is a weak
   remote access solution in place.





<span class="grey">Behringer                    Informational                     [Page 19]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-20" id="page-20" name="page-20"> </a>
<span class="grey"><a href="rfc4381.html">RFC 4381</a>              Security of BGP/MPLS IP VPNs         February 2006</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20Security%20Considerations"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  Security Considerations</span>

   The entire document is discussing security considerations of the <a href="rfc4364.html">RFC</a>
   <a href="rfc4364.html">4364</a> [<a href="#ref-1" title='"BGP/MPLS IP Virtual Private Networks (VPNs)"'>1</a>] architecture.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/9.%20%20Acknowledgements"></a><a class="selflink" href="#section-9" name="section-9">9</a>.  Acknowledgements</span>

   The author would like to thank everybody who has provided input to
   this document.  Specific thanks go to Yakov Rekhter, for his
   continued strong support, and Eric Rosen, Loa Andersson, Alexander
   Renner, Jim Guichard, Monique Morrow, Eric Vyncke, and Steve Simlo,
   for their extended feedback and support.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/10.%20%20Normative%20References"></a><a class="selflink" href="#section-10" name="section-10">10</a>.  Normative References</span>

   [<a id="ref-1" name="ref-1">1</a>]   Rosen, E. and Y. Rekhter, "BGP/MPLS IP Virtual Private Networks
         (VPNs)", <a href="rfc4364.html">RFC 4364</a>, February 2006.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/11.%20%20Informative%20References"></a><a class="selflink" href="#section-11" name="section-11">11</a>.  Informative References</span>

   [<a id="ref-2" name="ref-2">2</a>]   Rekhter, Y., Moskowitz, R., Karrenberg, D., Groot, G., and E.
         Lear, "Address Allocation for Private Internets", <a href="https://tools.ietf.org/html/bcp5">BCP 5</a>,
         <a href="rfc1918.html">RFC 1918</a>, February 1996.

   [<a id="ref-3" name="ref-3">3</a>]   Baker, F., Atkinson, R., and G. Malkin, "RIP-2 MD5
         Authentication", <a href="rfc2082.html">RFC 2082</a>, January 1997.

   [<a id="ref-4" name="ref-4">4</a>]   Murphy, S., Badger, M., and B. Wellington, "OSPF with Digital
         Signatures", <a href="rfc2154.html">RFC 2154</a>, June 1997.

   [<a id="ref-5" name="ref-5">5</a>]   Fraser, B., "Site Security Handbook", <a href="rfc2196.html">RFC 2196</a>, September 1997.

   [<a id="ref-6" name="ref-6">6</a>]   Heffernan, A., "Protection of BGP Sessions via the TCP MD5
         Signature Option", <a href="rfc2385.html">RFC 2385</a>, August 1998.

   [<a id="ref-7" name="ref-7">7</a>]   Rosen, E. and Y. Rekhter, "BGP/MPLS VPNs", <a href="rfc2547.html">RFC 2547</a>,
         March 1999.

   [<a id="ref-8" name="ref-8">8</a>]   Bates, T., Rekhter, Y., Chandra, R., and D. Katz,
         "Multiprotocol Extensions for BGP-4", <a href="rfc2858.html">RFC 2858</a>, June 2000.

   [<a id="ref-9" name="ref-9">9</a>]   Rosen, E., Viswanathan, A., and R. Callon, "Multiprotocol Label
         Switching Architecture", <a href="rfc3031.html">RFC 3031</a>, January 2001.

   [<a id="ref-10" name="ref-10">10</a>]  Gill, V., Heasley, J., and D. Meyer, "The Generalized TTL
         Security Mechanism (GTSM)", <a href="rfc3682.html">RFC 3682</a>, February 2004.





<span class="grey">Behringer                    Informational                     [Page 20]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-21" id="page-21" name="page-21"> </a>
<span class="grey"><a href="rfc4381.html">RFC 4381</a>              Security of BGP/MPLS IP VPNs         February 2006</span>


   [<a id="ref-11" name="ref-11">11</a>]  Fang, L., "Security Framework for Provider-Provisioned Virtual
         Private Networks (PPVPNs)", <a href="rfc4111.html">RFC 4111</a>, July 2005.

   [<a id="ref-12" name="ref-12">12</a>]  Behringer, M., Guichard, J., and P. Marques, "MPLS VPN
         Import/Export Verification", Work in Progress, June 2004.

   [<a id="ref-13" name="ref-13">13</a>]  Bonica, R. and Y. Rekhter, "CE-to-CE Member Verification for
         Layer 3 VPNs", Work in Progress, September 2003.

   [<a id="ref-14" name="ref-14">14</a>]  DataComm, "Data Communications Report, Vol 15, No 4: Frame
         Relay and ATM: Are they really secure?", February 2000.

Author's Address

   Michael H. Behringer
   Cisco Systems Inc
   Village d'Entreprises Green Side
   400, Avenue Roumanille, Batiment T 3
   Biot - Sophia Antipolis  06410
   France

   EMail: mbehring@cisco.com
   URI:   <a href="http://www.cisco.com/">http://www.cisco.com</a>




























<span class="grey">Behringer                    Informational                     [Page 21]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-22" id="page-22" name="page-22"> </a>
<span class="grey"><a href="rfc4381.html">RFC 4381</a>              Security of BGP/MPLS IP VPNs         February 2006</span>


Full Copyright Statement

   Copyright (C) The Internet Society (2006).

   This document is subject to the rights, licenses and restrictions
   contained in <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and at www.rfc-editor.org/copyright.html, and
   except as set forth therein, the authors retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY AND THE INTERNET
   ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR IMPLIED,
   INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE
   INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and <a href="https://tools.ietf.org/html/bcp79">BCP 79</a>.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   <a href="http://www.ietf.org/ipr">http://www.ietf.org/ipr</a>.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.

Acknowledgement

   Funding for the RFC Editor function is provided by the IETF
   Administrative Support Activity (IASA).







Behringer                    Informational                     [Page 22]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc4381 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:42 GMT --></html>