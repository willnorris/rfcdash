<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc6572 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:29 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="urn:ietf:rfc:6572" name="DC.Identifier"/>
<meta content="This document defines new attributes to facilitate Proxy Mobile IPv6
operations using the RADIUS infrastructure. The protocol defined in
this document uses RADIUS-based interfaces of the mobile access
gateway and the local mobility anchor with the AAA server for
authentication, authorization, and policy functions. The RADIUS
interactions between the mobile access gateway and the RADIUS-based
AAA server take place when the mobile node (MN) attaches,
authenticates, and authorizes to a Proxy Mobile IPv6 domain.
Furthermore, this document defines the RADIUS-based interface between
the local mobility anchor and the AAA RADIUS server for authorizing
received Proxy Binding Update messages for the mobile node's
mobility session. In addition to the interactions related to mobility
session setup, this document defines the baseline for the mobile
access gateway and the local mobility anchor generated accounting.
[STANDARDS-TRACK]" name="DC.Description.Abstract"/>
<meta content="Xia, Frank" name="DC.Creator"/>
<meta content="Damic, Damjan" name="DC.Creator"/>
<meta content="Korhonen, Jouni" name="DC.Creator"/>
<meta content="Gundavelli, Sri" name="DC.Creator"/>
<meta content="Sarikaya, Behcet" name="DC.Creator"/>
<meta content="June, 2012" name="DC.Date.Issued"/>
<meta content="RADIUS Support for Proxy Mobile IPv6" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 6572 - RADIUS Support for Proxy Mobile IPv6</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgblue" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc6572.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc6572" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-netext-radius-pmip6" title="draft-ietf-netext-radius-pmip6">draft-ietf-nete...</a>] [<a href="https://datatracker.ietf.org/doc/rfc6572" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc6572" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc6572" title="Side-by-side diff">Diff2</a>]         </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">Updated by: <a href="rfc8044.html">8044</a>                                       PROPOSED STANDARD</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Internet Engineering Task Force (IETF)                            F. Xia
Request for Comments: 6572                                   B. Sarikaya
Category: Standards Track                                     Huawei USA
ISSN: 2070-1721                                         J. Korhonen, Ed.
                                                  Nokia Siemens Networks
                                                           S. Gundavelli
                                                                   Cisco
                                                                D. Damic
                                                                 Siemens
                                                               June 2012


                  <span class="h1">RADIUS Support for Proxy Mobile IPv6</span>

Abstract

   This document defines new attributes to facilitate Proxy Mobile IPv6
   operations using the RADIUS infrastructure.  The protocol defined in
   this document uses RADIUS-based interfaces of the mobile access
   gateway and the local mobility anchor with the AAA server for
   authentication, authorization, and policy functions.  The RADIUS
   interactions between the mobile access gateway and the RADIUS-based
   AAA server take place when the mobile node (MN) attaches,
   authenticates, and authorizes to a Proxy Mobile IPv6 domain.
   Furthermore, this document defines the RADIUS-based interface between
   the local mobility anchor and the AAA RADIUS server for authorizing
   received Proxy Binding Update messages for the mobile node's mobility
   session.  In addition to the interactions related to mobility session
   setup, this document defines the baseline for the mobile access
   gateway and the local mobility anchor generated accounting.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="rfc5741.html#section-2">Section 2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc6572">http://www.rfc-editor.org/info/rfc6572</a>.







<span class="grey">Xia, et al.                  Standards Track                    [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc6572.html">RFC 6572</a>                      RADIUS PMIPv6                    June 2012</span>


Copyright Notice

   Copyright (c) 2012 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.





































<span class="grey">Xia, et al.                  Standards Track                    [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc6572.html">RFC 6572</a>                      RADIUS PMIPv6                    June 2012</span>


Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-4">4</a>
   <a href="#section-2">2</a>. Terminology .....................................................<a href="#page-4">4</a>
   <a href="#section-3">3</a>. Solution Overview ...............................................<a href="#page-5">5</a>
   <a href="#section-4">4</a>. Attribute Definitions ...........................................<a href="#page-9">9</a>
      <a href="#section-4.1">4.1</a>. MIP6-Feature-Vector ........................................<a href="#page-9">9</a>
      <a href="#section-4.2">4.2</a>. Mobile-Node-Identifier ....................................<a href="#page-11">11</a>
      <a href="#section-4.3">4.3</a>. Service-Selection .........................................<a href="#page-12">12</a>
      <a href="#section-4.4">4.4</a>. PMIP6-Home-LMA-IPv6-Address ...............................<a href="#page-12">12</a>
      <a href="#section-4.5">4.5</a>. PMIP6-Visited-LMA-IPv6-Address ............................<a href="#page-13">13</a>
      <a href="#section-4.6">4.6</a>. PMIP6-Home-LMA-IPv4-Address ...............................<a href="#page-14">14</a>
      <a href="#section-4.7">4.7</a>. PMIP6-Visited-LMA-IPv4-Address ............................<a href="#page-15">15</a>
      <a href="#section-4.8">4.8</a>. PMIP6-Home-HN-Prefix ......................................<a href="#page-15">15</a>
      <a href="#section-4.9">4.9</a>. PMIP6-Visited-HN-Prefix ...................................<a href="#page-16">16</a>
      <a href="#section-4.10">4.10</a>. PMIP6-Home-Interface-ID ..................................<a href="#page-18">18</a>
      <a href="#section-4.11">4.11</a>. PMIP6-Visited-Interface-ID ...............................<a href="#page-18">18</a>
      <a href="#section-4.12">4.12</a>. PMIP6-Home-IPv4-HoA ......................................<a href="#page-19">19</a>
      <a href="#section-4.13">4.13</a>. PMIP6-Visited-IPv4-HoA ...................................<a href="#page-20">20</a>
      <a href="#section-4.14">4.14</a>. PMIP6-Home-DHCP4-Server-Address ..........................<a href="#page-21">21</a>
      <a href="#section-4.15">4.15</a>. PMIP6-Visited-DHCP4-Server-Address .......................<a href="#page-22">22</a>
      <a href="#section-4.16">4.16</a>. PMIP6-Home-DHCP6-Server-Address ..........................<a href="#page-22">22</a>
      <a href="#section-4.17">4.17</a>. PMIP6-Visited-DHCP6-Server-Address .......................<a href="#page-23">23</a>
      <a href="#section-4.18">4.18</a>. Calling-Station-Id .......................................<a href="#page-24">24</a>
      <a href="#section-4.19">4.19</a>. Chargeable-User-Identity .................................<a href="#page-24">24</a>
      <a href="#section-4.20">4.20</a>. PMIP6-Home-IPv4-Gateway ..................................<a href="#page-25">25</a>
      <a href="#section-4.21">4.21</a>. PMIP6-Visited-IPv4-Gateway ...............................<a href="#page-25">25</a>
   <a href="#section-5">5</a>. MAG to RADIUS AAA Interface ....................................<a href="#page-26">26</a>
      <a href="#section-5.1">5.1</a>. Interface Operations ......................................<a href="#page-26">26</a>
      <a href="#section-5.2">5.2</a>. Table of Attributes .......................................<a href="#page-27">27</a>
   <a href="#section-6">6</a>. LMA to RADIUS AAA Interface ....................................<a href="#page-28">28</a>
      <a href="#section-6.1">6.1</a>. Interface Operations ......................................<a href="#page-28">28</a>
      <a href="#section-6.2">6.2</a>. Table of Attributes .......................................<a href="#page-30">30</a>
   <a href="#section-7">7</a>. Accounting .....................................................<a href="#page-31">31</a>
      <a href="#section-7.1">7.1</a>. Accounting at LMA .........................................<a href="#page-31">31</a>
      <a href="#section-7.2">7.2</a>. Accounting at MAG .........................................<a href="#page-32">32</a>
      <a href="#section-7.3">7.3</a>. Table of Attributes .......................................<a href="#page-32">32</a>
   <a href="#section-8">8</a>. Security Considerations ........................................<a href="#page-32">32</a>
   <a href="#section-9">9</a>. IANA Consideration .............................................<a href="#page-33">33</a>
      <a href="#section-9.1">9.1</a>. Attribute Type Codes ......................................<a href="#page-33">33</a>
      <a href="#section-9.2">9.2</a>. Namespaces ................................................<a href="#page-33">33</a>
   <a href="#section-10">10</a>. Acknowledgements ..............................................<a href="#page-34">34</a>
   <a href="#section-11">11</a>. References ....................................................<a href="#page-34">34</a>
      <a href="#section-11.1">11.1</a>. Normative References .....................................<a href="#page-34">34</a>
      <a href="#section-11.2">11.2</a>. Informative References ...................................<a href="#page-35">35</a>






<span class="grey">Xia, et al.                  Standards Track                    [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc6572.html">RFC 6572</a>                      RADIUS PMIPv6                    June 2012</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   Proxy Mobile IPv6 (PMIPv6) [<a href="rfc5213.html" title='"Proxy Mobile IPv6"'>RFC5213</a>] is a network-based mobility
   management protocol that allows IP mobility support for a mobile node
   without requiring the mobile node's participation in any mobility-
   related signaling.  The mobile management elements in the network,
   the mobile access gateway (MAG) and the local mobility anchor (LMA),
   are the two key functions in this network-based mobility system.  The
   mobile access gateway is responsible for detecting the mobile node's
   movements in the network and for initiating the needed mobility
   management signaling with the local mobility anchor (LMA).  Both the
   mobility management agents make use of the AAA infrastructure to
   retrieve the mobile node's policy profile and for performing service
   authorization.

   This document defines a RADIUS-based [<a href="rfc2865.html" title='"Remote Authentication Dial In User Service (RADIUS)"'>RFC2865</a>] profile and
   corresponding attributes to be used on the AAA interface between the
   MAG and the AAA RADIUS server.  This interface is used to carry the
   per-MN policy profile from the remote policy store to the MAG.
   Furthermore, this document also defines a RADIUS-based interface
   between the LMA and the AAA RADIUS server for authorization of the
   received Proxy Mobile IPv6 signaling messages.  The AAA procedures
   defined in this document cover the following two scenarios:

   o  a mobile node connects to the Proxy Mobile IPv6 domain from the
      home network

   o  a mobile node connects to the Proxy Mobile IPv6 domain from a
      visited network

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Terminology"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Terminology</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [<a href="rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].

   All the mobility-related terms used in this document are to be
   interpreted as defined in the Proxy Mobile IPv6 specifications
   [<a href="rfc5213.html" title='"Proxy Mobile IPv6"'>RFC5213</a>] and [<a href="rfc5844.html" title='"IPv4 Support for Proxy Mobile IPv6"'>RFC5844</a>].  Additionally, this document uses the
   following abbreviations:

   Network Access Server (NAS):

      A function that provides authorization services for a device/user
      access to the network as defined in [<a href="rfc2865.html" title='"Remote Authentication Dial In User Service (RADIUS)"'>RFC2865</a>].  This document
      makes an assumption that the NAS function is co-located with the





<span class="grey">Xia, et al.                  Standards Track                    [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc6572.html">RFC 6572</a>                      RADIUS PMIPv6                    June 2012</span>


      MAG.  In scenarios where the NAS function and MAG are decoupled,
      the messaging interface needed between them for the operation of
      PMIP6 is beyond the scope of this document.

   Home AAA (HAAA):

      An Authentication, Authorization, and Accounting (AAA) server
      located in the MN's home network.  This sever has access to the
      mobile node's policy profiles.

   Visited AAA (VAAA):

      An Authentication, Authorization, and Accounting (AAA) server
      located in the MN's visited network.  The VAAA server takes the
      role of a proxy-server, forwarding the received AAA service
      request to the HAAA server in the mobile node's home network and
      relaying the response to the requesting node, after applying any
      local access network policies.

   Local AAA (LAAA):

      An Authentication, Authorization, and Accounting proxy located in
      the local network.  In a roaming case, the local AAAA has the
      visited AAA role.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Solution%20Overview"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Solution Overview</span>

   This document defines the RADIUS-based AAA interactions with the two
   mobility management elements in the Proxy Mobile IPv6 domain.

   o  Interactions between a MAG and a RADIUS-based AAA server

   o  Interactions between a LMA and a RADIUS-based AAA server

   The mobile node's policy profile [<a href="rfc5213.html" title='"Proxy Mobile IPv6"'>RFC5213</a>] is present in a policy
   store and is needed by the PMIPv6 mobility management elements for
   authorizing the mobile node for mobility management service and for
   obtaining various service-related parameters.  This policy store
   could be locally co-located with the mobility management agents
   enabling direct local access or could be available from a AAA server
   through a RADIUS-based AAA interface.

   When a mobile node attaches to an access network, the NAS on that
   access network may activate the network access authentication
   procedure.  The choice of the authentication mechanism is specific to
   the access network deployment; however, it is typically based on the
   Extensible Authentication Protocol (EAP) [<a href="rfc3748.html" title='"Extensible Authentication Protocol (EAP)"'>RFC3748</a>].  The NAS performs
   the network access authentication and queries the HAAA using AAA



<span class="grey">Xia, et al.                  Standards Track                    [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc6572.html">RFC 6572</a>                      RADIUS PMIPv6                    June 2012</span>


   protocol, such as RADIUS.  If the network access authentication
   succeeds, the MN's policy profile is obtained as part of the RADIUS
   message exchange with the AAA server.

   The mobile node may be an IPv4-only node, IPv6-only node, or a dual-
   stack (IPv4/v6) node.  Based on the policy specified in the policy
   profile, the network access authentication procedure SHOULD provide
   the unambiguous indication of the type of address(es) to be assigned
   for the MN in the network and with all other service-related and
   policy parameters relevant to the mobility service.

   After the successful network access authentication and obtaining the
   mobile node's policy profile, the MAG sends a Proxy Binding Update
   (PBU) to the LMA.  Upon receiving the PBU, the LMA interacts with the
   HAAA to obtain the mobile node's policy profile, which is required
   for authorizing and activating mobility service.

   This document adds support for three distinct PMIPv6 mobility use
   cases, taking into account the administrative domains to which the
   MAG and the LMA belong.  The following are the three relevant
   deployment models.

   1.  the MAG and LMA are both in the home network,

   2.  the MAG and LMA are both in the visited network,

   3.  the MAG is in the visited network while the LMA is in the home
       network.

   Figure 1 shows participating network entities for the PMIPv6 mobility
   session, which is located in the home network.  The MAG and LMA
   interact only with the HAAA.



















<span class="grey">Xia, et al.                  Standards Track                    [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc6572.html">RFC 6572</a>                      RADIUS PMIPv6                    June 2012</span>


       +--------+
       | HAAA &amp; |  RADIUS  +-----+
       | Policy |&lt;--------&gt;| LMA |
       | Profile|          +-----+
       +--------+             | &lt;--- LMA-Address
            ^                 |
            |               // \\
        +---|------------- //---\\----------------+
       (    |  IPv4/IPv6  //     \\                )
       (    |   Network  //       \\               )
        +---|-----------//---------\\-------------+
            |          //           \\
          RADIUS      // &lt;- Tunnel1  \\ &lt;- Tunnel2
            |        //               \\
            |        |- MAG1-Address   |- MAG2-Address
            |     +----+             +----+
            +----&gt;|MAG1|             |MAG2|
                  +----+             +----+
                     |                 |
                     |                 |
                    MN1               MN2

          Figure 1: The MAG and LMA Are Both in the Home Network

   Figure 2 shows both the LMA and MAG are in the visited network.  The
   MAG and LMA exchange signaling with the HAAA through the VAAA, which
   acts as a Proxy.  The visited network may append additional
   information to the HAAA replies in order to reflect the local policy.























<span class="grey">Xia, et al.                  Standards Track                    [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc6572.html">RFC 6572</a>                      RADIUS PMIPv6                    June 2012</span>


                       +---------------+
                       |    HAAA &amp;     |
            +----------| Policy Profile|
            |          +---------------+
            |
       +---------+
       |[VL]AAA &amp;| RADIUS  +-----+
       | Policy  |&lt;-------&gt;| LMA |
       | Profile |         +-----+
       +---------+            | &lt;--- LMA-Address
            ^               // \\
        +---|------------- //---\\----------------+
       (    |  IPv4/IPv6  //     \\                )
       (    |   Network  //       \\               )
        +---|-----------//---------\\-------------+
            |          //           \\
          RADIUS      // &lt;- Tunnel1  \\ &lt;- Tunnel2
            |        //               \\
            |        |- MAG1-Address   |- MAG2-Address
            |     +----+             +----+
            +----&gt;|MAG1|             |MAG2|
                  +----+             +----+
                     |                 |
                    MN1               MN2

      Figure 2: The MAG and LMA Are Both in the Visited/Local Network

   Figure 3 illustrates a topology where the MAG resides in the visited
   network while the associated LMA is in MN's home network.  Any
   message between the MAG and the HAAA passes through the VAAA, which
   acts as a Proxy.  During the network authentication, the visited
   network's specific policy may also be propagated from the VAAA to the
   MAG.  The LMA has a direct access to the HAAA.


















<span class="grey">Xia, et al.                  Standards Track                    [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc6572.html">RFC 6572</a>                      RADIUS PMIPv6                    June 2012</span>


                       +---------------+
                       |    HAAA &amp;     |
            +----------| Policy Profile|
            |          +---------------+
            |                 |
            |               RADIUS
       +---------+            |
       |[VL]AAA &amp;|         +-----+
       | Policy  |         | LMA |
       | Profile |         +-----+
       +---------+            | &lt;--- LMA-Address
            ^               // \\
        +---|------------- //---\\----------------+
       (    |  IPv4/IPv6  //     \\                )
       (    |   Network  //       \\               )
        +---|-----------//---------\\-------------+
            |          //           \\
          RADIUS      // &lt;- Tunnel1  \\ &lt;- Tunnel2
            |        //               \\
            |        |- MAG1-Address   |- MAG2-Address
            |     +----+             +----+
            +----&gt;|MAG1|             |MAG2|
                  +----+             +----+
                     |                 |
                    MN1               MN2

                Figure 3: Visited MAG and Home LMA Topology

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Attribute%20Definitions"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Attribute Definitions</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.1.%20%20MIP6-Feature-Vector"></a><a class="selflink" href="#section-4.1" name="section-4.1">4.1</a>.  MIP6-Feature-Vector</span>

   Diameter [<a href="rfc3588.html" title='"Diameter Base Protocol"'>RFC3588</a>] reserves AVP Code space 1-255 as RADIUS attribute
   compatibility space.  The MIP6-Feature-Vector attribute (Type value
   124) defined in [<a href="rfc5447.html" title='"Diameter Mobile IPv6: Support for Network Access Server to Diameter Server Interaction"'>RFC5447</a>] is of type OctetString and contains a
   64-bit flags field of supported mobility capabilities.  This document
   reserves two new capability bits according to the rules in [<a href="rfc5447.html" title='"Diameter Mobile IPv6: Support for Network Access Server to Diameter Server Interaction"'>RFC5447</a>],
   and reuses the PMIPv6 capability bits defined by [<a href="rfc5779.html" title='"Diameter Proxy Mobile IPv6: Mobile Access Gateway and Local Mobility Anchor Interaction with Diameter Server"'>RFC5779</a>].  The
   following capability flag bits are used or defined in this document:

   PMIP6_SUPPORTED (0x0000010000000000)

      This capability bit is used as defined in [<a href="rfc5779.html" title='"Diameter Proxy Mobile IPv6: Mobile Access Gateway and Local Mobility Anchor Interaction with Diameter Server"'>RFC5779</a>].

   IP4_HOA_SUPPORTED (0x0000020000000000)

      This capability bit is used as defined in [<a href="rfc5779.html" title='"Diameter Proxy Mobile IPv6: Mobile Access Gateway and Local Mobility Anchor Interaction with Diameter Server"'>RFC5779</a>].  Assignment
      of the IPv4-HoA (Home Address) is defined by [<a href="rfc5844.html" title='"IPv4 Support for Proxy Mobile IPv6"'>RFC5844</a>].



<span class="grey">Xia, et al.                  Standards Track                    [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc6572.html">RFC 6572</a>                      RADIUS PMIPv6                    June 2012</span>


   LOCAL_MAG_ROUTING_SUPPORTED (0x0000040000000000)

      This capability bit is used as defined in [<a href="rfc5779.html" title='"Diameter Proxy Mobile IPv6: Mobile Access Gateway and Local Mobility Anchor Interaction with Diameter Server"'>RFC5779</a>].

   IP4_TRANSPORT_SUPPORTED (0x0000800000000000)

      This capability bit is used for negotiation of the IPv4 transport
      support between the MAG and AAA.  When the MAG sets this flag bit
      in the MIP6-Feature-Vector, it indicates the ability of the MAG to
      provide IPv4 transport (i.e., IPv4-based encapsulation) for
      carrying IP traffic between the MAG and the LMA.  If this flag bit
      is unset in the returned MIP6-Feature-Vector attribute, the AAA
      does not authorize the use of IPv4 transport on the MAG-to-LMA
      tunnel.

   IP4_HOA_ONLY_SUPPORTED (0x0001000000000000)

      This capability bit is used for determination of the authorized
      PMIPv6 mobility mode.  When this bit is set by the AAA, it
      indicates PMIPv6 mobility with IPv4 support has only been
      authorized for the MN.  As a result, the RADIUS Access-Accept
      SHOULD NOT carry the IPv6 Home Network Prefix (IPv6 HNP).  When
      this bit is set, the PMIP6_SUPPORTED flag MUST also be set and the
      IP4_HOA_SUPPORTED flag MUST NOT be set.

   To summarize the use of the MIP6-Feature-Vector the following
   capability bit combination settings mean:

      PMIP6-SUPPORTED bit set - only IPv6 mobility is supported and
      authorized.

      PMIP6-SUPPORTED and IP4-ONLY-HOA-SUPPORTED bits set - only IPv4
      mobility is supported and authorized.

      PMIP6-SUPPORTED and IP4-HOA-SUPPORTED bits set - both IPv6 and
      IPv4 mobility are supported and authorized.

   The MIP6-Feature-Vector attribute is also used on the LMA to the
   RADIUS AAA interface.  This capability announcement attribute enables
   direct capability negotiation between the LMA and the AAA.  The
   capabilities that are announced by both parties in the MIP6-Feature-
   Vector are known to be mutually supported.  The LMA may use this
   mechanism during authorization of the received PBU against the AAA to
   check individual PMIPv6 feature permissions for a particular MN.

   If the RADIUS Access-Accept contains a contradicting combination of
   the capability flag bits such as both the IP4_HOA_ONLY_SUPPORTED and
   the IP4_HOA_SUPPORTED flags being set, then the RADIUS client MUST



<span class="grey">Xia, et al.                  Standards Track                   [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc6572.html">RFC 6572</a>                      RADIUS PMIPv6                    June 2012</span>


   treat the Access-Accept as an Access-Reject and SHOULD log the event.
   Similarly, if the RADIUS Access-Request contains a contradicting
   combination of the capability flag bits, then the RADIUS server MUST
   reply with an Access-Reject message and SHOULD log the event.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.2.%20%20Mobile-Node-Identifier"></a><a class="selflink" href="#section-4.2" name="section-4.2">4.2</a>.  Mobile-Node-Identifier</span>

   The Mobile-Node-Identifier attribute (Type value 145) is of type
   String and contains the mobile node identifier (MN-Identifier), see
   [<a href="rfc5213.html" title='"Proxy Mobile IPv6"'>RFC5213</a>], in a form of a Network Access Identifier (NAI) [<a href="rfc4282.html" title='"The Network Access Identifier"'>RFC4282</a>].
   This identifier and the identifier used for access authentication may
   be different; however, there needs to be a mapping between the two
   identities as specified in <a href="rfc5213.html#section-6.6">Section 6.6 of [RFC5213]</a>.  This attribute
   is used on the interface between the MAG and the AAA server.  The
   Mobile-Node-Identifier attribute is designed for deployments where
   the identity used during network access authentication and the
   identity used for mobility management is decoupled.  It may also be
   the case where the MAG does not have means to find out the MN
   identity that could be used in subsequent PBU and Proxy Binding
   Acknowledgement (PBA) exchanges (e.g., due to identity hiding during
   the network access authentication) or when the HAAA wants to assign
   periodically changing identities to the MN.

   The Mobile-Node-Identifier attribute MAY be returned by the HAAA in
   the RADIUS Access-Accept message that completes a successful
   authentication and authorization exchange between the MAG and the
   HAAA.  The MAG MUST use the received MN-Identifier.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Type     |   Length      |   Mobile Node Identifier...   ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Type:
     Mobile-Node-Identifier 145.

   Length:
      In octets, including Type and Length fields (&gt;= 3).

   Mobile Node Identifier:
      This field is of type String and contains the MN-Identifier
      of the MN to be used in the PBU/PBA exchange.








<span class="grey">Xia, et al.                  Standards Track                   [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc6572.html">RFC 6572</a>                      RADIUS PMIPv6                    June 2012</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.3.%20%20Service-Selection"></a><a class="selflink" href="#section-4.3" name="section-4.3">4.3</a>.  Service-Selection</span>

   The Service-Selection attribute (Type value 146) is of type UTF-8
   text and contains the name of the service or the external network
   with which the mobility service for the particular MN SHOULD be
   associated [<a href="rfc5149.html" title='"Service Selection for Mobile IPv6"'>RFC5149</a>].  The identifier MUST be unique within the
   PMIPv6 Domain when normalized using the selected normalization form
   [<a href="#ref-UNF" title='"Unicode Standard Annex #15: Unicode Normalization Forms"'>UNF</a>] for the particular PMIPv6 Domain deployment.  For instance,
   [<a href="rfc5149.html" title='"Service Selection for Mobile IPv6"'>RFC5149</a>] uses the Normalization Form KC (NFKC).

   The MAG MUST include the Service-Selection attribute in the Access-
   Request sent to the AAA if the information was acquired, e.g., by
   operator-specific configuration.  The AAA MAY include the Service-
   Selection attribute in the Access-Accept response message to the MAG
   even if it was not included in the Access-Request as a means of
   indicating the MN's default service.

   The Service Selection mobility option defined in [<a href="rfc5149.html" title='"Service Selection for Mobile IPv6"'>RFC5149</a>] can be
   used in PBU/PBA messages between the MAG and LMA.  On the LMA-to-AAA
   interface, the LMA MAY populate the Service-Selection attribute in
   the Access-Request message using the service information found in the
   received PBU, if such a mobility option were included.  The Service-
   Selection identifier should be used to assist the PBU authorization,
   the assignment of the MN-HNP, and the IPv4-MN-HoA as described in
   [<a href="rfc5149.html" title='"Service Selection for Mobile IPv6"'>RFC5149</a>] and [<a href="rfc5779.html" title='"Diameter Proxy Mobile IPv6: Mobile Access Gateway and Local Mobility Anchor Interaction with Diameter Server"'>RFC5779</a>].

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Type     |   Length      |    Service Identifier...      ~
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Type:
      Service-Selection 146.

   Length:
      In octets, including Type and Length fields (&gt;= 3).

   Text:
      This field is of type UTF-8 text and contains the Service
      Identifier with which the MN is associated.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.4.%20%20PMIP6-Home-LMA-IPv6-Address"></a><a class="selflink" href="#section-4.4" name="section-4.4">4.4</a>.  PMIP6-Home-LMA-IPv6-Address</span>

   The PMIP6-Home-LMA-IPv6-Address attribute (Type value 147) is of type
   IPv6 address and is used to deliver the IPv6 address of the LMA
   located in the home network.




<span class="grey">Xia, et al.                  Standards Track                   [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc6572.html">RFC 6572</a>                      RADIUS PMIPv6                    June 2012</span>


   Before the MAG can initiate Proxy Mobile IPv6 signaling, it must be
   aware of the LMA's IP address.

   When the LMA is assigned to the MN from the home network, this
   attribute MAY be sent by the HAAA to the MAG in the RADIUS Access-
   Accept message.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Type     |   Length      |    Home LMA IPv6 address
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                          Home LMA IPv6 address
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                          Home LMA IPv6 address
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                          Home LMA IPv6 address
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       Home LMA IPv6 address       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Type:
     PMIP6-Home-LMA-IPv6-Address 147.

   Length:
      = 18 octets

   Home LMA IPv6 address:
      128-bit IPv6 address of the assigned home LMA IPv6 address.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.5.%20%20PMIP6-Visited-LMA-IPv6-Address"></a><a class="selflink" href="#section-4.5" name="section-4.5">4.5</a>.  PMIP6-Visited-LMA-IPv6-Address</span>

   The PMIP6-Visited-LMA-IPv6-Address attribute (Type value 148) is of
   type IPv6 address and is used to propose a particular LMA in the
   visited network and to authorize the use of the LMA in the visited/
   local network.

   PMIP6-Visited-LMA-IPv6-Address attribute MAY be included by the MAG
   in the RADIUS Access-Request message.  The LMA in the visited/local
   network may be assigned by the [VL]AAA as the result of retrieved
   policy profile.  If included by the [VL]AAA in the RADIUS Access-
   Accept sent to the MAG, the use of the LMA in the visited/local
   network is authorized and the attribute SHALL carry the IPv6 address
   of the LMA assigned for the particular MN.  See <a href="rfc5447.html#section-4.2.5">Section 4.2.5 of
   [RFC5447]</a> how the MIP6-Feature-Vector attribute and
   LOCAL_HOME_AGENT_ASSIGNMENT capability flag is used with the LMA
   (Home Agent) assignment.




<span class="grey">Xia, et al.                  Standards Track                   [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc6572.html">RFC 6572</a>                      RADIUS PMIPv6                    June 2012</span>


    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Type     |   Length      |   Visited LMA IPv6 address
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                        Visited LMA IPv6 address
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                        Visited LMA IPv6 address
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                        Visited LMA IPv6 address
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      Visited LMA IPv6 address     |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Type:
     PMIP6-Visited-LMA-IPv6-Address 148.

   Length:
      = 18 octets

   Visited LMA IPv6 address:
      128-bit IPv6 address of the assigned visited LMA IPv6 address.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.6.%20%20PMIP6-Home-LMA-IPv4-Address"></a><a class="selflink" href="#section-4.6" name="section-4.6">4.6</a>.  PMIP6-Home-LMA-IPv4-Address</span>

   The PMIP6-Home-LMA-IPv4-Address attribute (Type value 149) is of type
   IPv4 address and contains the IPv4 address of the LMA assigned by the
   HAAA.  The [<a href="rfc5844.html" title='"IPv4 Support for Proxy Mobile IPv6"'>RFC5844</a>] supports Proxy Mobile IPv6 signaling exchange
   between MAG and LMA using the IPv4 transport.

   When the LMA is located in the home network, this attribute MAY be
   sent by the HAAA to the MAG in the RADIUS Access-Accept message.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Type     |   Length      |  Home LMA IPv4 address
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       Home LMA IPv4 address       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Type:
     PMIP6-Home-LMA-IPv4-Address 149.

   Length:
      = 6 octets





<span class="grey">Xia, et al.                  Standards Track                   [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc6572.html">RFC 6572</a>                      RADIUS PMIPv6                    June 2012</span>


   Home LMA IPv4 address:
      32-bit IPv4 address of the assigned LMA.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.7.%20%20PMIP6-Visited-LMA-IPv4-Address"></a><a class="selflink" href="#section-4.7" name="section-4.7">4.7</a>.  PMIP6-Visited-LMA-IPv4-Address</span>

   The PMIP6-Visited-LMA-IPv4-Address attribute (Type value 150) is of
   type IPv4 address and is used to propose a particular LMA in the
   visited network and to authorize the use of the LMA in the visited
   network.

   PMIP6-Visited-LMA-IPv4-Address attribute MAY be included by the MAG
   in the RADIUS Access-Request message.  The LMA in the visited/local
   network may be assigned by the [VL]AAA as the result of retrieved
   policy profile.  If included by the [VL]AAA in the RADIUS Access-
   Accept sent to the MAG, the use of the LMA in the visited/local
   network is authorized and the attribute SHALL carry the IPv4 address
   of the LMA assigned for the particular MN.  See <a href="rfc5447.html#section-4.2.5">Section 4.2.5 of
   [RFC5447]</a> how the MIP6-Feature-Vector attribute and
   LOCAL_HOME_AGENT_ASSIGNMENT capability flag is used with the LMA
   (Home Agent) assignment.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Type     |   Length      |    Visited LMA IPv4 address
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      Visited LMA IPv4 address     |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Type:
     PMIP6-Visited-LMA-IPv4-Address 150.

   Length:
      = 6 octets

   IPv4 LMA address:
      32-bit IPv4 address of the assigned LMA.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.8.%20%20PMIP6-Home-HN-Prefix"></a><a class="selflink" href="#section-4.8" name="section-4.8">4.8</a>.  PMIP6-Home-HN-Prefix</span>

   The PMIP6-Home-HN-Prefix attribute (Type value 151) is of type IPv6
   prefix.  It contains the Mobile Node - Home Network Prefix (MN-HNP),
   which is the IPv6 prefix assigned to the link between the MN and the
   MAG.  The MN configures its IP interface from its home network
   prefix(es).  When the LMA is located in the home network, the PMIP6-
   Home-HN-Prefix attribute is used to deliver the MN-HNP from the HAAA
   to the MAG.




<span class="grey">Xia, et al.                  Standards Track                   [Page 15]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc6572.html">RFC 6572</a>                      RADIUS PMIPv6                    June 2012</span>


   The PMIP6-Home-HN-Prefix attribute is also used on the LMA-to-HAAA
   interface containing the prefix assigned to the MN.  If the LMA
   delegates the MN-HNP assignment to the HAAA, the attribute MUST
   contain all zeroes in the address of (i.e., '::') the Access-Request
   message.  The attribute MUST be present in the RADIUS Access-Accept
   message if the prior request already included one and SHOULD carry
   the MN-HNP the HAAA assigned to the MN.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Type      |    Length   |    Reserved     | Prefix-Length |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                        Home MN-HNP
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                            Home MN-HNP
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                            Home MN-HNP
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                            Home MN-HNP                            |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Type:
      PMIP6-Home-HN-Prefix 151.

   Length:
      = at least 4 and no larger than 20.

   Reserved:
      Reserved for future use.  The bits MUST be set to zero by the
      sender and MUST be ignored by the receiver.

   Prefix-Length:
      The 8-bit unsigned integer indicating the prefix length of
      the home network prefix (at least 0 and no larger than 128).
      If the home network prefix contains an address of all zeroes
      (i.e., '::'), then the Prefix-Length MUST be set to 128.

   Home Network Prefix:
      The home network prefix for the MN's IPv6 address configuration.
      The Prefix field is up to 16 octets in length.  Bits outside of
      the Prefix-Length, if included, must be zero.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.9.%20%20PMIP6-Visited-HN-Prefix"></a><a class="selflink" href="#section-4.9" name="section-4.9">4.9</a>.  PMIP6-Visited-HN-Prefix</span>

   The PMIP6-Visited-HN-Prefix attribute (Type value 152) is of type
   IPv6 prefix.  It contains the Mobile Node - Home Network Prefix (MN-
   HNP), which is the IPv6 prefix assigned to the link between the MN



<span class="grey">Xia, et al.                  Standards Track                   [Page 16]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc6572.html">RFC 6572</a>                      RADIUS PMIPv6                    June 2012</span>


   and the MAG.  The MN configures its IP interface from its home
   network prefix(es).  When the LMA is located in the visited network,
   the PMIP6-Visited-HN-Prefix attribute is used to deliver the MN-HNP
   from the VAAA to the MAG.

   The PMIP6-Visited-HN-Prefix attribute is also used on the LMA-to-VAAA
   interface containing the IPv6 prefix assigned to the MN.  If the LMA
   delegates the assignment of the MN-HNP to the VAAA, the attribute
   MUST contain an address of all zeroes (i.e., '::') in the RADIUS
   Access-Request message.  The attribute MUST be present in Access-
   Accept message if the prior request already included one and SHOULD
   carry the MN-HNP the VAAA assigned to the MN.

   The attribute SHOULD NOT be included if the use of LMA in the home
   network is authorized (the PMIP6-Home-HN-Prefix and/or PMIP6-Home-
   LMA-IPv6-Address attributes are already present).  However, if the
   VAAA local policy allows both home and visited LMA addresses to be
   delivered to the MAG, then this attribute MAY also be included.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Type      |    Length   |    Reserved     | Prefix-Length |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                       Visited MN-HNP
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                           Visited MN-HNP
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                           Visited MN-HNP
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                           Visited MN-HNP                          |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Type:
      PMIP6-Visited-HN-Prefix 152.

   Length:
      = at least 4 and no larger than 20.

   Reserved:
      Reserved for future use.  The bits MUST be set to zero by the
      sender and MUST be ignored by the receiver.

   Prefix-Length:
      The 8-bit unsigned integer indicating the prefix length of
      the Visited MN-HNP (at least 0 and no larger than 128).  If
      the visited home network prefix contains an address of all zeroes
      (i.e., '::'), then the Prefix-Length MUST be set to 128.



<span class="grey">Xia, et al.                  Standards Track                   [Page 17]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc6572.html">RFC 6572</a>                      RADIUS PMIPv6                    June 2012</span>


   Visited Home Network Prefix:
      The home network prefix for the MN's IPv6 address configuration.
      The Prefix field is up to 16 octets in length.  Bits outside of
      the Prefix-Length, if included, must be zero.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.10.%20%20PMIP6-Home-Interface-ID"></a><a class="selflink" href="#section-4.10" name="section-4.10">4.10</a>.  PMIP6-Home-Interface-ID</span>

   The PMIP6-Home-Interface-ID attribute (Type value 153) is of type
   String and contains the MN's interface identifier.  The selection of
   the interface identifier SHOULD NOT allow the tracking of individual
   MNs or users between PMIPv6 mobility sessions for privacy reasons.
   This attribute is applicable in network systems and link
   technologies, where the network explicitly delivers an interface
   identifier to the MN during the link setup.  Third Generation
   Partnership Project (3GPP) and PPP link technologies are examples of
   such.

   This attribute MAY be sent by the LMA or the MAG to the HAAA in the
   RADIUS Access-Request packet as a proposal.  This attribute MAY be
   sent by the HAAA to the LMA or to the MAG in an Access-Accept packet;
   however, it MUST be present if the prior request already included
   one.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Type     |   Length      |  Home Interface Identifier
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                       Home Interface Identifier
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     Home Interface Identifier     |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Type:
      PMIP6-Home-Interface-ID 153.

   Length:
      = 10 octets.

   Home Interface Identifier:
      The 64-bit long interface identifier (8 octets).

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.11.%20%20PMIP6-Visited-Interface-ID"></a><a class="selflink" href="#section-4.11" name="section-4.11">4.11</a>.  PMIP6-Visited-Interface-ID</span>

   The PMIP6-Visited-Interface-ID attribute (Type value 154) is of type
   String and contains the MN's interface identifier.  The selection of
   the interface identifier SHOULD NOT allow the tracking of individual
   MNs or users between PMIPv6 mobility session for privacy reasons.



<span class="grey">Xia, et al.                  Standards Track                   [Page 18]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-19" id="page-19" name="page-19"> </a>
<span class="grey"><a href="rfc6572.html">RFC 6572</a>                      RADIUS PMIPv6                    June 2012</span>


   This attribute is applicable in network systems and link
   technologies, where the network explicitly delivers an interface
   identifier to the MN during the link setup. 3GPP and PPP link
   technologies are examples of such.

   This attribute MAY be sent by the LMA or the MAG to the VAAA in the
   RADIUS Access-Request packet as a proposal.  This attribute MAY be
   sent by the VAAA to the LMA or to the MAG in an Access-Accept packet;
   however, it MUST be present if the prior request already included
   one.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Type     |   Length      |  Visited Interface Identifier
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                       Visited Interface Identifier
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     Visited Interface Identifier  |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Type:
      PMIP6-Visited-Interface-ID 154.

   Length:
      = 10 octets.

   Visited Interface Identifier:
      The 64-bit long interface identifier (8 octets).

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.12.%20%20PMIP6-Home-IPv4-HoA"></a><a class="selflink" href="#section-4.12" name="section-4.12">4.12</a>.  PMIP6-Home-IPv4-HoA</span>

   [<a id="ref-RFC5844" name="ref-RFC5844">RFC5844</a>] specifies extensions to Proxy Mobile IPv6 protocol that
   enable IPv4 home address mobility support to the MN.  The PMIP6-Home-
   IPv4-HoA attribute (Type value 155) is of type Address and contains
   the IPv4 Home Address of the MN.  The primary use of this attribute
   is to deliver the assigned IPv4-HoA from HAAA to the MAG.

   The PMIP6-Home-IPv4-HoA is also used on the LMA-to-HAAA interface.
   If the LMA in the home network delegates the assignment of the
   IPv4-HoA to the HAAA, the attribute MUST contain an address of all
   zeroes (i.e., 0.0.0.0) in the Access-Request message.  The attribute
   MUST be included in by HAAA in the Access-Accept message if the
   previous request included it, and it contains the IPv4-HoA assigned
   to the MN.






<span class="grey">Xia, et al.                  Standards Track                   [Page 19]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-20" id="page-20" name="page-20"> </a>
<span class="grey"><a href="rfc6572.html">RFC 6572</a>                      RADIUS PMIPv6                    June 2012</span>


    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Type      |    Length     |     Reserved      |Prefix-Len |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                       Home IPv4 HoA                           |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Type:
      PMIP6-Home-IPv4-HoA 155.

   Length:
      = 8 octets

   Reserved
      The 10-bit field reserved for future use.  The value MUST be
      initialized to zero by sender and MUST be ignored by the
      receiver.

   Prefix-Len
      The 6-bit unsigned integer indicating the prefix length of the
      IPv4 HoA.  If the Home IPv4 HoA contains an address of all zeroes
      (i.e., '0.0.0.0'), then the Prefix-Len MUST be set to 32.

   Home IPv4 HoA:
      This field is of type Address and contains the IPv4 home
      address of the MN in the home network.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.13.%20%20PMIP6-Visited-IPv4-HoA"></a><a class="selflink" href="#section-4.13" name="section-4.13">4.13</a>.  PMIP6-Visited-IPv4-HoA</span>

   When both the MAG and the LMA are in the visited network, the PMIP6-
   Visited-IPv4-HoA attribute (Type value 156) is of type Address and is
   used to exchange information between the VAAA and the MAG on the
   assignment of the IPv4 Home Address to the MN being present in the
   visited network.

   The PMIP6-Visited-IPv4-HoA is also used on the LMA-to-VAAA interface.
   If the LMA delegates the assignment of the IPv4-HoA to the VAAA, the
   attribute MUST contain an address of all zeroes (i.e., 0.0.0.0) in
   the RADIUS Access-Request message.  The Access-Accept message MUST
   have the attribute present if the prior request to the VAAA already
   included one.

   The attribute SHOULD NOT be included if the use of the LMA in the
   home network is authorized (the PMIP6-Home-IPv4-HoA and/or PMIP6-
   Home-LMA-IPv4-Address attributes are already present).  However, if
   the VAAA local policy allows both home and visited LMA addresses to
   be delivered to the MAG, then this attribute MAY also be included.



<span class="grey">Xia, et al.                  Standards Track                   [Page 20]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-21" id="page-21" name="page-21"> </a>
<span class="grey"><a href="rfc6572.html">RFC 6572</a>                      RADIUS PMIPv6                    June 2012</span>


    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Type      |    Length     |     Reserved      |Prefix-Len |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                      Visited IPv4 HoA                         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Type:
      PMIP6-Visited-IPv4-HoA 156.

   Length:
      = 8 octets

   Reserved:
      The 10-bit field reserved for future use.  The value MUST be
      initialized to zero by the sender and MUST be ignored by the
      receiver.

   Prefix-Len:
      6-bit unsigned integer indicating the prefix length of the IPv4
      HoA.  If the Visited IPv4 HoA contains an address of all zeroes
      (i.e., '0.0.0.0'), then the Prefix-Len MUST be set to 32.

   Visited IPv4 HoA:
      This field is of type Address and contains the IPv4 home address
      of the MN in the visited network.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.14.%20%20PMIP6-Home-DHCP4-Server-Address"></a><a class="selflink" href="#section-4.14" name="section-4.14">4.14</a>.  PMIP6-Home-DHCP4-Server-Address</span>

   The PMIP6-Home-DHCP4-Server-Address (Type value 157) is of type
   Address and contains the IPv4 address of the DHCPv4 server in the
   home network.  The particular DHCP server address is indicated to the
   MAG that serves the concerning MN.  The HAAA MAY assign a DHCP server
   to the MAG in deployments where the MAG acts as a DHCP Relay, as
   defined in [<a href="rfc5844.html" title='"IPv4 Support for Proxy Mobile IPv6"'>RFC5844</a>].

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Type     |   Length      |  Home DHCPv4 server address
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      Home DHCPv4 server address   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Type:
     PMIP6-Home-DHCP4-Server-Address 157.




<span class="grey">Xia, et al.                  Standards Track                   [Page 21]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-22" id="page-22" name="page-22"> </a>
<span class="grey"><a href="rfc6572.html">RFC 6572</a>                      RADIUS PMIPv6                    June 2012</span>


   Length:
      = 6 octets.

   Home DHCPv4 server address:
      This field is of type Address and contains a 4-octet IPv4 address
      of the DHCP server.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.15.%20%20PMIP6-Visited-DHCP4-Server-Address"></a><a class="selflink" href="#section-4.15" name="section-4.15">4.15</a>.  PMIP6-Visited-DHCP4-Server-Address</span>

   The PMIP6-Visited-DHCP4-Server-Address attribute (Type value 158) is
   of type Address and delivers the IPv4 address of the DHCPv4 server
   from the visited network to the MAG.  When both the MAG and the LMA
   are in the visited network, the VAAA MAY assign a DHCPv4 server to
   the MAG in deployments where the MAG acts as a DHCP Relay, as defined
   in [<a href="rfc5844.html" title='"IPv4 Support for Proxy Mobile IPv6"'>RFC5844</a>].

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Type     |   Length      | Visited DHCPv4 server address
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     Visited DHCPv4 server address |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Type:
      PMIP6-Visited-DHCP4-Server-Address 158.

   Length:
      = 6 octets

   Visited DHCPv4 server address:
      This field is of type Address and contains a 4-octet IPv4 address
      of the DHCPv4 server.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.16.%20%20PMIP6-Home-DHCP6-Server-Address"></a><a class="selflink" href="#section-4.16" name="section-4.16">4.16</a>.  PMIP6-Home-DHCP6-Server-Address</span>

   The PMIP6-Home-DHCP6-Server-Address (Type value 159) is of type IPv6
   address and contains the IPv6 address of the DHCPv6 server in the
   home network indicated by the HAAA to the MAG that serves the MN.
   The HAAA MAY assign a DHCPv6 server to the MAG in deployments where
   the MAG acts as a DHCP Relay, as defined in [<a href="rfc5213.html" title='"Proxy Mobile IPv6"'>RFC5213</a>].










<span class="grey">Xia, et al.                  Standards Track                   [Page 22]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-23" id="page-23" name="page-23"> </a>
<span class="grey"><a href="rfc6572.html">RFC 6572</a>                      RADIUS PMIPv6                    June 2012</span>


    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Type     |   Length      |  Home DHCPv6 server address
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                     Home DHCPv6 server address
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                     Home DHCPv6 server address
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                     Home DHCPv6 server address
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      Home DHCPv6 server address   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Type:
     PMIP6-Home-DHCP6-Server-Address 159.

   Length:
      = 18 octets

   Home DHCPv6 server address:
      This field is of type Address and contains 16-octet IPv6 address
      of the DHCPv6 server.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.17.%20%20PMIP6-Visited-DHCP6-Server-Address"></a><a class="selflink" href="#section-4.17" name="section-4.17">4.17</a>.  PMIP6-Visited-DHCP6-Server-Address</span>

   The PMIP6-Visited-DHCP6-Server-Address attribute (Type value 160) is
   of type IPv6 address and contains the IPv6 address of the DHCPv6
   server in the visited network indicated by the VAAA to the MAG that
   serves the MN.  When both MAG and the LMA are located in the visited
   network, the VAAA MAY assign a DHCPv6 server to the MAG in
   deployments where the MAG acts as a DHCP Relay, as defined in
   [<a href="rfc5213.html" title='"Proxy Mobile IPv6"'>RFC5213</a>].


















<span class="grey">Xia, et al.                  Standards Track                   [Page 23]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-24" id="page-24" name="page-24"> </a>
<span class="grey"><a href="rfc6572.html">RFC 6572</a>                      RADIUS PMIPv6                    June 2012</span>


    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Type     |   Length      | Visited DHCPv6 server address
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                    Visited DHCPv6 server address
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                    Visited DHCPv6 server address
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                    Visited DHCPv6 server address
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     Visited DHCPv6 server address |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Type:
     PMIP6-Visited-DHCP6-Server-Address 160.

   Length:
      = 18 octets

   Visited DHCPv6 server address:
      This field is of type Address and contains the 16-octet IPv6
      address of the DHCPv6 server.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.18.%20%20Calling-Station-Id"></a><a class="selflink" href="#section-4.18" name="section-4.18">4.18</a>.  Calling-Station-Id</span>

   The Calling-Station-Id attribute (Type value 31) is of type String.
   When used within PMIPv6 deployments, the attribute contains the MN
   Link-Layer Identifier option of the MN as defined in [<a href="rfc5213.html" title='"Proxy Mobile IPv6"'>RFC5213</a>],
   Sections <a href="#section-2.2">2.2</a> and <a href="#section-8.6">8.6</a>.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.19.%20%20Chargeable-User-Identity"></a><a class="selflink" href="#section-4.19" name="section-4.19">4.19</a>.  Chargeable-User-Identity</span>

   The Chargeable-User-Identity attribute, or CUI, (Type value 89) is a
   unique, temporary handle used as means to, for example, correlate
   authentication, accounting, and bill post-processing for a particular
   chargeable subscriber.  The CUI format and use follows guidelines
   defined by [<a href="rfc4372.html" title='"Chargeable User Identity"'>RFC4372</a>].

   In the scope of this document, the CUI attribute MAY be present in
   the Access-Request.  The CUI MAY also be present in the Access-
   Accept.  The CUI MUST be present in the Access-Accept if it was
   present in the Access-Request.  If the use of the Chargeable-User-
   Identity attribute is supported, then the MAG and/or the LMA commits
   to include the Chargeable-User-Identity attribute in all subsequent
   RADIUS Accounting packets they send for the given user.





<span class="grey">Xia, et al.                  Standards Track                   [Page 24]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-25" id="page-25" name="page-25"> </a>
<span class="grey"><a href="rfc6572.html">RFC 6572</a>                      RADIUS PMIPv6                    June 2012</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.20.%20%20PMIP6-Home-IPv4-Gateway"></a><a class="selflink" href="#section-4.20" name="section-4.20">4.20</a>.  PMIP6-Home-IPv4-Gateway</span>

   [<a id="ref-RFC5844" name="ref-RFC5844">RFC5844</a>] specifies extensions to Proxy Mobile IPv6 protocol that
   enable IPv4 home address mobility support to the MN.  The PMIP6-Home-
   IPv4-Gateway attribute (Type value 161) is of type Address and
   contains the default gateway IPv4 address for the MN.  This address
   is populated into the PMIPv6 IPv4 Default-Router Address Option
   [<a href="rfc5844.html" title='"IPv4 Support for Proxy Mobile IPv6"'>RFC5844</a>].  The address MUST belong to the subnet defined in the
   PMIP6-Home-IPv4-HoA attribute.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Type     |   Length      |   Home IPv4 default gateway
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
               address             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Type:
      PMIP6-Home-IPv4-Gateway 161.

   Length:
      = 6 octets

   Home IPv4 default gateway address:
      This field is of type Address and contains a 4-octet IPv4 default
      gateway address.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.21.%20%20PMIP6-Visited-IPv4-Gateway"></a><a class="selflink" href="#section-4.21" name="section-4.21">4.21</a>.  PMIP6-Visited-IPv4-Gateway</span>

   [<a id="ref-RFC5844" name="ref-RFC5844">RFC5844</a>] specifies extensions to Proxy Mobile IPv6 protocol that
   enable IPv4 home address mobility support to the MN.  The PMIP6-
   Visited-IPv4-Gateway attribute (Type value 162) is of type Address
   and contains the default gateway IPv4 address for the MN.  This
   address is populated into the PMIPv6 IPv4 Default-Router Address
   Option [<a href="rfc5844.html" title='"IPv4 Support for Proxy Mobile IPv6"'>RFC5844</a>].  The address MUST belong to the subnet defined in
   the PMIP6-Visited-IPv4-HoA attribute.














<span class="grey">Xia, et al.                  Standards Track                   [Page 25]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-26" id="page-26" name="page-26"> </a>
<span class="grey"><a href="rfc6572.html">RFC 6572</a>                      RADIUS PMIPv6                    June 2012</span>


    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |      Type     |   Length      |  Visited IPv4 default gateway
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
               address             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Type:
      PMIP6-Visited-IPv4-Gateway 162.

   Length:
      = 6 octets

   Visited IPv4 default gateway address:
      This field is of type Address and contains a 4-octet IPv4 default
      gateway address.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20MAG%20to%20RADIUS%20AAA%20Interface"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  MAG to RADIUS AAA Interface</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.1.%20%20Interface%20Operations"></a><a class="selflink" href="#section-5.1" name="section-5.1">5.1</a>.  Interface Operations</span>

   The MAG to the AAA RADIUS server interface is used for retrieval of
   the policy profile when an MN tries to attach, authenticate, and
   authorize to a PMIPv6 domain.  Depending on the policies and network
   capabilities, the MAG may retrieve different sets of PMIPv6-session-
   related parameters:

   o  Configuration attributes for home or visited network access
      scenario, depending on the location and attachment point of the
      MN,

   o  The IPv6 or IPv4 address of the designated LMA, depending on the
      access network's actual IP topology,

   o  The IPv6 or IPv4 configuration parameters for the MN, depending on
      the utilized IP configuration method and individual MN's service
      Policy,

   o  The DHCP Relay support attributes (IPv4 or IPv6) in case such
      functionality is supported in the network.

   In addition to PMIPv6-specific attributes, other RADIUS attributes
   are to be used on the MAG-to-AAA interface.







<span class="grey">Xia, et al.                  Standards Track                   [Page 26]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-27" id="page-27" name="page-27"> </a>
<span class="grey"><a href="rfc6572.html">RFC 6572</a>                      RADIUS PMIPv6                    June 2012</span>


   The User-Name attribute MUST be present in the Access-Request.  It
   MUST carry a correctly formed identifier that SHOULD correspond to an
   MN identity unless the identity is being suppressed for policy
   reasons, for example, when identity hiding is in effect.  The MN
   identity, if available, MUST be in Network Access Identifier (NAI)
   [<a href="rfc4282.html" title='"The Network Access Identifier"'>RFC4282</a>] format.  At minimum, the home realm of the MN MUST be
   available at the MAG when the network access authentication takes
   place.  Otherwise, the MAG is not able to route RADIUS request
   messages towards the correct HAAA.  The MN identity used on the MAG-
   to-HAAA interface and in the User-Name attribute MAY entirely be
   related to the network access authentication and, therefore, not be
   suitable to be used as the MN-Identifier mobility option value in the
   subsequent PBU/PBA messages.  In this case, the HAAA MUST provide the
   MN-Identifier for PBU/PBA messages using the Mobile-Node-Identifier
   attribute (see <a href="#section-4.2">Section 4.2</a>).

   At least one of the NAS-IP-Address, NAS-IPv6-Address, or
   NAS-Identifier attributes MUST be present in the Access-Request.  The
   Service-Type attribute SHOULD be set to value 1 (Login) and the NAS-
   Port-Type attribute SHOULD be present in the Access-Request.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.2.%20%20Table%20of%20Attributes"></a><a class="selflink" href="#section-5.2" name="section-5.2">5.2</a>.  Table of Attributes</span>

   The following table provides a guide to attributes that may be found
   in authentication and authorization RADIUS messages between the MAG
   and the AAA server.

























<span class="grey">Xia, et al.                  Standards Track                   [Page 27]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-28" id="page-28" name="page-28"> </a>
<span class="grey"><a href="rfc6572.html">RFC 6572</a>                      RADIUS PMIPv6                    June 2012</span>


   Request Accept Reject Challenge #  Attribute

   1       0-1    0      0         1  User-Name
   0-1     0      0      0         4  NAS-IP-Address
   0-1     0-1    0      0         5  NAS-Port
   0-1     0-1    0      0         6  Service-Type
   0-1     0-1    0      0-1      24  State
   0       0-1    0      0        25  Class
   0       0-1    0      0-1      27  Session-Timeout
   0-1     0      0      0        31  Calling-Station-Id
   0-1     0      0      0        32  NAS-Identifier
   0+      0+     0+     0+       33  Proxy-State
   0-1     0      0      0        69  NAS-Port-Type
   0+      0+     0+     0+       79  EAP-Message
   1       1      1      1        80  Message-Authenticator
   0-1     0-1    0      0        89  Chargeable-User-Identity
   0-1     0      0      0        95  NAS-IPv6-Address
   0-1     0-1    0      0       124  MIP6-Feature-Vector
   0       1      0      0       145  Mobile-Node-Identifier
   0-1     0-1    0      0       146  Service-Selection
   0       0-1    0      0       147  PMIP6-Home-LMA-IPv6-Address
   0-1     0-1    0      0       148  PMIP6-Visited-LMA-IPv6-Address
   0       0-1    0      0       149  PMIP6-Home-LMA-IPv4-Address
   0-1     0-1    0      0       150  PMIP6-Visited-LMA-IPv4-Address
   0       0+     0      0       151  PMIP6-Home-HN-Prefix
   0       0+     0      0       152  PMIP6-Visited-HN-Prefix
   0       0-1    0      0       153  PMIP6-Home-Interface-ID
   0       0-1    0      0       154  PMIP6-Visited-Interface-ID
   0       0-1    0      0       155  PMIP6-Home-IPv4-HoA
   0       0-1    0      0       156  PMIP6-Visited-IPv4-HoA
   0       0-1    0      0       157  PMIP6-Home-DHCP4-Server-Address
   0       0-1    0      0       158  PMIP6-Visited-DHCP4-Server-Address
   0       0-1    0      0       159  PMIP6-Home-DHCP6-Server-Address
   0       0-1    0      0       160  PMIP6-Visited-DHCP6-Server-Address
   0       0-1    0      0       161  PMIP6-Home-IPv4-Gateway
   0       0-1    0      0       162  PMIP6-Visited-IPv4-Gateway

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20LMA%20to%20RADIUS%20AAA%20Interface"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  LMA to RADIUS AAA Interface</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.1.%20%20Interface%20Operations"></a><a class="selflink" href="#section-6.1" name="section-6.1">6.1</a>.  Interface Operations</span>

   The LMA-to-HAAA interface may be used for multiple purposes.  These
   include the authorization of the incoming PBU, updating the LMA
   address to the HAAA, delegating the assignment of the MN-HNP or the
   IPv4-HoA to the HAAA, and accounting and PMIPv6 session management.
   The primary purpose of this interface is to update the HAAA with the





<span class="grey">Xia, et al.                  Standards Track                   [Page 28]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-29" id="page-29" name="page-29"> </a>
<span class="grey"><a href="rfc6572.html">RFC 6572</a>                      RADIUS PMIPv6                    June 2012</span>


   LMA address information in case of dynamically assigned LMA and to
   exchange the MN address assignment information between the LMA and
   the HAAA.

   Whenever the LMA sends an Access-Request message to the HAAA, the
   User-Name attribute SHOULD contain the MN's identity.  The LMA-
   provided identity in the User-Name attribute is strongly RECOMMENDED
   to be the same as the MN's identity information in the PBU MN-
   Identifier mobility option.  The identity SHOULD also be the same as
   used on the MAG-to-HAAA interface; however, in case those identities
   differ, the HAAA MUST have a mechanism of mapping the MN identity
   used on the MAG-to-HAAA interface to the identity used on the LMA-to-
   HAAA interface.

   If the PBU contains the MN Link-Layer Identifier option, the Calling-
   Station-Id attribute SHOULD be included in the request message
   containing the received MN Link-Layer Identifier option.
   Furthermore, if the PBU contains the Service Selection mobility
   option [<a href="rfc5149.html" title='"Service Selection for Mobile IPv6"'>RFC5149</a>], the Service-Selection attribute SHOULD be included
   in the request message containing the received service identifier.
   Both the MN Link-Layer Identifier option and the service selection
   can be used to provide more information for the PBU authorization
   step in the HAAA.

   The Service-Type attribute MUST be set to the value 17 (Authorize
   Only).  If the HAAA is not able to authorize the subscriber's
   mobility service session, then the Access-Reject message to the LMA
   MAY contain the Reply-Message attribute describing the reason for
   rejecting the authorization.  A failed authorization obviously
   results in a rejection of the PBU, and a PBA with an appropriate
   error Status Value MUST be sent back to the MAG.

   The authorization step MUST be performed at least for the initial PBU
   session up to a mobility session, when the LMA-to-HAAA interface is
   deployed.  For the subsequent re-registration and handover of PBUs,
   the authorization step MAY be repeated (in this case, the LMA-to-HAAA
   interface should also maintain an authorization session state).

   In case of a dynamic LMA discovery and assignment [<a href="rfc6097.html" title='"Local Mobility Anchor (LMA) Discovery for Proxy Mobile IPv6"'>RFC6097</a>], the HAAA
   and the remote policy store may need to be updated with the selected
   LMA address information.  The update can be done during the PBU
   authorization step using the LMA-to-HAAA interface.  This
   specification uses the PMIP6-*-LMA-*-Address attribute for carrying
   the LMA's address information from the LMA to the HAAA.  The LMA
   address information in the request message MUST contain the IP
   address of the LMA, the Fully Qualified Domain Name (FQDN) uniquely





<span class="grey">Xia, et al.                  Standards Track                   [Page 29]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-30" id="page-30" name="page-30"> </a>
<span class="grey"><a href="rfc6572.html">RFC 6572</a>                      RADIUS PMIPv6                    June 2012</span>


   identifying the LMA, or both.  The LMA address information refers to
   the PMIPv6 part of the LMA, not necessarily the LMA part interfacing
   with the AAA infrastructure.

   The LMA and the HAAA use the PMIP6-Home-HN-Prefix/
   PMIP6-Visited-HN-Prefix attributes to exchange the MN-HNP when
   appropriate.  Similarly, the LMA and the HAAA use the PMIP6-Home-
   IPv4-HoA/PMIP6-Visited-IPv4-HoA attributes to exchange the IPv4-MN-
   HoA when appropriate.  The MN address information exchange is again
   done during the PBU authorization step.  The HAAA MAY also use the
   LMA-provided MN address information as a part of the information used
   to authorize the PBU.

   Which entity is actually responsible for the address management is
   deployment specific within the PMIPv6 Domain and MUST be pre-agreed
   on per deployment basis.  When the LMA is responsible for the address
   management, the PMIP6-*-HN-Prefix/PMIP6-*-IPv4-HoA attributes are
   used to inform the HAAA and the remote policy store of the MN-HNP/
   IPv4-MN-HoA assigned to the MN.  It is also possible that the LMA
   delegates the address management to the HAAA.  In this case, the
   MN-HNP/IPv4-MN-HoA are set to undefined addresses in the Access-
   Request message sent from the LMA to the HAAA.  The LMA expects to
   receive the HAAA assigned HNP/IPv4-MN-HoA in the corresponding
   Access-Accept message.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.2.%20%20Table%20of%20Attributes"></a><a class="selflink" href="#section-6.2" name="section-6.2">6.2</a>.  Table of Attributes</span>

   The following table provides a guide to which attributes may be found
   in authorization process between LMA and the AAA.






















<span class="grey">Xia, et al.                  Standards Track                   [Page 30]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-31" id="page-31" name="page-31"> </a>
<span class="grey"><a href="rfc6572.html">RFC 6572</a>                      RADIUS PMIPv6                    June 2012</span>


   Request Accept Reject Challenge #   Attribute

   1       0-1    0      0         1   User-Name
   0-1     0-1    0      0         4   NAS-IP-Address
   0-1     0-1    0      0         5   NAS-Port
   1       0-1    0      0         6   Service-Type
   0       0-1    0      0        25   Class
   0       0-1    0      0-1      27   Session-Timeout
   0-1     0      0      0        31   Calling-Station-Id
   1       0      0      0        32   NAS-Identifier
   0+      0+     0+     0+       33   Proxy-State
   1       0      0      0        69   NAS-Port-Type
   1       1      1      1        80   Message-Authenticator
   0-1     0-1    0      0        89   Chargeable-User-Identity
   0-1     0-1    0      0        95   NAS-IPv6-Address
   0-1     0-1    0      0       124   MIP6-Feature-Vector
   1       0      0      0       145   Mobile-Node-Identifier
   0-1     0-1    0      0       146   Service-Selection
   0-1     0      0      0       147   PMIP6-Home-LMA-IPv6-Address
   0-1     0      0      0       148   PMIP6-Visited-LMA-IPv6-Address
   0-1     0      0      0       149   PMIP6-Home-LMA-IPv4-Address
   0-1     0      0      0       150   PMIP6-Visited-LMA-IPv4-Address
   0+      0+     0      0       151   PMIP6-Home-HN-Prefix
   0+      0+     0      0       152   PMIP6-Visited-HN-Prefix
   0-1     0-1    0      0       153   PMIP6-Home-Interface-ID
   0-1     0-1    0      0       154   PMIP6-Visited-Interface-ID
   0-1     0-1    0      0       155   PMIP6-Home-IPv4-HoA
   0-1     0-1    0      0       156   PMIP6-Visited-IPv4-HoA
   0-1     0-1    0      0       161   PMIP6-Home-IPv4-Gateway
   0-1     0-1    0      0       162   PMIP6-Visited-IPv4-Gateway

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20Accounting"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  Accounting</span>

   Radius-based interfaces at the MAG and LMA with the AAA server
   enables the metering of traffic associated with the MN, commonly
   called "accounting".  If accounting is turned on in the mobile node's
   policy profile, the local routing SHOULD NOT be enabled [<a href="rfc5213.html" title='"Proxy Mobile IPv6"'>RFC5213</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.1.%20%20Accounting%20at%20LMA"></a><a class="selflink" href="#section-7.1" name="section-7.1">7.1</a>.  Accounting at LMA</span>

   The accounting at the LMA to AAA server interface is based on
   [<a href="rfc2865.html" title='"Remote Authentication Dial In User Service (RADIUS)"'>RFC2865</a>] and [<a href="rfc2866.html" title='"RADIUS Accounting"'>RFC2866</a>].  This interface MUST support the transfer of
   accounting records needed for service control and charging.  These
   records should include (but may not be limited to) the following:
   time of binding cache entry creation and deletion, number of the
   octets sent and received by the MN over the bi-directional tunnel,
   etc.




<span class="grey">Xia, et al.                  Standards Track                   [Page 31]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-32" id="page-32" name="page-32"> </a>
<span class="grey"><a href="rfc6572.html">RFC 6572</a>                      RADIUS PMIPv6                    June 2012</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.2.%20%20Accounting%20at%20MAG"></a><a class="selflink" href="#section-7.2" name="section-7.2">7.2</a>.  Accounting at MAG</span>

   The accounting at the MAG to AAA server interface is based on
   [<a href="rfc2865.html" title='"Remote Authentication Dial In User Service (RADIUS)"'>RFC2865</a>] and [<a href="rfc2866.html" title='"RADIUS Accounting"'>RFC2866</a>].  The interface MUST also support the
   transfer of accounting records that should include the following:
   time of binding cache entry creation and deletion, number of the
   octets sent and received by the MN over the bi-directional tunnel,
   etc.

   If there is data traffic between a visiting MN and a correspondent
   node that is locally attached to an access link connected to the same
   MAG, the mobile access gateway MAY optimize on the delivery efforts
   by locally routing the packets instead of using reverse tunneling to
   the mobile node's LMA.  In this case, the local data traffic too MUST
   be reported to AAA Accounting servers by means of RADIUS protocol.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.3.%20%20Table%20of%20Attributes"></a><a class="selflink" href="#section-7.3" name="section-7.3">7.3</a>.  Table of Attributes</span>

   The following table provides a list of attributes that may be
   included in the RADIUS Accounting messages.  These attributes are to
   complement the set of accounting attributes already required by
   [<a href="rfc2866.html" title='"RADIUS Accounting"'>RFC2866</a>] and [<a href="rfc2869.html" title='"RADIUS Extensions"'>RFC2869</a>].

   Accounting
   Request       #  Attribute

   0-1         145  Mobile-Node-Identifier
   0-1         146  Service-Selection
   0-1         147  PMIP6-Home-LMA-IPv6-Address
   0-1         148  PMIP6-Visited-LMA-IPv6-Address
   0-1         149  PMIP6-Home-LMA-IPv4-Address
   0-1         150  PMIP6-Visited-LMA-IPv4-Address
   0+          151  PMIP6-Home-HN-Prefix
   0+          152  PMIP6-Visited-HN-Prefix
   0-1         155  PMIP6-Home-IPv4-HoA
   0-1         156  PMIP6-Visited-IPv4-HoA
   0-1          31  Calling-Station-Id
   0-1          80  Message-Authenticator
   0-1          89  Chargeable-User-Identity
   0-1         124  MIP6-Feature-Vector

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20Security%20Considerations"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  Security Considerations</span>

   The RADIUS messages may be transported between the MAG and/or the LMA
   to the RADIUS server via one or more AAA brokers or RADIUS proxies.
   In this case, the communication between the LMA and the RADIUS AAA
   server relies on the security properties of the intermediate AAA
   brokers and RADIUS proxies.



<span class="grey">Xia, et al.                  Standards Track                   [Page 32]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-33" id="page-33" name="page-33"> </a>
<span class="grey"><a href="rfc6572.html">RFC 6572</a>                      RADIUS PMIPv6                    June 2012</span>


   Regarding the privacy threats associated with sending MN-specific
   information between the MAG and AAA server and between the LMA and
   AAA server, considerations of the RADIUS Base protocol [<a href="rfc2865.html" title='"Remote Authentication Dial In User Service (RADIUS)"'>RFC2865</a>],
   RADIUS Accounting [<a href="rfc2866.html" title='"RADIUS Accounting"'>RFC2866</a>], and the RADIUS EAP application [<a href="rfc3579.html" title='"RADIUS (Remote Authentication Dial In User Service) Support For Extensible Authentication Protocol (EAP)"'>RFC3579</a>]
   are applicable to this document.  The MAG, LMA, and AAA server SHOULD
   avoid including attributes containing personally identifying
   information such as a MN's Interface ID, link-layer address, or NAI,
   except as needed and SHOULD pay special attention if identity hiding
   is desired.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/9.%20%20IANA%20Consideration"></a><a class="selflink" href="#section-9" name="section-9">9</a>.  IANA Consideration</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/9.1.%20%20Attribute%20Type%20Codes"></a><a class="selflink" href="#section-9.1" name="section-9.1">9.1</a>.  Attribute Type Codes</span>

   This specification defines the following new RADIUS attribute type
   values:

           Mobile-Node-Identifier              145
           Service-Selection                   146
           PMIP6-Home-LMA-IPv6-Address         147
           PMIP6-Visited-LMA-IPv6-Address      148
           PMIP6-Home-LMA-IPv4-Address         149
           PMIP6-Visited-LMA-IPv4-Address      150
           PMIP6-Home-HN-Prefix                151
           PMIP6-Visited-HN-Prefix             152
           PMIP6-Home-Interface-ID             153
           PMIP6-Visited-Interface-ID          154
           PMIP6-Home-IPv4-HoA                 155
           PMIP6-Visited-IPv4-HoA              156
           PMIP6-Home-DHCP4-Server-Address     157
           PMIP6-Visited-DHCP4-Server-Address  158
           PMIP6-Home-DHCP6-Server-Address     159
           PMIP6-Visited-DHCP6-Server-Address  160
           PMIP6-Home-IPv4-Gateway             161
           PMIP6-Visited-IPv4-Gateway          162

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/9.2.%20%20Namespaces"></a><a class="selflink" href="#section-9.2" name="section-9.2">9.2</a>.  Namespaces</span>

   This specification defines new values to the Mobility Capability
   registry (see [<a href="rfc5447.html" title='"Diameter Mobile IPv6: Support for Network Access Server to Diameter Server Interaction"'>RFC5447</a>]) for use with the MIP6-Feature-Vector AVP:

     Token                             | Value
     ----------------------------------+--------------------
     IP4_TRANSPORT_SUPPORTED           | 0x0000800000000000
     IP4_HOA_ONLY_SUPPORTED            | 0x0001000000000000






<span class="grey">Xia, et al.                  Standards Track                   [Page 33]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-34" id="page-34" name="page-34"> </a>
<span class="grey"><a href="rfc6572.html">RFC 6572</a>                      RADIUS PMIPv6                    June 2012</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/10.%20%20Acknowledgements"></a><a class="selflink" href="#section-10" name="section-10">10</a>.  Acknowledgements</span>

   First of all, the authors would like to acknowledge the
   standardization work and people of the WiMAX Forum that have set the
   foundation for this document.

   The authors would like to thank Basavaraj Patil, Glen Zorn, Avi Lior,
   Alan DeKok, Dhananjay Patki and Pete McCann for reviewing the
   document and providing valuable input.  The authors also thank Elwyn
   Davies, Pete Resnick, Bernard Aboba, Jari Arkko, and Stephen Farrell
   for their reviews on the document during the IESG process.

   The authors would also like to thank the authors of [<a href="rfc5779.html" title='"Diameter Proxy Mobile IPv6: Mobile Access Gateway and Local Mobility Anchor Interaction with Diameter Server"'>RFC5779</a>] as this
   document reuses some procedural ideas of that specification.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/11.%20%20References"></a><a class="selflink" href="#section-11" name="section-11">11</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/11.1.%20%20Normative%20References"></a><a class="selflink" href="#section-11.1" name="section-11.1">11.1</a>.  Normative References</span>

   [<a id="ref-RFC2119" name="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a id="ref-RFC2865" name="ref-RFC2865">RFC2865</a>]  Rigney, C., Willens, S., Rubens, A., and W. Simpson,
              "Remote Authentication Dial In User Service (RADIUS)",
              <a href="rfc2865.html">RFC 2865</a>, June 2000.

   [<a id="ref-RFC5213" name="ref-RFC5213">RFC5213</a>]  Gundavelli, S., Leung, K., Devarapalli, V., Chowdhury, K.,
              and B. Patil, "Proxy Mobile IPv6", <a href="rfc5213.html">RFC 5213</a>, August 2008.

   [<a id="ref-RFC4282" name="ref-RFC4282">RFC4282</a>]  Aboba, B., Beadles, M., Arkko, J., and P. Eronen, "The
              Network Access Identifier", <a href="rfc4282.html">RFC 4282</a>, December 2005.

   [<a id="ref-RFC5447" name="ref-RFC5447">RFC5447</a>]  Korhonen, J., Bournelle, J., Tschofenig, H., Perkins, C.,
              and K. Chowdhury, "Diameter Mobile IPv6: Support for
              Network Access Server to Diameter Server Interaction",
              <a href="rfc5447.html">RFC 5447</a>, February 2009.

   [<a id="ref-RFC3588" name="ref-RFC3588">RFC3588</a>]  Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J.
              Arkko, "Diameter Base Protocol", <a href="rfc3588.html">RFC 3588</a>, September 2003.

   [<a id="ref-RFC5844" name="ref-RFC5844">RFC5844</a>]  Wakikawa, R. and S. Gundavelli, "IPv4 Support for Proxy
              Mobile IPv6", <a href="rfc5844.html">RFC 5844</a>, May 2010.

   [<a id="ref-RFC5779" name="ref-RFC5779">RFC5779</a>]  Korhonen, J., Bournelle, J., Chowdhury, K., Muhanna, A.,
              and U. Meyer, "Diameter Proxy Mobile IPv6: Mobile Access
              Gateway and Local Mobility Anchor Interaction with
              Diameter Server", <a href="rfc5779.html">RFC 5779</a>, February 2010.




<span class="grey">Xia, et al.                  Standards Track                   [Page 34]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-35" id="page-35" name="page-35"> </a>
<span class="grey"><a href="rfc6572.html">RFC 6572</a>                      RADIUS PMIPv6                    June 2012</span>


   [<a id="ref-RFC4372" name="ref-RFC4372">RFC4372</a>]  Adrangi, F., Lior, A., Korhonen, J., and J. Loughney,
              "Chargeable User Identity", <a href="rfc4372.html">RFC 4372</a>, January 2006.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/11.2.%20%20Informative%20References"></a><a class="selflink" href="#section-11.2" name="section-11.2">11.2</a>.  Informative References</span>

   [<a id="ref-RFC3579" name="ref-RFC3579">RFC3579</a>]  Aboba, B. and P. Calhoun, "RADIUS (Remote Authentication
              Dial In User Service) Support For Extensible
              Authentication Protocol (EAP)", <a href="rfc3579.html">RFC 3579</a>, September 2003.

   [<a id="ref-RFC2866" name="ref-RFC2866">RFC2866</a>]  Rigney, C., "RADIUS Accounting", <a href="rfc2866.html">RFC 2866</a>, June 2000.

   [<a id="ref-RFC2869" name="ref-RFC2869">RFC2869</a>]  Rigney, C., Willats, W., and P. Calhoun, "RADIUS
              Extensions", <a href="rfc2869.html">RFC 2869</a>, June 2000.

   [<a id="ref-RFC3748" name="ref-RFC3748">RFC3748</a>]  Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H.
              Levkowetz, "Extensible Authentication Protocol (EAP)",
              <a href="rfc3748.html">RFC 3748</a>, June 2004.

   [<a id="ref-RFC5149" name="ref-RFC5149">RFC5149</a>]  Korhonen, J., Nilsson, U., and V. Devarapalli, "Service
              Selection for Mobile IPv6", <a href="rfc5149.html">RFC 5149</a>, February 2008.

   [<a id="ref-RFC6097" name="ref-RFC6097">RFC6097</a>]  Korhonen, J. and V. Devarapalli, "Local Mobility Anchor
              (LMA) Discovery for Proxy Mobile IPv6", <a href="rfc6097.html">RFC 6097</a>,
              February 2011.

   [<a id="ref-UNF" name="ref-UNF">UNF</a>]      Davis, M., Ed. and K. Whistler, Ed., "Unicode Standard
              Annex #15: Unicode Normalization Forms", January 2012,
              &lt;<a href="http://www.unicode.org/reports/tr15/">http://www.unicode.org/reports/tr15/</a>&gt;.























<span class="grey">Xia, et al.                  Standards Track                   [Page 35]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-36" id="page-36" name="page-36"> </a>
<span class="grey"><a href="rfc6572.html">RFC 6572</a>                      RADIUS PMIPv6                    June 2012</span>


Authors' Addresses

   Frank Xia
   Huawei USA
   1700 Alma Dr., Suite 500
   Plano, TX  75075

   Phone: +1 972-509-5599
   EMail: xiayangsong@huawei.com


   Behcet Sarikaya
   Huawei USA
   1700 Alma Dr., Suite 500
   Plano, TX  75075

   Phone: +1 972-509-5599
   EMail: sarikaya@ieee.org


   Jouni Korhonen (editor)
   Nokia Siemens Networks
   Linnoitustie 6
   Espoo  FI-02600
   Finland

   EMail: jouni.nospam@gmail.com


   Sri Gundavelli
   Cisco
   170 West Tasman Drive
   San Jose, CA  95134

   EMail: sgundave@cisco.com


   Damjan Damic
   Siemens
   Heinzelova 70a
   Zagreb  10000
   Croatia

   EMail: damjan.damic@siemens.com







Xia, et al.                  Standards Track                   [Page 36]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc6572 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:29 GMT --></html>