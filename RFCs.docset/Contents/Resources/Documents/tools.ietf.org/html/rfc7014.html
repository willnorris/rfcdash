<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc7014 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:25 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="urn:ietf:rfc:7014" name="DC.Identifier"/>
<meta content="The Intermediate Flow Selection Process is the process of selecting a
subset of Flows from all observed Flows. The Intermediate Flow
Selection Process may be located at an IP Flow Information Export
(IPFIX) Exporter or Collector, or within an IPFIX Mediator. It reduces
the effort of post-processing Flow data and transferring Flow Records.
This document describes motivations for using the Intermediate Flow
Selection process and presents Intermediate Flow Selection techniques.
It provides an information model for configuring Intermediate Flow
Selection Process techniques and discusses what information about an
Intermediate Flow Selection Process should be exported." name="DC.Description.Abstract"/>
<meta content="Zseby, Tanja" name="DC.Creator"/>
<meta content="Henke, Christian" name="DC.Creator"/>
<meta content="Peluso, Lorenzo" name="DC.Creator"/>
<meta content="September, 2013" name="DC.Date.Issued"/>
<meta content="Flow Selection Techniques" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 7014 - Flow Selection Techniques</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgblue" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc7014.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc7014" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-ipfix-flow-selection-tech" title="draft-ietf-ipfix-flow-selection-tech">draft-ietf-ipfi...</a>] [<a href="https://datatracker.ietf.org/doc/rfc7014" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc7014" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc7014" title="Side-by-side diff">Diff2</a>] [<a href="https://datatracker.ietf.org/ipr/search/?rfc=7014&amp;submit=rfc" title="IPR disclosures related to this document">IPR</a>]   </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                       PROPOSED STANDARD</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Internet Engineering Task Force (IETF)                      S. D'Antonio
Request for Comments: 7014                  Univ. of Napoli "Parthenope"
Category: Standards Track                                       T. Zseby
ISSN: 2070-1721                                          CAIDA/FhG FOKUS
                                                                C. Henke
                                         Tektronix Communications Berlin
                                                               L. Peluso
                                                    University of Napoli
                                                          September 2013


                       <span class="h1">Flow Selection Techniques</span>

Abstract

   The Intermediate Flow Selection Process is the process of selecting a
   subset of Flows from all observed Flows.  The Intermediate Flow
   Selection Process may be located at an IP Flow Information Export
   (IPFIX) Exporter or Collector, or within an IPFIX Mediator.  It
   reduces the effort of post-processing Flow data and transferring Flow
   Records.  This document describes motivations for using the
   Intermediate Flow Selection process and presents Intermediate Flow
   Selection techniques.  It provides an information model for
   configuring Intermediate Flow Selection Process techniques and
   discusses what information about an Intermediate Flow Selection
   Process should be exported.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="rfc5741.html#section-2">Section 2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc7014">http://www.rfc-editor.org/info/rfc7014</a>.











<span class="grey">D'Antonio, et al.            Standards Track                    [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc7014.html">RFC 7014</a>                Flow Selection Techniques         September 2013</span>


Copyright Notice

   Copyright (c) 2013 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

   This document may contain material from IETF Documents or IETF
   Contributions published or made publicly available before November
   10, 2008.  The person(s) controlling the copyright in some of this
   material may not have granted the IETF Trust the right to allow
   modifications of such material outside the IETF Standards Process.
   Without obtaining an adequate license from the person(s) controlling
   the copyright in such materials, this document may not be modified
   outside the IETF Standards Process, and derivative works of it may
   not be created outside the IETF Standards Process, except to format
   it for publication as an RFC or to translate it into languages other
   than English.

























<span class="grey">D'Antonio, et al.            Standards Track                    [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc7014.html">RFC 7014</a>                Flow Selection Techniques         September 2013</span>


Table of Contents

   <a href="#section-1">1</a>.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-4">4</a>
     <a href="#section-1.1">1.1</a>.  Requirements Language  . . . . . . . . . . . . . . . . . .  <a href="#page-4">4</a>
   <a href="#section-2">2</a>.  Terminology  . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-4">4</a>
   3.  Difference between Intermediate Flow Selection Process and
       Packet Selection . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-7">7</a>
   4.  Difference between Intermediate Flow Selection Process and
       Intermediate Selection Process . . . . . . . . . . . . . . . .  <a href="#page-9">9</a>
   5.  Intermediate Flow Selection Process within the IPFIX
       Architecture . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-9">9</a>
     5.1.  Intermediate Flow Selection Process in the Metering
           Process  . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-11">11</a>
     5.2.  Intermediate Flow Selection Process in the Exporting
           Process  . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-11">11</a>
     5.3.  Intermediate Flow Selection Process as a Function of
           the IPFIX Mediator . . . . . . . . . . . . . . . . . . . . <a href="#page-11">11</a>
   <a href="#section-6">6</a>.  Intermediate Flow Selection Process Techniques . . . . . . . . <a href="#page-12">12</a>
     <a href="#section-6.1">6.1</a>.  Flow Filtering . . . . . . . . . . . . . . . . . . . . . . <a href="#page-12">12</a>
       <a href="#section-6.1.1">6.1.1</a>.  Property Match Filtering . . . . . . . . . . . . . . . <a href="#page-12">12</a>
       <a href="#section-6.1.2">6.1.2</a>.  Hash-Based Flow Filtering  . . . . . . . . . . . . . . <a href="#page-13">13</a>
     <a href="#section-6.2">6.2</a>.  Flow Sampling  . . . . . . . . . . . . . . . . . . . . . . <a href="#page-13">13</a>
       <a href="#section-6.2.1">6.2.1</a>.  Systematic Sampling  . . . . . . . . . . . . . . . . . <a href="#page-13">13</a>
       <a href="#section-6.2.2">6.2.2</a>.  Random Sampling  . . . . . . . . . . . . . . . . . . . <a href="#page-14">14</a>
     6.3.  Flow-State Dependent Intermediate Flow Selection
           Process  . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-14">14</a>
     <a href="#section-6.4">6.4</a>.  Flow-State Dependent Packet Selection  . . . . . . . . . . <a href="#page-15">15</a>
   7.  Configuration of Intermediate Flow Selection Process
       Techniques . . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-16">16</a>
     <a href="#section-7.1">7.1</a>.  Intermediate Flow Selection Process Parameters . . . . . . <a href="#page-17">17</a>
     <a href="#section-7.2">7.2</a>.  Description of Flow-State Dependent Packet Selection . . . <a href="#page-19">19</a>
   8.  Information Model for Intermediate Flow Selection Process
       Configuration and Reporting  . . . . . . . . . . . . . . . . . <a href="#page-20">20</a>
   <a href="#section-9">9</a>.  IANA Considerations  . . . . . . . . . . . . . . . . . . . . . <a href="#page-22">22</a>
     <a href="#section-9.1">9.1</a>.  Registration of Information Elements . . . . . . . . . . . <a href="#page-22">22</a>
       <a href="#section-9.1.1">9.1.1</a>.  flowSelectorAlgorithm  . . . . . . . . . . . . . . . . <a href="#page-22">22</a>
       <a href="#section-9.1.2">9.1.2</a>.  flowSelectedOctetDeltaCount  . . . . . . . . . . . . . <a href="#page-24">24</a>
       <a href="#section-9.1.3">9.1.3</a>.  flowSelectedPacketDeltaCount . . . . . . . . . . . . . <a href="#page-24">24</a>
       <a href="#section-9.1.4">9.1.4</a>.  flowSelectedFlowDeltaCount . . . . . . . . . . . . . . <a href="#page-24">24</a>
       <a href="#section-9.1.5">9.1.5</a>.  selectorIDTotalFlowsObserved . . . . . . . . . . . . . <a href="#page-25">25</a>
       <a href="#section-9.1.6">9.1.6</a>.  selectorIDTotalFlowsSelected . . . . . . . . . . . . . <a href="#page-25">25</a>
       <a href="#section-9.1.7">9.1.7</a>.  samplingFlowInterval . . . . . . . . . . . . . . . . . <a href="#page-26">26</a>
       <a href="#section-9.1.8">9.1.8</a>.  samplingFlowSpacing  . . . . . . . . . . . . . . . . . <a href="#page-26">26</a>
       <a href="#section-9.1.9">9.1.9</a>.  flowSamplingTimeInterval . . . . . . . . . . . . . . . <a href="#page-27">27</a>
       <a href="#section-9.1.10">9.1.10</a>. flowSamplingTimeSpacing  . . . . . . . . . . . . . . . <a href="#page-27">27</a>
       <a href="#section-9.1.11">9.1.11</a>. hashFlowDomain . . . . . . . . . . . . . . . . . . . . <a href="#page-28">28</a>
     <a href="#section-9.2">9.2</a>.  Registration of Object Identifier  . . . . . . . . . . . . <a href="#page-28">28</a>
   <a href="#section-10">10</a>. Security and Privacy Considerations  . . . . . . . . . . . . . <a href="#page-28">28</a>



<span class="grey">D'Antonio, et al.            Standards Track                    [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc7014.html">RFC 7014</a>                Flow Selection Techniques         September 2013</span>


   <a href="#section-11">11</a>. Acknowledgments  . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-30">30</a>
   <a href="#section-12">12</a>. References . . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-30">30</a>
     <a href="#section-12.1">12.1</a>. Normative References . . . . . . . . . . . . . . . . . . . <a href="#page-30">30</a>
     <a href="#section-12.2">12.2</a>. Informative References . . . . . . . . . . . . . . . . . . <a href="#page-31">31</a>

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   This document describes Intermediate Flow Selection Process
   techniques for network traffic measurements.  A Flow is defined as a
   set of packets with common properties, as described in [<a href="rfc7011.html" title='"Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of Flow Information"'>RFC7011</a>].  An
   Intermediate Flow Selection Process can be executed to limit the
   resource demands for capturing, storing, exporting, and post-
   processing Flow Records.  It also can be used to select a particular
   set of Flows that are of interest to a specific application.  This
   document provides a categorization of Intermediate Flow Selection
   Process techniques and describes configuration and reporting
   parameters for them.

   This document also addresses configuration and reporting parameters
   for Flow-state dependent packet selection as described in [<a href="rfc5475.html" title='"Sampling and Filtering Techniques for IP Packet Selection"'>RFC5475</a>],
   although this technique is categorized as packet selection.  The
   reason is that Flow-state dependent packet selection techniques often
   aim at the reduction of resources for Flow capturing and Flow
   processing.  Furthermore, these techniques were only briefly
   discussed in [<a href="rfc5475.html" title='"Sampling and Filtering Techniques for IP Packet Selection"'>RFC5475</a>].  Therefore, configuration and reporting
   considerations for Flow-state dependent packet selection techniques
   have been included in this document.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.1.%20%20Requirements%20Language"></a><a class="selflink" href="#section-1.1" name="section-1.1">1.1</a>.  Requirements Language</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in <a href="rfc2119.html">RFC 2119</a> [<a href="rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Terminology"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Terminology</span>

   This document is consistent with the terminology introduced in
   [<a href="rfc7011.html" title='"Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of Flow Information"'>RFC7011</a>], [<a href="rfc5470.html" title='"Architecture for IP Flow Information Export"'>RFC5470</a>], [<a href="rfc5475.html" title='"Sampling and Filtering Techniques for IP Packet Selection"'>RFC5475</a>], and [<a href="rfc3917.html" title='"Requirements for IP Flow Information Export (IPFIX)"'>RFC3917</a>].  As in [<a href="rfc7011.html" title='"Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of Flow Information"'>RFC7011</a>] and
   [<a href="rfc5476.html" title='"Packet Sampling (PSAMP) Protocol Specifications"'>RFC5476</a>], the first letter of each IPFIX specific and Packet
   Sampling (PSAMP) specific term is capitalized, along with the
   Intermediate Flow Selection Process specific terms defined here.










<span class="grey">D'Antonio, et al.            Standards Track                    [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc7014.html">RFC 7014</a>                Flow Selection Techniques         September 2013</span>


   * Packet Classification

      Packet Classification is a process by which packets are mapped to
      specific Flow Records, based on packet properties or external
      properties (e.g., interface).  The properties (e.g., header
      information, packet content, Autonomous System (AS) number) make
      up the Flow Key.  If a Flow Record for a specific Flow Key value
      already exists, the Flow Record is updated; otherwise, a new Flow
      Record is created.

   * Intermediate Flow Selection Process

      An Intermediate Flow Selection Process is an Intermediate Process,
      as defined in [<a href="rfc6183.html" title='"IP Flow Information Export (IPFIX) Mediation: Framework"'>RFC6183</a>] that takes Flow Records as its input and
      selects a subset of this set as its output.  The Intermediate Flow
      Selection Process is a more general concept than the Intermediate
      Selection Process as defined in [<a href="rfc6183.html" title='"IP Flow Information Export (IPFIX) Mediation: Framework"'>RFC6183</a>].  While an Intermediate
      Selection Process selects Flow Records from a sequence based upon
      criteria-evaluated Flow Record values and only passes on those
      Flow Records that match the criteria, an Intermediate Flow
      Selection Process selects Flow Records using selection criteria
      applicable to a larger set of Flow characteristics and
      information.

   * Flow Cache

      A Flow Cache is the set of Flow Records.

   * Flow Selection State

      An Intermediate Flow Selection Process maintains state information
      for use by the Flow Selector.  At a given time, the Flow Selection
      State may depend on Flows and packets observed at and before that
      time, as well as other variables.  Examples include:

      (i)   sequence number of packets and Flow Records;

      (ii)  number of selected Flows;

      (iii) number of observed Flows;

      (iv)  current Flow Cache occupancy;

      (v)   Flow specific counters, lower and upper bounds;

      (vi)  Intermediate Flow Selection Process timeout intervals.





<span class="grey">D'Antonio, et al.            Standards Track                    [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc7014.html">RFC 7014</a>                Flow Selection Techniques         September 2013</span>


   * Flow Selector

      A Flow Selector defines the action of an Intermediate Flow
      Selection Process on a single Flow of its input.  The Flow
      Selector can make use of the following information in order to
      establish whether or not a Flow has to be selected:

      (i)   the content of the Flow Record;

      (ii)  any state information related to the Metering Process or
            Exporting Process;

      (iii) any Flow Selection State that may be maintained by the
            Intermediate Flow Selection Process.

   * Complete Flow

      A Complete Flow consists of all the packets that enter the
      Intermediate Flow Selection Process within the Flow timeout
      interval and that belong to the same Flow, per the definition of
      "Flow" in [<a href="rfc5470.html" title='"Architecture for IP Flow Information Export"'>RFC5470</a>].  For this definition, only packets that
      arrive at the Intermediate Flow Selection Process are considered.

   * Flow Position

      Flow Position is the position of a Flow Record within the Flow
      Cache.

   * Flow Filtering

      Flow Filtering selects flows based on a deterministic function on
      the Flow Record content, Flow Selection State, external properties
      (e.g., ingress interface), or external events (e.g., violated
      Access Control List).  If the relevant parts of the Flow Record
      content can already be observed at the packet level (e.g., Flow
      Keys from packet header fields), Flow Filtering can be performed
      at the packet level by Property Match Filtering, as described in
      [<a href="rfc5475.html" title='"Sampling and Filtering Techniques for IP Packet Selection"'>RFC5475</a>].

   * Hash-based Flow Filtering

      Hash-based Flow Filtering is a deterministic Flow filter function
      that selects flows based on a hash function.  The hash function is
      calculated over parts of the Flow Record content or external
      properties that are called the Hash Domain.  If the hash value
      falls into a predefined Hash Selection Range, the Flow is
      selected.




<span class="grey">D'Antonio, et al.            Standards Track                    [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc7014.html">RFC 7014</a>                Flow Selection Techniques         September 2013</span>


   * Flow-state Dependent Intermediate Flow Selection Process

      The Flow-state dependent Intermediate Flow Selection Process is a
      selection function that selects or drops Flows based on the
      current Flow Selection State.  The selection can be either
      deterministic, random, or non-uniform random.

   * Flow-state Dependent Packet Selection

      Flow-state dependent packet selection is a selection function that
      selects or drops packets based on the current Flow Selection
      State.  The selection can be either deterministic, random, or non-
      uniform random.  Flow-state dependent packet selection can be used
      to implement a preference for the selection of packets belonging
      to specific Flows.  For example, the selection probability of
      packets belonging to Flows that are already within the Flow Cache
      may be higher than for packets that have not been recorded yet.

   * Flow Sampling

      Flow Sampling selects flows based on Flow Record sequence or
      arrival times (e.g., entry in Flow Cache, arrival time at Exporter
      or Mediator).  The selection can be systematic (e.g., every n-th
      Flow) or based on a random function (e.g., select each Flow Record
      with probability p, or randomly select n out of N Flow Records).

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Difference%20between%20Intermediate%20Flow%20Selection%20Process%20and%20Packet"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Difference between Intermediate Flow Selection Process and Packet</span>
<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/Selection"></a>    Selection</span>

   The Intermediate Flow Selection Process differs from packet selection
   as described in [<a href="rfc5475.html" title='"Sampling and Filtering Techniques for IP Packet Selection"'>RFC5475</a>].  Packet selection techniques consider
   packets as the basic element, and the parent population consists of
   all packets observed at an Observation Point.  In contrast to this,
   the basic elements in Flow selection are the Flows.  The parent
   population consists of all observed Flows, and the Intermediate Flow
   Selection Process operates on the Flows.  The major characteristics
   of the Intermediate Flow Selection Process are the following:

   -  The Intermediate Flow Selection Process takes Flows as basic
      elements.  For packet selection, packets are considered as basic
      elements.

   -  The Intermediate Flow Selection Process typically takes place
      after Packet Classification, because the classification rules
      determine to which Flow a packet belongs.  The Intermediate Flow
      Selection Process can be performed before Packet Classification.
      In that case, the Intermediate Flow Selection Process is based on
      the Flow Key (and also on a hash value over the Flow Key) but not



<span class="grey">D'Antonio, et al.            Standards Track                    [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc7014.html">RFC 7014</a>                Flow Selection Techniques         September 2013</span>


      on characteristics that are only available after Packet
      Classification (e.g., Flow size, Flow duration).  Packet selection
      can be applied before and after Packet Classification.  As an
      example, packet selection before Packet Classification can be
      random packet selection, whereas packet selection after Packet
      Classification can be Flow-state dependent packet selection (as
      described in [<a href="rfc5475.html" title='"Sampling and Filtering Techniques for IP Packet Selection"'>RFC5475</a>]).

   -  The Intermediate Flow Selection Process operates on Complete
      Flows.  That means that after the Intermediate Flow Selection
      Process, either all packets of the Flow are kept or all packets of
      the Flow are discarded.  That means that if the Intermediate Flow
      Selection Process is preceded by a packet selection process, the
      Complete Flow consists only of the packets that were not discarded
      during the packet selection.

   There are some techniques that are difficult to unambiguously
   categorize into one of the categories.  Here, some guidance is given
   on how to categorize such techniques:

   -  Techniques that can be considered as both packet selection and an
      Intermediate Flow Selection Process: some packet selection
      techniques result in the selection of Complete Flows and therefore
      can be considered as packet selection or as an Intermediate Flow
      Selection Process at the same time.  An example is Property Match
      Filtering of all packets to a specific destination address.  If
      Flows are defined based on destination addresses, such a packet
      selection also results in an Intermediate Flow Selection Process
      and can be considered as packet selection or as an Intermediate
      Flow Selection Process.

   -  Flow-state Dependent Packet Selection: there exist techniques that
      select packets based on the Flow state, e.g., based on the number
      of already observed packets belonging to the Flow.  Examples of
      these techniques from the literature include "Sample and Hold"
      [<a href="#ref-EsVa01" title='"New Directions in Traffic Measurement and Accounting: Focusing on the Elephants, Ignoring the Mice"'>EsVa01</a>], "Fast Filtered Sampling" [<a href="#ref-MSZC10" title='"Fast Filtered Sampling"'>MSZC10</a>], and the "Sticky
      Sampling" algorithm presented in [<a href="#ref-MaMo02" title='"Approximate Frequency Counts over Data Streams"'>MaMo02</a>].  Such techniques can be
      used to influence which Flows are captured (e.g., increase the
      selection of packets belonging to large Flows) and reduce the
      number of Flows that need to be stored in the Flow Cache.
      Nevertheless, such techniques do not necessarily select Complete
      Flows, because they do not ensure that all packets of a selected
      Flow are captured.  Therefore, Flow-state dependent packet
      selection techniques that do not ensure that either all or no
      packets of a Flow are selected, strictly speaking, have to be
      considered as packet selection techniques and not as Intermediate
      Flow Selection Process techniques.




<span class="grey">D'Antonio, et al.            Standards Track                    [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc7014.html">RFC 7014</a>                Flow Selection Techniques         September 2013</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Difference%20between%20Intermediate%20Flow%20Selection%20Process%20and"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Difference between Intermediate Flow Selection Process and</span>
<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/Intermediate%20Selection%20Process"></a>    Intermediate Selection Process</span>

   The Intermediate Flow Selection Process differs from the Intermediate
   Selection Process, since the Intermediate Flow Selection Process uses
   selection criteria that apply to a larger set of Flow information and
   properties than those used by the Intermediate Selection Process.
   The typical function of an Intermediate Selection Process is Property
   Match Filtering, which selects a Flow Record if the value of a
   specific field in the Flow Record matches a configured value or falls
   within a configured range.  This means that the selection criteria
   used by an Intermediate Selection Process are evaluated only on Flow
   Record values.  An Intermediate Flow Selection Process makes its
   decision on whether a Flow has to be selected or not by taking into
   account not only information related to the content of the Flow
   Record but also any Flow Selection State information or variable that
   can be used to select Flows in order to meet application requirements
   or resource constraints (e.g., Flow Cache occupancy, export link
   capacity).  Examples include flow counters, Intermediate Flow
   Selection Process timeout intervals, and Flow Record time
   information.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Intermediate%20Flow%20Selection%20Process%20within%20the%20IPFIX%20Architecture"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Intermediate Flow Selection Process within the IPFIX Architecture</span>

   An Intermediate Flow Selection Process can be deployed at any of
   three places within the IPFIX architecture.  As shown in Figure 1,
   the Intermediate Flow Selection Process can occur

   1.  in the Metering Process at the IPFIX Exporter

   2.  in the Exporting Process at the Collector

   3.  within a Mediator


















<span class="grey">D'Antonio, et al.            Standards Track                    [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc7014.html">RFC 7014</a>                Flow Selection Techniques         September 2013</span>


                +===========================================+
                |  IPFIX Exporter        +----------------+ |
                |                        | Metering Proc. | |
                | +-----------------+    +----------------+ |
                | |    Metering     |    |  Intermediate  | |
                | |    Process      | or | Flow Selection | |
                | |                 |    |     Process    | |
                | +-----------------+----+----------------+ |
                | |           Exporting Process           | |
                | +----|-------------------------------|--+ |
                +======|===============================|====+
                       |                               |
                       |                               |
                +======|========================+      |
                |      |  Mediator              |      |
                |    +-V-------------------+    |      |
                |    | Collecting Process  |    |      |
                |    +---------------------+    |      |
                |    | Intermediate Flow   |    |      |
                |    | Selection Process   |    |      |
                |    +---------------------+    |      |
                |    |  Exporting Process  |    |      |
                |    +-|-------------------+    |      |
                +======|========================+      |
                       |                               |
                       |                               |
                +======|===============================|=====+
                |      |         Collector             |     |
                | +----V-------------------------------V-+   |
                | |         Collecting Process           |   |
                | +--------------------------------------+   |
                | | Intermediate Flow Selection Process  |   |
                | +--------------------------------------+   |
                | |           Exporting Process          |   |
                | +------------------------------|-------+   |
                +================================|===========+
                                                 |
                                                 |
                                                 V
                                          +------------------+
                                          |       IPFIX      |
                                          +------------------+

     Figure 1: Potential Intermediate Flow Selection Process Locations

   In contrast to packet selection, the Intermediate Flow Selection
   Process is always applied after the packets are classified into
   Flows.



<span class="grey">D'Antonio, et al.            Standards Track                   [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc7014.html">RFC 7014</a>                Flow Selection Techniques         September 2013</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.1.%20%20Intermediate%20Flow%20Selection%20Process%20in%20the%20Metering%20Process"></a><a class="selflink" href="#section-5.1" name="section-5.1">5.1</a>.  Intermediate Flow Selection Process in the Metering Process</span>

   An Intermediate Flow Selection Process in the Metering Process uses
   packet information to update the Flow Records in the Flow Cache.  The
   Intermediate Flow Selection Process, before Packet Classification,
   can be based on the Flow Key (and also on a hash value over the Flow
   Key) but not on characteristics that are only available after Packet
   Classification (e.g., Flow size, Flow duration).  Here, an
   Intermediate Flow Selection Process is applied to reduce resources
   for all subsequent processes or to select specific Flows of interest
   in cases where such Flow characteristics are already observable at
   the packet level (e.g., Flows to specific IP addresses).  In
   contrast, Flow-state dependent packet selection is a packet selection
   technique, because it does not necessarily select Complete Flows.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.2.%20%20Intermediate%20Flow%20Selection%20Process%20in%20the%20Exporting%20Process"></a><a class="selflink" href="#section-5.2" name="section-5.2">5.2</a>.  Intermediate Flow Selection Process in the Exporting Process</span>

   An Intermediate Flow Selection Process in the Exporting Process works
   on Flow Records and can therefore depend on Flow characteristics that
   are only visible after the classification of packets, such as Flow
   size and Flow duration.  The Exporting Process may implement policies
   for exporting only a subset of the Flow Records that have been stored
   in the system's memory, in order to offload Flow export and Flow
   post-processing.  An Intermediate Flow Selection Process in the
   Exporting Process may select only the subset of Flow Records that are
   of interest to the user's application or select only as many Flow
   Records as can be handled by the available resources (e.g., limited
   export link capacity).

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.3.%20%20Intermediate%20Flow%20Selection%20Process%20as%20a%20Function%20of%20the%20IPFIX"></a><a class="selflink" href="#section-5.3" name="section-5.3">5.3</a>.  Intermediate Flow Selection Process as a Function of the IPFIX</span>
<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/Mediator"></a>      Mediator</span>

   As shown in Figure 1, the Intermediate Flow Selection Process can be
   performed within an IPFIX Mediator [<a href="rfc6183.html" title='"IP Flow Information Export (IPFIX) Mediation: Framework"'>RFC6183</a>].  The Intermediate Flow
   Selection Process takes a Flow Record stream as its input and selects
   Flow Records from a sequence based upon criteria-evaluated record
   values.  The Intermediate Flow Selection Process can again apply an
   Intermediate Flow Selection Process technique to obtain Flows of
   interest to the application.  Further, the Intermediate Flow
   Selection Process can base its selection decision on the correlation
   of data from different IPFIX Exporters, e.g., by only selecting Flows
   that were recorded on two or more IPFIX Exporters.









<span class="grey">D'Antonio, et al.            Standards Track                   [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc7014.html">RFC 7014</a>                Flow Selection Techniques         September 2013</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20Intermediate%20Flow%20Selection%20Process%20Techniques"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  Intermediate Flow Selection Process Techniques</span>

   An Intermediate Flow Selection Process technique selects either all
   or none of the packets of a Flow; otherwise, the technique has to be
   considered as packet selection.  A difference between Flow Filtering
   and Flow sampling is recognized.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.1.%20%20Flow%20Filtering"></a><a class="selflink" href="#section-6.1" name="section-6.1">6.1</a>.  Flow Filtering</span>

   Flow Filtering is a deterministic function on the IPFIX Flow Record
   content.  If the relevant Flow characteristics are already observable
   at the packet level (e.g., Flow Keys), Flow Filtering can be applied
   before aggregation at the packet level.  In order to be compliant
   with IPFIX, at least one of this document's Flow Filtering schemes
   MUST be implemented.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/6.1.1.%20%20Property%20Match%20Filtering"></a><a class="selflink" href="#section-6.1.1" name="section-6.1.1">6.1.1</a>.  Property Match Filtering</span>

   Property Match Filtering is performed similarly to Property Match
   Filtering for packet selection as described in [<a href="rfc5475.html" title='"Sampling and Filtering Techniques for IP Packet Selection"'>RFC5475</a>].  The
   difference is that Flow Record fields are used here, instead of
   packet fields, to derive the selection decision.  Property Match
   Filtering is used to select a specific subset of the Flows that are
   of interest to a particular application (e.g., all Flows to a
   specific destination, all large Flows, etc.).  Properties on which
   the filtering is based can be Flow Keys, Flow Timestamps, or Per-Flow
   Counters as described in [<a href="rfc7012.html" title='"Information Model for IP Flow Information Export (IPFIX)"'>RFC7012</a>].  Examples include the Flow size
   in bytes, the number of packets in the Flow, the observation time of
   the first or last packet, and the maximum packet length.  An example
   of Property Match Filtering is to select Flows with more than a
   threshold number of observed octets.  The selection criteria can be a
   specific value, a set of specific values, or an interval.  For
   example, a Flow is selected if destinationIPv4Address and the total
   number of packets of the Flow equal two predefined values.  An
   Intermediate Flow Selection Process using Property Match Filtering in
   the Metering Process relies on properties that are observable at the
   packet level (e.g., Flow Key).  For example, a Flow is selected if
   sourceIPv4Address and sourceIPv4PrefixLength equal, respectively, two
   specific values.

   An Intermediate Flow Selection Process using Property Match Filtering
   in the Exporting Process is based on properties that are only visible
   after Packet Classification, such as Flow size and Flow duration.  An
   example is the selection of the largest Flows or a percentage of
   Flows with the longest lifetime.  Another example is to select and
   remove from the Flow Cache the Flow Record with the lowest Flow
   volume per current Flow lifetime if the Flow Cache is full.




<span class="grey">D'Antonio, et al.            Standards Track                   [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc7014.html">RFC 7014</a>                Flow Selection Techniques         September 2013</span>


   An Intermediate Flow Selection Process using Property Match Filtering
   within an IPFIX Mediator selects a Flow Record if the value of a
   specific field in the Flow Record equals a configured value or falls
   within a configured range [<a href="rfc6183.html" title='"IP Flow Information Export (IPFIX) Mediation: Framework"'>RFC6183</a>].

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/6.1.2.%20%20Hash-Based%20Flow%20Filtering"></a><a class="selflink" href="#section-6.1.2" name="section-6.1.2">6.1.2</a>.  Hash-Based Flow Filtering</span>

   Hash-based Flow Filtering uses a hash function h to map the Flow Key
   c onto a Hash Range R.  A Flow is selected if the hash value h(c) is
   within the Hash Selection Range S, which is a subset of R.  Hash-
   based Flow Filtering can be used to emulate a random sampling process
   but still enable the correlation between selected Flow subsets at
   different Observation Points.  Hash-based Flow Filtering is similar
   to Hash-based packet selection and is in fact identical when Hash-
   based packet selection uses the Flow Key that defines the Flow as the
   hash input.  Nevertheless, there may be the incentive to apply Hash-
   based Flow Filtering, but not at the packet level, in the Metering
   Process, for example, when the size of the selection range, and
   therefore the sampling probability, are dependent on the number of
   observed Flows.  If Hash-based Flow Filtering is used to select the
   same subset of flows at different Observation Points, the Hash Domain
   MUST only include parts of the Flow Record content that are invariant
   on the Flow path.  Refer also to the Trajectory Sampling application
   example of coordinated packet selection [<a href="rfc5475.html" title='"Sampling and Filtering Techniques for IP Packet Selection"'>RFC5475</a>], which explains the
   hash-based filtering approach at the packet level.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.2.%20%20Flow%20Sampling"></a><a class="selflink" href="#section-6.2" name="section-6.2">6.2</a>.  Flow Sampling</span>

   Flow sampling operates on Flow Record sequence or arrival times.  It
   can use either a systematic or a random function for the Intermediate
   Flow Selection Process.  Flow sampling usually aims at the selection
   of a representative subset of all Flows in order to estimate
   characteristics of the whole set (e.g., mean Flow size in the
   network).

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/6.2.1.%20%20Systematic%20Sampling"></a><a class="selflink" href="#section-6.2.1" name="section-6.2.1">6.2.1</a>.  Systematic Sampling</span>

   Systematic sampling is a deterministic selection function.  It may be
   a periodic selection of the N-th Flow Record that arrives at the
   Intermediate Flow Selection Process.  Systematic sampling MAY be
   applied in the Metering Process.  An example would be to create,
   besides the Flow Cache of selected Flows, an additional data
   structure that saves the Flow Key values of the Flows that are not
   selected.  The selection of a Flow would then be based on the first
   packet of a Flow.  Every time a packet belonging to a new Flow (which
   is not in the data structure of either the selected or non-selected
   Flows) arrives at the Observation Point, a counter is increased.  If




<span class="grey">D'Antonio, et al.            Standards Track                   [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc7014.html">RFC 7014</a>                Flow Selection Techniques         September 2013</span>


   the counter is increased to a multiple of N, a new Flow Cache entry
   is created; if the counter is not a multiple of N, the Flow Key value
   is added to the data structure for non-selected Flows.

   Systematic sampling can also be time-based.  Time-based systematic
   sampling is applied by only creating Flows that are observed between
   time-based start and stop triggers.  The time interval may be applied
   at the packet level in the Metering Process or after aggregation at
   the Flow level, e.g., by selecting a Flow arriving at the Exporting
   Process every n seconds.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/6.2.2.%20%20Random%20Sampling"></a><a class="selflink" href="#section-6.2.2" name="section-6.2.2">6.2.2</a>.  Random Sampling</span>

   Random Flow sampling is based on a random process that requires the
   calculation of random numbers.  One can differentiate between n-out-
   of-N and probabilistic Flow sampling.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/6.2.2.1.%20%20n-out-of-N%20Flow%20Sampling"></a><a class="selflink" href="#section-6.2.2.1" name="section-6.2.2.1">6.2.2.1</a>.  n-out-of-N Flow Sampling</span>

   In n-out-of-N Sampling, n elements are selected out of the parent
   population, which consists of N elements.  One example would be to
   generate n different random numbers in the range [1,N] and select all
   Flows that have a Flow Position equal to one of the random numbers.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/6.2.2.2.%20%20Probabilistic%20Flow%20Sampling"></a><a class="selflink" href="#section-6.2.2.2" name="section-6.2.2.2">6.2.2.2</a>.  Probabilistic Flow Sampling</span>

   In probabilistic Sampling, the decision of whether or not a Flow is
   selected is made in accordance with a predefined selection
   probability.  For probabilistic Sampling, the Sample Size can vary
   for different trials.  The selection probability does not necessarily
   have to be the same for each Flow.  Therefore, a difference between
   uniform probabilistic sampling (with the same selection probability
   for all Flows) and non-uniform probabilistic sampling (where the
   selection probability can vary for different Flows) is recognized.
   For non-uniform probabilistic Flow sampling, the sampling probability
   may be adjusted according to the Flow Record content.  An example
   would be to increase the selection probability of large-volume Flows
   over small-volume Flows, as described in [<a href="#ref-DuLT01" title='"Charging from Sampled Network Usage"'>DuLT01</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.3.%20%20Flow-State%20Dependent%20Intermediate%20Flow%20Selection%20Process"></a><a class="selflink" href="#section-6.3" name="section-6.3">6.3</a>.  Flow-State Dependent Intermediate Flow Selection Process</span>

   The Flow-state dependent Intermediate Flow Selection Process can be a
   deterministic or random Intermediate Flow Selection Process, based on
   the Flow Record content and the Flow state that may be kept
   additionally for each of the Flows.  External processes may update
   counters, bounds, and timers for each of the Flow Records, and the
   Intermediate Flow Selection Process utilizes this information for the
   selection decision.  A review of Flow-state dependent Intermediate



<span class="grey">D'Antonio, et al.            Standards Track                   [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc7014.html">RFC 7014</a>                Flow Selection Techniques         September 2013</span>


   Flow Selection Process techniques that aim at the selection of the
   most frequent items by keeping additional Flow state information can
   be found in [<a href="#ref-CoHa08" title='"Finding Frequent Items in Data Streams"'>CoHa08</a>].  The Flow-state dependent Intermediate Flow
   Selection Process can only be applied after packet aggregation, when
   a packet has been assigned to a Flow.  The Intermediate Flow
   Selection Process then decides, based on the Flow state for each
   Flow, whether it is kept in the Flow Cache or not.  Two Flow-state
   dependent Intermediate Flow Selection Process Algorithms are
   described here:

   The Frequent algorithm [<a href="#ref-KaPS03" title='"A simple algorithm for finding frequent elements in sets and bags"'>KaPS03</a>] is a technique that aims at the
   selection of all flows that at least exceed a 1/k fraction of the
   Observed Packet Stream.  The algorithm has only a Flow Cache of size
   k-1, and each Flow in the Flow Cache has an additional counter.  The
   counter is incremented each time a packet belonging to the Flow in
   the Flow Cache is observed.  If the observed packet does not belong
   to any Flow, all counters are decremented; if any of the Flow
   counters has a value of zero, the Flow is replaced with a Flow formed
   from the new packet.

   Lossy counting is a selection technique that identifies all Flows
   whose packet count exceeds a certain percentage of the whole observed
   packet stream (e.g., 5% of all packets) with a certain estimation
   error e.  Lossy counting separates the observed packet stream in
   windows of size N=1/e, where N is an amount of consecutive packets.
   For each observed Flow, an additional counter will be held in the
   Flow state.  The counter is incremented each time a packet belonging
   to the Flow is observed, and all counters are decremented at the end
   of each window.  Also, all Flows with a counter of zero are removed
   from the Flow Cache.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.4.%20%20Flow-State%20Dependent%20Packet%20Selection"></a><a class="selflink" href="#section-6.4" name="section-6.4">6.4</a>.  Flow-State Dependent Packet Selection</span>

   Flow-state dependent packet selection is not an Intermediate Flow
   Selection Process technique but a packet selection technique.
   Nevertheless, configuration and reporting parameters for this
   technique will be described in this document.  An example is the
   "Sample and Hold" algorithm [<a href="#ref-EsVa01" title='"New Directions in Traffic Measurement and Accounting: Focusing on the Elephants, Ignoring the Mice"'>EsVa01</a>], which tries to implement a
   preference for large-volume Flows in the selection.  When a packet
   arrives, it is selected when a Flow Record for this packet already
   exists.  If there is no Flow Record, the packet is selected according
   to a certain probability that is dependent on the packet size.









<span class="grey">D'Antonio, et al.            Standards Track                   [Page 15]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc7014.html">RFC 7014</a>                Flow Selection Techniques         September 2013</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20Configuration%20of%20Intermediate%20Flow%20Selection%20Process%20Techniques"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  Configuration of Intermediate Flow Selection Process Techniques</span>

   This section describes the configuration parameters of the Flow
   selection techniques presented above.  It provides the basis for an
   information model to be adopted in order to configure the
   Intermediate Flow Selection Process within an IPFIX Device.  The
   information model with the Information Elements (IEs) for
   Intermediate Flow Selection Process configuration is described
   together with the reporting IEs in <a href="#section-8">Section 8</a>.  Table 1 gives an
   overview of the defined Intermediate Flow Selection Process
   techniques, where they can be applied, and what their input
   parameters are.  Depending on where the Flow selection techniques are
   applied, different input parameters can be configured.

   +-------------------+--------------------+--------------------------+
   | Location          | Selection          | Selection Input          |
   |                   | Technique          |                          |
   +-------------------+--------------------+--------------------------+
   | In the Metering   | Flow-state         | packet sampling          |
   | Process           | Dependent Packet   | probabilities, Flow      |
   |                   | Selection          | Selection State, packet  |
   |                   |                    | properties               |
   |                   |                    |                          |
   | In the Metering   | Property Match     | Flow Record IEs,         |
   | Process           | Flow Filtering     | Selection Interval       |
   |                   |                    |                          |
   | In the Metering   | Hash-based Flow    | selection range, hash    |
   | Process           | Filtering          | function, Flow Key, seed |
   |                   |                    | (optional)               |
   |                   |                    |                          |
   | In the Metering   | Time-based         | Flow Position (derived   |
   | Process           | Systematic Flow    | from arrival time of     |
   |                   | sampling           | packets), Flow Selection |
   |                   |                    | State                    |
   |                   |                    |                          |
   | In the Metering   | Sequence-based     | Flow Position (derived   |
   | Process           | Systematic Flow    | from packet position),   |
   |                   | sampling           | Flow Selection State     |
   |                   |                    |                          |
   | In the Metering   | Random Flow        | random number generator  |
   | Process           | sampling           | or list and packet       |
   |                   |                    | position, Flow state     |
   |                   |                    |                          |
   | In the Exporting  | Property Match     | Flow Record content,     |
   | Process/ within   | Flow Filtering     | filter function          |
   | the IPFIX         |                    |                          |
   | Mediator          |                    |                          |
   |                   |                    |                          |



<span class="grey">D'Antonio, et al.            Standards Track                   [Page 16]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc7014.html">RFC 7014</a>                Flow Selection Techniques         September 2013</span>


   | In the Exporting  | Hash-based Flow    | selection range, hash    |
   | Process/ within   | Filtering          | function, hash input     |
   | the IPFIX         |                    | (Flow Keys and other     |
   | Mediator          |                    | Flow properties)         |
   |                   |                    |                          |
   | In the Exporting  | Flow-state         | Flow state parameters,   |
   | Process/ within   | Dependent          | random number generator  |
   | the IPFIX         | Intermediate Flow  | or list                  |
   | Mediator          | Selection Process  |                          |
   |                   |                    |                          |
   | In the Exporting  | Time-based         | Flow arrival time, Flow  |
   | Process/ within   | Systematic Flow    | state                    |
   | the IPFIX         | sampling           |                          |
   | Mediator          |                    |                          |
   |                   |                    |                          |
   | In the Exporting  | Sequence-based     | Flow Position, Flow      |
   | Process/ within   | Systematic Flow    | state                    |
   | the IPFIX         | sampling           |                          |
   | Mediator          |                    |                          |
   |                   |                    |                          |
   | In the Exporting  | Random Flow        | random number generator  |
   | Process/ within   | sampling           | or list and Flow         |
   | the IPFIX         |                    | Position, Flow state     |
   | Mediator          |                    |                          |
   +-------------------+--------------------+--------------------------+

    Table 1: Overview of Intermediate Flow Selection Process Techniques

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.1.%20%20Intermediate%20Flow%20Selection%20Process%20Parameters"></a><a class="selflink" href="#section-7.1" name="section-7.1">7.1</a>.  Intermediate Flow Selection Process Parameters</span>

   This section defines what parameters are required to describe the
   most common Intermediate Flow Selection Process techniques.

   Intermediate Flow Selection Process Parameters:

   For Property Match Filtering:

   -  Information Element as specified in [<a href="#ref-IANA-IPFIX" title='"IP Flow Information Export (IPFIX) Entities Registry"'>IANA-IPFIX</a>]):
      Specifies the Information Element that is used as the property in
      the filter expression.  <a href="#section-8">Section 8</a> specifies the Information
      Elements that MUST be exported by an Intermediate Flow Selection
      Process using Property Match Filtering.

   -  Selection Value or Value Interval:
      Specifies the value or interval of the filter expression.  Packets
      and Flow Records that have a value equal to the Selection Value or
      within the Interval will be selected.




<span class="grey">D'Antonio, et al.            Standards Track                   [Page 17]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc7014.html">RFC 7014</a>                Flow Selection Techniques         September 2013</span>


   For Hash-based Flow Filtering:

   -  Hash Domain:
      Specifies the bits from the packet or Flow that are taken as the
      hash input to the hash function.

   -  Hash Function:
      Specifies the name of the hash function that is used to calculate
      the hash value.  Possible hash functions are BOB [<a href="rfc5475.html" title='"Sampling and Filtering Techniques for IP Packet Selection"'>RFC5475</a>], IP
      Shift-XOR (IPSX) [<a href="rfc5475.html" title='"Sampling and Filtering Techniques for IP Packet Selection"'>RFC5475</a>], and CRC-32 [<a href="#ref-Bra75" title='"Evaluation of 32 Degree Polynomials in Error Detection on the SATIN IV Autovon Error Patterns"'>Bra75</a>].

   -  Hash Selection Range:
      Flows that have a hash value within the Hash Selection Range are
      selected.  The Hash Selection Range can be a value interval or
      arbitrary hash values within the Hash Range of the hash function.

   -  Random Seed or Initializer Value:
      Some hash functions require an initializing value.  In order to
      make the selection decision more secure, one can choose a random
      seed that configures the hash function.

   For Flow-state Dependent Intermediate Flow Selection Process:

   -  Frequency threshold:
      Specifies the frequency threshold s for Flow-state dependent Flow
      Selection techniques that try to find the most frequent items
      within a dataset.  All Flows that exceed the defined threshold
      will be selected.

   -  Accuracy parameter:
      Specifies the accuracy parameter e for techniques that deal with
      the issue of mining frequent items in a dataset.  The accuracy
      parameter defines the maximum error, i.e., no Flows that have a
      true frequency less than (s - e) N are selected, where s is the
      frequency threshold and N is the total number of packets.

   The above list of parameters for Flow-state dependent Flow Selection
   techniques is suitable for the presented frequent item and lossy
   counting algorithms.  Nevertheless, a variety of techniques exist
   with very specific parameters not defined here.

   For Systematic time-based Flow sampling:

   -  Interval length (in usec):
      Defines the length of the sampling interval during which Flows are
      selected.





<span class="grey">D'Antonio, et al.            Standards Track                   [Page 18]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-19" id="page-19" name="page-19"> </a>
<span class="grey"><a href="rfc7014.html">RFC 7014</a>                Flow Selection Techniques         September 2013</span>


   -  Spacing (in usec):
      Defines the spacing in usec between the end of one sampling
      interval and the start of the next interval.

   For Systematic count-based Flow sampling:

   -  Interval length:
      Defines the number of Flows that are selected within the sampling
      interval.

   -  Spacing:
      Defines the spacing, in number of observed Flows, between the end
      of one sampling interval and the start of the next interval.

   For random n-out-of-N Flow sampling:

   -  Population Size N:
      The number of all Flows in the Population from which the sample is
      drawn.

   -  Sampling Size n:
      The number of Flows that are randomly drawn from the population N.

   For probabilistic Flow sampling:

   -  Sampling probability p:
      Defines the probability by which each of the observed Flows is
      selected.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.2.%20%20Description%20of%20Flow-State%20Dependent%20Packet%20Selection"></a><a class="selflink" href="#section-7.2" name="section-7.2">7.2</a>.  Description of Flow-State Dependent Packet Selection</span>

   The configuration of Flow-state dependent packet selection has not
   been described in [<a href="rfc5475.html" title='"Sampling and Filtering Techniques for IP Packet Selection"'>RFC5475</a>]; therefore, the parameters are defined
   here:

   For Flow-state Dependent Packet Selection:

   -  Packet selection probability per possible Flow state interval:
      Defines multiple {Flow interval, packet selection probability}
      value pairs that configure the sampling probability, depending on
      the current Flow state.

   -  Additional parameters:
      For the configuration of Flow-state dependent packet selection,
      additional parameters or packet properties may be required, e.g.,
      the packet size [<a href="#ref-EsVa01" title='"New Directions in Traffic Measurement and Accounting: Focusing on the Elephants, Ignoring the Mice"'>EsVa01</a>].





<span class="grey">D'Antonio, et al.            Standards Track                   [Page 19]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-20" id="page-20" name="page-20"> </a>
<span class="grey"><a href="rfc7014.html">RFC 7014</a>                Flow Selection Techniques         September 2013</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20Information%20Model%20for%20Intermediate%20Flow%20Selection%20Process"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  Information Model for Intermediate Flow Selection Process</span>
<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/Configuration%20and%20Reporting"></a>    Configuration and Reporting</span>

   This section specifies the Information Elements that MUST be exported
   by an Intermediate Flow Selection Process in order to support the
   interpretation of measurement results from Flow measurements.  The
   information is mainly used to report how many packets and Flows have
   been observed in total and how many of them were selected.  This
   helps, for instance, to calculate the Attained Selection Fraction
   (see also [<a href="rfc5476.html" title='"Packet Sampling (PSAMP) Protocol Specifications"'>RFC5476</a>]), which is an important parameter for providing
   an accuracy statement.  The IEs can provide reporting information
   about Flow Records, packets, or bytes.  The reported metrics are the
   total number of elements and the number of selected elements.  The
   number of dropped elements can be derived from this information.





































<span class="grey">D'Antonio, et al.            Standards Track                   [Page 20]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-21" id="page-21" name="page-21"> </a>
<span class="grey"><a href="rfc7014.html">RFC 7014</a>                Flow Selection Techniques         September 2013</span>


   Table 2 shows a list of Intermediate Flow Selection Process
   Information Elements:

   ID   Name                         | ID   Name
   ----------------------------------+----------------------------------
   301  selectionSequenceID          | 302  selectorID
                                     |
   390  flowSelectorAlgorithm        |   1  octetDeltaCount
                                     |
   391  flowSelectedOctetDeltaCount  |   2  packetDeltaCount
                                     |
   392  flowSelectedPacketDeltaCount |   3  originalFlowsPresent
                                     |
   393  flowSelectedFlowDeltaCount   | 394  selectorIDTotalFlowsObserved
                                     |
   395  selectorIDTotalFlowsSelected | 396  samplingFlowInterval
                                     |
   397  samplingFlowSpacing          | 309  samplingSize
                                     |
   310  samplingPopulation           | 311  samplingProbability
                                     |
   398  flowSamplingTimeInterval     | 399  flowSamplingTimeSpacing
                                     |
   326  digestHashValue              | 400  hashFlowDomain
                                     |
   329  hashOutputRangeMin           | 330  hashOutputRangeMax
                                     |
   331  hashSelectedRangeMin         | 332  hashSelectedRangeMax
                                     |
   333  hashDigestOutput             | 334  hashInitialiserValue
                                     |
   320  absoluteError                | 321  relativeError
                                     |
   336  upperCILimit                 | 337  lowerCILimit
                                     |
   338  confidenceLevel              |

     Table 2: Intermediate Flow Selection Process Information Elements













<span class="grey">D'Antonio, et al.            Standards Track                   [Page 21]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-22" id="page-22" name="page-22"> </a>
<span class="grey"><a href="rfc7014.html">RFC 7014</a>                Flow Selection Techniques         September 2013</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/9.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-9" name="section-9">9</a>.  IANA Considerations</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/9.1.%20%20Registration%20of%20Information%20Elements"></a><a class="selflink" href="#section-9.1" name="section-9.1">9.1</a>.  Registration of Information Elements</span>

   IANA has registered the following IEs in the "IPFIX Information
   Elements" registry at <a href="http://www.iana.org/assignments/ipfix/">http://www.iana.org/assignments/ipfix/</a>.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/9.1.1.%20%20flowSelectorAlgorithm"></a><a class="selflink" href="#section-9.1.1" name="section-9.1.1">9.1.1</a>.  flowSelectorAlgorithm</span>

   Description:

      This Information Element identifies the Intermediate Flow
      Selection Process technique (e.g., Filtering, Sampling) that is
      applied by the Intermediate Flow Selection Process.  Most of these
      techniques have parameters; configuration parameter(s) MUST be
      clearly specified.  Further Information Elements are needed to
      fully specify packet selection with these methods and all their
      parameters.  Further method identifiers may be added to the list
      below.  It might be necessary to define new Information Elements
      to specify their parameters.  The flowSelectorAlgorithm registry
      is maintained by IANA.  New assignments for the registry will be
      administered by IANA, on a First Come First Served basis
      [<a href="rfc5226.html" title='"Guidelines for Writing an IANA Considerations Section in RFCs"'>RFC5226</a>], subject to Expert Review [<a href="rfc5226.html" title='"Guidelines for Writing an IANA Considerations Section in RFCs"'>RFC5226</a>].  Please note that
      the purpose of the flow selection techniques described in this
      document is the improvement of measurement functions as defined in
      the Introduction (<a href="#section-1">Section 1</a>).  Before adding new flow selector
      algorithms, their intended purposes should be determined,
      especially if those purposes contradict any policies defined in
      [<a href="rfc2804.html" title='"IETF Policy on Wiretapping"'>RFC2804</a>].  The designated expert(s) should consult with the
      community if a request that runs counter to [<a href="rfc2804.html" title='"IETF Policy on Wiretapping"'>RFC2804</a>] is received.
      The registry can be updated when specifications of the new
      method(s) and any new Information Elements are provided.  The
      group of experts must double-check the flowSelectorAlgorithm
      definitions and Information Elements with already-defined
      flowSelectorAlgorithm definitions and Information Elements for
      completeness, accuracy, and redundancy.  Those experts will
      initially be drawn from the Working Group Chairs and document
      editors of the IPFIX and PSAMP Working Groups.  The following
      identifiers for Intermediate Flow Selection Process Techniques are
      defined here:











<span class="grey">D'Antonio, et al.            Standards Track                   [Page 22]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-23" id="page-23" name="page-23"> </a>
<span class="grey"><a href="rfc7014.html">RFC 7014</a>                Flow Selection Techniques         September 2013</span>


         +----+------------------------+--------------------------+
         | ID |       Technique        |      Parameters          |
         +----+------------------------+--------------------------+
         | 1  | Systematic count-based | flowSamplingInterval     |
         |    | Sampling               | flowSamplingSpacing      |
         +----+------------------------+--------------------------+
         | 2  | Systematic time-based  | flowSamplingTimeInterval |
         |    | Sampling               | flowSamplingTimeSpacing  |
         +----+------------------------+--------------------------+
         | 3  | Random n-out-of-N      | samplingSize             |
         |    | Sampling               | samplingPopulation       |
         +----+------------------------+--------------------------+
         | 4  | Uniform probabilistic  | samplingProbability      |
         |    | Sampling               |                          |
         +----+------------------------+--------------------------+
         | 5  | Property Match         | Information Element      |
         |    | Filtering              | Value Range              |
         +----+------------------------+--------------------------+
         |   Hash-based Filtering      | hashInitialiserValue     |
         +----+------------------------+ hashFlowDomain           |
         | 6  | using BOB              | hashSelectedRangeMin     |
         +----+------------------------+ hashSelectedRangeMax     |
         | 7  | using IPSX             | hashOutputRangeMin       |
         +----+------------------------+ hashOutputRangeMax       |
         | 8  | using CRC              |                          |
         +----+------------------------+--------------------------+
         | 9  | Flow-state Dependent   |No agreed Parameters      |
         |    | Intermediate Flow      |                          |
         |    | Selection Process      |                          |
         +----+------------------------+--------------------------+

          Table 3: Intermediate Flow Selection Process Techniques

   Abstract Data Type: unsigned16

   ElementId: 390

   Data Type Semantics: identifier

   Status: current











<span class="grey">D'Antonio, et al.            Standards Track                   [Page 23]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-24" id="page-24" name="page-24"> </a>
<span class="grey"><a href="rfc7014.html">RFC 7014</a>                Flow Selection Techniques         September 2013</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/9.1.2.%20%20flowSelectedOctetDeltaCount"></a><a class="selflink" href="#section-9.1.2" name="section-9.1.2">9.1.2</a>.  flowSelectedOctetDeltaCount</span>

   Description:

      This Information Element specifies the volume in octets of all
      Flows that are selected in the Intermediate Flow Selection Process
      since the previous report.

   Abstract Data Type: unsigned64

   ElementId: 391

   Units: octets

   Status: current

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/9.1.3.%20%20flowSelectedPacketDeltaCount"></a><a class="selflink" href="#section-9.1.3" name="section-9.1.3">9.1.3</a>.  flowSelectedPacketDeltaCount</span>

   Description:

      This Information Element specifies the volume in packets of all
      Flows that were selected in the Intermediate Flow Selection
      Process since the previous report.

   Abstract Data Type: unsigned64

   ElementId: 392

   Units: packets

   Status: current

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/9.1.4.%20%20flowSelectedFlowDeltaCount"></a><a class="selflink" href="#section-9.1.4" name="section-9.1.4">9.1.4</a>.  flowSelectedFlowDeltaCount</span>

   Description:

      This Information Element specifies the number of Flows that were
      selected in the Intermediate Flow Selection Process since the last
      report.

   Abstract Data Type: unsigned64

   ElementId: 393

   Units: flows

   Status: current




<span class="grey">D'Antonio, et al.            Standards Track                   [Page 24]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-25" id="page-25" name="page-25"> </a>
<span class="grey"><a href="rfc7014.html">RFC 7014</a>                Flow Selection Techniques         September 2013</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/9.1.5.%20%20selectorIDTotalFlowsObserved"></a><a class="selflink" href="#section-9.1.5" name="section-9.1.5">9.1.5</a>.  selectorIDTotalFlowsObserved</span>

   Description:

      This Information Element specifies the total number of Flows
      observed by a Selector, for a specific value of SelectorID.  This
      Information Element should be used in an Options Template scoped
      to the observation to which it refers.  See <a href="#section-3.4.2.1">Section 3.4.2.1</a> of the
      IPFIX protocol document [<a href="rfc7011.html" title='"Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of Flow Information"'>RFC7011</a>].

   Abstract Data Type: unsigned64

   ElementId: 394

   Units: flows

   Status: current

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/9.1.6.%20%20selectorIDTotalFlowsSelected"></a><a class="selflink" href="#section-9.1.6" name="section-9.1.6">9.1.6</a>.  selectorIDTotalFlowsSelected</span>

   Description:

      This Information Element specifies the total number of Flows
      selected by a Selector, for a specific value of SelectorID.  This
      Information Element should be used in an Options Template scoped
      to the observation to which it refers.  See <a href="#section-3.4.2.1">Section 3.4.2.1</a> of the
      IPFIX protocol document [<a href="rfc7011.html" title='"Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of Flow Information"'>RFC7011</a>].

   Abstract Data Type: unsigned64

   ElementId: 395

   Units: flows

   Status: current
















<span class="grey">D'Antonio, et al.            Standards Track                   [Page 25]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-26" id="page-26" name="page-26"> </a>
<span class="grey"><a href="rfc7014.html">RFC 7014</a>                Flow Selection Techniques         September 2013</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/9.1.7.%20%20samplingFlowInterval"></a><a class="selflink" href="#section-9.1.7" name="section-9.1.7">9.1.7</a>.  samplingFlowInterval</span>

   Description:

      This Information Element specifies the number of Flows that are
      consecutively sampled.  A value of 100 means that 100 consecutive
      Flows are sampled.  For example, this Information Element may be
      used to describe the configuration of a systematic count-based
      Sampling Selector.

   Abstract Data Type: unsigned64

   ElementId: 396

   Units: flows

   Status: current

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/9.1.8.%20%20samplingFlowSpacing"></a><a class="selflink" href="#section-9.1.8" name="section-9.1.8">9.1.8</a>.  samplingFlowSpacing</span>

   Description:

      This Information Element specifies the number of Flows between two
      "samplingFlowInterval"s.  A value of 100 means that the next
      interval starts 100 Flows (which are not sampled) after the
      current "samplingFlowInterval" is over.  For example, this
      Information Element may be used to describe the configuration of a
      systematic count-based Sampling Selector.

   Abstract Data Type: unsigned64

   ElementId: 397

   Units: flows

   Status: current















<span class="grey">D'Antonio, et al.            Standards Track                   [Page 26]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-27" id="page-27" name="page-27"> </a>
<span class="grey"><a href="rfc7014.html">RFC 7014</a>                Flow Selection Techniques         September 2013</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/9.1.9.%20%20flowSamplingTimeInterval"></a><a class="selflink" href="#section-9.1.9" name="section-9.1.9">9.1.9</a>.  flowSamplingTimeInterval</span>

   Description:

      This Information Element specifies the time interval in
      microseconds during which all arriving Flows are sampled.  For
      example, this Information Element may be used to describe the
      configuration of a systematic time-based Sampling Selector.

   Abstract Data Type: unsigned64

   ElementId: 398

   Units: microseconds

   Status: current

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/9.1.10.%20%20flowSamplingTimeSpacing"></a><a class="selflink" href="#section-9.1.10" name="section-9.1.10">9.1.10</a>.  flowSamplingTimeSpacing</span>

   Description:

      This Information Element specifies the time interval in
      microseconds between two "flowSamplingTimeInterval"s.  A value of
      100 means that the next interval starts 100 microseconds (during
      which no Flows are sampled) after the current
      "flowsamplingTimeInterval" is over.  For example, this Information
      Element may be used to describe the configuration of a systematic
      time-based Sampling Selector.

   Abstract Data Type: unsigned64

   ElementId: 399

   Units: microseconds

   Status: current















<span class="grey">D'Antonio, et al.            Standards Track                   [Page 27]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-28" id="page-28" name="page-28"> </a>
<span class="grey"><a href="rfc7014.html">RFC 7014</a>                Flow Selection Techniques         September 2013</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/9.1.11.%20%20hashFlowDomain"></a><a class="selflink" href="#section-9.1.11" name="section-9.1.11">9.1.11</a>.  hashFlowDomain</span>

   Description:

      This Information Element specifies the Information Elements that
      are used by the Hash-based Flow Selector as the Hash Domain.

   Abstract Data Type: unsigned16

   ElementId: 400

   Data Type Semantics: identifier

   Status: Current

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/9.2.%20%20Registration%20of%20Object%20Identifier"></a><a class="selflink" href="#section-9.2" name="section-9.2">9.2</a>.  Registration of Object Identifier</span>

   IANA has registered the following OID in the IPFIX-SELECTOR-MIB
   Functions subregistry at <a href="http://www.iana.org/assignments/smi-numbers">http://www.iana.org/assignments/smi-numbers</a>
   according to the procedures set forth in [<a href="rfc6615.html" title='"Definitions of Managed Objects for IP Flow Information Export"'>RFC6615</a>].

   +---------+-----------------------+---------------------+-----------+
   | Decimal | Name                  | Description         | Reference |
   +---------+-----------------------+---------------------+-----------+
   | 8       | flowSelectorAlgorithm | This Object         | [<a href="rfc7014.html">RFC7014</a>] |
   |         |                       | Identifier          |           |
   |         |                       | identifies the      |           |
   |         |                       | Intermediate Flow   |           |
   |         |                       | Selection Process   |           |
   |         |                       | technique (e.g.,    |           |
   |         |                       | Filtering,          |           |
   |         |                       | Sampling) that is   |           |
   |         |                       | applied by the      |           |
   |         |                       | Intermediate Flow   |           |
   |         |                       | Selection Process   |           |
   +---------+-----------------------+---------------------+-----------+

               Table 4: Object Identifiers to Be Registered

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/10.%20%20Security%20and%20Privacy%20Considerations"></a><a class="selflink" href="#section-10" name="section-10">10</a>.  Security and Privacy Considerations</span>

   Flow data exported by Exporting Processes, and collected by
   Collecting Processes, can be sensitive for privacy reasons and need
   to be protected.  Privacy considerations for collected data are
   provided in [<a href="rfc7011.html" title='"Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of Flow Information"'>RFC7011</a>].

   Some of the described Intermediate Flow Selection Process techniques
   (e.g., Flow sampling, hash-based Flow Filtering) aim at the selection



<span class="grey">D'Antonio, et al.            Standards Track                   [Page 28]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-29" id="page-29" name="page-29"> </a>
<span class="grey"><a href="rfc7014.html">RFC 7014</a>                Flow Selection Techniques         September 2013</span>


   of a representative subset of flows in order to estimate parameters
   of the population.  An adversary may have incentives to influence the
   selection of flows, for example, to circumvent accounting or to avoid
   the detection of packets that are part of an attack.

   Security considerations concerning the choice of a hash function for
   Hash-based packet selection have been discussed in <a href="rfc5475.html#section-6.2.3">Section 6.2.3 of
   [RFC5475]</a> and are also appropriate for Hash-based Flow Selection.
   [<a href="rfc5475.html" title='"Sampling and Filtering Techniques for IP Packet Selection"'>RFC5475</a>] discusses the possibility of crafting Packet Streams that
   are disproportionately selected or can be used to discover hash
   function parameters.  It also describes vulnerabilities of different
   hash functions to these attacks and discusses practices to minimize
   these vulnerabilities.

   For other sampling approaches, an adversary can gain knowledge about
   the start and stop triggers in time-based systematic Sampling, e.g.,
   by sending test packets.  This knowledge might allow adversaries to
   modify their send schedule in such a way that their packets are
   disproportionately selected or not selected.  For random Sampling, an
   input to the encryption process, like the Initialization Vector of
   the CBC (Cipher Block Chaining) mode, should be used to prevent an
   adversary from predicting the selection decision [<a href="#ref-Dw01" title='"Recommendation for Block Cipher Modes of Operation - Methods and Techniques"'>Dw01</a>].

   Further security threats can occur when Intermediate Flow Selection
   Process parameters are configured or communicated to other entities.
   The protocol(s) for the configuration and reporting of Intermediate
   Flow Selection Process parameters are out of scope for this document.
   Nevertheless, a set of initial requirements for future configuration
   and reporting protocols are stated below:

   1.  Protection against disclosure of configuration information:
       Intermediate Flow Selection Process configuration information
       describes the Intermediate Flow Selection Process and its
       parameters.  This information can be useful to attackers.
       Attackers may craft packets that never fit the selection criteria
       in order to prevent Flows from being seen by the Intermediate
       Flow Selection Process.  They can also craft a lot of packets
       that fit the selection criteria and overload or bias subsequent
       processes.  Therefore, any transmission of configuration data
       (e.g., to configure a process or to report its actual status)
       should be protected by encryption.

   2.  Protection against modification of configuration information:
       Sending incorrect configuration information to the Intermediate
       Flow Selection Process can lead to a malfunction of the
       Intermediate Flow Selection Process.  Additionally, reporting
       incorrect configuration information from the Intermediate Flow
       Selection Process to other processes can lead to incorrect



<span class="grey">D'Antonio, et al.            Standards Track                   [Page 29]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-30" id="page-30" name="page-30"> </a>
<span class="grey"><a href="rfc7014.html">RFC 7014</a>                Flow Selection Techniques         September 2013</span>


       estimations at subsequent processes.  Therefore, any protocol
       that transmits configuration information should prevent an
       attacker from modifying configuration information.  Data
       integrity can be achieved by authenticating the data.

   3.  Protection against malicious nodes sending configuration
       information:
       The remote configuration of Intermediate Flow Selection Process
       techniques should be protected against access by unauthorized
       nodes.  This can be achieved by access control lists at the
       device that hosts the Intermediate Flow Selection Process (e.g.,
       IPFIX Exporter, IPFIX Mediator, or IPFIX Collector) and by source
       authentication.  The reporting of configuration data from an
       Intermediate Flow Selection Process has to be protected in the
       same way.  That means that protocols that report configuration
       data from the Intermediate Flow Selection Process to other
       processes also need to protect against unauthorized nodes
       reporting configuration information.

   The security threats that originate from communicating configuration
   information to and from Intermediate Flow Selection Processes cannot
   be assessed solely with the information given in this document.  A
   further and more detailed assessment of security threats is necessary
   when a specific protocol for the configuration or reporting
   configuration data is proposed.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/11.%20%20Acknowledgments"></a><a class="selflink" href="#section-11" name="section-11">11</a>.  Acknowledgments</span>

   We would like to thank the IPFIX group, especially Brian Trammell,
   Paul Aitken, and Benoit Claise, for fruitful discussions and for
   proofreading the document.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/12.%20%20References"></a><a class="selflink" href="#section-12" name="section-12">12</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/12.1.%20%20Normative%20References"></a><a class="selflink" href="#section-12.1" name="section-12.1">12.1</a>.  Normative References</span>

   [<a id="ref-RFC2119" name="ref-RFC2119">RFC2119</a>]     Bradner, S., "Key words for use in RFCs to Indicate
                 Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a id="ref-RFC5475" name="ref-RFC5475">RFC5475</a>]     Zseby, T., Molina, M., Duffield, N., Niccolini, S., and
                 F. Raspall, "Sampling and Filtering Techniques for IP
                 Packet Selection", <a href="rfc5475.html">RFC 5475</a>, March 2009.

   [<a id="ref-RFC5476" name="ref-RFC5476">RFC5476</a>]     Claise, B., Johnson, A., and J. Quittek, "Packet
                 Sampling (PSAMP) Protocol Specifications", <a href="rfc5476.html">RFC 5476</a>,
                 March 2009.





<span class="grey">D'Antonio, et al.            Standards Track                   [Page 30]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-31" id="page-31" name="page-31"> </a>
<span class="grey"><a href="rfc7014.html">RFC 7014</a>                Flow Selection Techniques         September 2013</span>


   [<a id="ref-RFC6615" name="ref-RFC6615">RFC6615</a>]     Dietz, T., Kobayashi, A., Claise, B., and G. Muenz,
                 "Definitions of Managed Objects for IP Flow Information
                 Export", <a href="rfc6615.html">RFC 6615</a>, June 2012.

   [<a id="ref-RFC7011" name="ref-RFC7011">RFC7011</a>]     Claise, B., Ed., Trammell, B., Ed., and P. Aitken,
                 "Specification of the IP Flow Information Export
                 (IPFIX) Protocol for the Exchange of Flow Information",
                 STD 77, <a href="rfc7011.html">RFC 7011</a>, September 2013.

   [<a id="ref-RFC7012" name="ref-RFC7012">RFC7012</a>]     Claise, B., Ed. and B. Trammell, Ed., "Information
                 Model for IP Flow Information Export (IPFIX)",
                 <a href="rfc7012.html">RFC 7012</a>, September 2013.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/12.2.%20%20Informative%20References"></a><a class="selflink" href="#section-12.2" name="section-12.2">12.2</a>.  Informative References</span>

   [<a id="ref-Bra75" name="ref-Bra75">Bra75</a>]       Brayer, K., "Evaluation of 32 Degree Polynomials in
                 Error Detection on the SATIN IV Autovon Error
                 Patterns", National Technical Information Service,
                 August 1975.

   [<a id="ref-CoHa08" name="ref-CoHa08">CoHa08</a>]      Cormode, G. and M. Hadjieleftheriou, "Finding Frequent
                 Items in Data Streams", Proceedings of the 34th
                 International Conference on Very Large DataBases
                 (VLDB), Auckland, New Zealand, Volume 1, Issue 2, pages
                 1530-1541, August 2008.

   [<a id="ref-DuLT01" name="ref-DuLT01">DuLT01</a>]      Duffield, N., Lund, C., and M. Thorup, "Charging from
                 Sampled Network Usage", ACM SIGCOMM Internet
                 Measurement Workshop (IMW) 2001, pages 245-256, San
                 Francisco, CA, USA, November 2001.

   [<a id="ref-Dw01" name="ref-Dw01">Dw01</a>]        Dworkin, M., "Recommendation for Block Cipher Modes of
                 Operation - Methods and Techniques", NIST Special
                 Publication 800-38A, December 2001.

   [<a id="ref-EsVa01" name="ref-EsVa01">EsVa01</a>]      Estan, C. and G,. Varghese, "New Directions in Traffic
                 Measurement and Accounting: Focusing on the Elephants,
                 Ignoring the Mice", ACM SIGCOMM Internet Measurement
                 Workshop (IMW) 2001, San Francisco, CA, USA,
                 November 2001.

   [<a id="ref-IANA-IPFIX" name="ref-IANA-IPFIX">IANA-IPFIX</a>]  IANA, "IP Flow Information Export (IPFIX) Entities
                 Registry", &lt;<a href="http://www.iana.org/assignments/ipfix/">http://www.iana.org/assignments/ipfix/</a>&gt;.

   [<a id="ref-KaPS03" name="ref-KaPS03">KaPS03</a>]      Karp, R., Papadimitriou, C., and S. Shenker, "A simple
                 algorithm for finding frequent elements in sets and
                 bags", ACM Transactions on Database Systems, Volume 28,
                 pages 51-55, March 2003.



<span class="grey">D'Antonio, et al.            Standards Track                   [Page 31]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-32" id="page-32" name="page-32"> </a>
<span class="grey"><a href="rfc7014.html">RFC 7014</a>                Flow Selection Techniques         September 2013</span>


   [<a id="ref-MSZC10" name="ref-MSZC10">MSZC10</a>]      Mai, J., Sridharan, A., Zang, H., and C. Chuah, "Fast
                 Filtered Sampling", Computer Networks Volume 54, Issue
                 11, pages 1885-1898, ISSN 1389-1286, August 2010.

   [<a id="ref-MaMo02" name="ref-MaMo02">MaMo02</a>]      Manku, G. and R. Motwani, "Approximate Frequency Counts
                 over Data Streams", Proceedings of the 28th
                 International Conference on Very Large DataBases
                 (VLDB), Hong Kong, China, pages 346-357, August 2002.

   [<a id="ref-RFC2804" name="ref-RFC2804">RFC2804</a>]     IAB and IESG, "IETF Policy on Wiretapping", <a href="rfc2804.html">RFC 2804</a>,
                 May 2000.

   [<a id="ref-RFC3917" name="ref-RFC3917">RFC3917</a>]     Quittek, J., Zseby, T., Claise, B., and S. Zander,
                 "Requirements for IP Flow Information Export (IPFIX)",
                 <a href="rfc3917.html">RFC 3917</a>, October 2004.

   [<a id="ref-RFC5226" name="ref-RFC5226">RFC5226</a>]     Narten, T. and H. Alvestrand, "Guidelines for Writing
                 an IANA Considerations Section in RFCs", <a href="https://tools.ietf.org/html/bcp26">BCP 26</a>,
                 <a href="rfc5226.html">RFC 5226</a>, May 2008.

   [<a id="ref-RFC5470" name="ref-RFC5470">RFC5470</a>]     Sadasivan, G., Brownlee, N., Claise, B., and J.
                 Quittek, "Architecture for IP Flow Information Export",
                 <a href="rfc5470.html">RFC 5470</a>, March 2009.

   [<a id="ref-RFC6183" name="ref-RFC6183">RFC6183</a>]     Kobayashi, A., Claise, B., Muenz, G., and K. Ishibashi,
                 "IP Flow Information Export (IPFIX) Mediation:
                 Framework", <a href="rfc6183.html">RFC 6183</a>, April 2011.
























<span class="grey">D'Antonio, et al.            Standards Track                   [Page 32]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-33" id="page-33" name="page-33"> </a>
<span class="grey"><a href="rfc7014.html">RFC 7014</a>                Flow Selection Techniques         September 2013</span>


Authors' Addresses

   Salvatore D'Antonio
   University of Napoli "Parthenope"
   Centro Direzionale di Napoli Is. C4
   Naples  80143
   Italy

   Phone: +39 081 5476766
   EMail: salvatore.dantonio@uniparthenope.it


   Tanja Zseby
   CAIDA/FhG FOKUS
   San Diego Supercomputer Center (SDSC)
   University of California, San Diego (UCSD)
   9500 Gilman Drive
   La Jolla, CA  92093-0505
   USA

   EMail: tanja.zseby@tuwien.ac.at


   Christian Henke
   Tektronix Communications Berlin
   Wohlrabedamm 32
   Berlin  13629
   Germany

   Phone: +49 17 2323 8717
   EMail: christian.henke@tektronix.com


   Lorenzo Peluso
   University of Napoli
   Via Claudio 21
   Napoli  80125
   Italy

   Phone: +39 081 7683821
   EMail: lorenzo.peluso@unina.it










D'Antonio, et al.            Standards Track                   [Page 33]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc7014 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:25 GMT --></html>