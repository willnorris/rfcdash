<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc6697 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:27 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="draft-hoeper-hokey-arch-design" name="DC.Relation.Replaces"/>
<meta content="urn:ietf:rfc:6697" name="DC.Identifier"/>
<meta content="July, 2012" name="DC.Date.Issued"/>
<meta content="Zorn, Glen" name="DC.Creator"/>
<meta content="Taylor, Tom" name="DC.Creator"/>
<meta content="Decugis, Sebastien" name="DC.Creator"/>
<meta content="Hoeper, Katrin" name="DC.Creator"/>
<meta content="Wu, Qin" name="DC.Creator"/>
<meta content="Nir, Yoav" name="DC.Creator"/>
<meta content='The Handover Keying (HOKEY) Working Group seeks to minimize handover
delay due to authentication when a peer moves from one point of
attachment to another. Work has progressed on two different approaches
to reduce handover delay: early authentication (so that authentication
does not need to be performed during handover), and reuse of
cryptographic material generated during an initial authentication to
save time during re-authentication. A basic assumption is that the
mobile host or "peer" is initially authenticated using the Extensible
Authentication Protocol (EAP), executed between the peer and an EAP
server as defined in RFC 3748.  This document defines the HOKEY
architecture. Specifically, it describes design objectives, the
functional environment within which handover keying operates, the
functions to be performed by the HOKEY architecture itself, and the
assignment of those functions to architectural components. It goes on
to illustrate the operation of the architecture within various
deployment scenarios that are described more fully in other documents
produced by the HOKEY Working Group. This document is not an Internet
Standards Track specification; it is published for informational
purposes.' name="DC.Description.Abstract"/>
<meta content="Handover Keying (HOKEY) Architecture Design" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 6697 - Handover Keying (HOKEY) Architecture Design</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgorange" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc6697.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc6697" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-hokey-arch-design" title="draft-ietf-hokey-arch-design">draft-ietf-hoke...</a>] [<a href="https://datatracker.ietf.org/doc/rfc6697" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc6697" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc6697" title="Side-by-side diff">Diff2</a>]         </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                           INFORMATIONAL</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Internet Engineering Task Force (IETF)                      G. Zorn, Ed.
Request for Comments: 6697                                   Network Zen
Category: Informational                                            Q. Wu
ISSN: 2070-1721                                                T. Taylor
                                                                  Huawei
                                                                  Y. Nir
                                                             Check Point
                                                               K. Hoeper
                                                Motorola Solutions, Inc.
                                                              S. Decugis
                                                           INSIDE Secure
                                                               July 2012


              <span class="h1">Handover Keying (HOKEY) Architecture Design</span>

Abstract

   The Handover Keying (HOKEY) Working Group seeks to minimize handover
   delay due to authentication when a peer moves from one point of
   attachment to another.  Work has progressed on two different
   approaches to reduce handover delay: early authentication (so that
   authentication does not need to be performed during handover), and
   reuse of cryptographic material generated during an initial
   authentication to save time during re-authentication.  A basic
   assumption is that the mobile host or "peer" is initially
   authenticated using the Extensible Authentication Protocol (EAP),
   executed between the peer and an EAP server as defined in <a href="rfc3748.html">RFC 3748</a>.

   This document defines the HOKEY architecture.  Specifically, it
   describes design objectives, the functional environment within which
   handover keying operates, the functions to be performed by the HOKEY
   architecture itself, and the assignment of those functions to
   architectural components.  It goes on to illustrate the operation of
   the architecture within various deployment scenarios that are
   described more fully in other documents produced by the HOKEY Working
   Group.














<span class="grey">Zorn, et al.                  Informational                     [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc6697.html">RFC 6697</a>                HOKEY Architecture Design              July 2012</span>


Status of This Memo

   This document is not an Internet Standards Track specification; it is
   published for informational purposes.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Not all documents
   approved by the IESG are a candidate for any level of Internet
   Standard; see <a href="rfc5741.html#section-2">Section 2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc6697">http://www.rfc-editor.org/info/rfc6697</a>.

Copyright Notice

   Copyright (c) 2012 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.





















<span class="grey">Zorn, et al.                  Informational                     [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc6697.html">RFC 6697</a>                HOKEY Architecture Design              July 2012</span>


Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-3">3</a>
   <a href="#section-2">2</a>. Terminology .....................................................<a href="#page-6">6</a>
   <a href="#section-3">3</a>. Design Goals ....................................................<a href="#page-6">6</a>
      <a href="#section-3.1">3.1</a>. Reducing Signaling Overhead ................................<a href="#page-7">7</a>
           <a href="#section-3.1.1">3.1.1</a>. Minimized Communications with Home Servers ..........<a href="#page-7">7</a>
           <a href="#section-3.1.2">3.1.2</a>. Minimized User Interaction for Authentication .......<a href="#page-7">7</a>
      <a href="#section-3.2">3.2</a>. Integrated Local Domain Name (LDN) Discovery ...............<a href="#page-7">7</a>
      <a href="#section-3.3">3.3</a>. Fault-Tolerant Re-Authentication ...........................<a href="#page-8">8</a>
      <a href="#section-3.4">3.4</a>. Improved Deployment Scalability ............................<a href="#page-8">8</a>
   <a href="#section-4">4</a>. Required Functionality ..........................................<a href="#page-8">8</a>
      <a href="#section-4.1">4.1</a>. Authentication Subsystem Functional Overview ...............<a href="#page-8">8</a>
      <a href="#section-4.2">4.2</a>. Pre-Authentication Function (Direct or Indirect) ...........<a href="#page-9">9</a>
      <a href="#section-4.3">4.3</a>. EAP Re-Authentication Function .............................<a href="#page-9">9</a>
      <a href="#section-4.4">4.4</a>. EAP Authentication Function ...............................<a href="#page-10">10</a>
      <a href="#section-4.5">4.5</a>. Authenticated Anticipatory Keying (AAK) Function ..........<a href="#page-10">10</a>
      <a href="#section-4.6">4.6</a>. Management of EAP-Based Handover Keys .....................<a href="#page-10">10</a>
   <a href="#section-5">5</a>. Components of the HOKEY Architecture ...........................<a href="#page-11">11</a>
      <a href="#section-5.1">5.1</a>. Functions of the Peer .....................................<a href="#page-12">12</a>
      <a href="#section-5.2">5.2</a>. Functions of the Serving Authenticator ....................<a href="#page-13">13</a>
      <a href="#section-5.3">5.3</a>. Functions of the Candidate Authenticator ..................<a href="#page-14">14</a>
      <a href="#section-5.4">5.4</a>. Functions of the EAP Server ...............................<a href="#page-15">15</a>
      <a href="#section-5.5">5.5</a>. Functions of the ER Server ................................<a href="#page-16">16</a>
   <a href="#section-6">6</a>. Usage Scenarios ................................................<a href="#page-16">16</a>
      <a href="#section-6.1">6.1</a>. Simple Re-Authentication ..................................<a href="#page-16">16</a>
      <a href="#section-6.2">6.2</a>. Intra-Domain Handover .....................................<a href="#page-17">17</a>
      <a href="#section-6.3">6.3</a>. Inter-Domain Handover .....................................<a href="#page-17">17</a>
      <a href="#section-6.4">6.4</a>. Inter-Technology Handover .................................<a href="#page-17">17</a>
   <a href="#section-7">7</a>. AAA Considerations .............................................<a href="#page-17">17</a>
      <a href="#section-7.1">7.1</a>. Authorization .............................................<a href="#page-17">17</a>
      <a href="#section-7.2">7.2</a>. Transport Aspect ..........................................<a href="#page-18">18</a>
   <a href="#section-8">8</a>. Security Considerations ........................................<a href="#page-18">18</a>
   <a href="#section-9">9</a>. Acknowledgments ................................................<a href="#page-18">18</a>
   <a href="#section-10">10</a>. References ....................................................<a href="#page-18">18</a>
      <a href="#section-10.1">10.1</a>. Normative References .....................................<a href="#page-18">18</a>
      <a href="#section-10.2">10.2</a>. Informative References ...................................<a href="#page-19">19</a>

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   The Extensible Authentication Protocol (EAP) [<a href="rfc3748.html" title='"Extensible Authentication Protocol (EAP)"'>RFC3748</a>] is an
   authentication framework that supports different types of
   authentication methods.  Originally designed for dial-up connections,
   EAP is now commonly used for authentication in a variety of access
   networks.






<span class="grey">Zorn, et al.                  Informational                     [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc6697.html">RFC 6697</a>                HOKEY Architecture Design              July 2012</span>


   When a host (or "peer", the term used from this point onward) changes
   its point of attachment to the network, it must be re-authenticated.
   If a full EAP authentication must be repeated, several message round
   trips between the peer and the home EAP server may be involved.  The
   resulting delay will result in degradation -- or, in the worst case,
   loss of any service session in progress -- if communication is
   suspended while re-authentication is carried out.  The delay is worse
   if the new point of attachment is in a visited network rather than
   the peer's home network because of the extra procedural steps
   involved as well as the probable increase in round-trip time.

   Clancy, et al. [<a href="rfc5169.html" title='"Handover Key Management and Re-Authentication Problem Statement"'>RFC5169</a>] describe this problem more fully and
   establish design goals for solutions to reduce re-authentication
   delay for transfers within a single administrative domain.  They also
   suggest a number of ways to achieve a solution:

   o  specification of a method-independent, efficient re-authentication
      protocol based upon EAP;

   o  reuse of keying material from the initial EAP authentication;

   o  deployment of re-authentication servers local to the peer to
      reduce round-trip delay; and

   o  specification of the additional protocol needed to allow the EAP
      server to pass authentication information to the local
      re-authentication servers.

   Salowey, et al. [<a href="rfc5295.html" title='"Specification for the Derivation of Root Keys from an Extended Master Session Key (EMSK)"'>RFC5295</a>] tackle the problem of the reuse of keying
   material by specifying how to derive a hierarchy of cryptographically
   independent purpose-specific keys from the results of the original
   EAP authentication, while Cao, et al. [<a href="rfc6696.html" title='"EAP Extensions for the EAP Re-authentication Protocol (ERP)"'>RFC6696</a>] specify a method-
   independent re-authentication protocol (the EAP Re-authentication
   Protocol (ERP)) applicable to two specific deployment scenarios:

   o  where the peer's home EAP server also performs re-authentication;
      and

   o  where a local re-authentication server exists but is co-located
      with an Authentication, Authorization, and Accounting (AAA) proxy
      within the domain.

   Other work provides further pieces of the solution or insight into
   the problem.  For the purpose of this memo, Hoeper, et al. [<a href="rfc5749.html" title='"Distribution of EAP-Based Keys for Handover and Re-Authentication"'>RFC5749</a>]
   provide an abstract mechanism for distribution of keying material
   from the EAP server to re-authentication servers.  Ohba,
   et al. [<a href="rfc5836.html" title='"Extensible Authentication Protocol (EAP) Early Authentication Problem Statement"'>RFC5836</a>] contrast the EAP Re-authentication (ER) strategy
   provided by ERP with an alternative strategy called "early



<span class="grey">Zorn, et al.                  Informational                     [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc6697.html">RFC 6697</a>                HOKEY Architecture Design              July 2012</span>


   authentication".  <a href="rfc5836.html">RFC 5836</a> defines EAP early authentication as the
   use of EAP by a mobile peer to establish authenticated keying
   material on a target attachment point prior to its arrival.  Hence,
   the goal of EAP early authentication is to complete all EAP-related
   communications, including AAA signaling, in preparation for the
   handover, before the mobile device actually moves.  Early
   authentication includes direct and indirect pre-authentication as
   well as Authenticated Anticipatory Keying (AAK).  All three early
   authentication mechanisms provide means to securely establish
   authenticated keying material on a Candidate Attachment Point (CAP)
   while still being connected to the Serving Attachment Point (SAP) but
   vary in their respective system assumptions and communication paths.
   In particular, direct pre-authentication assumes that clients are
   capable of discovering CAPs and all communications are routed through
   the SAP.  On the other hand, indirect pre-authentication assumes an
   existing relationship between the SAP and CAP, whereas the discovery
   and selection of CAPs is outside the scope of AAK.  Furthermore, both
   direct and indirect pre-authentication require a full EAP execution
   to occur before the handover of the peer takes place, while AAK
   techniques (like ERP [<a href="rfc6696.html" title='"EAP Extensions for the EAP Re-authentication Protocol (ERP)"'>RFC6696</a>]) use keys derived from the initial EAP
   authentication.

   Both EAP re-authentication and early authentication enable faster
   inter-authenticator handovers.  However, it is currently unclear how
   the necessary handover infrastructure can be deployed and integrated
   into existing EAP infrastructures.  In particular, previous work has
   not described how ER servers that act as endpoints in the
   re-authentication process should be integrated into local and home
   domain networks.  Furthermore, how EAP infrastructure can support the
   timely triggering of early authentications and aid with the selection
   of CAPs is currently unspecified.

   This document proposes a general HOKEY architecture and demonstrates
   how it can be adapted to different deployment scenarios.  To begin
   with, <a href="#section-3">Section 3</a> recalls the design objectives for the HOKEY
   architecture.  <a href="#section-4">Section 4</a> reviews the functions that must be supported
   within the architecture.  <a href="#section-5">Section 5</a> describes the components of the
   HOKEY architecture.  <a href="#section-6">Section 6</a> describes the different deployment
   scenarios that the HOKEY Working Group has addressed and the
   information flows that must occur within those scenarios, by
   reference to the documents summarized above where possible and
   otherwise within this document itself.  Finally, <a href="#section-7">Section 7</a> provides
   an analysis of how AAA protocols can be applied in the HOKEY
   architecture.







<span class="grey">Zorn, et al.                  Informational                     [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc6697.html">RFC 6697</a>                HOKEY Architecture Design              July 2012</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Terminology"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Terminology</span>

   This document reuses terms defined in <a href="#section-2">Section 2</a> of Ohba,
   et al. [<a href="rfc5836.html" title='"Extensible Authentication Protocol (EAP) Early Authentication Problem Statement"'>RFC5836</a>] and <a href="#section-2">Section 2</a> of Cao, et al. [<a href="rfc6696.html" title='"EAP Extensions for the EAP Re-authentication Protocol (ERP)"'>RFC6696</a>].  In
   addition, it defines the following:

   DS-rRK
      Domain-Specific re-authentication Root Key.

   pMSK
      pre-established Master Session Key.

   EAP Early Authentication
      The use of EAP by a mobile peer to establish authenticated keying
      material on a target attachment point prior to its arrival; see
      Ohba, et al. [<a href="rfc5836.html" title='"Extensible Authentication Protocol (EAP) Early Authentication Problem Statement"'>RFC5836</a>].

   ER Key Management
      An instantiation of the mechanism described in Hoeper,
      et al. [<a href="rfc5749.html" title='"Distribution of EAP-Based Keys for Handover and Re-Authentication"'>RFC5749</a>] for creating and delivering root keys from an EAP
      server to an ER server.

   EAP Re-authentication (ER)
      The use of keying material derived from an initial EAP
      authentication to enable single-round-trip re-authentication of a
      mobile peer.  For a detailed description of the keying material,
      see <a href="#section-4">Section 4</a> of Cao, et al. [<a href="rfc6696.html" title='"EAP Extensions for the EAP Re-authentication Protocol (ERP)"'>RFC6696</a>].

   ER Server
      A component of the HOKEY architecture that terminates the EAP
      re-authentication exchange with the peer.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Design%20Goals"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Design Goals</span>

   This section investigates the design goals for the HOKEY
   architecture.  These include reducing the signaling overhead for
   re-authentication and early authentication, integrating local domain
   name discovery, enabling fault-tolerant re-authentication, and
   improving deployment scalability.  These goals supplement those
   discussed in <a href="rfc5169.html#section-4">Section 4 of RFC 5169</a>.  Note that the identification and
   selection of CAPs is not a goal of the architecture, since those
   operations are generally specific to the lower layer in use.









<span class="grey">Zorn, et al.                  Informational                     [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc6697.html">RFC 6697</a>                HOKEY Architecture Design              July 2012</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.1.%20%20Reducing%20Signaling%20Overhead"></a><a class="selflink" href="#section-3.1" name="section-3.1">3.1</a>.  Reducing Signaling Overhead</span>

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.1.1.%20%20Minimized%20Communications%20with%20Home%20Servers"></a><a class="selflink" href="#section-3.1.1" name="section-3.1.1">3.1.1</a>.  Minimized Communications with Home Servers</span>

   ERP [<a href="rfc6696.html" title='"EAP Extensions for the EAP Re-authentication Protocol (ERP)"'>RFC6696</a>] requires only one round trip; however, this round trip
   may require communication between a peer and its home ER and/or home
   AAA server in explicit bootstrapping and communication between local
   servers and the home server in implicit bootstrapping even if the
   peer is currently attached to a visited (local) network.  As a
   result, even this one round trip may introduce long delays because
   the home ER and home AAA servers may be distant from the peer and the
   network to which it is attached.  To lower signaling overhead,
   communication with the home ER server and home AAA server should be
   minimized.  Ideally, a peer should only need to communicate with
   local servers and other local entities.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.1.2.%20%20Minimized%20User%20Interaction%20for%20Authentication"></a><a class="selflink" href="#section-3.1.2" name="section-3.1.2">3.1.2</a>.  Minimized User Interaction for Authentication</span>

   When the peer is initially attached to the network or moves between
   heterogeneous networks, full EAP authentication between the peer and
   EAP server occurs and user interaction may be needed, e.g., a dialog
   to prompt the user for credentials.  To reduce latency, user
   interaction for authentication at each handover should be minimized.
   Ideally, user involvement should take place only during initial
   authentication and subsequent re-authentication should occur
   transparently.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.2.%20%20Integrated%20Local%20Domain%20Name%20%28LDN%29%20Discovery"></a><a class="selflink" href="#section-3.2" name="section-3.2">3.2</a>.  Integrated Local Domain Name (LDN) Discovery</span>

   ERP bootstrapping must occur before (implicit) or during (explicit) a
   handover to transport the necessary keys to the local ER server
   involved.  Implicit bootstrapping is preferable because it does not
   require communication with the home ER server during handover, but it
   requires that the peer know the domain name of the ER server before
   the subsequent local ERP exchange happens in order to derive the
   necessary re-authentication keying material.  ERP [<a href="rfc6696.html" title='"EAP Extensions for the EAP Re-authentication Protocol (ERP)"'>RFC6696</a>] does not
   specify such a domain name discovery mechanism and suggests that the
   peer may learn the domain name through the EAP-Initiate/Re-auth-Start
   message or via lower-layer announcements.  However, domain name
   discovery happens after the implicit bootstrapping completes, which
   may introduce extra latency.  To allow more efficient handovers, a
   HOKEY architecture should support an efficient domain name discovery
   mechanism (for example, see Zorn, Wu &amp; Wang [<a href="rfc6440.html" title='"The EAP Re-authentication Protocol (ERP) Local Domain Name DHCPv6 Option"'>RFC6440</a>]) and allow its
   integration with ERP implicit bootstrapping.  Even in the case of
   explicit bootstrapping, LDN discovery should be optimized such that
   it does not require contacting the home AAA server, as is currently
   the case.




<span class="grey">Zorn, et al.                  Informational                     [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc6697.html">RFC 6697</a>                HOKEY Architecture Design              July 2012</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.3.%20%20Fault-Tolerant%20Re-Authentication"></a><a class="selflink" href="#section-3.3" name="section-3.3">3.3</a>.  Fault-Tolerant Re-Authentication</span>

   If all authentication services depend upon a remote server, a network
   partition can result in the denial of service to valid users.
   However, if for example an ER server exists in the local network,
   previously authenticated users can re-authenticate even though a link
   to the home or main authentication server doesn't exist.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.4.%20%20Improved%20Deployment%20Scalability"></a><a class="selflink" href="#section-3.4" name="section-3.4">3.4</a>.  Improved Deployment Scalability</span>

   To provide better deployment scalability, there should be no
   requirement for the co-location of entities providing handover keying
   services (e.g., ER servers) and AAA servers or proxies.  Separation
   of these entities may cause problems with routing but allows greater
   flexibility in deployment and implementation.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Required%20Functionality"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Required Functionality</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.1.%20%20Authentication%20Subsystem%20Functional%20Overview"></a><a class="selflink" href="#section-4.1" name="section-4.1">4.1</a>.  Authentication Subsystem Functional Overview</span>

   The operation of the authentication subsystem provided by HOKEY also
   depends on the availability of a number of discovery functions:

   o  discovery of CAPs by the peer, by the SAP, or by some other
      entity;

   o  discovery of the authentication services supported at a given CAP;

   o  discovery of the required server in the home domain when a CAP is
      not in the same domain as the SAP, or no local server is
      available;

   o  peer discovery of the LDN when EAP re-authentication is used with
      a local server.

   It is assumed that these functions are provided by the environment
   within which the authentication subsystem operates and are outside
   the scope of the authentication subsystem itself.  LDN discovery is a
   possible exception.

   The major functions comprising the authentication subsystem and their
   interdependencies are discussed in greater detail below.

   o  When AAA is invoked to authorize network access, it uses one of
      two services offered by the authentication subsystem: full EAP
      authentication or EAP re-authentication.  Note that although AAA
      may perform authentication directly in some cases, when EAP is




<span class="grey">Zorn, et al.                  Informational                     [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc6697.html">RFC 6697</a>                HOKEY Architecture Design              July 2012</span>


      utilized AAA functions only as a transport for EAP messages and
      the encryption keys (if any) resulting from successful EAP
      authentication.

   o  Pre-authentication triggers AAA network access authorization at
      each CAP, which in turn causes full EAP authentication to be
      invoked.

   o  EAP re-authentication invokes ER key management at the time of
      authentication to create and distribute keying material to ER
      servers.

   o  AAK relies on ER key management to establish keying material on
      ER/AAK servers but uses an extension to ER key management to
      derive and establish keying material on candidate authenticators.
      AAK uses an extension to EAP re-authentication to communicate with
      ER/AAK servers.

   EAP authentication, EAP re-authentication, and handover key
   distribution depend on the routing and secure transport service
   provided by AAA.  Discovery functions and the function of
   authentication and authorization of network entities (access points,
   ER servers) are not shown.  As stated above, these are external to
   the authentication subsystem.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.2.%20%20Pre-Authentication%20Function%20%28Direct%20or%20Indirect%29"></a><a class="selflink" href="#section-4.2" name="section-4.2">4.2</a>.  Pre-Authentication Function (Direct or Indirect)</span>

   The pre-authentication function is responsible for discovery of CAPs
   and completion of network access authentication and authorization at
   each CAP in advance of handover.  The operation of this function is
   described in general terms in Ohba, et al. [<a href="rfc5836.html" title='"Extensible Authentication Protocol (EAP) Early Authentication Problem Statement"'>RFC5836</a>].  No document is
   yet available to describe the implementation of pre-authentication in
   terms of specific protocols; pre-authentication support for the
   Protocol for Carrying Authentication for Network Access (PANA)
   [<a href="rfc5873.html" title='"Pre-Authentication Support for the Protocol for Carrying Authentication for Network Access (PANA)"'>RFC5873</a>] could be part of the solution.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.3.%20%20EAP%20Re-Authentication%20Function"></a><a class="selflink" href="#section-4.3" name="section-4.3">4.3</a>.  EAP Re-Authentication Function</span>

   The EAP re-authentication function is responsible for authenticating
   the peer at a specific access point using keying material derived
   from a prior full EAP authentication.  <a href="rfc5169.html">RFC 5169</a> [<a href="rfc5169.html" title='"Handover Key Management and Re-Authentication Problem Statement"'>RFC5169</a>] provides
   the design objectives for an implementation of this function.  ERP
   [<a href="rfc6696.html" title='"EAP Extensions for the EAP Re-authentication Protocol (ERP)"'>RFC6696</a>] describes a protocol to implement EAP re-authentication.








<span class="grey">Zorn, et al.                  Informational                     [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc6697.html">RFC 6697</a>                HOKEY Architecture Design              July 2012</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.4.%20%20EAP%20Authentication%20Function"></a><a class="selflink" href="#section-4.4" name="section-4.4">4.4</a>.  EAP Authentication Function</span>

   The EAP authentication function is responsible for authenticating the
   peer at a specific access point using a full EAP exchange.  Aboba,
   et al. [<a href="rfc3748.html" title='"Extensible Authentication Protocol (EAP)"'>RFC3748</a>] define the associated protocol, while Ohba,
   et al. [<a href="rfc5836.html" title='"Extensible Authentication Protocol (EAP) Early Authentication Problem Statement"'>RFC5836</a>] describe the use of EAP as part of
   pre-authentication.  Note that the HOKEY Working Group has not
   specified the non-AAA protocol required to transport EAP frames over
   IP that is shown in Figures 3 and 5 of Ohba, et al. [<a href="rfc5836.html" title='"Extensible Authentication Protocol (EAP) Early Authentication Problem Statement"'>RFC5836</a>],
   although PANA [<a href="rfc5873.html" title='"Pre-Authentication Support for the Protocol for Carrying Authentication for Network Access (PANA)"'>RFC5873</a>] is a candidate.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.5.%20%20Authenticated%20Anticipatory%20Keying%20%28AAK%29%20Function"></a><a class="selflink" href="#section-4.5" name="section-4.5">4.5</a>.  Authenticated Anticipatory Keying (AAK) Function</span>

   The AAK function is responsible for pre-placing keying material
   derived from an initial full EAP authentication on CAPs.  The
   operation is carried out in two steps: ER key management (with
   trigger not currently specified) places root keys derived from
   initial EAP authentication onto an ER/AAK server associated with the
   peer.  When requested by the peer, the ER/AAK server derives and
   pushes predefined master session keys to one or more CAPs.  The
   operation of the AAK function is described in very general terms in
   Ohba, et al. [<a href="rfc5836.html" title='"Extensible Authentication Protocol (EAP) Early Authentication Problem Statement"'>RFC5836</a>].  A protocol specification exists (see Cao,
   et al. [<a href="rfc6630.html" title='"EAP Re-authentication Protocol Extensions for Authenticated Anticipatory Keying (ERP/AAK)"'>RFC6630</a>]).

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.6.%20%20Management%20of%20EAP-Based%20Handover%20Keys"></a><a class="selflink" href="#section-4.6" name="section-4.6">4.6</a>.  Management of EAP-Based Handover Keys</span>

   Handover key management consists of EAP method-independent key
   derivation and distribution and comprises the following specific
   functions:

   o  handover key derivation

   o  handover key distribution

   The derivation of handover keys is specified in Salowey,
   et al. [<a href="rfc5295.html" title='"Specification for the Derivation of Root Keys from an Extended Master Session Key (EMSK)"'>RFC5295</a>], and AAA-based key distribution is specified in
   Hoeper, Nakhjiri &amp; Ohba [<a href="rfc5749.html" title='"Distribution of EAP-Based Keys for Handover and Re-Authentication"'>RFC5749</a>].














<span class="grey">Zorn, et al.                  Informational                    [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc6697.html">RFC 6697</a>                HOKEY Architecture Design              July 2012</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Components%20of%20the%20HOKEY%20Architecture"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Components of the HOKEY Architecture</span>

   This section describes the components of the HOKEY architecture in
   terms of the functions they perform.  The components cooperate as
   described in this section to carry out the functions described in the
   previous section.  <a href="#section-6">Section 6</a> describes the different deployment
   scenarios that are possible using these functions.

   The components of the HOKEY architecture are as follows:

   o  the peer;

   o  the authenticator, which is a part of the SAP and CAPs;

   o  the EAP server;

   o  the ER server; and

   o  the ER/AAK server [<a href="rfc6630.html" title='"EAP Re-authentication Protocol Extensions for Authenticated Anticipatory Keying (ERP/AAK)"'>RFC6630</a>], either in the home domain or local to
      the authenticator.































<span class="grey">Zorn, et al.                  Informational                    [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc6697.html">RFC 6697</a>                HOKEY Architecture Design              July 2012</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.1.%20%20Functions%20of%20the%20Peer"></a><a class="selflink" href="#section-5.1" name="section-5.1">5.1</a>.  Functions of the Peer</span>

   The peer participates in the functions described in <a href="#section-4">Section 4</a>, as
   shown in Table 1.

   +--------------------+----------------------------------------------+
   | Function           | Peer Role                                    |
   +--------------------+----------------------------------------------+
   | EAP authentication | Determines that full EAP authentication is   |
   |                    | needed based on context (e.g., initial       |
   |                    | authentication), prompting from the          |
   |                    | authenticator, or discovery that only EAP    |
   |                    | authentication is supported.  Participates   |
   |                    | in the EAP exchange with the EAP server.     |
   | -                  | -                                            |
   | Direct             | Discovers CAPs.  Initiates                   |
   | pre-authentication | pre-authentication with each, followed by    |
   |                    | EAP authentication as above, but using IP    |
   |                    | rather than L2 transport for the EAP frames. |
   | -                  | -                                            |
   | Indirect           | Enters into a full EAP exchange when         |
   | pre-authentication | triggered, using either L2 or L3 transport   |
   |                    | for the frames.                              |
   | -                  | -                                            |
   | EAP                | Determines that EAP re-authentication is     |
   | re-authentication  | possible based on discovery or authenticator |
   |                    | prompting.  Participates in ERP exchange     |
   |                    | with the ER server.                          |
   | -                  | -                                            |
   | AAK                | Determines that AAK is possible based on     |
   |                    | discovery or serving authenticator           |
   |                    | prompting.  Discovers CAPs.  Participates in |
   |                    | ERP/AAK exchange, requesting distribution of |
   |                    | keying material to the CAPs.                 |
   | -                  | -                                            |
   | ER key management  | No role.                                     |
   +--------------------+----------------------------------------------+

                      Table 1: Functions of the Peer












<span class="grey">Zorn, et al.                  Informational                    [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc6697.html">RFC 6697</a>                HOKEY Architecture Design              July 2012</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.2.%20%20Functions%20of%20the%20Serving%20Authenticator"></a><a class="selflink" href="#section-5.2" name="section-5.2">5.2</a>.  Functions of the Serving Authenticator</span>

   The serving authenticator participates in the functions described in
   <a href="#section-4">Section 4</a>, as shown in Table 2.

   +--------------------+----------------------------------------------+
   | Function           | Serving Authenticator Role                   |
   +--------------------+----------------------------------------------+
   | EAP authentication | No role.                                     |
   | -                  | -                                            |
   | Direct             | No role.                                     |
   | pre-authentication |                                              |
   | -                  | -                                            |
   | Indirect           | Discovers CAPs.  Initiates an EAP exchange   |
   | pre-authentication | between the peer and the EAP server through  |
   |                    | each candidate authenticator.  Mediates      |
   |                    | between L2 transport of EAP frames on the    |
   |                    | peer side and a non-AAA protocol over IP     |
   |                    | toward the CAP.                              |
   | -                  | -                                            |
   | EAP                | No role.                                     |
   | re-authentication  |                                              |
   | -                  | -                                            |
   | AAK                | Mediates between L2 transport of AAK frames  |
   |                    | on the peer side and AAA transport toward    |
   |                    | the ER/AAK server.                           |
   | -                  | -                                            |
   | ER key management  | No role.                                     |
   +--------------------+----------------------------------------------+

              Table 2: Functions of the Serving Authenticator




















<span class="grey">Zorn, et al.                  Informational                    [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc6697.html">RFC 6697</a>                HOKEY Architecture Design              July 2012</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.3.%20%20Functions%20of%20the%20Candidate%20Authenticator"></a><a class="selflink" href="#section-5.3" name="section-5.3">5.3</a>.  Functions of the Candidate Authenticator</span>

   The candidate authenticator participates in the functions described
   in <a href="#section-4">Section 4</a>, as shown in Table 3.

   +--------------------+----------------------------------------------+
   | Function           | Candidate Authenticator Role                 |
   +--------------------+----------------------------------------------+
   | EAP authentication | Invokes AAA network access authentication    |
   |                    | and authorization upon handover/initial      |
   |                    | attachment.  Mediates between L2 transport   |
   |                    | of EAP frames on the peer link and AAA       |
   |                    | transport toward the EAP server.             |
   | -                  | -                                            |
   | Direct             | Invokes AAA network access authentication    |
   | pre-authentication | and authorization when the peer initiates    |
   |                    | authentication.  Mediates between non-AAA L3 |
   |                    | transport of EAP frames on the peer side and |
   |                    | AAA transport toward the EAP server.         |
   | -                  | -                                            |
   | Indirect           | Same as direct pre-authentication, except    |
   | pre-authentication | that it communicates with the serving        |
   |                    | authenticator rather than the peer.          |
   | -                  | -                                            |
   | EAP                | Invokes AAA network access authentication    |
   | re-authentication  | and authorization upon handover.  Discovers  |
   |                    | or is configured with the address of the ER  |
   |                    | server.  Mediates between L2 transport of    |
   |                    | ERP frames on the peer side and AAA          |
   |                    | transport toward the ER server.              |
   | -                  | -                                            |
   | AAK                | Receives and saves the pMSK.                 |
   | -                  | -                                            |
   | ER key management  | No role.                                     |
   +--------------------+----------------------------------------------+

             Table 3: Functions of the Candidate Authenticator














<span class="grey">Zorn, et al.                  Informational                    [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc6697.html">RFC 6697</a>                HOKEY Architecture Design              July 2012</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.4.%20%20Functions%20of%20the%20EAP%20Server"></a><a class="selflink" href="#section-5.4" name="section-5.4">5.4</a>.  Functions of the EAP Server</span>

   The EAP server participates in the functions described in <a href="#section-4">Section 4</a>,
   as shown in Table 4.

   +--------------------+----------------------------------------------+
   | Function           | EAP Server Role                              |
   +--------------------+----------------------------------------------+
   | EAP authentication | Terminates EAP signaling between it and the  |
   |                    | peer via the candidate authenticator.        |
   |                    | Determines whether network access            |
   |                    | authentication succeeds or fails.  Provides  |
   |                    | the MSK to the authenticator (via AAA).      |
   | -                  | -                                            |
   | Direct             | Same as for EAP authentication.              |
   | pre-authentication |                                              |
   | -                  | -                                            |
   | Indirect           | Same as for EAP authentication.              |
   | pre-authentication |                                              |
   | -                  | -                                            |
   | EAP                | Provides an rRK or DS-rRK to the ER server   |
   | re-authentication  | (via AAA).                                   |
   | -                  | -                                            |
   | AAK                | Same as for EAP re-authentication.           |
   | -                  | -                                            |
   | ER key management  | Creates an rRK or DS-rRK and distributes it  |
   |                    | to the ER server requesting the information. |
   +--------------------+----------------------------------------------+

                   Table 4: Functions of the EAP Server





















<span class="grey">Zorn, et al.                  Informational                    [Page 15]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc6697.html">RFC 6697</a>                HOKEY Architecture Design              July 2012</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.5.%20%20Functions%20of%20the%20ER%20Server"></a><a class="selflink" href="#section-5.5" name="section-5.5">5.5</a>.  Functions of the ER Server</span>

   The ER server participates in the functions described in <a href="#section-4">Section 4</a>,
   as shown in Table 5.

   +--------------------+----------------------------------------------+
   | Function           | ER Server Role                               |
   +--------------------+----------------------------------------------+
   | EAP authentication | No role.                                     |
   | -                  | -                                            |
   | Direct             | No role.                                     |
   | pre-authentication |                                              |
   | -                  | -                                            |
   | Indirect           | No role.                                     |
   | pre-authentication |                                              |
   | -                  | -                                            |
   | EAP                | Acquires an rRK or DS-rRK as applicable when |
   | re-authentication  | necessary.  Terminates ERP signaling between |
   |                    | it and the peer via the candidate            |
   |                    | authenticator.  Determines whether network   |
   |                    | access authentication succeeds or fails.     |
   |                    | Provides an MSK to the authenticator.        |
   | -                  | -                                            |
   | AAK                | Acquires an rRK or DS-rRK as applicable when |
   |                    | necessary.  Derives pMSKs and passes them to |
   |                    | the CAPs.                                    |
   | -                  | -                                            |
   | ER key management  | Receives and saves an rRK or DS-rRK as       |
   |                    | applicable.                                  |
   +--------------------+----------------------------------------------+

                    Table 5: Functions of the ER Server

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20Usage%20Scenarios"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  Usage Scenarios</span>

   Depending upon whether a change in a domain or access technology is
   involved, we have the following usage scenarios.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.1.%20%20Simple%20Re-Authentication"></a><a class="selflink" href="#section-6.1" name="section-6.1">6.1</a>.  Simple Re-Authentication</span>

   The peer remains stationary and re-authenticates to the original
   access point.  Note that in this case, the SAP takes the role of the
   CAP in the discussion above.








<span class="grey">Zorn, et al.                  Informational                    [Page 16]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc6697.html">RFC 6697</a>                HOKEY Architecture Design              July 2012</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.2.%20%20Intra-Domain%20Handover"></a><a class="selflink" href="#section-6.2" name="section-6.2">6.2</a>.  Intra-Domain Handover</span>

   The peer moves between two authenticators in the same domain.  In
   this scenario, the peer communicates with the ER server via the ER
   authenticator within the same network.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.3.%20%20Inter-Domain%20Handover"></a><a class="selflink" href="#section-6.3" name="section-6.3">6.3</a>.  Inter-Domain Handover</span>

   The peer moves between two different domains.  In this scenario, the
   peer communicates with more than one ER server via one or two
   different ER authenticators.  One ER server is located in the current
   network as the peer, and one is located in the previous network from
   which the peer moves.  Another ER server is located in the home
   network to which the peer belongs.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.4.%20%20Inter-Technology%20Handover"></a><a class="selflink" href="#section-6.4" name="section-6.4">6.4</a>.  Inter-Technology Handover</span>

   The peer moves between two heterogeneous networks.  In this scenario,
   the peer needs to support at least two access technologies.  The
   coverage of two access technologies usually is overlapped during
   handover.  In this case, only authentication corresponding to
   intra-domain handover is required; i.e., the peer can communicate
   with the same local ER server to complete authentication and obtain
   keying material corresponding to the peer.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20AAA%20Considerations"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  AAA Considerations</span>

   This section provides an analysis of how the AAA protocol can be
   applied in the HOKEY architecture in accordance with <a href="#section-4.1">Section 4.1</a>
   ("Authentication Subsystem Functional Overview").

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.1.%20%20Authorization"></a><a class="selflink" href="#section-7.1" name="section-7.1">7.1</a>.  Authorization</span>

   Authorization is a major issue in deployments.  Wherever the peer
   moves around, the home AAA server provides authorization for the peer
   during its handover.  However, it is unnecessary to couple
   authorization with authentication at every handover, since
   authorization is only needed when the peer is initially attached to
   the network or moves between two different AAA domains.  The EAP key
   management document [<a href="rfc5247.html" title='"Extensible Authentication Protocol (EAP) Key Management Framework"'>RFC5247</a>] discusses several vulnerabilities that
   are common to handover mechanisms.  One important issue arises from
   the way that the authorization decisions might be handled at the AAA
   server during network access authentication.  For example, if AAA
   proxies are involved, they may also influence authorization
   decisions.  Furthermore, the reasons for choosing a particular
   decision are not communicated to the AAA clients.  In fact, the AAA
   client only knows the final authorization result.  Another issue
   relates to session management.  In some circumstances, when the peer



<span class="grey">Zorn, et al.                  Informational                    [Page 17]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc6697.html">RFC 6697</a>                HOKEY Architecture Design              July 2012</span>


   moves from one authenticator to another, the peer may be
   authenticated by the different authenticator during a period of time,
   and the authenticator to which the peer is currently attached needs
   to create a new AAA user session; however, the AAA server should not
   view these handoffs as different sessions.  Otherwise, this may
   affect user experience and also cause accounting or logging issues.
   For example, session ID creation, in most cases, is done by each
   authenticator to which the peer attaches.  In this sense, the new
   authenticator acting as AAA client needs to create a new AAA user
   session from scratch, which forces its corresponding AAA server to
   terminate the existing user session with the previous authenticator
   and set up a new user session with the new authenticator.  This may
   complicate the setup and maintenance of the AAA user session.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.2.%20%20Transport%20Aspect"></a><a class="selflink" href="#section-7.2" name="section-7.2">7.2</a>.  Transport Aspect</span>

   The existing AAA protocols can be used to carry EAP and ERP messages
   between the AAA server and AAA clients.  AAA transport of ERP
   messages is specified in Hoeper, Nakhjiri &amp; Ohba [<a href="rfc5749.html" title='"Distribution of EAP-Based Keys for Handover and Re-Authentication"'>RFC5749</a>] and
   Bournelle, et al. [<a href="#ref-DIAMETER-ERP">DIAMETER-ERP</a>].  AAA transport of EAP messages is
   specified in [<a href="rfc4072.html" title='"Diameter Extensible Authentication Protocol (EAP) Application"'>RFC4072</a>].  Key transport also can be performed through
   a AAA protocol.  Zorn, Wu &amp; Cakulev [<a href="#ref-DIAMETER-AVP">DIAMETER-AVP</a>] specify a set of
   Attribute-Value Pairs (AVPs) providing native Diameter support of
   cryptographic key delivery.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20Security%20Considerations"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  Security Considerations</span>

   This document does not introduce any new security vulnerabilities.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/9.%20%20Acknowledgments"></a><a class="selflink" href="#section-9" name="section-9">9</a>.  Acknowledgments</span>

   The authors would like to thank Mark Jones, Zhen Cao, Semyon
   Mizikovsky, Stephen Farrell, Ondrej Sury, Richard Barnes, Jari Arkko,
   and Lionel Morand for their reviews and comments.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/10.%20%20References"></a><a class="selflink" href="#section-10" name="section-10">10</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/10.1.%20%20Normative%20References"></a><a class="selflink" href="#section-10.1" name="section-10.1">10.1</a>.  Normative References</span>

   [<a id="ref-RFC3748" name="ref-RFC3748">RFC3748</a>]  Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H.
              Levkowetz, Ed., "Extensible Authentication Protocol
              (EAP)", <a href="rfc3748.html">RFC 3748</a>, June 2004.

   [<a id="ref-RFC5169" name="ref-RFC5169">RFC5169</a>]  Clancy, T., Nakhjiri, M., Narayanan, V., and L. Dondeti,
              "Handover Key Management and Re-Authentication Problem
              Statement", <a href="rfc5169.html">RFC 5169</a>, March 2008.





<span class="grey">Zorn, et al.                  Informational                    [Page 18]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-19" id="page-19" name="page-19"> </a>
<span class="grey"><a href="rfc6697.html">RFC 6697</a>                HOKEY Architecture Design              July 2012</span>


   [<a id="ref-RFC5836" name="ref-RFC5836">RFC5836</a>]  Ohba, Y., Ed., Wu, Q., Ed., and G. Zorn, Ed., "Extensible
              Authentication Protocol (EAP) Early Authentication Problem
              Statement", <a href="rfc5836.html">RFC 5836</a>, April 2010.

   [<a id="ref-RFC6696" name="ref-RFC6696">RFC6696</a>]  Cao, Z., He, B., Shi, Y., Wu, Q., Ed., and G. Zorn, Ed.,
              "EAP Extensions for the EAP Re-authentication Protocol
              (ERP)", <a href="rfc6696.html">RFC 6696</a>, July 2012.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/10.2.%20%20Informative%20References"></a><a class="selflink" href="#section-10.2" name="section-10.2">10.2</a>.  Informative References</span>

   [<a id="ref-DIAMETER-AVP" name="ref-DIAMETER-AVP">DIAMETER-AVP</a>]
              Zorn, G., Wu, Q., and V. Cakulev, "Diameter Attribute-
              Value Pairs for Cryptographic Key Transport", Work
              in Progress, August 2011.

   [<a id="ref-DIAMETER-ERP" name="ref-DIAMETER-ERP">DIAMETER-ERP</a>]
              Bournelle, J., Morand, L., Decugis, S., Wu, Q., and G.
              Zorn, "Diameter Support for the EAP Re-authentication
              Protocol (ERP)", Work in Progress, June 2012.

   [<a id="ref-RFC4072" name="ref-RFC4072">RFC4072</a>]  Eronen, P., Ed., Hiller, T., and G. Zorn, "Diameter
              Extensible Authentication Protocol (EAP) Application",
              <a href="rfc4072.html">RFC 4072</a>, August 2005.

   [<a id="ref-RFC5247" name="ref-RFC5247">RFC5247</a>]  Aboba, B., Simon, D., and P. Eronen, "Extensible
              Authentication Protocol (EAP) Key Management Framework",
              <a href="rfc5247.html">RFC 5247</a>, August 2008.

   [<a id="ref-RFC5295" name="ref-RFC5295">RFC5295</a>]  Salowey, J., Dondeti, L., Narayanan, V., and M. Nakhjiri,
              "Specification for the Derivation of Root Keys from an
              Extended Master Session Key (EMSK)", <a href="rfc5295.html">RFC 5295</a>,
              August 2008.

   [<a id="ref-RFC5749" name="ref-RFC5749">RFC5749</a>]  Hoeper, K., Ed., Nakhjiri, M., and Y. Ohba, Ed.,
              "Distribution of EAP-Based Keys for Handover and
              Re-Authentication", <a href="rfc5749.html">RFC 5749</a>, March 2010.

   [<a id="ref-RFC5873" name="ref-RFC5873">RFC5873</a>]  Ohba, Y. and A. Yegin, "Pre-Authentication Support for the
              Protocol for Carrying Authentication for Network Access
              (PANA)", <a href="rfc5873.html">RFC 5873</a>, May 2010.

   [<a id="ref-RFC6440" name="ref-RFC6440">RFC6440</a>]  Zorn, G., Wu, Q., and Y. Wang, "The EAP Re-authentication
              Protocol (ERP) Local Domain Name DHCPv6 Option", <a href="rfc6440.html">RFC 6440</a>,
              December 2011.

   [<a id="ref-RFC6630" name="ref-RFC6630">RFC6630</a>]  Cao, Z., Deng, H., Wu, Q., and G. Zorn, Ed., "EAP
              Re-authentication Protocol Extensions for Authenticated
              Anticipatory Keying (ERP/AAK)", <a href="rfc6630.html">RFC 6630</a>, June 2012.



<span class="grey">Zorn, et al.                  Informational                    [Page 19]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-20" id="page-20" name="page-20"> </a>
<span class="grey"><a href="rfc6697.html">RFC 6697</a>                HOKEY Architecture Design              July 2012</span>


Authors' Addresses

   Glen Zorn (editor)
   Network Zen
   227/358 Thanon Sanphawut
   Bang Na, Bangkok  10260
   Thailand
   Phone: +66 (0) 909 201060
   EMail: glenzorn@gmail.com

   Qin Wu
   Huawei Technologies Co., Ltd.
   101 Software Avenue, Yuhua District
   Nanjing, JiangSu  210012
   China
   Phone: +86-25-84565892
   EMail: bill.wu@huawei.com

   Tom Taylor
   Huawei Technologies Co., Ltd.
   Ottawa, Ontario
   Canada
   EMail: tom.taylor.stds@gmail.com

   Yoav Nir
   Check Point
   5 Hasolelim St.
   Tel Aviv  67897
   Israel
   EMail: ynir@checkpoint.com

   Katrin Hoeper
   Motorola Solutions, Inc.
   1301 E. Algonquin Road
   Schaumburg, IL  60196
   USA
   EMail: khoeper@motorolasolutions.com&gt;

   Sebastien Decugis
   INSIDE Secure
   41 Parc Club du Golf
   Aix-en-Provence  13856
   France
   Phone: +33 (0)4 42 39 63 00
   EMail: sdecugis@freediameter.net






Zorn, et al.                  Informational                    [Page 20]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc6697 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:27 GMT --></html>