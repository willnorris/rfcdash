<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc6080 by HTTrack Website Copier/3.x [XR&CO'2013], Sat, 07 Jun 2014 20:18:41 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.107" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="draft-petrie-sipping-config-framework" name="DC.Relation.Replaces"/>
<meta content="urn:ietf:rfc:6080" name="DC.Identifier"/>
<meta content="March, 2011" name="DC.Date.Issued"/>
<meta content="Sumanth Channabasappa &lt;sumanth@cablelabs.com&gt;" name="DC.Creator"/>
<meta content="This document specifies a framework to enable configuration of Session\nInitiation Protocol (SIP) user agents (UAs) in SIP deployments. The\nframework provides a means to deliver profile data that user agents\nneed to be functional, automatically and with minimal or no User and\nAdministrative intervention. The framework describes how SIP user\nagents can discover sources, request profiles, and receive\nnotifications related to profile modifications. As part of this\nframework, a new SIP event package is defined for notification of\nprofile changes. The framework provides minimal data retrieval options\nto ensure interoperability. The framework does not include\nspecification of the profile data within its scope. [STANDARDS-TRACK]" name="DC.Description.Abstract"/>
<meta content="A Framework for Session Initiation Protocol User Agent Profile Delivery" name="DC.Title"/>

    <link href="http://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="http://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 6080 - A Framework for Session Initiation Protocol User Agent Profile Delivery</title>
    
    
    <style type="text/css">
	body {
	    margin: 0px 8px;
            font-size: 1em;
	}
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgblue" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="http://tools.ietf.org/rfc/rfc6080.txt" title="Plaintext version of this document">txt</a>|<a href="http://tools.ietf.org/pdf/rfc6080" title="PDF version of this document">pdf</a>] [<a href="http://tools.ietf.org/html/draft-ietf-sipping-config-framework" title="draft-ietf-sipping-config-framework">draft-ietf-sippin...</a>] [<a href="http://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc6080" title="Inline diff (wdiff)">Diff1</a>] [<a href="http://tools.ietf.org/rfcdiff?url2=rfc6080" title="Side-by-side diff">Diff2</a>] [<a href="https://datatracker.ietf.org/ipr/search/?option=rfc_search&amp;rfc_search=6080" title="IPR disclosures related to this document">IPR</a>]           </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                       PROPOSED STANDARD</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Internet Engineering Task Force (IETF)                         D. Petrie
Request for Comments: 6080                                     SIPez LLC
Category: Standards Track                          S. Channabasappa, Ed.
ISSN: 2070-1721                                                CableLabs
                                                              March 2011


<span class="h1"><a class="selflink" href="#appendix-A" name="appendix-A">A</a> Framework for Session Initiation Protocol User Agent Profile Delivery</span>

Abstract

   This document specifies a framework to enable configuration of
   Session Initiation Protocol (SIP) user agents (UAs) in SIP
   deployments.  The framework provides a means to deliver profile data
   that user agents need to be functional, automatically and with
   minimal or no User and Administrative intervention.  The framework
   describes how SIP user agents can discover sources, request profiles,
   and receive notifications related to profile modifications.  As part
   of this framework, a new SIP event package is defined for
   notification of profile changes.  The framework provides minimal data
   retrieval options to ensure interoperability.  The framework does not
   include specification of the profile data within its scope.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="rfc5741.html#section-2">SectionÂ 2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc6080">http://www.rfc-editor.org/info/rfc6080</a>.















<span class="grey">Petrie &amp; Channabasappa       Standards Track                    [Page 1]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc6080.html">RFC 6080</a>               SIP Configuration Framework            March 2011</span>


Copyright Notice

   Copyright (c) 2011 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="http://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in <a href="#section-4">Section 4</a>.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

   This document may contain material from IETF Documents or IETF
   Contributions published or made publicly available before November
   10, 2008.  The person(s) controlling the copyright in some of this
   material may not have granted the IETF Trust the right to allow
   modifications of such material outside the IETF Standards Process.
   Without obtaining an adequate license from the person(s) controlling
   the copyright in such materials, this document may not be modified
   outside the IETF Standards Process, and derivative works of it may
   not be created outside the IETF Standards Process, except to format
   it for publication as an RFC or to translate it into languages other
   than English.

























<span class="grey">Petrie &amp; Channabasappa       Standards Track                    [Page 2]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc6080.html">RFC 6080</a>               SIP Configuration Framework            March 2011</span>


Table of Contents

   <a href="#section-1">1</a>.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-4">4</a>
   <a href="#section-2">2</a>.  Terminology  . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-4">4</a>
   <a href="#section-3">3</a>.  Overview . . . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-5">5</a>
     <a href="#section-3.1">3.1</a>.  Reference Model  . . . . . . . . . . . . . . . . . . . . .  <a href="#page-6">6</a>
     <a href="#section-3.2">3.2</a>.  Motivation . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-7">7</a>
     <a href="#section-3.3">3.3</a>.  Profile Types  . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-9">9</a>
     <a href="#section-3.4">3.4</a>.  Profile Delivery Stages  . . . . . . . . . . . . . . . . .  <a href="#page-9">9</a>
     <a href="#section-3.5">3.5</a>.  Supported Device Types . . . . . . . . . . . . . . . . . . <a href="#page-10">10</a>
   <a href="#section-4">4</a>.  Use Cases  . . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-10">10</a>
     <a href="#section-4.1">4.1</a>.  Simple Deployment Scenario . . . . . . . . . . . . . . . . <a href="#page-10">10</a>
     4.2.  Devices Supporting Multiple Users from Different
           Service Providers  . . . . . . . . . . . . . . . . . . . . <a href="#page-12">12</a>
   <a href="#section-5">5</a>.  Profile Delivery Framework . . . . . . . . . . . . . . . . . . <a href="#page-14">14</a>
     <a href="#section-5.1">5.1</a>.  Profile Delivery Stages  . . . . . . . . . . . . . . . . . <a href="#page-14">14</a>
     <a href="#section-5.2">5.2</a>.  Securing Profile Delivery  . . . . . . . . . . . . . . . . <a href="#page-22">22</a>
     <a href="#section-5.3">5.3</a>.  Additional Considerations  . . . . . . . . . . . . . . . . <a href="#page-24">24</a>
     <a href="#section-5.4">5.4</a>.  Support for NATs . . . . . . . . . . . . . . . . . . . . . <a href="#page-33">33</a>
   <a href="#section-6">6</a>.  Event Package Definition . . . . . . . . . . . . . . . . . . . <a href="#page-33">33</a>
     <a href="#section-6.1">6.1</a>.  Event Package Name . . . . . . . . . . . . . . . . . . . . <a href="#page-33">33</a>
     <a href="#section-6.2">6.2</a>.  Event Package Parameters . . . . . . . . . . . . . . . . . <a href="#page-33">33</a>
     <a href="#section-6.3">6.3</a>.  SUBSCRIBE Bodies . . . . . . . . . . . . . . . . . . . . . <a href="#page-36">36</a>
     <a href="#section-6.4">6.4</a>.  Subscription Duration  . . . . . . . . . . . . . . . . . . <a href="#page-37">37</a>
     <a href="#section-6.5">6.5</a>.  NOTIFY Bodies  . . . . . . . . . . . . . . . . . . . . . . <a href="#page-37">37</a>
     <a href="#section-6.6">6.6</a>.  Notifier Processing of SUBSCRIBE Requests  . . . . . . . . <a href="#page-37">37</a>
     <a href="#section-6.7">6.7</a>.  Notifier Generation of NOTIFY Requests . . . . . . . . . . <a href="#page-38">38</a>
     <a href="#section-6.8">6.8</a>.  Subscriber Processing of NOTIFY Requests . . . . . . . . . <a href="#page-38">38</a>
     <a href="#section-6.9">6.9</a>.  Handling of Forked Requests  . . . . . . . . . . . . . . . <a href="#page-39">39</a>
     <a href="#section-6.10">6.10</a>. Rate of Notifications  . . . . . . . . . . . . . . . . . . <a href="#page-39">39</a>
     <a href="#section-6.11">6.11</a>. State Agents . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-39">39</a>
   <a href="#section-7">7</a>.  Examples . . . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-39">39</a>
     <a href="#section-7.1">7.1</a>.  Example 1: Device Requesting Profile . . . . . . . . . . . <a href="#page-39">39</a>
     <a href="#section-7.2">7.2</a>.  Example 2: Device Obtaining Change Notification  . . . . . <a href="#page-42">42</a>
   <a href="#section-8">8</a>.  IANA Considerations  . . . . . . . . . . . . . . . . . . . . . <a href="#page-46">46</a>
     <a href="#section-8.1">8.1</a>.  SIP Event Package  . . . . . . . . . . . . . . . . . . . . <a href="#page-46">46</a>
     <a href="#section-8.2">8.2</a>.  Registry of SIP Configuration Profile Types  . . . . . . . <a href="#page-46">46</a>
   <a href="#section-9">9</a>.  Security Considerations  . . . . . . . . . . . . . . . . . . . <a href="#page-47">47</a>
     <a href="#section-9.1">9.1</a>.  Local-Network Profile  . . . . . . . . . . . . . . . . . . <a href="#page-48">48</a>
     <a href="#section-9.2">9.2</a>.  Device Profile . . . . . . . . . . . . . . . . . . . . . . <a href="#page-49">49</a>
     <a href="#section-9.3">9.3</a>.  User Profile . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-50">50</a>
   <a href="#section-10">10</a>. Acknowledgements . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-51">51</a>
   <a href="#section-11">11</a>. References . . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-52">52</a>
     <a href="#section-11.1">11.1</a>. Normative References . . . . . . . . . . . . . . . . . . . <a href="#page-52">52</a>
     <a href="#section-11.2">11.2</a>. Informative References . . . . . . . . . . . . . . . . . . <a href="#page-53">53</a>






<span class="grey">Petrie &amp; Channabasappa       Standards Track                    [Page 3]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc6080.html">RFC 6080</a>               SIP Configuration Framework            March 2011</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   SIP user agents require configuration data to function properly.
   Examples include information specific to local networks, devices, and
   users.  A configuration data set specific to an entity is termed a
   profile.  For example, device profile contains the configuration data
   related to a device.  The process of providing devices with one or
   more profiles is termed "profile delivery".  Ideally, this profile
   delivery process should be automatic and require minimal or no user
   intervention.

   Many deployments of SIP user agents require dynamic configuration and
   cannot rely on pre-configuration.  This framework provides a standard
   means of providing dynamic configuration that simplifies deployments
   containing SIP user agents from multiple vendors.  This framework
   also addresses change notifications when profiles change.  However,
   the framework does not define the content or format of the profile,
   leaving that to future standardization activities.

   This document is organized as follows.  The normative requirements
   are contained in <a href="#section-5">Section 5</a> (framework operations) and <a href="#section-6">Section 6</a> (the
   event package definition).  The rest of the document provides
   introductory and supporting explanations.  <a href="#section-3">Section 3</a> provides a high-
   level overview of the abstract components, profiles, and the profile
   delivery stages.  <a href="#section-4">Section 4</a> provides some motivating use cases.
   <a href="#section-7">Section 7</a> follows with illustrative examples of the framework in use.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Terminology"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Terminology</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in <a href="rfc2119.html">RFC 2119</a> [<a href="rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].

   This document also reuses the SIP terminology defined in [<a href="rfc3261.html" title='"SIP: Session Initiation Protocol"'>RFC3261</a>]
   and [<a href="rfc3265.html" title='"Session Initiation Protocol (SIP)-Specific Event Notification"'>RFC3265</a>], and it specifies the usage of the following terms.

   Device:  software or hardware entity containing one or more SIP user
      agents.  It may also contain applications such as a DHCP client.

   Device Provider:  the entity responsible for managing a given device.

   Local Network Provider:  the entity that controls the local network
      to which a given device is connected.

   SIP Service Provider:  the entity providing SIP services to users.
      This can refer to private or public enterprises.





<span class="grey">Petrie &amp; Channabasappa       Standards Track                    [Page 4]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc6080.html">RFC 6080</a>               SIP Configuration Framework            March 2011</span>


   Profile:  configuration data set specific to an entity (e.g., user,
      device, local network, or other).

   Profile Type:  a particular category of profile data (e.g., user,
      device, local network, or other).

   Profile Delivery Server (PDS):  the source of a profile, it is the
      logical collection of the Profile Notification Component (PNC) and
      the Profile Content Component (PCC).

   Profile Notification Component (PNC):  the logical component of a
      Profile Delivery Server that is responsible for enrolling devices
      and providing profile notifications.

   Profile Content Component (PCC):  the logical component of a Profile
      Delivery Server that is responsible for storing, providing access
      to, and accepting profile content.

   Profile Delivery Stages:  the processes that lead a device to obtain
      profile data, and any subsequent changes, are collectively called
      profile delivery stages.

   Bootstrapping:  Bootstrapping is the process by which a new (or
      factory reset) device, with no configuration or minimal "factory"
      pre-configuration, enrolls with the PDS.  The device may use a
      temporary identity and credentials to authenticate itself to
      enroll and receive profiles, which may provide more permanent
      identities and credentials for future enrollments.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Overview"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Overview</span>

   This section provides an overview of the configuration framework.  It
   presents the reference model, the motivation, the profile delivery
   stages, and a mapping of the concepts to specific use cases.  It is
   meant to serve as a reference section for the document, rather than
   providing a specific logical flow of material, and it may be
   necessary to revisit these sections for a complete appreciation of
   the framework.

   The SIP UA Profile Delivery Framework uses a combination of SIP event
   messages (SUBSCRIBE and NOTIFY; [<a href="rfc3265.html" title='"Session Initiation Protocol (SIP)-Specific Event Notification"'>RFC3265</a>]) and traditional file
   retrieval protocols, such as HTTP [<a href="rfc2616.html" title='"Hypertext Transfer Protocol -- HTTP/1.1"'>RFC2616</a>], to discover, monitor,
   and retrieve configuration profiles.  The framework defines three
   types of profiles (local-network, device, and user) in order to
   separate aspects of the configuration that may be independently
   managed by different administrative domains.  The initial SUBSCRIBE
   message for each profile allows the UA to describe itself (both its
   implementation and the identity requesting the profile), while



<span class="grey">Petrie &amp; Channabasappa       Standards Track                    [Page 5]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc6080.html">RFC 6080</a>               SIP Configuration Framework            March 2011</span>


   requesting access to a profile by type, without prior knowledge of
   the profile name or location.  Discovery mechanisms are specified to
   help the UA form the Subscription URI (the Request-URI for the SIP
   SUBSCRIBE).  The SIP User Agent Server (UAS) handling these
   subscriptions is the Profile Delivery Server (PDS).  When the PDS
   accepts a subscription, it sends a NOTIFY to the device.  The initial
   NOTIFY from the PDS for each profile may contain profile data or a
   reference to the location of the profile, to be retrieved using HTTP
   or similar file retrieval protocols.  By maintaining a subscription
   to each profile, the UA will receive additional NOTIFY messages if
   the profile is later changed.  These may contain a new profile, a
   reference to a new profile, or a description of profile changes,
   depending on the Content-Type [<a href="rfc3261.html" title='"SIP: Session Initiation Protocol"'>RFC3261</a>] in use by the subscription.
   The framework describes the mechanisms for obtaining three different
   profile types, but does not describe the data model they utilize (the
   data model is out of scope for this specification).

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.1.%20%20Reference%20Model"></a><a class="selflink" href="#section-3.1" name="section-3.1">3.1</a>.  Reference Model</span>

   The design of the framework was the result of a careful analysis to
   identify the configuration needs of a wide range of SIP deployments.
   As such, the reference model provides for a great deal of
   flexibility, while breaking down the interactions to their basic
   forms, which can be reused in many different scenarios.

   The reference model for the framework defines the interactions
   between the Profile Delivery Server (PDS) and the device.  The device
   needs the profile data to function effectively in the network.  The
   PDS is responsible for responding to device requests and providing
   the profile data.  The reference model is illustrated in Figure 1.

                                          +-------------------------+
    +--------+                            | Profile Delivery Server |
    | Device |&lt;==========================&gt;|  +---+          +---+   |
    +--------+                            |  |PNC|          |PCC|   |
                                          |  +---+          +---+   |
                                          +-------------------------+

                                PNC = Profile Notification Component
                                PCC = Profile Content Component

                    Figure 1: Framework Reference Model

   The PDS is subdivided into two logical components:

   o  Profile Notification Component (PNC), responsible for enrolling
      devices for profiles and providing profile change notifications.




<span class="grey">Petrie &amp; Channabasappa       Standards Track                    [Page 6]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc6080.html">RFC 6080</a>               SIP Configuration Framework            March 2011</span>


   o  Profile Content Component (PCC), responsible for storing,
      providing access to, and accepting modifications related to
      profile content.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.2.%20%20Motivation"></a><a class="selflink" href="#section-3.2" name="section-3.2">3.2</a>.  Motivation</span>

   The motivation for the framework can be demonstrated by applying the
   reference model presented in <a href="#section-3.1">Section 3.1</a> to two scenarios that are
   representative of the two ends of a spectrum of potential SIP
   deployments.

   In the simplest deployment scenario, a device connects through a
   network that is controlled by a single provider who provides the
   local network, manages the devices, and offers services to the users.
   The provider propagates profile data to the device that contains all
   the necessary information to obtain services in the network
   (including information related to the local network and the users).
   This is illustrated in Figure 2.  An example is a simple enterprise
   network that supports SIP-based devices.

                               --------------
                             / Local Network, \
                            | Device &amp; Service |
                             \    Provider    /
                              ----------------
                                     |
                                     |
                                  --------
                                 | Device |
                                  --------
                                     |
                                     |
                                   ----
                                  |User|
                                   ----

                     Figure 2: Simple Deployment Model

   In more complex deployments, devices connect via a local network that
   is not controlled by the SIP service provider, such as devices that
   connect via available public WiFi hot spots.  In such cases, local
   network providers may wish to provide local network information such
   as bandwidth constraints to the devices.

   Devices may also be controlled by device providers that are
   independent of the SIP service provider who provides user services,
   such as kiosks that allow users to access services from remote




<span class="grey">Petrie &amp; Channabasappa       Standards Track                    [Page 7]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc6080.html">RFC 6080</a>               SIP Configuration Framework            March 2011</span>


   locations.  In such cases, the profile data may have to be obtained
   from different profile sources: local network provider, device
   provider, and SIP service provider.  This is indicated in Figure 3.

      --------
    /   SIP    \
   |   Service  |                -&gt; Provides 'user' profile
   |  Provider  |                   data (e.g., services
    \          /                    configuration)
      --------      --------
          |       /          \
          |      |   Device   |  -&gt; Provides 'device' profile
          |      |  Provider  |     data (e.g., device specifics)
          |       \          /
          |         ---------
          |        /
          |       /    -------
          |      /   /  Local  \
          |     /   |  Network  |
          |    |    |  Provider | -&gt; Provides 'local-network' profile
          |    |     \         /     data (e.g., bandwidth)
          |    |       -------
          |    |        /
          |    |       /
          |    |      |
     ===================
    (   Local Network   )
     ===================
             |
             |
          --------
         | Device |              -&gt; Needs the 'local-network'
          --------                  and 'device' profile
          /     \
         /       \
       ------   ------
      |User A| |User B|          -&gt; Users need 'user' profiles
       ------   ------

                    Figure 3: Complex Deployment Model

   In either case, Providers need to deliver to the device, profile data
   that is required to participate in their network.  Examples of
   profile data include the list of codecs that can be used and the SIP
   proxies to which to connect for services.  Pre-configuration of such
   information is one option if the device is always served by the same
   set of Providers.  In all other cases, the profile delivery needs to
   be automated and consistent across Providers.  Given the presence of



<span class="grey">Petrie &amp; Channabasappa       Standards Track                    [Page 8]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc6080.html">RFC 6080</a>               SIP Configuration Framework            March 2011</span>


   a number of large deployments where pre-configuration is neither
   desired nor optimal, there is a need for a common configuration
   framework such as the one described in this document.

   Further, the former deployment model can be accomplished by the
   device obtaining profile data from a single provider.  However, the
   latter deployment model requires the device to obtain profile data
   from different providers.  To address either deployment or any
   variation in between, one needs to allow for profile delivery via one
   or more Providers.  The framework accomplishes this by specifying
   multiple profile types and a set of profile delivery stages to obtain
   them.  These are introduced in the subsections to follow.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.3.%20%20Profile%20Types"></a><a class="selflink" href="#section-3.3" name="section-3.3">3.3</a>.  Profile Types</span>

   The framework handles the presence of potentially different Providers
   by allowing for multiple profile types.  Clients request each profile
   separately, and obtain them from the same, or different, Providers.
   A deployment can also choose to pre-configure the device to request
   only a subset of the specified profile types.  The framework
   specifies three basic profile types, as follows:

   Local Network Profile:  contains configuration data related to the
      local network to which a device is directly connected, provided by
      the local network provider.

   Device Profile:  contains configuration data related to a specific
      device, provided by the device provider.

   User Profile:  contains configuration data related to a specific
      User, as required to reflect that user's preferences and the
      particular services to which it is subscribed.  It is provided by
      the SIP service provider.

   Additional profile types may also be specified by future work within
      the IETF.  The data models associated with each profile type are
      out of scope for this document.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.4.%20%20Profile%20Delivery%20Stages"></a><a class="selflink" href="#section-3.4" name="section-3.4">3.4</a>.  Profile Delivery Stages</span>

   The framework specified in this document requires a device to
   explicitly request profiles.  It also requires one or more PDSs,
   which provide the profile data.  The processes that lead a device to
   obtain profile data, and any subsequent changes, can be explained in
   three stages, termed the profile delivery stages.






<span class="grey">Petrie &amp; Channabasappa       Standards Track                    [Page 9]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc6080.html">RFC 6080</a>               SIP Configuration Framework            March 2011</span>


   Profile Enrollment:  the process by which a device requests, and if
      successful, enrolls with a PDS capable of providing a profile.  A
      successful enrollment is indicated by a notification containing
      the profile information (contents or content indirection
      information).  Depending on the request, this could also result in
      a subscription to notification of profile changes.

   Profile Content Retrieval:  the process by which a device retrieves
      profile contents, if the profile enrollment resulted in content
      indirection information.

   Profile Change Notification:  the process by which a device is
      notified of any changes to an enrolled profile.  This may provide
      the device with modified profile data or content indirection
      information.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.5.%20%20Supported%20Device%20Types"></a><a class="selflink" href="#section-3.5" name="section-3.5">3.5</a>.  Supported Device Types</span>

   The examples in this framework tend to associate devices with
   entities that are accessible to end-users.  However, this is not
   necessarily the only type of device that can utilize the specified
   framework.  Devices can be entities such as SIP Phones or soft
   clients, with or without user interfaces (that allow for device
   configuration), entities in the network that do not directly
   communicate with any users (e.g., gateways, media servers, etc.) or
   network infrastructure elements (e.g., SIP servers).  The framework
   is extensible for use with such device types.  However, it is to be
   noted that some of these other device types (e.g., network elements)
   may also be configurable using other mechanisms.  The use of this
   framework in conjunction with other mechanisms (specified outside of
   this document), is out of scope.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Use%20Cases"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Use Cases</span>

   This section provides a small, non-comprehensive set of
   representative use cases to further illustrate how this framework can
   be utilized in SIP deployments.  The first use case is simplistic in
   nature, whereas the second is relatively complex.  The use cases
   illustrate the effectiveness of the framework in either scenario.

   For security considerations, please refer to Sections <a href="#section-5">5</a> and <a href="#section-9">9</a>.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.1.%20%20Simple%20Deployment%20Scenario"></a><a class="selflink" href="#section-4.1" name="section-4.1">4.1</a>.  Simple Deployment Scenario</span>

   Description: Consider a deployment scenario (e.g., a small private
   enterprise) where a participating device implements this framework
   and is configured, using previously obtained profile data, to request
   only the device profile.  Assume that the device operates in the same



<span class="grey">Petrie &amp; Channabasappa       Standards Track                   [Page 10]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc6080.html">RFC 6080</a>               SIP Configuration Framework            March 2011</span>


   network as the PDS (i.e., there is no NAT) and it obtains its IP
   configuration using DHCP.  Typical communication between the device
   and the PDS will traverse one or more SIP proxies, but is not
   required, and is omitted in this illustration.

   Figure 4 illustrates the sequence of events that includes device
   start-up and a successful profile enrollment for the device profile
   that results in device profile data.  It then illustrates how a
   change in the profile data is delivered via Profile Change
   Notification.

                                         +----------------------+
    +--------+                           |  Provider's Network  |
    | Device |                           |                      |
    |        |                           |                      |
    +--------+                           |  DHCP        PDS     |
                                         +----------------------+
         |                                   |          |
    (A)  |&lt;============== DHCP =============&gt;|          |
         |                                              |
         |                                              |
         |                                              |
    (B)  |&lt;=========== Profile Enrollment  ============&gt;|
         |                                              | Profile data
         |                                              | is modified
         |                                              |
    (C)  |&lt;============ Profile Change  ================|
         |               Notification                   |
         |                                              |
         |                                              |

                           Figure 4: Use Case 1

   The following is an explanation of the interactions in Figure 4.

   (A)  Upon initialization, the device obtains IP configuration
        parameters such as an IP address using DHCP.

   (B)  The device requests profile enrollment for the device profile.
        Successful enrollment provides it with a notification containing
        the device profile data.

   (C)  Due to a modification of the device profile, a profile change
        notification is sent across to the device, along with the
        modified profile.






<span class="grey">Petrie &amp; Channabasappa       Standards Track                   [Page 11]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc6080.html">RFC 6080</a>               SIP Configuration Framework            March 2011</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.2.%20%20Devices%20Supporting%20Multiple%20Users%20from%20Different%20Service%20Providers"></a><a class="selflink" href="#section-4.2" name="section-4.2">4.2</a>.  Devices Supporting Multiple Users from Different Service Providers</span>

   Description: Consider a single device that allows multiple users to
   obtain services from different SIP service providers, e.g., a kiosk
   at an airport.

   The following assumptions apply:

   o  Provider A is the device and local network provider for the
      device, and the SIP service provider for user A; Provider B is the
      SIP service provider for user B.

   o  Profile enrollment always results in content indirection
      information requiring profile content retrieval.

   o  Communication between the device and the PDSs is facilitated via
      one or more SIP proxies (only one is shown in the illustration).

   Figure 5 illustrates the use case and highlights the communications
   relevant to the framework specified in this document.































<span class="grey">Petrie &amp; Channabasappa       Standards Track                   [Page 12]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc6080.html">RFC 6080</a>               SIP Configuration Framework            March 2011</span>


     User User
       A   B        +----------------------+  +----------------------+
    +--------+      |       Provider       |  |       Provider       |
    | Device |      |           A          |  |          B           |
    |        |      |                      |  |                      |
    +--------+      | DHCP    PROXY   PDS  |  |  PROXY        PDS    |
                    +----------------------+  +----------------------+
         |              |        |      |          |           |
     (A) |&lt;====DHCP====&gt;|        |      |          |           |
         |                       |      |          |           |
         |                       |      |          |           |
         |  Profile Enrollment   |      |          |           |
     (B) |&lt;local-network profile&gt;|&lt;====&gt;|          |           |
         |
         |   &lt;&lt;Profile content retrieval&gt;&gt;
         |
         |
         |  Profile Enrollment   |      |          |           |
     (C) |&lt;== device profile ==&gt; |&lt;====&gt;|          |           |
         |
         |   &lt;&lt;Profile content retrieval&gt;&gt;
         |
                      .
                      .
                      .

         |   Profile Enrollment  |      |          |           |
     (D) |&lt;= user profile (A) =&gt; |&lt;====&gt;|          |           |
         |                       |      |          |           |
         |
         |   &lt;&lt;Profile content retrieval&gt;&gt;
                              .
             [[User A obtains services]]
                      .
                      .
                      .
         |
         |            Profile Enrollment           |           |
     (E) |&lt;=========== user profile (B) ==========&gt;|&lt;=========&gt;|
         |                                         |           |
         |   &lt;&lt;Profile content retrieval&gt;&gt;
         |

             [[User B obtains services]]

                           Figure 5: Use Case 2





<span class="grey">Petrie &amp; Channabasappa       Standards Track                   [Page 13]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc6080.html">RFC 6080</a>               SIP Configuration Framework            March 2011</span>


   The following is an explanation of the interactions in Figure 5.

   (A)  Upon initialization, the device obtains IP configuration
        parameters using DHCP.  This also provides the local domain
        information to help with local-network profile enrollment.

   (B)  The device requests profile enrollment for the local network
        profile.  It receives an enrollment notification containing
        content indirection information from Provider A's PDS.  The
        device retrieves the profile (this contains useful information
        such as firewall port restrictions and available bandwidth).

   (C)  The device then requests profile enrollment for the device
        profile.  It receives an enrollment notification resulting in
        device profile content retrieval.  The device initializes the
        user interface for services.

   (D)  User A with a pre-existing service relationship with Provider A
        attempts communication via the user interface.  The device uses
        the user supplied information (including any credential
        information) and requests profile enrollment for user A's
        profile.  Successful enrollment and profile content retrieval
        results in services for user A.

   (E)  At a different point in time, user B with a service relationship
        with Provider B attempts communication via the user interface.
        It enrolls and retrieves user B's profile and this results in
        services for user B.

   The discovery mechanisms for profile enrollment described by the
   framework, or the profile data themselves, can result in outbound
   proxies that support devices behind NATs, using procedures specified
   in [<a href="rfc5626.html" title='"Managing Client- Initiated Connections in the Session Initiation Protocol (SIP)"'>RFC5626</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Profile%20Delivery%20Framework"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Profile Delivery Framework</span>

   This section specifies the profile delivery framework.  It provides
   the requirements for the three profile delivery stages introduced in
   <a href="#section-3.4">Section 3.4</a> and presents the associated security requirements.  It
   also presents considerations such as back-off and retry mechanisms.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.1.%20%20Profile%20Delivery%20Stages"></a><a class="selflink" href="#section-5.1" name="section-5.1">5.1</a>.  Profile Delivery Stages</span>

   The three profile delivery stages -- enrollment, content retrieval,
   and change notification -- apply separately to each profile type
   specified for use with this framework.  The following subsections
   provide the requirements associated with each stage.




<span class="grey">Petrie &amp; Channabasappa       Standards Track                   [Page 14]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc6080.html">RFC 6080</a>               SIP Configuration Framework            March 2011</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.1.1.%20%20Profile%20Enrollment"></a><a class="selflink" href="#section-5.1.1" name="section-5.1.1">5.1.1</a>.  Profile Enrollment</span>

   Profile enrollment is the process by means of which a device
   requests, and receives, profile data.  Each profile type specified in
   this document requires an independent enrollment request.  However, a
   particular PDS can support enrollment for one or more profile types.

   PDSs and devices MUST implement all of the three profile types.  A
   device that has not been configured otherwise SHOULD try to obtain
   all the three profile types, in the order specified by this
   framework.  The exceptions are bootstrapping when it SHOULD request
   the device profile type (see <a href="#section-5.3.1">Section 5.3.1</a>) or when it has been
   explicitly configured with a different order via mechanisms such as
   previously retrieved profile data or pre-configuration or manual
   configuration.

   Profile enrollment consists of the following operations, in the
   specified order.

   Enrollment request transmission

      Profile enrollment is initiated when the device transmits a SIP
      SUBSCRIBE request [<a href="rfc3265.html" title='"Session Initiation Protocol (SIP)-Specific Event Notification"'>RFC3265</a>] for the 'ua-profile' event package,
      specified in <a href="#section-6">Section 6</a>.  The profile being requested is indicated
      using the 'profile-type' parameter.  The device MUST transmit the
      SIP SUBSCRIBE message via configured outbound proxies for the
      destination domain, or in accordance with <a href="rfc3263.html">RFC 3263</a> [<a href="rfc3263.html" title='"Session Initiation Protocol (SIP): Locating SIP Servers"'>RFC3263</a>].

      The device needs certain data to create an enrollment request,
      form a Request-URI, and authenticate to the network.  This
      includes the profile provider's domain name and device or user
      identities and credentials.  Such data can be "configured" during
      device manufacturing, by the user, or via profile data enrollment
      (see <a href="#section-5.3.1">Section 5.3.1</a>).  The data can also be "discovered" using the
      procedures specified by this framework.  The "discovered" data can
      be retained across device resets (but not across factory resets)
      and such data is referred to as "cached".  Thus, data can be
      configured, discovered, or cached.  The following requirements
      apply.

      *  If the device is configured with a specific domain name (for
         the local network provider or device provider), it MUST NOT
         attempt "discovery" of the domain name.  This is the case when
         the device is pre-configured (e.g., via a user interface) to be
         managed by specific entities.






<span class="grey">Petrie &amp; Channabasappa       Standards Track                   [Page 15]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc6080.html">RFC 6080</a>               SIP Configuration Framework            March 2011</span>


      *  The device MUST only use data associated with the provider's
         domain in an enrollment request.  As an example, when the
         device is requesting a local-network profile in the domain
         'example.net', it cannot present a user Address of Record (AoR)
         associated with the local domain 'example.com'.

      *  The device SHOULD adhere to the following order of data usage:
         configured, cached, and discovered.  An exception is when the
         device is explicitly configured to use a different order.

      Upon failure to obtain the profile using any methods specified in
      this framework, the device MAY provide a user interface to allow
      for user intervention.  This can result in temporary, one-time
      data to bootstrap the device.  Such temporary data is not
      considered to be "configured" and SHOULD NOT be cached across
      resets.  The configuration obtained using such data MAY provide
      the configuration data required for the device to continue
      functioning normally.

      Devices attempting enrollment MUST comply with the SIP-specific
      event notification specified in [<a href="rfc3265.html" title='"Session Initiation Protocol (SIP)-Specific Event Notification"'>RFC3265</a>], the event package
      requirements specified in <a href="#section-6.2">Section 6.2</a>, and the security
      requirements specified in <a href="#section-5.2">Section 5.2</a>.

   Enrollment request admittance

      A PDS or a SIP proxy will receive a transmitted enrollment
      request.  If a SIP infrastructure element receives the request, it
      will relay it to the authoritative proxy for the domain indicated
      in the Request-URI (the same way it would handle any other
      SUBSCRIBE message).  The authoritative proxy is required to
      examine the request (e.g., event package) and transmit it to a PDS
      capable of addressing the profile enrollment request.

      A PDS receiving the enrollment request SHOULD respond to the
      request, or proxy it to a PDS that can respond.  An exception to
      responding or proxying the request is when a policy prevents
      response (e.g., recognition of a denial-of-service (DoS) attack,
      an invalid device, etc.).  The PDS then verifies the identity
      presented in the request and performs any necessary
      authentication.  Once authentication is successful, the PDS MUST
      either admit or reject the enrollment request, based on applicable
      authorization policies.  A PDS admitting the enrollment request
      indicates it via a 2xx-class response, as specified in [<a href="rfc3265.html" title='"Session Initiation Protocol (SIP)-Specific Event Notification"'>RFC3265</a>].

      Refer to Sections <a href="#section-6.6">6.6</a> and <a href="#section-5.2">5.2</a> for more information on subscription
      request handling and security requirements, respectively.




<span class="grey">Petrie &amp; Channabasappa       Standards Track                   [Page 16]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc6080.html">RFC 6080</a>               SIP Configuration Framework            March 2011</span>


   Enrollment request acceptance

      A PDS that admits the enrollment request verifies applicable
      policies, identifies the requested profile data and prepares a SIP
      NOTIFY message to the device.  Such a notification can either
      contain the profile data or contain content indirection
      information that results in the device performing profile content
      retrieval.  The PDS then transmits the prepared SIP notification.
      When the device successfully receives and accepts the SIP
      notification, profile enrollment is complete.

      When it receives the SIP NOTIFY message, indicating successful
      profile enrollment, the device SHOULD make the new profile
      effective within the specified time frame, as described in
      <a href="#section-6.2">Section 6.2</a>.  The exception is when the profile data is delivered
      via content indirection, and the device cannot obtain the profile
      data within the specified time frame.

      Once profile enrollment is successful, the PDS MUST consider the
      device enrolled for the specific profile, for the duration of the
      subscription.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.1.2.%20%20Content%20Retrieval"></a><a class="selflink" href="#section-5.1.2" name="section-5.1.2">5.1.2</a>.  Content Retrieval</span>

   A successful profile enrollment leads to an initial SIP notification,
   and may result in subsequent change notifications.  Each of these
   notifications can either contain profile data or content indirection
   information.  If it contains content indirection information, the
   device is required to retrieve the profile data using the specified
   content retrieval protocols.  This process is termed "profile content
   retrieval".  For information regarding the use of the SIP NOTIFY
   message body, please refer to <a href="#section-6.5">Section 6.5</a>.

   Devices and PDSs implementing this framework MUST implement two
   content retrieval protocols: HTTP and HTTPS, as specified in
   [<a href="rfc2616.html" title='"Hypertext Transfer Protocol -- HTTP/1.1"'>RFC2616</a>] and [<a href="rfc2818.html" title='"HTTP Over TLS"'>RFC2818</a>], respectively.  Future enhancements or usage
   of this framework may specify additional or alternative content
   retrieval protocols.  For security requirements and considerations,
   please refer to <a href="#section-5.2">Section 5.2</a>.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.1.3.%20%20Change%20Notification"></a><a class="selflink" href="#section-5.1.3" name="section-5.1.3">5.1.3</a>.  Change Notification</span>

   Profile data can change over time.  Changes can be initiated by
   various entities (e.g., via the device, back-office components, and
   end-user web interfaces) and for various reasons (e.g., change in
   user preferences and modifications to services).  Profiles may also
   be shared by multiple devices simultaneously.  When a profile is
   changed, the PDS MUST inform all the devices currently enrolled for



<span class="grey">Petrie &amp; Channabasappa       Standards Track                   [Page 17]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc6080.html">RFC 6080</a>               SIP Configuration Framework            March 2011</span>


   the specific profile.  This process of informing a device of any
   changes to the profile that it is currently enrolled for is termed
   change notification.

   The PDS provides change notification using a SIP notification (the
   SIP NOTIFY message, as specified in [<a href="rfc3265.html" title='"Session Initiation Protocol (SIP)-Specific Event Notification"'>RFC3265</a>]).  The SIP notification
   may provide the changes, a revised profile, or content indirection,
   which contains a pointer to the revised data.  When a device
   successfully receives a profile change notification for an enrolled
   profile, it MUST act upon the changes prior to the expiration of the
   'effective-by' parameter.

   For NOTIFY content, please refer to <a href="#section-6.5">Section 6.5</a>.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.1.4.%20%20Enrollment%20Data%20and%20Caching"></a><a class="selflink" href="#section-5.1.4" name="section-5.1.4">5.1.4</a>.  Enrollment Data and Caching</span>

   The requirements for the contents of the SIP SUBSCRIBE used to
   request profile enrollment are described in this section.  The data
   required can be configured, cached, or discovered -- depending on the
   profile type.  If the data is not configured, the device MUST use
   relevant cached data or proceed with data discovery.  This section
   describes the requirements for creating a SIP SUBSCRIBE for
   enrollment, the caching requirements and how data can be discovered.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/5.1.4.1.%20%20Local-Network%20Profile"></a><a class="selflink" href="#section-5.1.4.1" name="section-5.1.4.1">5.1.4.1</a>.  Local-Network Profile</span>

   To create a Subscription URI to request the local-network profile, a
   device needs the local network domain name, the device identifier,
   and optionally a user AoR with associated credentials (if one is
   configured).  Since the device can be potentially initialized in a
   different local network each time, it SHOULD NOT cache the local
   network domain, the SIP Subscription URI or the local-network profile
   data across resets.  An exception to this is when the device can
   confirm that it is reinitialized in the same network (using means
   outside the scope of this document).  Thus, in most cases, the device
   needs to discover the local network domain name.  The device
   discovers this by establishing IP connectivity in the local network
   (such as via DHCP or pre-configured IP information).  Once
   established, the device MUST attempt to use the local network domain
   obtained via pre-configuration, if available.  If it is not pre-
   configured, it MUST employ dynamic discovery using DHCPv4 ([<a href="rfc2132.html" title='"DHCP Options and BOOTP Vendor Extensions"'>RFC2132</a>],
   Domain Name option) or DHCPv6 ([<a href="rfc4704.html" title='"The Dynamic Host Configuration Protocol for IPv6 (DHCPv6) Client Fully Qualified Domain Name (FQDN) Option"'>RFC4704</a>]).  Once the local network
   domain is obtained, the device creates the SIP SUBSCRIBE for
   enrollment as described below.







<span class="grey">Petrie &amp; Channabasappa       Standards Track                   [Page 18]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-19" id="page-19" name="page-19"> </a>
<span class="grey"><a href="rfc6080.html">RFC 6080</a>               SIP Configuration Framework            March 2011</span>


   o  The device MUST NOT populate the user part of the Request-URI.
      The device MUST set the host portion of the Request-URI to the
      dot-separated concatenation of "_sipuaconfig" and the local
      network domain (see example below).

   o  If the device has been configured with a user AoR for the local
      network domain (verified as explained in <a href="#section-5.2">Section 5.2</a>) the device
      MUST use it to populate the From field, unless configured not to
      (due to privacy concerns, for example).  Otherwise, the device
      MUST set the From field to a value of
      "anonymous@anonymous.invalid".

   o  The device MUST include the +sip.instance parameter within the
      Contact header, as specified in [<a href="rfc5626.html" title='"Managing Client- Initiated Connections in the Session Initiation Protocol (SIP)"'>RFC5626</a>].  The device MUST ensure
      that the value of this parameter is the same as that included in
      any subsequent profile enrollment request.

   For example, if the device requested and received the local domain
   name via DHCP to be: airport.example.net, then the local-network
   profile SUBSCRIBE Request-URI would look like:

   sip:_sipuaconfig.airport.example.net

   The local-network profile SUBSCRIBE Request-URI does not have a user
   part so that the URI is distinct between the "local" and "device"
   URIs when the domain is the same for the two.  This provides a means
   of routing to the appropriate PDS in domains where there are distinct
   servers.

   The From field is populated with the user AoR, if available.  This
   allows the local network provider to propagate user-specific profile
   data, if available.  The "+sip.instance" parameter within the Contact
   header is set to the device identifier or specifically, the SIP UA
   instance.  Even though every device may get the same (or similar)
   local-network profile, the uniqueness of the "+sip.instance"
   parameter provides an important capability.  Having unique instance
   ID fields allows the management of the local network to track devices
   present in the network and consequently also manage resources such as
   bandwidth allocation.

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/5.1.4.2.%20%20Device%20Profile%20Type"></a><a class="selflink" href="#section-5.1.4.2" name="section-5.1.4.2">5.1.4.2</a>.  Device Profile Type</span>

   Once associated with a device, the device provider is not expected to
   change frequently.  Thus, the device is allowed to, and SHOULD, cache
   the Subscription URI for the device profile upon successful
   enrollment.  Exceptions include cases where the device identifier has
   changed (e.g., new network card), device provider information has
   changed (e.g., user initiated change), or the device cannot obtain



<span class="grey">Petrie &amp; Channabasappa       Standards Track                   [Page 19]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-20" id="page-20" name="page-20"> </a>
<span class="grey"><a href="rfc6080.html">RFC 6080</a>               SIP Configuration Framework            March 2011</span>


   its profile using the Subscription URI.  Thus, when available, the
   device MUST use a cached Subscription URI.  If no cached URI is
   available then it needs to create a Subscription URI.  To create a
   Subscription URI, the device needs a device identity and the device
   provider's domain name.  Unless already configured, the device needs
   to discover the necessary information and form the Subscription URI.
   In such cases, the following requirements apply for creating a
   Subscription URI for requesting the device profile:

   o  The device MUST populate the user part of the Request-URI with the
      device identifier.  The device MUST set the host portion of the
      Request-URI to the domain name of the device provider.  The device
      identifier format is explained in detail later in this section.

   o  The device MUST set the From field to a value of anonymous@&lt;device
      provider's domain&gt;.

   o  The device MUST include the "+sip.instance" parameter within the
      Contact header, as specified in [<a href="rfc5626.html" title='"Managing Client- Initiated Connections in the Session Initiation Protocol (SIP)"'>RFC5626</a>].  The device MUST use
      the same value as the one presented while requesting the local-
      network profile.

   Note that the discovered AoR for the Request-URI can be overridden by
   a special, provisioned, AoR that is unique to the device.  In such
   cases, the provisioned AoR is used to form the Request-URI and to
   populate the From field.

   If the device is not configured with an AoR, and needs a domain name
   to populate the Request-URI and the From field, it can either use a
   configured domain name, if available, or discover it.  The options to
   discover are described below.  The device MUST use the results of
   each successful discovery process for one enrollment attempt, in the
   order specified below.

   o  Option 1: Devices that support DHCP MUST attempt to obtain the
      domain name of the outbound proxy during the DHCP process, using
      the DHCP option for SIP servers defined in [<a href="rfc3361.html" title='"Dynamic Host Configuration Protocol (DHCP-for-IPv4) Option for Session Initiation Protocol (SIP) Servers"'>RFC3361</a>] or [<a href="rfc3319.html" title='"Dynamic Host Configuration Protocol (DHCPv6) Options for Session Initiation Protocol (SIP) Servers"'>RFC3319</a>]
      (for IPv4 and IPv6, respectively).

   o  Option 2: Devices that support DHCP MUST attempt to obtain the
      local IP network domain during the DHCP process (refer to
      [<a href="rfc2132.html" title='"DHCP Options and BOOTP Vendor Extensions"'>RFC2132</a>] and [<a href="rfc4704.html" title='"The Dynamic Host Configuration Protocol for IPv6 (DHCPv6) Client Fully Qualified Domain Name (FQDN) Option"'>RFC4704</a>]).

   o  Option 3: Devices MUST use the local network domain name
      (configured or discovered to retrieve the local-network profile),
      prefixing it with the label "_sipuaconfig".





<span class="grey">Petrie &amp; Channabasappa       Standards Track                   [Page 20]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-21" id="page-21" name="page-21"> </a>
<span class="grey"><a href="rfc6080.html">RFC 6080</a>               SIP Configuration Framework            March 2011</span>


   If the device needs to create a Subscription URI and needs to use its
   device identifier, it MUST use the UUID-based (Universally Unique
   Identifier) URN representation as specified in [<a href="rfc4122.html" title='"A Universally Unique IDentifier (UUID) URN Namespace"'>RFC4122</a>].  The
   following requirements apply:

   o  When the device has a non-alterable Media Access Control (MAC)
      address, it SHOULD use the version 1 UUID representation with the
      timestamp and clock sequence bits set to a value of '0'.  This
      will allow for easy recognition, and uniqueness of MAC-address-
      based UUIDs.  An exception is the case where the device supports
      independent device configuration for more than one SIP UA.  An
      example would be multiple SIP UAs on the same platform.

   o  If the device cannot use a non-alterable device identifier, it
      SHOULD use an alternative non-alterable device identifier.  For
      example, the International Mobile Equipment Identity (IMEI) for
      mobile devices.

   o  If the device cannot use a non-alterable MAC address, it MUST use
      the same approach as defining a user agent instance ID in
      [<a href="rfc5626.html" title='"Managing Client- Initiated Connections in the Session Initiation Protocol (SIP)"'>RFC5626</a>].

   o  Note: when the URN is used as the user part of the Request-URI, it
      MUST be URL escaped since the colon (":") is not a legal character
      in the user part of an addr-spec ([<a href="rfc4122.html" title='"A Universally Unique IDentifier (UUID) URN Namespace"'>RFC4122</a>]), and must be escaped.

         For example, the instance ID:
         urn:uuid:f81d4fae-7ced-11d0-a765-00a0c91e6bf6@example.com

         would be escaped to look as follows in a URI:
         sip:urn%3auuid%3af81d4fae-7ced-11d0-a765-00a0c91e6bf6@
         example.com

         The ABNF ([<a href="rfc5234.html" title='"Augmented BNF for Syntax Specifications: ABNF"'>RFC5234</a>]) for the UUID representation is provided in
         [<a href="rfc4122.html" title='"A Universally Unique IDentifier (UUID) URN Namespace"'>RFC4122</a>].

<span class="h5"><a class="dashAnchor" name="//apple_ref/Section/5.1.4.3.%20%20User%20Profile%20Type"></a><a class="selflink" href="#section-5.1.4.3" name="section-5.1.4.3">5.1.4.3</a>.  User Profile Type</span>

   To create a Subscription URI to request the user profile on behalf of
   a user, the device needs to know the user's AoR.  This can be
   statically or dynamically configured on the device (e.g., user input,
   or propagated as part of the device profile).  Similar to device
   profiles, the content and propagation of user profiles may differ,
   based on deployment scenarios (i.e., users belonging to the same
   domain may -- or may not -- be provided the same profile).  To create
   a Subscription URI, the following rules apply:





<span class="grey">Petrie &amp; Channabasappa       Standards Track                   [Page 21]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-22" id="page-22" name="page-22"> </a>
<span class="grey"><a href="rfc6080.html">RFC 6080</a>               SIP Configuration Framework            March 2011</span>


   o  The device MUST set the Request-URI to the user AoR.

   o  The device MUST populate the From field with the user AoR.

   An authoritative SIP proxy for a SIP provider's network that receives
   a profile enrollment request for the user profile type will route
   based on the Event Header field values, thus allowing a subscription
   to the user's AoR to be routed to the appropriate PDS.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.2.%20%20Securing%20Profile%20Delivery"></a><a class="selflink" href="#section-5.2" name="section-5.2">5.2</a>.  Securing Profile Delivery</span>

   Profile data can contain sensitive information that needs to be
   secured, such as identities and credentials.  Security involves
   authentication, data integrity and data confidentiality.
   Authentication is the process by which you verify that an entity is
   who it claims to be, such as a user AoR presented during profile
   enrollment.  Message integrity provides the assurance that the
   message contents transmitted between two entities, such as between
   the PDS and the device, has not been modified during transit.
   Privacy ensures that the message contents have not been subjected to
   monitoring by unwanted elements during transit.  Authentication and
   data integrity are required to ensure that the profile contents were
   received by a valid entity, from a valid source, and without any
   modifications during transit.  For profiles that contain sensitive
   data, data confidentiality is also required.

   For an overview of potential security threats, refer to <a href="#section-9">Section 9</a>.
   For information on how the device can be configured with identities
   and credentials, refer to <a href="#section-5.3.1">Section 5.3.1</a>.  The following subsections
   provide the security requirements associated with each profile
   delivery stage, and applies to each of profile types specified by
   this framework.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.2.1.%20%20Securing%20Profile%20Enrollment"></a><a class="selflink" href="#section-5.2.1" name="section-5.2.1">5.2.1</a>.  Securing Profile Enrollment</span>

   Profile enrollment may result in sensitive profile data.  In such
   cases, the PDS MUST authenticate the device, except during the
   bootstrapping scenario when the device does not have existing
   credentials (see <a href="#section-5.3.1">Section 5.3.1</a> for more information on
   bootstrapping).  Additionally, the device MUST authenticate the PDS
   to ensure that it is obtaining sensitive profile data from a valid
   PDS.

   To authenticate a device that has been configured with identities and
   credentials, as specified in <a href="#section-5.3.1">Section 5.3.1</a>, and support profiles
   containing sensitive profile data (refer to <a href="#section-5.3.3">Section 5.3.3</a>), devices
   and PDSs MUST support digest authentication (over Transport Layer
   Security (TLS)) as specified in [<a href="rfc3261.html" title='"SIP: Session Initiation Protocol"'>RFC3261</a>].  Future enhancements may



<span class="grey">Petrie &amp; Channabasappa       Standards Track                   [Page 22]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-23" id="page-23" name="page-23"> </a>
<span class="grey"><a href="rfc6080.html">RFC 6080</a>               SIP Configuration Framework            March 2011</span>


   provide other authentication methods such as authentication using
   X.509 certificates.  For the device to authenticate the PDS, the
   device MUST mutually authenticate with the PDS during digest
   authentication (device challenges the PDS, which responds with the
   Authorization header).  Transmission of sensitive profile data also
   requires data integrity.  This can be accomplished by configuring the
   device with, or by ensuring that the discovery process during profile
   enrollment provides, a Session Initiation Protocol Secure (SIPS) URI
   resulting in TLS establishment ([<a href="rfc5246.html" title='"The Transport Layer Security (TLS) Protocol Version 1.2"'>RFC5246</a>]).  TLS also prevents
   offline dictionary attacks when digest authentication is used.  Thus,
   in the absence of TLS, the device MUST NOT respond to any
   authentication challenges.  It is to be noted that the digest
   credentials used for obtaining profile data via this framework may,
   or may not, be the same as those used for SIP registration (see
   <a href="#section-5.3.1">Section 5.3.1</a>).  In addition, while [<a href="rfc3261.html" title='"SIP: Session Initiation Protocol"'>RFC3261</a>] considers MD5 to be a
   reasonable choice to compute the hash, and this may have been true
   when [<a href="rfc3261.html" title='"SIP: Session Initiation Protocol"'>RFC3261</a>] was published, implementers are recommended to use
   stronger alternatives such as SHA-256.  Refer to [<a href="#ref-FIPS-180-3" title='"Secure Hash Standard (SHS)"'>FIPS-180-3</a>] and
   [<a href="rfc4634.html" title='"US Secure Hash Algorithms (SHA and HMAC-SHA)"'>RFC4634</a>] for more information about SHA-256.

   When the PDS challenges a profile enrollment request, and it fails,
   the PDS MAY refuse enrollment or provide profile data without the
   user-specific information (e.g., to bootstrap a device as indicated
   in <a href="#section-5.3.1">Section 5.3.1</a>).  If the device challenges, but fails to
   authenticate the PDS, it MUST reject the initial notification and
   retry the profile enrollment process.  If the device is configured
   with, or discovers, a SIPS URI but TLS establishment fails because
   the next-hop SIP entity does not support TLS, the device SHOULD
   attempt other resolved next-hop SIP entities.  When the device
   establishes TLS with the next-hop entity, the device MUST use the
   procedures specified in <a href="rfc2818.html#section-3.1">[RFC2818], SectionÂ 3.1</a>, for authentication,
   unless it does not have any configured information (e.g.,
   certification authority (CA) certificate) to perform authentication
   (like prior to bootstrapping).  The 'Server Identity' for
   authentication is always the domain of the next-hop SIP entity.  If
   the device attempts validation, and it fails, it MUST reject the
   initial notification and retry profile enrollment.  In the absence of
   a SIPS URI for the device and a mechanism for mutual authentication,
   the PDS MUST NOT present any sensitive profile data in the initial
   notification, except when the device is being bootstrapped.  It MAY
   still use content indirection to transmit sensitive profile data.

   When a device is being provided with bootstrapping profile data
   within the notification, and it contains sensitive information, the
   SIP Identity header SHOULD be used, as specified in [<a href="rfc4474.html" title='"Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP)"'>RFC4474</a>].  This
   helps with devices that MAY be pre-configured with certificates to
   validate bootstrapping sources (e.g., list of allowed domain
   certificates, or a list of root CA certificates using Public Key



<span class="grey">Petrie &amp; Channabasappa       Standards Track                   [Page 23]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-24" id="page-24" name="page-24"> </a>
<span class="grey"><a href="rfc6080.html">RFC 6080</a>               SIP Configuration Framework            March 2011</span>


   Infrastructure (PKI)).  When the SIP Identity header is used, the PDS
   MUST set the host portion of the AoR in the From header to the
   Provider's domain (the user portion is a entity-specific identifier).
   If the device is capable of validating the SIP Identity, and it
   fails, it MUST reject bootstrapping profile data.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.2.2.%20%20Securing%20Content%20Retrieval"></a><a class="selflink" href="#section-5.2.2" name="section-5.2.2">5.2.2</a>.  Securing Content Retrieval</span>

   Initial or change notifications following a successful enrollment can
   provide a device with the requested profile data or use content
   indirection to direct it to a PCC that can provide the profile data.
   This document specifies HTTP and HTTPS as content retrieval
   protocols.

   If the profile is provided via content indirection and contains
   sensitive profile data, then the PDS MUST use a HTTPS URI for content
   indirection.  PCCs and devices MUST NOT use HTTP for sensitive
   profile data, except for bootstrapping a device via the device
   profile.  A device MUST authenticate the PCC as specified in
   <a href="rfc2818.html#section-3.1">[RFC2818], SectionÂ 3.1</a>.  A device that is being provided with profile
   data that contains sensitive data MUST be authenticated using digest
   authentication as specified in [<a href="rfc2617.html" title='"HTTP Authentication: Basic and Digest Access Authentication"'>RFC2617</a>], with the exception of a
   device that is being bootstrapped for the first time via the device
   profile.  The resulting TLS channel also provides data integrity and
   data confidentiality.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.2.3.%20%20Securing%20Change%20Notification"></a><a class="selflink" href="#section-5.2.3" name="section-5.2.3">5.2.3</a>.  Securing Change Notification</span>

   If the device requested enrollment via a SIP subscription with a non-
   zero 'Expires' parameter, it can also result in change notifications
   for the duration of the subscription.  For change notifications
   containing sensitive profile data, this framework RECOMMENDS the use
   of the SIP Identity header as specified in [<a href="rfc4474.html" title='"Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP)"'>RFC4474</a>].  When the SIP
   Identity header is used, the PDS MUST set the host portion of the AoR
   in the From header to the Provider's domain (the user portion is a
   entity-specific identifier).  This provides header and body integrity
   as well.  However, for sensitive profile data requiring data
   confidentiality , if the contact URI to which the NOTIFY request is
   to be sent is not SIPS, the PDS MUST use content indirection.
   Additionally, the PDS MUST also use content indirection for
   notifications containing sensitive profile data, when the profile
   enrollment was not authenticated.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.3.%20%20Additional%20Considerations"></a><a class="selflink" href="#section-5.3" name="section-5.3">5.3</a>.  Additional Considerations</span>

   This section provides additional considerations, such as details on
   how a device obtains identities and credentials, back-off and retry
   methods, guidelines on profile data, and additional profile types.



<span class="grey">Petrie &amp; Channabasappa       Standards Track                   [Page 24]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-25" id="page-25" name="page-25"> </a>
<span class="grey"><a href="rfc6080.html">RFC 6080</a>               SIP Configuration Framework            March 2011</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.3.1.%20%20Bootstrapping%20Identities%20and%20Credentials"></a><a class="selflink" href="#section-5.3.1" name="section-5.3.1">5.3.1</a>.  Bootstrapping Identities and Credentials</span>

   When requesting a profile, the profile delivery server will likely
   require the device to provide an identity (i.e., a user AoR) and
   associated credentials for authentication.  During this process
   (e.g., digest authentication), the PDS is also required to present
   its knowledge of the credentials to ensure mutual authentication (see
   <a href="#section-5.2.1">Section 5.2.1</a>).  For mutual authentication with the PDS, the device
   needs to be provided with the necessary identities and credentials
   (e.g., username/password, certificates).  This is done via
   bootstrapping.  For a discussion around the security considerations
   related to bootstrapping, please see <a href="#section-9.2">Section 9.2</a>.

   Bootstrapping a device with the required identities and credentials
   can be accomplished in one of the following ways:

   Pre-configuration
      The device may be pre-configured with identities and associated
      credentials, such as a user AoR and digest password.

   Out-of-band methods
      A device or Provider may provide hardware- or software-based
      credentials such as Subscriber Identity Module (SIM) cards or
      Universal Serial Bus (USB) drives.

   End-user interface
      The end-user may be provided with the necessary identities and
      credentials.  The end-user can then configure the device (using a
      user interface), or present when required (e.g., IM login screen).

   Using this framework
      When a device is initialized, even if it has no pre-configured
      information, it can request the local-network and device profiles.
      For purposes of bootstrapping, this framework recommends that the
      device profile provide one of the following to bootstrap the
      device:

      *  Profile data that allows the end-user to communicate with the
         device provider or SIP service provider using non-SIP methods.
         For example, the profile data can direct the end-user to a web
         portal to obtain a subscription.  Upon obtaining a successful
         subscription, the end-user or the device can be provided with
         the necessary identities and credentials.








<span class="grey">Petrie &amp; Channabasappa       Standards Track                   [Page 25]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-26" id="page-26" name="page-26"> </a>
<span class="grey"><a href="rfc6080.html">RFC 6080</a>               SIP Configuration Framework            March 2011</span>


      *  Content indirection information to a PCC that can provide
         identities and credentials.  As an example, consider a device
         that has an X.509 certificate that can be authenticated by the
         PCC.  In such a case, the PCC can use HTTPS to provide
         identities and associated credentials.

      *  Profile data containing identities and credentials that can be
         used to bootstrap the device (see <a href="#section-5.3.3">Section 5.3.3</a> for profile
         data recommendations).  This can be used in cases where the
         device is initialized for the first time, or after a factory
         reset.  This can be considered only in cases where the device
         is initialized in the Provider's network, for obvious security
         reasons.

   For interoperability purposes, this framework requires PDSs and
   devices to support the last option (above), which is to use this
   framework.  Specifically, the option of providing identities and
   credentials via the profile data MUST be supported.

   Additionally, AoRs are typically known by PDSs that serve the domain
   indicated by the AoR.  Thus, devices can only present the configured
   AoRs in the respective domains.  An exception is the use of federated
   identities.  This allows a device to use a user's AoR in multiple
   domains.  Further even within the same domain, the device's domain
   proxy and the PDS may be in two different realms, and as such may be
   associated with different credentials for digest authentication.  In
   such cases, multiple credentials may be configured, and associated
   with the realms in which they are to be used.  This framework
   specifies only digest authentication for profile enrollment and the
   device is not expected to contain any other credentials.  For profile
   retrieval using content indirection, the device will need to support
   additional credentials such as X.509 certificates (for TLS).  Future
   enhancements can specify additional credential types for profile
   enrollment and retrieval.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.3.2.%20%20Profile%20Enrollment%20Request%20Attempt"></a><a class="selflink" href="#section-5.3.2" name="section-5.3.2">5.3.2</a>.  Profile Enrollment Request Attempt</span>

   A state diagram representing a device requesting any specific profile
   defined by this framework is shown in Figure 6.












<span class="grey">Petrie &amp; Channabasappa       Standards Track                   [Page 26]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-27" id="page-27" name="page-27"> </a>
<span class="grey"><a href="rfc6080.html">RFC 6080</a>               SIP Configuration Framework            March 2011</span>


                                +------------+
                                | Initialize |
                                +-----+------+
                                      |
                                      |
                                      V
                               +-------------+
                               |   Prepare   |
                    +---------&gt;|  Enrollment |&lt;------------------+
                    |          |   Request   |                   |
                    |          +------+------+                   |
             +------+------+          |                          |
             |   Failure   | Enroll. Req. prepared               |
         +--&gt;|  Handling &amp; |      /Send Req                      |
         |   |   Delay     |          |                          |
         |   +-------------+          V                          |
         |       ^    ^        +-------------+                   |
         |       |    |        |    Await    |                   |
         |       |    +--------+  Enrollment |                   |
         |       |    Timeout, |  acceptance |                   |
         |       |   non-2xx/- +------+------+                   |
         |       |                    |                          |
         |   Timeout            200 OK/-                    Enrollment
         |  /Terminate                |                       Timeout/-
         |   Enrollment               V                          |
         |       |            +--------------+                   |
         |       |            |  Enrollment  |                   |
         |       +------------+   accepted   |                   |
    Retries Exceeded          |(await NOTIFY)|                   |
   /Retry Enrollment          +---+------+---+                   |
         |                        |      |                       |
         |                        |      |                       |
         |   NOTIFY w. Content Ind|      |  NOTIFY w. Profile    |
         |     /Retrieve Profile  |      |  /Accept Profile      |
         |           +------------+      +------------+          |
         |           |                                |          |
         |           V                                V          |
         |     +------------+                   +------------+   |
         +-----+ Retrieving |    Retrieved      | Enrollment +---+
            ,-&gt;|   Profile  +--/Apply Profile--&gt;| Successful |
           /   |            |                   |(monitoring)|&lt;--.
      Timeout  +--+---------+                   +--+----+----+    :
      /Retry      ;      ^                         |    :         ;
           `------'      |   NOTIFY w. Cont.Ind    |    `-------'
                         +---/Retrieve Profile-----+   NOTIFY w. Profile
                                                          /Apply Profile

                      Figure 6: Device State Diagram



<span class="grey">Petrie &amp; Channabasappa       Standards Track                   [Page 27]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-28" id="page-28" name="page-28"> </a>
<span class="grey"><a href="rfc6080.html">RFC 6080</a>               SIP Configuration Framework            March 2011</span>


   As a reminder:

   o  The timeout for SIP messages is specified by [<a href="rfc3261.html" title='"SIP: Session Initiation Protocol"'>RFC3261</a>].  In the
      cases where this is not specified such as the timeout to wait for
      the initial notification during profile enrollment, it is left to
      device implementations or future protocol enhancements.

   o  The timeout for profile retrieval using content indirection will
      be as specified by profile retrieval protocols employed.  If none
      exists, it is left to device implementations.

   In addition, since profile enrollment is a process unique to this
   framework, the device MUST follow the enrollment attempt along with
   exponential back-off and retry mechanisms as indicated in Figure 7.





































<span class="grey">Petrie &amp; Channabasappa       Standards Track                   [Page 28]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-29" id="page-29" name="page-29"> </a>
<span class="grey"><a href="rfc6080.html">RFC 6080</a>               SIP Configuration Framework            March 2011</span>


     Function for Profile Enrollment ()

        Init Function: Iteration i=0

        Loop 1: Attempt

             Loop 2: For each SIP Subscription URI

                  Loop 3: For each next-hop SIP entity

                     - Prepare and transmit Enrollment Request

                     - Await Enrollment Acceptance and initial NOTIFY

                     + If the profile enrollment is successful
                       = Exit this function()

                     + If profile enrollment fails due to an explicit
                       failure or a timeout as specified in [<a href="rfc3261.html" title='"SIP: Session Initiation Protocol"'>RFC3261</a>]
                       = Continue with the next-hop SIP entity (Loop 3)

                  End Loop: Loop 3

             End Loop: Loop 2

             (Note: If you are here, profile enrollment did not succeed)

             + Is any valid cached profile data available?
               = If yes, use it and continue with Loop 1

             + If the enrollment request is for a non-mandatory profile
               = Start profile enrollment for the next profile,
                 if applicable

             - Delay for 2^i*(64*T1); -- this is exponential back-off

             - increment i;

             - If i&gt;8, reset i=8;

       End loop: Loop 1

   End Function()

            Figure 7: Profile Enrollment Attempt (Pseudo-Code)






<span class="grey">Petrie &amp; Channabasappa       Standards Track                   [Page 29]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-30" id="page-30" name="page-30"> </a>
<span class="grey"><a href="rfc6080.html">RFC 6080</a>               SIP Configuration Framework            March 2011</span>


   The pseudo-code above (Figure 7) allows for cached profiles to be
   used.  However, any cached local-network profile MUST NOT be used
   unless the device can ensure that it is in the same local network
   that provided the cached data.  This framework does not provide any
   procedures for local network recognition.  Any cached device and user
   profiles MUST only be used in domains with which they are associated.
   For example, a cached device profile is used only when the associated
   domain matches the current device provider's domain.  If a PDS wants
   to invalidate a profile it may do so by transmitting a NOTIFY with an
   'empty profile', i.e., profile instance without any included data (if
   supported by the profile data model; not to be confused with an empty
   NOTIFY), or via an explicit profile data element that invalidates the
   data.  A device receiving such a NOTIFY MUST discard the applicable
   profile (i.e., it cannot even store it in the cache).  Additionally,
   if a factory reset is available and performed on a device, it MUST
   reset the device to its initial state prior to any configuration.
   Specifically, the device MUST set the device back to the state when
   it was originally distributed.

   The order of profile enrollment is important.  For the profiles
   specified in this framework, the device MUST enroll in the following
   default order: local network, device, and user.  The pseudo-code
   presented earlier (Figure 7) differentiates between 'mandatory' and
   'non-mandatory' profiles.  This distinction is left to profile data
   definitions.

   It is to be noted that this framework does not allow the devices to
   inform the PDSs of profile retrieval errors such as invalid data.
   Follow-on standardization activities are expected to address this
   feature.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.3.3.%20%20Profile%20Data"></a><a class="selflink" href="#section-5.3.3" name="section-5.3.3">5.3.3</a>.  Profile Data</span>

   This framework does not specify the contents for any profile type.
   Follow-on standardization activities are expected to address profile
   contents.  However, the framework provides the following requirements
   and recommendations for profile data definitions:

   o  The device profile type SHOULD specify parameters to configure the
      identities and credentials for use in scenarios such as
      bootstrapping (see <a href="#section-5.3.1">Section 5.3.1</a>) and run-time modifications to
      identities and credentials.  This framework recommends the device
      profile provide the identities and credentials due to a couple of
      reasons.  The local-network profile may not always be available,
      and even if present, may not be controlled by the device provider
      who controls device configuration to provide services.  Further,
      the device may not have any users configured prior to being
      bootstrapped, resulting in an absence of user profile requests.



<span class="grey">Petrie &amp; Channabasappa       Standards Track                   [Page 30]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-31" id="page-31" name="page-31"> </a>
<span class="grey"><a href="rfc6080.html">RFC 6080</a>               SIP Configuration Framework            March 2011</span>


      However, this framework does not prevent other profile types from
      providing identities and credentials to meet deployment needs.
      For example, the user profile can contain identities and
      credentials for communicating with specific applications.

   o  Each profile MUST clearly identify if it may contain any sensitive
      data.  Such profiles MUST also identify the data elements that are
      considered sensitive, i.e., data that cannot be disclosed to
      unauthorized parties.  As an example, a device profile definition
      may identify itself as containing sensitive data and indicate data
      such as device credentials to be sensitive.

   o  When the device receives multiple profiles, the contents of each
      profile type SHOULD only contain data relevant to the entity it
      represents.  As an example, consider a device that obtains all the
      defined profiles.  Information pertaining to the local network is
      contained in the 'local-network' profile and not the 'user'
      profile.  This does not preclude relevant data about a different
      entity from being included in a profile type, e.g., the 'device'
      profile type may contain information about the users allowed to
      access services via the device.  A profile may also contain
      starting information to obtain subsequent profiles.

   o  Data overlap SHOULD be avoided across profile types, unless
      necessary.  If data overlap is present, prioritization of the data
      is left to data definitions.  As an example, the device profile
      may contain the list of codecs to be used by the device and the
      user profile (for a user on the device) may contain the codecs
      preferred by the user.  Thus, the same data (usable codecs) is
      present in two profiles.  However, the data definitions may
      indicate that, to function effectively, any codec chosen for
      communication needs to be present in both the profiles.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.3.4.%20%20Profile%20Data%20Frameworks"></a><a class="selflink" href="#section-5.3.4" name="section-5.3.4">5.3.4</a>.  Profile Data Frameworks</span>

   The framework specified in this document does not address profile
   data representation, storage, or retrieval protocols.  It assumes
   that the PDS has a PCC based on existing or other Profile Data
   Frameworks.

   While this framework does not impose specific constraints on any such
   framework, it does allow for the propagation of profile content to
   the PDS (specifically the PCC).  Thus, Profile Data Frameworks or
   retrieval frameworks used in conjunction with this framework MAY
   consider techniques for propagating incremental, atomic changes to
   the PDS.  One means for propagating changes to a PDS is XML
   Configuration Access Protocol (XCAP) ([<a href="rfc4825.html" title='"The Extensible Markup Language (XML) Configuration Access Protocol (XCAP)"'>RFC4825</a>]).




<span class="grey">Petrie &amp; Channabasappa       Standards Track                   [Page 31]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-32" id="page-32" name="page-32"> </a>
<span class="grey"><a href="rfc6080.html">RFC 6080</a>               SIP Configuration Framework            March 2011</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.3.5.%20%20Additional%20Profile%20Types"></a><a class="selflink" href="#section-5.3.5" name="section-5.3.5">5.3.5</a>.  Additional Profile Types</span>

   This document specifies three profile types: local-network, device,
   and user.  However, there may be use cases for additional profile
   types. e.g., profile types for application specific profile data or
   to provide enterprise-specific policies.  Definition of such
   additional profile types is not prohibited, but considered out of
   scope for this document.  Such profile definitions MUST specify the
   order of retrieval with respect to all the other profiles such as the
   local-network, device, and user profile types defined in this
   document.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/5.3.6.%20%20Deployment%20Considerations"></a><a class="selflink" href="#section-5.3.6" name="section-5.3.6">5.3.6</a>.  Deployment Considerations</span>

   The framework defined in this document was designed to address
   various deployment considerations, some of which are highlighted
   below.

   Provider relationships:

   o  The local network provider and the SIP service provider can often
      be different entities, with no administrative or business
      relationship with each other.

   o  There may be multiple SIP service providers involved, one for each
      service to which a user subscribes (telephony service, instant
      messaging, etc.); this framework does not specify explicit
      behavior in such a scenario, but it does not prohibit its usage
      either.

   o  Each user accessing services via the same device may subscribe to
      different sets of services, from different service providers.

   User-device relationship:

   o  The relationship between devices and users can be many-to-many
      (e.g., a particular device may allow for many users to obtain
      subscription services through it, and individual users may have
      access to multiple devices).

   o  Each user may have different preferences for use of services, and
      presentation of those services in the device user interface.

   o  Each user may have different personal information applicable to
      use of the device, either as related to particular services, or
      independent of them.





<span class="grey">Petrie &amp; Channabasappa       Standards Track                   [Page 32]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-33" id="page-33" name="page-33"> </a>
<span class="grey"><a href="rfc6080.html">RFC 6080</a>               SIP Configuration Framework            March 2011</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.4.%20%20Support%20for%20NATs"></a><a class="selflink" href="#section-5.4" name="section-5.4">5.4</a>.  Support for NATs</span>

   PDSs that support devices behind NATs, and devices that can be behind
   NATs can use procedures specified in [<a href="rfc5626.html" title='"Managing Client- Initiated Connections in the Session Initiation Protocol (SIP)"'>RFC5626</a>].  The Outbound proxies
   can be configured or discovered.  Clients that support such behavior
   MUST include the 'outbound' option-tag in a Supported header field
   value, and add the "ob" parameter, as specified in [<a href="rfc5626.html" title='"Managing Client- Initiated Connections in the Session Initiation Protocol (SIP)"'>RFC5626</a>], within
   the SIP SUBSCRIBE for profile enrollment.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20Event%20Package%20Definition"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  Event Package Definition</span>

   The framework specified in this document proposes and specifies a new
   SIP event package, as allowed by [<a href="rfc3265.html" title='"Session Initiation Protocol (SIP)-Specific Event Notification"'>RFC3265</a>].  The purpose is to allow
   for devices to subscribe to specific profile types with PDSs and for
   the PDSs to notify the devices with the profile data or content
   indirection information.

   The requirements specified in [<a href="rfc3265.html" title='"Session Initiation Protocol (SIP)-Specific Event Notification"'>RFC3265</a>] apply to this package.  The
   following subsections specify the event package description and the
   associated requirements.  The framework requirements are defined in
   <a href="#section-5">Section 5</a>.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.1.%20%20Event%20Package%20Name"></a><a class="selflink" href="#section-6.1" name="section-6.1">6.1</a>.  Event Package Name</span>

   The name of this package is "ua-profile".  This value appears in the
   Event header field present in SUBSCRIBE and NOTIFY requests for this
   package, as defined in [<a href="rfc3265.html" title='"Session Initiation Protocol (SIP)-Specific Event Notification"'>RFC3265</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.2.%20%20Event%20Package%20Parameters"></a><a class="selflink" href="#section-6.2" name="section-6.2">6.2</a>.  Event Package Parameters</span>

   This package defines the following new parameters for the event
   header:

      "profile-type", "vendor", "model", "version", and "effective-by"

   The following rules apply:

   o  All the new parameters, with the exception of the "effective-by"
      parameter, MUST only be used in SUBSCRIBE requests and ignored if
      they appear in NOTIFY requests.

   o  The "effective-by" parameter is for use in NOTIFY requests only
      and MUST be ignored if it appears in SUBSCRIBE requests.

   The semantics of these new parameters are specified in the following
   subsections.





<span class="grey">Petrie &amp; Channabasappa       Standards Track                   [Page 33]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-34" id="page-34" name="page-34"> </a>
<span class="grey"><a href="rfc6080.html">RFC 6080</a>               SIP Configuration Framework            March 2011</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/6.2.1.%20%20%22profile-type%22%20Parameter"></a><a class="selflink" href="#section-6.2.1" name="section-6.2.1">6.2.1</a>.  "profile-type" Parameter</span>

   The "profile-type" parameter is used to indicate the token name of
   the profile type the user agent wishes to obtain and to be notified
   of subsequent changes.  This document defines three logical types of
   profiles and their token names.  They are as follows:

   local-network:  specifying the "local-network" type profile indicates
      the desire for profile data, and potentially, profile change
      notifications specific to the local network.

   device:  specifying the "device" type profile(s) indicates the desire
      for the profile data, and potentially, profile change notification
      that is specific to the device or user agent.

   user:  specifying the "user" type profile indicates the desire for
      the profile data, and potentially, profile change notification
      specific to the user.

   The profile type is identified in the Event header parameter:
   "profile-type".  A separate SUBSCRIBE dialog is used for each profile
   type.  Thus, the subscription dialog on which a NOTIFY arrives
   implies which profile's data is contained in, or referred to, by the
   NOTIFY message body.  The Accept header of the SUBSCRIBE request MUST
   include the MIME types for all profile content types for which the
   subscribing user agent wishes to retrieve profiles, or receive change
   notifications.

   In the following syntax definition using ABNF, EQUAL and token are
   defined in [<a href="rfc3261.html" title='"SIP: Session Initiation Protocol"'>RFC3261</a>].  It is to be noted that additional profile
   types may be defined in subsequent documents.

   Profile-type   = "profile-type" EQUAL profile-value
   profile-value  =  profile-types / token
   profile-types  = "device" / "user" / "local-network"

   The "device", "user", or "local-network" token in the profile-type
   parameter may represent a class or set of profile properties.
   Follow-on standards defining specific profile contents may find it
   desirable to define additional tokens for the profile-type parameter.
   Also, additional content types may be defined along with the profile
   formats that can be used in the Accept header of the SUBSCRIBE to
   filter or indicate what data sets of the profile are desired.








<span class="grey">Petrie &amp; Channabasappa       Standards Track                   [Page 34]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-35" id="page-35" name="page-35"> </a>
<span class="grey"><a href="rfc6080.html">RFC 6080</a>               SIP Configuration Framework            March 2011</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/6.2.2.%20%20%22vendor%22%2C%20%22model%22%2C%20and%20%22version%22%20Parameters"></a><a class="selflink" href="#section-6.2.2" name="section-6.2.2">6.2.2</a>.  "vendor", "model", and "version" Parameters</span>

   The "vendor", "model", and "version" parameter values are tokens
   specified by the implementer of the user agent.  These parameters
   MUST be provided in the SUBSCRIBE request for all profile types.  The
   implementer SHOULD use their DNS domain name (e.g., example.com) as
   the value of the "vendor" parameter so that it is known to be unique,
   unless there is a good reason not to.  Examples of exceptions
   include: if the vendor does not have an assigned DNS domain name, if
   they are using a different vendor's implementation, etc.  These
   parameters are useful to the PDS to affect the profiles provided.  In
   some scenarios, it is desirable to provide different profiles based
   upon these parameters.  For example, feature property X in a profile
   may work differently on two versions of the same user agent.  This
   gives the PDS the ability to compensate for or take advantage of the
   differences.  In the following ABNF defining the syntax, EQUAL and
   quoted-string are defined in [<a href="rfc3261.html" title='"SIP: Session Initiation Protocol"'>RFC3261</a>].

   Vendor       =  "vendor" EQUAL quoted-string
   Model        =  "model" EQUAL quoted-string
   Version      =  "version" EQUAL quoted-string

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/6.2.3.%20%20%22effective-by%22%20Parameter"></a><a class="selflink" href="#section-6.2.3" name="section-6.2.3">6.2.3</a>.  "effective-by" Parameter</span>

   The "effective-by" parameter in the Event header of the NOTIFY
   request specifies the maximum number of seconds before the user agent
   MUST attempt to make the new profile effective.  The "effective-by"
   parameter MAY be provided in the NOTIFY request for any of the
   profile types.  A value of 0 (zero) indicates that the subscribing
   user agent MUST attempt to make the profiles effective immediately
   (despite possible service interruptions).  This gives the PDS the
   power to control when the profile is effective.  This may be
   important to resolve an emergency problem or disable a user agent
   immediately.  If it is absent, the device SHOULD attempt to make the
   profile data effective at the earliest possible opportunity that does
   not disrupt any services being offered.  The "effective-by" parameter
   is ignored in all messages other than the NOTIFY request.  In the
   following ABNF, EQUAL and DIGIT are defined in [<a href="rfc3261.html" title='"SIP: Session Initiation Protocol"'>RFC3261</a>].

   Effective-By =  "effective-by" EQUAL 1*DIGIT

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/6.2.4.%20%20Summary%20of%20Event%20Parameters"></a><a class="selflink" href="#section-6.2.4" name="section-6.2.4">6.2.4</a>.  Summary of Event Parameters</span>

   The following are example Event headers that may occur in SUBSCRIBE
   requests.  These examples are not intended to be complete SUBSCRIBE
   requests.





<span class="grey">Petrie &amp; Channabasappa       Standards Track                   [Page 35]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-36" id="page-36" name="page-36"> </a>
<span class="grey"><a href="rfc6080.html">RFC 6080</a>               SIP Configuration Framework            March 2011</span>


   Event: ua-profile;profile-type=device;
          vendor="vendor.example.com";model="Z100";version="1.2.3"

   Event: ua-profile;profile-type=user;
          vendor="premier.example.com";model="trs8000";version="5.5"

   The following are example Event headers that may occur in NOTIFY
   requests.  These example headers are not intended to be complete
   SUBSCRIBE requests.

   Event: ua-profile;effective-by=0

   Event: ua-profile;effective-by=3600

   The following table shows the use of Event header parameters in
   SUBSCRIBE requests for the three profile types:

   profile-type || device | user | local-network
   =============================================
   vendor       ||   m    |  m   |        m
   model        ||   m    |  m   |        m
   version      ||   m    |  m   |        m
   effective-by ||        |      |

   m - MUST be provided
   s - SHOULD be provided
   o - OPTIONAL to be provided

   Non-specified means that the parameter has no meaning and should be
   ignored.

   The following table shows the use of Event header parameters in
   NOTIFY requests for the three profile types:

   profile-type || device | user | local-network
   =============================================
   vendor       ||        |      |
   model        ||        |      |
   version      ||        |      |
   effective-by ||   o    |  o   |        o

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.3.%20%20SUBSCRIBE%20Bodies"></a><a class="selflink" href="#section-6.3" name="section-6.3">6.3</a>.  SUBSCRIBE Bodies</span>

   This package defines no use of the SUBSCRIBE request body.  If
   present, it SHOULD be ignored.  Exceptions include future
   enhancements to the framework that may specify a use for the
   SUBSCRIBE request body.




<span class="grey">Petrie &amp; Channabasappa       Standards Track                   [Page 36]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-37" id="page-37" name="page-37"> </a>
<span class="grey"><a href="rfc6080.html">RFC 6080</a>               SIP Configuration Framework            March 2011</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.4.%20%20Subscription%20Duration"></a><a class="selflink" href="#section-6.4" name="section-6.4">6.4</a>.  Subscription Duration</span>

   The duration of a subscription is specific to SIP deployments, and no
   specific recommendation is made by this event package.  If absent, a
   value of 86400 seconds (24 hours; 1 day) is RECOMMENDED since the
   presence (or absence) of a device subscription is not time critical
   to the regular functioning of the PDS.

   It is to be noted that a one-time fetch of a profile, without ongoing
   subscription, can be accomplished by setting the 'Expires' parameter
   to a value of Zero, as specified in [<a href="rfc3265.html" title='"Session Initiation Protocol (SIP)-Specific Event Notification"'>RFC3265</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.5.%20%20NOTIFY%20Bodies"></a><a class="selflink" href="#section-6.5" name="section-6.5">6.5</a>.  NOTIFY Bodies</span>

   The framework specifying the event package allows for the NOTIFY body
   to contain the profile data, or a pointer to the profile data using
   content indirection.  For profile data delivered via content
   indirection, i.e., a pointer to a PCC, then the Content-ID MIME
   header, as described in [<a href="rfc4483.html" title='"A Mechanism for Content Indirection in Session Initiation Protocol (SIP) Messages"'>RFC4483</a>], MUST be used for each profile
   document URI.  At a minimum, the "http:" [<a href="rfc2616.html" title='"Hypertext Transfer Protocol -- HTTP/1.1"'>RFC2616</a>] and "https:"
   [<a href="rfc2818.html" title='"HTTP Over TLS"'>RFC2818</a>] URI schemes MUST be supported; other URI schemes MAY be
   supported based on the Profile Data Frameworks (examples include FTP
   [<a href="http://tools.ietf.org/html/rfc0959" title='"File Transfer Protocol"'>RFC0959</a>], Lightweight Directory Access Protocol (LDAP) [<a href="rfc4510.html" title='"Lightweight Directory Access Protocol (LDAP): Technical Specification Road Map"'>RFC4510</a>],
   and XCAP [<a href="rfc4825.html" title='"The Extensible Markup Language (XML) Configuration Access Protocol (XCAP)"'>RFC4825</a>] ).

   A non-empty NOTIFY body MUST include a MIME type specified in the
   Accept header of the SUBSCRIBE.  Further, if the Accept header of the
   SUBSCRIBE included the MIME type message/external-body (indicating
   support for content indirection) then the PDS MAY use content
   indirection in the NOTIFY body for providing the profiles.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.6.%20%20Notifier%20Processing%20of%20SUBSCRIBE%20Requests"></a><a class="selflink" href="#section-6.6" name="section-6.6">6.6</a>.  Notifier Processing of SUBSCRIBE Requests</span>

   A successful SUBSCRIBE request results in a NOTIFY with either
   profile contents or a pointer to it (via content indirection).  The
   SUBSCRIBE SHOULD be either authenticated or transmitted over an
   integrity protected SIP communications channel.  Exceptions include
   cases where the identity of the Subscriber is unknown and the
   Notifier is configured to accept such requests.

   The Notifier MAY also authenticate SUBSCRIBE messages even if the
   NOTIFY is expected to only contain a pointer to profile data.
   Securing data sent via content indirection is covered in <a href="#section-9">Section 9</a>.

   If the profile type indicated in the "profile-type" Event header
   parameter is unavailable or the Notifier is configured not to provide
   it, the Notifier SHOULD return a 404 response to the SUBSCRIBE




<span class="grey">Petrie &amp; Channabasappa       Standards Track                   [Page 37]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-38" id="page-38" name="page-38"> </a>
<span class="grey"><a href="rfc6080.html">RFC 6080</a>               SIP Configuration Framework            March 2011</span>


   request.  If the specific user or device is unknown, the Notifier MAY
   accept the subscription, or else it may reject the subscription (with
   a 403 response).

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.7.%20%20Notifier%20Generation%20of%20NOTIFY%20Requests"></a><a class="selflink" href="#section-6.7" name="section-6.7">6.7</a>.  Notifier Generation of NOTIFY Requests</span>

   As specified in [<a href="rfc3265.html" title='"Session Initiation Protocol (SIP)-Specific Event Notification"'>RFC3265</a>], the Notifier MUST always send a NOTIFY
   request upon accepting a subscription.  If the device or user is
   unknown and the Notifier chooses to accept the subscription, the
   Notifier MAY either respond with profile data (e.g., default profile
   data) or provide no profile information (i.e., empty NOTIFY).

   If the identity indicated in the SUBSCRIBE request (From header) is a
   known identity and the requested profile information is available
   (i.e., as specified in the "profile-type" parameter of the Event
   header), the Notifier SHOULD send a NOTIFY with profile data.
   Profile data MAY be sent as profile contents or via content
   indirection (if the content indirection MIME type was included in the
   Accept header).  The Notifier MUST NOT use any scheme that was not
   indicated in the "schemes" Contact header field.

   The Notifier MAY specify when the new profiles must be made effective
   by the Subscriber by specifying a maximum time in seconds (zero or
   more) in the "effective-by" Event header parameter.

   If the SUBSCRIBE was received over an integrity protected SIP
   communications channel, the Notifier SHOULD send the NOTIFY over the
   same channel.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.8.%20%20Subscriber%20Processing%20of%20NOTIFY%20Requests"></a><a class="selflink" href="#section-6.8" name="section-6.8">6.8</a>.  Subscriber Processing of NOTIFY Requests</span>

   A Subscriber to this event package MUST adhere to the NOTIFY request
   processing behavior specified in [<a href="rfc3265.html" title='"Session Initiation Protocol (SIP)-Specific Event Notification"'>RFC3265</a>].  If the Notifier
   indicated an effective time (using the "effective-by" Event header
   parameter), the Subscriber SHOULD attempt to make the profiles
   effective within the specified time.  Exceptions include deployments
   that prohibit such behavior in certain cases (e.g., emergency
   sessions are in progress).  When profile data cannot be applied
   within the recommended time frame and this affects device behavior,
   any actions to be taken SHOULD be defined by the profile data
   definitions.  By default, the Subscriber is RECOMMENDED to make the
   profiles effective as soon as possible.

   When accepting content indirection, the Subscriber MUST always
   support "http:" or "https:" and be prepared to accept NOTIFY messages
   with those URI schemes.  If the Subscriber wishes to support
   alternative URI schemes they MUST each be indicated in the "schemes"
   Contact header field parameter as defined in [<a href="rfc4483.html" title='"A Mechanism for Content Indirection in Session Initiation Protocol (SIP) Messages"'>RFC4483</a>].  The



<span class="grey">Petrie &amp; Channabasappa       Standards Track                   [Page 38]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-39" id="page-39" name="page-39"> </a>
<span class="grey"><a href="rfc6080.html">RFC 6080</a>               SIP Configuration Framework            March 2011</span>


   Subscriber MUST also be prepared to receive a NOTIFY request with no
   body.  The subscriber MUST NOT reject the NOTIFY request with no
   body.  The subscription dialog MUST NOT be terminated by a empty
   NOTIFY, i.e., with no body.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.9.%20%20Handling%20of%20Forked%20Requests"></a><a class="selflink" href="#section-6.9" name="section-6.9">6.9</a>.  Handling of Forked Requests</span>

   This event package allows the creation of only one dialog as a result
   of an initial SUBSCRIBE request as described in <a href="rfc3265.html#section-4.4.9">SectionÂ 4.4.9 of
   [RFC3265]</a>.  It does not support the creation of multiple
   subscriptions using forked SUBSCRIBE requests.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.10.%20%20Rate%20of%20Notifications"></a><a class="selflink" href="#section-6.10" name="section-6.10">6.10</a>.  Rate of Notifications</span>

   The rate of notifications for the profiles in this framework is
   deployment specific, but expected to be infrequent.  Hence, the event
   package specification does not specify a throttling or minimum period
   between NOTIFY requests.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.11.%20%20State%20Agents"></a><a class="selflink" href="#section-6.11" name="section-6.11">6.11</a>.  State Agents</span>

   State agents are not applicable to this event package.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20Examples"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  Examples</span>

   This section provides examples along with sample SIP message bodies
   relevant to this framework.  Both the examples are derived from the
   use case illustrated in <a href="#section-4.1">Section 4.1</a>, specifically the request for the
   device profile.  The examples are informative only.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.1.%20%20Example%201%3A%20Device%20Requesting%20Profile"></a><a class="selflink" href="#section-7.1" name="section-7.1">7.1</a>.  Example 1: Device Requesting Profile</span>

   This example illustrates the detailed message flows between the
   device and the SIP service provider's network for requesting and
   retrieving the profile (the flow uses the device profile as an
   example).

   The following are assumed for this example:

   o  Device is assumed to have established local network connectivity;
      NAT and firewall considerations are assumed to have been addressed
      by the SIP service provider.

   o  Examples are snapshots only and do not illustrate all the
      interactions between the device and the service provider's network
      (and none between the entities in the SIP service provider's
      network).




<span class="grey">Petrie &amp; Channabasappa       Standards Track                   [Page 39]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-40" id="page-40" name="page-40"> </a>
<span class="grey"><a href="rfc6080.html">RFC 6080</a>               SIP Configuration Framework            March 2011</span>


   o  All SIP communication with the SIP service provider happens via a
      SIP proxy.

   o  HTTP over TLS is assumed to be the Content Retrieval method used
      (any suitable alternative can be used as well).

   The flow diagram and an explanation of the messages follow.

                                      +----------------------+
    +--------+                        | SIP Service Provider |
    | Device |                        |                      |
    |(SIP UA)|                        |  SIP     PDS   HTTP  |
    +--------+                        | PROXY         Server |
                                      |                      |
                                      +----------------------+
         |                                |       |      |
         |                                |       |      |
         |          SUBSCRIBE             |       |      |
   (SReq)|--------device profile---------&gt;|       |      |
         |                                |------&gt;|      |
         |                                |200 OK |      |
         |            200 OK              |&lt;------|      |
   (SRes)|&lt;-------------------------------|       |      |
         |                                |       |      |
         |                                | NOTIFY|      |
         |    NOTIFY (Content Indirection)|&lt;------|      |
   (NTFY)|&lt;-------------------------------|       |      |
         |            200 OK              |       |      |
   (NRes)|-------------------------------&gt;|200 OK |      |
         |                                |------&gt;|      |
         |                                               |
         |                                               |
         |                                               |
         |&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;  TLS establishment  &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;|
         |                                               |
         |                HTTP Request                   |
   (XReq)|----------------------------------------------&gt;|
         |                                               |
         |                HTTP Response                  |
   (XRes)|&lt;----------------------------------------------|
         |                                               |










<span class="grey">Petrie &amp; Channabasappa       Standards Track                   [Page 40]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-41" id="page-41" name="page-41"> </a>
<span class="grey"><a href="rfc6080.html">RFC 6080</a>               SIP Configuration Framework            March 2011</span>


   (SReq)
      the device transmits a request for the 'device' profile using the
      SIP SUBSCRIBE utilizing the event package specified in this
      framework.

      *  Note: Some of the header fields (e.g., SUBSCRIBE, Event, Via)
         are continued on a separate line due to format constraints of
         this document.

   SUBSCRIBE sip:urn%3auuid%3a00000000-0000-1000-0000-00FF8D82EDCB
             @example.com  SIP/2.0
   Event: ua-profile;profile-type=device;vendor="vendor.example.net";
          model="Z100";version="1.2.3"
   From: anonymous@example.com;tag=1234
   To: sip:urn%3auuid%3a00000000-0000-1000-0000-00FF8D82EDCB@example.com
   Call-ID: 3573853342923422@192.0.2.44
   CSeq: 2131 SUBSCRIBE
   Contact: sip:urn%3auuid%3a00000000-0000-1000-0000-00FF8D82EDCB
      @192.168.1.44
      ;+sip.instance="&lt;urn:uuid:00000000-0000-0000-0000-123456789AB0&gt;"
      ;schemes="http,https"
   Via: SIP/2.0/TCP 192.0.2.41;
     branch=z9hG4bK6d6d35b6e2a203104d97211a3d18f57a
   Accept: message/external-body, application/x-z100-device-profile
   Content-Length: 0

   (SRes)  the SUBSCRIBE request is received by a SIP proxy in the
      service provider's network, which transmits it to the PDS.  The
      PDS accepts the response and responds with a 200 OK.

      *  Note: The device and the SIP proxy may have established a
         secure communications channel (e.g., TLS).

   (NTFY)  subsequently, the PDS transmits a SIP NOTIFY message
      indicating the profile location.

      *  Note: Some of the fields (e.g., content-type) are continued on
         a separate line due to format constraints of this document.













<span class="grey">Petrie &amp; Channabasappa       Standards Track                   [Page 41]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-42" id="page-42" name="page-42"> </a>
<span class="grey"><a href="rfc6080.html">RFC 6080</a>               SIP Configuration Framework            March 2011</span>


 NOTIFY sip:urn%3auuid%3a00000000-0000-1000-0000-00FF8D82EDCB
        @192.168.1.44 SIP/2.0
 Event: ua-profile;effective-by=3600
 From: sip:urn%3auuid%3a00000000-0000-1000-0000-00FF8D82EDCB@example.com
       ;tag=abca
 To: sip:urn%3auuid%3a00000000-0000-1000-0000-00FF8D82EDCB@example.com
     ;tag=1234
 Call-ID: 3573853342923422@192.0.2.44
 CSeq: 322 NOTIFY
 Via: SIP/2.0/UDP 192.0.2.3;
   branch=z9hG4bK1e3effada91dc37fd5a0c95cbf6767d0
 MIME-Version: 1.0
 Content-Type: message/external-body; access-type="URL";
               expiration="Mon, 01 Jan 2010 09:00:00 UTC";
               URL="http://example.com/z100-000000000000.html";
               size=9999;
               hash=10AB568E91245681AC1B

 Content-Type: application/x-z100-device-profile
 Content-ID: &lt;39EHF78SA@example.com&gt;
 .
 .
 .

   (NRes)  Device accepts the NOTIFY message and responds with a 200 OK.

   (XReq)  once the necessary secure communications channel is
      established, the device sends an HTTP request to the HTTP server
      indicated in the NOTIFY.

   (XRes)  the HTTP server responds to the request via a HTTP response
      containing the profile contents.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.2.%20%20Example%202%3A%20Device%20Obtaining%20Change%20Notification"></a><a class="selflink" href="#section-7.2" name="section-7.2">7.2</a>.  Example 2: Device Obtaining Change Notification</span>

   The following example illustrates the case where a user (X) is
   simultaneously accessing services via two different devices (e.g.,
   multimedia entities on a PC and PDA) and has access to a user
   interface that allows for changes to the user profile.

   The following are assumed for this example:

   o  The devices (A &amp; B) obtain the necessary profiles from the same
      SIP service provider.

   o  The SIP service provider also provides a user interface that
      allows the user to change preferences that impact the user
      profile.



<span class="grey">Petrie &amp; Channabasappa       Standards Track                   [Page 42]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-43" id="page-43" name="page-43"> </a>
<span class="grey"><a href="rfc6080.html">RFC 6080</a>               SIP Configuration Framework            March 2011</span>


   The flow diagram and an explanation of the messages follow.

   o  Note: The example only shows retrieval of user X's profile, but it
      may request and retrieve other profiles (e.g., local-network,
      device).

               -----           -----
              |User |_________| UI* | * = User Interface
              |  X  |         |     |
               -----           -----
             /       \
            /         \
           /           \              +----------------------+
    +--------+      +--------+        | SIP Service Provider |
    | Device |      | Device |        |                      |
    |    A   |      |    B   |        |  SIP     PDS   HTTP  |
    +--------+      +--------+        | PROXY         Server |
                                      +----------------------+
         |                                |       |      |
         |                                |       |      |
   (A-EX)|&lt;=Enrolls for User X's profile=&gt;|&lt;=====&gt;|      |
         |                                |       |      |
         |                                               |
   (A-RX)|&lt;===Retrieves User X's profile================&gt;|
         |                                               |
         |               |                |       |      |
         |               |  Enrolls for   |       |      |
         |         (B-EX)|&lt;== User X's ==&gt;|&lt;=====&gt;|      |
         |               |    profile     |       |      |
         |               |                |       |      |
         |               |                               |
         |         (B-RX)|&lt;= Retrieves User X's profile=&gt;|
         |                                               |
         |                       |                       |
         |                 (HPut)|----------------------&gt;|
         |                       |                       |
         |                 (HRes)|&lt;----------------------|
         |                                               |
         |                                |       |      |
         |                                | NOTIFY|      |
         |            NOTIFY              |&lt;------|      |
   (A-NT)|&lt;-------------------------------|       |      |
         |            200 OK              |       |      |
   (A-RS)|-------------------------------&gt;|200 OK |      |
         |                                |------&gt;|      |






<span class="grey">Petrie &amp; Channabasappa       Standards Track                   [Page 43]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-44" id="page-44" name="page-44"> </a>
<span class="grey"><a href="rfc6080.html">RFC 6080</a>               SIP Configuration Framework            March 2011</span>


         |                                               |
         |               |                | NOTIFY|      |
         |               |    NOTIFY      |&lt;------|      |
         |         (B-NT)|&lt;---------------|       |      |
         |               |    200 OK      |       |      |
         |         (B-RS)|---------------&gt;|200 OK |      |
         |               |                |------&gt;|      |
         |                                               |
         |                                               |
   (A-RX)|&lt;===Retrieves User X's profile================&gt;|
         |                                               |
         |               |                               |
         |               |                               |
         |         (B-RX)|&lt;= Retrieves User X's profile=&gt;|
         |               |                               |

   (A-EX)   Device A discovers, enrolls, and obtains notification
            related to user X's profile.

   (A-RX)   Device A retrieves user X's profile.

   (B-EX)   Device B discovers, enrolls, and obtains notification
            related to user X's profile.

   (B-RX)   Device B retrieves user X's profile.

   (HPut)   Changes affected by the user via the user interface are
            uploaded to the HTTP server.

            *  Note: The Unique Identifier (UI) itself can act as a
               device and subscribe to user X's profile.  This is not
               the case in the example shown.

   (HRes)   Changes are accepted by the HTTP server.

   (A-NT)   PDS transmits a NOTIFY message to device A indicating the
            changed profile.  A sample message is shown below:

            *  Note: Some of the fields (e.g., Via) are continued on a
               separate line due to format constraints of this document.











<span class="grey">Petrie &amp; Channabasappa       Standards Track                   [Page 44]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-45" id="page-45" name="page-45"> </a>
<span class="grey"><a href="rfc6080.html">RFC 6080</a>               SIP Configuration Framework            March 2011</span>


   NOTIFY sip:userX@192.0.2.44 SIP/2.0
   Event: ua-profile;effective-by=3600
   From: sip:userX@sip.example.net;tag=abcd
   To: sip:userX@sip.example.net.net;tag=1234
   Call-ID: 3573853342923422@192.0.2.44
   CSeq: 322 NOTIFY
   Via: SIP/2.0/UDP 192.0.2.3;
     branch=z9hG4bK1e3effada91dc37fd5a0c95cbf6767d1
   MIME-Version: 1.0
   Content-Type: message/external-body; access-type="URL";
                 expiration="Mon, 01 Jan 2010 09:00:00 UTC";
                 URL="http://www.example.com/user-x-profile.html";
                 size=9999;
                 hash=123456789AAABBBCCCDD
   .
   .
   .

   (A-RS)   Device A accepts the NOTIFY and sends a 200 OK.

   (B-NT)   PDS transmits a NOTIFY message to device B indicating the
            changed profile.  A sample message is shown below:

            *  Note: Some of the fields (e.g., Via) are continued on a
               separate line due to format constraints of this document.

   NOTIFY sip:userX@192.0.2.43 SIP/2.0
   Event: ua-profile;effective-by=3600
   From: sip:userX@sip.example.net;tag=abce
   To: sip:userX@sip.example.net.net;tag=1234
   Call-ID: 3573853342923422@192.0.2.43
   CSeq: 322 NOTIFY
   Via: SIP/2.0/UDP 192.0.2.3;
     branch=z9hG4bK1e3effada91dc37fd5a0c95cbf6767d2
   MIME-Version: 1.0
   Content-Type: message/external-body; access-type="URL";
                 expiration="Mon, 01 Jan 2010 09:00:00 UTC";
                 URL="http://www.example.com/user-x-profile.html";
                 size=9999;
                 hash=123456789AAABBBCCCDD
   .
   .
   .

   (B-RS)   Device B accepts the NOTIFY and sends a 200 OK.

   (A-RX)   Device A retrieves the updated profile pertaining to user X.




<span class="grey">Petrie &amp; Channabasappa       Standards Track                   [Page 45]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-46" id="page-46" name="page-46"> </a>
<span class="grey"><a href="rfc6080.html">RFC 6080</a>               SIP Configuration Framework            March 2011</span>


   (B-RX)   Device B retrieves the updated profile pertaining to user X.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  IANA Considerations</span>

   IANA has registered a SIP event package, event header parameters, and
   SIP configuration profile types as outlined in the following
   subsections.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.1.%20%20SIP%20Event%20Package"></a><a class="selflink" href="#section-8.1" name="section-8.1">8.1</a>.  SIP Event Package</span>

   This specification registers a new event package as defined in
   [<a href="rfc3265.html" title='"Session Initiation Protocol (SIP)-Specific Event Notification"'>RFC3265</a>].  The registration is as follows:

   Package Name:  ua-profile

   Package or Template-Package:  This is a package

   Published Document:  <a href="rfc6080.html">RFC 6080</a>

   Persons to Contact:  Daniel Petrie &lt;dan.ietf@SIPez.com&gt;,
      Sumanth Channabasappa &lt;sumanth@cablelabs.com&gt;

   New event header parameters:  profile-type, vendor, model, version,
      effective-by (The profile-type parameter has predefined values.
      The new event header parameters do not.)

   The following table illustrates the additions to the IANA SIP "Header
   Field Parameters and Parameter Values" registry:

                                                   Predefined
   Header Field                  Parameter Name    Values      Reference
   ----------------------------  ---------------   ----------  ---------
   Event                         profile-type      Yes         [<a href="rfc6080.html">RFC6080</a>]
   Event                         vendor            No          [<a href="rfc6080.html">RFC6080</a>]
   Event                         model             No          [<a href="rfc6080.html">RFC6080</a>]
   Event                         version           No          [<a href="rfc6080.html">RFC6080</a>]
   Event                         effective-by      No          [<a href="rfc6080.html">RFC6080</a>]

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.2.%20%20Registry%20of%20SIP%20Configuration%20Profile%20Types"></a><a class="selflink" href="#section-8.2" name="section-8.2">8.2</a>.  Registry of SIP Configuration Profile Types</span>

   IANA has registered new SIP configuration profile types at
   <a href="http://www.iana.org/">http://www.iana.org</a> in the "SIP Configuration Profile Types"
   registry.

   The registration procedures are "Specification Required", as
   explained in "Guidelines for Writing an IANA Considerations Section
   in RFCs" ([<a href="rfc5226.html" title='"Guidelines for Writing an IANA Considerations Section in RFCs"'>RFC5226</a>]).




<span class="grey">Petrie &amp; Channabasappa       Standards Track                   [Page 46]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-47" id="page-47" name="page-47"> </a>
<span class="grey"><a href="rfc6080.html">RFC 6080</a>               SIP Configuration Framework            March 2011</span>


   Registrations with the IANA MUST include the profile type, and a
   published document that describes its purpose and usage.

   As this document specifies three SIP configuration profile types, the
   initial IANA registration contains the information shown in the table
   below.

         Profile Type                          Reference
         --------------                         ---------
         local-network                          [<a href="rfc6080.html">RFC6080</a>]
         device                                 [<a href="rfc6080.html">RFC6080</a>]
         user                                   [<a href="rfc6080.html">RFC6080</a>]

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/9.%20%20Security%20Considerations"></a><a class="selflink" href="#section-9" name="section-9">9</a>.  Security Considerations</span>

   The framework specified in this document specifies profile delivery
   stages, an event package, and three profile types to enable profile
   delivery.  The profile delivery stages are enrollment, content
   retrieval, and change notification.  The event package helps with
   enrollment and change notifications.  Each profile type allows for
   profile retrieval from a PDS belonging to a specific provider.

   Enrollment allows a device to request, and if successful, enroll with
   a PDS to obtain profile data.  To transmit the request the device
   relies on configured, cached, or discovered data.  Such data includes
   provider domain names, identities, and credentials.  The device
   either uses configured outbound proxies or discovers the next-hop
   entity using [<a href="rfc3263.html" title='"Session Initiation Protocol (SIP): Locating SIP Servers"'>RFC3263</a>] that can result in a SIP proxy or the PDS.  It
   then transmits the request.  A SIP proxy receiving the request uses
   the Request-URI and event header contents to route it to a PDS (via
   other SIP proxies, if required).

   When a PDS receives the enrollment request, it can either challenge
   any contained identity or admit the enrollment.  Authorization rules
   then decide if the enrollment gets accepted.  If accepted, the PDS
   sends an initial notification that contains either the profile data,
   or content indirection information.  The profile data can contain
   generic profile data (common across multiple devices) or information
   specific to an entity (such as the device or a user).  If specific to
   an entity, it may contain sensitive information such as credentials.
   Disclosure of sensitive data can lead to threats such as
   impersonation attacks (establishing rogue sessions), theft of service
   (if services are obtainable), and zombie attacks.  It is important
   for the device to ensure the authenticity of the PNC and the PCC
   since impersonation of the SIP service provider can lead to DoS and
   man-in-the-middle (MITM) attacks.





<span class="grey">Petrie &amp; Channabasappa       Standards Track                   [Page 47]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-48" id="page-48" name="page-48"> </a>
<span class="grey"><a href="rfc6080.html">RFC 6080</a>               SIP Configuration Framework            March 2011</span>


   Profile content retrieval allows a device to retrieve profile data
   via content indirection from a PCC.  This communication is
   accomplished using one of many profile delivery protocols or
   frameworks, such as HTTP or HTTPS as specified in this document.
   However, since the profile data returned is subject to the same
   considerations as that sent via profile notification, similar threats
   exist.  For example, DoS attacks (rogue devices bombard the PCC with
   requests for a specific profile) and attempts to modify erroneous
   data onto the PCC (since the location and format may be known).
   Thus, for the delivery of any sensitive profile data, authentication
   of the entity requesting profile data is required.  It is also
   important for the requesting entity to authenticate the profile
   source via content indirection and ensure that the sensitive profile
   data is protected via data integrity.  For sensitive data that should
   not be disclosed to unauthorized parties, data confidentiality is
   also required.

   The following subsections highlight the security considerations that
   are specific to each profile type.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/9.1.%20%20Local-Network%20Profile"></a><a class="selflink" href="#section-9.1" name="section-9.1">9.1</a>.  Local-Network Profile</span>

   A local network may or may not (e.g., home router) support local-
   network profiles as specified in this framework.  Even if supported,
   the PDS may only be configured with a generic local-network profile
   that is provided to every device that requests the local-network
   profile.  Such a PDS may not implement any authentication
   requirements or TLS.

   Alternatively, certain deployments may require the entities -- device
   and the PDS -- to authenticate each other prior to successful profile
   enrollment.  Such networks may pre-configure user identities to the
   devices and allow user-specific local-network profiles.  In such
   networks, the PDS will support digest authentication, and the devices
   are configured with user identities and credentials as specified in
   <a href="#section-5.3.1">Section 5.3.1</a>.  If sensitive profile data is being transmitted, the
   user identity is a SIPS URI that results in TLS with the next-hop
   (which is authenticated), and digest authentication is used by the
   PDS and the device.

   This framework supports both use cases and any variations in between.
   However, devices obtaining local-network profiles from an
   unauthenticated PDS are cautioned against potential MITM or PDS
   impersonation attacks.  This framework requires that a device reject
   sensitive data, such as credentials, from unauthenticated local-
   network sources.  It also prohibits devices from responding to
   authentication challenges in the absence of TLS on all hops as a
   result of using a SIPS URI.  Responding to unauthenticated challenges



<span class="grey">Petrie &amp; Channabasappa       Standards Track                   [Page 48]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-49" id="page-49" name="page-49"> </a>
<span class="grey"><a href="rfc6080.html">RFC 6080</a>               SIP Configuration Framework            March 2011</span>


   allows for dictionary attacks that can reveal weak passwords.  The
   only exception to accepting such sensitive data without
   authentication of the PDS is in the case of bootstrapping (see
   <a href="#section-5.3.1">Section 5.3.1</a>).  In the case of bootstrapping, the methods employed
   need to be aware of potential security threats such as impersonation.

   SIP Identity is useful for the device to validate notifications in
   the absence of a secure channel such as TLS when a SIPS URI is used.
   In such cases, the device can validate the SIP Identity header to
   verify the source of the profile notification, and the source of the
   profile data when content indirection is not used.  However, the
   presence of the header does not guarantee the validity of the data.
   It verifies the source and confirms data integrity, but the data
   obtained from an undesired source may still be invalid, e.g., invalid
   outbound proxy information, resulting in DoS.  Thus, devices
   requesting the local-network profile from unknown networks need to be
   prepared to discard information that prevent retrieval of other,
   required, profiles.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/9.2.%20%20Device%20Profile"></a><a class="selflink" href="#section-9.2" name="section-9.2">9.2</a>.  Device Profile</span>

   Device profiles deal with device-specific configuration.  They may be
   provided to unknown devices that are attempting to obtaining profiles
   for purposes such as trials, self-subscription (not to be confused
   with [<a href="rfc3265.html" title='"Session Initiation Protocol (SIP)-Specific Event Notification"'>RFC3265</a>]), and emergency services [<a href="#ref-PHONEBCP" title='"Best Current Practice for Communications Services in support of Emergency Calling"'>PHONEBCP</a>].

   This framework allows the device profile to be used for bootstrapping
   a device.  Such bootstrapping profile data may contain enough
   information to connect to a Provider.  For example, it may enable the
   device to communicate with a device provider, allowing for trial or
   self-subscription services via visual or audio interfaces (e.g.,
   interactive voice response), or customer service representatives.
   The profile data may also allow the device a choice of device
   providers and allow the end-user to choose one.  The profile data may
   also contain identities and credentials (temporary or long-term) that
   can be used to obtain further profile data from the network.  This
   framework recommends the use of the SIP Identity header by the PDS.
   However, to be able to validate the SIP Identity header, the device
   needs to be pre-configured with the knowledge of allowable domains or
   certificates for validation (e.g., using PKI).  If not, the device
   can still guarantee header and body integrity if the profile data
   contains the domain certificate (but the data can still be invalid or
   malicious).  In such cases, devices supporting user interfaces may
   obtain confirmation from the user trying to bootstrap the device
   (confirming header and body integrity).  However, when the SIP
   Identity header is not present, or the device is not capable of
   validating it, the bootstrapping data is unauthenticated and obtained
   without any integrity protection.  Such bootstrapping data, however,



<span class="grey">Petrie &amp; Channabasappa       Standards Track                   [Page 49]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-50" id="page-50" name="page-50"> </a>
<span class="grey"><a href="rfc6080.html">RFC 6080</a>               SIP Configuration Framework            March 2011</span>


   may contain only temporary credentials (SIPS URI and digest
   credentials) that can be used to reconnect to the network to ensure
   data integrity and data confidentiality prior to obtaining long-term
   credentials.  It is to be noted that such devices are at the mercy of
   the network they request the device profile from.  If they are
   initialized in a rogue network, or get hijacked by a rogue PDS, the
   end-user may be left without desired device operation or, worse,
   unwanted operation.  To mitigate such factors the device provider may
   communicate temporary credentials (e.g., passwords that can be
   entered via an interface) or permanent credentials (e.g., a USB
   device) to the end-user for connectivity.  If such methods are used,
   those credentials MUST be quickly replaced by large-entropy
   credentials, to minimize the impact of dictionary attacks.  Future
   enhancements to this framework may specify device capabilities that
   allow for authentication without any provider-specific configuration
   (e.g., X.509 certificates using PKI can allow for authentication by
   any provider with access to the CA certificate).  Alternatively, the
   device may be pre-configured with credentials for use with content
   indirection mechanisms.  In such circumstances a PDS can use secure
   content indirection mechanism, such as HTTPS, to provide the
   bootstrapping data.

   Once a device is associated with a device provider the device profile
   is vital to device operation.  This is because the device profile can
   contain important operational information such as users that are to
   be allowed access (white-list or black-list), user credentials (if
   required) and other sensitive information.  Thus, it is necessary to
   ensure that any device profile containing sensitive information is
   obtained via an authenticated source, with integrity protection, and
   delivered to an authenticated device.  For sensitive information such
   as credentials, data confidentiality is also required.  The framework
   requires that devices obtain sensitive information only from
   authenticated entities except while it is being bootstrapped.  In
   cases where data confidentiality needs to be mandated for
   notifications, the device provider can configure the device with a
   SIPS URI, to be used as the Subscription URI, during profile
   enrollment.  The framework also requires a PDS presenting sensitive
   profile data to use digest authentication.  This ensures that the
   data is delivered to an authenticated entity.  Authentication of
   profile retrieval via content indirection for sensitive profiles is
   via HTTPS utilizing HTTP digest.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/9.3.%20%20User%20Profile"></a><a class="selflink" href="#section-9.3" name="section-9.3">9.3</a>.  User Profile</span>

   Devices can only request user profiles for users that are known by a
   SIP service provider.  PDSs are required to reject user profile
   enrollment requests for any users that are unknown in the network.




<span class="grey">Petrie &amp; Channabasappa       Standards Track                   [Page 50]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-51" id="page-51" name="page-51"> </a>
<span class="grey"><a href="rfc6080.html">RFC 6080</a>               SIP Configuration Framework            March 2011</span>


   For known user AoRs that are allowed to retrieve profiles, the
   security considerations are similar to that of the device profile
   (except for bootstrapping).

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/10.%20%20Acknowledgements"></a><a class="selflink" href="#section-10" name="section-10">10</a>.  Acknowledgements</span>

   The author appreciates all those who contributed and commented on the
   many iterations of this document.  Detailed comments were provided by
   the following individuals: Jonathan Rosenberg, Henning Schulzrinne,
   Cullen Jennings, Rohan Mahy, Rich Schaaf, Volker Hilt, Adam Roach,
   Hisham Khartabil, Henry Sinnreich, Martin Dolly, John Elwell, Elliot
   Eichen, Robert Liao, Dale Worley, Francois Audet, Roni Even, Jason
   Fischl, Josh Littlefield, and Nhut Nguyen.

   The final revisions of this document were a product of design team
   discussions.  The editor wishes to extend special appreciation to the
   following design team members for their numerous reviews and specific
   contributions to various sections: Josh Littlefield (Overview,
   <a href="#section-6">Section 6</a>), Peter Blatherwick (<a href="#section-6">Section 6</a>), Cullen Jennings
   (Security), Sam Ganesan (<a href="#section-6">Section 6</a>), and Mary Barnes (layout, <a href="#section-6">Section</a>
   <a href="#section-6">6</a>).

   The following design team members are thanked for numerous reviews
   and general contributions: Martin Dolly, Jason Fischl, Alvin Jiang,
   and Francois Audet.

   The following SIPPING WG members are thanked for numerous reviews,
   comments and recommendations: John Elwell, Donald Lukacs, Roni Even,
   David Robbins, Shida Schubert, and Eugene Nechamkin.  The editor
   would also like to extend a special thanks to the comments and
   recommendations provided by the SIPPING WG, specifically Keith Drage
   (restructuring proposal) and John Elwell (numerous reviews and
   recommendations).

   Additionally, appreciation is also due to Peter Koch for expert DNS
   advice.

   Finally, sincere appreciation is extended to the chairs (Mary Barnes
   and Gonzalo Camarillo); the past/current Area Directors (Cullen
   Jennings, Jon Peterson, and Robert Sparks) for facilitating
   discussions, reviews, and contributions; and, the expert reviewers
   from the IESG (Peter McCann, Catherine Meadows).









<span class="grey">Petrie &amp; Channabasappa       Standards Track                   [Page 51]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-52" id="page-52" name="page-52"> </a>
<span class="grey"><a href="rfc6080.html">RFC 6080</a>               SIP Configuration Framework            March 2011</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/11.%20%20References"></a><a class="selflink" href="#section-11" name="section-11">11</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/11.1.%20%20Normative%20References"></a><a class="selflink" href="#section-11.1" name="section-11.1">11.1</a>.  Normative References</span>

   [<a id="ref-FIPS-180-3" name="ref-FIPS-180-3">FIPS-180-3</a>]  National Institute of Standards and Technology (NIST),
                 "Secure Hash Standard (SHS)", FIPS PUB 180-3,
                 October 2008.

   [<a id="ref-RFC2119" name="ref-RFC2119">RFC2119</a>]     Bradner, S., "Key words for use in RFCs to Indicate
                 Requirement Levels", <a href="http://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a id="ref-RFC2616" name="ref-RFC2616">RFC2616</a>]     Fielding, R., Gettys, J., Mogul, J., Frystyk, H.,
                 Masinter, L., Leach, P., and T. Berners-Lee, "Hypertext
                 Transfer Protocol -- HTTP/1.1", <a href="rfc2616.html">RFC 2616</a>, June 1999.

   [<a id="ref-RFC2617" name="ref-RFC2617">RFC2617</a>]     Franks, J., Hallam-Baker, P., Hostetler, J., Lawrence,
                 S., Leach, P., Luotonen, A., and L. Stewart, "HTTP
                 Authentication: Basic and Digest Access
                 Authentication", <a href="rfc2617.html">RFC 2617</a>, June 1999.

   [<a id="ref-RFC2818" name="ref-RFC2818">RFC2818</a>]     Rescorla, E., "HTTP Over TLS", <a href="rfc2818.html">RFC 2818</a>, May 2000.

   [<a id="ref-RFC3261" name="ref-RFC3261">RFC3261</a>]     Rosenberg, J., Schulzrinne, H., Camarillo, G.,
                 Johnston, A., Peterson, J., Sparks, R., Handley, M.,
                 and E. Schooler, "SIP: Session Initiation Protocol",
                 <a href="rfc3261.html">RFC 3261</a>, June 2002.

   [<a id="ref-RFC3263" name="ref-RFC3263">RFC3263</a>]     Rosenberg, J. and H. Schulzrinne, "Session Initiation
                 Protocol (SIP): Locating SIP Servers", <a href="rfc3263.html">RFC 3263</a>,
                 June 2002.

   [<a id="ref-RFC3265" name="ref-RFC3265">RFC3265</a>]     Roach, A., "Session Initiation Protocol (SIP)-Specific
                 Event Notification", <a href="rfc3265.html">RFC 3265</a>, June 2002.

   [<a id="ref-RFC3319" name="ref-RFC3319">RFC3319</a>]     Schulzrinne, H. and B. Volz, "Dynamic Host
                 Configuration Protocol (DHCPv6) Options for Session
                 Initiation Protocol (SIP) Servers", <a href="rfc3319.html">RFC 3319</a>,
                 July 2003.

   [<a id="ref-RFC3361" name="ref-RFC3361">RFC3361</a>]     Schulzrinne, H., "Dynamic Host Configuration Protocol
                 (DHCP-for-IPv4) Option for Session Initiation Protocol
                 (SIP) Servers", <a href="rfc3361.html">RFC 3361</a>, August 2002.

   [<a id="ref-RFC4122" name="ref-RFC4122">RFC4122</a>]     Leach, P., Mealling, M., and R. Salz, "A Universally
                 Unique IDentifier (UUID) URN Namespace", <a href="rfc4122.html">RFC 4122</a>,
                 July 2005.





<span class="grey">Petrie &amp; Channabasappa       Standards Track                   [Page 52]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-53" id="page-53" name="page-53"> </a>
<span class="grey"><a href="rfc6080.html">RFC 6080</a>               SIP Configuration Framework            March 2011</span>


   [<a id="ref-RFC4474" name="ref-RFC4474">RFC4474</a>]     Peterson, J. and C. Jennings, "Enhancements for
                 Authenticated Identity Management in the Session
                 Initiation Protocol (SIP)", <a href="rfc4474.html">RFC 4474</a>, August 2006.

   [<a id="ref-RFC4483" name="ref-RFC4483">RFC4483</a>]     Burger, E., "A Mechanism for Content Indirection in
                 Session Initiation Protocol (SIP) Messages", <a href="rfc4483.html">RFC 4483</a>,
                 May 2006.

   [<a id="ref-RFC4704" name="ref-RFC4704">RFC4704</a>]     Volz, B., "The Dynamic Host Configuration Protocol for
                 IPv6 (DHCPv6) Client Fully Qualified Domain Name (FQDN)
                 Option", <a href="rfc4704.html">RFC 4704</a>, October 2006.

   [<a id="ref-RFC5226" name="ref-RFC5226">RFC5226</a>]     Narten, T. and H. Alvestrand, "Guidelines for Writing
                 an IANA Considerations Section in RFCs", <a href="http://tools.ietf.org/html/bcp26">BCP 26</a>,
                 <a href="rfc5226.html">RFC 5226</a>, May 2008.

   [<a id="ref-RFC5234" name="ref-RFC5234">RFC5234</a>]     Crocker, D. and P. Overell, "Augmented BNF for Syntax
                 Specifications: ABNF", STD 68, <a href="rfc5234.html">RFC 5234</a>, January 2008.

   [<a id="ref-RFC5246" name="ref-RFC5246">RFC5246</a>]     Dierks, T. and E. Rescorla, "The Transport Layer
                 Security (TLS) Protocol Version 1.2", <a href="rfc5246.html">RFC 5246</a>,
                 August 2008.

   [<a id="ref-RFC5626" name="ref-RFC5626">RFC5626</a>]     Jennings, C., Mahy, R., and F. Audet, "Managing Client-
                 Initiated Connections in the Session Initiation
                 Protocol (SIP)", <a href="rfc5626.html">RFC 5626</a>, October 2009.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/11.2.%20%20Informative%20References"></a><a class="selflink" href="#section-11.2" name="section-11.2">11.2</a>.  Informative References</span>

   [<a id="ref-PHONEBCP" name="ref-PHONEBCP">PHONEBCP</a>]    Rosen, B. and J. Polk, "Best Current Practice for
                 Communications Services in support of Emergency
                 Calling", Work in Progress, October 2010.

   [<a id="ref-RFC0959" name="ref-RFC0959">RFC0959</a>]     Postel, J. and J. Reynolds, "File Transfer Protocol",
                 STD 9, <a href="rfc959.html">RFC 959</a>, October 1985.

   [<a id="ref-RFC2132" name="ref-RFC2132">RFC2132</a>]     Alexander, S. and R. Droms, "DHCP Options and BOOTP
                 Vendor Extensions", <a href="rfc2132.html">RFC 2132</a>, March 1997.

   [<a id="ref-RFC4510" name="ref-RFC4510">RFC4510</a>]     Zeilenga, K., "Lightweight Directory Access Protocol
                 (LDAP): Technical Specification Road Map", <a href="rfc4510.html">RFC 4510</a>,
                 June 2006.

   [<a id="ref-RFC4634" name="ref-RFC4634">RFC4634</a>]     Eastlake, D. and T. Hansen, "US Secure Hash Algorithms
                 (SHA and HMAC-SHA)", <a href="rfc4634.html">RFC 4634</a>, July 2006.






<span class="grey">Petrie &amp; Channabasappa       Standards Track                   [Page 53]</span>
</pre><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-54" id="page-54" name="page-54"> </a>
<span class="grey"><a href="rfc6080.html">RFC 6080</a>               SIP Configuration Framework            March 2011</span>


   [<a id="ref-RFC4825" name="ref-RFC4825">RFC4825</a>]     Rosenberg, J., "The Extensible Markup Language (XML)
                 Configuration Access Protocol (XCAP)", <a href="rfc4825.html">RFC 4825</a>,
                 May 2007.

Authors' Addresses

   Daniel Petrie
   SIPez LLC
   246A Park Ave
   Arlington, MA  02476
   USA

   EMail: dan.ietf@SIPez.com
   URI:   <a href="http://www.sipez.com/">http://www.SIPez.com/</a>


   Sumanth Channabasappa (editor)
   CableLabs
   858 Coal Creek Circle
   Louisville, CO  80027
   USA

   EMail: sumanth@cablelabs.com
   URI:   <a href="http://www.cablelabs.com/">http://www.cablelabs.com/</a>



























Petrie &amp; Channabasappa       Standards Track                   [Page 54]

</pre><br/>
<span class="noprint"><small><small>Html markup produced by rfcmarkup 1.107, available from
<a href="http://tools.ietf.org/tools/rfcmarkup/">http://tools.ietf.org/tools/rfcmarkup/</a>
</small></small></span>



</body><!-- Mirrored from tools.ietf.org/html/rfc6080 by HTTrack Website Copier/3.x [XR&CO'2013], Sat, 07 Jun 2014 20:18:41 GMT --></html>