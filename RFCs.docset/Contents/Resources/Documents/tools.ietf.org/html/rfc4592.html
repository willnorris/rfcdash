<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc4592 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:41 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="urn:ietf:rfc:4592" name="DC.Identifier"/>
<meta content="This is an update to the wildcard definition of RFC 1034. The
interaction with wildcards and CNAME is changed, an error condition is
removed, and the words defining some concepts central to wildcards are
changed. The overall goal is not to change wildcards, but to refine
the definition of RFC 1034. [STANDARDS-TRACK]" name="DC.Description.Abstract"/>
<meta content="E. Lewis" name="DC.Creator"/>
<meta content="July, 2006" name="DC.Date.Issued"/>
<meta content="The Role of Wildcards in the Domain Name System" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 4592 - The Role of Wildcards in the Domain Name System</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgblue" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc4592.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc4592" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-dnsext-wcard-clarify" title="draft-ietf-dnsext-wcard-clarify">draft-ietf-dnse...</a>] [<a href="https://datatracker.ietf.org/doc/rfc4592" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc4592" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc4592" title="Side-by-side diff">Diff2</a>] [<a href="https://www.rfc-editor.org/errata_search.php?rfc=4592">Errata</a>]</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                       PROPOSED STANDARD</span><br/>
<span class="pre noprint docinfo">                                                            <span style="color: #C00;">Errata Exist</span></span><br/>
<pre>Network Working Group                                           E. Lewis
Request for Comments: 4592                                       NeuStar
Updates: <a href="rfc1034.html">1034</a>, <a href="rfc2672.html">2672</a>                                            July 2006
Category: Standards Track


                         <span class="h1">The Role of Wildcards</span>
                       <span class="h1">in the Domain Name System</span>

Status of This Memo

   This document specifies an Internet standards track protocol for the
   Internet community, and requests discussion and suggestions for
   improvements.  Please refer to the current edition of the "Internet
   Official Protocol Standards" (STD 1) for the standardization state
   and status of this protocol.  Distribution of this memo is unlimited.

Copyright Notice

   Copyright (C) The Internet Society (2006).

Abstract

   This is an update to the wildcard definition of <a href="rfc1034.html">RFC 1034</a>.  The
   interaction with wildcards and CNAME is changed, an error condition
   is removed, and the words defining some concepts central to wildcards
   are changed.  The overall goal is not to change wildcards, but to
   refine the definition of <a href="rfc1034.html">RFC 1034</a>.























<span class="grey">Lewis                       Standards Track                     [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc4592.html">RFC 4592</a>                      DNSEXT WCARD                     July 2006</span>


Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-3">3</a>
      <a href="#section-1.1">1.1</a>. Motivation .................................................<a href="#page-3">3</a>
      <a href="#section-1.2">1.2</a>. The Original Definition ....................................<a href="#page-3">3</a>
      <a href="#section-1.3">1.3</a>. Roadmap to This Document ...................................<a href="#page-4">4</a>
           <a href="#section-1.3.1">1.3.1</a>. New Terms ...........................................<a href="#page-5">5</a>
           <a href="#section-1.3.2">1.3.2</a>. Changed Text ........................................<a href="#page-5">5</a>
           <a href="#section-1.3.3">1.3.3</a>. Considerations with Special Types ...................<a href="#page-5">5</a>
      <a href="#section-1.4">1.4</a>. Standards Terminology ......................................<a href="#page-6">6</a>
   <a href="#section-2">2</a>. Wildcard Syntax .................................................<a href="#page-6">6</a>
      <a href="#section-2.1">2.1</a>. Identifying a Wildcard .....................................<a href="#page-6">6</a>
           <a href="#section-2.1.1">2.1.1</a>. Wildcard Domain Name and Asterisk Label .............<a href="#page-6">6</a>
           <a href="#section-2.1.2">2.1.2</a>. Asterisks and Other Characters ......................<a href="#page-7">7</a>
           <a href="#section-2.1.3">2.1.3</a>. Non-terminal Wildcard Domain Names ..................<a href="#page-7">7</a>
      <a href="#section-2.2">2.2</a>. Existence Rules ............................................<a href="#page-7">7</a>
           <a href="#section-2.2.1">2.2.1</a>. An Example ..........................................<a href="#page-8">8</a>
           <a href="#section-2.2.2">2.2.2</a>. Empty Non-terminals .................................<a href="#page-9">9</a>
           <a href="#section-2.2.3">2.2.3</a>. Yet Another Definition of Existence ................<a href="#page-10">10</a>
      <a href="#section-2.3">2.3</a>. When Is a Wildcard Domain Name Not Special? ...............<a href="#page-10">10</a>
   <a href="#section-3">3</a>. Impact of a Wildcard Domain Name on a Response .................<a href="#page-10">10</a>
      <a href="#section-3.1">3.1</a>. Step 2 ....................................................<a href="#page-11">11</a>
      <a href="#section-3.2">3.2</a>. Step 3 ....................................................<a href="#page-11">11</a>
      <a href="#section-3.3">3.3</a>. Part 'c' ..................................................<a href="#page-12">12</a>
           <a href="#section-3.3.1">3.3.1</a>. Closest Encloser and the Source of Synthesis .......<a href="#page-12">12</a>
           <a href="#section-3.3.2">3.3.2</a>. Closest Encloser and Source of Synthesis Examples ..13
           <a href="#section-3.3.3">3.3.3</a>. Type Matching ......................................<a href="#page-13">13</a>
   <a href="#section-4">4</a>. Considerations with Special Types ..............................<a href="#page-14">14</a>
      <a href="#section-4.1">4.1</a>. SOA RRSet at a Wildcard Domain Name .......................<a href="#page-14">14</a>
      <a href="#section-4.2">4.2</a>. NS RRSet at a Wildcard Domain Name ........................<a href="#page-14">14</a>
           <a href="#section-4.2.1">4.2.1</a>. Discarded Notions ..................................<a href="#page-15">15</a>
      <a href="#section-4.3">4.3</a>. CNAME RRSet at a Wildcard Domain Name .....................<a href="#page-16">16</a>
      <a href="#section-4.4">4.4</a>. DNAME RRSet at a Wildcard Domain Name .....................<a href="#page-16">16</a>
      <a href="#section-4.5">4.5</a>. SRV RRSet at a Wildcard Domain Name .......................<a href="#page-17">17</a>
      <a href="#section-4.6">4.6</a>. DS RRSet at a Wildcard Domain Name ........................<a href="#page-17">17</a>
      <a href="#section-4.7">4.7</a>. NSEC RRSet at a Wildcard Domain Name ......................<a href="#page-18">18</a>
      <a href="#section-4.8">4.8</a>. RRSIG at a Wildcard Domain Name ...........................<a href="#page-18">18</a>
      <a href="#section-4.9">4.9</a>. Empty Non-terminal Wildcard Domain Name ...................<a href="#page-18">18</a>
   <a href="#section-5">5</a>. Security Considerations ........................................<a href="#page-18">18</a>
   <a href="#section-6">6</a>. References .....................................................<a href="#page-18">18</a>
      <a href="#section-6.1">6.1</a>. Normative References ......................................<a href="#page-18">18</a>
      <a href="#section-6.2">6.2</a>. Informative References ....................................<a href="#page-19">19</a>
   <a href="#section-7">7</a>. Others Contributing to the Document ............................<a href="#page-19">19</a>








<span class="grey">Lewis                       Standards Track                     [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc4592.html">RFC 4592</a>                      DNSEXT WCARD                     July 2006</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   In <a href="rfc1034.html">RFC 1034</a> [<a href="rfc1034.html" title='"Domain names - concepts and facilities"'>RFC1034</a>], sections <a href="#section-4.3.2">4.3.2</a> and <a href="#section-4.3.3">4.3.3</a> describe the
   synthesis of answers from special resource records (RRs) called
   wildcards.  The definition in <a href="rfc1034.html">RFC 1034</a> is incomplete and has proven
   to be confusing.  This document describes the wildcard synthesis by
   adding to the discussion and making limited modifications.
   Modifications are made to close inconsistencies that have led to
   interoperability issues.  This description does not expand the
   service intended by the original definition.

   Staying within the spirit and style of the original documents, this
   document avoids specifying rules for DNS implementations regarding
   wildcards.  The intention is to only describe what is needed for
   interoperability, not restrict implementation choices.  In addition,
   consideration is given to minimize any backward-compatibility issues
   with implementations that comply with <a href="rfc1034.html">RFC 1034</a>'s definition.

   This document is focused on the concept of wildcards as defined in
   <a href="rfc1034.html">RFC 1034</a>.  Nothing is implied regarding alternative means of
   synthesizing resource record sets (RRSets), nor are alternatives
   discussed.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.1.%20%20Motivation"></a><a class="selflink" href="#section-1.1" name="section-1.1">1.1</a>.  Motivation</span>

   Many DNS implementations diverge, in different ways, from the
   original definition of wildcards.  Although there is clearly a need
   to clarify the original documents in light of this alone, the impetus
   for this document lay in the engineering of the DNS security
   extensions [<a href="rfc4033.html" title='"DNS Security Introduction and Requirements"'>RFC4033</a>].  With an unclear definition of wildcards, the
   design of authenticated denial became entangled.

   This document is intended to limit its changes, documenting only
   those deemed necessary based on implementation experience, and to
   remain as close to the original document as possible.  To reinforce
   that this document is meant to clarify and adjust and not redefine
   wildcards, relevant sections of <a href="rfc1034.html">RFC 1034</a> are repeated verbatim to
   facilitate comparison of the old and new text.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.2.%20%20The%20Original%20Definition"></a><a class="selflink" href="#section-1.2" name="section-1.2">1.2</a>.  The Original Definition</span>

   The definition of the wildcard concept is comprised by the
   documentation of the algorithm by which a name server prepares a
   response (in <a href="rfc1034.html">RFC 1034</a>'s <a href="#section-4.3.2">section 4.3.2</a>) and the way in which a
   resource record (set) is identified as being a source of synthetic
   data (<a href="#section-4.3.3">section 4.3.3</a>).





<span class="grey">Lewis                       Standards Track                     [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc4592.html">RFC 4592</a>                      DNSEXT WCARD                     July 2006</span>


   This is the definition of the term "wildcard" as it appears in <a href="rfc1034.html">RFC</a>
   <a href="rfc1034.html">1034</a>, <a href="#section-4.3.3">section 4.3.3</a>.

   # In the previous algorithm, special treatment was given to RRs with
   # owner names starting with the label "*".  Such RRs are called
   # wildcards. Wildcard RRs can be thought of as instructions for
   # synthesizing RRs.  When the appropriate conditions are met, the
   # name server creates RRs with an owner name equal to the query name
   # and contents taken from the wildcard RRs.

   This passage follows the algorithm in which the term wildcard is
   first used.  In this definition, wildcard refers to resource records.
   In other usage, wildcard has referred to domain names, and it has
   been used to describe the operational practice of relying on
   wildcards to generate answers.  It is clear from this that there is a
   need to define clear and unambiguous terminology in the process of
   discussing wildcards.

   The mention of the use of wildcards in the preparation of a response
   is contained in step 3, part 'c' of <a href="rfc1034.html">RFC 1034</a>'s <a href="#section-4.3.2">section 4.3.2</a>,
   entitled "Algorithm".  Note that "wildcard" does not appear in the
   algorithm, instead references are made to the "*" label.  The portion
   of the algorithm relating to wildcards is deconstructed in detail in
   <a href="#section-3">section 3</a> of this document; this is the beginning of the relevant
   portion of the "Algorithm".

   #    c. If at some label, a match is impossible (i.e., the
   #       corresponding label does not exist), look to see if [...]
   #       the "*" label exists.

   The scope of this document is the <a href="rfc1034.html">RFC 1034</a> definition of wildcards
   and the implications of updates to those documents, such as DNS
   Security (DNSSEC).  Alternate schemes for synthesizing answers are
   not considered.  (Note that there is no reference listed.  No
   document is known to describe any alternate schemes, although there
   has been some mention of them in mailing lists.)

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.3.%20%20Roadmap%20to%20This%20Document"></a><a class="selflink" href="#section-1.3" name="section-1.3">1.3</a>.  Roadmap to This Document</span>

   This document accomplishes these three tasks.

   o Defines new terms

   o Makes minor changes to avoid conflicting concepts

   o Describes the actions of certain resource records as wildcards





<span class="grey">Lewis                       Standards Track                     [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc4592.html">RFC 4592</a>                      DNSEXT WCARD                     July 2006</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/1.3.1.%20%20New%20Terms"></a><a class="selflink" href="#section-1.3.1" name="section-1.3.1">1.3.1</a>.  New Terms</span>

   To help in discussing what resource records are wildcards, two terms
   will be defined: "asterisk label" and "wildcard domain name".  These
   are defined in <a href="#section-2.1.1">section 2.1.1</a>.

   To assist in clarifying the role of wildcards in the name server
   algorithm in <a href="rfc1034.html#section-4.3.2">RFC 1034, section 4.3.2</a>, "source of synthesis" and
   "closest encloser" are defined.  These definitions are in <a href="#section-3.3.1">section</a>
   <a href="#section-3.3.1">3.3.1</a>.  "Label match" is defined in <a href="#section-3.2">section 3.2</a>.

   The new terms are used to make discussions of wildcards clearer.
   Terminology does not directly have an impact on implementations.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/1.3.2.%20%20Changed%20Text"></a><a class="selflink" href="#section-1.3.2" name="section-1.3.2">1.3.2</a>.  Changed Text</span>

   The definition of "existence" is changed superficially.  This change
   will not be apparent to implementations; it is needed to make
   descriptions more precise.  The change appears in <a href="#section-2.2.3">section 2.2.3</a>.

   <a href="rfc1034.html#section-4.3.3">RFC 1034, section 4.3.3</a>, seems to prohibit having two asterisk labels
   in a wildcard owner name.  With this document, the restriction is
   removed entirely.  This change and its implications are in <a href="#section-2.1.3">section</a>
   <a href="#section-2.1.3">2.1.3</a>.

   The actions when a source of synthesis owns a CNAME RR are changed to
   mirror the actions if an exact match name owns a CNAME RR.  This is
   an addition to the words in <a href="rfc1034.html#section-4.3.2">RFC 1034, section 4.3.2</a>, step 3, part
   'c'.  The discussion of this is in <a href="#section-3.3.3">section 3.3.3</a>.

   Only the latter change represents an impact to implementations.  The
   definition of existence is not a protocol impact.  The change to the
   restriction on names is unlikely to have an impact, as <a href="rfc1034.html">RFC 1034</a>
   contained no specification on when and how to enforce the
   restriction.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/1.3.3.%20%20Considerations%20with%20Special%20Types"></a><a class="selflink" href="#section-1.3.3" name="section-1.3.3">1.3.3</a>.  Considerations with Special Types</span>

   This document describes semantics of wildcard RRSets for
   "interesting" types as well as empty non-terminal wildcards.
   Understanding these situations in the context of wildcards has been
   clouded because these types incur special processing if they are the
   result of an exact match.  This discussion is in <a href="#section-4">section 4</a>.

   These discussions do not have an implementation impact; they cover
   existing knowledge of the types, but to a greater level of detail.





<span class="grey">Lewis                       Standards Track                     [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc4592.html">RFC 4592</a>                      DNSEXT WCARD                     July 2006</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.4.%20%20Standards%20Terminology"></a><a class="selflink" href="#section-1.4" name="section-1.4">1.4</a>.  Standards Terminology</span>

   This document does not use terms as defined in "Key words for use in
   RFCs to Indicate Requirement Levels" [<a href="rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].

   Quotations of <a href="rfc1034.html">RFC 1034</a> are denoted by a '#' at the start of the line.
   References to section "4.3.2" are assumed to refer to <a href="rfc1034.html">RFC 1034</a>'s
   <a href="#section-4.3.2">section 4.3.2</a>, simply titled "Algorithm".

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Wildcard%20Syntax"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Wildcard Syntax</span>

   The syntax of a wildcard is the same as any other DNS resource
   record, across all classes and types.  The only significant feature
   is the owner name.

   Because wildcards are encoded as resource records with special names,
   they are included in zone transfers and incremental zone transfers
   [<a href="rfc1995.html" title='"Incremental Zone Transfer in DNS"'>RFC1995</a>] just as non-wildcard resource records are.  This feature
   has been under appreciated until discussions on alternative
   approaches to wildcards appeared on mailing lists.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.1.%20%20Identifying%20a%20Wildcard"></a><a class="selflink" href="#section-2.1" name="section-2.1">2.1</a>.  Identifying a Wildcard</span>

   To provide a more accurate description of wildcards, the definition
   has to start with a discussion of the domain names that appear as
   owners.  Two new terms are needed, "asterisk label" and "wildcard
   domain name".

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.1.1.%20%20Wildcard%20Domain%20Name%20and%20Asterisk%20Label"></a><a class="selflink" href="#section-2.1.1" name="section-2.1.1">2.1.1</a>.  Wildcard Domain Name and Asterisk Label</span>

   A "wildcard domain name" is defined by having its initial (i.e.,
   leftmost or least significant) label be, in binary format:

      0000 0001 0010 1010 (binary) = 0x01 0x2a (hexadecimal)

   The first octet is the normal label type and length for a 1-octet-
   long label, and the second octet is the ASCII representation [<a href="rfc20.html" title='"ASCII format for network interchange"'>RFC20</a>]
   for the '*' character.

   A descriptive name of a label equaling that value is an "asterisk
   label".

   <a href="rfc1034.html">RFC 1034</a>'s definition of wildcard would be "a resource record owned
   by a wildcard domain name".







<span class="grey">Lewis                       Standards Track                     [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc4592.html">RFC 4592</a>                      DNSEXT WCARD                     July 2006</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.1.2.%20%20Asterisks%20and%20Other%20Characters"></a><a class="selflink" href="#section-2.1.2" name="section-2.1.2">2.1.2</a>.  Asterisks and Other Characters</span>

   No label values other than that in <a href="#section-2.1.1">section 2.1.1</a> are asterisk labels,
   hence names beginning with other labels are never wildcard domain
   names.  Labels such as 'the*' and '**' are not asterisk labels, so
   these labels do not start wildcard domain names.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.1.3.%20%20Non-terminal%20Wildcard%20Domain%20Names"></a><a class="selflink" href="#section-2.1.3" name="section-2.1.3">2.1.3</a>.  Non-terminal Wildcard Domain Names</span>

   In <a href="#section-4.3.3">section 4.3.3</a>, the following is stated:

   # ..........................  The owner name of the wildcard RRs is
   # of the form "*.&lt;anydomain&gt;", where &lt;anydomain&gt; is any domain name.
   # &lt;anydomain&gt; should not contain other * labels......................

   The restriction is now removed.  The original documentation of it is
   incomplete and the restriction does not serve any purpose given years
   of operational experience.

   There are three possible reasons for putting the restriction in
   place, but none of the three has held up over time.  One is that the
   restriction meant that there would never be subdomains of wildcard
   domain names, but the restriction as stated still permits
   "example.*.example." for instance.  Another is that wildcard domain
   names are not intended to be empty non-terminals, but this situation
   does not disrupt the algorithm in 4.3.2.  Finally, "nested" wildcard
   domain names are not ambiguous once the concept of the closest
   encloser had been documented.

   A wildcard domain name can have subdomains.  There is no need to
   inspect the subdomains to see if there is another asterisk label in
   any subdomain.

   A wildcard domain name can be an empty non-terminal.  (See the
   upcoming sections on empty non-terminals.)  In this case, any lookup
   encountering it will terminate as would any empty non-terminal match.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.2.%20%20Existence%20Rules"></a><a class="selflink" href="#section-2.2" name="section-2.2">2.2</a>.  Existence Rules</span>

   The notion that a domain name 'exists' is mentioned in the definition
   of wildcards.  In <a href="rfc1034.html#section-4.3.3">section 4.3.3 of RFC 1034</a>:

   # Wildcard RRs do not apply:
   #
   ...
   #   - When the query name or a name between the wildcard domain and
   #     the query name is know[n] to exist. . . .




<span class="grey">Lewis                       Standards Track                     [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc4592.html">RFC 4592</a>                      DNSEXT WCARD                     July 2006</span>


   "Existence" is therefore an important concept in the understanding of
   wildcards.  Unfortunately, the definition of what exists, in <a href="rfc1034.html">RFC</a>
   <a href="rfc1034.html">1034</a>, is unclear.  So, in sections <a href="#section-2.2.2">2.2.2</a>. and 2.2.3, another look is
   taken at the definition of existence.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.2.1.%20%20An%20Example"></a><a class="selflink" href="#section-2.2.1" name="section-2.2.1">2.2.1</a>.  An Example</span>

   To illustrate what is meant by existence consider this complete zone:

      $ORIGIN example.
      example.                 3600 IN  SOA   &lt;SOA RDATA&gt;
      example.                 3600     NS    ns.example.com.
      example.                 3600     NS    ns.example.net.
      *.example.               3600     TXT   "this is a wildcard"
      *.example.               3600     MX    10 host1.example.
      sub.*.example.           3600     TXT   "this is not a wildcard"
      host1.example.           3600     A     192.0.2.1
      _ssh._tcp.host1.example. 3600     SRV   &lt;SRV RDATA&gt;
      _ssh._tcp.host2.example. 3600     SRV   &lt;SRV RDATA&gt;
      subdel.example.          3600     NS    ns.example.com.
      subdel.example.          3600     NS    ns.example.net.

   A look at the domain names in a tree structure is helpful:

                                  |
                  -------------example------------
                 /           /         \          \
                /           /           \          \
               /           /             \          \
              *          host1          host2      subdel
              |            |             |
              |            |             |
             sub         _tcp          _tcp
                           |             |
                           |             |
                         _ssh          _ssh

   The following responses would be synthesized from one of the
   wildcards in the zone:

      QNAME=host3.example. QTYPE=MX, QCLASS=IN
           the answer will be a "host3.example. IN MX ..."

      QNAME=host3.example. QTYPE=A, QCLASS=IN
           the answer will reflect "no error, but no data"
           because there is no A RR set at '*.example.'





<span class="grey">Lewis                       Standards Track                     [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc4592.html">RFC 4592</a>                      DNSEXT WCARD                     July 2006</span>


      QNAME=foo.bar.example. QTYPE=TXT, QCLASS=IN
           the answer will be "foo.bar.example. IN TXT ..."
           because bar.example. does not exist, but the wildcard
           does.

   The following responses would not be synthesized from any of the
   wildcards in the zone:

      QNAME=host1.example., QTYPE=MX, QCLASS=IN
           because host1.example. exists

      QNAME=sub.*.example., QTYPE=MX, QCLASS=IN
           because sub.*.example. exists

      QNAME=_telnet._tcp.host1.example., QTYPE=SRV, QCLASS=IN
           because _tcp.host1.example. exists (without data)

      QNAME=host.subdel.example., QTYPE=A, QCLASS=IN
           because subdel.example. exists (and is a zone cut)

      QNAME=ghost.*.example., QTYPE=MX, QCLASS=IN
           because *.example. exists

   The final example highlights one common misconception about
   wildcards.  A wildcard "blocks itself" in the sense that a wildcard
   does not match its own subdomains.  That is, "*.example."  does not
   match all names in the "example." zone; it fails to match the names
   below "*.example.". To cover names under "*.example.", another
   wildcard domain name is needed--"*.*.example."--which covers all but
   its own subdomains.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.2.2.%20%20Empty%20Non-terminals"></a><a class="selflink" href="#section-2.2.2" name="section-2.2.2">2.2.2</a>.  Empty Non-terminals</span>

   Empty non-terminals [RFC2136, <a href="#section-7.16">section 7.16</a>] are domain names that own
   no resource records but have subdomains that do.  In <a href="#section-2.2.1">section 2.2.1</a>,
   "_tcp.host1.example." is an example of an empty non-terminal name.
   Empty non-terminals are introduced by this text in section 3.1 of <a href="rfc1034.html">RFC</a>
   <a href="rfc1034.html">1034</a>:

   # The domain name space is a tree structure.  Each node and leaf on
   # the tree corresponds to a resource set (which may be empty).  The
   # domain system makes no distinctions between the uses of the
   # interior nodes and leaves, and this memo uses the term "node" to
   # refer to both.

   The parenthesized "which may be empty" specifies that empty non-
   terminals are explicitly recognized and that empty non-terminals
   "exist".



<span class="grey">Lewis                       Standards Track                     [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc4592.html">RFC 4592</a>                      DNSEXT WCARD                     July 2006</span>


   Pedantically reading the above paragraph can lead to an
   interpretation that all possible domains exist--up to the suggested
   limit of 255 octets for a domain name [<a href="rfc1035.html" title='"Domain names - implementation and specification"'>RFC1035</a>].  For example,
   www.example. may have an A RR, and as far as is practically
   concerned, is a leaf of the domain tree.  But the definition can be
   taken to mean that sub.www.example. also exists, albeit with no data.
   By extension, all possible domains exist, from the root on down.

   As <a href="rfc1034.html">RFC 1034</a> also defines "an authoritative name error indicating that
   the name does not exist" in <a href="#section-4.3.1">section 4.3.1</a>, so this apparently is not
   the intent of the original definition, justifying the need for an
   updated definition in the next section.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.2.3.%20%20Yet%20Another%20Definition%20of%20Existence"></a><a class="selflink" href="#section-2.2.3" name="section-2.2.3">2.2.3</a>.  Yet Another Definition of Existence</span>

   <a href="rfc1034.html">RFC 1034</a>'s wording is fixed by the following paragraph:

   The domain name space is a tree structure.  Nodes in the tree either
   own at least one RRSet and/or have descendants that collectively own
   at least one RRSet.  A node may exist with no RRSets only if it has
   descendants that do; this node is an empty non-terminal.

   A node with no descendants is a leaf node.  Empty leaf nodes do not
   exist.

   Note that at a zone boundary, the domain name owns data, including
   the NS RR set.  In the delegating zone, the NS RR set is not
   authoritative, but that is of no consequence here.  The domain name
   owns data; therefore, it exists.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.3.%20%20When%20Is%20a%20Wildcard%20Domain%20Name%20Not%20Special%3F"></a><a class="selflink" href="#section-2.3" name="section-2.3">2.3</a>.  When Is a Wildcard Domain Name Not Special?</span>

   When a wildcard domain name appears in a message's query section, no
   special processing occurs.  An asterisk label in a query name only
   matches a single, corresponding asterisk label in the existing zone
   tree when the 4.3.2 algorithm is being followed.

   When a wildcard domain name appears in the resource data of a record,
   no special processing occurs.  An asterisk label in that context
   literally means just an asterisk.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Impact%20of%20a%20Wildcard%20Domain%20Name%20on%20a%20Response"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Impact of a Wildcard Domain Name on a Response</span>

   <a href="rfc1034.html">RFC 1034</a>'s description of how wildcards impact response generation is
   in its <a href="#section-4.3.2">section 4.3.2</a>.  That passage contains the algorithm followed
   by a server in constructing a response.  Within that algorithm, step
   3, part 'c' defines the behavior of the wildcard.




<span class="grey">Lewis                       Standards Track                    [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc4592.html">RFC 4592</a>                      DNSEXT WCARD                     July 2006</span>


   The algorithm in <a href="#section-4.3.2">section 4.3.2</a> is not intended to be pseudo-code;
   that is, its steps are not intended to be followed in strict order.
   The "algorithm" is a suggested means of implementing the
   requirements.  As such, in step 3, parts 'a', 'b', and 'c' do not
   have to be implemented in that order, provided that the result of the
   implemented code is compliant with the protocol's specification.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.1.%20%20Step%202"></a><a class="selflink" href="#section-3.1" name="section-3.1">3.1</a>.  Step 2</span>

   Step 2 of <a href="#section-4.3.2">section 4.3.2</a> reads:

   #   2. Search the available zones for the zone which is the nearest
   #      ancestor to QNAME.  If such a zone is found, go to step 3,
   #      otherwise step 4.

   In this step, the most appropriate zone for the response is chosen.
   The significance of this step is that it means all of step 3 is being
   performed within one zone.  This has significance when considering
   whether or not an SOA RR can ever be used for synthesis.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.2.%20%20Step%203"></a><a class="selflink" href="#section-3.2" name="section-3.2">3.2</a>.  Step 3</span>

   Step 3 is dominated by three parts, labeled 'a', 'b', and 'c'.  But
   the beginning of the step is important and needs explanation.

   #   3. Start matching down, label by label, in the zone.  The
   #      matching process can terminate several ways:

   The word 'matching' refers to label matching.  The concept is based
   in the view of the zone as the tree of existing names.  The query
   name is considered to be an ordered sequence of labels--as if the
   name were a path from the root to the owner of the desired data
   (which it is--3rd paragraph of <a href="rfc1034.html#section-3.1">RFC 1034, section 3.1</a>).

   The process of label matching a query name ends in exactly one of
   three choices, the parts 'a', 'b', and 'c'.  Either the name is
   found, the name is below a cut point, or the name is not found.

   Once one of the parts is chosen, the other parts are not considered
   (e.g., do not execute part 'c' and then change the execution path to
   finish in part 'b').  The process of label matching is also done
   independent of the query type (QTYPE).

   Parts 'a' and 'b' are not an issue for this clarification as they do
   not relate to record synthesis.  Part 'a' is an exact match that
   results in an answer; part 'b' is a referral.





<span class="grey">Lewis                       Standards Track                    [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc4592.html">RFC 4592</a>                      DNSEXT WCARD                     July 2006</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.3.%20%20Part%20%27c%27"></a><a class="selflink" href="#section-3.3" name="section-3.3">3.3</a>.  Part 'c'</span>

   The context of part 'c' is that the process of label matching the
   labels of the query name has resulted in a situation in which there
   is no corresponding label in the tree.  It is as if the lookup has
   "fallen off the tree".

   #     c. If at some label, a match is impossible (i.e., the
   #        corresponding label does not exist), look to see if [...]
   #        the "*" label exists.

   To help describe the process of looking 'to see if [...] the "*"
   label exists' a term has been coined to describe the last domain
   (node) matched.  The term is "closest encloser".

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.3.1.%20%20Closest%20Encloser%20and%20the%20Source%20of%20Synthesis"></a><a class="selflink" href="#section-3.3.1" name="section-3.3.1">3.3.1</a>.  Closest Encloser and the Source of Synthesis</span>

   The closest encloser is the node in the zone's tree of existing
   domain names that has the most labels matching the query name
   (consecutively, counting from the root label downward).  Each match
   is a "label match" and the order of the labels is the same.

   The closest encloser is, by definition, an existing name in the zone.
   The closest encloser might be an empty non-terminal or even be a
   wildcard domain name itself.  In no circumstances is the closest
   encloser to be used to synthesize records for the current query.

   The source of synthesis is defined in the context of a query process
   as that wildcard domain name immediately descending from the closest
   encloser, provided that this wildcard domain name exists.
   "Immediately descending" means that the source of synthesis has a
   name of the form:

      &lt;asterisk label&gt;.&lt;closest encloser&gt;.

   A source of synthesis does not guarantee having a RRSet to use for
   synthesis.  The source of synthesis could be an empty non-terminal.

   If the source of synthesis does not exist (not on the domain tree),
   there will be no wildcard synthesis.  There is no search for an
   alternate.

   The important concept is that for any given lookup process, there is
   at most one place at which wildcard synthetic records can be
   obtained.  If the source of synthesis does not exist, the lookup
   terminates, and the lookup does not look for other wildcard records.





<span class="grey">Lewis                       Standards Track                    [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc4592.html">RFC 4592</a>                      DNSEXT WCARD                     July 2006</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.3.2.%20%20Closest%20Encloser%20and%20Source%20of%20Synthesis%20Examples"></a><a class="selflink" href="#section-3.3.2" name="section-3.3.2">3.3.2</a>.  Closest Encloser and Source of Synthesis Examples</span>

   To illustrate, using the example zone in <a href="#section-2.2.1">section 2.2.1</a> of this
   document, the following chart shows QNAMEs and the closest enclosers.

     QNAME                       Closest Encloser    Source of Synthesis
     host3.example.              example.            *.example.
     _telnet._tcp.host1.example. _tcp.host1.example. no source
     _dns._udp.host2.example.    host2.example.      no source
     _telnet._tcp.host3.example. example.            *.example.
     _chat._udp.host3.example.   example.            *.example.
     foobar.*.example.           *.example.          no source

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/3.3.3.%20%20Type%20Matching"></a><a class="selflink" href="#section-3.3.3" name="section-3.3.3">3.3.3</a>.  Type Matching</span>

   <a href="rfc1034.html">RFC 1034</a> concludes part 'c' with this:

   #            If the "*" label does not exist, check whether the name
   #            we are looking for is the original QNAME in the query
   #            or a name we have followed due to a CNAME.  If the name
   #            is original, set an authoritative name error in the
   #            response and exit.  Otherwise just exit.
   #
   #            If the "*" label does exist, match RRs at that node
   #            against QTYPE.  If any match, copy them into the answer
   #            section, but set the owner of the RR to be QNAME, and
   #            not the node with the "*" label.  Go to step 6.

   The final paragraph covers the role of the QTYPE in the lookup
   process.

   Based on implementation feedback and similarities between part 'a'
   and part 'c', a change to this passage has been made.

   The change is to add the following text to part 'c' prior to the
   instructions to "go to step 6":

      If the data at the source of synthesis is a CNAME, and QTYPE
      doesn't match CNAME, copy the CNAME RR into the answer section of
      the response changing the owner name to the QNAME, change QNAME to
      the canonical name in the CNAME RR, and go back to step 1.

   This is essentially the same text in part 'a' covering the processing
   of CNAME RRSets.







<span class="grey">Lewis                       Standards Track                    [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc4592.html">RFC 4592</a>                      DNSEXT WCARD                     July 2006</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Considerations%20with%20Special%20Types"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Considerations with Special Types</span>

   Sections <a href="#section-2">2</a> and <a href="#section-3">3</a> of this document discuss wildcard synthesis with
   respect to names in the domain tree and ignore the impact of types.
   In this section, the implication of wildcards of specific types is
   discussed.  The types covered are those that have proven to be the
   most difficult to understand.  The types are SOA, NS, CNAME, DNAME,
   SRV, DS, NSEC, RRSIG, and "none", that is, empty non-terminal
   wildcard domain names.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.1.%20%20SOA%20RRSet%20at%20a%20Wildcard%20Domain%20Name"></a><a class="selflink" href="#section-4.1" name="section-4.1">4.1</a>.  SOA RRSet at a Wildcard Domain Name</span>

   A wildcard domain name owning an SOA RRSet means that the domain is
   at the root of the zone (apex).  The domain cannot be a source of
   synthesis because that is, by definition, a descendant node (of the
   closest encloser) and a zone apex is at the top of the zone.

   Although a wildcard domain name owning an SOA RRSet can never be a
   source of synthesis, there is no reason to forbid the ownership of an
   SOA RRSet.

   For example, given this zone:

      $ORIGIN *.example.
      @                 3600 IN  SOA   &lt;SOA RDATA&gt;
                        3600     NS    ns1.example.com.
                        3600     NS    ns1.example.net.
      www               3600     TXT   "the www txt record"

   A query for www.*.example.'s TXT record would still find the "the www
   txt record" answer.  The asterisk label only becomes significant when
   <a href="#section-4.3.2">section 4.3.2</a>, step 3, part 'c' is in effect.

   Of course, there would need to be a delegation in the parent zone,
   "example." for this to work too.  This is covered in the next
   section.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.2.%20%20NS%20RRSet%20at%20a%20Wildcard%20Domain%20Name"></a><a class="selflink" href="#section-4.2" name="section-4.2">4.2</a>.  NS RRSet at a Wildcard Domain Name</span>

   With the definition of DNSSEC [RFC4033, <a href="rfc4034.html">RFC4034</a>, <a href="rfc4035.html">RFC4035</a>] now in
   place, the semantics of a wildcard domain name owning an NS RRSet has
   come to be poorly defined.  The dilemma relates to a conflict between
   the rules for synthesis in part 'c' and the fact that the resulting
   synthesis generates a record for which the zone is not authoritative.
   In a DNSSEC signed zone, the mechanics of signature management
   (generation and inclusion in a message) have become unclear.





<span class="grey">Lewis                       Standards Track                    [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc4592.html">RFC 4592</a>                      DNSEXT WCARD                     July 2006</span>


   Salient points of the working group discussion on this topic are
   summarized in <a href="#section-4.2.1">section 4.2.1</a>.

   As a result of these discussions, there is no definition given for
   wildcard domain names owning an NS RRSet.  The semantics are left
   undefined until there is a clear need to have a set defined, and
   until there is a clear direction to proceed.  Operationally,
   inclusion of wildcard NS RRSets in a zone is discouraged, but not
   barred.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.2.1.%20%20Discarded%20Notions"></a><a class="selflink" href="#section-4.2.1" name="section-4.2.1">4.2.1</a>.  Discarded Notions</span>

   Prior to DNSSEC, a wildcard domain name owning a NS RRSet appeared to
   be workable, and there are some instances in which it is found in
   deployments using implementations that support this.  Continuing to
   allow this in the specification is not tenable with DNSSEC.  The
   reason is that the synthesis of the NS RRSet is being done in a zone
   that has delegated away the responsibility for the name.  This
   "unauthorized" synthesis is not a problem for the base DNS protocol,
   but DNSSEC in affirming the authorization model for DNS exposes the
   problem.

   Outright banning of wildcards of type NS is also untenable as the DNS
   protocol does not define how to handle "illegal" data.
   Implementations may choose not to load a zone, but there is no
   protocol definition.  The lack of the definition is complicated by
   having to cover dynamic update [<a href="rfc2136.html" title='"Dynamic Updates in the Domain Name System (DNS UPDATE)"'>RFC2136</a>] and zone transfers, as well
   as loading at the master server.  The case of a client (resolver,
   caching server) getting a wildcard of type NS in a reply would also
   have to be considered.

   Given the daunting challenge of a complete definition of how to ban
   such records, dealing with existing implementations that permit the
   records today is a further complication.  There are uses of wildcard
   domain name owning NS RRSets.

   One compromise proposed would have redefined wildcards of type NS to
   not be used in synthesis, this compromise fell apart because it would
   have required significant edits to the DNSSEC signing and validation
   work.  (Again, DNSSEC catches unauthorized data.)

   With no clear consensus forming on the solution to this dilemma, and
   the realization that wildcards of type NS are a rarity in operations,
   the best course of action is to leave this open-ended until "it
   matters".






<span class="grey">Lewis                       Standards Track                    [Page 15]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc4592.html">RFC 4592</a>                      DNSEXT WCARD                     July 2006</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.3.%20%20CNAME%20RRSet%20at%20a%20Wildcard%20Domain%20Name"></a><a class="selflink" href="#section-4.3" name="section-4.3">4.3</a>.  CNAME RRSet at a Wildcard Domain Name</span>

   The issue of a CNAME RRSet owned by a wildcard domain name has
   prompted a suggested change to the last paragraph of step 3c of the
   algorithm in 4.3.2.  The changed text appears in <a href="#section-3.3.3">section 3.3.3</a> of
   this document.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.4.%20%20DNAME%20RRSet%20at%20a%20Wildcard%20Domain%20Name"></a><a class="selflink" href="#section-4.4" name="section-4.4">4.4</a>.  DNAME RRSet at a Wildcard Domain Name</span>

   Ownership of a DNAME [<a href="rfc2672.html" title='"Non-Terminal DNS Name Redirection"'>RFC2672</a>] RRSet by a wildcard domain name
   represents a threat to the coherency of the DNS and is to be avoided
   or outright rejected.  Such a DNAME RRSet represents non-
   deterministic synthesis of rules fed to different caches.  As caches
   are fed the different rules (in an unpredictable manner) the caches
   will cease to be coherent.  ("As caches are fed" refers to the
   storage in a cache of records obtained in responses by recursive or
   iterative servers.)

   For example, assume one cache, responding to a recursive request,
   obtains the following record:

         "a.b.example. DNAME foo.bar.example.net."

      and another cache obtains:

         "b.example.  DNAME foo.bar.example.net."

      both generated from the record:

         "*.example. DNAME foo.bar.example.net."

       by an authoritative server.

   The DNAME specification is not clear on whether DNAME records in a
   cache are used to rewrite queries.  In some interpretations, the
   rewrite occurs; in others, it does not.  Allowing for the occurrence
   of rewriting, queries for "sub.a.b.example. A" may be rewritten as
   "sub.foo.bar.tld. A" by the former caching server and may be
   rewritten as "sub.a.foo.bar.tld. A" by the latter.  Coherency is
   lost, and an operational nightmare ensues.

   Another justification for a recommendation to avoid the use of
   wildcard DNAME records is the observation that such a record could
   synthesize a DNAME owned by "sub.foo.bar.example." and
   "foo.bar.example.".  There is a restriction in the DNAME definition
   that no domain exist below a DNAME-owning domain; hence, the wildcard
   DNAME is to be avoided.




<span class="grey">Lewis                       Standards Track                    [Page 16]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc4592.html">RFC 4592</a>                      DNSEXT WCARD                     July 2006</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.5.%20%20SRV%20RRSet%20at%20a%20Wildcard%20Domain%20Name"></a><a class="selflink" href="#section-4.5" name="section-4.5">4.5</a>.  SRV RRSet at a Wildcard Domain Name</span>

   The definition of the SRV RRset is <a href="rfc2782.html">RFC 2782</a> [<a href="rfc2782.html" title='"A DNS RR for specifying the location of services (DNS SRV)"'>RFC2782</a>].  In the
   definition of the record, there is some confusion over the term
   "Name".  The definition reads as follows:

   # The format of the SRV RR
   ...
   #    _Service._Proto.Name TTL Class SRV Priority Weight Port Target
   ...
   #  Name
   #   The domain this RR refers to.  The SRV RR is unique in that the
   #   name one searches for is not this name; the example near the end
   #   shows this clearly.

   Do not confuse the definition "Name" with the owner name.  That is,
   once removing the _Service and _Proto labels from the owner name of
   the SRV RRSet, what remains could be a wildcard domain name but this
   is immaterial to the SRV RRSet.

   For example, if an SRV record is the following:

      _foo._udp.*.example. 10800 IN SRV 0 1 9 old-slow-box.example.

   *.example is a wildcard domain name and although it is the Name of
   the SRV RR, it is not the owner (domain name).  The owner domain name
   is "_foo._udp.*.example.", which is not a wildcard domain name.

   A query for the SRV RRSet of "_foo._udp.bar.example." (class IN),
   will result in a match of the name "*.example." (assuming there is no
   bar.example.) and not a match of the SRV record shown.  If there is
   no SRV RRSet at "*.example.", the answer section will reflect that
   (be empty or a CNAME RRset).

   The confusion is likely based on the mixture of the specification of
   the SRV RR and the description of a "use case".

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.6.%20%20DS%20RRSet%20at%20a%20Wildcard%20Domain%20Name"></a><a class="selflink" href="#section-4.6" name="section-4.6">4.6</a>.  DS RRSet at a Wildcard Domain Name</span>

   A DS RRSet owned by a wildcard domain name is meaningless and
   harmless.  This statement is made in the context that an NS RRSet at
   a wildcard domain name is undefined.  At a non-delegation point, a DS
   RRSet has no value (no corresponding DNSKEY RRSet will be used in
   DNSSEC validation).  If there is a synthesized DS RRSet, it alone
   will not be very useful as it exists in the context of a delegation
   point.





<span class="grey">Lewis                       Standards Track                    [Page 17]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc4592.html">RFC 4592</a>                      DNSEXT WCARD                     July 2006</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.7.%20%20NSEC%20RRSet%20at%20a%20Wildcard%20Domain%20Name"></a><a class="selflink" href="#section-4.7" name="section-4.7">4.7</a>.  NSEC RRSet at a Wildcard Domain Name</span>

   Wildcard domain names in DNSSEC signed zones will have an NSEC RRSet.
   Synthesis of these records will only occur when the query exactly
   matches the record.  Synthesized NSEC RRs will not be harmful as they
   will never be used in negative caching or to generate a negative
   response [<a href="rfc2308.html" title='"Negative Caching of DNS Queries (DNS NCACHE)"'>RFC2308</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.8.%20%20RRSIG%20at%20a%20Wildcard%20Domain%20Name"></a><a class="selflink" href="#section-4.8" name="section-4.8">4.8</a>.  RRSIG at a Wildcard Domain Name</span>

   RRSIG records will be present at a wildcard domain name in a signed
   zone and will be synthesized along with data sought in a query.  The
   fact that the owner name is synthesized is not a problem as the label
   count in the RRSIG will instruct the verifying code to ignore it.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.9.%20%20Empty%20Non-terminal%20Wildcard%20Domain%20Name"></a><a class="selflink" href="#section-4.9" name="section-4.9">4.9</a>.  Empty Non-terminal Wildcard Domain Name</span>

   If a source of synthesis is an empty non-terminal, then the response
   will be one of no error in the return code and no RRSet in the answer
   section.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Security%20Considerations"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Security Considerations</span>

   This document is refining the specifications to make it more likely
   that security can be added to DNS.  No functional additions are being
   made, just refining what is considered proper to allow the DNS,
   security of the DNS, and extending the DNS to be more predictable.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20References"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.1.%20Normative%20References"></a><a class="selflink" href="#section-6.1" name="section-6.1">6.1</a>. Normative References</span>

   [<a id="ref-RFC20" name="ref-RFC20">RFC20</a>]   Cerf, V., "ASCII format for network interchange", <a href="rfc20.html">RFC 20</a>,
             October 1969.

   [<a id="ref-RFC1034" name="ref-RFC1034">RFC1034</a>] Mockapetris, P., "Domain names - concepts and facilities",
             STD 13, <a href="rfc1034.html">RFC 1034</a>, November 1987.

   [<a id="ref-RFC1035" name="ref-RFC1035">RFC1035</a>] Mockapetris, P., "Domain names - implementation and
             specification", STD 13, <a href="rfc1035.html">RFC 1035</a>, November 1987.

   [<a id="ref-RFC1995" name="ref-RFC1995">RFC1995</a>] Ohta, M., "Incremental Zone Transfer in DNS", <a href="rfc1995.html">RFC 1995</a>,
             August 1996.

   [<a id="ref-RFC2119" name="ref-RFC2119">RFC2119</a>] Bradner, S., "Key words for use in RFCs to Indicate
             Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.





<span class="grey">Lewis                       Standards Track                    [Page 18]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-19" id="page-19" name="page-19"> </a>
<span class="grey"><a href="rfc4592.html">RFC 4592</a>                      DNSEXT WCARD                     July 2006</span>


   [<a id="ref-RFC2308" name="ref-RFC2308">RFC2308</a>] Andrews, M., "Negative Caching of DNS Queries (DNS
             NCACHE)", <a href="rfc2308.html">RFC 2308</a>, March 1998.

   [<a id="ref-RFC2672" name="ref-RFC2672">RFC2672</a>] Crawford, M., "Non-Terminal DNS Name Redirection", <a href="rfc2672.html">RFC</a>
             <a href="rfc2672.html">2672</a>, August 1999.

   [<a id="ref-RFC2782" name="ref-RFC2782">RFC2782</a>] Gulbrandsen, A., Vixie, P., and L. Esibov, "A DNS RR for
             specifying the location of services (DNS SRV)", <a href="rfc2782.html">RFC 2782</a>,
             February 2000.

   [<a id="ref-RFC4033" name="ref-RFC4033">RFC4033</a>] Arends, R., Austein, R., Larson, M., Massey, D., and S.
             Rose, "DNS Security Introduction and Requirements", <a href="rfc4033.html">RFC</a>
             <a href="rfc4033.html">4033</a>, March 2005.

   [<a id="ref-RFC4034" name="ref-RFC4034">RFC4034</a>] Arends, R., Austein, R., Larson, M., Massey, D., and S.
             Rose, "Resource Records for the DNS Security Extensions",
             <a href="rfc4034.html">RFC 4034</a>, March 2005.

   [<a id="ref-RFC4035" name="ref-RFC4035">RFC4035</a>] Arends, R., Austein, R., Larson, M., Massey, D., and S.
             Rose, "Protocol Modifications for the DNS Security
             Extensions", <a href="rfc4035.html">RFC 4035</a>, March 2005.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.2.%20%20Informative%20References"></a><a class="selflink" href="#section-6.2" name="section-6.2">6.2</a>.  Informative References</span>

   [<a id="ref-RFC2136" name="ref-RFC2136">RFC2136</a>] Vixie, P., Thomson, S., Rekhter, Y., and J. Bound, "Dynamic
             Updates in the Domain Name System (DNS UPDATE)", <a href="rfc2136.html">RFC 2136</a>,
             April 1997.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20Others%20Contributing%20to%20the%20Document"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  Others Contributing to the Document</span>

   This document represents the work of a large working group.  The
   editor merely recorded its collective wisdom.

   Comments on this document can be sent to the editor or the mailing
   list for the DNSEXT WG, namedroppers@ops.ietf.org.

Editor's Address

   Edward Lewis
   NeuStar
   46000 Center Oak Plaza
   Sterling, VA
   20166, US

   Phone: +1-571-434-5468
   EMail: ed.lewis@neustar.biz





<span class="grey">Lewis                       Standards Track                    [Page 19]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-20" id="page-20" name="page-20"> </a>
<span class="grey"><a href="rfc4592.html">RFC 4592</a>                      DNSEXT WCARD                     July 2006</span>


Full Copyright Statement

   Copyright (C) The Internet Society (2006).

   This document is subject to the rights, licenses and restrictions
   contained in <a href="https://tools.ietf.org/html/bcp78">BCP 78</a>, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY AND THE INTERNET
   ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR IMPLIED,
   INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE
   INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and <a href="https://tools.ietf.org/html/bcp79">BCP 79</a>.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   <a href="http://www.ietf.org/ipr">http://www.ietf.org/ipr</a>.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.

Acknowledgement

   Funding for the RFC Editor function is provided by the IETF
   Administrative Support Activity (IASA).







Lewis                       Standards Track                    [Page 20]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc4592 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:41 GMT --></html>