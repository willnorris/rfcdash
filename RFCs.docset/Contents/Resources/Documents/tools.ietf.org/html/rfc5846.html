<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<!-- Mirrored from tools.ietf.org/html/rfc5846 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:33 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head profile="http://dublincore.org/documents/2008/08/04/dc-html/">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="robots" content="index,follow" />
    <meta name="creator" content="rfcmarkup version 1.126" />
    <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" />
<meta name="DC.Relation.Replaces" content="draft-muhanna-mext-binding-revocation" />
<meta name="DC.Identifier" content="urn:ietf:rfc:5846" />
<meta name="DC.Date.Issued" content="June, 2010" />
<meta name="DC.Creator" content="Khalil, Mohamed" />
<meta name="DC.Creator" content="Yegani, Parviz" />
<meta name="DC.Creator" content="Muhanna, Ahmad" />
<meta name="DC.Creator" content="Chowdhury, Kuntal" />
<meta name="DC.Creator" content="Gundavelli, Sri" />
<meta name="DC.Description.Abstract" content="This document defines the revocation semantics for terminating a
mobile node's mobility session and associated resources. These
semantics are generic enough and can be used by mobility entities in
the case of Client Mobile IPv6 and its extensions. This mechanism
allows the mobility entity which initiates the revocation procedure to
request its corresponding one to terminate either one, multiple or all
specified binding cache entries." />
<meta name="DC.Title" content="Binding Revocation for IPv6 Mobility" />

    <link rel="icon" href="https://tools.ietf.org/images/rfc.png" type="image/png" />
    <link rel="shortcut icon" href="https://tools.ietf.org/images/rfc.png" type="image/png" />
    <title>RFC 5846 - Binding Revocation for IPv6 Mobility</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div onmouseover="this.style.cursor='pointer';"
         onclick="showElem('legend');"
         onmouseout="hideElem('legend')"
	 style="height: 6px; position: absolute;"
         class="pre noprint docinfo bgblue"
         title="Click for colour legend." >                                                                        </div>
      <div id="legend"
           class="docinfo noprint pre legend"
           style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; "
           onmouseover="showElem('legend');"
           onmouseout="hideElem('legend');">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc5846.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc5846" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-mext-binding-revocation" title="draft-ietf-mext-binding-revocation">draft-ietf-mext...</a>] [<a href='https://datatracker.ietf.org/doc/rfc5846' title='IESG Datatracker information for this document'>Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc5846" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc5846" title="Side-by-side diff">Diff2</a>] [<a href="https://datatracker.ietf.org/ipr/search/?rfc=5846&amp;submit=rfc" title="IPR disclosures related to this document">IPR</a>]   </span><br />
<span class="pre noprint docinfo">                                                                        </span><br />
<span class="pre noprint docinfo">                                                       PROPOSED STANDARD</span><br />
<span class="pre noprint docinfo">                                                                        </span><br />
<pre>
Internet Engineering Task Force (IETF)                        A. Muhanna
Request for Comments: 5846                                     M. Khalil
Category: Standards Track                                       Ericsson
ISSN: 2070-1721                                            S. Gundavelli
                                                            K. Chowdhury
                                                                   Cisco
                                                               P. Yegani
                                                        Juniper Networks
                                                               June 2010


                  <span class="h1">Binding Revocation for IPv6 Mobility</span>

Abstract

   This document defines a binding revocation mechanism to terminate a
   mobile node's mobility session and the associated resources.  This
   mechanism can be used both with base Mobile IPv6 and its extensions,
   such as Proxy Mobile IPv6.  The mechanism allows the mobility entity
   which initiates the revocation procedure to request its peer to
   terminate either one, multiple or all specified Binding Cache
   entries.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="rfc5741.html#section-2">Section&nbsp;2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc5846">http://www.rfc-editor.org/info/rfc5846</a>.















<span class="grey">Muhanna, et al.              Standards Track                    [Page 1]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-2" id="page-2" href="#page-2" class="invisible"> </a>
<span class="grey"><a href="rfc5846.html">RFC 5846</a>          Binding Revocation for IPv6 Mobility         June 2010</span>


Copyright Notice

   Copyright (c) 2010 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

   This document may contain material from IETF Documents or IETF
   Contributions published or made publicly available before November
   10, 2008.  The person(s) controlling the copyright in some of this
   material may not have granted the IETF Trust the right to allow
   modifications of such material outside the IETF Standards Process.
   Without obtaining an adequate license from the person(s) controlling
   the copyright in such materials, this document may not be modified
   outside the IETF Standards Process, and derivative works of it may
   not be created outside the IETF Standards Process, except to format
   it for publication as an RFC or to translate it into languages other
   than English.

























<span class="grey">Muhanna, et al.              Standards Track                    [Page 2]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-3" id="page-3" href="#page-3" class="invisible"> </a>
<span class="grey"><a href="rfc5846.html">RFC 5846</a>          Binding Revocation for IPv6 Mobility         June 2010</span>


Table of Contents

   <a href="#section-1">1</a>.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-4">4</a>
   <a href="#section-2">2</a>.  Conventions and Terminology  . . . . . . . . . . . . . . . . .  <a href="#page-4">4</a>
     <a href="#section-2.1">2.1</a>.  Conventions Used in This Document  . . . . . . . . . . . .  <a href="#page-4">4</a>
     <a href="#section-2.2">2.2</a>.  Terminology  . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-4">4</a>
   <a href="#section-3">3</a>.  Binding Revocation Protocol and Use Cases Overview . . . . . .  <a href="#page-5">5</a>
     <a href="#section-3.1">3.1</a>.  Binding Revocation Protocol  . . . . . . . . . . . . . . .  <a href="#page-5">5</a>
     <a href="#section-3.2">3.2</a>.  MIPv6 and DSMIP6 Use Case  . . . . . . . . . . . . . . . .  <a href="#page-6">6</a>
     <a href="#section-3.3">3.3</a>.  Multiple Care-of Addresses (MCoA) Use Case . . . . . . . .  <a href="#page-7">7</a>
     <a href="#section-3.4">3.4</a>.  Proxy MIPv6 Use Case . . . . . . . . . . . . . . . . . . .  <a href="#page-8">8</a>
       <a href="#section-3.4.1">3.4.1</a>.  Local Mobility Anchor Initiates PMIPv6 Revocation  . .  <a href="#page-9">9</a>
       <a href="#section-3.4.2">3.4.2</a>.  Mobile Access Gateway Revokes Bulk PMIPv6 Bindings . . <a href="#page-10">10</a>
   <a href="#section-4">4</a>.  Binding Revocation Messages over IPv4 Transport Network  . . . <a href="#page-10">10</a>
   <a href="#section-5">5</a>.  Binding Revocation Message . . . . . . . . . . . . . . . . . . <a href="#page-11">11</a>
     <a href="#section-5.1">5.1</a>.  Binding Revocation Indication Message  . . . . . . . . . . <a href="#page-13">13</a>
     <a href="#section-5.2">5.2</a>.  Binding Revocation Acknowledgement Message . . . . . . . . <a href="#page-16">16</a>
   <a href="#section-6">6</a>.  Binding Revocation Process Operation . . . . . . . . . . . . . <a href="#page-18">18</a>
     <a href="#section-6.1">6.1</a>.  Sending Binding Revocation Message . . . . . . . . . . . . <a href="#page-18">18</a>
       <a href="#section-6.1.1">6.1.1</a>.  Sending Binding Revocation Indication  . . . . . . . . <a href="#page-18">18</a>
       <a href="#section-6.1.2">6.1.2</a>.  Sending Binding Revocation Acknowledgement . . . . . . <a href="#page-19">19</a>
     <a href="#section-6.2">6.2</a>.  Receiving Binding Revocation Message . . . . . . . . . . . <a href="#page-20">20</a>
       <a href="#section-6.2.1">6.2.1</a>.  Receiving Binding Revocation Indication  . . . . . . . <a href="#page-20">20</a>
       <a href="#section-6.2.2">6.2.2</a>.  Receiving Binding Revocation Acknowledgement . . . . . <a href="#page-21">21</a>
     <a href="#section-6.3">6.3</a>.  Retransmission of Binding Revocation Indication  . . . . . <a href="#page-22">22</a>
   <a href="#section-7">7</a>.  Home Agent Operation . . . . . . . . . . . . . . . . . . . . . <a href="#page-22">22</a>
   <a href="#section-8">8</a>.  Local Mobility Anchor Operation  . . . . . . . . . . . . . . . <a href="#page-23">23</a>
     <a href="#section-8.1">8.1</a>.  Sending Binding Revocation Indication  . . . . . . . . . . <a href="#page-23">23</a>
     <a href="#section-8.2">8.2</a>.  Receiving Binding Revocation Indication  . . . . . . . . . <a href="#page-27">27</a>
   <a href="#section-9">9</a>.  Mobile Access Gateway Operation  . . . . . . . . . . . . . . . <a href="#page-29">29</a>
     <a href="#section-9.1">9.1</a>.  Receiving Binding Revocation Indication  . . . . . . . . . <a href="#page-29">29</a>
     <a href="#section-9.2">9.2</a>.  Sending Binding Revocation Indication  . . . . . . . . . . <a href="#page-31">31</a>
   <a href="#section-10">10</a>. Mobile Node Operation  . . . . . . . . . . . . . . . . . . . . <a href="#page-32">32</a>
   <a href="#section-11">11</a>. Protocol Configuration Variables . . . . . . . . . . . . . . . <a href="#page-34">34</a>
   <a href="#section-12">12</a>. IANA Considerations  . . . . . . . . . . . . . . . . . . . . . <a href="#page-34">34</a>
   <a href="#section-13">13</a>. Security Considerations  . . . . . . . . . . . . . . . . . . . <a href="#page-36">36</a>
   <a href="#section-14">14</a>. Acknowledgements . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-37">37</a>
   <a href="#section-15">15</a>. References . . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-37">37</a>
     <a href="#section-15.1">15.1</a>. Normative References . . . . . . . . . . . . . . . . . . . <a href="#page-37">37</a>
     <a href="#section-15.2">15.2</a>. Informative References . . . . . . . . . . . . . . . . . . <a href="#page-38">38</a>











<span class="grey">Muhanna, et al.              Standards Track                    [Page 3]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-4" id="page-4" href="#page-4" class="invisible"> </a>
<span class="grey"><a href="rfc5846.html">RFC 5846</a>          Binding Revocation for IPv6 Mobility         June 2010</span>


<span class="h2"><a class="selflink" name="section-1" href="#section-1">1</a>.  Introduction</span>

   In the case of Mobile IPv6 and for administrative reasons, sometimes
   it becomes necessary to inform the mobile node that its registration
   has been revoked and the mobile node is no longer able to receive IP
   mobility service for its Home Address.  A similar Mobile IPv4
   registration revocation mechanism [<a href="rfc3543.html" title="&quot;Registration Revocation in Mobile IPv4&quot;">RFC3543</a>] has been specified by the
   IETF for providing a revocation mechanism for sessions that were
   established using Mobile IPv4 registration [<a href="rfc3344.html" title="&quot;IP Mobility Support for IPv4&quot;">RFC3344</a>].

   This document specifies a binding revocation mechanism that can be
   used to revoke a mobile node's mobility session(s).  The same
   mechanism can be used to revoke bindings created using Mobile IPv6
   [<a href="rfc3775.html" title="&quot;Mobility Support in IPv6&quot;">RFC3775</a>] or any of its extensions, e.g., Proxy Mobile IPv6
   [<a href="rfc5213.html" title="&quot;Proxy Mobile IPv6&quot;">RFC5213</a>].  The proposed revocation mechanism uses a new Mobility
   Header (MH) type 16 for revocation signaling that is applicable to
   Mobile IPv6 [<a href="rfc3775.html" title="&quot;Mobility Support in IPv6&quot;">RFC3775</a>] and Proxy Mobile IPv6 [<a href="rfc5213.html" title="&quot;Proxy Mobile IPv6&quot;">RFC5213</a>] and can be used
   by any two IP mobility entities.  As an example, this mechanism
   allows a local mobility anchor (LMA), involved in providing IP
   mobility services to a mobile node, to notify the mobile access
   gateway (MAG) of the termination of that mobile node binding
   registration.  In another example, a mobile access gateway can use
   this mechanism to notify its local mobility anchor peer with a bulk
   termination of all or a subset of proxy mobile IPv6 (PMIPv6) bindings
   that are registered with the local mobility anchor and currently
   being served by the mobile access gateway.  Any mobility entity is
   allowed to revoke only the registration of those mobile node(s)
   mobility sessions that are currently registered with it.

<span class="h2"><a class="selflink" name="section-2" href="#section-2">2</a>.  Conventions and Terminology</span>

<span class="h3"><a class="selflink" name="section-2.1" href="#section-2.1">2.1</a>.  Conventions Used in This Document</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [<a href="rfc2119.html" title="&quot;Key words for use in RFCs to Indicate Requirement Levels&quot;">RFC2119</a>].

<span class="h3"><a class="selflink" name="section-2.2" href="#section-2.2">2.2</a>.  Terminology</span>

   All the general mobility related terminology and abbreviations are to
   be interpreted as defined in the Mobile IPv6 [<a href="rfc3775.html" title="&quot;Mobility Support in IPv6&quot;">RFC3775</a>], Proxy Mobile
   IPv6 [<a href="rfc5213.html" title="&quot;Proxy Mobile IPv6&quot;">RFC5213</a>] and IPv4 Support for Proxy Mobile IPv6 [<a href="rfc5844.html" title="&quot;IPv4 Support for Proxy Mobile IPv6&quot;">RFC5844</a>]
   specifications.  The following terms are used in this specification.








<span class="grey">Muhanna, et al.              Standards Track                    [Page 4]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-5" id="page-5" href="#page-5" class="invisible"> </a>
<span class="grey"><a href="rfc5846.html">RFC 5846</a>          Binding Revocation for IPv6 Mobility         June 2010</span>


   Initiator

      The mobility node that initiates the binding revocation procedure
      by sending a Binding Revocation Indication message to its peer,
      e.g., home agent, local mobility anchor, or mobile access gateway.

   Responder

      The mobility node that receives the Binding Revocation Indication
      message and responds with a Binding Revocation Acknowledgement
      message, e.g., mobile node, mobile access gateway, or local
      mobility anchor.

<span class="h2"><a class="selflink" name="section-3" href="#section-3">3</a>.  Binding Revocation Protocol and Use Cases Overview</span>

   This specification specifies a generic binding revocation mechanism
   where a mobility node can communicate to the mobile node or another
   mobility node the identity of the mobile node registration binding
   that is being terminated.  In the case when this mechanism is used
   for bulk termination or multiple bindings, the identities of these
   bindings are communicated to the mobile node or mobility node using
   the same generic mechanism.  The following subsections present the
   protocol overview and applicable use cases.

<span class="h3"><a class="selflink" name="section-3.1" href="#section-3.1">3.1</a>.  Binding Revocation Protocol</span>

   In the case of Mobile IPv6, if the home network decides to terminate
   the service of the mobile node, the home agent sends a Binding
   Revocation Indication (BRI) message to the mobile node.  The home
   agent includes the home address (HoA) of the mobile node in the Type
   2 routing header as specified in [<a href="rfc3775.html" title="&quot;Mobility Support in IPv6&quot;">RFC3775</a>] to indicate the impacted
   mobile node binding.  In the case of Dual Stack Mobile IPv6 (DSMIPv6)
   [<a href="rfc5555.html" title="&quot;Mobile IPv6 Support for Dual Stack Hosts and Routers&quot;">RFC5555</a>], the home agent may include the IPv4 Home Address option
   with the home IPv4 address assigned by the mobile node.
   Additionally, if the mobile node registered multiple care-of
   addresses [<a href="rfc5648.html" title="&quot;Multiple Care-of Addresses Registration&quot;">RFC5648</a>], the home agent includes the Binding Identifier
   (BID) option(s) in the Binding Revocation Indication message to
   identify which binding is being revoked.  When the mobile node
   receives a Binding Revocation Indication message with its HoA
   included in the Type 2 routing header, the mobile node responds by
   sending a Binding Revocation Acknowledgement (BRA) message.

   Similarly, in the case of Proxy Mobile IPv6 [<a href="rfc5213.html" title="&quot;Proxy Mobile IPv6&quot;">RFC5213</a>], the revocation
   procedure can be initiated by the local mobility anchor by sending a
   Binding Revocation Indication message to communicate the termination
   of a mobile node registration binding to the mobile access gateway.
   In this case, the local mobility anchor includes the mobile node Home
   Network Prefix (MN-HNP) option [<a href="rfc5213.html" title="&quot;Proxy Mobile IPv6&quot;">RFC5213</a>] and the MN-ID option



<span class="grey">Muhanna, et al.              Standards Track                    [Page 5]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-6" id="page-6" href="#page-6" class="invisible"> </a>
<span class="grey"><a href="rfc5846.html">RFC 5846</a>          Binding Revocation for IPv6 Mobility         June 2010</span>


   [<a name="ref-RFC4283" id="ref-RFC4283">RFC4283</a>] to indicate to the mobility access gateway the identity of
   the PMIPv6 binding that needs to be terminated.  When the mobile
   access gateway receives the Binding Revocation Indication message,
   the mobile access gateway responds to the local mobility anchor by
   sending a Binding Revocation Acknowledgement message.

   On the other hand, the mobile access gateway usually sends a de-
   registration message by sending a Proxy Binding Update with a
   lifetime of zero to indicate to the local mobility anchor of the
   termination of the PMIPv6 mobile node binding registration.  In this
   case, the mobile access gateway includes the MN-HNP option, the MN-ID
   option, and all other required mobility options as per [<a href="rfc5213.html" title="&quot;Proxy Mobile IPv6&quot;">RFC5213</a>] in
   order for the local mobility anchor to identify the mobile node
   PMIPv6 binding.  Additionally, in the case when the mobile access
   gateway communicates a bulk termination of PMIPv6 mobility sessions,
   the mobile access gateway sends a Binding Revocation Indication
   message with the Global (G) bit set and includes the mobile access
   gateway identity in the MN-ID option, see <a href="#section-9.2">Section 9.2</a> and
   <a href="#section-8.2">Section 8.2</a>.  When the local mobility anchor receives such a Binding
   Revocation Indication message, it ensures that the mobile access
   gateway is authorized to send such a bulk termination message, see
   <a href="#section-13">Section 13</a>, and then processes the Binding Revocation Indication
   message accordingly.  If the local mobility anchor processes the
   Binding Revocation Indication message successfully, the local
   mobility anchor responds to the mobile access gateway by sending
   Binding Revocation Acknowledgement message.

   In any of the above cases, the initiator of the binding revocation
   procedure, e.g., home agent, local mobility anchor, or mobile access
   gateway, uses the Revocation Trigger field in the Binding Revocation
   Indication message to indicate to the receiving node the reason for
   initiating the revocation procedure.

<span class="h3"><a class="selflink" name="section-3.2" href="#section-3.2">3.2</a>.  MIPv6 and DSMIP6 Use Case</span>

   The binding revocation mechanism is applicable to Mobile IPv6 and
   DSMIPv6 session(s) when the home agent needs to inform the mobile
   node that its binding registration has been revoked, e.g., for an
   administrative reason.  This mechanism enables the user or the mobile
   node to react to the revocation, e.g., reinstate its interrupted
   Mobile IPv6 services.

   In this case, the home agent sends a Binding Revocation Indication
   message to indicate to the mobile node that its current mobile IPv6
   (MIPv6) binding has been revoked and it is no longer able to receive
   IP mobility service.  The home agent includes the HoA in a Type 2
   routing header as used in [<a href="rfc3775.html" title="&quot;Mobility Support in IPv6&quot;">RFC3775</a>] and sets the Revocation Trigger
   field to a proper value, e.g., Administrative Reason.  In the case of



<span class="grey">Muhanna, et al.              Standards Track                    [Page 6]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-7" id="page-7" href="#page-7" class="invisible"> </a>
<span class="grey"><a href="rfc5846.html">RFC 5846</a>          Binding Revocation for IPv6 Mobility         June 2010</span>


   a DSMIPv6 session, the home agent may additionally include the
   mobile-node-assigned IPv4 Home Address in the IPv4 Home Address
   option.  When the mobile node receives the Binding Revocation
   Indication message, it sends a Binding Revocation Acknowledgement
   message to the home agent.  Figure 1 illustrates the message
   sequencing when a home agent revokes a mobile node binding
   registration.

         MN                                         HA
         |                                           |
         |           HoA in Type 2 Routing Hdr       |
         |&lt;&lt;&lt;------------...  +  ...-----------------|
         |      BRI [seq.#, Revocation Trigger]      |
         |                                           |
         |                                           |
         | BRA (HoA in Dest. Option)[seq.#, Status]  |
         |----------------------------------------&gt;&gt;&gt;|
         |                                           |
         |                                           |

      Figure 1: Home Agent Revokes a Mobile Node Binding Registration

<span class="h3"><a class="selflink" name="section-3.3" href="#section-3.3">3.3</a>.  Multiple Care-of Addresses (MCoA) Use Case</span>

   In the case of multiple care-of address registrations [<a href="rfc5648.html" title="&quot;Multiple Care-of Addresses Registration&quot;">RFC5648</a>], the
   home agent maintains a different binding for each care-of address and
   home address pair.  These bindings are also indexed and identified
   during the mobile node registration using a BID mobility option.  The
   HA may revoke one or multiple bindings for the same mobile node home
   address.

   If the home agent revokes a single binding for a mobile node with
   multiple care-of address registrations, the home agent sends a
   Binding Revocation Indication message to the mobile node with the
   corresponding BID option included.  If more than one of the mobile
   node registered care-of addresses needs to be revoked, the home agent
   includes all the corresponding BID options in the same Binding
   Revocation Indication message.  Figure 2 illustrates the message flow
   when the home agent revokes two registered care-of addresses for the
   same mobile node in a single Binding Revocation Indication message.











<span class="grey">Muhanna, et al.              Standards Track                    [Page 7]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-8" id="page-8" href="#page-8" class="invisible"> </a>
<span class="grey"><a href="rfc5846.html">RFC 5846</a>          Binding Revocation for IPv6 Mobility         June 2010</span>


                                                    HA Binding Cache
                                                    ================
                                                    MN-BID1 [CoA1+HoA]
   MN                                           HA  MN-BID2 [CoA2+HoA]
    |                                            |  MN-BID3 [CoA3+HoA]
    |                                            |  MN-BID4 [CoA4+HoA]
    |             HoA in Type 2 Routing Hdr      |
    |&lt;&lt;&lt;&lt;--------------  +  ---------------------|
    |     BRI [seq.#, R. Trigger, BID1, BID4]    |
    |                                            |
    |                                            |
    | BRA (HoA in Dest. Option) [seq.#, Status]  |
    |----------------------------------------&gt;&gt;&gt;&gt;|
    |                                            |
    |                                            |

    Figure 2: Home Agent Revokes MN's Specific Care-of Address Bindings

   Additionally, the home agent may revoke all of the mobile node
   registered bindings by sending a BRI message without including any
   BID options while the HoA is included in the Type 2 routing header.
   Figure 1 illustrates the message flow when the home agent revokes all
   registered care-of address bindings for a mobile node in a single
   Binding Revocation Indication message.

<span class="h3"><a class="selflink" name="section-3.4" href="#section-3.4">3.4</a>.  Proxy MIPv6 Use Case</span>

   Since the mobile node does not participate in the mobility mechanism
   in the case of PMIPv6, there are many scenarios where the Binding
   Revocation mechanism is needed to clean resources and make sure that
   the mobility entities, i.e., mobile access gateway and local mobility
   anchor, are always synchronized with respect to the status of the
   existing PMIPv6 bindings.  The binding revocation mechanism is
   generic enough that it can be used for all Proxy Mobile IPv6
   scenarios that follow the [<a href="rfc5213.html" title="&quot;Proxy Mobile IPv6&quot;">RFC5213</a>] and [<a href="rfc5844.html" title="&quot;IPv4 Support for Proxy Mobile IPv6&quot;">RFC5844</a>] specifications.

   When the mobile access gateway receives a Binding Revocation
   Indication message as in <a href="#section-9.1">Section 9.1</a>, the mobile access gateway sends
   a Binding Revocation Acknowledgement message to the local mobility
   anchor following the rules described in <a href="#section-6.1.2">Section 6.1.2</a>.  Similarly, if
   the local mobility anchor receives a Binding Revocation Indication
   message, the local mobility anchor responds to the mobile access
   gateway by sending a Binding Revocation Acknowledgement message.








<span class="grey">Muhanna, et al.              Standards Track                    [Page 8]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-9" id="page-9" href="#page-9" class="invisible"> </a>
<span class="grey"><a href="rfc5846.html">RFC 5846</a>          Binding Revocation for IPv6 Mobility         June 2010</span>


<span class="h4"><a class="selflink" name="section-3.4.1" href="#section-3.4.1">3.4.1</a>.  Local Mobility Anchor Initiates PMIPv6 Revocation</span>

   The local mobility anchor may send a Binding Revocation Indication
   message with the appropriate revocation trigger value to the mobile
   access gateway that hosts a specific PMIPv6 binding to indicate that
   the mobile node binding has been terminated and the mobile access
   gateway can clean up the applicable resources.  When the mobile
   access gateway receives a Binding Revocation Indication message, the
   mobile access gateway identifies the respective binding and it sends
   a Binding Revocation Acknowledgement message to the local mobility
   anchor.  In this case, the mobile access gateway could terminate the
   IPv6 or IPv4 mobility session on the access link and notify the
   mobile node as in <a href="#section-9.1">Section 9.1</a>.

   As an example, Figure 3, illustrates the message sequence for
   revoking a mobile node binding at the source mobile access gateway
   during the mobile node inter-MAG handover.  During the inter-MAG
   handover, the mobile node moves from the source MAG to the target
   MAG.  The target MAG sends a Proxy Binding Update with the new
   care-of address to the local mobility anchor to update the mobile
   node's point of attachment.  Since the mobile node binding at the
   local mobility anchor points to the source MAG and upon receiving the
   Proxy Binding Update from the target MAG, the local mobility anchor
   updates the MN Binding Cache entry (BCE) and sends a Proxy Binding
   Acknowledgement to the target MAG.  The local mobility anchor can
   send a Binding Revocation Indication message with the appropriate
   revocation trigger value, e.g., inter-MAG handover - different Access
   Types, to the source MAG in order to clean up the applicable
   resources reserved for the specified mobile node binding.  The source
   mobile access gateway acknowledges the Binding Revocation Indication
   message by sending a Binding Revocation Acknowledgement message to
   indicate the success or failure of the termination of the mobile
   node's binding.

   The process identified above can also be used by the local mobility
   anchor in scenarios other than the inter-MAG handover with the proper
   revocation trigger value to indicate to the peer mobile access
   gateway that a specific PMIPv6 binding or bindings have been revoked.













<span class="grey">Muhanna, et al.              Standards Track                    [Page 9]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-10" id="page-10" href="#page-10" class="invisible"> </a>
<span class="grey"><a href="rfc5846.html">RFC 5846</a>          Binding Revocation for IPv6 Mobility         June 2010</span>


             oldMAG       newMAG                          LMA
               |             |                            |
               |             |        PBU                 |
               |             |---------------------------&gt;|
               |             |                      PBU triggers
               |             |                   BRI Msg to oldMAG
               |             |                            |
               |             |        PBA                 |
               |             |&lt;---------------------------|
               |             |                            |
               |             |                            |
               |    BRI [seq.#, R. Trigger, P bit, NAI]   |
               |&lt;-----------------------------------------|
               |             |                            |
               |             |                            |
               |             |                            |
               |             |                            |
               |        BRA [seq.#, Status, P bit]        |
               |-----------------------------------------&gt;|
               |             |                            |
               |             |                            |

    Figure 3: LMA Revokes an MN Registration During Inter-MAG Handover

   In addition, the local mobility anchor can send a Binding Revocation
   Indication message to indicate that all bindings that are hosted by
   the peer mobile access gateway and registered with the local mobility
   anchor are being revoked by setting the Global (G) bit as described
   in <a href="#section-8.1">Section 8.1</a>.

<span class="h4"><a class="selflink" name="section-3.4.2" href="#section-3.4.2">3.4.2</a>.  Mobile Access Gateway Revokes Bulk PMIPv6 Bindings</span>

   The mobile access gateway sends a BRI message with the Global (G) bit
   set and the Revocation Trigger field set to "Per-Peer Policy" to
   indicate that all mobility bindings that are registered at the local
   mobility anchor and attached to the mobile access gateway are being
   revoked as in <a href="#section-9.2">Section 9.2</a>.  When the local mobility anchor receives
   this Binding Revocation Indication message from the specified mobile
   access gateway, the local mobility anchor first checks if the mobile
   access gateway is authorized to use global revocations, then it
   responds with the appropriate status code by sending a Binding
   Revocation Acknowledgement message as in <a href="#section-6.1.2">Section 6.1.2</a>.

<span class="h2"><a class="selflink" name="section-4" href="#section-4">4</a>.  Binding Revocation Messages over IPv4 Transport Network</span>

   In some deployments, the network between the mobile access gateway
   and the local mobility anchor may only support IPv4 transport.
   Another case is when a mobile node that supports client mobile IPv6



<span class="grey">Muhanna, et al.              Standards Track                   [Page 10]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-11" id="page-11" href="#page-11" class="invisible"> </a>
<span class="grey"><a href="rfc5846.html">RFC 5846</a>          Binding Revocation for IPv6 Mobility         June 2010</span>


   roams to an access network where only IPv4 addressing and transport
   is supported.  In this case, the mobile node is required to register
   an IPv4 home address with its home agent using a mobile IPv6 Binding
   Update message.

   If the Proxy Binding Update and Proxy Binding Acknowledgement
   messages or the Binding Update and Binding Acknowledgement messages
   are sent using UDP encapsulation [<a href="rfc5844.html" title="&quot;IPv4 Support for Proxy Mobile IPv6&quot;">RFC5844</a>] [<a href="rfc5555.html" title="&quot;Mobile IPv6 Support for Dual Stack Hosts and Routers&quot;">RFC5555</a>], then the
   Binding Revocation Messages are sent using the same UDP
   encapsulation.  The same UDP source and destination port numbers and
   IPv4 addresses used for exchanging the Proxy Binding Update and Proxy
   Binding Acknowledgement or the Binding Update and Binding
   Acknowledgement messages MUST be used when transporting Binding
   Revocation Messages over IPv4 using UDP encapsulation.  For example,
   the source UDP port number, the destination UDP port number, the
   source IPv4 address, and the destination IPv4 address of the Binding
   Revocation Indication message are set to the destination UDP port
   number, the source UDP port number, destination IPv4 address, and
   source IPv4 address of the latest received and successfully processed
   Proxy Binding Update or Binding Update message, respectively.  For
   more details on tunneling Proxy Mobile IPv6 and Mobile IPv6 signaling
   messages over IPv4, see [<a href="rfc5844.html" title="&quot;IPv4 Support for Proxy Mobile IPv6&quot;">RFC5844</a>] and [<a href="rfc5555.html" title="&quot;Mobile IPv6 Support for Dual Stack Hosts and Routers&quot;">RFC5555</a>], respectively.

<span class="h2"><a class="selflink" name="section-5" href="#section-5">5</a>.  Binding Revocation Message</span>

   This section defines the Binding Revocation Message format using an
   MH Type 16 as illustrated in Figure 4.  The value in the Binding
   Revocation Type field defines whether the Binding Revocation Message
   is a Binding Revocation Indication or Binding Revocation
   Acknowledgement.  If the Binding Revocation Type field is set to 1,
   the Binding Revocation Message is a Binding Revocation Indication as
   in <a href="#section-5.1">Section 5.1</a>.  However, if the value is 2, it is a Binding
   Revocation Acknowledgement message as in <a href="#section-5.2">Section 5.2</a>.

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       | Payload Proto |  Header Len   |   MH Type     |   Reserved    |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |           Checksum            |  B.R. Type    |               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+               +
       |                                                               |
       .            Binding Revocation Message Data                    .
       |                                                               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                   Figure 4: Binding Revocation Message




<span class="grey">Muhanna, et al.              Standards Track                   [Page 11]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-12" id="page-12" href="#page-12" class="invisible"> </a>
<span class="grey"><a href="rfc5846.html">RFC 5846</a>          Binding Revocation for IPv6 Mobility         June 2010</span>


   Payload Proto

      8-bit selector.  See [<a href="rfc3775.html" title="&quot;Mobility Support in IPv6&quot;">RFC3775</a>] for more details.

   Header Len

      8-bit unsigned integer.  Representing the length of the Mobility
      Header in units of 8 octets, excluding the first 8 octets.  See
      [<a href="rfc3775.html" title="&quot;Mobility Support in IPv6&quot;">RFC3775</a>] for more details.

   MH Type

      16, which identifies the mobility message as a Binding Revocation
      Message.

   Reserved

      8-bit field reserved for future use.  The value MUST be
      initialized to zero by the sender and MUST be ignored by the
      receiver.

   Checksum

      16-bit unsigned integer.  This field contains the checksum of the
      Mobility Header.  The checksum is calculated as described in
      [<a href="rfc3775.html" title="&quot;Mobility Support in IPv6&quot;">RFC3775</a>].

   Binding Revocation Type

      8-bit unsigned integer.  It defines the type of the Binding
      Revocation Message.  It can be assigned one of the following
      values:

          0  Reserved

          1  Binding Revocation Indication

          2  Binding Revocation Acknowledgement

          All other values are unassigned

   Binding Revocation Message Data

      The Binding Revocation Message Data follows the Binding Revocation
      Message format that is defined in this document for the specified
      value in the Binding Revocation Type field.  In this document, it
      is either a Binding Revocation Indication as in <a href="#section-5.1">Section 5.1</a> or
      Binding Revocation Acknowledgement as in <a href="#section-5.2">Section 5.2</a>.



<span class="grey">Muhanna, et al.              Standards Track                   [Page 12]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-13" id="page-13" href="#page-13" class="invisible"> </a>
<span class="grey"><a href="rfc5846.html">RFC 5846</a>          Binding Revocation for IPv6 Mobility         June 2010</span>


<span class="h3"><a class="selflink" name="section-5.1" href="#section-5.1">5.1</a>.  Binding Revocation Indication Message</span>

   The Binding Revocation Indication (BRI) message is a Binding
   Revocation Message that has an MH type 16 and a Binding Revocation
   Type value of 1.  It is used by the initiator to inform the responder
   of the identity of a specific binding or bindings for which IP
   mobility service are being revoked.  Binding Revocation Indication
   message is sent as described in Sections <a href="#section-7">7</a>, <a href="#section-8.1">8.1</a>, and <a href="#section-9.2">9.2</a>.

   When the value 1 is indicated in the Binding Revocation Type field of
   the Binding Revocation Message, the format of the Binding Revocation
   Message Data follows the Binding Revocation Indication message as in
   Figure 5

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
                                       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                                       | B.R. Type = 1 |  R. Trigger   |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |          Sequence #           |P|V|G|       Reserved          |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                                                               |
       .                                                               .
       .                        Mobility options                       .
       |                                                               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

              Figure 5: Binding Revocation Indication Message

   Revocation Trigger

      8-bit unsigned integer indicating the event that triggered the
      initiator to send the BRI message.  The Per-MN Revocation Trigger
      values are less than 128.  The Per-MN Revocation Trigger is used
      when the BRI message intends to revoke one or more bindings for
      the same mobile node.  The Global Revocation Trigger values are
      greater than 128 and less than 250 and used in the BRI message
      when the Global (G) bit is set for global revocation.  The values
      250-255 are reserved for testing purposes only.  The following
      Revocation Trigger values are currently defined:

      Per-MN Revocation Trigger Values:
          0  Unspecified
          1  Administrative Reason
          2  Inter-MAG Handover - same Access Type
          3  Inter-MAG Handover - different Access Type
          4  Inter-MAG Handover - Unknown
          5  User-Initiated Session(s) Termination



<span class="grey">Muhanna, et al.              Standards Track                   [Page 13]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-14" id="page-14" href="#page-14" class="invisible"> </a>
<span class="grey"><a href="rfc5846.html">RFC 5846</a>          Binding Revocation for IPv6 Mobility         June 2010</span>


          6  Access Network Session(s) Termination
          7  Possible Out-of-Sync BCE State

      Global Revocation Trigger Values:
          128  Per-Peer Policy
          129  Revoking Mobility Node Local Policy

      Reserved Revocation Trigger Values:
          250-255 Reserved For Testing Purposes only
          All other values are Reserved

   Sequence Number

      A 16-bit unsigned integer used by the initiator to match a
      returned Binding Revocation Acknowledgement with this Binding
      Revocation Indication.  This sequence number could be a random
      number.  At any time, implementations MUST ensure there is no
      collision between the sequence numbers of all outstanding Binding
      Revocation Indication Messages.

   Proxy Binding (P)

      The Proxy Binding (P) bit is set by the initiator to indicate that
      the revoked binding(s) is a PMIPv6 binding.

   IPv4 HoA Binding Only (V)

      The IPv4 HoA Binding Only (V) bit is set by the initiator, home
      agent, or local mobility anchor to indicate to the receiving
      mobility entity the termination of the IPv4 Home Address binding
      only as in Sections <a href="#section-7">7</a> and <a href="#section-8.1">8.1</a>.

   Global (G)

      The Global (G) bit is set by the initiator, LMA or MAG, to
      indicate the termination of all Per-Peer mobility Bindings or
      Multiple Bindings that share a common identifier(s) and are served
      by the initiator and responder as in Sections <a href="#section-8.1">8.1</a> and <a href="#section-9.2">9.2</a>.

   Reserved

      These fields are unused.  They MUST be initialized to zero by the
      sender and MUST be ignored by the receiver.

   Mobility Options

      A variable-length field of such length that the complete Mobility
      Header is an integer multiple of 8 octets long.  This field



<span class="grey">Muhanna, et al.              Standards Track                   [Page 14]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-15" id="page-15" href="#page-15" class="invisible"> </a>
<span class="grey"><a href="rfc5846.html">RFC 5846</a>          Binding Revocation for IPv6 Mobility         June 2010</span>


      contains zero or more TLV-encoded mobility options.  This document
      does not define any new mobility option.  The receiver MUST ignore
      and skip any options that it does not understand.  These mobility
      options are used by the responder to identify the specific binding
      or bindings that the initiator is requesting be revoked.

   The following options are valid in a Binding Revocation Indication:

   o  Home Network Prefix option [<a href="rfc5213.html" title="&quot;Proxy Mobile IPv6&quot;">RFC5213</a>].  This option MAY be used
      only when the (P) bit is set.  This option MUST be present when
      the BRI is used to revoke a single Proxy MIPv6 Binding Cache
      entry.

   o  Mobile Node Identifier option [<a href="rfc4283.html" title="&quot;Mobile Node Identifier Option for Mobile IPv6 (MIPv6)&quot;">RFC4283</a>].  This option MUST be
      present when the (P) bit is set.  Additionally, if the Global (G)
      bit is set by the mobile access gateway, this option MUST carry
      the MAG identity.  In this specification, only the Mobile Node
      Identifier option with subtype 1 is required and other subtypes
      are currently not supported.

   o  Binding Identifier mobility option [<a href="rfc5648.html" title="&quot;Multiple Care-of Addresses Registration&quot;">RFC5648</a>].  This option MUST be
      present if the initiator requests to terminate one binding of a
      multiple care-of address bindings for the same mobile node.  The
      initiator may include more than one of the BID mobility options.

   o  IPv4 Home Address option, which contains the mobile node home IPv4
      address [<a href="rfc5555.html" title="&quot;Mobile IPv6 Support for Dual Stack Hosts and Routers&quot;">RFC5555</a>].  This option MUST only be included when the
      IPv4 HoA Binding only (V) bit is set and the (P) bit is cleared.

   o  IPv4 Home Address Request option, which contains the mobile node
      proxy home IPv4 address [<a href="rfc5844.html" title="&quot;IPv4 Support for Proxy Mobile IPv6&quot;">RFC5844</a>].  This option MUST only be
      included when the IPv4 HoA Binding only (V) and the (P) bits are
      set.

   o  Alternate Care-of Address mobility option [<a href="rfc3775.html" title="&quot;Mobility Support in IPv6&quot;">RFC3775</a>].  According to
      [<a href="rfc5213.html" title="&quot;Proxy Mobile IPv6&quot;">RFC5213</a>], the mobile access gateway is allowed to include this
      option in the Proxy Binding Update to indicate the proxy care-of
      address of the mobile node mobility session.  This option MAY be
      included to indicate the proxy care-of address of the mobile
      node's binding that is being revoked.  In the case when the Global
      (G) bit is set, this option identifies all mobility bindings that
      share the same proxy care-of address.

   If no mobility options are present in this message, 4 octets of
   padding are necessary and the Header Len field of the Binding
   Revocation Message will be set to 1.





<span class="grey">Muhanna, et al.              Standards Track                   [Page 15]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-16" id="page-16" href="#page-16" class="invisible"> </a>
<span class="grey"><a href="rfc5846.html">RFC 5846</a>          Binding Revocation for IPv6 Mobility         June 2010</span>


<span class="h3"><a class="selflink" name="section-5.2" href="#section-5.2">5.2</a>.  Binding Revocation Acknowledgement Message</span>

   The Binding Revocation Acknowledgement (BRA) message is a Binding
   Revocation Message that has an MH type 16 and a Binding Revocation
   Type value of 2.  It is used to acknowledge the receipt of a Binding
   Revocation Indication message described in <a href="#section-5.1">Section 5.1</a>.  This packet
   is sent as described in <a href="#section-6.1.2">Section 6.1.2</a>.

   When the value 2 is indicated in the Binding Revocation Type field of
   the Binding Revocation Message, the format of the Binding Revocation
   Message Data follows the Binding Revocation Acknowledgement message
   as in Figure 6.

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
                                       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                                       | B.R. Type = 2 |    Status     |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |            Sequence #         |P|V|G|       Reserved          |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                                                               |
       .                                                               .
       .                        Mobility options                       .
       .                                                               .
       |                                                               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

           Figure 6: Binding Revocation Acknowledgement Message

   Status  8-bit unsigned integer indicating the result of processing
      the Binding Revocation Indication message by the responder.
      Values of the Status field less than 128 indicate that the Binding
      Revocation Indication was processed successfully by the responder.
      Values greater than or equal to 128 indicate that the Binding
      Revocation Indication was rejected by the responder.  The
      following Status values are currently defined:

            0  success
            1  partial success
          128  Binding Does NOT Exist
          129  IPv4 Home Address Option Required
          130  Global Revocation NOT Authorized
          131  Revoked Mobile Nodes Identity Required
          132  Revocation Failed - MN is Attached
          133  Revocation Trigger NOT Supported
          134  Revocation Function NOT Supported
          135  Proxy Binding Revocation NOT Supported




<span class="grey">Muhanna, et al.              Standards Track                   [Page 16]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-17" id="page-17" href="#page-17" class="invisible"> </a>
<span class="grey"><a href="rfc5846.html">RFC 5846</a>          Binding Revocation for IPv6 Mobility         June 2010</span>


   Sequence Number

      The sequence number in the Binding Revocation Acknowledgement is
      copied from the Sequence Number field in the Binding Revocation
      Indication.  It is used by the initiator, e.g., HA, LMA, MAG, in
      matching this Binding Revocation Acknowledgement with the
      outstanding Binding Revocation Indication.

   Proxy Binding (P)

      The Proxy Binding (P) bit is set if the (P) bit is set in the
      corresponding Binding Revocation Indication message.

   IPv4 HoA Binding Only (V)

      The IPv4 HoA Binding Only (V) bit is set if the (V) bit is set in
      the corresponding Binding Revocation Indication message.

   Global (G)

      The Global (G) bit is set if the (G) bit is set in the
      corresponding Binding Revocation Indication message.

   Reserved

      These fields are unused.  They MUST be initialized to zero by the
      sender and MUST be ignored by the receiver.

   Mobility Options

      A variable-length field of such length that the complete Mobility
      Header is an integer multiple of 8 octets long.  This field
      contains zero or more TLV-encoded mobility options.  In the case
      when the Status field is set to success, no mobility option is
      required.  The mobility option(s) is usually used to communicate
      information of the bindings that failed the revocation procedure.

   The following mobility options are valid in a Binding Revocation
   Acknowledgement:

   o  Home Network Prefix option [<a href="rfc5213.html" title="&quot;Proxy Mobile IPv6&quot;">RFC5213</a>].  This option MAY be included
      only when the (P) bit is set.

   o  Mobile Node Identifier Option [<a href="rfc4283.html" title="&quot;Mobile Node Identifier Option for Mobile IPv6 (MIPv6)&quot;">RFC4283</a>].  This option MAY be
      included when the (P) bit is set.  This option SHOULD be included
      if the Home Network Prefix option is included.





<span class="grey">Muhanna, et al.              Standards Track                   [Page 17]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-18" id="page-18" href="#page-18" class="invisible"> </a>
<span class="grey"><a href="rfc5846.html">RFC 5846</a>          Binding Revocation for IPv6 Mobility         June 2010</span>


   o  Binding Identifier mobility option [<a href="rfc5648.html" title="&quot;Multiple Care-of Addresses Registration&quot;">RFC5648</a>].  The responder MAY
      include this option to indicate the specific BID that failed the
      revocation procedure.

   If no options are present in this message, 4 octets of padding are
   necessary and the Header Len field of the Binding Revocation Message
   will be set to 1.

<span class="h2"><a class="selflink" name="section-6" href="#section-6">6</a>.  Binding Revocation Process Operation</span>

   The following subsections describe the details of the generic binding
   revocation process as used by the different mobility entities.

<span class="h3"><a class="selflink" name="section-6.1" href="#section-6.1">6.1</a>.  Sending Binding Revocation Message</span>

   When sending a Binding Revocation message, the initiator constructs
   the packet as it would do with any other Mobility Header with the
   exception of setting the MH Type field to 16.

   The Binding Revocation Message MUST be protected using the same
   underlying security association, e.g., IPsec, that is being used
   between the two peers to protect the mobile node's Mobile IPv6 and
   its extensions binding registration signaling.  If IPsec is not used
   as the underlying security mechanism to protect the binding
   registration signaling, the used underlying security mechanism MUST
   provide protection against all identified security threats as
   described under "Security Considerations" in [<a href="rfc3775.html" title="&quot;Mobility Support in IPv6&quot;">RFC3775</a>] and [<a href="rfc5213.html" title="&quot;Proxy Mobile IPv6&quot;">RFC5213</a>].

<span class="h4"><a class="selflink" name="section-6.1.1" href="#section-6.1.1">6.1.1</a>.  Sending Binding Revocation Indication</span>

   The initiator MUST construct the Binding Revocation Message Data
   following the format of the Binding Revocation Indication message as
   described in <a href="#section-5.1">Section 5.1</a> and the following:

   o  The initiator MUST set the Sequence Number field to a valid
      sequence number for Binding Revocation.  Since sending a Binding
      Revocation Indication message is not done on a regular basis, a
      16-bit Sequence Number field is large enough to allow the
      initiator to match the Binding Revocation Acknowledgement to the
      associated Binding Revocation Indication using the Sequence Number
      field only.

   o  If the initiator is revoking a binding that was created using
      proxy MIPv6 registration, the initiator MUST set the Proxy Binding
      (P) bit.






<span class="grey">Muhanna, et al.              Standards Track                   [Page 18]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-19" id="page-19" href="#page-19" class="invisible"> </a>
<span class="grey"><a href="rfc5846.html">RFC 5846</a>          Binding Revocation for IPv6 Mobility         June 2010</span>


   o  If the initiator is sending the Binding Revocation Indication
      message to revoke multiple mobility sessions, the initiator MUST
      set the Global (G) bit.  In this case, the initiator MUST set the
      Revocation Trigger field to a valid value from the list of Global
      Revocation Triggers.

   o  If the initiator is sending the Binding Revocation Indication
      message with the Global (G) bit cleared, the initiator MUST set
      the Revocation Trigger field to a valid value from the list of
      Per-MN Revocation Triggers.

   o  If the initiator is sending the Binding Revocation Indication
      message to indicate the revocation of the mobile node IPv4 HoA
      Binding Only, the initiator MUST set the (V) bit.  In this case,
      the initiator MUST include either the IPv4 Home Address option or
      the IPv4 Home Address Request option in the BRI to identify the
      IPv4 HoA that is being revoked.

<span class="h4"><a class="selflink" name="section-6.1.2" href="#section-6.1.2">6.1.2</a>.  Sending Binding Revocation Acknowledgement</span>

   The responder MUST send a Binding Revocation Acknowledgement message
   to indicate the receipt and the status of processing of the
   corresponding Binding Revocation Indication message as follows:

   o  Whenever the Binding Revocation Indication is discarded, e.g., as
      described in <a href="#section-6.2">Section 6.2</a>, a Binding Revocation Acknowledgement
      MUST NOT be sent.  Otherwise, the treatment depends on the
      following rules.

   o  If the responder accepts the Binding Revocation Indication
      message, the responder MUST send a successful Binding Revocation
      Acknowledgement with an appropriate status code.

   o  If the responder rejects the Binding Revocation Indication
      message, the responder MUST send a Binding Revocation
      Acknowledgement with an appropriate failure status code.

   If the Source Address field of the IPv6 header that carried the
   Binding Revocation Indication message does not contain a unicast
   address, the Binding Revocation Indication packet MUST be silently
   discarded.

   When the responder acknowledges the received Binding Revocation
   Indication message, the responder MUST construct the Binding
   Revocation Message Data following the format of the Binding
   Revocation Acknowledgement message as described in <a href="#section-5.2">Section 5.2</a> and
   the following:




<span class="grey">Muhanna, et al.              Standards Track                   [Page 19]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-20" id="page-20" href="#page-20" class="invisible"> </a>
<span class="grey"><a href="rfc5846.html">RFC 5846</a>          Binding Revocation for IPv6 Mobility         June 2010</span>


   o  The responder MUST set the Sequence Number field by copying the
      value from the Sequence Number field of the received Binding
      Revocation Indication.

   o  The responder MUST set the Status field to a valid value that
      reflects the status of the processing of the received Binding
      Revocation Indication message.

   o  If the (P) bit is set in the received Binding Revocation
      Indication, the responder MUST set the (P) bit in the Binding
      Revocation Acknowledgement.

   o  If the Global (G) bit is set in the received Binding Revocation
      Indication, the responder MUST set the Global (G) bit in the
      Binding Revocation Acknowledgement.

   o  If the IPv4 HoA Binding Only (V) bit is set in the received
      Binding Revocation Indication, the responder MUST set the (V) bit
      in the Binding Revocation Acknowledgement.

   o  The destination IP address of the IPv6 packet of the Binding
      Revocation Acknowledgement is set to the source IP address of the
      received Binding Revocation Indication.

<span class="h3"><a class="selflink" name="section-6.2" href="#section-6.2">6.2</a>.  Receiving Binding Revocation Message</span>

   When receiving a Binding Revocation Message, the responder MUST
   verify the Mobility Header as described in <a href="rfc3775.html#section-9.2">Section&nbsp;9.2. of [RFC3775]</a>.
   If the packet is dropped due to failing any of the Mobility Header
   test checks, the responder MUST follow the processing rules as in
   <a href="rfc3775.html#section-9.2">Section&nbsp;9.2 of [RFC3775]</a>.  If the responder does not support the
   Binding Revocation Indication message and does not recognize the MH
   type 16, it sends a Binding Error message with the Status field set
   to 2 as described in [<a href="rfc3775.html" title="&quot;Mobility Support in IPv6&quot;">RFC3775</a>].

   Upon receiving a packet carrying a Binding Revocation Message, BRI or
   BRA, the receiving mobility entity MUST verify that the packet was
   received protected by the security association that is being used to
   protect the binding registration and Binding Revocation signaling
   between the two peers, e.g., an IPsec Security Association (SA).

<span class="h4"><a class="selflink" name="section-6.2.1" href="#section-6.2.1">6.2.1</a>.  Receiving Binding Revocation Indication</span>

   When the responder receives a packet carrying a Binding Revocation
   Indication message that was successfully processed as in <a href="#section-6.2">Section 6.2</a>,
   the responder, in addition, processes the message as follows:





<span class="grey">Muhanna, et al.              Standards Track                   [Page 20]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-21" id="page-21" href="#page-21" class="invisible"> </a>
<span class="grey"><a href="rfc5846.html">RFC 5846</a>          Binding Revocation for IPv6 Mobility         June 2010</span>


   o  The responder MUST validate that the Binding Revocation Indication
      is formatted as in <a href="#section-5.1">Section 5.1</a>.

   o  If the Revocation Trigger field is set to a value that the
      responder does not support, the responder SHOULD reject the
      Binding Revocation Indication message using status code
      "Revocation Trigger NOT Supported".

   o  If the Revocation Trigger value is NOT allowed with the Binding
      Revocation Indication message intent, e.g., the Global (G) bit is
      set and the Revocation Trigger field value is Per-MN-specific, the
      responder SHOULD reject the Binding Revocation Indication message
      using status code "Revocation Function NOT Supported".

   o  If the responder failed to identify the mobile node(s) bindings as
      identified in the Binding Revocation Indication message, the
      responder MUST reject the BRI using status code "Binding Does NOT
      Exist".

<span class="h4"><a class="selflink" name="section-6.2.2" href="#section-6.2.2">6.2.2</a>.  Receiving Binding Revocation Acknowledgement</span>

   When the initiator receives a packet carrying a Binding Revocation
   Acknowledgement message that was successfully processed as in
   <a href="#section-6.2">Section 6.2</a>, the initiator, in addition, processes the message and
   examines the Status field as follows:

   o  The initiator MUST validate that the sequence number in the
      Sequence Number field matches the sequence number of an
      outstanding Binding Revocation Indication that was sent by the
      initiator.  If the sequence number does not match a sequence
      number of any of the outstanding Binding Revocation Indication
      messages, the initiator MUST silently discard the message but MAY
      log the event.

   o  If the Status field indicates that the Binding Revocation
      Indication was processed successfully, the initiator MUST delete
      the current timer and the mobile node(s) binding(s) and all
      associated resources.

   o  If the Status field indicates any value other than success, the
      initiator SHOULD examine any mobility options included in the
      Binding Revocation Acknowledgement.  In this case, it is based on
      the initiator local policy how to handle the mobile node binding.
      The initiator MAY log the appropriate event to reflect the
      received status.






<span class="grey">Muhanna, et al.              Standards Track                   [Page 21]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-22" id="page-22" href="#page-22" class="invisible"> </a>
<span class="grey"><a href="rfc5846.html">RFC 5846</a>          Binding Revocation for IPv6 Mobility         June 2010</span>


<span class="h3"><a class="selflink" name="section-6.3" href="#section-6.3">6.3</a>.  Retransmission of Binding Revocation Indication</span>

   If the initiator does not receive a Binding Revocation
   Acknowledgement in response to the outstanding Binding Revocation
   Indication before the InitMINDelayBRIs timer expires, the initiator,
   e.g., LMA, SHOULD retransmit the same BRI message up to the
   BRIMaxRetriesNumber as defined in <a href="#section-11">Section 11</a>.

   The retransmissions by the initiator MUST use an exponential back-off
   process in which the timeout period is doubled upon each
   retransmission, until either the initiator receives a response or the
   timeout period reaches the value MAX_BRACK_TIMEOUT.  The initiator
   MAY continue to send these messages at this slower rate up to the
   BRIMaxRetriesNumber.

   If the initiator does not receive a Binding Revocation
   Acknowledgement message after the BRIMaxRetriesNumber of retransmits
   have been sent, the initiator SHOULD clean up all resources
   associated with this mobile node binding.  The initiator may log the
   event.

<span class="h2"><a class="selflink" name="section-7" href="#section-7">7</a>.  Home Agent Operation</span>

   To terminate a mobile node registration and its current binding with
   the home agent, the home agent sends a packet to the mobile node
   containing a Binding Revocation Indication, with the packet
   constructed as follows:

   o  The Revocation Trigger field MUST be set to indicate to the mobile
      node the reason for revoking its IP mobility binding with the home
      agent.  The Revocation Trigger may be used by the mobile node to
      take further steps if necessary.

   o  The Binding Revocation Indication MUST be sent using a Type 2
      routing header that contains the mobile node's registered IPv6
      home address for the binding being revoked.

   o  The care-of address for the binding MUST be used as the
      destination address in the packet's IPv6 header.

   o  If the home agent needs to only revoke the mobile node's IPv4 home
      address binding, the home agent MUST set the IPv4 HoA Binding Only
      (V) bit and MUST include the mobile node's registered IPv4 home
      address that is being revoked in the IPv4 Home Address option.

   When the home agent sends a Binding Revocation Indication to the
   mobile node, the home agent sets a flag in the mobile node BCE to
   indicate that revocation is in progress and starts the



<span class="grey">Muhanna, et al.              Standards Track                   [Page 22]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-23" id="page-23" href="#page-23" class="invisible"> </a>
<span class="grey"><a href="rfc5846.html">RFC 5846</a>          Binding Revocation for IPv6 Mobility         June 2010</span>


   InitMINDelayBRIs timer.  The home agent maintains the mobile node BCE
   in this state until it receives a Binding Revocation Acknowledgement
   or retransmits the Binding Revocation Indication message as described
   in <a href="#section-6.3">Section 6.3</a>.

   In a race condition case, the home agent may receive a Binding Update
   from the mobile node while the mobile node's BCE has the revocation
   in progress flag set, the home agent SHOULD handle this case based on
   the reason for sending the Binding Revocation Indication message and
   its local policy.  In this case, if the home agent accepts the
   Binding Update, it needs to update the mobile node BCE accordingly,
   e.g., removing the revocation in progress flag.

   When the home agent needs to revoke one or more of a mobile node
   bindings that were created using multiple care-of address
   registrations as in [<a href="rfc5648.html" title="&quot;Multiple Care-of Addresses Registration&quot;">RFC5648</a>], the home agent MUST include all the
   related BID mobility options that identify these bindings in the
   Binding Revocation Indication message.  In the case when the home
   agent needs to revoke all of the mobile node bindings, the home agent
   SHOULD NOT include any of the BID mobility options.

   When the home agent receives a packet carrying a valid Binding
   Revocation Acknowledgement message, the home agent follows
   <a href="#section-6.2">Section 6.2</a> in processing this message.

<span class="h2"><a class="selflink" name="section-8" href="#section-8">8</a>.  Local Mobility Anchor Operation</span>

<span class="h3"><a class="selflink" name="section-8.1" href="#section-8.1">8.1</a>.  Sending Binding Revocation Indication</span>

   To terminate a mobile node PMIPv6 registration and its current
   binding with the local mobility anchor, the local mobility anchor
   sends a packet to the mobile access gateway containing a Binding
   Revocation Indication message following the procedure in <a href="#section-6.1">Section 6.1</a>
   and the following rules:

   o  The Proxy Binding (P) bit MUST be set to indicate that the binding
      being revoked is a PMIPv6 binding.

   o  The Revocation Trigger field MUST be set to indicate to the mobile
      access gateway the reason for removing the specified mobile node
      PMIPv6 binding at the local mobility anchor.  The Revocation
      Trigger may be used by the mobile access gateway to learn the
      mobile node's latest movement.

   o  The packet MUST contain the Mobile Node Identifier (MN-ID) option,
      which contains the mobile node's Network Access Identifier (NAI)
      that was used in the Proxy Binding Update during the mobile node
      registration.



<span class="grey">Muhanna, et al.              Standards Track                   [Page 23]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-24" id="page-24" href="#page-24" class="invisible"> </a>
<span class="grey"><a href="rfc5846.html">RFC 5846</a>          Binding Revocation for IPv6 Mobility         June 2010</span>


   o  If the Mobile Node Identifier (MN-ID) is registered in more than
      one of the mobile node's BCEs and the local mobility anchor does
      NOT need to revoke all of the mobile node's bindings, the Binding
      Revocation Indication message MUST contain another identifier to
      uniquely identify the mobile node binding(s) that is being
      revoked, e.g., at least one Home Network Prefix option that
      contains the mobile node's registered Home Network Prefix (HNP)
      for the binding being revoked.

   o  In the case of revoking all Per-Peer bindings, the local mobility
      anchor MUST set the Global (G) bit and the Revocation Trigger MUST
      contain the value "Per-Peer Policy" to request the mobile access
      gateway to remove all Per-Peer bindings that are registered with
      the local mobility anchor and this mobile access gateway.

   o  The proxy care-of address for the binding MUST be used as the
      destination address in the packet's IPv6 header.  However, in the
      case when IPsec is used to protect the Proxy MIPv6 signaling as
      specified in [<a href="rfc5213.html" title="&quot;Proxy Mobile IPv6&quot;">RFC5213</a>], the destination address MUST be set to the
      mag_address that is being used for keying the IPsec SA.  If the
      mag_address is different than the mobile node proxy care-of
      address, the Alternate Care-of Address option MUST be included and
      MUST contain the mobile node proxy care-of address.

   The local mobility anchor MAY delete the mobile node(s) IP tunnel
   immediately after sending the initial Binding Revocation Indication
   and before receiving the Binding Revocation Acknowledgement message.

   When the local mobility anchor sends a Binding Revocation Indication
   to the mobile access gateway to remove a specific binding, the local
   mobility anchor sets a flag in the mobile node proxy BCE to indicate
   that revocation is in progress and starts the InitMINDelayBRIs timer.
   The local mobility anchor SHOULD maintain the mobile node proxy BCE
   in this state until it receives a Binding Revocation Acknowledgement
   or the BRIMaxRetransmitNumber is reached.  In the case when the local
   mobility anchor sets the Revocation Trigger field to a value that
   indicates inter-MAG handover, the local mobility anchor MAY switch
   the mobile node IP tunnel to the target mobile access gateway before
   sending the Binding Revocation Indication to the source mobile access
   gateway.

   In a race condition case, the local mobility anchor may receive a
   Proxy Binding Update from the mobile access gateway while the mobile
   node's proxy BCE has the revocation in progress flag set.  The local
   mobility anchor should handle this case based on the reason for
   sending the Binding Revocation Indication message and its local





<span class="grey">Muhanna, et al.              Standards Track                   [Page 24]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-25" id="page-25" href="#page-25" class="invisible"> </a>
<span class="grey"><a href="rfc5846.html">RFC 5846</a>          Binding Revocation for IPv6 Mobility         June 2010</span>


   policy.  In this case, if the local mobility anchor accepts the Proxy
   Binding Update, it needs to update the mobile node proxy BCE
   accordingly, e.g., removing the revocation in progress flag.

   When the local mobility anchor needs to revoke all the mobile node
   proxy BCEs that are registered with the local mobility anchor and the
   mobile access gateway peer, it MUST set the Global (G) bit and set
   the value of the Revocation Trigger field to "Per-Peer Policy".  In
   this case, the local mobility anchor MUST NOT include any mobility
   options in this Binding Revocation Indication message.

   When the local mobility anchor needs to revoke all mobile nodes proxy
   BCEs that belong to a specific realm and are registered with the
   local mobility anchor and the mobile access gateway peer, the local
   mobility anchor MUST set the Global (G) bit and set the value of the
   Revocation Trigger field to "Revoking Mobility Node Local Policy".
   In this case, the local mobility anchor MUST include a mobility
   option in the Binding Revocation Indication that is shared among all
   the impacted mobile nodes BCEs, e.g., the mobile node identifier
   option, MN-ID option, with a subtype value of 1.  In this case, the
   NAI value in the MN-ID MUST follow the format where the content after
   the "@" character defines the realm that is shared amongst all of the
   impacted mobile nodes proxy BCEs.  As an example: @example.com
   identifies all mobile nodes whose MN-ID value contains "example.com"
   as the realm, e.g., "1234abdelta@example.com", "axxxyzd@example.com",
   and "abcdefg.xyz123@example.com", but not
   "1234abdelta@foo.example.com".

   When the local mobility anchor needs to revoke a subgroup of the
   mobile nodes proxy BCEs that belong to a specific realm and are
   registered with the local mobility anchor and the mobile access
   gateway, the local mobility anchor MUST set the Global (G) bit and
   set the value of the Revocation Trigger field to "Revoking Mobility
   Node Local Policy".  In this case, the local mobility anchor MUST
   include an additional mobility option to the mobile node identifier
   option (MN-ID) option, with a subtype value of 1.  In other words,
   the impacted mobile node BCEs are those that have an MN-ID with a
   realm as specified above and, e.g., are assigned the same proxy
   care-of address as the one included in the Alternate Care-of Address
   mobility option.

   When the mobile node is registered with multiple Home Network
   Prefixes for the same proxy care-of address, the local mobility
   anchor SHOULD include an HNP option for each registered HNP in the
   Binding Revocation Indication.  Alternatively, it MAY include only
   the mobile node identifier (MN-ID) option with the mobile node NAI
   included to indicate to the mobile access gateway to remove all
   bindings of the specified mobile node NAI in the MN-ID option.



<span class="grey">Muhanna, et al.              Standards Track                   [Page 25]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-26" id="page-26" href="#page-26" class="invisible"> </a>
<span class="grey"><a href="rfc5846.html">RFC 5846</a>          Binding Revocation for IPv6 Mobility         June 2010</span>


   According to the Proxy Mobile IPv6 specification [<a href="rfc5213.html" title="&quot;Proxy Mobile IPv6&quot;">RFC5213</a>], if the
   local mobility anchor receives a Proxy Binding Update message from a
   new mobile access gateway for extending the binding lifetime of the
   only BCE of this mobile node with the Handoff Indicator value set to
   "Handoff state unknown (4)", the local mobility anchor waits a period
   of MaxDelayBeforeNewBCEAssign to receive a de-registration message
   from the previous mobile access gateway before updating the mobile
   node's BCE with the new point of attachment.  If a de-registration
   message is not received, the local mobility anchor considers the
   received Proxy Binding Update message as a request for a new BCE and
   if processed successfully, the local mobility anchor assigns a
   different HNP for the new BCE.

   This document updates the local mobility anchor's behavior in this
   case.  If the local mobility anchor supports the binding revocation
   mechanism as described in this document, it SHOULD proactively send a
   Binding Revocation Indication message to the previous mobile access
   gateway instead of waiting for a de-registration from the previous
   mobile access gateway.  In the Binding Revocation Indication message,
   the Revocation Trigger MUST be set to "Inter-MAG Handover - Unknown".

   If the local mobility anchor sent a Binding Revocation Indication
   message with the Revocation Trigger field set to "Inter-MAG Handover
   - Unknown" and while waiting for a response, Binding Revocation
   Acknowledgement, the following are possible conditions that the local
   mobility anchor MUST handle as specified below:

   o  If the local mobility anchor receives a successful Binding
      Revocation Acknowledgement message or a de-registration message
      from the previous mobile access gateway, the local mobility anchor
      MUST update the mobile node BCE as if it received a de-
      registration message as described in [<a href="rfc5213.html" title="&quot;Proxy Mobile IPv6&quot;">RFC5213</a>].

   o  If the local mobility anchor receives a Binding Revocation
      Acknowledgement message with the Status field set to "Revocation
      Failed - MN is Attached", the local mobility anchor SHOULD update
      the mobile node BCE as if it did NOT receive a de-registration
      before the MaxDelayBeforeNewBCEAssign timer expired by creating a
      new BCE as described in [<a href="rfc5213.html" title="&quot;Proxy Mobile IPv6&quot;">RFC5213</a>].

   o  If the local mobility anchor did not receive a Binding Revocation
      Acknowledgement message or a de-registration Proxy Binding Update
      from the previous mobile access gateway after it exhausted all of
      the Binding Revocation Indication message retransmissions as
      described in <a href="#section-6.3">Section 6.3</a>, the local mobility anchor SHOULD update
      the mobile node's BCE as if it did NOT receive a de-registration
      before the MaxDelayBeforeNewBCEAssign timer expired by creating a
      new BCE as described in [<a href="rfc5213.html" title="&quot;Proxy Mobile IPv6&quot;">RFC5213</a>].  Note that the local mobility



<span class="grey">Muhanna, et al.              Standards Track                   [Page 26]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-27" id="page-27" href="#page-27" class="invisible"> </a>
<span class="grey"><a href="rfc5846.html">RFC 5846</a>          Binding Revocation for IPv6 Mobility         June 2010</span>


      anchor SHOULD use the recommended number of retransmissions for
      the Binding Revocation Indication message as described in
      <a href="#section-11">Section 11</a> to avoid delaying the creation of a new Binding Cache
      entry for too long, if the mobile node is actually attaching to
      the new MAG with a different interface.

   When the mobile node is registered with an IPv4 proxy home address in
   addition to the Home Network Prefix where both of the IPv4 proxy HoA
   (pHoA) and HNP are bound to the same proxy CoA (pCoA), the local
   mobility anchor MAY revoke the mobile node IPv4 proxy HoA binding to
   the current mobile node proxy CoA while maintaining the mobile node
   binding of the HNP to its current pCoA as part of the mobile node
   BCE.  In this case, if the local mobility anchor decides to revoke
   the mobile node IPv4 proxy HoA only, it MUST send a Binding
   Revocation Indication message following the procedure in <a href="#section-6.1">Section 6.1</a>
   and the following rules:

   o  The IPv4 HoA Binding Only (V) bit MUST be set in the BRI to
      indicate that only the IPv4 home address binding is being revoked.

   o  The IPv4 Home Address Request option MUST be included with the
      mobile node's registered proxy home IPv4 address that is being
      released in addition to the MN-ID option.

   o  The mobile node Home Network Prefix option MUST NOT be included.

   o  The Revocation Trigger field MUST be set to an appropriate value,
      e.g., "User Initiated Session(s) Termination".

<span class="h3"><a class="selflink" name="section-8.2" href="#section-8.2">8.2</a>.  Receiving Binding Revocation Indication</span>

   When the local mobility anchor receives a packet carrying a Binding
   Revocation Indication that was successfully processed as in
   <a href="#section-6.2">Section 6.2</a>, the local mobility anchor processes the message as
   follows:

   o  If the (P) bit is set, the local mobility anchor MUST validate
      that all impacted bindings have the proxy binding flag set.

   o  If the Global (G) bit is set and the Revocation Trigger field
      value is "Per-Peer Policy", the LMA MUST validate that the Proxy
      (P) bit is set and the MN-ID option is present with the mobile
      access gateway identity included.  In addition, the local mobility
      anchor MUST verify that the identified mobile access gateway as
      per the value in the MN-ID option is authorized to use the global
      revocation with revocation trigger value "Per-Peer Policy", see
      <a href="#section-13">Section 13</a>.  If the local mobility anchor processes the Global




<span class="grey">Muhanna, et al.              Standards Track                   [Page 27]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-28" id="page-28" href="#page-28" class="invisible"> </a>
<span class="grey"><a href="rfc5846.html">RFC 5846</a>          Binding Revocation for IPv6 Mobility         June 2010</span>


      Binding Revocation Indication message successfully, it MUST accept
      the Binding Revocation Indication message using the status code
      "success".

   o  If the mobile access gateway is not authorized to use the Per-Peer
      Global revocation feature or the received Binding Revocation
      Indication message has the Global (G) bit set and the Revocation
      Trigger field is set to "Per-Peer Policy", but the MN-ID option is
      not included, the local mobility anchor MUST reject the Binding
      Revocation Indication message using status code "Global Revocation
      NOT Authorized".

   o  If the Global (G) bit is set and the Revocation Trigger value is
      "Per-Peer Policy", and only the mobile node identifier (MN-ID)
      option is included, the local mobility anchor MUST revoke all
      mobile node bindings for which the proxy CoA is the one used as
      the source of the IPv6 packet that carried the Binding Revocation
      Indication.  However, if the Alternate Care-of Address option is
      included in addition to the mobile node identifier option, the
      local mobility anchor MUST revoke all mobile node bindings whose
      proxy care-of address matches the care-of address in the Alternate
      Care-of Address option.  After the local mobility anchor
      successfully processes the Binding Revocation Indication message
      and identifies all impacted mobile nodes bindings, it MUST accept
      the Binding Revocation Indication message using the status code
      "success".

   o  If the local mobility anchor accepted the Binding Revocation
      Indication message but one or more of the bindings identified in
      the received Binding Revocation Indication message has already
      been released, the local mobility anchor MUST accept the message
      and it MAY set the Status field to "partial success" and include
      the mobile node identifier (MN-ID) or the Home Network Prefix
      option to identify the binding(s) that failed the revocation
      procedure.

   o  If the Global (G) bit is not set, the local mobility anchor uses
      the included mobility options to identify the impacted mobile node
      binding as follows:

      1.  If only the mobile node identifier (MN-ID) option is included,
          the local mobility anchor MUST accept the message and revoke
          all bindings for this mobile node that use the specified
          mobile node NAI including the IPv4 Home Address binding(s) if
          present.






<span class="grey">Muhanna, et al.              Standards Track                   [Page 28]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-29" id="page-29" href="#page-29" class="invisible"> </a>
<span class="grey"><a href="rfc5846.html">RFC 5846</a>          Binding Revocation for IPv6 Mobility         June 2010</span>


      2.  If the mobile node identifier (MN-ID) and one Home Network
          Prefix option are included, the local mobility anchor MUST
          accept the message and only remove the specified mobile node
          proxy binding.

      3.  If the mobile node identifier (MN-ID) option and more than one
          Home Network Prefix options are included, the local mobility
          anchor MUST accept the message and remove all bindings that
          are referenced by these Home Network Prefixes for the
          specified mobile node NAI.

      4.  If the IPv4 HoA binding Only (V) bit is set and the mobile
          node identifier (MN-ID) option and the IPv4 Home Address
          Request option are included, the local mobility anchor MUST
          accept the message and remove only the IPv4 HoA address
          binding to the mobile node current proxy care-of address.

   The Revocation Trigger field value in the received Binding Revocation
   Indication could be used by the local mobility anchor to log an event
   or update some local parameters that track the state of the peer
   mobile access gateway.

   After the local mobility anchor accepts or rejects a Binding
   Revocation Indication message, the local mobility anchor MUST follow
   Sections <a href="#section-6.1">6.1</a> and <a href="#section-6.1.2">6.1.2</a> to send a Binding Revocation Acknowledgement
   message to the mobile access gateway.

<span class="h2"><a class="selflink" name="section-9" href="#section-9">9</a>.  Mobile Access Gateway Operation</span>

<span class="h3"><a class="selflink" name="section-9.1" href="#section-9.1">9.1</a>.  Receiving Binding Revocation Indication</span>

   When the mobile access gateway receives a packet carrying a Binding
   Revocation Indication that was successfully processed as in
   <a href="#section-6.2">Section 6.2</a>, the mobile access gateway processes the message as
   follows:

   o  If the Global (G) bit is set and the Revocation Trigger field
      value is "Per-Peer Policy", the mobile access gateway MUST
      validate that the Proxy (P) bit is set and no mobility options are
      included in the message.  If the mobile access gateway processes
      the Global Binding Revocation Indication message successfully, it
      MUST accept the Binding Revocation Indication message using the
      status code "success".

   o  If the Global (G) bit is set and the Revocation Trigger field
      value is "Revoking Mobility Node Local Policy", the mobile access
      gateway MUST validate that the Proxy (P) bit is set and at least
      the MN-ID option with the subtype value of 1 is included in the



<span class="grey">Muhanna, et al.              Standards Track                   [Page 29]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-30" id="page-30" href="#page-30" class="invisible"> </a>
<span class="grey"><a href="rfc5846.html">RFC 5846</a>          Binding Revocation for IPv6 Mobility         June 2010</span>


      Binding Revocation Indication and it is formatted as described is
      <a href="#section-8.1">Section 8.1</a>.  If the mobile access gateway processes this Global
      Binding Revocation Indication message successfully, it MUST accept
      the message using the status code "success".

   o  If the Global (G) bit is set and the Revocation Trigger field
      value is "Revoking Mobility Node Local Policy", and no mobility
      options are included in the Binding Revocation Indication message
      or the mobile access gateway is not able to identify the impacted
      mobile nodes bindings based on the included mobility options, the
      mobile access gateway MUST treat this as an error scenario.  In
      this case, the mobile access gateway MUST reject the Binding
      Revocation Indication message using status code "Revoked Mobile
      Nodes Identity Required".

   o  If the Revocation Trigger field value in the received Binding
      Revocation Indication message indicates inter-MAG handover, e.g.,
      Inter-MAG Handover - Unknown, the mobile access gateway uses the
      mobility option(s) included in the Binding Revocation Indication
      message to identify the mobile node binding.  The mobile access
      gateway SHOULD ensure that the mobile node is no longer attached
      to the mobile access gateway before accepting the BRI message
      using status code "success".  However, if the mobile access
      gateway verified that the mobile node is still directly attached,
      the mobile access gateway MUST reject the BRI using status code
      "Revocation failed - MN is Attached".

   o  If the IPv4 HoA Binding Only (V) bit is set, the mobile access
      gateway uses the MN-ID option to identify the mobile node binding
      entry in the Binding Update List (BUL).  The mobile access gateway
      MUST verify that the IPv4 address included in the IPv4 Home
      Address Request option in the received Binding Revocation
      Indication is the same as the IPv4 proxy HoA that is assigned to
      the mobile node.  After the mobile access gateway successfully
      validates the received IPv4 home address as the mobile node IPv4
      HoA, it MUST consider this as an indication to ONLY release the
      mobile node IPv4 proxy HoA binding to the mobile node current
      proxy CoA.  Consequently, it MUST continue to maintain the mobile
      node IPv6 proxy HoA or HNP binding to the current mobile node
      proxy CoA as part of the mobile node binding in the BUL entry and
      release all resources associated with the MN IPv4 proxy HoA
      binding to the MN pCoA.  If the mobile access gateway processed
      the BRI successfully, the mobile access gateway MUST accept the
      BRI using status code "success".  On the other hand, if the mobile
      access gateway is able to identify the mobile node binding using
      the MN-ID but failed to identify the received IPv4 proxy HoA, the
      mobile access gateway MUST reject the BRI using status code
      "Binding Does NOT Exist".



<span class="grey">Muhanna, et al.              Standards Track                   [Page 30]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-31" id="page-31" href="#page-31" class="invisible"> </a>
<span class="grey"><a href="rfc5846.html">RFC 5846</a>          Binding Revocation for IPv6 Mobility         June 2010</span>


   o  If the mobile access gateway accepts the Binding Revocation
      Indication message but one or more of the bindings identified in
      the received Binding Revocation Indication message has already
      been released before processing the Binding Revocation Indication,
      the mobile access gateway MUST accept the Binding Revocation
      Indication message.  In this case, the mobile access gateway MAY
      set the Status field to "partial success" and include the mobile
      node identifier (MN-ID) or the Home Network Prefix option to
      identify the binding(s) that failed to be removed as part of the
      revocation procedure.

   The Revocation Trigger field value in the received Binding Revocation
   Indication could be used by the mobile access gateway to define what
   actions the mobile access gateway could do to inform the mobile node
   that its IP connectivity to the current HNP has been terminated,
   e.g., if the Revocation Trigger field is set to "Administrative
   Reason", the mobile access gateway may terminate the IPv6 or IPv4
   mobility session on the access link and notify the mobile node.  The
   specific details and considerations on how the mobile access gateway
   terminates IPv6 or IPv4 mobility session on the access link and
   notifies the mobile node can be found in [<a href="rfc5213.html" title="&quot;Proxy Mobile IPv6&quot;">RFC5213</a>] and [<a href="rfc5844.html" title="&quot;IPv4 Support for Proxy Mobile IPv6&quot;">RFC5844</a>].

   After the mobile access gateway accepts or rejects a Binding
   Revocation Indication message, the mobile access gateway MUST follow
   Sections <a href="#section-6.1">6.1</a> and <a href="#section-6.1.2">6.1.2</a> to send a Binding Revocation Acknowledgement
   message to the local mobility anchor.

<span class="h3"><a class="selflink" name="section-9.2" href="#section-9.2">9.2</a>.  Sending Binding Revocation Indication</span>

   The mobile access gateway could send a Binding Revocation Indication
   message to indicate the termination of multiple mobile node bindings,
   e.g., when using the global revocation with the Global (G) bit set.
   In this case, when an event occurs that requires the mobile access
   gateway to inform the local mobility anchor peer to terminate all
   mobile node bindings that are registered at the local mobility anchor
   and the mobile access gateway, the mobile access gateway sends a
   Binding Revocation Indication message following the procedure in
   <a href="#section-6.1">Section 6.1</a> and the following:

   o  The Proxy Binding (P) bit MUST be set to indicate that the
      binding(s) being revoked is a PMIPv6 binding.

   o  The Global (G) bit MUST be set and the Revocation Trigger MUST
      contain a value of "Per-Peer Policy" in the Binding Revocation
      Indication to request the local mobility anchor to remove all Per-
      Peer bindings that are registered with the local mobility anchor
      and the mobile access gateway.  In this case, the MN-ID option
      MUST be included in the Binding Revocation Indication and contain



<span class="grey">Muhanna, et al.              Standards Track                   [Page 31]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-32" id="page-32" href="#page-32" class="invisible"> </a>
<span class="grey"><a href="rfc5846.html">RFC 5846</a>          Binding Revocation for IPv6 Mobility         June 2010</span>


      the mobile access gateway identity.  In addition, the mobile
      access gateway MAY include the Alternate Care-of Address option.
      If included, the Alternate Care-of Address option MUST contain the
      proxy care-of address the bindings that are being impacted by this
      Binding Revocation Indication message.

   o  The mobile access gateway address MAY be used as the source
      address in the packet's IPv6 header.

   As described in <a href="#section-6.3">Section 6.3</a>, the mobile access gateway SHOULD
   retransmit the Binding Revocation Indication to the local mobility
   anchor until it receives a matching Binding Revocation
   Acknowledgement or the BRIMaxRetransmitNumber is reached.  The mobile
   access gateway MAY delete the mobile node IP tunnels immediately
   after sending the Binding Revocation Indication and before receiving
   a Binding Revocation Acknowledgement message from the LMA.

   In response to a Binding Revocation Indication message, if the mobile
   access gateway receives a packet carrying a Binding Revocation
   Acknowledgement that was successfully processed as in <a href="#section-6.2">Section 6.2</a> and
   the Status field indicates "Global Revocation NOT Authorized", the
   mobile access gateway is not authorized to participate in a Per-Peer
   Global Revocation.  The mobile access gateway SHOULD NOT retry
   sending a Binding Revocation Indication with the Global (G) bit set
   and the Revocation Trigger field value set to "Per-Peer Policy" to
   the same local mobility agent.  The mobile access gateway should
   raise an alarm or log an event to indicate this rejection.

<span class="h2"><a class="selflink" name="section-10" href="#section-10">10</a>.  Mobile Node Operation</span>

   Upon receiving a packet carrying a Binding Revocation Indication, the
   mobile node MUST validate the packet according to <a href="#section-6.2">Section 6.2</a> and the
   following tests:

   o  The mobile node MUST verify that the IP address in the Type 2
      routing header is its Home Address and that its Binding Update
      List contains an entry for that Home Address.  If one of the tests
      fails, the mobile node SHOULD silently discard the received
      Binding Revocation Indication message.

   o  If mobile node Binding Update List contains an entry for the IP
      address in the Type 2 routing header of the received Binding
      Revocation Indication packet, the mobile node MUST accept the BRI
      message using status code "success".

   o  If the IPv4 HoA Binding Only (V) bit is set in the received BRI
      message, the mobile node MUST verify that there is an IPv4 Home
      Address option in the received Binding Revocation Indication and



<span class="grey">Muhanna, et al.              Standards Track                   [Page 32]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-33" id="page-33" href="#page-33" class="invisible"> </a>
<span class="grey"><a href="rfc5846.html">RFC 5846</a>          Binding Revocation for IPv6 Mobility         June 2010</span>


      the IPv4 address included in the IPv4 Home Address option is the
      same as its IPv4 HoA that is assigned to the mobile node.  If this
      verification is successful, the mobile node MUST consider this
      Binding Revocation Indication as an indication to ONLY release the
      mobile node IPv4 HoA binding to its current care-of address.
      Consequently, the mobile node MUST continue to maintain its IPv6
      HoA binding to the current CoA as part of the mobile node binding
      in the BUL entry and release all resources associated with the MN
      IPv4 HoA binding.  In this case, the mobile node MUST accept the
      Binding Revocation Indication message using status code "success".
      On the other hand, if the IPv4 Home Address Option was NOT
      included in the received BRI with the (V) bit is set, the MN MUST
      reject the BRI message with status code "IPv4 Home Address Option
      Required".  Additionally, if the IPv4 HoA received in the IPv4
      Home Address Option is NOT the one assigned to the mobile node,
      the mobile node SHOULD reject the Binding Revocation Indication
      with status code "Binding Does NOT Exist".

   o  The mobile node MUST verify that the (P) bit in the Binding
      Revocation Indication is NOT set.  If the (P) bit is set, the
      mobile node MUST reject the Binding Revocation Indication using
      status code "Proxy Binding Revocation NOT Supported".

   o  If the mobile node has registered multiple care-of addresses with
      its home agent, the mobile node MUST verify which binding is being
      revoked by examining the content of the Binding Revocation
      Indication message.  If the mobile node received a Binding
      Revocation Indication with one or more BID options and its home
      address is included in the Type 2 routing header, the mobile node
      MUST consider all of the care-of addresses bindings, identified in
      the BID options, with this home address as being revoked.  In this
      case, if the BRI validation is successful, the mobile node MUST
      accept the Binding Revocation Indication message with status code
      "success".

   o  If the mobile node has multiple care-of address bindings with its
      home agent and received a Binding Revocation Indication, without
      any BID option included and its home address was included in the
      Type 2 routing header, the mobile node MUST consider all of its
      registered care-of address bindings with this home address as
      being revoked.  If the mobile node validates the BRI successfully,
      the mobile node MUST accept the Binding Revocation Indication
      message with status code "success".

   If the mobile node accepts or rejects the Binding Revocation
   Indication message, the mobile node MUST follow Sections <a href="#section-6.1">6.1</a> and
   6.1.2 to send a Binding Revocation Acknowledgement message to the
   home agent.  Note that anytime the MN does not send a Binding



<span class="grey">Muhanna, et al.              Standards Track                   [Page 33]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-34" id="page-34" href="#page-34" class="invisible"> </a>
<span class="grey"><a href="rfc5846.html">RFC 5846</a>          Binding Revocation for IPv6 Mobility         June 2010</span>


   Revocation Acknowledgement to a BRI, the initiator is likely to
   retransmit the BRI at least one time.  This causes additional load on
   the initiator who sends the retransmissions, as well as on the MN
   that will receive and process them.

   The Revocation Trigger field value in the received Binding Revocation
   Indication could be used by the mobile node to define what action the
   mobile node could do to be able to register again and receive its IP
   mobility service, e.g., contacting its home operator.

<span class="h2"><a class="selflink" name="section-11" href="#section-11">11</a>.  Protocol Configuration Variables</span>

   Any mobility entity that is allowed to invoke the binding revocation
   procedure by sending a Binding Revocation Indication message SHOULD
   allow the following variables to be configured.

   BRI Maximum Number of Retries (BRIMaxRetriesNumber)

      This variable specifies the maximum Number of times a mobility
      entity can retransmit a Binding Revocation Indication message
      before receiving a Binding Revocation Acknowledgement message.
      The default value for this parameter is 1.

   Initial Minimum Delay Between BRI messages (InitMINDelayBRIs)

      This variable specifies the initial delay timeout in seconds
      before the revoking mobility entity retransmits a BRI message.
      The default is 1 second but is not to be configured to less than
      0.5 seconds.

   Maximum BRA TIMEOUT (MAX_BRACK_TIMEOUT)

      This variable specifies the maximum delay timeout in seconds
      before the revoking mobility entity retransmits a BRI message.
      The default is 2 seconds.

<span class="h2"><a class="selflink" name="section-12" href="#section-12">12</a>.  IANA Considerations</span>

   This specification defines a new Binding Revocation Message using a
   new Mobility Header Type 16, as described in <a href="#section-5">Section 5</a>.  The new
   Mobility Header type value needs to be assigned from the same
   numbering space as allocated for the other Mobility Header types
   registry.

   This document also creates a new registry "Binding Revocation Type"
   that indicates the type of the binding revocation message.  The
   current binding revocation message types are described in Sections
   5.1 and 5.2, and are the following:



<span class="grey">Muhanna, et al.              Standards Track                   [Page 34]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-35" id="page-35" href="#page-35" class="invisible"> </a>
<span class="grey"><a href="rfc5846.html">RFC 5846</a>          Binding Revocation for IPv6 Mobility         June 2010</span>


       0  Reserved
       1  Binding Revocation Indication
       2  Binding Revocation Acknowledgement
       All other values are unassigned

   Future values of the Binding Revocation Type can be allocated using
   Standards Action or IESG Approval [<a href="rfc5226.html" title="&quot;Guidelines for Writing an IANA Considerations Section in RFCs&quot;">RFC5226</a>].

   In addition, this document also creates a second new registry for the
   Revocation Trigger that indicates the reason behind sending the
   Binding Revocation Indication message.  The current Revocation
   Trigger values are described in <a href="#section-5.1">Section 5.1</a>, and are the following:

   Per-MN Revocation Trigger Values:
       0  Unspecified
       1  Administrative Reason
       2  Inter-MAG Handover - same Access Type
       3  Inter-MAG Handover - different Access Type
       4  Inter-MAG Handover - Unknown
       5  User-Initiated Session(s) Termination
       6  Access Network Session(s) Termination
       7  Possible Out-of-Sync BCE State

   Global Revocation Trigger Values:
       128  Per-Peer Policy
       129  Revoking Mobility Node Local Policy

   Reserved Revocation Trigger Values:
       250-255 Reserved For Testing Purposes only
       All other values are Unassigned

   Future values of the Revocation Trigger can be allocated using
   Standards Action or IESG Approval [<a href="rfc5226.html" title="&quot;Guidelines for Writing an IANA Considerations Section in RFCs&quot;">RFC5226</a>].

   Furthermore, this document creates a third new registry "Binding
   Revocation Acknowledgement Status Codes".  The current values are
   described in <a href="#section-5.2">Section 5.2</a>, and are the following:

         0  success
         1  partial success
       128  Binding Does NOT Exist
       129  IPv4 Home Address Option Required
       130  Global Revocation NOT Authorized
       131  Revoked Mobile Nodes Identity Required
       132  Revocation Failed - MN is Attached
       133  Revocation Trigger NOT Supported
       134  Revocation Function NOT Supported
       135  Proxy Binding Revocation NOT Supported



<span class="grey">Muhanna, et al.              Standards Track                   [Page 35]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-36" id="page-36" href="#page-36" class="invisible"> </a>
<span class="grey"><a href="rfc5846.html">RFC 5846</a>          Binding Revocation for IPv6 Mobility         June 2010</span>


   Future values of the Status field can be allocated using Standards
   Action or IESG Approval [<a href="rfc5226.html" title="&quot;Guidelines for Writing an IANA Considerations Section in RFCs&quot;">RFC5226</a>].

   All fields labeled "Reserved" are only to be assigned through
   Standards Action or IESG Approval.

<span class="h2"><a class="selflink" name="section-13" href="#section-13">13</a>.  Security Considerations</span>

   This specification allows the mobility node that initiates the
   binding revocation procedure to revoke a mobility session(s) that is
   currently registered with it.  It is NOT allowed for any mobility
   node to revoke a mobile node mobility session that is not registered
   with this mobility node.

   The binding revocation protocol described in this specification uses
   the same security association between the mobile node and the home
   agent or the mobile access gateway and the local mobility anchor that
   is being used to exchange the MIPv6 or PMIPv6 Binding Update and
   Binding Acknowledgement signaling.  If IPsec is used, the traffic
   selectors associated with the Security Policy Database (SPD) entry
   protecting the Binding Update and Binding Acknowledgement MUST be
   extended to include Binding Revocation Message MH type 16.  Extending
   the traffic selectors of the SPD entry in order to reuse the SA
   protecting the Binding Update and Binding Acknowledgement (instead of
   creating new ones) ensures that those SAs will be up and running when
   the revoking entity needs to send a binding revocation signaling
   message.

   On the other hand, if IPsec is not used as the underlying security
   mechanism to protect the Mobile IPv6 and its extensions binding
   registration signaling, the used underlying security mechanism MUST
   provide protection against all identified security threats as
   described under "Security Considerations" in [<a href="rfc3775.html" title="&quot;Mobility Support in IPv6&quot;">RFC3775</a>] and [<a href="rfc5213.html" title="&quot;Proxy Mobile IPv6&quot;">RFC5213</a>].

   Since some mobility entities, e.g., local mobility anchor and mobile
   access gateway, are allowed to send and receive Binding Revocation
   Indications and Binding Revocation Acknowledgements for different
   cases, when IPsec is used to secure signaling between the local
   mobility anchor and mobile access gateway, it prevents any of them
   from processing a Binding Revocation Message that was not constructed
   by an authorized party.

   The Proxy Mobile IPv6 [<a href="rfc5213.html" title="&quot;Proxy Mobile IPv6&quot;">RFC5213</a>] requires the local mobility anchor to
   restrict the creation and manipulation of proxy bindings to
   specifically authorized mobile access gateways.  Therefore, the
   mobile access gateway that is authorized to create or manipulate the
   mobile node proxy BCE is also authorized to revoke such mobile node
   registration by sending a de-registration with lifetime of zero.



<span class="grey">Muhanna, et al.              Standards Track                   [Page 36]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-37" id="page-37" href="#page-37" class="invisible"> </a>
<span class="grey"><a href="rfc5846.html">RFC 5846</a>          Binding Revocation for IPv6 Mobility         June 2010</span>


   However, since bulk termination using Binding Revocation Indication
   with the Global (G) bit set and the Revocation Trigger field set to
   "Per-Peer Policy" impacts all mobility sessions that are registered
   with the mobile access gateway and its local mobility anchor peer,
   the local mobility anchor MUST be locally configurable to authorize
   such specific functionality.  Additional mechanisms, such as a policy
   store or Authentication, Authorization, and Accounting (AAA) may be
   employed, but these are outside the scope of this specification.

<span class="h2"><a class="selflink" name="section-14" href="#section-14">14</a>.  Acknowledgements</span>

   The authors would like to thank Ryuji Wakikawa, Bruno Mongazon-
   Cazavet, Domagoj Premec, Arnaud Ebalard, Patrick Stupar, Vijay
   Devarapalli, and Joel Hortelius for their review and comments of this
   document and all colleagues who have supported the advancement of
   this effort.

   Also, we would like to thank Jari Arkko, Ben Campbell, Pasi Eronen,
   Ralph Droms, Alexey Melnikov, Tim Polk, Adrian Farrel, and Robert
   Sparks for their reviews of this document as part of the IESG review
   process.

<span class="h2"><a class="selflink" name="section-15" href="#section-15">15</a>.  References</span>

<span class="h3"><a class="selflink" name="section-15.1" href="#section-15.1">15.1</a>.  Normative References</span>

   [<a name="ref-RFC2119" id="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a name="ref-RFC5226" id="ref-RFC5226">RFC5226</a>]  Narten, T. and H. Alvestrand, "Guidelines for Writing an
              IANA Considerations Section in RFCs", <a href="https://tools.ietf.org/html/bcp26">BCP 26</a>, <a href="rfc5226.html">RFC 5226</a>,
              May 2008.

   [<a name="ref-RFC3775" id="ref-RFC3775">RFC3775</a>]  Johnson, D., Perkins, C., and J. Arkko, "Mobility Support
              in IPv6", <a href="rfc3775.html">RFC 3775</a>, June 2004.

   [<a name="ref-RFC4283" id="ref-RFC4283">RFC4283</a>]  Patel, A., Leung, K., Khalil, M., Akhtar, H., and K.
              Chowdhury, "Mobile Node Identifier Option for Mobile IPv6
              (MIPv6)", <a href="rfc4283.html">RFC 4283</a>, November 2005.

   [<a name="ref-RFC5213" id="ref-RFC5213">RFC5213</a>]  Gundavelli, S., Leung, K., Devarapalli, V., Chowdhury, K.,
              and B. Patil, "Proxy Mobile IPv6", <a href="rfc5213.html">RFC 5213</a>, August 2008.

   [<a name="ref-RFC5844" id="ref-RFC5844">RFC5844</a>]  Wakikawa, R. and S. Gundavelli, "IPv4 Support for Proxy
              Mobile IPv6", <a href="rfc5844.html">RFC 5844</a>, May 2010.






<span class="grey">Muhanna, et al.              Standards Track                   [Page 37]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-38" id="page-38" href="#page-38" class="invisible"> </a>
<span class="grey"><a href="rfc5846.html">RFC 5846</a>          Binding Revocation for IPv6 Mobility         June 2010</span>


   [<a name="ref-RFC5648" id="ref-RFC5648">RFC5648</a>]  Wakikawa, R., Devarapalli, V., Tsirtsis, G., Ernst, T.,
              and K. Nagami, "Multiple Care-of Addresses Registration",
              <a href="rfc5648.html">RFC 5648</a>, October 2009.

   [<a name="ref-RFC5555" id="ref-RFC5555">RFC5555</a>]  Soliman, H., "Mobile IPv6 Support for Dual Stack Hosts and
              Routers", <a href="rfc5555.html">RFC 5555</a>, June 2009.

<span class="h3"><a class="selflink" name="section-15.2" href="#section-15.2">15.2</a>.  Informative References</span>

   [<a name="ref-RFC3344" id="ref-RFC3344">RFC3344</a>]  Perkins, C., "IP Mobility Support for IPv4", <a href="rfc3344.html">RFC 3344</a>,
              August 2002.

   [<a name="ref-RFC3543" id="ref-RFC3543">RFC3543</a>]  Glass, S. and M. Chandra, "Registration Revocation in
              Mobile IPv4", <a href="rfc3543.html">RFC 3543</a>, August 2003.





































<span class="grey">Muhanna, et al.              Standards Track                   [Page 38]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-39" id="page-39" href="#page-39" class="invisible"> </a>
<span class="grey"><a href="rfc5846.html">RFC 5846</a>          Binding Revocation for IPv6 Mobility         June 2010</span>


Authors' Addresses

   Ahmad Muhanna
   Ericsson, Inc.
   2201 Lakeside Blvd.
   Richardson, TX  75082
   USA

   EMail: ahmad.muhanna@ericsson.com


   Mohamed Khalil
   Ericsson, Inc.
   6300 Legacy Dr.
   Plano, TX  75024
   USA

   EMail: mohamed.khalil@ericsson.com


   Sri Gundavelli
   Cisco
   170 West Tasman Drive
   San Jose, CA  95134
   USA

   EMail: sgundave@cisco.com


   Kuntal Chowdhury
   Cisco
   30 International Place
   Tewksbury, MA  01876
   USA

   EMail: kchowdhu@cisco.com


   Parviz Yegani
   Juniper Networks
   1194 North Mathilda Avenue
   Sunnyvale, CA  94089
   USA

   EMail: pyegani@juniper.net






Muhanna, et al.              Standards Track                   [Page 39]

</pre><br />
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>
</body>

<!-- Mirrored from tools.ietf.org/html/rfc5846 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:33 GMT -->
</html>
