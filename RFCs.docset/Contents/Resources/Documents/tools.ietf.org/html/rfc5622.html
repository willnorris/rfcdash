<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<!-- Mirrored from tools.ietf.org/html/rfc5622 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 28 Jul 2019 12:56:56 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head profile="http://dublincore.org/documents/2008/08/04/dc-html/">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="robots" content="index,follow" />
    <meta name="creator" content="rfcmarkup version 1.129c" />
    <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" />
<meta name="DC.Relation.Replaces" content="draft-floyd-dccp-ccid4" />
<meta name="DC.Identifier" content="urn:ietf:rfc:5622" />
<meta name="DC.Date.Issued" content="August, 2009" />
<meta name="DC.Creator" content="Floyd, Sally" />
<meta name="DC.Creator" content="Kohler, Eddie" />
<meta name="DC.Description.Abstract" content="This document specifies a profile for Congestion Control Identifier 4,
the small-packet variant of TCP-Friendly Rate Control (TFRC), in the
Datagram Congestion Control Protocol (DCCP). CCID 4 is for
experimental use, and uses TFRC-SP (RFC 4828), a variant of TFRC
designed for applications that send small packets. CCID 4 is
considered experimental because TFRC-SP is itself experimental, and is
not proposed for widespread deployment in the global Internet at this
time. The goal for TFRC-SP is to achieve roughly the same bandwidth in
bits per second (bps) as a TCP flow using packets of up to 1500 bytes
but experiencing the same level of congestion. CCID 4 is for use for
senders that send small packets and would like a TCP- friendly sending
rate, possibly with Explicit Congestion Notification (ECN), while
minimizing abrupt rate changes. This memo defines an Experimental
Protocol for the Internet community." />
<meta name="DC.Title" content="Profile for Datagram Congestion Control Protocol (DCCP) Congestion ID 4: TCP-Friendly Rate Control for Small Packets (TFRC-SP)" />

    <link rel="icon" href="https://tools.ietf.org/images/rfc.png" type="image/png" />
    <link rel="shortcut icon" href="https://tools.ietf.org/images/rfc.png" type="image/png" />
    <title>RFC 5622 - Profile for Datagram Congestion Control Protocol (DCCP) Congestion ID 4: TCP-Friendly Rate Control for Small Packets (TFRC-SP)</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div onmouseover="this.style.cursor='pointer';"
         onclick="showElem('legend');"
         onmouseout="hideElem('legend')"
	 style="height: 6px; position: absolute;"
         class="pre noprint docinfo bgyellow"
         title="Click for colour legend." >                                                                        </div>
      <div id="legend"
           class="docinfo noprint pre legend"
           style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; "
           onmouseover="showElem('legend');"
           onmouseout="hideElem('legend');">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc5622.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc5622" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-dccp-ccid4" title="draft-ietf-dccp-ccid4">draft-ietf-dccp...</a>] [<a href='https://datatracker.ietf.org/doc/rfc5622' title='IESG Datatracker information for this document'>Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc5622" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc5622" title="Side-by-side diff">Diff2</a>]         </span><br />
<span class="pre noprint docinfo">                                                                        </span><br />
<span class="pre noprint docinfo">Updated by: <a href="rfc6323.html">6323</a>, <a href="rfc8311.html">8311</a>                                      EXPERIMENTAL</span><br />
<span class="pre noprint docinfo">                                                                        </span><br />
<pre>
Network Working Group                                           S. Floyd
Request for Comments: 5622                                          ICIR
Category: Experimental                                         E. Kohler
                                                                    UCLA
                                                             August 2009


        <span class="h1">Profile for Datagram Congestion Control Protocol (DCCP)</span>
 <span class="h1">Congestion ID 4: TCP-Friendly Rate Control for Small Packets (TFRC-SP)</span>

Abstract

   This document specifies a profile for Congestion Control Identifier
   4, the small-packet variant of TCP-Friendly Rate Control (TFRC), in
   the Datagram Congestion Control Protocol (DCCP).  CCID 4 is for
   experimental use, and uses TFRC-SP (<a href="rfc4828.html">RFC 4828</a>), a variant of TFRC
   designed for applications that send small packets.  CCID 4 is
   considered experimental because TFRC-SP is itself experimental, and
   is not proposed for widespread deployment in the global Internet at
   this time.  The goal for TFRC-SP is to achieve roughly the same
   bandwidth in bits per second (bps) as a TCP flow using packets of up
   to 1500 bytes but experiencing the same level of congestion.  CCID 4
   is for use for senders that send small packets and would like a TCP-
   friendly sending rate, possibly with Explicit Congestion Notification
   (ECN), while minimizing abrupt rate changes.

Status of This Memo

   This memo defines an Experimental Protocol for the Internet
   community.  It does not specify an Internet standard of any kind.
   Discussion and suggestions for improvement are requested.
   Distribution of this memo is unlimited.

Copyright Notice

   Copyright (c) 2009 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents in effect on the date of
   publication of this document (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>).
   Please review these documents carefully, as they describe your rights
   and restrictions with respect to this document.

   This document may contain material from IETF Documents or IETF
   Contributions published or made publicly available before November
   10, 2008.  The person(s) controlling the copyright in some of this
   material may not have granted the IETF Trust the right to allow



<span class="grey">Floyd &amp; Kohler                Experimental                      [Page 1]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-2" id="page-2" href="#page-2" class="invisible"> </a>
<span class="grey"><a href="rfc5622.html">RFC 5622</a>                Profile for DCCP CCID 4              August 2009</span>


   modifications of such material outside the IETF Standards Process.
   Without obtaining an adequate license from the person(s) controlling
   the copyright in such materials, this document may not be modified
   outside the IETF Standards Process, and derivative works of it may
   not be created outside the IETF Standards Process, except to format
   it for publication as an RFC or to translate it into languages other
   than English.

Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-3">3</a>
   <a href="#section-2">2</a>. Conventions .....................................................<a href="#page-4">4</a>
   <a href="#section-3">3</a>. Usage ...........................................................<a href="#page-4">4</a>
      <a href="#section-3.1">3.1</a>. Relationship with TFRC and TFRC-SP .........................<a href="#page-5">5</a>
      <a href="#section-3.2">3.2</a>. Example Half-Connection ....................................<a href="#page-5">5</a>
   <a href="#section-4">4</a>. Connection Establishment ........................................<a href="#page-6">6</a>
   <a href="#section-5">5</a>. Congestion Control on Data Packets ..............................<a href="#page-6">6</a>
      <a href="#section-5.1">5.1</a>. Response to Idle and Application-Limited Periods ...........<a href="#page-7">7</a>
      <a href="#section-5.2">5.2</a>. Response to Data Dropped and Slow Receiver .................<a href="#page-7">7</a>
      <a href="#section-5.3">5.3</a>. Packet Sizes ...............................................<a href="#page-7">7</a>
   <a href="#section-6">6</a>. Acknowledgements ................................................<a href="#page-8">8</a>
      <a href="#section-6.1">6.1</a>. Loss Interval Definition ...................................<a href="#page-8">8</a>
      <a href="#section-6.2">6.2</a>. Congestion Control on Acknowledgements .....................<a href="#page-8">8</a>
      <a href="#section-6.3">6.3</a>. Acknowledgements of Acknowledgements .......................<a href="#page-8">8</a>
      <a href="#section-6.4">6.4</a>. Quiescence .................................................<a href="#page-8">8</a>
   <a href="#section-7">7</a>. Explicit Congestion Notification ................................<a href="#page-8">8</a>
   <a href="#section-8">8</a>. Options and Features ............................................<a href="#page-9">9</a>
      <a href="#section-8.1">8.1</a>. Window Counter Value ......................................<a href="#page-10">10</a>
      <a href="#section-8.2">8.2</a>. Elapsed Time Options ......................................<a href="#page-10">10</a>
      <a href="#section-8.3">8.3</a>. Receive Rate Option .......................................<a href="#page-10">10</a>
      <a href="#section-8.4">8.4</a>. Send Loss Event Rate Feature ..............................<a href="#page-10">10</a>
      <a href="#section-8.5">8.5</a>. Loss Event Rate Option ....................................<a href="#page-11">11</a>
      <a href="#section-8.6">8.6</a>. Loss Intervals Option .....................................<a href="#page-11">11</a>
      <a href="#section-8.7">8.7</a>. Dropped Packets Option ....................................<a href="#page-11">11</a>
           <a href="#section-8.7.1">8.7.1</a>. Example ............................................<a href="#page-13">13</a>
   <a href="#section-9">9</a>. Verifying Congestion Control Compliance with ECN ...............<a href="#page-14">14</a>
      <a href="#section-9.1">9.1</a>. Verifying the ECN Nonce Echo ..............................<a href="#page-14">14</a>
      9.2. Verifying the Reported Loss Intervals and Loss
           Event Rate ................................................<a href="#page-14">14</a>
   <a href="#section-10">10</a>. Implementation Issues .........................................<a href="#page-14">14</a>
      <a href="#section-10.1">10.1</a>. Timestamp Usage ..........................................<a href="#page-14">14</a>
      <a href="#section-10.2">10.2</a>. Determining Loss Events at the Receiver ..................<a href="#page-15">15</a>
      <a href="#section-10.3">10.3</a>. Sending Feedback Packets .................................<a href="#page-15">15</a>
   <a href="#section-11">11</a>. Design Considerations .........................................<a href="#page-15">15</a>
      <a href="#section-11.1">11.1</a>. The Field Size in the Loss Intervals Option ..............<a href="#page-15">15</a>
      <a href="#section-11.2">11.2</a>. The Field Size in the Dropped Packets Option .............<a href="#page-16">16</a>
   <a href="#section-12">12</a>. Experimental Status of This Document ..........................<a href="#page-17">17</a>
   <a href="#section-13">13</a>. Security Considerations .......................................<a href="#page-17">17</a>



<span class="grey">Floyd &amp; Kohler                Experimental                      [Page 2]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-3" id="page-3" href="#page-3" class="invisible"> </a>
<span class="grey"><a href="rfc5622.html">RFC 5622</a>                Profile for DCCP CCID 4              August 2009</span>


   <a href="#section-14">14</a>. IANA Considerations ...........................................<a href="#page-17">17</a>
      <a href="#section-14.1">14.1</a>. Reset Codes ..............................................<a href="#page-17">17</a>
      <a href="#section-14.2">14.2</a>. Option Types .............................................<a href="#page-17">17</a>
      <a href="#section-14.3">14.3</a>. Feature Numbers ..........................................<a href="#page-18">18</a>
   <a href="#section-15">15</a>. Thanks ........................................................<a href="#page-18">18</a>
   <a href="#section-16">16</a>. References ....................................................<a href="#page-18">18</a>
      <a href="#section-16.1">16.1</a>. Normative References .....................................<a href="#page-18">18</a>
      <a href="#section-16.2">16.2</a>. Informative References ...................................<a href="#page-19">19</a>

List of Tables

   Table 1: DCCP CCID 4 Options .......................................<a href="#page-9">9</a>
   Table 2: DCCP CCID 4 Feature Numbers ...............................<a href="#page-9">9</a>

<span class="h2"><a class="selflink" name="section-1" href="#section-1">1</a>.  Introduction</span>

   This document specifies an experimental profile for Congestion
   Control Identifier 4, TCP-Friendly Rate Control for Small Packets
   (TFRC-SP), in the Datagram Congestion Control Protocol (DCCP)
   [<a href="rfc4340.html" title="&quot;Datagram Congestion Control Protocol (DCCP)&quot;">RFC4340</a>].  CCID 4 is a modified version of Congestion Control
   Identifier 3, CCID 3, which has been specified in [<a href="rfc4342.html" title="&quot;Profile for Datagram Congestion Control Protocol (DCCP) Congestion Control ID 3: TCP-Friendly Rate Control (TFRC)&quot;">RFC4342</a>].  This
   document assumes that the reader is familiar with CCID 3, instead of
   repeating from that document unnecessarily.

   CCID 3 uses TCP-Friendly Rate Control (TFRC), which is now specified
   in <a href="rfc5348.html">RFC 5348</a> [<a href="rfc5348.html" title="&quot;TCP Friendly Rate Control (TFRC): Protocol Specification&quot;">RFC5348</a>].  CCID 4 differs from CCID 3 in that CCID 4
   uses TFRC-SP [<a href="rfc4828.html" title="&quot;TCP Friendly Rate Control (TFRC): The Small-Packet (SP) Variant&quot;">RFC4828</a>], an experimental, small-packet variant of
   TFRC.  The original specification of TFRC, <a href="rfc3448.html">RFC 3448</a> [<a href="rfc3448.html" title="&quot;TCP Friendly Rate Control (TFRC): Protocol Specification&quot;">RFC3448</a>], has
   been obsoleted by <a href="rfc5348.html">RFC 5348</a>.  The CCID 3 and TFRC-SP documents both
   predate <a href="rfc5348.html">RFC 5348</a> and refer instead to <a href="rfc3448.html">RFC 3448</a> for the specification
   of TFRC.  However, this document assumes that <a href="rfc5348.html">RFC 5348</a> will be used
   instead of <a href="rfc3448.html">RFC 3448</a> for the specification of TFRC.

   CCID 4 differs from CCID 3 only in the following respects:

   o  Header size: For TFRC-SP, the allowed transmit rate in bytes per
      second is reduced by a factor that accounts for packet header
      size.  This is specified for TFRC-SP in <a href="rfc4828.html#section-4.2">Section&nbsp;4.2 of [RFC4828]</a>,
      and described for CCID 4 in <a href="#section-5">Section 5</a> below.

   o  Maximum sending rate: TFRC-SP enforces a minimum interval of 10
      milliseconds between data packets.  This is specified for TFRC-SP
      in <a href="rfc4828.html#section-4.3">Section&nbsp;4.3 of [RFC4828]</a>, and described for CCID 4 in <a href="#section-5">Section 5</a>
      below.

   o  Loss rates for short loss intervals: For short loss intervals of
      at most two round-trip times (RTTs), the loss rate is computed by
      counting the actual number of packets lost or marked.  For such a



<span class="grey">Floyd &amp; Kohler                Experimental                      [Page 3]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-4" id="page-4" href="#page-4" class="invisible"> </a>
<span class="grey"><a href="rfc5622.html">RFC 5622</a>                Profile for DCCP CCID 4              August 2009</span>


      short loss interval with N data packets, including K lost or
      marked data packets, the loss interval length is calculated as
      N/K, instead of as N.  This is specified for TFRC-SP in <a href="rfc4828.html#section-4.4">Section</a>
      <a href="rfc4828.html#section-4.4">4.4 of [RFC4828]</a>.  If the sender is computing the loss event rate,
      the Dropped Packets option specified in <a href="#section-8.7">Section 8.7</a> is required,
      in addition to the default CCID 3's Loss Intervals option.
      <a href="#section-8.7">Section 8.7</a> describes the use of the Dropped Packets option in
      calculating the loss event rate.  The computation of the loss rate
      by the receiver for the Loss Event Rate option is described for
      CCID 4 in <a href="#section-8.4">Section 8.4</a> below.

   o  The nominal segment size: In TFRC-SP, the nominal segment size
      used by the TCP throughput equation is set to 1460 bytes.  This is
      specified for TFRC-SP in <a href="rfc4828.html#section-4.5">Section&nbsp;4.5 of [RFC4828]</a>, and described
      for CCID 4 in <a href="#section-5">Section 5</a> below.

<span class="h2"><a class="selflink" name="section-2" href="#section-2">2</a>.  Conventions</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [<a href="rfc2119.html" title="&quot;Key words for use in RFCs to Indicate Requirement Levels&quot;">RFC2119</a>].

   Additional terminology is described in <a href="rfc4342.html#section-2">Section&nbsp;2 of [RFC4342]</a>.

<span class="h2"><a class="selflink" name="section-3" href="#section-3">3</a>.  Usage</span>

   Like CCID 3, CCID 4's congestion control is appropriate for flows
   that would prefer to minimize abrupt changes in the sending rate,
   including streaming media applications with small or moderate
   receiver buffering before playback.

   CCID 4 is designed to be used either by applications that use a small
   fixed segment size, or by applications that change their sending rate
   by varying the segment size.  If CCID 4 is used by an application
   that varies its segment size in response to changes in the allowed
   sending rate in bps, we note that CCID 4 doesn't dictate the segment
   size to be used by the application; this is done by the application
   itself.  The CCID 4 sender determines the allowed sending rate in
   bps, in response to on-going feedback from the CCID 4 receiver, and
   the application can use information about the current allowed sending
   rate to decide whether to change the current segment size.

   We note that in some environments, there will be a feedback loop,
   with changes in the packet size or in the sending rate in bps
   affecting congestion along the path, therefore affecting the allowed
   sending rate in the future.





<span class="grey">Floyd &amp; Kohler                Experimental                      [Page 4]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-5" id="page-5" href="#page-5" class="invisible"> </a>
<span class="grey"><a href="rfc5622.html">RFC 5622</a>                Profile for DCCP CCID 4              August 2009</span>


<span class="h3"><a class="selflink" name="section-3.1" href="#section-3.1">3.1</a>.  Relationship with TFRC and TFRC-SP</span>

   The congestion control mechanisms described here follow the TFRC-SP
   mechanism specified in [<a href="rfc4828.html" title="&quot;TCP Friendly Rate Control (TFRC): The Small-Packet (SP) Variant&quot;">RFC4828</a>].  As with CCID 3, conformant CCID 4
   implementations MAY track updates to the TCP throughput equation
   directly, as updates are standardized in the IETF, rather than
   waiting for revisions of this document.  This document is based on
   CCID 3 [<a href="rfc4342.html" title="&quot;Profile for Datagram Congestion Control Protocol (DCCP) Congestion Control ID 3: TCP-Friendly Rate Control (TFRC)&quot;">RFC4342</a>], TFRC, and TFRC-SP.  For TFRC, <a href="rfc3448.html">RFC 3448</a> [<a href="rfc3448.html" title="&quot;TCP Friendly Rate Control (TFRC): Protocol Specification&quot;">RFC3448</a>]
   has been obsoleted by <a href="rfc5348.html">RFC 5348</a> [<a href="rfc5348.html" title="&quot;TCP Friendly Rate Control (TFRC): Protocol Specification&quot;">RFC5348</a>].

<span class="h3"><a class="selflink" name="section-3.2" href="#section-3.2">3.2</a>.  Example Half-Connection</span>

   This example shows the typical progress of a half-connection using
   CCID 4's TFRC Congestion Control, not including connection initiation
   and termination.  The example is informative, not normative.  This
   example differs from that for CCID 3 in [<a href="rfc4342.html" title="&quot;Profile for Datagram Congestion Control Protocol (DCCP) Congestion Control ID 3: TCP-Friendly Rate Control (TFRC)&quot;">RFC4342</a>] only in one
   respect; with CCID 4, the allowed transmit rate is determined by
   [<a href="rfc4828.html" title="&quot;TCP Friendly Rate Control (TFRC): The Small-Packet (SP) Variant&quot;">RFC4828</a>] as well as by [<a href="rfc5348.html" title="&quot;TCP Friendly Rate Control (TFRC): Protocol Specification&quot;">RFC5348</a>].

   1. The sender transmits DCCP-Data packets, where the sending rate is
      governed by the allowed transmit rate as specified in [<a href="rfc4828.html" title="&quot;TCP Friendly Rate Control (TFRC): The Small-Packet (SP) Variant&quot;">RFC4828</a>].
      Each DCCP-Data packet has a sequence number, and the DCCP header's
      CCVal field contains the window counter value, used by the
      receiver in determining when multiple losses belong in a single
      loss event.

      In the typical case of an ECN-capable half-connection, each DCCP-
      Data and DCCP-DataAck packet is sent as ECN-capable, with either
      the ECT(0) or the ECT(1) codepoint set.  The use of the ECN Nonce
      with TFRC is described in <a href="#section-9">Section 9</a>.

   2. The receiver sends DCCP-Ack packets, acknowledging the data
      packets at least once per round-trip time, unless the sender is
      sending at a rate of less than one packet per round-trip time
      [<a href="rfc5348.html" title="&quot;TCP Friendly Rate Control (TFRC): Protocol Specification&quot;">RFC5348</a>] (<a href="#section-6">Section 6</a>).  Each DCCP-Ack packet uses a sequence
      number, identifying the most recent packet received from the
      sender and includes feedback about the recent loss intervals
      experienced by the receiver.

   3. The sender continues sending DCCP-Data packets as controlled by
      the allowed transmit rate.  Upon receiving DCCP-Ack packets, the
      sender updates its allowed transmit rate as specified in [<a href="rfc5348.html" title="&quot;TCP Friendly Rate Control (TFRC): Protocol Specification&quot;">RFC5348</a>]
      (<a href="#section-4.3">Section 4.3</a>) and [<a href="rfc4828.html" title="&quot;TCP Friendly Rate Control (TFRC): The Small-Packet (SP) Variant&quot;">RFC4828</a>].  This update is based upon a loss
      event rate calculated by the sender, based on the receiver's
      loss-interval feedback.  If it prefers, the sender can also use a
      loss event rate calculated and reported by the receiver.





<span class="grey">Floyd &amp; Kohler                Experimental                      [Page 5]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-6" id="page-6" href="#page-6" class="invisible"> </a>
<span class="grey"><a href="rfc5622.html">RFC 5622</a>                Profile for DCCP CCID 4              August 2009</span>


   4. The sender estimates round-trip times and calculates a nofeedback
      time, as specified in [<a href="rfc5348.html" title="&quot;TCP Friendly Rate Control (TFRC): Protocol Specification&quot;">RFC5348</a>] (<a href="#section-4.4">Section 4.4</a>).  If no feedback is
      received from the receiver in that time (at least four round-trip
      times), the sender halves its sending rate.

<span class="h2"><a class="selflink" name="section-4" href="#section-4">4</a>.  Connection Establishment</span>

   The connection establishment is as specified in <a href="rfc4342.html#section-4">Section&nbsp;4 of
   [RFC4342]</a>.

<span class="h2"><a class="selflink" name="section-5" href="#section-5">5</a>.  Congestion Control on Data Packets</span>

   CCID 4 uses the congestion control mechanisms of TFRC [<a href="rfc5348.html" title="&quot;TCP Friendly Rate Control (TFRC): Protocol Specification&quot;">RFC5348</a>] and
   TFRC-SP [<a href="rfc4828.html" title="&quot;TCP Friendly Rate Control (TFRC): The Small-Packet (SP) Variant&quot;">RFC4828</a>].  [<a href="rfc4828.html" title="&quot;TCP Friendly Rate Control (TFRC): The Small-Packet (SP) Variant&quot;">RFC4828</a>] MUST be considered normative except
   where specifically indicated.

   Loss Event Rate

   As with CCID 3, the basic operation of CCID 4 centers around the
   calculation of a loss event rate: the number of loss events as a
   fraction of the number of packets transmitted, weighted over the last
   several loss intervals.  For CCID 4, this loss event rate, a round-
   trip time estimate, and a nominal packet size of 1460 bytes are
   plugged into the TCP throughput equation, as specified in <a href="rfc5348.html">RFC 5348</a>
   (<a href="#section-3.1">Section 3.1</a>) and [<a href="rfc4828.html" title="&quot;TCP Friendly Rate Control (TFRC): The Small-Packet (SP) Variant&quot;">RFC4828</a>].

   Because CCID 4 is intended for applications that send small packets,
   the allowed transmit rate derived from the TCP throughput equation is
   reduced by a factor that accounts for packet header size, as
   specified in <a href="rfc4828.html#section-4.2">Section&nbsp;4.2 of [RFC4828]</a>.  The header size on data
   packets is estimated as 36 bytes (20 bytes for the IPv4 header and 16
   bytes for the DCCP-Data header with 48-bit sequence numbers).  If the
   DCCP sender is sending N-byte data packets, the allowed transmit rate
   is reduced by N/(N+36).  CCID 4 senders are limited to this fair
   rate.  The header size would be 32 bytes instead of 36 bytes when
   24-bit sequence numbers were used in the DCCP-Data header.

   As explained in <a href="rfc4828.html#section-4.2">Section&nbsp;4.2 of [RFC4828]</a>, the actual header could be
   larger or smaller than the assumed value due to IP or DCCP options,
   IPv6, IP tunnels, header compression, and the like.  Because we are
   only aiming at rough fairness, and at a rough incentive for
   applications, the default use of a 32-byte or 36-byte header in the
   calculations of the header bandwidth is sufficient for both IPv4 and
   IPv6.

   If the sender is calculating the loss event rate itself, the loss
   event rate can be calculated using recent loss interval lengths
   reported by the receiver.  Loss intervals are precisely defined in



<span class="grey">Floyd &amp; Kohler                Experimental                      [Page 6]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-7" id="page-7" href="#page-7" class="invisible"> </a>
<span class="grey"><a href="rfc5622.html">RFC 5622</a>                Profile for DCCP CCID 4              August 2009</span>


   <a href="rfc4342.html#section-6.1">Section&nbsp;6.1 of [RFC4342]</a>, with the modification in [<a href="rfc4828.html" title="&quot;TCP Friendly Rate Control (TFRC): The Small-Packet (SP) Variant&quot;">RFC4828</a>] (<a href="#section-3">Section</a>
   <a href="#section-3">3</a>) for loss intervals of at most two round-trip times.  In summary, a
   loss interval is up to 1 RTT of possibly lost or ECN-marked data
   packets, followed by an arbitrary number of non-dropped, non-marked
   data packets.  The CCID 3 Loss Intervals option is used to report
   loss interval lengths; see <a href="#section-8.6">Section 8.6</a>.

   For loss intervals of at most two round-trip times, CCID 4 calculates
   the loss event rate for that interval by counting the number of
   packets lost or marked, as described in <a href="rfc4828.html#section-4.4">Section&nbsp;4.4 of [RFC4828]</a>.
   Thus, for such a short loss interval with N data packets, including K
   lost or marked data packets, the loss interval length is calculated
   as N/K, instead as N.  The Dropped Packets option is used to report
   K, the count of lost or marked data packets.

   Unlike CCID 3, the CCID 4 sender enforces a minimum interval of 10 ms
   between data packets, regardless of the allowed transmit rate.  If
   operating system scheduling granularity makes this impractical, up to
   one additional packet MAY be sent per timeslice, providing that no
   more than three packets are sent in any 30 ms interval.

   Other Congestion Control Mechanisms

   The other congestion control mechanisms such as slow-start and
   feedback packets are exactly as in CCID 3, and are described in the
   subsection on "Other Congestion Control Mechanisms" of <a href="rfc4342.html#section-5">Section&nbsp;5 in
   [RFC4342]</a>.

<span class="h3"><a class="selflink" name="section-5.1" href="#section-5.1">5.1</a>.  Response to Idle and Application-Limited Periods</span>

   This is described in <a href="rfc4342.html#section-5.1">Section&nbsp;5.1 of [RFC4342]</a>.  If Faster Restart is
   standardized in the IETF for TFRC [<a href="#ref-KFS07" title="&quot;Faster Restart for TCP Friendly Rate Control (TFRC)&quot;">KFS07</a>], then Faster Restart MAY be
   implemented in CCID4 without having to wait for an explicit update to
   this document.

<span class="h3"><a class="selflink" name="section-5.2" href="#section-5.2">5.2</a>.  Response to Data Dropped and Slow Receiver</span>

   This is described in <a href="rfc4342.html#section-5.2">Section&nbsp;5.2 of [RFC4342]</a>.

<span class="h3"><a class="selflink" name="section-5.3" href="#section-5.3">5.3</a>.  Packet Sizes</span>

   CCID 4 is intended for applications that use a fixed small segment
   size, or that vary their segment size in response to congestion.

   The CCID 4 sender uses a segment size of 1460 bytes in the TCP
   throughput equation.  This gives the CCID 4 sender roughly the same
   sending rate in bytes per second as a TFRC flow using 1460-byte
   segments but experiencing the same packet drop rate.



<span class="grey">Floyd &amp; Kohler                Experimental                      [Page 7]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-8" id="page-8" href="#page-8" class="invisible"> </a>
<span class="grey"><a href="rfc5622.html">RFC 5622</a>                Profile for DCCP CCID 4              August 2009</span>


<span class="h2"><a class="selflink" name="section-6" href="#section-6">6</a>.  Acknowledgements</span>

   The acknowledgements are as specified in <a href="rfc4342.html#section-6">Section&nbsp;6 of [RFC4342]</a> with
   the exception of the Loss Interval lengths specified below.

<span class="h3"><a class="selflink" name="section-6.1" href="#section-6.1">6.1</a>.  Loss Interval Definition</span>

   The loss interval definition is as defined in <a href="rfc4342.html#section-6.1">Section&nbsp;6.1 of
   [RFC4342]</a>, except as specified below.  <a href="rfc4342.html#section-6.1.1">Section&nbsp;6.1.1 of RFC 4342</a>
   specifies that for all loss intervals except the first one, the data
   length equals the sequence length minus the number of non-data
   packets the sender transmitted during the loss interval, with a
   minimum data length of one packet.  For short loss intervals of at
   most two round-trip times, TFRC-SP computes the loss interval length
   as the data length divided by the number of dropped or marked data
   packets (rather than as the data length of the loss interval).

   <a href="rfc4342.html#section-5.4">Section&nbsp;5.4 of RFC 4342</a> describes when to use the most recent loss
   interval in the calculation of the average loss interval.  [<a href="rfc4828.html" title="&quot;TCP Friendly Rate Control (TFRC): The Small-Packet (SP) Variant&quot;">RFC4828</a>]
   adds to this procedure the restriction that the most recent loss
   interval is only used in the calculation of the average loss interval
   if the most recent loss interval is greater than two round-trip
   times.  The pseudocode is given in <a href="rfc4828.html#section-3">Section&nbsp;3 of [RFC4828]</a>.

<span class="h3"><a class="selflink" name="section-6.2" href="#section-6.2">6.2</a>.  Congestion Control on Acknowledgements</span>

   The congestion control on acknowledgements is as specified in <a href="rfc4342.html#section-6.2">Section</a>
   <a href="rfc4342.html#section-6.2">6.2 of [RFC4342]</a>.

<span class="h3"><a class="selflink" name="section-6.3" href="#section-6.3">6.3</a>.  Acknowledgements of Acknowledgements</span>

   Procedures for the acknowledgement of acknowledgements are as
   specified in <a href="rfc4342.html#section-6.3">Section&nbsp;6.3 of [RFC4342]</a>.

<span class="h3"><a class="selflink" name="section-6.4" href="#section-6.4">6.4</a>.  Quiescence</span>

   The procedure for detecting that the sender has gone quiescent is as
   specified in <a href="rfc4342.html#section-6.4">Section&nbsp;6.4 of [RFC4342]</a>.

<span class="h2"><a class="selflink" name="section-7" href="#section-7">7</a>.  Explicit Congestion Notification</span>

   Procedures for the use of Explicit Congestion Notification (ECN) are
   as specified in <a href="rfc4342.html#section-7">Section&nbsp;7 of [RFC4342]</a>.








<span class="grey">Floyd &amp; Kohler                Experimental                      [Page 8]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-9" id="page-9" href="#page-9" class="invisible"> </a>
<span class="grey"><a href="rfc5622.html">RFC 5622</a>                Profile for DCCP CCID 4              August 2009</span>


<span class="h2"><a class="selflink" name="section-8" href="#section-8">8</a>.  Options and Features</span>

   CCID 4 can make use of DCCP's Ack Vector, Timestamp, Timestamp Echo,
   and Elapsed Time options, and its Send Ack Vector and ECN Incapable
   features.  CCID 4 also imports the currently defined CCID-3-specific
   options and features [<a href="rfc4342.html" title="&quot;Profile for Datagram Congestion Control Protocol (DCCP) Congestion Control ID 3: TCP-Friendly Rate Control (TFRC)&quot;">RFC4342</a>], augmented by the Dropped Packets
   option specified in this document.  Each CCID4-specific option and
   feature contains the same data as the corresponding CCID 3 option or
   feature, and is interpreted in the same way, except as specified
   elsewhere in this document (or in a subsequent IETF standards-track
   RFC that updates or obsoletes this specification).

                Option                        DCCP-   Section
       Type     Length     Meaning            Data?  Reference
       -----    ------     -------            -----  ---------
      128-183              Unassigned
      184-190              Reserved for
                            experimental
                            and testing use
        191                Unassigned
        192        6       Loss Event Rate      N      8.5
        193     variable   Loss Intervals       N      8.6
        194        6       Receive Rate         N      8.3
        195     variable   Dropped Packets      N      8.7
      196-247              Unassigned
      248-254              Reserved for
                            experimental
                            and testing use
        255                Unassigned

                         Table 1: DCCP CCID 4 Options

   The "DCCP-Data?" column indicates that all currently defined CCID4-
   specific options MUST be ignored when they occur on DCCP-Data
   packets.

   As with CCID 3, the following CCID-specific features are also
   defined.













<span class="grey">Floyd &amp; Kohler                Experimental                      [Page 9]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-10" id="page-10" href="#page-10" class="invisible"> </a>
<span class="grey"><a href="rfc5622.html">RFC 5622</a>                Profile for DCCP CCID 4              August 2009</span>


      Number   Meaning                  Rule   Value  Req'd Reference
      ------   -------                  -----  -----  ----- ---------
      128-183  Unassigned
      184-190  Reserved for experimental
                and testing use
        191    Unassigned
        192    Send Loss Event Rate      SP      0      N      8.4
      193-247  Unassigned
      248-254  Reserved for experimental
                and testing use
        255    Unassigned

                     Table 2: DCCP CCID 4 Feature Numbers

   More information is available in <a href="rfc4342.html#section-8">Section&nbsp;8 of [RFC4342]</a>.

<span class="h3"><a class="selflink" name="section-8.1" href="#section-8.1">8.1</a>.  Window Counter Value</span>

   The use of the Window Counter Value in the DCCP generic header's
   CCVal field is as specified in <a href="rfc4342.html#section-8.1">Section&nbsp;8.1 of [RFC4342]</a>.  In addition
   to their use described in CCID 3, the CCVal counters are used by the
   receiver in CCID 4 to determine when the length of a loss interval is
   at most two round-trip times.  None of these procedures require the
   receiver to maintain an explicit estimate of the round-trip time.
   However, <a href="rfc4342.html#section-8.1">Section&nbsp;8.1 of [RFC4342]</a> gives a procedure that implementors
   may use if they wish to keep such an RTT estimate using CCVal.

<span class="h3"><a class="selflink" name="section-8.2" href="#section-8.2">8.2</a>.  Elapsed Time Options</span>

   The use of the Elapsed Time option is defined in <a href="rfc4342.html#section-8.2">Section&nbsp;8.2 of
   [RFC4342]</a>.

<span class="h3"><a class="selflink" name="section-8.3" href="#section-8.3">8.3</a>.  Receive Rate Option</span>

   The Receive Rate option is as specified in <a href="rfc4342.html#section-8.3">Section&nbsp;8.3 of [RFC4342]</a>.

<span class="h3"><a class="selflink" name="section-8.4" href="#section-8.4">8.4</a>.  Send Loss Event Rate Feature</span>

   The Send Loss Event Rate feature is as defined in <a href="rfc4342.html#section-8.4">Section&nbsp;8.4 of
   [RFC4342]</a>.

   See <a href="rfc5348.html#section-5">[RFC5348], Section&nbsp;5</a>, and <a href="rfc4828.html#section-4.4">[RFC4828], Section&nbsp;4.4</a>, for a normative
   calculation of the loss event rate.  <a href="rfc4828.html#section-4.4">Section&nbsp;4.4 of [RFC4828]</a>
   modifies the calculation of the loss interval size for loss intervals
   of at most two round-trip times.






<span class="grey">Floyd &amp; Kohler                Experimental                     [Page 10]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-11" id="page-11" href="#page-11" class="invisible"> </a>
<span class="grey"><a href="rfc5622.html">RFC 5622</a>                Profile for DCCP CCID 4              August 2009</span>


   If the CCID 4 receiver is using the Loss Event Rate option, the
   receiver needs to be able to determine if a loss interval is short,
   of at most two round-trip times.  The receiver can heuristically
   detect a short loss interval by using the Window Counter in arriving
   data packets.  The sender increases the Window Counter by 1 every
   quarter of a round-trip time, with the caveat that the Window Counter
   is never increased by more than five, modulo 16, from one data packet
   to the next.  Using the Window Counter to detect loss intervals of at
   most two round-trip times could result in some false positives, with
   some longer loss intervals incorrectly identified as short ones.  For
   example, if the loss interval contained data packets with only two
   Window Counter values, say, k and k+5, then the receiver could not
   tell if the loss interval was at most two round-trip times long or
   not.  Similarly, if the sender sent data packets with Window Counter
   values of 4, 8, 12, 0, 5, but the packets with Window Counter values
   of 8, 12, and 0 were lost in the network, then the receiver would
   only receive data packets with Window Counter values of 4 and 5, and
   would incorrectly infer that the loss interval was at most two round-
   trip times.

<span class="h3"><a class="selflink" name="section-8.5" href="#section-8.5">8.5</a>.  Loss Event Rate Option</span>

   The Loss Event Rate option is as specified in <a href="rfc4342.html#section-8.5">Section&nbsp;8.5 of
   [RFC4342]</a>.

   See [<a href="rfc5348.html" title="&quot;TCP Friendly Rate Control (TFRC): Protocol Specification&quot;">RFC5348</a>] (<a href="#section-5">Section 5</a>) and [<a href="rfc4828.html" title="&quot;TCP Friendly Rate Control (TFRC): The Small-Packet (SP) Variant&quot;">RFC4828</a>] for a normative calculation
   of the loss event rate.

<span class="h3"><a class="selflink" name="section-8.6" href="#section-8.6">8.6</a>.  Loss Intervals Option</span>

   The Loss Intervals option is as specified in <a href="rfc4342.html#section-8.6">Section&nbsp;8.6 of
   [RFC4342]</a>.

<span class="h3"><a class="selflink" name="section-8.7" href="#section-8.7">8.7</a>.  Dropped Packets Option</span>

   This section describes the Dropped Packets option, a mechanism for
   reporting the number of lost and marked packets per loss interval.
   By reporting both the Loss Intervals and Dropped Packets options on
   the feedback packets, the receiver gives the sender sufficient
   information to calculate the loss event rate, or to verify the
   calculation of the reported loss event rate, if the sender so
   desires.

   The core information reported by CCID 4 receivers is a list of recent
   loss intervals, where a loss interval begins with a lost or ECN-
   marked data packet; continues with at most one round-trip time's
   worth of packets that may or may not be lost or marked; and completes
   with an arbitrarily long series of non-dropped, non-marked data



<span class="grey">Floyd &amp; Kohler                Experimental                     [Page 11]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-12" id="page-12" href="#page-12" class="invisible"> </a>
<span class="grey"><a href="rfc5622.html">RFC 5622</a>                Profile for DCCP CCID 4              August 2009</span>


   packets.  Loss intervals model the congestion behavior of TCP NewReno
   senders, which reduce their sending rate at most once per window of
   data packets.  Consequently, the number of packets lost in a loss
   interval is not important for either TCP's or TFRC's congestion
   response.  CCID 3's Loss Intervals option reports the length of each
   loss interval's lossy part, not the number of packets that were
   actually lost or marked in that lossy part.

   However, for computing the loss event rate for periods that include
   short loss intervals the TFRC-SP sender needs to know the number of
   packets lost or marked in a loss interval, over and above the length
   of the loss interval in packets.  The Dropped Packets option, a
   CCID4-specific option, reports this information.  Together with the
   existing Loss Intervals option, the Dropped Packets option allows the
   CCID 4 sender to discover exactly how many packets were dropped from
   each loss interval.  The receiver reports the number of lost or
   marked packets in its recently observed loss intervals using the
   Dropped Packets option.

   The Dropped Packets Option is specified as follows:

      +--------+--------+-------...-------+--------+-------
      |11000011| Length |   Drop Count    | More Drop Counts...
      +--------+--------+-------...-------+--------+-------
       Type=195               3 bytes

            Figure 1: Dropped Packets Option

   The Dropped Packets option contains information about one to 84
   consecutive loss intervals, always including the most recent loss
   interval.  As with the Loss Intervals option, intervals are listed in
   reverse chronological order.  Should more than 84 loss intervals need
   to be reported, multiple Dropped Packets options can be sent; the
   second option begins where the first left off, and so forth.

   One Drop Count is specified per loss interval.  Drop Count is a 24-
   bit number that equals the number of packets, lost or received, ECN-
   marked during the corresponding loss interval.  By definition, this
   number MUST NOT exceed the corresponding loss interval's Loss Length.

   CCID 4 receivers MUST report Dropped Packets options with every
   feedback packet.  Any packet containing a Loss Intervals option MUST
   also contain a Dropped Packets option covering the same loss
   intervals.  If a feedback packet does not include a relevant Dropped
   Packets option, and the CCID 4 sender is computing the loss event
   rate itself, the sender MUST treat the relevant loss intervals' Drop
   Counts as equal to the corresponding Loss Lengths, as specified
   below.



<span class="grey">Floyd &amp; Kohler                Experimental                     [Page 12]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-13" id="page-13" href="#page-13" class="invisible"> </a>
<span class="grey"><a href="rfc5622.html">RFC 5622</a>                Profile for DCCP CCID 4              August 2009</span>


   Consider a CCID 4 receiver.  As specified in Section 8.6.1 of <a href="rfc4342.html">RFC</a>
   <a href="rfc4342.html">4342</a>, the receiver sends the Loss Intervals option for all intervals
   that have not been acknowledged by the sender.  When this receiver
   sends a feedback packet containing information about the N most
   recent loss intervals (packaged in one or more Loss Intervals
   options), then the receiver includes on the same feedback packet one
   or more Dropped Packets options covering exactly those N loss
   intervals.  CCID 4 senders MUST ignore Drop Counts information for
   loss intervals not covered by a Loss Intervals option on the same
   feedback packet.  Conversely, a CCID 4 sender might want to
   interpolate Drop Counts information for a loss interval not covered
   by any Dropped Packets options; such a sender MUST use the
   corresponding loss interval's Loss Length as its Drop Count.

   Each loss interval's Drop Count MUST, by definition, be less than or
   equal to its Loss Length.  A Drop Count that exceeds the
   corresponding Loss Length MUST be treated as equal to the Loss
   Length.

<span class="h4"><a class="selflink" name="section-8.7.1" href="#section-8.7.1">8.7.1</a>.  Example</span>

   Consider the following sequence of packets, where "-" represents a
   safely delivered packet and "*" represents a lost or marked packet.
   This sequence is repeated from [<a href="rfc4342.html" title="&quot;Profile for Datagram Congestion Control Protocol (DCCP) Congestion Control ID 3: TCP-Friendly Rate Control (TFRC)&quot;">RFC4342</a>].

      Sequence
       Numbers: 0         10        20        30        40  44
                |         |         |         |         |   |
                ----------*--------***-*--------*----------*-

      Figure 2:  Sequence of Delivered (-) and Lost (*) Packets

   Assuming that packet 43 was lost, not marked, this sequence might be
   divided into loss intervals as follows:

      0         10        20        30        40  44
      |         |         |         |         |   |
      ----------*--------***-*--------*----------*-
      \________/\_______/\___________/\_________/
          L0       L1         L2          L3

      Figure 3:  Loss Intervals for the Packet Sequence

   A Loss Intervals option sent on a packet with Acknowledgement Number
   44 to acknowledge this set of loss intervals might contain the bytes
   193,39,2, 0,0,10, 128,0,1, 0,0,10, 0,0,8, 0,0,5, 0,0,10, 0,0,8,
   0,0,1, 0,0,8, 0,0,10, 128,0,0, 0,0,15; for interpretation of this




<span class="grey">Floyd &amp; Kohler                Experimental                     [Page 13]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-14" id="page-14" href="#page-14" class="invisible"> </a>
<span class="grey"><a href="rfc5622.html">RFC 5622</a>                Profile for DCCP CCID 4              August 2009</span>


   option, see [<a href="rfc4342.html" title="&quot;Profile for Datagram Congestion Control Protocol (DCCP) Congestion Control ID 3: TCP-Friendly Rate Control (TFRC)&quot;">RFC4342</a>].  A Dropped Packets option sent in tandem on
   this packet would contain the bytes 195,14, 0,0,1, 0,0,4, 0,0,1,
   0,0,0.  This is interpreted as follows.

   195 The Dropped Packets option number.

   14       The length of the option, including option type and length
            bytes.  This option contains information about (14 - 2)/3 =
            4 loss intervals.  Note that the two most recent sequence
            numbers are not yet part of any loss interval -- the Loss
            Intervals option includes them in its Skip Length -- and are
            thus not included in the Dropped Packets option.

   0,0,1    These bytes define the Drop Count for L3, which is 1.  As
            required, the Drop Count is less than or equal to L3's Loss
            Length, which is also 1.

   0,0,4    The Drop Count for L2 is 4.

   0,0,1    The Drop Count for L1 is 1.

   0,0,0    Finally, the Drop Count for L0 is 0.

<span class="h2"><a class="selflink" name="section-9" href="#section-9">9</a>.  Verifying Congestion Control Compliance with ECN</span>

   Verifying congestion control compliance with ECN is as discussed in
   <a href="rfc4342.html#section-9">Section&nbsp;9 of [RFC4342]</a>.

<span class="h3"><a class="selflink" name="section-9.1" href="#section-9.1">9.1</a>.  Verifying the ECN Nonce Echo</span>

   Procedures for verifying the ECN Nonce Echo are as specified in
   <a href="rfc4342.html#section-9.1">Section&nbsp;9.1 of [RFC4342]</a>.

<span class="h3"><a class="selflink" name="section-9.2" href="#section-9.2">9.2</a>.  Verifying the Reported Loss Intervals and Loss Event Rate</span>

   <a href="rfc4342.html#section-9.2">Section&nbsp;9.2 of [RFC4342]</a> discusses the sender's possible verification
   of loss intervals and loss event rate information reported by the
   receiver.

<span class="h2"><a class="selflink" name="section-10" href="#section-10">10</a>.  Implementation Issues</span>

<span class="h3"><a class="selflink" name="section-10.1" href="#section-10.1">10.1</a>.  Timestamp Usage</span>

   The use of the Timestamp option is as discussed in <a href="rfc4342.html#section-10.1">Section&nbsp;10.1 of
   [RFC4342]</a>.






<span class="grey">Floyd &amp; Kohler                Experimental                     [Page 14]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-15" id="page-15" href="#page-15" class="invisible"> </a>
<span class="grey"><a href="rfc5622.html">RFC 5622</a>                Profile for DCCP CCID 4              August 2009</span>


<span class="h3"><a class="selflink" name="section-10.2" href="#section-10.2">10.2</a>.  Determining Loss Events at the Receiver</span>

   The use of the window counter by the receiver to determine if
   multiple lost packets belong to the same loss event is as described
   in <a href="rfc4342.html#section-10.2">Section&nbsp;10.2 of [RFC4342]</a>.

<span class="h3"><a class="selflink" name="section-10.3" href="#section-10.3">10.3</a>.  Sending Feedback Packets</span>

   The procedure for sending feedback packets is as described in <a href="rfc4342.html#section-10.3">Section</a>
   <a href="rfc4342.html#section-10.3">10.3 of [RFC4342]</a>.

<span class="h2"><a class="selflink" name="section-11" href="#section-11">11</a>.  Design Considerations</span>

   This section discusses design considerations for the field sizes in
   the Loss Intervals and Dropped Packets options.

<span class="h3"><a class="selflink" name="section-11.1" href="#section-11.1">11.1</a>.  The Field Size in the Loss Intervals Option</span>

   <a href="rfc4342.html#section-8.6">Section&nbsp;8.6 of RFC 4342</a> specifies a Loss Intervals option with three
   fields for each loss interval, for reporting the Lossless Length,
   Loss Length, and Data Length.  Each field is specified to be three
   bytes.  <a href="#section-8.6">Section 8.6</a> of this document specifies that CCID 4 use the
   same Loss Intervals option as CCID 3, with the same field sizes.
   This has the significant advantage of minimizing the implementation
   differences between CCID 3 and CCID 4.  However, it has been
   suggested that CCID 4 *could* use a Loss Intervals option with
   smaller field sizes, since a CCID 4 sender enforces a minimum
   interval of 10 ms between data packets.  This section explains the
   reason for CCID 4 to use the same Loss Intervals option as specified
   for CCID 3.

   The Lossless Length field reports the number of packets in the loss
   intervals' lossless part, and the Loss Length field reports the
   number of packets in the loss interval's lossy part.  The Data Length
   field reports the number of packets in the loss interval's data
   length (excluding non-data packets).  A two-byte Data Length field
   can report a data length of 65,536 packets, corresponding to a loss
   event rate of 0.00002; this is enough to give the CCID 4 sender an
   allowed sending rate of roughly 250 packets per RTT, which is enough
   for a connection with a round-trip time of at most 2.5 seconds.  For
   a CCID 4 connection with a larger round-trip time, the three-byte
   Lossless Length and Data Length fields would be needed.

   For the Loss Length field in the Loss Intervals option, reporting the
   number of packets in the one-RTT lossy part of the loss interval, a
   one-byte field would not be sufficient for a CCID 4 connection with a
   long RTT (three seconds or longer).  For the Loss Length field, a
   two-byte field should be sufficient for CCID 4.  However, our



<span class="grey">Floyd &amp; Kohler                Experimental                     [Page 15]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-16" id="page-16" href="#page-16" class="invisible"> </a>
<span class="grey"><a href="rfc5622.html">RFC 5622</a>                Profile for DCCP CCID 4              August 2009</span>


   judgement is that the advantages of using the same Loss Intervals
   option as in CCID 3 outweigh any advantages of using a CCID 4 Loss
   Intervals option that uses eight bytes instead of nine bytes for
   reporting the fields for each loss interval.

<span class="h3"><a class="selflink" name="section-11.2" href="#section-11.2">11.2</a>.  The Field Size in the Dropped Packets Option</span>

   <a href="#section-8.7">Section 8.7</a> specifies the Dropped Packets option for reporting the
   number of lost or marked packets per loss interval, allocating three
   bytes for the drop count field for each loss interval reported.  The
   three-byte field is partly for simplicity, to give the same field
   size as the fields in the Loss Intervals option specified in <a href="rfc4342.html">RFC</a>
   <a href="rfc4342.html">4342</a>.  It has been suggested that CCID 4 *could* use a smaller field
   size for the Dropped Packets option.  This section discusses the
   issue of the size of the drop count field in the Dropped Packets
   option.

   It is not necessary to specify a three-byte field for the Dropped
   Packets option.  A one-byte field would allow a reported drop count
   of 255, and a two-byte field would allow a reported drop count of
   65,535.  A two-byte field would clearly be sufficient for the drop
   count field for CCID 4.

   In fact, a one-byte field would *probably* be adequate for reporting
   the drop count for a loss interval in a CCID 4 connection.  Because a
   CCID 4 sender enforces a minimum interval of 10 ms between data
   packets, a sender would need a round-trip time of over 2.55 seconds
   to have more than 255 packets lost or marked in a single loss
   interval;  round-trip times of greater than three seconds are not
   unusual for some flows traversing satellite links.  The drop count
   field is used in CCID 4 to compute the actual loss rate for short
   loss intervals, rather than using the loss event rate that is used
   for longer loss intervals.  If a loss interval of at most two round-
   trip times included N packets sent, with more than 255 of those
   packets lost or marked, a drop count field of one byte would allow a
   drop count of at most 255 to be reported, resulting in a computed
   loss rate for that interval of 255/N.  This loss rate might be less
   than the actual loss rate, but it is significantly higher than the
   loss event rate of 1/N, and should be sufficient to prevent a steady-
   state condition of a CCID 4 connection with multiple packets dropped
   each round-trip time.  Thus, a one-byte field would probably be
   adequate for reporting the drop count for a loss interval in a CCID 4
   connection.  However, at the moment this document specifies a three-
   byte field, for consistency with the field size in the Loss Intervals
   option.






<span class="grey">Floyd &amp; Kohler                Experimental                     [Page 16]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-17" id="page-17" href="#page-17" class="invisible"> </a>
<span class="grey"><a href="rfc5622.html">RFC 5622</a>                Profile for DCCP CCID 4              August 2009</span>


<span class="h2"><a class="selflink" name="section-12" href="#section-12">12</a>.  Experimental Status of This Document</span>

   TFRC-SP is a congestion control mechanism defined in <a href="rfc4828.html">RFC 4828</a>.
   <a href="rfc4828.html#section-10">Section&nbsp;10 of [RFC4828]</a> describes why TFRC-SP is currently specified
   as experimental and why it is not intended for widespread deployment
   at this time in the global Internet.  Since TFRC-SP is Experimental,
   CCID 4 is therefore also considered experimental.  If the IETF
   publishes a Standards-Track RFC that changes the status of TFRC-SP,
   then CCID 4 should then be updated to reflect the change of status.

<span class="h2"><a class="selflink" name="section-13" href="#section-13">13</a>.  Security Considerations</span>

   Security considerations include those discussed in <a href="rfc4342.html#section-11">Section&nbsp;11 of
   [RFC4342]</a>.  There are no new security considerations introduced by
   CCID 4.

<span class="h2"><a class="selflink" name="section-14" href="#section-14">14</a>.  IANA Considerations</span>

   This specification defines the value 4 in the DCCP CCID namespace
   managed by IANA.  This is a permanent codepoint, as is needed for
   experimentation across the Internet using different codebases.

   CCID 4 also uses three sets of numbers whose values have been
   allocated by IANA, namely CCID4-specific Reset Codes, option types,
   and feature numbers.  This document makes no particular allocations
   from the Reset Code range, except for experimental and testing use
   [<a href="rfc3692.html" title="&quot;Assigning Experimental and Testing Numbers Considered Useful&quot;">RFC3692</a>].  We refer to the Standards Action policy outlined in
   [<a href="rfc5226.html" title="&quot;Guidelines for Writing an IANA Considerations Section in RFCs&quot;">RFC5226</a>].

<span class="h3"><a class="selflink" name="section-14.1" href="#section-14.1">14.1</a>.  Reset Codes</span>

   Each entry in the DCCP CCID 4 Reset Code registry contains a CCID4-
   specific Reset Code, which is a number in the range 128-255; a short
   description of the Reset Code; and a reference to the RFC defining
   the Reset Code.  Reset Codes 184-190 and 248-254 are permanently
   reserved for experimental and testing use.  The remaining Reset Codes
   -- 128-183, 191-247, and 255 -- are currently reserved, and should be
   allocated with the Standards Action policy, which requires IESG
   review and approval and Standards-Track IETF RFC publication.

<span class="h3"><a class="selflink" name="section-14.2" href="#section-14.2">14.2</a>.  Option Types</span>

   Each entry in the DCCP CCID 4 option type registry contains a CCID4-
   specific option type, which is a number in the range 128-255; the
   name of the option, such as "Loss Intervals"; and a reference to the
   RFC defining the option type.  The registry is initially populated
   using the values in Table 1, in <a href="#section-8">Section 8</a>.  This includes the value
   195 allocated for the Dropped Packets option.  This document



<span class="grey">Floyd &amp; Kohler                Experimental                     [Page 17]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-18" id="page-18" href="#page-18" class="invisible"> </a>
<span class="grey"><a href="rfc5622.html">RFC 5622</a>                Profile for DCCP CCID 4              August 2009</span>


   allocates option types 192-195, and option types 184-190 and 248-254
   are permanently reserved for experimental and testing use.  The
   remaining option types -- 128-183, 191, 196-247, and 255 -- are
   currently reserved, and should be allocated with the Standards Action
   policy, which requires IESG review and approval and Standards-Track
   IETF RFC publication.

<span class="h3"><a class="selflink" name="section-14.3" href="#section-14.3">14.3</a>.  Feature Numbers</span>

   Each entry in the DCCP CCID 4 feature number registry contains a
   CCID4-specific feature number, which is a number in the range 128-
   255; the name of the feature, such as "Send Loss Event Rate"; and a
   reference to the RFC defining the feature number.  The registry is
   initially populated using the values in Table 2, in <a href="#section-8">Section 8</a>.  This
   document allocates feature number 192, and feature numbers 184-190
   and 248-254 are permanently reserved for experimental and testing
   use.  The remaining feature numbers -- 128-183, 191, 193-247, and 255
   -- are currently reserved, and should be allocated with the Standards
   Action policy, which requires IESG review and approval and Standards-
   Track IETF RFC publication.

<span class="h2"><a class="selflink" name="section-15" href="#section-15">15</a>.  Thanks</span>

   We thank Gorry Fairhurst, Alfred Hoenes, Ian McDonald, Gerrit Renker,
   and Leandro Sales for feedback on this document.

<span class="h2"><a class="selflink" name="section-16" href="#section-16">16</a>.  References</span>

<span class="h3"><a class="selflink" name="section-16.1" href="#section-16.1">16.1</a>.  Normative References</span>

   [<a name="ref-RFC2119" id="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a name="ref-RFC3448" id="ref-RFC3448">RFC3448</a>]  Handley, M., Floyd, S., Padhye, J., and J. Widmer, "TCP
              Friendly Rate Control (TFRC): Protocol Specification", <a href="rfc3448.html">RFC</a>
              <a href="rfc3448.html">3448</a>, January 2003.

   [<a name="ref-RFC3692" id="ref-RFC3692">RFC3692</a>]  Narten, T., "Assigning Experimental and Testing Numbers
              Considered Useful", <a href="https://tools.ietf.org/html/bcp82">BCP 82</a>, <a href="rfc3692.html">RFC 3692</a>, January 2004.

   [<a name="ref-RFC4340" id="ref-RFC4340">RFC4340</a>]  Kohler, E., Handley, M., and S. Floyd, "Datagram
              Congestion Control Protocol (DCCP)", <a href="rfc4340.html">RFC 4340</a>, March 2006.

   [<a name="ref-RFC4342" id="ref-RFC4342">RFC4342</a>]  Floyd, S., Kohler, E., and J. Padhye, "Profile for
              Datagram Congestion Control Protocol (DCCP) Congestion
              Control ID 3: TCP-Friendly Rate Control (TFRC)", <a href="rfc4342.html">RFC 4342</a>,
              March 2006.




<span class="grey">Floyd &amp; Kohler                Experimental                     [Page 18]</span></pre>
<hr class='noprint' style='width: 96ex;' align='left'/><!--NewPage--><pre class='newpage'><a name="page-19" id="page-19" href="#page-19" class="invisible"> </a>
<span class="grey"><a href="rfc5622.html">RFC 5622</a>                Profile for DCCP CCID 4              August 2009</span>


   [<a name="ref-RFC4828" id="ref-RFC4828">RFC4828</a>]  Floyd, S. and E. Kohler, "TCP Friendly Rate Control
              (TFRC): The Small-Packet (SP) Variant", <a href="rfc4828.html">RFC 4828</a>, April
              2007.

   [<a name="ref-RFC5226" id="ref-RFC5226">RFC5226</a>]  Narten, T. and H. Alvestrand, "Guidelines for Writing an
              IANA Considerations Section in RFCs", <a href="https://tools.ietf.org/html/bcp26">BCP 26</a>, <a href="rfc5226.html">RFC 5226</a>,
              May 2008.

   [<a name="ref-RFC5348" id="ref-RFC5348">RFC5348</a>]  Floyd, S., Handley, M., Padhye, J., and J. Widmer, "TCP
              Friendly Rate Control (TFRC): Protocol Specification", <a href="rfc5348.html">RFC</a>
              <a href="rfc5348.html">5348</a>, September 2008.

<span class="h3"><a class="selflink" name="section-16.2" href="#section-16.2">16.2</a>.  Informative References</span>

   [<a name="ref-KFS07" id="ref-KFS07">KFS07</a>]    Kohler, E., Floyd, S., and A. Sathiaseelan, "Faster
              Restart for TCP Friendly Rate Control (TFRC)", Work in
              Progress, July 2008.

Authors' Addresses

   Sally Floyd
   ICSI Center for Internet Research
   1947 Center Street, Suite 600
   Berkeley, CA 94704
   USA

   EMail:  floyd@icir.org

   Eddie Kohler
   4531C Boelter Hall
   UCLA Computer Science Department
   Los Angeles, CA 90095
   USA

   EMail: kohler@cs.ucla.edu
















Floyd &amp; Kohler                Experimental                     [Page 19]

</pre><br />
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.129c, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>
</body>

<!-- Mirrored from tools.ietf.org/html/rfc5622 by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 28 Jul 2019 12:56:56 GMT -->
</html>
