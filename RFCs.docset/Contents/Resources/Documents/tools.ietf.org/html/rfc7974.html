<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc7974 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:18 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="urn:ietf:rfc:7974" name="DC.Identifier"/>
<meta content="Recent RFCs have discussed issues with host identification in IP
address-sharing systems, such as address/prefix-sharing devices and
application-layer proxies. Potential solutions for revealing a host
identifier in shared address deployments have also been discussed.
This memo describes the design, deployment, and privacy considerations
for one such solution in operational use on the Internet today that
uses a TCP option to transmit a host identifier." name="DC.Description.Abstract"/>
<meta content="Boucadair, Mohamed" name="DC.Creator"/>
<meta content="Wing, Dan" name="DC.Creator"/>
<meta content="Williams, Brandon" name="DC.Creator"/>
<meta content="October, 2016" name="DC.Date.Issued"/>
<meta content="An Experimental TCP Option for Host Identification" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 7974 - An Experimental TCP Option for Host Identification</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgyellow" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc7974.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc7974" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-williams-exp-tcp-host-id-opt" title="draft-williams-exp-tcp-host-id-opt">draft-williams-...</a>] [<a href="https://datatracker.ietf.org/doc/rfc7974" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc7974" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc7974" title="Side-by-side diff">Diff2</a>]         </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                            EXPERIMENTAL</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Independent Submission                                       B. Williams
Request for Comments: 7974                                  Akamai, Inc.
Category: Informational                                     M. Boucadair
ISSN: 2070-1721                                                   Orange
                                                                 D. Wing
                                                            October 2016


           <span class="h1">An Experimental TCP Option for Host Identification</span>

Abstract

   Recent RFCs have discussed issues with host identification in IP
   address-sharing systems, such as address/prefix-sharing devices and
   application-layer proxies.  Potential solutions for revealing a host
   identifier in shared address deployments have also been discussed.
   This memo describes the design, deployment, and privacy
   considerations for one such solution in operational use on the
   Internet today that uses a TCP option to transmit a host identifier.

Independent Submissions Editor Note

   This Informational document specifies an experimental TCP HOST_ID
   option that is already fairly widely deployed.  It discusses that
   option's privacy considerations in considerable detail and highlights
   the care providers need to exercise in any actual deployment.  The
   Independent Submissions Editor has chosen to publish this document in
   the Independent Stream so that potential deployers and implementors
   can understand all its details, so as to produce implementations that
   will interwork properly with other (existing) deployments.

IESG Note

   This proposal was previously proposed for adoption by the TCPM
   working group and rejected as being an undesirable technical design
   for both transport and privacy reasons.  This document specifies a
   new TCP option that uses the shared experimental options format.  The
   use of experimental TCP options is specified in [<a href="rfc6994.html" title='"Shared Use of Experimental TCP Options"'>RFC6994</a>] for TCP
   options "that are not yet eligible for assigned codepoints".  As this
   proposal has been rejected by the IETF community, it is not eligible
   for the registration of a TCP option codepoint.  It should be further
   noted that for experimental TCP options, it "is only appropriate to
   use these values in explicitly-configured experiments; they MUST NOT
   be shipped as defaults in implementations" [<a href="rfc4727.html" title='"Experimental Values In IPv4, IPv6, ICMPv4, ICMPv6, UDP, and TCP Headers"'>RFC4727</a>].  The IESG also
   carried out a review as described in [<a href="rfc5742.html" title='"IESG Procedures for Handling of Independent and IRTF Stream Submissions"'>RFC5742</a>] and concluded that
   this proposal violates IETF principles expressed in [<a href="rfc7258.html" title='"Pervasive Monitoring Is an Attack"'>RFC7258</a>] about
   pervasive monitoring as an attack and should therefore not be
   published without IETF review and IESG approval.  (The process



<span class="grey">Williams, et al.              Informational                     [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc7974.html">RFC 7974</a>             Experimental TCP HOST_ID Option        October 2016</span>


   described in [<a href="rfc5742.html" title='"IESG Procedures for Handling of Independent and IRTF Stream Submissions"'>RFC5742</a>] nonetheless allows the Independent Submissions
   Editor to publish, as has been chosen in this case.)  Deployments of
   this proprietary TCP option may be widely viewed as undermining
   privacy and are likely to encounter issues with reliability of
   transport.

Status of This Memo

   This document is not an Internet Standards Track specification; it is
   published for informational purposes.

   This is a contribution to the RFC Series, independently of any other
   RFC stream.  The RFC Editor has chosen to publish this document at
   its discretion and makes no statement about its value for
   implementation or deployment.  Documents approved for publication by
   the RFC Editor are not a candidate for any level of Internet
   Standard; see <a href="rfc7841.html#section-2">SectionÂ 2 of RFC 7841</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc7974">http://www.rfc-editor.org/info/rfc7974</a>.

Copyright Notice

   Copyright (c) 2016 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.


















<span class="grey">Williams, et al.              Informational                     [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc7974.html">RFC 7974</a>             Experimental TCP HOST_ID Option        October 2016</span>


Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-4">4</a>
      <a href="#section-1.1">1.1</a>. Important Use Cases ........................................<a href="#page-4">4</a>
      <a href="#section-1.2">1.2</a>. Document Goals .............................................<a href="#page-6">6</a>
   <a href="#section-2">2</a>. Terminology .....................................................<a href="#page-6">6</a>
   <a href="#section-3">3</a>. Option Format ...................................................<a href="#page-7">7</a>
   <a href="#section-4">4</a>. Option Use ......................................................<a href="#page-7">7</a>
      <a href="#section-4.1">4.1</a>. Option Values ..............................................<a href="#page-7">7</a>
      <a href="#section-4.2">4.2</a>. Sending Host Requirements ..................................<a href="#page-9">9</a>
           <a href="#section-4.2.1">4.2.1</a>. Alternative SYN Cookie Support ......................<a href="#page-9">9</a>
           <a href="#section-4.2.2">4.2.2</a>. Persistent TCP Connections ..........................<a href="#page-9">9</a>
           <a href="#section-4.2.3">4.2.3</a>. Packet Fragmentation ...............................<a href="#page-10">10</a>
      <a href="#section-4.3">4.3</a>. Multiple In-Path HOST_ID Senders ..........................<a href="#page-10">10</a>
   <a href="#section-5">5</a>. Option Interpretation ..........................................<a href="#page-11">11</a>
   <a href="#section-6">6</a>. Interaction with Other TCP Options .............................<a href="#page-12">12</a>
      <a href="#section-6.1">6.1</a>. Multipath TCP (MPTCP) .....................................<a href="#page-12">12</a>
      <a href="#section-6.2">6.2</a>. Authentication Option (TCP-AO) ............................<a href="#page-12">12</a>
      <a href="#section-6.3">6.3</a>. TCP Fast Open (TFO) .......................................<a href="#page-13">13</a>
   <a href="#section-7">7</a>. Security Considerations ........................................<a href="#page-13">13</a>
   <a href="#section-8">8</a>. Privacy Considerations .........................................<a href="#page-14">14</a>
   <a href="#section-9">9</a>. Pervasive Monitoring (PM) Considerations .......................<a href="#page-15">15</a>
   <a href="#section-10">10</a>. IANA Considerations ...........................................<a href="#page-16">16</a>
   <a href="#section-11">11</a>. References ....................................................<a href="#page-16">16</a>
      <a href="#section-11.1">11.1</a>. Normative References .....................................<a href="#page-16">16</a>
      <a href="#section-11.2">11.2</a>. Informative References ...................................<a href="#page-17">17</a>
   Acknowledgements ..................................................<a href="#page-20">20</a>
   Authors' Addresses ................................................<a href="#page-20">20</a>























<span class="grey">Williams, et al.              Informational                     [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc7974.html">RFC 7974</a>             Experimental TCP HOST_ID Option        October 2016</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   A broad range of issues associated with address sharing have been
   documented in [<a href="rfc6269.html" title='"Issues with IP Address Sharing"'>RFC6269</a>] and [<a href="rfc7620.html" title='"Scenarios with Host Identification Complications"'>RFC7620</a>].  In addition, [<a href="rfc6967.html" title='"Analysis of Potential Solutions for Revealing a Host Identifier (HOST_ID) in Shared Address Deployments"'>RFC6967</a>]
   provides an analysis of various solutions to the problem of revealing
   the sending host's identifier (HOST_ID) information to the receiver,
   indicating that a solution using a TCP [<a href="rfc793.html" title='"Transmission Control Protocol"'>RFC793</a>] option for this
   purpose is among the possible approaches that could be applied with
   limited performance impact and a high success ratio.  The purpose of
   this memo is to describe a TCP HOST_ID option that is currently
   deployed on the public Internet using the TCP experimental option
   codepoint, including discussion of related design, deployment, and
   privacy considerations.

   Multiple documents have defined TCP options for the purpose of host
   identification: [<a href="#ref-REVEAL" title='"Revealing hosts sharing an IP address using TCP option"'>REVEAL</a>], [<a href="#ref-HOSTID" title='"HOST_ID TCP Options: Implementation &amp; Preliminary Test Results"'>HOSTID</a>], and [<a href="#ref-OVERLAYPATH">OVERLAYPATH</a>].  Specification
   of multiple option formats to serve the purpose of host
   identification increases the burden for potential implementers and
   presents interoperability challenges as well, so the authors of those
   documents have worked together to define a common TCP option that
   supersedes the formats from those three documents.  This memo
   describes a version of that common TCP option format that is
   currently in use on the public Internet.

   The option defined in this memo uses the TCP experimental option
   codepoint sharing mechanism defined in [<a href="rfc6994.html" title='"Shared Use of Experimental TCP Options"'>RFC6994</a>].  One of the earlier
   specifications, [<a href="#ref-OVERLAYPATH">OVERLAYPATH</a>], is associated with unauthorized use of
   a TCP option kind number, and moving to the TCP experimental option
   codepoint has allowed the authors of that document to correct their
   error.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.1.%20%20Important%20Use%20Cases"></a><a class="selflink" href="#section-1.1" name="section-1.1">1.1</a>.  Important Use Cases</span>

   The authors' implementations have primarily focused on the following
   address-sharing use cases in which currently deployed systems insert
   the HOST_ID option:

   Carrier-Grade NAT (CGN):  As defined in [<a href="rfc6888.html" title='"Common Requirements for Carrier-Grade NATs (CGNs)"'>RFC6888</a>], [<a href="rfc6333.html" title='"Dual- Stack Lite Broadband Deployments Following IPv4 Exhaustion"'>RFC6333</a>], and
      other sources, a CGN allows multiple hosts connected to the public
      Internet to share a single Internet routable IPv4 address.  One
      important characteristic of the CGN use case is that it modifies
      IP packets in-path, but does not serve as the endpoint for the
      associated TCP connections.

   Application Proxy:  As defined in [<a href="rfc1919.html" title='"Classical versus Transparent IP Proxies"'>RFC1919</a>], an application proxy
      splits a TCP connection into two segments, serving as an endpoint
      for each of the connections and relaying data flows between the
      connections.



<span class="grey">Williams, et al.              Informational                     [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc7974.html">RFC 7974</a>             Experimental TCP HOST_ID Option        October 2016</span>


   Overlay Network:  An overlay network is an Internet-based system
      providing security, optimization, or other services for data flows
      that transit the system.  A network-layer overlay will sometimes
      act much like a CGN, in that packets transit the system with NAT
      being applied at the edge of the overlay.  A transport-layer or
      application-layer overlay [<a href="rfc3135.html" title='"Performance Enhancing Proxies Intended to Mitigate Link-Related Degradations"'>RFC3135</a>] will typically act much like
      an application proxy, in that the TCP connection will be segmented
      with the overlay network serving as an endpoint for each of the
      TCP connections.

   In this set of sender use cases, the TCP option is applied to an
   individual TCP packet either at the connection endpoint (e.g., an
   application proxy or a transport-layer overlay network) or at an
   address-sharing middlebox (e.g., a CGN or a network-layer overlay
   network).  See <a href="#section-4">Section 4</a> for additional details about the types of
   devices that add the option to a TCP packet, as well as existing
   limitations on use of the option when it is inserted by an address-
   sharing middlebox, including issues related to packet fragmentation.

   The existing receiver use cases considered by this memo include the
   following:

   o  Differentiating between attack and non-attack traffic when the
      source of the attack is sharing an address with non-attack
      traffic.

   o  Application of per-subscriber policies for resource utilization,
      etc., when multiple subscribers are sharing a common address.

   o  Improving server-side load-balancing decisions by allowing the
      load for multiple clients behind a shared address to be assigned
      to different servers, even when session affinity is required at
      the application layer.

   In all of the above cases, differentiation between address-sharing
   clients is performed by a network function that does not process the
   application-layer protocol (e.g., HTTP) or the security protocol
   (e.g., TLS), because the action needs to be performed prior to
   decryption or parsing the application layer.  Due to this, a solution
   implemented within the application layer or security protocol was
   considered unable to fully meet the receiver-side requirements.  At
   the same time, as noted in [<a href="rfc6967.html" title='"Analysis of Potential Solutions for Revealing a Host Identifier (HOST_ID) in Shared Address Deployments"'>RFC6967</a>], use of an IP option for this
   purpose has a low success rate.  For these reasons, using a TCP
   option to deliver the host identifier was deemed by the authors to be
   an effective way to satisfy these specific use cases.  See <a href="#section-5">Section 5</a>
   for details about receiver-side interpretation of the option.





<span class="grey">Williams, et al.              Informational                     [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc7974.html">RFC 7974</a>             Experimental TCP HOST_ID Option        October 2016</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.2.%20%20Document%20Goals"></a><a class="selflink" href="#section-1.2" name="section-1.2">1.2</a>.  Document Goals</span>

   Publication of this memo is intended to serve multiple purposes.

   First and foremost, this document intends to inform readers about a
   mechanism that is in broad use on the public Internet.  The authors
   are each affiliated with companies that have implemented, tested,
   and/or deployed systems that use the HOST_ID option on the public
   Internet.  Other systems might encounter packets that contain this
   TCP option, and this document is intended to help others understand
   the nature of the TCP option when it is encountered so they can make
   informed decisions about how to handle it.

   The testing effort documented in [<a href="#ref-HOSTID" title='"HOST_ID TCP Options: Implementation &amp; Preliminary Test Results"'>HOSTID</a>] indicated that a TCP option
   could be used for host identification purposes without significant
   disruption of TCP connectivity to legacy servers and networks that do
   not support the option.  It also showed how mechanisms available in
   existing TCP implementations could make use of such a TCP option for
   diagnostics and/or packet filtering.  The authors' use of the TCP
   option on the public Internet has confirmed that it can be used
   effectively for our use cases, but it has also uncovered some
   interoperability issues associated with the option's use on the
   public Internet, especially regarding interactions with other TCP
   options that support new transport capability being specified within
   the IETF.  <a href="#section-6">Section 6</a> discusses those interactions and limitations and
   explains how our systems handle associated issues.

   Discussions within the IETF have raised privacy concerns about the
   option's use, especially in regard to pervasive monitoring risks.
   Existing uses of the option limit the nature of the HOST_ID values
   that are used and the systems that insert them in order to mitigate
   pervasive monitoring risks.  Sections <a href="#section-8">8</a> and <a href="#section-9">9</a> discuss the authors'
   assessments of the privacy and monitoring impact of this TCP option
   in its current uses and suggest behavior for some external systems
   when the option is encountered.  Continued discussion following
   publication of this memo is expected to allow further refinement of
   requirements related to the values used to populate the option and
   how those values can be interpreted by the receiver.  There is a
   trade-off between providing the expected functionality to the
   receiver and protecting the privacy of the sender, and continued
   assessment will be necessary in order to find the right balance.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Terminology"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Terminology</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [<a href="rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].




<span class="grey">Williams, et al.              Informational                     [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc7974.html">RFC 7974</a>             Experimental TCP HOST_ID Option        October 2016</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Option%20Format"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Option Format</span>

   When used for host identification, the TCP experimental option uses
   the experiment identification mechanism described in [<a href="rfc6994.html" title='"Shared Use of Experimental TCP Options"'>RFC6994</a>] and
   has the following format and content.

    0          1          2          3
    01234567 89012345 67890123 45678901
   +--------+--------+--------+--------+
   |  Kind  | Length |       ExID      |
   +--------+--------+--------+--------+
   |  HOST_ID ...
   +--------+---

   Kind:  The option kind value is 253.

   Length:  The length of the option is variable, based on the required
      size of the host identifier (e.g., a 2-octet HOST_ID will require
      a length of 6, while a 4-octet HOST_ID will require a length of
      8).

   ExID:  The experiment ID value is 0x0348 (840).

   HOST_ID:  The host identifier is a value that can be used to
      differentiate among the various hosts sharing a common public IP
      address.  See below for further discussion of this value.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Option%20Use"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Option Use</span>

   This section describes requirements associated with the use of the
   option, including expected option values, which hosts are allowed to
   include the option, and segments that include the option.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.1.%20%20Option%20Values"></a><a class="selflink" href="#section-4.1" name="section-4.1">4.1</a>.  Option Values</span>

   The information conveyed in the HOST_ID option is intended to
   uniquely identify the sending host to the best capability of the
   machine that adds the option to the segment, while at the same time
   avoiding inclusion of information that does not assist this purpose.
   In addition, the option is not intended to be used to expose
   information about the sending host that could not be discovered by
   observing segments in transit on some portion of the Internet path
   between the sender and the receiver.  Existing use cases have
   different requirements for receiver-side functionality, so this
   document attempts to provide a high degree of flexibility for the
   machine that adds the option to TCP segments.





<span class="grey">Williams, et al.              Informational                     [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc7974.html">RFC 7974</a>             Experimental TCP HOST_ID Option        October 2016</span>


   The HOST_ID option value MUST correlate to IP addresses and/or TCP
   port numbers that were changed by the inserting host/device (i.e.,
   some of the IP address and/or port number bits are used to generate
   the HOST_ID).  Example values that satisfy this requirement include
   the following:

   Unique ID:  An inserting host/device could maintain a pool of locally
      unique ID values that are dynamically mapped to the unique source
      IP address values in use behind the host/device as a result of
      address sharing.  This ID value would be meaningful only within
      the context of a specific shared IP address due to the local
      uniqueness characteristic.  Such an ID value could be smaller than
      an IP address (e.g., 16 bits) in order to conserve TCP option
      space.  This option is preferred because it does not increase IP
      address visibility on the forward side of the address-sharing
      system, and it SHOULD be used in cases where receiver-side
      requirements can be met without direct inclusion of the original
      IP address (e.g., some load-balancing uses).

   IP Address/Subnet:  An inserting host/device could simply populate
      the option value with the IP address value in use behind the host/
      device.  In the case of IPv6 addresses, it could be difficult to
      include the full address due to TCP option space constraints, so
      the value would likely need to provide only a portion of the
      address (e.g., the first 64 bits).

   IP Address and TCP Port:  Some networks share public IP addresses
      among multiple subscribers with a portion of the TCP port number
      space being assigned to each subscriber [<a href="rfc6346.html" title='"The Address plus Port (A+P) Approach to the IPv4 Address Shortage"'>RFC6346</a>].  When such a
      system is behind an address-sharing host/device, inclusion of both
      the IP address and the TCP port number will more uniquely identify
      the sending host than just the IP address on its own.

   When multiple host identifiers are necessary (e.g., an IP address and
   a port number), the HOST_ID option is included multiple times within
   the packet, once for each identifier.  While this approach
   significantly increases option space utilization when multiple
   identifiers are included, cases where only a single identifier is
   included are expected to be more common; thus, it is beneficial to
   optimize for those cases.  Note that some middleboxes might reorder
   TCP options, so this method could be problematic if such a middlebox
   is in-path between the address-sharing system and the receiver.  This
   has not proven to be a problem for existing use cases.

   See <a href="#section-8">Section 8</a> for discussion of privacy considerations related to
   selection of HOST_ID values.





<span class="grey">Williams, et al.              Informational                     [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc7974.html">RFC 7974</a>             Experimental TCP HOST_ID Option        October 2016</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.2.%20%20Sending%20Host%20Requirements"></a><a class="selflink" href="#section-4.2" name="section-4.2">4.2</a>.  Sending Host Requirements</span>

   The HOST_ID option MUST only be added by the sending host or any
   device involved in the forwarding path that changes IP addresses and/
   or TCP port numbers (e.g., NAT44 [<a href="rfc3022.html" title='"Traditional IP Network Address Translator (Traditional NAT)"'>RFC3022</a>], L2-Aware NAT, DS-Lite
   Address Family Transition Router (AFTR) [<a href="rfc6333.html" title='"Dual- Stack Lite Broadband Deployments Following IPv4 Exhaustion"'>RFC6333</a>], IPv6-to-IPv6
   Network Prefix Translation (NPTv6) [<a href="rfc6296.html" title='"IPv6-to-IPv6 Network Prefix Translation"'>RFC6296</a>], NAT64 [<a href="rfc6146.html" title='"Stateful NAT64: Network Address and Protocol Translation from IPv6 Clients to IPv4 Servers"'>RFC6146</a>], Dual-
   Stack Extra Lite [<a href="rfc6619.html" title='"Scalable Operation of Address Translators with Per-Interface Bindings"'>RFC6619</a>], TCP Proxy, etc.).  The HOST_ID option
   MUST NOT be added or modified en route by any device that does not
   modify IP addresses and/or TCP port numbers.

   The sending host or intermediary device cannot determine whether the
   option value is used in a stateful manner by the receiver, nor can it
   determine whether SYN cookies are in use by the receiver.  For this
   reason, the option MUST be included in all segments, both SYN and
   non-SYN segments, until return segments from the receiver positively
   indicate that the TCP connection is fully established on the receiver
   (e.g., the return segment either includes or acknowledges data).

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.2.1.%20%20Alternative%20SYN%20Cookie%20Support"></a><a class="selflink" href="#section-4.2.1" name="section-4.2.1">4.2.1</a>.  Alternative SYN Cookie Support</span>

   The authors have also considered an alternative approach to SYN
   cookie support in which the receiving host (i.e., the host that
   accepts the TCP connection) echoes the option back to the sender in
   the SYN/ACK segment when a SYN cookie is being sent.  This would
   allow the host sending HOST_ID to determine whether further inclusion
   of the option is necessary.  This approach would have the benefit of
   not requiring inclusion of the option in non-SYN segments if SYN
   cookies had not been used.  Unfortunately, this approach fails if the
   responding host itself does not support the option, since an
   intermediate node would have no way to determine that SYN cookies had
   been used.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.2.2.%20%20Persistent%20TCP%20Connections"></a><a class="selflink" href="#section-4.2.2" name="section-4.2.2">4.2.2</a>.  Persistent TCP Connections</span>

   Some types of middleboxes (e.g., application proxy) open and maintain
   persistent TCP connections to regularly visited destinations in order
   to minimize the burden of connection establishment.  Such middleboxes
   might use a single persistent TCP connection for multiple different
   client hosts over the life of the persistent connection.

   This specification does not attempt to support the use of persistent
   TCP connections for multiple client hosts due to the perceived
   complexity of providing such support.  Instead, the HOST_ID option is
   only allowed to be used at connection initiation.  An inserting host/
   device that supports both the HOST_ID option and multi-client
   persistent TCP connections MUST NOT apply the HOST_ID option to TCP
   connections that could be used for multiple clients over the life of



<span class="grey">Williams, et al.              Informational                     [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc7974.html">RFC 7974</a>             Experimental TCP HOST_ID Option        October 2016</span>


   the connection.  If the HOST_ID option was sent during connection
   initiation, the inserting host/device MUST NOT reuse the connection
   for data flows originating from a client that would require a
   different HOST_ID value.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.2.3.%20%20Packet%20Fragmentation"></a><a class="selflink" href="#section-4.2.3" name="section-4.2.3">4.2.3</a>.  Packet Fragmentation</span>

   In order to avoid the overhead associated with in-path IP
   fragmentation, it is desirable for the inserting host/device to avoid
   including the HOST_ID option when IP fragmentation might be required.
   This is not a firm requirement though, because the HOST_ID option is
   only included in the first few packets of a TCP connection; thus,
   associated IP fragmentation will generally have minimal impact.  The
   option SHOULD NOT be included in packets if the resulting packet
   would require local fragmentation.

   It can be difficult to determine whether local fragmentation would be
   required.  For example, in cases where multiple interfaces with
   different MTUs are in use, a local routing decision has to be made
   before the MTU can be determined, and in some systems, this decision
   could be made after TCP option handling is complete.  Additionally,
   it could be true that inclusion of the option causes the packet to
   violate the path's MTU but the path's MTU has not been learned yet on
   the sending host/device.

   In existing deployed systems, the impact of IP fragmentation that
   results from use of the option has been minimal.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.3.%20%20Multiple%20In-Path%20HOST_ID%20Senders"></a><a class="selflink" href="#section-4.3" name="section-4.3">4.3</a>.  Multiple In-Path HOST_ID Senders</span>

   The possibility exists that there could be multiple in-path hosts/
   devices configured to insert the HOST_ID option.  For example, the
   client's TCP packets might first traverse a CGN device on their way
   to the edge of a public Internet overlay network.  In order for the
   HOST_ID value to most uniquely identify the sender, it needs to
   represent both the identity observed by the CGN device (the
   subscriber's internal IP address, e.g., Shared Address Space
   [<a href="rfc6598.html" title='"IANA-Reserved IPv4 Prefix for Shared Address Space"'>RFC6598</a>]) and the identity observed by the overlay network (the
   shared address of the CGN device).  The mechanism for handling the
   received HOST_ID value could vary depending upon the nature of the
   new HOST_ID value to be inserted, as described below.

   The problem of multiple in-path HOST_ID senders has not been observed
   in existing deployed systems.  For this reason, existing
   implementations do not consistently support this scenario.  Some
   systems do not propagate forward the received HOST_ID option value in
   any way, while other systems follow the guidance described below.




<span class="grey">Williams, et al.              Informational                    [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc7974.html">RFC 7974</a>             Experimental TCP HOST_ID Option        October 2016</span>


   An inserting host/device that uses the received packet's source IP
   address as the HOST_ID value (possibly along with the port) MUST
   propagate forward the HOST_ID value(s) from the received packet,
   since the source IP address and port only represent the previous
   in-path address-sharing device and do not represent the original
   sender.  In the CGN-plus-overlay example, this means that the overlay
   will include both the CGN's HOST_ID value(s) and a HOST_ID with the
   source IP address received by the overlay.

   An inserting host/device that sends a unique ID (as described in
   <a href="#section-4.1">Section 4.1</a>) has two options for how to handle the HOST_ID value(s)
   from the received packet:

   1.  A host/device that sends a unique ID MAY strip the received
       HOST_ID option and insert its own option, provided that it uses
       the received HOST_ID value as a differentiator for selecting the
       unique ID.  What this means in the CGN-plus-overlay example above
       is that the overlay is allowed to drop the HOST_ID value inserted
       by the CGN provided that the HOST_ID value selected by the
       overlay represents both the CGN itself and the HOST_ID value
       inserted by the CGN.

   2.  A host/device that sends a unique ID MAY instead select a unique
       ID that represents only the previous in-path address-sharing
       host/device and propagate forward the HOST_ID value inserted by
       the previous host/device.  In the CGN-plus-overlay example, this
       means that the overlay would include both the CGN's HOST_ID value
       and a HOST_ID with a unique ID of its own that was selected to
       represent the CGN's shared address.

   An inserting host/device that sends a unique ID MUST use one of the
   above two mechanisms.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Option%20Interpretation"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Option Interpretation</span>

   Due to the variable nature of the option value, it is not possible
   for the receiving machine to reliably determine the value type from
   the option itself.  For this reason, a receiving host/device SHOULD
   interpret the option value as an opaque identifier.

   This specification allows the inserting host/device to provide
   multiple HOST_ID options.  The order of appearance of TCP options
   could be modified by some middleboxes, so receivers SHOULD NOT rely
   on option order to provide additional meaning to the individual
   options.  Instead, when multiple HOST_ID options are present, their
   values SHOULD be concatenated together in the order in which they
   appear in the packet and treated as a single large identifier.




<span class="grey">Williams, et al.              Informational                    [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc7974.html">RFC 7974</a>             Experimental TCP HOST_ID Option        October 2016</span>


   For both of the receiver requirements discussed above, this
   specification uses SHOULD rather than MUST because reliable
   interpretation and ordering of options could be possible if the
   inserting host and the interpreting host are under common
   administrative control and integrity-protect communication between
   the inserting host and the interpreting host.  Mechanisms for
   signaling the value type(s) and integrity protection are not provided
   by this specification, and in their absence, the receiving host/
   device MUST interpret the option value(s) as a single opaque
   identifier.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20Interaction%20with%20Other%20TCP%20Options"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  Interaction with Other TCP Options</span>

   This section details how the HOST_ID option functions in conjunction
   with other TCP options.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.1.%20%20Multipath%20TCP%20%28MPTCP%29"></a><a class="selflink" href="#section-6.1" name="section-6.1">6.1</a>.  Multipath TCP (MPTCP)</span>

   TCP provides for a maximum of 40 octets for TCP options.  As
   discussed in <a href="#appendix-A">Appendix A</a> of MPTCP [<a href="rfc6824.html" title='"TCP Extensions for Multipath Operation with Multiple Addresses"'>RFC6824</a>], a typical SYN from
   modern, popular operating systems contains several TCP options (MSS
   (Maximum Segment Size), window scale, SACK (selective acknowledgment)
   permitted, and timestamp), which consume 19-24 octets depending on
   word alignment of the options.  The initial SYN from a multipath TCP
   client would consume an additional 16 octets.

   HOST_ID needs at least 6 octets to be useful, so 9-21 octets are
   sufficient for many scenarios that benefit from HOST_ID.  However, 4
   octets are not enough space for the HOST_ID option.  Thus, a TCP SYN
   containing all the typical TCP options (MSS, window scale, SACK
   permitted, and timestamp) and also containing multipath capable or
   multipath join as well as being word-aligned has insufficient space
   to accommodate HOST_ID.  This means something has to give.  The
   choices are either to avoid word alignment in that case (freeing 5
   octets) or avoid adding the HOST_ID option.  Each of these approaches
   is used in existing implementations and has been deemed acceptable
   for the associated use case.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.2.%20%20Authentication%20Option%20%28TCP-AO%29"></a><a class="selflink" href="#section-6.2" name="section-6.2">6.2</a>.  Authentication Option (TCP-AO)</span>

   The TCP Authentication Option (TCP-AO) [<a href="rfc5925.html" title='"The TCP Authentication Option"'>RFC5925</a>] is incompatible with
   address sharing due to the fact that it provides integrity protection
   of the source IP address.  For this reason, the only use cases where
   it makes sense to combine TCP-AO and HOST_ID are those where the TCP-
   AO-NAT extension [<a href="rfc6978.html" title='"A TCP Authentication Option Extension for NAT Traversal"'>RFC6978</a>] is in use.  Injecting a HOST_ID TCP option
   does not interfere with the use of TCP-AO-NAT because the TCP options
   are not included in the Message Authentication Code (MAC)
   calculation.



<span class="grey">Williams, et al.              Informational                    [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc7974.html">RFC 7974</a>             Experimental TCP HOST_ID Option        October 2016</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.3.%20%20TCP%20Fast%20Open%20%28TFO%29"></a><a class="selflink" href="#section-6.3" name="section-6.3">6.3</a>.  TCP Fast Open (TFO)</span>

   The TFO option [<a href="rfc7413.html" title='"TCP Fast Open"'>RFC7413</a>] uses a zero-length cookie (total option
   length is 2 bytes) to request a TFO cookie for use on future
   connections.  The server-generated TFO cookie is required to be at
   least 4 bytes long and allowed to be as long as 16 bytes (total
   option length is 6 to 18 bytes).  The cookie request form of the
   option leaves enough room available in a SYN packet with the most
   commonly used options to accommodate the HOST_ID option, but a valid
   TFO cookie length longer than 13 bytes would prevent even the minimal
   6-byte HOST_ID option from being included in the header.

   There are multiple possibilities for allowing TFO and HOST_ID to be
   supported for the same connection, including:

   o  If the TFO implementation allows the cookie size to be
      configurable, the configured cookie size can be specifically
      selected to leave enough option space available in a typical TFO
      SYN packet to allow inclusion of the HOST_ID option.

   o  If the TFO implementation provides explicit support for the
      HOST_ID option, it can be designed to use a shorter cookie length
      when the HOST_ID option is present in the TFO cookie request SYN.

   Reducing the TFO cookie size in order to include the HOST_ID option
   could have unacceptable security implications, so existing deployed
   systems that use the HOST_ID option consider TFO and HOST_ID to be
   mutually exclusive and do not support the use of both options on the
   same TCP connection.

   It should also be noted that the presence of data in a TFO SYN
   increases the likelihood that there will be no space available in the
   SYN packet to support inclusion of the HOST_ID option without IP
   fragmentation, even if there is enough room in the TCP option space.
   This is an additional reason that the existing system considers TFO
   and HOST_ID to be mutually exclusive.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20Security%20Considerations"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  Security Considerations</span>

   Security (including privacy) considerations common to all HOST_ID
   solutions are discussed in [<a href="rfc6967.html" title='"Analysis of Potential Solutions for Revealing a Host Identifier (HOST_ID) in Shared Address Deployments"'>RFC6967</a>].

   The content of the HOST_ID option SHOULD NOT be used for purposes
   that require a trust relationship between the sender and the receiver
   (e.g., billing and/or subscriber policy enforcement).  This
   requirement uses SHOULD rather than MUST because reliable
   interpretation of options could be possible if the inserting host and
   the interpreting host are under common administrative control and



<span class="grey">Williams, et al.              Informational                    [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc7974.html">RFC 7974</a>             Experimental TCP HOST_ID Option        October 2016</span>


   integrity-protect communication between the inserting host and the
   interpreting host.  Mechanisms for signaling the value type(s) and
   integrity protection are not provided by this specification, and in
   their absence, the receiving host/device MUST NOT use the HOST_ID
   value for purposes that require a trust relationship.

   Note that the above trust requirement applies equally to HOST_ID
   option values propagated forward from a previous in-path host as
   described in <a href="#section-4.3">Section 4.3</a>.  In other words, if the trust mechanism
   does not apply to all option values in the packet, then none of the
   HOST_ID values can be considered trusted, and the receiving host/
   device MUST NOT use any of the HOST_ID values for purposes that
   require a trust relationship.  An inserting host/device that has such
   a trust relationship MUST NOT propagate forward an untrusted HOST_ID
   in such a way as to allow it to be considered trusted.

   When the receiving network uses the values provided by the option in
   a way that does not require trust (e.g., maintaining session affinity
   in a load-balancing system), then use of a mechanism to enforce the
   trust relationship is OPTIONAL.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20Privacy%20Considerations"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  Privacy Considerations</span>

   Sending a TCP SYN across the public Internet necessarily discloses
   the public IP address of the sending host.  When an intermediate
   address-sharing device is deployed on the public Internet, anonymity
   of the hosts using the device will be increased, with hosts
   represented by multiple source IP addresses on the ingress side of
   the device using a single source IP address on the egress side.  The
   HOST_ID TCP option removes that increased anonymity, taking
   information that was already visible in TCP packets on the public
   Internet on the ingress side of the address-sharing device and making
   it available on the egress side of the device as well.  In some
   cases, an explicit purpose of the address-sharing device is
   anonymity, in which case use of the HOST_ID TCP option would be
   incompatible with the purpose of the device.

   A NAT device used to provide interoperability between a local area
   network (LAN) using private [<a href="rfc1918.html" title='"Address Allocation for Private Internets"'>RFC1918</a>] IP addresses and the public
   Internet is sometimes specifically intended to provide anonymity for
   the LAN clients as described in the above paragraph.  For this
   reason, address-sharing devices at the border between a private LAN
   and the public Internet MUST NOT insert the HOST_ID option.

   The HOST_ID option MUST NOT be used to provide client geographic or
   network location information that was not publicly visible in IP
   packets for the TCP flows processed by the inserting host.  For




<span class="grey">Williams, et al.              Informational                    [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc7974.html">RFC 7974</a>             Experimental TCP HOST_ID Option        October 2016</span>


   example, the client's IP address MAY be used as the HOST_ID option
   value, but any geographic or network location information derived
   from the client's IP address MUST NOT be used as the HOST_ID value.

   The HOST_ID option MAY provide differentiating information that is
   locally unique such that individual TCP flows processed by the
   inserting host can be reliably identified.  The HOST_ID option MUST
   NOT provide client identification information that was not publicly
   visible in IP packets for the TCP flows processed by the inserting
   host, such as subscriber information linked to the IP address.

   The HOST_ID value MUST be changed whenever the subscriber IP address
   changes.  This requirement ensures that the HOST_ID option does not
   introduce a new globally unique identifier that persists across
   subscriber IP address changes.

   The HOST_ID option MUST be stripped from IP packets traversing
   middleboxes that provide network-based anonymity services.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/9.%20%20Pervasive%20Monitoring%20%28PM%29%20Considerations"></a><a class="selflink" href="#section-9" name="section-9">9</a>.  Pervasive Monitoring (PM) Considerations</span>

   [<a id="ref-RFC7258" name="ref-RFC7258">RFC7258</a>] provides the following guidance: "Those developing IETF
   specifications need to be able to describe how they have considered
   PM, and, if the attack is relevant to the work to be published, be
   able to justify related design decisions."  Legitimate concerns about
   host identification have been raised within the IETF.  The authors of
   this memo have attempted to address those concerns by providing
   details about the nature of the HOST_ID values and the types of
   middleboxes that should and should not include the HOST_ID option in
   TCP headers, which describes limitations already imposed by existing
   deployed systems.  This section is intended to highlight some
   particularly important aspects of this design and the related
   guidance/limitations that are relevant to the pervasive monitoring
   discussion.

   When a generated identifier is used, this document prohibits the
   address-sharing device from using globally unique or permanent
   identifiers.  Only locally unique identifiers are allowed.  As with
   persistent IP addresses, persistent HOST_ID values could facilitate
   user tracking and are therefore prohibited.  The specific
   requirements for permissible HOST_ID values are discussed in Sections
   8 and 4.1.

   This specification does not target exposing a host beyond what the
   original packet, issued from that host, would have already exposed on
   the public Internet without introduction of the option.  The option
   is intended only to carry forward information that was conveyed to
   the address-sharing device in the original packet, and HOST_ID option



<span class="grey">Williams, et al.              Informational                    [Page 15]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc7974.html">RFC 7974</a>             Experimental TCP HOST_ID Option        October 2016</span>


   values that do not match this description are prohibited by
   requirements discussed in <a href="#section-8">Section 8</a>.  This design does not allow the
   HOST_ID option to carry personally identifiable information,
   geographic location identifiers, or any other information that is not
   available in the wire format of the associated TCP/IP headers.

   This document's guidance on option values is followed in the existing
   deployed system.  Thus, the volatility of the information conveyed in
   a HOST_ID option is similar to that of the public, subscriber IP
   address.  A distinct HOST_ID is used by the address-sharing function
   when the host reboots or gets a new public IP address from the
   subscriber network.

   The described TCP option allows network identification to a similar
   level as the first 64 bits of an IPv6 address.  That is, the server
   can use the bits of the TCP option to help identify a host behind an
   address-sharing device, in much the same way the server would use the
   host's IPv6 network address if the client and server were using IPv6
   end to end.

   Some address-sharing middleboxes on the public Internet have the
   express intention of providing originator anonymity.  Publication of
   this document can help such middleboxes recognize the associated risk
   and take action to mitigate it (e.g., by stripping or modifying the
   option value).

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/10.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-10" name="section-10">10</a>.  IANA Considerations</span>

   This document specifies a new TCP option (HOST_ID) that uses the
   shared experimental options format [<a href="rfc6994.html" title='"Shared Use of Experimental TCP Options"'>RFC6994</a>], with ExID in network-
   standard byte order.  IANA has registered HOST_ID (0x0348) in the
   "TCP Experimental Option Experiment Identifiers (TCP ExIDs)"
   registry.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/11.%20%20References"></a><a class="selflink" href="#section-11" name="section-11">11</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/11.1.%20%20Normative%20References"></a><a class="selflink" href="#section-11.1" name="section-11.1">11.1</a>.  Normative References</span>

   [<a id="ref-RFC793" name="ref-RFC793">RFC793</a>]   Postel, J., "Transmission Control Protocol", STD 7,
              <a href="rfc793.html">RFC 793</a>, DOI 10.17487/RFC0793, September 1981,
              &lt;<a href="http://www.rfc-editor.org/info/rfc793">http://www.rfc-editor.org/info/rfc793</a>&gt;.

   [<a id="ref-RFC2119" name="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>,
              DOI 10.17487/RFC2119, March 1997,
              &lt;<a href="http://www.rfc-editor.org/info/rfc2119">http://www.rfc-editor.org/info/rfc2119</a>&gt;.





<span class="grey">Williams, et al.              Informational                    [Page 16]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc7974.html">RFC 7974</a>             Experimental TCP HOST_ID Option        October 2016</span>


   [<a id="ref-RFC4727" name="ref-RFC4727">RFC4727</a>]  Fenner, B., "Experimental Values In IPv4, IPv6, ICMPv4,
              ICMPv6, UDP, and TCP Headers", <a href="rfc4727.html">RFC 4727</a>,
              DOI 10.17487/RFC4727, November 2006,
              &lt;<a href="http://www.rfc-editor.org/info/rfc4727">http://www.rfc-editor.org/info/rfc4727</a>&gt;.

   [<a id="ref-RFC5742" name="ref-RFC5742">RFC5742</a>]  Alvestrand, H. and R. Housley, "IESG Procedures for
              Handling of Independent and IRTF Stream Submissions",
              <a href="https://tools.ietf.org/html/bcp92">BCP 92</a>, <a href="rfc5742.html">RFC 5742</a>, DOI 10.17487/RFC5742, December 2009,
              &lt;<a href="http://www.rfc-editor.org/info/rfc5742">http://www.rfc-editor.org/info/rfc5742</a>&gt;.

   [<a id="ref-RFC6994" name="ref-RFC6994">RFC6994</a>]  Touch, J., "Shared Use of Experimental TCP Options",
              <a href="rfc6994.html">RFC 6994</a>, DOI 10.17487/RFC6994, August 2013,
              &lt;<a href="http://www.rfc-editor.org/info/rfc6994">http://www.rfc-editor.org/info/rfc6994</a>&gt;.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/11.2.%20%20Informative%20References"></a><a class="selflink" href="#section-11.2" name="section-11.2">11.2</a>.  Informative References</span>

   [<a id="ref-HOSTID" name="ref-HOSTID">HOSTID</a>]   Abdo, E., Boucadair, M., and J. Queiroz, "HOST_ID TCP
              Options: Implementation &amp; Preliminary Test Results", Work
              in Progress, <a href="https://tools.ietf.org/html/draft-abdo-hostid-tcpopt-implementation-03">draft-abdo-hostid-tcpopt-implementation-03</a>,
              July 2012.

   [<a id="ref-OVERLAYPATH" name="ref-OVERLAYPATH">OVERLAYPATH</a>]
              Williams, B., <a href="https://www.google.com/search?sitesearch=tools.ietf.org%2Fhtml%2F&amp;q=inurl:draft-+%22Overlay+Path+Option+for+IP+and+TCP%22" style="text-decoration: none">"Overlay Path Option for IP and TCP"</a>, Work
              in Progress, <a href="https://tools.ietf.org/html/draft-williams-overlaypath-ip-tcp-rfc-04">draft-williams-overlaypath-ip-tcp-rfc-04</a>,
              June 2013.

   [<a id="ref-REVEAL" name="ref-REVEAL">REVEAL</a>]   Yourtchenko, A. and D. Wing, "Revealing hosts sharing an
              IP address using TCP option", Work in Progress,
              <a href="https://tools.ietf.org/html/draft-wing-nat-reveal-option-03">draft-wing-nat-reveal-option-03</a>, December 2011.

   [<a id="ref-RFC1918" name="ref-RFC1918">RFC1918</a>]  Rekhter, Y., Moskowitz, B., Karrenberg, D., de Groot, G.,
              and E. Lear, "Address Allocation for Private Internets",
              <a href="https://tools.ietf.org/html/bcp5">BCP 5</a>, <a href="rfc1918.html">RFC 1918</a>, DOI 10.17487/RFC1918, February 1996,
              &lt;<a href="http://www.rfc-editor.org/info/rfc1918">http://www.rfc-editor.org/info/rfc1918</a>&gt;.

   [<a id="ref-RFC1919" name="ref-RFC1919">RFC1919</a>]  Chatel, M., "Classical versus Transparent IP Proxies",
              <a href="rfc1919.html">RFC 1919</a>, DOI 10.17487/RFC1919, March 1996,
              &lt;<a href="http://www.rfc-editor.org/info/rfc1919">http://www.rfc-editor.org/info/rfc1919</a>&gt;.

   [<a id="ref-RFC3022" name="ref-RFC3022">RFC3022</a>]  Srisuresh, P. and K. Egevang, "Traditional IP Network
              Address Translator (Traditional NAT)", <a href="rfc3022.html">RFC 3022</a>,
              DOI 10.17487/RFC3022, January 2001,
              &lt;<a href="http://www.rfc-editor.org/info/rfc3022">http://www.rfc-editor.org/info/rfc3022</a>&gt;.








<span class="grey">Williams, et al.              Informational                    [Page 17]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc7974.html">RFC 7974</a>             Experimental TCP HOST_ID Option        October 2016</span>


   [<a id="ref-RFC3135" name="ref-RFC3135">RFC3135</a>]  Border, J., Kojo, M., Griner, J., Montenegro, G., and Z.
              Shelby, "Performance Enhancing Proxies Intended to
              Mitigate Link-Related Degradations", <a href="rfc3135.html">RFC 3135</a>,
              DOI 10.17487/RFC3135, June 2001,
              &lt;<a href="http://www.rfc-editor.org/info/rfc3135">http://www.rfc-editor.org/info/rfc3135</a>&gt;.

   [<a id="ref-RFC5925" name="ref-RFC5925">RFC5925</a>]  Touch, J., Mankin, A., and R. Bonica, "The TCP
              Authentication Option", <a href="rfc5925.html">RFC 5925</a>, DOI 10.17487/RFC5925,
              June 2010, &lt;<a href="http://www.rfc-editor.org/info/rfc5925">http://www.rfc-editor.org/info/rfc5925</a>&gt;.

   [<a id="ref-RFC6146" name="ref-RFC6146">RFC6146</a>]  Bagnulo, M., Matthews, P., and I. van Beijnum, "Stateful
              NAT64: Network Address and Protocol Translation from IPv6
              Clients to IPv4 Servers", <a href="rfc6146.html">RFC 6146</a>, DOI 10.17487/RFC6146,
              April 2011, &lt;<a href="http://www.rfc-editor.org/info/rfc6146">http://www.rfc-editor.org/info/rfc6146</a>&gt;.

   [<a id="ref-RFC6269" name="ref-RFC6269">RFC6269</a>]  Ford, M., Ed., Boucadair, M., Durand, A., Levis, P., and
              P. Roberts, "Issues with IP Address Sharing", <a href="rfc6269.html">RFC 6269</a>,
              DOI 10.17487/RFC6269, June 2011,
              &lt;<a href="http://www.rfc-editor.org/info/rfc6269">http://www.rfc-editor.org/info/rfc6269</a>&gt;.

   [<a id="ref-RFC6296" name="ref-RFC6296">RFC6296</a>]  Wasserman, M. and F. Baker, "IPv6-to-IPv6 Network Prefix
              Translation", <a href="rfc6296.html">RFC 6296</a>, DOI 10.17487/RFC6296, June 2011,
              &lt;<a href="http://www.rfc-editor.org/info/rfc6296">http://www.rfc-editor.org/info/rfc6296</a>&gt;.

   [<a id="ref-RFC6333" name="ref-RFC6333">RFC6333</a>]  Durand, A., Droms, R., Woodyatt, J., and Y. Lee, "Dual-
              Stack Lite Broadband Deployments Following IPv4
              Exhaustion", <a href="rfc6333.html">RFC 6333</a>, DOI 10.17487/RFC6333, August 2011,
              &lt;<a href="http://www.rfc-editor.org/info/rfc6333">http://www.rfc-editor.org/info/rfc6333</a>&gt;.

   [<a id="ref-RFC6346" name="ref-RFC6346">RFC6346</a>]  Bush, R., Ed., "The Address plus Port (A+P) Approach to
              the IPv4 Address Shortage", <a href="rfc6346.html">RFC 6346</a>,
              DOI 10.17487/RFC6346, August 2011,
              &lt;<a href="http://www.rfc-editor.org/info/rfc6346">http://www.rfc-editor.org/info/rfc6346</a>&gt;.

   [<a id="ref-RFC6598" name="ref-RFC6598">RFC6598</a>]  Weil, J., Kuarsingh, V., Donley, C., Liljenstolpe, C., and
              M. Azinger, "IANA-Reserved IPv4 Prefix for Shared Address
              Space", <a href="https://tools.ietf.org/html/bcp153">BCP 153</a>, <a href="rfc6598.html">RFC 6598</a>, DOI 10.17487/RFC6598, April
              2012, &lt;<a href="http://www.rfc-editor.org/info/rfc6598">http://www.rfc-editor.org/info/rfc6598</a>&gt;.

   [<a id="ref-RFC6619" name="ref-RFC6619">RFC6619</a>]  Arkko, J., Eggert, L., and M. Townsley, "Scalable
              Operation of Address Translators with Per-Interface
              Bindings", <a href="rfc6619.html">RFC 6619</a>, DOI 10.17487/RFC6619, June 2012,
              &lt;<a href="http://www.rfc-editor.org/info/rfc6619">http://www.rfc-editor.org/info/rfc6619</a>&gt;.

   [<a id="ref-RFC6824" name="ref-RFC6824">RFC6824</a>]  Ford, A., Raiciu, C., Handley, M., and O. Bonaventure,
              "TCP Extensions for Multipath Operation with Multiple
              Addresses", <a href="rfc6824.html">RFC 6824</a>, DOI 10.17487/RFC6824, January 2013,
              &lt;<a href="http://www.rfc-editor.org/info/rfc6824">http://www.rfc-editor.org/info/rfc6824</a>&gt;.



<span class="grey">Williams, et al.              Informational                    [Page 18]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-19" id="page-19" name="page-19"> </a>
<span class="grey"><a href="rfc7974.html">RFC 7974</a>             Experimental TCP HOST_ID Option        October 2016</span>


   [<a id="ref-RFC6888" name="ref-RFC6888">RFC6888</a>]  Perreault, S., Ed., Yamagata, I., Miyakawa, S., Nakagawa,
              A., and H. Ashida, "Common Requirements for Carrier-Grade
              NATs (CGNs)", <a href="https://tools.ietf.org/html/bcp127">BCP 127</a>, <a href="rfc6888.html">RFC 6888</a>, DOI 10.17487/RFC6888,
              April 2013, &lt;<a href="http://www.rfc-editor.org/info/rfc6888">http://www.rfc-editor.org/info/rfc6888</a>&gt;.

   [<a id="ref-RFC6967" name="ref-RFC6967">RFC6967</a>]  Boucadair, M., Touch, J., Levis, P., and R. Penno,
              "Analysis of Potential Solutions for Revealing a Host
              Identifier (HOST_ID) in Shared Address Deployments",
              <a href="rfc6967.html">RFC 6967</a>, DOI 10.17487/RFC6967, June 2013,
              &lt;<a href="http://www.rfc-editor.org/info/rfc6967">http://www.rfc-editor.org/info/rfc6967</a>&gt;.

   [<a id="ref-RFC6978" name="ref-RFC6978">RFC6978</a>]  Touch, J., "A TCP Authentication Option Extension for NAT
              Traversal", <a href="rfc6978.html">RFC 6978</a>, DOI 10.17487/RFC6978, July 2013,
              &lt;<a href="http://www.rfc-editor.org/info/rfc6978">http://www.rfc-editor.org/info/rfc6978</a>&gt;.

   [<a id="ref-RFC7258" name="ref-RFC7258">RFC7258</a>]  Farrell, S. and H. Tschofenig, "Pervasive Monitoring Is an
              Attack", <a href="https://tools.ietf.org/html/bcp188">BCP 188</a>, <a href="rfc7258.html">RFC 7258</a>, DOI 10.17487/RFC7258, May
              2014, &lt;<a href="http://www.rfc-editor.org/info/rfc7258">http://www.rfc-editor.org/info/rfc7258</a>&gt;.

   [<a id="ref-RFC7413" name="ref-RFC7413">RFC7413</a>]  Cheng, Y., Chu, J., Radhakrishnan, S., and A. Jain, "TCP
              Fast Open", <a href="rfc7413.html">RFC 7413</a>, DOI 10.17487/RFC7413, December 2014,
              &lt;<a href="http://www.rfc-editor.org/info/rfc7413">http://www.rfc-editor.org/info/rfc7413</a>&gt;.

   [<a id="ref-RFC7620" name="ref-RFC7620">RFC7620</a>]  Boucadair, M., Ed., Chatras, B., Reddy, T., Williams, B.,
              and B. Sarikaya, "Scenarios with Host Identification
              Complications", <a href="rfc7620.html">RFC 7620</a>, DOI 10.17487/RFC7620, August
              2015, &lt;<a href="http://www.rfc-editor.org/info/rfc7620">http://www.rfc-editor.org/info/rfc7620</a>&gt;.
























<span class="grey">Williams, et al.              Informational                    [Page 19]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-20" id="page-20" name="page-20"> </a>
<span class="grey"><a href="rfc7974.html">RFC 7974</a>             Experimental TCP HOST_ID Option        October 2016</span>


Acknowledgements

   Many thanks to W. Eddy, Y. Nishida, T. Reddy, M. Scharf, J. Touch,
   A. Zimmermann, and A. Falk for their comments.

Authors' Addresses

   Brandon Williams
   Akamai, Inc.
   8 Cambridge Center
   Cambridge, MA  02142
   United States of America

   Email: brandon.williams@akamai.com


   Mohamed Boucadair
   Orange

   Email: mohamed.boucadair@orange.com


   Dan Wing

   Email: dwing-ietf@fuggles.com


























Williams, et al.              Informational                    [Page 20]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc7974 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:18 GMT --></html>