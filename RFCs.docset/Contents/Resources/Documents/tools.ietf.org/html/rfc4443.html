<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc4443 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:41 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="rfc2463" name="DC.Relation.Replaces"/>
<meta content="urn:ietf:rfc:4443" name="DC.Identifier"/>
<meta content="March, 2006" name="DC.Date.Issued"/>
<meta content="Conta, Alex" name="DC.Creator"/>
<meta content="Gupta, Mukesh" name="DC.Creator"/>
<meta content="This document describes the format of a set of control messages used
in ICMPv6 (Internet Control Message Protocol). ICMPv6 is the Internet
Control Message Protocol for Internet Protocol version 6 (IPv6).
[STANDARDS-TRACK]" name="DC.Description.Abstract"/>
<meta content="Internet Control Message Protocol (ICMPv6) for the Internet Protocol Version 6 (IPv6) Specification" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 4443 - Internet Control Message Protocol (ICMPv6) for the Internet Protocol Version 6 (IPv6) Specification</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bggreen" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc4443.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc4443" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-ipngwg-icmp-v3" title="draft-ietf-ipngwg-icmp-v3">draft-ietf-ipng...</a>] [<a href="https://datatracker.ietf.org/doc/rfc4443" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc4443" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc4443" title="Side-by-side diff">Diff2</a>] [<a href="https://www.rfc-editor.org/errata_search.php?rfc=4443">Errata</a>]</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">Updated by: <a href="rfc4884.html">4884</a>                                       INTERNET STANDARD</span><br/>
<span class="pre noprint docinfo">                                                            <span style="color: #C00;">Errata Exist</span></span><br/>
<pre>Network Working Group                                           A. Conta
Request for Comments: 4443                                    Transwitch
Obsoletes: <a href="rfc2463.html">2463</a>                                               S. Deering
Updates: <a href="rfc2780.html">2780</a>                                              Cisco Systems
Category: Standards Track                                  M. Gupta, Ed.
                                                         Tropos Networks
                                                              March 2006


               <span class="h1">Internet Control Message Protocol (ICMPv6)</span>
        <span class="h1">for the Internet Protocol Version 6 (IPv6) Specification</span>

Status of This Memo

   This document specifies an Internet standards track protocol for the
   Internet community, and requests discussion and suggestions for
   improvements.  Please refer to the current edition of the "Internet
   Official Protocol Standards" (STD 1) for the standardization state
   and status of this protocol.  Distribution of this memo is unlimited.

Copyright Notice

   Copyright (C) The Internet Society (2006).

Abstract

   This document describes the format of a set of control messages used
   in ICMPv6 (Internet Control Message Protocol).  ICMPv6 is the
   Internet Control Message Protocol for Internet Protocol version 6
   (IPv6).





















<span class="grey">Conta, et al.               Standards Track                     [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc4443.html">RFC 4443</a>                 ICMPv6 (ICMP for IPv6)               March 2006</span>


Table of Contents


   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-2">2</a>
   <a href="#section-2">2</a>. ICMPv6 (ICMP for IPv6) ..........................................<a href="#page-3">3</a>
      <a href="#section-2.1">2.1</a>. Message General Format .....................................<a href="#page-3">3</a>
      <a href="#section-2.2">2.2</a>. Message Source Address Determination .......................<a href="#page-5">5</a>
      <a href="#section-2.3">2.3</a>. Message Checksum Calculation ...............................<a href="#page-5">5</a>
      <a href="#section-2.4">2.4</a>. Message Processing Rules ...................................<a href="#page-5">5</a>
   <a href="#section-3">3</a>. ICMPv6 Error Messages ...........................................<a href="#page-8">8</a>
      <a href="#section-3.1">3.1</a>. Destination Unreachable Message ............................<a href="#page-8">8</a>
      <a href="#section-3.2">3.2</a>. Packet Too Big Message ....................................<a href="#page-10">10</a>
      <a href="#section-3.3">3.3</a>. Time Exceeded Message .....................................<a href="#page-11">11</a>
      <a href="#section-3.4">3.4</a>. Parameter Problem Message .................................<a href="#page-12">12</a>
   <a href="#section-4">4</a>. ICMPv6 Informational Messages ..................................<a href="#page-13">13</a>
      <a href="#section-4.1">4.1</a>. Echo Request Message ......................................<a href="#page-13">13</a>
      <a href="#section-4.2">4.2</a>. Echo Reply Message ........................................<a href="#page-14">14</a>
   <a href="#section-5">5</a>. Security Considerations ........................................<a href="#page-15">15</a>
      <a href="#section-5.1">5.1</a>. Authentication and Confidentiality of ICMP Messages .......<a href="#page-15">15</a>
      <a href="#section-5.2">5.2</a>. ICMP Attacks ..............................................<a href="#page-16">16</a>
   <a href="#section-6">6</a>. IANA Considerations ............................................<a href="#page-17">17</a>
      <a href="#section-6.1">6.1</a>. Procedure for New ICMPV6 Type and Code Value Assignments ..17
      <a href="#section-6.2">6.2</a>. Assignments for This Document .............................<a href="#page-18">18</a>
   <a href="#section-7">7</a>. References .....................................................<a href="#page-19">19</a>
      <a href="#section-7.1">7.1</a>. Normative References ......................................<a href="#page-19">19</a>
      <a href="#section-7.2">7.2</a>. Informative References ....................................<a href="#page-19">19</a>
   <a href="#section-8">8</a>. Acknowledgements ...............................................<a href="#page-20">20</a>
   <a href="#appendix-A">Appendix A</a> - Changes since <a href="rfc2463.html">RFC 2463</a>................................<a href="#page-21">21</a>

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>. Introduction</span>

   The Internet Protocol version 6 (IPv6) uses the Internet Control
   Message Protocol (ICMP) as defined for IPv4 [<a href="rfc792.html" title='"Internet Control Message Protocol"'>RFC-792</a>], with a number
   of changes.  The resulting protocol is called ICMPv6 and has an IPv6
   Next Header value of 58.

   This document describes the format of a set of control messages used
   in ICMPv6.  It does not describe the procedures for using these
   messages to achieve functions like Path MTU discovery; these
   procedures are described in other documents (e.g., [<a href="#ref-PMTU" title='"Path MTU Discovery for IP version 6"'>PMTU</a>]).  Other
   documents may also introduce additional ICMPv6 message types, such as
   Neighbor Discovery messages [<a href="#ref-IPv6-DISC" title='"Neighbor Discovery for IP Version 6 (IPv6)"'>IPv6-DISC</a>], subject to the general rules
   for ICMPv6 messages given in <a href="#section-2">Section 2</a> of this document.

   Terminology defined in the IPv6 specification [<a href="#ref-IPv6" title='"Internet Protocol, Version 6 (IPv6) Specification"'>IPv6</a>] and the IPv6
   Routing and Addressing specification [<a href="#ref-IPv6-ADDR" title='"Intpernet Protocol Version 6 (IPv6) Addressing Architecture"'>IPv6-ADDR</a>] applies to this
   document as well.




<span class="grey">Conta, et al.               Standards Track                     [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc4443.html">RFC 4443</a>                 ICMPv6 (ICMP for IPv6)               March 2006</span>


   This document obsoletes <a href="rfc2463.html">RFC 2463</a> [<a href="rfc2463.html" title='"Internet Control Message Protocol (ICMPv6) for the Internet Protocol Version 6 (IPv6) Specification"'>RFC-2463</a>] and updates <a href="rfc2780.html">RFC 2780</a>
   [<a href="rfc2780.html" title='"IANA Allocation Guidelines For Values In the Internet Protocol and Related Headers"'>RFC-2780</a>].

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [<a href="rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC-2119</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20ICMPv6%20%28ICMP%20for%20IPv6%29"></a><a class="selflink" href="#section-2" name="section-2">2</a>. ICMPv6 (ICMP for IPv6)</span>

   ICMPv6 is used by IPv6 nodes to report errors encountered in
   processing packets, and to perform other internet-layer functions,
   such as diagnostics (ICMPv6 "ping").  ICMPv6 is an integral part of
   IPv6, and the base protocol (all the messages and behavior required
   by this specification) MUST be fully implemented by every IPv6 node.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.1.%20%20Message%20General%20Format"></a><a class="selflink" href="#section-2.1" name="section-2.1">2.1</a>.  Message General Format</span>

   Every ICMPv6 message is preceded by an IPv6 header and zero or more
   IPv6 extension headers.  The ICMPv6 header is identified by a Next
   Header value of 58 in the immediately preceding header.  (This is
   different from the value used to identify ICMP for IPv4.)

   The ICMPv6 messages have the following general format:

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |     Type      |     Code      |          Checksum             |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                                                               |
      +                         Message Body                          +
      |                                                               |

   The type field indicates the type of the message.  Its value
   determines the format of the remaining data.

   The code field depends on the message type.  It is used to create an
   additional level of message granularity.

   The checksum field is used to detect data corruption in the ICMPv6
   message and parts of the IPv6 header.

   ICMPv6 messages are grouped into two classes: error messages and
   informational messages.  Error messages are identified as such by a
   zero in the high-order bit of their message Type field values.  Thus,
   error messages have message types from 0 to 127; informational
   messages have message types from 128 to 255.




<span class="grey">Conta, et al.               Standards Track                     [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc4443.html">RFC 4443</a>                 ICMPv6 (ICMP for IPv6)               March 2006</span>


   This document defines the message formats for the following ICMPv6
   messages:

      ICMPv6 error messages:

          1    Destination Unreachable      (see <a href="#section-3.1">Section 3.1</a>)
          2    Packet Too Big               (see <a href="#section-3.2">Section 3.2</a>)
          3    Time Exceeded                (see <a href="#section-3.3">Section 3.3</a>)
          4    Parameter Problem            (see <a href="#section-3.4">Section 3.4</a>)

          100  Private experimentation
          101  Private experimentation

          127  Reserved for expansion of ICMPv6 error messages

      ICMPv6 informational messages:

          128  Echo Request                 (see <a href="#section-4.1">Section 4.1</a>)
          129  Echo Reply                   (see <a href="#section-4.2">Section 4.2</a>)

          200  Private experimentation
          201  Private experimentation

          255  Reserved for expansion of ICMPv6 informational messages

   Type values 100, 101, 200, and 201 are reserved for private
   experimentation.  They are not intended for general use.  It is
   expected that multiple concurrent experiments will be done with the
   same type values.  Any wide-scale and/or uncontrolled usage should
   obtain real allocations as defined in <a href="#section-6">Section 6</a>.

   Type values 127 and 255 are reserved for future expansion of the type
   value range if there is a shortage in the future.  The details of
   this are left for future work.  One possible way of doing this that
   would not cause any problems with current implementations is that if
   the type equals 127 or 255, the code field should be used for the new
   assignment.  Existing implementations would ignore the new
   assignments as specified in <a href="#section-2.4">Section 2.4</a>, (b).  The new messages using
   these expanded type values could assign fields in the message body
   for its code values.

   Sections <a href="#section-3">3</a> and <a href="#section-4">4</a> describe the message formats for the ICMPv6 error
   message types 1 through 4 and informational message types 128 and
   129.







<span class="grey">Conta, et al.               Standards Track                     [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc4443.html">RFC 4443</a>                 ICMPv6 (ICMP for IPv6)               March 2006</span>


   Inclusion of, at least, the start of the invoking packet is intended
   to allow the originator of a packet that has resulted in an ICMPv6
   error message to identify the upper-layer protocol and process that
   sent the packet.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.2.%20%20Message%20Source%20Address%20Determination"></a><a class="selflink" href="#section-2.2" name="section-2.2">2.2</a>.  Message Source Address Determination</span>

   A node that originates an ICMPv6 message has to determine both the
   Source and Destination IPv6 Addresses in the IPv6 header before
   calculating the checksum.  If the node has more than one unicast
   address, it MUST choose the Source Address of the message as follows:

   (a) If the message is a response to a message sent to one of the
       node's unicast addresses, the Source Address of the reply MUST be
       that same address.

   (b) If the message is a response to a message sent to any other
       address, such as

       - a multicast group address,
       - an anycast address implemented by the node, or
       - a unicast address that does not belong to the node

      the Source Address of the ICMPv6 packet MUST be a unicast address
      belonging to the node.  The address SHOULD be chosen according to
      the rules that would be used to select the source address for any
      other packet originated by the node, given the destination address
      of the packet.  However, it MAY be selected in an alternative way
      if this would lead to a more informative choice of address
      reachable from the destination of the ICMPv6 packet.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.3.%20%20Message%20Checksum%20Calculation"></a><a class="selflink" href="#section-2.3" name="section-2.3">2.3</a>.  Message Checksum Calculation</span>

   The checksum is the 16-bit one's complement of the one's complement
   sum of the entire ICMPv6 message, starting with the ICMPv6 message
   type field, and prepended with a "pseudo-header" of IPv6 header
   fields, as specified in [IPv6, <a href="#section-8.1">Section 8.1</a>].  The Next Header value
   used in the pseudo-header is 58.  (The inclusion of a pseudo-header
   in the ICMPv6 checksum is a change from IPv4; see [<a href="#ref-IPv6" title='"Internet Protocol, Version 6 (IPv6) Specification"'>IPv6</a>] for the
   rationale for this change.)

   For computing the checksum, the checksum field is first set to zero.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.4.%20%20Message%20Processing%20Rules"></a><a class="selflink" href="#section-2.4" name="section-2.4">2.4</a>.  Message Processing Rules</span>

   Implementations MUST observe the following rules when processing
   ICMPv6 messages (from [<a href="rfc1122.html" title='"Requirements for Internet Hosts - Communication Layers"'>RFC-1122</a>]):




<span class="grey">Conta, et al.               Standards Track                     [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc4443.html">RFC 4443</a>                 ICMPv6 (ICMP for IPv6)               March 2006</span>


   (a) If an ICMPv6 error message of unknown type is received at its
       destination, it MUST be passed to the upper-layer process that
       originated the packet that caused the error, where this can be
       identified (see <a href="#section-2.4">Section 2.4</a>, (d)).

   (b) If an ICMPv6 informational message of unknown type is received,
       it MUST be silently discarded.

   (c) Every ICMPv6 error message (type &lt; 128) MUST include as much of
       the IPv6 offending (invoking) packet (the packet that caused the
       error) as possible without making the error message packet exceed
       the minimum IPv6 MTU [<a href="#ref-IPv6" title='"Internet Protocol, Version 6 (IPv6) Specification"'>IPv6</a>].

   (d) In cases where the internet-layer protocol is required to pass an
       ICMPv6 error message to the upper-layer process, the upper-layer
       protocol type is extracted from the original packet (contained in
       the body of the ICMPv6 error message) and used to select the
       appropriate upper-layer process to handle the error.

       In cases where it is not possible to retrieve the upper-layer
       protocol type from the ICMPv6 message, the ICMPv6 message is
       silently dropped after any IPv6-layer processing.  One example of
       such a case is an ICMPv6 message with an unusually large amount
       of extension headers that does not have the upper-layer protocol
       type due to truncation of the original packet to meet the minimum
       IPv6 MTU [<a href="#ref-IPv6" title='"Internet Protocol, Version 6 (IPv6) Specification"'>IPv6</a>] limit.  Another example is an ICMPv6 message with
       an ESP extension header for which it is not possible to decrypt
       the original packet due to either truncation or the
       unavailability of the state necessary to decrypt the packet.

   (e) An ICMPv6 error message MUST NOT be originated as a result of
       receiving the following:

       (e.1) An ICMPv6 error message.

       (e.2) An ICMPv6 redirect message [<a href="#ref-IPv6-DISC" title='"Neighbor Discovery for IP Version 6 (IPv6)"'>IPv6-DISC</a>].

       (e.3) A packet destined to an IPv6 multicast address.  (There are
             two exceptions to this rule: (1) the Packet Too Big Message
             (<a href="#section-3.2">Section 3.2</a>) to allow Path MTU discovery to work for IPv6
             multicast, and (2) the Parameter Problem Message, Code 2
             (<a href="#section-3.4">Section 3.4</a>) reporting an unrecognized IPv6 option (see
             Section 4.2 of [<a href="#ref-IPv6" title='"Internet Protocol, Version 6 (IPv6) Specification"'>IPv6</a>]) that has the Option Type highest-
             order two bits set to 10).

       (e.4) A packet sent as a link-layer multicast (the exceptions
             from e.3 apply to this case, too).




<span class="grey">Conta, et al.               Standards Track                     [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc4443.html">RFC 4443</a>                 ICMPv6 (ICMP for IPv6)               March 2006</span>


       (e.5) A packet sent as a link-layer broadcast (the exceptions
             from e.3 apply to this case, too).

       (e.6) A packet whose source address does not uniquely identify a
             single node -- e.g., the IPv6 Unspecified Address, an IPv6
             multicast address, or an address known by the ICMP message
             originator to be an IPv6 anycast address.

   (f) Finally, in order to limit the bandwidth and forwarding costs
       incurred by originating ICMPv6 error messages, an IPv6 node MUST
       limit the rate of ICMPv6 error messages it originates.  This
       situation may occur when a source sending a stream of erroneous
       packets fails to heed the resulting ICMPv6 error messages.

       Rate-limiting of forwarded ICMP messages is out of scope of this
       specification.

       A recommended method for implementing the rate-limiting function
       is a token bucket, limiting the average rate of transmission to
       N, where N can be either packets/second or a fraction of the
       attached link's bandwidth, but allowing up to B error messages to
       be transmitted in a burst, as long as the long-term average is
       not exceeded.

       Rate-limiting mechanisms that cannot cope with bursty traffic
       (e.g., traceroute) are not recommended; for example, a simple
       timer-based implementation, allowing an error message every T
       milliseconds (even with low values for T), is not reasonable.

       The rate-limiting parameters SHOULD be configurable.  In the case
       of a token-bucket implementation, the best defaults depend on
       where the implementation is expected to be deployed (e.g., a
       high-end router vs. an embedded host).  For example, in a
       small/mid-size device, the possible defaults could be B=10,
       N=10/s.

   NOTE: THE RESTRICTIONS UNDER (e) AND (f) ABOVE TAKE PRECEDENCE OVER
   ANY REQUIREMENT ELSEWHERE IN THIS DOCUMENT FOR ORIGINATING ICMP ERROR
   MESSAGES.

   The following sections describe the message formats for the above
   ICMPv6 messages.









<span class="grey">Conta, et al.               Standards Track                     [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc4443.html">RFC 4443</a>                 ICMPv6 (ICMP for IPv6)               March 2006</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20ICMPv6%20Error%20Messages"></a><a class="selflink" href="#section-3" name="section-3">3</a>. ICMPv6 Error Messages</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.1.%20%20Destination%20Unreachable%20Message"></a><a class="selflink" href="#section-3.1" name="section-3.1">3.1</a>.  Destination Unreachable Message</span>

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |     Type      |     Code      |          Checksum             |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                             Unused                            |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                    As much of invoking packet                 |
      +                as possible without the ICMPv6 packet          +
      |                exceeding the minimum IPv6 MTU [<a href="#ref-IPv6" title='"Internet Protocol, Version 6 (IPv6) Specification"'>IPv6</a>]          |

   IPv6 Fields:

   Destination Address

                  Copied from the Source Address field of the invoking
                  packet.

   ICMPv6 Fields:

   Type           1

   Code           0 - No route to destination
                  1 - Communication with destination
                        administratively prohibited
                  2 - Beyond scope of source address
                  3 - Address unreachable
                  4 - Port unreachable
                  5 - Source address failed ingress/egress policy
                  6 - Reject route to destination

   Unused         This field is unused for all code values.
                  It must be initialized to zero by the originator
                  and ignored by the receiver.
   Description

   A Destination Unreachable message SHOULD be generated by a router, or
   by the IPv6 layer in the originating node, in response to a packet
   that cannot be delivered to its destination address for reasons other
   than congestion.  (An ICMPv6 message MUST NOT be generated if a
   packet is dropped due to congestion.)

   If the reason for the failure to deliver is lack of a matching entry
   in the forwarding node's routing table, the Code field is set to 0.



<span class="grey">Conta, et al.               Standards Track                     [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc4443.html">RFC 4443</a>                 ICMPv6 (ICMP for IPv6)               March 2006</span>


   (This error can occur only in nodes that do not hold a "default
   route" in their routing tables.)

   If the reason for the failure to deliver is administrative
   prohibition (e.g., a "firewall filter"), the Code field is set to 1.

   If the reason for the failure to deliver is that the destination is
   beyond the scope of the source address, the Code field is set to 2.
   This condition can occur only when the scope of the source address is
   smaller than the scope of the destination address (e.g., when a
   packet has a link-local source address and a global-scope destination
   address) and the packet cannot be delivered to the destination
   without leaving the scope of the source address.

   If the reason for the failure to deliver cannot be mapped to any of
   other codes, the Code field is set to 3.  Example of such cases are
   an inability to resolve the IPv6 destination address into a
   corresponding link address, or a link-specific problem of some sort.

   One specific case in which a Destination Unreachable message is sent
   with a code 3 is in response to a packet received by a router from a
   point-to-point link, destined to an address within a subnet assigned
   to that same link (other than one of the receiving router's own
   addresses).  In such a case, the packet MUST NOT be forwarded back
   onto the arrival link.

   A destination node SHOULD originate a Destination Unreachable message
   with Code 4 in response to a packet for which the transport protocol
   (e.g., UDP) has no listener, if that transport protocol has no
   alternative means to inform the sender.

   If the reason for the failure to deliver is that the packet with this
   source address is not allowed due to ingress or egress filtering
   policies, the Code field is set to 5.

   If the reason for the failure to deliver is that the route to the
   destination is a reject route, the Code field is set to 6.  This may
   occur if the router has been configured to reject all the traffic for
   a specific prefix.

   Codes 5 and 6 are more informative subsets of code 1.

   For security reasons, it is recommended that implementations SHOULD
   allow sending of ICMP destination unreachable messages to be
   disabled, preferably on a per-interface basis.






<span class="grey">Conta, et al.               Standards Track                     [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc4443.html">RFC 4443</a>                 ICMPv6 (ICMP for IPv6)               March 2006</span>


   Upper Layer Notification

   A node receiving the ICMPv6 Destination Unreachable message MUST
   notify the upper-layer process if the relevant process can be
   identified (see <a href="#section-2.4">Section 2.4</a>, (d)).

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.2.%20%20Packet%20Too%20Big%20Message"></a><a class="selflink" href="#section-3.2" name="section-3.2">3.2</a>.  Packet Too Big Message</span>

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |     Type      |     Code      |          Checksum             |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                             MTU                               |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                    As much of invoking packet                 |
      +               as possible without the ICMPv6 packet           +
      |               exceeding the minimum IPv6 MTU [<a href="#ref-IPv6" title='"Internet Protocol, Version 6 (IPv6) Specification"'>IPv6</a>]           |

   IPv6 Fields:

   Destination Address

                  Copied from the Source Address field of the invoking
                  packet.

   ICMPv6 Fields:

   Type           2

   Code           Set to 0 (zero) by the originator and ignored by the
                  receiver.

   MTU            The Maximum Transmission Unit of the next-hop link.

   Description

   A Packet Too Big MUST be sent by a router in response to a packet
   that it cannot forward because the packet is larger than the MTU of
   the outgoing link.  The information in this message is used as part
   of the Path MTU Discovery process [<a href="#ref-PMTU" title='"Path MTU Discovery for IP version 6"'>PMTU</a>].

   Originating a Packet Too Big Message makes an exception to one of the
   rules as to when to originate an ICMPv6 error message.  Unlike other
   messages, it is sent in response to a packet received with an IPv6
   multicast destination address, or with a link-layer multicast or
   link-layer broadcast address.




<span class="grey">Conta, et al.               Standards Track                    [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc4443.html">RFC 4443</a>                 ICMPv6 (ICMP for IPv6)               March 2006</span>


   Upper Layer Notification

   An incoming Packet Too Big message MUST be passed to the upper-layer
   process if the relevant process can be identified (see <a href="#section-2.4">Section 2.4</a>,
   (d)).

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.3.%20%20Time%20Exceeded%20Message"></a><a class="selflink" href="#section-3.3" name="section-3.3">3.3</a>.  Time Exceeded Message</span>

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |     Type      |     Code      |          Checksum             |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                             Unused                            |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                    As much of invoking packet                 |
      +               as possible without the ICMPv6 packet           +
      |               exceeding the minimum IPv6 MTU [<a href="#ref-IPv6" title='"Internet Protocol, Version 6 (IPv6) Specification"'>IPv6</a>]           |

   IPv6 Fields:

   Destination Address
                  Copied from the Source Address field of the invoking
                  packet.

   ICMPv6 Fields:

   Type           3

   Code           0 - Hop limit exceeded in transit
                  1 - Fragment reassembly time exceeded

   Unused         This field is unused for all code values.
                  It must be initialized to zero by the originator
                  and ignored by the receiver.

   Description

   If a router receives a packet with a Hop Limit of zero, or if a
   router decrements a packet's Hop Limit to zero, it MUST discard the
   packet and originate an ICMPv6 Time Exceeded message with Code 0 to
   the source of the packet.  This indicates either a routing loop or
   too small an initial Hop Limit value.

   An ICMPv6 Time Exceeded message with Code 1 is used to report
   fragment reassembly timeout, as specified in [IPv6, <a href="#section-4.5">Section 4.5</a>].





<span class="grey">Conta, et al.               Standards Track                    [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc4443.html">RFC 4443</a>                 ICMPv6 (ICMP for IPv6)               March 2006</span>


   Upper Layer Notification

   An incoming Time Exceeded message MUST be passed to the upper-layer
   process if the relevant process can be identified (see <a href="#section-2.4">Section 2.4</a>,
   (d)).

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.4.%20%20Parameter%20Problem%20Message"></a><a class="selflink" href="#section-3.4" name="section-3.4">3.4</a>.  Parameter Problem Message</span>

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |     Type      |     Code      |          Checksum             |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                            Pointer                            |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                    As much of invoking packet                 |
      +               as possible without the ICMPv6 packet           +
      |               exceeding the minimum IPv6 MTU [<a href="#ref-IPv6" title='"Internet Protocol, Version 6 (IPv6) Specification"'>IPv6</a>]           |

   IPv6 Fields:

   Destination Address

                  Copied from the Source Address field of the invoking
                  packet.

   ICMPv6 Fields:

   Type           4

   Code           0 - Erroneous header field encountered
                  1 - Unrecognized Next Header type encountered
                  2 - Unrecognized IPv6 option encountered

   Pointer        Identifies the octet offset within the
                  invoking packet where the error was detected.

                  The pointer will point beyond the end of the ICMPv6
                  packet if the field in error is beyond what can fit
                  in the maximum size of an ICMPv6 error message.

   Description

   If an IPv6 node processing a packet finds a problem with a field in
   the IPv6 header or extension headers such that it cannot complete
   processing the packet, it MUST discard the packet and SHOULD
   originate an ICMPv6 Parameter Problem message to the packet's source,
   indicating the type and location of the problem.



<span class="grey">Conta, et al.               Standards Track                    [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc4443.html">RFC 4443</a>                 ICMPv6 (ICMP for IPv6)               March 2006</span>


   Codes 1 and 2 are more informative subsets of Code 0.

   The pointer identifies the octet of the original packet's header
   where the error was detected.  For example, an ICMPv6 message with a
   Type field of 4, Code field of 1, and Pointer field of 40 would
   indicate that the IPv6 extension header following the IPv6 header of
   the original packet holds an unrecognized Next Header field value.

   Upper Layer Notification

   A node receiving this ICMPv6 message MUST notify the upper-layer
   process if the relevant process can be identified (see <a href="#section-2.4">Section 2.4</a>,
   (d)).

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20ICMPv6%20Informational%20Messages"></a><a class="selflink" href="#section-4" name="section-4">4</a>. ICMPv6 Informational Messages</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.1.%20%20Echo%20Request%20Message"></a><a class="selflink" href="#section-4.1" name="section-4.1">4.1</a>.  Echo Request Message</span>

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |     Type      |     Code      |          Checksum             |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |           Identifier          |        Sequence Number        |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |     Data ...
      +-+-+-+-+-

   IPv6 Fields:

   Destination Address

                  Any legal IPv6 address.

   ICMPv6 Fields:

   Type           128

   Code           0

   Identifier     An identifier to aid in matching Echo Replies
                  to this Echo Request.  May be zero.









<span class="grey">Conta, et al.               Standards Track                    [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc4443.html">RFC 4443</a>                 ICMPv6 (ICMP for IPv6)               March 2006</span>


   Sequence Number

                  A sequence number to aid in matching Echo Replies
                  to this Echo Request.  May be zero.

   Data           Zero or more octets of arbitrary data.

   Description

   Every node MUST implement an ICMPv6 Echo responder function that
   receives Echo Requests and originates corresponding Echo Replies.  A
   node SHOULD also implement an application-layer interface for
   originating Echo Requests and receiving Echo Replies, for diagnostic
   purposes.

   Upper Layer Notification

   Echo Request messages MAY be passed to processes receiving ICMP
   messages.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.2.%20%20Echo%20Reply%20Message"></a><a class="selflink" href="#section-4.2" name="section-4.2">4.2</a>.  Echo Reply Message</span>

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |     Type      |     Code      |          Checksum             |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |           Identifier          |        Sequence Number        |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |     Data ...
      +-+-+-+-+-

   IPv6 Fields:

   Destination Address

                  Copied from the Source Address field of the invoking
                  Echo Request packet.

   ICMPv6 Fields:

   Type           129

   Code           0

   Identifier     The identifier from the invoking Echo Request message.





<span class="grey">Conta, et al.               Standards Track                    [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc4443.html">RFC 4443</a>                 ICMPv6 (ICMP for IPv6)               March 2006</span>


   Sequence Number

                  The sequence number from the invoking Echo Request
                  message.

   Data           The data from the invoking Echo Request message.

   Description

   Every node MUST implement an ICMPv6 Echo responder function that
   receives Echo Requests and originates corresponding Echo Replies.  A
   node SHOULD also implement an application-layer interface for
   originating Echo Requests and receiving Echo Replies, for diagnostic
   purposes.

   The source address of an Echo Reply sent in response to a unicast
   Echo Request message MUST be the same as the destination address of
   that Echo Request message.

   An Echo Reply SHOULD be sent in response to an Echo Request message
   sent to an IPv6 multicast or anycast address.  In this case, the
   source address of the reply MUST be a unicast address belonging to
   the interface on which the Echo Request message was received.

   The data received in the ICMPv6 Echo Request message MUST be returned
   entirely and unmodified in the ICMPv6 Echo Reply message.

   Upper Layer Notification

   Echo Reply messages MUST be passed to the process that originated an
   Echo Request message.  An Echo Reply message MAY be passed to
   processes that did not originate the Echo Request message.

   Note that there is no limitation on the amount of data that can be
   put in Echo Request and Echo Reply Messages.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20Security%20Considerations"></a><a class="selflink" href="#section-5" name="section-5">5</a>. Security Considerations</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.1.%20%20Authentication%20and%20Confidentiality%20of%20ICMP%20Messages"></a><a class="selflink" href="#section-5.1" name="section-5.1">5.1</a>.  Authentication and Confidentiality of ICMP Messages</span>

   ICMP protocol packet exchanges can be authenticated using the IP
   Authentication Header [<a href="#ref-IPv6-AUTH" title='"IP Authentication Header"'>IPv6-AUTH</a>] or IP Encapsulating Security
   Payload Header [<a href="#ref-IPv6-ESP" title='"IP Encapsulating Security Payload (ESP)"'>IPv6-ESP</a>].  Confidentiality for the ICMP protocol
   packet exchanges can be achieved using the IP Encapsulating Security
   Payload Header [<a href="#ref-IPv6-ESP" title='"IP Encapsulating Security Payload (ESP)"'>IPv6-ESP</a>].

   [<a id="ref-SEC-ARCH" name="ref-SEC-ARCH">SEC-ARCH</a>] describes the IPsec handling of ICMP traffic in detail.




<span class="grey">Conta, et al.               Standards Track                    [Page 15]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc4443.html">RFC 4443</a>                 ICMPv6 (ICMP for IPv6)               March 2006</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.2.%20%20ICMP%20Attacks"></a><a class="selflink" href="#section-5.2" name="section-5.2">5.2</a>.  ICMP Attacks</span>

   ICMP messages may be subject to various attacks.  A complete
   discussion can be found in the IP Security Architecture [<a href="#ref-IPv6-SA" title='"Security Architecture for the Internet Protocol"'>IPv6-SA</a>].  A
   brief discussion of these attacks and their prevention follows:

   1. ICMP messages may be subject to actions intended to cause the
      receiver to believe the message came from a different source from
      that of the message originator.  The protection against this
      attack can be achieved by applying the IPv6 Authentication
      mechanism [<a href="#ref-IPv6-AUTH" title='"IP Authentication Header"'>IPv6-AUTH</a>] to the ICMP message.

   2. ICMP messages may be subject to actions intended to cause the
      message or the reply to it to go to a destination different from
      that of the message originator's intention.  The protection
      against this attack can be achieved by using the Authentication
      Header [<a href="#ref-IPv6-AUTH" title='"IP Authentication Header"'>IPv6-AUTH</a>] or the Encapsulating Security Payload Header
      [<a href="#ref-IPv6-ESP" title='"IP Encapsulating Security Payload (ESP)"'>IPv6-ESP</a>].  The Authentication Header provides the protection
      against change for the source and the destination address of the
      IP packet.  The Encapsulating Security Payload Header does not
      provide this protection, but the ICMP checksum calculation
      includes the source and the destination addresses, and the
      Encapsulating Security Payload Header protects the checksum.
      Therefore, the combination of ICMP checksum and the Encapsulating
      Security Payload Header provides protection against this attack.
      The protection provided by the Encapsulating Security Payload
      Header will not be as strong as the protection provided by the
      Authentication Header.

   3. ICMP messages may be subject to changes in the message fields, or
      payload.  The authentication [<a href="#ref-IPv6-AUTH" title='"IP Authentication Header"'>IPv6-AUTH</a>] or encryption [<a href="#ref-IPv6-ESP" title='"IP Encapsulating Security Payload (ESP)"'>IPv6-ESP</a>]
      of the ICMP message protects against such actions.

   4. ICMP messages may be used to attempt denial-of-service attacks by
      sending back to back erroneous IP packets.  An implementation that
      correctly followed <a href="#section-2.4">Section 2.4</a>, paragraph (f), of this
      specification, would be protected by the ICMP error rate limiting
      mechanism.

   5. The exception number 2 of rule e.3 in <a href="#section-2.4">Section 2.4</a> gives a
      malicious node the opportunity to cause a denial-of-service attack
      to a multicast source.  A malicious node can send a multicast
      packet with an unknown destination option marked as mandatory,
      with the IPv6 source address of a valid multicast source.  A large
      number of destination nodes will send an ICMP Parameter Problem
      Message to the multicast source, causing a denial-of-service
      attack.  The way multicast traffic is forwarded by the multicast
      routers requires that the malicious node be part of the correct



<span class="grey">Conta, et al.               Standards Track                    [Page 16]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc4443.html">RFC 4443</a>                 ICMPv6 (ICMP for IPv6)               March 2006</span>


      multicast path, i.e., near to the multicast source.  This attack
      can only be avoided by securing the multicast traffic.  The
      multicast source should be careful while sending multicast traffic
      with the destination options marked as mandatory, because they can
      cause a denial-of-service attack to themselves if the destination
      option is unknown to a large number of destinations.

   6. As the ICMP messages are passed to the upper-layer processes, it
      is possible to perform attacks on the upper layer protocols (e.g.,
      TCP) with ICMP [<a href="#ref-TCP-attack" title='"ICMP attacks against TCP"'>TCP-attack</a>].  It is recommended that the upper
      layers perform some form of validation of ICMP messages (using the
      information contained in the payload of the ICMP message) before
      acting upon them.  The actual validation checks are specific to
      the upper layers and are out of the scope of this specification.
      Protecting the upper layer with IPsec mitigates these attacks.

      ICMP error messages signal network error conditions that were
      encountered while processing an internet datagram.  Depending on
      the particular scenario, the error conditions being reported might
      or might not get solved in the near term.  Therefore, reaction to
      ICMP error messages may depend not only on the error type and code
      but also on other factors, such as the time at which the error
      messages are received, previous knowledge of the network error
      conditions being reported, and knowledge of the network scenario
      in which the receiving host is operating.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20IANA%20Considerations"></a><a class="selflink" href="#section-6" name="section-6">6</a>. IANA Considerations</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.1.%20%20Procedure%20for%20New%20ICMPV6%20Type%20and%20Code%20Value%20Assignments"></a><a class="selflink" href="#section-6.1" name="section-6.1">6.1</a>.  Procedure for New ICMPV6 Type and Code Value Assignments</span>

   The IPv6 ICMP header defined in this document contains the following
   fields that carry values assigned from IANA-managed name spaces: Type
   and Code.  Code field values are defined relative to a specific Type
   value.

   Values for the IPv6 ICMP Type fields are allocated using the
   following procedure:

   1. The IANA should allocate and permanently register new ICMPv6 type
      codes from IETF RFC publication.  This is for all RFC types,
      including standards track, informational, and experimental status,
      that originate from the IETF and have been approved by the IESG
      for publication.

   2. IETF working groups with working group consensus and area director
      approval can request reclaimable ICMPV6 type code assignments from
      the IANA.  The IANA will tag the values as "reclaimable in
      future".



<span class="grey">Conta, et al.               Standards Track                    [Page 17]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc4443.html">RFC 4443</a>                 ICMPv6 (ICMP for IPv6)               March 2006</span>


      The "reclaimable in the future" tag will be removed when an RFC is
      published that documents the protocol as defined in 1.  This will
      make the assignment permanent and update the reference on the IANA
      web pages.

      At the point where the ICMPv6 type values are 85% assigned, the
      IETF will review the assignments tagged "reclaimable in the
      future" and inform the IANA which ones should be reclaimed and
      reassigned.

   3. Requests for new ICMPv6 type value assignments from outside the
      IETF are only made through the publication of an IETF document,
      per 1 above.  Note also that documents published as "RFC Editor
      contributions" [<a href="rfc3978.html" title='"IETF Rights in Contributions"'>RFC-3978</a>] are not considered IETF documents.

   The assignment of new Code values for the Type values defined in this
   document require standards action or IESG approval.  The policy for
   assigning Code values for new IPv6 ICMP Types not defined in this
   document should be defined in the document defining the new Type
   values.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.2.%20%20Assignments%20for%20This%20Document"></a><a class="selflink" href="#section-6.2" name="section-6.2">6.2</a>.  Assignments for This Document</span>

   The following has updated assignments located at:

      <a href="http://www.iana.org/assignments/icmpv6-parameters">http://www.iana.org/assignments/icmpv6-parameters</a>

   The IANA has reassigned ICMPv6 type 1 "Destination Unreachable" code
   2, which was unassigned in [<a href="rfc2463.html" title='"Internet Control Message Protocol (ICMPv6) for the Internet Protocol Version 6 (IPv6) Specification"'>RFC-2463</a>], to:

         2 - Beyond scope of source address

   The IANA has assigned the following two new codes values for ICMPv6
   type 1 "Destination Unreachable":

         5 - Source address failed ingress/egress policy
         6 - Reject route to destination

   The IANA has assigned the following new type values:

         100  Private experimentation
         101  Private experimentation

         127  Reserved for expansion of ICMPv6 error messages

         200  Private experimentation
         201  Private experimentation




<span class="grey">Conta, et al.               Standards Track                    [Page 18]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-19" id="page-19" name="page-19"> </a>
<span class="grey"><a href="rfc4443.html">RFC 4443</a>                 ICMPv6 (ICMP for IPv6)               March 2006</span>


         255  Reserved for expansion of ICMPv6 informational messages

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20References"></a><a class="selflink" href="#section-7" name="section-7">7</a>. References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.1.%20%20Normative%20References"></a><a class="selflink" href="#section-7.1" name="section-7.1">7.1</a>.  Normative References</span>

   [<a id="ref-IPv6" name="ref-IPv6">IPv6</a>]       Deering, S. and R. Hinden, "Internet Protocol, Version 6
                (IPv6) Specification", <a href="rfc2460.html">RFC 2460</a>, December 1998.

   [<a id="ref-IPv6-DISC" name="ref-IPv6-DISC">IPv6-DISC</a>]  Narten, T., Nordmark, E., and W. Simpson, "Neighbor
                Discovery for IP Version 6 (IPv6)", <a href="rfc2461.html">RFC 2461</a>, December
                1998.

   [<a id="ref-RFC-792" name="ref-RFC-792">RFC-792</a>]    Postel, J., "Internet Control Message Protocol", STD 5,
                <a href="rfc792.html">RFC 792</a>, September 1981.

   [<a id="ref-RFC-2463" name="ref-RFC-2463">RFC-2463</a>]   Conta, A. and S. Deering, "Internet Control Message
                Protocol (ICMPv6) for the Internet Protocol Version 6
                (IPv6) Specification", <a href="rfc2463.html">RFC 2463</a>, December 1998.

   [<a id="ref-RFC-1122" name="ref-RFC-1122">RFC-1122</a>]   Braden, R., "Requirements for Internet Hosts -
                Communication Layers", STD 3, <a href="rfc1122.html">RFC 1122</a>, October 1989.

   [<a id="ref-RFC-2119" name="ref-RFC-2119">RFC-2119</a>]   Bradner, S., "Key words for use in RFCs to Indicate
                Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a id="ref-RFC-3978" name="ref-RFC-3978">RFC-3978</a>]   Bradner, S., "IETF Rights in Contributions", <a href="https://tools.ietf.org/html/bcp78">BCP 78</a>, <a href="rfc3978.html">RFC</a>
                <a href="rfc3978.html">3978</a>, March 2005.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/7.2.%20%20Informative%20References"></a><a class="selflink" href="#section-7.2" name="section-7.2">7.2</a>.  Informative References</span>

   [<a id="ref-RFC-2780" name="ref-RFC-2780">RFC-2780</a>]   Bradner, S. and V. Paxson, "IANA Allocation Guidelines
                For Values In the Internet Protocol and Related
                Headers", <a href="https://tools.ietf.org/html/bcp37">BCP 37</a>, <a href="rfc2780.html">RFC 2780</a>, March 2000.

   [<a id="ref-IPv6-ADDR" name="ref-IPv6-ADDR">IPv6-ADDR</a>]  Hinden, R. and S. Deering, "Intpernet Protocol Version 6
                (IPv6) Addressing Architecture", <a href="rfc3513.html">RFC 3513</a>, April 2003.

   [<a id="ref-PMTU" name="ref-PMTU">PMTU</a>]       McCann, J., Deering, S., and J. Mogul, "Path MTU
                Discovery for IP version 6", <a href="rfc1981.html">RFC 1981</a>, August 1996.

   [<a id="ref-IPv6-SA" name="ref-IPv6-SA">IPv6-SA</a>]    Kent, S. and R. Atkinson, "Security Architecture for the
                Internet Protocol", <a href="rfc2401.html">RFC 2401</a>, November 1998.

   [<a id="ref-IPv6-AUTH" name="ref-IPv6-AUTH">IPv6-AUTH</a>]  Kent, S., "IP Authentication Header", <a href="rfc4302.html">RFC 4302</a>, December
                2005.





<span class="grey">Conta, et al.               Standards Track                    [Page 19]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-20" id="page-20" name="page-20"> </a>
<span class="grey"><a href="rfc4443.html">RFC 4443</a>                 ICMPv6 (ICMP for IPv6)               March 2006</span>


   [<a id="ref-IPv6-ESP" name="ref-IPv6-ESP">IPv6-ESP</a>]   Kent, S., "IP Encapsulating Security Payload (ESP)", <a href="rfc4203.html">RFC</a>
                <a href="rfc4203.html">4203</a>, December 2005.

   [<a id="ref-SEC-ARCH" name="ref-SEC-ARCH">SEC-ARCH</a>]   Kent, S. and K. Seo, "Security Architecture for the
                Internet Protocol", <a href="rfc4301.html">RFC 4301</a>, December 2005.

   [<a id="ref-TCP-attack" name="ref-TCP-attack">TCP-attack</a>] Gont, F., <a href="https://www.google.com/search?sitesearch=tools.ietf.org%2Fhtml%2F&amp;q=inurl:draft-+%22ICMP+attacks+against+TCP%22" style="text-decoration: none">"ICMP attacks against TCP"</a>, Work in Progress.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20Acknowledgements"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  Acknowledgements</span>

   The document is derived from previous ICMP documents of the SIPP and
   IPng working group.

   The IPng working group, and particularly Robert Elz, Jim Bound, Bill
   Simpson, Thomas Narten, Charlie Lynn, Bill Fink, Scott Bradner,
   Dimitri Haskin, Bob Hinden, Jun-ichiro Itojun Hagino, Tatuya Jinmei,
   Brian Zill, Pekka Savola, Fred Templin, and Elwyn Davies (in
   chronological order) provided extensive review information and
   feedback.

   Bob Hinden was the document editor for this document.






























<span class="grey">Conta, et al.               Standards Track                    [Page 20]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-21" id="page-21" name="page-21"> </a>
<span class="grey"><a href="rfc4443.html">RFC 4443</a>                 ICMPv6 (ICMP for IPv6)               March 2006</span>


Appendix A - Changes since <a href="rfc2463.html">RFC 2463</a>

   The following changes were made from <a href="rfc2463.html">RFC 2463</a>:

   - Edited the Abstract to make it a little more elaborate.

   - Corrected typos in <a href="#section-2.4">Section 2.4</a>, where references to sub-bullet e.2
     were supposed to be references to e.3.

   - Removed the Timer-based and the Bandwidth-based methods from the
     example rate-limiting mechanism for ICMP error messages.  Added
     Token-bucket based method.

   - Added specification that all ICMP error messages shall have exactly
     32 bits of type-specific data, so that receivers can reliably find
     the embedded invoking packet even when they don't recognize the
     ICMP message Type.

   - In the description of Destination Unreachable messages, Code 3,
     added rule prohibiting forwarding of packets back onto point-to-
     point links from which they were received, if their destination
     addresses belong to the link itself ("anti-ping-ponging" rule).

   - Added description of Time Exceeded Code 1 (fragment reassembly
     timeout).

   - Added "beyond scope of source address", "source address failed
     ingress/egress policy", and "reject route to destination" messages
     to the family of "unreachable destination" type ICMP error messages
     (<a href="#section-3.1">Section 3.1</a>).

   - Reserved some ICMP type values for experimentation.

   - Added a NOTE in <a href="#section-2.4">Section 2.4</a> that specifies ICMP message processing
     rules precedence.

   - Added ICMP REDIRECT to the list in <a href="#section-2.4">Section 2.4</a>, (e) of cases in
     which ICMP error messages are not to be generated.

   - Made minor editorial changes in <a href="#section-2.3">Section 2.3</a> on checksum
     calculation, and in <a href="#section-5.2">Section 5.2</a>.

   - Clarified in <a href="#section-4.2">Section 4.2</a>, regarding the Echo Reply Message; the
     source address of an Echo Reply to an anycast Echo Request should
     be a unicast address, as in the case of multicast.






<span class="grey">Conta, et al.               Standards Track                    [Page 21]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-22" id="page-22" name="page-22"> </a>
<span class="grey"><a href="rfc4443.html">RFC 4443</a>                 ICMPv6 (ICMP for IPv6)               March 2006</span>


   - Revised the Security Considerations section.  Added the use of the
     Encapsulating Security Payload Header for authentication.  Changed
     the requirement of an option of "not allowing unauthenticated ICMP
     messages" to MAY from SHOULD.

   - Added a new attack in the list of possible ICMP attacks in <a href="#section-5.2">Section</a>
     <a href="#section-5.2">5.2</a>.

   - Separated References into Normative and Informative.

   - Added reference to <a href="rfc2780.html">RFC 2780</a> "IANA Allocation Guidelines For Values
     In the Internet Protocol and Related Headers".  Also added a note
     that this document updates <a href="rfc2780.html">RFC 2780</a>.

   - Added a procedure for new ICMPv6 Type and Code value assignments in
     the IANA Considerations section.

   - Replaced word "send" with "originate" to make it clear that ICMP
     packets being forwarded are out of scope of this specification.

   - Changed the ESP and AH references to the updated ESP and AH
     documents.

   - Added reference to the updated IPsec Security Architecture
     document.

   - Added a SHOULD requirement for allowing the sending of ICMP
     destination unreachable messages to be disabled.

   - Simplified the source address selection of the ICMPv6 packet.

   - Reorganized the General Message Format (<a href="#section-2.1">Section 2.1</a>).

   - Removed the general packet format from <a href="#section-2.1">Section 2.1</a>.  It refers to
     Sections <a href="#section-3">3</a> and <a href="#section-4">4</a> for packet formats now.

   - Added text about attacks to the transport protocols that could
     potentially be caused by ICMP.













<span class="grey">Conta, et al.               Standards Track                    [Page 22]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-23" id="page-23" name="page-23"> </a>
<span class="grey"><a href="rfc4443.html">RFC 4443</a>                 ICMPv6 (ICMP for IPv6)               March 2006</span>


Authors' Addresses

   Alex Conta
   Transwitch Corporation
   3 Enterprise Drive
   Shelton, CT 06484
   USA

   EMail: aconta@txc.com


   Stephen Deering
   Cisco Systems, Inc.
   170 West Tasman Drive
   San Jose, CA 95134-1706
   USA


   Mukesh Gupta, Ed.
   Tropos Networks
   555 Del Rey Avenue
   Sunnyvale, CA 94085

   Phone: +1 408-331-6889
   EMail: mukesh.gupta@tropos.com


























<span class="grey">Conta, et al.               Standards Track                    [Page 23]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-24" id="page-24" name="page-24"> </a>
<span class="grey"><a href="rfc4443.html">RFC 4443</a>                 ICMPv6 (ICMP for IPv6)               March 2006</span>


Full Copyright Statement

   Copyright (C) The Internet Society (2006).

   This document is subject to the rights, licenses and restrictions
   contained in <a href="https://tools.ietf.org/html/bcp78">BCP 78</a>, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY AND THE INTERNET
   ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR IMPLIED,
   INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE
   INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and <a href="https://tools.ietf.org/html/bcp79">BCP 79</a>.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   <a href="http://www.ietf.org/ipr">http://www.ietf.org/ipr</a>.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.

Acknowledgement

   Funding for the RFC Editor function is provided by the IETF
   Administrative Support Activity (IASA).







Conta, et al.               Standards Track                    [Page 24]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc4443 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:41 GMT --></html>