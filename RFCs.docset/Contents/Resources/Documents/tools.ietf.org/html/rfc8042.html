<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc8042 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:18 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="draft-zzhang-ospf-two-part-metric" name="DC.Relation.Replaces"/>
<meta content="urn:ietf:rfc:8042" name="DC.Identifier"/>
<meta content="December, 2016" name="DC.Date.Issued"/>
<meta content="Wang, Lili" name="DC.Creator"/>
<meta content="Lindem, Acee" name="DC.Creator"/>
<meta content="Zhang, Zhaohui" name="DC.Creator"/>
<meta content="This document specifies an optional OSPF protocol extension to
represent router metrics in a multi-access network in two parts: the
metric from the router to the network and the metric from the network
to the router. For such networks, the router-to-router metric for OSPF
route computation is the sum of the two parts. This document updates
RFC 2328." name="DC.Description.Abstract"/>
<meta content="OSPF Two-Part Metric" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 8042 - OSPF Two-Part Metric</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgblue" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc8042.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc8042" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-ospf-two-part-metric" title="draft-ietf-ospf-two-part-metric">draft-ietf-ospf...</a>] [<a href="https://datatracker.ietf.org/doc/rfc8042" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc8042" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc8042" title="Side-by-side diff">Diff2</a>]         </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                       PROPOSED STANDARD</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Internet Engineering Task Force (IETF)                          Z. Zhang
Request for Comments: 8042                                       L. Wang
Updates: <a href="rfc2328.html">2328</a>                                     Juniper Networks, Inc.
Category: Standards Track                                      A. Lindem
ISSN: 2070-1721                                            Cisco Systems
                                                           December 2016


                          <span class="h1">OSPF Two-Part Metric</span>

Abstract

   This document specifies an optional OSPF protocol extension to
   represent router metrics in a multi-access network in two parts: the
   metric from the router to the network and the metric from the network
   to the router.  For such networks, the router-to-router metric for
   OSPF route computation is the sum of the two parts.  This document
   updates <a href="rfc2328.html">RFC 2328</a>.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="rfc7841.html#section-2">Section 2 of RFC 7841</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc8042">http://www.rfc-editor.org/info/rfc8042</a>.

Copyright Notice

   Copyright (c) 2016 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.




<span class="grey">Zhang, et al.                Standards Track                    [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc8042.html">RFC 8042</a>                  OSPF Two-Part Metric             December 2016</span>


Table of Contents

   <a href="#section-1">1</a>.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-2">2</a>
     <a href="#section-1.1">1.1</a>.  Requirements Language . . . . . . . . . . . . . . . . . .   <a href="#page-3">3</a>
   <a href="#section-2">2</a>.  Proposed Enhancement  . . . . . . . . . . . . . . . . . . . .   <a href="#page-3">3</a>
   <a href="#section-3">3</a>.  Specifications  . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-4">4</a>
     <a href="#section-3.1">3.1</a>.  Router Interface Parameters . . . . . . . . . . . . . . .   <a href="#page-4">4</a>
     <a href="#section-3.2">3.2</a>.  Advertising Network-to-Router Metric in OSPFv2  . . . . .   <a href="#page-4">4</a>
     3.3.  Advertising Network-to-Router Traffic Engineering (TE)
           Metric  . . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-5">5</a>
     <a href="#section-3.4">3.4</a>.  Advertising Network-to-Router Metric in OSPFv3  . . . . .   <a href="#page-5">5</a>
     <a href="#section-3.5">3.5</a>.  OSPF Stub Router Behavior . . . . . . . . . . . . . . . .   <a href="#page-5">5</a>
     <a href="#section-3.6">3.6</a>.  SPF Calculation . . . . . . . . . . . . . . . . . . . . .   <a href="#page-5">5</a>
     <a href="#section-3.7">3.7</a>.  Backward Compatibility  . . . . . . . . . . . . . . . . .   <a href="#page-6">6</a>
   <a href="#section-4">4</a>.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .   <a href="#page-6">6</a>
   <a href="#section-5">5</a>.  Security Considerations . . . . . . . . . . . . . . . . . . .   <a href="#page-6">6</a>
   <a href="#section-6">6</a>.  References  . . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-7">7</a>
     <a href="#section-6.1">6.1</a>.  Normative References  . . . . . . . . . . . . . . . . . .   <a href="#page-7">7</a>
     <a href="#section-6.2">6.2</a>.  Informative References  . . . . . . . . . . . . . . . . .   <a href="#page-7">7</a>
   Acknowledgements  . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-8">8</a>
   Contributors  . . . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-8">8</a>
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-9">9</a>

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   With Open Shortest Path First (OSPF) [<a href="rfc2328.html" title='"OSPF Version 2"'>RFC2328</a>] [<a href="rfc5340.html" title='"OSPF for IPv6"'>RFC5340</a>]), a Network-
   LSA (Link State Advertisement) is advertised to list all routers on a
   broadcast network.  Additionally, each router on the broadcast
   network includes a link in its Router-LSA to describe its connection
   to the network.  The link in the Router-LSA includes a metric but the
   listed routers in the Network-LSA do not include a metric.  This is
   based on the assumption that from a particular router, all others on
   the same network can be reached with the same metric.

   With some broadcast networks, different routers can be reached with
   different metrics.  [<a href="rfc6845.html" title='"OSPF Hybrid Broadcast and Point-to-Multipoint Interface Type"'>RFC6845</a>] extends the OSPF protocol with a hybrid
   interface type for that kind of broadcast network, where no Network-
   LSA is advertised and Router-LSAs simply include point-to-point links
   to all routers on the same network with individual metrics.
   Broadcast capability is still used to optimize database
   synchronization and adjacency maintenance.

   This works well for broadcast networks where the metric between
   different pairs of routers are really independent, for example,
   Virtual Private LAN Service (VPLS) networks.

   With certain types of broadcast networks, further optimization can be
   made to reduce the size of Router-LSAs and the number of updates.



<span class="grey">Zhang, et al.                Standards Track                    [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc8042.html">RFC 8042</a>                  OSPF Two-Part Metric             December 2016</span>


   Consider a satellite radio network with fixed and mobile ground
   terminals.  All communication goes through the satellite.  When the
   mobile terminals move about, their communication capability may
   change.  When OSPF runs over the radio network, [<a href="rfc6845.html" title='"OSPF Hybrid Broadcast and Point-to-Multipoint Interface Type"'>RFC6845</a>] hybrid
   interface can be used, but with the following drawbacks.

   Consider that one terminal/router moves into an area where its
   communication capability degrades significantly.  Through the radio
   control protocol, all other routers determine that the metric to this
   particular router changed and they all need to update their Router-
   LSAs accordingly.  In addition, the router in question determines
   that its metric to reach all others also changed and it needs to
   update its Router-LSA.  Consider that there could be many terminals
   and many of them can be moving fast and frequently.  The number and
   frequency of updates of those large Router-LSAs could inhibit network
   scaling.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.1.%20%20Requirements%20Language"></a><a class="selflink" href="#section-1.1" name="section-1.1">1.1</a>.  Requirements Language</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [<a href="rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Proposed%20Enhancement"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Proposed Enhancement</span>

   Notice that in the above scenario, when one terminal's communication
   capability changes, its metric to all other terminals and the metric
   to it from all other terminals will all change in a similar fashion.
   Given this, the above problem can be easily addressed by breaking the
   metric into two parts: the metric to the satellite and the metric
   from the satellite.  The metric from terminal R1 to R2 would be the
   sum of the metric from R1 to the satellite and the metric from the
   satellite to R2.

   Instead of using the hybrid interface type described in [<a href="rfc6845.html" title='"OSPF Hybrid Broadcast and Point-to-Multipoint Interface Type"'>RFC6845</a>],
   the network is treated as a regular broadcast network.  A router on
   the network no longer lists individual metrics to each neighbor in
   its Router-LSA.  Instead, each router advertises the metric from the
   network to itself in addition to the normal metric for the network.
   With the normal Router-to-Network and additional Network-to-Router
   metrics advertised for each router, individual Router-to-Router
   metrics can be calculated.

   With the proposed enhancement, the size of the Router-LSA will be
   significantly reduced.  In addition, when a router's communication
   capability changes, only that router needs to update its Router-LSA.





<span class="grey">Zhang, et al.                Standards Track                    [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc8042.html">RFC 8042</a>                  OSPF Two-Part Metric             December 2016</span>


   Note that while the example uses the satellite as the relay point at
   the radio level (layer 2), the satellite does not participate in
   packet forwarding at layer 3.  In fact, the satellite does not need
   to run any layer-3 protocol.  Therefore, for generality, the metric
   is abstracted as to/from the "network" rather than specifically to/
   from the "satellite".

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Specifications"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Specifications</span>

   The following specifications are added to or modified from the base
   OSPF protocol.  If an area contains one or more two-part metric
   networks, then all routers in the area MUST support the extensions
   specified herein.  This is ensured by procedures described in
   <a href="#section-3.7">Section 3.7</a>.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.1.%20%20Router%20Interface%20Parameters"></a><a class="selflink" href="#section-3.1" name="section-3.1">3.1</a>.  Router Interface Parameters</span>

   The "Router interface parameters" have the following additions:

   o  Two-part metric: TRUE if the interface connects to a multi-access
      network that uses a two-part metric.  All routers connected to the
      same network SHOULD have the same configuration for their
      corresponding interfaces.

   o  Interface input cost: Link-state metric from the two-part-metric
      network to this router.  Defaults to "Interface output cost" but
      is not valid for normal networks using a single metric.  May be
      configured or dynamically adjusted to a value different from the
      "Interface output cost".

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.2.%20%20Advertising%20Network-to-Router%20Metric%20in%20OSPFv2"></a><a class="selflink" href="#section-3.2" name="section-3.2">3.2</a>.  Advertising Network-to-Router Metric in OSPFv2</span>

   For OSPFv2, the Network-to-Router metric is encoded in an OSPF
   Extended Link TLV Sub-TLV [<a href="rfc7684.html" title='"OSPFv2 Prefix/Link Attribute Advertisement"'>RFC7684</a>], defined in this document as the
   Network-to-Router Metric Sub-TLV.  The type of the sub-TLV is 4.  The
   length of the sub-TLV is 4 (for the value part only).  The value part
   of the sub-TLV is defined as follows:

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |      MT-ID    |        0      |          MT Metric            |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Multiple such sub-TLVs can exist in a single OSPF Extended Link TLV,
   one for each topology [<a href="rfc4915.html" title='"Multi-Topology (MT) Routing in OSPF"'>RFC4915</a>].  Each sub-TLV will have a unique
   Multi-Topology Identifier (MT-ID) and will adhere to the
   advertisement rules defined in <a href="rfc4915.html#section-3.4">Section 3.4 of [RFC4915]</a>.  The OSPF



<span class="grey">Zhang, et al.                Standards Track                    [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc8042.html">RFC 8042</a>                  OSPF Two-Part Metric             December 2016</span>


   Extended Link TLV identifies the transit link to the network and is
   part of an OSPFv2 Extended-Link Opaque LSA.  The sub-TLV MUST ONLY
   appear in Extended-Link TLVs for Link Type 2 (link to transit
   network) and MUST be ignored if received for other link types.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.3.%20%20Advertising%20Network-to-Router%20Traffic%20Engineering%20%28TE%29%20Metric"></a><a class="selflink" href="#section-3.3" name="section-3.3">3.3</a>.  Advertising Network-to-Router Traffic Engineering (TE) Metric</span>

   A Traffic Engineering Network-to-Router Metric Sub-TLV is defined,
   similar to the Traffic Engineering Metric Sub-TLV defined in
   <a href="rfc3630.html#section-2.5.5">Section 2.5.5 of [RFC3630]</a>.  The only difference is the TLV type,
   which is 35.  The sub-TLV MUST only appear in Type 2 Link TLVs
   (Multi-access) of Traffic Engineer LSAs (OSPF2) or Intra-Area-TE-LSAs
   (OSPFv3) [<a href="rfc5329.html" title='"Traffic Engineering Extensions to OSPF Version 3"'>RFC5329</a>], and MUST appear at most once in such a Link TLV.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.4.%20%20Advertising%20Network-to-Router%20Metric%20in%20OSPFv3"></a><a class="selflink" href="#section-3.4" name="section-3.4">3.4</a>.  Advertising Network-to-Router Metric in OSPFv3</span>

   Network-to-Router metric advertisement in OSPFv3 Extended Router-LSA
   [<a href="#ref-OSPFV3-EXTENDED-LSA">OSPFV3-EXTENDED-LSA</a>] will be described in a separate document.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.5.%20%20OSPF%20Stub%20Router%20Behavior"></a><a class="selflink" href="#section-3.5" name="section-3.5">3.5</a>.  OSPF Stub Router Behavior</span>

   When an OSPF router with interfaces to multi-access networks using
   two-part metrics is advertising itself as a stub router [<a href="rfc6987.html" title='"OSPF Stub Router Advertisement"'>RFC6987</a>],
   only the Router-to-Network metric in the stub router's OSPF Router-
   LSA links for those networks is set to the MaxLinkMetric.  This is
   fully backward compatible and will result in the same behavior as
   described in [<a href="rfc6987.html" title='"OSPF Stub Router Advertisement"'>RFC6987</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.6.%20%20SPF%20Calculation"></a><a class="selflink" href="#section-3.6" name="section-3.6">3.6</a>.  SPF Calculation</span>

   The first stage of the shortest-path tree calculation is described in
   <a href="rfc2328.html#section-16.1">Section 16.1 of [RFC2328]</a>.  With a two-part metric, when a vertex V
   corresponding to a Network-LSA has just been added to the Shortest
   Path Tree (SPT) and an adjacent vertex W (joined by a link in V's
   corresponding Network-LSA) is being added to the candidate list, the
   cost from V to W (W's network-to-router cost) is determined as
   follows:

   o  For OSPFv2, if vertex W has a corresponding Extended-Link Opaque
      LSA with an Extended Link TLV for the link from W to V, and the
      Extended Link TLV has a Network-to-Router Metric Sub-TLV for the
      corresponding topology, then the cost from V to W is the metric in
      the sub-TLV.  Otherwise, the cost is 0.

   o  OSPFv3 [<a href="rfc5340.html" title='"OSPF for IPv6"'>RFC5340</a>] Shortest Path First (SPF) changes will be
      described in a separate document.





<span class="grey">Zhang, et al.                Standards Track                    [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc8042.html">RFC 8042</a>                  OSPF Two-Part Metric             December 2016</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.7.%20%20Backward%20Compatibility"></a><a class="selflink" href="#section-3.7" name="section-3.7">3.7</a>.  Backward Compatibility</span>

   Due to the change of procedures in the SPF calculation, all routers
   in an area that includes one or more two-part metric networks must
   support the changes specified in this document.  To ensure that, if
   an area is provisioned to support two-part metric networks, all
   routers supporting this capability must advertise a Router
   Information (RI) LSA with a Router Functional Capabilities TLV
   [<a href="rfc7770.html" title='"Extensions to OSPF for Advertising Optional Router Capabilities"'>RFC7770</a>] that includes the following Router Functional Capability
   Bit:

             Bit       Capabilities

             6         Two-Part Metric support

   Upon detecting the presence of a reachable Router-LSA without a
   companion RI LSA that has the bit set, all routers MUST recalculate
   routes without considering any network-to-router costs.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  IANA Considerations</span>

   IANA has made the following assignments per this document:

   o  Two-Part Metric support (6) was added to the "OSPF Router
      Informational Capability Bits" registry.

   o  Network-to-Router Metric Sub-TLV (4) has been added to the "OSPFv2
      Extended Link TLV Sub-TLVs" registry.

   o  Network-to-Router TE Metric Sub-TLV (35) has been added to the
      "Types for sub-TLVs of TE Link TLV (Value 2)" registry.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Security%20Considerations"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Security Considerations</span>

   This document does not introduce new security risks.  Existing
   security considerations in OSPFv2 and OSPFv3 apply.















<span class="grey">Zhang, et al.                Standards Track                    [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc8042.html">RFC 8042</a>                  OSPF Two-Part Metric             December 2016</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20References"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.1.%20%20Normative%20References"></a><a class="selflink" href="#section-6.1" name="section-6.1">6.1</a>.  Normative References</span>

   [<a id="ref-RFC2119" name="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>,
              DOI 10.17487/RFC2119, March 1997,
              &lt;<a href="http://www.rfc-editor.org/info/rfc2119">http://www.rfc-editor.org/info/rfc2119</a>&gt;.

   [<a id="ref-RFC2328" name="ref-RFC2328">RFC2328</a>]  Moy, J., "OSPF Version 2", STD 54, <a href="rfc2328.html">RFC 2328</a>,
              DOI 10.17487/RFC2328, April 1998,
              &lt;<a href="http://www.rfc-editor.org/info/rfc2328">http://www.rfc-editor.org/info/rfc2328</a>&gt;.

   [<a id="ref-RFC3630" name="ref-RFC3630">RFC3630</a>]  Katz, D., Kompella, K., and D. Yeung, "Traffic Engineering
              (TE) Extensions to OSPF Version 2", <a href="rfc3630.html">RFC 3630</a>,
              DOI 10.17487/RFC3630, September 2003,
              &lt;<a href="http://www.rfc-editor.org/info/rfc3630">http://www.rfc-editor.org/info/rfc3630</a>&gt;.

   [<a id="ref-RFC4915" name="ref-RFC4915">RFC4915</a>]  Psenak, P., Mirtorabi, S., Roy, A., Nguyen, L., and P.
              Pillay-Esnault, "Multi-Topology (MT) Routing in OSPF",
              <a href="rfc4915.html">RFC 4915</a>, DOI 10.17487/RFC4915, June 2007,
              &lt;<a href="http://www.rfc-editor.org/info/rfc4915">http://www.rfc-editor.org/info/rfc4915</a>&gt;.

   [<a id="ref-RFC5329" name="ref-RFC5329">RFC5329</a>]  Ishiguro, K., Manral, V., Davey, A., and A. Lindem, Ed.,
              "Traffic Engineering Extensions to OSPF Version 3",
              <a href="rfc5329.html">RFC 5329</a>, DOI 10.17487/RFC5329, September 2008,
              &lt;<a href="http://www.rfc-editor.org/info/rfc5329">http://www.rfc-editor.org/info/rfc5329</a>&gt;.

   [<a id="ref-RFC7684" name="ref-RFC7684">RFC7684</a>]  Psenak, P., Gredler, H., Shakir, R., Henderickx, W.,
              Tantsura, J., and A. Lindem, "OSPFv2 Prefix/Link Attribute
              Advertisement", <a href="rfc7684.html">RFC 7684</a>, DOI 10.17487/RFC7684, November
              2015, &lt;<a href="http://www.rfc-editor.org/info/rfc7684">http://www.rfc-editor.org/info/rfc7684</a>&gt;.

   [<a id="ref-RFC7770" name="ref-RFC7770">RFC7770</a>]  Lindem, A., Ed., Shen, N., Vasseur, JP., Aggarwal, R., and
              S. Shaffer, "Extensions to OSPF for Advertising Optional
              Router Capabilities", <a href="rfc7770.html">RFC 7770</a>, DOI 10.17487/RFC7770,
              February 2016, &lt;<a href="http://www.rfc-editor.org/info/rfc7770">http://www.rfc-editor.org/info/rfc7770</a>&gt;.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.2.%20%20Informative%20References"></a><a class="selflink" href="#section-6.2" name="section-6.2">6.2</a>.  Informative References</span>

   [<a id="ref-OSPFV3-EXTENDED-LSA" name="ref-OSPFV3-EXTENDED-LSA">OSPFV3-EXTENDED-LSA</a>]
              Lindem, A., Mirtorabi, S., and A. Roy, "OSPFv3 LSA
              Extendibility", Work in Progress, <a href="https://tools.ietf.org/html/draft-ietf-ospf-ospfv3-lsa-extend-13.txt">draft-ietf-ospf-ospfv3-</a>
              <a href="https://tools.ietf.org/html/draft-ietf-ospf-ospfv3-lsa-extend-13.txt">lsa-extend-13.txt</a>, October 2016.

   [<a id="ref-RFC5340" name="ref-RFC5340">RFC5340</a>]  Coltun, R., Ferguson, D., Moy, J., and A. Lindem, "OSPF
              for IPv6", <a href="rfc5340.html">RFC 5340</a>, DOI 10.17487/RFC5340, July 2008,
              &lt;<a href="http://www.rfc-editor.org/info/rfc5340">http://www.rfc-editor.org/info/rfc5340</a>&gt;.



<span class="grey">Zhang, et al.                Standards Track                    [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc8042.html">RFC 8042</a>                  OSPF Two-Part Metric             December 2016</span>


   [<a id="ref-RFC6845" name="ref-RFC6845">RFC6845</a>]  Sheth, N., Wang, L., and J. Zhang, "OSPF Hybrid Broadcast
              and Point-to-Multipoint Interface Type", <a href="rfc6845.html">RFC 6845</a>,
              DOI 10.17487/RFC6845, January 2013,
              &lt;<a href="http://www.rfc-editor.org/info/rfc6845">http://www.rfc-editor.org/info/rfc6845</a>&gt;.

   [<a id="ref-RFC6987" name="ref-RFC6987">RFC6987</a>]  Retana, A., Nguyen, L., Zinin, A., White, R., and D.
              McPherson, "OSPF Stub Router Advertisement", <a href="rfc6987.html">RFC 6987</a>,
              DOI 10.17487/RFC6987, September 2013,
              &lt;<a href="http://www.rfc-editor.org/info/rfc6987">http://www.rfc-editor.org/info/rfc6987</a>&gt;.

Acknowledgements

   The authors would like to thank Abhay Roy, Hannes Gredler, Peter
   Psenak, and Eric Wu for their comments and suggestions.

Contributors

   David Dubois
   General Dynamics C4S
   400 John Quincy Adams Road
   Taunton, MA 02780
   United States of America
   Email: dave.dubois@gd-ms.com

   Vibhor Julka
   Individual Contributor

   Email: vjulka1@yahoo.com


   Tom McMillan
   L3 Communications, Linkabit
   9890 Towne Centre Drive
   San Diego, CA 92121
   United States of America
   Email: tom.mcmillan@l-3com.com















<span class="grey">Zhang, et al.                Standards Track                    [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc8042.html">RFC 8042</a>                  OSPF Two-Part Metric             December 2016</span>


Authors' Addresses

   Zhaohui Zhang
   Juniper Networks, Inc.
   10 Technology Park Drive
   Westford, MA 01886
   United States of America

   Email: zzhang@juniper.net


   Lili Wang
   Juniper Networks, Inc.
   10 Technology Park Drive
   Westford, MA 01886
   United States of America

   Email: liliw@juniper.net


   Acee Lindem
   Cisco Systems
   301 Midenhall Way
   Cary, NC 27513
   United States of America

   Email: acee@cisco.com
























Zhang, et al.                Standards Track                    [Page 9]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc8042 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:18 GMT --></html>