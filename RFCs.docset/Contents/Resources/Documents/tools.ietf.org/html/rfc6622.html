<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc6622 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 14 Aug 2018 14:14:11 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.127" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="draft-herberg-manet-packetbb-sec" name="DC.Relation.Replaces"/>
<meta content="urn:ietf:rfc:6622" name="DC.Identifier"/>
<meta content="May, 2012" name="DC.Date.Issued"/>
<meta content="Herberg, Ulrich" name="DC.Creator"/>
<meta content="Clausen, Thomas Heide" name="DC.Creator"/>
<meta content="This document describes general and flexible TLVs for representing
cryptographic Integrity Check Values (ICVs) (i.e., digital signatures
or Message Authentication Codes (MACs)) as well as timestamps, using
the generalized Mobile Ad Hoc Network (MANET) packet/message format
defined in RFC 5444. It defines two Packet TLVs, two Message TLVs, and
two Address Block TLVs for affixing ICVs and timestamps to a packet, a
message, and an address, respectively. [STANDARDS-TRACK]" name="DC.Description.Abstract"/>
<meta content="Integrity Check Value and Timestamp TLV Definitions for Mobile Ad Hoc Networks (MANETs)" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 6622 - Integrity Check Value and Timestamp TLV Definitions for Mobile Ad Hoc Networks (MANETs)</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgbrown" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc6622.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc6622" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-manet-packetbb-sec" title="draft-ietf-manet-packetbb-sec">draft-ietf-mane...</a>] [<a href="https://datatracker.ietf.org/doc/rfc6622" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc6622" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc6622" title="Side-by-side diff">Diff2</a>]         </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">Obsoleted by: <a href="rfc7182.html">7182</a>                                     PROPOSED STANDARD</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Internet Engineering Task Force (IETF)                        U. Herberg
Request for Comments: 6622               Fujitsu Laboratories of America
Category: Standards Track                                     T. Clausen
ISSN: 2070-1721                                 LIX, Ecole Polytechnique
                                                                May 2012


          <span class="h1">Integrity Check Value and Timestamp TLV Definitions</span>
                  <span class="h1">for Mobile Ad Hoc Networks (MANETs)</span>

Abstract

   This document describes general and flexible TLVs for representing
   cryptographic Integrity Check Values (ICVs) (i.e., digital signatures
   or Message Authentication Codes (MACs)) as well as timestamps, using
   the generalized Mobile Ad Hoc Network (MANET) packet/message format
   defined in <a href="rfc5444.html">RFC 5444</a>.  It defines two Packet TLVs, two Message TLVs,
   and two Address Block TLVs for affixing ICVs and timestamps to a
   packet, a message, and an address, respectively.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="rfc5741.html#section-2">Section 2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc6622">http://www.rfc-editor.org/info/rfc6622</a>.

Copyright Notice

   Copyright (c) 2012 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.



<span class="grey">Herberg &amp; Clausen            Standards Track                    [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc6622.html">RFC 6622</a>            ICV and Timestamp TLVs for MANETs           May 2012</span>


Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-3">3</a>
   <a href="#section-2">2</a>. Terminology .....................................................<a href="#page-3">3</a>
   <a href="#section-3">3</a>. Applicability Statement .........................................<a href="#page-3">3</a>
   <a href="#section-4">4</a>. Security Architecture ...........................................<a href="#page-4">4</a>
   <a href="#section-5">5</a>. Overview and Functioning ........................................<a href="#page-5">5</a>
   <a href="#section-6">6</a>. General ICV TLV Structure .......................................<a href="#page-6">6</a>
   <a href="#section-7">7</a>. General Timestamp TLV Structure .................................<a href="#page-6">6</a>
   <a href="#section-8">8</a>. Packet TLVs .....................................................<a href="#page-7">7</a>
      <a href="#section-8.1">8.1</a>. Packet ICV TLV .............................................<a href="#page-7">7</a>
      <a href="#section-8.2">8.2</a>. Packet TIMESTAMP TLV .......................................<a href="#page-7">7</a>
   <a href="#section-9">9</a>. Message TLVs ....................................................<a href="#page-8">8</a>
      <a href="#section-9.1">9.1</a>. Message ICV TLV ............................................<a href="#page-8">8</a>
      <a href="#section-9.2">9.2</a>. Message TIMESTAMP TLV ......................................<a href="#page-8">8</a>
   <a href="#section-10">10</a>. Address Block TLVs .............................................<a href="#page-8">8</a>
      <a href="#section-10.1">10.1</a>. Address Block ICV TLV .....................................<a href="#page-8">8</a>
      <a href="#section-10.2">10.2</a>. Address Block TIMESTAMP TLV ...............................<a href="#page-9">9</a>
   <a href="#section-11">11</a>. ICV: Basic .....................................................<a href="#page-9">9</a>
   <a href="#section-12">12</a>. ICV: Cryptographic Function over a Hash Value ..................<a href="#page-9">9</a>
      <a href="#section-12.1">12.1</a>. General ICV TLV Structure ................................<a href="#page-10">10</a>
           <a href="#section-12.1.1">12.1.1</a>. Rationale .........................................<a href="#page-11">11</a>
      <a href="#section-12.2">12.2</a>. Considerations for Calculating the ICV ...................<a href="#page-11">11</a>
           <a href="#section-12.2.1">12.2.1</a>. Packet ICV TLV ....................................<a href="#page-11">11</a>
           <a href="#section-12.2.2">12.2.2</a>. Message ICV TLV ...................................<a href="#page-11">11</a>
           <a href="#section-12.2.3">12.2.3</a>. Address Block ICV TLV .............................<a href="#page-11">11</a>
      <a href="#section-12.3">12.3</a>. Example of a Message Including an ICV ....................<a href="#page-12">12</a>
   <a href="#section-13">13</a>. IANA Considerations ...........................................<a href="#page-13">13</a>
      <a href="#section-13.1">13.1</a>. Expert Review: Evaluation Guidelines .....................<a href="#page-13">13</a>
      <a href="#section-13.2">13.2</a>. Packet TLV Type Registrations ............................<a href="#page-14">14</a>
      <a href="#section-13.3">13.3</a>. Message TLV Type Registrations ...........................<a href="#page-15">15</a>
      <a href="#section-13.4">13.4</a>. Address Block TLV Type Registrations .....................<a href="#page-16">16</a>
      <a href="#section-13.5">13.5</a>. Hash Functions ...........................................<a href="#page-17">17</a>
      <a href="#section-13.6">13.6</a>. Cryptographic Functions ..................................<a href="#page-18">18</a>
   <a href="#section-14">14</a>. Security Considerations .......................................<a href="#page-18">18</a>
   <a href="#section-15">15</a>. Acknowledgements ..............................................<a href="#page-19">19</a>
   <a href="#section-16">16</a>. References ....................................................<a href="#page-19">19</a>
      <a href="#section-16.1">16.1</a>. Normative References .....................................<a href="#page-19">19</a>
      <a href="#section-16.2">16.2</a>. Informative References ...................................<a href="#page-21">21</a>












<span class="grey">Herberg &amp; Clausen            Standards Track                    [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc6622.html">RFC 6622</a>            ICV and Timestamp TLVs for MANETs           May 2012</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   This document specifies

   o  Two TLVs for carrying Integrity Check Values (ICVs) and timestamps
      in packets, messages, and address blocks as defined by [<a href="rfc5444.html" title='"Generalized Mobile Ad Hoc Network (MANET) Packet/Message Format"'>RFC5444</a>].

   o  A generic framework for ICVs, accounting (for Message TLVs) for
      mutable message header fields (&lt;msg-hop-limit&gt; and
      &lt;msg-hop-count&gt;), where these fields are present in messages.

   This document sets up IANA registries for recording code points for
   hash-function and ICV calculation, respectively.

   Moreover, in <a href="#section-12">Section 12</a>, this document defines the following:

   o  One common method for generating ICVs as a cryptographic function,
      calculated over the hash value of the content.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Terminology"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Terminology</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in
   [<a href="rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].

   This document uses the terminology and notation defined in [<a href="rfc5444.html" title='"Generalized Mobile Ad Hoc Network (MANET) Packet/Message Format"'>RFC5444</a>].
   In particular, the following TLV fields from [<a href="rfc5444.html" title='"Generalized Mobile Ad Hoc Network (MANET) Packet/Message Format"'>RFC5444</a>] are used in
   this specification:

   &lt;msg-hop-limit&gt;  is the hop limit of a message, as specified in
      <a href="rfc5444.html#section-5.2">Section 5.2 of [RFC5444]</a>.

   &lt;msg-hop-count&gt;  is the hop count of a message, as specified in
      <a href="rfc5444.html#section-5.2">Section 5.2 of [RFC5444]</a>.

   &lt;length&gt;  is the length of a TLV in octets, as specified in
      <a href="rfc5444.html#section-5.4.1">Section 5.4.1 of [RFC5444]</a>.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Applicability%20Statement"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Applicability Statement</span>

   MANET routing protocols using the format defined in [<a href="rfc5444.html" title='"Generalized Mobile Ad Hoc Network (MANET) Packet/Message Format"'>RFC5444</a>] are
   accorded the ability to carry additional information in control
   messages and packets, through the inclusion of TLVs.  Information so
   included MAY be used by a MANET routing protocol, or by an extension
   of a MANET routing protocol, according to its specification.





<span class="grey">Herberg &amp; Clausen            Standards Track                    [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc6622.html">RFC 6622</a>            ICV and Timestamp TLVs for MANETs           May 2012</span>


   This document specifies how to include an ICV for a packet, a
   message, and addresses in address blocks within a message, by way of
   such TLVs.  This document also specifies a) how to treat "mutable"
   fields, specifically the &lt;msg-hop-count&gt; and &lt;msg-hop-limit&gt; fields,
   if present in the message header when calculating ICVs, such that the
   resulting ICV can be correctly verified by any recipient, and b) how
   to include this ICV.

   This document describes a generic framework for creating ICVs, and
   how to include these ICVs in TLVs.  In <a href="#section-12">Section 12</a>, an example method
   for calculating such ICVs is given, using a cryptographic function
   over the hash value of the content.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Security%20Architecture"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Security Architecture</span>

   Basic MANET routing protocol specifications are often "oblivious to
   security"; however, they have a clause allowing a control message to
   be rejected as "badly formed" or "insecure" prior to the message
   being processed or forwarded.  MANET routing protocols such as the
   Neighborhood Discovery Protocol (NHDP) [<a href="rfc6130.html" title='"Mobile Ad Hoc Network (MANET) Neighborhood Discovery Protocol (NHDP)"'>RFC6130</a>] and the Optimized
   Link State Routing Protocol version 2 [<a href="#ref-OLSRv2" title='"The Optimized Link State Routing Protocol version 2"'>OLSRv2</a>] recognize external
   reasons (such as failure to verify an ICV) for rejecting a message
   that would be considered "invalid for processing".  This architecture
   is a result of the observation that with respect to security in
   MANETs, "one size rarely fits all" and that MANET routing protocol
   deployment domains have varying security requirements ranging from
   "unbreakable" to "virtually none".  The virtue of this approach is
   that MANET routing protocol specifications (and implementations) can
   remain "generic", with extensions providing proper security
   mechanisms specific to a deployment domain.

   The MANET routing protocol "security architecture", in which this
   specification situates itself, can therefore be summarized as
   follows:

   o  Security-oblivious MANET routing protocol specifications, with a
      clause allowing an extension to reject a message (prior to
      processing/forwarding) as "badly formed" or "insecure".

   o  MANET routing protocol security extensions, rejecting messages as
      "badly formed" or "insecure", as appropriate for a given security
      requirement specific to a deployment domain.

   o  Code points and an exchange format for information, necessary for
      specification of such MANET routing protocol security extensions.






<span class="grey">Herberg &amp; Clausen            Standards Track                    [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc6622.html">RFC 6622</a>            ICV and Timestamp TLVs for MANETs           May 2012</span>


   This document addresses the last of the issues listed above by
   specifying a common exchange format for cryptographic ICVs, making
   reservations from within the Packet TLV, Message TLV, and Address
   Block TLV registries of [<a href="rfc5444.html" title='"Generalized Mobile Ad Hoc Network (MANET) Packet/Message Format"'>RFC5444</a>], to be used (and shared) among
   MANET routing protocol security extensions.

   For the specific decomposition of an ICV into a cryptographic
   function over a hash value (specified in <a href="#section-12">Section 12</a>), this document
   establishes two IANA registries for code points for hash functions
   and cryptographic functions adhering to [<a href="rfc5444.html" title='"Generalized Mobile Ad Hoc Network (MANET) Packet/Message Format"'>RFC5444</a>].

   With respect to [<a href="rfc5444.html" title='"Generalized Mobile Ad Hoc Network (MANET) Packet/Message Format"'>RFC5444</a>], this document is

   o  Intended to be used in the non-normative, but intended, mode of
      use described in <a href="rfc5444.html#appendix-B">Appendix B of [RFC5444]</a>.

   o  A specific example of the Security Considerations section of
      [<a href="rfc5444.html" title='"Generalized Mobile Ad Hoc Network (MANET) Packet/Message Format"'>RFC5444</a>] (the authentication part).

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Overview%20and%20Functioning"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Overview and Functioning</span>

   This document specifies a syntactical representation of security-
   related information for use with [<a href="rfc5444.html" title='"Generalized Mobile Ad Hoc Network (MANET) Packet/Message Format"'>RFC5444</a>] addresses, messages, and
   packets, and also establishes IANA registrations of TLV types and
   type extension registries for these TLV types.

   Moreover, this document provides guidelines for how MANET routing
   protocols and MANET routing protocol extensions using this
   specification should treat ICV and Timestamp TLVs, and mutable fields
   in messages.  This specification does not represent a stand-alone
   protocol; MANET routing protocols and MANET routing protocol
   extensions, using this specification, MUST provide instructions as to
   how to handle packets, messages, and addresses with security
   information, associated as specified in this document.

   This document assigns TLV types from the registries defined for
   Packet, Message, and Address Block TLVs in [<a href="rfc5444.html" title='"Generalized Mobile Ad Hoc Network (MANET) Packet/Message Format"'>RFC5444</a>].  When a TLV
   type is assigned from one of these registries, a registry for type
   extensions for that TLV type is created by IANA.  This document
   utilizes these type extension registries so created, in order to
   specify internal structure (and accompanying processing) of the
   &lt;value&gt; field of a TLV.

   For example, and as defined in this document, an ICV TLV with type
   extension = 0 specifies that the &lt;value&gt; field has no pre-defined
   internal structure but is simply a sequence of octets.  An ICV TLV
   with type extension = 1 specifies that the &lt;value&gt; field has a
   pre-defined internal structure and defines its interpretation.



<span class="grey">Herberg &amp; Clausen            Standards Track                    [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc6622.html">RFC 6622</a>            ICV and Timestamp TLVs for MANETs           May 2012</span>


   (Specifically, the &lt;value&gt; field consists of a cryptographic
   operation over a hash value, with fields indicating which hash
   function and cryptographic operation have been used; this is
   specified in <a href="#section-12">Section 12</a>.)

   Other documents can request assignments for other type extensions; if
   they do so, they MUST specify their internal structure (if any) and
   interpretation.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20General%20ICV%20TLV%20Structure"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  General ICV TLV Structure</span>

   The value of the ICV TLV is

      &lt;value&gt; := &lt;ICV-value&gt;

   where

   &lt;ICV-value&gt;  is a field, of &lt;length&gt; octets, which contains the
      information to be interpreted by the ICV verification process, as
      specified by the type extension.

   Note that this does not stipulate how to calculate the &lt;ICV-value&gt;
   nor the internal structure thereof, if any; such information MUST be
   specified by way of the type extension for the ICV TLV type.  See
   <a href="#section-13">Section 13</a>.  This document specifies two such type extensions -- one
   for ICVs without pre-defined structures, and one for ICVs constructed
   by way of a cryptographic operation over a hash value.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20General%20Timestamp%20TLV%20Structure"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  General Timestamp TLV Structure</span>

   The value of the Timestamp TLV is

      &lt;value&gt; := &lt;time-value&gt;

   where

   &lt;time-value&gt;  is an unsigned integer field, of length &lt;length&gt;, which
      contains the timestamp.

      Note that this does not stipulate how to calculate the
      &lt;time-value&gt; nor the internal structure thereof, if any; such
      information MUST be specified by way of the type extension for the
      TIMESTAMP TLV type.  See <a href="#section-13">Section 13</a>.








<span class="grey">Herberg &amp; Clausen            Standards Track                    [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc6622.html">RFC 6622</a>            ICV and Timestamp TLVs for MANETs           May 2012</span>


   A timestamp is essentially "freshness information".  As such, its
   setting and interpretation are to be determined by the MANET routing
   protocol, or MANET routing protocol extension, that uses the
   timestamp and can, for example, correspond to a UNIX timestamp, GPS
   timestamp, or a simple sequence number.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20Packet%20TLVs"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  Packet TLVs</span>

   Two Packet TLVs are defined: one for including the cryptographic ICV
   of a packet and one for including the timestamp indicating the time
   at which the cryptographic ICV was calculated.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.1.%20%20Packet%20ICV%20TLV"></a><a class="selflink" href="#section-8.1" name="section-8.1">8.1</a>.  Packet ICV TLV</span>

   A Packet ICV TLV is an example of an ICV TLV as described in
   <a href="#section-6">Section 6</a>.

   The following considerations apply:

   o  Because packets as defined in [<a href="rfc5444.html" title='"Generalized Mobile Ad Hoc Network (MANET) Packet/Message Format"'>RFC5444</a>] are never forwarded by
      routers, no special considerations are required regarding mutable
      fields (e.g., &lt;msg-hop-count&gt; and &lt;msg-hop-limit&gt;), if present,
      when calculating the ICV.

   o  Any Packet ICV TLVs already present in the Packet TLV block MUST
      be removed before calculating the ICV, and the Packet TLV block
      size MUST be recalculated accordingly.  Removed ICV TLVs MUST be
      restored after having calculated the ICV value.

   The rationale for removing any Packet ICV TLV already present prior
   to calculating the ICV is that several ICVs may be added to the same
   packet, e.g., using different ICV functions.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/8.2.%20%20Packet%20TIMESTAMP%20TLV"></a><a class="selflink" href="#section-8.2" name="section-8.2">8.2</a>.  Packet TIMESTAMP TLV</span>

   A Packet TIMESTAMP TLV is an example of a Timestamp TLV as described
   in <a href="#section-7">Section 7</a>.  If a packet contains a TIMESTAMP TLV and an ICV TLV,
   the TIMESTAMP TLV SHOULD be added to the packet before any ICV TLV,
   in order that it be included in the calculation of the ICV.












<span class="grey">Herberg &amp; Clausen            Standards Track                    [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc6622.html">RFC 6622</a>            ICV and Timestamp TLVs for MANETs           May 2012</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/9.%20%20Message%20TLVs"></a><a class="selflink" href="#section-9" name="section-9">9</a>.  Message TLVs</span>

   Two Message TLVs are defined: one for including the cryptographic ICV
   of a message and one for including the timestamp indicating the time
   at which the cryptographic ICV was calculated.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/9.1.%20%20Message%20ICV%20TLV"></a><a class="selflink" href="#section-9.1" name="section-9.1">9.1</a>.  Message ICV TLV</span>

   A Message ICV TLV is an example of an ICV TLV as described in
   <a href="#section-6">Section 6</a>.  When determining the &lt;ICV-value&gt; for a message, the
   following considerations MUST be applied:

   o  The fields &lt;msg-hop-limit&gt; and &lt;msg-hop-count&gt;, if present, MUST
      both be assumed to have the value 0 (zero) when calculating
      the ICV.

   o  Any Message ICV TLVs already present in the Message TLV block MUST
      be removed before calculating the ICV, and the message size as
      well as the Message TLV block size MUST be recalculated
      accordingly.  Removed ICV TLVs MUST be restored after having
      calculated the ICV value.

   The rationale for removing any Message ICV TLV already present prior
   to calculating the ICV is that several ICVs may be added to the same
   message, e.g., using different ICV functions.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/9.2.%20%20Message%20TIMESTAMP%20TLV"></a><a class="selflink" href="#section-9.2" name="section-9.2">9.2</a>.  Message TIMESTAMP TLV</span>

   A Message TIMESTAMP TLV is an example of a Timestamp TLV as described
   in <a href="#section-7">Section 7</a>.  If a message contains a TIMESTAMP TLV and an ICV TLV,
   the TIMESTAMP TLV SHOULD be added to the message before the ICV TLV,
   in order that it be included in the calculation of the ICV.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/10.%20%20Address%20Block%20TLVs"></a><a class="selflink" href="#section-10" name="section-10">10</a>.  Address Block TLVs</span>

   Two Address Block TLVs are defined: one for associating a
   cryptographic ICV to an address and one for including the timestamp
   indicating the time at which the cryptographic ICV was calculated.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/10.1.%20%20Address%20Block%20ICV%20TLV"></a><a class="selflink" href="#section-10.1" name="section-10.1">10.1</a>.  Address Block ICV TLV</span>

   An Address Block ICV TLV is an example of an ICV TLV as described in
   <a href="#section-6">Section 6</a>.  The ICV is calculated over the address, concatenated with
   any other values -- for example, any other Address Block TLV &lt;value&gt;
   fields -- associated with that address.  A MANET routing protocol or
   MANET routing protocol extension using Address Block ICV TLVs MUST
   specify how to include any such concatenated attribute of the address




<span class="grey">Herberg &amp; Clausen            Standards Track                    [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc6622.html">RFC 6622</a>            ICV and Timestamp TLVs for MANETs           May 2012</span>


   in the verification process of the ICV.  When determining the
   &lt;ICV-value&gt; for an address, the following consideration MUST be
   applied:

   o  If other TLV values are concatenated with the address for
      calculating the ICV, these TLVs MUST NOT be Address Block ICV TLVs
      already associated with the address.

   The rationale for not concatenating the address with any ICV TLV
   values already associated with the address when calculating the ICV
   is that several ICVs may be added to the same address, e.g., using
   different ICV functions.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/10.2.%20%20Address%20Block%20TIMESTAMP%20TLV"></a><a class="selflink" href="#section-10.2" name="section-10.2">10.2</a>.  Address Block TIMESTAMP TLV</span>

   An Address Block TIMESTAMP TLV is an example of a Timestamp TLV as
   described in <a href="#section-7">Section 7</a>.  If both a TIMESTAMP TLV and an ICV TLV are
   associated with an address, the TIMESTAMP TLV &lt;value&gt; MUST be covered
   when calculating the value of the ICV to be contained in the ICV TLV
   value (i.e., concatenated with the associated address and any other
   values as described in <a href="#section-10.1">Section 10.1</a>).

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/11.%20%20ICV%3A%20Basic"></a><a class="selflink" href="#section-11" name="section-11">11</a>.  ICV: Basic</span>

   The basic ICV, represented by way of an ICV TLV with type
   extension = 0, is a simple bit-field containing the cryptographic
   ICV.  This assumes that the mechanism stipulating how ICVs are
   calculated and verified is established outside of this specification,
   e.g., by way of administrative configuration or external out-of-band
   signaling.  Thus, the &lt;ICV-value&gt;, when using type extension = 0, is

      &lt;ICV-value&gt; := &lt;ICV-data&gt;

   where

   &lt;ICV-data&gt;  is an unsigned integer field, of length &lt;length&gt;, which
      contains the cryptographic ICV.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/12.%20%20ICV%3A%20Cryptographic%20Function%20over%20a%20Hash%20Value"></a><a class="selflink" href="#section-12" name="section-12">12</a>.  ICV: Cryptographic Function over a Hash Value</span>

   One common way of calculating an ICV is applying a cryptographic
   function over a hash value of the content.  This decomposition is
   specified in this section, using a type extension = 1 in the
   ICV TLVs.







<span class="grey">Herberg &amp; Clausen            Standards Track                    [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc6622.html">RFC 6622</a>            ICV and Timestamp TLVs for MANETs           May 2012</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/12.1.%20%20General%20ICV%20TLV%20Structure"></a><a class="selflink" href="#section-12.1" name="section-12.1">12.1</a>.  General ICV TLV Structure</span>

   The following data structure allows representation of a cryptographic
   ICV, including specification of the appropriate hash function and
   cryptographic function used for calculating the ICV:

                   &lt;ICV-value&gt; := &lt;hash-function&gt;
                                  &lt;cryptographic-function&gt;
                                  &lt;key-id-length&gt;
                                  &lt;key-id&gt;
                                  &lt;ICV-data&gt;

   where

   &lt;hash-function&gt;  is an 8-bit unsigned integer field specifying the
      hash function.

   &lt;cryptographic-function&gt;  is an 8-bit unsigned integer field
      specifying the cryptographic function.

   &lt;key-id-length&gt;  is an 8-bit unsigned integer field specifying the
      length of the &lt;key-id&gt; field in number of octets.  The value 0x00
      is reserved for using a pre-installed, shared key.

   &lt;key-id&gt;  is a field specifying the key identifier of the key that
      was used to calculate the ICV of the message, which allows unique
      identification of different keys with the same originator.  It is
      the responsibility of each key originator to make sure that
      actively used keys that it issues have distinct key identifiers.
      If &lt;key-id-length&gt; equals 0x00, the &lt;key-id&gt; field is not
      contained in the TLV, and a pre-installed, shared key is used.

   &lt;ICV-data&gt;  is an unsigned integer field, whose length is
      &lt;length&gt; - 3 - &lt;key-id-length&gt;, and which contains the
      cryptographic ICV.

   The version of this TLV, specified in this section, assumes that
   calculating the ICV can be decomposed into

      ICV-value = cryptographic-function(hash-function(content))

   The hash function and the cryptographic function correspond to the
   entries in two IANA registries, which are set up by this
   specification and are described in <a href="#section-13">Section 13</a>.







<span class="grey">Herberg &amp; Clausen            Standards Track                   [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc6622.html">RFC 6622</a>            ICV and Timestamp TLVs for MANETs           May 2012</span>


<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/12.1.1.%20%20Rationale"></a><a class="selflink" href="#section-12.1.1" name="section-12.1.1">12.1.1</a>.  Rationale</span>

   The rationale for separating the hash function and the cryptographic
   function into two octets instead of having all combinations in a
   single octet -- possibly as a TLV type extension -- is that adding
   further hash functions or cryptographic functions in the future may
   lead to a non-contiguous number space.

   The rationale for not including a field that lists parameters of the
   cryptographic ICV in the TLV is that, before being able to validate a
   cryptographic ICV, routers have to exchange or acquire keys (e.g.,
   public keys).  Any additional parameters can be provided together
   with the keys in that bootstrap process.  It is therefore not
   necessary, and would even entail an extra overhead, to transmit the
   parameters within every message.  One implicitly available parameter
   is the length of the ICV, which is &lt;length&gt; - 3 - &lt;key-id-length&gt;,
   and which depends on the choice of the cryptographic function.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/12.2.%20%20Considerations%20for%20Calculating%20the%20ICV"></a><a class="selflink" href="#section-12.2" name="section-12.2">12.2</a>.  Considerations for Calculating the ICV</span>

   The considerations listed in the following subsections MUST be
   applied when calculating the ICV for Packet, Message, and Address ICV
   TLVs, respectively.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/12.2.1.%20%20Packet%20ICV%20TLV"></a><a class="selflink" href="#section-12.2.1" name="section-12.2.1">12.2.1</a>.  Packet ICV TLV</span>

   When determining the &lt;ICV-value&gt; for a packet, the ICV is calculated
   over the fields &lt;hash-function&gt;, &lt;cryptographic-function&gt;,
   &lt;key-id-length&gt;, and -- if present -- &lt;key-id&gt; (in that order),
   concatenated with the entire packet, including the packet header, all
   Packet TLVs (other than Packet ICV TLVs), and all included Messages
   and their message headers, in accordance with <a href="#section-8.1">Section 8.1</a>.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/12.2.2.%20%20Message%20ICV%20TLV"></a><a class="selflink" href="#section-12.2.2" name="section-12.2.2">12.2.2</a>.  Message ICV TLV</span>

   When determining the &lt;ICV-value&gt; for a message, the ICV is calculated
   over the fields &lt;hash-function&gt;, &lt;cryptographic-function&gt;,
   &lt;key-id-length&gt;, and -- if present -- &lt;key-id&gt; (in that order),
   concatenated with the entire message.  The considerations in
   <a href="#section-9.1">Section 9.1</a> MUST be applied.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/12.2.3.%20%20Address%20Block%20ICV%20TLV"></a><a class="selflink" href="#section-12.2.3" name="section-12.2.3">12.2.3</a>.  Address Block ICV TLV</span>

   When determining the &lt;ICV-value&gt; for an address, the ICV is
   calculated over the fields &lt;hash-function&gt;, &lt;cryptographic-function&gt;,
   &lt;key-id-length&gt;, and -- if present -- &lt;key-id&gt; (in that order),
   concatenated with the address, and concatenated with any other values
   -- for example, any other address block TLV &lt;value&gt; that is



<span class="grey">Herberg &amp; Clausen            Standards Track                   [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc6622.html">RFC 6622</a>            ICV and Timestamp TLVs for MANETs           May 2012</span>


   associated with that address.  A MANET routing protocol or MANET
   routing protocol extension using Address Block ICV TLVs MUST specify
   how to include any such concatenated attribute of the address in the
   verification process of the ICV.  The considerations in <a href="#section-10.1">Section 10.1</a>
   MUST be applied.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/12.3.%20%20Example%20of%20a%20Message%20Including%20an%20ICV"></a><a class="selflink" href="#section-12.3" name="section-12.3">12.3</a>.  Example of a Message Including an ICV</span>

   The sample message depicted in Figure 1 is derived from <a href="rfc5444.html#appendix-D">Appendix D of
   [RFC5444]</a>.  The message contains an ICV Message TLV, with the value
   representing an ICV that is 16 octets long of the whole message, and
   a key identifier that is 4 octets long.  The type extension of the
   Message TLV is 1, for the specific decomposition of an ICV into a
   cryptographic function over a hash value, as specified in <a href="#section-12">Section 12</a>.

      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | PV=0 |  PF=8  |    Packet Sequence Number     | Message Type  |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | MF=15 | MAL=3 |      Message Length = 44      | Msg. Orig Addr|
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |       Message Originator Address (cont)       |   Hop Limit   |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |   Hop Count   |    Message Sequence Number    | Msg. TLV Block|
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Length = 27   |     ICV       |  MTLVF = 144  |  MTLVExt = 1  |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |Value Len = 23 |   Hash Func   |  Crypto Func  |Key ID length=4|
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                          Key Identifier                       |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                          ICV Value                            |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                          ICV Value (cont)                     |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                          ICV Value (cont)                     |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                          ICV Value (cont)                     |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                    Figure 1: Example Message with ICV









<span class="grey">Herberg &amp; Clausen            Standards Track                   [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc6622.html">RFC 6622</a>            ICV and Timestamp TLVs for MANETs           May 2012</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/13.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-13" name="section-13">13</a>.  IANA Considerations</span>

   This specification defines the following:

   o  Two Packet TLV types, which have been allocated from the 0-223
      range of the "Packet TLV Types" repository of [<a href="rfc5444.html" title='"Generalized Mobile Ad Hoc Network (MANET) Packet/Message Format"'>RFC5444</a>], as
      specified in Table 1.

   o  Two Message TLV types, which have been allocated from the 0-127
      range of the "Message TLV Types" repository of [<a href="rfc5444.html" title='"Generalized Mobile Ad Hoc Network (MANET) Packet/Message Format"'>RFC5444</a>], as
      specified in Table 2.

   o  Two Address Block TLV types, which have been allocated from the
      0-127 range of the "Address Block TLV Types" repository of
      [<a href="rfc5444.html" title='"Generalized Mobile Ad Hoc Network (MANET) Packet/Message Format"'>RFC5444</a>], as specified in Table 3.

   This specification created the following:

   o  A type extension registry for each of these TLV types with initial
      values as listed in Tables 1, 2, and 3.

   IANA has assigned the same numerical value to the Packet TLV, Message
   TLV, and Address Block TLV types with the same name.

   The following terms are used as defined in [<a href="#ref-BCP26" title='"Guidelines for Writing an IANA Considerations Section in RFCs"'>BCP26</a>]: "Namespace",
   "Registration", and "Designated Expert".

   The following policy is used as defined in [<a href="#ref-BCP26" title='"Guidelines for Writing an IANA Considerations Section in RFCs"'>BCP26</a>]: "Expert Review".

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/13.1.%20%20Expert%20Review%3A%20Evaluation%20Guidelines"></a><a class="selflink" href="#section-13.1" name="section-13.1">13.1</a>.  Expert Review: Evaluation Guidelines</span>

   For TLV type extensions registries where an Expert Review is
   required, the Designated Expert SHOULD take the same general
   recommendations into consideration as those specified by [<a href="rfc5444.html" title='"Generalized Mobile Ad Hoc Network (MANET) Packet/Message Format"'>RFC5444</a>].

   For the Timestamp TLV, the same type extensions for all Packet,
   Message, and Address Block TLVs SHOULD be numbered identically.














<span class="grey">Herberg &amp; Clausen            Standards Track                   [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc6622.html">RFC 6622</a>            ICV and Timestamp TLVs for MANETs           May 2012</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/13.2.%20%20Packet%20TLV%20Type%20Registrations"></a><a class="selflink" href="#section-13.2" name="section-13.2">13.2</a>.  Packet TLV Type Registrations</span>

   IANA has made allocations from the "Packet TLV Types" namespace of
   [<a href="rfc5444.html" title='"Generalized Mobile Ad Hoc Network (MANET) Packet/Message Format"'>RFC5444</a>] for the Packet TLVs specified in Table 1.

   +-----------+------+-----------+------------------------------------+
   |    Name   | Type |    Type   |             Description            |
   |           |      | Extension |                                    |
   +-----------+------+-----------+------------------------------------+
   |    ICV    |   5  |     0     |           ICV of a packet          |
   |           |      |           |                                    |
   |           |      |     1     | ICV, decomposed into cryptographic |
   |           |      |           |   function over a hash value, as   |
   |           |      |           |   specified in <a href="#section-12">Section 12</a> of this  |
   |           |      |           |              document              |
   |           |      |           |                                    |
   |           |      |   2-251   |      Unassigned; Expert Review     |
   |           |      |           |                                    |
   |           |      |  252-255  |          Experimental Use          |
   |           |      |           |                                    |
   | TIMESTAMP |   6  |     0     |   Unsigned timestamp of arbitrary  |
   |           |      |           |   length, given by the TLV Length  |
   |           |      |           | field.  The MANET routing protocol |
   |           |      |           |   has to define how to interpret   |
   |           |      |           |           this timestamp           |
   |           |      |           |                                    |
   |           |      |     1     |    Unsigned 32-bit timestamp, as   |
   |           |      |           |   specified in [IEEE 1003.1-2008   |
   |           |      |           |              (POSIX)]              |
   |           |      |           |                                    |
   |           |      |     2     |  NTP timestamp format, as defined  |
   |           |      |           |            in [<a href="rfc5905.html" title='"Network Time Protocol Version 4: Protocol and Algorithms Specification"'>RFC5905</a>]            |
   |           |      |           |                                    |
   |           |      |     3     |    Signed timestamp of arbitrary   |
   |           |      |           | length with no constraints such as |
   |           |      |           |  monotonicity.  In particular, it  |
   |           |      |           |   may represent any random value   |
   |           |      |           |                                    |
   |           |      |   4-251   |      Unassigned; Expert Review     |
   |           |      |           |                                    |
   |           |      |  252-255  |          Experimental Use          |
   +-----------+------+-----------+------------------------------------+

                         Table 1: Packet TLV Types







<span class="grey">Herberg &amp; Clausen            Standards Track                   [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc6622.html">RFC 6622</a>            ICV and Timestamp TLVs for MANETs           May 2012</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/13.3.%20%20Message%20TLV%20Type%20Registrations"></a><a class="selflink" href="#section-13.3" name="section-13.3">13.3</a>.  Message TLV Type Registrations</span>

   IANA has made allocations from the "Message TLV Types" namespace of
   [<a href="rfc5444.html" title='"Generalized Mobile Ad Hoc Network (MANET) Packet/Message Format"'>RFC5444</a>] for the Message TLVs specified in Table 2.

   +-----------+------+-----------+------------------------------------+
   |    Name   | Type |    Type   |             Description            |
   |           |      | Extension |                                    |
   +-----------+------+-----------+------------------------------------+
   |    ICV    |   5  |     0     |          ICV of a message          |
   |           |      |           |                                    |
   |           |      |     1     | ICV, decomposed into cryptographic |
   |           |      |           |   function over a hash value, as   |
   |           |      |           |   specified in <a href="#section-12">Section 12</a> of this  |
   |           |      |           |              document              |
   |           |      |           |                                    |
   |           |      |   2-251   |      Unassigned; Expert Review     |
   |           |      |           |                                    |
   |           |      |  252-255  |          Experimental Use          |
   |           |      |           |                                    |
   | TIMESTAMP |   6  |     0     |   Unsigned timestamp of arbitrary  |
   |           |      |           |   length, given by the TLV Length  |
   |           |      |           |               field                |
   |           |      |           |                                    |
   |           |      |     1     |    Unsigned 32-bit timestamp, as   |
   |           |      |           |   specified in [IEEE 1003.1-2008   |
   |           |      |           |              (POSIX)]              |
   |           |      |           |                                    |
   |           |      |     2     |  NTP timestamp format, as defined  |
   |           |      |           |            in [<a href="rfc5905.html" title='"Network Time Protocol Version 4: Protocol and Algorithms Specification"'>RFC5905</a>]            |
   |           |      |           |                                    |
   |           |      |     3     |    Signed timestamp of arbitrary   |
   |           |      |           | length with no constraints such as |
   |           |      |           |  monotonicity.  In particular, it  |
   |           |      |           |   may represent any random value   |
   |           |      |           |                                    |
   |           |      |   4-251   |      Unassigned; Expert Review     |
   |           |      |           |                                    |
   |           |      |  252-255  |          Experimental Use          |
   +-----------+------+-----------+------------------------------------+

                        Table 2: Message TLV Types









<span class="grey">Herberg &amp; Clausen            Standards Track                   [Page 15]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc6622.html">RFC 6622</a>            ICV and Timestamp TLVs for MANETs           May 2012</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/13.4.%20%20Address%20Block%20TLV%20Type%20Registrations"></a><a class="selflink" href="#section-13.4" name="section-13.4">13.4</a>.  Address Block TLV Type Registrations</span>

   IANA has made allocations from the "Address Block TLV Types"
   namespace of [<a href="rfc5444.html" title='"Generalized Mobile Ad Hoc Network (MANET) Packet/Message Format"'>RFC5444</a>] for the Packet TLVs specified in Table 3.

   +-----------+------+-----------+------------------------------------+
   |    Name   | Type |    Type   |             Description            |
   |           |      | Extension |                                    |
   +-----------+------+-----------+------------------------------------+
   |    ICV    |   5  |     0     |     ICV of an object (e.g., an     |
   |           |      |           |              address)              |
   |           |      |           |                                    |
   |           |      |     1     | ICV, decomposed into cryptographic |
   |           |      |           |   function over a hash value, as   |
   |           |      |           |   specified in <a href="#section-12">Section 12</a> of this  |
   |           |      |           |              document              |
   |           |      |           |                                    |
   |           |      |   2-251   |      Unassigned; Expert Review     |
   |           |      |           |                                    |
   |           |      |  252-255  |          Experimental Use          |
   |           |      |           |                                    |
   | TIMESTAMP |   6  |     0     |   Unsigned timestamp of arbitrary  |
   |           |      |           |   length, given by the TLV Length  |
   |           |      |           |                field               |
   |           |      |           |                                    |
   |           |      |     1     |    Unsigned 32-bit timestamp, as   |
   |           |      |           |   specified in [IEEE 1003.1-2008   |
   |           |      |           |              (POSIX)]              |
   |           |      |           |                                    |
   |           |      |     2     |  NTP timestamp format, as defined  |
   |           |      |           |            in [<a href="rfc5905.html" title='"Network Time Protocol Version 4: Protocol and Algorithms Specification"'>RFC5905</a>]            |
   |           |      |           |                                    |
   |           |      |     3     |    Signed timestamp of arbitrary   |
   |           |      |           | length with no constraints such as |
   |           |      |           |  monotonicity.  In particular, it  |
   |           |      |           |   may represent any random value   |
   |           |      |           |                                    |
   |           |      |   4-251   |      Unassigned; Expert Review     |
   |           |      |           |                                    |
   |           |      |  252-255  |          Experimental Use          |
   +-----------+------+-----------+------------------------------------+

                     Table 3: Address Block TLV Types








<span class="grey">Herberg &amp; Clausen            Standards Track                   [Page 16]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc6622.html">RFC 6622</a>            ICV and Timestamp TLVs for MANETs           May 2012</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/13.5.%20%20Hash%20Functions"></a><a class="selflink" href="#section-13.5" name="section-13.5">13.5</a>.  Hash Functions</span>

   IANA has created a new registry for hash functions that can be used
   when creating an ICV, as specified in <a href="#section-12">Section 12</a> of this document.
   The initial assignments and allocation policies are specified in
   Table 4.

   +-------------+-----------+-----------------------------------------+
   |     Hash    | Algorithm |               Description               |
   |   Function  |           |                                         |
   |    Value    |           |                                         |
   +-------------+-----------+-----------------------------------------+
   |      0      |    none   | The "identity function": The hash value |
   |             |           |    of an object is the object itself    |
   |             |           |                                         |
   |      1      |    SHA1   |            [<a href="#ref-NIST-FIPS-180-2" title='"Specifications for the Secure Hash Standard"'>NIST-FIPS-180-2</a>]            |
   |             |           |                                         |
   |      2      |   SHA224  |         [<a href="#ref-NIST-FIPS-180-2-change" title='"Federal Information Processing Standards Publication 180-2 (+ Change Notice to include SHA-224)"'>NIST-FIPS-180-2-change</a>]        |
   |             |           |                                         |
   |      3      |   SHA256  |            [<a href="#ref-NIST-FIPS-180-2" title='"Specifications for the Secure Hash Standard"'>NIST-FIPS-180-2</a>]            |
   |             |           |                                         |
   |      4      |   SHA384  |            [<a href="#ref-NIST-FIPS-180-2" title='"Specifications for the Secure Hash Standard"'>NIST-FIPS-180-2</a>]            |
   |             |           |                                         |
   |      5      |   SHA512  |            [<a href="#ref-NIST-FIPS-180-2" title='"Specifications for the Secure Hash Standard"'>NIST-FIPS-180-2</a>]            |
   |             |           |                                         |
   |    6-251    |           |        Unassigned; Expert Review        |
   |             |           |                                         |
   |   252-255   |           |             Experimental Use            |
   +-------------+-----------+-----------------------------------------+

                      Table 4: Hash-Function Registry




















<span class="grey">Herberg &amp; Clausen            Standards Track                   [Page 17]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc6622.html">RFC 6622</a>            ICV and Timestamp TLVs for MANETs           May 2012</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/13.6.%20%20Cryptographic%20Functions"></a><a class="selflink" href="#section-13.6" name="section-13.6">13.6</a>.  Cryptographic Functions</span>

   IANA has created a new registry for the cryptographic functions, as
   specified in <a href="#section-12">Section 12</a> of this document.  Initial assignments and
   allocation policies are specified in Table 5.

   +----------------+-----------+--------------------------------------+
   |  Cryptographic | Algorithm |              Description             |
   | Function Value |           |                                      |
   +----------------+-----------+--------------------------------------+
   |        0       |    none   |  The "identity function": The value  |
   |                |           |   of an encrypted hash is the hash   |
   |                |           |                itself                |
   |                |           |                                      |
   |        1       |    RSA    |               [<a href="rfc3447.html" title='"Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1"'>RFC3447</a>]              |
   |                |           |                                      |
   |        2       |    DSA    |           [<a href="#ref-NIST-FIPS-186-3" title='"Digital Signature Standard (DSS)"'>NIST-FIPS-186-3</a>]          |
   |                |           |                                      |
   |        3       |    HMAC   |               [<a href="rfc2104.html" title='"HMAC: Keyed-Hashing for Message Authentication"'>RFC2104</a>]              |
   |                |           |                                      |
   |        4       |    3DES   |           [<a href="#ref-NIST-SP-800-67" title='"Recommendation for the Triple Data Encryption Algorithm (TDEA) Block Cipher"'>NIST-SP-800-67</a>]           |
   |                |           |                                      |
   |        5       |    AES    |            [<a href="#ref-NIST-FIPS-197" title='"Specification for the Advanced Encryption Standard (AES)"'>NIST-FIPS-197</a>]           |
   |                |           |                                      |
   |        6       |   ECDSA   |           [<a href="#ref-ANSI-X9-62-2005" title='"Public Key Cryptography for the Financial Services Industry: The Elliptic Curve Digital Signature Algorithm (ECDSA)"'>ANSI-X9-62-2005</a>]          |
   |                |           |                                      |
   |      7-251     |           |       Unassigned; Expert Review      |
   |                |           |                                      |
   |     252-255    |           |           Experimental Use           |
   +----------------+-----------+--------------------------------------+

                 Table 5: Cryptographic Function Registry

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/14.%20%20Security%20Considerations"></a><a class="selflink" href="#section-14" name="section-14">14</a>.  Security Considerations</span>

   This document does not specify a protocol.  It provides a syntactical
   component for cryptographic ICVs of messages and packets, as defined
   in [<a href="rfc5444.html" title='"Generalized Mobile Ad Hoc Network (MANET) Packet/Message Format"'>RFC5444</a>].  It can be used to address security issues of a MANET
   routing protocol or MANET routing protocol extension.  As such, it
   has the same security considerations as [<a href="rfc5444.html" title='"Generalized Mobile Ad Hoc Network (MANET) Packet/Message Format"'>RFC5444</a>].

   In addition, a MANET routing protocol or MANET routing protocol
   extension that uses this specification MUST specify how to use the
   framework, and the TLVs presented in this document.  In addition, the
   protection that the MANET routing protocol or MANET routing protocol
   extensions attain by using this framework MUST be described.





<span class="grey">Herberg &amp; Clausen            Standards Track                   [Page 18]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-19" id="page-19" name="page-19"> </a>
<span class="grey"><a href="rfc6622.html">RFC 6622</a>            ICV and Timestamp TLVs for MANETs           May 2012</span>


   As an example, a MANET routing protocol that uses this component to
   reject "badly formed" or "insecure" messages if a control message
   does not contain a valid ICV SHOULD indicate the security assumption
   that if the ICV is valid, the message is considered valid.  It also
   SHOULD indicate the security issues that are counteracted by this
   measure (e.g., link or identity spoofing) as well as the issues that
   are not counteracted (e.g., compromised keys).

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/15.%20%20Acknowledgements"></a><a class="selflink" href="#section-15" name="section-15">15</a>.  Acknowledgements</span>

   The authors would like to thank Bo Berry (Cisco), Alan Cullen (BAE),
   Justin Dean (NRL), Christopher Dearlove (BAE), Paul Lambert
   (Marvell), Jerome Milan (Ecole Polytechnique), and Henning Rogge
   (FGAN) for their constructive comments on the document.

   The authors also appreciate the detailed reviews from the Area
   Directors, in particular Stewart Bryant (Cisco), Stephen Farrell
   (Trinity College Dublin), and Robert Sparks (Tekelec), as well as
   Donald Eastlake (Huawei) from the Security Directorate.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/16.%20%20References"></a><a class="selflink" href="#section-16" name="section-16">16</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/16.1.%20%20Normative%20References"></a><a class="selflink" href="#section-16.1" name="section-16.1">16.1</a>.  Normative References</span>

   [<a id="ref-ANSI-X9-62-2005" name="ref-ANSI-X9-62-2005">ANSI-X9-62-2005</a>]
               American National Standards Institute, "Public Key
               Cryptography for the Financial Services Industry: The
               Elliptic Curve Digital Signature Algorithm (ECDSA)",
               ANSI X9.62-2005, November 2005.

   [<a id="ref-BCP26" name="ref-BCP26">BCP26</a>]     Narten, T. and H. Alvestrand, "Guidelines for Writing an
               IANA Considerations Section in RFCs", <a href="https://tools.ietf.org/html/bcp26">BCP 26</a>, <a href="rfc5226.html">RFC 5226</a>,
               May 2008.

   [IEEE 1003.1-2008 (POSIX)]
               IEEE Computer Society, "1003.1-2008 Standard for
               Information Technology-Portable Operating System
               Interface (POSIX) Base Specifications, Issue 7",
               December 2008.

   [<a id="ref-NIST-FIPS-180-2" name="ref-NIST-FIPS-180-2">NIST-FIPS-180-2</a>]
               National Institute of Standards and Technology,
               "Specifications for the Secure Hash Standard",
               FIPS 180-2, August 2002.







<span class="grey">Herberg &amp; Clausen            Standards Track                   [Page 19]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-20" id="page-20" name="page-20"> </a>
<span class="grey"><a href="rfc6622.html">RFC 6622</a>            ICV and Timestamp TLVs for MANETs           May 2012</span>


   [<a id="ref-NIST-FIPS-180-2-change" name="ref-NIST-FIPS-180-2-change">NIST-FIPS-180-2-change</a>]
               National Institute of Standards and Technology, "Federal
               Information Processing Standards Publication 180-2
               (+ Change Notice to include SHA-224)", FIPS 180-2,
               August 2002, &lt;http:// csrc.nist.gov/publications/fips/
               fips180-2/fips180-2withchangenotice.pdf&gt;.

   [<a id="ref-NIST-FIPS-186-3" name="ref-NIST-FIPS-186-3">NIST-FIPS-186-3</a>]
               National Institute of Standards and Technology, "Digital
               Signature Standard (DSS)", FIPS 186-3, June 2009.

   [<a id="ref-NIST-FIPS-197" name="ref-NIST-FIPS-197">NIST-FIPS-197</a>]
               National Institute of Standards and Technology,
               "Specification for the Advanced Encryption Standard
               (AES)", FIPS 197, November 2001.

   [<a id="ref-NIST-SP-800-67" name="ref-NIST-SP-800-67">NIST-SP-800-67</a>]
               National Institute of Standards and Technology,
               "Recommendation for the Triple Data Encryption Algorithm
               (TDEA) Block Cipher", Special Publication 800-67,
               May 2004.

   [<a id="ref-RFC2104" name="ref-RFC2104">RFC2104</a>]   Krawczyk, H., Bellare, M., and R. Canetti, "HMAC:
               Keyed-Hashing for Message Authentication", <a href="rfc2104.html">RFC 2104</a>,
               February 1997.

   [<a id="ref-RFC2119" name="ref-RFC2119">RFC2119</a>]   Bradner, S., "Key words for use in RFCs to Indicate
               Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a id="ref-RFC3447" name="ref-RFC3447">RFC3447</a>]   Jonsson, J. and B. Kaliski, "Public-Key Cryptography
               Standards (PKCS) #1: RSA Cryptography Specifications
               Version 2.1", <a href="rfc3447.html">RFC 3447</a>, February 2003.

   [<a id="ref-RFC5444" name="ref-RFC5444">RFC5444</a>]   Clausen, T., Dearlove, C., Dean, J., and C. Adjih,
               "Generalized Mobile Ad Hoc Network (MANET) Packet/Message
               Format", <a href="rfc5444.html">RFC 5444</a>, February 2009.

   [<a id="ref-RFC5905" name="ref-RFC5905">RFC5905</a>]   Mills, D., Martin, J., Ed., Burbank, J., and W. Kasch,
               "Network Time Protocol Version 4: Protocol and Algorithms
               Specification", <a href="rfc5905.html">RFC 5905</a>, June 2010.











<span class="grey">Herberg &amp; Clausen            Standards Track                   [Page 20]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-21" id="page-21" name="page-21"> </a>
<span class="grey"><a href="rfc6622.html">RFC 6622</a>            ICV and Timestamp TLVs for MANETs           May 2012</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/16.2.%20%20Informative%20References"></a><a class="selflink" href="#section-16.2" name="section-16.2">16.2</a>.  Informative References</span>

   [<a id="ref-OLSRv2" name="ref-OLSRv2">OLSRv2</a>]    Clausen, T., Dearlove, C., Jacquet, P., and U. Herberg,
               "The Optimized Link State Routing Protocol version 2",
               Work in Progress, March 2012.

   [<a id="ref-RFC6130" name="ref-RFC6130">RFC6130</a>]   Clausen, T., Dearlove, C., and J. Dean, "Mobile Ad Hoc
               Network (MANET) Neighborhood Discovery Protocol (NHDP)",
               <a href="rfc6130.html">RFC 6130</a>, April 2011.

Authors' Addresses

   Ulrich Herberg
   Fujitsu Laboratories of America
   1240 E. Arques Ave.
   Sunnyvale, CA  94085
   USA

   EMail: ulrich@herberg.name
   URI:   <a href="http://www.herberg.name/">http://www.herberg.name/</a>


   Thomas Heide Clausen
   LIX, Ecole Polytechnique
   91128 Palaiseau Cedex
   France

   Phone: +33 6 6058 9349
   EMail: T.Clausen@computer.org
   URI:   <a href="http://www.thomasclausen.org/">http://www.thomasclausen.org/</a>





















Herberg &amp; Clausen            Standards Track                   [Page 21]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.127, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc6622 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 14 Aug 2018 14:14:11 GMT --></html>