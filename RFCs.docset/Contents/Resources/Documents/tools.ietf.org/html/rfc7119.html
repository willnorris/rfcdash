<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc7119 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 14 Aug 2018 14:06:07 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.127" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="draft-claise-ipfix-mediation-protocol" name="DC.Relation.Replaces"/>
<meta content="urn:ietf:rfc:7119" name="DC.Identifier"/>
<meta content="February, 2014" name="DC.Date.Issued"/>
<meta content="Trammell, Brian" name="DC.Creator"/>
<meta content="Claise, Benoit" name="DC.Creator"/>
<meta content="Kobayashi, Atsushi" name="DC.Creator"/>
<meta content="This document specifies the operation of the IP Flow Information
Export (IPFIX) protocol specific to IPFIX Mediators, including
Template and Observation Point management, timing considerations, and
other Mediator-specific concerns." name="DC.Description.Abstract"/>
<meta content="Operation of the IP Flow Information Export (IPFIX) Protocol on IPFIX Mediators" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 7119 - Operation of the IP Flow Information Export (IPFIX) Protocol on IPFIX Mediators</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgblue" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc7119.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc7119" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-ipfix-mediation-protocol" title="draft-ietf-ipfix-mediation-protocol">draft-ietf-ipfi...</a>] [<a href="https://datatracker.ietf.org/doc/rfc7119" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc7119" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc7119" title="Side-by-side diff">Diff2</a>]         </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                       PROPOSED STANDARD</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Internet Engineering Task Force (IETF)                         B. Claise
Request for Comments: 7119                           Cisco Systems, Inc.
Category: Standards Track                                   A. Kobayashi
ISSN: 2070-1721                                                      NTT
                                                             B. Trammell
                                                              ETH Zurich
                                                           February 2014


      <span class="h1">Operation of the IP Flow Information Export (IPFIX) Protocol</span>
                           <span class="h1">on IPFIX Mediators</span>

Abstract

   This document specifies the operation of the IP Flow Information
   Export (IPFIX) protocol specific to IPFIX Mediators, including
   Template and Observation Point management, timing considerations, and
   other Mediator-specific concerns.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="rfc5741.html#section-2">Section 2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc7119">http://www.rfc-editor.org/info/rfc7119</a>.

Copyright Notice

   Copyright (c) 2014 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.




<span class="grey">Claise, et al.               Standards Track                    [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc7119.html">RFC 7119</a>                     IPFIX MED-PROTO               February 2014</span>


Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-2">2</a>
      <a href="#section-1.1">1.1</a>. IPFIX Documents Overview ...................................<a href="#page-3">3</a>
      <a href="#section-1.2">1.2</a>. IPFIX Mediator Documents Overview ..........................<a href="#page-4">4</a>
      <a href="#section-1.3">1.3</a>. Relationship with the IPFIX and PSAMP Protocols ............<a href="#page-5">5</a>
   <a href="#section-2">2</a>. Terminology .....................................................<a href="#page-5">5</a>
   <a href="#section-3">3</a>. Handling IPFIX Message Headers ..................................<a href="#page-8">8</a>
   <a href="#section-4">4</a>. Template Management ............................................<a href="#page-10">10</a>
      <a href="#section-4.1">4.1</a>. Passing Unmodified Templates through an IPFIX Mediator ....<a href="#page-11">11</a>
           <a href="#section-4.1.1">4.1.1</a>. Template Mapping and Information Element Ordering ..15
      <a href="#section-4.2">4.2</a>. Creating New Templates at an IPFIX Mediator ...............<a href="#page-17">17</a>
      <a href="#section-4.3">4.3</a>. Handling Unknown Information Elements .....................<a href="#page-17">17</a>
   <a href="#section-5">5</a>. Preserving Original Observation Point Information ..............<a href="#page-17">17</a>
      <a href="#section-5.1">5.1</a>. originalExporterIPv4Address Information Element ...........<a href="#page-20">20</a>
      <a href="#section-5.2">5.2</a>. originalExporterIPv6Address Information Element ...........<a href="#page-20">20</a>
   <a href="#section-6">6</a>. Managing Observation Domain IDs ................................<a href="#page-20">20</a>
      <a href="#section-6.1">6.1</a>. originalObservationDomainId Information Element ...........<a href="#page-21">21</a>
   <a href="#section-7">7</a>. Timing Considerations ..........................................<a href="#page-21">21</a>
   <a href="#section-8">8</a>. Transport Considerations .......................................<a href="#page-23">23</a>
   <a href="#section-9">9</a>. Collecting Process Considerations ..............................<a href="#page-23">23</a>
   <a href="#section-10">10</a>. Specific Reporting Requirements ...............................<a href="#page-23">23</a>
      10.1. Intermediate Process Reliability Statistics
            Options Template .........................................<a href="#page-24">24</a>
      <a href="#section-10.2">10.2</a>. Flow Key Options Template ................................<a href="#page-26">26</a>
      <a href="#section-10.3">10.3</a>. intermediateProcessId Information Element ................<a href="#page-26">26</a>
      <a href="#section-10.4">10.4</a>. ignoredDataRecordTotalCount Information Element ..........<a href="#page-27">27</a>
   <a href="#section-11">11</a>. Operations and Management Considerations ......................<a href="#page-27">27</a>
   <a href="#section-12">12</a>. Security Considerations .......................................<a href="#page-28">28</a>
   <a href="#section-13">13</a>. IANA Considerations ...........................................<a href="#page-28">28</a>
   <a href="#section-14">14</a>. Acknowledgments ...............................................<a href="#page-29">29</a>
   <a href="#section-15">15</a>. References ....................................................<a href="#page-29">29</a>
      <a href="#section-15.1">15.1</a>. Normative References .....................................<a href="#page-29">29</a>
      <a href="#section-15.2">15.2</a>. Informative References ...................................<a href="#page-30">30</a>

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   The IPFIX architectural components in [<a href="rfc5470.html" title='"Architecture for IP Flow Information Export"'>RFC5470</a>] consist of IPFIX
   Devices and IPFIX Collectors communicating using the IPFIX protocol
   [<a href="rfc7011.html" title='"Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of Flow Information"'>RFC7011</a>], which specifies how to export IP Flow information.  This
   protocol is designed to export information about IP traffic Flows and
   related measurement data, where a Flow is defined by a set of key
   attributes (e.g., source and destination IP address, source and
   destination port, etc.).

   However, thanks to its Template mechanism, the IPFIX protocol can
   export any type of information, as long as the relevant Information
   Element is specified in the IPFIX Information Model [<a href="rfc7012.html" title='"Information Model for IP Flow Information Export (IPFIX)"'>RFC7012</a>],



<span class="grey">Claise, et al.               Standards Track                    [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc7119.html">RFC 7119</a>                     IPFIX MED-PROTO               February 2014</span>


   registered with IANA, or specified as an enterprise-specific
   Information Element.  The IPFIX protocol [<a href="rfc7011.html" title='"Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of Flow Information"'>RFC7011</a>] was not originally
   written with IPFIX Mediators in mind.  Therefore, the IPFIX protocol
   must be adapted for Intermediate Processes, as defined in the IPFIX
   Mediation Reference Model as specified in Figure A of [<a href="rfc6183.html" title='"IP Flow Information Export (IPFIX) Mediation: Framework"'>RFC6183</a>],
   which is based on the IPFIX Mediation Problem Statement [<a href="rfc5982.html" title='"IP Flow Information Export (IPFIX) Mediation: Problem Statement"'>RFC5982</a>].

   This document specifies the IP Flow Information Export (IPFIX)
   protocol in the context of the implementation and deployment of IPFIX
   Mediators.  The use of the IPFIX protocol within an IPFIX Mediator --
   a device that contains both a Collecting Process and an Exporting
   Process -- has an impact on the technical details of the usage of the
   protocol.  An overview of the technical problem is covered in
   <a href="rfc5982.html#section-6">Section 6 of [RFC5982]</a>: loss of original Exporter information, loss
   of base time information, transport sessions management, loss of
   Options Template Information, Template Id management, considerations
   for network topology, IPFIX mediation interpretation, and
   considerations for aggregation.

   The specifications in this document are based on the IPFIX protocol
   specifications [<a href="rfc7011.html" title='"Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of Flow Information"'>RFC7011</a>], but they are adapted according to the IPFIX
   Mediation Framework [<a href="rfc6183.html" title='"IP Flow Information Export (IPFIX) Mediation: Framework"'>RFC6183</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.1.%20%20IPFIX%20Documents%20Overview"></a><a class="selflink" href="#section-1.1" name="section-1.1">1.1</a>.  IPFIX Documents Overview</span>

   The IPFIX protocol [<a href="rfc7011.html" title='"Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of Flow Information"'>RFC7011</a>] provides network administrators with
   access to IP Flow information.

   The architecture for the export of measured IP Flow information out
   of an IPFIX Exporting Process to a Collecting Process is defined in
   the IPFIX Architecture [<a href="rfc5470.html" title='"Architecture for IP Flow Information Export"'>RFC5470</a>], per the requirements defined in the
   IPFIX Requirements document, [<a href="rfc3917.html" title='"Requirements for IP Flow Information Export (IPFIX)"'>RFC3917</a>].

   The IPFIX Architecture [<a href="rfc5470.html" title='"Architecture for IP Flow Information Export"'>RFC5470</a>] specifies how IPFIX Data Records and
   Templates are carried via a congestion-aware transport protocol from
   IPFIX Exporting Processes to IPFIX Collecting Processes.

   IPFIX has a formal description of IPFIX Information Elements, their
   names, types, and additional semantic information, as specified in
   the IPFIX Information Model [<a href="rfc7012.html" title='"Information Model for IP Flow Information Export (IPFIX)"'>RFC7012</a>].  The IPFIX Information Element
   registry [<a href="#ref-IANA-IPFIX" title='"IP Flow Information Export (IPFIX) Entities"'>IANA-IPFIX</a>] is maintained by IANA.  New Information Element
   definitions can be added to this registry subject to an Expert Review
   [<a href="rfc5226.html" title='"Guidelines for Writing an IANA Considerations Section in RFCs"'>RFC5226</a>], with additional process considerations described in
   [<a href="rfc7013.html" title='"Guidelines for Authors and Reviewers of IP Flow Information Export (IPFIX) Information Elements"'>RFC7013</a>]; that document also provides guidelines for authors and
   reviewers of new Information Element definitions.  The inline export
   of the Information Element type information is specified in
   [<a href="rfc5610.html" title='"Exporting Type Information for IP Flow Information Export (IPFIX) Information Elements"'>RFC5610</a>].




<span class="grey">Claise, et al.               Standards Track                    [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc7119.html">RFC 7119</a>                     IPFIX MED-PROTO               February 2014</span>


   The IPFIX Applicability Statement [<a href="rfc5472.html" title='"IP Flow Information Export (IPFIX) Applicability"'>RFC5472</a>] describes what type of
   applications can use the IPFIX protocol and how they can use the
   information provided.  It furthermore shows how the IPFIX framework
   relates to other architectures and frameworks.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.2.%20%20IPFIX%20Mediator%20Documents%20Overview"></a><a class="selflink" href="#section-1.2" name="section-1.2">1.2</a>.  IPFIX Mediator Documents Overview</span>

   "IP Flow Information Export (IPFIX) Mediation: Problem Statement"
   [<a href="rfc5982.html" title='"IP Flow Information Export (IPFIX) Mediation: Problem Statement"'>RFC5982</a>] provides an overview of the applicability of IPFIX
   Mediators and defines requirements for IPFIX Mediators in general
   terms.  This document is of use largely to define the problems to be
   solved through the deployment of IPFIX Mediators and to provide scope
   to the role of IPFIX Mediators within an IPFIX collection
   infrastructure.

   "IP Flow Information Export (IPFIX) Mediation: Framework" [<a href="rfc6183.html" title='"IP Flow Information Export (IPFIX) Mediation: Framework"'>RFC6183</a>],
   which details the IPFIX Mediation reference model and the components
   of an IPFIX Mediator, provides more architectural details of the
   arrangement of Intermediate Processes within an IPFIX Mediator.

   Documents specifying the operations of specific Intermediate
   Processes cover the operation of these Processes within the IPFIX
   Mediator framework and comply with the specifications given in this
   document; additionally, they may specify the operation of the process
   independently, outside the context of an IPFIX Mediator, when this is
   appropriate.  The details of specific Intermediate Processes, when
   they have additional export specifications (e.g., metadata about the
   intermediate processing conveyed through IPFIX Options Templates),
   are each addressed in their own document.  As of today, these
   documents are:

   1.  "IP Flow Anonymization Support", [<a href="rfc6235.html" title='"IP Flow Anonymization Support"'>RFC6235</a>], which describes
       anonymization techniques for IP flow data and the export of
       anonymized data using the IPFIX protocol.

   2.  "Flow Selection Techniques" [<a href="rfc7014.html" title='"Flow Selection Techniques"'>RFC7014</a>], which describes the
       process of selecting a subset of Flows from all Flows observed at
       an Observation Point, the flow selection motivations, and some
       specific flow selection techniques.

   3.  "Flow Aggregation for the IP Flow Information Export (IPFIX)
       Protocol" [<a href="rfc7015.html" title='"Flow Aggregation for the IP Flow Information Export (IPFIX) Protocol"'>RFC7015</a>], which describes Aggregated Flow export
       within the framework of IPFIX Mediators and defines an
       interoperable, implementation-independent method for Aggregated
       Flow export.






<span class="grey">Claise, et al.               Standards Track                    [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc7119.html">RFC 7119</a>                     IPFIX MED-PROTO               February 2014</span>


   This document specifies the IP Flow Information Export (IPFIX)
   protocol specific to Mediation, to which all Intermediate Processes
   must comply.  Some extra specifications might be required per
   Intermediate Process type (in which case, the document specific to
   the Intermediate Process would apply).

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.3.%20%20Relationship%20with%20the%20IPFIX%20and%20PSAMP%20Protocols"></a><a class="selflink" href="#section-1.3" name="section-1.3">1.3</a>.  Relationship with the IPFIX and PSAMP Protocols</span>

   The specification in this document is based on the IPFIX protocol
   specification [<a href="rfc7011.html" title='"Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of Flow Information"'>RFC7011</a>].  All specifications from [<a href="rfc7011.html" title='"Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of Flow Information"'>RFC7011</a>] apply
   unless specified otherwise in this document.

   As the Packet Sampling (PSAMP) protocol specifications [<a href="rfc5476.html" title='"Packet Sampling (PSAMP) Protocol Specifications"'>RFC5476</a>] are
   based on the IPFIX protocol specifications, the specifications in
   this document are also valid for the PSAMP protocol.  Therefore, the
   method specified by this document also applies to PSAMP.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Terminology"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Terminology</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in
   [<a href="rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].

   IPFIX-specific terms, such as Observation Domain, Flow, Flow Key,
   Metering Process, Exporting Process, Exporter, IPFIX Device,
   Collecting Process, Collector, Template, IPFIX Message, Message
   Header, Template Record, Data Record, Options Template Record, Set,
   Data Set, Information Element, Scope and Transport Session, used in
   this document are defined in [<a href="rfc7011.html" title='"Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of Flow Information"'>RFC7011</a>].  The PSAMP-specific terms
   used in this document, such as Filtering and Sampling, are defined in
   [<a href="rfc5476.html" title='"Packet Sampling (PSAMP) Protocol Specifications"'>RFC5476</a>].

   IPFIX Mediation terms related to aggregation, such as the Interval,
   Aggregated Flow and Aggregated Function, are defined in [<a href="rfc7015.html" title='"Flow Aggregation for the IP Flow Information Export (IPFIX) Protocol"'>RFC7015</a>].

   The terminology specific to IPFIX Mediation that is used in this
   document is defined in "IP Flow Information Export (IPFIX) Mediation:
   Problem Statement" [<a href="rfc5982.html" title='"IP Flow Information Export (IPFIX) Mediation: Problem Statement"'>RFC5982</a>] and reused in "IP Flow Information
   Export (IPFIX) Mediation: Framework" [<a href="rfc6183.html" title='"IP Flow Information Export (IPFIX) Mediation: Framework"'>RFC6183</a>].  However, since both
   of those documents are Informational RFCs, the definitions have been
   reproduced and elaborated on here.

   Similarly, since [<a href="rfc6235.html" title='"IP Flow Anonymization Support"'>RFC6235</a>] is an Experimental RFC, the Anonymization
   Record, Anonymized Data Record, and Intermediate Anonymization
   Process terms, specified in [<a href="rfc6235.html" title='"IP Flow Anonymization Support"'>RFC6235</a>], are also reproduced here.





<span class="grey">Claise, et al.               Standards Track                    [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc7119.html">RFC 7119</a>                     IPFIX MED-PROTO               February 2014</span>


   In this document, as in [<a href="rfc7011.html" title='"Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of Flow Information"'>RFC7011</a>], [<a href="rfc5476.html" title='"Packet Sampling (PSAMP) Protocol Specifications"'>RFC5476</a>], [<a href="rfc7015.html" title='"Flow Aggregation for the IP Flow Information Export (IPFIX) Protocol"'>RFC7015</a>], and
   [<a href="rfc6235.html" title='"IP Flow Anonymization Support"'>RFC6235</a>], the first letter of each IPFIX-specific and PSAMP-specific
   term is capitalized along with the IPFIX Mediation-specific term
   defined here.

   In this document, we call a stream of records carrying flow- or
   packet-based information a "record stream".  The records may be
   encoded as IPFIX Data Records or any other format.

   Transport Session:   The Transport Session is specified in [<a href="rfc7011.html" title='"Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of Flow Information"'>RFC7011</a>].
      In Stream Control Transmission Protocol (SCTP), the Transport
      Session information is the SCTP association.  In TCP and UDP, the
      Transport Session information corresponds to a 5-tuple {Exporter
      IP address, Collector IP address, Exporter transport port,
      Collector transport port, transport protocol}.

   Original Exporter:   An Original Exporter is the source from which a
      Mediator receives its record stream.  For simple IPFIX mediation
      without protocol conversion, this is an IPFIX Device that hosts
      the Observation Points where the metered IP packets are observed.

   Original Observation Point:   An Observation Point on a Metering
      Process associated with the Original Exporter.  In the case of the
      Intermediate Aggregation Process on an IPFIX Mediator, the
      Original Observation Point can be composed of, but not limited to,
      a (set of) specific Exporter(s), a (set of) specific interface(s)
      on an Exporter, a (set of) line card(s) on an Exporter, or any
      combinations of these.

   IPFIX Mediation:   IPFIX Mediation is the manipulation and conversion
      of a record stream for subsequent export using the IPFIX protocol.

   Template Mapping:   A mapping from Template Records and/or Options
      Template Records received by an IPFIX Mediator to Template Records
      and/or Options Template Records sent by that IPFIX Mediator.  Each
      entry in a Template Mapping is scoped by incoming or outgoing
      Transport Session and Observation Domain, as with Templates and
      Options Templates in the IPFIX Protocol.

   Anonymization Record:   A record that defines the properties of the
      anonymization applied to a single Information Element within a
      single Template or Options Template, as in [<a href="rfc6235.html" title='"IP Flow Anonymization Support"'>RFC6235</a>].

   Anonymized Data Record:   A Data Record within a Data Set containing
      at least one Information Element with anonymized values.  The
      Information Element(s) within the Template or Options Template
      describing this Data Record SHOULD have a corresponding
      Anonymization Record, as in [<a href="rfc6235.html" title='"IP Flow Anonymization Support"'>RFC6235</a>].



<span class="grey">Claise, et al.               Standards Track                    [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc7119.html">RFC 7119</a>                     IPFIX MED-PROTO               February 2014</span>


   The following terms are used in this document to describe the
   architectural entities used by IPFIX Mediation.

   Intermediate Process:   An Intermediate Process takes a record stream
      as its input from Collecting Processes, Metering Processes, IPFIX
      File Readers, other Intermediate Processes, or other record
      sources; performs some transformations on this stream, based upon
      the content of each record, states maintained across multiple
      records, or other data sources; and passes the transformed record
      stream as its output to Exporting Processes, IPFIX File Writers,
      or other Intermediate Processes, in order to perform IPFIX
      Mediation.  Typically, an Intermediate Process is hosted by an
      IPFIX Mediator.  Alternatively, an Intermediate Process may be
      hosted by an Original Exporter.

   IPFIX Mediator:   An IPFIX Mediator is an IPFIX Device that provides
      IPFIX Mediation by receiving a record stream from some data
      sources, hosting one or more Intermediate Processes to transform
      that stream, and exporting the transformed record stream into
      IPFIX Messages via an Exporting Process.  In the common case, an
      IPFIX Mediator receives a record stream from a Collecting Process,
      but it could also receive a record stream from data sources not
      encoded using IPFIX, e.g., in the case of conversion from the
      NetFlow V9 protocol [<a href="rfc3954.html" title='"Cisco Systems NetFlow Services Export Version 9"'>RFC3954</a>] to IPFIX protocol.

   Specific Intermediate Processes are described below.

   Intermediate Conversion Process  (as in [<a href="rfc6183.html" title='"IP Flow Information Export (IPFIX) Mediation: Framework"'>RFC6183</a>]): An Intermediate
      Conversion Process is an Intermediate Process that transforms non-
      IPFIX into IPFIX or manages the relation among Templates and
      states of incoming/outgoing Transport Sessions in the case of
      transport protocol conversion (e.g., from UDP to SCTP).

   Intermediate Aggregation Process  (as in [<a href="rfc7015.html" title='"Flow Aggregation for the IP Flow Information Export (IPFIX) Protocol"'>RFC7015</a>]): an Intermediate
      Process (IAP), as in [<a href="rfc6183.html" title='"IP Flow Information Export (IPFIX) Mediation: Framework"'>RFC6183</a>], that aggregates records, based
      upon a set of Flow Keys or functions applied to fields from the
      record.

   Intermediate Correlation Process  (as in [<a href="rfc6183.html" title='"IP Flow Information Export (IPFIX) Mediation: Framework"'>RFC6183</a>]): An Intermediate
      Correlation Process is an Intermediate Process that adds
      information to records, noting correlations among them, or
      generates new records with correlated data from multiple records
      (e.g., the production of bidirectional flow records from
      unidirectional flow records).

   Intermediate Anonymization Process  (as in [<a href="rfc6235.html" title='"IP Flow Anonymization Support"'>RFC6235</a>]): An
      intermediate process that takes Data Records and transforms them
      into Anonymized Data Records.



<span class="grey">Claise, et al.               Standards Track                    [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc7119.html">RFC 7119</a>                     IPFIX MED-PROTO               February 2014</span>


   Intermediate Selection Process  (as in [<a href="rfc6183.html" title='"IP Flow Information Export (IPFIX) Mediation: Framework"'>RFC6183</a>]): An Intermediate
      Selection Process is an Intermediate Process that selects records
      from a sequence based upon criteria-evaluated record values and
      passes only those records that match the criteria (e.g., Filtering
      only records from a given network to a given Collector).

   Intermediate Flow Selection Process  (as in [<a href="rfc7014.html" title='"Flow Selection Techniques"'>RFC7014</a>]: An
      Intermediate Flow Selection Process is an Intermediate Process, as
      in [<a href="rfc6183.html" title='"IP Flow Information Export (IPFIX) Mediation: Framework"'>RFC6183</a>] that takes Flow Records as its input and selects a
      subset of this set as its output.  The Intermediate Flow Selection
      Process is a more general concept than the Intermediate Selection
      Process as defined in [<a href="rfc6183.html" title='"IP Flow Information Export (IPFIX) Mediation: Framework"'>RFC6183</a>].  While an Intermediate Selection
      Process selects Flow Records from a sequence based upon criteria-
      evaluated Flow record values and only passes on those Flow Records
      that match the criteria, an Intermediate Flow Selection Process
      selects Flow Records using selection criteria applicable to a
      larger set of Flow characteristics and information.

      Note: for more information on the difference between Intermediate
      Flow Selection Process and Intermediate Selection Process, see
      <a href="rfc7014.html#section-4">Section 4 in [RFC7014]</a>.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Handling%20IPFIX%20Message%20Headers"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Handling IPFIX Message Headers</span>

   The format of the IPFIX Message Header as exported by an IPFIX
   Mediator is shown in Figure 1.  This is identical to the format
   defined for IPFIX in [<a href="rfc7011.html" title='"Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of Flow Information"'>RFC7011</a>], though Export Time and Observation
   Domain ID may be handled differently at certain Mediators, as noted
   below.

    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |             Version           |            Length             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                           Export Time                         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                       Sequence Number                         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                    Observation Domain ID                      |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                   Figure 1: IPFIX Message Header format








<span class="grey">Claise, et al.               Standards Track                    [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc7119.html">RFC 7119</a>                     IPFIX MED-PROTO               February 2014</span>


   The header fields as exported by an IPFIX Mediator are described
   below.

   Version:

      Version of IPFIX to which this Message conforms.  The value of
      this field is 0x000a for the current version, incrementing by one
      the version used in the NetFlow services export version 9
      [<a href="rfc3954.html" title='"Cisco Systems NetFlow Services Export Version 9"'>RFC3954</a>].

   Length:

      Total length of the IPFIX Message, measured in octets, including
      Message Header and Set(s).

   Export Time:

      Time at which the IPFIX Message Header leaves the IPFIX Mediator,
      expressed in seconds since the UNIX epoch of 1 January 1970 at
      00:00 UTC, encoded as an unsigned 32-bit integer.

      However, in the specific case of an IPFIX Mediator containing an
      Intermediate Conversion Process, the IPFIX Mediator MAY use the
      export time received from the incoming Transport Session.

   Sequence Number:

      Incremental sequence counter modulo 2^32 of all IPFIX Data Records
      sent in the current stream from the current Observation Domain by
      the Exporting Process.  Each SCTP Stream counts sequence numbers
      separately, while all messages in a TCP connection or UDP
      Transport Session are considered to be part of the same stream.
      This value can be used by the Collecting Process to identify
      whether any IPFIX Data Records have been missed.  Template and
      Options Template Records do not increase the Sequence Number.

   Observation Domain ID:

      A 32-bit identifier of the Observation Domain that is locally
      unique to the Exporting Process.  The Exporting Process uses the
      Observation Domain ID to uniquely identify to the Collecting
      Process the Observation Domain that metered the Flows.  It is
      RECOMMENDED that this identifier also be unique per IPFIX Device.
      Collecting Processes can use the Transport Session and the
      Observation Domain ID field to separate different export streams
      originating from the same Exporter.  The Observation Domain ID is
      set to 0 when no specific Observation Domain ID is relevant for




<span class="grey">Claise, et al.               Standards Track                    [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc7119.html">RFC 7119</a>                     IPFIX MED-PROTO               February 2014</span>


      the entire IPFIX Message, for example, when exporting the
      Exporting Process Statistics, or in case of a hierarchy of
      Collectors when aggregated Data Records are exported.

      See <a href="#section-4.1">Section 4.1</a> for special considerations for Observation Domain
      management while passing unmodified templates through an IPFIX
      Mediator, and <a href="#section-5">Section 5</a> for guidelines for preservation of
      original Observation Domain information at an IPFIX Mediator.

   The following specifications, copied over from [<a href="rfc7011.html" title='"Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of Flow Information"'>RFC7011</a>] have some
   implications in this document:

      Template Withdrawals MAY appear interleaved with Template Sets,
      Options Template Sets, and Data Sets within an IPFIX Message.  In
      this case, the Templates and Template Withdrawals shall be
      interpreted as taking effect in the order in which they appear in
      the IPFIX Message.

   If an IPFIX Mediator receives an IPFIX Message composed of Template
   Withdrawals and Template Sets, and if the IPFIX Mediator forwards
   this IPFIX Message, it MUST NOT modify the Set order.  If an IPFIX
   Mediator receives IPFIX Messages composed of Template Withdrawals and
   Template Sets, and if the IPFIX Mediator forwards these IPFIX
   Messages, it MUST NOT modify the IPFIX Message order.  Note that the
   Template Mapping (see <a href="#section-4.1">Section 4.1</a>) is the authoritative source of
   information on the IPFIX Mediator to decide whether the entire IPFIX
   Messages can be forwarded as such.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Template%20Management"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Template Management</span>

   How an IPFIX Mediator handles the Templates it receives from the
   Original Exporter depends entirely on the nature of the Intermediate
   Process running on that IPFIX Mediator.  There are two cases here:

   1.  IPFIX Mediators that pass substantially the same Data Records
       from the Original Exporter downstream (e.g., an Intermediate
       Selection Process), pass unmodified Templates as described in
       <a href="#section-4.1">Section 4.1</a>; this section describes a Template Mapping required
       to make this work in the general case, and the correlation
       between the received and generated IPFIX Message Withdrawals.

   2.  IPFIX Mediators that export Data Records that are substantially
       changed from the Data Records received from the Original Exporter
       follow the guidelines in <a href="#section-4.2">Section 4.2</a> instead: in this case, the
       IPFIX Mediator generates new (Options) Template Records as a
       result of the Intermediate Process, and no Template Mapping is
       required.




<span class="grey">Claise, et al.               Standards Track                   [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc7119.html">RFC 7119</a>                     IPFIX MED-PROTO               February 2014</span>


   Subsequent subsections deal with specific issues in Template
   management that may occur at IPFIX Mediators.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.1.%20%20Passing%20Unmodified%20Templates%20through%20an%20IPFIX%20Mediator"></a><a class="selflink" href="#section-4.1" name="section-4.1">4.1</a>.  Passing Unmodified Templates through an IPFIX Mediator</span>

   For some Intermediate Processes, the IPFIX Mediator doesn't modify
   the (Options) Template Record(s) content.  A typical example is an
   Intermediate Flow Selection Process acting as distributor, which
   collects Flow Records from one or more Exporters, and based on the
   content of the Information Elements, redirects the Flow Records to
   the appropriate Collector.  This example is a typical case of a
   single network operation center managing multiple universities: a
   unique IPFIX Collector collects all Flow Records for the common
   infrastructure, but might be re-exporting specific university Flow
   Records to the responsible system administrator.

   As specified in [<a href="rfc7011.html" title='"Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of Flow Information"'>RFC7011</a>], the Template IDs are unique per Exporter,
   per Transport Session, and per Observation Domain.  As there is no
   guarantee that, for similar Template Records, the Template IDs
   received on the incoming Transport Session and exported to the
   outgoing Transport Session would be same, the IPFIX Mediator MUST
   maintain a Template Mapping composed of related received and exported
   (Options) Template Records:

   o  for each received (Options) Template Record: Template Record
      Information Elements, Template ID, Observation Domain ID, and
      Transport Session information, metadata scoped to the Template (*)

   o  for each exported (Options) Template Record: Template Record
      Information Elements, Template ID, Collector, Observation Domain
      ID, and Transport Session information metadata scoped to the
      Template (*)

   (*) The "metadata scoped to the Template" encompasses the metadata,
   that are scoped to the Template, and that help to determine the
   semantics of the Template Record.  Note that these metadata are
   typically sent in Data Records described by an Options Template.  An
   example is the flowKeyIndicator.  An IPFIX Mediator could potentially
   receive two different Template IDs, from the same Exporter, with the
   same Information Elements, but with a different set of Flow Keys
   (indicated by the flowKeyIndicator in an Options Template Record).
   Another example is the combination of anonymizationFlags and
   anonymizationTechnique [<a href="rfc6235.html" title='"IP Flow Anonymization Support"'>RFC6235</a>]).  This metadata information must be
   present in the Template Mapping, to stress that the two Template
   Record semantics are different.






<span class="grey">Claise, et al.               Standards Track                   [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc7119.html">RFC 7119</a>                     IPFIX MED-PROTO               February 2014</span>


   If an IPFIX Mediator receives an IPFIX Withdrawal Message for a
   (Options) Template Record that is not used anymore in any other
   Template Mappings, the IPFIX Mediator SHOULD export the appropriate
   IPFIX Withdrawal Message(s) on the outgoing Transport Session and
   remove the corresponding entry in the Template Mapping.

   If a (Options) Template Record is not used anymore in an outgoing
   Transport Session, it MUST be withdrawn with an IPFIX Template
   Withdrawal Message on that specific outgoing Transport Session, and
   its entry, MUST be removed from the Template Mapping.

   If an incoming or outgoing Transport Session is gracefully shut down
   or reset, the (Options) Template Records corresponding to that
   Transport Session MUST be removed from the Template Mapping.

   For example, Figure 2 displays an example of an Intermediate Flow
   Selection Process, redistributing Data Records to Collectors on the
   basis of customer networks, i.e., the Route Distinguisher (RD).  In
   this example, the Template Record received from the Exporter #1 is
   reused towards Collector #1, Collector #2, and Collector #3, for the
   customer #1, customer #2, and customer #3, respectively.  In this
   example, the outgoing Template Records exported to the different
   Collectors are identical.  As a reminder that the Template ID
   uniqueness is local to the Transport Session and Observation Domain
   that generated the Template ID, a mix of Template ID 256 and 257 has
   been used.

























<span class="grey">Claise, et al.               Standards Track                   [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc7119.html">RFC 7119</a>                     IPFIX MED-PROTO               February 2014</span>


                                               .---------.
                                   Tmpl.       |         |
                                   ID    .----&gt;|Collector|&lt;==&gt;Customer 1
                                   256   |     |   #1    |
                                         |     |         |
                                      RD=100:1 '---------'
         .--------.        .--------.    |
         |        | Tmpl.  |        |----'
         |        | Id     |        |          .---------.
         |        | 258    |        | RD=100:2 |         |
         | IPFIX  |-------&gt;| IPFIX  |---------&gt;|Collector|&lt;==&gt;Customer 2
         |Exporter|        |Mediator| Tmpl.    |   #2    |
         |   #1   |        |        | ID 257   |         |
         |        |        |        |          '---------'
         |        |        |        |----.
         '--------'        '--------'    |
                                      RD=100:3
                                         |     .---------.
                                   Tmpl. |     |         |
                                   ID    '----&gt;|Collector|&lt;==&gt;Customer 3
                                   257         |   #3    |
                                               |         |
                                               '---------'

           Figure 2: Intermediate Flow Selection Process Example

   Figure 3 shows the Template Mapping for the system shown in Figure 2.
























<span class="grey">Claise, et al.               Standards Track                   [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc7119.html">RFC 7119</a>                     IPFIX MED-PROTO               February 2014</span>


   +-----------------------------------------------------------------+
   | Template Entry A:                                               |
   | Incoming Transport Session information (from Exporter#1):       |
   |   Source IP: &lt;Exporter#1 export IP address&gt;                     |
   |   Destination IP: &lt;IPFIX Mediator IP address&gt;                   |
   |   Protocol: SCTP                                                |
   |   Source Port: &lt;source port&gt;                                    |
   |   Destination Port: 4739 (IPFIX)                                |
   | Observation Domain ID: &lt;Observation Domain ID&gt;                  |
   | Template ID: 258                                                |
   | Metadata scoped to the Template : &lt;not applicable in this case&gt; |
   |                                                                 |
   | Template Entry B:                                               |
   | Outgoing Transport Session information (to Collector#1):        |
   |   Source IP: &lt;IPFIX Mediator IP address&gt;                        |
   |   Destination IP: &lt;IPFIX Collector#1 IP address&gt;                |
   |   Protocol: SCTP                                                |
   |   Source Port: &lt;source port&gt;                                    |
   |   Destination Port: 4739 (IPFIX)                                |
   | Observation Domain ID: &lt;Observation Domain ID&gt;                  |
   | Template ID: 256                                                |
   | Metadata scoped to the Template : &lt;not applicable in this case&gt; |
   |                                                                 |
   | Template Entry C:                                               |
   | Outgoing Transport Session information (to Collector#2):        |
   |   Source IP: &lt;IPFIX Mediator IP address&gt;                        |
   |   Destination IP: &lt;IPFIX Collector#2 IP address&gt;                |
   |   Protocol: SCTP                                                |
   |   Source Port: &lt;source port&gt;                                    |
   |   Destination Port: 4739 (IPFIX)                                |
   | Observation Domain ID: &lt;Observation Domain ID&gt;                  |
   | Template ID: 257                                                |
   | Metadata scoped to the Template : &lt;not applicable in this case&gt; |
   |                                                                 |
   | Template Entry D:                                               |
   | Outgoing Transport Session information (to Collector#3):        |
   |   Source IP: &lt;IPFIX Mediator IP address&gt;                        |
   |   Destination IP: &lt;IPFIX Collector#3 IP address&gt;                |
   |   Protocol: SCTP                                                |
   |   Source Port: &lt;source port&gt;                                    |
   |   Destination Port: 4739 (IPFIX)                                |
   | Observation Domain ID: &lt;Observation Domain ID&gt;                  |
   | Template ID: 257                                                |
   | Metadata scoped to the Template : &lt;not applicable in this case&gt; |
   +-----------------------------------------------------------------+

               Figure 3: Template Mapping Example: Templates




<span class="grey">Claise, et al.               Standards Track                   [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc7119.html">RFC 7119</a>                     IPFIX MED-PROTO               February 2014</span>


   The Template Mapping corresponding to Figure 3 is displayed in
   Figure 4:

   Template Entry A   &lt;----&gt; Template Entry B
   Template Entry A   &lt;----&gt; Template Entry C
   Template Entry A   &lt;----&gt; Template Entry D

               Figure 4: Template Mapping Example: Mappings

   Alternatively, the Template Mapping may be optimized as in Figure 5:

                         +--&gt; Template Entry B
                         |
   Template Entry A   &lt;--+--&gt; Template Entry C
                         |
                         +--&gt; Template Entry D

              Figure 5: Template Mapping Example 2: Mappings

   Note that all examples use Transport Sessions based on the SCTP, as
   simplified use cases.  However, the transport protocol would be
   important in situations such as an Intermediate Conversion Process
   doing transport protocol conversion.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/4.1.1.%20%20Template%20Mapping%20and%20Information%20Element%20Ordering"></a><a class="selflink" href="#section-4.1.1" name="section-4.1.1">4.1.1</a>.  Template Mapping and Information Element Ordering</span>

   In the situation where Original Exporters each export an (Options)
   Template Record to a single IPFIX Mediator, and the (Options)
   Template Record contains the same Information Elements, but in
   different order, should the IPFIX Mediator maintain a Template
   Mapping with a single Export Template Record (see Figure 6) or should
   the IPFIX Mediator maintain multiple independent Template Records
   (see Figure 7) before re-exporting to the Collector?

           Template Entry A   &lt;--+
                                 |
           Template Entry B   &lt;--+--&gt; Template Entry D
                                 |
           Template Entry C   &lt;--+

                 Figure 6: Template Mapping and Ordering:
                      A single Export Template Record









<span class="grey">Claise, et al.               Standards Track                   [Page 15]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc7119.html">RFC 7119</a>                     IPFIX MED-PROTO               February 2014</span>


           Template Entry A   &lt;--+--&gt; Template Entry D

           Template Entry B   &lt;--+--&gt; Template Entry E

           Template Entry C   &lt;--+--&gt; Template Entry F

                 Figure 7: Template Mapping and Ordering:
                     Multiple Export Template Records

   The answer depends on whether the order of the Information Elements
   implies some specific semantic.  One of the guiding principles in
   IPFIX protocol specifications is that the semantic meaning of one
   Information Element doesn't depend on the value of any other
   Information Element.  However, there is one noticeable exception, as
   mentioned in [<a href="rfc7011.html" title='"Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of Flow Information"'>RFC7011</a>]:

      Multiple Scope Fields MAY be present in the Options Template
      Record, in which case the composite scope is the combination of
      the scopes.  For example, if the two scopes are meteringProcessId
      and templateId, the combined scope is this Template for this
      Metering Process.  If a different order of Scope Fields would
      result in a Record having a different semantic meaning, then the
      order of Scope Fields MUST be preserved by the Exporting Process.
      For example, in the context of PSAMP [<a href="rfc5476.html" title='"Packet Sampling (PSAMP) Protocol Specifications"'>RFC5476</a>], if the first scope
      defines the filtering function, while the second scope defines the
      sampling function, the order of the scope is important.  Applying
      the sampling function first, followed by the filtering function,
      would lead to potentially different Data Records than applying the
      filtering function first, followed by the sampling function.

   If an IPFIX Mediator receives, from multiple Exporters, Template
   Records with identical Information Elements, but ordered differently,
   it SHOULD consider those Template Records as identical, subject to
   metadata information in the associated Options Template (for example,
   the Flow Key Options Template, see <a href="#section-10.2">Section 10.2</a>).

   If an IPFIX Mediator receives, from multiple Exporters, Options
   Template Records with identical and ordered Information Elements in
   the Scope fields, and with identical Information Elements, but
   ordered differently, in the non-Scope fields, it SHOULD consider
   those Template Records as identical.

   If an IPFIX Mediator receives, from multiple Exporters, Options
   Template Records with identical Information Elements in the Scope
   field, but ones that are ordered differently, it MUST consider those
   Template Records as semantically different.





<span class="grey">Claise, et al.               Standards Track                   [Page 16]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc7119.html">RFC 7119</a>                     IPFIX MED-PROTO               February 2014</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.2.%20%20Creating%20New%20Templates%20at%20an%20IPFIX%20Mediator"></a><a class="selflink" href="#section-4.2" name="section-4.2">4.2</a>.  Creating New Templates at an IPFIX Mediator</span>

   For other Intermediate Processes, the IPFIX Mediator generates new
   (Options) Template Records as a result of the Intermediate Process.

   In these cases, the IPFIX Mediator doesn't need to maintain a
   Template Mapping, as it generates its own series of (Options)
   Template Records.  However, some special cases might still require a
   Template Mapping.  Consider a situation where the IPFIX Mediator
   generates new (Options) Template Records based on what it receives
   from the Exporter(s) based on the Intermediate Process function: for
   example, an Intermediate Anonymization process that performs black-
   marker anonymization [<a href="rfc6235.html" title='"IP Flow Anonymization Support"'>RFC6235</a>] on certain Information Elements.  In
   such cases, it's important to keep the correlation between the
   received (Options) Template Records and derived (Options) Template
   Records in the Template Mapping.  These Template Mappings would be
   kept as in <a href="#section-4.1">Section 4.1</a>, except that the exported Template would not
   be identical to the received Template.

   Similar to Exporting Processes in any Exporter, an IPFIX Mediator may
   use the technique for reducing redundancy in IPFIX described in
   [<a href="rfc5473.html" title='"Reducing Redundancy in IP Flow Information Export (IPFIX) and Packet Sampling (PSAMP) Reports"'>RFC5473</a>].

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.3.%20%20Handling%20Unknown%20Information%20Elements"></a><a class="selflink" href="#section-4.3" name="section-4.3">4.3</a>.  Handling Unknown Information Elements</span>

   Depending on application requirements, Mediators that do not generate
   new Records SHOULD re-export values for unknown Information Elements,
   for which the Mediator does not have information about Information
   Element data type and semantics.  However, as there may be presence
   or ordering dependencies among the unknown Information Elements, the
   Mediator MUST NOT omit fields from such re-exported Records or
   reorder any fields within the Records.

   Mediators that generate new Records, as in <a href="#section-4.2">Section 4.2</a>, MUST ignore
   values of Information Elements they do not understand.  If a Mediator
   passes values of Information Elements it does not understand (for
   example, when re-exporting Flow Records), it MUST pass them in the
   order in which they were originally received.

   In any case, Mediators handling unknown Information Elements SHOULD
   log this fact, as it is likely that mediation of records containing
   unknown values will have unintended consequences.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Preserving%20Original%20Observation%20Point%20Information"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Preserving Original Observation Point Information</span>

   Depending on the use case, the Collector in an Exporter/IPFIX
   Mediator/Collector structure (for example, tiered Mediators) may need
   to receive information about the Original Observation Point(s);



<span class="grey">Claise, et al.               Standards Track                   [Page 17]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc7119.html">RFC 7119</a>                     IPFIX MED-PROTO               February 2014</span>


   otherwise, it may wrongly conclude that the IPFIX Device exporting
   the Flow Records, i.e., the IPFIX Mediator, directly observed the
   packets that generated the Flow Records.  Two new Information
   Elements are introduced to address this use case:
   originalExporterIPv4Address and originalExporterIPv6Address.
   Practically, the Original Exporters will not be exporting these
   Information Elements.  Therefore, the Intermediate Process will
   report the Original Observation Point(s) to the best of its
   knowledge.  Note that the Configuration Data Model for IPFIX and
   PSAMP [<a href="rfc6728.html" title='"Configuration Data Model for the IP Flow Information Export (IPFIX) and Packet Sampling (PSAMP) Protocols"'>RFC6728</a>] may report the Original Exporter information out of
   band.

   In the IPFIX Mediator, the Observation Point(s) may be represented
   by:

   o  A single Original Exporter (represented by the
      originalExporterIPv4Address or originalExporterIPv6Address
      Information Elements).

   o  A list of Original Exporters (represented by a list of
      originalExporterIPv4Address or originalExporterIPv6Address
      Information Elements).

   o  Any combination or list of Information Elements representing
      Observation Points.  For example:

      *  A list of Original Exporter interfaces (represented by the
         originalExporterIPv4Address or originalExporterIPv6Address, the
         ingressInterface, and/or egressInterface Information Elements,
         respectively).

      *  A list of Original Exporter line card (represented by the
         originalExporterIPv4Address, originalExporterIPv6Address, or
         lineCardId Information Elements, respectively).

   Some Information Elements characterizing the Observation Point may be
   added.  For example, the flowDirection Information Element specifies
   the direction of the observation, and, as such, characterizes the
   Observation Point.

   Any combination of the above representations is possible.  An example
   of an Original Observation Point for an Intermediate Aggregation
   Process is displayed in Figure 8.








<span class="grey">Claise, et al.               Standards Track                   [Page 18]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-19" id="page-19" name="page-19"> </a>
<span class="grey"><a href="rfc7119.html">RFC 7119</a>                     IPFIX MED-PROTO               February 2014</span>


   exporterIPv4Address 192.0.2.1
   exporterIPv4Address 192.0.2.2,
     interface ethernet 0, direction ingress
     interface ethernet 1, direction ingress
     interface serial 1, direction egress
     interface serial 2, direction egress
   exporterIPv4Address 192.0.2.3,
     lineCardId 1, direction ingress

          Figure 8: Complex Observation Point Definition Example

   A Mediator MAY export such complex Original Observation Point
   information, depending on application requirements.  If such
   information is exported, the Mediator MUST use [<a href="rfc6313.html" title='"Export of Structured Data in IP Flow Information Export (IPFIX)"'>RFC6313</a>] to do so, as
   described below.

   The most generic way to export the Original Observation Point is to
   use a subTemplateMultiList, with the semantic "exactlyOneOf".  Taking
   the previous example, the encoding in Figure 9 can be used.

   Template Record 257: exporterIPv4Address
   Template Record 258: exporterIPv4Address,
                        basicList of ingressInterface, flowDirection
   Template Record 259: exporterIPv4Address, lineCardId, flowDirection

     Figure 9: Complex Observation Point Definition Example: Templates

   The Original Observation Point is modeled with the Data Records
   corresponding to either Template Record 1, Template Record 2, or
   Template Record 3 but not more than one of these ("exactlyOneOf"
   semantic).  This implies that the Flow was observed at exactly one of
   the Observation Points reported.

   When an IPFIX Mediator receives Flow Records containing the Original
   Observation Point Information Element, i.e.,
   originalExporterIPv4Address or originalExporterIPv6Address, the IPFIX
   Mediator SHOULD NOT modify its value(s) when composing new Flow
   Records in the general case.  Known exceptions include anonymization
   per <a href="rfc6235.html#section-7.2.4">Section 7.2.4 of [RFC6235]</a> and an Intermediate Correlation
   Process rewriting addresses across NAT.  In other words, the Original
   Observation Point should not be replaced with the IPFIX Mediator
   Observation Point.  The daisy chain of (Exporter, Observation Point)
   representing the path the Flow Records took from the Exporter to the
   top Collector in the Exporter/IPFIX Mediator(s)/Collector structure
   model is out of the scope of this specification.






<span class="grey">Claise, et al.               Standards Track                   [Page 19]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-20" id="page-20" name="page-20"> </a>
<span class="grey"><a href="rfc7119.html">RFC 7119</a>                     IPFIX MED-PROTO               February 2014</span>


   The following subsections describe Information Elements for reporting
   Original Exporter addresses as seen by the Collecting Process; note
   they may be subject to network address translation upstream; see
   [<a href="#ref-NAT-LOGGING" title='"IPFIX Information Elements for logging NAT Events"'>NAT-LOGGING</a>] for more on logging in this situation.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.1.%20%20originalExporterIPv4Address%20Information%20Element"></a><a class="selflink" href="#section-5.1" name="section-5.1">5.1</a>.  originalExporterIPv4Address Information Element</span>

   Name:   originalExporterIPv4Address

   Description:   The IPv4 address used by the Exporting Process on an
      Original Exporter, as seen by the Collecting Process on an IPFIX
      Mediator.  Used to provide information about the Original
      Observation Points to a downstream Collector.

   Data Type:   ipv4Address

   ElementId:   403

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.2.%20%20originalExporterIPv6Address%20Information%20Element"></a><a class="selflink" href="#section-5.2" name="section-5.2">5.2</a>.  originalExporterIPv6Address Information Element</span>

   Name:   originalExporterIPv6Address

   Description:   The IPv6 address used by the Exporting Process on an
      Original Exporter, as seen by the Collecting Process on an IPFIX
      Mediator.  Used to provide information about the Original
      Observation Points to a downstream Collector.

   Data Type:   ipv6Address

   ElementId:   404

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20Managing%20Observation%20Domain%20IDs"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  Managing Observation Domain IDs</span>

   The Observation Domain ID of any IPFIX Message containing Flow
   Records relevant to no particular Observation Domain, or to multiple
   Observation Domains, MUST have an Observation Domain ID of 0.

   IPFIX Mediators that do not change (Options) Template Records MUST
   maintain a Template Mapping, as detailed in <a href="#section-4.1">Section 4.1</a>, to ensure
   that the combination of Observation Domain IDs and Template IDs do
   not collide on export.

   For IPFIX Mediators that export New (Options) Template Records, as in
   <a href="#section-4.2">Section 4.2</a>, there are two options for Observation Domain ID
   management.  The first and simplest of these is to completely
   decouple exported Observation Domain IDs from received Observation





<span class="grey">Claise, et al.               Standards Track                   [Page 20]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-21" id="page-21" name="page-21"> </a>
<span class="grey"><a href="rfc7119.html">RFC 7119</a>                     IPFIX MED-PROTO               February 2014</span>


   Domain IDs; the IPFIX Mediator, in this case, comprises its own set
   of Observation Domain(s) independent of the Observation Domain(s) of
   the Original Exporters.

   The second option is to provide or maintain a Template Mapping for
   received (Options) Template Records and exported inferred (Options)
   Template Records, along with the appropriate Observation Domain IDs
   per Transport Session, which ensures that the combination of
   Observation Domain IDs and Template IDs do not collide on export.

   In some cases where the IPFIX Message Header can't contain a
   consistent Observation Domain for the entire IPFIX Message, but the
   Flow Records exported from the IPFIX Mediator should contain the
   Observation Domain of the Original Exporter anyway, the (Options)
   Template Record must contain the originalObservationDomainId
   Information Element, specified in <a href="#section-6.1">Section 6.1</a>.  When an IPFIX
   Mediator receives Flow Records containing the
   originalObservationDomainId Information Element, the IPFIX Mediator
   MUST NOT modify its value(s) when composing new Flow Records with the
   originalObservationDomainId Information Element.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/6.1.%20%20originalObservationDomainId%20Information%20Element"></a><a class="selflink" href="#section-6.1" name="section-6.1">6.1</a>.  originalObservationDomainId Information Element</span>

   Name:   originalObservationDomainId

   Description:   The Observation Domain ID reported by the Exporting
      Process on an Original Exporter, as seen by the Collecting Process
      on an IPFIX Mediator.  Used to provide information about the
      Original Observation Domain to a downstream Collector.  When
      cascading through multiple Mediators, this identifies the initial
      Observation Domain in the cascade.

   Data Type:   unsigned32

   Data Type Semantics:   identifier

   ElementId:   405

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20Timing%20Considerations"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  Timing Considerations</span>

   The IPFIX Message Header "Export Time" field is the time in seconds
   since 0000 UTC Jan 1, 1970, at which the IPFIX Message leaves the
   IPFIX Mediator.  However, in the specific case of an IPFIX Mediator
   containing an Intermediate Conversion Process, the IPFIX Mediator MAY
   use the export time received from the incoming Transport Session.






<span class="grey">Claise, et al.               Standards Track                   [Page 21]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-22" id="page-22" name="page-22"> </a>
<span class="grey"><a href="rfc7119.html">RFC 7119</a>                     IPFIX MED-PROTO               February 2014</span>


   It is RECOMMENDED that IPFIX Mediators handle time using absolute
   timestamps (e.g., flowStartSeconds, flowStartMilliseconds, or
   flowStartNanoseconds), which are specified relative to the UNIX epoch
   (00:00 UTC 1 Jan 1970) [<a href="#ref-POSIX.1" title='"IEEE Standard for Information Technology - Portable Operating System Interface"'>POSIX.1</a>], where possible rather than relative
   timestamps (e.g., flowStartSysUpTime or flowStartDeltaMicroseconds),
   which are specified relative to protocol structures such as system
   initialization or message export time.

   The latter are difficult to manage for two reasons.  First, they
   require constant translation, as the system initialization time of an
   intermediate system and the export time of an intermediate message
   will change across mediation operations.  Further, relative
   timestamps introduce range problems.  For example, when using the
   flowStartDeltaMicroseconds and flowEndDeltaMicroseconds Information
   Elements [<a href="#ref-IANA-IPFIX" title='"IP Flow Information Export (IPFIX) Entities"'>IANA-IPFIX</a>], the Data Record must be exported within a
   maximum of 71 minutes after its creation.  Otherwise, the 32-bit
   counter would not be sufficient to contain the flow start time
   offset.  Those time constraints might be incompatible with some of
   the application requirements of some Intermediate Processes.

   Intermediate Processes MUST NOT assume that received records appear
   in flowStartTime, flowEndTime, or observationTime order.  An
   Intermediate Process processing timing information (e.g., an
   Intermediate Aggregation Process) MAY ignore records that are
   significantly out of order, in order to meet application-specific
   state and latency requirements, but SHOULD report that records were
   dropped.

   When an Intermediate Process aggregates information from different
   Flow Records, the timestamps on exported records SHOULD be the
   minimum of the start times and the maximum of the end times in the
   general case.  However, if the Flow Records do not overlap, i.e., if
   there is a time gap between the times in the Flow Records, then the
   report may be inaccurate.  The IPFIX Mediator is only reporting what
   it knows, on the basis of the information made available to it, and
   there may not have been any data to observe during the gap.  Then
   again, if there is an overlap in timestamps, there's the potential of
   double-accounting: different Observation Points may have observed the
   same traffic simultaneously.  The specification of the precise rules
   for applying Flow Record timestamps at IPFIX Mediators for all the
   different situations is out of the scope of this document.

   Note that [<a href="rfc7015.html" title='"Flow Aggregation for the IP Flow Information Export (IPFIX) Protocol"'>RFC7015</a>] provides additional specifications for handling
   of timestamps at an Intermediate Aggregation Process.







<span class="grey">Claise, et al.               Standards Track                   [Page 22]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-23" id="page-23" name="page-23"> </a>
<span class="grey"><a href="rfc7119.html">RFC 7119</a>                     IPFIX MED-PROTO               February 2014</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20Transport%20Considerations"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  Transport Considerations</span>

   SCTP [<a href="rfc4960.html" title='"Stream Control Transmission Protocol"'>RFC4960</a>] using the Partially Reliable SCTP (PR-SCTP) extension
   specified in [<a href="rfc3758.html" title='"Stream Control Transmission Protocol (SCTP) Partial Reliability Extension"'>RFC3758</a>] MUST be implemented by all compliant IPFIX
   Mediator implementations.  TCP [<a href="https://tools.ietf.org/html/rfc0793" title='"Transmission Control Protocol"'>RFC0793</a>] MAY also be implemented by
   implementations compliant with the IPFIX Mediator.  UDP [<a href="https://tools.ietf.org/html/rfc0768" title='"User Datagram Protocol"'>RFC0768</a>] MAY
   also be implemented by compliant IPFIX Mediator implementations.
   Transport-specific considerations for IPFIX Exporters as specified in
   Sections <a href="#section-8.3">8.3</a>, <a href="#section-8.4">8.4</a>, <a href="#section-9.1">9.1</a>, <a href="#section-9.2">9.2</a>, and <a href="#section-10">10</a> of [<a href="rfc7011.html" title='"Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of Flow Information"'>RFC7011</a>] apply to IPFIX
   Mediators as well.

   SCTP SHOULD be used in deployments where IPFIX Mediators and
   Collectors are communicating over links that are susceptible to
   congestion.  SCTP is capable of providing any required degree of
   reliability.  TCP MAY be used in deployments where IPFIX Mediators
   and Collectors communicate over links that are susceptible to
   congestion, but SCTP is preferred due to its ability to limit back
   pressure on Exporters and its message versus stream orientation.  UDP
   MAY be used, although it is not a congestion-aware protocol.
   However, in this case, the IPFIX traffic between IPFIX Mediator and
   Collector MUST run in an environment where IPFIX traffic has been
   provisioned for and/or separated from non-IPFIX traffic, whether
   physically or virtually.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/9.%20%20Collecting%20Process%20Considerations"></a><a class="selflink" href="#section-9" name="section-9">9</a>.  Collecting Process Considerations</span>

   Any Collecting Process compliant with [<a href="rfc7011.html" title='"Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of Flow Information"'>RFC7011</a>] can receive IPFIX
   Messages from an IPFIX Mediator.  If the IPFIX Mediator uses IPFIX
   Structured Data [<a href="rfc6313.html" title='"Export of Structured Data in IP Flow Information Export (IPFIX)"'>RFC6313</a>] to export Original Exporter Information, as
   in <a href="#section-5">Section 5</a>, the Collecting Process MUST support [<a href="rfc6313.html" title='"Export of Structured Data in IP Flow Information Export (IPFIX)"'>RFC6313</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/10.%20%20Specific%20Reporting%20Requirements"></a><a class="selflink" href="#section-10" name="section-10">10</a>.  Specific Reporting Requirements</span>

   IPFIX provides Options Templates for the reporting the reliability of
   processes within the IPFIX Architecture.  As each Mediator includes
   at least one IPFIX Exporting Process, they MAY use the Exporting
   Process Reliability Statistics Options Template, as specified in
   [<a href="rfc7011.html" title='"Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of Flow Information"'>RFC7011</a>].

   Analogous to the Metering Process Reliability Statistics Options
   Template, also specified in [<a href="rfc7011.html" title='"Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of Flow Information"'>RFC7011</a>], Mediators MAY implement the
   Intermediate Process Reliability Statistics Options Template,
   specified in Sections <a href="#section-10.1">10.1</a>, <a href="#section-10.3">10.3</a>, and <a href="#section-10.4">10.4</a> define Information
   Elements used by this Options Template.

   The Flow Keys Options Template, as specified in [<a href="rfc7011.html" title='"Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of Flow Information"'>RFC7011</a>], may
   require special handling at an IPFIX Mediator, as described in
   <a href="#section-10.2">Section 10.2</a>.



<span class="grey">Claise, et al.               Standards Track                   [Page 23]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-24" id="page-24" name="page-24"> </a>
<span class="grey"><a href="rfc7119.html">RFC 7119</a>                     IPFIX MED-PROTO               February 2014</span>


   In addition, each Intermediate Process may have its own specific
   reporting requirements (e.g., Anonymization Records as in [<a href="rfc6235.html" title='"IP Flow Anonymization Support"'>RFC6235</a>],
   or the Aggregation Counter Distribution Options Template as in
   [<a href="rfc7015.html" title='"Flow Aggregation for the IP Flow Information Export (IPFIX) Protocol"'>RFC7015</a>]); these SHOULD be implemented as necessary, as described in
   the specification for each Intermediate Process.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/10.1.%20%20Intermediate%20Process%20Reliability%20Statistics%20Options%20Template"></a><a class="selflink" href="#section-10.1" name="section-10.1">10.1</a>.  Intermediate Process Reliability Statistics Options Template</span>

   The Intermediate Process Statistics Options Template specifies the
   structure of a Data Record for reporting Intermediate Process
   statistics.  It SHOULD contain the following Information Elements;
   the intermediateProcessId Information Element is defined in
   <a href="#section-10.3">Section 10.3</a> and the ignoredDataRecordTotalCount Information Element
   is defined in <a href="#section-10.4">Section 10.4</a>:





































<span class="grey">Claise, et al.               Standards Track                   [Page 24]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-25" id="page-25" name="page-25"> </a>
<span class="grey"><a href="rfc7119.html">RFC 7119</a>                     IPFIX MED-PROTO               February 2014</span>


   +-----------------------------+-------------------------------------+
   | IE                          | Description                         |
   +-----------------------------+-------------------------------------+
   | observationDomainId [scope] | An identifier of the Observation    |
   |                             | Domain (of messages exported by     |
   |                             | this Mediator), locally unique to   |
   |                             | the Intermediate Process, to which  |
   |                             | this statistics record applies.     |
   |                             | ----------------------------------  |
   | intermediateProcessId       | An identifier for the Intermediate  |
   | [scope]                     | Process to which this statistics    |
   |                             | record applies.                     |
   |                             | ----------------------------------  |
   | ignoredDataRecordTotalCount | The total number of Data Records    |
   |                             | received but not processed by the   |
   |                             | Intermediate Process.               |
   |                             | ----------------------------------  |
   | time first record ignored   | The timestamp of the first record   |
   |                             | that was ignored by the             |
   |                             | Intermediate Process.  For Data     |
   |                             | Records containing timestamp        |
   |                             | ranges, this SHOULD be taken from   |
   |                             | the start timestamp of the range;   |
   |                             | for data records containing no      |
   |                             | timing information, this SHOULD be  |
   |                             | taken from the Export Time in the   |
   |                             | message header of the IPFIX Message |
   |                             | that contains it.  For this         |
   |                             | timestamp, any of the following     |
   |                             | timestamp can be used:              |
   |                             | observationTimeSeconds,             |
   |                             | observationTimeMilliseconds,        |
   |                             | observationTimeMicroseconds, or     |
   |                             | observationTimeNanoseconds.         |
   +-----------------------------+-------------------------------------+
















<span class="grey">Claise, et al.               Standards Track                   [Page 25]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-26" id="page-26" name="page-26"> </a>
<span class="grey"><a href="rfc7119.html">RFC 7119</a>                     IPFIX MED-PROTO               February 2014</span>


   +-----------------------------+-------------------------------------+
   | IE                          | Description                         |
   +-----------------------------+-------------------------------------+
   | time last record ignored    | The timestamp of the last record    |
   |                             | that was ignored by the             |
   |                             | Intermediate Process.  For Data     |
   |                             | Records containing timestamp        |
   |                             | ranges, this SHOULD be taken from   |
   |                             | the end timestamp of the range; for |
   |                             | data records containing no timing   |
   |                             | information, this SHOULD be taken   |
   |                             | from the Export Time in the message |
   |                             | header of the containing IPFIX      |
   |                             | Message.  For this timestamp, any   |
   |                             | of the following timestamp can be   |
   |                             | used: observationTimeSeconds,       |
   |                             | observationTimeMilliseconds,        |
   |                             | observationTimeMicroseconds, or     |
   |                             | observationTimeNanoseconds.         |
   +-----------------------------+-------------------------------------+

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/10.2.%20%20Flow%20Key%20Options%20Template"></a><a class="selflink" href="#section-10.2" name="section-10.2">10.2</a>.  Flow Key Options Template</span>

   The Flow Keys Options Template specifies the structure of a Data
   Record for reporting the Flow Keys of reported Flows.  A Flow Keys
   Data Record extends a particular Template Record that is referenced
   by its templateId identifier.  The Template Record is extended by
   specifying which of the Information Elements contained in the
   corresponding Data Records describe Flow properties that serve as
   Flow Keys of the reported Flow.  This Options Template is defined in
   <a href="rfc7011.html#section-4.4">Section 4.4 of [RFC7011]</a> and SHOULD be used by Mediators for export
   as defined there.

   When an Intermediate Process exports Data Records containing
   different Flow Keys from those received from the Original Exporter,
   and the Original Exporter sent a Flow Keys Options record to the
   IPFIX Mediator, the IPFIX Mediator MUST export a Flow Keys Options
   record defining the new set of Flow Keys.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/10.3.%20%20intermediateProcessId%20Information%20Element"></a><a class="selflink" href="#section-10.3" name="section-10.3">10.3</a>.  intermediateProcessId Information Element</span>

   Name:   intermediateProcessId

   Description:   An identifier of an Intermediate Process that is
      unique per IPFIX Device.  Typically, this Information Element is
      used for limiting the scope of other Information Elements.  Note
      that process identifiers may be assigned dynamically; that is, an
      Intermediate Process may be restarted with a different ID.



<span class="grey">Claise, et al.               Standards Track                   [Page 26]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-27" id="page-27" name="page-27"> </a>
<span class="grey"><a href="rfc7119.html">RFC 7119</a>                     IPFIX MED-PROTO               February 2014</span>


   Data Type:   unsigned32

   Data Type Semantics:   identifier

   ElementId:   406

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/10.4.%20%20ignoredDataRecordTotalCount%20Information%20Element"></a><a class="selflink" href="#section-10.4" name="section-10.4">10.4</a>.  ignoredDataRecordTotalCount Information Element</span>

   Name:   ignoredDataRecordTotalCount

   Description:   The total number of received Data Records that the
      Intermediate Process did not process since the (re-)initialization
      of the Intermediate Process; includes only Data Records not
      examined or otherwise handled by the Intermediate Process due to
      resource constraints, not Data Records that were examined or
      otherwise handled by the Intermediate Process but those that
      merely do not contribute to any exported Data Record due to the
      operations performed by the Intermediate Process.

   Data Type:   unsigned64

   Data Type Semantics:   totalCounter

   ElementId:   407

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/11.%20%20Operations%20and%20Management%20Considerations"></a><a class="selflink" href="#section-11" name="section-11">11</a>.  Operations and Management Considerations</span>

   In general, using IPFIX Mediators to combine information from
   multiple Original Exporters requires a consistent configuration of
   the Metering Processes behind these Original Exporters.  The details
   of this consistency are specific to each Intermediate Process.
   Consistency of configuration should be verified out of band, with the
   MIB modules ([<a href="rfc6615.html" title='"Definitions of Managed Objects for IP Flow Information Export"'>RFC6615</a>] and [<a href="rfc6727.html" title='"Definitions of Managed Objects for Packet Sampling"'>RFC6727</a>]) or with the Configuration Data
   Model for IPFIX and PSAMP [<a href="rfc6728.html" title='"Configuration Data Model for the IP Flow Information Export (IPFIX) and Packet Sampling (PSAMP) Protocols"'>RFC6728</a>].

   From an operational perspective, this specification provides all the
   information required to set up IPFIX Mediators and Collectors behind
   IPFIX Mediators.  While configuring the IPFIX Mediators, care must be
   taken to include all the relevant information so that the Collectors
   deduce the Data Records precise semantic.  This is covered by the
   Template Mapping specifications in <a href="#section-4.1">Section 4.1</a>.  Also, caution must
   be taken that if something is not carefully configured in the
   processing chain, this can lead to the wrong interpretation of
   collected IPFIX data, and the associated applications can produce
   results that are not operationally meaningful.






<span class="grey">Claise, et al.               Standards Track                   [Page 27]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-28" id="page-28" name="page-28"> </a>
<span class="grey"><a href="rfc7119.html">RFC 7119</a>                     IPFIX MED-PROTO               February 2014</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/12.%20%20Security%20Considerations"></a><a class="selflink" href="#section-12" name="section-12">12</a>.  Security Considerations</span>

   As they act as both IPFIX Collecting Processes and Exporting
   Processes, the Security Considerations for the IPFIX Protocol
   [<a href="rfc7011.html" title='"Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of Flow Information"'>RFC7011</a>] also apply to IPFIX Mediators.  The Security Considerations
   for IPFIX Files [<a href="rfc5655.html" title='"Specification of the IP Flow Information Export (IPFIX) File Format"'>RFC5655</a>] also apply to IPFIX Mediators that write
   IPFIX Files or use them for internal storage.  However, there are a
   few specific considerations that IPFIX Mediator implementations must
   also take into account.

   By design, IPFIX Mediators are "men in the middle": they intercede in
   the communication between an Original Exporter (or another upstream
   IPFIX Mediator) and a downstream Collecting Process.  This has two
   important implications for the level of confidentiality provided
   across an IPFIX Mediator and the ability to protect data integrity
   and Original Exporter authenticity across an IPFIX Mediator.  These
   are addressed in more detail in the Security Considerations for IPFIX
   Mediators in [<a href="rfc6183.html" title='"IP Flow Information Export (IPFIX) Mediation: Framework"'>RFC6183</a>].

   Note that while IPFIX Mediators can use the exporterCertificate and
   collectorCertificate Information Elements defined in [<a href="rfc5655.html" title='"Specification of the IP Flow Information Export (IPFIX) File Format"'>RFC5655</a>] as
   described in <a href="rfc6183.html#section-9.3">Section 9.3 of [RFC6183]</a> to export information about
   X.509 identities in upstream TLS-protected Transport Sessions, this
   mechanism cannot be used to provide true end-to-end assertions about
   a chain of IPFIX Mediators: any IPFIX Mediator in the chain can
   simply falsify the information about upstream Transport Sessions.  In
   situations where information about the chain of mediation is
   important, it must be determined out of band.  Note as well that an
   Exporting Process has no in-band way to determine whether or not a
   given Collecting Process will act as a Mediator.  Trust placed in
   Collecting Processes is absolute, so care should be taken when
   exporting IPFIX Messages between Exporting Processes and Collecting
   Processes controlled by different entities.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/13.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-13" name="section-13">13</a>.  IANA Considerations</span>

   This document specifies new IPFIX Information Elements,
   originalExporterIPv4Address in <a href="#section-5.1">Section 5.1</a>,
   originalExporterIPv6Address in <a href="#section-5.2">Section 5.2</a>,
   originalObservationDomainId in <a href="#section-6.1">Section 6.1</a>, intermediateProcessId in
   <a href="#section-10.3">Section 10.3</a>, and ignoredDataRecordTotalCount in <a href="#section-10.4">Section 10.4</a>, which
   have been added to the IPFIX Information Element registry
   [<a href="#ref-IANA-IPFIX" title='"IP Flow Information Export (IPFIX) Entities"'>IANA-IPFIX</a>].








<span class="grey">Claise, et al.               Standards Track                   [Page 28]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-29" id="page-29" name="page-29"> </a>
<span class="grey"><a href="rfc7119.html">RFC 7119</a>                     IPFIX MED-PROTO               February 2014</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/14.%20%20Acknowledgments"></a><a class="selflink" href="#section-14" name="section-14">14</a>.  Acknowledgments</span>

   We would like to thank the IPFIX contributors, specifically Paul
   Aitken (THE ultimate IPFIX document reviewer) and Andrew Feren for
   their thorough reviews; Nevil Brownlee and Juergen Quittek for
   shepherding this document and chairing the IPFIX Working Group; and
   to Rahul Patel, Meral Shirazipour, and Juergen Schoenwaelder for
   their feedback and comments.  This work is materially supported by
   the European Union Seventh Framework Programme under grant agreements
   257315 (DEMONS) and 318627 (mPlane).

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/15.%20%20References"></a><a class="selflink" href="#section-15" name="section-15">15</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/15.1.%20%20Normative%20References"></a><a class="selflink" href="#section-15.1" name="section-15.1">15.1</a>.  Normative References</span>

   [<a id="ref-RFC0768" name="ref-RFC0768">RFC0768</a>]  Postel, J., "User Datagram Protocol", STD 6, <a href="rfc768.html">RFC 768</a>,
              August 1980.

   [<a id="ref-RFC0793" name="ref-RFC0793">RFC0793</a>]  Postel, J., "Transmission Control Protocol", STD 7, <a href="rfc793.html">RFC</a>
              <a href="rfc793.html">793</a>, September 1981.

   [<a id="ref-RFC2119" name="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a id="ref-RFC3758" name="ref-RFC3758">RFC3758</a>]  Stewart, R., Ramalho, M., Xie, Q., Tuexen, M., and P.
              Conrad, "Stream Control Transmission Protocol (SCTP)
              Partial Reliability Extension", <a href="rfc3758.html">RFC 3758</a>, May 2004.

   [<a id="ref-RFC4960" name="ref-RFC4960">RFC4960</a>]  Stewart, R., "Stream Control Transmission Protocol", <a href="rfc4960.html">RFC</a>
              <a href="rfc4960.html">4960</a>, September 2007.

   [<a id="ref-RFC5226" name="ref-RFC5226">RFC5226</a>]  Narten, T. and H. Alvestrand, "Guidelines for Writing an
              IANA Considerations Section in RFCs", <a href="https://tools.ietf.org/html/bcp26">BCP 26</a>, <a href="rfc5226.html">RFC 5226</a>,
              May 2008.

   [<a id="ref-RFC5655" name="ref-RFC5655">RFC5655</a>]  Trammell, B., Boschi, E., Mark, L., Zseby, T., and A.
              Wagner, "Specification of the IP Flow Information Export
              (IPFIX) File Format", <a href="rfc5655.html">RFC 5655</a>, October 2009.

   [<a id="ref-RFC6313" name="ref-RFC6313">RFC6313</a>]  Claise, B., Dhandapani, G., Aitken, P., and S. Yates,
              "Export of Structured Data in IP Flow Information Export
              (IPFIX)", <a href="rfc6313.html">RFC 6313</a>, July 2011.

   [<a id="ref-RFC6615" name="ref-RFC6615">RFC6615</a>]  Dietz, T., Kobayashi, A., Claise, B., and G. Muenz,
              "Definitions of Managed Objects for IP Flow Information
              Export", <a href="rfc6615.html">RFC 6615</a>, June 2012.





<span class="grey">Claise, et al.               Standards Track                   [Page 29]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-30" id="page-30" name="page-30"> </a>
<span class="grey"><a href="rfc7119.html">RFC 7119</a>                     IPFIX MED-PROTO               February 2014</span>


   [<a id="ref-RFC6727" name="ref-RFC6727">RFC6727</a>]  Dietz, T., Claise, B., and J. Quittek, "Definitions of
              Managed Objects for Packet Sampling", <a href="rfc6727.html">RFC 6727</a>, October
              2012.

   [<a id="ref-RFC6728" name="ref-RFC6728">RFC6728</a>]  Muenz, G., Claise, B., and P. Aitken, "Configuration Data
              Model for the IP Flow Information Export (IPFIX) and
              Packet Sampling (PSAMP) Protocols", <a href="rfc6728.html">RFC 6728</a>, October
              2012.

   [<a id="ref-RFC7011" name="ref-RFC7011">RFC7011</a>]  Claise, B., Trammell, B., and P. Aitken, "Specification of
              the IP Flow Information Export (IPFIX) Protocol for the
              Exchange of Flow Information", STD 77, <a href="rfc7011.html">RFC 7011</a>, September
              2013.

   [<a id="ref-RFC7012" name="ref-RFC7012">RFC7012</a>]  Claise, B. and B. Trammell, "Information Model for IP Flow
              Information Export (IPFIX)", <a href="rfc7012.html">RFC 7012</a>, September 2013.

   [<a id="ref-RFC7013" name="ref-RFC7013">RFC7013</a>]  Trammell, B. and B. Claise, "Guidelines for Authors and
              Reviewers of IP Flow Information Export (IPFIX)
              Information Elements", <a href="https://tools.ietf.org/html/bcp184">BCP 184</a>, <a href="rfc7013.html">RFC 7013</a>, September 2013.

   [<a id="ref-RFC7014" name="ref-RFC7014">RFC7014</a>]  D'Antonio, S., Zseby, T., Henke, C., and L. Peluso, "Flow
              Selection Techniques", <a href="rfc7014.html">RFC 7014</a>, September 2013.

   [<a id="ref-RFC7015" name="ref-RFC7015">RFC7015</a>]  Trammell, B., Wagner, A., and B. Claise, "Flow Aggregation
              for the IP Flow Information Export (IPFIX) Protocol", <a href="rfc7015.html">RFC</a>
              <a href="rfc7015.html">7015</a>, September 2013.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/15.2.%20%20Informative%20References"></a><a class="selflink" href="#section-15.2" name="section-15.2">15.2</a>.  Informative References</span>

   [<a id="ref-RFC3917" name="ref-RFC3917">RFC3917</a>]  Quittek, J., Zseby, T., Claise, B., and S. Zander,
              "Requirements for IP Flow Information Export (IPFIX)", <a href="rfc3917.html">RFC</a>
              <a href="rfc3917.html">3917</a>, October 2004.

   [<a id="ref-RFC3954" name="ref-RFC3954">RFC3954</a>]  Claise, B., "Cisco Systems NetFlow Services Export Version
              9", <a href="rfc3954.html">RFC 3954</a>, October 2004.

   [<a id="ref-RFC5470" name="ref-RFC5470">RFC5470</a>]  Sadasivan, G., Brownlee, N., Claise, B., and J. Quittek,
              "Architecture for IP Flow Information Export", <a href="rfc5470.html">RFC 5470</a>,
              March 2009.

   [<a id="ref-RFC5472" name="ref-RFC5472">RFC5472</a>]  Zseby, T., Boschi, E., Brownlee, N., and B. Claise, "IP
              Flow Information Export (IPFIX) Applicability", <a href="rfc5472.html">RFC 5472</a>,
              March 2009.

   [<a id="ref-RFC5473" name="ref-RFC5473">RFC5473</a>]  Boschi, E., Mark, L., and B. Claise, "Reducing Redundancy
              in IP Flow Information Export (IPFIX) and Packet Sampling
              (PSAMP) Reports", <a href="rfc5473.html">RFC 5473</a>, March 2009.



<span class="grey">Claise, et al.               Standards Track                   [Page 30]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-31" id="page-31" name="page-31"> </a>
<span class="grey"><a href="rfc7119.html">RFC 7119</a>                     IPFIX MED-PROTO               February 2014</span>


   [<a id="ref-RFC5476" name="ref-RFC5476">RFC5476</a>]  Claise, B., Johnson, A., and J. Quittek, "Packet Sampling
              (PSAMP) Protocol Specifications", <a href="rfc5476.html">RFC 5476</a>, March 2009.

   [<a id="ref-RFC5610" name="ref-RFC5610">RFC5610</a>]  Boschi, E., Trammell, B., Mark, L., and T. Zseby,
              "Exporting Type Information for IP Flow Information Export
              (IPFIX) Information Elements", <a href="rfc5610.html">RFC 5610</a>, July 2009.

   [<a id="ref-RFC5982" name="ref-RFC5982">RFC5982</a>]  Kobayashi, A. and B. Claise, "IP Flow Information Export
              (IPFIX) Mediation: Problem Statement", <a href="rfc5982.html">RFC 5982</a>, August
              2010.

   [<a id="ref-RFC6183" name="ref-RFC6183">RFC6183</a>]  Kobayashi, A., Claise, B., Muenz, G., and K. Ishibashi,
              "IP Flow Information Export (IPFIX) Mediation: Framework",
              <a href="rfc6183.html">RFC 6183</a>, April 2011.

   [<a id="ref-RFC6235" name="ref-RFC6235">RFC6235</a>]  Boschi, E. and B. Trammell, "IP Flow Anonymization
              Support", <a href="rfc6235.html">RFC 6235</a>, May 2011.

   [<a id="ref-NAT-LOGGING" name="ref-NAT-LOGGING">NAT-LOGGING</a>]
              Sivakumar, S. and R. Penno, "IPFIX Information Elements
              for logging NAT Events", Work in Progress, November 2013.

   [<a id="ref-IANA-IPFIX" name="ref-IANA-IPFIX">IANA-IPFIX</a>]
              IANA, "IP Flow Information Export (IPFIX) Entities",
              &lt;<a href="http://www.iana.org/assignments/ipfix">http://www.iana.org/assignments/ipfix</a>&gt;.

   [<a id="ref-POSIX.1" name="ref-POSIX.1">POSIX.1</a>]  IEEE, "IEEE Standard for Information Technology - Portable
              Operating System Interface", IEEE 1003.1-2008, 2008.























<span class="grey">Claise, et al.               Standards Track                   [Page 31]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-32" id="page-32" name="page-32"> </a>
<span class="grey"><a href="rfc7119.html">RFC 7119</a>                     IPFIX MED-PROTO               February 2014</span>


Authors' Addresses

   Benoit Claise
   Cisco Systems, Inc.
   De Kleetlaan 6a b1
   1831 Diegem
   Belgium

   Phone: +32 2 704 5622
   EMail: bclaise@cisco.com


   Atsushi Kobayashi
   NTT Information Sharing Platform Laboratories
   3-9-11 Midori-cho
   Musashino-shi, Tokyo 180-8585
   Japan

   Phone: +81 422 59 3978
   EMail: akoba@nttv6.net


   Brian Trammell
   Swiss Federal Institute of Technology Zurich
   Gloriastrasse 35
   8092 Zurich
   Switzerland

   Phone: +41 44 632 70 13
   EMail: trammell@tik.ee.ethz.ch





















Claise, et al.               Standards Track                   [Page 32]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.127, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc7119 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 14 Aug 2018 14:06:07 GMT --></html>