<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc7324 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:22 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="draft-osborne-mpls-psc-updates" name="DC.Relation.Replaces"/>
<meta content="urn:ietf:rfc:7324" name="DC.Identifier"/>
<meta content="July, 2014" name="DC.Date.Issued"/>
<meta content="Eric Osborne &lt;eric.osborne@notcom.com&gt;" name="DC.Creator"/>
<meta content="This document contains a number of updates to the Protection State
Coordination (PSC) logic defined in RFC 6378, &quot;MPLS Transport Profile
(MPLS-TP) Linear Protection&quot;. These updates provide some rules and
recommendations around the use of TLVs in PSC, address some issues
raised in an ITU-T liaison statement, and clarify PSC's behavior in
a case not well explained in RFC 6378." name="DC.Description.Abstract"/>
<meta content="Updates to MPLS Transport Profile Linear Protection" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 7324 - Updates to MPLS Transport Profile Linear Protection</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgblue" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc7324.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc7324" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-mpls-psc-updates" title="draft-ietf-mpls-psc-updates">draft-ietf-mpls...</a>] [<a href="https://datatracker.ietf.org/doc/rfc7324" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc7324" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc7324" title="Side-by-side diff">Diff2</a>]         </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                       PROPOSED STANDARD</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Internet Engineering Task Force (IETF)                        E. Osborne
Request for Comments: 7324                                     July 2014
Updates: <a href="rfc6378.html">6378</a>
Category: Standards Track
ISSN: 2070-1721


          <span class="h1">Updates to MPLS Transport Profile Linear Protection</span>

Abstract

   This document contains a number of updates to the Protection State
   Coordination (PSC) logic defined in <a href="rfc6378.html">RFC 6378</a>, "MPLS Transport Profile
   (MPLS-TP) Linear Protection".  These updates provide some rules and
   recommendations around the use of TLVs in PSC, address some issues
   raised in an ITU-T liaison statement, and clarify PSC's behavior in a
   case not well explained in <a href="rfc6378.html">RFC 6378</a>.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="rfc5741.html#section-2">Section 2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc7324">http://www.rfc-editor.org/info/rfc7324</a>.

Copyright Notice

   Copyright (c) 2014 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.





<span class="grey">Osborne                      Standards Track                    [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc7324.html">RFC 7324</a>                       PSC Updates                     July 2014</span>


Table of Contents

   <a href="#section-1">1</a>.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-2">2</a>
     <a href="#section-1.1">1.1</a>.  Requirements Language . . . . . . . . . . . . . . . . . .   <a href="#page-3">3</a>
   <a href="#section-2">2</a>.  Message Formatting and Error Handling . . . . . . . . . . . .   <a href="#page-3">3</a>
     <a href="#section-2.1">2.1</a>.  PSC TLV Format  . . . . . . . . . . . . . . . . . . . . .   <a href="#page-3">3</a>
     <a href="#section-2.2">2.2</a>.  Error Handling  . . . . . . . . . . . . . . . . . . . . .   <a href="#page-4">4</a>
       <a href="#section-2.2.1">2.2.1</a>.  Malformed Messages  . . . . . . . . . . . . . . . . .   <a href="#page-4">4</a>
       <a href="#section-2.2.2">2.2.2</a>.  Well-Formed but Unknown or Unexpected TLV . . . . . .   <a href="#page-4">4</a>
   <a href="#section-3">3</a>.  Incorrect Local Status after Failure  . . . . . . . . . . . .   <a href="#page-5">5</a>
   <a href="#section-4">4</a>.  Handling a Capabilities Mismatch  . . . . . . . . . . . . . .   <a href="#page-5">5</a>
     <a href="#section-4.1">4.1</a>.  Protection Type Mismatch  . . . . . . . . . . . . . . . .   <a href="#page-5">5</a>
     <a href="#section-4.2">4.2</a>.  R Mismatch  . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-6">6</a>
     <a href="#section-4.3">4.3</a>.  Unsupported Modes . . . . . . . . . . . . . . . . . . . .   <a href="#page-6">6</a>
   <a href="#section-5">5</a>.  Reversion Deadlock Due to a Race Condition  . . . . . . . . .   <a href="#page-7">7</a>
   <a href="#section-6">6</a>.  Clarifying PSC's Behavior in the Face of Multiple Inputs  . .   <a href="#page-8">8</a>
   <a href="#section-7">7</a>.  Security Considerations . . . . . . . . . . . . . . . . . . .  <a href="#page-10">10</a>
   <a href="#section-8">8</a>.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .  <a href="#page-10">10</a>
   <a href="#section-9">9</a>.  Acknowledgements  . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-10">10</a>
   <a href="#section-10">10</a>. References  . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-10">10</a>
     <a href="#section-10.1">10.1</a>.  Normative References . . . . . . . . . . . . . . . . . .  <a href="#page-10">10</a>
     <a href="#section-10.2">10.2</a>.  Informative References . . . . . . . . . . . . . . . . .  <a href="#page-10">10</a>

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   This document contains a number of updates to PSC [<a href="rfc6378.html" title='"MPLS Transport Profile (MPLS-TP) Linear Protection"'>RFC6378</a>].  One
   provides some rules and recommendations around the use of TLVs in
   PSC.  Three of the updates address issues #2, #7, and #8 as
   identified in the ITU's liaison statement "Recommendation ITU-T
   G.8131/Y.1382 revision - Linear protection switching for MPLS-TP
   networks" [<a href="#ref-LIAISON" title='"Liaison Statement: Recommendation ITU-T G.8131/Y.1382 revision - Linear protection switching for MPLS-TP networks"'>LIAISON</a>].  Another clears up a behavior that was not well
   explained in <a href="rfc6378.html">RFC 6378</a>.  These updates are not changes to the
   protocol's packet format or to PSC's design; they are corrections and
   clarifications to specific aspects of the protocol's procedures.
   This document does not introduce backward compatibility issues with
   implementations of <a href="rfc6378.html">RFC 6378</a>.

   It should be noted that [<a href="rfc7271.html" title='"MPLS Transport Profile (MPLS- TP) Linear Protection to Match the Operational Expectations of Synchronous Digital Hierarchy, Optical Transport Network, and Ethernet Transport Network Operators"'>RFC7271</a>] contains protocol mechanisms for an
   alternate mode of operating MPLS-TP PSC.  Those modes are built on
   the message structures and procedures of [<a href="rfc6378.html" title='"MPLS Transport Profile (MPLS-TP) Linear Protection"'>RFC6378</a>], and so, while
   this document does not update [<a href="rfc7271.html" title='"MPLS Transport Profile (MPLS- TP) Linear Protection to Match the Operational Expectations of Synchronous Digital Hierarchy, Optical Transport Network, and Ethernet Transport Network Operators"'>RFC7271</a>], it has an impact on that
   work through its update to [<a href="rfc6378.html" title='"MPLS Transport Profile (MPLS-TP) Linear Protection"'>RFC6378</a>].

   This document assumes familiarity with <a href="rfc6378.html">RFC 6378</a> and its terms,
   conventions, and acronyms.  Any term used in this document but not
   defined herein can be found in <a href="rfc6378.html">RFC 6378</a>.  In particular, this
   document shares the acronyms defined in <a href="rfc6378.html#section-2.1">Section 2.1 of RFC 6378</a>.




<span class="grey">Osborne                      Standards Track                    [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc7324.html">RFC 7324</a>                       PSC Updates                     July 2014</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.1.%20%20Requirements%20Language"></a><a class="selflink" href="#section-1.1" name="section-1.1">1.1</a>.  Requirements Language</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in <a href="rfc2119.html">RFC 2119</a> [<a href="rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Message%20Formatting%20and%20Error%20Handling"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Message Formatting and Error Handling</span>

   This section covers message formatting as well as some recommended
   error checking.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.1.%20%20PSC%20TLV%20Format"></a><a class="selflink" href="#section-2.1" name="section-2.1">2.1</a>.  PSC TLV Format</span>

   [<a id="ref-RFC6378" name="ref-RFC6378">RFC6378</a>] provides the capability to carry TLVs in the PSC messages.
   All fields are encoded in network byte order.  Each TLV contains
   three fields, as follows:

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |             Type              |            Length             |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                             Value                             |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Type field (T):

   A two-octet field that encodes a type value.  The type values are
   recorded in the IANA registry "MPLS PSC TLV Registry".

   Length field (L):

   A two-octet field that encodes the length in octets of the Value
   field.  The value of this field MUST be a multiple of 4.

   Value field (V):

   The payload of the TLV.  The length of this field (which is the value
   of the Length field) MUST be a multiple of 4 octets, and so this
   field may contain explicit padding.  The length of each single TLV is
   the sum of the lengths of its three fields: the length of the value
   field + 4.  The overall TLV Length field in the PSC message contains
   the total length of all TLVs in octets.








<span class="grey">Osborne                      Standards Track                    [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc7324.html">RFC 7324</a>                       PSC Updates                     July 2014</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.2.%20%20Error%20Handling"></a><a class="selflink" href="#section-2.2" name="section-2.2">2.2</a>.  Error Handling</span>

   It is recommended to implement error and bounds checking to ensure
   that received messages, if improperly formatted, are handled in such
   a way to minimize the impact of this formatting on the behavior of
   the network and its devices.  This section covers two such areas --
   malformed messages and well-formed but unexpected TLVs.

   This text is not intended to limit the error or bounds checking a
   device performs.  The recommendations herein should be taken as a
   starting point.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.2.1.%20%20Malformed%20Messages"></a><a class="selflink" href="#section-2.2.1" name="section-2.2.1">2.2.1</a>.  Malformed Messages</span>

   An implementation SHOULD:

   o  Ensure any fields prior to TLV Length are consistent with <a href="rfc6378.html">RFC</a>
      <a href="rfc6378.html">6378</a>, particularly <a href="#section-4.2">Section 4.2</a> of that document.

   o  Ensure the overall length of the message matches the value in the
      TLV Length + 12.

   o  Check that the sum of the lengths of all TLVs matches the value in
      the TLV Length.

   If an implementation receives a message that fails any malformed
   message checks, it MUST drop the message and SHOULD alert the
   operator to the malformed message.  The method(s) used to alert the
   operator are outside the scope of this document but may include
   things like syslog or console messages.

<span class="h4"><a class="dashAnchor" name="//apple_ref/Section/2.2.2.%20%20Well-Formed%20but%20Unknown%20or%20Unexpected%20TLV"></a><a class="selflink" href="#section-2.2.2" name="section-2.2.2">2.2.2</a>.  Well-Formed but Unknown or Unexpected TLV</span>

   If a message is deemed to be properly formed, an implementation
   SHOULD check all TLVs to ensure that it knows what to do with them.
   A well-formed but unknown or unexpected TLV value MUST be ignored,
   and the rest of the message processed as if the ignored TLV did not
   exist.  An implementation detecting a malformed TLV SHOULD alert the
   operator as described in <a href="#section-2.2.1">Section 2.2.1</a>.












<span class="grey">Osborne                      Standards Track                    [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc7324.html">RFC 7324</a>                       PSC Updates                     July 2014</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20Incorrect%20Local%20Status%20after%20Failure"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  Incorrect Local Status after Failure</span>

   Issue #2 in the liaison statement identifies a case where a strict
   reading of <a href="rfc6378.html">RFC 6378</a> leaves a node reporting an inaccurate status:

   A node can end up sending incorrect status -- NR(0,1) -- despite the
   failure of the protection LSP (P-LSP).  This is clearly not correct,
   as a node should not be sending NR if it has a local failure.  To
   address this issue, the fourth bullet in <a href="rfc6378.html#section-4.3.3.3">Section 4.3.3.3 of RFC 6378</a>
   is replaced with the following three bullets:

   o  If the current state is due to a local or remote Manual Switch, a
      local Signal Fail indication on the protection path SHALL cause
      the LER to enter local Unavailable state and begin transmission of
      an SF(0,0) message.

   o  If the LER is in local Protecting Administrative state due to a
      local Forced Switch, a local Signal Fail indication on the
      protection path SHALL be ignored.

   o  If the LER is in remote Protecting Administrative state due to a
      remote Forced Switch, a local Signal Fail indication on the
      protection path SHALL cause the LER to remain in remote Protecting
      administrative state and transmit an SF(0,1) message.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Handling%20a%20Capabilities%20Mismatch"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Handling a Capabilities Mismatch</span>

   PSC has no explicit facility to negotiate any properties of the
   protection domain.  It does, however, have the ability to signal two
   properties of that domain, via the Protection Type (PT) and Revertive
   (R) bits.  <a href="rfc6378.html">RFC 6378</a> specifies that if these bits do not match an
   operator "SHALL [be notified]" (PT, <a href="#section-4.2.3">Section 4.2.3</a>) or "SHOULD be
   notified" (R, <a href="#section-4.2.4">Section 4.2.4</a>).  However, there is no text that
   specifies the behavior of the end nodes of a protection domain in
   case of a mismatch.  This section provides that text, as requested by
   issue #7 in the liaison statement.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.1.%20%20Protection%20Type%20Mismatch"></a><a class="selflink" href="#section-4.1" name="section-4.1">4.1</a>.  Protection Type Mismatch</span>

   The behavior of the protection domain depends on the exact Protection
   Type (PT) mismatch.  <a href="rfc6378.html#section-4.2.3">Section 4.2.3 of RFC 6378</a> specifies three
   protection types -- bidirectional switching using a permanent bridge,
   bidirectional switching using a selector bridge, and unidirectional
   switching using a permanent bridge.  They are abbreviated here as BP,
   BS, and UP.






<span class="grey">Osborne                      Standards Track                    [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc7324.html">RFC 7324</a>                       PSC Updates                     July 2014</span>


   There are three possible mismatches: {BP, UP}, {BP, BS}, and
   {UP, BS}.  The priority is:

   UP &gt; BS &gt; BP

   In other words:

   o  If the PT mismatch is {BP, UP}, the node transmitting BP MUST
      switch to UP mode if it is supported.

   o  If the PT mismatch is {BP, BS}, the node transmitting BP MUST
      switch to BS mode if it is supported.

   o  If the PT mismatch is {UP, BS}, the node transmitting BS MUST
      switch to UP mode if it is supported.

   If a node does not support a mode to which it is required to switch,
   then that node MUST behave as in <a href="#section-4.3">Section 4.3</a>.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.2.%20%20R%20Mismatch"></a><a class="selflink" href="#section-4.2" name="section-4.2">4.2</a>.  R Mismatch</span>

   The R bit indicates whether the protection domain is in revertive or
   non-revertive behavior.  If the R bits do not match, the node
   indicating non-revertive MUST switch to Revertive if it is supported.
   If it is not supported, a node must behave as in <a href="#section-4.3">Section 4.3</a>.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/4.3.%20%20Unsupported%20Modes"></a><a class="selflink" href="#section-4.3" name="section-4.3">4.3</a>.  Unsupported Modes</span>

   An implementation may not support all three PT modes and/or both R
   modes, and thus a pair of nodes may be unable to converge on a common
   mode.  This creates a permanent mismatch, resolvable only by operator
   intervention.  An implementation SHOULD alert the operator to an
   irreconcilable mismatch.

   It is desirable to allow the protection domain to function in a non-
   failure mode even if there is a mismatch, as the mismatches of PT or
   R have to do with how nodes recover from a failure.  An
   implementation SHOULD allow traffic to be sent on the Working LSP as
   long as there is no failure (e.g., NR state) regardless of any PT or
   R mismatch.

   If there is a trigger that would cause the protection LSP to be used,
   such as SF or MS, a node MUST NOT use the protection LSP to carry
   traffic.







<span class="grey">Osborne                      Standards Track                    [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc7324.html">RFC 7324</a>                       PSC Updates                     July 2014</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Reversion%20Deadlock%20Due%20to%20a%20Race%20Condition"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Reversion Deadlock Due to a Race Condition</span>

   Issue #8 in the liaison statement identifies a deadlock case where
   each node can end up sending NR(0,1) when it should instead be in the
   process of recovering from the failure (i.e., entering into WTR or
   DNR, as appropriate for the protection domain).  The root of the
   issue is that a pair of nodes can simultaneously enter WTR state,
   receive an out-of-date SF-W indication, transition into a remotely
   triggered WTR, and remain in remotely triggered WTR waiting for the
   other end to trigger a change in status.

   In the case identified in issue #8, each node can end up sending
   NR(0,1), which is an indication that the transmitting node has no
   local failure, but is instead reacting to the remote SF-W.  If a node
   that receives NR(0,1) is in fact not indicating a local error, the
   correct behavior for the receiving node is to take the received
   NR(0,1) as an indication that there is no error in the protection
   domain, and recovery procedures (WTR or DNR) should begin.

   This is addressed by adding the following text as the penultimate
   bullet in <a href="rfc6378.html#section-4.3.3.4">Section 4.3.3.4 of RFC 6378</a>:

   o  If a node is in Protecting Failure state due to a remote SF-W and
      receives NR(0,1), this SHALL cause the node to begin recovery
      procedures.  If the LER is configured for revertive behavior, it
      enters into Wait-to-Restore state, starts the WTR timer, and
      begins transmitting WTR(0,1).  If the LER is configured for non-
      revertive behavior, it enters into Do-Not-Revert state and begins
      transmitting a DNR(0,1) message.

   Additionally, the penultimate bullet in <a href="#section-4.3.3.3">Section 4.3.3.3</a> is changed
   from

   o  A remote NR(0,0) message SHALL be ignored if in local Protecting
      administrative state.

   to

   o  A remote No Request message SHALL be ignored if in local
      Protecting administrative state.

   This indicates that a remote NR triggers the same behavior regardless
   of the value of FPath and Path.  This change does not directly
   address issue #8, but it fixes a similar issue -- if a node receives
   NR while in Remote administrative state, the value of FPath and Path
   have no bearing on the node's reaction to this NR.





<span class="grey">Osborne                      Standards Track                    [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc7324.html">RFC 7324</a>                       PSC Updates                     July 2014</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20Clarifying%20PSC%27s%20Behavior%20in%20the%20Face%20of%20Multiple%20Inputs"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  Clarifying PSC's Behavior in the Face of Multiple Inputs</span>

   <a href="rfc6378.html">RFC 6378</a> describes the PSC state machine.  Figure 1 in <a href="rfc6378.html#section-3">Section 3 of
   RFC 6378</a> shows two inputs into the PSC Control logic -- Local Request
   logic and Remote PSC Request.  When there is only one input into the
   PSC Control logic -- a local request or a remote request but not both
   -- the PSC Control logic decides what that input signifies and then
   takes one or more actions, as necessary.  This is what the PSC State
   Machine in <a href="rfc6378.html#section-4.3">Section 4.3 of RFC 6378</a> describes.

   <a href="rfc6378.html">RFC 6378</a> does not sufficiently describe the behavior in the face of
   multiple inputs into the PSC Control Logic (one Local Request and one
   Remote Request).  This section clarifies the expected behavior.

   There are two cases to think about when considering dual inputs into
   the PSC Control logic.  The first is when the same request is
   presented from both local and remote sources.  One example of this
   case is a Forced Switch (FS) configured on both ends of an LSP.  This
   will result in the PSC Control logic receiving both a local FS and
   remove FS.  For convenience, this scenario is written as [L(FS),
   R(FS)] -- that is, Local(Forced Switch) and Remote(Forced Switch).

   The second case, which is handled in exactly the same way as the
   first, is when the two inputs into the PSC Control logic describe
   different events.  There are a number of variations on this case.
   One example is when there is a Lockout of Protection from the Local
   request logic and a Signal Fail on the Working path from the Remote
   PSC Request.  This is shortened to [L(LO), R(SF-W)].

   In both cases, the question is not how the PSC Control logic decides
   which of these is the one it acts upon.  <a href="rfc6378.html#section-4.3.2">Section 4.3.2 of RFC 6378</a>
   lists the priority order and prioritizes the local input over the
   remote input in case both inputs are of the same priority.  So, in
   the first example it is the local SF that drives the PSC Control
   logic, and in the second example it is the local Lockout that drives
   the PSC Control logic.

   The point that this section clears up is around what happens when the
   highest-priority input goes away.  Consider the first case.
   Initially, the PSC Control logic has [L(FS), R(FS)], and L(FS) is
   driving PSC's behavior.  When L(FS) is removed, but R(FS) remains,
   what does PSC do?  A strict reading of the Finite State Machine (FSM)
   would suggest that PSC transition from PA:F:L into N, and at some
   future time (perhaps after the remote request refreshes), PSC would
   transition from N to PA:F:R.  This is an unreasonable behavior, as
   there is no sensible justification for a node behaving as if things
   were normal (i.e., N state) when it is clear that they are not.




<span class="grey">Osborne                      Standards Track                    [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc7324.html">RFC 7324</a>                       PSC Updates                     July 2014</span>


   The second case is similar.  If a node starts with [L(LO), R(SF-W)]
   and the local lockout is removed, a strict reading of the state
   machine would suggest that the node transition from UA:LO:L to N, and
   then at some future time presumably notice the R(SF-W) and transition
   from N to PF:W:R.  As with the first case, this is clearly not a
   useful behavior.

   In both cases, the request that was driving PSC's behavior was
   removed.  What should happen is that the PSC Control logic should,
   upon removal of an input, immediately reevaluate all other inputs to
   decide on the next course of action.  This requires an implementation
   to store the most recent local and remote inputs regardless of their
   eventual use as triggers for the PSC Control Logic.

   There is also a third case.  Consider a node with [L(FS), R(LO)].  At
   some point in time, the remote node replaces its Lockout request with
   a Signal Fail on Working, so that the inputs into the PSC Control
   logic on the receiving node go to [L(FS), R(SF-W)].  Similar to the
   first two cases, the node should immediately reevaluate both its
   local and remote inputs to determine the highest priority among them
   and act on that input accordingly.  That is in fact what happens, as
   defined in <a href="rfc6378.html#section-4.3.3">Section 4.3.3 of RFC 6378</a>:

      When a LER is in a remote state, i.e., state transition in
      reaction to a PSC message received from the far-end LER, and
      receives a new PSC message from the far-end LER that indicates a
      contradictory state, e.g., in remote Unavailable state receiving a
      remote FS(1,1) message, then the PSC Control logic SHALL
      reevaluate all inputs (both the local input and the remote
      message) as if the LER is in the Normal state.

   This section extends that paragraph to handle the first two cases.
   The essence of the quoted paragraph is that when faced with multiple
   inputs, PSC must reevaluate any changes as if it were in Normal
   state.  So, the quoted paragraph is replaced with the following text:

      The PSC Control logic may simultaneously have Local and Remote
      requests, and the highest priority of these requests ultimately
      drives the behavior of the PSC Control logic.  When this highest-
      priority request is removed or is replaced with another input,
      then the PSC Control logic SHALL immediately reevaluate all inputs
      (both the local input and the remote message), transitioning into
      a new state only upon reevaluation of all inputs.








<span class="grey">Osborne                      Standards Track                    [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc7324.html">RFC 7324</a>                       PSC Updates                     July 2014</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20Security%20Considerations"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  Security Considerations</span>

   These changes and clarifications raise no new security concerns.  <a href="rfc6941.html">RFC</a>
   <a href="rfc6941.html">6941</a> [<a href="rfc6941.html" title='"MPLS Transport Profile (MPLS-TP) Security Framework"'>RFC6941</a>] provides the baseline security discussion for MPLS-TP,
   and PSC (as described in both <a href="rfc6378.html">RFC 6378</a> and this document) falls under
   that umbrella.  Additionally, <a href="#section-2.2">Section 2.2</a> clarifies how to react to
   malformed or unexpected messages.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  IANA Considerations</span>

   IANA has marked the value 0 in the "MPLS PSC TLV Registry" as
   "Reserved, not to be allocated" and updated the references to show
   [<a href="rfc6378.html" title='"MPLS Transport Profile (MPLS-TP) Linear Protection"'>RFC6378</a>] and this document (<a href="rfc7324.html">RFC 7324</a>).  Note that this document
   provides documentation of an action already taken by IANA but not
   recorded in <a href="rfc6378.html">RFC 6378</a>.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/9.%20%20Acknowledgements"></a><a class="selflink" href="#section-9" name="section-9">9</a>.  Acknowledgements</span>

   The author of this document thanks Taesik Cheung, Alessandro
   D'Alessandro, Annamaria Fulignoli, Sagar Soni, George Swallow, and
   Yaacov Weingarten for their contributions and review, and Adrian
   Farrel for the text of <a href="#section-2">Section 2</a>.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/10.%20%20References"></a><a class="selflink" href="#section-10" name="section-10">10</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/10.1.%20%20Normative%20References"></a><a class="selflink" href="#section-10.1" name="section-10.1">10.1</a>.  Normative References</span>

   [<a id="ref-RFC2119" name="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a id="ref-RFC6378" name="ref-RFC6378">RFC6378</a>]  Weingarten, Y., Bryant, S., Osborne, E., Sprecher, N., and
              A. Fulignoli, "MPLS Transport Profile (MPLS-TP) Linear
              Protection", <a href="rfc6378.html">RFC 6378</a>, October 2011.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/10.2.%20%20Informative%20References"></a><a class="selflink" href="#section-10.2" name="section-10.2">10.2</a>.  Informative References</span>

   [<a id="ref-LIAISON" name="ref-LIAISON">LIAISON</a>]  ITU-T SG15, "Liaison Statement: Recommendation ITU-T
              G.8131/Y.1382 revision - Linear protection switching for
              MPLS-TP networks", &lt;<a href="https://datatracker.ietf.org/liaison/1205/">https://datatracker.ietf.org/</a>
              <a href="https://datatracker.ietf.org/liaison/1205/">liaison/1205/</a>&gt;.

   [<a id="ref-RFC6941" name="ref-RFC6941">RFC6941</a>]  Fang, L., Niven-Jenkins, B., Mansfield, S., and R.
              Graveman, "MPLS Transport Profile (MPLS-TP) Security
              Framework", <a href="rfc6941.html">RFC 6941</a>, April 2013.







<span class="grey">Osborne                      Standards Track                   [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc7324.html">RFC 7324</a>                       PSC Updates                     July 2014</span>


   [<a id="ref-RFC7271" name="ref-RFC7271">RFC7271</a>]  Ryoo, J., Gray, E., van Helvoort, H., D'Alessandro, A.,
              Cheung, T., and E. Osborne, "MPLS Transport Profile (MPLS-
              TP) Linear Protection to Match the Operational
              Expectations of Synchronous Digital Hierarchy, Optical
              Transport Network, and Ethernet Transport Network
              Operators", <a href="rfc7271.html">RFC 7271</a>, June 2014.

Author's Address

   Eric Osborne

   EMail: eric.osborne@notcom.com







































Osborne                      Standards Track                   [Page 11]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc7324 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:22 GMT --></html>