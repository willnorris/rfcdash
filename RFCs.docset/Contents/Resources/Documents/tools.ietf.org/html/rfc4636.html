<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc4636 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:40 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="draft-perkins-mip4-faerr" name="DC.Relation.Replaces"/>
<meta content="urn:ietf:rfc:4636" name="DC.Identifier"/>
<meta content="October, 2006" name="DC.Date.Issued"/>
<meta content="Charles E. Perkins &lt;charles.perkins@.nokia.com&gt;" name="DC.Creator"/>
<meta content="This document specifies a new extension for use by Foreign Agents
operating Mobile IP for IPv4. Currently, a foreign agent cannot supply
status information without destroying the ability for a mobile node to
verify authentication data supplied by the home agent. The new
extension solves this problem by making a better place for the foreign
agent to provide its status information to the mobile node.
[STANDARDS-TRACK]" name="DC.Description.Abstract"/>
<meta content="Foreign Agent Error Extension for Mobile IPv4" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 4636 - Foreign Agent Error Extension for Mobile IPv4</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgblue" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc4636.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc4636" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-mip4-faerr" title="draft-ietf-mip4-faerr">draft-ietf-mip4...</a>] [<a href="https://datatracker.ietf.org/doc/rfc4636" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc4636" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc4636" title="Side-by-side diff">Diff2</a>] [<a href="https://www.rfc-editor.org/errata_search.php?rfc=4636">Errata</a>]</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                       PROPOSED STANDARD</span><br/>
<span class="pre noprint docinfo">                                                            <span style="color: #C00;">Errata Exist</span></span><br/>
<pre>Network Working Group                                         C. Perkins
Request for Comments: 4636                         Nokia Research Center
Category: Standards Track                                   October 2006


             <span class="h1">Foreign Agent Error Extension for Mobile IPv4</span>

Status of This Memo

   This document specifies an Internet standards track protocol for the
   Internet community, and requests discussion and suggestions for
   improvements.  Please refer to the current edition of the "Internet
   Official Protocol Standards" (STD 1) for the standardization state
   and status of this protocol.  Distribution of this memo is unlimited.

Copyright Notice

   Copyright (C) The Internet Society (2006).

Abstract

   This document specifies a new extension for use by Foreign Agents
   operating Mobile IP for IPv4.  Currently, a foreign agent cannot
   supply status information without destroying the ability for a mobile
   node to verify authentication data supplied by the home agent.  The
   new extension solves this problem by making a better place for the
   foreign agent to provide its status information to the mobile node.
























<span class="grey">Perkins                     Standards Track                     [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc4636.html">RFC 4636</a>                   FA Error Extension               October 2006</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   This document specifies a new non-skippable extension for use by
   Foreign Agents operating Mobile IP for IPv4 [<a href="#ref-4" title='"IP Mobility Support for IPv4"'>4</a>].  The new extension
   option allows a foreign agent to supply an error code without
   disturbing the data supplied by the Home Agent within the
   Registration Reply message.  In this way, the mobile node can verify
   that the Registration Reply message was generated by the Home Agent
   even in cases where the foreign agent is required by protocol to
   insert new status information into the Registration Reply message.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20Terminology"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  Terminology</span>

   The keywords "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in <a href="rfc2119.html">RFC 2119</a> [<a href="#ref-1" title='"Key words for use in RFCs to Indicate Requirement Levels"'>1</a>].  Other
   terminology is used as already defined in [<a href="#ref-4" title='"IP Mobility Support for IPv4"'>4</a>].

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20FA%20Error%20Extension%20Format"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  FA Error Extension Format</span>

   The format of the FA Error Extension conforms to the Short Extension
   format specified for Mobile IPv4 [<a href="#ref-4" title='"IP Mobility Support for IPv4"'>4</a>].  The FA Error Extension is not
   skippable.

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |     Type      |   Length      |    Sub-Type   |     Status    |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

      Type

         45

      Length

         2

      Sub-Type

         0

      Status

         A status code used by the foreign agent to supply status
         information to the mobile node.





<span class="grey">Perkins                     Standards Track                     [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc4636.html">RFC 4636</a>                   FA Error Extension               October 2006</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Operation%20and%20Use%20of%20the%20FA%20Error%20Extension"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Operation and Use of the FA Error Extension</span>

   The FA Error Extension is only valid for use within Mobile IPv4
   Registration Reply messages.  The FA Error Extension is not
   skippable.  A mobile node that cannot correctly interpret the
   contents of the FA Error Extension MUST NOT use the care-of address
   provided in the Registration Reply message, until another
   Registration Request message has been sent and a successful
   Registration Reply message received.

   Status codes allowable for use within the FA Error Extension are
   within the range 64-127.  The currently specified codes are as
   follows:

      64 reason unspecified
      65 administratively prohibited
      66 insufficient resources
      68 home agent failed authentication
      71 poorly formed Reply
      77 invalid care-of address
      78 registration timeout

   as defined in <a href="rfc3344.html">RFC 3344</a> [<a href="#ref-4" title='"IP Mobility Support for IPv4"'>4</a>] for use by the Foreign Agent.  Status
   codes for use with the FA Error extensions must not be differently
   defined for use in the Code field of Registration Reply messages.

   When a foreign agent appends a FA Error Extension to the Registration
   Reply as received from the Home Agent, it has to update the UDP
   Length field in the UDP header [<a href="#ref-5" title='"User Datagram Protocol"'>5</a>] to account for the extra 4 bytes
   of length.

   This document updates the Mobile IP base specification [<a href="#ref-4" title='"IP Mobility Support for IPv4"'>4</a>] regarding
   the procedures followed by the foreign agent in the case that the
   home agent fails authentication.  Instead of modifying the "status"
   field of the Registration Reply to contain the value 68, now the
   foreign agent should append the Foreign Agent Error Extension
   containing the status value 68.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20Mobile%20Node%20Considerations"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  Mobile Node Considerations</span>

   If a mobile node receives a successful Registration Reply (status
   code 0 or 1), with a FA Error Extension indicating that the foreign
   agent is not honoring said Registration Reply, the mobile node SHOULD
   then send a deregistration message to the home agent.  In this way,
   the home agent will not maintain a registration status that is
   inconsistent with the status maintained by the foreign agent.





<span class="grey">Perkins                     Standards Track                     [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc4636.html">RFC 4636</a>                   FA Error Extension               October 2006</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/6.%20%20Foreign%20Agent%20Considerations"></a><a class="selflink" href="#section-6" name="section-6">6</a>.  Foreign Agent Considerations</span>

   When denying a successful Registration Reply, the Foreign Agent
   SHOULD send a Registration Revocation message [<a href="#ref-2" title='"Registration Revocation in Mobile IPv4"'>2</a>] to the Home Agent
   if a mobility security association exists between them.  For cases
   when the foreign agent does have the required security association,
   this way of informing the home agent does not have the vulnerability
   from detrimental actions by malicious foreign agents, as noted in
   <a href="#section-8">section 8</a>.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/7.%20%20IANA%20Considerations"></a><a class="selflink" href="#section-7" name="section-7">7</a>.  IANA Considerations</span>

   This specification reserves one number for the FA Error Extension
   (see <a href="#section-3">section 3</a>) from the space of numbers for non-skippable mobility
   extensions (i.e., 0-127) defined in the specification for Mobile IPv4
   [<a href="#ref-4" title='"IP Mobility Support for IPv4"'>4</a>].

   This specification also creates a new number space of sub-types for
   the type number of this extension.  Sub-type zero is to be allocated
   from this number space for the protocol extension specified in this
   document.  Similar to the procedures specified for Mobile IP [<a href="#ref-4" title='"IP Mobility Support for IPv4"'>4</a>]
   number spaces, future allocations from this number space require
   expert review [<a href="#ref-3" title='"Guidelines for Writing an IANA Considerations Section in RFCs"'>3</a>].

   The status codes that are allowable in the FA Error Extension are a
   subset of the status codes defined in the specification for Mobile
   IPv4 [<a href="#ref-4" title='"IP Mobility Support for IPv4"'>4</a>].  If, in the future, additional status codes are defined for
   Mobile IPv4, the definition for each new status code must indicate
   whether the new status code is allowable for use in the FA Error
   Extension.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/8.%20%20Security%20Considerations"></a><a class="selflink" href="#section-8" name="section-8">8</a>.  Security Considerations</span>

   The extension in this document improves the security features of
   Mobile IPv4 by allowing the mobile node to be assured of the
   authenticity of the information supplied within a Registration
   Request.  Previously, whenever the foreign agent was required to
   provide status information to the mobile node, it could only do so by
   destroying the ability of the mobile device to verify the Mobile-Home
   Authentication Extension data.

   In many common cases, the mobile node will not have a security
   association with the foreign agent that has sent the extension.
   Thus, the mobile node will be unable to ascertain that the foreign
   agent sending the extended Registration Reply message is the same
   foreign agent that earlier received the associated Registration
   Request from the mobile node.  Because of this, a malicious foreign
   agent could cause a mobile node to operate as if the registration had



<span class="grey">Perkins                     Standards Track                     [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc4636.html">RFC 4636</a>                   FA Error Extension               October 2006</span>


   failed, when in fact its home agent and a correctly operating foreign
   agent had both accepted the mobile node's Registration Request.  In
   order to reduce the vulnerability to such maliciously transmitted
   Registration Reply messages with the unauthenticated extension, the
   mobile node MAY delay processing of such denied Registration Reply
   messages for a short while in order to determine whether another
   successful Registration Reply might be received from the foreign
   agent.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/9.%20%20Acknowledgements"></a><a class="selflink" href="#section-9" name="section-9">9</a>.  Acknowledgements</span>

   Thanks to Kent Leung and Henrik Lefkowetz for suggested improvements
   to this specification.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/10.%20%20Normative%20References"></a><a class="selflink" href="#section-10" name="section-10">10</a>.  Normative References</span>

   [<a id="ref-1" name="ref-1">1</a>] Bradner, S., "Key words for use in RFCs to Indicate Requirement
       Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a id="ref-2" name="ref-2">2</a>] Glass, S. and M. Chandra, "Registration Revocation in Mobile
       IPv4", <a href="rfc3543.html">RFC 3543</a>, August 2003.

   [<a id="ref-3" name="ref-3">3</a>] Narten, T. and H. Alvestrand, "Guidelines for Writing an IANA
       Considerations Section in RFCs", <a href="https://tools.ietf.org/html/bcp26">BCP 26</a>, <a href="rfc2434.html">RFC 2434</a>, October 1998.

   [<a id="ref-4" name="ref-4">4</a>] Perkins, C., "IP Mobility Support for IPv4", <a href="rfc3344.html">RFC 3344</a>, August
       2002.

   [<a id="ref-5" name="ref-5">5</a>] Postel, J., "User Datagram Protocol", STD 6, <a href="rfc768.html">RFC 768</a>, August
       1980.

Author's Address

   Charles E. Perkins
   Palo Alto Systems Research Lab
   Nokia Research Center
   975 Page Mill Road, Suite 200
   Palo Alto, CA 94304-1003

   Phone: +1 650-496-4402
   Fax:   +1-650-739-0779
   EMail: charles.perkins@nokia.com









<span class="grey">Perkins                     Standards Track                     [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc4636.html">RFC 4636</a>                   FA Error Extension               October 2006</span>


Full Copyright Statement

   Copyright (C) The Internet Society (2006).

   This document is subject to the rights, licenses and restrictions
   contained in <a href="https://tools.ietf.org/html/bcp78">BCP 78</a>, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY AND THE INTERNET
   ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR IMPLIED,
   INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE
   INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and <a href="https://tools.ietf.org/html/bcp79">BCP 79</a>.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   <a href="http://www.ietf.org/ipr">http://www.ietf.org/ipr</a>.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.

Acknowledgement

   Funding for the RFC Editor function is provided by the IETF
   Administrative Support Activity (IASA).







Perkins                     Standards Track                     [Page 6]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc4636 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:40 GMT --></html>