<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><!-- Mirrored from tools.ietf.org/html/rfc7146 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:23 GMT --><!-- Added by HTTrack --><head><meta content="text/html;charset=utf-8" http-equiv="content-type"/><!-- /Added by HTTrack -->

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <meta content="index,follow" name="robots"/>
    <meta content="rfcmarkup version 1.126" name="creator"/>
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/>
<meta content="urn:ietf:rfc:7146" name="DC.Identifier"/>
<meta content="RFC 3723 specifies IPsec requirements for block storage protocols over
IP (e.g., Internet Small Computer System Interface (iSCSI)) based on
IPsec v2 (RFC 2401 and related RFCs); those requirements have
subsequently been applied to remote direct data placement protocols,
e.g., the Remote Direct Memory Access Protocol (RDMAP). This document
updates RFC 3723's IPsec requirements to IPsec v3 (RFC 4301 and
related RFCs) and makes some changes to required algorithms based on
developments in cryptography since RFC 3723 was published." name="DC.Description.Abstract"/>
<meta content="Koning, Paul" name="DC.Creator"/>
<meta content="Black, David" name="DC.Creator"/>
<meta content="April, 2014" name="DC.Date.Issued"/>
<meta content="Securing Block Storage Protocols over IP: RFC 3723 Requirements Update for IPsec v3" name="DC.Title"/>

    <link href="https://tools.ietf.org/images/rfc.png" rel="icon" type="image/png"/>
    <link href="https://tools.ietf.org/images/rfc.png" rel="shortcut icon" type="image/png"/>
    <title>RFC 7146 - Securing Block Storage Protocols over IP: RFC 3723 Requirements Update for IPsec v3</title>
    
    
    <style type="text/css">
	@media only screen 
	  and (min-width: 992px)
	  and (max-width: 1199px) {
	    body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 768px)
	  and (max-width: 991px) {
            body { font-size: 14pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-width: 480px)
	  and (max-width: 767px) {
            body { font-size: 11pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (max-width: 479px) {
            body { font-size: 8pt; }
            div.content { width: 96ex; margin: 0 auto; }
        }
	@media only screen 
	  and (min-device-width : 375px) 
	  and (max-device-width : 667px) {
            body { font-size: 9.5pt; }
            div.content { width: 96ex; margin: 0 1px; }
        }
	@media only screen 
	  and (min-device-width: 1200px) {
            body { font-size: 10pt; margin: 0 4em; }
            div.content { width: 96ex; margin: 0; }
        }
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>                   <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>                     <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>             <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>              <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td>      <td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td>         <td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard (old designation):</td> <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Internet Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>                  <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>                  <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
  <div class="content">
   <div style="height: 13px;">
      <div class="pre noprint docinfo bgblue" onclick="showElem('legend');" onmouseout="hideElem('legend')" onmouseover="this.style.cursor='pointer';" style="height: 6px; position: absolute;" title="Click for colour legend.">                                                                        </div>
      <div class="docinfo noprint pre legend" id="legend" onmouseout="hideElem('legend');" onmouseover="showElem('legend');" style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; ">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="index.html" title="Document search and retrieval page">Docs</a>] [<a href="https://tools.ietf.org/rfc/rfc7146.txt" title="Plaintext version of this document">txt</a>|<a href="https://tools.ietf.org/pdf/rfc7146" title="PDF version of this document">pdf</a>] [<a href="https://tools.ietf.org/html/draft-ietf-storm-ipsec-ips-update" title="draft-ietf-storm-ipsec-ips-update">draft-ietf-stor...</a>] [<a href="https://datatracker.ietf.org/doc/rfc7146" title="IESG Datatracker information for this document">Tracker</a>] [<a href="https://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=rfc7146" title="Inline diff (wdiff)">Diff1</a>] [<a href="https://tools.ietf.org/rfcdiff?url2=rfc7146" title="Side-by-side diff">Diff2</a>]         </span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<span class="pre noprint docinfo">                                                       PROPOSED STANDARD</span><br/>
<span class="pre noprint docinfo">                                                                        </span><br/>
<pre>Internet Engineering Task Force (IETF)                          D. Black
Request for Comments: 7146                                           EMC
Updates: <a href="rfc3720.html">3720</a>, <a href="rfc3723.html">3723</a>, <a href="rfc3821.html">3821</a>, <a href="rfc3822.html">3822</a>, <a href="rfc4018.html">4018</a>, <a href="rfc4172.html">4172</a>,                   P. Koning
         <a href="rfc4173.html">4173</a>, <a href="rfc4174.html">4174</a>, <a href="rfc5040.html">5040</a>, <a href="rfc5041.html">5041</a>, <a href="rfc5042.html">5042</a>, <a href="rfc5043.html">5043</a>,                        Dell
         5044, 5045, 5046, 5047, 5048                         April 2014
Category: Standards Track
ISSN: 2070-1721


               <span class="h1">Securing Block Storage Protocols over IP:</span>
               <span class="h1"><a href="rfc3723.html">RFC 3723</a> Requirements Update for IPsec v3</span>

Abstract

   <a href="rfc3723.html">RFC 3723</a> specifies IPsec requirements for block storage protocols
   over IP (e.g., Internet Small Computer System Interface (iSCSI))
   based on IPsec v2 (<a href="rfc2401.html">RFC 2401</a> and related RFCs); those requirements
   have subsequently been applied to remote direct data placement
   protocols, e.g., the Remote Direct Memory Access Protocol (RDMAP).
   This document updates <a href="rfc3723.html">RFC 3723</a>'s IPsec requirements to IPsec v3 (<a href="rfc4301.html">RFC</a>
   <a href="rfc4301.html">4301</a> and related RFCs) and makes some changes to required algorithms
   based on developments in cryptography since <a href="rfc3723.html">RFC 3723</a> was published.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="rfc5741.html#section-2">Section 2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc7146">http://www.rfc-editor.org/info/rfc7146</a>.















<span class="grey">Black &amp; Koning               Standards Track                    [Page 1]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-2" id="page-2" name="page-2"> </a>
<span class="grey"><a href="rfc7146.html">RFC 7146</a>            <a href="rfc3723.html">RFC 3723</a> Reqs Update for IPsec v3         April 2014</span>


Copyright Notice

   Copyright (c) 2014 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="https://tools.ietf.org/html/bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-3">3</a>
      <a href="#section-1.1">1.1</a>. Requirements Language ......................................<a href="#page-3">3</a>
      <a href="#section-1.2">1.2</a>. Summary of Changes to <a href="rfc3723.html">RFC 3723</a> .............................<a href="#page-4">4</a>
      <a href="#section-1.3">1.3</a>. Other Updated RFCs .........................................<a href="#page-4">4</a>
   <a href="#section-2">2</a>. ESP Requirements ................................................<a href="#page-6">6</a>
      <a href="#section-2.1">2.1</a>. Data Origin Authentication and Data Integrity Transforms ...<a href="#page-6">6</a>
      <a href="#section-2.2">2.2</a>. Confidentiality Transform Requirements .....................<a href="#page-7">7</a>
   <a href="#section-3">3</a>. IKEv1 and IKEv2 Requirements ....................................<a href="#page-8">8</a>
      <a href="#section-3.1">3.1</a>. Authentication Requirements ...............................<a href="#page-10">10</a>
      <a href="#section-3.2">3.2</a>. DH Group and PRF Requirements .............................<a href="#page-11">11</a>
   <a href="#section-4">4</a>. Security Considerations ........................................<a href="#page-11">11</a>
   <a href="#section-5">5</a>. References .....................................................<a href="#page-12">12</a>
      <a href="#section-5.1">5.1</a>. Normative References ......................................<a href="#page-12">12</a>
      <a href="#section-5.2">5.2</a>. Informative References ....................................<a href="#page-16">16</a>
   <a href="#appendix-A">Appendix A</a>. Block Cipher Birthday Bounds ..........................<a href="#page-17">17</a>
   <a href="#appendix-B">Appendix B</a>. Contributors ..........................................<a href="#page-17">17</a>


















<span class="grey">Black &amp; Koning               Standards Track                    [Page 2]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-3" id="page-3" name="page-3"> </a>
<span class="grey"><a href="rfc7146.html">RFC 7146</a>            <a href="rfc3723.html">RFC 3723</a> Reqs Update for IPsec v3         April 2014</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/1.%20%20Introduction"></a><a class="selflink" href="#section-1" name="section-1">1</a>.  Introduction</span>

   [<a id="ref-RFC3723" name="ref-RFC3723">RFC3723</a>] specifies IPsec requirements for block storage protocols
   over IP (e.g., iSCSI [<a href="rfc3720.html" title='"Internet Small Computer Systems Interface (iSCSI)"'>RFC3720</a>]) based on IPsec v2 ([<a href="rfc2401.html" title='"Security Architecture for the Internet Protocol"'>RFC2401</a>] and
   related RFCs); those requirements have subsequently been applied to
   remote direct data placement protocols, e.g., RDMAP [<a href="rfc5040.html" title='"A Remote Direct Memory Access Protocol Specification"'>RFC5040</a>].  This
   document updates <a href="rfc3723.html">RFC 3723</a>'s IPsec requirements to IPsec v3 ([<a href="rfc4301.html" title='"Security Architecture for the Internet Protocol"'>RFC4301</a>]
   and related RFCs) to reflect developments since <a href="rfc3723.html">RFC 3723</a> was
   published.

   For brevity, this document uses the term "block storage protocols" to
   refer to all protocols to which <a href="rfc3723.html">RFC 3723</a>'s requirements apply; see
   <a href="#section-1.3">Section 1.3</a> for details.

   In addition to the IPsec v2 requirements in <a href="rfc3723.html">RFC 3723</a>, IPsec v3, as
   specified in [<a href="rfc4301.html" title='"Security Architecture for the Internet Protocol"'>RFC4301</a>] and related RFCs (e.g., IKEv2 [<a href="rfc5996.html" title='"Internet Key Exchange Protocol Version 2 (IKEv2)"'>RFC5996</a>]),
   SHOULD be implemented for block storage protocols.  Retention of the
   mandatory requirement for IPsec v2 provides interoperability with
   existing implementations, and the strong recommendation for IPsec v3
   encourages implementers to move forward to that newer version of
   IPsec.

   Cryptographic developments since the publication of <a href="rfc3723.html">RFC 3723</a>
   necessitate changes to the encryption transform requirements for
   IPsec v2, as explained further in <a href="#section-2.2">Section 2.2</a>; these updated
   requirements also apply to IPsec v3.

   Block storage protocols can be expected to operate at high data rates
   (multiple gigabits/second).  The cryptographic requirements in this
   document are strongly influenced by that expectation; an important
   example is that Triple Data Encryption Standard Cipher Block Chaining
   (3DES CBC) is no longer recommended for block storage protocols due
   to the frequent rekeying impacts of 3DES's 64-bit block size at high
   data rates.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.1.%20%20Requirements%20Language"></a><a class="selflink" href="#section-1.1" name="section-1.1">1.1</a>.  Requirements Language</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in
   [<a href="rfc2119.html" title='"Key words for use in RFCs to Indicate Requirement Levels"'>RFC2119</a>].










<span class="grey">Black &amp; Koning               Standards Track                    [Page 3]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-4" id="page-4" name="page-4"> </a>
<span class="grey"><a href="rfc7146.html">RFC 7146</a>            <a href="rfc3723.html">RFC 3723</a> Reqs Update for IPsec v3         April 2014</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.2.%20%20Summary%20of%20Changes%20to%20RFC%203723"></a><a class="selflink" href="#section-1.2" name="section-1.2">1.2</a>.  Summary of Changes to <a href="rfc3723.html">RFC 3723</a></span>

   This document makes the following changes to <a href="rfc3723.html">RFC 3723</a>:

   o  Adds requirements that IPsec v3 SHOULD be implemented
      (Encapsulating Security Payload (ESPv3) and IKEv2) in addition to
      IPsec v2 (see <a href="#section-1">Section 1</a>).

   o  Requires extended sequence numbers for both ESPv2 and ESPv3 (see
      <a href="#section-2">Section 2</a>).

   o  Clarifies key-size requirements for AES CBC MAC with XCBC
      extensions (MUST implement 128-bit keys; see <a href="#section-2.1">Section 2.1</a>).

   o  Adds IPsec v3 requirements for AES Galois Message Authentication
      Code (GMAC) and Galois/Counter Mode (GCM) (SHOULD implement when
      IKEv2 is supported; see Sections <a href="#section-2.1">2.1</a> and <a href="#section-2.2">2.2</a>).

   o  Removes implementation requirements for 3DES CBC and AES in
      Counter mode (AES CTR) (changes requirements for both to "MAY
      implement").  Adds a "MUST implement" requirement for AES CBC (see
      <a href="#section-2.2">Section 2.2</a>).

   o  Adds specific IKEv2 implementation requirements (see <a href="#section-3">Section 3</a>).

   o  Removes the requirement that IKEv1 use UDP port 500 (see
      <a href="#section-3">Section 3</a>).

   o  Allows the use of the Online Certificate Status Protocol (OCSP) in
      addition to Certificate Revocation Lists (CRLs) to check
      certificates, and changes the Diffie-Hellman group size
      recommendation to a minimum of 2048 bits (see <a href="#section-3">Section 3</a>).

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/1.3.%20%20Other%20Updated%20RFCs"></a><a class="selflink" href="#section-1.3" name="section-1.3">1.3</a>.  Other Updated RFCs</span>

   <a href="rfc3723.html">RFC 3723</a>'s IPsec requirements have been applied to a number of
   protocols.  For that reason, in addition to updating <a href="rfc3723.html">RFC 3723</a>'s IPsec
   requirements, this document also updates the IPsec requirements for
   each protocol that uses <a href="rfc3723.html">RFC 3723</a>; that is, the following RFCs are
   updated -- in each case, the update is solely to the IPsec
   requirements:

   o  [<a href="rfc3720.html" title='"Internet Small Computer Systems Interface (iSCSI)"'>RFC3720</a>] "Internet Small Computer Systems Interface (iSCSI)"

   o  [<a href="rfc3821.html" title='"Fibre Channel Over TCP/IP (FCIP)"'>RFC3821</a>] "Fibre Channel Over TCP/IP (FCIP)"

   o  [<a href="rfc3822.html" title='"Finding Fibre Channel over TCP/IP (FCIP) Entities Using Service Location Protocol version 2 (SLPv2)"'>RFC3822</a>] "Finding Fibre Channel over TCP/IP (FCIP) Entities Using
      Service Location Protocol version 2 (SLPv2)"



<span class="grey">Black &amp; Koning               Standards Track                    [Page 4]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-5" id="page-5" name="page-5"> </a>
<span class="grey"><a href="rfc7146.html">RFC 7146</a>            <a href="rfc3723.html">RFC 3723</a> Reqs Update for IPsec v3         April 2014</span>


   o  [<a href="rfc4018.html" title='"Finding Internet Small Computer Systems Interface (iSCSI) Targets and Name Servers by Using Service Location Protocol version 2 (SLPv2)"'>RFC4018</a>] "Finding Internet Small Computer Systems Interface
      (iSCSI) Targets and Name Servers by Using Service Location
      Protocol version 2 (SLPv2)"

   o  [<a href="rfc4172.html" title='"iFCP - A Protocol for Internet Fibre Channel Storage Networking"'>RFC4172</a>] "iFCP - A Protocol for Internet Fibre Channel Storage
      Networking"

   o  [<a href="rfc4173.html" title='"Bootstrapping Clients using the Internet Small Computer System Interface (iSCSI) Protocol"'>RFC4173</a>] "Bootstrapping Clients using the Internet Small Computer
      System Interface (iSCSI) Protocol"

   o  [<a href="rfc4174.html" title='"The IPv4 Dynamic Host Configuration Protocol (DHCP) Option for the Internet Storage Name Service"'>RFC4174</a>] "The IPv4 Dynamic Host Configuration Protocol (DHCP)
      Option for the Internet Storage Name Service"

   o  [<a href="rfc5040.html" title='"A Remote Direct Memory Access Protocol Specification"'>RFC5040</a>] "A Remote Direct Memory Access Protocol Specification"

   o  [<a href="rfc5041.html" title='"Direct Data Placement over Reliable Transports"'>RFC5041</a>] "Direct Data Placement over Reliable Transports"

   o  [<a href="rfc5042.html" title='"Direct Data Placement Protocol (DDP) / Remote Direct Memory Access Protocol (RDMAP) Security"'>RFC5042</a>] "Direct Data Placement Protocol (DDP) / Remote Direct
      Memory Access Protocol (RDMAP) Security"

   o  [<a href="rfc5043.html" title='"Stream Control Transmission Protocol (SCTP) Direct Data Placement (DDP) Adaptation"'>RFC5043</a>] "Stream Control Transmission Protocol (SCTP) Direct Data
      Placement (DDP) Adaptation"

   o  [<a href="rfc5044.html" title='"Marker PDU Aligned Framing for TCP Specification"'>RFC5044</a>] "Marker PDU Aligned Framing for TCP Specification"

   o  [<a href="rfc5045.html" title='"Applicability of Remote Direct Memory Access Protocol (RDMA) and Direct Data Placement (DDP)"'>RFC5045</a>] "Applicability of Remote Direct Memory Access Protocol
      (RDMA) and Direct Data Placement (DDP)"

   o  [<a href="rfc5046.html" title='"Internet Small Computer System Interface (iSCSI) Extensions for Remote Direct Memory Access (RDMA)"'>RFC5046</a>] "Internet Small Computer System Interface (iSCSI)
      Extensions for Remote Direct Memory Access (RDMA)"

   o  [<a href="rfc5047.html" title='"DA: Datamover Architecture for the Internet Small Computer System Interface (iSCSI)"'>RFC5047</a>] "DA: Datamover Architecture for the Internet Small
      Computer System Interface (iSCSI)"

   o  [<a href="rfc5048.html" title='"Internet Small Computer System Interface (iSCSI) Corrections and Clarifications"'>RFC5048</a>] "Internet Small Computer System Interface (iSCSI)
      Corrections and Clarifications"

   [<a id="ref-RFC3721" name="ref-RFC3721">RFC3721</a>] and [<a href="rfc5387.html" title='"Problem and Applicability Statement for Better-Than-Nothing Security (BTNS)"'>RFC5387</a>] are not updated by this document, as their
   usage of <a href="rfc3723.html">RFC 3723</a> does not encompass its IPsec requirements.

   In addition, this document's updated IPsec requirements apply to the
   new specifications for iSCSI [<a href="rfc7143.html" title='"Internet Small Computer System Interface (iSCSI) Protocol (Consolidated)"'>RFC7143</a>] and iSCSI Extensions for RDMA
   (iSER) [<a href="rfc7145.html" title='"Internet Small Computer System Interface (iSCSI) Extensions for the Remote Direct Memory Access (RDMA) Specification"'>RFC7145</a>].

   This document uses the term "block storage protocols" to refer to the
   protocols (listed above) to which <a href="rfc3723.html">RFC 3723</a>'s requirements (as updated
   by the requirements in this document) apply.




<span class="grey">Black &amp; Koning               Standards Track                    [Page 5]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-6" id="page-6" name="page-6"> </a>
<span class="grey"><a href="rfc7146.html">RFC 7146</a>            <a href="rfc3723.html">RFC 3723</a> Reqs Update for IPsec v3         April 2014</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/2.%20%20ESP%20Requirements"></a><a class="selflink" href="#section-2" name="section-2">2</a>.  ESP Requirements</span>

   <a href="rfc3723.html">RFC 3723</a> requires that implementations MUST support IPsec ESPv2
   [<a href="rfc2406.html" title='"IP Encapsulating Security Payload (ESP)"'>RFC2406</a>] in tunnel mode as part of IPsec v2 to provide security for
   both control packets and data packets; and that when ESPv2 is
   utilized, per-packet data origin authentication, integrity, and
   replay protection MUST be provided.

   This document modifies <a href="rfc3723.html">RFC 3723</a> to require that implementations
   SHOULD also support IPsec ESPv3 [<a href="rfc4303.html" title='"IP Encapsulating Security Payload (ESP)"'>RFC4303</a>] in tunnel mode as part of
   IPsec v3 to provide security for both control packets and data
   packets; per-packet data origin authentication, integrity, and replay
   protection MUST be provided when ESPv3 is utilized.

   At the high speeds at which block storage protocols are expected to
   operate, a single IPsec security association (SA) could rapidly
   exhaust the ESP 32-bit sequence number space, requiring frequent
   rekeying of the SA, as rollover of the ESP sequence number within a
   single SA is prohibited for both ESPv2 [<a href="rfc2406.html" title='"IP Encapsulating Security Payload (ESP)"'>RFC2406</a>] and ESPv3 [<a href="rfc4303.html" title='"IP Encapsulating Security Payload (ESP)"'>RFC4303</a>].
   In order to provide the means to avoid this potentially undesirable
   frequent rekeying, implementations that are capable of operating at
   speeds of 1 gigabit/second or higher MUST implement extended (64-bit)
   sequence numbers for ESPv2 (and ESPv3, if supported) and SHOULD use
   extended sequence numbers for all block storage protocol traffic.
   Extended sequence number negotiation as part of security association
   establishment is specified in [<a href="rfc4304.html" title='"Extended Sequence Number (ESN) Addendum to IPsec Domain of Interpretation (DOI) for Internet Security Association and Key Management Protocol (ISAKMP)"'>RFC4304</a>] for IKEv1 and [<a href="rfc5996.html" title='"Internet Key Exchange Protocol Version 2 (IKEv2)"'>RFC5996</a>] for
   IKEv2.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.1.%20%20Data%20Origin%20Authentication%20and%20Data%20Integrity%20Transforms"></a><a class="selflink" href="#section-2.1" name="section-2.1">2.1</a>.  Data Origin Authentication and Data Integrity Transforms</span>

   <a href="rfc3723.html">RFC 3723</a> requires that:

   o  HMAC-SHA1 MUST be implemented in the form of HMAC-SHA-1-96
      [<a href="rfc2404.html" title='"The Use of HMAC-SHA-1-96 within ESP and AH"'>RFC2404</a>].

   o  AES CBC MAC with XCBC extensions SHOULD be implemented [<a href="rfc3566.html" title='"The AES-XCBC-MAC-96 Algorithm and Its Use With IPsec"'>RFC3566</a>].

   This document clarifies <a href="rfc3723.html">RFC 3723</a>'s key-size requirements for
   implementations of AES CBC MAC with XCBC extensions; 128-bit keys
   MUST be supported, and other key sizes MAY also be supported.

   This document also adds a requirement for IPsec v3:

   o  Implementations that support IKEv2 [<a href="rfc5996.html" title='"Internet Key Exchange Protocol Version 2 (IKEv2)"'>RFC5996</a>] SHOULD also implement
      AES GMAC [<a href="rfc4543.html" title='"The Use of Galois Message Authentication Code (GMAC) in IPsec ESP and AH"'>RFC4543</a>].  AES GMAC implementations MUST support 128-bit
      keys and MAY support other key sizes.





<span class="grey">Black &amp; Koning               Standards Track                    [Page 6]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-7" id="page-7" name="page-7"> </a>
<span class="grey"><a href="rfc7146.html">RFC 7146</a>            <a href="rfc3723.html">RFC 3723</a> Reqs Update for IPsec v3         April 2014</span>


   The rationale for the added requirement is that GMAC is more amenable
   to hardware implementations that may be preferable for the high data
   rates at which block storage protocols can be expected to operate.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/2.2.%20%20Confidentiality%20Transform%20Requirements"></a><a class="selflink" href="#section-2.2" name="section-2.2">2.2</a>.  Confidentiality Transform Requirements</span>

   <a href="rfc3723.html">RFC 3723</a> requires that:

   o  3DES in CBC mode (3DES CBC) [<a href="rfc2451.html" title='"The ESP CBC-Mode Cipher Algorithms"'>RFC2451</a>] [<a href="#ref-triple-des-spec">triple-des-spec</a>] MUST be
      supported.

   o  AES in Counter mode (AES CTR) [<a href="rfc3686.html" title='"Using Advanced Encryption Standard (AES) Counter Mode With IPsec Encapsulating Security Payload (ESP)"'>RFC3686</a>] SHOULD be supported.

   o  NULL encryption [<a href="rfc2410.html" title='"The NULL Encryption Algorithm and Its Use With IPsec"'>RFC2410</a>] MUST be supported.

   The above requirements from <a href="rfc3723.html">RFC 3723</a> regarding 3DES CBC and AES CTR
   are replaced in this document by requirements that both 3DES CBC and
   AES CTR MAY be implemented.  The NULL encryption requirement is not
   changed by this document.  The 3DES CBC requirement matched the basic
   encryption interoperability requirement for IPsec v2.  At the time of
   <a href="rfc3723.html">RFC 3723</a>'s publication, AES in Counter mode was the encryption
   transform that was most amenable to hardware implementation, as
   hardware implementation may be preferable for the high data rates at
   which block storage protocols can be expected to operate.  This
   document changes both of these requirements, based on cryptographic
   developments since the publication of <a href="rfc3723.html">RFC 3723</a>.

   The requirement for 3DES CBC has become problematic due to 3DES's
   64-bit block size; i.e., the core cipher encrypts or decrypts 64 bits
   at a time.  Security weaknesses in encryption start to appear as the
   amount of data encrypted under a single key approaches the birthday
   bound of 32 GiB (gibibytes) for a cipher with a 64-bit block size;
   see <a href="#appendix-A">Appendix A</a> and [<a href="#ref-triple-des-birthday">triple-des-birthday</a>].  It is prudent to rekey
   well before that bound is reached, and 32 GiB or some significant
   fraction thereof is less than the amount of data that a block storage
   protocol may transfer in a single session.  This may require frequent
   rekeying, e.g., to obtain an order-of-magnitude (10x) safety margin
   by rekeying after 3 GiB on a multi-gigabit/sec link.  In contrast,
   AES has a 128-bit block size, which results in a much larger birthday
   bound (2^68 bytes); see <a href="#appendix-A">Appendix A</a>.  AES CBC [<a href="rfc3602.html" title='"The AES-CBC Cipher Algorithm and Its Use with IPsec"'>RFC3602</a>] is the primary
   mandatory-to-implement encryption transform for interoperability and
   hence is the appropriate mandatory-to-implement transform replacement
   for 3DES CBC.

   AES in Counter mode (AES CTR) is no longer the encryption transform
   that is most amenable to hardware implementation.  That
   characterization now applies to AES GCM [<a href="rfc4106.html" title='"The Use of Galois/Counter Mode (GCM) in IPsec Encapsulating Security Payload (ESP)"'>RFC4106</a>], which provides
   both encryption and integrity protection in a single cryptographic



<span class="grey">Black &amp; Koning               Standards Track                    [Page 7]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-8" id="page-8" name="page-8"> </a>
<span class="grey"><a href="rfc7146.html">RFC 7146</a>            <a href="rfc3723.html">RFC 3723</a> Reqs Update for IPsec v3         April 2014</span>


   mechanism (in contrast, neither HMAC-SHA1 nor AES CBC MAC with XCBC
   extensions is well suited for hardware implementation, as both
   transforms do not pipeline well).  AES GCM is also capable of
   providing confidentiality protection for the IKEv2 key exchange
   protocol, but not the IKEv1 protocol [<a href="rfc5282.html" title='"Using Authenticated Encryption Algorithms with the Encrypted Payload of the Internet Key Exchange version 2 (IKEv2) Protocol"'>RFC5282</a>], and therefore the new
   AES GCM "SHOULD" requirement is based on the presence of support for
   IKEv2.

   For the reasons described in the preceding paragraphs, the
   confidentiality transform requirements in <a href="rfc3723.html">RFC 3723</a> are replaced by
   the following:

   o  3DES in CBC mode MAY be implemented (replaces <a href="rfc3723.html">RFC 3723</a>'s "MUST
      implement" requirement).

   o  AES in Counter mode (AES CTR) MAY be implemented (replaces
      <a href="rfc3723.html">RFC 3723</a>'s "SHOULD implement" requirement).

   o  AES in CBC mode MUST be implemented.  AES CBC implementations MUST
      support 128-bit keys and MAY support other key sizes.

   o  Implementations that support IKEv2 SHOULD also implement AES GCM.
      AES GCM implementations MUST support 128-bit keys and MAY support
      other key sizes.

   o  NULL encryption [<a href="rfc2410.html" title='"The NULL Encryption Algorithm and Its Use With IPsec"'>RFC2410</a>] MUST be supported.

   The requirement for support of NULL encryption enables the use of SAs
   that provide data origin authentication and data integrity, but not
   confidentiality.

   Other transforms MAY be implemented in addition to those listed
   above.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/3.%20%20IKEv1%20and%20IKEv2%20Requirements"></a><a class="selflink" href="#section-3" name="section-3">3</a>.  IKEv1 and IKEv2 Requirements</span>

   Note: To avoid ambiguity, the original IKE protocol [<a href="rfc2409.html" title='"The Internet Key Exchange (IKE)"'>RFC2409</a>] is
   referred to as "IKEv1" in this document.

   This document adds requirements for IKEv2 usage with block storage
   protocols and makes the following two changes to the IKEv1
   requirements in <a href="rfc3723.html">RFC 3723</a> (the new Diffie-Hellman (DH) group
   requirement also applies to IKEv2):

   o  When DH groups are used, a DH group of at least 2048 bits SHOULD
      be offered as a part of all proposals to create IPsec security
      associations.  The recommendation for the use of 1024-bit DH




<span class="grey">Black &amp; Koning               Standards Track                    [Page 8]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-9" id="page-9" name="page-9"> </a>
<span class="grey"><a href="rfc7146.html">RFC 7146</a>            <a href="rfc3723.html">RFC 3723</a> Reqs Update for IPsec v3         April 2014</span>


      groups with 3DES CBC and HMAC-SHA1 has been removed; the use of
      1024-bit DH groups is NOT RECOMMENDED, and

   o  The requirement to use UDP port 500 is removed in order to allow
      NAT traversal [<a href="rfc3947.html" title='"Negotiation of NAT-Traversal in the IKE"'>RFC3947</a>].

   There are no other changes to <a href="rfc3723.html">RFC 3723</a>'s IKEv1 requirements, but many
   of them are restated in this document in order to provide context for
   the new IKEv2 requirements.

   <a href="rfc3723.html">RFC 3723</a> requires that IKEv1 [<a href="rfc2409.html" title='"The Internet Key Exchange (IKE)"'>RFC2409</a>] be supported for peer
   authentication, negotiation of security associations, and key
   management, using the IPsec domain of interpretation (DOI) [<a href="rfc2407.html" title='"The Internet IP Security Domain of Interpretation for ISAKMP"'>RFC2407</a>],
   and further requires that manual keying not be used since it does not
   provide the rekeying support necessary for operation at high data
   rates.  This document adds a requirement that IKEv2 [<a href="rfc5996.html" title='"Internet Key Exchange Protocol Version 2 (IKEv2)"'>RFC5996</a>] SHOULD
   be supported for peer authentication, negotiation of security
   associations, and key management.  The prohibition of manual keying
   as stated in <a href="rfc3723.html">RFC 3723</a> is extended to IKEv2; manual keying MUST NOT be
   used with any version of IPsec for protocols to which the
   requirements in this document apply.

   <a href="rfc3723.html">RFC 3723</a>'s requirements for IKEv1 mode implementation and usage are
   unchanged; this document does not extend those requirements to IKEv2
   because IKEv2 does not have modes.

   When IPsec is used, the receipt of an IKEv1 Phase 2 delete message or
   an IKEv2 INFORMATIONAL exchange that deletes the SA SHOULD NOT be
   interpreted as a reason for tearing down the block storage protocol
   connection (e.g., TCP-based).  If additional traffic is sent, a new
   SA will be created to protect that traffic.

   The method used to determine whether a block storage protocol
   connection should be established using IPsec is regarded as an issue
   of IPsec policy administration and thus is not defined in this
   document.  The method used by an implementation that supports both
   IPsec v2 and v3 to determine which versions of IPsec are supported by
   a block storage protocol peer is also regarded as an issue of IPsec
   policy administration and thus is also not defined in this document.
   If both IPsec v2 and v3 are supported by both endpoints of a block
   storage protocol connection, the use of IPsec v3 is RECOMMENDED.










<span class="grey">Black &amp; Koning               Standards Track                    [Page 9]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-10" id="page-10" name="page-10"> </a>
<span class="grey"><a href="rfc7146.html">RFC 7146</a>            <a href="rfc3723.html">RFC 3723</a> Reqs Update for IPsec v3         April 2014</span>


<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.1.%20%20Authentication%20Requirements"></a><a class="selflink" href="#section-3.1" name="section-3.1">3.1</a>.  Authentication Requirements</span>

   The authentication requirements for IKEv1 are unchanged by this
   document but are restated here for context, along with the
   authentication requirements for IKEv2:

   a.  Peer authentication using a pre-shared cryptographic key MUST be
       supported.  Certificate-based peer authentication using digital
       signatures MAY be supported.  For IKEv1 [<a href="rfc2409.html" title='"The Internet Key Exchange (IKE)"'>RFC2409</a>], peer
       authentication using the public key encryption methods specified
       in Sections <a href="#section-5.2">5.2</a> and <a href="#section-5.3">5.3</a> of [<a href="rfc2409.html" title='"The Internet Key Exchange (IKE)"'>RFC2409</a>] SHOULD NOT be used.

   b.  When digital signatures are used for authentication, all IKEv1
       and IKEv2 negotiators SHOULD use Certificate Request Payload(s)
       to specify the certificate authority and SHOULD check the
       certificate validity via the pertinent Certificate Revocation
       List (CRL) or the use of the Online Certificate Status Protocol
       (OCSP) [<a href="rfc6960.html" title='"X.509 Internet Public Key Infrastructure Online Certificate Status Protocol - OCSP"'>RFC6960</a>] before accepting a PKI certificate for use in
       authentication.  OCSP support within the IKEv2 protocol is
       specified in [<a href="rfc4806.html" title='"Online Certificate Status Protocol (OCSP) Extensions to IKEv2"'>RFC4806</a>].

   c.  IKEv1 implementations MUST support Main Mode and SHOULD support
       Aggressive Mode.  Main Mode with the pre-shared key
       authentication method SHOULD NOT be used when either the
       initiator or the target uses dynamically assigned IP addresses.
       While in many cases pre-shared keys offer good security,
       situations in which dynamically assigned addresses are used force
       the use of a group pre-shared key, which creates vulnerability to
       a man-in-the-middle attack.  These requirements do not apply to
       IKEv2 because it has no modes.

   d.  In the IKEv1 Phase 2 Quick Mode, in exchanges for creating the
       Phase 2 SA, the Identification Payload MUST be present.  This
       requirement does not apply to IKEv2 because it has no modes.

   e.  The following identification type requirements apply to IKEv1.
       ID_IPV4_ADDR, ID_IPV6_ADDR (if the protocol stack supports IPv6),
       and ID_FQDN Identification Types MUST be supported; ID_USER_FQDN
       SHOULD be supported.  The IP Subnet, IP Address Range,
       ID_DER_ASN1_DN, and ID_DER_ASN1_GN Identification Types SHOULD
       NOT be used.  The ID_KEY_ID Identification Type MUST NOT be used.

   f.  When IKEv2 is supported, the following identification
       requirements apply.  ID_IPV4_ADDR, ID_IPV6_ADDR (if the protocol
       stack supports IPv6), and ID_FQDN Identification Types MUST be
       supported; ID_RFC822_ADDR SHOULD be supported.  The
       ID_DER_ASN1_DN and ID_DER_ASN1_GN Identification Types SHOULD NOT
       be used.  The ID_KEY_ID Identification Type MUST NOT be used.



<span class="grey">Black &amp; Koning               Standards Track                   [Page 10]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-11" id="page-11" name="page-11"> </a>
<span class="grey"><a href="rfc7146.html">RFC 7146</a>            <a href="rfc3723.html">RFC 3723</a> Reqs Update for IPsec v3         April 2014</span>


   The reasons for the identification requirements in items e and f
   above are as follows:

   o  IP Subnet and IP Address Range are too broad to usefully identify
      an iSCSI endpoint.

   o  The _DN and _GN types are X.500 identities; it is usually better
      to use an identity from subjectAltName in a PKI certificate.

   o  ID_KEY_ID is an opaque identifier that is not interoperable among
      different IPsec implementations as specified.  Heterogeneity in
      some block storage protocol implementations can be expected (e.g.,
      iSCSI initiator vs. iSCSI target implementations), and hence
      heterogeneity among IPsec implementations is important.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/3.2.%20%20DH%20Group%20and%20PRF%20Requirements"></a><a class="selflink" href="#section-3.2" name="section-3.2">3.2</a>.  DH Group and PRF Requirements</span>

   This document does not change the support requirements for Diffie-
   Hellman (DH) groups and Pseudo-Random Functions (PRFs).  See
   [<a href="rfc4109.html" title='"Algorithms for Internet Key Exchange version 1 (IKEv1)"'>RFC4109</a>] for IKEv1 requirements and [<a href="rfc4307.html" title='"Cryptographic Algorithms for Use in the Internet Key Exchange Version 2 (IKEv2)"'>RFC4307</a>] for IKEv2
   requirements.  Implementers are advised to check for subsequent RFCs
   that update either of these RFCs, as such updates may change these
   requirements.

   When DH groups are used, a DH group of at least 2048 bits SHOULD be
   offered as a part of all proposals to create IPsec security
   associations for both IKEv1 and IKEv2.

   <a href="rfc3723.html">RFC 3723</a> requires that support for perfect forward secrecy in the
   IKEv1 Quick Mode key exchange MUST be implemented.  This document
   extends that requirement to IKEv2; support for perfect forward
   secrecy in the CREATE_CHILD_SA key exchange MUST be implemented for
   the use of IPsec with block storage protocols.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/4.%20%20Security%20Considerations"></a><a class="selflink" href="#section-4" name="section-4">4</a>.  Security Considerations</span>

   This entire document is about security.

   The security considerations sections of all of the referenced RFCs
   apply, and particular note should be taken of the security
   considerations for the encryption transforms whose requirement levels
   are changed by this RFC:

   o  AES GMAC [<a href="rfc4543.html" title='"The Use of Galois Message Authentication Code (GMAC) in IPsec ESP and AH"'>RFC4543</a>] (new requirement -- SHOULD be supported when
      IKEv2 is supported),

   o  3DES CBC [<a href="rfc2451.html" title='"The ESP CBC-Mode Cipher Algorithms"'>RFC2451</a>] (changed from "MUST be supported" to "MAY be
      supported"),



<span class="grey">Black &amp; Koning               Standards Track                   [Page 11]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-12" id="page-12" name="page-12"> </a>
<span class="grey"><a href="rfc7146.html">RFC 7146</a>            <a href="rfc3723.html">RFC 3723</a> Reqs Update for IPsec v3         April 2014</span>


   o  AES CTR [<a href="rfc3686.html" title='"Using Advanced Encryption Standard (AES) Counter Mode With IPsec Encapsulating Security Payload (ESP)"'>RFC3686</a>] (changed from "SHOULD be supported" to "MAY be
      supported"),

   o  AES CBC [<a href="rfc3602.html" title='"The AES-CBC Cipher Algorithm and Its Use with IPsec"'>RFC3602</a>] (new requirement -- MUST be supported), and

   o  AES GCM [<a href="rfc4106.html" title='"The Use of Galois/Counter Mode (GCM) in IPsec Encapsulating Security Payload (ESP)"'>RFC4106</a>] (new requirement -- SHOULD be supported when
      IKEv2 is supported).

   Of particular interest are the security considerations concerning the
   use of AES GCM [<a href="rfc4106.html" title='"The Use of Galois/Counter Mode (GCM) in IPsec Encapsulating Security Payload (ESP)"'>RFC4106</a>] and AES GMAC [<a href="rfc4543.html" title='"The Use of Galois Message Authentication Code (GMAC) in IPsec ESP and AH"'>RFC4543</a>]; both modes are
   vulnerable to catastrophic forgery attacks if a nonce is ever
   repeated with a given key.

   The requirement level for 3DES CBC has been reduced, based on
   considerations for high-speed implementations; 3DES CBC remains an
   optional encryption transform that may be suitable for
   implementations limited to operating at lower speeds where the
   required rekeying frequency for 3DES is acceptable.

   The requirement level for AES CTR has been reduced, based solely on
   hardware implementation considerations that favor AES GCM, as opposed
   to changes in AES CTR's security properties.  AES CTR remains an
   optional security transform that is suitable for use in general, as
   it does not share 3DES CBC's requirement for frequent rekeying when
   operating at high data rates.

   Key sizes with comparable strength SHOULD be used for the
   cryptographic algorithms and transforms for any individual IPsec
   security association.  See Section 5.6 of [<a href="#ref-SP800-57" title='"NIST Special Publication 800-57: Recommendation for Key Management - Part 1: General (Revision 3)"'>SP800-57</a>] for further
   discussion.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/5.%20%20References"></a><a class="selflink" href="#section-5" name="section-5">5</a>.  References</span>

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.1.%20%20Normative%20References"></a><a class="selflink" href="#section-5.1" name="section-5.1">5.1</a>.  Normative References</span>

   [<a id="ref-RFC2119" name="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="rfc2119.html">RFC 2119</a>, March 1997.

   [<a id="ref-RFC2401" name="ref-RFC2401">RFC2401</a>]  Kent, S. and R. Atkinson, "Security Architecture for the
              Internet Protocol", <a href="rfc2401.html">RFC 2401</a>, November 1998.

   [<a id="ref-RFC2404" name="ref-RFC2404">RFC2404</a>]  Madson, C. and R. Glenn, "The Use of HMAC-SHA-1-96 within
              ESP and AH", <a href="rfc2404.html">RFC 2404</a>, November 1998.

   [<a id="ref-RFC2406" name="ref-RFC2406">RFC2406</a>]  Kent, S. and R. Atkinson, "IP Encapsulating Security
              Payload (ESP)", <a href="rfc2406.html">RFC 2406</a>, November 1998.





<span class="grey">Black &amp; Koning               Standards Track                   [Page 12]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-13" id="page-13" name="page-13"> </a>
<span class="grey"><a href="rfc7146.html">RFC 7146</a>            <a href="rfc3723.html">RFC 3723</a> Reqs Update for IPsec v3         April 2014</span>


   [<a id="ref-RFC2407" name="ref-RFC2407">RFC2407</a>]  Piper, D., "The Internet IP Security Domain of
              Interpretation for ISAKMP", <a href="rfc2407.html">RFC 2407</a>, November 1998.

   [<a id="ref-RFC2409" name="ref-RFC2409">RFC2409</a>]  Harkins, D. and D. Carrel, "The Internet Key Exchange
              (IKE)", <a href="rfc2409.html">RFC 2409</a>, November 1998.

   [<a id="ref-RFC2410" name="ref-RFC2410">RFC2410</a>]  Glenn, R. and S. Kent, "The NULL Encryption Algorithm and
              Its Use With IPsec", <a href="rfc2410.html">RFC 2410</a>, November 1998.

   [<a id="ref-RFC2451" name="ref-RFC2451">RFC2451</a>]  Pereira, R. and R. Adams, "The ESP CBC-Mode Cipher
              Algorithms", <a href="rfc2451.html">RFC 2451</a>, November 1998.

   [<a id="ref-RFC3566" name="ref-RFC3566">RFC3566</a>]  Frankel, S. and H. Herbert, "The AES-XCBC-MAC-96 Algorithm
              and Its Use With IPsec", <a href="rfc3566.html">RFC 3566</a>, September 2003.

   [<a id="ref-RFC3602" name="ref-RFC3602">RFC3602</a>]  Frankel, S., Glenn, R., and S. Kelly, "The AES-CBC Cipher
              Algorithm and Its Use with IPsec", <a href="rfc3602.html">RFC 3602</a>,
              September 2003.

   [<a id="ref-RFC3686" name="ref-RFC3686">RFC3686</a>]  Housley, R., "Using Advanced Encryption Standard (AES)
              Counter Mode With IPsec Encapsulating Security Payload
              (ESP)", <a href="rfc3686.html">RFC 3686</a>, January 2004.

   [<a id="ref-RFC3720" name="ref-RFC3720">RFC3720</a>]  Satran, J., Meth, K., Sapuntzakis, C., Chadalapaka, M.,
              and E. Zeidner, "Internet Small Computer Systems Interface
              (iSCSI)", <a href="rfc3720.html">RFC 3720</a>, April 2004.

   [<a id="ref-RFC3723" name="ref-RFC3723">RFC3723</a>]  Aboba, B., Tseng, J., Walker, J., Rangan, V., and F.
              Travostino, "Securing Block Storage Protocols over IP",
              <a href="rfc3723.html">RFC 3723</a>, April 2004.

   [<a id="ref-RFC3821" name="ref-RFC3821">RFC3821</a>]  Rajagopal, M., Rodriguez, E., and R. Weber, "Fibre Channel
              Over TCP/IP (FCIP)", <a href="rfc3821.html">RFC 3821</a>, July 2004.

   [<a id="ref-RFC3822" name="ref-RFC3822">RFC3822</a>]  Peterson, D., "Finding Fibre Channel over TCP/IP (FCIP)
              Entities Using Service Location Protocol version 2
              (SLPv2)", <a href="rfc3822.html">RFC 3822</a>, July 2004.

   [<a id="ref-RFC3947" name="ref-RFC3947">RFC3947</a>]  Kivinen, T., Swander, B., Huttunen, A., and V. Volpe,
              "Negotiation of NAT-Traversal in the IKE", <a href="rfc3947.html">RFC 3947</a>,
              January 2005.

   [<a id="ref-RFC4018" name="ref-RFC4018">RFC4018</a>]  Bakke, M., Hufferd, J., Voruganti, K., Krueger, M., and T.
              Sperry, "Finding Internet Small Computer Systems Interface
              (iSCSI) Targets and Name Servers by Using Service Location
              Protocol version 2 (SLPv2)", <a href="rfc4018.html">RFC 4018</a>, April 2005.





<span class="grey">Black &amp; Koning               Standards Track                   [Page 13]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-14" id="page-14" name="page-14"> </a>
<span class="grey"><a href="rfc7146.html">RFC 7146</a>            <a href="rfc3723.html">RFC 3723</a> Reqs Update for IPsec v3         April 2014</span>


   [<a id="ref-RFC4106" name="ref-RFC4106">RFC4106</a>]  Viega, J. and D. McGrew, "The Use of Galois/Counter Mode
              (GCM) in IPsec Encapsulating Security Payload (ESP)",
              <a href="rfc4106.html">RFC 4106</a>, June 2005.

   [<a id="ref-RFC4109" name="ref-RFC4109">RFC4109</a>]  Hoffman, P., "Algorithms for Internet Key Exchange
              version 1 (IKEv1)", <a href="rfc4109.html">RFC 4109</a>, May 2005.

   [<a id="ref-RFC4172" name="ref-RFC4172">RFC4172</a>]  Monia, C., Mullendore, R., Travostino, F., Jeong, W., and
              M. Edwards, "iFCP - A Protocol for Internet Fibre Channel
              Storage Networking", <a href="rfc4172.html">RFC 4172</a>, September 2005.

   [<a id="ref-RFC4173" name="ref-RFC4173">RFC4173</a>]  Sarkar, P., Missimer, D., and C. Sapuntzakis,
              "Bootstrapping Clients using the Internet Small Computer
              System Interface (iSCSI) Protocol", <a href="rfc4173.html">RFC 4173</a>,
              September 2005.

   [<a id="ref-RFC4174" name="ref-RFC4174">RFC4174</a>]  Monia, C., Tseng, J., and K. Gibbons, "The IPv4 Dynamic
              Host Configuration Protocol (DHCP) Option for the Internet
              Storage Name Service", <a href="rfc4174.html">RFC 4174</a>, September 2005.

   [<a id="ref-RFC4301" name="ref-RFC4301">RFC4301</a>]  Kent, S. and K. Seo, "Security Architecture for the
              Internet Protocol", <a href="rfc4301.html">RFC 4301</a>, December 2005.

   [<a id="ref-RFC4303" name="ref-RFC4303">RFC4303</a>]  Kent, S., "IP Encapsulating Security Payload (ESP)",
              <a href="rfc4303.html">RFC 4303</a>, December 2005.

   [<a id="ref-RFC4304" name="ref-RFC4304">RFC4304</a>]  Kent, S., "Extended Sequence Number (ESN) Addendum to
              IPsec Domain of Interpretation (DOI) for Internet Security
              Association and Key Management Protocol (ISAKMP)",
              <a href="rfc4304.html">RFC 4304</a>, December 2005.

   [<a id="ref-RFC4307" name="ref-RFC4307">RFC4307</a>]  Schiller, J., "Cryptographic Algorithms for Use in the
              Internet Key Exchange Version 2 (IKEv2)", <a href="rfc4307.html">RFC 4307</a>,
              December 2005.

   [<a id="ref-RFC4543" name="ref-RFC4543">RFC4543</a>]  McGrew, D. and J. Viega, "The Use of Galois Message
              Authentication Code (GMAC) in IPsec ESP and AH", <a href="rfc4543.html">RFC 4543</a>,
              May 2006.

   [<a id="ref-RFC5040" name="ref-RFC5040">RFC5040</a>]  Recio, R., Metzler, B., Culley, P., Hilland, J., and D.
              Garcia, "A Remote Direct Memory Access Protocol
              Specification", <a href="rfc5040.html">RFC 5040</a>, October 2007.

   [<a id="ref-RFC5041" name="ref-RFC5041">RFC5041</a>]  Shah, H., Pinkerton, J., Recio, R., and P. Culley, "Direct
              Data Placement over Reliable Transports", <a href="rfc5041.html">RFC 5041</a>,
              October 2007.





<span class="grey">Black &amp; Koning               Standards Track                   [Page 14]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-15" id="page-15" name="page-15"> </a>
<span class="grey"><a href="rfc7146.html">RFC 7146</a>            <a href="rfc3723.html">RFC 3723</a> Reqs Update for IPsec v3         April 2014</span>


   [<a id="ref-RFC5042" name="ref-RFC5042">RFC5042</a>]  Pinkerton, J. and E. Deleganes, "Direct Data Placement
              Protocol (DDP) / Remote Direct Memory Access Protocol
              (RDMAP) Security", <a href="rfc5042.html">RFC 5042</a>, October 2007.

   [<a id="ref-RFC5043" name="ref-RFC5043">RFC5043</a>]  Bestler, C. and R. Stewart, "Stream Control Transmission
              Protocol (SCTP) Direct Data Placement (DDP) Adaptation",
              <a href="rfc5043.html">RFC 5043</a>, October 2007.

   [<a id="ref-RFC5044" name="ref-RFC5044">RFC5044</a>]  Culley, P., Elzur, U., Recio, R., Bailey, S., and J.
              Carrier, "Marker PDU Aligned Framing for TCP
              Specification", <a href="rfc5044.html">RFC 5044</a>, October 2007.

   [<a id="ref-RFC5046" name="ref-RFC5046">RFC5046</a>]  Ko, M., Chadalapaka, M., Hufferd, J., Elzur, U., Shah, H.,
              and P. Thaler, "Internet Small Computer System Interface
              (iSCSI) Extensions for Remote Direct Memory Access
              (RDMA)", <a href="rfc5046.html">RFC 5046</a>, October 2007.

   [<a id="ref-RFC5048" name="ref-RFC5048">RFC5048</a>]  Chadalapaka, M., "Internet Small Computer System Interface
              (iSCSI) Corrections and Clarifications", <a href="rfc5048.html">RFC 5048</a>,
              October 2007.

   [<a id="ref-RFC5282" name="ref-RFC5282">RFC5282</a>]  Black, D. and D. McGrew, "Using Authenticated Encryption
              Algorithms with the Encrypted Payload of the Internet Key
              Exchange version 2 (IKEv2) Protocol", <a href="rfc5282.html">RFC 5282</a>,
              August 2008.

   [<a id="ref-RFC5996" name="ref-RFC5996">RFC5996</a>]  Kaufman, C., Hoffman, P., Nir, Y., and P. Eronen,
              "Internet Key Exchange Protocol Version 2 (IKEv2)",
              <a href="rfc5996.html">RFC 5996</a>, September 2010.

   [<a id="ref-RFC6960" name="ref-RFC6960">RFC6960</a>]  Santesson, S., Myers, M., Ankney, R., Malpani, A.,
              Galperin, S., and C. Adams, "X.509 Internet Public Key
              Infrastructure Online Certificate Status Protocol - OCSP",
              <a href="rfc6960.html">RFC 6960</a>, June 2013.

   [<a id="ref-RFC7143" name="ref-RFC7143">RFC7143</a>]  Chadalapaka, M., Satran, J., Meth, K., and D. Black,
              "Internet Small Computer System Interface (iSCSI) Protocol
              (Consolidated)", <a href="rfc7143.html">RFC 7143</a>, April 2014.

   [<a id="ref-RFC7145" name="ref-RFC7145">RFC7145</a>]  Ko, M. and A. Nezhinsky, "Internet Small Computer System
              Interface (iSCSI) Extensions for the Remote Direct Memory
              Access (RDMA) Specification", <a href="rfc7145.html">RFC 7145</a>, April 2014.

   [<a id="ref-SP800-57" name="ref-SP800-57">SP800-57</a>] Barker, E., Barker, W., Burr, W., Polk, W., and M. Smid,
              "NIST Special Publication 800-57: Recommendation for Key
              Management - Part 1: General (Revision 3)", July 2012,
              &lt;<a href="http://csrc.nist.gov/publications/nistpubs/800-57/sp800-57_part1_rev3_general.pdf">http://csrc.nist.gov/publications/nistpubs/800-57/</a>
              <a href="http://csrc.nist.gov/publications/nistpubs/800-57/sp800-57_part1_rev3_general.pdf">sp800-57_part1_rev3_general.pdf</a>&gt;.



<span class="grey">Black &amp; Koning               Standards Track                   [Page 15]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-16" id="page-16" name="page-16"> </a>
<span class="grey"><a href="rfc7146.html">RFC 7146</a>            <a href="rfc3723.html">RFC 3723</a> Reqs Update for IPsec v3         April 2014</span>


   [<a id="ref-triple-des-birthday" name="ref-triple-des-birthday">triple-des-birthday</a>]
              McGrew, D., "Impossible plaintext cryptanalysis and
              probable-plaintext collision attacks of 64-bit block
              cipher modes (Cryptology ePrint Archive: Report 2012/
              623)", November 2012, &lt;<a href="http://eprint.iacr.org/2012/623">http://eprint.iacr.org/2012/623</a>&gt;.

   [<a id="ref-triple-des-spec" name="ref-triple-des-spec">triple-des-spec</a>]
              American Bankers Association (ABA), "American National
              Standard for Financial Services X9.52-1998 - Triple Data
              Encryption Algorithm Modes of Operation", July 1998.

<span class="h3"><a class="dashAnchor" name="//apple_ref/Section/5.2.%20%20Informative%20References"></a><a class="selflink" href="#section-5.2" name="section-5.2">5.2</a>.  Informative References</span>

   [<a id="ref-RFC3721" name="ref-RFC3721">RFC3721</a>]  Bakke, M., Hafner, J., Hufferd, J., Voruganti, K., and M.
              Krueger, "Internet Small Computer Systems Interface
              (iSCSI) Naming and Discovery", <a href="rfc3721.html">RFC 3721</a>, April 2004.

   [<a id="ref-RFC4806" name="ref-RFC4806">RFC4806</a>]  Myers, M. and H. Tschofenig, "Online Certificate Status
              Protocol (OCSP) Extensions to IKEv2", <a href="rfc4806.html">RFC 4806</a>,
              February 2007.

   [<a id="ref-RFC5045" name="ref-RFC5045">RFC5045</a>]  Bestler, C. and L. Coene, "Applicability of Remote Direct
              Memory Access Protocol (RDMA) and Direct Data Placement
              (DDP)", <a href="rfc5045.html">RFC 5045</a>, October 2007.

   [<a id="ref-RFC5047" name="ref-RFC5047">RFC5047</a>]  Chadalapaka, M., Hufferd, J., Satran, J., and H. Shah,
              "DA: Datamover Architecture for the Internet Small
              Computer System Interface (iSCSI)", <a href="rfc5047.html">RFC 5047</a>,
              October 2007.

   [<a id="ref-RFC5387" name="ref-RFC5387">RFC5387</a>]  Touch, J., Black, D., and Y. Wang, "Problem and
              Applicability Statement for Better-Than-Nothing Security
              (BTNS)", <a href="rfc5387.html">RFC 5387</a>, November 2008.


















<span class="grey">Black &amp; Koning               Standards Track                   [Page 16]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-17" id="page-17" name="page-17"> </a>
<span class="grey"><a href="rfc7146.html">RFC 7146</a>            <a href="rfc3723.html">RFC 3723</a> Reqs Update for IPsec v3         April 2014</span>


<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/Appendix%20A.%20%20Block%20Cipher%20Birthday%20Bounds"></a><a class="selflink" href="#appendix-A" name="appendix-A">Appendix A</a>.  Block Cipher Birthday Bounds</span>

   This appendix provides the birthday bounds for the 3DES and AES
   ciphers based on [<a href="#ref-triple-des-birthday">triple-des-birthday</a>], which states: "Theory advises
   against using a w-bit block cipher to encrypt more than 2^(w/2)
   blocks with a single key; this is known as the birthday bound".

   For a cipher with a 64-bit block size (e.g., 3DES), w = 64, so the
   birthday bound is 2^32 blocks.  As each block contains 8 (2^3) bytes,
   the birthday bound is 2^35 bytes = 2^5 gibibytes, i.e., 32 GiB, where
   1 gibibyte (GiB) = 2^30 bytes.  Note that a gigabyte (decimal
   quantity) is not the same as a gibibyte (binary quantity); 1 gigabyte
   (GB) = 10^6 bytes.

   For a cipher with a 128-bit block size (e.g., AES), w = 128, so the
   birthday bound is 2^64 blocks.  As each block contains 16 (2^4)
   bytes, the birthday bound is 2^68 bytes = 2^8 exbibytes, i.e.,
   256 EiB, where 1 exbibyte (EiB) = 2^60 bytes.  Note that an exabyte
   (decimal quantity) is not the same as an exbibyte (binary quantity);
   1 exabyte (EB) = 10^9 bytes.

<span class="h2"><a class="dashAnchor" name="//apple_ref/Section/Appendix%20B.%20%20Contributors"></a><a class="selflink" href="#appendix-B" name="appendix-B">Appendix B</a>.  Contributors</span>

   David McGrew's observations about the birthday bound implications of
   3DES's 64-bit block size on the ipsec@ietf.org mailing list led to
   changing from 3DES CBC to AES CBC as the mandatory-to-implement
   encryption algorithm, based on the birthday bound discussion in
   <a href="#appendix-A">Appendix A</a>.

   The original authors of <a href="rfc3723.html">RFC 3723</a> were Bernard Aboba, Joshua Tseng,
   Jesse Walker, Venkat Rangan, and Franco Travostino.  Comments from
   Francis Dupont, Yaron Sheffer, Tom Talpey, Sean Turner, and Tom Yu
   have improved this document and are gratefully acknowledged.


















<span class="grey">Black &amp; Koning               Standards Track                   [Page 17]</span></pre>
<hr align="left" class="noprint" style="width: 96ex;"/><!--NewPage--><pre class="newpage"><a class="invisible" href="#page-18" id="page-18" name="page-18"> </a>
<span class="grey"><a href="rfc7146.html">RFC 7146</a>            <a href="rfc3723.html">RFC 3723</a> Reqs Update for IPsec v3         April 2014</span>


Authors' Addresses

   David L. Black
   EMC Corporation
   176 South St.
   Hopkinton, MA  01748
   USA

   Phone: +1 508 293-7953
   EMail: david.black@emc.com


   Paul Koning
   Dell
   300 Innovative Way
   Nashua, NH  03062
   USA

   Phone: +1 603 249-7703
   EMail: paul_koning@Dell.com































Black &amp; Koning               Standards Track                   [Page 18]

</pre><br/>
    <span class="noprint"><small><small>Html markup produced by rfcmarkup 1.126, available from
      <a href="https://tools.ietf.org/tools/rfcmarkup/">https://tools.ietf.org/tools/rfcmarkup/</a>
    </small></small></span>
  </div>




</body><!-- Mirrored from tools.ietf.org/html/rfc7146 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Mar 2018 23:18:23 GMT --></html>